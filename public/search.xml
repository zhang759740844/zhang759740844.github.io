<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[FDFullScreenPopGesture æºç è§£æ]]></title>
      <url>http://zhang759740844.github.io/2017/02/06/FDFullScreenPopGesture_%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</url>
      <content type="html"><![CDATA[<p><code>FDFullScreenPopGesture</code> æ˜¯ä¸€ä¸ªéå¸¸å°å·§ç²¾æ‚ï¼Œå´åˆåŠŸèƒ½å¼ºå¤§çš„å¼€æºé¡¹ç›®ã€‚ä¸»è¦çš„åŠŸèƒ½æœ‰ï¼šå…¨å±€çš„æ‰‹åŠ¿å›é€€ï¼›éƒ¨åˆ†ç•Œé¢çš„ <code>NavigationBar</code> çš„éšè—ã€‚ä»Šå¤©èŠ±äº†åŠå¤©çš„æ—¶é—´ææ˜ç™½äº†å…¶ä¸­çš„åŸç†ã€‚</p>
<a id="more"></a>
<p>iOS åŸç”Ÿçš„è¿”å›æ‰‹åŠ¿çš„èµ·å§‹æ»‘åŠ¨ç‚¹å¿…é¡»é è¿‘å±å¹•çš„å·¦æ–¹ï¼Œæ— æ³•å®ç°å…¨å±è¿”å›ã€‚æˆ‘ä»¬å¯ä»¥ç»™æ§åˆ¶å™¨çš„ view æ·»åŠ æ‰‹åŠ¿æ¥æ§åˆ¶å®ƒçš„ frameã€‚ä½†æ˜¯é‚£æ ·éœ€è¦è‡ªå·±æ§åˆ¶åŠ¨ç”»ï¼Œè‡ªå·±æ§åˆ¶ <code>NavigationBar</code> ï¼Œéå¸¸éº»çƒ¦ã€‚<code>FDFullScreenPopGesture</code> é€šè¿‡ä¸€ç§ä¼˜é›…çš„æ–¹å¼è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚å¹¶ä¸”é¡ºå¸¦å®ç°äº†éƒ¨åˆ†æ§åˆ¶å™¨éšè— <code>NavigationBar</code> çš„åŠŸèƒ½ã€‚</p>
<h3 id="æ€»ä½“è§£æ„"><a href="#æ€»ä½“è§£æ„" class="headerlink" title="æ€»ä½“è§£æ„"></a>æ€»ä½“è§£æ„</h3><p>æ•´ä¸ª <code>FDFullScreenPopGesture</code> æ€»å…±åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li><code>_FDFullscreenPopGestureRecognizerDelegate</code></li>
<li><code>UIViewController (FDFullscreenPopGesturePrivate)</code></li>
<li><code>UIViewController (FDFullscreenPopGesture)</code></li>
<li><code>UINavigationController (FDFullscreenPopGesture)</code></li>
</ul>
<h3 id="FDFullscreenPopGestureRecognizerDelegate"><a href="#FDFullscreenPopGestureRecognizerDelegate" class="headerlink" title="_FDFullscreenPopGestureRecognizerDelegate"></a>_FDFullscreenPopGestureRecognizerDelegate</h3><p>è¿™ä¸ªç±»åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯å®ç°äº† <code>UIGestureRecognizerDelegate</code> çš„ä»£ç†æ–¹æ³• <code>gestureRecognizerShouldBegin:</code>ã€‚ç”¨æ¥æ§åˆ¶æ˜¯å¦å¼€å§‹æ‰‹åŠ¿æ“ä½œã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)gestureRecognizerShouldBegin:(<span class="built_in">UIPanGestureRecognizer</span> *)gestureRecognizer</div><div class="line">&#123;</div><div class="line">    <span class="comment">// Ignore when no view controller is pushed into the navigation stack.</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.navigationController.viewControllers.count &lt;= <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// Ignore when the active view controller doesn't allow interactive pop.</span></div><div class="line">    <span class="built_in">UIViewController</span> *topViewController = <span class="keyword">self</span>.navigationController.viewControllers.lastObject;</div><div class="line">    <span class="keyword">if</span> (topViewController.fd_interactivePopDisabled) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// Ignore when the beginning location is beyond max allowed initial distance to left edge.</span></div><div class="line">    <span class="built_in">CGPoint</span> beginningLocation = [gestureRecognizer locationInView:gestureRecognizer.view];</div><div class="line">    <span class="built_in">CGFloat</span> maxAllowedInitialDistance = topViewController.fd_interactivePopMaxAllowedInitialDistanceToLeftEdge;</div><div class="line">    <span class="keyword">if</span> (maxAllowedInitialDistance &gt; <span class="number">0</span> &amp;&amp; beginningLocation.x &gt; maxAllowedInitialDistance) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Ignore pan gesture when the navigation controller is currently in transition.</span></div><div class="line">    <span class="keyword">if</span> ([[<span class="keyword">self</span>.navigationController valueForKey:<span class="string">@"_isTransitioning"</span>] boolValue]) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">    &#125;</div><div class="line">   </div><div class="line">    <span class="comment">// Prevent calling the handler when the gesture begins in an opposite direction.</span></div><div class="line">    <span class="built_in">CGPoint</span> translation = [gestureRecognizer translationInView:gestureRecognizer.view];</div><div class="line">    <span class="keyword">if</span> (translation.x &lt;= <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ€»å…±åœ¨5ä¸­æƒ…å†µä¸‹ï¼Œä¸èƒ½å…¨å±å¹•è¿”å›ï¼š</p>
<ol>
<li>æ•´å„¿ <code>NavigationController</code> ä¸­åªæœ‰ä¸€ä¸ª <code>ViewController</code> çš„æ—¶å€™</li>
<li>å½“å‰çš„ <code>ViewController</code> ç¦ç”¨äº† <code>fd_interactivePopDisabled</code>ï¼ˆè¿™ä¸ªåœ¨ <code>UINavigationController (FDFullscreenPopGesture)</code> ä¸­è®¾ç½®çš„ï¼‰</li>
<li>å½“å‰æ‰‹åŠ¿çš„å¯åŠ¨ç‚¹è·ç¦»å·¦è¾¹ç¼˜è¿œè¿‡äº† <code>fd_interactivePopMaxAllowedInitialDistanceToLeftEdge</code>ï¼ˆåŒä¸Šï¼Œä¹Ÿæ˜¯è‡ªå·±è®¾ç½®çš„ï¼‰</li>
<li>å½“å‰æ˜¯å¦åœ¨è½¬åœºè¿‡ç¨‹ä¸­ã€‚è¿™é‡Œé€šè¿‡ KVC æ‹¿åˆ°äº† <code>NavigationController</code> ä¸­çš„ <code>_isTransitioning</code> å±æ€§</li>
<li>æ‰‹åŠ¿è¿åŠ¨æ–¹å‘æ˜¯å¦æ˜¯ä»å³å¾€å·¦</li>
</ol>
<h3 id="UIViewController-FDFullscreenPopGesturePrivate"><a href="#UIViewController-FDFullscreenPopGesturePrivate" class="headerlink" title="UIViewController (FDFullscreenPopGesturePrivate)"></a><strong>UIViewController (FDFullscreenPopGesturePrivate)</strong></h3><p>å¦‚æœä½ å¯¹ <code>runtime</code> æ¯”è¾ƒç†Ÿæ‚‰ï¼Œé‚£ä¹ˆçœ‹åˆ°è¿™ä¸ªç±»ä¸€å®šéå¸¸äº²åˆ‡ã€‚è¿™ä¸ªæ–¹æ³•åœ¨ <code>load</code> æ–¹æ³•çš„æ—¶å€™ï¼Œé€šè¿‡ <code>Method Swizzling</code> ç”¨ <code>fd_viewWillAppear:</code> æ–¹æ³•ï¼Œæ›¿æ¢äº†åŸæ¥çš„ <code>viewWillAppear:</code> æ–¹æ³•ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)fd_viewWillAppear:(<span class="built_in">BOOL</span>)animated</div><div class="line">&#123;</div><div class="line">    <span class="comment">// Forward to primary implementation.</span></div><div class="line">    [<span class="keyword">self</span> fd_viewWillAppear:animated];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.fd_willAppearInjectBlock) &#123;</div><div class="line">        <span class="keyword">self</span>.fd_willAppearInjectBlock(<span class="keyword">self</span>, animated);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ›¿æ¢çš„æ–¹æ³•æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œå°±æ˜¯åœ¨å…¶ä¸­æ’å…¥äº†è‡ªå·±çš„å›è°ƒå— <code>fd_willAppearInjectBlock</code> ï¼Œè¯¥å—åœ¨ <code>UINavigationController (FDFullscreenPopGesture)</code> ä¸­å®šä¹‰å¹¶è®¾ç½®ã€‚è¯¥å—ç”¨æ¥è®¾ç½® <code>NavigationBar</code> çš„æ˜¾ç¤ºä¸éšè—ã€‚</p>
<h3 id="UIViewController-FDFullscreenPopGesture"><a href="#UIViewController-FDFullscreenPopGesture" class="headerlink" title="UIViewController (FDFullscreenPopGesture)"></a>UIViewController (FDFullscreenPopGesture)</h3><p>è¿™ä¸ªç±»ä¸­å®šä¹‰äº†3ä¸ªå±æ€§ï¼Œä¸Šé¢ç”¨åˆ°äº†ä¸¤ä¸ª <code>fd_interactivePopDisabled</code>ï¼Œ<code>fd_interactivePopMaxAllowedInitialDistanceToLeftEdge</code> è¿˜æœ‰ä¸€ä¸ª <code>fd_prefersNavigationBarHidden</code> å±æ€§ç”¨äºåˆ¤æ–­æ˜¯å¦éšè— <code>NavigationBar</code> ä¸Šé¢çš„ <code>fd_willAppearInjectBlock</code> ä¸­ç”¨åˆ°ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIViewController</span> (<span class="title">FDFullscreenPopGesture</span>)</span></div><div class="line"></div><div class="line"><span class="comment">/// Whether the interactive pop gesture is disabled when contained in a navigation</span></div><div class="line"><span class="comment">/// stack.</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> fd_interactivePopDisabled;</div><div class="line"></div><div class="line"><span class="comment">/// Indicate this view controller prefers its navigation bar hidden or not,</span></div><div class="line"><span class="comment">/// checked when view controller based navigation bar's appearance is enabled.</span></div><div class="line"><span class="comment">/// Default to NO, bars are more likely to show.</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> fd_prefersNavigationBarHidden;</div><div class="line"></div><div class="line"><span class="comment">/// Max allowed initial distance to left edge when you begin the interactive pop</span></div><div class="line"><span class="comment">/// gesture. 0 by default, which means it will ignore this limit.</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> fd_interactivePopMaxAllowedInitialDistanceToLeftEdge;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h3 id="UINavigationController-FDFullscreenPopGesture"><a href="#UINavigationController-FDFullscreenPopGesture" class="headerlink" title="UINavigationController (FDFullscreenPopGesture)"></a>UINavigationController (FDFullscreenPopGesture)</h3><p>è¿™ä¸ªæ–¹æ³•æ˜¯æ•´ä¸ªé¡¹ç›®çš„é€»è¾‘çš„æ ¸å¿ƒï¼Œé¦–å…ˆè¿˜æ˜¯åœ¨ <code>load</code> æ–¹æ³•ä¸­ç”¨ <code>fd_pushViewController:animated:</code> æ–¹æ³•æ›¿æ¢äº†ç³»ç»Ÿè‡ªèº«çš„ <code>pushViewController:animated:</code> æ–¹æ³•ã€‚è¯¥æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)fd_pushViewController:(<span class="built_in">UIViewController</span> *)viewController animated:(<span class="built_in">BOOL</span>)animated</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (![<span class="keyword">self</span>.interactivePopGestureRecognizer.view.gestureRecognizers containsObject:<span class="keyword">self</span>.fd_fullscreenPopGestureRecognizer]) &#123;</div><div class="line"></div><div class="line">        <span class="comment">// 1.</span></div><div class="line">        [<span class="keyword">self</span>.interactivePopGestureRecognizer.view addGestureRecognizer:<span class="keyword">self</span>.fd_fullscreenPopGestureRecognizer];</div><div class="line"></div><div class="line">        <span class="comment">// 2.</span></div><div class="line">        <span class="built_in">NSArray</span> *internalTargets = [<span class="keyword">self</span>.interactivePopGestureRecognizer valueForKey:<span class="string">@"targets"</span>];</div><div class="line">        <span class="keyword">id</span> internalTarget = [internalTargets.firstObject valueForKey:<span class="string">@"target"</span>];</div><div class="line">        SEL internalAction = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"handleNavigationTransition:"</span>);</div><div class="line">        <span class="keyword">self</span>.fd_fullscreenPopGestureRecognizer.delegate = <span class="keyword">self</span>.fd_popGestureRecognizerDelegate;</div><div class="line">        [<span class="keyword">self</span>.fd_fullscreenPopGestureRecognizer addTarget:internalTarget action:internalAction];</div><div class="line"></div><div class="line">        <span class="comment">// 3.</span></div><div class="line">        <span class="keyword">self</span>.interactivePopGestureRecognizer.enabled = <span class="literal">NO</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 4.</span></div><div class="line">    [<span class="keyword">self</span> fd_setupViewControllerBasedNavigationBarAppearanceIfNeeded:viewController];</div><div class="line"></div><div class="line">    <span class="comment">// Forward to primary implementation.</span></div><div class="line">    <span class="keyword">if</span> (![<span class="keyword">self</span>.viewControllers containsObject:viewController]) &#123;</div><div class="line">        [<span class="keyword">self</span> fd_pushViewController:viewController animated:animated];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…ˆçœ‹ç¬¬ä¸€æ­¥ï¼Œåœ¨ <code>interactivePopGestureRecognizer</code> çš„ view ä¸Šæ·»åŠ ä¸€ä¸ª <code>UIPanGestureRecognizer</code>ã€‚è¿™ä¸ª <code>interactivePopGestureRecognizer</code> æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ è¿™æ˜¯æ§åˆ¶ç•Œé¢åœ¨è¾¹ç¼˜å¤„æ»‘åŠ¨è¿”å›çš„æ‰‹åŠ¿ã€‚è¿™æ˜¯ä¸€ä¸ªåªè¯»çš„å±æ€§ï¼Œæˆ‘ä»¬å½“ç„¶ä¸èƒ½ç›´æ¥è®¾ç½®å®ƒï¼Œæ‹¿åˆ°å®ƒæ˜¯ä¸ºäº†é€šè¿‡å®ƒæ‹¿åˆ°è¯¥æ‰‹åŠ¿æ‰€åœ¨çš„ viewï¼Œåœ¨ view ä¸­ä¿å­˜äº†ä¸€ä¸ª <code>_gestureRecognizers</code> çš„æ•°ç»„ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚ä½•åˆ¤æ–­æ˜¯å¦éœ€è¦ pop å‘¢ï¼Ÿå°±æ˜¯é€šè¿‡æ‹¿åˆ° view ä¸­çš„  <code>_gestureRecognizers</code> ï¼Œå†è°ƒç”¨æ¯ä¸ªæ‰‹åŠ¿çš„ <code>UIGestureRecognizerDelegate</code> ä¸­çš„ gestureRecognizerShouldBegin<code>æ–¹æ³•æ˜¯å¦è¿”å›</code>yes<code>ã€‚è¿™é‡Œè‹¹æœä¹‹æ‰€ä»¥æŠŠ</code>_gestureRecognizers` è®¾ç½®ä¸ºæ•°ç»„ï¼Œå¯èƒ½æ˜¯ä¸ºäº†ä»¥åæ›´æ˜“æ‹“å±•å§ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿæ–¹ä¾¿äº†æˆ‘ä»¬çš„æ‹“å±•ã€‚</p>
<p>ç¬¬äºŒæ­¥å°†è‡ªå·±æ·»åŠ çš„æ‰‹åŠ¿è®¾ç½®æˆä¸åŸç”Ÿæ‰‹åŠ¿ç›¸åŒï¼ŒåŒ…æ‹¬ä¸€ä¸ª <code>target</code> å’Œä¸€ä¸ª <code>action</code>ï¼Œè¿™æ ·ä¸¤ä¸ªæ‰‹åŠ¿çš„åŠ¨ç”»ä»¥åŠè§¦å‘æ–¹æ³•å°±ä¸€æ¨¡ä¸€æ ·äº†ã€‚</p>
<p>ç¬¬ä¸‰æ­¥å°†åŸæ¥çš„æ‰‹åŠ¿ç¦ç”¨ã€‚</p>
<p>ç¬¬å››æ­¥è®¾ç½®ä¸Šé¢è¯´è¿‡çš„ <code>_FDViewControllerWillAppearInjectBlock</code> ã€‚ä¹Ÿå°±æ˜¯é€šè¿‡ <code>fd_prefersNavigationBarHidden</code> æ¥æ˜¾ç¤ºå’Œéšè— <code>NavigationBar</code>ã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ä¸»è¦å¤ä¹ äº†ä¸€ä¸‹ <code>method swizzling</code> çš„ä½¿ç”¨ï¼Œå¯ä»¥å¾ˆä¼˜é›…åœ°ä¿®æ”¹ç‰¹å®šçš„æ–¹æ³•ã€‚</p>
<p>å¦å¤–ï¼Œè™½ç„¶è‹¹æœæ²¡å¼€æºï¼Œä½†è¿˜æ˜¯é€šè¿‡è·å–åˆ°äº†ç³»ç»Ÿç±»ä¸­çš„ç§æœ‰æ–¹æ³•ã€‚è¿™ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ€è·¯ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è°ƒè¯•ï¼Œæ¥æŸ¥çœ‹å„ä¸ªéšè—çš„å˜é‡ã€‚ä¸è¿‡æœ‰ä¸€ç‚¹è¦å°å¿ƒï¼šç³»ç»Ÿç±»å†…å®šä¹‰çš„ä¸€äº› property åªæ˜¯å®šä¹‰åŒåçš„ get set æ–¹æ³•ï¼Œä½†æ˜¯å®é™…å­˜å‚¨çš„å˜é‡åå¹¶ä¸å’Œ property åç›¸åŒï¼Œå˜é‡å­˜å‚¨çš„ä½ç½®ä¹Ÿä¸èƒ½å®Œå…¨ç¡®å®šã€‚æ¯”å¦‚ä¸Šé¢ <code>UINavigationController</code> çš„ <code>interactivePopGestureRecognizer</code> å±æ€§ï¼Œè¢«ä¿å­˜åœ¨ <code>UINavigationController</code> ä¸­çš„ <code>__cachedInteractionController</code> ä¹‹ä¸‹ï¼Œåä¸º <code>_edgePanRecognizer</code>ï¼Œå¦‚æœè‡ªå·±æ‰¾èµ·æ¥çš„è¯ï¼ŒçœŸçš„å›°éš¾ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iOS æŒä¹…åŒ–æ–¹å¼]]></title>
      <url>http://zhang759740844.github.io/2017/02/03/iOS%E6%8C%81%E4%B9%85%E5%8C%96/</url>
      <content type="html"><![CDATA[<p>å¼€å‘çš„æ—¶å€™æ€»æ˜¯è¦ä¿å­˜ä¸€äº›ä¸œè¥¿åœ¨ç£ç›˜ä¸Šçš„ï¼Œé‚£ä¹ˆæœ‰å“ªäº›æ–¹å¼æ¥å®ŒæˆæŒä¹…åŒ–å‘¢ï¼Ÿ</p>
<a id="more"></a>
<h2 id="NSUserDefaults"><a href="#NSUserDefaults" class="headerlink" title="NSUserDefaults"></a>NSUserDefaults</h2><p>å¯¹äºåº”ç”¨æ¥è¯´ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„ç‹¬ç‰¹åå¥½è®¾ç½®ï¼Œè€Œå¥½çš„åº”ç”¨ä¼šè®©ç”¨æˆ·æ ¹æ®å–œå¥½é€‰æ‹©åˆé€‚çš„ä½¿ç”¨æ–¹å¼ï¼ŒæŠŠè¿™äº›åå¥½è®°å½•åœ¨åº”ç”¨åŒ…çš„ <code>plist</code> æ–‡ä»¶ä¸­ï¼Œé€šè¿‡ <code>NSUserDefaults</code> ç±»æ¥è®¿é—®ï¼Œè¿™æ˜¯ <code>NSUserDefaults</code> çš„å¸¸ç”¨å§¿åŠ¿ã€‚å¦‚æœæœ‰ä¸€äº›è®¾ç½®ä½ å¸Œæœ›ç”¨æˆ·å³ä½¿å‡çº§åè¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œæ¯”å¦‚ç©æ¸¸æˆæ—¶å¾—è¿‡çš„æœ€é«˜åˆ†ã€å–œå¥½å’Œé€šçŸ¥è®¾ç½®ã€ä¸»é¢˜é¢œè‰²ç”šè‡³ä¸€ä¸ªç”¨æˆ·å¤´åƒï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ <code>NSUserDefaults</code> æ¥å­˜å‚¨è¿™äº›ä¿¡æ¯ã€‚</p>
<h3 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h3><p><code>NSUserDefaults</code> æ˜¯ iOS ç³»ç»Ÿæä¾›çš„ä¸€ä¸ªå•ä¾‹ç±»ï¼Œé€šè¿‡ç±»æ–¹æ³• <code>standardUserDefaults</code> å¯ä»¥è·å– <code>NSUserDefaults</code> å•ä¾‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSUserDefaults</span> *defaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</div></pre></td></tr></table></figure>
<p><code>NSUserDefaults</code> å•ä¾‹ä»¥ key-value çš„å½¢å¼å­˜å‚¨äº†ä¸€ç³»åˆ—åå¥½è®¾ç½®ï¼Œkey æ˜¯åç§°ï¼Œvalue æ˜¯ç›¸åº”çš„æ•°æ®ã€‚å­˜/å–æ•°æ®æ—¶å¯ä»¥ä½¿ç”¨æ–¹æ³• <code>objectForKey:</code> å’Œ <code>setObject:forKey:</code> æ¥æŠŠå¯¹è±¡å­˜å‚¨åˆ°ç›¸åº”çš„ <code>plist</code> æ–‡ä»¶ä¸­ï¼Œæˆ–è€…è¯»å–ï¼Œæ—¢ç„¶æ˜¯ <code>plist</code> æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯¹è±¡çš„ç±»å‹åˆ™å¿…é¡»æ˜¯ <code>plist</code> æ–‡ä»¶å¯ä»¥å­˜å‚¨çš„ç±»å‹ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>NSData</code></li>
<li><code>NSString</code></li>
<li><code>NSNumber</code></li>
<li><code>NSDate</code></li>
<li><code>NSArray</code></li>
<li><code>NSDictionary</code></li>
</ul>
<p>è€Œå¦‚æœéœ€è¦å­˜å‚¨  <code>plist</code> æ–‡ä»¶ä¸æ”¯æŒçš„ç±»å‹ï¼Œæ¯”å¦‚å›¾ç‰‡ï¼Œå¯ä»¥å…ˆå°†å…¶å½’æ¡£ä¸º <code>NSData</code> ç±»å‹ï¼Œå†å­˜å…¥ <code>plist</code> æ–‡ä»¶ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿å¯¹è±¡æ˜¯ <code>NSArray</code> æˆ– <code>NSDictionary</code> ï¼Œä»–ä»¬å­˜å‚¨çš„ç±»å‹ä¹Ÿåº”è¯¥æ˜¯ä»¥ä¸ŠèŒƒå›´åŒ…æ‹¬çš„ã€‚</p>
<h3 id="ä¸€äº›æ–¹æ³•"><a href="#ä¸€äº›æ–¹æ³•" class="headerlink" title="ä¸€äº›æ–¹æ³•"></a>ä¸€äº›æ–¹æ³•</h3><p><code>NSUserDefaults</code> æä¾›äº†è‹¥å¹²ç®€ä¾¿æ–¹æ³•å¯ä»¥å­˜å‚¨æŸäº›å¸¸ç”¨ç±»å‹çš„å€¼ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- setBool:forKey:</div><div class="line">- setFloat:forKey:</div><div class="line">- setInteger:forKey:</div><div class="line">- setDouble:forKey:</div><div class="line">- setURL:forKey:</div></pre></td></tr></table></figure>
<p>è¿™é‡Œåªåˆ—ä¸¾äº†å‡ ä¸ª set æ–¹æ³•ï¼Œget æ–¹æ³•ç±»ä¼¼ã€‚</p>
<h3 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><p>å­˜ä¸€ä¸ªæ•´æ•°ã€å­—ç¬¦ä¸²å’Œä¸€å¼ å›¾ç‰‡ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSUserDefaults</span> *defaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</div><div class="line"><span class="comment">//å­—ç¬¦ä¸²</span></div><div class="line">[defaults setObject:<span class="string">@"jack"</span> forKey:<span class="string">@"firstName"</span>];</div><div class="line"><span class="comment">//æ•´æ•°</span></div><div class="line">[defaults setInteger:<span class="number">10</span> forKey:<span class="string">@"Age"</span>];</div><div class="line"><span class="comment">//å›¾ç‰‡</span></div><div class="line"><span class="built_in">UIImage</span> *image =[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"somename"</span>];</div><div class="line"><span class="built_in">NSData</span> *imageData = <span class="built_in">UIImageJPEGRepresentation</span>(image, <span class="number">100</span>);<span class="comment">//æŠŠimageå½’æ¡£ä¸ºNSData</span></div><div class="line">[defaults setObject:imageData forKey:<span class="string">@"image"</span>];</div></pre></td></tr></table></figure>
<p>å¯¹åº”çš„è¯»å–æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSUserDefaults</span> *defaults = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</div><div class="line"><span class="comment">//å­—ç¬¦ä¸²</span></div><div class="line"><span class="built_in">NSString</span> *firstName = [defaults objectForKey:<span class="string">@"firstName"</span>]</div><div class="line"><span class="comment">//æ•°å­—</span></div><div class="line"><span class="built_in">NSInteger</span> age = [defaults integerForKey:<span class="string">@"Age"</span>];</div><div class="line"><span class="comment">//å›¾ç‰‡</span></div><div class="line"><span class="built_in">NSData</span> *imageData = [defaults dataForKey:<span class="string">@"image"</span>];</div><div class="line"><span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageWithData:imageData];</div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[å…³äº iOS build]]></title>
      <url>http://zhang759740844.github.io/2017/02/03/%E5%85%B3%E4%BA%8E%20iOS%20build/</url>
      <content type="html"><![CDATA[<p>å…³äº Xcode æ˜¯å¦‚ä½•ç¼–è¯‘çš„ï¼Œä¸‹é¢æ˜¯ä¸€äº›è¾ƒä¸ºæµ…æ˜¾çš„è®¨è®ºã€‚</p>
<a id="more"></a>
<h2 id="ç‚¹å‡»runåå‘ç”Ÿäº†ä»€ä¹ˆ"><a href="#ç‚¹å‡»runåå‘ç”Ÿäº†ä»€ä¹ˆ" class="headerlink" title="ç‚¹å‡»runåå‘ç”Ÿäº†ä»€ä¹ˆ"></a>ç‚¹å‡»runåå‘ç”Ÿäº†ä»€ä¹ˆ</h2><p>ç‚¹å‡» Run ä¹‹å App è¿›è¡Œ<strong>ç¼–è¯‘ã€æ±‡ç¼–ã€é“¾æ¥ã€ä»£ç ç­¾åä»¥åŠå¯åŠ¨æ‰§è¡Œ</strong>ç­‰æ“ä½œ</p>
<h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><p>Clangæ˜¯LLVMçš„å‰ç«¯ï¼Œå¯ä»¥ç”¨æ¥ç¼–è¯‘Cï¼ŒC++ï¼ŒObjectiveCç­‰è¯­è¨€ã€‚ä¼ ç»Ÿçš„ç¼–è¯‘å™¨é€šå¸¸åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œ<strong>å‰ç«¯(frontEnd)</strong>ï¼Œ<strong>ä¼˜åŒ–å™¨(Optimizer)</strong>å’Œ<strong>åç«¯(backEnd)</strong>ã€‚åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œå‰ç«¯ä¸»è¦è´Ÿè´£è¯æ³•å’Œè¯­æ³•åˆ†æï¼Œå°†æºä»£ç è½¬åŒ–ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼›ä¼˜åŒ–å™¨åˆ™æ˜¯åœ¨å‰ç«¯çš„åŸºç¡€ä¸Šï¼Œå¯¹å¾—åˆ°çš„ä¸­é—´ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œä½¿ä»£ç æ›´åŠ é«˜æ•ˆï¼›åç«¯åˆ™æ˜¯å°†å·²ç»ä¼˜åŒ–çš„<strong>ä¸­é—´ä»£ç </strong>è½¬åŒ–ä¸ºé’ˆå¯¹å„è‡ªå¹³å°çš„æœºå™¨ä»£ç ã€‚Clangåˆ™æ˜¯ä»¥LLVMä¸ºåç«¯çš„ä¸€æ¬¾é«˜æ•ˆæ˜“ç”¨ï¼Œå¹¶ä¸”ä¸IDEç»“åˆå¾ˆå¥½çš„ç¼–è¯‘å‰ç«¯ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/build_ç¼–è¯‘å™¨.png?raw=true" alt="ç¼–è¯‘å™¨è§£æ„"></p>
<p>ç¼–è¯‘å™¨åˆ†åˆ«ç¼–è¯‘å™¨å‰ç«¯ï¼ˆclangï¼‰å’Œç¼–è¯‘å™¨åç«¯ï¼Œç¼–è¯‘å™¨å‰ç«¯è´Ÿè´£äº§ç”Ÿæœºå™¨æ— å…³çš„ä¸­é—´ä»£ç ï¼Œç¼–è¯‘å™¨åç«¯è´Ÿè´£å¯¹ä¸­é—´ä»£ç è¿›è¡Œä¼˜åŒ–å¹¶è½¬åŒ–ä¸ºç›®æ ‡æœºå™¨ä»£ç ï¼Œå¯¹äºä¸ºä»€ä¹ˆéœ€è¦ ä¸­é—´ä»£ç è¿™ä¸ªä¸œè¥¿ï¼Œçœ‹ä¸ªå›¾å°±ä¸€ç›®äº†ç„¶å•¦ï¼ˆIRï¼šintermediate representationä¸­é—´è¡¨ç¤ºï¼‰</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/build_ä¸­é—´ä»£ç .png?raw=true" alt="ä¸­é—´ä»£ç "></p>
<h3 id="æ±‡ç¼–"><a href="#æ±‡ç¼–" class="headerlink" title="æ±‡ç¼–"></a>æ±‡ç¼–</h3><p>ç›®æ ‡ä»£ç éœ€è¦ç»è¿‡æ±‡ç¼–å™¨å¤„ç†ï¼Œæ‰èƒ½å˜æˆæœºå™¨ä¸Šå¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤ã€‚ç”Ÿæˆå¯¹åº”çš„<code>.o</code>æ–‡ä»¶</p>
<h3 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h3><p>é“¾æ¥å™¨ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯é™æ€é“¾æ¥å™¨ï¼‰å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨ OS X å’Œ iOSä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ <code>Mach-O</code> ã€‚é“¾æ¥å‘¢ï¼Œåˆåˆ†ä¸ºé™æ€é“¾æ¥å’ŒåŠ¨æ€é“¾æ¥</p>
<p>é™æ€é“¾æ¥ï¼šåœ¨ç¼–è¯‘é“¾æ¥æœŸé—´å‘æŒ¥ä½œç”¨ï¼ŒæŠŠç›®æ ‡æ–‡ä»¶å’Œé™æ€åº“ä¸€èµ·é“¾æ¥å½¢æˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/build_é“¾æ¥è¿‡ç¨‹.png?raw=true" alt="é“¾æ¥è¿‡ç¨‹"></p>
<p>åŠ¨æ€é“¾æ¥ï¼šé“¾æ¥è¿‡ç¨‹æ¨è¿Ÿåˆ°è¿è¡Œæ—¶å†è¿›è¡Œã€‚å¯¹äºåŠ¨æ€é“¾æ¥å’Œé™æ€é“¾æ¥ï¼Œå„æœ‰åƒç§‹ã€‚</p>
<h3 id="ä»£ç ç­¾å"><a href="#ä»£ç ç­¾å" class="headerlink" title="ä»£ç ç­¾å"></a>ä»£ç ç­¾å</h3><p>æˆ‘ä»¬æ¯æ¬¡ <code>build</code> ä¹‹åï¼Œéƒ½ä¼šå‘ç°å·¥ç¨‹ç›®å½•ä¸‹å¤šäº†ä¸€ä¸ª <code>.app</code> æ–‡ä»¶ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/build_ä»£ç ç­¾å.png?raw=true" alt="ä»£ç ç­¾å"></p>
<p>åœ¨ <code>.app</code> ç›®å½•ä¸­ï¼Œæœ‰åˆä¸€ä¸ªå« <code>_CodeSignature</code> çš„å­ç›®å½•ï¼Œè¿™æ˜¯ä¸€ä¸ª  <code>plist</code> æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†ç¨‹åºçš„ä»£ç ç­¾åï¼Œä½ çš„ç¨‹åºä¸€æ—¦ç­¾åï¼Œå°±æ²¡æœ‰åŠæ³•æ›´æ”¹å…¶ä¸­çš„ä»»ä½•ä¸œè¥¿ï¼ŒåŒ…æ‹¬èµ„æºæ–‡ä»¶ï¼Œå¯æ‰§è¡Œæ–‡ä»¶ç­‰ï¼ŒiOSç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªç­¾åã€‚</p>
<p>ç­¾åè¿‡ç¨‹æœ¬èº«æ˜¯ç”±å‘½ä»¤è¡Œå·¥å…· <code>codesign</code> æ¥å®Œæˆçš„ã€‚å¦‚æœä½ åœ¨ Xcode ä¸­build ä¸€ä¸ªåº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨æ„å»ºå®Œæˆä¹‹åä¼šè‡ªåŠ¨è°ƒç”¨ <code>codesign</code> å‘½ä»¤è¿›è¡Œç­¾åï¼Œè¿™ä¹Ÿæ˜¯ Link ä¹‹åçš„ä¸€ä¸ªå…³é”®æ­¥éª¤ã€‚</p>
<h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><p>åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œ<code>dyld</code>ï¼ˆåŠ¨æ€é“¾æ¥å™¨ï¼‰ èµ·äº†å¾ˆé‡è¦çš„ä½œç”¨ï¼Œè¿›è¡ŒåŠ¨æ€é“¾æ¥ï¼Œè¿›è¡Œç¬¦å·å’Œåœ°å€çš„ä¸€ä¸ªç»‘å®šã€‚</p>
<p><code>dyld</code> ä¸»è¦åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ä¸»è¦åšäº†ä»¥ä¸‹äº‹æƒ…ï¼š</p>
<ul>
<li>åŠ è½½æ‰€ä¾èµ–çš„ <code>dylibs</code></li>
</ul>
<ul>
<li><code>Fix-ups</code>ï¼šRebase ä¿®æ­£åœ°å€åç§»ï¼Œå› ä¸º OS Xå’Œ iOS é€šè¿‡ <code>ASLR</code> æ¥åšåœ°å€åç§»ï¼ˆéšæœºåŒ–ï¼‰æ¥é¿å…æ”¶åˆ°æ”»å‡»</li>
<li><code>Fix-ups</code>ï¼šBindingç¡®å®š <code>Non-Lazy Pointer</code> åœ°å€ï¼Œè¿›è¡Œç¬¦å·åœ°å€ç»‘å®šã€‚</li>
<li><code>ObjC runtime</code> åˆå§‹åŒ–ï¼šåŠ è½½æ‰€æœ‰ç±»</li>
<li><code>Initializers</code> ï¼šæ‰§è¡Œ <code>load</code> æ–¹æ³•å’Œ <code>__attribute__((constructor))</code> ä¿®é¥°çš„å‡½æ•°</li>
</ul>
<h2 id="Buildè¿‡ç¨‹"><a href="#Buildè¿‡ç¨‹" class="headerlink" title="Buildè¿‡ç¨‹"></a>Buildè¿‡ç¨‹</h2><p>åœ¨é€‰æ‹©å·¥ç¨‹åä¼šå‡ºç°ä¸‹é¢è¿™æ ·çš„å‡ ä¸ªé€‰é¡¹ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/buildè¿‡ç¨‹.png?raw=true" alt="buildè¿‡ç¨‹"></p>
<h3 id="Build-Phases"><a href="#Build-Phases" class="headerlink" title="Build Phases"></a>Build Phases</h3><p>Build Phases ä»£è¡¨ç€å°†ä»£ç è½¬å˜ä¸ºå¯æ‰§è¡Œæ–‡ä»¶çš„æœ€é«˜çº§åˆ«è§„åˆ™ã€‚é‡Œé¢æè¿°äº† build è¿‡ç¨‹ä¸­å¿…é¡»æ‰§è¡Œçš„ä¸åŒç±»å‹è§„åˆ™ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/build_buildè¿‡ç¨‹.png?raw=true" alt="build phases"></p>
<p>é¦–å…ˆæ˜¯ target ä¾èµ–é¡¹çš„æ„å»ºã€‚è¿™é‡Œä¼šå‘Šè¯‰ build ç³»ç»Ÿï¼Œbuild å½“å‰çš„ target ä¹‹å‰ï¼Œå¿…é¡»å…ˆå¯¹è¿™é‡Œçš„ä¾èµ–æ€§è¿›è¡Œ buildã€‚å®é™…ä¸Šè¿™å¹¶ä¸å±äºçœŸæ­£çš„ build phaseï¼Œåœ¨è¿™é‡Œï¼ŒXcode åªä¸è¿‡å°†å…¶ä¸ build phase æ˜¾ç¤ºåˆ°ä¸€å—ç½¢äº†ã€‚</p>
<p>æ¥ç€åœ¨ build phaseä¸­æ˜¯ä¸€ä¸ª CocoaPods ç›¸å…³çš„è„šæœ¬ <em>script execution</em> ã€‚æ¥ç€åœ¨ Compile Sources section ä¸­è§„å®šäº†æ‰€æœ‰å¿…é¡»å‚ä¸ç¼–è¯‘çš„æ–‡ä»¶ã€‚æ­¤å¤„åˆ—å‡ºçš„æ‰€æœ‰æ–‡ä»¶å°†æ ¹æ®ç›¸å…³çš„ rules å’Œ settings è¢«å¤„ç†ã€‚</p>
<p>å½“ç¼–è¯‘ç»“æŸä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°†ç¼–è¯‘æ‰€ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶é“¾æ¥åˆ°ä¸€å—ã€‚æ³¨æ„è§‚å¯Ÿï¼ŒXcode ä¸­çš„ build phase ä¹‹åæ˜¯ï¼šâ€Link Binary with Libraries.â€ è¿™é‡Œé¢åˆ—å‡ºäº†æ‰€æœ‰çš„é™æ€åº“å’ŒåŠ¨æ€åº“ï¼Œè¿™äº›åº“ä¼šå‚ä¸ä¸Šé¢ç¼–è¯‘é˜¶æ®µç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œé“¾æ¥ã€‚</p>
<p>å½“é“¾æ¥å®Œæˆä¹‹åï¼Œbuild phase ä¸­æœ€åéœ€è¦å¤„ç†çš„å°±æ˜¯å°†é™æ€èµ„æºï¼ˆä¾‹å¦‚å›¾ç‰‡å’Œå­—ä½“ï¼‰æ‹·è´åˆ° app bundle ä¸­ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå›¾ç‰‡èµ„æºæ˜¯PNGæ ¼å¼ï¼Œé‚£ä¹ˆä¸ä»…ä»…å¯¹å…¶è¿›è¡Œæ‹·è´ï¼Œè¿˜ä¼šåšä¸€äº›ä¼˜åŒ–ã€‚</p>
<p>è™½ç„¶é™æ€èµ„æºçš„æ‹·è´æ˜¯ build phase ä¸­çš„æœ€åä¸€æ­¥ï¼Œä½† build è¿˜æ²¡æœ‰å®Œæˆã€‚ä¾‹å¦‚ï¼Œè¿˜æ²¡æœ‰è¿›è¡Œ code signing ï¼ˆè¿™å¹¶ä¸æ˜¯ build phase è€ƒè™‘çš„èŒƒç•´ï¼‰ï¼Œcode signing å±äº build æ­¥éª¤ä¸­çš„æœ€åä¸€æ­¥ â€œPackagingâ€ã€‚</p>
<h3 id="Build-Rules"><a href="#Build-Rules" class="headerlink" title="Build Rules"></a>Build Rules</h3><p>Build rules æŒ‡å®šäº†ä¸åŒçš„æ–‡ä»¶ç±»å‹è¯¥å¦‚ä½•ç¼–è¯‘ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¼€å‘è€…å¹¶ä¸éœ€è¦ä¿®æ”¹è¿™é‡Œé¢çš„å†…å®¹ã€‚å¦‚æœä½ éœ€è¦å¯¹ç‰¹å®šç±»å‹çš„æ–‡ä»¶æ·»åŠ å¤„ç†æ–¹æ³•ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨æ­¤å¤„æ·»åŠ ä¸€æ¡æ–°çš„è§„åˆ™ã€‚ä¸€æ¡ build rule æŒ‡å®šäº†å…¶åº”ç”¨äºå“ªç§ç±»å‹æ–‡ä»¶ï¼Œè¯¥ç±»å‹æ–‡ä»¶æ˜¯å¦‚ä½•è¢«å¤„ç†çš„ï¼Œä»¥åŠè¾“å‡ºçš„å†…å®¹è¯¥å¦‚ä½•å¤„ç½®ã€‚</p>
<h3 id="Build-Settings"><a href="#Build-Settings" class="headerlink" title="Build Settings"></a>Build Settings</h3><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»äº†è§£åˆ°åœ¨ build phases ä¸­æ˜¯å¦‚ä½•å®šä¹‰ build å¤„ç†çš„è¿‡ç¨‹ï¼Œä»¥åŠ build rules æ˜¯å¦‚ä½•æŒ‡å®šå“ªäº›æ–‡ä»¶ç±»å‹åœ¨ç¼–è¯‘é˜¶æ®µéœ€è¦è¢«é¢„å¤„ç†ã€‚åœ¨ build settings ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®æ¯ä¸ªä»»åŠ¡çš„è¯¦ç»†å†…å®¹ã€‚</p>
<p>ä½ ä¼šå‘ç° build è¿‡ç¨‹çš„æ¯ä¸€ä¸ªé˜¶æ®µï¼Œéƒ½æœ‰è®¸å¤šé€‰é¡¹ï¼šä»ç¼–è¯‘ã€é“¾æ¥ä¸€ç›´åˆ° code signing å’Œ packagingã€‚æ³¨æ„ï¼Œsettings æ˜¯å¦‚ä½•è¢«åˆ†å‰²ä¸ºä¸åŒçš„éƒ¨åˆ† â€“ å…¶å®è¿™å¤§éƒ¨åˆ†ä¼šä¸ build phases æœ‰å…³è”ï¼Œæœ‰æ—¶å€™ä¹Ÿä¼šæŒ‡å®šç¼–è¯‘çš„æ–‡ä»¶ç±»å‹ã€‚</p>
<h3 id="å·¥ç¨‹æ–‡ä»¶"><a href="#å·¥ç¨‹æ–‡ä»¶" class="headerlink" title="å·¥ç¨‹æ–‡ä»¶"></a>å·¥ç¨‹æ–‡ä»¶</h3><p>ä¸Šé¢æˆ‘ä»¬ä»‹ç»çš„æ‰€æœ‰å†…å®¹éƒ½è¢«ä¿å­˜åœ¨å·¥ç¨‹æ–‡ä»¶ï¼ˆ<code>.pbxproj</code>ï¼‰ä¸­ï¼Œé™¤äº†å…¶å®ƒä¸€äº›å·¥ç¨‹ç›¸å…³ä¿¡æ¯ï¼ˆä¾‹å¦‚ file groupsï¼‰ï¼Œæˆ‘ä»¬å¾ˆå°‘ä¼šæ·±å…¥è¯¥æ–‡ä»¶å†…éƒ¨ï¼Œé™¤éåœ¨ä»£ç  merge æ—¶å‘ç”Ÿå†²çªï¼Œæˆ–è®¸ä¼šè¿›å»çœ‹çœ‹ã€‚</p>
<p>å¦‚æœç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ä¸€ä¸ªå·¥ç¨‹æ–‡ä»¶ï¼Œä»å¤´åˆ°å°¾çœ‹ä¸€éé‡Œé¢çš„å†…å®¹ã€‚å®ƒçš„å¯è¯»æ€§éå¸¸é«˜ï¼Œé‡Œé¢çš„è®¸å¤šå†…å®¹ä¸€çœ‹å°±çŸ¥é“ä»€ä¹ˆæ„æ€äº†ï¼Œä¸ä¼šå­˜åœ¨å¤ªå¤§çš„é—®é¢˜ã€‚é€šè¿‡é˜…è¯»å¹¶å®Œå…¨ç†è§£å·¥ç¨‹æ–‡ä»¶ï¼Œè¿™å¯¹äºåˆå¹¶å·¥ç¨‹æ–‡ä»¶çš„å†²çªéå¸¸æœ‰å¸®åŠ©ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ–‡ä»¶ä¸­å«åš rootObject çš„æ¡ç›®ã€‚åœ¨æˆ‘çš„å·¥ç¨‹ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rootObject = <span class="number">1793817</span>C17A9421F0078255E /* Project object *<span class="regexp">/;</span></div></pre></td></tr></table></figure>
<p>æ ¹æ®è¿™ä¸ª IDï¼ˆ1793817C17A9421F0078255Eï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ° main å·¥ç¨‹çš„å®šä¹‰ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/* Begin PBXProject section */</div><div class="line">    1793817C17A9421F0078255E /* Project object */ = &#123;</div><div class="line">        isa = PBXProject;</div><div class="line">...</div></pre></td></tr></table></figure>
<p>åœ¨è¿™éƒ¨åˆ†ä¸­æœ‰ä¸€äº› keysï¼Œé¡ºä»è¿™äº› keyï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°æ›´å¤šå…³äºè¿™ä¸ªå·¥ç¨‹æ–‡ä»¶çš„ç»„æˆã€‚ä¾‹å¦‚ï¼ŒmainGroup æŒ‡å‘äº† root file groupã€‚å¦‚æœä½ æŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œä½ å¯ä»¥å¿«é€Ÿäº†è§£åˆ°åœ¨ <code>.pbxproj</code> æ–‡ä»¶ä¸­å·¥ç¨‹çš„ç»“æ„ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">1BC1E1511ACBEFFA0042431B = &#123;</div><div class="line">	isa = PBXGroup;</div><div class="line">	children = (</div><div class="line">		B62C765C1D9B71D300CB2CD4 /* OKit.framework */,</div><div class="line">		230935DA1C4F3D9C0070A5B3 /* QiNiuManager.xcodeproj */,</div><div class="line">		23D1991E1C2B8FF600E1DE8A /* Debug.xcodeproj */,</div><div class="line">		0DD10D591C28FB4900ADF8E5 /* Track.xcodeproj */,</div><div class="line">		0D106DDC1BE70BF600C49E7B /* Interface.xcodeproj */,</div><div class="line">		0D106D761BE7052800C49E7B /* Model.xcodeproj */,</div><div class="line">		0DC641041C0D427A007025D5 /* Wallet.xcodeproj */,</div><div class="line">		0DC641A41C0D997C007025D5 /* Tool.xcodeproj */,</div><div class="line">		0DC641CA1C0D9ADB007025D5 /* Location.xcodeproj */,</div><div class="line">		1BC1E1631ACBEFFA0042431B /* Mike */,</div><div class="line">		1BC1E15C1ACBEFFA0042431B /* Frameworks */,</div><div class="line">		1BC1E15B1ACBEFFA0042431B /* Products */,</div><div class="line">		FF0DD481DA78D64E15039700 /* Pods */,</div><div class="line">	);</div><div class="line">	sourceTree = "&lt;group&gt;";</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ¥çœ‹ä¸€äº›ä¸ build è¿‡ç¨‹ç›¸å…³çš„å†…å®¹ã€‚å…¶ä¸­ target key æŒ‡å‘äº† build target çš„å®šä¹‰ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">targets = (</div><div class="line">	1BC1E1591ACBEFFA0042431B /* Mike */,</div><div class="line">);</div></pre></td></tr></table></figure>
<p>æ ¹æ®ç¬¬ä¸€ä¸ªå†…å®¹ï¼Œæˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ª target çš„å®šä¹‰ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">1BC1E1591ACBEFFA0042431B /* Mike */ = &#123;</div><div class="line">			isa = PBXNativeTarget;</div><div class="line">			buildConfigurationList = 1BC1E1861ACBEFFA0042431B /* Build configuration list for PBXNativeTarget "Mike" */;</div><div class="line">			buildPhases = (</div><div class="line">				E2E1BAED1E12657500A4F13C /* ShellScript */,</div><div class="line">				D328411202E8C8A158C68A9A /* [CP] Check Pods Manifest.lock */,</div><div class="line">				32F9C08DAB34C3D77A8CD59E /* [CP] Check Pods Manifest.lock */,</div><div class="line">				1BC1E1561ACBEFFA0042431B /* Sources */,</div><div class="line">				1BC1E1571ACBEFFA0042431B /* Frameworks */,</div><div class="line">				1BC1E1581ACBEFFA0042431B /* Resources */,</div><div class="line">				7C20CC96F9690C1C11011773 /* [CP] Embed Pods Frameworks */,</div><div class="line">				1DBEA7A742BF77DA6EC31CEB /* [CP] Copy Pods Resources */,</div><div class="line">				2337E6001BCDF5EC007659ED /* ShellScript */,</div><div class="line">				2CA588C55C8E11D9779AABF0 /* ğŸ“¦ Embed Pods Frameworks */,</div><div class="line">				789C695793C24ECAC7D8420E /* ğŸ“¦ Copy Pods Resources */,</div><div class="line">				B60684181D9924B00003E3E5 /* Embed Frameworks */,</div><div class="line">			);</div><div class="line">			buildRules = (</div><div class="line">			);</div><div class="line">			dependencies = (</div><div class="line">				230935E91C4F55B20070A5B3 /* PBXTargetDependency */,</div><div class="line">				23D199251C2B918700E1DE8A /* PBXTargetDependency */,</div><div class="line">				0DD10D601C28FB5D00ADF8E5 /* PBXTargetDependency */,</div><div class="line">				0DE3C0941C0F103000184463 /* PBXTargetDependency */,</div><div class="line">				0DE3C0921C0F102D00184463 /* PBXTargetDependency */,</div><div class="line">				2390C7521C0DB98B008C31B1 /* PBXTargetDependency */,</div><div class="line">				0D106DE41BE70C2600C49E7B /* PBXTargetDependency */,</div><div class="line">				0D106D7E1BE7060100C49E7B /* PBXTargetDependency */,</div><div class="line">			);</div><div class="line">			name = Mike;</div><div class="line">			productName = Mike;</div><div class="line">			productReference = 1BC1E15A1ACBEFFA0042431B /* Mike.app */;</div><div class="line">			productType = "com.apple.product-type.application";</div><div class="line">		&#125;;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ <code>buildConfigurationList</code> æŒ‡å‘äº†å¯ç”¨çš„é…ç½®é¡¹ï¼Œä¸€èˆ¬æ˜¯ Debug å’Œ Releaseã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">1BC1E1861ACBEFFA0042431B /* Build configuration list for PBXNativeTarget "Mike" */ = &#123;</div><div class="line">	isa = XCConfigurationList;</div><div class="line">	buildConfigurations = (</div><div class="line">		1BC1E1871ACBEFFA0042431B /* Debug */,</div><div class="line">		1BC1E1881ACBEFFA0042431B /* Release */,</div><div class="line">	);</div><div class="line">	defaultConfigurationIsVisible = 0;</div><div class="line">	defaultConfigurationName = Release;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æ ¹æ® debug å¯¹åº”çš„ idï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ° build setting tab ä¸­æ‰€æœ‰é€‰é¡¹å­˜å‚¨çš„ä½ç½®ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">1BC1E1871ACBEFFA0042431B /* Debug */ = &#123;</div><div class="line">			isa = XCBuildConfiguration;</div><div class="line">			baseConfigurationReference = 31FD03C25841C700BD562061 /* Pods-Mike.debug.xcconfig */;</div><div class="line">			buildSettings = &#123;</div><div class="line">              	ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon;</div><div class="line">				ASSETCATALOG_COMPILER_LAUNCHIMAGE_NAME = LaunchImage;</div><div class="line">				CLANG_CXX_LANGUAGE_STANDARD = "compiler-default";</div><div class="line">				CLANG_CXX_LIBRARY = "compiler-default";</div><div class="line">				CLANG_ENABLE_OBJC_ARC = YES;</div><div class="line">              ...</div></pre></td></tr></table></figure>
<p><code>buildPhases</code> å±æ€§åˆ™ç®€å•çš„åˆ—å‡ºäº†åœ¨ Xcode ä¸­å®šä¹‰çš„æ‰€æœ‰ <code>build phases</code>ã€‚è¿™éå¸¸å®¹æ˜“è¯†åˆ«å‡ºæ¥ï¼ˆXcode ä¸­çš„å‚æ•°ä½¿ç”¨äº†å®ƒä»¬åŸæœ¬çœŸæ­£çš„åå­—ï¼Œå¹¶ä»¥ C é£æ ¼è¿›è¡Œæ³¨é‡Šï¼‰ã€‚<code>buildRules</code> å±æ€§æ˜¯ç©ºçš„ï¼šå› ä¸ºåœ¨è¯¥å·¥ç¨‹ä¸­ï¼Œæˆ‘æ²¡æœ‰è‡ªå®šä¹‰ <code>build rules</code>ã€‚<code>dependencies</code> åˆ—å‡ºäº†åœ¨ <code>Xcode build phase tab</code> ä¸­åˆ—å‡ºçš„ target ä¾èµ–é¡¹ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[React-Native å¦‚ä½•åˆ›å»ºåŸç”Ÿ View æºç è§£æ]]></title>
      <url>http://zhang759740844.github.io/2017/01/24/RN%E6%98%BE%E7%A4%BA%E5%8E%9F%E7%90%86/</url>
      <content type="html"><![CDATA[<p>å‰ä¸€ç¯‡ï¼Œä¸»è¦è®²äº† RN å¦‚ä½•åˆå§‹åŒ–ä¸€ä¸ª <code>BCTBatchedBridge</code>ï¼Œè¿™ä¸€ç¯‡å°†è¿›ä¸€æ­¥ç ”ç©¶ RN æ˜¯å¦‚ä½•é€šè¿‡è¿™ä¸ª bridge åˆ›å»ºå‡ºçœŸæ­£å±•ç¤ºå‡ºæ¥çš„ View çš„ã€‚</p>
<a id="more"></a>
<p>é¦–å…ˆæŠ›å‡ºç»“è®ºï¼šæ¯ä¸€ä¸ª js <code>render()</code> æ–¹æ³•ä¸­çš„ component éƒ½å¯¹åº”äº native ä¸­çš„ä¸€ä¸ª <code>RCTView</code>ã€‚åœ¨æ¸²æŸ“å‰ï¼Œjs ä¼šå¾ªç¯å–å‡ºå„ä¸ª component ã€‚ç„¶åé€šè¿‡ <code>UIManager</code> ï¼ˆ<code>NativeModules</code> ä¸­çš„ä¸€é¡¹ï¼‰ çš„ <code>createView</code> æ–¹æ³•ï¼Œé€šè¿‡ <code>BatchedBridge</code> è°ƒç”¨ native ç«¯çš„ <code>RCTUIManager</code> çš„åŒåæ–¹æ³•ï¼Œåˆ›å»ºä¸ component ç›¸å¯¹åº”çš„ç±»ã€‚å¯¹äºè§¦æ‘¸äº‹ä»¶ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚native ç«¯é€šè¿‡ bridge å°†è§¦æ‘¸äº‹ä»¶ä¼ ç»™ jsï¼Œjs åœ¨æ‰¾åˆ°å¯¹åº” component åï¼Œå“åº”å„ä¸ªè§¦æ‘¸äº‹ä»¶ã€‚</p>
<p>ä¸‹é¢å°†åˆ†å‡ ä¸ªé˜¶æ®µè§£è¯» RN æ˜¯å¦‚ä½•æ˜¾ç¤ºå‡ºæ¥çš„ï¼Œä¾æ—§æ˜¯ 0.39 ç‰ˆæœ¬ã€‚æœ€å¥½åœ¨ç†è§£äº†å‰ä¸€ç¯‡ RN é€šä¿¡åŸç†åå†çœ‹ã€‚</p>
<h2 id="native-è°ƒç”¨-js"><a href="#native-è°ƒç”¨-js" class="headerlink" title="native è°ƒç”¨ js"></a>native è°ƒç”¨ js</h2><p>è¿™æ˜¯æ•´ä¸ªè¿‡ç¨‹çš„ç¬¬ä¸€æ­¥ï¼Œä» <code>RCTRootView *rootView = [[RCTRootView alloc] initWithBridge:_bridge moduleName:moduleName initialProperties:param];</code> æ–¹æ³•å¼€å§‹ã€‚native å‘Šè¯‰ js æˆ‘è¦å‡†å¤‡æ˜¾ç¤º view äº†ï¼Œå¿«ç‚¹æŠŠä½ è¿™é‡Œå„ä¸ª view çš„ä¿¡æ¯å‘Šè¯‰æˆ‘ã€‚å…ˆæ¥çœ‹ä¸€å¼ è°ƒç”¨æµç¨‹å›¾ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/RN_nativecalljs.png?raw=true" alt="RN nativeè°ƒç”¨js"></p>
<h3 id="tag1"><a href="#tag1" class="headerlink" title="tag1"></a>tag1</h3><p>è¿™ä¸ª <code>setBridge</code> æ–¹æ³•æ˜¯åˆå§‹åŒ–æ—¶å€™æ‰§è¡Œçš„æ–¹æ³•ã€‚è¿˜è®°å¾—å‰ä¸€ç¯‡åˆå§‹åŒ–çš„æ—¶å€™å…¶ä¸­çš„ä¸€æ­¥è®¾ç½®å„ä¸ª <code>RCTModuleData</code> çš„ <code>instance</code> ä¹ˆï¼Ÿå…¶ä¸­å°±ä¼šè°ƒç”¨ <code>setBridge</code> æ–¹æ³•ä¸ºæ¯ä¸ª RCTModuleData çš„ <code>instance</code> è®¾ç½® bridgeã€‚åœ¨ <code>RCTUIManager</code> ç±»çš„ <code>setBridge</code> æ–¹æ³•ä¸­è¿˜åšäº†ä¸€äº›å…¶ä»–æ“ä½œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">- (void)setBridge:(RCTBridge *)bridge&#123;</div><div class="line">  ...</div><div class="line">      NSMutableDictionary *componentDataByName = [NSMutableDictionary new];</div><div class="line">      for (Class moduleClass in _bridge.moduleClasses) &#123;</div><div class="line">    	if ([moduleClass isSubclassOfClass:[RCTViewManager class]]) &#123;</div><div class="line">          RCTComponentData *componentData = [[RCTComponentData alloc] initWithManagerClass:moduleClass bridge:_bridge];</div><div class="line">          componentDataByName[componentData.name] = componentData;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      _componentDataByName = [componentDataByName copy];</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•å¾ªç¯éå† bridge ä¸­çš„æ¯ä¸€ä¸ªæš´éœ²ç»™ js çš„æ¨¡å—åï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯ <code>RCTViewManager</code> çš„å­ç±»ã€‚å¦‚æœæ˜¯ï¼Œåˆ™ä¸ºå…¶åˆ›å»ºä¸€ä¸ª <code>RCTComponentData</code> å¹¶å°†å…¶ä¿å­˜åœ¨ <code>_componentDataByName</code> å­—å…¸ä¸­ã€‚<code>RCTViewManager</code> æ˜¯å„ä¸ª <code>RCTView</code> çš„æ§åˆ¶å™¨çš„çˆ¶ç±»ï¼Œæ‰€æœ‰ <code>RCTView</code> çš„æ–¹æ³•éƒ½åœ¨ <code>RCTViewManager</code> çš„å­ç±»é‡Œå®ç°ã€‚è¿™æ ·å°±æŠŠæ‰€æœ‰è§†å›¾æ§åˆ¶å™¨ä¿å­˜åœ¨äº† <code>RCTUIManager</code> ä¸­ã€‚</p>
<h3 id="tag2"><a href="#tag2" class="headerlink" title="tag2"></a>tag2</h3><p>çœ‹åˆ°è¿™ä¸ªæ–¹æ³•çš„åå­—å°±çŸ¥é“æ˜¯åœ¨ bundle åŠ è½½å®Œæˆåæ‰§è¡Œçš„ã€‚ è¿™ä¸ªæ–¹æ³•åˆ†ä¸ºä¸¤æ­¥ã€‚ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ª <code>_contentView</code> ç”¨æ¥å®¹çº³å„ä¸ª componentã€‚ç¬¬äºŒæ­¥å°±æ˜¯é€šè¿‡ <code>BatchedBridge</code> è°ƒç”¨ js çš„æ–¹æ³•äº†ã€‚éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)bundleFinishedLoading:(RCTBridge *)bridge</div><div class="line">&#123;</div><div class="line">  ...</div><div class="line">  _contentView = [[RCTRootContentView alloc] initWithFrame:<span class="keyword">self</span>.bounds</div><div class="line">                                                    bridge:bridge</div><div class="line">                                                  reactTag:<span class="keyword">self</span>.reactTag</div><div class="line">                                            sizeFlexiblity:_sizeFlexibility];</div><div class="line">  [<span class="keyword">self</span> runApplication:bridge];</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­æœ‰ä¸€ä¸ªåœ°æ–¹éœ€è¦è¯´æ˜ï¼Œå°±æ˜¯è¿™é‡Œé¢çš„ <code>self.reactTag</code>ã€‚ç±»ä¼¼äº RN é€šä¿¡çš„åŸç†ï¼Œ<code>reactTag</code> æ˜¯ native å’Œ js è¯†åˆ«å„ä¸ª component çš„æ ‡è®°ã€‚æ¥çœ‹ä¸€ä¸‹ <code>reactTag</code> çš„ getter æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSNumber</span> *)reactTag</div><div class="line">&#123;</div><div class="line">  RCTAssertMainQueue();</div><div class="line">  <span class="keyword">if</span> (!<span class="keyword">super</span>.reactTag) &#123;</div><div class="line">    <span class="keyword">self</span>.reactTag = [_bridge.uiManager allocateRootTag];</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">super</span>.reactTag;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">NSNumber</span> *)allocateRootTag</div><div class="line">&#123;</div><div class="line">  <span class="built_in">NSNumber</span> *rootTag = objc_getAssociatedObject(<span class="keyword">self</span>, _cmd) ?: @<span class="number">1</span>;</div><div class="line">  objc_setAssociatedObject(<span class="keyword">self</span>, _cmd, @(rootTag.integerValue + <span class="number">10</span>), OBJC_ASSOCIATION_RETAIN_NONATOMIC);</div><div class="line">  <span class="keyword">return</span> rootTag;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¯ä¸€ä¸ªæ ¹è§†å›¾éƒ½å¿…é¡»æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ <code>ractTag</code>ã€‚è¿™ä¸ª tag ä»1å¼€å§‹ï¼Œæ¯æ¬¡è‡ªå¢10ï¼Œä¹Ÿå°±æ˜¯ 1ï¼Œ11ï¼Œ21ï¼Œ31â€¦çš„å½¢å¼ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p>è¿™é‡Œè¦åæ§½ä¸€ä¸‹ facebook çš„ç¨‹åºå‘˜ã€‚æ²¡æƒ³åˆ°å¤–å›½çš„ç¨‹åºå‘˜ä¹Ÿä¼šæŠŠå•è¯æ‹¼é”™ã€‚ä¸Šé¢æ–¹æ³•ä¸­ <code>sizeFlexiblity</code> å°‘äº†ä¸ª <code>i</code>ã€‚è¿™æ˜¯è¦è¾“å…¥æ³•èƒŒé”…ä¹ˆï¼Ÿ</p>
<h3 id="tag3"><a href="#tag3" class="headerlink" title="tag3"></a>tag3</h3><p>è¯¥æ–¹æ³•é¦–å…ˆä¸º <code>rootView</code> æ–°å»ºäº† <code>RCTTouchHandler</code> å®ä¾‹ï¼Œå¹¶è®¾ç½®ä¸ºå…¶ <code>GestureRecognizer</code>ã€‚å…¶æ¬¡æ‰§è¡Œäº† <code>registerRootView:withSizeFlexibility:</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å°† <code>rootView</code> ä¿å­˜åœ¨ <code>RCTUIManager</code> çš„ <code>_viewRegistry</code> å­—å…¸ä¸­ï¼Œå…¶ä¸­é”®æ˜¯ <code>rootView</code> çš„ <code>reactTag</code>ã€‚æ­¤æ—¶ï¼Œ<code>RCTUIManager</code> ä¸­è®¾ç½®å¹¶ä¿å­˜å¥½äº†ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„å­—å…¸ï¼š<code>_viewRegistry</code>,<code>_componentDataByName</code>ã€‚</p>
<h3 id="tag4"><a href="#tag4" class="headerlink" title="tag4"></a>tag4</h3><p>è¿™ä¸ªæ–¹æ³•å°±æ¯”è¾ƒç›´è§‚äº†ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)runApplication:(RCTBridge *)bridge</div><div class="line">&#123;</div><div class="line">  <span class="built_in">NSString</span> *moduleName = _moduleName ?: <span class="string">@""</span>;</div><div class="line">  <span class="built_in">NSDictionary</span> *appParameters = @&#123;</div><div class="line">    <span class="string">@"rootTag"</span>: _contentView.reactTag,</div><div class="line">    <span class="string">@"initialProps"</span>: _appProperties ?: @&#123;&#125;,</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  RCTLogInfo(<span class="string">@"Running application %@ (%@)"</span>, moduleName, appParameters);</div><div class="line">  [bridge enqueueJSCall:<span class="string">@"AppRegistry"</span></div><div class="line">                 method:<span class="string">@"runApplication"</span></div><div class="line">                   args:@[moduleName, appParameters]</div><div class="line">             completion:<span class="literal">NULL</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å°±æ˜¯è°ƒç”¨ <code>enqueueJSCall:method:args:completion:</code> æ–¹æ³•ã€‚å¦‚æœå‰ä¸€ç¯‡çœ‹æ‡‚äº†çš„è¯ï¼Œå°±ä¼šçŸ¥é“ï¼Œè¿™ä¸ªæ–¹æ³•è°ƒç”¨çš„æ˜¯ js ç«¯ <code>AppRegistry.js</code> çš„ <code>runApplication</code> æ–¹æ³•ï¼Œéœ€è¦åˆ›å»ºçš„ <code>rootView</code> ä»¥ String çš„æ–¹å¼é€šè¿‡ <code>moduleName</code> ä¼ å…¥ã€‚</p>
<p>åˆ°è¿™ä¸€æ­¥ï¼ŒNative è°ƒç”¨ JS å°±ç»“æŸäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ js ç«¯çš„æ‰§è¡Œã€‚</p>
<h2 id="js-è°ƒç”¨-native"><a href="#js-è°ƒç”¨-native" class="headerlink" title="js è°ƒç”¨ native"></a>js è°ƒç”¨ native</h2><p>js ç«¯çš„æ–¹æ³•è°ƒç”¨è¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ã€‚æ¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„æµç¨‹å›¾ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/RN_jscallnative.png?raw=true" alt="RN nativeè°ƒç”¨js"></p>
<h3 id="tag1-1"><a href="#tag1-1" class="headerlink" title="tag1"></a>tag1</h3><p>åœ¨ native è°ƒç”¨ <code>enqueueJSCall:method:args:completion</code> åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ <code>AppRegistry</code> çš„ <code>runApplication</code> æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> runApplication: <span class="function"><span class="keyword">function</span>(<span class="params">appKey: string, appParameters: any</span>): <span class="title">void</span> </span>&#123;</div><div class="line">...</div><div class="line">   runnables[appKey].run(appParameters);</div><div class="line"> &#125;,</div></pre></td></tr></table></figure>
<p><code>appKey</code> å°±æ˜¯ä¸Šé¢çš„ <code>moduleName</code>ï¼Œé€šè¿‡å®ƒæ‹¿åˆ° <code>runnables</code> å­—å…¸ä¸­å¯¹åº”çš„å¯¹è±¡ï¼Œæ‰§è¡Œå…¶ <code>run</code> æ–¹æ³•ã€‚è¿™ä¸ªå­—å…¸æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿå¾€ä¸‹çœ‹ã€‚</p>
<h3 id="tag2-1"><a href="#tag2-1" class="headerlink" title="tag2"></a>tag2</h3><p>RN çš„å®˜æ–¹æ–‡æ¡£ä¸­ç¬¬ä¸€ç¯‡å°±è¯´æ˜äº†ï¼Œåœ¨å®šä¹‰å¥½ä¸€ä¸ª component åï¼Œéœ€è¦åœ¨ <code>index.ios.js</code> ä¸­ä½¿ç”¨ <code>AppRegistry.registerComponent()</code> æ–¹æ³•æ³¨å†Œ:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> HelloWorldView <span class="keyword">from</span> <span class="string">'./app/view/HelloWorldView'</span>;</div><div class="line">AppRegistry.registerComponent(<span class="string">'HelloWorldView'</span>, () =&gt; HelloWorldView);</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆ <code>registerComponent</code> åšäº†ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">registerComponent: <span class="function"><span class="keyword">function</span>(<span class="params">appKey: string, getComponentFunc: ComponentProvider</span>): <span class="title">string</span> </span>&#123;</div><div class="line">  runnables[appKey] = &#123;</div><div class="line">    run: (appParameters) =&gt;</div><div class="line">      renderApplication(getComponentFunc(), appParameters.initialProps, appParameters.rootTag)</div><div class="line">  &#125;;</div><div class="line">  <span class="keyword">return</span> appKey;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå°±è®¾ç½®äº†å‰é¢ç”¨åˆ°çš„ <code>runnables</code> å­—å…¸ï¼Œå¹¶ä¸”ä¸ºå­—å…¸å†…å¯¹è±¡åˆ›å»ºäº† <code>run</code> æ–¹æ³•ã€‚å‰é¢æ‰§è¡Œçš„ <code>run</code> æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯æ‰§è¡Œ <code>renderApplication</code> æ–¹æ³•ã€‚<code>renderApplication</code> åœ¨ RootView å¤–å±‚åˆåµŒå¥—äº†ä¸€å±‚ <code>AppContainer</code>ã€‚</p>
<h3 id="tag3-1"><a href="#tag3-1" class="headerlink" title="tag3"></a>tag3</h3><p>è¿™ä¸ªæ–¹æ³•å†…éƒ¨å°±æ¯”è¾ƒå¤æ‚äº†ã€‚å…¶ä¸­:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> instance = instantiateReactComponent(nextWrappedElement, <span class="literal">false</span>);</div></pre></td></tr></table></figure>
<p>é€šè¿‡ <code>instantiateReactComponent</code> æ–¹æ³•å°†æ•´ä¸ª View çš„ JSX è½¬æ¢ä¸º <code>ReactCompositeComponentWrapper</code> å®ä¾‹ã€‚è¿™ä¹Ÿå°±æ˜¯ Reactjs çš„ç²¾é«“ä¹‹ä¸€ã€‚å¥½å§ã€‚å¹¶æ²¡æœ‰èŠ±æ—¶é—´å»ç»†è¯»ï¼Œè‡£å¦¾åšä¸åˆ°å•Šã€‚æœ‰å…´è¶£çš„è¯å¯ä»¥æ‰¾æ‰¾ç±»ä¼¼äº <a href="http://purplebamboo.github.io/2015/09/15/reactjs_source_analyze_part_one/" target="_blank" rel="external">reactjsæºç åˆ†æ-ä¸Šç¯‡ï¼ˆé¦–æ¬¡æ¸²æŸ“å®ç°åŸç†ï¼‰</a> çš„æ–‡ç« å­¦ä¹ ä¸€ä¸‹ã€‚ä¹‹åå°±æ˜¯é•¿é•¿çš„è°ƒç”¨æ ˆäº†ï¼Œå¾ªç¯é€’å½’æ¯ä¸€ä¸ª component æ‰§è¡Œ <code>createView</code>ã€‚</p>
<h3 id="tag4-1"><a href="#tag4-1" class="headerlink" title="tag4"></a>tag4</h3><p>åœ¨ <code>ReactNativeBaseComponent.js</code> ä¸­è°ƒç”¨äº† <code>UIManager.createView()</code>ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•ç‚¹ä¸è¿›å»ï¼Œ<code>UIManager.js</code> ä¸­æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ã€‚å¼€å§‹æˆ‘æ¯”è¾ƒè¿·æƒ‘ï¼Œåæ¥ç»†è¯»äº†ä¸€ä¸‹å‘ç°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; UIManager &#125; = NativeModules;</div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ª <code>UIManager</code> æ˜¯ native ä¸­çš„ä¸€ä¸ª moduleï¼Œè¿™ä¸ª <code>createView()</code> æ˜¯ native ä¸­æš´éœ²å‡ºæ¥çš„ä¸€ä¸ªæ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">UIManager.createView(</div><div class="line">  tag,</div><div class="line">  <span class="keyword">this</span>.viewConfig.uiViewClassName,</div><div class="line">  nativeTopRootTag,</div><div class="line">  updatePayload</div><div class="line">);</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•ä¼šå°†å½“å‰ component çš„æ ‡è®°ï¼Œåå­—ï¼Œæ ¹æ ‡è®°ï¼Œå±æ€§æ–¹æ³•ç­‰ä¸€èµ·ä¼ ç»™ nativeã€‚å…¶ä¸­ <code>tag</code> æ˜¯ <code>ReactNativeTagHandles.allocateTag()</code> ç”Ÿæˆçš„ã€‚æ¯æ¬¡è°ƒç”¨è¯¥æ–¹æ³•ï¼Œ<code>tag</code> éƒ½ä¼šåŠ ä¸€ï¼ˆä¼šç•¥è¿‡1ç»“å°¾çš„ï¼Œé‚£äº›æ˜¯ç•™ç»™æ ¹ component çš„ï¼‰ã€‚</p>
<p>è‡³æ­¤ï¼Œjs è°ƒç”¨ native çš„éƒ¨åˆ†å°±ç»“æŸäº†ã€‚å›é¡¾ä¸€ä¸‹ï¼Œä¸»è¦å°±æ˜¯å¾ªç¯æ¯ä¸€ä¸ª componentï¼Œä¸ºæ¯ä¸ª component åˆ†é…ä¸€ä¸ªç‹¬æœ‰çš„ <code>tag</code> ç„¶åè°ƒç”¨ <code>createView</code> æ–¹æ³•ã€‚</p>
<h2 id="Native-createView-çš„è¿‡ç¨‹"><a href="#Native-createView-çš„è¿‡ç¨‹" class="headerlink" title="Native createView çš„è¿‡ç¨‹"></a>Native createView çš„è¿‡ç¨‹</h2><p>æ¥åˆ° nativeï¼Œ<code>RCTUIManager</code> æš´éœ²å‡ºäº†è®¸å¤šæ–¹æ³•ä¾› js è°ƒç”¨ã€‚æ¥çœ‹ä¸€ä¸‹åˆšæ‰ js è°ƒç”¨çš„ <code>createView</code> æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">RCT_EXPORT_METHOD(createView:(<span class="keyword">nonnull</span> <span class="built_in">NSNumber</span> *)reactTag</div><div class="line">                  viewName:(<span class="built_in">NSString</span> *)viewName</div><div class="line">                  rootTag:(__unused <span class="built_in">NSNumber</span> *)rootTag</div><div class="line">                  props:(<span class="built_in">NSDictionary</span> *)props)</div><div class="line">&#123;</div><div class="line">  RCTComponentData *componentData = _componentDataByName[viewName];</div><div class="line">  ...</div><div class="line">  __<span class="keyword">weak</span> RCTUIManager *weakManager = <span class="keyword">self</span>;</div><div class="line">  <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">    RCTUIManager *uiManager = weakManager;</div><div class="line">    <span class="keyword">if</span> (!uiManager) &#123;</div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">UIView</span> *view = [componentData createViewWithTag:reactTag];</div><div class="line">    <span class="keyword">if</span> (view) &#123;</div><div class="line">      [componentData setProps:props forView:view]; <span class="comment">// Must be done before bgColor to prevent wrong default</span></div><div class="line">      ...</div><div class="line">      uiManager-&gt;_viewRegistry[reactTag] = view;</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>_componentDataByName</code> ä¸Šé¢ä»‹ç»è¿‡äº†ï¼Œå¯ä»¥æ‹¿åˆ°å‰é¢ä¿å­˜çš„ js å°†è¦åˆ›å»ºçš„ view çš„ <code>RCTComponentData</code>ã€‚ç„¶ååœ¨ä¸»çº¿ç¨‹ä¸­ä½¿ç”¨ <code>createViewWithTag:</code> æ–¹æ³•åˆ›å»º Viewã€‚é€šè¿‡ <code>RCTComponentData</code> ä¸­ä¿å­˜çš„ <code>_managerClass</code> å¯ä»¥æ‹¿åˆ°å¯¹åº” View çš„ <code>manager</code>ï¼Œç„¶åè°ƒç”¨å…¶ <code>view</code> æ–¹æ³•åˆ›å»º viewã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UIView</span> *)createViewWithTag:(<span class="built_in">NSNumber</span> *)tag</div><div class="line">&#123;</div><div class="line">  <span class="built_in">UIView</span> *view = [<span class="keyword">self</span>.manager view];</div><div class="line">  view.reactTag = tag;</div><div class="line">	...</div><div class="line">  <span class="keyword">return</span> view;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (RCTViewManager *)manager</div><div class="line">&#123;</div><div class="line">  <span class="keyword">if</span> (!_manager) &#123;</div><div class="line">    _manager = [_bridge moduleForClass:_managerClass];</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> _manager;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é€šè¿‡ <code>setProps:forView:</code> æ–¹æ³•å°†æ¯ä¸ª view çš„ props ä¿å­˜ä¸‹æ¥ã€‚è¿™é‡Œåˆè¦ç”¨åˆ°åå°„çš„æ–¹å¼ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚å…·ä½“å°±ä¸è¯´äº†ã€‚åªè¦æ¸…æ¥šï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ª blockï¼Œæ¯æ¬¡éƒ½ç”¨è¿™ä¸ª blockï¼Œéƒ½ä¼š<strong>è°ƒç”¨å¯¹åº”å±æ€§çš„ setter æ–¹æ³•</strong>å°†å€¼èµ‹ç»™è¯¥å±æ€§å³å¯ã€‚</p>
<p>æœ€åï¼ŒæŠŠè®¾ç½®å¥½çš„ view ä¿å­˜åˆ° <code>_viewRegistry</code> ä¸­ã€‚js å’Œ native ç«¯éƒ½ä¼šä¿å­˜å¥½è¿™ä¸ª <code>tag</code> å’Œ view çš„æ˜ å°„è¡¨ã€‚è¿™é‡Œçš„ <code>_viewRegistry</code> å°±æ˜¯ native ç«¯ä¿å­˜çš„å­—å…¸ã€‚</p>
<p>è¿™é‡Œåªæ˜¯ä»‹ç»äº†å¦‚ä½•é€šè¿‡ js ä¼ æ¥çš„ <code>tag</code> å’Œ <code>moduleName</code> åˆ›å»ºå‡ºå¯¹åº”çš„ native ç«¯çš„ view çš„ã€‚å½“ç„¶ï¼Œåˆ›å»ºå’Œå±•ç¤ºä¸­é—´è¿˜éš”ç€ measureã€layoutä¹‹ç±»çš„æ­¥éª¤ï¼Œè¿™ä¹Ÿæ˜¯ React éœ€è¦åšçš„ï¼Œè¿™ä¸ªæˆ‘å°±ä¸èŠäº†ï¼Œå¤ªæ·±å…¥äº†èŠä¸åŠ¨ï¼Œå®¹æ˜“èŠçˆ†ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/RN_liaobaole.png?raw=true" alt="èŠçˆ†å•¦"></p>
<h2 id="è‡ªå»ºç»„ä»¶"><a href="#è‡ªå»ºç»„ä»¶" class="headerlink" title="è‡ªå»ºç»„ä»¶"></a>è‡ªå»ºç»„ä»¶</h2><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“ view æ˜¯å¦‚ä½•åˆ›å»ºå‡ºæ¥çš„äº†ã€‚facebook å°è£…çš„ç»„ä»¶å’Œè‡ªå»ºçš„ç»„ä»¶åŸç†ä¸Šæ˜¯ä¸€è‡´çš„ã€‚ç°åœ¨æ¥ç ”ç©¶ä¸€ä¸‹è‡ªå»ºç»„ä»¶çš„åˆ›å»ºè¿‡ç¨‹ã€‚</p>
<h3 id="åŸºæœ¬è®¾ç½®"><a href="#åŸºæœ¬è®¾ç½®" class="headerlink" title="åŸºæœ¬è®¾ç½®"></a>åŸºæœ¬è®¾ç½®</h3><p>å‰é¢è¯´åˆ°æ‹¿åˆ° view çš„ <code>manager</code> è°ƒç”¨å…¶ <code>view</code> æ–¹æ³•ã€‚é‚£ä¹ˆ <code>manager</code> æ˜¯ä¸ªä»€ä¹ˆå‘¢ï¼Ÿ<code>manager</code> ç›¸å½“äºä¸€ä¸ª Controllerï¼Œè´Ÿè´£åˆ›å»ºå’Œæ§åˆ¶ viewã€‚æ–‡æ¡£ä¸Šå…³äºåˆ›å»º <code>RCTViewManager</code> ä¸»è¦æœ‰ä¸‰æ­¥ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªå­ç±»</li>
<li>æ·»åŠ  <code>RCT_EXPORT_MODULE()</code> æ ‡è®°å®</li>
<li>å®ç° <code>-(UIView *)view</code> æ–¹æ³•</li>
</ol>
<p>è¿™ä¸‰æ­¥æ˜¯æœ€åŸºæœ¬çš„ä¸‰æ­¥ï¼Œä½œç”¨ä¹ŸæŒºæ˜æ˜¾çš„ã€‚ç»§æ‰¿ <code>RCTViewManager</code> ä½œä¸ºä¸€ä¸ªæ ‡è®°ï¼Œè¿™æ · <code>RCTUIManager</code> åœ¨è®¾ç½® <code>bridge</code>  çš„æ—¶å€™å°±èƒ½å¤Ÿå°†è¯¥ <code>manager</code> æ”¾å…¥ <code>_componentDataByName</code> æ•°ç»„ä¸­äº†ã€‚æ·»åŠ  <code>RCT_EXPORT_MODULE()</code> æ ‡è®°å®åæ‰èƒ½å°†è¯¥ç±»æš´éœ²ç»™ jsï¼Œæ‰èƒ½è®© js è°ƒç”¨è¯¥ç±»æ–¹æ³•ã€‚å®ç° <code>-(UIView *)view</code> æ–¹æ³•å°±æ˜¯ä¸Šé¢ <code>[self.manager view]</code> è°ƒç”¨çš„æ–¹æ³•ã€‚</p>
<h3 id="è®¾ç½®å±æ€§"><a href="#è®¾ç½®å±æ€§" class="headerlink" title="è®¾ç½®å±æ€§"></a>è®¾ç½®å±æ€§</h3><p>ä¸Šé¢åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ª viewï¼Œæ›´å¤æ‚ä¸€ç‚¹çš„æƒ…å†µå°±æ˜¯éœ€è¦æ§åˆ¶ view çš„å±æ€§ã€‚RN æä¾›äº†ä¸¤ä¸ªå®ï¼š</p>
<ul>
<li><code>RCT_EXPORT_VIEW_PROPERTY(name,type)</code></li>
<li><code>RCT_CUSTOM_VIEW_PROPERTY(name,type,viewClass){...}</code></li>
</ul>
<p>æ¥çœ‹ä¸€ä¸‹å®å®šä¹‰çš„å®ç°ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¸¸è§„å¯¼å‡º</span></div><div class="line"><span class="meta">#define RCT_EXPORT_VIEW_PROPERTY(name, type) \</span></div><div class="line">+ (<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)propConfig_<span class="meta">##name &#123; return @[@#type]; &#125;</span></div><div class="line"><span class="comment">// è‡ªå®šä¹‰å¯¼å‡º</span></div><div class="line"><span class="meta">#define RCT_CUSTOM_VIEW_PROPERTY(name, type, viewClass) \</span></div><div class="line">RCT_REMAP_VIEW_PROPERTY(name, __custom__, type)         \</div><div class="line">- (<span class="keyword">void</span>)set_<span class="meta">##name:(id)json forView:(viewClass *)view withDefaultView:(viewClass *)defaultView</span></div><div class="line"></div><div class="line"><span class="meta">#define RCT_REMAP_VIEW_PROPERTY(name, keyPath, type) \</span></div><div class="line">+ (<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)propConfig_<span class="meta">##name &#123; return @[@#type, @#keyPath]; &#125;</span></div></pre></td></tr></table></figure>
<p>å…³äº <code>##</code> å’Œ <code>@#</code> å‰ä¸€ç¯‡ä¹Ÿæœ‰æ¶‰åŠã€‚æ“ä½œç¬¦ <code>##</code> ç”¨æ¥å®ç°å®ä¸­ token çš„è¿æ¥ï¼Œ <code>@#</code> å®ç°å°†å®ä¸­çš„å‚æ•°è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚æ¯”å¦‚ <code>RCT_EXPORT_VIEW_PROPERTY(placeholder, NSString)</code> è¿™æ ·ä¸€ä¸ªå±æ€§ï¼Œå°†ä¼šè¢«è½¬åŒ–ä¸ºä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+ (<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)propConfig_placeholder &#123; <span class="keyword">return</span> @[<span class="string">@"NSString"</span>]; &#125;</div></pre></td></tr></table></figure>
<p>ä½†å¦‚æœè¦å¯¹å±æ€§è¿›è¡Œä¹Ÿè°¢æ“ä½œçš„è¯ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">RCT_CUSTOM_VIEW_PROPERTY(fontSize, <span class="built_in">NSNumber</span>, RCTTextView)</div><div class="line">&#123;</div><div class="line">  view.font = [RCTFont updateFont:view.font withSize:json ?: @(defaultView.font.pointSize)];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·çš„è‡ªå®šä¹‰å±æ€§ï¼Œåˆ™ä¼šè½¬åŒ–ä¸ºå¦‚ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">+ (<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)propConfig_fontSize &#123; <span class="keyword">return</span> @[<span class="string">@"NSNumber"</span>, <span class="string">@"__custom__"</span>]; &#125;</div><div class="line">- (<span class="keyword">void</span>)set_fontSize:(<span class="keyword">id</span>)json forView:(RCTTextView *)view withDefaultView:(RCTTextView *)defaultView&#123;</div><div class="line">  view.font = [RCTFont updateFont:view.font withSize:json ?: @(defaultView.font.pointSize)];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ <code>json</code> ä»£è¡¨äº† JS ä¸­ä¼ é€’çš„å°šæœªè§£æçš„åŸå§‹å€¼ã€‚<code>view</code> ä»£è¡¨è®¿é—®çš„å¯¹åº”çš„è§†å›¾å®ä¾‹ã€‚<code>defaultView</code> åœ¨ JS å‘é€ null çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠè§†å›¾çš„è¿™ä¸ªå±æ€§é‡ç½®å›é»˜è®¤å€¼ã€‚</p>
<p>è¿™é‡Œè¯´ä¸€ä¸‹è¿™ä¸ª <code>defaultView</code>ï¼Œè¿™æ˜¯ <code>RCTComponentData</code> ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œä¸ç”¨åœ¨æ„ä¹Ÿä¸ç”¨è‡ªå·±è®¾ç½®å®ƒã€‚åœ¨ <code>json</code> ä¸ºç©ºçš„æ—¶å€™ï¼Œå°±ä¼šå»è‡ªå·±åˆ›å»ºä¸€ä¸ªå½“å‰ view çš„å®ä¾‹ä½œä¸º <code>defaultView</code>ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//RCTComponentData.m propBlockForKey:inDictionary</span></div><div class="line"><span class="keyword">if</span> (!json &amp;&amp; !strongSelf-&gt;_defaultView) &#123;</div><div class="line">  <span class="comment">// Only create default view if json is null</span></div><div class="line">  strongSelf-&gt;_defaultView = [strongSelf createViewWithTag:<span class="literal">nil</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®å®šä¹‰çš„æ–¹æ³•åœ¨ä¸Šé¢è¯´è¿‡çš„ <code>setProps:forView:</code> æ–¹æ³•é‡Œè°ƒç”¨ï¼Œç›®çš„æ˜¯éªŒè¯ä» js ç«¯ä¼ é€’è¿‡æ¥çš„å±æ€§æ˜¯å¦åœ¨ native é‡Œæ³¨å†Œè¿‡ã€‚</p>
<p>è‡³äºè¿˜æœ‰ä¸€äº›éå¸¸è§„çš„éœ€è¦ç”¨åˆ° <code>RCTConvert</code> ä»¥åŠäº‹ä»¶çš„ä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼Œä¸æ·±å…¥äº†ã€‚</p>
<h3 id="åˆ›å»º-View"><a href="#åˆ›å»º-View" class="headerlink" title="åˆ›å»º View"></a>åˆ›å»º View</h3><p>å‰é¢è¯´è¿‡äº†å¦‚ä½•åˆ›å»º Controllerï¼Œç°åœ¨è¯´ä¸€ä¸‹è¿™ä¸ª viewã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UIView</span> *)view</div><div class="line">&#123;</div><div class="line">  <span class="keyword">return</span> [[<span class="built_in">MKMapView</span> alloc] init];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ˜¯å®˜æ–¹æ–‡æ¡£é‡Œçš„ä¾‹å­ï¼Œåœ¨ <code>manager</code> ä¸­çš„ <code>view</code> æ–¹æ³•é‡Œåˆ›å»ºäº†ä¸€ä¸ª <code>MKMapView</code> çš„è§†å›¾ã€‚é‚£ä¹ˆ RN æ˜¯å¦‚ä½•è®¾ç½® <code>MKMapView</code> çš„ frame çš„å‘¢ï¼Ÿä¸ç”¨æ‹…å¿ƒï¼ŒRN å®ç°äº† <code>UIView</code> çš„èŒƒç•´ <code>UIView(React)</code>ï¼Œå…¶ä¸­å°±å®ç°äº† <code>reactSetFrame</code> æ–¹æ³•ï¼Œä¼šè‡ªå·±å°†è®¡ç®—å¥½çš„å¤§å°è®¾ç½®ç»™ viewï¼Œå¦‚æœä½ æƒ³åœ¨ view è®¾ç½®å¥½å¤§å°ååšä»€ä¹ˆäº‹ï¼Œä½ å°±å¯ä»¥é€šè¿‡é‡å†™è¿™ä¸ªæ–¹æ³•ã€‚å¦å¤–ï¼Œå½“ js ç«¯çš„ä¸€äº›å±æ€§å˜åŒ–æ—¶ï¼Œå°±ä¼šè§¦å‘ native ç›¸åº” view çš„ç›¸åº”å±æ€§çš„ setter æ–¹æ³•ï¼Œå¯ä»¥è‡ªå·±å®ç°è¿™äº› setter æ–¹æ³•ï¼Œæ¥åšä¸€äº›åˆ«çš„å¤„ç†ï¼Œæ¯”å¦‚åœ¨ <code>RCTImageView</code> é‡Œï¼Œåªè¦ä»»æ„å±æ€§å‘ç”Ÿå˜åŒ–ï¼Œéƒ½ä¼šè§¦å‘ <code>reloadImage</code> æ–¹æ³•ã€‚</p>
<h2 id="ç»ˆ"><a href="#ç»ˆ" class="headerlink" title="ç»ˆ"></a>ç»ˆ</h2><p>æ€»ç®—é€šè¿‡è¿™ä¸¤ç¯‡å°† RN ç¨å¾®æ¢³ç†äº†ä¸€ä¸‹ï¼Œè·Ÿè¿›èµ·æ¥ä¸å®¹æ˜“å•Šï¼Œéƒ½æ˜¯æ³ªã€‚æœ¬æ¥æƒ³ç ”ç©¶ä¸€ä¸‹ï¼Œå†™ä¸€ç¯‡ â€œRN view æ˜¾ç¤ºåŸç†â€ çš„ã€‚ä½†æ˜¯è¯»ç€è¯»ç€å‘ç° Reactjs å¹¶ä¸èƒ½çœ‹æ‡‚ï¼Œé‚£è¿˜å†™ä¸ªè›‹çš„æ˜¾ç¤ºåŸç†å•Šå–‚ã€‚æœ€ç»ˆå°±å¿½ç•¥äº† view çš„å±‚æ¬¡å…³ç³»ä»¥åŠå¤§å°ä½ç½®ç­‰ç­‰çš„è½¬æ¢åŸç†ï¼Œå†™äº†è¿™ä¹ˆä¸€ç¯‡ã€‚è™½ç„¶å†™çš„æ°´å¹³ä¸é«˜ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡å¦‚æœä½ æƒ³æ›´æ·±å…¥çš„äº†è§£ä¸€ä¸‹ react nativeï¼Œè¯»ä¸€ä¸‹æœ¬ç¯‡è¿˜æ˜¯èƒ½æœ‰äº›è®¸å¸®åŠ©çš„ã€‚æ¯•ç«Ÿä¸ºäº†çœ‹æ‡‚ï¼Œæˆ‘ä¹Ÿè¯»äº†å¥½ä¹…å¥½ä¹…<del>~</del>~~</p>
<p>ä¹Ÿè®¸ä¼šæœ‰ä¸‹ä¸€ç¯‡ï¼Œä¹Ÿè®¸ä¼šæŒ‘ä¸€ä¸ª RN å°è£…çš„ç»„ä»¶å…·ä½“çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å®ç°çš„~</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[React-Native åˆå§‹åŒ–ä¸é€šä¿¡åŸç†æºç åˆ†æ]]></title>
      <url>http://zhang759740844.github.io/2017/01/17/RN%20Native%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>RN æ˜¯å¦‚ä½•å¯åŠ¨çš„ï¼Œoc ä¸ js æ˜¯å¦‚ä½•é€šä¿¡çš„å°†æ˜¯æœ¬æ–‡æ¢ç©¶çš„é‡ç‚¹ã€‚è™½ç„¶ç½‘ä¸Šå·²ç»æœ‰ä¸å°‘è§£é‡Š RN åŸç†çš„æ–‡ç« ï¼Œä½†æ˜¯åˆ°è‡ªå·±è¯»èµ·æºç çš„æ—¶å€™ï¼Œè¿˜æ˜¯éå¸¸ç´¯äººçš„ã€‚è¿™é‡Œï¼Œå°†è¾ƒä¸ºç»†è‡´çš„æ¢³ç†ä¸€ä¸‹ RN çš„æ–¹æ³•è°ƒç”¨è¿‡ç¨‹ï¼Œå¸Œæœ›èƒ½å¯¹å„ä½æœ‰æ‰€å¸®åŠ©ã€‚</p>
<p>æœ¬æ–‡ä¸»è¦é’ˆå¯¹ RN 0.39 ç‰ˆæœ¬ï¼Œä¸åŒç‰ˆæœ¬å¯èƒ½ä¼šç•¥æœ‰ä¸åŒã€‚ä¸å¤šbb RN çš„åŸºæœ¬æ¦‚è¦äº†ï¼Œç›´æ¥å¼€å§‹ï¼ˆå»ºè®®è¯»è€…è¿˜æ˜¯å…ˆè‡ªè¡Œäº†è§£ä¸‹ RN çš„åŸºæœ¬åŸç†ï¼Œæœ‰åŠ©äºç†è§£ï¼‰ã€‚</p>
<a id="more"></a>
<h2 id="Native-åˆå§‹åŒ–è¿‡ç¨‹"><a href="#Native-åˆå§‹åŒ–è¿‡ç¨‹" class="headerlink" title="Native åˆå§‹åŒ–è¿‡ç¨‹"></a>Native åˆå§‹åŒ–è¿‡ç¨‹</h2><p>å…ˆæ¥ä¸€å¼ å®Œæ•´çš„åˆå§‹åŒ–æµç¨‹å›¾ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/RNå¯åŠ¨æµç¨‹.png?raw=true" alt="RN åˆå§‹åŒ–æµç¨‹å›¾"></p>
<p>ä¸‹é¢å°†å¯¹å…¶ä¸­çš„éƒ¨åˆ†æ–¹æ³•åšä¸€äº›æ³¨é‡Šã€‚</p>
<h3 id="tag1"><a href="#tag1" class="headerlink" title="tag1"></a>tag1</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">RCTRootView *rootView = [[RCTRootView alloc] initWithBundleURL:jsCodeLocation</div><div class="line">                                                    moduleName:<span class="string">@"AwesomeProject"</span></div><div class="line">                                             initialProperties:<span class="literal">nil</span></div><div class="line">                                                 launchOptions:launchOptions];</div></pre></td></tr></table></figure>
<p>ä»»ä½• RN çš„ä½¿ç”¨è€…éƒ½åº”è¯¥å¯¹è¿™ä¸ªæ–¹æ³•ä¸é™Œç”Ÿã€‚åœ¨ js ç«¯å†™çš„å„ä¸ª componentï¼Œéƒ½å°†åœ¨ native è½¬æ¢æˆ <code>RCTRootView</code> çš„å½¢å¼å±•ç°å‡ºæ¥ã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥åˆ›å»ºä¸€ä¸ª <code>RCTBridge</code> çš„å®ä¾‹ï¼Œå®ƒæ˜¯ oc ä¸ js äº¤äº’çš„æ¡¥æ¢ï¼Œæ•´ä¸ªåˆå§‹åŒ–çš„è¿‡ç¨‹å°±æ˜¯åˆ›å»ºè¿™ä¸ª Bridgeã€‚ç¬¬äºŒæ­¥é€šè¿‡è¿™ä¸ª Bridge åˆ›å»ºä¸€ä¸ª <code>RCTRootView</code>ã€‚</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚å¯¹äºä¸€ä¸ªåŠ RN åŠ native çš„åº”ç”¨ï¼ˆå³ä¸æ˜¯é€šè¿‡ RN çš„ navigator è·³è½¬ï¼Œè€Œæ˜¯é€šè¿‡åŸç”Ÿè·³è½¬å¥½åï¼Œå†åˆ†åˆ«åˆ›å»º RN çš„ viewï¼‰ï¼Œåˆ›å»ºé¡µé¢æ—¶ä¸åº”è¯¥ç›´æ¥è°ƒç”¨ <code>initWithBundleURL:moduleName:initialProperties:launchOptions:</code> æ–¹æ³•ã€‚å› ä¸ºè¿™æ ·æ¯æ¬¡éƒ½è¦åˆ›å»º <code>RCTBridge</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªè€—æ—¶è€—èµ„æºçš„è¿‡ç¨‹ã€‚åº”è¯¥äº‹å…ˆåˆ›å»ºå¥½ <code>RCTBridge</code>ï¼Œåœ¨è¦åˆ›å»ºé¡µé¢çš„æ—¶å€™è°ƒç”¨ <code>initWithBridge:moduleName:initialProperties:</code> æ–¹æ³•ã€‚</p>
<h3 id="tag2"><a href="#tag2" class="headerlink" title="tag2"></a>tag2</h3><p>ä¸€ç•ªè·³è½¬æ¥åˆ° <code>setUp</code> æ–¹æ³•å†…ï¼Œä¸€äº›æ¯”è¾ƒæ¬¡è¦çš„ä»£ç æ¯”å¦‚ <code>Logger</code> æˆ‘å°±ä¸åˆ†æäº†ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)setUp</div><div class="line">&#123;</div><div class="line">	...</div><div class="line">  [<span class="keyword">self</span> createBatchedBridge];</div><div class="line">  [<span class="keyword">self</span>.batchedBridge start];</div><div class="line">	...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åˆ›å»ºå¹¶æŒæœ‰äº†å…¶å­ç±» <code>RCTBatchedBridge</code> çš„å®ä¾‹ã€‚<code>RCTBridge</code> ä¸­å…¶å®æ²¡æœ‰å¤ªå¤šä»£ç ï¼Œåˆå§‹åŒ–çš„å¤§éƒ¨åˆ†é€»è¾‘éƒ½åœ¨ <code>[self.batchedBridge start]</code> ä¸­å®Œæˆã€‚</p>
<h3 id="tag3"><a href="#tag3" class="headerlink" title="tag3"></a>tag3</h3><p>åˆ›å»º <code>RCTBatchedBridge</code> ä¸­æœ€é‡è¦çš„æ–¹æ³•å°±æ˜¯ <code>[self.batchedBridge start]</code> æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ æ­¥:</p>
<ol>
<li>è¯»å– js æºç </li>
<li>åˆå§‹åŒ–å„ä¸ªéœ€è¦ç»™ js è°ƒç”¨çš„æ¨¡å—</li>
<li>åˆ›å»ºä¸€ä¸ª JSContextï¼Œä¸º JSContext è®¾ç½®å¤šä¸ªå›è°ƒæ–¹æ³•</li>
<li>å°†æ¨¡å—ä¿¡æ¯å†™å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­</li>
<li>å°†å­—ç¬¦ä¸²ä¼ é€’ç»™ js ç«¯</li>
<li>æ‰§è¡Œ js æºç </li>
</ol>
<p>å…¶ä¸­åˆ›å»ºäº†ä¸¤ä¸ª GCDGroupï¼Œåˆ†åˆ«ä¸º <code>initModulesAndLoadSource</code> å’Œ <code>setupJSExecutorAndModuleConfig</code>ã€‚å½“3ã€4æ­¥å®Œæˆåæ‰èƒ½æ‰§è¡Œç¬¬5æ­¥ï¼Œå½“1ã€2ã€5éƒ½å®Œæˆåæ‰ä¼šæ‰§è¡Œ6ã€‚</p>
<h3 id="tag4"><a href="#tag4" class="headerlink" title="tag4"></a>tag4</h3><p>å¼‚æ­¥åœ°è¯»å– jsBundleï¼Œä¼ å…¥åŠ è½½æˆåŠŸå’Œæ­£åœ¨åŠ è½½ä¸­çš„å›è°ƒæ–¹æ³•ã€‚æ²¡æœ‰å¤ªå¤šå¥½è¯´çš„ï¼Œéƒ½æ˜¯ä¸€äº›ç³»ç»Ÿ api çš„è°ƒç”¨ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">  [<span class="keyword">self</span> loadSource:^(<span class="built_in">NSError</span> *error, <span class="built_in">NSData</span> *source, __unused int64_t sourceLength) &#123;</div><div class="line">    <span class="keyword">if</span> (error) &#123;</div><div class="line">      RCTLogWarn(<span class="string">@"Failed to load source: %@"</span>, error);</div><div class="line">      <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">        [weakSelf stopLoadingWithError:error];</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">    sourceCode = source;</div><div class="line">    dispatch_group_leave(initModulesAndLoadSource);</div><div class="line">  &#125; onProgress:^(RCTLoadingProgress *progressData) &#123;</div><div class="line"><span class="meta">#ifdef RCT_DEV</span></div><div class="line">    RCTDevLoadingView *loadingView = [weakSelf moduleForClass:[RCTDevLoadingView <span class="keyword">class</span>]];</div><div class="line">    [loadingView updateProgress:progressData];</div><div class="line"><span class="meta">#endif</span></div><div class="line">  &#125;];</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>[weakSelf stopLoadingWithError:error]</code> å°±æ˜¯ç»å¸¸æ‰€è§çš„çº¢å±æŠ¥é”™ã€‚<code>onProgress</code> çš„å›è°ƒæ–¹æ³•è¡¨ç¤ºï¼Œå¦‚æœåœ¨çœŸæœºä¸ŠåŠ è½½ï¼Œé‚£ä¹ˆåœ¨åŠ è½½æ—¶é¡µé¢ä¸Šéƒ¨æ˜¾ç¤º â€œLoading from XXXXâ€ çš„æç¤ºã€‚</p>
<h3 id="tag5"><a href="#tag5" class="headerlink" title="tag5"></a>tag5</h3><p><code>initModulesWithDispatchGroup:</code> æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„æ–¹æ³•ï¼Œç”¨æ¥åˆå§‹åŒ–æ¨¡å—ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªå°†è¦æš´éœ²ç»™ js çš„æ¨¡å—éƒ½ä¼šä¿å­˜ä¸º <code>RCTModuleData</code> çš„å½¢å¼ï¼Œç„¶åè¢«å­˜å‚¨ä¸º3åˆ†é…ç½®è¡¨ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSMutableArray</span>&lt;Class&gt; *moduleClassesByID = [<span class="built_in">NSMutableArray</span> new];</div><div class="line"><span class="built_in">NSMutableArray</span>&lt;RCTModuleData *&gt; *moduleDataByID = [<span class="built_in">NSMutableArray</span> new];</div><div class="line"><span class="built_in">NSMutableDictionary</span>&lt;<span class="built_in">NSString</span> *, RCTModuleData *&gt; *moduleDataByName = [<span class="built_in">NSMutableDictionary</span> new];</div><div class="line"></div><div class="line">moduleDataByName[moduleName] = moduleData;</div><div class="line">[moduleClassesByID addObject:moduleClass];</div><div class="line">[moduleDataByID addObject:moduleData];</div></pre></td></tr></table></figure>
<h4 id="RCTRegisterModule"><a href="#RCTRegisterModule" class="headerlink" title="RCTRegisterModule"></a>RCTRegisterModule</h4><p>é‚£ä¹ˆï¼Œå¦‚ä½•æ‰¾åˆ°æš´éœ²ç»™ js çš„æ¨¡å—å‘¢ï¼ŸRN æä¾›äº† <code>RCTRegisterModule();</code> çš„å®ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#define RCT_EXPORT_MODULE(js_name) \</span></div><div class="line">RCT_EXTERN <span class="keyword">void</span> RCTRegisterModule(Class); \</div><div class="line">+ (<span class="built_in">NSString</span> *)moduleName &#123; <span class="keyword">return</span> @<span class="meta">#js_name; &#125; \</span></div><div class="line">+ (<span class="keyword">void</span>)load &#123; RCTRegisterModule(<span class="keyword">self</span>); &#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> RCTRegisterModule(Class moduleClass)</div><div class="line">&#123;</div><div class="line">  <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">  <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">    RCTModuleClasses = [<span class="built_in">NSMutableArray</span> new];</div><div class="line">  &#125;);</div><div class="line">  </div><div class="line">  <span class="comment">// Register module</span></div><div class="line">  [RCTModuleClasses addObject:moduleClass];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·å°±ç”Ÿæˆäº†ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<ol>
<li>åœ¨ç±» <code>load</code> çš„æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨ <code>RCTRegisterModule</code> æ–¹æ³•ï¼Œå°†ç±»è‡ªåŠ¨æ³¨å†Œåˆ° <code>RCTModuleClasses</code> æ•°ç»„ä¸­ã€‚åªè¦éå†è¯¥æ•°ç»„ï¼Œå°±èƒ½å–å‡ºæ‰€æœ‰æš´éœ²å‡ºçš„æ¨¡å—ã€‚</li>
<li><code>moduleName</code> æ–¹æ³•ï¼Œè¿”å› <code>@#js_name</code>ã€‚è¿™é‡Œçš„ <code>@#</code> çš„ä¸€æ—¶æ˜¯æŠŠå®å‚æ•° <code>js_name</code> è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œå•¥ä¹Ÿæ²¡æœ‰ï¼Œè¿”å›çš„å°±æ˜¯ç©ºã€‚å½“ç„¶åœ¨ <code>RCTBridgeModuleNameForClass()</code> è¿™ä¸ªè·å–æ¨¡å—åçš„æ–¹æ³•é‡Œï¼Œå¦‚æœ <code>moduleName</code> é•¿åº¦ä¸º0ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨ <code>NSStringFromClass()</code> æ–¹æ³•è·å–ç±»åã€‚</li>
</ol>
<h3 id="tag6"><a href="#tag6" class="headerlink" title="tag6"></a>tag6</h3><p>åœ¨æ‰€æœ‰è¦æš´éœ²ç»™ js çš„ç±»ä¸­ï¼Œ<code>RCTJSCExecutor</code> æ˜¯æœ€ç‰¹æ®Šçš„ä¸€ä¸ªç±»ã€‚éœ€è¦ç‡å…ˆåˆ›å»ºä¸€ä¸ªå®ä¾‹å¹¶ä½œä¸ºinstance ä¿å­˜åœ¨ä¸€ä¸ª <code>RCTModuleData</code> çš„å®ä¾‹ä¸­ï¼Œä»¥é˜²å…¶ä»– module å¯èƒ½éœ€è¦ç”¨åˆ°ã€‚</p>
<p>åœ¨åˆ›å»º <code>RCTJSCExecutor</code> å®ä¾‹çš„æ—¶å€™ï¼Œåˆ›å»ºäº†ä¸€ä¸ª JSThreadï¼Œæ‰€æœ‰çš„ JS é€šä¿¡ï¼Œéƒ½æ˜¯é€šè¿‡  <code>RCTJSCExecutor</code> æ‰§è¡Œï¼Œéƒ½æ˜¯åœ¨è¿™ä¸ª JSThread å†…ã€‚</p>
<h3 id="tag7"><a href="#tag7" class="headerlink" title="tag7"></a>tag7</h3><p>é™¤äº† <code>RCTJSCExecutor</code> çš„å…¶ä»–æ¨¡å—å®ä¾‹åŒ–çš„è¿‡ç¨‹éƒ½æ˜¯åœ¨ <code>prepareModulesWithDispatchGroup:</code> ä¸­å®Œæˆã€‚å®ä¾‹åŒ–æ¯ä¸ªæš´éœ²çš„æ¨¡å—ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸º <code>RCTModuleData</code> çš„ <code>instance</code> å±æ€§ã€‚åœ¨ <code>setUpMethodQueue</code> æ–¹æ³•ä¸­ï¼Œä¸ºæ¯ä¸€ä¸ªæ¨¡å—éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè‡ªå·±ç‹¬æœ‰çš„ä¸“å±ä¸²è¡Œé˜Ÿåˆ—ï¼Œä¿è¯æ¯ä¸ªæ¨¡å—å†…çš„é€šä¿¡äº‹ä»¶éƒ½æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ã€‚</p>
<h3 id="tag8"><a href="#tag8" class="headerlink" title="tag8"></a>tag8</h3><p><code>gatherConstants</code> æ–¹æ³•ä¸»è¦åŠŸèƒ½ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">RCTExecuteOnMainThread(^&#123;</div><div class="line">  <span class="keyword">self</span>-&gt;_constantsToExport = [<span class="keyword">self</span>-&gt;_instance constantsToExport] ?: @&#123;&#125;;</div><div class="line">&#125;, <span class="literal">YES</span>);</div></pre></td></tr></table></figure>
<p>å°†æ¨¡å—(instance)çš„ä¸€äº›å¸¸é‡è®¾ç½®ç»™å„è‡ªçš„ <code>RCTModuleData</code> å®ä¾‹ä¸­ã€‚</p>
<h3 id="tag9"><a href="#tag9" class="headerlink" title="tag9"></a>tag9</h3><p>åœ¨ <code>setUp</code> æ–¹æ³•ä¸­ï¼ŒJSThread å†…åˆ›å»ºäº†ä¸€ä¸ª <code>JSContext</code>ï¼Œå¹¶ä¸”ä¸º Context è®¾ç½®äº†ä¸åŒçš„ blockï¼Œå¦‚ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">context[<span class="string">@"nativeFlushQueueImmediate"</span>] = ^(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSArray</span> *&gt; *calls)&#123;</div><div class="line">  RCTJSCExecutor *strongSelf = weakSelf;</div><div class="line">  <span class="keyword">if</span> (!strongSelf.valid || !calls) &#123;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  RCT_PROFILE_BEGIN_EVENT(RCTProfileTagAlways, <span class="string">@"nativeFlushQueueImmediate"</span>, <span class="literal">nil</span>);</div><div class="line">  [strongSelf-&gt;_bridge handleBuffer:calls batchEnded:<span class="literal">NO</span>];</div><div class="line">  RCT_PROFILE_END_EVENT(RCTProfileTagAlways, <span class="string">@"js_call"</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>è¿™äº› block ä¼šåœ¨ç‰¹å®šçš„åœºåˆè°ƒç”¨ã€‚ä¹‹åå°†æœ‰ä»‹ç»ã€‚</p>
<h3 id="tag10"><a href="#tag10" class="headerlink" title="tag10"></a>tag10</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSString</span> *)moduleConfig</div><div class="line">&#123;</div><div class="line">  <span class="built_in">NSMutableArray</span>&lt;<span class="built_in">NSArray</span> *&gt; *config = [<span class="built_in">NSMutableArray</span> new];</div><div class="line">  <span class="keyword">for</span> (RCTModuleData *moduleData <span class="keyword">in</span> _moduleDataByID) &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.executorClass == [RCTJSCExecutor <span class="keyword">class</span>]) &#123;</div><div class="line">      [config addObject:@[moduleData.name]];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      [config addObject:RCTNullIfNil(moduleData.config)];</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> RCTJSONStringify(@&#123;</div><div class="line">    <span class="string">@"remoteModuleConfig"</span>: config,</div><div class="line">  &#125;, <span class="literal">NULL</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ <code>moduleConfig</code> æ–¹æ³•ä¸­ï¼Œå„ä¸ªæ¨¡å—åå°†å…ˆè¢«åŠ å…¥ config æ•°ç»„ä¸­ï¼Œç„¶åè¢«è½¬æ¢ä¸º json å­—ç¬¦ä¸²çš„å½¢å¼ã€‚è¿™é‡Œåªæ˜¯å†™å…¥æ¨¡å—åï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/moduleConfig.png?raw=true" alt="moduleConfig"></p>
<h3 id="tag11"><a href="#tag11" class="headerlink" title="tag11"></a>tag11</h3><p>è¿™ä¸€æ­¥å°†ä¸Šé¢çš„ JSON å­—ç¬¦ä¸²é€šè¿‡ <code>JSExecutor</code> ä¼ å…¥ JS ä½œä¸ºå…¨å±€å˜é‡ã€‚å˜é‡åä¸º <code>__fbBatchedBridgeConfig</code>:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)injectJSONConfiguration:(<span class="built_in">NSString</span> *)configJSON</div><div class="line">                     onComplete:(<span class="keyword">void</span> (^)(<span class="built_in">NSError</span> *))onComplete</div><div class="line">&#123;</div><div class="line">	...</div><div class="line">  [_javaScriptExecutor injectJSONText:configJSON</div><div class="line">                  asGlobalObjectNamed:<span class="string">@"__fbBatchedBridgeConfig"</span></div><div class="line">                             callback:onComplete];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="tag-12"><a href="#tag-12" class="headerlink" title="tag 12"></a>tag 12</h3><p>å½“ä¸Šé¢æ‰€æœ‰æ­¥éª¤å…¨éƒ¨åšå®Œåï¼Œå°±å¼€å§‹é€šè¿‡ <code>executeSourceCode</code> æ‰§è¡Œ js ä»£ç äº†ã€‚</p>
<h2 id="JSåˆå§‹åŒ–è¿‡ç¨‹"><a href="#JSåˆå§‹åŒ–è¿‡ç¨‹" class="headerlink" title="JSåˆå§‹åŒ–è¿‡ç¨‹"></a>JSåˆå§‹åŒ–è¿‡ç¨‹</h2><p>native ç«¯ <code>injectJSONConfiguration</code> åªæŠŠæ¨¡å—çš„åç§°ç»„æˆçš„ JSON å­—ç¬¦ä¸²ç½®å…¥äº† <code>__fbBatchedBridgeConfig</code>ï¼Œé‚£ä¹ˆ JS ç«¯å¦‚ä½•æ‹¿åˆ°æ¨¡å—çš„æ–¹æ³•ä»¥åŠä¸€äº›å¸¸é‡ä¿¡æ¯å‘¢ï¼Ÿéœ€è¦æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹ JS ç«¯çš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚</p>
<h3 id="NativeModule"><a href="#NativeModule" class="headerlink" title="NativeModule"></a>NativeModule</h3><p>js çš„æ‰“åŒ…æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/jsBundle.png?raw=true" alt="jsbundle"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå…¶ä¸­å¯¼å…¥äº† <code>NativeModule</code>ã€‚å®ƒå°±æ˜¯ç”¨æ¥æ¥æ”¶ä¿å­˜ native ç«¯æš´éœ²çš„æ¨¡å—çš„ã€‚</p>
<p>å…ˆæ¥çœ‹ä¸€å¼ æ•´ä½“çš„åˆå§‹åŒ–æµç¨‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/è·å–methods.png?raw=true" alt="JS åˆå§‹åŒ–"></p>
<h4 id="tag1-1"><a href="#tag1-1" class="headerlink" title="tag1"></a>tag1</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> bridgeConfig = global.__fbBatchedBridgeConfig;</div><div class="line">invariant(bridgeConfig, <span class="string">'__fbBatchedBridgeConfig is not set, cannot invoke native modules'</span>);</div><div class="line">(bridgeConfig.remoteModuleConfig || []).forEach((config: ModuleConfig, moduleID: number) =&gt; &#123;</div><div class="line">  <span class="comment">// Initially this config will only contain the module name when running in JSC. The actual</span></div><div class="line">  <span class="comment">// configuration of the module will be lazily loaded.</span></div><div class="line">  <span class="keyword">const</span> info = genModule(config, moduleID);</div><div class="line">  <span class="keyword">if</span> (!info) &#123;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (info.module) &#123;</div><div class="line">    NativeModules[info.name] = info.module;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// If there's no module config, define a lazy getter</span></div><div class="line">  <span class="keyword">else</span> &#123;</div><div class="line">    defineLazyObjectProperty(NativeModules, info.name, &#123;</div><div class="line">      get: () =&gt; loadModule(info.name, moduleID)</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„ <code>global.__fbBatchedBridgeConfig</code> å°±æ˜¯ native æ³¨å…¥çš„å­—ç¬¦ä¸²ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯å„ä¸ªæ¨¡å—åã€‚è¿™é‡Œè¯´ä¸€èˆ¬æ˜¯å› ä¸ºå¦‚æœæ‰“å¼€äº† Remote JS Debuggingï¼Œé‚£ä¹ˆè¿™é‡Œå¾—åˆ°çš„æ˜¯åŒ…æ‹¬æ–¹æ³•åçš„å…¨éƒ¨é…ç½®ä¿¡æ¯ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/bridgeConfig.png?raw=true" alt="bridgeConfig"></p>
<p>(æ³¨ï¼šå¼€äº† Remote JS Debugging å js ä»£ç æ˜¯å¯ä»¥æ–­ç‚¹çš„ï¼Œä½†æ˜¯ Xcode ç»å¸¸æ˜¾ç¤º <code>__nw_connection_get_connected_socket_block_invoke xx Connection has no connected handler</code> ç„¶åï¼ŒXcode çš„æ–­ç‚¹å°±å¤±çµäº†ã€‚)</p>
<p>å…³é—­ Remote JS Debuggingï¼Œ<code>info.module</code> ä¸º nilï¼Œå› æ­¤ä¸€å®šä¼šè¿è¡Œåˆ° <code>get: () =&gt; loadModule(info.name, moduleID)</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªæ‡’åŠ è½½æ–¹æ³•ï¼Œä»¥æ­¤æ¥åŠ å¿« RN çš„åˆå§‹åŒ–é€Ÿåº¦ã€‚</p>
<p>ç»è¿‡è¿™ä¸ªæ–¹æ³•ï¼Œå°±å°†æ‰€æœ‰æš´éœ²å‡ºæ¥çš„æ–¹æ³•çš„æ‰§è¡Œä¿¡æ¯ä¿å­˜åœ¨ NativeModule å¯¹è±¡ï¼ˆæˆ–è€…è¯´å­—å…¸ï¼Œä¸æ˜¯æ•°ç»„ã€‚é”®æ˜¯moduleåï¼Œå€¼æ˜¯æ¨¡å—å†…çš„æ–¹æ³•ç»„æˆçš„å¯¹è±¡ï¼‰é‡Œäº†ã€‚ï¼ˆè¿™é‡Œå¹¶ä¸æ˜¯å…¨éƒ¨ <code>ModuleCinfig</code> éƒ½å˜æˆäº† <code>NativeModules</code> é‡Œçš„ä¸€é¡¹ï¼Œæ¯”å¦‚ä¸€äº›å…³äº view çš„managerï¼Œå®ƒä»¬å¹¶æ²¡æœ‰è°ƒç”¨å„è‡ªçš„æ‡’åŠ è½½æ–¹æ³•ã€‚è¿™äº› manager çš„æ–¹æ³•éƒ½åœ¨åŠ è½½ <code>RCTUIManager</code> çš„æ—¶å€™ï¼Œä½œä¸º <code>RCTUIManager</code> çš„ <code>constants</code> è®¾ç½®å¥½äº†ã€‚ï¼‰</p>
<h4 id="tag2-1"><a href="#tag2-1" class="headerlink" title="tag2"></a>tag2</h4><p>è¿›å…¥ <code>loadModule</code> æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadModule</span>(<span class="params">name: string, moduleID: number</span>): ?<span class="title">Object</span> </span>&#123;</div><div class="line">  invariant(global.nativeRequireModuleConfig,</div><div class="line">    <span class="string">'Can\'t lazily create module without nativeRequireModuleConfig'</span>);</div><div class="line">  <span class="keyword">const</span> config = global.nativeRequireModuleConfig(name);</div><div class="line">  <span class="keyword">const</span> info = genModule(config, moduleID);</div><div class="line">  <span class="keyword">return</span> info &amp;&amp; info.module;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è°ƒç”¨äº† <code>global.nativeRequireModuleConfig</code> æ–¹æ³•ï¼Œä»¥åŠ <code>genModule</code> æ–¹æ³•ã€‚</p>
<h4 id="tag3-1"><a href="#tag3-1" class="headerlink" title="tag3"></a>tag3</h4><p><code>global.nativeRequireModuleConfig</code> å°±æ˜¯ native æµç¨‹å›¾çš„ tag9ï¼Œ<code>RCTJSCExecutor</code> çš„ <code>setUp</code> æ–¹æ³•ä¸­ï¼Œæ³¨å†Œçš„è¯¸å¤šå›è°ƒä¸­çš„ä¸€ä¸ªï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">context[<span class="string">@"nativeRequireModuleConfig"</span>] = ^<span class="built_in">NSArray</span> *(<span class="built_in">NSString</span> *moduleName) &#123;</div><div class="line">  RCTJSCExecutor *strongSelf = weakSelf;</div><div class="line">  <span class="keyword">if</span> (!strongSelf.valid) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  RCT_PROFILE_BEGIN_EVENT(RCTProfileTagAlways, <span class="string">@"nativeRequireModuleConfig"</span>, @&#123; <span class="string">@"moduleName"</span>: moduleName &#125;);</div><div class="line">  <span class="built_in">NSArray</span> *result = [strongSelf-&gt;_bridge configForModuleName:moduleName];</div><div class="line">  RCT_PROFILE_END_EVENT(RCTProfileTagAlways, <span class="string">@"js_call,config"</span>);</div><div class="line">  <span class="keyword">return</span> RCTNullIfNil(result);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><code>methods</code> æ–¹æ³•ä¼šæ‹¿åˆ°å¯¹åº” <code>RCTModuleData</code> çš„æ‰€æœ‰æ–¹æ³•ï¼Œç„¶åå¾ªç¯æ‰¾åˆ°ä»¥ <code>__rct_export__</code> å¼€å¤´çš„æ–¹æ³•(ä¸ºä»€ä¹ˆæ˜¯ä»¥ <code>__rct_export__</code> å¼€å¤´åé¢å†è®²)ã€‚</p>
<p><code>JSMethodName</code> æ–¹æ³•ä¼šæ‹¿åˆ°æ–¹æ³•çš„å­—ç¬¦ä¸²ï¼Œå¹¶æˆªå–ç¬¬ä¸€ä¸ªå†’å·å‰çš„å­—ç¬¦ï¼Œä½œä¸º JS ç®€å†™æ–¹æ³•åã€‚</p>
<p>æœ€åå°†å„ä¸ªæ–¹æ³•å¸¸é‡ç­‰ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œå³éœ€è¦è¿”å›çš„ <code>config</code>:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSArray</span> *config = @[</div><div class="line">  <span class="keyword">self</span>.name,</div><div class="line">  RCTNullIfNil(constants),</div><div class="line">  RCTNullIfNil(methods),</div><div class="line">  RCTNullIfNil(promiseMethods),</div><div class="line">  RCTNullIfNil(syncMethods)</div><div class="line">];</div></pre></td></tr></table></figure>
<h4 id="tag4-1"><a href="#tag4-1" class="headerlink" title="tag4"></a>tag4</h4><p>æ¥çœ‹ä¸€ä¸‹ <code>genModule</code> æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">genModule</span>(<span class="params">config: ?ModuleConfig, moduleID: number</span>): ?</span>&#123;name: string, <span class="built_in">module</span>?: <span class="built_in">Object</span>&#125; &#123;</div><div class="line">  ...</div><div class="line">  methods &amp;&amp; methods.forEach((methodName, methodID) =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> isPromise = promiseMethods &amp;&amp; arrayContains(promiseMethods, methodID);</div><div class="line">    <span class="keyword">const</span> isSync = syncMethods &amp;&amp; arrayContains(syncMethods, methodID);</div><div class="line">    invariant(!isPromise || !isSync, <span class="string">'Cannot have a method that is both async and a sync hook'</span>);</div><div class="line">    <span class="keyword">const</span> methodType = isPromise ? <span class="string">'promise'</span> : isSync ? <span class="string">'sync'</span> : <span class="string">'async'</span>;</div><div class="line">    <span class="built_in">module</span>[methodName] = genMethod(moduleID, methodID, methodType);</div><div class="line">  &#125;);</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‹¿åˆ°äº†é€šè¿‡ <code>global.nativeRequireModuleConfig</code> æ–¹æ³•è·å¾—çš„å®Œæ•´ <code>config</code> ä¿¡æ¯ã€‚åœ¨è¯¥æ–¹æ³•ä¸­é€šè¿‡ä¸€ä¸ªå¾ªç¯ï¼Œå°†æ‰€æœ‰ <code>method</code> æ‹¿å‡ºï¼Œå­˜å…¥ä¸€ä¸ª <code>module</code> å¯¹è±¡ä¸­å»ï¼Œé”®æ˜¯ method åï¼Œå€¼æ˜¯é€šè¿‡ <code>genMethod</code> æ–¹æ³•ç”Ÿæˆçš„ functionã€‚</p>
<h4 id="tag5-1"><a href="#tag5-1" class="headerlink" title="tag5"></a>tag5</h4><p>å†è·Ÿè¿›åˆ° <code>genMethod</code> æ–¹æ³•ä¸­å»ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">genMethod</span>(<span class="params">moduleID: number, methodID: number, type: MethodType</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> fn = <span class="literal">null</span>;</div><div class="line">  <span class="keyword">if</span> (type === <span class="string">'promise'</span>) &#123;</div><div class="line">	...</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    fn = <span class="function"><span class="keyword">function</span>(<span class="params">...args: Array&lt;any&gt;</span>) </span>&#123;</div><div class="line">      <span class="keyword">const</span> lastArg = args.length &gt; <span class="number">0</span> ? args[args.length - <span class="number">1</span>] : <span class="literal">null</span>;</div><div class="line">      <span class="keyword">const</span> secondLastArg = args.length &gt; <span class="number">1</span> ? args[args.length - <span class="number">2</span>] : <span class="literal">null</span>;</div><div class="line">      <span class="keyword">const</span> hasSuccessCallback = <span class="keyword">typeof</span> lastArg === <span class="string">'function'</span>;</div><div class="line">      <span class="keyword">const</span> hasErrorCallback = <span class="keyword">typeof</span> secondLastArg === <span class="string">'function'</span>;</div><div class="line">      hasErrorCallback &amp;&amp; invariant(</div><div class="line">        hasSuccessCallback,</div><div class="line">        <span class="string">'Cannot have a non-function arg after a function arg.'</span></div><div class="line">      );</div><div class="line">      <span class="keyword">const</span> onSuccess = hasSuccessCallback ? lastArg : <span class="literal">null</span>;</div><div class="line">      <span class="keyword">const</span> onFail = hasErrorCallback ? secondLastArg : <span class="literal">null</span>;</div><div class="line">      <span class="keyword">const</span> callbackCount = hasSuccessCallback + hasErrorCallback;</div><div class="line">      args = args.slice(<span class="number">0</span>, args.length - callbackCount);</div><div class="line">      BatchedBridge.enqueueNativeCall(moduleID, methodID, args, onFail, onSuccess);</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  fn.type = type;</div><div class="line">  <span class="keyword">return</span> fn;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç°åœ¨åªçœ‹ else çš„æƒ…å†µã€‚ä¸»è¦å°±æ˜¯å°† <code>moduleID</code>ï¼Œ<code>methodID</code>ï¼Œå‚æ•°ä»¥åŠå¤±è´¥å’ŒæˆåŠŸçš„å›è°ƒå‡½æ•°ä¼ å…¥ <code>BatchedBridge</code> çš„ <code>enqueuenativeCall</code> æ–¹æ³•ã€‚è¿™é‡Œçš„ <code>moduleID</code>ï¼Œ<code>methodID</code>ï¼Œ ä¹Ÿå°±æ˜¯ä¸€èˆ¬è®¨è®º RN åŸç†æ—¶ç»å¸¸çœ‹åˆ°çš„ â€œé€šè¿‡æ¨¡å—ã€æ–¹æ³•idæ‰¾åˆ°å¯¹åº”æ¨¡å—å’Œæ–¹æ³•â€ï¼Œå…¶å®å°±æ˜¯<strong>å¯¹åº”æ•°ç»„ä¸­çš„ä¸‹æ ‡</strong>ã€‚</p>
<p>å¦å¤–ï¼Œå…³äºå–å‡ºæˆåŠŸå’Œå¤±è´¥çš„å›è°ƒæ–¹æ³•ï¼Œæ˜¯é€šè¿‡åˆ¤æ–­æœ€åä¸¤ä¸ªå‚æ•°æ˜¯å¦æ˜¯æ–¹æ³•æ¥å¾—åˆ°çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæœ€åä¸€ä¸ªæ˜¯æˆåŠŸçš„å›è°ƒæ–¹æ³•ï¼Œå€’æ•°ç¬¬äºŒä¸ªæ˜¯å¤±è´¥çš„å›è°ƒæ–¹æ³•ã€‚å› æ­¤ï¼Œå¦‚æœéœ€è¦è®¾ç½®å›è°ƒæ–¹æ³•ï¼Œé‚£ä¹ˆå¿…é¡»æ”¾åœ¨æœ€åï¼Œä¸”å›è°ƒæ–¹æ³•ä¸èƒ½è¶…è¿‡ä¸¤ä¸ªã€‚</p>
<h3 id="BatchedBridge"><a href="#BatchedBridge" class="headerlink" title="BatchedBridge"></a>BatchedBridge</h3><p><code>BatchedBridge</code> æ˜¯ä¸ªå•¥:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> MessageQueue = <span class="built_in">require</span>(<span class="string">'MessageQueue'</span>);</div><div class="line"><span class="keyword">const</span> BatchedBridge = <span class="keyword">new</span> MessageQueue();</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">Object.defineProperty(global, <span class="string">'__fbBatchedBridge'</span>, &#123;</div><div class="line">  configurable: <span class="literal">true</span>,</div><div class="line">  value: BatchedBridge,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>BatchedBridge</code> æ˜¯ä¸€ä¸ª <code>MessageQueue</code> å®ä¾‹ã€‚å…¶å°†è‡ªèº«å†™å…¥å…¨å±€å˜é‡ <code>__fbBatchedBridge</code> ä¸Šï¼Œè¿™æ · Native å¯ä»¥é€šè¿‡ <code>__fbBatchedBridge</code> ï¼Œè®¿é—® JSBridgeå¯¹è±¡ï¼Œæ¯”å¦‚åœ¨ <code>RCTJSCExecutor.mm</code> çš„ <code>_executeJSCall:arguments:unwrapResult:callback</code> æ–¹æ³•ä¸­ã€‚</p>
<h3 id="MessageQueue"><a href="#MessageQueue" class="headerlink" title="MessageQueue"></a>MessageQueue</h3><p>åœ¨å‰é¢çš„ tag5 ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œ<code>genModule</code> æ–¹æ³•ä¸­ç”Ÿæˆçš„ function è°ƒç”¨äº† <code>BatchedBridge</code> çš„ <code>enqueuenativeCall</code>ã€‚è¿™ä¸ªæ–¹æ³•å°±å®šä¹‰åœ¨ <code>MessageQueue.js</code> ä¸­ã€‚</p>
<p>ä»£ç å¤ªé•¿æˆ‘å°±å°±è´´éƒ¨åˆ†å§ï¼Œå¤§è‡´åˆ†ä¸º ä¸ªéƒ¨åˆ†ï¼š</p>
<p>é¦–å…ˆï¼Œåœ¨ <code>MessageQueue</code> ä¸­å®šä¹‰äº†ä¸€ä¸ªä»0å¼€å§‹çš„è®¡æ•°çš„ <code>_callbackID</code>ï¼Œç”¨æ¥æ ‡è¯† js ç«¯çš„å›è°ƒå‡½æ•°ã€‚å°† <code>callbackID</code> push è¿›å‚æ•°æ•°ç»„ <code>params</code> é‡Œã€‚ç„¶åï¼Œå°†è¿™ä¸ª callback ä¿å­˜åœ¨æœ¬åœ°çš„ <code>_callbacks</code> æ•°ç»„ä¸­çš„å¯¹åº” <code>callbackID</code> ä½ç½®ã€‚è¿™æ ·ï¼Œå½“ native ä¼ æ¥å›è°ƒçš„ <code>callbackID</code> çš„æ—¶å€™ï¼Œå°±èƒ½åœ¨ <code>_callbacks</code> æ•°ç»„ä¸­æ‰¾åˆ°å¹¶æ‰§è¡Œç›¸åº”æ–¹æ³•äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">onFail &amp;&amp; params.push(this._callbackID);</div><div class="line">this._callbacks[this._callbackID++] = onFail;</div><div class="line">onSucc &amp;&amp; params.push(this._callbackID);</div><div class="line">this._callbacks[this._callbackID++] = onSucc;</div></pre></td></tr></table></figure>
<p>è®¾ç½®å¥½å›è°ƒä¹‹åï¼Œå°† <code>moduleID</code>ï¼Œ<code>methodID</code>ï¼Œ<code>params</code> åˆ†åˆ« push è¿› <code>_queue</code>è¿™ä¸ªæ•°ç»„çš„å„ä¸ªä½ç½®ã€‚ä¸‹é¢çš„ <code>MODULE_IDS</code>ï¼Œ<code>METHOD_IDS</code>ï¼Œ<code>PARAMS</code>åˆ†åˆ«ä»£è¡¨0ï¼Œ1ï¼Œ2ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>._queue[MODULE_IDS].push(moduleID);</div><div class="line"><span class="keyword">this</span>._queue[METHOD_IDS].push(methodID);</div><div class="line"><span class="keyword">this</span>._queue[PARAMS].push(params);</div></pre></td></tr></table></figure></p>
<p>ä¸ºä»€ä¹ˆè¦æŠŠæ–¹æ³•å‚æ•°æ”¾è¿›ä¸€ä¸ª <code>_queue</code> æ•°ç»„é‡Œå‘¢ï¼Ÿå› ä¸º js ä¸èƒ½ä¸»åŠ¨è°ƒç”¨é™¤äº†ä¸Šé¢è®¾ç½® <code>JSContext</code> çš„æ—¶å€™è®¾ç½®çš„é‚£äº›å›è°ƒæ–¹æ³•å¤–çš„ native æ–¹æ³•ï¼Œæ‰€ä»¥ js ç«¯æƒ³è°ƒç”¨ native ç«¯ä»£ç çš„æ—¶å€™ï¼Œå¿…é¡»å°†æƒ³è¦è°ƒç”¨çš„æ¨¡å—ã€æ–¹æ³•ã€å‚æ•°æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œï¼Œç­‰å¾… native æ¥è·å–è¿™ä¸ªæ•°ç»„ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ª <code>_queue</code>ã€‚ä»€ä¹ˆæ—¶å€™ native å›æ¥è¦ä¸€æ¬¡è¿™ä¸ªæ•°ç»„å‘¢ï¼Ÿæ¯”å¦‚åœ¨å®Œæˆ native è°ƒç”¨ js æ–¹æ³•åï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[_javaScriptExecutor callFunctionOnModule:module</div><div class="line">                                   method:method</div><div class="line">                                arguments:args</div><div class="line">                                 callback:^(<span class="keyword">id</span> json, <span class="built_in">NSError</span> *error) &#123;</div><div class="line">                                   [weakSelf _processResponse:json error:error];</div><div class="line">                                 &#125;];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„è¿™ä¸ªæ–¹æ³•å°±æ˜¯ native è°ƒç”¨ js çš„æ–¹æ³•ï¼Œå…·ä½“çš„è°ƒç”¨æµç¨‹åœ¨åé¢ä¼šè¯´æ˜ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ <code>callback</code> çš„ block å†…ï¼Œæœ‰ä¸€ä¸ªå«åš <code>json</code> çš„å…¥å‚ï¼Œè¿™ä¸ª <code>json</code> å°±æ˜¯ä¸Šé¢çš„ <code>_queue</code>ã€‚åœ¨ native è°ƒç”¨å®Œ js çš„æ–¹æ³•åï¼Œnative å°±ä¼šæ¥å¤„ç† js æ˜¯å¦éœ€è¦è°ƒç”¨ native çš„ä»€ä¹ˆæ–¹æ³•ï¼Œå¹¶ä¸”åˆ·æ–° <code>_queue</code> æ•°ç»„ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/jsonç¤ºä¾‹.png?raw=true" alt="jsonç¤ºä¾‹"></p>
<p>ç»§ç»­åˆšæ‰çš„ <code>enqueueNativeCall</code> æ–¹æ³•å¾€ä¸‹èµ°æ‰§è¡Œåˆ°ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (global.nativeFlushQueueImmediate &amp;&amp; now - <span class="keyword">this</span>._lastFlush &gt;= MIN_TIME_BETWEEN_FLUSHES_MS) &#123;</div><div class="line">    global.nativeFlushQueueImmediate(<span class="keyword">this</span>._queue);</div><div class="line">    <span class="keyword">this</span>._queue = [[], [], [], <span class="keyword">this</span>._callID];</div><div class="line">    <span class="keyword">this</span>._lastFlush = now;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„ <code>global.nativeFlushQueueImmediate</code> å°±æ˜¯ <code>JSContext</code> è®¾ç½®çš„å‡ ä¸ªå›è°ƒæ–¹æ³•ä¸­çš„ä¸€ä¸ªï¼Œä¾› JS ä¸»åŠ¨è°ƒç”¨ã€‚æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">context[<span class="string">@"nativeFlushQueueImmediate"</span>] = ^(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSArray</span> *&gt; *calls)&#123;</div><div class="line">  RCTJSCExecutor *strongSelf = weakSelf;</div><div class="line">  <span class="keyword">if</span> (!strongSelf.valid || !calls) &#123;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  RCT_PROFILE_BEGIN_EVENT(RCTProfileTagAlways, <span class="string">@"nativeFlushQueueImmediate"</span>, <span class="literal">nil</span>);</div><div class="line">  [strongSelf-&gt;_bridge handleBuffer:calls batchEnded:<span class="literal">NO</span>];</div><div class="line">  RCT_PROFILE_END_EVENT(RCTProfileTagAlways, <span class="string">@"js_call"</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>è°ƒç”¨äº† <code>nativeFlushQueueImmediate</code> æ–¹æ³•åå°±ä¼šæ‰§è¡Œ <code>handleBuffer:batcheEnded:</code> æ–¹æ³•æ¥å¼ºåˆ¶ native æ¥æ‰§è¡Œ js éœ€è¦è°ƒç”¨çš„ native æ–¹æ³•ï¼Œå¹¶ä¸”åˆ·æ–° <code>_queue</code> æ•°ç»„ã€‚</p>
<p>å› æ­¤ï¼Œ<code>enqueueNativeCall</code> æ–¹æ³•ä¸­çš„è¿™æ®µä»£ç è¡¨ç¤ºï¼Œå½“ä¸Šæ¬¡åˆ·æ–° <code>_queue</code> æ•°ç»„çš„æ—¶é—´å’Œå½“å‰æ—¶é—´ç›¸æ¯”è¶…è¿‡äº† <code>MIN_TIME_BETWEEN_FLUSHES_MS</code> å³5msï¼Œé‚£ä¹ˆå°±ä¼šä¸»åŠ¨è°ƒç”¨ native çš„ <code>nativeFlushQueueImmediate</code> æ–¹æ³•ï¼Œå¼ºåˆ¶æ‰§è¡Œï¼Œåˆ·æ–° <code>_queue</code>ã€‚</p>
<p>æ³¨æ„åˆ°ï¼Œè¿™é‡Œæ¸…ç©ºçš„æ“ä½œï¼š<code>this._queue = [[], [], [], this._callID];</code>ï¼Œå°† <code>_queue</code> çš„ç¬¬å››é¡¹è®¾ç½®ä¸º <code>_callID</code>ã€‚è¿™ä¸ª <code>_callID</code> æ¯æ¬¡ <code>enqueueNativeCall</code> çš„æ—¶å€™éƒ½ä¼šè‡ªå¢ä¸€æ¬¡ï¼Œåº”è¯¥åªæ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œæš‚æ—¶æ²¡çœ‹å‡ºæœ‰ä»€ä¹ˆå¤ªç‰¹åˆ«çš„ç”¨å¤„ã€‚</p>
<h3 id="RCT-EXPORT-METHOD"><a href="#RCT-EXPORT-METHOD" class="headerlink" title="RCT_EXPORT_METHOD()"></a>RCT_EXPORT_METHOD()</h3><p>RN æ˜¯å¦‚ä½•å°†æ–¹æ³•å‰åŠ ä¸Š <code>__rct_export__</code> çš„å‘¢ï¼Ÿé€šè¿‡ <code>RCT_EXPORT_METHOD()</code> æ–¹æ³•ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#define RCT_EXPORT_METHOD(method) \</span></div><div class="line">  RCT_REMAP_METHOD(, method)</div><div class="line"></div><div class="line"><span class="meta">#define RCT_REMAP_METHOD(js_name, method) \</span></div><div class="line">  RCT_EXTERN_REMAP_METHOD(js_name, method) \</div><div class="line">  - (<span class="keyword">void</span>)method</div><div class="line"></div><div class="line"><span class="meta">#define RCT_EXTERN_REMAP_METHOD(js_name, method) \</span></div><div class="line">  + (<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)RCT_CONCAT(__rct_export__, \</div><div class="line">    RCT_CONCAT(js_name, RCT_CONCAT(__LINE__, __COUNTER__))) &#123; \</div><div class="line">    <span class="keyword">return</span> @[@<span class="meta">#js_name, @#method]; \</span></div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>ä¸­é—´çš„å®ä¸ºæ–¹æ³•è¡¥å…¨äº† <code>-(void)</code> æ¢å¤äº†å®Œæ•´ OC æ–¹æ³•çš„å®šä¹‰ã€‚è¿™æ ·æ‰èƒ½ä½¿å¾— <code>RCT_EXPORT_METHOD(xxx)</code> è¿™æ ·çš„å†™æ³•ç¼–è¯‘å™¨ä¸æŠ¥é”™ã€‚</p>
<p>ä¸‹é¢çš„å®ä¸­ <code>RCT_CONCAT</code> æ˜¯ä¸€ä¸ªæ‹¼æ¥çš„å®ã€‚å¤§è‡´ä¸ºæ¯ä¸€ä¸ª <code>RCT_EXPORT_METHOD</code> ç”Ÿæˆäº†å”¯ä¸€è¯†åˆ«çš„æ•°å­— tag ä¸ js_name æ‹¼æ¥ï¼Œç„¶ååœ¨å‰é¢åŠ ä¸Šä¸€ä¸ª <code>__rct_export__</code>ï¼Œç”Ÿæˆäº†ä¸€ä¸ªè¿”å›ä¸€ä¸ªæ•°ç»„çš„æ–¹æ³•ã€‚</p>
<p>å¥—ç”¨<a href="http://awhisper.github.io/2016/07/02/ReactNativeæºç åˆ†æ2/" target="_blank" rel="external">RN æºç è§£è¯»ï¼ˆäºŒï¼‰</a>ä¸­çš„ä¸€ä¸ªä¾‹å­ï¼š</p>
<p>å‡è®¾æˆ‘ä»¬å†™ <code>RCT_EXPORT_METHOD(nativeAlert:xxx)</code> çš„æ—¶å€™ï¼Œ<code>__LINE__</code> ä¸ <code>__COUNTER__</code> ç»„åˆèµ·æ¥çš„æ•°å­— tag å¦‚æœæ˜¯ 123456ï¼Œé‚£ä¹ˆè¿™ä¸ªå†…äºŒå±‚å®è¿˜ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªè¿™æ ·çš„å‡½æ•°ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">+ (<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)__rct_export__123456&#123; </div><div class="line">    <span class="keyword">return</span> @[<span class="string">@""</span>, <span class="string">@"nativeAlert:xxx"</span>]; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¢å¥è¯è¯´ï¼Œä¸€è¡Œ <code>RCT_EXPORT_METHOD(xxxx)</code>ï¼Œç­‰äºç”Ÿæˆäº†2ä¸ªå‡½æ•°çš„å®ç°:</p>
<ul>
<li><code>-(void)nativeAlert:(NSString *)content withButton:(NSString *)name</code></li>
<li><code>+(NSArray&lt;NSString *&gt; *)__rct_export__123456</code></li>
</ul>
<h2 id="Native-ä¸-JS-é—´çš„é€šä¿¡"><a href="#Native-ä¸-JS-é—´çš„é€šä¿¡" class="headerlink" title="Native ä¸ JS é—´çš„é€šä¿¡"></a>Native ä¸ JS é—´çš„é€šä¿¡</h2><p>ç°åœ¨å¼€å§‹è®²åˆ° native å’Œ JS ä¹‹é—´çš„é€šä¿¡ã€‚é¦–å…ˆæ˜¯ native è°ƒç”¨ JS æ–¹æ³•ã€‚åœ¨ <code>RCTEventDispatcher.m</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å„ç§å„æ ·çš„è°ƒç”¨æ–¹æ³•ï¼š</p>
<ul>
<li><code>sendAppEventWithName:body:</code></li>
<li><code>sendDeviceEventWithName:body:</code></li>
<li><code>sendInputEventWithName:body:</code></li>
</ul>
<p>è¿™äº›æ–¹æ³•éƒ½åœ¨å†…éƒ¨è°ƒåŠ¨äº† <code>RCTBatchedBridge</code> çš„ <code>enqueueJSCall:method:args:completion:</code> æ–¹æ³•ï¼Œä¸‹é¢æ˜¯å‚è€ƒäº†<a href="http://i.dotidea.cn/2016/05/react-native-communication-principle-for-ios/" target="_blank" rel="external">React Nativeé€šä¿¡åŸç†è§£æ(IOS)</a>ç”»çš„ä¸€å¼ å®Œæ•´çš„è°ƒç”¨æµç¨‹å›¾ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/native_js_é€šä¿¡.png?raw=true" alt="native js é€šä¿¡"></p>
<h3 id="tag1-2"><a href="#tag1-2" class="headerlink" title="tag1"></a>tag1</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)_actuallyInvokeAndProcessModule:(<span class="built_in">NSString</span> *)module</div><div class="line">                                 method:(<span class="built_in">NSString</span> *)method</div><div class="line">                              arguments:(<span class="built_in">NSArray</span> *)args</div><div class="line">&#123;</div><div class="line">  RCTAssertJSThread();</div><div class="line"></div><div class="line">  __<span class="keyword">weak</span> __<span class="keyword">typeof</span>(<span class="keyword">self</span>) weakSelf = <span class="keyword">self</span>;</div><div class="line">  [_javaScriptExecutor callFunctionOnModule:module</div><div class="line">                                     method:method</div><div class="line">                                  arguments:args</div><div class="line">                                   callback:^(<span class="keyword">id</span> json, <span class="built_in">NSError</span> *error) &#123;</div><div class="line">                                     [weakSelf _processResponse:json error:error];</div><div class="line">                                   &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œä¸»è¦çœ‹ä¸€ä¸‹ <code>callFunctionOnModule</code> æ–¹æ³•çš„ callbackï¼Œåœ¨ callback ä¸­è°ƒç”¨äº† <code>_processResponse</code> æ–¹æ³•ï¼Œç”¨æ¥å¤„ç†æ‰§è¡Œ js ç«¯è°ƒç”¨ native çš„æ–¹æ³•ã€‚</p>
<h3 id="tag2-2"><a href="#tag2-2" class="headerlink" title="tag2"></a>tag2</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)_callFunctionOnModule:(<span class="built_in">NSString</span> *)module</div><div class="line">                       method:(<span class="built_in">NSString</span> *)method</div><div class="line">                    arguments:(<span class="built_in">NSArray</span> *)args</div><div class="line">                  returnValue:(<span class="built_in">BOOL</span>)returnValue</div><div class="line">                 unwrapResult:(<span class="built_in">BOOL</span>)unwrapResult</div><div class="line">                     callback:(RCTJavaScriptCallback)onComplete</div><div class="line">&#123;</div><div class="line">  <span class="comment">// <span class="doctag">TODO:</span> Make this function handle first class instead of dynamically dispatching it. #9317773</span></div><div class="line">  <span class="built_in">NSString</span> *bridgeMethod = returnValue ? <span class="string">@"callFunctionReturnFlushedQueue"</span> : <span class="string">@"callFunctionReturnResultAndFlushedQueue"</span>;</div><div class="line">  [<span class="keyword">self</span> _executeJSCall:bridgeMethod arguments:@[module, method, args] unwrapResult:unwrapResult callback:onComplete];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œè®¾ç½®äº†è°ƒç”¨ js ç«¯ batchedBridge çš„ <code>callFunctionReturnFlushedQueue</code> æˆ–è€… <code>callFunctionReturnResultAndFlushedQueue</code> æ–¹æ³•ã€‚å¹¶å°† <code>module</code>ï¼Œ<code>method</code>ï¼Œ<code>args</code> ä½œä½•æˆä¸€ä¸ªæ•°ç»„ä½œä¸º <code>arguments</code> ä¼ å…¥ã€‚<strong>ç”±äº native ç«¯éœ€è¦ä¸»åŠ¨è°ƒç”¨çš„ js ç«¯çš„æ–¹æ³•éƒ½æ˜¯ native æ‰€ç†ŸçŸ¥çš„æ¨¡å—å’Œæ–¹æ³•ï¼Œæ‰€ä»¥è¿™é‡Œçš„å„ä¸ªå‚æ•°éƒ½æ˜¯ string</strong>ï¼ˆåªæœ‰é‚£äº›è‡ªå®šä¹‰çš„æ¨¡å—æˆ–è€…æ–¹æ³•çš„è°ƒç”¨æ‰ä¼šç”¨ idï¼‰ã€‚</p>
<h3 id="tag3-2"><a href="#tag3-2" class="headerlink" title="tag3"></a>tag3</h3><p>åœ¨æ‰§è¡Œå®Œ js ç«¯çš„æ–¹æ³•åï¼Œå›åˆ° <code>RCTJSCExecutor</code> å†…æ‰§è¡Œ <code>onComplete</code> å›è°ƒ:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)_executeJSCall:(<span class="built_in">NSString</span> *)method</div><div class="line">             arguments:(<span class="built_in">NSArray</span> *)arguments</div><div class="line">          unwrapResult:(<span class="built_in">BOOL</span>)unwrapResult</div><div class="line">              callback:(RCTJavaScriptCallback)onComplete</div><div class="line">&#123;</div><div class="line">  [<span class="keyword">self</span> executeBlockOnJavaScriptQueue:^&#123;</div><div class="line">		<span class="comment">//æ‰§è¡Œjsæ–¹æ³•</span></div><div class="line">		...</div><div class="line">    onComplete(objcValue, error);</div><div class="line">  &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ª <code>onComplete</code> å°±æ˜¯ä¸Šé¢ tag1 ä¸­çš„ <code>callback</code>ã€‚</p>
<h3 id="tag4-2"><a href="#tag4-2" class="headerlink" title="tag4"></a>tag4</h3><p>js è°ƒç”¨ oc å¯ä»¥æœ‰å¾ˆå¤šä¸ªæ–¹æ³•ï¼Œä½†æ˜¯æœ€åæ–¹æ³•ä¸€å®šä¼šèµ°åˆ° <code>handleBuffer:</code> æ–¹æ³•ä¸­å»ã€‚è¿™ä¸ªæ–¹æ³•åœ¨ä¸Šé¢çš„ <code>MessageQueue</code> ä¸­ä¹Ÿæœ‰æåˆ°è¿‡ã€‚å…¥å‚æ˜¯ä¸€ä¸ªåŒ…å«æ¨¡å—ã€æ–¹æ³•ã€å‚æ•°çš„æ•°ç»„ã€‚</p>
<p>ç°åœ¨å°±ç”¨åˆ°äº†ä¹‹å‰ä¿å­˜çš„ <code>_moduleDataByID</code> æ•°ç»„ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">RCTModuleData *moduleData = <span class="keyword">self</span>-&gt;_moduleDataByID[moduleID.integerValue];</div><div class="line"><span class="built_in">dispatch_queue_t</span> queue = moduleData.methodQueue;</div></pre></td></tr></table></figure>
<p>é€šè¿‡ä¼ å…¥çš„ <code>moduleID</code> å°±å¯ä»¥åœ¨æ•°ç»„ä¸­æ‰¾åˆ°å¯¹åº”çš„ <code>RCTModuleData</code> å®ä¾‹ï¼Œæ‹¿å‡ºæ¯ä¸ª <code>RCTModuleData</code> çš„ gcd é˜Ÿåˆ—ã€‚ä¹‹åå°±æ˜¯åœ¨å„è‡ªé˜Ÿåˆ—é‡Œæ‰§è¡Œäº†ã€‚ç”±äºæ˜¯ä¸²è¡Œé˜Ÿåˆ—ï¼ŒåŒä¸€ä¸ª <code>RCTModuleData</code> çš„æ–¹æ³•å¿…é¡»æ˜¯é¡ºåºæ‰§è¡Œçš„ã€‚</p>
<h3 id="tag5-2"><a href="#tag5-2" class="headerlink" title="tag5"></a>tag5</h3><p>è¿™ä¸ªå°±æ˜¯æ­£çœŸé€šè¿‡åå°„çš„æ–¹å¼æ‰§è¡Œ native ä»£ç çš„æ–¹æ³•ã€‚ç”±äºä¹Ÿæ˜¯ iOS èœé¸Ÿï¼Œå¯¹äº invocation ä¹Ÿä¸æ˜¯å¾ˆäº†è§£ï¼Œæ‰€ä»¥è¿™æ®µä»£ç ä¸æ˜¯å¾ˆèƒ½çœ‹å¾—æ‡‚ï¼Œå°±ä¸ç»†èŠäº†ã€‚å„ä½å¤§ç¥å¯ä»¥ä»”ç»†è·Ÿè¿›ã€‚</p>
<p>ä¸è¿‡è¦æ³¨æ„å…¶ä¸­çš„ <code>processMethodSignature</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¸­ï¼ŒRN ä¼šå¯¹åå°„çš„ selector è¿›è¡Œåˆ†æï¼Œåˆ†ææœ‰å‡ ä¸ªå‚æ•°ï¼Œæ˜¯ä»€ä¹ˆç±»å‹ç­‰ç­‰ã€‚å…¶ä¸­å°±åœ¨ <code>addBlockArgument</code> è¿™ä¸ª block ä¸­ï¼Œè®¾ç½®äº†ä¸€ä¸ªè¾“å…¥å‚æ•°ä¸ºæ•°ç»„çš„å›è°ƒæ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">RCT_BLOCK_ARGUMENT(^(<span class="built_in">NSArray</span> *args) &#123;</div><div class="line">  [bridge enqueueCallback:json args:args];</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è¿™ä¸ª <code>RCT_BLOCK_ARGUMENT</code> å®æ˜¯ç”¨æ¥ä¿å­˜è¿™ä¸ªå›è°ƒæ–¹æ³•çš„ã€‚å› ä¸º <code>NSInvocation</code> ä¸ä¼šæŒæœ‰è¿™ä¸ª blockã€‚å…¶ä¸­çš„ <code>enqueueCallback:args:</code> å°±æ˜¯ç”¨æ¥å›è°ƒå‰é¢ä¿å­˜çš„ <code>_callback</code> çš„ã€‚</p>
<p>åé¢æ‰€æœ‰çš„æ–¹æ³•è°ƒç”¨ï¼Œå¤§è‡´è¿‡ç¨‹éƒ½å’Œ native è°ƒç”¨ js ä¸€æ ·ï¼Œåªä¸è¿‡å‰è€…ä¼ å…¥çš„æ˜¯ <code>callbackID</code>ï¼Œåè€…ä¼ å…¥çš„æ˜¯å„ä¸ªæ¨¡å—æ–¹æ³•å‚æ•°åã€‚æ‰€ä»¥æˆ‘ä¹Ÿå°±ä¸å†å±•å¼€äº†ã€‚</p>
<h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="http://www.jianshu.com/p/978c4bd3a759" target="_blank" rel="external">React Native ä»å…¥é—¨åˆ°åŸç†</a> çœ‹å®Œå¯ä»¥å¯¹ RN æœ‰ä¸€ä¸ªåˆæ­¥çš„è®¤è¯†<br><a href="http://awhisper.github.io/2016/06/24/ReactNativeæµç¨‹æºç åˆ†æ/" target="_blank" rel="external">ReactNative iOSæºç è§£æ</a> native ç«¯è®²è§£çš„éå¸¸è¯¦ç»†ï¼Œéœ€è¦ä»”ç»†åœ°è·Ÿç€èµ°ä¸€é<br><a href="http://i.dotidea.cn/2016/05/react-native-communication-principle-for-ios/" target="_blank" rel="external">React Nativeé€šä¿¡åŸç†è§£æ(IOS)</a> native å’Œ js éƒ½è®²è§£çš„è¾ƒä¸ºè¯¦ç»†ï¼Œå‰é¢é‚£ç¯‡çœ‹æ‡‚äº†ï¼Œå†æ¥çœ‹è¿™ç¯‡ï¼Œå¯ä»¥åŠ æ·±ç†è§£ã€‚(éƒ¨åˆ†å†…å®¹æœ‰ä¸€äº›åŒºåˆ«)</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ä» setTimeout() çœ‹jsçš„ Event Loop æ‰§è¡Œè¿‡ç¨‹]]></title>
      <url>http://zhang759740844.github.io/2016/12/28/EventLoop/</url>
      <content type="html"><![CDATA[<p>é€šè¿‡ <code>setTimeout()</code> æ–¹æ³•ï¼Œæ¥äº†è§£ js ä¸­çš„ä»£ç æ‰§è¡Œã€‚æœ¬æ–‡å‚ç…§<a href="https://mp.weixin.qq.com/s?__biz=MzI1MTE2NTE1Ng==&amp;mid=2649515867&amp;idx=1&amp;sn=971a3e41da08ddf2da200d9d07af0fb0&amp;chksm=f1efe7d0c6986ec688a746ece15f52c8df78bca37ca2609e75199f5c3fbbabd3fbcc00179885&amp;scene=0&amp;key=564c3e9811aee0abcc036cb111e6e7bdbe3938a8756b5bf3b98a1696b2f16c1e6e3a1b4af159d1ae1dd3e71ee5fae4e0b6655bd9f37cc81efb1174bf3ef39b43f874bc6a0482348422cc5245dfae917f&amp;ascene=0&amp;uin=MzIxNTY1NTU%3D&amp;devicetype=iMac+MacBookPro11%2C1+OSX+OSX+10.12.1+build(16B2555" target="_blank" rel="external">å¹²è´§ | åŸæ¥ä½ æ˜¯è¿™æ ·çš„ setTimeout</a>&amp;version=12010210&amp;nettype=WIFI&amp;fontScale=100&amp;pass_ticket=g24dIjS%2F70EF4QPCYwRMInMa218z6XagvevxLr5Mbzc%3D)</p>
<a id="more"></a>
<h2 id="Event-Loop"><a href="#Event-Loop" class="headerlink" title="Event Loop"></a>Event Loop</h2><p>Js å¼•æ“æ˜¯å•çº¿ç¨‹çš„ï¼Œåœ¨æŸä¸€ä¸ªç‰¹å®šçš„æ—¶é—´å†…åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶é˜»å¡å…¶ä»–ä»»åŠ¡çš„æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›ä»»åŠ¡æ˜¯ä¸²è¡Œçš„ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­æˆ‘ä»¬å´å¯ä»¥ä½¿ç”¨å¼‚æ­¥ä»£ç æ¥è§£å†³ã€‚Js ä¸ºäº†å¼•å…¥å¼‚æ­¥çš„ç‰¹æ€§ï¼Œå¼•ç”³å‡ºä¸€ä¸ªé‡è¦çš„ä¸œè¥¿ï¼ŒEvent Loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰ã€‚</p>
<p>å½“å¼‚æ­¥æ–¹æ³•ï¼Œæ¯”å¦‚ <code>setTimeout()</code> æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šäº¤ç”±æµè§ˆå™¨å†…æ ¸çš„å…¶ä»–æ¨¡å—å»ç®¡ç†ã€‚å½“å¼‚æ­¥çš„æ–¹æ³•æ»¡è¶³è§¦å‘æ¡ä»¶åï¼Œè¯¥æ¨¡å—å°±ä¼šå°†æ–¹æ³•æ¨å…¥åˆ°ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼ˆtask queueï¼‰ä¸­ï¼Œå½“ä¸»çº¿ç¨‹ä»£ç æ‰§è¡Œå®Œæ¯•å¤„äºç©ºé—²çŠ¶æ€çš„æ—¶å€™ï¼Œå°±ä¼šå»æ£€æŸ¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œå°†é˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ªä»»åŠ¡å…¥æ ˆæ‰§è¡Œï¼Œå®Œæ¯•åç»§ç»­æ£€æŸ¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¦‚æ­¤å¾ªç¯ã€‚å‰ææ¡ä»¶æ˜¯ä¸»çº¿ç¨‹å¤„äºç©ºé—²çŠ¶æ€ï¼Œè¿™å°±æ˜¯äº‹ä»¶å¾ªç¯çš„æ¨¡å‹ã€‚</p>
<h2 id="ç¬¬ä¸€ä¸ª-setTimeout-ä¾‹å­"><a href="#ç¬¬ä¸€ä¸ª-setTimeout-ä¾‹å­" class="headerlink" title="ç¬¬ä¸€ä¸ª setTimeout ä¾‹å­"></a>ç¬¬ä¸€ä¸ª setTimeout ä¾‹å­</h2><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'start'</span>);</div><div class="line"></div><div class="line">setTimeout(() =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</div><div class="line">&#125;,<span class="number">300</span>);</div><div class="line"></div><div class="line">setTimeout(()=&gt;&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'world'</span>);</div><div class="line">&#125;,<span class="number">200</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'end'</span>);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœä¸ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">start</div><div class="line">end</div><div class="line">world</div><div class="line">hello</div></pre></td></tr></table></figure></p>
<h3 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>é¦–å…ˆç¬¬ä¸€ä¸ª <code>console.log()</code> å…¥æ ˆæ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•æ§åˆ¶å°æ‰“å° <code>start</code> åå‡ºæ ˆï¼Œç´§æ¥ç€æ‰§è¡Œåˆ° <code>setTimeout</code> å®šæ—¶å™¨ï¼Œæ­¤æ—¶ JS å¼•æ“ä¼šå°†å®šæ—¶å™¨äº¤ç»™æµè§ˆå™¨çš„å¦ä¸€ä¸ªæ¨¡å—å»ç®¡ç†ï¼ˆä¸ºæ–¹ä¾¿ç†è§£è¿™é‡ŒæŠŠå®ƒå«åš Timer æ¨¡å—ï¼‰ï¼Œç„¶åä¸»çº¿ç¨‹ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œç´§æ¥ç€å°†ç¬¬äºŒä¸ªå®šæ—¶å™¨ä¹Ÿäº¤ç»™ Timer æ¨¡å—ï¼Œç„¶åæ‰§è¡Œåˆ°ç¬¬äºŒä¸ª <code>console.log()</code>ï¼Œæ§åˆ¶å°æ‰“å° <code>end</code>ï¼Œæ‰§è¡Œå®Œæ¯•åæ¸…ç©ºæ‰§è¡Œæ ˆã€‚ä½†æ˜¯å¹¶æ²¡æœ‰ç»“æŸï¼Œåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„åŒæ—¶ï¼ŒTimer æ¨¡å—ä¼šæ£€æŸ¥å…¶ä¸­çš„å¼‚æ­¥ä»£ç ï¼Œ<strong>ä¸€æ—¦æ»¡è¶³è§¦å‘æ¡ä»¶ï¼Œå°±ä¼šå°†å®ƒæ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­</strong>(æ³¨æ„ï¼Œæ˜¯æ»¡è¶³è§¦å‘æ¡ä»¶äº†å†æ”¾åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­)ã€‚Timer2 å»¶è¿Ÿ 200msï¼Œæ‰€ä»¥ä¼šæ—©äº Timer1 è¢«æ·»åŠ åˆ°é˜Ÿåˆ—æ’å¤´ã€‚è€Œä¸»çº¿ç¨‹æ­¤æ—¶å¤„äºç©ºé—²çŠ¶æ€ï¼Œæ‰€ä»¥ä¼šæ£€æŸ¥ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æœ‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ã€‚æ­¤æ—¶ä¼šå°† Timer2 å›è°ƒä¸­çš„ <code>console.log()</code> æ‰§è¡Œï¼Œæ§åˆ¶å°æ‰“å° <code>world</code>ï¼Œç„¶åæ‰§è¡Œæ ˆç©ºé—²åç»§ç»­æ£€æŸ¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œå°† Timer1 çš„ä»£ç å‹å…¥æ‰§è¡Œæ ˆä¸­æ‰§è¡Œï¼Œæ§åˆ¶å°æ‰“å° <code>hello</code>ï¼Œæ¸…ç©ºæ‰§è¡Œæ ˆï¼Œæ­¤æ—¶ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºï¼Œæ‰§è¡Œç»“æŸã€‚</p>
<p>##ç¬¬äºŒä¸ª setTimeout ä¾‹å­</p>
<h3 id="ä¾‹å­-1"><a href="#ä¾‹å­-1" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'start'</span>);</div><div class="line"></div><div class="line">setTimeout(() =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</div><div class="line">&#125;,<span class="number">300</span>);</div><div class="line"></div><div class="line">setTimeout(()=&gt;&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'world'</span>);</div><div class="line">&#125;,<span class="number">200</span>);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">100000</span>;i++)&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line">setTimeout(()=&gt;&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'i am run'</span>);</div><div class="line">&#125;,<span class="number">100</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'end'</span>);</div></pre></td></tr></table></figure>
<p>ç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">start</div><div class="line">...</div><div class="line">end</div><div class="line">hello</div><div class="line">world</div><div class="line">I am run</div></pre></td></tr></table></figure></p>
<h3 id="è¿‡ç¨‹-1"><a href="#è¿‡ç¨‹-1" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>Timer3 ä»…ä»…å»¶è¿Ÿäº† 100msï¼Œåè€Œåœ¨å¦å¤–ä¸¤ä¸ª Timer ä¹‹åæ‰§è¡Œäº†ã€‚å…¶å®è¿™é‡ŒåŸå› å¾ˆç®€å•ï¼Œå› ä¸ºåœ¨ Timer1 å’Œ Timer2 åŠ å…¥åˆ°æ‰§è¡Œé˜Ÿåˆ—ä¸­åï¼Œä¸»çº¿ç¨‹ä¾ç„¶è¿˜åœ¨æ‰§è¡Œforå¾ªç¯ä¸­çš„ä»£ç ï¼Œå¤„äºé˜»å¡çŠ¶æ€ã€‚é˜Ÿåˆ—ä¸­çš„ Timer1 å’Œ Timer2 å¹¶ä¸ä¼šå¾—ä»¥æ‰§è¡Œã€‚<strong>å½“forå¾ªç¯ç»“æŸï¼Œè¿™æ—¶æ‰å°† Timer3 äº¤ç”± Timer æ¨¡å—å»ç®¡ç†</strong>(æ³¨æ„ï¼Œä»£ç é¡ºåºæ‰§è¡Œï¼Œforå¾ªç¯çš„æ—¶å€™ï¼Œ Timer3 çš„ <code>setTimeout()</code> è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€ä»¥ä¹Ÿå°±è¿˜æ²¡æœ‰è¢« Timer æ¨¡å—ç®¡ç†)ï¼Œç»§ç»­æ‰§è¡Œåç»­ä»£ç æ‰“å° <code>end</code>ï¼Œæ¸…ç©ºæ‰§è¡Œæ ˆã€‚è™½ç„¶åœ¨è¿™é‡Œ Timer3 çš„å»¶è¿Ÿæ—¶é—´æœ€çŸ­ï¼Œä½†æ˜¯<strong>åŠ å…¥ä»»åŠ¡é˜Ÿåˆ—å</strong>è¿˜æ˜¯ä¼šæ’åœ¨ Timer1 å’Œ Timer2 çš„åé¢ï¼Œæ‰€ä»¥æ­¤æ—¶æŒ‰<strong>é¡ºåºæ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»£ç </strong>ï¼Œä¾æ¬¡æ‰“å°ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰§è¡Œå®Œ <code>console.log(&#39;end&#39;);</code> åï¼Œç«‹åˆ»æ‰§è¡Œäº† Timer1 å’Œ Timer2ï¼Œä½†æ˜¯ Timer3 æ‰§è¡Œæ—¶é—´çº¦åœ¨ä¹‹å 100msï¼Œè¿™æ˜¯å› ä¸ºforå¾ªç¯æ‰§è¡Œçš„æ—¶é—´è¶…è¿‡äº†300msã€‚å¦‚æœforå¾ªç¯åœ¨100msä»¥å†…å®Œæˆï¼Œé‚£ä¹ˆ <code>console.log(&#39;i am run&#39;);</code> ä»ç„¶æ˜¯æœ€å…ˆæ‰§è¡Œçš„ã€‚å¦‚æœforå¾ªç¯åœ¨100msåˆ°200msä¹‹é—´ï¼Œé‚£ä¹ˆ <code>console.log(&#39;i am run&#39;);</code> åœ¨ <code>console.log(&#39;world&#39;);</code> ä¹‹åï¼Œ<code>console.log(&#39;hello&#39;);</code> ä¹‹é—´æ‰§è¡Œã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[HTTPè¯¦è§£]]></title>
      <url>http://zhang759740844.github.io/2016/12/24/HTTP%E7%9A%84%E6%9E%84%E6%88%90/</url>
      <content type="html"><![CDATA[<p>ç½‘ç»œåè®®è¿™å—ä¸€ç›´æ²¡æœ‰æé€å½»ï¼Œè¶ç€è‹¹æœå¼ºåˆ¶ ATSï¼ˆApp Transport Securityï¼‰æœªæœï¼Œå­¦ä¹ ä¸€ä¸‹è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚</p>
<a id="more"></a>
<h2 id="HTTPçš„æ„æˆ"><a href="#HTTPçš„æ„æˆ" class="headerlink" title="HTTPçš„æ„æˆ"></a>HTTPçš„æ„æˆ</h2><h3 id="HTTP-Request"><a href="#HTTP-Request" class="headerlink" title="HTTP Request"></a>HTTP Request</h3><p>http è¯·æ±‚ä¸»è¦åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<code>request line</code>ï¼Œ<code>header</code> å’Œ <code>body</code>ï¼Œä¸­é—´çš„CRLFä¸ºæ¢è¡Œç¬¦ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/httpè¯·æ±‚.png?raw=true" alt="httpè¯·æ±‚ç»„æˆ"></p>
<p>ä¸‹é¢å°†ä»¥ä¸€ä¸ªå®é™…çš„ http è¯·æ±‚æ¥è¯¦ç»†çœ‹çœ‹å…¶å†…éƒ¨æ„é€ ã€‚å‡è®¾æˆ‘ä»¬çš„è¯·æ±‚URLä¸ºï¼š<br><code>http://www.baidu.com/res/static/thirdparty/connect.jpg?t=1480992153433</code></p>
<h4 id="Request-Line"><a href="#Request-Line" class="headerlink" title="Request Line"></a>Request Line</h4><p>è¯·æ±‚è¡Œçš„ç»“æ„ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Request-Line   = Method SP Request-URI SP HTTP-Version CRLF</div></pre></td></tr></table></figure>
<ul>
<li><strong>Method</strong>:è¯·æ±‚ç±»å‹ï¼Œä¾‹å¦‚ <code>post/get</code>ã€‚</li>
<li><strong>SP</strong>:åˆ†éš”ç¬¦ï¼Œä¸€èˆ¬å°±æ˜¯ç©ºæ ¼ã€‚</li>
<li><strong>Request-URI</strong>:å¯¹åº”ä¸Šè¿°è¯·æ±‚ä¸ºï¼š<code>/res/static/thirdparty/connect.jpg?t=1480992153.564331</code>ã€‚æ³¨æ„ï¼ŒRequest-URI ä¹Ÿå¯ä»¥æ˜¯å¸¦ host çš„å®Œæ•´ uriã€‚ä¸å¸¦çš„è¯ï¼Œå°±è¦åœ¨ <code>Header</code> é‡Œæ·»åŠ  hostã€‚</li>
<li><strong>HTTP-Version</strong>:ä»£è¡¨æˆ‘ä»¬å½“å‰ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œä¾‹å¦‚ <code>HTTP/1.1</code></li>
<li><strong>CRLF</strong>:<code>CR</code> å¯¹åº”å›è½¦é”®ï¼Œ<code>LF</code>å¯¹åº”æ¢è¡Œé”®ï¼Œåˆèµ·æ¥å°±æ˜¯æˆ‘ä»¬å¹³å¸¸æ‰€è¯´çš„ <code>\r\n</code>ã€‚</li>
</ul>
<p>æ‰€ä»¥ä¸Šè¿°è¯·æ±‚çš„ Request-Line çš„æ–‡æœ¬å±•ç¤ºï¼š</p>
<blockquote>
<p>GET /res/static/thirdparty/connect.jpg?t=1480992153.564331 HTTP/1.1CRLF</p>
</blockquote>
<h4 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h4><p>header å…¶æœ¬è´¨ä¸Šæ˜¯ä¸€äº›æ–‡æœ¬é”®å€¼å¯¹ï¼Œä¸€ä¸ªå…¸å‹çš„ä¾‹å­å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/http_header.png?raw=true" alt="header"></p>
<p>ç»“æ„ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Key:ç©ºæ ¼ValueCRLF</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è®²è¿° Request-URI çš„æ—¶å€™ï¼Œç¼ºå¤±çš„ <code>Host</code> å°±ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜åœ¨äº header ä¸­ï¼Œæ¯”å¦‚ï¼Œ <code>Hostï¼š pan.baidu.com</code>ã€‚</p>
<p>å°†è‹¥å¹²ä¸ªä¸Šè¿°æ ¼å¼çš„é”®å€¼å¯¹ç»„åˆèµ·æ¥ï¼Œå°±æˆäº†æˆ‘ä»¬ HTTP è¯·æ±‚çš„å®Œæ•´ headerã€‚æœ€åä¸€ä¸ªé”®å€¼å¯¹ä¹‹åå†è·Ÿä¸€ä¸ª <code>CRLF</code>ï¼Œå°±è¡¨ç¤ºæˆ‘ä»¬çš„ header ç»“æŸäº†ã€‚</p>
<h4 id="Body"><a href="#Body" class="headerlink" title="Body"></a>Body</h4><p>body é‡Œé¢åŒ…å«è¯·æ±‚çš„å®é™…æ•°æ®ã€‚</p>
<p>å¯¹äº <code>Method=GET</code> çš„è¯·æ±‚æ¥è¯´ï¼Œbody ä½“æ˜¯ä¸ºç©ºçš„ï¼ŒHeader æœ€åçš„ä¸¤ä¸ª <code>CRLF</code> å°±æ ‡è¯†ç€è¯·æ±‚çš„ç»“å°¾ã€‚æˆ‘ä»¬ä¸€èˆ¬è°ƒç”¨è¯·æ±‚çš„ä¸šåŠ¡å‚æ•°æ˜¯é€šè¿‡ Request Line å½“ä¸­çš„ Request-URI æ¥ä¼ é€’çš„ï¼Œæ¯”å¦‚ä¸Šè¿°è¯·æ±‚ä¸­çš„ <code>?t=1480992153.564331</code>ï¼Œä¹Ÿå°±æ˜¯ URI çš„ query string éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†åŒæ ·æ˜¯ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜åœ¨ï¼Œä¸è¿‡æ˜¯ä½äº Request Line å½“ä¸­ã€‚</p>
<p>å¯¹äº <code>Method=POST</code> çš„è¯·æ±‚æ¥è¯´ï¼Œå®é™…çš„ä¸šåŠ¡æ•°æ®éƒ½å­˜æ”¾äº body å½“ä¸­ã€‚<strong>POST è¯·æ±‚å¯ä»¥æ ¹æ® Header ä¸­çš„ <code>Content-Type</code> å€¼ï¼Œä»¥ä¸åŒçš„å½¢å¼å°†æ•°æ®ä¿å­˜åœ¨ body ä½“ä¸­ã€‚è·å–åˆ°è¯·æ±‚åï¼Œå¯ä»¥ä»ç„¶é€šè¿‡ Header ä¸­çš„ <code>Content-Length</code> å€¼ï¼Œè¯»å–å›ºå®šé•¿åº¦çš„bodyä½“ï¼Œç›´æ¥ä¼ é€’ç»™åº”ç”¨å±‚</strong> </p>
<h3 id="HTTP-Response"><a href="#HTTP-Response" class="headerlink" title="HTTP Response"></a>HTTP Response</h3><p>response çš„ç»“æ„å’Œ request å¤§è‡´ç›¸ä¼¼ï¼Œä¸è¿‡æ˜¯å°† Request Line æ¢æˆäº† Status Line ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/http_response.png?raw=true" alt="http_response"></p>
<p>Status Line çš„ç»“æ„å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Status-Line = HTTP-Version SP Status-Code SP Reason-Phrase CRLF</div></pre></td></tr></table></figure></p>
<h3 id="Content-Type"><a href="#Content-Type" class="headerlink" title="Content-Type"></a>Content-Type</h3><p>Content-Type ç”¨äºæŒ‡å®šå†…å®¹ç±»å‹ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç½‘é¡µä¸­å­˜åœ¨çš„ Content-Typeï¼ŒContent-Type å±æ€§æŒ‡å®š<strong>è¯·æ±‚å’Œå“åº”</strong>çš„ HTTP å†…å®¹ç±»å‹ã€‚å¦‚æœæœªæŒ‡å®š  ContentTypeï¼Œé»˜è®¤ä¸º <code>text/html</code>ã€‚</p>
<p>ä¸€äº›å¸¸è§çš„ Content-Type:</p>
<ul>
<li>text/html</li>
<li>text/plain</li>
<li>text/css</li>
<li>text/javascript</li>
<li>application/x-www-form-urlencoded</li>
<li>multipart/form-data</li>
<li>application/json</li>
<li>application/xml</li>
</ul>
<p>å‰é¢å‡ ä¸ªéƒ½å¾ˆå¥½ç†è§£ï¼Œéƒ½æ˜¯ htmlï¼Œcssï¼Œjavascript çš„æ–‡ä»¶ç±»å‹ï¼Œ<strong>åé¢å››ä¸ªæ˜¯POST çš„å‘åŒ…æ–¹å¼</strong>ã€‚</p>
<p>é‚£æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™ç”¨ <code>application/x-www-form-urlencoded</code>ï¼Œä»€ä¹ˆæ—¶å€™ç”¨ <code>multipart/form-data</code> å‘¢ï¼Ÿå¤§æ–‡ä»¶å¦‚æ–‡ä»¶å›¾ç‰‡ç”¨åè€…ï¼Œå°æ–‡ä»¶å¦‚é”®å€¼å¯¹ç”¨å‰è€…ã€‚</p>
<h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><h3 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a>åŸºæœ¬ä»‹ç»</h3><p>HTTP åè®®ä¼ è¾“çš„æ•°æ®éƒ½æ˜¯æœªåŠ å¯†çš„ï¼Œä¹Ÿå°±æ˜¯æ˜æ–‡çš„ï¼Œå› æ­¤ä½¿ç”¨ HTTP åè®®ä¼ è¾“éšç§ä¿¡æ¯éå¸¸ä¸å®‰å…¨ã€‚æ¯”å¦‚è¿è¥å•†å¯ä»¥è½»æ˜“åŠ«æŒä½ çš„ http è¯·æ±‚ï¼Œåœ¨ response ä¸­æ³¨å…¥ jsä»£ç ï¼ˆå¦‚ç½‘é¡µä¸Šå¼¹çª—å¹¿å‘Šã€æµé‡çƒç­‰ï¼‰ï¼Œç”šè‡³æ˜¯é‡å®šå‘ã€‚ä¸ºäº†ä¿è¯è¿™äº›éšç§æ•°æ®èƒ½åŠ å¯†ä¼ è¾“ï¼Œäºæ˜¯ç½‘æ™¯å…¬å¸è®¾è®¡äº† SSLï¼ˆSecure Sockets Layerï¼‰åè®®ç”¨äºå¯¹ HTTP åè®®ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä»è€Œå°±è¯ç”Ÿäº† HTTPSã€‚ä¹‹åå¯¹ SSL è¿›è¡Œäº†å‡çº§ä¸º TLSï¼ˆTransport Layer Securityï¼‰ã€‚æˆ‘ä»¬ç°åœ¨çš„ HTTPS éƒ½æ˜¯ç”¨çš„ TLS åè®®ã€‚</p>
<h3 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h3><p>æ€»å…±åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p>
<ol>
<li>æµè§ˆå™¨å°†è‡ªå·±æ”¯æŒçš„ä¸€å¥—åŠ å¯†è§„åˆ™å‘é€ç»™ç½‘ç«™ã€‚</li>
<li>ç½‘ç«™ä»ä¸­é€‰å‡ºä¸€ç»„åŠ å¯†ç®—æ³•ä¸ HASH ç®—æ³•ï¼Œå¹¶å°†è‡ªå·±çš„èº«ä»½ä¿¡æ¯ä»¥è¯ä¹¦çš„å½¢å¼å‘å›ç»™æµè§ˆå™¨ã€‚è¯ä¹¦é‡Œé¢åŒ…å«äº†ç½‘ç«™åœ°å€ï¼ŒåŠ å¯†å…¬é’¥ï¼Œä»¥åŠè¯ä¹¦çš„é¢å‘æœºæ„ç­‰ä¿¡æ¯ã€‚</li>
<li>è·å¾—ç½‘ç«™è¯ä¹¦ä¹‹åæµè§ˆå™¨è¦åšä»¥ä¸‹å·¥ä½œï¼š<ol>
<li>éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§ï¼ˆé¢å‘è¯ä¹¦çš„æœºæ„æ˜¯å¦åˆæ³•ï¼Œè¯ä¹¦ä¸­åŒ…å«çš„ç½‘ç«™åœ°å€æ˜¯å¦ä¸æ­£åœ¨è®¿é—®çš„åœ°å€ä¸€è‡´ç­‰ï¼‰ï¼Œå¦‚æœè¯ä¹¦å—ä¿¡ä»»ï¼Œåˆ™æµè§ˆå™¨æ é‡Œé¢ä¼šæ˜¾ç¤ºä¸€ä¸ªå°é”å¤´ï¼Œå¦åˆ™ä¼šç»™å‡ºè¯ä¹¦ä¸å—ä¿¡çš„æç¤ºã€‚</li>
<li>å¦‚æœè¯ä¹¦å—ä¿¡ä»»ï¼Œæˆ–è€…æ˜¯ç”¨æˆ·æ¥å—äº†ä¸å—ä¿¡çš„è¯ä¹¦ï¼Œæµè§ˆå™¨ä¼šç”Ÿæˆä¸€ä¸²éšæœºæ•°çš„å¯†ç ï¼Œå¹¶ç”¨è¯ä¹¦ä¸­æä¾›çš„å…¬é’¥åŠ å¯†ã€‚</li>
<li>ä½¿ç”¨çº¦å®šå¥½çš„HASHè®¡ç®—æ¡æ‰‹æ¶ˆæ¯ï¼Œå¹¶ä½¿ç”¨ç”Ÿæˆçš„éšæœºæ•°å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼Œæœ€åå°†ä¹‹å‰ç”Ÿæˆçš„æ‰€æœ‰ä¿¡æ¯å‘é€ç»™ç½‘ç«™ã€‚</li>
</ol>
</li>
<li>ç½‘ç«™æ¥æ”¶æµè§ˆå™¨å‘æ¥çš„æ•°æ®ä¹‹åè¦åšä»¥ä¸‹çš„æ“ä½œï¼š<ol>
<li>ä½¿ç”¨è‡ªå·±çš„ç§é’¥å°†ä¿¡æ¯è§£å¯†å–å‡ºå¯†ç ï¼Œä½¿ç”¨å¯†ç è§£å¯†æµè§ˆå™¨å‘æ¥çš„æ¡æ‰‹æ¶ˆæ¯ï¼Œå¹¶éªŒè¯HASHæ˜¯å¦ä¸æµè§ˆå™¨å‘æ¥çš„ä¸€è‡´ã€‚</li>
<li>ä½¿ç”¨å¯†ç åŠ å¯†ä¸€æ®µæ¡æ‰‹æ¶ˆæ¯ï¼Œå‘é€ç»™æµè§ˆå™¨ã€‚</li>
</ol>
</li>
<li>æµè§ˆå™¨è§£å¯†å¹¶è®¡ç®—æ¡æ‰‹æ¶ˆæ¯çš„HASHï¼Œå¦‚æœä¸æœåŠ¡ç«¯å‘æ¥çš„HASHä¸€è‡´ï¼Œæ­¤æ—¶æ¡æ‰‹è¿‡ç¨‹ç»“æŸï¼Œä¹‹åæ‰€æœ‰çš„é€šä¿¡æ•°æ®å°†ç”±ä¹‹å‰æµè§ˆå™¨ç”Ÿæˆçš„éšæœºå¯†ç å¹¶åˆ©ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†ã€‚</li>
</ol>
<p>è¿™é‡Œæµè§ˆå™¨ä¸ç½‘ç«™äº’ç›¸å‘é€åŠ å¯†çš„æ¡æ‰‹æ¶ˆæ¯å¹¶éªŒè¯ï¼Œç›®çš„æ˜¯ä¸ºäº†ä¿è¯åŒæ–¹éƒ½è·å¾—äº†ä¸€è‡´çš„å¯†ç ï¼Œå¹¶ä¸”å¯ä»¥æ­£å¸¸çš„åŠ å¯†è§£å¯†æ•°æ®ï¼Œä¸ºåç»­çœŸæ­£æ•°æ®çš„ä¼ è¾“åšä¸€æ¬¡æµ‹è¯•ã€‚</p>
<p>å…¶ä¸­<strong>éå¯¹ç§°åŠ å¯†ç®—æ³•ç”¨äºåœ¨æ¡æ‰‹è¿‡ç¨‹ä¸­åŠ å¯†ç”Ÿæˆçš„å¯†ç </strong>ï¼Œ<strong>å¯¹ç§°åŠ å¯†ç®—æ³•ç”¨äºå¯¹çœŸæ­£ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†</strong>ï¼Œè€Œ <strong>HASH ç®—æ³•ç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§</strong>ã€‚ç”±äºæµè§ˆå™¨ç”Ÿæˆçš„å¯†ç æ˜¯æ•´ä¸ªæ•°æ®åŠ å¯†çš„å…³é”®ï¼Œå› æ­¤åœ¨ä¼ è¾“çš„æ—¶å€™ä½¿ç”¨äº†éå¯¹ç§°åŠ å¯†ç®—æ³•å¯¹å…¶åŠ å¯†ã€‚éå¯¹ç§°åŠ å¯†ç®—æ³•ä¼šç”Ÿæˆå…¬é’¥å’Œç§é’¥ï¼Œå…¬é’¥åªèƒ½ç”¨äºåŠ å¯†æ•°æ®ï¼Œå› æ­¤å¯ä»¥éšæ„ä¼ è¾“ï¼Œè€Œç½‘ç«™çš„ç§é’¥ç”¨äºå¯¹æ•°æ®è¿›è¡Œè§£å¯†ï¼Œæ‰€ä»¥ç½‘ç«™éƒ½ä¼šéå¸¸å°å¿ƒçš„ä¿ç®¡è‡ªå·±çš„ç§é’¥ï¼Œé˜²æ­¢æ³„æ¼ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸ç›´æ¥å…¨ç¨‹ä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ˜¯å› ä¸ºéå¯¹ç§°ç®—æ³•çš„æ•ˆç‡å¯¹æ¯”èµ·å¯¹ç§°ç®—æ³•æ¥è¯´ï¼Œè¦ä½å¾—å¤šå¾—å¤šï¼›å› æ­¤å¾€å¾€åªç”¨åœ¨HTTPSçš„æ¡æ‰‹é˜¶æ®µã€‚</p>
<h3 id="è¯ä¹¦çš„éªŒè¯è¿‡ç¨‹"><a href="#è¯ä¹¦çš„éªŒè¯è¿‡ç¨‹" class="headerlink" title="è¯ä¹¦çš„éªŒè¯è¿‡ç¨‹"></a>è¯ä¹¦çš„éªŒè¯è¿‡ç¨‹</h3><p>è¯ä¹¦ä»¥è¯ä¹¦é“¾çš„å½¢å¼ç»„ç»‡ï¼Œåœ¨é¢å‘è¯ä¹¦çš„æ—¶å€™é¦–å…ˆè¦æœ‰æ ¹CAæœºæ„é¢å‘çš„æ ¹è¯ä¹¦ï¼Œå†ç”±æ ¹CAæœºæ„é¢å‘ä¸€ä¸ªä¸­çº§CAæœºæ„çš„è¯ä¹¦ï¼Œæœ€åç”±ä¸­çº§CAæœºæ„é¢å‘å…·ä½“çš„SSLè¯ä¹¦ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£ï¼Œæ ¹CAæœºæ„å°±æ˜¯ä¸€ä¸ªå…¬å¸ï¼Œæ ¹è¯ä¹¦å°±æ˜¯ä»–çš„èº«ä»½å‡­è¯ï¼Œæ¯ä¸ªå…¬å¸ç”±ä¸åŒçš„éƒ¨é—¨æ¥é¢å‘ä¸åŒç”¨é€”çš„è¯ä¹¦ï¼Œè¿™äº›ä¸åŒçš„éƒ¨é—¨å°±æ˜¯ä¸­çº§CAæœºæ„ï¼Œè¿™äº›ä¸­çº§CAæœºæ„ä½¿ç”¨ä¸­çº§è¯ä¹¦ä½œä¸ºè‡ªå·±çš„èº«ä»½å‡­è¯ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªéƒ¨é—¨æ˜¯ä¸“é—¨é¢å‘SSLè¯ä¹¦ï¼Œå½“æŠŠæ ¹è¯ä¹¦ï¼Œä¸­çº§è¯ä¹¦ï¼Œä»¥åŠæœ€åç”³è¯·çš„SSLè¯ä¹¦è¿åœ¨ä¸€èµ·å°±å½¢æˆäº†è¯ä¹¦é“¾ï¼Œä¹Ÿç§°ä¸ºè¯ä¹¦è·¯å¾„ã€‚åœ¨éªŒè¯è¯ä¹¦çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè°ƒç”¨ç³»ç»Ÿçš„è¯ä¹¦ç®¡ç†å™¨æ¥å£å¯¹è¯ä¹¦è·¯å¾„ä¸­çš„æ‰€æœ‰è¯ä¹¦ä¸€çº§ä¸€çº§çš„è¿›è¡ŒéªŒè¯ï¼Œåªæœ‰è·¯å¾„ä¸­æ‰€æœ‰çš„è¯ä¹¦éƒ½æ˜¯å—ä¿¡çš„ï¼Œæ•´ä¸ªéªŒè¯çš„ç»“æœæ‰æ˜¯å—ä¿¡ã€‚æ“ä½œç³»ç»Ÿåœ¨å®‰è£…è¿‡ç¨‹ä¸­ä¼šé»˜è®¤å®‰è£…ä¸€äº›å—ä¿¡ä»»çš„CAæœºæ„çš„æ ¹è¯ä¹¦ã€‚</p>
<h3 id="SSLåŠ«æŒ"><a href="#SSLåŠ«æŒ" class="headerlink" title="SSLåŠ«æŒ"></a>SSLåŠ«æŒ</h3><p>SSL åŠ«æŒä¹Ÿå°±æ˜¯ SSL è¯ä¹¦æ¬ºéª—æ”»å‡»ï¼Œæ”»å‡»è€…ä¸ºäº†è·å¾— HTTPS ä¼ è¾“çš„æ˜æ–‡æ•°æ®ï¼Œéœ€è¦å…ˆå°†è‡ªå·±æ¥å…¥åˆ°æµè§ˆå™¨ä¸ç›®æ ‡ç½‘ç«™ä¹‹é—´ï¼ˆä¸­é—´äººï¼‰ï¼Œåœ¨ä¼ è¾“æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œæ›¿æ¢ç›®æ ‡ç½‘ç«™å‘ç»™æµè§ˆå™¨çš„è¯ä¹¦ï¼Œä¹‹åè§£å¯†ä¼ è¾“ä¸­çš„æ•°æ®ï¼Œç®€å•çš„å›¾ç¤ºå¦‚ä¸‹ï¼š</p>
<blockquote>
<p>[æµè§ˆå™¨] &lt;======&gt; [ç›®æ ‡ç½‘ç«™] ï¼ˆæ­£å¸¸æƒ…å†µï¼‰<br>[æµè§ˆå™¨] &lt;======&gt; ä¸­é—´äºº &lt;======&gt; [ç›®æ ‡ç½‘ç«™] ï¼ˆä¸­é—´äººæ”»å‡»ï¼‰</p>
</blockquote>
<p>ä¸­é—´äººæ”»å‡»æœ€å¥½çš„ç¯å¢ƒæ˜¯åœ¨å±€åŸŸç½‘ä¸­ï¼Œå±€åŸŸç½‘ä¸­æ‰€æœ‰çš„è®¡ç®—æœºéœ€è¦é€šè¿‡ä¸€ä¸ªå›ºå®šçš„å‡ºå£ï¼ˆç½‘å…³ï¼‰æ¥æ¥å…¥äº’è”ç½‘ï¼Œå› æ­¤æ”»å‡»è€…åªéœ€è¦åœ¨å±€åŸŸç½‘ä¸­å®æ–½ä¸€æ¬¡ä¸­é—´äººæ”»å‡»å°±å¯ä»¥é¡ºåˆ©çš„æˆªè·æ‰€æœ‰è®¡ç®—æœºä¸ç½‘å…³ä¹‹é—´ä¼ è¾“çš„æ•°æ®ã€‚</p>
<p><strong>ä¸­é—´äººæ”»å‡»(Man-in-the-Middle Attackï¼Œç¼©å†™ MITM)</strong>ã€‚</p>
<p><a href="http://www.guokr.com/post/114121/" target="_blank" rel="external">å‚è€ƒé“¾æ¥:HTTPSé‚£äº›äº‹ï¼ˆä¸€ï¼‰HTTPSåŸç†</a></p>
<h2 id="æŠ“åŒ…å·¥å…·-mitmproxy-ä½¿ç”¨"><a href="#æŠ“åŒ…å·¥å…·-mitmproxy-ä½¿ç”¨" class="headerlink" title="æŠ“åŒ…å·¥å…· mitmproxy ä½¿ç”¨"></a>æŠ“åŒ…å·¥å…· mitmproxy ä½¿ç”¨</h2><p>mitmproxy æ˜¯ä¸€æ¬¾å‘½ä»¤è¡ŒæŠ“åŒ…å·¥å…·ï¼Œå®ƒé™¤äº†å¯ä»¥æŠ“åŒ…æŸ¥çœ‹ http/https è¯·æ±‚ï¼Œè¿˜å¯ä»¥æ‹¦æˆªå¹¶ä¿®æ”¹ request æˆ–è€… responseã€‚</p>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>é¦–å…ˆéœ€è¦å®‰è£… python çš„åŒ…ç®¡ç†å·¥å…· pipã€‚ OSX El Capitan åŠä»¥ä¸Šçš„ç³»ç»Ÿç‰ˆæœ¬åœ¨å®‰è£…æ—¶ä¼šå‡ºç° six æ¨¡å—ä¾èµ–é”™è¯¯ï¼Œæ‰€ä»¥éœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo pip install mitmproxy --ignore-installed six</div></pre></td></tr></table></figure>
<h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€å±€åŸŸç½‘ä¸‹ï¼Œè®¾ç½®æ‰‹æœºçš„ http ä»£ç†ã€‚æœåŠ¡å™¨ä¸ºç”µè„‘å½“å‰çš„ ipï¼Œå¦‚ 192.168.3.10ï¼›ç«¯å£å¯ä»»æ„è®¾ç½®ï¼Œä¸€èˆ¬è®¾ç½®ä¸º8080ã€‚ç½‘ç»œç¯å¢ƒé…ç½®å¥½åï¼Œåœ¨ç»ˆç«¯è¾“å…¥ <code>mitmproxy -p 8080</code>ï¼Œè¿›å…¥æŠ“åŒ…æ¨¡å¼ã€‚</p>
<p>å¦‚æœæƒ³è¦æŠ“å– https çš„åŒ…ï¼Œéœ€è¦è¿›ä¸€æ­¥é…ç½®ã€‚ç”¨ iPhone æ‰“å¼€ Safari æµè§ˆå™¨å¹¶è¾“å…¥ mitm.itï¼Œè¿™æ—¶ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼Œé€‰æ‹©å¯¹åº”å¹³å°å¹¶å®‰è£…è¯ä¹¦ï¼Œå®‰è£…å®Œæˆåå°±å¯ä»¥æŠ“ https çš„åŒ…äº†ã€‚æ³¨æ„ï¼Œç”¨æµè§ˆå™¨æ‰“å¼€æ—¶éœ€è¦å·²ç»åœ¨æŠ“åŒ…æ¨¡å¼ï¼Œå¦åˆ™æ˜¯æ— æ³•çœ‹åˆ°ä¸Šè¿°é¡µé¢çš„ã€‚</p>
<p>æŠ“åŒ…è½¯ä»¶ç›¸å½“äºåœ¨ç”¨æˆ·å’ŒæœåŠ¡å™¨é—´å¢åŠ äº†ä¸€ä¸ªä¸­é—´äººã€‚å®‰è£…æŠ“åŒ…è½¯ä»¶çš„è¯ä¹¦ï¼Œè¿™æ ·ä¸­é—´äººå°±å¯ä»¥è·å¾—ç”¨æˆ·ç«¯ç”Ÿæˆçš„å¯†é’¥ï¼Œå°±èƒ½å¤Ÿè§£å¯†ç”¨æˆ·å’ŒæœåŠ¡å™¨é—´çš„ä¿¡æ¯ã€‚<strong>æ³¨æ„ï¼Œä¸€å®šä¸å¯éšæ„ä¸‹è½½ä¿¡ä»»ä¸æ˜çš„è¯ä¹¦</strong></p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/httpproxy_certificate.png?raw=true" alt="ä¸‹è½½è¯ä¹¦"></p>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>éšä¾¿æ‰“å¼€ä¸€ä¸ª appï¼Œå°±å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„ä¸€ä¸ªè¯·æ±‚åˆ—è¡¨ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/http_request.png?raw=true" alt="httpè¯·æ±‚åˆ—è¡¨"></p>
<p>å¸¸ç”¨å¿«æ·é”®ï¼š</p>
<ul>
<li>enter: æŸ¥çœ‹è¯¦ç»†è¯·æ±‚</li>
<li>Tab: åˆ‡æ¢é¡¶éƒ¨å¯¼èˆªæ </li>
<li>z: æ¸…ç©ºåˆ—è¡¨</li>
<li>f: è¿‡æ»¤è¯·æ±‚ã€‚å¯ä»¥å‚ç…§å¸®åŠ©ä¸­çš„ Filter expression å¯¹è¿‡æ»¤å…³é”®å­—è¿›è¡Œç¼–è¾‘ã€‚åˆ é™¤è¿‡æ»¤å°±æ˜¯å°†è¿‡æ»¤å…³é”®å­—æ¸…ç©ºã€‚</li>
<li>d: åˆ é™¤è¯·æ±‚</li>
<li>C: å¤åˆ¶è¯·æ±‚ã€‚ç›´æ¥é€‰ä¸­å¤åˆ¶å¯èƒ½ä¼šå¤åˆ¶è¿›ç©ºæ ¼éå¸¸éº»çƒ¦ï¼Œå¯ä»¥é€šè¿‡ C æ¥é€‰æ‹©å¤åˆ¶çš„å†…å®¹ã€‚</li>
</ul>
<p>å…³äºå¦‚ä½•æ‹¦æˆªå’Œä¿®æ”¹ request å’Œ response å¯ä»¥å‚è§<a href="http://ios.jobbole.com/90841/" target="_blank" rel="external">æŠ“åŒ…æ•™ç¨‹</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[hexo é…ç½®é‡åˆ°çš„ä¸€äº›å‘]]></title>
      <url>http://zhang759740844.github.io/2016/12/03/hexo%E7%88%AC%E8%BF%87%E7%9A%84%E5%9D%91/</url>
      <content type="html"><![CDATA[<p>é…ç½®ä¸ªäººåšå®¢æœ‰æ—¶å€™æ˜¯ä¸€ä»¶å¾ˆè›‹ç–¼çš„äº‹æƒ…ï¼Œç»å¸¸ä¼šå‡ºç°ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ã€‚è¿™é‡Œæˆ‘å°±å°†æŠŠæˆ‘å¡«ä¸Šçš„ä¸€äº›å‘æ€»ç»“ä¸€ä¸‹ã€‚</p>
<a id="more"></a>
<h3 id="å„ç§éƒ¨ç½²çš„å†…å®¹å’Œæœ¬åœ°ä¸ä¸€è‡´"><a href="#å„ç§éƒ¨ç½²çš„å†…å®¹å’Œæœ¬åœ°ä¸ä¸€è‡´" class="headerlink" title="å„ç§éƒ¨ç½²çš„å†…å®¹å’Œæœ¬åœ°ä¸ä¸€è‡´"></a>å„ç§éƒ¨ç½²çš„å†…å®¹å’Œæœ¬åœ°ä¸ä¸€è‡´</h3><p>æœ‰æ—¶å€™ hexo ä¼šæŠ½é£ï¼Œæœ‰äº›æ–‡ä»¶æ— è®ºæ€ä¹ˆ <code>hexo g</code> éƒ½ deploy ä¸ä¸Šå»ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥è¾“å…¥ <code>hexo clean</code>ï¼Œåˆ é™¤ database å’Œ public æ–‡ä»¶å¤¹ï¼Œå† generate å’Œ deploy å°±å¯ä»¥éƒ¨ç½²æˆåŠŸäº†ã€‚ </p>
<h3 id="nextä¸»é¢˜ç©ºç™½"><a href="#nextä¸»é¢˜ç©ºç™½" class="headerlink" title="nextä¸»é¢˜ç©ºç™½"></a>nextä¸»é¢˜ç©ºç™½</h3><p>è¿™æ˜¯16å¹´11æœˆä»½çš„é—®é¢˜ï¼Œçªç„¶æ‰“å¼€è‡ªå·±çš„åšå®¢å‘ç°ä¸€ç‰‡ç©ºç™½ï¼Œä½†æ˜¯åœ¨æœ¬åœ° <code>hexo s</code> å°±èƒ½å¤Ÿæ˜¾ç¤ºå‡ºæ¥ã€‚åŸæœ¬ä»¥ä¸ºæ˜¯æˆ‘è¿œç«¯ä»“åº“å‡ºäº†é—®é¢˜ï¼Œå°±é‡å»ºäº†ä¸ªæ–°çš„ï¼Œä½†æ˜¯æ²¡æœ‰æ•ˆæœã€‚å¾ˆæ€¥å¾ˆéš¾å—ã€‚ç½‘ä¸Šæœç´¢çœŸçš„éš¾ï¼Œä»¥ä¸ºæˆ‘ä¸çŸ¥é“æœ‰æ²¡æœ‰äººé‡åˆ°è¿‡è¿™æ ·çš„é—®é¢˜ï¼Œå¹¶ä¸”æˆ‘ä¹Ÿä¸çŸ¥é“è¯¥æ€ä¹ˆå»æè¿°è¿™ä¸ªå‡ºç°çš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œå‡ ç»æ³¢æŠ˜ï¼Œè¿˜æ˜¯æ‰¾åˆ°äº†è§£å†³çš„æ–¹æ¡ˆã€‚</p>
<p>å› ä¸º Github åœ¨ 11æœˆ3æ—¥çš„æ›´æ–°ä¸­å¿½ç•¥äº† <code>venders</code> å’Œ <code>node_modules</code> ä¸¤ä¸ªæ–‡ä»¶å¤¹ã€‚äºæ˜¯å°±æ‰“ä¸å¼€ <code>venders</code> ç›®å½•ä¸‹çš„ js æ–‡ä»¶äº†ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•è§£å†³å‘¢ï¼Ÿ<code>next</code> çš„ä½œè€…æ¨èæˆ‘ä»¬ä¿®æ”¹ <code>venders</code> æ–‡ä»¶å¤¹åã€‚æ¯”å¦‚å°† <code>source/venders</code> ä¿®æ”¹æˆ <code>source/libs</code>ã€‚åŒæ—¶ï¼Œä¿®æ”¹ä¸»é¢˜ä¸‹çš„é…ç½®æ–‡ä»¶ <code>_config.yml</code>,å°† <code>_internal: venders</code> ä¿®æ”¹æˆä¹‹å‰ä¿®æ”¹çš„åå­—ï¼Œå¦‚ <code>_internal: libs</code>ã€‚</p>
<p>å½“ç„¶ï¼Œå¦‚æœæ˜¯ç›´æ¥å…‹éš†çš„ <code>next</code> ä¸»é¢˜ï¼Œå¯ä»¥é€šè¿‡ <code>git pull</code> ç›´æ¥æ‹‰å– <code>next</code> ä½œè€…çš„ä¿®æ”¹ã€‚</p>
<h3 id="ç¼ºå°‘-DTraceProviderBindings-æ¨¡å—"><a href="#ç¼ºå°‘-DTraceProviderBindings-æ¨¡å—" class="headerlink" title="ç¼ºå°‘ DTraceProviderBindings æ¨¡å—"></a>ç¼ºå°‘ DTraceProviderBindings æ¨¡å—</h3><p>è¿™æ˜¯åœ¨æ¢äº† Macï¼Œé‡æ–°å®‰è£… hexo åï¼Œ<code>hexo g</code> æ—¶å‡ºç°çš„é—®é¢˜ã€‚ä¼šå‡ºç°å¦‚ä¸‹ Error æç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123; [Error: Cannot find module &apos;./build/Release/DTraceProviderBindings&apos;] code: &apos;MODULE_NOT_FOUND&apos; &#125;</div><div class="line">&#123; [Error: Cannot find module &apos;./build/default/DTraceProviderBindings&apos;] code: &apos;MODULE_NOT_FOUND&apos; &#125;</div><div class="line">&#123; [Error: Cannot find module &apos;./build/Debug/DTraceProviderBindings&apos;] code: &apos;MODULE_NOT_FOUND&apos; &#125;</div></pre></td></tr></table></figure>
<p>è™½ç„¶ç»“æœä¸Šæ¥è¯´å¹¶ä¸å½±å“ hexo çš„æ‰§è¡Œï¼Œä½†æ˜¯æ¯æ¬¡éƒ½æç¤ºè¿˜æ˜¯å¾ˆè®©äººä¸çˆ½çš„ã€‚äºæ˜¯ï¼Œæœç´¢äº†ä¸€ä¸‹ï¼Œç½‘ä¸Šç¡®å®æœ‰å¾ˆå¤šè®¨è®ºè¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ³•çš„ã€‚ä¸€èˆ¬æ¯”è¾ƒå¤šçš„æ–¹å¼æ˜¯ä½¿ç”¨ <code>npm install hexo --no-optional</code> å®‰è£… hexoï¼ˆä¸€èˆ¬å®‰è£…è¿˜æ˜¯å°† hexo å®‰è£…æˆå…¨å±€çš„å§ï¼Œä½¿ç”¨ <code>-g</code> é€‰é¡¹ï¼‰ã€‚</p>
<p>ä½†æ˜¯æˆ‘ç”¨äº†è¿™ä¸ªæ–¹å¼åï¼Œå¹¶æ²¡æœ‰æ•ˆæœï¼Œç„¶ååˆæŸ¥äº†å‡ ç§æ–¹å¼éƒ½ä¸è¡Œï¼Œå°±å¾ˆæ°”ã€‚ç„¶åå°±çœ‹ hexo çš„å®‰è£…æ–‡æ¡£ï¼Œçªç„¶çµå…‰ä¸€é—ªã€‚å› ä¸ºç°åœ¨å®‰è£… hexo çš„æ–¹å¼å˜æˆäº† <code>npm install hexo-cli -g</code>ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯è¯´åŸæœ¬çš„  <code>npm install hexo</code> æ–¹å¼å·²ç»è¢«åºŸå¼ƒäº†å‘¢ï¼Ÿ äºæ˜¯æˆ‘å°±å°è¯•åœ¨ç»ˆç«¯è¾“å…¥ <code>npm install hexo-cli -g --no-optional</code>ã€‚æœç„¶å°±æ²¡æœ‰è¿™ä¸ª Error äº†ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[React-Native ä½¿ç”¨æ–¹å¼]]></title>
      <url>http://zhang759740844.github.io/2016/11/25/RN%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>è¿™é‡ŒåŸºäº0.39çš„å®˜æ–¹æ–‡æ¡£ï¼Œåˆ—ä¸¾äº†ä¸€äº›éœ€è¦çŸ¥é“çš„ç‚¹ã€‚</p>
<a id="more"></a>
<h3 id="AppRegistry"><a href="#AppRegistry" class="headerlink" title="AppRegistry"></a>AppRegistry</h3><p><code>index.ios.js</code> ä½œä¸ºä¸€ä¸ªç»„ä»¶çš„æ³¨å†Œé›†åˆä»¥åŠå…¥å£ï¼Œåœ¨è¿™é‡Œï¼Œå°†æ‰€æœ‰ç»„ä»¶åƒè¿™æ ·æ³¨å†Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">AppRegistry.registerComponent(<span class="string">'HelloApp'</span>, () =&gt; HellodApp);</div><div class="line">AppRegistry.registerComponent(<span class="string">'HelloWorldApp'</span>, () =&gt; HelloWorldApp);</div></pre></td></tr></table></figure>
<h3 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h3><h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>ç»„ä»¶åœ¨åˆ›å»ºçš„æ—¶å€™ä¼ å…¥ <code>Props</code> æ¥å®Œæˆå®šåˆ¶ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;Image source=&#123;pic&#125; style=&#123;&#123;width: <span class="number">193</span>, height: <span class="number">110</span>&#125;&#125; /&gt;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ <code>source</code>,<code>style</code> éƒ½æ˜¯ä¼ å…¥ image çš„ <code>Props</code>ã€‚å…¶ä¸­ <code>pic</code> è¡¨ç¤ºä¸€ä¸ªjså¯¹è±¡ï¼Œç±»ä¼¼åé¢çš„ <code>{width: 193, height: 110}</code>ã€‚</p>
<p><code>{pic}</code> å¤–é¢æœ‰ä¸ªæ‹¬å·ï¼Œè¡¨ç¤ºæ‹¬å·å†…æ˜¯ä¸€ä¸ªjså˜é‡æˆ–è€…è¡¨è¾¾å¼ï¼Œéœ€è¦æ‰§è¡Œåå–å€¼ï¼Œä»¥æ­¤<strong>åœ¨JSXä¸­åµŒå…¥jsè¯­å¥</strong>ã€‚</p>
<h4 id="è‡ªå®šä¹‰ç»„ä»¶çš„-Props"><a href="#è‡ªå®šä¹‰ç»„ä»¶çš„-Props" class="headerlink" title="è‡ªå®šä¹‰ç»„ä»¶çš„ Props"></a>è‡ªå®šä¹‰ç»„ä»¶çš„ Props</h4><p>è‡ªå®šä¹‰ç»„ä»¶å¯ä»¥æé«˜å¤ç”¨æ€§ã€‚ä½¿ç”¨æ—¶åœ¨å‡½æ•°ä¸­å¼•ç”¨ <code>this.props.å±æ€§å</code>ï¼Œä¾‹å¦‚ä¸‹é¢çš„ <code>name</code> å±æ€§ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;Text&gt;Hello &#123;this.props.name&#125;!&lt;/Text&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LotsOfGreetings</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;View style=&#123;&#123;alignItems: 'center'&#125;&#125;&gt;</div><div class="line">        &lt;Greeting name='Rexxar' /&gt;</div><div class="line">        &lt;Greeting name='Jaina' /&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p>é€šè¿‡ <code>Props</code>,<code>State</code> æ§åˆ¶ç»„ä»¶ã€‚<code>Props</code> åœ¨çˆ¶ç»„ä»¶ä¸­æŒ‡å®šï¼Œä¸€ç»æŒ‡å®šï¼Œä¸èƒ½æ”¹å˜ã€‚å¯¹äºéœ€è¦æ”¹å˜çš„ç»„ä»¶ï¼Œè¦ä½¿ç”¨ <code>state</code>ã€‚</p>
<p>ä¸€èˆ¬è¦åœ¨ <code>constructor</code> ä¸­åˆå§‹åŒ– <code>state</code>(é€šè¿‡ <code>getInitialState</code> æ–¹æ³•ä¸ºes5æ–¹æ³•ï¼Œå·²è¢«æ·˜æ±°)ï¼Œéœ€è¦ä¿®æ”¹æ—¶è°ƒç”¨ <code>setState</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Blink</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(props) &#123;</div><div class="line">    <span class="keyword">super</span>(props);</div><div class="line">    <span class="keyword">this</span>.state = &#123; showText: <span class="literal">true</span> &#125;;</div><div class="line"></div><div class="line">    <span class="comment">// æ¯1000æ¯«ç§’å¯¹showTextçŠ¶æ€åšä¸€æ¬¡å–åæ“ä½œ</span></div><div class="line">    setInterval(() =&gt; &#123;</div><div class="line">      <span class="keyword">this</span>.setState(&#123; showText: !<span class="keyword">this</span>.state.showText &#125;);</div><div class="line">    &#125;, <span class="number">1000</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="comment">// æ ¹æ®å½“å‰showTextçš„å€¼å†³å®šæ˜¯å¦æ˜¾ç¤ºtextå†…å®¹</span></div><div class="line">    <span class="keyword">let</span> display = <span class="keyword">this</span>.state.showText ? <span class="keyword">this</span>.props.text : <span class="string">' '</span>;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;Text&gt;&#123;display&#125;&lt;/Text&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BlinkApp</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;View&gt;</div><div class="line">        &lt;Blink text='I love to blink' /&gt;</div><div class="line">        &lt;Blink text='Yes blinking is so great' /&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ä¸­ text æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ç”¨ <code>Props</code> åœ¨çˆ¶æ§ä»¶åˆ›å»ºçš„æ—¶å€™ä¼ å…¥ã€‚åœ¨æ„é€ å‡½æ•°çš„æ—¶å€™åˆ›å»ºäº† <code>State</code> å’Œå…¶å±æ€§ <code>showText</code>ã€‚å½“ç„¶ï¼Œè¿˜å¯ä»¥å†è¿™é‡Œåˆå§‹åŒ–ä»»æ„å¤šä¸ªå±æ€§ï¼Œç”¨é€—å·éš”å¼€ï¼Œç›¸å½“äºåˆ›å»ºä¸€ä¸ª <code>state</code> å¯¹è±¡ã€‚ä½¿ç”¨çš„æ—¶å€™ç›´æ¥å¯ä»¥ç‚¹å‡ºæ¥ï¼š<code>this.state.showText</code>ã€‚æƒ³è¦ä¿®æ”¹çš„æ—¶å€™è°ƒç”¨ <code>this.setState()</code> æ–¹æ³•ï¼Œå°†è¦ä¿®æ”¹çš„å±æ€§ç»„æˆå¯¹è±¡ä¼ å…¥ã€‚</p>
<p>æ‹“å±•ï¼šå¯ä»¥å­¦ä¹ ä¸€ä¸‹çŠ¶æ€å®¹å™¨å¦‚ï¼š<code>Redux</code>ã€‚å¦å¤–ï¼Œå…³äº <code>state</code> çš„æ›´å¤šåŸç†ï¼Œå¯ä»¥å‚è€ƒ <code>React.js</code>ã€‚</p>
<h3 id="StyleSheet"><a href="#StyleSheet" class="headerlink" title="StyleSheet"></a>StyleSheet</h3><p>ç›¸å½“äºä¸€ä¸ªæ ·å¼åˆé›†ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; AppRegistry, StyleSheet, Text, View &#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</div><div class="line">  bigblue: &#123;</div><div class="line">    color: <span class="string">'blue'</span>,</div><div class="line">    fontWeight: <span class="string">'bold'</span>,</div><div class="line">    fontSize: <span class="number">30</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//ä½¿ç”¨ï¼š</span></div><div class="line">&lt;View style=&#123;styles.bigblue&#125;/&gt;</div></pre></td></tr></table></figure>
<h3 id="flex"><a href="#flex" class="headerlink" title="flex"></a>flex</h3><p>åœ¨ <code>style</code> ä¸­é€šè¿‡flexå¯ä»¥çµæ´»åœ°å°†ç»„ä»¶æ’‘æ»¡æ•´ä¸ªå±å¹•ã€‚</p>
<p>ç»„ä»¶èƒ½å¤Ÿæ’‘æ»¡å‰©ä½™ç©ºé—´çš„å‰ææ˜¯å…¶çˆ¶å®¹å™¨çš„å°ºå¯¸ä¸ä¸ºé›¶ã€‚å¦‚æœçˆ¶å®¹å™¨æ—¢æ²¡æœ‰å›ºå®šçš„ <code>width</code> å’Œ <code>height</code>ï¼Œä¹Ÿæ²¡æœ‰è®¾å®š <code>flex</code>ï¼Œåˆ™çˆ¶å®¹å™¨çš„å°ºå¯¸ä¸ºé›¶ã€‚å…¶å­ç»„ä»¶å¦‚æœä½¿ç”¨äº† <code>flex</code>ï¼Œä¹Ÿæ˜¯æ— æ³•æ˜¾ç¤ºçš„ã€‚</p>
<h3 id="flexboxå¸ƒå±€"><a href="#flexboxå¸ƒå±€" class="headerlink" title="flexboxå¸ƒå±€"></a>flexboxå¸ƒå±€</h3><h4 id="flexDirection"><a href="#flexDirection" class="headerlink" title="flexDirection"></a>flexDirection</h4><p>åœ¨ <code>style</code> ä¸­æŒ‡å®šå¸ƒå±€çš„<strong>ä¸»è½´</strong>ï¼Œæ˜¯ <code>row</code> è¿˜æ˜¯ <code>column</code>ã€‚é»˜è®¤æ˜¯ <code>column</code>ã€‚</p>
<h4 id="justifyContent"><a href="#justifyContent" class="headerlink" title="justifyContent"></a>justifyContent</h4><p>åœ¨ <code>style</code> ä¸­æŒ‡å®šå…ƒç´ æ²¿ç€<strong>ä¸»è½´</strong>çš„æ’åºæ–¹å¼ã€‚<strong>æ³¨æ„</strong>ï¼Œè¿™ä¸ªå±æ€§æ˜¯å®šä¹‰åœ¨çˆ¶æ§ä»¶ï¼Œä½œç”¨åœ¨å­æ§ä»¶ä¸Šçš„ã€‚</p>
<p>åŒ…æ‹¬ <code>flex-start</code>,<code>flex-end</code>,<code>center</code>,<code>space-between</code>,<code>space-around</code>ã€‚</p>
<p>å‰é¢ä¸‰ä¸ªä¸è¯´äº†ï¼Œåé¢ä¸¤ä¸ªè¯´ä¸€ä¸‹ï¼š</p>
<ol>
<li><code>space-between</code>:å·¦å³å„ä¸€ä¸ªå­æ§ä»¶ï¼Œå‰©ä½™çš„å­æ§ä»¶å‡åŒ€çš„åˆ†å¸ƒåœ¨ä¸­é—´ã€‚å¦‚æœåªæœ‰ä¸€ä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªå±…å·¦ã€‚</li>
<li><code>space-around</code>:æ‰€æœ‰å­æ§ä»¶å‡åŒ€çš„åˆ†å¸ƒï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªå±…ä¸­ã€‚</li>
</ol>
<h4 id="alignItems"><a href="#alignItems" class="headerlink" title="alignItems"></a>alignItems</h4><p>åœ¨ <code>style</code> ä¸­æŒ‡å®šå¸ƒå±€çš„<strong>æ¬¡è½´</strong>çš„æ’åºæ–¹å¼ã€‚<strong>æ³¨æ„</strong>ï¼Œè¿™ä¸ªå±æ€§æ˜¯å®šä¹‰åœ¨çˆ¶æ§ä»¶ï¼Œä½œç”¨åœ¨å­æ§ä»¶ä¸Šçš„ã€‚</p>
<p>åŒ…æ‹¬ <code>flex-start</code>,<code>flex-end</code>,<code>center</code>,<code>stretch</code>ã€‚</p>
<p>å…¶ä¸­ <code>stretch</code> è¡¨ç¤ºæ‹‰ä¼¸æ’‘æ»¡æ¬¡è½´ï¼Œå‰ææ˜¯ä¸è®¾ç½®å­æ§ä»¶å®½åº¦ã€‚</p>
<h3 id="å¸ƒå±€æ ·å¼"><a href="#å¸ƒå±€æ ·å¼" class="headerlink" title="å¸ƒå±€æ ·å¼"></a>å¸ƒå±€æ ·å¼</h3><h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><p>é™¤äº†ä¸Šé¢è¯´çš„é‚£äº›ï¼Œå†æ‘˜å–ä¸€äº›æœ‰ç”¨çš„ <code>style</code> ä¸­çš„å±æ€§ï¼š</p>
<ol>
<li><code>border</code> ç³»åˆ—:è®¾ç½®è¾¹æ¡†çš„å®½åº¦ï¼Œ<code>borderTopWidth</code>,<code>borderLeftWidth</code>â€¦ä¸Šä¸‹å·¦å³éƒ½å¯ä»¥åˆ†åˆ«è®¾ç½®ã€‚</li>
<li><code>alignSelf</code>:ç±»ä¼¼äº <code>alignItems</code>ï¼Œåªä¸è¿‡è¿™ä¸ªå±æ€§å®šä¹‰åœ¨å­æ§ä»¶ä¸­ï¼Œé‡å†™çˆ¶æ§ä»¶çš„ <code>alignItems</code>ã€‚å› ä¸ºå­æ§ä»¶åœ¨æ¬¡è½´ä¸Šæ²¡æœ‰å¿…è¦å®Œå…¨æŒ‰ç…§çˆ¶æ§ä»¶çš„æ§åˆ¶ï¼Œé‚£æ ·å¤ªæ­»æ¿äº†ï¼Œ<code>alignSelf</code> çš„ç›®çš„å°±æ˜¯æè¿™ä¸ªç‰¹æ®Šã€‚</li>
<li><code>left</code> ç³»åˆ—:å®šä¹‰å­æ§ä»¶åˆ°çˆ¶æ§ä»¶çš„å·¦è¾¹è·ã€‚<strong>æ³¨æ„</strong>ï¼Œè¦å…ˆè®¾ç½® <code>position:absolute</code> å¦åˆ™æ— æ•ˆã€‚ç±»ä¼¼çš„è¿˜æœ‰ <code>right</code>,<code>top</code>,<code>bottom</code>ã€‚</li>
<li><code>flexWrap</code>:å½“å­æ§ä»¶åˆ°åº•åè‡ªåŠ¨æ¢è¡Œã€‚<code>wrap</code> ä¸ºè‡ªåŠ¨æ¢è¡Œï¼Œ<code>noWrap</code> ä¸ºä¸æ¢è¡Œã€‚<strong>æ³¨æ„</strong>ï¼Œè¦å®šä¹‰åœ¨çˆ¶æ§ä»¶ä¸­ã€‚</li>
<li><code>margin</code> ç³»åˆ—:è®¾ç½®å­æ§ä»¶åˆ°ç›¸é‚»å­æ§ä»¶çš„é—´éš”ã€‚</li>
<li><code>max</code>,<code>min</code> ç³»åˆ—:è®¾ç½®æ§ä»¶çš„æœ€å¤§(å°)å®½åº¦(é«˜åº¦).</li>
<li><code>padding</code> ç³»åˆ—:åœ¨çˆ¶æ§ä»¶å†…è®¾ç½®ï¼Œè®¾ç½®å­æ§ä»¶çš„èµ·ç‚¹ã€‚</li>
<li><code>position</code>:åˆ†ä¸º <code>absolute</code> ç»å¯¹ï¼Œ<code>relative</code>ç›¸å¯¹ã€‚é»˜è®¤æ˜¯ç›¸å¯¹çš„ï¼Œå¦‚æœè¦ä½¿ç”¨ <code>left</code> ç­‰æ ·å¼ï¼Œå°±è¦ä½¿ç”¨ç»å¯¹å¸ƒå±€ã€‚<strong>ç»å¯¹å¸ƒå±€çš„å­æ§ä»¶çš„å¤§å°ä¸ä¼šå½±å“çˆ¶æ§ä»¶çš„å¤§å°</strong></li>
<li><code>zIndex</code>: æ§åˆ¶æ§ä»¶çš„ç»˜åˆ¶å±‚çº§ï¼Œè¯¥å±æ€§è¶Šå¤§ï¼Œè¶Šç»˜åœ¨é¡¶å±‚ã€‚</li>
</ol>
<h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><p>ä¸€èˆ¬ä½¿ç”¨æ–¹å¼:<br><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">style=&#123;&#123;height:xx,width:xx&#125;&#125;</div></pre></td></tr></table></figure></p>
<p>å¦‚æœæœ‰å¤šä¸ªå¯¹è±¡ï¼Œéœ€è¦ç”¨æ•°ç»„çš„æ–¹å¼ä¼ å…¥ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">style=&#123;[&#123;height:xx,width:xx,&#125;,&#123;height:yy,wudth:yy,&#125;]&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœæœ‰ç›¸åŒçš„å±æ€§é‡å¤èµ‹å€¼ï¼Œåˆ™ä»¥åä¸€ä¸ªè¦†ç›–å‰ä¸€ä¸ªä¸ºå‡†ã€‚</p>
<h3 id="TextInput"><a href="#TextInput" class="headerlink" title="TextInput"></a>TextInput</h3><h4 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h4><p>æ–‡æœ¬è¾“å…¥ç»„ä»¶ï¼Œå…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UselessTextInput</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;TextInput</div><div class="line">        &#123;...this.props&#125; // Inherit any props passed to it; e.g., multiline, numberOfLines below</div><div class="line">        editable = &#123;true&#125;</div><div class="line">        maxLength = &#123;40&#125;</div><div class="line">      /&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class UselessTextInputMultiline extends Component &#123;</div><div class="line">  constructor(props) &#123;</div><div class="line">    super(props);</div><div class="line">    this.state = &#123;</div><div class="line">      text: 'Useless Multiline Placeholder',</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    return (</div><div class="line">     &lt;View style=&#123;&#123;</div><div class="line">       backgroundColor: this.state.text,</div><div class="line">       borderBottomColor: '#000000',</div><div class="line">       borderBottomWidth: 1 &#125;&#125;</div><div class="line">     &gt;</div><div class="line">       &lt;UselessTextInput</div><div class="line">         multiline = &#123;true&#125;</div><div class="line">         numberOfLines = &#123;4&#125;</div><div class="line">         onChangeText=&#123;(text) =&gt; this.setState(&#123;text&#125;)&#125;</div><div class="line">         value=&#123;this.state.text&#125;</div><div class="line">       /&gt;</div><div class="line">     &lt;/View&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œä¸ºä»€ä¹ˆè¦æŠŠè¿™ä¸ªä¾‹å­è´´å‡ºæ¥å‘¢ï¼Ÿä¸»è¦æœ‰<strong>ä¸¤ä¸ªè¦ç‚¹</strong>ï¼š</p>
<p>é¦–å…ˆï¼Œ<code>{...this.props}</code> çš„è¯­æ³•ã€‚è¿™é‡Œ<code>{}</code> è¿˜æ˜¯è¡¨ç¤ºä½¿ç”¨JSè¯­æ³•çš„æ„æ€ã€‚<code>...</code> æ˜¯es6çš„è¯­æ³•ï¼Œå«åš<strong>å±•å¼€è¿ç®—ç¬¦</strong>ï¼Œè¯¥åŠŸèƒ½ç”¨æ¥éå†å¯¹è±¡ã€‚å¯ä»¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>];</div><div class="line"><span class="built_in">console</span>.log(array);</div><div class="line"><span class="comment">//è¾“å‡º [1, 2, 3, 4, 5, 6, 7]</span></div><div class="line"><span class="built_in">console</span>.log(...array);</div><div class="line"><span class="comment">//è¾“å‡º 1 2 3 4 5 6 7</span></div></pre></td></tr></table></figure>
<p><code>this.props</code> æ˜¯ä¸ªå¯¹è±¡ï¼Œè‚¯å®šä¸èƒ½æ”¾åœ¨ Component ä¸­ï¼Œä½†æ˜¯ç”¨äº†<strong>å±•å¼€è¿ç®—ç¬¦</strong>ï¼Œé‡Œé¢çš„å±æ€§å°±å…¨éƒ¨è¢«å±•å¼€äº†ï¼Œä¹Ÿå°±ç¬¦åˆäº† JSX çš„è¯­æ³•ã€‚ä¸åªæ˜¯ <code>this.props</code> <strong>ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ç”¨è¿™ç§å±•å¼€çš„æ–¹å¼å°†å‚æ•°ä¼ å…¥ Component</strong>ã€‚ä¸è¿‡ä¸å»ºè®®æ»¥ç”¨ï¼Œå› ä¸ºå®¹æ˜“å°†å¾ˆå¤šå¤šä½™å‚æ•°ä¼ å…¥ï¼Œå¯èƒ½äº§ç”Ÿä¸€äº›ä¸æ˜“æ’æŸ¥çš„é—®é¢˜ã€‚</p>
<p>å…¶æ¬¡ï¼Œ<code>onChangeText={(text) =&gt; this.setState({text})}</code>ã€‚ä¸€èˆ¬ <code>setState()</code> ä¸­éƒ½æ˜¯å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œåªæ˜¯ <code>text</code>ï¼Ÿè¿™ä¹Ÿæ˜¯es6çš„è¯­æ³•ï¼Œåœ¨é”®å’Œå€¼ç›¸ç­‰çš„æ—¶å€™å¯ä»¥çœç•¥ <code>{text:text}</code> ä¸º <code>{text}</code>ã€‚ä¹Ÿå°±æ˜¯æœ¬ä¾‹çš„ <code>this.setState({text})</code>ã€‚</p>
<p>å’Œ <code>onChangeText</code> ç›¸å¯¹åº”çš„è¿˜æœ‰ä¸€ä¸ª <code>onEndEditing</code> å±æ€§ã€‚å‰è€…æ˜¯æ¯æ¬¡ text å˜åŒ–çš„æ—¶å€™éƒ½ä¼šå›è°ƒï¼›åè€…åªæœ‰åœ¨ç»“æŸè¾“å…¥çš„æ—¶å€™ä¼šå›è°ƒä¸€æ¬¡ã€‚</p>
<h4 id="éƒ¨åˆ†å±æ€§"><a href="#éƒ¨åˆ†å±æ€§" class="headerlink" title="éƒ¨åˆ†å±æ€§"></a>éƒ¨åˆ†å±æ€§</h4><ol>
<li><code>autoFocus</code>:åœ¨ <code>componentDidMount</code> åæ˜¯å¦è‡ªåŠ¨è·å¾—ç„¦ç‚¹ã€‚</li>
<li><code>defaultValue</code>:æä¾›æ–‡æœ¬æ¡†çš„åˆå§‹å€¼ã€‚</li>
<li><code>editable</code>:æ–‡æœ¬æ¡†æ˜¯å¦å¯ç¼–è¾‘</li>
<li><code>maxLength</code>:æ–‡æœ¬æ¡†ä¸­æœ€é•¿å­—ç¬¦æ•°ã€‚ä½¿ç”¨è¿™ä¸ªå±æ€§è€Œä¸ç”¨JSé€»è¾‘å»å®ç°ï¼Œå¯ä»¥é¿å…é—ªçƒçš„ç°è±¡ã€‚</li>
<li><code>multiline</code>:æ˜¯å¦å¯ä»¥å¤šè¡Œï¼Œé»˜è®¤ false</li>
<li><code>onFocus</code>,<code>onBlur</code>,<code>onSubmitEditing</code>:è¾“å…¥æ¡†åœ¨å„ç§æƒ…å†µä¸‹çš„å›è°ƒå‡½æ•°ã€‚</li>
<li><code>onChange</code>:å½“è¾“å…¥æ¡†å†…å®¹æ”¹å˜æ—¶ï¼Œå›è°ƒè¯¥å‡½æ•°</li>
<li><code>onChangeText</code>,<code>onEndEditing</code>:å‰è€…å½“è¾“å…¥æ¡†å†…å®¹æ”¹å˜æ—¶ï¼Œå›è°ƒè¯¥å‡½æ•°ã€‚æ”¹å˜åçš„æ–‡å­—å†…å®¹å°†ä½œä¸ºå‚æ•°ä¼ å…¥;åè€…å½“è¾“å…¥æ¡†ç»“æŸç¼–è¾‘åå›è°ƒè¯¥å‡½æ•°ã€‚</li>
<li><code>placeholder</code>:å ä½ç¬¦</li>
<li><code>placeholderTextColor</code>:å ä½ç¬¦é¢œè‰².(æ³¨æ„ï¼Œè²Œä¼¼æ²¡æœ‰ placeholderTextSize è¿™ä¸ªå±æ€§)</li>
<li><code>value</code>:è¾“å…¥æ¡†å†…æ˜¾ç¤ºçš„å€¼ </li>
<li><code>underlineColorAndroid</code>:è¿™æ˜¯ android ç‰¹æœ‰çš„å±æ€§ï¼Œéå¸¸çš„å‘ã€‚æ–‡æ¡£é‡Œæ˜¯è¿™ä¹ˆè¯´çš„â€œæ–‡æœ¬æ¡†çš„ä¸‹åˆ’çº¿é¢œè‰²â€ï¼Œå…¶å®ä¸æ˜¯è¿™ä¸ªæ„æ€ï¼Œè¿™ä¸ªå±æ€§è®¾ç½®çš„æ˜¯æ•´ä¸ªæ–‡æœ¬æ¡†çš„é¢œè‰²ã€‚æ¯”å¦‚åœ¨ iOS ä¸Šï¼Œç›´æ¥è®¾ç½® <code>backgroundColor=&#39;red&#39;</code> å°±èƒ½æŠŠæ–‡æœ¬æ¡†è®¾æˆçº¢è‰²ï¼Œä½†æ˜¯ android ä¸ç„¶ï¼Œåœ¨ background ä¹‹ä¸Šè¿˜æœ‰ä¸€å±‚ï¼Œå°±æ˜¯è¿™ä¸ª <code>underlineColorAndroid</code> éœ€è¦å°†è¿™ä¸ªä¹Ÿè®¾ç½®æˆçº¢è‰²ï¼Œæ‰èƒ½æ­£ç¡®æ˜¾ç¤ºæˆçº¢è‰²ã€‚</li>
<li>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå‘ç‚¹ï¼Œå°±æ˜¯ä¸€å®šä¸€å®šä¸€å®šè®¾ç½® TextInput çš„é«˜åº¦ã€‚ä¸ç„¶å³ä½¿ TextInput å¤§å°ä¸º0ï¼Œä»»ç„¶ä¼šæ˜¾ç¤º placeholder ï¼Œè¿™å°±ä¼šå¯¼è‡´ä¸€ç›´æ²¡æœ‰ç‚¹å‡»æ•ˆæœã€‚æ‰€ä»¥<strong>ä¸€ä¸ªè°ƒè¯•æŠ€å·§ï¼šç»™æ§ä»¶è®¾ç½®é†’ç›®çš„èƒŒæ™¯é¢œè‰²ï¼Œè¿™æ ·æœ‰åŠ©äºäº†è§£æ§ä»¶çš„å¸ƒå±€æƒ…å†µï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚</strong></li>
</ol>
<h4 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h4><ol>
<li><code>isFocusd()</code>:åˆ¤æ–­å½“å‰è¾“å…¥æ¡†æ˜¯å¦è·å¾—ç„¦ç‚¹ã€‚</li>
<li><code>clear()</code>:æ¸…ç©ºè¾“å…¥æ¡†å†…å®¹ã€‚</li>
</ol>
<h3 id="ScrollView"><a href="#ScrollView" class="headerlink" title="ScrollView"></a>ScrollView</h3><h4 id="å±æ€§-1"><a href="#å±æ€§-1" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><ol>
<li><code>contentContainerStyle</code>:æ¯”è¾ƒé‡è¦çš„å±æ€§ï¼Œç›¸å½“äºåœ¨ ScrollView ä¸­å†…åµŒäº†ä¸€ä¸ª Viewï¼Œè¿™ä¸ªå±æ€§å°±æ˜¯æ§åˆ¶è¿™ä¸ªå†…åµŒ View çš„ã€‚</li>
<li><code>horizontal</code>:å†…å®¹æ°´å¹³æ’å¸ƒï¼Œä¸çŸ¥é“å’Œ <code>flexDirection</code> æœ‰ä»€ä¹ˆåŒºåˆ«</li>
<li><code>keyboardDismissMode</code>:ç”¨æˆ·æ‹–æ‹½è§†å›¾æ˜¯å¦éšè—è½¯é”®ç›˜ã€‚<code>none</code>,<code>on-drag</code></li>
<li><code>keyboardShouldPersistTaps</code>:æ§åˆ¶æ˜¯å¦åœ¨å½“ç‚¹å‡»æ–‡æœ¬è¾“å…¥æ¡†ä»¥å¤–åŒºåŸŸæ—¶ï¼Œè‡ªåŠ¨éšè—è½¯é”®ç›˜ã€‚true ä¸éšè—ï¼Œfalse éšè—ã€‚é»˜è®¤ false</li>
<li><code>onScroll</code>:æ»šåŠ¨çš„æ—¶å€™ä»¥ä¸€å®šé¢‘ç‡å›è°ƒè¯¥å‡½æ•°ã€‚</li>
<li><code>refreshControll</code>:æŒ‡å®š RefreshController ç»„ä»¶ï¼Œç”¨äºä¸º ScrollView æä¾›ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½ã€‚</li>
<li><code>pagingEnabled</code>:æ»šåŠ¨æ¡åœåœ¨æ•´æ•°å€ä½ç½®ã€‚</li>
<li><code>scrollEventEnabled</code>:æ§åˆ¶è§†å›¾èƒ½å¦æ»šåŠ¨ã€‚</li>
</ol>
<h4 id="æ–¹æ³•-1"><a href="#æ–¹æ³•-1" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h4><ol>
<li><code>scrollTo</code>:æ»šåŠ¨åˆ°æŒ‡å®šçš„x, yåç§»å¤„ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæ˜¯å¦å¯ç”¨å¹³æ»‘æ»šåŠ¨åŠ¨ç”»ã€‚</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scrollTo(&#123;x: <span class="number">0</span>, y: <span class="number">0</span>, animated: <span class="literal">true</span>&#125;)</div></pre></td></tr></table></figure>
<h4 id="RefreshControl"><a href="#RefreshControl" class="headerlink" title="RefreshControl"></a>RefreshControl</h4><p>è¿™ä¸€ç»„ä»¶å¯ä»¥ç”¨åœ¨ ScrollView æˆ– ListView å†…éƒ¨ï¼Œä¸ºå…¶æ·»åŠ ä¸‹æ‹‰åˆ·æ–°çš„åŠŸèƒ½ã€‚å½“ ScrollView å¤„äºç«–ç›´æ–¹å‘ä¸Šçš„èµ·ç‚¹ä½ç½®æ—¶ï¼Œæ­¤æ—¶ä¸‹æ‹‰ä¼šè§¦å‘ä¸€ä¸ª <code>onRefresh</code> äº‹ä»¶ã€‚æœ‰ä¸¤ä¸ªå¸¸ç”¨å±æ€§ï¼š</p>
<ol>
<li><code>onRefresh</code>:åœ¨è§†å›¾å¼€å§‹åˆ·æ–°æ—¶è°ƒç”¨ã€‚</li>
<li><code>refreshing</code>: è§†å›¾æ˜¯å¦åº”è¯¥åœ¨åˆ·æ–°æ—¶æ˜¾ç¤ºæŒ‡ç¤ºå™¨ã€‚ä¸€èˆ¬æ˜¯ä»ç½‘ç»œè·å–æ•°æ®çš„æ—¶å€™æ˜¯ trueï¼Œè·å–å®Œæ•°æ®ä¸º false</li>
</ol>
<h4 id="ç¤ºä¾‹ï¼šç”¨Scrollviewå®ç°å¸¦ä¸‹æ‹‰åˆ·æ–°çš„Tableview"><a href="#ç¤ºä¾‹ï¼šç”¨Scrollviewå®ç°å¸¦ä¸‹æ‹‰åˆ·æ–°çš„Tableview" class="headerlink" title="ç¤ºä¾‹ï¼šç”¨Scrollviewå®ç°å¸¦ä¸‹æ‹‰åˆ·æ–°çš„Tableview"></a>ç¤ºä¾‹ï¼šç”¨Scrollviewå®ç°å¸¦ä¸‹æ‹‰åˆ·æ–°çš„Tableview</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ¯ä¸€ä¸ªrowçš„view</span></div><div class="line"><span class="keyword">const</span> Row = React.createClass(&#123;</div><div class="line">  _onClick: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.props.onClick(<span class="keyword">this</span>.props.data);</div><div class="line">  &#125;,</div><div class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">     &lt;TouchableWithoutFeedback onPress=&#123;this._onClick&#125; &gt;</div><div class="line">        &lt;View style=&#123;styles.row&#125;&gt;</div><div class="line">          &lt;Text style=&#123;styles.text&#125;&gt;</div><div class="line">            &#123;this.props.data.text + ' (' + this.props.data.clicks + ' clicks)'&#125;</div><div class="line">          &lt;/Text&gt;</div><div class="line">        &lt;/View&gt;</div><div class="line">      &lt;/TouchableWithoutFeedback&gt;</div><div class="line">    );</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> RefreshControlExample = React.createClass(&#123;</div><div class="line">  statics: &#123;</div><div class="line">    title: <span class="string">'&lt;RefreshControl&gt;'</span>,</div><div class="line">    description: <span class="string">'Adds pull-to-refresh support to a scrollview.'</span></div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  getInitialState() &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      isRefreshing: <span class="literal">false</span>,</div><div class="line">      loaded: <span class="number">0</span>,</div><div class="line">      rowData: <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">20</span>)).map(</div><div class="line">        (val, i) =&gt; (&#123;text: <span class="string">'Initial row '</span> + i, clicks: <span class="number">0</span>&#125;)),</div><div class="line">    &#125;;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  _onClick(row) &#123;</div><div class="line">    row.clicks++;</div><div class="line">    <span class="keyword">this</span>.setState(&#123;</div><div class="line">      rowData: <span class="keyword">this</span>.state.rowData,</div><div class="line">    &#125;);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">const</span> rows = <span class="keyword">this</span>.state.rowData.map((row, ii) =&gt; &#123;</div><div class="line">      <span class="keyword">return</span> &lt;Row key=&#123;ii&#125; data=&#123;row&#125; onClick=&#123;this._onClick&#125;/&gt;;</div><div class="line">    &#125;);</div><div class="line">    return (</div><div class="line">      &lt;ScrollView</div><div class="line">        style=&#123;styles.scrollview&#125;</div><div class="line">        refreshControl=&#123;</div><div class="line">          &lt;RefreshControl</div><div class="line">            refreshing=&#123;this.state.isRefreshing&#125;</div><div class="line">            onRefresh=&#123;this._onRefresh&#125;</div><div class="line">            tintColor="#ff0000"</div><div class="line">            title="Loading..."</div><div class="line">            titleColor="#00ff00"</div><div class="line">            colors=&#123;['#ff0000', '#00ff00', '#0000ff']&#125;</div><div class="line">            progressBackgroundColor="#ffff00"</div><div class="line">          /&gt;</div><div class="line">        &#125;&gt;</div><div class="line">        &#123;rows&#125;</div><div class="line">      &lt;/ScrollView&gt;</div><div class="line">    );</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  _onRefresh() &#123;</div><div class="line">    this.setState(&#123;isRefreshing: true&#125;);</div><div class="line">    setTimeout(() =&gt; &#123;</div><div class="line">      // prepend 10 items</div><div class="line">      const rowData = Array.from(new Array(10))</div><div class="line">      .map((val, i) =&gt; (&#123;</div><div class="line">        text: 'Loaded row ' + (+this.state.loaded + i),</div><div class="line">        clicks: 0,</div><div class="line">      &#125;))</div><div class="line">      .concat(this.state.rowData);</div><div class="line"></div><div class="line">      this.setState(&#123;</div><div class="line">        loaded: this.state.loaded + 10,</div><div class="line">        isRefreshing: false,</div><div class="line">        rowData: rowData,</div><div class="line">      &#125;);</div><div class="line">    &#125;, 5000);</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>çœç•¥äº†styleSheetã€‚è¿™é‡Œä¸»è¦æ³¨æ„å‡ ç‚¹ï¼š</p>
<ol>
<li>è­¬å¦‚å°è£…ä¸€ä¸ªç»„ä»¶ Rowï¼Œå…¶ä¸­æœ‰ç‚¹å‡»äº‹ä»¶çš„å¤„ç†ã€‚iOS ä¸­ä¸€èˆ¬ä½¿ç”¨ä»£ç†ã€‚è¿™é‡Œç”±äºjsçš„ç‰¹æ€§ï¼Œå¯ä»¥æŠŠå¤–éƒ¨çš„ç‚¹å‡»æ–¹æ³•ä¼ å…¥ç»„ä»¶å†…ï¼Œå†ç”±ç»„ä»¶çš„ç‚¹å‡»äº‹ä»¶è°ƒç”¨ã€‚</li>
<li>æ³¨æ„ <code>map()</code> æ–¹æ³•çš„ä½¿ç”¨ã€‚è¿™ä¹Ÿå°±æ˜¯ç”¨ scrollview å®ç° tableview çš„æ–¹å¼ã€‚</li>
<li>åœ¨ <code>render</code> é‡Œå¯ä»¥æ’å…¥jsæ–¹æ³•ï¼Œå¦‚ä¸Šé¢çš„ <code>{row}</code>,åªè¦æ–¹æ³•è¿”å›çš„æ˜¯JSXçš„ componentå°±è¡Œã€‚ï¼ˆè²Œä¼¼componenté‡Œçš„å±æ€§åªèƒ½ç”¨å±•å¼€è¿ç®—ç¬¦æ‰èƒ½æ’å…¥ï¼Œç”¨jsæ–¹æ³•è¿”å›çš„æ–¹å¼ä¸€ç›´éƒ½æŠ¥é”™ï¼‰</li>
<li><code>RefreshControl</code> çœ‹èµ·æ¥ä¹Ÿå°±æ˜¯ä¸€ä¸ª componentï¼Œç”± scrollview æ§åˆ¶ä»€ä¹ˆæ—¶å€™å±•ç¤ºï¼Œæ€ä¹ˆå±•ç¤ºã€‚</li>
<li>å¦‚æœæƒ³è¦è‡ªå®šä¹‰ä¸Šæ‹‰åˆ·æ–°ï¼Œå°±å¾—çŸ¥é“ <code>contentOffset</code> å¯ä»¥ç ”ç©¶ä¸€ä¸‹ã€‚</li>
</ol>
<h3 id="ListView"><a href="#ListView" class="headerlink" title="ListView"></a>ListView</h3><p>ListViewè®¾è®¡åˆ°å„ç§ä¼˜åŒ–ï¼Œä»¥åŠå„ç§æ–¹æ³•ï¼ŒæŒæ¡çš„ä¸æ˜¯å¾ˆå¥½ï¼Œéœ€è¦è¿›ä¸€æ­¥å­¦ä¹ ã€‚</p>
<h4 id="å±æ€§-2"><a href="#å±æ€§-2" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><ol>
<li>ScrollView å…¨éƒ¨å±æ€§</li>
<li><code>dataSource</code>:<code>ListView.DataSourceå®ä¾‹</code>ã€‚</li>
<li><code>initialListSize</code>:æŒ‡å®šåœ¨ç»„ä»¶åˆšæŒ‚è½½çš„æ—¶å€™æ¸²æŸ“å¤šå°‘è¡Œæ•°æ®ã€‚(è¯•äº†ä¸‹æ²¡çœ‹å‡ºæœ‰ä»€ä¹ˆæ•ˆæœã€‚)</li>
<li><code>onChangeVisibleRows</code>:æ˜¾ç¤ºåŒºåŸŸçš„ cell å˜åŒ–æ—¶è°ƒç”¨ã€‚ï¼ˆapi å’Œå®é™…ä½¿ç”¨æœ‰å‡ºå…¥ï¼Œéœ€è¦å®é™…ä½¿ç”¨çš„æ—¶å€™æ£€éªŒï¼Œä¸è¿‡è¿™ä¸ªä¸œè¥¿å¥½åƒæ²¡ä»€ä¹ˆå¤ªå¤§ç”¨ï¼‰</li>
<li><code>onEndReachedThreshold</code>:è°ƒç”¨ <code>onEndReached</code> ä¹‹å‰çš„ä¸´ç•Œå€¼.</li>
<li><code>onEndReached</code>:æ»šåŠ¨åˆ°åº•éƒ¨æ—¶çš„å›è°ƒï¼Œå¦‚æœæ•°æ®ä¸æ»¡è¶³ä¸€å±ï¼Œä¼šç«‹å³å›è°ƒï¼Œéœ€è¦æ‰‹åŠ¨æ ‡è®°è¿‡æ»¤ã€‚</li>
<li><code>pageSize</code>:æ¯æ¬¡äº‹ä»¶å¾ªç¯ï¼ˆæ¯å¸§ï¼‰æ¸²æŸ“çš„è¡Œæ•°ã€‚é»˜è®¤æ˜¯1ã€‚ï¼ˆå¥½åƒä¸éœ€è¦è‡ªå·±è®¾ç½®ï¼Œä¸çŸ¥é“è®¾äº†æœ‰ä»€ä¹ˆå½±å“ï¼‰</li>
<li><code>removeClippedSubviews</code>:è¯´æ˜¯æå‡æ€§èƒ½é»˜è®¤å¼€å¯ï¼Œä¸çŸ¥é“å…·ä½“æœ‰å•¥ç”¨ã€‚</li>
<li><code>renderHeader</code>,<code>renderFooter</code>:é¡µå¤´ï¼Œé¡µè„šã€‚</li>
<li><code>renderRow</code>: cell çš„å®ç°ï¼Œæ–¹æ³•ä¸º<code>(rowData, sectionID, rowID, highlightRow) =&gt; renderable</code></li>
<li><code>renderSeparator</code>: <code>(sectionID, rowID, adjacentRowHighlighted) =&gt; renderable</code> ä¸€ä¸ªå¯æ¸²æŸ“çš„ç»„ä»¶ä¼šè¢«æ¸²æŸ“åœ¨æ¯ä¸€è¡Œä¸‹é¢.å¦‚æœè¢«ç‚¹å‡»äº†ï¼Œå°±ä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚æ²¡ä»€ä¹ˆå¤ªå¤§ç”¨ã€‚å¦‚æœè¦ç”¨ï¼Œè¦åœ¨ return çš„ view é‡Œæ·»åŠ  <code>key</code>ï¼Œæœ€å¥½çœ‹ä¸€ä¸‹ç¤ºä¾‹ã€‚</li>
<li><code>scrollRenderAheadDistance</code>:è·ç¦»å¤šå°‘å¼€å§‹æ¸²æŸ“ä¸‹ä¸€è¡Œã€‚</li>
<li><code>renderScrollComponent</code>:ä¸çŸ¥é“æ€ä¹ˆç”¨ã€‚</li>
<li><code>renderSectionHeader</code>:æ¯ä¸ªå°èŠ‚(section)æ¸²æŸ“ä¸€ä¸ªç²˜æ€§çš„æ ‡é¢˜ã€‚<code>(sectionData, sectionID) =&gt; renderable</code> å…¶ä¸­ <code>sectionData</code> å°±æ˜¯sectionå†…å†…å®¹çš„æ•°ç»„ã€‚</li>
</ol>
<h4 id="ä¸€äº›æ–¹æ³•"><a href="#ä¸€äº›æ–¹æ³•" class="headerlink" title="ä¸€äº›æ–¹æ³•"></a>ä¸€äº›æ–¹æ³•</h4><ol>
<li>listview åªæ˜¯æä¾›äº†æ¸²æŸ“å…¶ä¸­ cell çš„åŠŸèƒ½ï¼Œé»˜è®¤æ˜¯ cell ç«–ç€æ’ä¸‹æ¥ã€‚é‚£ä¹ˆå¦‚æœè¦å®ç°æˆ gridview ä¹‹ç±»è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿå°±æ˜¯ç»™ listview é™„ä¸Šä» scrollview ä¸­ç»§æ‰¿æ¥çš„ <code>contentContainerStyle</code> è¿™ä¸ª style ç”¨æ¥æ§åˆ¶å…¶ä¸­å­è§†å›¾çš„æ ·å¼ï¼Œåªè¦åœ¨å…¶ä¸­å°† <code>flexDirection:â€˜rowâ€™,justifyContent: &#39;space-around&#39;,flexWrap: &#39;wrap&#39;</code> è¿™æ ·ä¸€è®¾ç½®ã€‚å°±èƒ½è¾¾åˆ°æ¨ªæ’ cellï¼Œå¹¶ä¸”è‡ªåŠ¨æ¢è¡Œçš„æ•ˆæœã€‚</li>
</ol>
<h3 id="ç½‘ç»œ"><a href="#ç½‘ç»œ" class="headerlink" title="ç½‘ç»œ"></a>ç½‘ç»œ</h3><p>æ„Ÿè§‰æ²¡ä»€ä¹ˆå¥½å†™çš„ï¼Œæš‚ä¸”ä¸è¡¨</p>
<h3 id="navigator"><a href="#navigator" class="headerlink" title="navigator"></a>navigator</h3><p>æš‚æ—¶è¿˜æ˜¯ç”¨åŸç”Ÿçš„ navigatorï¼Œæ„Ÿè§‰ navigator ä¸å¤ªå¥½ç”¨ï¼Œæ‰€ä»¥æš‚ä¸”ä¸è¡¨ã€‚</p>
<p>å¦‚æœéœ€è¦ä½¿ç”¨ï¼Œå¯ä»¥æŸ¥çœ‹è¿™ç¯‡<a href="http://bbs.reactnative.cn/topic/20/æ–°æ‰‹ç†è§£navigatorçš„æ•™ç¨‹" target="_blank" rel="external">æ•™ç¨‹</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[React-Native æŠ€å·§ä¸å‘æ€»ç»“]]></title>
      <url>http://zhang759740844.github.io/2016/11/25/RN%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡å°†æ”¶é›†å…³äº React-Native çš„å„ç§æŠ€å·§ä¸å‘ï¼Œä¸è®ºæ˜¯æ‘˜å½•çš„è¿˜æ˜¯è‡ªå·±é‡åˆ°çš„ã€‚</p>
<a id="more"></a>
<h3 id="keyboardShouldPersistTaps-çš„ä½¿ç”¨"><a href="#keyboardShouldPersistTaps-çš„ä½¿ç”¨" class="headerlink" title="keyboardShouldPersistTaps çš„ä½¿ç”¨"></a><code>keyboardShouldPersistTaps</code> çš„ä½¿ç”¨</h3><p><code>keyboardShouldPersistTaps</code> è¿™æ˜¯ <code>scrollview</code> ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚</p>
<p>é‚£ä¹ˆåœºæ™¯ä¼šç”¨åˆ°è¿™ä¸ªå±æ€§å‘¢ï¼Ÿå°±æ˜¯åœ¨ä¸€ä¸ª <code>scrollview</code> ä¸­æœ‰ä¸¤ä¸ª <code>textinput</code> a,bï¼Œå½“ a è¾“å…¥å®Œä¹‹åç‚¹å‡» bï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœä½ ä¸è®¾ç½® <code>keyboardShouldPersistTaps</code> å±æ€§ï¼Œé‚£ä¹ˆç‚¹å‡» b åï¼Œè™šæ‹Ÿé”®ç›˜æ¶ˆå¤±ï¼Œä½ éœ€è¦å†ç‚¹ä¸€æ¬¡ b æ‰èƒ½å°†è™šæ‹Ÿé”®ç›˜å†æ‰“å¼€ï¼Œä¹Ÿå°±æ˜¯è¯´ <code>scrollview</code> å¹¶æ²¡æœ‰ç›¸åº” b æ§ä»¶çš„ç‚¹å‡»äº‹ä»¶ã€‚æ­£å¸¸çš„éœ€æ±‚åº”è¯¥æ˜¯ï¼Œç‚¹å‡» b åï¼Œé”®ç›˜ä»ç„¶ä»£å¼€çŠ¶æ€ï¼Œåªä¸è¿‡è¾“å…¥æ¡†å˜ä¸º bã€‚æ‰€ä»¥è¦ç”¨è¯¥å±æ€§æ§åˆ¶ã€‚</p>
<p>è¯¥å±æ€§æœ‰ä¸‰ä¸ªæšä¸¾å€¼ï¼š</p>
<ul>
<li><code>never</code>: é»˜è®¤æƒ…å†µï¼Œç‚¹å‡» <code>TextInput</code> ä»¥å¤–çš„å­ç»„ä»¶ä¼šä½¿å½“å‰çš„è½¯é”®ç›˜æ”¶èµ·ã€‚æ­¤æ—¶å­å…ƒç´ ä¸ä¼šæ”¶åˆ°ç‚¹å‡»äº‹ä»¶ã€‚</li>
<li><code>always</code>: é”®ç›˜ä¸ä¼šè‡ªåŠ¨æ”¶èµ·ï¼Œ<code>ScrollView</code> ä¹Ÿä¸ä¼šæ•æ‰ç‚¹å‡»äº‹ä»¶ï¼Œä½†å­ç»„ä»¶å¯ä»¥æ•è·ã€‚</li>
<li><code>handled</code>:å½“ç‚¹å‡»äº‹ä»¶è¢«å­ç»„ä»¶æ•è·æ—¶ï¼Œé”®ç›˜ä¸ä¼šè‡ªåŠ¨æ”¶èµ·ã€‚è¿™æ ·åˆ‡æ¢ <code>TextInput</code> æ—¶é”®ç›˜å¯ä»¥ä¿æŒçŠ¶æ€ã€‚å¤šæ•°å¸¦æœ‰TextInputçš„æƒ…å†µä¸‹ä½ åº”è¯¥é€‰æ‹©æ­¤é¡¹ã€‚</li>
</ul>
<h3 id="cloneWithRows-ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹"><a href="#cloneWithRows-ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹" class="headerlink" title="cloneWithRows ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹"></a><code>cloneWithRows</code> ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹</h3><p>æˆ‘ä»¬çŸ¥é“ <code>cloneWithRows</code> æ˜¯åœ¨ <code>listview</code> ä¸­ä¿å­˜åˆ—è¡¨æ•°ç»„æ—¶ä½¿ç”¨çš„æ–¹æ³•ã€‚ä½¿ç”¨çš„æ—¶å€™è¦æ³¨æ„ä¸€ç‚¹ï¼šæ•°ç»„åœ¨ <code>cloneWithRows</code> ä¹‹åä¼šå˜æˆä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œæ•°æ®æ•°ç»„åªæ˜¯è¿™ä¸ªæ•°æ®ç»“æ„ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚</p>
<p>é‚£ä¹ˆä»€ä¹ˆæ—¶å€™éœ€è¦æ³¨æ„å‘¢ï¼Ÿä¸€ä¸ªçˆ¶æ§ä»¶å†…çš„å­æ§ä»¶é‡Œæœ‰ä¸€ä¸ª <code>listview</code>ï¼Œé‚£ä¹ˆè¦ä¹ˆä¼ å…¥æ•°æ®åœ¨é‡Œé¢ <code>cloneWithRows</code>ï¼Œè¦ä¹ˆåœ¨å¤–é¢ <code>cloneWithRows</code> å¥½åç›´æ¥ä¼ å…¥ï¼Œä¸èƒ½å¤–éƒ¨ <code>cloneWithRows</code> ä¸€æ¬¡åå†åœ¨é‡Œé¢ <code>cloneWithRows</code> ä¸€æ¬¡ã€‚æ¨èæ˜¯åœ¨å¤–é¢ <code>cloneWithRows</code> å¥½åä¼ å…¥ï¼Œè¿™æ ·æ›´ç¬¦åˆå°è£…æ€§ã€‚</p>
<h3 id="View-è®¾ç½®å®½é«˜"><a href="#View-è®¾ç½®å®½é«˜" class="headerlink" title="View è®¾ç½®å®½é«˜"></a>View è®¾ç½®å®½é«˜</h3><p>åœ¨ <code>view</code> ä¸­çš„å­æ§ä»¶å¿…é¡»è¦æ ¹æ®ä¸»è½´æ–¹å‘ï¼Œåˆ†åˆ«è®¾ç½®é«˜åº¦æˆ–è€…å®½åº¦å¤§å°ï¼Œæ¯”å¦‚ä¸»è½´æ˜¯ç«–çš„ï¼Œé‚£å°±å¿…é¡»è®¾å®š <code>height</code>ï¼Œå¦‚æœæ˜¯æ¨ªçš„ï¼Œé‚£å°±å¿…é¡»è®¾å®š <code>width</code>ï¼Œæˆ–è€…ç›´æ¥è®¾ç½® <code>flex</code>ï¼Œå¦åˆ™è¦ä¹ˆä¸æ˜¾ç¤ºï¼Œè¦ä¹ˆæ˜¾ç¤ºäº†ä¹Ÿæœ‰é—®é¢˜ã€‚è€Œæ¬¡è½´åˆ™ä¸ç”¨ä¸»åŠ¨è®¾ç½®,å¦‚æœæœ‰å­ <code>view</code>ï¼Œåˆ™ç­‰äºå­ <code>view</code> çš„æ¬¡è½´å¤§å°ï¼Œæ²¡æœ‰å­ <code>view</code>ï¼Œåˆ™é»˜è®¤æ‰©å±•æ•´æ¡é•¿åº¦ï¼ˆå¦‚æœçˆ¶æ§ä»¶è®¾ç½®äº† <code>alignItems</code> åˆ™ä¸ä¼šæ‰©å±•ï¼Œé»˜è®¤å­æ§ä»¶çš„æœ€å°æ¬¡è½´å¤§å°ï¼‰ã€‚</p>
<p>å¦‚æœ <code>view</code> ä¸­æœ‰å­ <code>view</code>ï¼Œå¯ä»¥å…ˆä¸æ˜¾å¼åœ°è®¾å®šä¸»è½´ï¼Œè€Œæ˜¯é€šè¿‡å­ <code>view</code> æ¥éšå¼åœ°è®¡ç®—å‡ºä¸»è½´çš„å¤§å°,ä¸è¿‡å®è·µä¸‹æ¥åšå¥½è¿˜æ˜¯åœ¨å¤–éƒ¨å°±è®¾ç½®å¥½ã€‚æ¬¡è½´åŒç†ã€‚éœ€è¦æ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰å¿…è¦ï¼Œä¸è¦åŒæ—¶æ—¢è®¾ç½®çˆ¶ <code>view</code> åˆè®¾ç½®å­ <code>view</code> ï¼Œè®¾ç½®äº†å…¶ä¸­ä¸€ä¸ªï¼Œå…¶ä»–çš„éƒ½è®¾ç½®æˆ <code>flex</code>ï¼Œä¸ç„¶å¯èƒ½é€ æˆä¸æ˜“å¯Ÿè§‰çš„å¸ƒå±€é”™è¯¯ã€‚</p>
<p>å…³äº <code>view</code> çš„è®¡ç®—ï¼Œæœ‰ä¸€ä¸ªæƒ…å†µè¦ç‰¹åˆ«è¯´æ˜ï¼Œå°±æ˜¯ <code>text</code>ã€‚<code>text</code> ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼ å¤§å°ï¼Œä½†æ˜¯å…¶æœ¬èº«æ˜¯æœ‰å¤§å°çš„ï¼Œå¤§å°é»˜è®¤æ˜¯åŒ…å«å†…å®¹çš„æœ€å°èŒƒå›´ã€‚æ‰€ä»¥å†ç”¨ <code>touchableOpacity</code> ä¹‹ç±»çš„ç»„ä»¶åŒ…è£¹ <code>text</code> çš„æ—¶å€™ï¼Œå¦‚æœæœ¬èº«æ²¡æœ‰è®¾ç½®å¤§å°ï¼Œé‚£ä¹ˆç»“åˆä¸Šé¢çš„ç»“è®ºå¯çŸ¥ï¼Œ<code>touchableOpacity</code> çš„å¤§å°å°±æ˜¯ <code>text</code> çš„å¤§å°ï¼Œè¿™å°±æ˜¯æŒ‰é’®çš„ç‚¹å‡»å“åº”ç‚¹åªæœ‰ä¸€å°æ¡çš„åŸå› ã€‚å› æ­¤ï¼Œå¯¹äº <code>touchOpacity</code>ï¼Œä¸€å®šè¦è®¾ç½®å®ƒçš„é•¿å’Œå®½ã€‚</p>
<h3 id="è®¾ç½®-Image"><a href="#è®¾ç½®-Image" class="headerlink" title="è®¾ç½® Image"></a>è®¾ç½® Image</h3><p><code>Image</code> å›¾ç‰‡ä¸€å®šè¦è®¾ç½®å®½é«˜ï¼Œå› ä¸ºå¦‚æœå›¾ç‰‡é»˜è®¤å¤§å°æ˜¯0ï¼ŒåŠ è½½å®Œå›¾ç‰‡åï¼Œä¼šæœ‰ä¸ªé—ªçƒï¼Œå¯ä»¥è®¾ç½®ä¸»é¢˜çš„å›¾ç‰‡æ¨¡å¼æ˜¯ <code>resizeMode = â€˜containâ€™</code>  è¿™æ ·å›¾ç‰‡å°±èƒ½åœ¨æŒ‡å®šå¤§å°å†…é€‚åº”ç¼©æ”¾ã€‚</p>
<h3 id="JSX-ä¸­çš„ä¸€ç‚¹å°æ³¨æ„äº‹é¡¹"><a href="#JSX-ä¸­çš„ä¸€ç‚¹å°æ³¨æ„äº‹é¡¹" class="headerlink" title="JSX ä¸­çš„ä¸€ç‚¹å°æ³¨æ„äº‹é¡¹"></a>JSX ä¸­çš„ä¸€ç‚¹å°æ³¨æ„äº‹é¡¹</h3><p>åœ¨ JSX ä¸­è°ƒç”¨å¤–éƒ¨çš„ jsæ–¹æ³•ï¼Œå¦‚æœè¦ç”¨åˆ° <code>this</code>ï¼Œ åˆ™å¿…é¡» <code>bind(this)</code> å¦åˆ™æ— æ³•è¯†åˆ«ã€‚</p>
<p><code>render</code> é‡Œå¯ä»¥å†™æ–¹æ³•ï¼Œç”¨ <code>{}</code>æ‹¬èµ·æ¥å³å¯ï¼Œä½†æ˜¯<code>&lt;View   &gt;</code> æ ‡ç­¾é‡Œä¸€å®šä¸èƒ½æœ‰ <code>{}</code>ï¼Œå°±æ¯”å¦‚ä½ è¦æŠŠ <code>View</code> é‡Œçš„ <code>style</code> æ³¨é‡Šæ‰ï¼Œ ä¸€å®šä¸èƒ½ç›´æ¥ç”¨ <code>cmd+/</code> è¿™æ ·ä¼šåœ¨ <code>&lt;&gt;</code>é‡ŒåŠ å…¥ <code>{}</code>ï¼Œäº§ç”Ÿ <code>SyntaxError xxx.js Unexpected token,expected ...</code>çš„é”™è¯¯</p>
<h3 id="å¦‚ä½•éšè—ä¸€ä¸ªç»„ä»¶"><a href="#å¦‚ä½•éšè—ä¸€ä¸ªç»„ä»¶" class="headerlink" title="å¦‚ä½•éšè—ä¸€ä¸ªç»„ä»¶"></a>å¦‚ä½•éšè—ä¸€ä¸ªç»„ä»¶</h3><p>å¦‚æœè®©ä¸€ä¸ªç»„ä»¶éšè—ã€‚åªéœ€è¦åœ¨å¿…è¦çš„æ—¶å€™é€šè¿‡ <code>state</code> çš„å˜åŒ–ï¼Œå°†åŸæ¥ <code>return</code> çš„ <code>view</code> å˜æˆ <code>return null</code> å°±å¯ä»¥äº†</p>
<h3 id="padding-å’Œ-margin-ä½¿ç”¨åŒºåˆ«"><a href="#padding-å’Œ-margin-ä½¿ç”¨åŒºåˆ«" class="headerlink" title="padding å’Œ margin ä½¿ç”¨åŒºåˆ«"></a>padding å’Œ margin ä½¿ç”¨åŒºåˆ«</h3><p>è¿™ä¸¤è€… android ç¨‹åºå‘˜ä½¿ç”¨èµ·æ¥ææ€•æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚iOS ç¨‹åºå‘˜å¦‚æœä½¿ç”¨æƒ¯äº† <code>autoLayout</code> å¯èƒ½ä¸€æ—¶ååº”ä¸è¿‡æ¥ã€‚</p>
<p>style ç©¶ç«Ÿæ˜¯åœ¨çˆ¶æ§ä»¶é‡Œç”¨ <code>padding</code> è¿˜æ˜¯åœ¨å­æ§ä»¶é‡Œç”¨ <code>margin</code>ã€‚å…¶å®åŸºæœ¬æ²¡æœ‰å¤ªå¤§å·®åˆ«ï¼Œä¸€èˆ¬ç”¨ <code>margin</code>ï¼Œèƒ½è®©å­æ§ä»¶çš„å¸ƒå±€æ›´çµæ´»ä¸€äº›ã€‚å½“ç„¶ï¼Œå¦‚æœçˆ¶æ§ä»¶çš„æ ·å¼éœ€è¦å¤ç”¨å¤šæ¬¡ï¼Œè€Œå­æ§ä»¶å„ä¸ç›¸åŒæ—¶ï¼Œç›´æ¥åœ¨çˆ¶æ§ä»¶è®¾ç½® <code>padding</code>ï¼Œå¯ä»¥å‡å°‘æ¯æ¬¡è®¾ç½®å­æ§ä»¶ <code>margin</code> çš„æ¬¡æ•°ã€‚</p>
<h3 id="ç»„ä»¶ä¹‹é—´çš„é€šä¿¡"><a href="#ç»„ä»¶ä¹‹é—´çš„é€šä¿¡" class="headerlink" title="ç»„ä»¶ä¹‹é—´çš„é€šä¿¡"></a>ç»„ä»¶ä¹‹é—´çš„é€šä¿¡</h3><h4 id="å­ç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶æ–¹æ³•"><a href="#å­ç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶æ–¹æ³•" class="headerlink" title="å­ç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶æ–¹æ³•"></a>å­ç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶æ–¹æ³•</h4><p>çˆ¶ç»„ä»¶å°†æ–¹æ³•ä»¥å±æ€§çš„æ–¹å¼ä¼ å…¥å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡ <code>this.props.æ–¹æ³•å</code> æ‹¿åˆ°è¿™ä¸ªæ–¹æ³•ã€‚</p>
<h4 id="çˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•"><a href="#çˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•" class="headerlink" title="çˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•"></a>çˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•</h4><p>çˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶çš„æ¡ä»¶æ˜¯æ‹¿åˆ°å­ç»„ä»¶çš„å®ä¾‹ã€‚å› æ­¤å¯ä»¥ä¸ºå­ç»„ä»¶åŠ ä¸Š <code>ref</code> å±æ€§ã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;Child ref=<span class="string">'child'</span>&gt;haha&lt;<span class="regexp">/Child&gt;</span></div></pre></td></tr></table></figure>
<p>è¿™æ ·çˆ¶ç»„ä»¶å°±å¯ä»¥é€šè¿‡ <code>this.ref.child</code> æ¥è·å– <code>Child</code> ç»„ä»¶çš„å®ä¾‹ï¼Œå¹¶è°ƒç”¨å…¶å†…éƒ¨æ–¹æ³•äº†ã€‚</p>
<h3 id="ä¸Šæ‹‰åŠ è½½"><a href="#ä¸Šæ‹‰åŠ è½½" class="headerlink" title="ä¸Šæ‹‰åŠ è½½"></a>ä¸Šæ‹‰åŠ è½½</h3><p>RN ä¸­çš„ ListView è‡ªå¸¦äº†ä¸Šæ‹‰åŠ è½½çš„æ–¹æ³•ï¼š<code>onEndReached</code>ã€‚ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œå½“ä¸‹æ‹‰åˆ°ä¸€å®šé˜ˆå€¼ <code>onEndReachedThreshold</code> æ—¶ï¼Œè‡ªåŠ¨å›è°ƒ <code>onEndReached</code> ä¼ å…¥çš„æ–¹æ³•ï¼Œå¦‚æœåŠ è½½çš„æ•°æ®ä¸æ»¡è¶³ä¸€å±ï¼Œä¹Ÿä¼šè‡ªåŠ¨å›è°ƒï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;ListView dataSource=&#123;<span class="keyword">this</span>.state.dataSource&#125;</div><div class="line">          renderRow=&#123;<span class="keyword">this</span>._cellForRow.bind(<span class="keyword">this</span>)&#125;</div><div class="line">          onEndReached=&#123;<span class="keyword">this</span>._pullUpToRefresh.bind(<span class="keyword">this</span>)&#125;</div><div class="line">          enableEmptySections = &#123;<span class="literal">true</span>&#125;</div><div class="line">          onEndReachedThreshold=&#123;<span class="number">100</span>&#125;&gt;</div><div class="line">&lt;/ListView&gt;</div></pre></td></tr></table></figure>
<p>ç›¸åº”çš„ç½‘ç»œè¯·æ±‚æ–¹æ³•å’Œä¸Šæ‹‰åŠ è½½æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//é»˜è®¤åŠ è½½æ•°æ®</span></div><div class="line">componentDidMount() &#123;</div><div class="line">    <span class="keyword">this</span>._getRemoteData();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ä¸Šæ‹‰åŠ è½½æ›´å¤šæ–¹æ³•</span></div><div class="line">_pullUpToRefresh() &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>._canPull) &#123;</div><div class="line">        <span class="keyword">this</span>._pageNo++;</div><div class="line">        <span class="keyword">this</span>._getRemoteData();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// è·å–æ•°æ®</span></div><div class="line">_getRemoteData()&#123;</div><div class="line">    <span class="keyword">this</span>._canPull = <span class="literal">false</span>;</div><div class="line">    TravelTogether.getTravelTogetherList(<span class="keyword">this</span>._pageNo,<span class="keyword">this</span>._pageSize,(data) =&gt; &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;data.list.length;i++)&#123;</div><div class="line">            <span class="keyword">this</span>._dataSources.push(data.list[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.setState(&#123;dataSource:<span class="keyword">this</span>.state.dataSource.cloneWithRows(<span class="keyword">this</span>._dataSources)&#125;);</div><div class="line">        <span class="keyword">if</span> (data.list.length === <span class="keyword">this</span>._pageSize)&#123;</div><div class="line">            <span class="keyword">this</span>._canPull = <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨çš„æ—¶å€™æ˜¯ä¸ä¸€äº›å‘çš„ã€‚é¦–å…ˆï¼Œå®è·µä¸‹æ¥ <code>onEndReached</code> æ–¹æ³•åœ¨ç¬¬ä¸€æ¬¡åŠ è½½æ•°æ®çš„æ—¶å€™å¿…å®šä¼šå›è°ƒï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚å¿…é¡»è¦è‡ªè¡Œè®¾ç½®ä¸€ä¸ª <code>_canPull</code> çš„ flag æ¥æ§åˆ¶æ˜¯å¦è¦ä»æœåŠ¡å™¨è·å–æ•°æ®ã€‚å…¶æ¬¡ï¼Œè¦æ³¨æ„ <code>onEndReached</code> çš„è°ƒç”¨æ—¶æœºã€‚å®ƒçš„å‡†ç¡®è°ƒç”¨æ—¶æœºæ˜¯åœ¨ç½‘ç»œè¯·æ±‚è¿”å›æ‰§è¡Œå›è°ƒï¼Œè®¾ç½®çŠ¶æ€ <code>this.setState()</code> çš„æ—¶å€™ã€‚å› æ­¤ï¼Œä½ ä¸èƒ½åœ¨ <code>setState()</code> å‰å°† <code>_canPull</code> è®¾ç½®ä¸º <code>true</code>ï¼Œå¿…é¡»å¦‚ä¸Šé¢ä¸€æ ·ï¼Œæ”¾åœ¨ <code>setState()</code> ä¹‹åã€‚</p>
<h3 id="å…³äºProp"><a href="#å…³äºProp" class="headerlink" title="å…³äºProp"></a>å…³äºProp</h3><h4 id="propTypes"><a href="#propTypes" class="headerlink" title="propTypes"></a>propTypes</h4><p>ç»„ä»¶çš„å±æ€§å¯ä»¥æ¥å—ä»»æ„å€¼ï¼Œå­—ç¬¦ä¸²ã€å¯¹è±¡ã€å‡½æ•°ç­‰ç­‰éƒ½å¯ä»¥ã€‚æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶ï¼ŒéªŒè¯åˆ«äººä½¿ç”¨ç»„ä»¶æ—¶ï¼Œæä¾›çš„å‚æ•°æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚ç»„ä»¶ç±»çš„ <code>PropTypes</code> å±æ€§ï¼Œå°±æ˜¯ç”¨æ¥éªŒè¯ç»„ä»¶å®ä¾‹çš„å±æ€§æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;Text&gt;&#123;this.props.name&#125;&lt;/Text&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Greeting.propTypes = &#123;</div><div class="line">  name: React.PropTypes.string</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¾‹å­ä¸­ï¼Œå¦‚æœ <code>name</code> ä¸æ˜¯ string ç±»å‹ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿä¸€ä¸ªè­¦å‘Šã€‚è¿˜å¯ä»¥è®¾ç½® <code>name: React.PropTypes.string.isRequired</code> è¡¨ç¤ºå¿…é¡»ä¼ å…¥å±æ€§ <code>name</code>ã€‚</p>
<p>é™¤äº† string å¤–ï¼Œè¿˜æœ‰è®¸å¤šç±»å‹çš„ PropTypes å¯ä»¥è®¾ç½®ã€‚<a href="https://facebook.github.io/react/docs/typechecking-with-proptypes.html" target="_blank" rel="external">å‚è§</a> å†ä¸¾ä¸€ä¸ªè®¾ç½®å•ä¸€å­èŠ‚ç‚¹çš„ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">class MyComponent extends React.Component &#123;</div><div class="line">  render() &#123;</div><div class="line">    // This must be exactly one element or it will warn.</div><div class="line">    const children = this.props.children;</div><div class="line">    return (</div><div class="line">        &#123;children&#125;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">MyComponent.propTypes = &#123;</div><div class="line">  children: React.PropTypes.element.isRequired</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h4 id="defaultProps"><a href="#defaultProps" class="headerlink" title="defaultProps"></a>defaultProps</h4><p>å¯ä»¥åœ¨ <code>defaultProps</code> ä¸­æ³¨å†Œè®¾ç½®é»˜è®¤å±æ€§å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;Text&gt;&#123;this.props.name&#125;&lt;/Text&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Greeting.defaultProps = &#123;</div><div class="line">  name: <span class="string">'hahaha'</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ç»“åˆä¸Šé¢è¿™ä¸¤ä¸ªå±æ€§ï¼Œå°±ä¸å¿…å†åœ¨æ„é€ å‡½æ•°é‡Œè®¾ç½®å„ç§å€¼äº†ã€‚</p>
<h3 id="this-props-children"><a href="#this-props-children" class="headerlink" title="this.props.children"></a>this.props.children</h3><p><code>this.props</code> å¯¹è±¡çš„å±æ€§ä¸ç»„ä»¶çš„å±æ€§ä¸€ä¸€å¯¹åº”ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œå°±æ˜¯ <code>this.props.children</code> å±æ€§ã€‚å®ƒè¡¨ç¤ºç»„ä»¶çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚ç±»ä¼¼äº <code>TouchableOpaque</code> é‡ŒåµŒå…¥ <code>Text</code>ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥å¾ˆæ–¹ä¾¿çš„åµŒå¥—å°è£…æ§ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">	render()&#123;</div><div class="line">		<span class="keyword">return</span>(</div><div class="line">			&#123;<span class="keyword">this</span>.props.children&#125;</div><div class="line">		);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//è°ƒç”¨ï¼š</span></div><div class="line">&lt;NewComponent&gt;</div><div class="line">	&lt;Text&gt;haha&lt;/Text&gt;</div><div class="line">&lt;<span class="regexp">/NewComponent&gt;</span></div></pre></td></tr></table></figure>
<h3 id="å…³äº-importï¼Œrequireï¼Œexportï¼Œmodule-exportsçš„åŒºåˆ«"><a href="#å…³äº-importï¼Œrequireï¼Œexportï¼Œmodule-exportsçš„åŒºåˆ«" class="headerlink" title="å…³äº importï¼Œrequireï¼Œexportï¼Œmodule.exportsçš„åŒºåˆ«"></a>å…³äº importï¼Œrequireï¼Œexportï¼Œmodule.exportsçš„åŒºåˆ«</h3><p>ES6æ ‡å‡†å‘å¸ƒåï¼Œmodule æˆä¸ºæ ‡å‡†ï¼Œæ ‡å‡†çš„ä½¿ç”¨æ˜¯ä»¥ export æŒ‡ä»¤å¯¼å‡ºæ¥å£ï¼Œä»¥ import å¼•å…¥æ¨¡å—ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬ä¸€è´¯çš„ node æ¨¡å—ä¸­ï¼Œä½¿ç”¨ require å¼•å…¥æ¨¡å—ï¼Œä½¿ç”¨ module.exports å¯¼å‡ºæ¥å£ã€‚é‚£ä¹ˆåœ¨æ··ç”¨çš„æƒ…å†µä¸‹åˆ°åº•æœ‰ä»€ä¹ˆå¼‚åŒå‘¢ï¼Ÿ</p>
<h4 id="export-module-exports"><a href="#export-module-exports" class="headerlink" title="export,module.exports"></a>export,module.exports</h4><p>é¦–å…ˆè¦æ˜ç¡®ä¸€ç‚¹ï¼Œç°ä»Šçš„æ‰€æœ‰ class éƒ½ä¼šè¢«ç¼–è¯‘å™¨è½¬åŒ–ä¸ºåŒåçš„ functionï¼Œfunction å†…éƒ¨é€šè¿‡ babel æä¾›çš„æ–¹æ³•å®ç° class å†…çš„å„ä¸ªå±æ€§å’Œæ–¹æ³•ã€‚</p>
<ul>
<li><code>export xx</code>å¯¼å‡ºçš„éƒ½æ˜¯ {} æ‹¬èµ·æ¥çš„å¯¹è±¡ã€‚å¦‚æœæ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆè‡ªåŠ¨å˜ä¸º <code>{targetå:target}</code> çš„å½¢å¼ï¼›å¦‚æœåé¢è·Ÿçš„æ˜¯ functionï¼Œé‚£ä¹ˆä¼šè‡ªåŠ¨å˜ä¸ºï¼š<code>{functionå:function}</code> çš„å½¢å¼ã€‚å› æ­¤ä¸€èˆ¬ä¸èƒ½ export åŒ¿åå¯¹è±¡å’Œæ–¹æ³•ã€‚æœ‰ä¸€ä¸ªç‰¹æ®Šç”¨æ³• <code>export default å¯¹è±¡/æ–¹æ³•</code> ç›¸å½“äºå¯¼å‡ºäº†ä¸€ä¸ªåˆ«åä¸º default çš„å¯¹è±¡/æ–¹æ³• <code>{default:å¯¹è±¡/æ–¹æ³•}</code> ä¸€ä¸ªæ–‡ä»¶å†…ï¼Œå¯ä»¥ä½¿ç”¨å¤šæ¬¡ exportï¼Œä½†åªèƒ½å°†ä¸€ä¸ªå¯¹è±¡/æ–¹æ³•è®¾ç½®ä¸º defaultã€‚</li>
<li><code>module.exports = xx</code> è¾ƒä¸ºç›´æ¥ï¼Œèµ‹å€¼çš„æ˜¯ä»€ä¹ˆï¼Œå¯¼å‡ºçš„å°±æ˜¯ä»€ä¹ˆã€‚</li>
</ul>
<h4 id="import-require"><a href="#import-require" class="headerlink" title="import,require"></a>import,require</h4><ul>
<li>import ä¸€èˆ¬å’Œ export ä¸€èµ·ä½¿ç”¨ï¼Œæ˜¯ä¸€ç§è§£æ„çš„æ–¹å¼ã€‚å¦‚ï¼š<code>import a {b,c} from &#39;./xx&#39;</code>ï¼Œç­‰ä»·äº <code>import {default as a,b,c} from &#39;./xx&#39;</code>ã€‚ç›¸å½“äºå°† default å¯¼å‡ºï¼Œå¹¶ç»™ defaultå–äº†ä¸ªåˆ«å aã€‚</li>
<li>require ä¸€èˆ¬å’Œ module.exports ä¸€èµ·ä½¿ç”¨ï¼Œç›´æ¥å°† module.exports å¯¼å‡ºçš„å¯¹è±¡èµ‹ç»™æ¥æ”¶å¯¹è±¡ã€‚å¦‚ï¼š<code>var a = require(&#39;./xx&#39;)</code>ã€‚<h4 id="æ··ç”¨"><a href="#æ··ç”¨" class="headerlink" title="æ··ç”¨"></a>æ··ç”¨</h4></li>
<li>å¦‚æœ import å’Œ <code>module.exports = xx</code> ä¸€èµ·ä½¿ç”¨ï¼Œåˆ™ç›´æ¥ importã€‚å¦‚:<code>import xx from &#39;./xx&#39;</code>ã€‚</li>
<li>å¦‚æœ require å’Œ export ä¸€èµ·ä½¿ç”¨åˆ™ç›¸å½“äºå°† export ç”Ÿæˆçš„å¯¼å‡ºå¯¹è±¡ä»˜ç»™æ¥æ”¶å¯¹è±¡ã€‚å¦‚ï¼š<code>export default funcA</code>,å¯¼å…¥æ–¹å¼ä¸€æ ·ï¼Œ<code>var a = require(&#39;./xx&#39;);</code> ä½†è¦è¿™æ ·ä½¿ç”¨ <code>a.default();</code></li>
</ul>
<p>ç»¼ä¸Šï¼Œä¸¤ç§exportçš„æ–¹å¼ï¼Œå¯¹äºimportéƒ½ä¸€æ ·ï¼Œä½†æ˜¯å¯¹äº requireæœ‰æ‰€ä¸åŒã€‚<a href="http://www.tuicool.com/articles/uuUVBv2" target="_blank" rel="external">å‚è€ƒé“¾æ¥</a></p>
<h3 id="å…³äºç¼–è¯‘æ—¶-RCTHTTPRequestHandler-m-ä¸å­˜åœ¨çš„é—®é¢˜"><a href="#å…³äºç¼–è¯‘æ—¶-RCTHTTPRequestHandler-m-ä¸å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="å…³äºç¼–è¯‘æ—¶ RCTHTTPRequestHandler.m ä¸å­˜åœ¨çš„é—®é¢˜"></a>å…³äºç¼–è¯‘æ—¶ RCTHTTPRequestHandler.m ä¸å­˜åœ¨çš„é—®é¢˜</h3><p>å‡çº§äº†ä¸€ä¸‹ React-Native çš„ç‰ˆæœ¬åï¼ˆ3.2=&gt;3.8ï¼‰ï¼ŒXcode ç¼–è¯‘çš„æ—¶å€™å‡ºç°äº† <code>RCTHTTPRequestHandler.m not found</code> çš„ç¼–è¯‘é”™è¯¯ã€‚åŸå› åº”è¯¥æ˜¯ <code>RCTHTTPRequestHandler.m</code> åœ¨åé¢çš„ç‰ˆæœ¬å˜ä¸ºäº† <code>RCTHTTPRequestHandler.mm</code>ã€‚</p>
<p>è§£å†³æ–¹æ³•å¾ˆç®€å•ï¼Œåœ¨ React-Native ç‰ˆæœ¬å‡çº§ï¼Œå³ä½¿ç”¨ <code>npm update</code> åï¼Œéœ€è¦é‡æ–° <code>pod install</code> ä¸€éã€‚å› ä¸º React ä½œä¸º pod ä¸­çš„ä¸€é¡¹ï¼ŒXcode æ˜¯é€šè¿‡ <code>pod install</code> åç”Ÿæˆçš„ç´¢å¼•æ¥å®šä½ React ä¸­çš„å„ä¸ªæ–‡ä»¶çš„ã€‚åª <code>npm update</code> è€Œä¸ <code>pod install</code>ï¼ŒXcode ç¼–è¯‘çš„æ—¶å€™é€šè¿‡ 3.2 çš„æ–‡ä»¶ç´¢å¼•ï¼Œå» 3.8 é‡Œæ‰¾æ–‡ä»¶ï¼Œå°±å¾ˆæœ‰å¯èƒ½å› ä¸ºç‰ˆæœ¬å˜åŒ–å¯¼è‡´æ‰¾ä¸åˆ°æ–‡ä»¶ã€‚ </p>
<h3 id="TextInput-éšè—é”®ç›˜"><a href="#TextInput-éšè—é”®ç›˜" class="headerlink" title="TextInput éšè—é”®ç›˜"></a>TextInput éšè—é”®ç›˜</h3><p>Native ä¸­çš„ <code>UITextField</code> å¯ä»¥é€šè¿‡ <code>resignFirstResponder</code> æˆ–è€… <code>endEditing</code> çš„æ–¹å¼å–æ¶ˆç¬¬ä¸€å“åº”è€…ï¼Œä»è€Œéšè—è™šæ‹Ÿé”®ç›˜ã€‚é‚£ä¹ˆï¼Œreact ä¸­å¦‚ä½•åšåˆ°éšè—é”®ç›˜å‘¢ï¼Ÿ</p>
<p>å¯ä»¥ä½¿ç”¨ <code>ScrollView</code> åŒ…è£…æˆ‘ä»¬çš„ <code>View</code>ã€‚<br><code>ScrollView</code> å¯ä»¥è®¾ç½® <code>keyboardDismissMode</code>ï¼Œ<code>keyboardShouldPersistTaps</code> æ¥æ§åˆ¶è¾“å…¥æ³•çš„è¡Œä¸ºã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;ScrollView 	contentContainerStyle=&#123;&#123;flex:<span class="number">1</span>&#125;&#125;<span class="comment">//éå¸¸é‡è¦ï¼Œè®©ScrollViewçš„å­å…ƒç´ å æ»¡æ•´ä¸ªåŒºåŸŸ</span></div><div class="line">				keyboardDismissMode=<span class="string">'on-drag'</span> <span class="comment">//æ‹–åŠ¨ç•Œé¢è¾“å…¥æ³•é€€å‡º</span></div><div class="line">				keyboardShouldPersistTaps=&#123;<span class="literal">false</span>&#125; <span class="comment">//ç‚¹å‡»è¾“å…¥æ³•æ„å¤–çš„åŒºåŸŸï¼Œè¾“å…¥æ³•é€€å‡º</span></div><div class="line">				&gt;</div><div class="line">....</div><div class="line">&lt;<span class="regexp">/ScrollView&gt;</span></div></pre></td></tr></table></figure>
<h3 id="ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°æ€»ç»“"><a href="#ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°æ€»ç»“" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°æ€»ç»“"></a>ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°æ€»ç»“</h3><h4 id="componentWillMount"><a href="#componentWillMount" class="headerlink" title="componentWillMount()"></a>componentWillMount()</h4><p><code>componentWillMount</code> ä¼šåœ¨ç»„ä»¶ <code>render</code> ä¹‹å‰æ‰§è¡Œï¼Œå¹¶ä¸”æ°¸è¿œéƒ½åªæ‰§è¡Œä¸€æ¬¡ã€‚</p>
<h4 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount()"></a>componentDidMount()</h4><p><code>componentDidMount</code> ä¼šåœ¨ç»„ä»¶åŠ è½½å®Œæ¯•ä¹‹åç«‹å³æ‰§è¡Œã€‚</p>
<h4 id="componentWillReceiveProps-object-nextProps"><a href="#componentWillReceiveProps-object-nextProps" class="headerlink" title="componentWillReceiveProps(object nextProps)"></a>componentWillReceiveProps(object nextProps)</h4><p>åœ¨ç»„ä»¶æ¥æ”¶åˆ°ä¸€ä¸ªæ–°çš„ prop æ—¶è¢«æ‰§è¡Œã€‚è¿™ä¸ªæ–¹æ³•åœ¨åˆå§‹åŒ– <code>render</code> æ—¶ä¸ä¼šè¢«è°ƒç”¨ã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•å¾ˆé‡è¦ã€‚ç»„ä»¶å†…éƒ¨å±æ€§çš„åˆå§‹åŒ–è®¾ç½®åªæœ‰ä¸€æ¬¡ï¼Œæ‰€ä»¥å½“ç»„ä»¶åˆå§‹åŒ–å®Œæˆåï¼Œå¤–éƒ¨ä¼ å…¥çš„å±æ€§å€¼çš„å˜åŒ–ä¸ä¼šç›´æ¥å¼•èµ·ç»„ä»¶å†…éƒ¨å±æ€§å€¼çš„å˜åŒ–ï¼Œè€Œæ˜¯ä¼šå›è°ƒè¿™ä¸ªæ–¹æ³•ã€‚</p>
<h4 id="boolean-shouldComponentUpdate-object-nextProps-object-nextState"><a href="#boolean-shouldComponentUpdate-object-nextProps-object-nextState" class="headerlink" title="boolean shouldComponentUpdate(object nextProps, object nextState)"></a>boolean shouldComponentUpdate(object nextProps, object nextState)</h4><p>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚åœ¨ç»„ä»¶çš„ props æˆ–è€… state æ”¹å˜æ—¶è¢«æ‰§è¡Œã€‚åœ¨åˆå§‹åŒ–æ—¶æˆ–è€…ä½¿ç”¨  <code>forceUpdate</code> æ—¶ä¸è¢«æ‰§è¡Œã€‚</p>
<p>å¦‚æœ <code>shouldComponentUpdate</code> è¿”å› <code>false</code>,<code>render()</code> åˆ™ä¼šåœ¨ä¸‹ä¸€ä¸ª state change ä¹‹å‰è¢«å®Œå…¨è·³è¿‡ã€‚(å¦å¤– <code>componentWillUpdate</code> å’Œ  <code>componentDidUpdate</code> ä¹Ÿä¸ä¼šè¢«æ‰§è¡Œ)é»˜è®¤æƒ…å†µä¸‹ <code>shouldComponentUpdate</code> ä¼šè¿”å› <code>true</code>.</p>
<h4 id="componentWillUpdate-object-nextProps-object-nextState"><a href="#componentWillUpdate-object-nextProps-object-nextState" class="headerlink" title="componentWillUpdate(object nextProps, object nextState)"></a>componentWillUpdate(object nextProps, object nextState)</h4><p>ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„ <code>props</code> æˆ–è€… <code>state</code> ä½†è¿˜æ²¡æœ‰ <code>render</code> æ—¶è¢«æ‰§è¡Œã€‚åœ¨åˆå§‹åŒ–æ—¶ä¸ä¼šè¢«æ‰§è¡Œã€‚ä¸€èˆ¬ç”¨åœ¨ç»„ä»¶å‘ç”Ÿæ›´æ–°ä¹‹å‰ã€‚</p>
<h4 id="componentDidUpdate-object-prevProps-object-prevState"><a href="#componentDidUpdate-object-prevProps-object-prevState" class="headerlink" title="componentDidUpdate(object prevProps, object prevState)"></a>componentDidUpdate(object prevProps, object prevState)</h4><p>åœ¨ç»„ä»¶å®Œæˆæ›´æ–°åç«‹å³æ‰§è¡Œã€‚åœ¨åˆå§‹åŒ–æ—¶ä¸ä¼šè¢«æ‰§è¡Œã€‚ä¸€èˆ¬ä¼šåœ¨ç»„ä»¶å®Œæˆæ›´æ–°åè¢«ä½¿ç”¨ã€‚ä¾‹å¦‚æ¸…é™¤ notification æ–‡å­—ç­‰æ“ä½œã€‚</p>
<h4 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount()"></a>componentWillUnmount()</h4><p>ä¸»è¦ç”¨æ¥æ‰§è¡Œä¸€äº›å¿…è¦çš„æ¸…ç†ä»»åŠ¡ã€‚<strong>æ³¨æ„ï¼Œ<code>Unmount</code> çš„å¤§å°å†™ã€‚</strong></p>
<h3 id="å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰æŸä¸ªå±æ€§"><a href="#å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰æŸä¸ªå±æ€§" class="headerlink" title="å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰æŸä¸ªå±æ€§"></a>å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰æŸä¸ªå±æ€§</h3><ul>
<li><p>ä½¿ç”¨inå…³é”®å­— è¯¥æ–¹æ³•å¯ä»¥åˆ¤æ–­å¯¹è±¡çš„è‡ªæœ‰å±æ€§å’Œç»§æ‰¿æ¥çš„å±æ€§æ˜¯å¦å­˜åœ¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o=&#123;x:<span class="number">1</span>&#125;;</div><div class="line"><span class="string">"x"</span> <span class="keyword">in</span> o; <span class="comment">//trueï¼Œè‡ªæœ‰å±æ€§å­˜åœ¨</span></div><div class="line"><span class="string">"y"</span> <span class="keyword">in</span> o; <span class="comment">//false</span></div><div class="line"><span class="string">"toString"</span> <span class="keyword">in</span> o; <span class="comment">//trueï¼Œæ˜¯ä¸€ä¸ªç»§æ‰¿å±æ€§</span></div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨å¯¹è±¡çš„hasOwnProperty()æ–¹æ³• è¯¥æ–¹æ³•åªèƒ½åˆ¤æ–­è‡ªæœ‰å±æ€§æ˜¯å¦å­˜åœ¨ï¼Œå¯¹äºç»§æ‰¿å±æ€§ä¼šè¿”å›falseã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o=&#123;x:<span class="number">1</span>&#125;;</div><div class="line">o.hasOwnProperty(<span class="string">"x"</span>); ã€€ã€€ <span class="comment">//trueï¼Œè‡ªæœ‰å±æ€§ä¸­æœ‰x</span></div><div class="line">o.hasOwnProperty(<span class="string">"y"</span>); ã€€ã€€ <span class="comment">//falseï¼Œè‡ªæœ‰å±æ€§ä¸­ä¸å­˜åœ¨y</span></div><div class="line">o.hasOwnProperty(<span class="string">"toString"</span>); <span class="comment">//falseï¼Œè¿™æ˜¯ä¸€ä¸ªç»§æ‰¿å±æ€§ï¼Œä½†ä¸æ˜¯è‡ªæœ‰å±æ€§</span></div></pre></td></tr></table></figure>
</li>
<li><p>ç”¨undefinedåˆ¤æ–­ è‡ªæœ‰å±æ€§å’Œç»§æ‰¿å±æ€§å‡å¯åˆ¤æ–­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o=&#123;x:<span class="number">1</span>&#125;;</div><div class="line">o.x!==<span class="literal">undefined</span>; <span class="comment">//true</span></div><div class="line">o.y!==<span class="literal">undefined</span>; <span class="comment">//false</span></div><div class="line">o.toString!==<span class="literal">undefined</span> <span class="comment">//true</span></div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨æ¡ä»¶è¯­å¥ä¸­ç›´æ¥åˆ¤æ–­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o=&#123;&#125;;</div><div class="line"><span class="keyword">if</span>(o.x) o.x+=<span class="number">1</span>; <span class="comment">//å¦‚æœxæ˜¯undefine,null,false," ",0æˆ–NaN,å®ƒå°†ä¿æŒä¸å˜</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="å¯å–æ¶ˆçš„Promise"><a href="#å¯å–æ¶ˆçš„Promise" class="headerlink" title="å¯å–æ¶ˆçš„Promise"></a>å¯å–æ¶ˆçš„Promise</h3><p><code>Promise</code>æ˜¯ React Native å¼€å‘è¿‡ç¨‹ä¸­ç”¨äºå¼‚æ­¥æ“ä½œçš„æœ€å¸¸ç”¨çš„ APIï¼Œä½† Promise æ²¡æœ‰æä¾›ç”¨äºå–æ¶ˆå¼‚æ­¥æ“ä½œçš„æ–¹æ³•ã€‚ä¸ºäº†å®ç°å¯å–æ¶ˆçš„å¼‚æ­¥æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä¸º Promise åŒ…è£¹ä¸€å±‚å¯å–æ¶ˆçš„å¤–è¡£ã€‚    </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> makeCancelable = (promise) =&gt; &#123;</div><div class="line">  <span class="keyword">let</span> hasCanceled_ = <span class="literal">false</span>;</div><div class="line">  <span class="keyword">const</span> wrappedPromise = <span class="keyword">new</span> <span class="built_in">Promise</span>((resolve, reject) =&gt; &#123;</div><div class="line">    promise.then((val) =&gt;</div><div class="line">      hasCanceled_ ? reject(&#123;isCanceled: <span class="literal">true</span>&#125;) : resolve(val)</div><div class="line">    );</div><div class="line">    promise.catch((error) =&gt;</div><div class="line">      hasCanceled_ ? reject(&#123;isCanceled: <span class="literal">true</span>&#125;) : reject(error)</div><div class="line">    );</div><div class="line">  &#125;);</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    promise: wrappedPromise,</div><div class="line">    cancel() &#123;</div><div class="line">      hasCanceled_ = <span class="literal">true</span>;</div><div class="line">    &#125;,</div><div class="line">  &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ç„¶åå¯ä»¥è¿™æ ·ä½¿ç”¨å–æ¶ˆæ“ä½œï¼š   </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> somePromise = <span class="keyword">new</span> <span class="built_in">Promise</span>(r =&gt; setTimeout(r, <span class="number">1000</span>));<span class="comment">//åˆ›å»ºä¸€ä¸ªå¼‚æ­¥æ“ä½œ</span></div><div class="line"><span class="keyword">const</span> cancelable = makeCancelable(somePromise);<span class="comment">//ä¸ºå¼‚æ­¥æ“ä½œæ·»åŠ å¯å–æ¶ˆçš„åŠŸèƒ½</span></div><div class="line">cancelable</div><div class="line">  .promise</div><div class="line">  .then(() =&gt; <span class="built_in">console</span>.log(<span class="string">'resolved'</span>))</div><div class="line">  .catch((&#123;isCanceled, ...error&#125;) =&gt; <span class="built_in">console</span>.log(<span class="string">'isCanceled'</span>, isCanceled));</div><div class="line"><span class="comment">// å–æ¶ˆå¼‚æ­¥æ“ä½œ</span></div><div class="line">cancelable.cancel();</div></pre></td></tr></table></figure>
<p>Promiseåé¢æ‹¬å·å†…è·Ÿçš„æ˜¯è¦å¼‚æ­¥æ‰§è¡Œçš„æ“ä½œï¼Œ<code>.then()</code>é‡Œè·Ÿçš„æ˜¯å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œåçš„å›è°ƒå‡½æ•°ã€‚å–æ¶ˆ Promise æ¢å¥è¯è¯´ä¹Ÿå°±æ˜¯å–æ¶ˆ <code>.then()</code> é‡Œçš„å›åˆ°å‡½æ•°çš„æ‰§è¡Œã€‚</p>
<p>è¿™é‡Œé€šè¿‡åˆ›å»ºä¸€ä¸ªè¾…åŠ©çš„ Promise æ¥åŒ…è£¹è¦æ‰§è¡Œçš„ Promiseï¼Œè¿™ä¸ªè®¾è®¡éå¸¸çš„å·§å¦™ã€‚</p>
<p>é¦–å…ˆï¼Œå¦‚ä½•å®ç°å–æ¶ˆ <code>.then()</code> é‡Œçš„æ¯æ‰å‡½æ•°çš„æ‰§è¡Œï¼Ÿé‚£ä¹ˆå°±ä¸èƒ½ç”¨ <code>.then(callback)</code> çš„å½¢å¼äº†ï¼Œè€Œè¦æœ‰ä¸€ä¸ªæ ‡è¯†ä½åˆ¤æ–­ï¼š<code>.then(()=&gt;flag?æ‰§è¡Œ:ä¸æ‰§è¡Œ)</code>ã€‚</p>
<p>é‚£ä¹ˆ <code>flag</code> å®šä¹‰åœ¨å“ªï¼Ÿè‚¯å®šä¸èƒ½ç›´æ¥ä½œä¸ºä¸€ä¸ªå˜é‡å®šä¹‰åœ¨æ‰§è¡Œ Promise çš„ç±»é‡Œï¼Œå› ä¸ºè¿™ä¸ªç±»å¯èƒ½æœ‰å¤šä¸ª Promise ä»»åŠ¡è¦å¤„ç†ï¼Œåˆ›å»ºå¤šä¸ª <code>flag</code> æ˜¾ç„¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚é‚£ä¹ˆå°±å¯ä»¥æ–°å»ºä¸€ä¸ª <code>class</code>ï¼Œè¿™ä¸ª <code>class</code> é‡ŒåŒ…å« <code>flag</code> ä»¥åŠè¿™ä¸ª Promiseï¼Œè¿™å°±éœ€è¦æ¯æ¬¡åˆ›å»º Promise çš„æ—¶å€™éƒ½ <code>new</code> ä¸€ä¸ªå¯¹è±¡å‡ºæ¥ã€‚è¿™ä¸ªæ–¹å¼å¯è¡Œï¼Œä½†æ˜¯ä¸å¤Ÿä¼˜é›…ã€‚ç”±äº Js æ˜¯å¼±ç±»å‹çš„ï¼Œæˆ‘ä»¬æ²¡æœ‰å¿…è¦ä¸“é—¨å®šä¹‰ä¸€ä¸ª <code>class</code>ï¼Œåæ­£éƒ½æ˜¯ <code>var</code>ã€‚å› æ­¤ï¼Œå°±åº”è¯¥åƒä¸Šé¢é‚£æ ·é€šè¿‡ä¸€ä¸ªæ–¹æ³•ï¼Œç›´æ¥ <code>return</code> ä¸€ä¸ª <code>{}</code> åŒ…è£¹èµ·æ¥çš„å¯¹è±¡ã€‚å› ä¸º <code>return</code> çš„è¿™ä¸ªå¯¹è±¡ç”¨åˆ°äº† <code>hasCanceled</code> è¿™ä¸ªå‚æ•°ï¼Œç”±äºæœ‰é—­åŒ…æ€§ï¼Œåœ¨ <code>return</code> çš„è¿™ä¸ªå¯¹è±¡è¢«é”€æ¯å‰ <code>hasCanceled</code> éƒ½æ˜¯å¯è§¦åŠçš„ã€‚</p>
<p>æœ€åï¼Œä¸ºä»€ä¹ˆè¦ç”¨ä¸€ä¸ªè¾…åŠ©çš„ Promise å»åŒ…è£¹ï¼Ÿ å…¶å®ç”¨ä¸€ä¸ªç±»æˆ–è€…ä¸€ä¸ªæ–¹æ³•ä¹Ÿæ˜¯èƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚è¿™æ ·çš„è®¾è®¡ä¹Ÿå¾ˆå·§å¦™ã€‚å°†è¦æ‰§è¡Œçš„ Promise çš„ <code>.then()</code> ä½œä¸º è¾…åŠ©çš„ Promise çš„å¼‚æ­¥æ‰§è¡Œæ“ä½œï¼Œè¾¾åˆ°çš„ç›®çš„æ˜¯åœ¨ <code>.then()</code> å®Œæˆåï¼Œè¾…åŠ©çš„ Promise çš„å¼‚æ­¥æ“ä½œæ‰å¯èƒ½ç»“æŸã€‚å½“è¾…åŠ©çš„ Promise çš„å¼‚æ­¥æ“ä½œç»“æŸåï¼Œå°±å¯ä»¥è°ƒç”¨å…¶è‡ªå·±çš„ <code>.then()</code> æ¥é€šçŸ¥è¦æ‰§è¡Œçš„ Promise å·²ç»æ‰§è¡Œå®Œæ¯•ï¼ˆä»”ç»†æƒ³äº†æƒ³ï¼Œå…¶å®ç”¨è¾…åŠ© Promise ä¹Ÿæ²¡ç”šå±Œç”¨ï¼Œå› ä¸º <code>.then()</code> æ˜¯å¯ä»¥é“¾å¼è°ƒç”¨çš„å¦‚ï¼š<code>.then().then()</code>ï¼Œæˆ‘å®Œå…¨å¯ä»¥ç›´æ¥è‡ªå·±å®šä¹‰ä¸€ä¸ª <code>function</code>ï¼Œæ¯”å¦‚ï¼š<code>(callbackLogical,callbackNotify)=&gt;promise.then(()=&gt;flag?æ‰§è¡ŒcallbackLogical:ä¸æ‰§è¡ŒcallbackLogical).then(callbackNotify)</code>ã€‚åªè¦è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆä¸å°±éƒ½æå®šäº†ä¹ˆã€‚</p>
<h3 id="å…¨å±€å˜é‡"><a href="#å…¨å±€å˜é‡" class="headerlink" title="å…¨å±€å˜é‡"></a>å…¨å±€å˜é‡</h3><p>æ­£å¦‚ web ä¸­çš„ <code>window</code>ï¼Œåœ¨ RN ä¸­ä¹Ÿæœ‰ä¸€ä¸ªå…¨å±€æ ¹å±æ€§å¯ä»¥æŒ‚è½½å„ç§å…¨å±€å˜é‡ï¼š<code>global</code>ã€‚æ¯”å¦‚ä¸Šé¢æ¨èçš„ <code>react-native-storage</code> ç”¨åˆ°çš„ <code>storage</code>,ä½¿ç”¨ <code>global.storage = storage</code> å°±å¯ä»¥åœ¨å„ä¸ªåœ°æ–¹æ‹¿åˆ° <code>storage</code> å¯¹è±¡ã€‚</p>
<p>ä½†æ˜¯è¦æ³¨æ„ä¸€ç‚¹ï¼Œä¸€å®šè¦æ³¨æ„æ‰§è¡Œé¡ºåºï¼Œä¹Ÿå°±æ˜¯å¿…é¡»è¦åœ¨ä½¿ç”¨ <code>global.storage</code> å‰ï¼Œå°† <code>storage</code> èµ‹ç»™ <code>global.storage</code>ï¼Œæ‰€ä»¥è¦å°†è¿™ä¸ªèµ‹å€¼æ”¾åˆ°å¿…é¡»æ‰§è¡Œçš„æ–‡ä»¶ä¸­ã€‚</p>
<h3 id="ä¼˜åŒ–åˆ‡æ¢åŠ¨ç”»å¡é¡¿çš„é—®é¢˜"><a href="#ä¼˜åŒ–åˆ‡æ¢åŠ¨ç”»å¡é¡¿çš„é—®é¢˜" class="headerlink" title="ä¼˜åŒ–åˆ‡æ¢åŠ¨ç”»å¡é¡¿çš„é—®é¢˜"></a>ä¼˜åŒ–åˆ‡æ¢åŠ¨ç”»å¡é¡¿çš„é—®é¢˜</h3><p>ä½¿ç”¨API <code>InteractionManager</code>ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å¯ä»¥ä½¿æœ¬æ¥ JS çš„ä¸€äº›æ“ä½œåœ¨åŠ¨ç”»å®Œæˆä¹‹åæ‰§è¡Œï¼Œè¿™æ ·å°±å¯ç¡®ä¿åŠ¨ç”»çš„æµç¨‹æ€§ã€‚å½“ç„¶è¿™æ˜¯åœ¨å»¶è¿Ÿæ‰§è¡Œä¸ºä»£ä»·ä¸Šæ¥è·å¾—å¸§æ•°çš„æé«˜ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">InteractionManager.runAfterInteractions(()=&gt;&#123;</div><div class="line">	<span class="comment">//...è€—æ—¶è¾ƒé•¿çš„åŒæ­¥ä»»åŠ¡...</span></div><div class="line">	<span class="comment">//æ›´æ–°stateä¹Ÿéœ€è¦æ—¶é—´</span></div><div class="line">	<span class="keyword">this</span>.setState(&#123;</div><div class="line">		...</div><div class="line">	&#125;)</div><div class="line">	<span class="comment">//è·å–æŸäº›æ•°æ®ï¼Œéœ€è¦é•¿æ—¶é—´ç­‰å¾…</span></div><div class="line">	<span class="keyword">this</span>.fetchData(arguements)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="React-Native-åŸç”Ÿæ¨¡å—è°ƒç”¨-iOS"><a href="#React-Native-åŸç”Ÿæ¨¡å—è°ƒç”¨-iOS" class="headerlink" title="React-Native åŸç”Ÿæ¨¡å—è°ƒç”¨(iOS)"></a>React-Native åŸç”Ÿæ¨¡å—è°ƒç”¨(iOS)</h3><p>åœ¨é¡¹ç›®ä¸­é‡åˆ°åœ°å›¾,æ‹¨æ‰“ç”µè¯,æ¸…é™¤ç¼“å­˜ç­‰iOSä¸Andioridæœºåˆ¶ä¸åŒçš„åŠŸèƒ½,å°±éœ€è¦è°ƒç”¨åŸç”Ÿçš„ç•Œé¢æˆ–æ¨¡å—ã€‚</p>
<h4 id="åˆ›å»ºåŸç”Ÿæ¨¡å—ï¼Œå®ç°â€œRCTBridgeModuleâ€åè®®"><a href="#åˆ›å»ºåŸç”Ÿæ¨¡å—ï¼Œå®ç°â€œRCTBridgeModuleâ€åè®®" class="headerlink" title="åˆ›å»ºåŸç”Ÿæ¨¡å—ï¼Œå®ç°â€œRCTBridgeModuleâ€åè®®"></a>åˆ›å»ºåŸç”Ÿæ¨¡å—ï¼Œå®ç°â€œRCTBridgeModuleâ€åè®®</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#import &lt;UIKit/UIKit.h&gt;</div><div class="line">#import &quot;RCTBridgeModule.h&quot;</div><div class="line"></div><div class="line">@interface LoginViewController : UIViewController&lt;RCTBridgeModule&gt;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<h4 id="å¯¼å‡ºæ¨¡å—ï¼Œå¯¼å‡ºæ–¹æ³•"><a href="#å¯¼å‡ºæ¨¡å—ï¼Œå¯¼å‡ºæ–¹æ³•" class="headerlink" title="å¯¼å‡ºæ¨¡å—ï¼Œå¯¼å‡ºæ–¹æ³•"></a>å¯¼å‡ºæ¨¡å—ï¼Œå¯¼å‡ºæ–¹æ³•</h4><p>ä¸ä»…å¯ä»¥è®©å¯¼å‡º native çš„æ–¹æ³•ï¼Œè€Œä¸”è¿˜å¯ä»¥åœ¨ js ä¸­æ·»åŠ å›è°ƒå‡½æ•°ï¼Œä¾› native è°ƒç”¨ï¼Œè¿™æ · native å°±å¯ä»¥å°†å‰é¢çš„æ•°æ®å›å¡ç»™ js äº†ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">@implementation LoginViewController</div><div class="line">//å¯¼å‡ºæ¨¡å—</div><div class="line">RCT_EXPORT_MODULE()</div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">&#125;</div><div class="line"></div><div class="line">RCT_EXPORT_METHOD(showSVProgressHUDErrorWithStatus:(NSString *)state callBack:(RCTResponseSenderBlock)callback)&#123;</div><div class="line">  NSLog(@&quot;state is %@&quot;,state);</div><div class="line">  NSArray *events = [[NSArray alloc] initWithObjects:@&quot;hello&quot;, nil];</div><div class="line">  // è¿™é‡Œcallbackå¿…é¡»æ˜¯æ•°ç»„</div><div class="line">  callback(events);</div><div class="line">  [SVProgressHUD showErrorWithStatus:state];</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure></p>
<h4 id="jsæ–‡ä»¶ä¸­è°ƒç”¨"><a href="#jsæ–‡ä»¶ä¸­è°ƒç”¨" class="headerlink" title="jsæ–‡ä»¶ä¸­è°ƒç”¨"></a>jsæ–‡ä»¶ä¸­è°ƒç”¨</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ›å»ºåŸç”Ÿæ¨¡å—å®ä¾‹</span></div><div class="line"><span class="keyword">let</span> LoginViewController = NativeModules.LoginViewController;</div><div class="line"></div><div class="line"><span class="comment">//æ–¹æ³•è°ƒç”¨</span></div><div class="line">LoginViewController.showSVProgressHUDErrorWithStatus(<span class="string">'è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·'</span>,(callbackString) =&gt; &#123;<span class="built_in">console</span>.log(callbackString);&#125;);</div></pre></td></tr></table></figure>
<h3 id="React-Native-çœŸæœºè°ƒè¯•"><a href="#React-Native-çœŸæœºè°ƒè¯•" class="headerlink" title="React Native çœŸæœºè°ƒè¯•"></a>React Native çœŸæœºè°ƒè¯•</h3><p>å¼€å‘ä¸­çœŸæœºè°ƒè¯•æ˜¯å¿…ä¸å¯å°‘çš„,æœ‰äº›åŠŸèƒ½å’Œé—®é¢˜æ¨¡æ‹Ÿå™¨æ˜¯æ— æ³•é‡ç°çš„,æ‰€ä»¥å°±éœ€è¦é…åˆçœŸæœºæµ‹è¯•</p>
<h4 id="iOS-çœŸæœºè°ƒè¯•"><a href="#iOS-çœŸæœºè°ƒè¯•" class="headerlink" title="iOS çœŸæœºè°ƒè¯•"></a>iOS çœŸæœºè°ƒè¯•</h4><p>é¦–å…ˆï¼Œ<strong>å¿…é¡»</strong> ä¿è¯è°ƒè¯•ç”¨ç”µè„‘çš„å’Œä½ çš„è®¾å¤‡å¤„äºç›¸åŒçš„ <code>WiFi</code> ç½‘ç»œç¯å¢ƒä¸­ä¸‹ã€‚ç„¶åä¿®æ”¹<code>AppDelegate.m</code> æ–‡ä»¶ï¼Œè®¾ç½® <code>jsLocation</code> ä¸ºæœ¬åœ° ip å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">NSURL *jsCodeLocation;</div><div class="line">[RCTBundleURLProvider sharedSettings].jsLocation = @&quot;192.168.31.142&quot;;</div><div class="line">jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@&quot;index.ios&quot; fallbackResource:nil];</div><div class="line"></div><div class="line">RCTRootView *rootView = [[RCTRootView alloc] initWithBundleURL:jsCodeLocation</div><div class="line">                                                      moduleName:@&quot;AwesomeProject&quot;</div><div class="line">                                               initialProperties:nil</div><div class="line">                                                   launchOptions:launchOptions];</div></pre></td></tr></table></figure>
<h3 id="React-Native-è¯»å–æœ¬åœ°çš„jsonæ–‡ä»¶"><a href="#React-Native-è¯»å–æœ¬åœ°çš„jsonæ–‡ä»¶" class="headerlink" title="React Native è¯»å–æœ¬åœ°çš„jsonæ–‡ä»¶"></a>React Native è¯»å–æœ¬åœ°çš„jsonæ–‡ä»¶</h3><p>å¯ä»¥ä»¥å¯¼å…¥çš„å½¢å¼ï¼Œæ¥è¯»å–æœ¬åœ°çš„jsonæ–‡ä»¶ï¼Œå¯¼å…¥çš„æ–‡ä»¶å¯ä»¥ä½œä¸ºä¸€ä¸ªjså¯¹è±¡ä½¿ç”¨ï¼Œè¿™æ ·æ–¹ä¾¿è°ƒè¯•çš„æ—¶å€™åŠ è½½æ•°æ®ã€‚</p>
<h4 id="å¯¼å…¥jsonæ–‡ä»¶ï¼š"><a href="#å¯¼å…¥jsonæ–‡ä»¶ï¼š" class="headerlink" title="å¯¼å…¥jsonæ–‡ä»¶ï¼š"></a>å¯¼å…¥jsonæ–‡ä»¶ï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> langsData = <span class="built_in">require</span>(<span class="string">'./json/langs.json'</span>);</div></pre></td></tr></table></figure>
<p>ç°åœ¨ä½ å¯ä»¥æ“ä½œ<code>langsData</code>å¯¹è±¡äº†ã€‚  </p>
<h4 id="jsonæ ¼å¼"><a href="#jsonæ ¼å¼" class="headerlink" title="jsonæ ¼å¼"></a>jsonæ ¼å¼</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"path"</span>:<span class="string">""</span>,</div><div class="line">    <span class="attr">"name"</span>:<span class="string">"123"</span>,</div><div class="line">    <span class="attr">"checked"</span>:<span class="literal">false</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"path"</span>:<span class="string">"aa"</span>,</div><div class="line">    <span class="attr">"name"</span>:<span class="string">"1234"</span>,</div><div class="line">    <span class="attr">"checked"</span>:<span class="literal">false</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"path"</span>:<span class="string">"ddd"</span>,</div><div class="line">    <span class="attr">"name"</span>:<span class="string">"123123123"</span>,</div><div class="line">    <span class="attr">"checked"</span>:<span class="literal">true</span></div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>,l=langsData.length;i&lt;l;i++)&#123;</div><div class="line">	<span class="built_in">console</span>.log(langsData[i]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[KVO ç®€ä»‹]]></title>
      <url>http://zhang759740844.github.io/2016/11/17/KVO/</url>
      <content type="html"><![CDATA[<p>æœ¬ç¯‡ç®€å•å­¦ä¹ ä¸‹å¦‚ä½•ä½¿ç”¨ KVOã€‚</p>
<a id="more"></a>
<h2 id="KVOæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#KVOæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="KVOæ˜¯ä»€ä¹ˆï¼Ÿ"></a>KVOæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>KVO æ˜¯ Object-C ä¸­å®šä¹‰çš„ä¸€ä¸ªé€šçŸ¥æœºåˆ¶ï¼Œå…¶å®šä¹‰äº†ä¸€ç§å¯¹è±¡é—´ç›‘æ§å¯¹æ–¹çŠ¶æ€çš„æ”¹å˜ï¼Œå¹¶åšå‡ºååº”çš„æœºåˆ¶ã€‚å¯¹è±¡å¯ä»¥ä¸ºè‡ªå·±çš„å±æ€§æ³¨å†Œè§‚å¯Ÿè€…ï¼Œå½“è¿™ä¸ªå±æ€§çš„å€¼å‘ç”Ÿäº†æ”¹å˜ï¼Œç³»ç»Ÿä¼šå¯¹è¿™äº›æ³¨å†Œçš„è§‚å¯Ÿè€…åšå‡ºé€šçŸ¥ã€‚å…¶ç”¨é€”ååˆ†å¹¿æ³›ï¼Œæ¯”æ–¹è¯´ï¼Œä½ çš„ä¸‹è½½è¿›åº¦æ¡æ˜¯æ ¹æ®ä¸‹è½½ç™¾åˆ†æ¯”å†³å®šçš„ï¼Œé‚£ä¹ˆï¼Œå¯ä»¥é€šè¿‡è§‚å¯Ÿä¸‹è½½ç™¾åˆ†æ¯”çš„æ”¹å˜ï¼Œåˆ·æ–°è¿›åº¦æ¡çš„æ ·å¼ï¼Œæ¥ç›´è§‚çš„ååº”ä¸‹è½½è¿›åº¦ç­‰ç­‰ã€‚ </p>
<h2 id="KVOçš„ç”¨æ³•"><a href="#KVOçš„ç”¨æ³•" class="headerlink" title="KVOçš„ç”¨æ³•"></a>KVOçš„ç”¨æ³•</h2><h3 id="ä¸ºå¯¹è±¡çš„å±æ€§æ³¨å†Œè§‚å¯Ÿè€…"><a href="#ä¸ºå¯¹è±¡çš„å±æ€§æ³¨å†Œè§‚å¯Ÿè€…" class="headerlink" title="ä¸ºå¯¹è±¡çš„å±æ€§æ³¨å†Œè§‚å¯Ÿè€…"></a>ä¸ºå¯¹è±¡çš„å±æ€§æ³¨å†Œè§‚å¯Ÿè€…</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)addObserver:(<span class="built_in">NSObject</span> *)observer  </div><div class="line">         forKeyPath:(<span class="built_in">NSString</span> *)keyPath  </div><div class="line">            options:(<span class="built_in">NSKeyValueObservingOptions</span>)options  </div><div class="line">            context:(<span class="keyword">void</span> *)context</div></pre></td></tr></table></figure>
<ul>
<li>observer: è§‚å¯Ÿè€…å¯¹è±¡. å…¶å¿…é¡»å®ç°æ–¹æ³• <code>observeValueForKeyPath:ofObject:change:context:</code>.</li>
<li>keyPath: è¢«è§‚å¯Ÿçš„å±æ€§ï¼Œå…¶ä¸èƒ½ä¸º <code>nil</code>.</li>
<li>options: è®¾å®šé€šçŸ¥è§‚å¯Ÿè€…æ—¶ä¼ é€’çš„å±æ€§å€¼ï¼Œæ˜¯ä¼ æ”¹å˜å‰çš„å‘¢ï¼Œè¿˜æ˜¯æ”¹å˜åçš„ï¼Œé€šå¸¸è®¾ç½®ä¸º <code>NSKeyValueObservingOptionNew</code>ã€‚</li>
<li>context: ä¸€äº›å…¶ä»–çš„éœ€è¦ä¼ é€’ç»™è§‚å¯Ÿè€…çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œé€šå¸¸è®¾ç½®ä¸º <code>nil</code>ã€‚</li>
</ul>
<h3 id="è§‚å¯Ÿè€…æ¥æ”¶é€šçŸ¥"><a href="#è§‚å¯Ÿè€…æ¥æ”¶é€šçŸ¥" class="headerlink" title="è§‚å¯Ÿè€…æ¥æ”¶é€šçŸ¥"></a>è§‚å¯Ÿè€…æ¥æ”¶é€šçŸ¥</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)observeValueForKeyPath:(<span class="built_in">NSString</span> *)keyPath  </div><div class="line">                      ofObject:(<span class="keyword">id</span>)object  </div><div class="line">                        change:(<span class="built_in">NSDictionary</span> *)change  </div><div class="line">                       context:(<span class="keyword">void</span> *)context</div></pre></td></tr></table></figure>
<ul>
<li>keyPath: è¢«è§‚å¯Ÿçš„å±æ€§ï¼Œå…¶ä¸èƒ½ä¸º <code>nil</code>.</li>
<li>object: è¢«è§‚å¯Ÿè€…çš„å¯¹è±¡.</li>
<li>change: å±æ€§å€¼ï¼Œæ ¹æ®ä¸Šé¢æåˆ°çš„ <code>Options</code> è®¾ç½®ï¼Œç»™å‡ºå¯¹åº”çš„å±æ€§å€¼ã€‚</li>
<li>context: ä¸Šé¢ä¼ é€’çš„ <code>context</code> å¯¹è±¡ã€‚</li>
</ul>
<h3 id="æ¸…é™¤è§‚å¯Ÿè€…"><a href="#æ¸…é™¤è§‚å¯Ÿè€…" class="headerlink" title="æ¸…é™¤è§‚å¯Ÿè€…"></a>æ¸…é™¤è§‚å¯Ÿè€…</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)removeObserver:(<span class="built_in">NSObject</span> *)anObserver forKeyPath:(<span class="built_in">NSString</span> *)keyPath</div></pre></td></tr></table></figure>
<h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>ä½¿ç”¨KVOæ¶ˆæ¯ä¼ é€’æœºåˆ¶æœ‰ä¸¤ä¸ªè¦æ±‚ï¼š</p>
<ol>
<li>è§‚å¯Ÿè€…å¿…é¡»çŸ¥é“è¢«è§‚å¯Ÿå¯¹è±¡ï¼Œå³åœ¨åŒä¸€ä½œç”¨åŸŸã€‚</li>
<li>è§‚å¯Ÿè€…è¿˜éœ€è¦çŸ¥é“è¢«è§‚å¯Ÿå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå› ä¸ºåœ¨é”€æ¯å‘é€è€…å¯¹è±¡ä¹‹å‰ï¼Œéœ€è¦å–æ¶ˆè§‚å¯Ÿè€…çš„æ³¨å†Œã€‚ </li>
</ol>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Effective Objective-C å­¦ä¹ ç¬”è®°]]></title>
      <url>http://zhang759740844.github.io/2016/11/11/Effective_oc2%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<p>æ‹œè¯»ä¸€ä¸‹ Effective Objective-C è¿™æœ¬ä¹¦ï¼Œåšä¸€äº›ç¬”è®°</p>
<a id="more"></a>
<h2 id="ç†Ÿæ‚‰OC"><a href="#ç†Ÿæ‚‰OC" class="headerlink" title="ç†Ÿæ‚‰OC"></a>ç†Ÿæ‚‰OC</h2><h3 id="ç¬¬1æ¡ï¼šäº†è§£Objective-Cçš„èµ·æº"><a href="#ç¬¬1æ¡ï¼šäº†è§£Objective-Cçš„èµ·æº" class="headerlink" title="ç¬¬1æ¡ï¼šäº†è§£Objective-Cçš„èµ·æº"></a>ç¬¬1æ¡ï¼šäº†è§£Objective-Cçš„èµ·æº</h3><p>å¯¹äºæ¶ˆæ¯ç»“æ„çš„è¯­è¨€ï¼Œè¿è¡Œæ—¶æ‰€æ‰§è¡Œçš„ä»£ç ç”±è¿è¡Œç¯å¢ƒæ¥å†³å®šï¼›åœ¨è¿è¡Œæ—¶æ‰å›å»æŸ¥æ‰¾ç´¢è¦æ‰§è¡Œçš„æ–¹æ³•ã€‚å…¶å®ç°åŸç†æ˜¯ç”±<strong>è¿è¡ŒæœŸç»„ä»¶ï¼ˆruntime componentï¼‰</strong>å®Œæˆï¼Œä½¿ç”¨ Objective-C çš„é¢å‘å¯¹è±¡ç‰¹æ€§æ‰€éœ€çš„å…¨éƒ¨æ•°æ®ç»“æ„ä»¥åŠå‡½æ•°éƒ½åœ¨è¿è¡ŒæœŸç»„ä»¶é‡Œé¢ã€‚</p>
<p>è¿è¡ŒæœŸç»„ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ä¸å¼€å‘è€…æ‰€ç¼–å†™çš„ä»£ç ç›¸é“¾æ¥çš„<strong>åŠ¨æ€åº“ï¼ˆdynamic libraryï¼‰</strong>ï¼Œå…¶ä»£ç èƒ½æŠŠå¼€å‘è€…æ‰€ç¼–å†™çš„æ‰€æœ‰ç¨‹åºç²˜åˆèµ·æ¥ã€‚</p>
<h3 id="ç¬¬2æ¡ï¼š-åœ¨ç±»çš„å¤´æ–‡ä»¶ä¸­å°½é‡å°‘å¼•ç”¨å…¶ä»–å¤´æ–‡ä»¶"><a href="#ç¬¬2æ¡ï¼š-åœ¨ç±»çš„å¤´æ–‡ä»¶ä¸­å°½é‡å°‘å¼•ç”¨å…¶ä»–å¤´æ–‡ä»¶" class="headerlink" title="ç¬¬2æ¡ï¼š åœ¨ç±»çš„å¤´æ–‡ä»¶ä¸­å°½é‡å°‘å¼•ç”¨å…¶ä»–å¤´æ–‡ä»¶"></a>ç¬¬2æ¡ï¼š åœ¨ç±»çš„å¤´æ–‡ä»¶ä¸­å°½é‡å°‘å¼•ç”¨å…¶ä»–å¤´æ–‡ä»¶</h3><p>æœ‰æ—¶ï¼Œç±»Aéœ€è¦å°†ç±»Bçš„å®ä¾‹å˜é‡ä½œä¸ºå®ƒå…¬å…± API çš„å±æ€§ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ä¸åº”è¯¥å¼•å…¥ç±»Bçš„å¤´æ–‡ä»¶ï¼Œè€Œåº”è¯¥ä½¿ç”¨<strong>å‘å‰å£°æ˜ï¼ˆforward declaringï¼‰</strong> ä½¿ç”¨ <code>@class</code> å…³é”®å­—ï¼Œå¹¶ä¸”<strong>åœ¨ A çš„å®ç°æ–‡ä»¶å¼•ç”¨ B çš„å¤´æ–‡ä»¶</strong>ã€‚(ç»§æ‰¿æˆ–è€…åè®®å¿…é¡»å¼•å…¥å®Œæ•´å¤´æ–‡ä»¶ï¼Œä¸èƒ½ä½¿ç”¨å‘å‰å£°æ˜)</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// EOCPerson.h</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@class</span> <span class="title">EOCEmployer</span>;</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCPerson</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *firstName;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *lastName;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) EOCEmployer *employer;<span class="comment">//å°†EOCEmployerä½œä¸ºå±æ€§</span></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="comment">// EOCPerson.m</span></div><div class="line"><span class="meta">#import <span class="meta-string">"EOCEmployer.h"</span></span></div></pre></td></tr></table></figure>
<p>è¿™æ ·åšæœ‰ä»€ä¹ˆä¼˜ç‚¹å‘¢ï¼š</p>
<ol>
<li>ä¸åœ¨Açš„å¤´æ–‡ä»¶ä¸­å¼•å…¥Bçš„å¤´æ–‡ä»¶ï¼Œé‚£ä¹ˆAçš„å®ç°æ–‡ä»¶å¼•å…¥Açš„å¤´æ–‡ä»¶æ—¶ï¼Œå°±ä¸ä¼šä¸€å¹¶å¼•å…¥Bçš„å…¨éƒ¨å†…å®¹ï¼Œè¿™æ ·å°±å‡å°‘äº†ç¼–è¯‘æ—¶é—´ã€‚åªæœ‰åœ¨Açš„å®ç°é‡Œéœ€è¦ç”¨åˆ°Bæ—¶ï¼Œå†åœ¨Açš„å®ç°é‡Œå¼•ç”¨Bçš„å¤´æ–‡ä»¶ã€‚</li>
<li>ä½¿ç”¨ <code>#import</code> è€Œä¸æ˜¯ <code>#include</code> å¯ä»¥é¿å…æ­»å¾ªç¯ï¼Œä½†ä»ä¼šå¯¼è‡´ç›¸äº’å¼•ç”¨çš„ä¸¤ä¸ªç±»ä¸­çš„ä¸€å“¥æ— æ³•æ­£ç¡®ç¼–è¯‘ã€‚ä½¿ç”¨ <code>@class</code> å¯ä»¥é¿å…å¾ªç¯å¼•ç”¨ï¼šå› ä¸ºå¦‚æœä¸¤ä¸ªç±»åœ¨è‡ªå·±çš„å¤´æ–‡ä»¶ä¸­éƒ½å¼•å…¥äº†å¯¹æ–¹çš„å¤´æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´å…¶ä¸­ä¸€ä¸ªç±»æ— æ³•è¢«æ­£ç¡®ç¼–è¯‘ã€‚</li>
</ol>
<h3 id="ç¬¬3æ¡ï¼šå¤šç”¨å­—é¢é‡è¯­æ³•ï¼Œå°‘ç”¨ä¸ä¹‹ç­‰ä»·çš„æ–¹æ³•"><a href="#ç¬¬3æ¡ï¼šå¤šç”¨å­—é¢é‡è¯­æ³•ï¼Œå°‘ç”¨ä¸ä¹‹ç­‰ä»·çš„æ–¹æ³•" class="headerlink" title="ç¬¬3æ¡ï¼šå¤šç”¨å­—é¢é‡è¯­æ³•ï¼Œå°‘ç”¨ä¸ä¹‹ç­‰ä»·çš„æ–¹æ³•"></a>ç¬¬3æ¡ï¼šå¤šç”¨å­—é¢é‡è¯­æ³•ï¼Œå°‘ç”¨ä¸ä¹‹ç­‰ä»·çš„æ–¹æ³•</h3><p>å£°æ˜æ—¶å¤šç”¨å­—é¢é‡ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSNumber</span> *intNumber = @<span class="number">1</span>;</div><div class="line"><span class="built_in">NSNumber</span> *floatNumber = @<span class="number">2.5</span>f;</div><div class="line"><span class="built_in">NSArray</span> *animals =@[<span class="string">@"cat"</span>, <span class="string">@"dog"</span>,<span class="string">@"mouse"</span>, <span class="string">@"badger"</span>];</div><div class="line">Dictionary *dict = @&#123;<span class="string">@"animal"</span>:<span class="string">@"tiger"</span>,<span class="string">@"phone"</span>:<span class="string">@"iPhone 6"</span>&#125;;</div><div class="line"></div><div class="line"><span class="built_in">NSString</span> *cat = animals[<span class="number">0</span>];</div><div class="line"><span class="built_in">NSString</span> *iphone = dict[<span class="string">@"phone"</span>];</div></pre></td></tr></table></figure>
<p>å°‘ç”¨ <code>alloc</code>ã€<code>init</code> çš„æ–¹å¼åˆ›å»ºï¼Œä»¥åŠ <code>objectAtIndex</code>ã€<code>objectForKey</code> çš„æ–¹å¼å–æ•°ç»„å­—å…¸ã€‚</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ol>
<li>ç®€æ´</li>
<li><code>NSArray</code> ä»¥ <code>nil</code> ç»“å°¾ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸å…è®¸æ•°ç»„ä¸­çš„å…ƒç´ ä¸º <code>nil</code>ï¼Œå¦‚æœä½¿ç”¨ç­‰ä»·æ–¹æ³•ï¼Œé‚£ä¹ˆæ•°ç»„å…ƒç´ ä¸º <code>nil</code> ä¸æŠ¥é”™ï¼Œä¼šå‡ºç°éš¾ä»¥æ’æŸ¥çš„é”™è¯¯ï¼›è€ŒåŒæ ·çš„æƒ…å†µï¼Œå­—é¢é‡è¯­æ³•ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ol>
<h3 id="ç¬¬4æ¡ï¼šå¤šç”¨ç±»å‹å¸¸é‡ï¼Œå°‘ç”¨-defineé¢„å¤„ç†å‘½ä»¤"><a href="#ç¬¬4æ¡ï¼šå¤šç”¨ç±»å‹å¸¸é‡ï¼Œå°‘ç”¨-defineé¢„å¤„ç†å‘½ä»¤" class="headerlink" title="ç¬¬4æ¡ï¼šå¤šç”¨ç±»å‹å¸¸é‡ï¼Œå°‘ç”¨#defineé¢„å¤„ç†å‘½ä»¤"></a>ç¬¬4æ¡ï¼šå¤šç”¨ç±»å‹å¸¸é‡ï¼Œå°‘ç”¨#defineé¢„å¤„ç†å‘½ä»¤</h3><p>é¢„å¤„ç†ä¸ç±»å‹å¸¸é‡çš„ä¼˜ç¼ºç‚¹ï¼š</p>
<ul>
<li>é¢„å¤„ç†å‘½ä»¤ï¼šç®€å•çš„æ–‡æœ¬æ›¿æ¢ï¼Œä¸åŒ…æ‹¬ç±»å‹ä¿¡æ¯ï¼Œå¹¶ä¸”å¯è¢«ä»»æ„ä¿®æ”¹ã€‚</li>
<li>ç±»å‹å¸¸é‡ï¼šåŒ…æ‹¬ç±»å‹ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®å…¶ä½¿ç”¨èŒƒå›´ï¼Œè€Œä¸”ä¸å¯è¢«ä¿®æ”¹ã€‚</li>
</ul>
<h4 id="é¢„å¤„ç†å‘½ä»¤"><a href="#é¢„å¤„ç†å‘½ä»¤" class="headerlink" title="é¢„å¤„ç†å‘½ä»¤"></a>é¢„å¤„ç†å‘½ä»¤</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#define W_LABEL (W_SCREEN - 2*GAP)</span></div></pre></td></tr></table></figure>
<p>è¿™é‡Œï¼Œ<code>(W_SCREEN - 2*GAP)</code> æ›¿æ¢äº† <code>W_LABEL</code>ï¼Œå®ƒä¸å…·å¤‡ <code>W_LABEL</code> çš„ç±»å‹ä¿¡æ¯ã€‚è€Œä¸”è¦æ³¨æ„ä¸€ä¸‹ï¼šå¦‚æœæ›¿æ¢å¼ä¸­å­˜åœ¨è¿ç®—ç¬¦å·ï¼Œä»¥ç¬”è€…çš„ç»éªŒæœ€å¥½ç”¨æ‹¬å·æ‹¬èµ·æ¥ï¼Œä¸ç„¶å®¹æ˜“å‡ºç°é”™è¯¯ï¼ˆæœ‰ä½“ä¼šï¼‰ã€‚</p>
<h4 id="ç±»å‹å¸¸é‡"><a href="#ç±»å‹å¸¸é‡" class="headerlink" title="ç±»å‹å¸¸é‡"></a>ç±»å‹å¸¸é‡</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="built_in">NSTimeIntervalDuration</span> = <span class="number">0.3</span>;</div></pre></td></tr></table></figure>
<p><code>const</code> å°†å…¶è®¾ç½®ä¸ºå¸¸é‡ï¼Œä¸å¯æ›´æ”¹ã€‚<code>static</code> æ„å‘³ç€è¯¥å˜é‡ä»…ä»…åœ¨å®šä¹‰æ­¤å˜é‡çš„ç¼–è¯‘å•å…ƒ(<code>.m</code> å®ç°æ–‡ä»¶)ä¸­å¯è§ã€‚å¦‚æœä¸å£°æ˜ <code>static</code>,ç¼–è¯‘å™¨ä¼šä¸ºå®ƒåˆ›å»ºä¸€ä¸ª<strong>å¤–éƒ¨ç¬¦å·ï¼ˆexternal symbolï¼‰</strong>ã€‚ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿå¦‚æœåœ¨å…¶ä»–ç±»ä¸­ä¹Ÿå£°æ˜äº†åŒåå˜é‡ï¼Œå³ä½¿æ²¡æœ‰ç›¸äº’å¼•ç”¨ï¼Œç¼–è¯‘å™¨ä¹Ÿä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚</p>
<h4 id="å…¨å±€å¸¸é‡"><a href="#å…¨å±€å¸¸é‡" class="headerlink" title="å…¨å±€å¸¸é‡"></a>å…¨å±€å¸¸é‡</h4><p>å¦‚æœæˆ‘ä»¬éœ€è¦å‘é€é€šçŸ¥ï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨ä¸åŒçš„åœ°æ–¹æ‹¿åˆ°é€šçŸ¥çš„â€œé¢‘é“â€å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæ˜¾ç„¶è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸èƒ½è¢«è½»æ˜“æ›´æ”¹ï¼Œè€Œä¸”å¯ä»¥åœ¨ä¸åŒçš„åœ°æ–¹è·å–ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦å®šä¹‰ä¸€ä¸ªå¤–ç•Œå¯è§çš„å­—ç¬¦ä¸²å¸¸é‡ï¼Œå³å…¨å±€å¸¸é‡ã€‚åœ¨å¤´æ–‡ä»¶ä¸­å£°æ˜å¤–éƒ¨å¸¸é‡ï¼Œåœ¨å®ç°æ–‡ä»¶ä¸­å®Œæˆå˜é‡çš„èµ‹å€¼ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//header file</span></div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> NotificationString;</div><div class="line"></div><div class="line"><span class="comment">//implementation file</span></div><div class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span>  NotificationString = <span class="string">@"Finish Download"</span>;</div></pre></td></tr></table></figure>
<p>æ³¨æ„è¿™é‡Œçš„ <code>const</code>, å¦‚æœåœ¨ <code>*</code> å‰é¢ï¼Œè¡¨ç¤ºæŒ‡é’ˆæŒ‡å‘çš„å †ä¸Šçš„å†…å®¹ä¸èƒ½æ”¹å˜ï¼Œå¦‚æœåœ¨ <code>*</code> åé¢ï¼Œè¡¨ç¤ºæŒ‡é’ˆæŒ‡å‘çš„åœ°å€æ˜¯ä¸èƒ½æ”¹å˜çš„ã€‚ï¼ˆè¿™é‡Œæœ‰ä¸ªåŠ©è®°æ–¹æ³•ï¼Œä»¥ <code>*</code> ä¸ºåˆ†è§£ï¼Œ<code>const</code> åœ¨å·¦è¾¹å°±æ˜¯ä¿®é¥° <code>NSString</code>ï¼Œè¡¨ç¤ºä¸èƒ½ä¿®æ”¹å€¼ï¼Œåœ¨å³è¾¹å°±è¡¨ç¤ºä¿®é¥°æŒ‡é’ˆå¯¹è±¡ï¼Œè¡¨ç¤ºä¸èƒ½ä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„åœ°å€ã€‚ï¼‰</p>
<h3 id="ç¬¬5æ¡ï¼šç”¨æšä¸¾è¡¨ç¤ºçŠ¶æ€ï¼Œé€‰é¡¹ï¼ŒçŠ¶æ€ç "><a href="#ç¬¬5æ¡ï¼šç”¨æšä¸¾è¡¨ç¤ºçŠ¶æ€ï¼Œé€‰é¡¹ï¼ŒçŠ¶æ€ç " class="headerlink" title="ç¬¬5æ¡ï¼šç”¨æšä¸¾è¡¨ç¤ºçŠ¶æ€ï¼Œé€‰é¡¹ï¼ŒçŠ¶æ€ç "></a>ç¬¬5æ¡ï¼šç”¨æšä¸¾è¡¨ç¤ºçŠ¶æ€ï¼Œé€‰é¡¹ï¼ŒçŠ¶æ€ç </h3><p>æˆ‘ä»¬ç»å¸¸éœ€è¦ç»™ç±»å®šä¹‰å‡ ä¸ªçŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€ç å¯ä»¥ç”¨æšä¸¾æ¥ç®¡ç†ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSUInteger</span>, EOCConnectionState) &#123;</div><div class="line">  EOCConnectionStateDisconnected,</div><div class="line">  EOCConnectionStateConnecting,</div><div class="line">  EOCConnectionStateConnected,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_OPTION</span>(<span class="built_in">NSUInteger</span>, EOCPermittedDirection) &#123;</div><div class="line">	EOCPermittedDirectionUp    = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</div><div class="line">	EOCPermittedDirectionDown  = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</div><div class="line">	EOCPermittedDirectionLeft  = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</div><div class="line">	EOCPermittedDirectionRight = <span class="number">1</span> &lt;&lt; <span class="number">3</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>NS_ENUM</code> å’Œ <code>NS_OPTION</code> æ˜¯ Foundation æ¡†æ¶ä¸­å®šä¹‰çš„è¾…åŠ©å®ã€‚éœ€è¦æ³¨æ„è¿™ä¸¤è€…ä½¿ç”¨åœºæ™¯çš„ä¸åŒã€‚</p>
<p>åœ¨æšä¸¾ç±»å‹çš„ switch è¯­å¥ä¸­ä¸è¦å®ç° default åˆ†æ”¯ã€‚å®ƒçš„å¥½å¤„æ˜¯ï¼Œå½“æˆ‘ä»¬ç»™æšä¸¾å¢åŠ æˆå‘˜æ—¶ï¼Œç¼–è¯‘å™¨å°±ä¼šæç¤ºå¼€å‘è€…ï¼šswitch è¯­å¥å¹¶æœªå¤„ç†æ‰€æœ‰çš„æšä¸¾ã€‚å¦åˆ™æ·»åŠ äº†æšä¸¾å´æ²¡æœ‰å®ç° switch å°†å¯èƒ½å¯¼è‡´ä¸¥é‡çš„å´©æºƒã€‚</p>
<h2 id="å¯¹è±¡ã€æ¶ˆæ¯ã€è¿è¡ŒæœŸ"><a href="#å¯¹è±¡ã€æ¶ˆæ¯ã€è¿è¡ŒæœŸ" class="headerlink" title="å¯¹è±¡ã€æ¶ˆæ¯ã€è¿è¡ŒæœŸ"></a>å¯¹è±¡ã€æ¶ˆæ¯ã€è¿è¡ŒæœŸ</h2><h3 id="ç¬¬6æ¡ï¼šç†è§£â€œå±æ€§â€è¿™ä¸€æ¦‚å¿µ"><a href="#ç¬¬6æ¡ï¼šç†è§£â€œå±æ€§â€è¿™ä¸€æ¦‚å¿µ" class="headerlink" title="ç¬¬6æ¡ï¼šç†è§£â€œå±æ€§â€è¿™ä¸€æ¦‚å¿µ"></a>ç¬¬6æ¡ï¼šç†è§£â€œå±æ€§â€è¿™ä¸€æ¦‚å¿µ</h3><h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><p>åœ¨ Java ä»¥åŠ C++ ä¸­ï¼Œå¯¹è±¡å¸ƒå±€åœ¨ç¼–è¯‘æœŸå°±å·²ç»å›ºå®šäº†ã€‚åªè¦è®¿é—®å˜é‡çš„ä»£ç ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠŠå…¶æ›¿æ¢æˆä¸ºâ€œåç§»é‡â€ã€‚è¿™ä¸ªåç§»é‡æ˜¯<strong>ç¡¬ç¼–ç ï¼ˆhardcodeï¼‰</strong>ï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡è·ç¦»å­˜æ”¾å¯¹è±¡çš„å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€æœ‰å¤šè¿œã€‚è¿™æ ·åšçš„é—®é¢˜æ˜¯ï¼Œå¦‚æœå†æ·»åŠ ä¸€ä¸ªå®ä¾‹å˜é‡ï¼Œé‚£ä¹ˆå…¶ä»–å®ä¾‹å˜é‡çš„å°±è¦å˜åŒ–äº†ï¼Œé‚£ä¹ˆå°±è¦é‡æ–°ç¼–è¯‘ï¼Œå¦åˆ™å°±ä¼šå‡ºé”™ã€‚</p>
<p>Objective-C çš„åšæ³•æ˜¯ï¼ŒæŠŠå®ä¾‹å˜é‡å½“åšä¸€ç§å­˜å‚¨åç§»é‡æ‰€ç”¨çš„<strong>â€œç‰¹æ®Šå˜é‡â€ï¼ˆspecial variableï¼‰</strong>ï¼Œäº¤ç”±<strong>â€œç±»å¯¹è±¡â€ï¼ˆclass objectï¼‰</strong>ä¿ç®¡ã€‚åç§»é‡ä¼šåœ¨è¿è¡ŒæœŸæŸ¥æ‰¾ï¼Œé‚£ä¹ˆç±»çš„å®šä¹‰å˜äº†ï¼Œå­˜å‚¨çš„åç§»é‡ä¹Ÿå°±å˜äº†ï¼Œè¿™æ ·çš„è¯ï¼Œæ— è®ºä½•æ—¶è®¿é—®å®ä¾‹å˜é‡ï¼Œæ€»èƒ½ä½¿ç”¨æ­£ç¡®çš„åç§»é‡ã€‚ç”šè‡³å¯ä»¥åœ¨è¿è¡ŒæœŸå‘ç±»ä¸­æ–°å¢å®ä¾‹å˜é‡ã€‚</p>
<h4 id="å­˜å–æ–¹æ³•"><a href="#å­˜å–æ–¹æ³•" class="headerlink" title="å­˜å–æ–¹æ³•"></a>å­˜å–æ–¹æ³•</h4><p>åœ¨è®¾ç½®å®Œå±æ€§åï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å‘ç±»ä¸­æ·»åŠ é€‚å½“ç±»å‹çš„å®ä¾‹å˜é‡ï¼Œå¹¶ä¸”ä¸ºå…¶å†™å‡ºä¸€å¥—å­˜å–æ–¹æ³•ã€‚è®¿é—®å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ç‚¹è¯­æ³•ï¼Œç¼–è¯‘å™¨ä¼šæŠŠç‚¹è¯­æ³•è½¬æ¢ä¸ºå¯¹å­˜å–æ–¹æ³•çš„è°ƒç”¨ï¼›ä¹Ÿå¯ç›´æ¥ä½¿ç”¨å®ä¾‹å˜é‡ï¼Œä½¿ç”¨å®ä¾‹å˜é‡çš„æ–¹å¼æ›´å¿«ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å­˜å–æ–¹æ³•è®¾ç½®å±æ€§</span></div><div class="line"><span class="keyword">self</span>.firstName = <span class="string">@"Zachary"</span>;</div><div class="line"><span class="comment">//å®ä¾‹å˜é‡è®¾ç½®å±æ€§</span></div><div class="line">_firstName = <span class="string">@"Zachary"</span>;</div></pre></td></tr></table></figure>
<h4 id="å±ç›¸ç‰¹è´¨"><a href="#å±ç›¸ç‰¹è´¨" class="headerlink" title="å±ç›¸ç‰¹è´¨"></a>å±ç›¸ç‰¹è´¨</h4><p>åŸå­æ€§ï¼š</p>
<ul>
<li>nonatomicï¼šä¸ä½¿ç”¨åŒæ­¥é”</li>
<li>atomicï¼šåŠ åŒæ­¥é”ï¼Œç¡®ä¿å…¶åŸå­æ€§</li>
</ul>
<p>è¯»å†™:</p>
<ul>
<li>readwrite:åŒæ—¶å­˜åœ¨å­˜å–æ–¹æ³•</li>
<li>readonly:åªæœ‰è·å–æ–¹æ³•</li>
</ul>
<p>å†…å­˜ç®¡ç†:</p>
<ul>
<li>assign:çº¯é‡ç±»å‹(scalar type)çš„ç®€å•èµ‹å€¼æ“ä½œ</li>
<li>strong:æ‹¥æœ‰å…³ç³»ä¿ç•™æ–°å€¼ï¼Œé‡Šæ”¾æ—§å€¼ï¼Œå†è®¾ç½®æ–°å€¼</li>
<li>weak:éæ‹¥æœ‰å…³ç³»(nonowning relationship)ï¼Œå±æ€§æ‰€æŒ‡çš„å¯¹è±¡é­åˆ°æ‘§æ¯æ—¶ï¼Œå±æ€§ä¹Ÿä¼šæ¸…ç©º</li>
<li>copyï¼šå½“èµ‹ç»™å…¶å¯å˜å¯¹è±¡ï¼Œè¿”å›ä¸å¯å˜å¯¹è±¡ï¼›å½“èµ‹ç»™å…¶ä¸å¯å˜å¯¹è±¡ï¼Œè¿”å›åŸå¯¹è±¡ã€‚</li>
</ul>
<h3 id="ç¬¬7æ¡ï¼š-åœ¨å¯¹è±¡å†…éƒ¨å°½é‡ç›´æ¥è®¿é—®å®ä¾‹å˜é‡"><a href="#ç¬¬7æ¡ï¼š-åœ¨å¯¹è±¡å†…éƒ¨å°½é‡ç›´æ¥è®¿é—®å®ä¾‹å˜é‡" class="headerlink" title="ç¬¬7æ¡ï¼š åœ¨å¯¹è±¡å†…éƒ¨å°½é‡ç›´æ¥è®¿é—®å®ä¾‹å˜é‡"></a>ç¬¬7æ¡ï¼š åœ¨å¯¹è±¡å†…éƒ¨å°½é‡ç›´æ¥è®¿é—®å®ä¾‹å˜é‡</h3><p>å…³äºå®ä¾‹å˜é‡çš„è®¿é—®ï¼Œå¯ä»¥ç›´æ¥è®¿é—® <code>_firstName</code>ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å±æ€§çš„æ–¹å¼(ç‚¹è¯­æ³•) <code>self.firstName</code> æ¥è®¿é—®ã€‚ä¹¦ä¸­ä½œè€…å»ºè®®åœ¨è¯»å–å®ä¾‹å˜é‡æ—¶é‡‡ç”¨ç›´æ¥è®¿é—®çš„å½¢å¼ï¼Œè€Œåœ¨è®¾ç½®å®ä¾‹å˜é‡çš„æ—¶å€™é€šè¿‡å±æ€§æ¥åšã€‚ï¼ˆè¿™éƒ¨åˆ†æ¯”è¾ƒé‡è¦ï¼‰</p>
<p>ç›´æ¥è®¿é—®å®ä¾‹å˜é‡çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>ä¸ç»è¿‡<strong>â€œæ–¹æ³•æ´¾å‘â€(method dispatch)</strong>ï¼Œä¼šç›´æ¥è®¿é—®ä¿å­˜å¯¹è±¡å®ä¾‹å˜é‡çš„é‚£å—å†…å­˜ï¼Œé€Ÿåº¦å¿«ã€‚</li>
</ul>
<p>é€šè¿‡å±æ€§è®¿é—®å®ä¾‹å˜é‡çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>ä¸ä¼šç»•è¿‡å±æ€§å®šä¹‰çš„<strong>å†…å­˜ç®¡ç†è¯­ä¹‰</strong>ã€‚å…¶å®ä¹Ÿå°±æ˜¯è¯´ï¼Œç¼–è¯‘æœŸåœ¨è®¾ç½® set æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šæ ¹æ®å±æ€§ç‰¹è´¨åšä¸€äº›æ“ä½œã€‚æ¯”å¦‚ä¸€ä¸ªå£°æ˜ä¸º <code>copy</code> çš„å±æ€§ï¼Œå¦‚æœç›´æ¥è®¿é—®å®ä¾‹å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå®ä¾‹å˜é‡å°±ä¼šç›´æ¥æŒ‡å‘å †ä¸­çš„å¯¹è±¡ï¼›è€Œå¦‚æœé€šè¿‡å±æ€§æ¥æ“ä½œï¼Œå°±ä¼šå…ˆå°†å †ä¸­çš„å¯¹è±¡ copy ä¸€ä»½ï¼Œç„¶åå°†å®ä¾‹å˜é‡æŒ‡å‘ copy å‡ºæ¥çš„å¯¹è±¡ã€‚</li>
<li>å¯ä»¥è§¦å‘KVO</li>
</ul>
<p>ä¸è¿‡æœ‰ä¸¤ä¸ªç‰¹ä¾‹ï¼š</p>
<ol>
<li><code>init</code> æ–¹æ³•å’Œ <code>dealloc</code> æ–¹æ³•ä¸­ï¼Œéœ€è¦ç›´æ¥è®¿é—®å®ä¾‹å˜é‡æ¥è¿›è¡Œè®¾ç½®å±æ€§æ“ä½œã€‚å› ä¸ºå¦‚æœåœ¨è¿™é‡Œæ²¡æœ‰ç»•è¿‡setæ–¹æ³•ï¼Œå°±æœ‰å¯èƒ½è§¦å‘å…¶ä»–ä¸å¿…è¦çš„æ“ä½œ(æ¯”å¦‚ä¸Šé¢è¯´çš„<strong>å†…å­˜ç®¡ç†è¯­ä¹‰</strong>æ‰€è¦è¿›è¡Œçš„æ“ä½œ)ã€‚</li>
<li>å¦‚æœä½¿ç”¨<strong>æ‡’åŠ è½½</strong>çš„è·å–æ–¹æ³•è¦ç”¨å±æ€§çš„æ–¹å¼è·å–ã€‚</li>
</ol>
<p>å…¶å®ï¼Œåˆ°åº•ç”¨ä»€ä¹ˆå¾ˆç®€å•ï¼Œå¦‚æœ getï¼Œset æ–¹æ³•é‡Œæ²¡æœ‰å…¶ä»–çš„ä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿ï¼Œæ¯”å¦‚:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSString</span> *)firstName&#123;</div><div class="line">	<span class="keyword">return</span> _firstName;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>) setFirstName:(<span class="built_in">NSString</span> *)firstName&#123;</div><div class="line">	_firstName = firstName;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ç§ï¼Œé‚£å°±ç›´æ¥ç”¨å®ä¾‹å˜é‡æ“ä½œäº†ï¼Œç”¨å±æ€§å°±æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼›å¦‚æœæœ‰ä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿ï¼Œé‚£ä¹ˆå°±è¦ç”¨å±æ€§çš„æ–¹å¼ã€‚</p>
<h3 id="ç¬¬8æ¡ï¼šç†è§£â€œå¯¹è±¡ç­‰åŒæ€§â€è¿™ä¸€æ¦‚å¿µ"><a href="#ç¬¬8æ¡ï¼šç†è§£â€œå¯¹è±¡ç­‰åŒæ€§â€è¿™ä¸€æ¦‚å¿µ" class="headerlink" title="ç¬¬8æ¡ï¼šç†è§£â€œå¯¹è±¡ç­‰åŒæ€§â€è¿™ä¸€æ¦‚å¿µ"></a>ç¬¬8æ¡ï¼šç†è§£â€œå¯¹è±¡ç­‰åŒæ€§â€è¿™ä¸€æ¦‚å¿µ</h3><p><code>NSObject</code> ç±»ä¸­æœ‰ä¸¤ä¸ªç”¨äºåˆ¤æ–­ç­‰åŒæ€§çš„æ–¹æ³•ï¼š</p>
<ul>
<li><code>- (BOOL)isEqual:(id)object;</code></li>
<li><code>- (NSUInteger)hash;</code></li>
</ul>
<p><code>NSObject</code> ç±»ä¸­é»˜è®¤çš„å®ç°æ˜¯ï¼šå½“ä¸”ä»…å½“å…¶å†…å­˜åœ°å€å®Œå…¨ç›¸ç­‰æ—¶ï¼Œä¸¤ä¸ªå¯¹è±¡æ‰ç›¸ç­‰ã€‚è‡ªå®šä¹‰å¯¹è±¡ä¸­å¯ä»¥è¦†å†™è¿™ä¸¤ä¸ªæ–¹æ³•ï¼ˆå…¶å®å¥½åƒæ²¡å¿…è¦é‡å†™ hash æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬é‡å†™çš„ <code>isEqual:</code> æ–¹æ³•é‡Œæ ¹æœ¬æ²¡æœ‰ç”¨åˆ° hash æ–¹æ³•ï¼Œé‡å†™äº†ä¹Ÿæ²¡å•¥ç”¨ï¼‰ï¼Œå®Œæˆè‡ªå·±çš„ç›¸ç­‰åˆ¤æ–­ã€‚å¦‚æœ <code>isEqual:</code> æ–¹æ³•åˆ¤æ–­å¯¹è±¡ç›¸ç­‰ï¼Œé‚£ä¹ˆå…¶ hash æ–¹æ³•ä¹Ÿå¿…é¡»è¿”å›åŒä¸€ä¸ªå€¼ï¼›åä¹‹ï¼Œå¦‚æœ hash æ–¹æ³•è¿”å›äº†åŒä¸€ä¸ªå€¼ï¼Œ<code>isEqual:</code> æ–¹æ³•æœªå¿…è®¤ä¸ºä¸¤è€…ç›¸ç­‰ã€‚</p>
<p>å¦‚æœå·²çŸ¥ä¸¤ä¸ªå¯¹è±¡æ˜¯å­—ç¬¦ä¸²ï¼Œæœ€å¥½é€šè¿‡ <code>isEqualToString:</code> æ–¹æ³•æ¥æ¯”è¾ƒã€‚å¯¹äºæ•°ç»„å’Œå­—å…¸ï¼Œä¹Ÿæœ‰ <code>isEqualToArray:</code> æ–¹æ³•å’Œ <code>isEqualToDictionary:</code>æ–¹æ³•ã€‚</p>
<p>å¦‚æœæ¯”è¾ƒçš„å¯¹è±¡ç±»å‹å’Œå½“å‰å¯¹è±¡ç±»å‹ç›¸åŒï¼Œå°±å¯ä»¥é‡‡ç”¨è‡ªå·±ç¼–å†™çš„åˆ¤å®šæ–¹æ³•ï¼Œå¦åˆ™è°ƒç”¨çˆ¶ç±»çš„ <code>isEqual:</code> æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)isEqualToPerson:(EOCPerson*)otherPerson &#123;</div><div class="line"></div><div class="line">     <span class="comment">//å…ˆæ¯”è¾ƒå¯¹è±¡ç±»å‹ï¼Œç„¶åæ¯”è¾ƒæ¯ä¸ªå±æ€§</span></div><div class="line">     <span class="keyword">if</span> (<span class="keyword">self</span> == object) <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">     <span class="keyword">if</span> (![_firstName isEqualToString:otherPerson.firstName])</div><div class="line">         <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">     <span class="keyword">if</span> (![_lastName isEqualToString:otherPerson.lastName])</div><div class="line">         <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">     <span class="keyword">if</span> (_age != otherPerson.age)</div><div class="line">         <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">     <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)isEqual:(<span class="keyword">id</span>)object &#123;</div><div class="line">    <span class="comment">//å¦‚æœå¯¹è±¡æ‰€å±ç±»å‹ç›¸åŒï¼Œå°±è°ƒç”¨è‡ªå·±ç¼–å†™çš„åˆ¤å®šæ–¹æ³•ï¼Œå¦‚æœä¸åŒï¼Œè°ƒç”¨çˆ¶ç±»çš„isEqual:æ–¹æ³•</span></div><div class="line">     <span class="keyword">if</span> ([<span class="keyword">self</span> <span class="keyword">class</span>] == [object <span class="keyword">class</span>]) &#123;    </div><div class="line">         <span class="keyword">return</span> [<span class="keyword">self</span> isEqualToPerson:(EOCPerson*)object];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;    </div><div class="line">         <span class="keyword">return</span> [<span class="keyword">super</span> isEqual:object];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="ç¬¬9æ¡-ä»¥â€œç±»æ—æ¨¡å¼â€œéšè—å®ç°ç»†èŠ‚"><a href="#ç¬¬9æ¡-ä»¥â€œç±»æ—æ¨¡å¼â€œéšè—å®ç°ç»†èŠ‚" class="headerlink" title="ç¬¬9æ¡ ä»¥â€œç±»æ—æ¨¡å¼â€œéšè—å®ç°ç»†èŠ‚"></a>ç¬¬9æ¡ ä»¥â€œç±»æ—æ¨¡å¼â€œéšè—å®ç°ç»†èŠ‚</h3><p>å…¶å®å°±æ˜¯é€šè¿‡æŠ½è±¡ç±»å®Œæˆå·¥å‚æ¨¡å¼ã€‚</p>
<p>ä¾‹å¦‚,å¯¹äºâ€œå‘˜å·¥â€è¿™ä¸ªç±»ï¼Œå¯ä»¥æœ‰å„ç§ä¸åŒçš„â€œå­ç±»å‹â€ï¼šå¼€å‘å‘˜å·¥ï¼Œè®¾è®¡å‘˜å·¥å’Œè´¢æ”¿å‘˜å·¥ã€‚è¿™äº›â€œå®ä½“ç±»â€å¯ä»¥ç”±â€œå‘˜å·¥â€è¿™ä¸ªæŠ½è±¡åŸºç±»æ¥è·å¾—ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//EOCEmployee.h</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSUInteger</span>, EOCEmployeeType) &#123;</div><div class="line">    EOCEmployeeTypeDeveloper,</div><div class="line">    EOCEmployeeTypeDesigner,</div><div class="line">    EOCEmployeeTypeFinance,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCEmployee</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</div><div class="line"><span class="keyword">@property</span> <span class="built_in">NSUInteger</span> salary;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// Helper for creating Employee objects</span></div><div class="line">+ (EOCEmployee*)employeeWithType:(EOCEmployeeType)type;</div><div class="line"></div><div class="line"><span class="comment">// Make Employees do their respective day's work</span></div><div class="line">- (<span class="keyword">void</span>)doADaysWork;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//EOCEmployee.m</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EOCEmployee</span></span></div><div class="line"></div><div class="line">+ (EOCEmployee*)employeeWithType:(EOCEmployeeType)type &#123;</div><div class="line">     <span class="keyword">switch</span> (type) &#123;</div><div class="line">         <span class="keyword">case</span> EOCEmployeeTypeDeveloper:</div><div class="line">            <span class="keyword">return</span> [EOCEmployeeDeveloper new];</div><div class="line">         <span class="keyword">break</span>; </div><div class="line"></div><div class="line">        <span class="keyword">case</span> EOCEmployeeTypeDesigner:</div><div class="line">             <span class="keyword">return</span> [EOCEmployeeDesigner new];</div><div class="line">         <span class="keyword">break</span>;</div><div class="line"></div><div class="line">        <span class="keyword">case</span> EOCEmployeeTypeFinance:</div><div class="line">             <span class="keyword">return</span> [EOCEmployeeFinance new];</div><div class="line">         <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)doADaysWork &#123;</div><div class="line"> <span class="comment">// éœ€è¦å­ç±»æ¥å®ç°</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCEmployeeDeveloper</span> : <span class="title">EOCEmployee</span></span></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EOCEmployeeDeveloper</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)doADaysWork &#123;</div><div class="line">    [<span class="keyword">self</span> writeCode];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œè¡¨é¢ä¸Šå¯¹è±¡æ˜¯ <code>EOCEmployee</code>ï¼Œä½†æ˜¯å®é™…ä¸Šæ“ä½œçš„æ˜¯ <code>EOCEmployeeDeveloper</code>ã€‚</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼šå¯¹äºè¿™ç§ç±»æ—ï¼Œä¸èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ¤æ–­ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ([employeeDeveloper <span class="keyword">class</span>] == [EOCEmployee <span class="keyword">class</span>])&#123;</div><div class="line">	<span class="comment">// will do</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å› ä¸º <code>employeeDeveloper</code> å¯¹è±¡æ˜¯ <code>EOCEmployee</code> ç±»çš„ä¸€ä¸ªå­é›†ï¼Œéœ€è¦ä½¿ç”¨ <code>isKindOfClass:</code> æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ([employeeDeveloper isKindOfClass:[EOCEmployee <span class="keyword">class</span>]])&#123;</div><div class="line">	<span class="comment">// will do</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ç¬¬10æ¡ï¼šåœ¨æ—¢æœ‰ç±»ä¸­ä½¿ç”¨å…³è”å¯¹è±¡å­˜æ”¾è‡ªå®šä¹‰æ•°æ®"><a href="#ç¬¬10æ¡ï¼šåœ¨æ—¢æœ‰ç±»ä¸­ä½¿ç”¨å…³è”å¯¹è±¡å­˜æ”¾è‡ªå®šä¹‰æ•°æ®" class="headerlink" title="ç¬¬10æ¡ï¼šåœ¨æ—¢æœ‰ç±»ä¸­ä½¿ç”¨å…³è”å¯¹è±¡å­˜æ”¾è‡ªå®šä¹‰æ•°æ®"></a>ç¬¬10æ¡ï¼šåœ¨æ—¢æœ‰ç±»ä¸­ä½¿ç”¨å…³è”å¯¹è±¡å­˜æ”¾è‡ªå®šä¹‰æ•°æ®</h3><p>è¿™ä¸€æ¡å’Œ runtime æ¯æ¯ç›¸å…³ã€‚èƒŒæ™¯æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ category ä¸ºç³»ç»Ÿç±»æ·»åŠ æ–¹æ³•ï¼Œä½†æ˜¯æ— æ³•æ·»åŠ å±æ€§ã€‚å½“éœ€è¦ä¸ºç³»ç»Ÿç±»æ·»åŠ å±æ€§æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ä¸ºæŸä¸ªå¯¹è±¡è®¾ç½®å…³è”å¯¹è±¡çš„å€¼ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸»å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯é”®ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å…³è”çš„å¯¹è±¡ï¼Œç¬¬å››ä¸ªå‚æ•°æ˜¯å­˜å‚¨ç­–ç•¥:æ˜¯æšä¸¾ï¼Œå®šä¹‰äº†å†…å­˜ç®¡ç†è¯­ä¹‰</span></div><div class="line"><span class="keyword">void</span> objc_setAssociatedObject(<span class="keyword">id</span> object, <span class="keyword">void</span> *key, <span class="keyword">id</span> value, objc_AssociationPolicy policy)</div><div class="line"></div><div class="line"><span class="comment">//æ ¹æ®ç»™å®šçš„é”®ä»æŸå¯¹è±¡ä¸­è·å–ç›¸åº”çš„å…³è”å¯¹è±¡å€¼</span></div><div class="line"><span class="keyword">id</span> objc_getAssociatedObject(<span class="keyword">id</span> object, <span class="keyword">void</span> *key)</div><div class="line"></div><div class="line"><span class="comment">//ç§»é™¤æŒ‡å®šå¯¹è±¡çš„å…³è”å¯¹è±¡</span></div><div class="line"><span class="keyword">void</span> objc_removeAssociatedObjects(<span class="keyword">id</span> object)</div></pre></td></tr></table></figure>
<p>è¿™é‡Œè¦å¼ºè°ƒçš„æ˜¯ï¼Œè¦æ‹¿åˆ°è®¾ç½®çš„å±æ€§ï¼Œé”®å¿…é¡»è¦å®Œå…¨ç›¸ç­‰ã€‚å› æ­¤ï¼Œéœ€è¦è®¾ç½®æˆé™æ€å…¨å±€å˜é‡ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">void</span> *EOCMyAlertViewKey = <span class="string">"EOCMyAlertViewKey"</span>;</div></pre></td></tr></table></figure>
<h3 id="ç¬¬11æ¡ï¼šç†è§£objc-msgSendçš„ä½œç”¨"><a href="#ç¬¬11æ¡ï¼šç†è§£objc-msgSendçš„ä½œç”¨" class="headerlink" title="ç¬¬11æ¡ï¼šç†è§£objc_msgSendçš„ä½œç”¨"></a>ç¬¬11æ¡ï¼šç†è§£objc_msgSendçš„ä½œç”¨</h3><p>è¿™éƒ¨åˆ†åœ¨<a href="https://zhang759740844.github.io/2016/08/22/runtimeåŸç†/">runtime</a>ä¸­å·²ç»å†™å¾—å¾ˆè¯¦ç»†äº†ï¼Œå‚è§å°±è¡Œäº†ã€‚</p>
<h3 id="ç¬¬12æ¡ï¼šç†è§£æ¶ˆæ¯è½¬å‘æœºåˆ¶"><a href="#ç¬¬12æ¡ï¼šç†è§£æ¶ˆæ¯è½¬å‘æœºåˆ¶" class="headerlink" title="ç¬¬12æ¡ï¼šç†è§£æ¶ˆæ¯è½¬å‘æœºåˆ¶"></a>ç¬¬12æ¡ï¼šç†è§£æ¶ˆæ¯è½¬å‘æœºåˆ¶</h3><p>è¿™éƒ¨åˆ†åœ¨<a href="https://zhang759740844.github.io/2016/08/23/runtimeåº”ç”¨/">runtime</a>ä¸­å·²ç»å†™å¾—å¾ˆè¯¦ç»†äº†ï¼Œå‚è§å°±è¡Œäº†ã€‚</p>
<h3 id="ç¬¬13æ¡ï¼šç”¨â€œæ–¹æ³•è°ƒé…æŠ€æœ¯â€è°ƒè¯•â€œé»‘ç›’æ–¹æ³•â€"><a href="#ç¬¬13æ¡ï¼šç”¨â€œæ–¹æ³•è°ƒé…æŠ€æœ¯â€è°ƒè¯•â€œé»‘ç›’æ–¹æ³•â€" class="headerlink" title="ç¬¬13æ¡ï¼šç”¨â€œæ–¹æ³•è°ƒé…æŠ€æœ¯â€è°ƒè¯•â€œé»‘ç›’æ–¹æ³•â€"></a>ç¬¬13æ¡ï¼šç”¨â€œæ–¹æ³•è°ƒé…æŠ€æœ¯â€è°ƒè¯•â€œé»‘ç›’æ–¹æ³•â€</h3><p>è¿™éƒ¨åˆ†åœ¨<a href="https://zhang759740844.github.io/2016/08/23/runtimeåº”ç”¨/">runtime</a>ä¸­ä¹Ÿä»‹ç»äº†ã€‚</p>
<h3 id="ç¬¬14æ¡ï¼šç†è§£â€œç±»å¯¹è±¡â€çš„ç”¨æ„"><a href="#ç¬¬14æ¡ï¼šç†è§£â€œç±»å¯¹è±¡â€çš„ç”¨æ„" class="headerlink" title="ç¬¬14æ¡ï¼šç†è§£â€œç±»å¯¹è±¡â€çš„ç”¨æ„"></a>ç¬¬14æ¡ï¼šç†è§£â€œç±»å¯¹è±¡â€çš„ç”¨æ„</h3><p>è¿™éƒ¨åˆ†åœ¨<a href="https://zhang759740844.github.io/2016/08/22/runtimeåŸç†/">runtime</a>ä¸­ä¹Ÿä»‹ç»äº†ã€‚</p>
<h2 id="æ¥å£ä¸APIè®¾è®¡"><a href="#æ¥å£ä¸APIè®¾è®¡" class="headerlink" title="æ¥å£ä¸APIè®¾è®¡"></a>æ¥å£ä¸APIè®¾è®¡</h2><h3 id="ç¬¬15æ¡ï¼šç”¨å‰ç¼€-é¿å…å‘½åç©ºé—´å†²çª"><a href="#ç¬¬15æ¡ï¼šç”¨å‰ç¼€-é¿å…å‘½åç©ºé—´å†²çª" class="headerlink" title="ç¬¬15æ¡ï¼šç”¨å‰ç¼€ é¿å…å‘½åç©ºé—´å†²çª"></a>ç¬¬15æ¡ï¼šç”¨å‰ç¼€ é¿å…å‘½åç©ºé—´å†²çª</h3><p>Apple å®£ç§°å…¶ä¿ç•™ä½¿ç”¨æ‰€æœ‰â€ä¸¤å­—æ¯å‰ç¼€â€çš„æƒåˆ©ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰ç”¨çš„å‰ç¼€åº”è¯¥æ˜¯ä¸‰ä¸ªå­—æ¯çš„ã€‚è€Œä¸”ï¼Œå¦‚æœè‡ªå·±å¼€å‘çš„ç¨‹åºä½¿ç”¨åˆ°äº†ç¬¬ä¸‰æ–¹åº“ï¼Œä¹Ÿåº”è¯¥åŠ ä¸Šå‰ç¼€ã€‚</p>
<h3 id="ç¬¬16æ¡ï¼šæä¾›â€å…¨èƒ½åˆå§‹åŒ–æ–¹æ³•â€"><a href="#ç¬¬16æ¡ï¼šæä¾›â€å…¨èƒ½åˆå§‹åŒ–æ–¹æ³•â€" class="headerlink" title="ç¬¬16æ¡ï¼šæä¾›â€å…¨èƒ½åˆå§‹åŒ–æ–¹æ³•â€"></a>ç¬¬16æ¡ï¼šæä¾›â€å…¨èƒ½åˆå§‹åŒ–æ–¹æ³•â€</h3><p>æ‰€è°“å…¨èƒ½åˆå§‹åŒ–æ–¹æ³•ï¼Œå°±æ˜¯æ‰€æœ‰åˆå§‹åŒ–æ–¹æ³•éƒ½è¦è°ƒç”¨çš„åˆå§‹åŒ–æ–¹æ³•ã€‚è¿™ä¸ªåˆå§‹åŒ–æ–¹æ³•åˆå§‹åŒ–æ–¹æ³•æ˜¯åˆå§‹åŒ–æ–¹æ³•é‡Œå‚æ•°æœ€å¤šçš„ä¸€ä¸ªï¼Œå› ä¸ºå®ƒä½¿ç”¨äº†å°½å¯èƒ½å¤šçš„åˆå§‹åŒ–æ‰€éœ€è¦çš„å‚æ•°ï¼Œä»¥ä¾¿å…¶ä»–çš„æ–¹æ³•æ¥è°ƒç”¨è‡ªå·±ã€‚</p>
<p>ç®—æ˜¯ä¸€ç§å†™ä»£ç çš„æŠ€å·§å§ã€‚å¹³æ—¶å†™ä»£ç çš„æ—¶å€™ä¹Ÿéƒ½æ˜¯è¿™æ ·çš„ï¼Œä¸å…·ä½“è¯´æ˜äº†ã€‚</p>
<h3 id="ç¬¬17æ¡ï¼šå®ç°descriptionæ–¹æ³•"><a href="#ç¬¬17æ¡ï¼šå®ç°descriptionæ–¹æ³•" class="headerlink" title="ç¬¬17æ¡ï¼šå®ç°descriptionæ–¹æ³•"></a>ç¬¬17æ¡ï¼šå®ç°descriptionæ–¹æ³•</h3><p>è‡ªå®šä¹‰çš„ç±»è°ƒç”¨ <code>NSLog();</code> çš„æ—¶å€™ï¼Œå¾€å¾€ä¸èƒ½è¿”å›æƒ³è¦çš„ç»“æœã€‚éœ€è¦é‡å†™ <code>NSObject</code> ç±»ä¸­çš„ <code>description</code> æ–¹æ³•ï¼Œè¿”å›éœ€è¦çš„å­—ç¬¦ä¸²ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSString</span>*)description &#123;</div><div class="line">     <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"&lt;%@: %p, %@ %@&gt;"</span>, [<span class="keyword">self</span> <span class="keyword">class</span>], <span class="keyword">self</span>, firstName, lastName];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼Œ<code>%p</code> è¡¨ç¤ºå¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</p>
<h3 id="ç¬¬18æ¡ï¼šå°½é‡ä½¿ç”¨ä¸å¯å˜å¯¹è±¡"><a href="#ç¬¬18æ¡ï¼šå°½é‡ä½¿ç”¨ä¸å¯å˜å¯¹è±¡" class="headerlink" title="ç¬¬18æ¡ï¼šå°½é‡ä½¿ç”¨ä¸å¯å˜å¯¹è±¡"></a>ç¬¬18æ¡ï¼šå°½é‡ä½¿ç”¨ä¸å¯å˜å¯¹è±¡</h3><p>å°½é‡ä½¿ç”¨ä¸å¯å˜å¯¹è±¡ã€‚æ²¡å•¥å¯è¯´çš„ã€‚<br>é‡Œé¢æ¨èçš„æ–¹æ³•æ²¡ç”¨è¿‡ï¼Œæ„Ÿè§‰å¹¶ä¸å¥½ï¼Œå°±ä¸å†™äº†ã€‚</p>
<h3 id="ç¬¬19æ¡ï¼šä½¿ç”¨æ¸…æ™°è€Œåè°ƒçš„å‘½åæ–¹å¼"><a href="#ç¬¬19æ¡ï¼šä½¿ç”¨æ¸…æ™°è€Œåè°ƒçš„å‘½åæ–¹å¼" class="headerlink" title="ç¬¬19æ¡ï¼šä½¿ç”¨æ¸…æ™°è€Œåè°ƒçš„å‘½åæ–¹å¼"></a>ç¬¬19æ¡ï¼šä½¿ç”¨æ¸…æ™°è€Œåè°ƒçš„å‘½åæ–¹å¼</h3><p>æ²¡å•¥å¥½è¯´çš„ï¼Œæ³¨æ„å°±å¥½</p>
<h3 id="ç¬¬20æ¡ï¼šä¸ºç§æœ‰æ–¹æ³•ååŠ å‰ç¼€"><a href="#ç¬¬20æ¡ï¼šä¸ºç§æœ‰æ–¹æ³•ååŠ å‰ç¼€" class="headerlink" title="ç¬¬20æ¡ï¼šä¸ºç§æœ‰æ–¹æ³•ååŠ å‰ç¼€"></a>ç¬¬20æ¡ï¼šä¸ºç§æœ‰æ–¹æ³•ååŠ å‰ç¼€</h3><p>å»ºè®®åœ¨å®ç°æ–‡ä»¶é‡Œå°†éå…¬å¼€çš„æ–¹æ³•éƒ½åŠ ä¸Šå‰ç¼€ï¼Œä¾¿äºè°ƒè¯•ï¼Œè€Œä¸”è¿™æ ·ä¸€æ¥ä¹Ÿå¾ˆå®¹æ˜“åŒºåˆ†å“ªäº›æ˜¯å…¬å…±æ–¹æ³•ï¼Œå“ªäº›æ˜¯ç§æœ‰æ–¹æ³•ã€‚å› ä¸ºå¾€å¾€å…¬å…±æ–¹æ³•æ˜¯ä¸ä¾¿äºä»»æ„ä¿®æ”¹çš„ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCObject</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)publicMethod;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EOCObject</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)publicMethod &#123;</div><div class="line"> <span class="comment">/* ... */</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)p_privateMethod &#123;</div><div class="line"> <span class="comment">/* ... */</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>å¾ˆæœ‰ç”¨çš„å»ºè®®ï¼Œæ³¨æ„ä¸è¦ç”¨ä¸‹åˆ’çº¿æ¥åŒºåˆ†ç§æœ‰æ–¹æ³•å’Œå…¬å…±æ–¹æ³•ï¼Œå› ä¸ºä¼šå’Œè‹¹æœå…¬å¸çš„APIé‡å¤ã€‚</p>
<h3 id="ç¬¬21æ¡ï¼šç†è§£Objective-Cé”™è¯¯ç±»å‹"><a href="#ç¬¬21æ¡ï¼šç†è§£Objective-Cé”™è¯¯ç±»å‹" class="headerlink" title="ç¬¬21æ¡ï¼šç†è§£Objective-Cé”™è¯¯ç±»å‹"></a>ç¬¬21æ¡ï¼šç†è§£Objective-Cé”™è¯¯ç±»å‹</h3><p>OC ä¸­ä»…åœ¨åŠå…¶ä¸¥é‡çš„é”™è¯¯æƒ…å†µä¸‹æŠ›å‡ºå¼‚å¸¸ã€‚æ¯”å¦‚ä¸€ä¸ªæŠ½è±¡åŸºç±»ã€‚ç”±äº OC ä¸­æ²¡åŠæ³•å°†æŸä¸ªç±»æ ‡è¯†ä¸ºæŠ½è±¡ç±»ã€‚å¦‚æœæƒ³è¦å®ç°æŠ½è±¡ç±»çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±è¦åœ¨å¿…é¡»è¦è¦†å†™çš„æ–¹æ³•é‡ŒæŠ›å‡ºå¼‚å¸¸ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)mustOverrideMethod&#123;</div><div class="line">	<span class="built_in">NSString</span> *reason = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@ must be overridden"</span>, <span class="built_in">NSStringFromeSelector</span>(_cmd)];</div><div class="line">	<span class="keyword">@throw</span> [<span class="built_in">NSException</span> exceptionWithName:<span class="built_in">NSInternalInconsistencyException</span></div><div class="line">									    reason:reason</div><div class="line">									  userInfo:<span class="literal">nil</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯¹äºä¸ä¸¥é‡çš„å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨è¿”å› <code>nil</code> æˆ–è€… <code>NSError</code> çš„æ–¹å¼(å…¶å®ä¹Ÿæ²¡å•¥ç”¨ï¼Œè¿™äº›éƒ½æ˜¯æ‰‹åŠ¨è®¾ç½®çš„ï¼Œæˆ‘éƒ½çŸ¥é“å“ªé‡Œä¼šå‡ºç°é—®é¢˜äº†ï¼Œè¿˜è¦æ–°å»º <code>NSError</code> å¯¹è±¡å¹²å˜›(å¯èƒ½æˆ‘çš„ç†è§£æœ‰åå·®))ã€‚</p>
<h3 id="ç¬¬22æ¡ï¼šç†è§£NSCopyingåè®®"><a href="#ç¬¬22æ¡ï¼šç†è§£NSCopyingåè®®" class="headerlink" title="ç¬¬22æ¡ï¼šç†è§£NSCopyingåè®®"></a>ç¬¬22æ¡ï¼šç†è§£NSCopyingåè®®</h3><h4 id="è‡ªå®šä¹‰æ‹·è´"><a href="#è‡ªå®šä¹‰æ‹·è´" class="headerlink" title="è‡ªå®šä¹‰æ‹·è´"></a>è‡ªå®šä¹‰æ‹·è´</h4><p>å¦‚æœæˆ‘ä»¬æƒ³ä»¤è‡ªå·±çš„ç±»æ”¯æŒæ‹·è´æ“ä½œï¼Œé‚£å°±è¦å®ç° <code>NSCopying</code> åè®®ï¼Œè¯¥åè®®åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span>*)zone</div></pre></td></tr></table></figure>
<p>æ¯”å¦‚è¦æ‹·è´ä¸€ä¸ª <code>EOCPerson</code> å¯¹è±¡ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span>*)zone &#123;</div><div class="line">     EOCPerson *<span class="keyword">copy</span> = [[[<span class="keyword">self</span> <span class="keyword">class</span>] allocWithZone:zone] initWithFirstName:_firstName  andLastName:_lastName];</div><div class="line">    <span class="keyword">copy</span>-&gt;_friends = [_friends mutableCopy];</div><div class="line">     <span class="keyword">return</span> <span class="keyword">copy</span>;</div><div class="line">&#125;</div><div class="line">``` </div><div class="line"></div><div class="line">è¿™é‡Œé¢çš„ `<span class="built_in">NSZone</span> *zone` å¯¹è±¡ä¸ç”¨åœ¨æ„æ˜¯ä»€ä¹ˆï¼Œç°åœ¨å·²ç»æ²¡ç”¨äº†ã€‚å…¶å®ä¹Ÿå°±æ˜¯æ–°å»ºä¸€ä¸ª `EOCPerson` å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å®ƒçš„æ„é€ å‡½æ•°æŠŠä¸œè¥¿å…¨éƒ½å¡è¿›å»ã€‚è¿™é‡Œçš„ `-&gt;` ç”¨ç®­å¤´æ˜¯å› ä¸ºå®šä¹‰çš„æ—¶å€™è¿™ä¸ª `_friends` ä¸æ˜¯ä¸€ä¸ªå±æ€§(ä»£ç æ²¡æœ‰è´´å‡ºæ¥ï¼Œè¯¦è§ä¹¦)ï¼Œè€Œåªæ˜¯åœ¨å®ç°æ–‡ä»¶ä¸­å®šä¹‰çš„ä¸€ä¸ªå®ä¾‹å˜é‡ï¼Œæ²¡æœ‰ get/set æ–¹æ³•ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ `.` </div><div class="line"></div><div class="line">è¿™é‡Œçš„ `mutableCopy` æ–¹æ³•ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œå°±æ˜¯ä¸‹é¢æ–¹æ³•çš„å®ç° </div><div class="line">```objc</div><div class="line">- (<span class="keyword">id</span>)mutableCopyWithZone:(<span class="built_in">NSZone</span>*)zoneï¼›</div></pre></td></tr></table></figure>
<h4 id="æµ…æ‹·è´ä¸æ·±æ‹·è´"><a href="#æµ…æ‹·è´ä¸æ·±æ‹·è´" class="headerlink" title="æµ…æ‹·è´ä¸æ·±æ‹·è´"></a>æµ…æ‹·è´ä¸æ·±æ‹·è´</h4><p>æµ…æ‹·è´å’Œæ·±æ‹·è´åº”è¯¥å¹¶ä¸é™Œç”Ÿã€‚æµ…æ‹·è´åªå¢åŠ å¼•ç”¨è®¡æ•°ï¼Œæ·±æ‹·è´å°†åˆ›å»ºå¦ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„å¯¹è±¡ã€‚</p>
<ul>
<li>ä¸å¯å˜å¯¹è±¡çš„ <code>copy</code> æ˜¯æµ…æ‹·è´ã€‚</li>
<li>å¯å˜å¯¹è±¡çš„ <code>copy</code> æ˜¯æ·±æ‹·è´ï¼Œè¿”å›ä¸å¯å˜å¯¹è±¡ã€‚</li>
<li>ä¸å¯å˜å¯¹è±¡çš„ <code>mutableCopy</code> æ˜¯æ·±æ‹·è´ï¼Œè¿”å›å¯å˜å¯¹è±¡ã€‚</li>
<li>å¯å˜å¯¹è±¡çš„ <code>mutableCopy</code> æ˜¯æµ…æ‹·è´ã€‚</li>
</ul>
<p>å®¹å™¨å¯¹è±¡(<code>NSArray</code>)æœ¬èº«ä¹Ÿéµå¾ªä¸Šé¢çš„è§„åˆ™ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>å®¹å™¨å¯¹è±¡å†…çš„å…ƒç´ æ˜¯æµ…æ‹·è´</strong>ã€‚å› æ­¤ä¸Šé¢çš„è‡ªå®šä¹‰ copy æ–¹æ³•å¦‚æœæƒ³è®© <code>_friends</code> å†…çš„å…ƒç´ æ·±æ‹·è´ï¼Œå°±ä¸èƒ½ç”¨ <code>[_friends mutableCopy]</code> æ–¹æ³•ï¼Œéœ€è¦æ–°å»ºä¸€ä¸ª Set:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">id</span>)deepCopy &#123;</div><div class="line">   EOCPerson *<span class="keyword">copy</span> = [[[<span class="keyword">self</span> <span class="keyword">class</span>] alloc] initWithFirstName:_firstName andLastName:_lastName];</div><div class="line">	<span class="keyword">copy</span>-&gt;_friends = [[<span class="built_in">NSMutableSet</span> alloc] initWithSet:_friends copyItems:<span class="literal">YES</span>];</div><div class="line">   <span class="keyword">return</span> <span class="keyword">copy</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="åè®®ä¸åˆ†ç±»"><a href="#åè®®ä¸åˆ†ç±»" class="headerlink" title="åè®®ä¸åˆ†ç±»"></a>åè®®ä¸åˆ†ç±»</h2><h3 id="ç¬¬23æ¡ï¼šé€šè¿‡å§”æ‰˜ä¸æ•°æ®æºåè®®è¿›è¡Œå¯¹è±¡é—´é€šä¿¡"><a href="#ç¬¬23æ¡ï¼šé€šè¿‡å§”æ‰˜ä¸æ•°æ®æºåè®®è¿›è¡Œå¯¹è±¡é—´é€šä¿¡" class="headerlink" title="ç¬¬23æ¡ï¼šé€šè¿‡å§”æ‰˜ä¸æ•°æ®æºåè®®è¿›è¡Œå¯¹è±¡é—´é€šä¿¡"></a>ç¬¬23æ¡ï¼šé€šè¿‡å§”æ‰˜ä¸æ•°æ®æºåè®®è¿›è¡Œå¯¹è±¡é—´é€šä¿¡</h3><p>å…¶å®ä¹Ÿæ˜¯è€ç”Ÿå¸¸è°ˆçš„ä¸œè¥¿äº†ï¼Œä¸è¿‡ä¹Ÿæœ‰ä¸€äº›æ³¨æ„ç‚¹ã€‚</p>
<p>å—ä»£ç†å¯¹è±¡å†…æŒæœ‰ä»£ç†å¯¹è±¡çš„å®ä¾‹æ—¶è¦å†™æˆè¿™æ ·ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">id</span> &lt;NetworkDelegate&gt; delegate;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œä¹¦ä¸­æŒ‡æ˜äº†è¦ç”¨ <code>weak</code>ï¼Œä¸èƒ½ç”¨ <code>strong</code>ï¼Œå¦åˆ™ä¼šå¼•èµ·å¼•ç”¨å¾ªç¯ã€‚æ¯”å¦‚ç³»ç»Ÿä¸­çš„ <code>TableViewCellDelegate</code>ï¼Œåœ¨ <code>TableViewController</code> ä½œä¸ºä»£ç†ç±»ç¡®å®æ‹¥æœ‰è¢«ä»£ç†å¯¹è±¡ <code>TableViewCell</code>ï¼Œç”¨ <code>weak</code> ç¡®å®æ˜¯åˆç†çš„ï¼Œä½†æ˜¯æ‰€æœ‰æƒ…å†µéƒ½è¿™æ ·å—ï¼Ÿä¸çŸ¥é“ï¼Œä¸è¿‡ç¡®å®åŸºæœ¬ä¸Šçš„ä»£ç†å¯¹è±¡éƒ½æ˜¯ <code>ViewController</code>ï¼Œæ‰€ä»¥ç”¨ <code>weak</code> è‚¯å®šæ˜¯ä¸ä¼šæœ‰é—®é¢˜çš„ã€‚</p>
<p>å®ç°å§”æ‰˜å¯¹è±¡çš„æ–¹æ³•æ˜¯å£°æ˜æŸä¸ªç±»éµä»å§”æ‰˜åè®®ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EOCDataModel</span> () &lt;<span class="title">EOCNetworkFetcherDelegate</span>&gt;</span></div><div class="line"><span class="keyword">@end</span></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EOCDataModel</span></span></div><div class="line"><span class="comment">// å„ä¸ªå®ç°æ–¹æ³•</span></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>åŸºæœ¬æ‰€æœ‰çš„ Delegate éƒ½åœ¨ <code>.m</code> æ–‡ä»¶ä¸­çš„ç±»æ‹“å±•ä¸­å£°æ˜ï¼Œä¹‹å‰ä¸€ç›´æ²¡æœ‰ç•™æ„ï¼Œçœ‹äº†ä¹¦åæ‰é—®è‡ªå·±ï¼Œä¸ºä»€ä¹ˆä¸åœ¨ <code>.h</code> ä¸­å£°æ˜ï¼Ÿä¸¤è€…æœ‰ä»€ä¹ˆå·®åˆ«å—ï¼Ÿå…¶å®ä¹Ÿæ²¡ä»€ä¹ˆå·®åˆ«ï¼Œåœ¨å®ç°æ–‡ä»¶ä¸­å£°æ˜çš„å¥½å¤„æ˜¯èƒ½éšè—ç»†èŠ‚ã€‚å¦‚æœåªæ˜¯è‡ªå·±ç”¨å¯èƒ½æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä½†æ˜¯å¦‚æœæ‰“åŒ…ç»™åˆ«äººç”¨ï¼Œé‚£ä¹ˆå°±ä¸åº”è¯¥è®©åˆ«äººçœ‹åˆ°ä½ çš„å®ç°ç»†èŠ‚äº†ï¼Œå› æ­¤ï¼Œå°±æŠŠè¿™ä¸ª Delegate çš„å£°æ˜æ”¾åˆ°äº†å®ç°æ–‡ä»¶ä¸­ã€‚<br>å¥½å§ã€‚ä¸€ä¸ªç®€å•çš„é“ç†ã€‚åªæ˜¯æˆ‘ä¸€å¼€å§‹æ²¡æƒ³æ˜ç™½ã€‚</p>
<h3 id="ç¬¬24æ¡ï¼šå°†ç±»çš„å®ç°ä»£ç åˆ†æ•£åˆ°ä¾¿äºç®¡ç†çš„æ•°ä¸ªåˆ†ç±»ä¸­"><a href="#ç¬¬24æ¡ï¼šå°†ç±»çš„å®ç°ä»£ç åˆ†æ•£åˆ°ä¾¿äºç®¡ç†çš„æ•°ä¸ªåˆ†ç±»ä¸­" class="headerlink" title="ç¬¬24æ¡ï¼šå°†ç±»çš„å®ç°ä»£ç åˆ†æ•£åˆ°ä¾¿äºç®¡ç†çš„æ•°ä¸ªåˆ†ç±»ä¸­"></a>ç¬¬24æ¡ï¼šå°†ç±»çš„å®ç°ä»£ç åˆ†æ•£åˆ°ä¾¿äºç®¡ç†çš„æ•°ä¸ªåˆ†ç±»ä¸­</h3><p>å½“ä¸€ä¸ªç±»è¶Šæ¥è¶Šå¤§æ—¶ï¼Œå°±å˜å¾—ä¸åˆ©äºç®¡ç†ï¼Œå› æ­¤éœ€è¦å°†ç±»ä»£ç æŒ‰ç…§é€»è¾‘åˆ’åˆ†å…¥å‡ ä¸ªåˆ†åŒºä¸­ï¼Œå¯ä»¥é€šè¿‡èŒƒç•´çš„æ–¹å¼å®ç°ã€‚ä¹¦ä¸­æœ‰ä¸€ä¸ªä¾‹å­ï¼š</p>
<p>æ— åˆ†ç±»:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCPerson</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSString</span> *firstName;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSString</span> *lastName;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) <span class="built_in">NSArray</span> *friends;</div><div class="line"></div><div class="line">- (<span class="keyword">id</span>)initWithFirstName:(<span class="built_in">NSString</span>*)firstName andLastName:(<span class="built_in">NSString</span>*)lastName;</div><div class="line"></div><div class="line"><span class="comment">/* Friendship methods */</span></div><div class="line">- (<span class="keyword">void</span>)addFriend:(EOCPerson*)person;</div><div class="line">- (<span class="keyword">void</span>)removeFriend:(EOCPerson*)person;</div><div class="line">- (<span class="built_in">BOOL</span>)isFriendsWith:(EOCPerson*)person;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/* Work methods */</span></div><div class="line">- (<span class="keyword">void</span>)performDaysWork;</div><div class="line">- (<span class="keyword">void</span>)takeVacationFromWork;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/* Play methods */</span></div><div class="line">- (<span class="keyword">void</span>)goToTheCinema;</div><div class="line">- (<span class="keyword">void</span>)goToSportsGame;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>åˆ†ç±»å:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCPerson</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSString</span> *firstName;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSString</span> *lastName;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) <span class="built_in">NSArray</span> *friends;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">id</span>)initWithFirstName:(<span class="built_in">NSString</span>*)firstName</div><div class="line"></div><div class="line">andLastName:(<span class="built_in">NSString</span>*)lastName;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCPerson</span> (<span class="title">Friendship</span>)</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)addFriend:(EOCPerson*)person;</div><div class="line">- (<span class="keyword">void</span>)removeFriend:(EOCPerson*)person;</div><div class="line">- (<span class="built_in">BOOL</span>)isFriendsWith:(EOCPerson*)person;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCPerson</span> (<span class="title">Work</span>)</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)performDaysWork;</div><div class="line">- (<span class="keyword">void</span>)takeVacationFromWork;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCPerson</span> (<span class="title">Play</span>)</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)goToTheCinema;</div><div class="line">- (<span class="keyword">void</span>)goToSportsGame;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>å¦‚æœè§‰å¾—å†™åœ¨ä¸€ä¸ªå®ç°æ–‡ä»¶ä¸­å¤ªé•¿äº†ï¼Œå¯ä»¥æ‹†å¼€ï¼Œæ¯”å¦‚å°†å…¶ä¸­çš„ <code>Friendship</code> æ‹†å¼€ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// EOCPerson+Friendship.h</span></div><div class="line"><span class="meta">#import <span class="meta-string">"EOCPerson.h"</span></span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCPerson</span> (<span class="title">Friendship</span>)</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)addFriend:(EOCPerson*)person;</div><div class="line">- (<span class="keyword">void</span>)removeFriend:(EOCPerson*)person;</div><div class="line">- (<span class="built_in">BOOL</span>)isFriendsWith:(EOCPerson*)person;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// EOCPerson+Friendship.m</span></div><div class="line"><span class="meta">#import <span class="meta-string">"EOCPerson+Friendship.h"</span></span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EOCPerson</span> (<span class="title">Friendship</span>)</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)addFriend:(EOCPerson*)person &#123;</div><div class="line"> <span class="comment">/* ... */</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)removeFriend:(EOCPerson*)person &#123;</div><div class="line"> <span class="comment">/* ... */</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)isFriendsWith:(EOCPerson*)person &#123;</div><div class="line"> <span class="comment">/* ... */</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ä¸è¿‡è¦æ³¨æ„ï¼Œåœ¨æ–°å»ºåˆ†ç±»æ–‡ä»¶æ—¶ï¼Œä¸€å®šè¦å¼•å…¥è¢«åˆ†ç±»çš„ç±»æ–‡ä»¶ã€‚</p>
<p>è¿™ä¸ªæŠ€å·§è¯´æœ‰ç”¨ä¹Ÿæœ‰ç”¨ï¼Œè¯´æ²¡ç”¨ï¼Œä¹Ÿæ²¡ç”¨ï¼Œçœ‹å…·ä½“å®é™…æƒ…å†µå§ã€‚å¦å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæŠ€å·§æ˜¯å°†æ‰€æœ‰â€ç§æœ‰â€æ–¹æ³•éƒ½å½’å…¥åå« Private çš„åˆ†ç±»ä¸­ï¼Œä»¥éšè—å®ç°ç»†èŠ‚ï¼Œå¥½åƒæ˜¯ä¸ªæŒºæœ‰æ„æ€çš„æƒ³æ³•ã€‚</p>
<h3 id="ç¬¬25æ¡ï¼šæ€»æ˜¯ä¸ºç¬¬ä¸‰æ–¹ç±»çš„åˆ†ç±»åç§°åŠ å‰ç¼€"><a href="#ç¬¬25æ¡ï¼šæ€»æ˜¯ä¸ºç¬¬ä¸‰æ–¹ç±»çš„åˆ†ç±»åç§°åŠ å‰ç¼€" class="headerlink" title="ç¬¬25æ¡ï¼šæ€»æ˜¯ä¸ºç¬¬ä¸‰æ–¹ç±»çš„åˆ†ç±»åç§°åŠ å‰ç¼€"></a>ç¬¬25æ¡ï¼šæ€»æ˜¯ä¸ºç¬¬ä¸‰æ–¹ç±»çš„åˆ†ç±»åç§°åŠ å‰ç¼€</h3><p>å¦‚æœæˆ‘ä»¬æƒ³ç»™ç¬¬ä¸‰æ–¹åº“æˆ–è€…iOSæ¡†æ¶é‡Œçš„ç±»æ·»åŠ åˆ†ç±»æ—¶ï¼Œæœ€å¥½å°†åˆ†ç±»åå’Œæ–¹æ³•ååŠ ä¸Šå‰ç¼€ã€‚å¦åˆ™å¯èƒ½ä¼šæ›¿æ¢æ‰ç³»ç»Ÿçš„æ–¹æ³•ã€‚</p>
<h3 id="ç¬¬26æ¡-å‹¿åœ¨åˆ†ç±»ä¸­å£°æ˜å±æ€§"><a href="#ç¬¬26æ¡-å‹¿åœ¨åˆ†ç±»ä¸­å£°æ˜å±æ€§" class="headerlink" title="ç¬¬26æ¡:å‹¿åœ¨åˆ†ç±»ä¸­å£°æ˜å±æ€§"></a>ç¬¬26æ¡:å‹¿åœ¨åˆ†ç±»ä¸­å£°æ˜å±æ€§</h3><p>è¿™æœ¬ä¹¦è¦æ˜¯æ—©ç‚¹çœ‹åˆ°å°±å¥½äº†ï¼Œå½“æ—¶çº ç»“è¿™ä¸ªå¾ˆä¹…ï¼Œèµ°äº†å¾ˆå¤šå¼¯è·¯ã€‚</p>
<p>åˆ†ç±»æœºåˆ¶ï¼Œç›®æ ‡åœ¨äºæ‰©å±•ç±»çš„åŠŸèƒ½ï¼Œè€Œä¸æ˜¯å°è£…æ•°æ®ã€‚</p>
<h3 id="ç¬¬27æ¡ï¼šä½¿ç”¨class-continuationåˆ†ç±»-éšè—å®ç°ç»†èŠ‚"><a href="#ç¬¬27æ¡ï¼šä½¿ç”¨class-continuationåˆ†ç±»-éšè—å®ç°ç»†èŠ‚" class="headerlink" title="ç¬¬27æ¡ï¼šä½¿ç”¨class-continuationåˆ†ç±» éšè—å®ç°ç»†èŠ‚"></a>ç¬¬27æ¡ï¼šä½¿ç”¨class-continuationåˆ†ç±» éšè—å®ç°ç»†èŠ‚</h3><p>é€šå¸¸ï¼Œæˆ‘ä»¬éœ€è¦å‡å°‘åœ¨å…¬å…±æ¥å£ä¸­å‘å¤–æš´éœ²çš„éƒ¨åˆ†(åŒ…æ‹¬å±æ€§å’Œæ–¹æ³•)ï¼Œè€Œå› æ­¤å¸¦ç»™æˆ‘ä»¬çš„å±€é™æ€§å¯ä»¥åˆ©ç”¨ class-continuation åˆ†ç±»çš„ç‰¹æ€§æ¥è¡¥å¿ï¼š</p>
<ul>
<li>å¯ä»¥åœ¨ class-continuation åˆ†ç±»ä¸­å¢åŠ å®ä¾‹å˜é‡ã€‚</li>
<li>å¯ä»¥åœ¨ class-continuation åˆ†ç±»ä¸­å°†å…¬å…±æ¥å£çš„åªè¯»å±æ€§è®¾ç½®ä¸ºè¯»å†™ã€‚</li>
<li>å¯ä»¥åœ¨ class-continuation åˆ†ç±»ä¸­éµå¾ªåè®®ï¼Œä½¿å…¶ä¸ä¸ºäººçŸ¥ã€‚</li>
</ul>
<h3 id="ç¬¬28æ¡-é€šè¿‡åè®®æä¾›åŒ¿åå¯¹è±¡"><a href="#ç¬¬28æ¡-é€šè¿‡åè®®æä¾›åŒ¿åå¯¹è±¡" class="headerlink" title="ç¬¬28æ¡:é€šè¿‡åè®®æä¾›åŒ¿åå¯¹è±¡"></a>ç¬¬28æ¡:é€šè¿‡åè®®æä¾›åŒ¿åå¯¹è±¡</h3><p>OC é‡Œçš„<strong>åŒ¿åå¯¹è±¡</strong>å’Œ Java é‡Œçš„åŒ¿åå¯¹è±¡ä¸åŒï¼Œè¿™é‡Œçš„åŒ¿åå¯¹è±¡æ²¡æœ‰ç±»å‹ã€‚æœ‰æ—¶æˆ‘ä»¬ç”¨åè®®æ¥æä¾›åŒ¿åå¯¹è±¡ï¼Œç›®çš„åœ¨äºè¯´æ˜å®ƒä»…ä»…è¡¨ç¤ºâ€œéµä»æŸä¸ªåè®®çš„å¯¹è±¡â€ï¼Œè€Œä¸æ˜¯â€œå±äºæŸä¸ªç±»çš„å¯¹è±¡â€ã€‚å®ƒçš„è¡¨ç¤ºæ–¹æ³•ä¸ºï¼š<code>id&lt;protocol&gt;</code>ã€‚</p>
<p>é€šè¿‡åè®®æä¾›åŒ¿åå¯¹è±¡çš„ä¸»è¦ä½¿ç”¨åœºæ™¯æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li>ä½œä¸ºå±æ€§</li>
<li>ä½œä¸ºæ–¹æ³•å‚æ•°</li>
</ul>
<h4 id="åŒ¿åå¯¹è±¡ä½œä¸ºå±æ€§"><a href="#åŒ¿åå¯¹è±¡ä½œä¸ºå±æ€§" class="headerlink" title="åŒ¿åå¯¹è±¡ä½œä¸ºå±æ€§"></a>åŒ¿åå¯¹è±¡ä½œä¸ºå±æ€§</h4><p>åœ¨è®¾å®šæŸä¸ªç±»ä¸ºè‡ªå·±çš„ä»£ç†å±æ€§æ—¶ï¼Œå¯ä»¥ä¸å£°æ˜ä»£ç†çš„ç±»ï¼Œè€Œæ˜¯ç”¨ <code>id&lt;protocol&gt;</code>ï¼Œå› ä¸ºæˆä¸ºä»£ç†çš„ç»ˆç‚¹å¹¶ä¸æ˜¯æŸä¸ªç±»çš„å®ä¾‹ï¼Œè€Œæ˜¯éµå¾ªäº†æŸä¸ªåè®®ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">id</span> &lt;EOCDelegate&gt; delegate;</div></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œä½¿ç”¨åŒ¿åå¯¹è±¡çš„åŸå› æœ‰ä¸¤ä¸ªï¼š</p>
<ol>
<li>å°†æ¥å¯èƒ½ä¼šæœ‰å¾ˆå¤šä¸åŒç±»çš„å®ä¾‹å¯¹è±¡ä½œä¸ºè¯¥ç±»çš„ä»£ç†ã€‚</li>
<li>æˆ‘ä»¬ä¸æƒ³æŒ‡æ˜å…·ä½“è¦ä½¿ç”¨å“ªä¸ªç±»æ¥ä½œä¸ºè¿™ä¸ªç±»çš„ä»£ç†ã€‚</li>
</ol>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œèƒ½ä½œä¸ºè¯¥ç±»çš„ä»£ç†çš„æ¡ä»¶åªæœ‰ä¸€ä¸ªï¼šå®ƒéµä»äº† <code>&lt;EOCDelegate&gt;</code> åè®®ã€‚</p>
<h4 id="åŒ¿åå¯¹è±¡ä½œä¸ºæ–¹æ³•å‚æ•°"><a href="#åŒ¿åå¯¹è±¡ä½œä¸ºæ–¹æ³•å‚æ•°" class="headerlink" title="åŒ¿åå¯¹è±¡ä½œä¸ºæ–¹æ³•å‚æ•°"></a>åŒ¿åå¯¹è±¡ä½œä¸ºæ–¹æ³•å‚æ•°</h4><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬ä¸ä¼šåœ¨æ„æ–¹æ³•é‡ŒæŸä¸ªå‚æ•°çš„å…·ä½“ç±»å‹ï¼Œè€Œæ˜¯éµå¾ªäº†æŸç§åè®®ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨åŒ¿åå¯¹è±¡æ¥ä½œä¸ºæ–¹æ³•å‚æ•°ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)setObject:(<span class="keyword">id</span>)object forKey:(<span class="keyword">id</span>&lt;<span class="built_in">NSCopying</span>&gt;)key;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•æ˜¯ NSDictionary çš„è®¾å€¼æ–¹æ³•ï¼Œå®ƒçš„å‚æ•°åªè¦éµä»äº† <code>&lt;NSCopying&gt;</code> åè®®ï¼Œå°±å¯ä»¥ä½œä¸ºå‚æ•°ä¼ è¿›å»,ä½œä¸º NSDictionary çš„é”®ã€‚</p>
<h2 id="å†…å­˜ç®¡ç†"><a href="#å†…å­˜ç®¡ç†" class="headerlink" title="å†…å­˜ç®¡ç†"></a>å†…å­˜ç®¡ç†</h2><h3 id="ç¬¬29æ¡ï¼šç†è§£å¼•ç”¨è®¡æ•°"><a href="#ç¬¬29æ¡ï¼šç†è§£å¼•ç”¨è®¡æ•°" class="headerlink" title="ç¬¬29æ¡ï¼šç†è§£å¼•ç”¨è®¡æ•°"></a>ç¬¬29æ¡ï¼šç†è§£å¼•ç”¨è®¡æ•°</h3><p>å°†å¯¹è±¡æ”¾å…¥è‡ªåŠ¨é‡Šæ”¾æ± ä¹‹åï¼Œä¸ä¼šé©¬ä¸Šä½¿å…¶å¼•ç”¨è®¡æ•° -1ï¼Œè€Œæ˜¯åœ¨å½“å‰çº¿ç¨‹çš„ä¸‹ä¸€æ¬¡äº‹ä»¶å¾ªç¯æ—¶é€’å‡ã€‚</p>
<p>å…¶ä»–æ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚</p>
<h3 id="ç¬¬30æ¡ï¼šä»¥ARCç®€åŒ–å¼•ç”¨è®¡æ•°"><a href="#ç¬¬30æ¡ï¼šä»¥ARCç®€åŒ–å¼•ç”¨è®¡æ•°" class="headerlink" title="ç¬¬30æ¡ï¼šä»¥ARCç®€åŒ–å¼•ç”¨è®¡æ•°"></a>ç¬¬30æ¡ï¼šä»¥ARCç®€åŒ–å¼•ç”¨è®¡æ•°</h3><p>ä½¿ç”¨ARCï¼Œå¯ä»¥çœç•¥å¯¹äºå¼•ç”¨è®¡æ•°çš„æ“ä½œï¼Œæ²¡å¤ªå¤šå¥½è¯´çš„ã€‚</p>
<p>éœ€è¦äº†è§£ä¸€ä¸ªä¿®é¥°ç¬¦ <code>__weak</code>ã€‚å—å†…å¼•ç”¨å¤–éƒ¨å˜é‡æ—¶ï¼Œä¼šè‡ªåŠ¨ä¿ç•™å…¶æ‰€æ•è·çš„å…¨éƒ¨å¯¹è±¡ï¼Œå¦‚æœè¿™å…¶ä¸­æœ‰æŸä¸ªå¯¹è±¡ä¿ç•™äº†å—æœ¬èº«ï¼ˆå¦‚å°† ViewController ä¼ å…¥ï¼‰ï¼Œå°†ä¼šå½¢æˆâ€œä¿ç•™ç¯â€ã€‚æ‰€ä»¥è¦ç”¨ <code>__weak</code> å±€éƒ¨å˜é‡æ¥æ‰“ç ´è¿™ç§ä¿ç•™ç¯ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">EOCNetwork * __<span class="keyword">weak</span> weakFetcher = fetcher;</div></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ª <code>weakSelf</code> æ¥ç®€åŒ–è¿™ç§å£°æ˜æ–¹å¼ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#define WEAKSELF typeof(self) __weak weakSelf = self;</span></div></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œåœ¨ ViewController ä¸­ç”¨åˆ° <code>self</code> æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥ç”¨ <code>weakSelf</code> æ›¿ä»£ã€‚</p>
<h3 id="ç¬¬31æ¡ï¼šåœ¨deallocæ–¹æ³•ä¸­åªé‡Šæ”¾å¼•ç”¨å¹¶è§£é™¤ç›‘å¬"><a href="#ç¬¬31æ¡ï¼šåœ¨deallocæ–¹æ³•ä¸­åªé‡Šæ”¾å¼•ç”¨å¹¶è§£é™¤ç›‘å¬" class="headerlink" title="ç¬¬31æ¡ï¼šåœ¨deallocæ–¹æ³•ä¸­åªé‡Šæ”¾å¼•ç”¨å¹¶è§£é™¤ç›‘å¬"></a>ç¬¬31æ¡ï¼šåœ¨deallocæ–¹æ³•ä¸­åªé‡Šæ”¾å¼•ç”¨å¹¶è§£é™¤ç›‘å¬</h3><p>å¯¹è±¡åœ¨ç»å†ç”Ÿå‘½æœŸåï¼Œæœ€ç»ˆä¼šè¢«ç³»ç»Ÿå›æ”¶ï¼Œè¿™é‡Œå°±æ˜¯æ‰§è¡Œ <code>dealloc</code> æ–¹æ³•äº†ã€‚æ°¸è¿œä¸è¦è‡ªå·±è°ƒç”¨ <code>dealloc</code> æ–¹æ³•ï¼Œè¿è¡ŒæœŸç³»ç»Ÿä¼šåœ¨é€‚å½“çš„æ—¶å€™è°ƒç”¨å®ƒã€‚æ ¹æ®æ€§èƒ½éœ€æ±‚æˆ‘ä»¬æœ‰æ—¶éœ€è¦åœ¨ <code>dealloc</code> æ–¹æ³•ä¸­åšä¸€äº›æ“ä½œã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ <code>dealloc</code> æ–¹æ³•é‡Œåšä»€ä¹ˆå‘¢ï¼Ÿ</p>
<ul>
<li>é‡Šæ”¾å¯¹è±¡æ‰€æ‹¥æœ‰çš„æ‰€æœ‰å¼•ç”¨ï¼Œä¸è¿‡ARCä¼šè‡ªåŠ¨æ·»åŠ è¿™äº›é‡Šæ”¾ä»£ç ï¼Œå¯ä»¥ä¸å¿…æ“å¿ƒã€‚</li>
<li>å¯¹è±¡æ‹¥æœ‰çš„å…¶ä»–éOCå¯¹è±¡ä¹Ÿè¦é‡Šæ”¾ï¼ˆCoreFoundation å¯¹è±¡å°±å¿…é¡»æ‰‹åŠ¨é‡Šæ”¾ï¼‰</li>
<li>é‡Šæ”¾åŸæ¥çš„è§‚æµ‹è¡Œä¸ºï¼šæ³¨é”€é€šçŸ¥ã€‚å¦‚æœæ²¡æœ‰åŠæ—¶æ³¨é”€ï¼Œå°±ä¼šå‘å…¶å‘é€é€šçŸ¥ï¼Œä½¿å¾—ç¨‹åºå´©æºƒã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)dealloc &#123;</div><div class="line">     <span class="built_in">CFRelease</span>(coreFoundationObject);</div><div class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>é™¤äº†é‡Šæ”¾å¼•ç”¨å’Œæ³¨é”€é€šçŸ¥ï¼Œä¸è¦åœ¨ <code>dealloc</code> ä¸­åšå…¶ä»–ä»»ä½•äº‹ï¼ˆæ¯”å¦‚è°ƒç”¨å±æ€§çš„å­˜å–æ–¹æ³•ï¼Œä»¥åŠå¼‚æ­¥æ“ä½œï¼‰ã€‚å¦‚æœå¯¹è±¡æŒæœ‰æ–‡ä»¶æè¿°ç¬¦ç­‰ç³»ç»Ÿèµ„æºï¼Œé‚£ä¹ˆåº”è¯¥ä¸“é—¨ç¼–å†™ä¸€ä¸ªæ–¹æ³•æ¥é‡Šæ”¾è¯¥èµ„æºã€‚è¿™æ ·çš„ç±»è¦å’Œä½¿ç”¨è€…çº¦å®šï¼Œç”¨å®Œèµ„æºåå¿…é¡»è°ƒç”¨ <code>close</code> æ–¹æ³•ã€‚</p>
<h3 id="ç¬¬32æ¡ï¼šç¼–å†™â€œå¼‚å¸¸å®‰å…¨ä»£ç â€æ—¶ç•™æ„å†…å­˜ç®¡ç†é—®é¢˜"><a href="#ç¬¬32æ¡ï¼šç¼–å†™â€œå¼‚å¸¸å®‰å…¨ä»£ç â€æ—¶ç•™æ„å†…å­˜ç®¡ç†é—®é¢˜" class="headerlink" title="ç¬¬32æ¡ï¼šç¼–å†™â€œå¼‚å¸¸å®‰å…¨ä»£ç â€æ—¶ç•™æ„å†…å­˜ç®¡ç†é—®é¢˜"></a>ç¬¬32æ¡ï¼šç¼–å†™â€œå¼‚å¸¸å®‰å…¨ä»£ç â€æ—¶ç•™æ„å†…å­˜ç®¡ç†é—®é¢˜</h3><p>åœ¨å‘ç”Ÿå¼‚å¸¸æ—¶çš„å†…å­˜ç®¡ç†éœ€è¦ä»”ç»†è€ƒè™‘å†…å­˜ç®¡ç†çš„é—®é¢˜ï¼šåœ¨ try å—ä¸­ï¼Œå¦‚æœå…ˆä¿ç•™äº†æŸä¸ªå¯¹è±¡ï¼Œç„¶ååœ¨é‡Šæ”¾å®ƒä¹‹å‰åˆæŠ›å‡ºäº†å¼‚å¸¸ï¼Œé‚£ä¹ˆé™¤éåœ¨ catch å—ä¸­èƒ½å¤„ç†æ­¤é—®é¢˜ï¼Œå¦åˆ™å¯¹è±¡æ‰€å å†…å­˜å°±å°†æ³„æ¼ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@try</span> &#123;</div><div class="line">     EOCSomeClass *object = [[EOCSomeClass alloc] init];</div><div class="line">     [object doSomethingThatMayThrow];</div><div class="line">&#125;</div><div class="line"><span class="keyword">@catch</span> (...) &#123;</div><div class="line"> <span class="built_in">NSLog</span>(<span class="string">@"Whoops, there was an error. Oh well..."</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯åœ¨ ARC çŠ¶æ€ä¸‹ï¼Œæˆ‘ä»¬ä¸èƒ½æ‰‹åŠ¨é‡Šæ”¾å¯¹è±¡ï¼Œè§£å†³åŠæ³•æ˜¯ä½¿ç”¨ï¼š<code>-fobjc-arc-exceptions</code> æ ‡å¿—æ¥è®©ç³»ç»Ÿè‡ªåŠ¨åŠ å…¥æ¸…ç†ä»£ç ï¼Œä¸è¿‡ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå˜å¤§ï¼Œè€Œä¸”ä¼šé™ä½è¿è¡Œæ•ˆç‡ã€‚</p>
<h3 id="ç¬¬33æ¡ï¼šä»¥å¼±å¼•ç”¨é¿å…ä¿ç•™ç¯"><a href="#ç¬¬33æ¡ï¼šä»¥å¼±å¼•ç”¨é¿å…ä¿ç•™ç¯" class="headerlink" title="ç¬¬33æ¡ï¼šä»¥å¼±å¼•ç”¨é¿å…ä¿ç•™ç¯"></a>ç¬¬33æ¡ï¼šä»¥å¼±å¼•ç”¨é¿å…ä¿ç•™ç¯</h3><p>å¯¹è±¡ä¹‹é—´éƒ½ç”¨å¼ºæŒ‡é’ˆå¼•ç”¨å¯¹æ–¹çš„è¯ä¼šé€ æˆä¿ç•™ç¯ã€‚å¦‚æœä¿ç•™ç¯è¿æ¥äº†å¤šä¸ªå¯¹è±¡ï¼Œè€Œè¿™é‡Œå…¶ä¸­ä¸€ä¸ªå¯¹è±¡è¢«å¤–ç•Œå¼•ç”¨ï¼Œé‚£ä¹ˆå½“è¿™ä¸ªå¼•ç”¨è¢«ç§»é™¤åï¼Œæ•´ä¸ªä¿ç•™ç¯å°±æ³„æ¼äº†ã€‚ä¸åƒ Java é‚£ç§å¤„ç†æ–¹å¼ï¼ŒOC ä¸­å­¤ç«‹çš„ä¿ç•™ç¯ä¸èƒ½è¢«è‡ªåŠ¨é‡Šæ”¾ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/effective_oc1.png?raw=true" alt="ä¿ç•™ç¯"></p>
<p>é‚£ä¹ˆå°±è¦ç”¨å¼±å¼•ç”¨çš„æ–¹å¼ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//EOCClassB.m</span></div><div class="line"><span class="comment">//ç¬¬ä¸€ç§å¼±å¼•ç”¨ï¼šunsafe_unretained</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">unsafe_unretained</span>) EOCClassA *other;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//ç¬¬äºŒç§å¼±å¼•ç”¨ï¼šweak</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) EOCClassA *other;</div></pre></td></tr></table></figure>
<p>è¿™ä¸¤ç§å¼±å¼•ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ<br>å½“æŒ‡å‘ <code>EOCClassA</code> å®ä¾‹çš„å¼•ç”¨ç§»é™¤åï¼Œ<code>unsafe_unretained</code> å±æ€§ä»ç„¶æŒ‡å‘é‚£ä¸ªå·²ç»å›æ”¶çš„å®ä¾‹ï¼Œè€Œ <code>weak</code> æŒ‡å‘ <code>nil</code>ã€‚æ˜¾ç„¶ï¼Œç”¨ <code>weak</code> å­—æ®µåº”è¯¥æ˜¯æ›´å®‰å…¨çš„ï¼Œå› ä¸ºä¸å†ä½¿ç”¨çš„å¯¹è±¡æŒ‰ç†è¯´åº”è¯¥è®¾ç½®ä¸º <code>nil</code>,è€Œä¸åº”è¯¥äº§ç”Ÿä¾èµ–ã€‚</p>
<p>æ‰€ä»¥åªè¦ç”¨ <code>weak</code> å°±è¡Œäº†ã€‚</p>
<h3 id="ç¬¬34æ¡ï¼šä»¥â€œè‡ªåŠ¨é‡Šæ”¾æ± å¿«â€é™ä½å†…å­˜å³°å€¼"><a href="#ç¬¬34æ¡ï¼šä»¥â€œè‡ªåŠ¨é‡Šæ”¾æ± å¿«â€é™ä½å†…å­˜å³°å€¼" class="headerlink" title="ç¬¬34æ¡ï¼šä»¥â€œè‡ªåŠ¨é‡Šæ”¾æ± å¿«â€é™ä½å†…å­˜å³°å€¼"></a>ç¬¬34æ¡ï¼šä»¥â€œè‡ªåŠ¨é‡Šæ”¾æ± å¿«â€é™ä½å†…å­˜å³°å€¼</h3><p>è¿™ä¸ªéƒ¨åˆ†åœ¨ <code>runloop</code> ç›¸å…³æ–‡ç« ä¸­æœ‰å­¦ä¹ è¿‡ã€‚ä¸»è¦ç”¨çš„æ˜¯è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++) &#123;</div><div class="line">      [<span class="keyword">self</span> doSomethingWithInt:i];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç”±äºçº¿ç¨‹è‡ªåŠ¨é‡Šæ”¾æ± åœ¨ event loop æ—¶ï¼Œè¿›è¡Œæ¸…ç©ºï¼Œä¸Šé¢çš„ä»£ç å°†å¯èƒ½é€ æˆå†…å­˜å³°å€¼ã€‚å› æ­¤ï¼Œå¯ä»¥æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªè‡ªåŠ¨é‡Šæ”¾æ± ï¼ŒæŠŠå¾ªç¯å†…çš„ä»£ç åŒ…è£¹åœ¨å†…ï¼Œé‚£ä¹ˆå¾ªç¯ä¸­è‡ªåŠ¨é‡Šæ”¾çš„ç‹¬äº«å°±ä¼šåœ¨è¿™ä¸ªæ± ä¸­ï¼Œè€Œä¸æ˜¯åœ¨çº¿ç¨‹çš„ä¸»æ± ä¸­ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSArray</span> *databaseRecords = <span class="comment">/* ... */</span>;</div><div class="line"><span class="built_in">NSMutableArray</span> *people = [<span class="built_in">NSMutableArray</span> new];</div><div class="line"><span class="keyword">for</span> (<span class="built_in">NSDictionary</span> *record <span class="keyword">in</span> databaseRecords) &#123;</div><div class="line">     <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">             EOCPerson *person = [[EOCPerson alloc] initWithRecord:record];</div><div class="line">            [people addObject:person];</div><div class="line">      &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ç¬¬35æ¡ï¼šç”¨â€œåƒµå°¸å¯¹è±¡â€è°ƒè¯•å†…å­˜ç®¡ç†é—®é¢˜"><a href="#ç¬¬35æ¡ï¼šç”¨â€œåƒµå°¸å¯¹è±¡â€è°ƒè¯•å†…å­˜ç®¡ç†é—®é¢˜" class="headerlink" title="ç¬¬35æ¡ï¼šç”¨â€œåƒµå°¸å¯¹è±¡â€è°ƒè¯•å†…å­˜ç®¡ç†é—®é¢˜"></a>ç¬¬35æ¡ï¼šç”¨â€œåƒµå°¸å¯¹è±¡â€è°ƒè¯•å†…å­˜ç®¡ç†é—®é¢˜</h3><p>æŸä¸ªå¯¹è±¡è¢«å›æ”¶åï¼Œå†å‘å®ƒå‘é€æ¶ˆæ¯æ˜¯ä¸å®‰å…¨çš„ï¼Œè¿™å¹¶ä¸ä¸€å®šä¼šå¼•èµ·ç¨‹åºå´©æºƒã€‚å¦‚æœç¨‹åºæ²¡æœ‰å´©æºƒï¼Œå¯èƒ½æ˜¯å› ä¸ºï¼š</p>
<ul>
<li>è¯¥å†…å­˜çš„éƒ¨åˆ†åŸæ•°æ®æ²¡æœ‰è¢«è¦†å†™ã€‚</li>
<li>è¯¥å†…å­˜æ°å¥½è¢«å¦ä¸€ä¸ªå¯¹è±¡å æ®ï¼Œè€Œè¿™ä¸ªå¯¹è±¡å¯ä»¥åº”ç­”è¿™ä¸ªæ–¹æ³•ã€‚</li>
</ul>
<p>å¦‚æœè¢«å›æ”¶çš„å¯¹è±¡å ç”¨çš„åŸå†…å­˜è¢«æ–°çš„å¯¹è±¡å æ®ï¼Œé‚£ä¹ˆæ”¶åˆ°æ¶ˆæ¯çš„å¯¹è±¡å°±ä¸ä¼šæ˜¯æˆ‘ä»¬é¢„æƒ³çš„é‚£ä¸ªå¯¹è±¡ã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡æ— æ³•å“åº”é‚£ä¸ªæ–¹æ³•çš„è¯ï¼Œç¨‹åºä¾æ—§ä¼šå´©æºƒã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥é€šè¿‡ä¸€ç§æ–¹æ³•æ•æ‰åˆ°å¯¹è±¡è¢«é‡Šæ”¾åæ”¶åˆ°æ¶ˆæ¯çš„æƒ…å†µã€‚è¿™ç§æ–¹æ³•å°±æ˜¯åˆ©ç”¨åƒµå°¸å¯¹è±¡ï¼</p>
<p>Cocoa æä¾›äº†â€œåƒµå°¸å¯¹è±¡â€çš„åŠŸèƒ½ã€‚å¦‚æœå¼€å¯äº†è¿™ä¸ªåŠŸèƒ½ï¼Œè¿è¡ŒæœŸç³»ç»Ÿä¼šæŠŠæ‰€æœ‰å·²ç»å›æ”¶çš„å®ä¾‹è½¬åŒ–æˆç‰¹æ®Šçš„â€œåƒµå°¸å¯¹è±¡â€ï¼ˆé€šè¿‡ä¿®æ”¹ isa æŒ‡é’ˆï¼Œä»¤å…¶æŒ‡å‘ç‰¹æ®Šçš„åƒµå°¸ç±»ï¼‰ï¼Œè€Œä¸ä¼šçœŸæ­£å›æ”¶å®ƒä»¬ï¼Œè€Œä¸”å®ƒä»¬æ‰€å æ®çš„æ ¸å¿ƒå†…å­˜å°†æ— æ³•è¢«é‡ç”¨ï¼Œè¿™æ ·ä¹Ÿå°±é¿å…äº†è¦†å†™çš„æƒ…å†µã€‚åœ¨åƒµå°¸å¯¹è±¡æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå®ƒä¼šè¯´æ˜å‘é€è¿‡æ¥çš„æ¶ˆæ¯ï¼Œä¹Ÿä¼šæè¿°å›æ”¶ä¹‹å‰çš„é‚£ä¸ªå¯¹è±¡ã€‚</p>
<p>(æ„Ÿè§‰å¥½åƒæ²¡ä»€ä¹ˆç”¨çš„æ ·å­ï¼Œä¸çŸ¥é“è¿™å’Œè®©ç¨‹åºç›´æ¥ crash æ¯”ï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿)</p>
<h3 id="ç¬¬36æ¡ï¼šä¸è¦ä½¿ç”¨retainCount"><a href="#ç¬¬36æ¡ï¼šä¸è¦ä½¿ç”¨retainCount" class="headerlink" title="ç¬¬36æ¡ï¼šä¸è¦ä½¿ç”¨retainCount"></a>ç¬¬36æ¡ï¼šä¸è¦ä½¿ç”¨retainCount</h3><p>ARC åï¼Œè¿™ä¸ª <code>retainCount</code> æ–¹æ³•å°±åºŸå¼ƒäº†ã€‚åæ­£ä»æ¥æ²¡ç”¨è¿‡ï¼Œä¹Ÿå°±æ²¡å•¥å¥½çœ‹çš„äº†ã€‚</p>
<h2 id="å—ä¸å¤§å°æ¢æ´¾å‘"><a href="#å—ä¸å¤§å°æ¢æ´¾å‘" class="headerlink" title="å—ä¸å¤§å°æ¢æ´¾å‘"></a>å—ä¸å¤§å°æ¢æ´¾å‘</h2><h3 id="ç¬¬37æ¡ï¼šç†è§£â€œå—â€è¿™ä¸€æ¦‚å¿µ"><a href="#ç¬¬37æ¡ï¼šç†è§£â€œå—â€è¿™ä¸€æ¦‚å¿µ" class="headerlink" title="ç¬¬37æ¡ï¼šç†è§£â€œå—â€è¿™ä¸€æ¦‚å¿µ"></a>ç¬¬37æ¡ï¼šç†è§£â€œå—â€è¿™ä¸€æ¦‚å¿µ</h3><p>åŸºæœ¬æ¦‚å¿µæ— éœ€å¤šè¯´ï¼Œè¿™é‡Œå¼ºè°ƒä¸€ä¸‹å—çš„ç§ç±»ã€‚</p>
<p>å—åˆ†ä¸ºä¸‰ç±»ï¼š</p>
<ul>
<li>æ ˆå—</li>
<li>å †å—</li>
<li>å…¨å±€å—</li>
</ul>
<h4 id="æ ˆå—"><a href="#æ ˆå—" class="headerlink" title="æ ˆå—"></a>æ ˆå—</h4><p>è¿™æ˜¯æ¯”è¾ƒå®¹æ˜“è¢«å¿½ç•¥çš„ä¸€å—ã€‚å®šä¹‰å—çš„æ—¶å€™ï¼Œå…¶æ‰€å å†…å­˜åŒºåŸŸæ˜¯<strong>åˆ†é…åœ¨æ ˆä¸­</strong>çš„ï¼Œè€Œä¸”åªåœ¨å®šä¹‰å®ƒçš„é‚£ä¸ªèŒƒå›´å†…æœ‰æ•ˆï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> (^block)();</div><div class="line"></div><div class="line"><span class="keyword">if</span> ( <span class="comment">/* some condition */</span> ) &#123;</div><div class="line">    block = ^&#123;</div><div class="line">     <span class="built_in">NSLog</span>(<span class="string">@"Block A"</span>);</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    block = ^&#123;</div><div class="line">     <span class="built_in">NSLog</span>(<span class="string">@"Block B"</span>);</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">block();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢å®šä¹‰çš„ä¸¤ä¸ªå—åªåœ¨ <code>if else</code> è¯­å¥èŒƒå›´å†…æœ‰æ•ˆï¼Œä¸€æ—¦ç¦»å¼€äº†æœ€åä¸€ä¸ªå³æ‹¬å·ï¼Œå¦‚æœç¼–è¯‘å™¨è¦†å†™äº†åˆ†é…ç»™å—çš„å†…å­˜ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆç¨‹åºå´©æºƒã€‚</p>
<p>å¹¶ä¸æ˜ç™½æŠŠå—ä¿å­˜åœ¨æ ˆä¸Šæ˜¯ä¸ªä»€ä¹ˆæœºåˆ¶ã€‚åº”è¯¥å¯ä»¥è¿™ä¹ˆç†è§£å§:<code>block</code> æ˜¯ä¸€ä¸ªæŒ‡å‘æ ˆä¸Šå†…å­˜çš„æŒ‡é’ˆï¼Œæ ˆå’Œå †çš„å¼•ç”¨æœºåˆ¶ä¸åŒï¼Œåœ¨ä»£ç å—è¿è¡Œç»“æŸåå°±ä¼šå°†ä»£ç å—ä¸­çš„å±€éƒ¨å˜é‡å‡ºæ ˆï¼Œè¿™ä¸ªæ—¶å€™ <code>block</code> æŒ‡å‘çš„åœ°æ–¹å°±è¢«å›æ”¶ï¼Œ<code>block</code> å°±æˆäº†é‡æŒ‡é’ˆï¼Œå› æ­¤å°±ä¼š crash äº†ã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹³æ—¶è¦ä¹ˆå°±å®šä¹‰å®Œå°±ä¼ å‡ºå»äº†ï¼Œè¦ä¹ˆå°±æŠŠ <code>block</code> å®šä¹‰æˆäº†ç±»çš„å±æ€§ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å‘ç”Ÿè¿‡è¿™ç§æƒ…å†µã€‚ </p>
<h4 id="å †å—"><a href="#å †å—" class="headerlink" title="å †å—"></a>å †å—</h4><p>å¹³æ—¶å¯¹å—çš„æ“ä½œè‚¯å®šä¸èƒ½ä»¥æ ˆå—çš„å½¢å¼æ¥å­˜å‚¨å•Šã€‚å †å—ï¼Œè¦åœ¨åŸæ¥çš„åŸºç¡€ä¸Šæ‰§è¡Œ <code>copy</code>ï¼Œè®©ä»£ç ä¿å­˜åœ¨å †ä¸Šã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> (^block)();</div><div class="line"></div><div class="line"><span class="keyword">if</span> ( <span class="comment">/* some condition */</span> ) &#123;</div><div class="line">    block = [^&#123;</div><div class="line">         <span class="built_in">NSLog</span>(<span class="string">@"Block A"</span>);</div><div class="line">   &#125; <span class="keyword">copy</span>];</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    block = [^&#123;</div><div class="line">         <span class="built_in">NSLog</span>(<span class="string">@"Block B"</span>);</div><div class="line">    &#125; <span class="keyword">copy</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">block();</div></pre></td></tr></table></figure>
<p>è‡³äº <code>copy</code> æ€ä¹ˆè®©æ ˆä¸Šçš„ä¸œè¥¿ä¿å­˜åˆ°å †ä¸Šå°±ä¸å¾—è€ŒçŸ¥äº†ï¼Œåæ­£å°±æ˜¯ä¿å­˜è¿‡å»äº†ã€‚ç„¶å <code>block</code> å°±èƒ½æŒ‡å‘å †ä¸Šçš„åœ°å€äº†ã€‚</p>
<p>å¹³æ—¶æˆ‘ä»¬ç”¨å±æ€§æ–¹å¼ä¿å­˜å—çš„æ—¶å€™éƒ½æ˜¯è¿™æ ·å£°æ˜çš„ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) Block block;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªå±æ€§é‡Œæš—å«äº† <code>copy</code> æ“ä½œäº†ã€‚</p>
<h4 id="å…¨å±€å—"><a href="#å…¨å±€å—" class="headerlink" title="å…¨å±€å—"></a>å…¨å±€å—</h4><p>åœ¨å…¨å±€å†…å­˜é‡Œå£°æ˜çš„å°±æ˜¯å…¨å±€å—ï¼Œæ²¡ç”¨è¿‡ã€‚ä¸çŸ¥é“æœ‰ä»€ä¹ˆå¥½å¤„ã€‚</p>
<h3 id="ç¬¬38æ¡ï¼šä¸ºå¸¸ç”¨çš„å—ç±»å‹åˆ›å»ºtypedef"><a href="#ç¬¬38æ¡ï¼šä¸ºå¸¸ç”¨çš„å—ç±»å‹åˆ›å»ºtypedef" class="headerlink" title="ç¬¬38æ¡ï¼šä¸ºå¸¸ç”¨çš„å—ç±»å‹åˆ›å»ºtypedef"></a>ç¬¬38æ¡ï¼šä¸ºå¸¸ç”¨çš„å—ç±»å‹åˆ›å»ºtypedef</h3><p>å¦‚æœæˆ‘ä»¬éœ€è¦é‡å¤åˆ›å»ºæŸç§å—ï¼ˆç›¸åŒå‚æ•°ï¼Œè¿”å›å€¼ï¼‰çš„å˜é‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡typedefæ¥ç»™æŸä¸€ç§å—å®šä¹‰å±äºå®ƒè‡ªå·±çš„æ–°ç±»å‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> (^variableName)(<span class="built_in">BOOL</span> flag, <span class="keyword">int</span> value) =^(<span class="built_in">BOOL</span> flag, <span class="keyword">int</span> value)&#123;</div><div class="line">     <span class="comment">// Implementation</span></div><div class="line">     <span class="keyword">return</span> someInt;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)startWithCompletionHandler: (<span class="keyword">void</span>(^)(<span class="built_in">NSData</span> *data, <span class="built_in">NSError</span> *error))completion;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªå—æœ‰ä¸€ä¸ª bool å‚æ•°å’Œä¸€ä¸ª int å‚æ•°ï¼Œå¹¶è¿”å› int ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥ç»™å®ƒå®šä¹‰ç±»å‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">int</span>(^EOCSomeBlock)(<span class="built_in">BOOL</span> flag, <span class="keyword">int</span> value);</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">void</span>(^EOCCompletionHandler)(<span class="built_in">NSData</span> *data, <span class="built_in">NSError</span> *error);</div><div class="line"></div><div class="line">EOCSomeBlock block = ^(<span class="built_in">BOOL</span> flag, <span class="keyword">int</span> value)&#123;</div><div class="line">     <span class="comment">// Implementation</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)startWithCompletionHandler:(EOCCompletionHandler)completion;</div></pre></td></tr></table></figure>
<h3 id="ç¬¬39æ¡ï¼šç”¨handlerå—é™ä½ä»£ç åˆ†æ•£ç¨‹åº¦"><a href="#ç¬¬39æ¡ï¼šç”¨handlerå—é™ä½ä»£ç åˆ†æ•£ç¨‹åº¦" class="headerlink" title="ç¬¬39æ¡ï¼šç”¨handlerå—é™ä½ä»£ç åˆ†æ•£ç¨‹åº¦"></a>ç¬¬39æ¡ï¼šç”¨handlerå—é™ä½ä»£ç åˆ†æ•£ç¨‹åº¦</h3><p>å¯ä»¥é€šè¿‡å—çš„æ–¹å¼ä»£æ›¿ä»£ç†æ¨¡å¼ã€‚</p>
<p>ä»£ç†æ¨¡å¼ä¸»è¦æ˜¯ä¸ºäº†è®©å…¶ä»–ç±»åœ¨å¿…è¦æ—¶å€™è°ƒç”¨è‡ªå·±ç±»çš„æ–¹æ³•ã€‚è€Œä½¿ç”¨å—çš„æ–¹å¼å¯ä»¥ç›´æ¥å°†æ–¹æ³•å†…å®¹ä½œä¸ºå‚æ•°æˆ–è€…å±æ€§ä¼ å…¥è°ƒç”¨å—ã€‚è¿™æ ·è®¾è®¡ä¸šåŠ¡é€»è¾‘æ›´åŠ ç›´è§‚æ¸…æ™°ã€‚</p>
<h3 id="ç¬¬40æ¡ï¼šç”¨å—å¼•ç”¨å…¶æ‰€å±å¯¹è±¡æ—¶ä¸è¦å‡ºç°ä¿ç•™ç¯"><a href="#ç¬¬40æ¡ï¼šç”¨å—å¼•ç”¨å…¶æ‰€å±å¯¹è±¡æ—¶ä¸è¦å‡ºç°ä¿ç•™ç¯" class="headerlink" title="ç¬¬40æ¡ï¼šç”¨å—å¼•ç”¨å…¶æ‰€å±å¯¹è±¡æ—¶ä¸è¦å‡ºç°ä¿ç•™ç¯"></a>ç¬¬40æ¡ï¼šç”¨å—å¼•ç”¨å…¶æ‰€å±å¯¹è±¡æ—¶ä¸è¦å‡ºç°ä¿ç•™ç¯</h3><p>æ³¨æ„ä½¿ç”¨å—çš„æ—¶å€™ä¸è¦äº§ç”Ÿä¿ç•™ç¯ï¼Œè¦åœ¨å—æ‰§è¡Œå®Œæˆåï¼Œå°†å—ç½®ä¸º <code>nil</code>ã€‚</p>
<h3 id="ç¬¬41æ¡ï¼šå¤šç”¨æ´¾å‘é˜Ÿåˆ—ï¼Œå°‘ç”¨åŒæ­¥é”"><a href="#ç¬¬41æ¡ï¼šå¤šç”¨æ´¾å‘é˜Ÿåˆ—ï¼Œå°‘ç”¨åŒæ­¥é”" class="headerlink" title="ç¬¬41æ¡ï¼šå¤šç”¨æ´¾å‘é˜Ÿåˆ—ï¼Œå°‘ç”¨åŒæ­¥é”"></a>ç¬¬41æ¡ï¼šå¤šç”¨æ´¾å‘é˜Ÿåˆ—ï¼Œå°‘ç”¨åŒæ­¥é”</h3><p>å¤šä¸ªçº¿ç¨‹æ‰§è¡ŒåŒä¸€ä»½ä»£ç æ—¶ï¼Œå¾ˆå¯èƒ½ä¼šé€ æˆæ•°æ®ä¸åŒæ­¥ã€‚ä½œè€…å»ºè®®ä½¿ç”¨ GCD æ¥ä¸ºä»£ç åŠ é”çš„æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h4 id="æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ä¸²è¡ŒåŒæ­¥é˜Ÿåˆ—æ¥å°†è¯»å†™æ“ä½œéƒ½å®‰æ’åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼š"><a href="#æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ä¸²è¡ŒåŒæ­¥é˜Ÿåˆ—æ¥å°†è¯»å†™æ“ä½œéƒ½å®‰æ’åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼š" class="headerlink" title="æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ä¸²è¡ŒåŒæ­¥é˜Ÿåˆ—æ¥å°†è¯»å†™æ“ä½œéƒ½å®‰æ’åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼š"></a>æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ä¸²è¡ŒåŒæ­¥é˜Ÿåˆ—æ¥å°†è¯»å†™æ“ä½œéƒ½å®‰æ’åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼š</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">_syncQueue = dispatch_queue_create(<span class="string">"com.effectiveobjectivec.syncQueue"</span>, <span class="literal">NULL</span>);</div><div class="line"></div><div class="line"><span class="comment">//è¯»å–å­—ç¬¦ä¸²</span></div><div class="line">- (<span class="built_in">NSString</span>*)someString &#123;</div><div class="line">    __block <span class="built_in">NSString</span> *localSomeString;</div><div class="line">    <span class="built_in">dispatch_sync</span>(_syncQueue, ^&#123;</div><div class="line">        localSomeString = _someString;</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> localSomeString;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®å­—ç¬¦ä¸²</span></div><div class="line">- (<span class="keyword">void</span>)setSomeString:(<span class="built_in">NSString</span>*)someString &#123;</div><div class="line">    <span class="built_in">dispatch_sync</span>(_syncQueue, ^&#123;</div><div class="line">        _someString = someString;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œï¼Œç”¨äº†ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ï¼Œä¿è¯äº†è¯»å†™æ“ä½œéƒ½åŠ äº†é”ï¼Œæ˜¯ä¸€ç§è§£å†³æ–¹å¼ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬è¦æ˜ç¡®ä¸€ç‚¹ï¼Œæ•°æ®çš„æ­£ç¡®æ€§ä¸»è¦å–å†³äºå†™å…¥æ“ä½œï¼Œåªè¦ä¿è¯å†™å…¥æ—¶ï¼Œçº¿ç¨‹æ˜¯å®‰å…¨çš„ï¼Œé‚£ä¹ˆå³ä¾¿è¯»å–æ“ä½œæ˜¯å¹¶å‘çš„ï¼Œä¹Ÿå¯ä»¥ä¿è¯æ•°æ®æ˜¯åŒæ­¥çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¦åŠ ä»¥æ”¹è¿›ï¼Œè¯»æ“ä½œå¹¶è¡Œï¼Œå†™æ“ä½œä¸²è¡Œã€‚å¯ä»¥é€šè¿‡  <code>dispatch_barrier_async</code>ã€<code>dispatch_barrier_sync</code> å®Œæˆã€‚</p>
<h4 id="å°†å†™æ“ä½œæ”¾å…¥æ …æ å—ä¸­ï¼Œè®©ä»–ä»¬å•ç‹¬æ‰§è¡Œï¼›å°†è¯»å–æ“ä½œå¹¶å‘æ‰§è¡Œ"><a href="#å°†å†™æ“ä½œæ”¾å…¥æ …æ å—ä¸­ï¼Œè®©ä»–ä»¬å•ç‹¬æ‰§è¡Œï¼›å°†è¯»å–æ“ä½œå¹¶å‘æ‰§è¡Œ" class="headerlink" title="å°†å†™æ“ä½œæ”¾å…¥æ …æ å—ä¸­ï¼Œè®©ä»–ä»¬å•ç‹¬æ‰§è¡Œï¼›å°†è¯»å–æ“ä½œå¹¶å‘æ‰§è¡Œ"></a>å°†å†™æ“ä½œæ”¾å…¥æ …æ å—ä¸­ï¼Œè®©ä»–ä»¬å•ç‹¬æ‰§è¡Œï¼›å°†è¯»å–æ“ä½œå¹¶å‘æ‰§è¡Œ</h4><p>åœ¨é˜Ÿåˆ—ä¸­ï¼Œæ …æ å—å¿…é¡»å•ç‹¬æ‰§è¡Œï¼Œä¸èƒ½ä¸å…¶ä»–å—å¹¶è¡Œã€‚è¿™åªå¯¹å¹¶å‘é˜Ÿåˆ—æœ‰æ„ä¹‰ï¼Œå› ä¸ºä¸²è¡Œé˜Ÿåˆ—ä¸­çš„å—æ€»æ˜¯æŒ‰ç…§é¡ºåºé€ä¸ªæ‰§è¡Œã€‚å¹¶å‘é˜Ÿåˆ—å¦‚æœå‘ç°æ¥ä¸‹æ¥è¦å¤„ç†çš„å—æ˜¯ä¸ªæ …æ å—ï¼Œé‚£ä¹ˆå°±ä¸€ç›´ç­‰åˆ°å½“å‰æ‰€æœ‰å¹¶å‘å—éƒ½æ‰§è¡Œå®Œæ¯•ï¼Œæ‰ä¼šå•ç‹¬æ‰§è¡Œè¿™ä¸ªæ …æ å—ã€‚å¾…æ …æ å—æ‰§è¡Œè¿‡åï¼Œå†æŒ‰æ­£å¸¸æ–¹å¼ç»§ç»­å‘ä¸‹å¤„ç†ã€‚<strong>ç›¸å½“äºç»™å¹¶è¡Œé˜Ÿåˆ—é‡ŒåŠ ä¸ªé”</strong></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">_syncQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="comment">//è¯»å–å­—ç¬¦ä¸²</span></div><div class="line">- (<span class="built_in">NSString</span>*)someString &#123;</div><div class="line">    __block <span class="built_in">NSString</span> *localSomeString;</div><div class="line">    <span class="built_in">dispatch_sync</span>(_syncQueue, ^&#123;</div><div class="line">       localSomeString = _someString;</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> localSomeString;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®å­—ç¬¦ä¸²</span></div><div class="line">- (<span class="keyword">void</span>)setSomeString:(<span class="built_in">NSString</span>*)someString &#123;</div><div class="line"></div><div class="line">    dispatch_barrier_async(_syncQueue, ^&#123;</div><div class="line">        _someString = someString;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œè§£é‡Šä¸‹ä¸ºä»€ä¹ˆè¯»å–ç”¨çš„æ˜¯ <code>sync</code>ï¼Œå†™å…¥ç”¨çš„æ˜¯ <code>async</code>ï¼Œå› ä¸ºè¯»å–æ˜¯è¦æœ‰è¿”å›å€¼çš„ï¼Œè¦å°†å€¼è¿”å›ç»™è°ƒç”¨çš„å¯¹è±¡ï¼Œæ€»ä¸èƒ½è¿˜æ²¡æœ‰æ‹¿åˆ°å€¼ï¼Œå°±å·²ç» <code>return</code> äº†å§ï¼›è€Œå†™å…¥æ“ä½œæ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆå°±è®©å®ƒç«‹å³ <code>return</code> æ‰§è¡Œåé¢çš„ä»£ç ï¼Œå¦å¼€çº¿ç¨‹å†™å…¥ã€‚</p>
<h3 id="ç¬¬42æ¡ï¼šå¤šç”¨GCDï¼Œå°‘ç”¨performSelectorç³»åˆ—æ–¹æ³•"><a href="#ç¬¬42æ¡ï¼šå¤šç”¨GCDï¼Œå°‘ç”¨performSelectorç³»åˆ—æ–¹æ³•" class="headerlink" title="ç¬¬42æ¡ï¼šå¤šç”¨GCDï¼Œå°‘ç”¨performSelectorç³»åˆ—æ–¹æ³•"></a>ç¬¬42æ¡ï¼šå¤šç”¨GCDï¼Œå°‘ç”¨performSelectorç³»åˆ—æ–¹æ³•</h3><p>åœ¨iOSå¼€å‘ä¸­ï¼Œæœ‰æ—¶ä¼šä½¿ç”¨ <code>performSelector</code> æ¥æ‰§è¡ŒæŸä¸ªæ–¹æ³•ï¼Œä½†æ˜¯ <code>performSelector</code> ç³»åˆ—çš„æ–¹æ³•èƒ½å¤„ç†çš„é€‰æ‹©å­å¾ˆå±€é™ï¼Œæœ€å¥½ä½¿ç”¨ GCDï¼š</p>
<ul>
<li>å®ƒæ— æ³•å¤„ç†å¸¦æœ‰å¤šä¸ªå‚æ•°çš„é€‰æ‹©å­ï¼ˆæœ‰æœ€å¤šæ”¯æŒä¸¤ä¸ªé€‰æ‹©å­çš„æ–¹æ³•ï¼‰</li>
<li>è¿”å›å€¼åªèƒ½æ˜¯voidæˆ–è€…å¯¹è±¡ç±»å‹</li>
<li>ä¼šå¼•èµ·å†…å­˜æ³„éœ²</li>
</ul>
<p>ä½†æ˜¯å¦‚æœå°†æ–¹æ³•æ”¾åœ¨å—ä¸­ï¼Œé€šè¿‡ GCD æ¥æ“ä½œå°±èƒ½å¾ˆå¥½åœ°è§£å†³è¿™äº›é—®é¢˜ã€‚å°¤å…¶æ˜¯æˆ‘ä»¬å¦‚æœæƒ³è¦è®©ä¸€ä¸ªä»»åŠ¡åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œæœ€å¥½åº”è¯¥å°†ä»»åŠ¡æ”¾åˆ°å—é‡Œï¼Œäº¤ç»™ GCD æ¥å®ç°ï¼Œè€Œä¸æ˜¯é€šè¿‡ <code>performSelector</code> æ–¹æ³•ã€‚</p>
<h4 id="å»¶åæ‰§è¡ŒæŸä¸ªä»»åŠ¡çš„æ–¹æ³•"><a href="#å»¶åæ‰§è¡ŒæŸä¸ªä»»åŠ¡çš„æ–¹æ³•" class="headerlink" title="å»¶åæ‰§è¡ŒæŸä¸ªä»»åŠ¡çš„æ–¹æ³•"></a>å»¶åæ‰§è¡ŒæŸä¸ªä»»åŠ¡çš„æ–¹æ³•</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä½¿ç”¨ performSelector:withObject:afterDelay:</span></div><div class="line">[<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(doSomething) withObject:<span class="literal">nil</span> afterDelay:<span class="number">5.0</span>];</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// ä½¿ç”¨ dispatch_after</span></div><div class="line">dispatch_time_t time = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">5.0</span> * <span class="built_in">NSEC_PER_SEC</span>));</div><div class="line">dispatch_after(time, dispatch_get_main_queue(), ^(<span class="keyword">void</span>)&#123;</div><div class="line">    [<span class="keyword">self</span> doSomething];</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="å°†ä»»åŠ¡æ”¾åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ"><a href="#å°†ä»»åŠ¡æ”¾åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ" class="headerlink" title="å°†ä»»åŠ¡æ”¾åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ"></a>å°†ä»»åŠ¡æ”¾åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// ä½¿ç”¨ performSelectorOnMainThread:withObject:waitUntilDone:</div><div class="line">[self performSelectorOnMainThread:@selector(doSomething) withObject:nil waitUntilDone:NO];</div><div class="line"></div><div class="line"></div><div class="line">// ä½¿ç”¨ dispatch_async</div><div class="line">// (or if waitUntilDone is YES, then dispatch_sync)</div><div class="line">dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">        [self doSomething];</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å¦‚æœ <code>waitUntilDone</code> çš„å‚æ•°æ˜¯ <code>Yes</code>ï¼Œé‚£ä¹ˆå°±å¯¹åº” GCD çš„ <code>dispatch_sync</code> æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ GCD çš„æ–¹å¼å¯ä»¥å°†çº¿ç¨‹æ“ä½œä»£ç å’Œæ–¹æ³•è°ƒç”¨ä»£ç å†™åœ¨åŒä¸€å¤„ï¼Œä¸€ç›®äº†ç„¶ï¼›è€Œä¸”å®Œå…¨ä¸å—è°ƒç”¨æ–¹æ³•çš„é€‰æ‹©å­å’Œæ–¹æ³•å‚æ•°ä¸ªæ•°çš„é™åˆ¶ã€‚</p>
<h3 id="ç¬¬43æ¡ï¼šæŒæ¡GCDåŠæ“ä½œé˜Ÿåˆ—çš„ä½¿ç”¨æ—¶æœº"><a href="#ç¬¬43æ¡ï¼šæŒæ¡GCDåŠæ“ä½œé˜Ÿåˆ—çš„ä½¿ç”¨æ—¶æœº" class="headerlink" title="ç¬¬43æ¡ï¼šæŒæ¡GCDåŠæ“ä½œé˜Ÿåˆ—çš„ä½¿ç”¨æ—¶æœº"></a>ç¬¬43æ¡ï¼šæŒæ¡GCDåŠæ“ä½œé˜Ÿåˆ—çš„ä½¿ç”¨æ—¶æœº</h3><p>é™¤äº† GCDï¼Œ<strong>æ“ä½œé˜Ÿåˆ—ï¼ˆNSOperationQueueï¼‰</strong>ä¹Ÿæ˜¯è§£å†³å¤šçº¿ç¨‹ä»»åŠ¡ç®¡ç†é—®é¢˜çš„ä¸€ä¸ªæ–¹æ¡ˆã€‚å¯¹äºä¸åŒçš„ç¯å¢ƒï¼Œæˆ‘ä»¬è¦é‡‡å–ä¸åŒçš„ç­–ç•¥æ¥è§£å†³é—®é¢˜ï¼šæœ‰æ—¶å€™ä½¿ç”¨ GCD å¥½äº›ï¼Œæœ‰æ—¶åˆ™æ˜¯ä½¿ç”¨æ“ä½œé˜Ÿåˆ—æ›´åŠ åˆç†ã€‚ï¼ˆå¹¶ä¸æ¸…æ¥šæ“ä½œé˜Ÿåˆ—æ€ä¹ˆç”¨çš„ï¼Œåæ­£å°±æŠ„ä¸€ä¸‹å“ªé‡Œå¥½ï¼‰</p>
<ul>
<li>å¯ä»¥å–æ¶ˆæ“ä½œï¼šåœ¨è¿è¡Œä»»åŠ¡å‰ï¼Œå¯ä»¥åœ¨NSOperationå¯¹è±¡è°ƒç”¨ <code>cancel</code> æ–¹æ³•ï¼Œæ ‡æ˜æ­¤ä»»åŠ¡ä¸éœ€è¦æ‰§è¡Œã€‚ä½†æ˜¯ GCD é˜Ÿåˆ—æ˜¯æ— æ³•å–æ¶ˆçš„ï¼Œå› ä¸ºå®ƒéµå¾ªâ€œå®‰æ’å¥½ä¹‹åå°±ä¸ç®¡äº†ï¼ˆfire and forgetï¼‰â€çš„åŸåˆ™ã€‚</li>
<li>å¯ä»¥æŒ‡å®šæ“ä½œé—´çš„ä¾èµ–å…³ç³»ï¼šä¾‹å¦‚ä»æœåŠ¡å™¨ä¸‹è½½å¹¶å¤„ç†æ–‡ä»¶çš„åŠ¨ä½œå¯ä»¥ç”¨æ“ä½œæ¥è¡¨ç¤ºã€‚è€Œåœ¨å¤„ç†å…¶ä»–æ–‡ä»¶ä¹‹å‰å¿…é¡»å…ˆä¸‹è½½â€œæ¸…å•æ–‡ä»¶â€ã€‚è€Œåç»­çš„ä¸‹è½½å·¥ä½œï¼Œéƒ½è¦ä¾èµ–äºå…ˆä¸‹è½½çš„æ¸…å•æ–‡ä»¶è¿™ä¸€æ“ä½œã€‚</li>
<li>ç›‘æ§ <code>NSOperation</code> å¯¹è±¡çš„å±æ€§ï¼šå¯ä»¥é€šè¿‡ KVO æ¥ç›‘å¬ <code>NSOperation</code> çš„å±æ€§ï¼šå¯ä»¥é€šè¿‡ <code>isCancelled</code> å±æ€§æ¥åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²å–æ¶ˆï¼›é€šè¿‡ <code>isFinished</code> å±æ€§æ¥åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆã€‚</li>
<li>å¯ä»¥æŒ‡å®šæ“ä½œçš„ä¼˜å…ˆçº§ï¼šæ“ä½œçš„ä¼˜å…ˆçº§è¡¨ç¤ºæ­¤æ“ä½œä¸é˜Ÿåˆ—ä¸­å…¶ä»–æ“ä½œä¹‹é—´çš„ä¼˜å…ˆå…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šå®ƒã€‚</li>
</ul>
<h3 id="ç¬¬44æ¡ï¼šé€šè¿‡Dispath-Groupæœºåˆ¶ï¼Œæ ¹æ®ç³»ç»Ÿèµ„æºçŠ¶å†µæ¥æ‰§è¡Œä»»åŠ¡"><a href="#ç¬¬44æ¡ï¼šé€šè¿‡Dispath-Groupæœºåˆ¶ï¼Œæ ¹æ®ç³»ç»Ÿèµ„æºçŠ¶å†µæ¥æ‰§è¡Œä»»åŠ¡" class="headerlink" title="ç¬¬44æ¡ï¼šé€šè¿‡Dispath Groupæœºåˆ¶ï¼Œæ ¹æ®ç³»ç»Ÿèµ„æºçŠ¶å†µæ¥æ‰§è¡Œä»»åŠ¡"></a>ç¬¬44æ¡ï¼šé€šè¿‡Dispath Groupæœºåˆ¶ï¼Œæ ¹æ®ç³»ç»Ÿèµ„æºçŠ¶å†µæ¥æ‰§è¡Œä»»åŠ¡</h3><p>æœ‰æ—¶éœ€è¦ç­‰å¾…å¤šä¸ªå¹¶è¡Œä»»åŠ¡ç»“æŸçš„é‚£ä¸€åˆ»æ‰§è¡ŒæŸä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ <code>dispath group</code> å‡½æ•°æ¥å®ç°è¿™ä¸ªéœ€æ±‚ï¼š</p>
<p>é€šè¿‡ <code>dispath group</code> å‡½æ•°ï¼Œå¯ä»¥æŠŠå¹¶å‘æ‰§è¡Œçš„å¤šä¸ªä»»åŠ¡åˆä¸ºä¸€ç»„ï¼Œäºæ˜¯è°ƒç”¨è€…å°±å¯ä»¥çŸ¥é“è¿™äº›ä»»åŠ¡ä½•æ—¶æ‰èƒ½å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ä¸€ä¸ªä¼˜å…ˆçº§ä½çš„å¹¶å‘é˜Ÿåˆ—</span></div><div class="line"><span class="built_in">dispatch_queue_t</span> lowPriorityQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, <span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="comment">//ä¸€ä¸ªä¼˜å…ˆçº§é«˜çš„å¹¶å‘é˜Ÿåˆ—</span></div><div class="line"><span class="built_in">dispatch_queue_t</span> highPriorityQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, <span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="comment">//åˆ›å»ºdispatch_group</span></div><div class="line">dispatch_group_t dispatchGroup = dispatch_group_create();</div><div class="line"></div><div class="line"><span class="comment">//å°†ä¼˜å…ˆçº§ä½çš„é˜Ÿåˆ—æ”¾å…¥dispatch_group</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">id</span> object <span class="keyword">in</span> lowPriorityObjects) &#123;</div><div class="line"> dispatch_group_async(dispatchGroup,lowPriorityQueue,^&#123; [object performTask]; &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//å°†ä¼˜å…ˆçº§é«˜çš„é˜Ÿåˆ—æ”¾å…¥dispatch_group</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">id</span> object <span class="keyword">in</span> highPriorityObjects) &#123;</div><div class="line"> dispatch_group_async(dispatchGroup,highPriorityQueue,^&#123; [object performTask]; &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//dispatch_groupé‡Œçš„ä»»åŠ¡éƒ½ç»“æŸåè°ƒç”¨å—ä¸­çš„ä»£ç </span></div><div class="line"><span class="built_in">dispatch_queue_t</span> notifyQueue = dispatch_get_main_queue();</div><div class="line">dispatch_group_notify(dispatchGroup,notifyQueue,^&#123;</div><div class="line">     <span class="comment">// Continue processing after completing tasks</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æƒ³è¦æ›´è¯¦ç»†çš„äº†è§£ï¼Œè¿˜æ˜¯çœ‹ä¹‹å‰çš„ GCD ä»‹ç»æ–‡ç« å§ã€‚</p>
<h3 id="ç¬¬45æ¡ï¼šä½¿ç”¨dispatch-onceæ¥æ‰§è¡Œåªéœ€è¿è¡Œä¸€æ¬¡çš„çº¿ç¨‹å®‰å…¨ä»£ç "><a href="#ç¬¬45æ¡ï¼šä½¿ç”¨dispatch-onceæ¥æ‰§è¡Œåªéœ€è¿è¡Œä¸€æ¬¡çš„çº¿ç¨‹å®‰å…¨ä»£ç " class="headerlink" title="ç¬¬45æ¡ï¼šä½¿ç”¨dispatch_onceæ¥æ‰§è¡Œåªéœ€è¿è¡Œä¸€æ¬¡çš„çº¿ç¨‹å®‰å…¨ä»£ç "></a>ç¬¬45æ¡ï¼šä½¿ç”¨dispatch_onceæ¥æ‰§è¡Œåªéœ€è¿è¡Œä¸€æ¬¡çš„çº¿ç¨‹å®‰å…¨ä»£ç </h3><p>æœ‰æ—¶æˆ‘ä»¬å¯èƒ½åªéœ€è¦å°†æŸæ®µä»£ç æ‰§è¡Œä¸€æ¬¡ï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡ <code>dispatch_once</code> å‡½æ•°æ¥è§£å†³ã€‚</p>
<p><code>dispatch_once</code> å‡½æ•°æ¯”è¾ƒé‡è¦çš„ä½¿ç”¨ä¾‹å­æ˜¯å•ä¾‹æ¨¡å¼ï¼š<br>æˆ‘ä»¬åœ¨åˆ›å»ºå•ä¾‹æ¨¡å¼çš„å®ä¾‹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>dispatch_once</code> å‡½æ•°æ¥ä»¤åˆå§‹åŒ–ä»£ç åªæ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶ä¸”å†…éƒ¨æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
<p>è€Œä¸”ï¼Œå¯¹äºæ‰§è¡Œä¸€æ¬¡çš„ <code>block</code> æ¥è¯´ï¼Œæ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶ä¼ å…¥çš„æ ‡è®°éƒ½å¿…é¡»å®Œå…¨ç›¸åŒï¼Œé€šå¸¸æ ‡è®°å˜é‡å£°æ˜åœ¨ <code>static</code> æˆ– <code>global</code> ä½œç”¨åŸŸé‡Œã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">id</span>)sharedInstance &#123;</div><div class="line">     <span class="keyword">static</span> EOCClass *sharedInstance = <span class="literal">nil</span>;</div><div class="line">     <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">     <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">ï»¿            sharedInstance = [[<span class="keyword">self</span> alloc] init];</div><div class="line">    &#125;);</div><div class="line">     <span class="keyword">return</span> sharedInstance;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ç¬¬46æ¡ï¼šä¸è¦ä½¿ç”¨dispatch-get-current-queue"><a href="#ç¬¬46æ¡ï¼šä¸è¦ä½¿ç”¨dispatch-get-current-queue" class="headerlink" title="ç¬¬46æ¡ï¼šä¸è¦ä½¿ç”¨dispatch_get_current_queue"></a>ç¬¬46æ¡ï¼šä¸è¦ä½¿ç”¨dispatch_get_current_queue</h3><p>å·²ç»è¢«åºŸå¼ƒçš„ APIï¼Œä¸è¯´äº†ã€‚</p>
<h2 id="ç³»ç»Ÿæ¡†æ¶"><a href="#ç³»ç»Ÿæ¡†æ¶" class="headerlink" title="ç³»ç»Ÿæ¡†æ¶"></a>ç³»ç»Ÿæ¡†æ¶</h2><h3 id="ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶"><a href="#ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶" class="headerlink" title="ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶"></a>ç¬¬47æ¡ï¼šç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶</h3><p>ä¸»è¦çš„ç³»ç»Ÿæ¡†æ¶ï¼š</p>
<ul>
<li>Foundation  :NSObject,NSArray,NSDictionary ç­‰</li>
<li>CFoundation :C è¯­è¨€ APIï¼ŒFoundation æ¡†æ¶ä¸­çš„è®¸å¤šåŠŸèƒ½ï¼Œéƒ½å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å¯¹åº”çš„ C è¯­è¨€ API</li>
<li>CFNetwork   :C è¯­è¨€ APIï¼Œæä¾›äº† C è¯­è¨€çº§åˆ«çš„ç½‘ç»œé€šä¿¡èƒ½åŠ› </li>
<li>CoreAudio   :C è¯­è¨€ APIï¼Œæ“ä½œè®¾å¤‡ä¸Šçš„éŸ³é¢‘ç¡¬ä»¶</li>
<li>AVFoundation:æä¾›çš„ OC å¯¹è±¡å¯ä»¥å›æ”¾å¹¶å½•åˆ¶éŸ³é¢‘å’Œè§†é¢‘</li>
<li>CoreData    :OC çš„ APIï¼Œå°†å¯¹è±¡å†™å…¥æ•°æ®åº“</li>
<li>CoreText    :C è¯­è¨€ APIï¼Œé«˜æ•ˆæ‰§è¡Œæ–‡å­—æ’ç‰ˆå’Œæ¸²æŸ“æ“ä½œ</li>
</ul>
<h3 id="ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨forå¾ªç¯"><a href="#ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨forå¾ªç¯" class="headerlink" title="ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨forå¾ªç¯"></a>ç¬¬48æ¡ï¼šå¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨forå¾ªç¯</h3><h4 id="ä¼ ç»Ÿçš„foréå†"><a href="#ä¼ ç»Ÿçš„foréå†" class="headerlink" title="ä¼ ç»Ÿçš„foréå†"></a>ä¼ ç»Ÿçš„foréå†</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSArray</span> *anArray = <span class="comment">/* ... */</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; anArray.count; i++) &#123;</div><div class="line">   <span class="keyword">id</span> object = anArray[i];</div><div class="line">   <span class="comment">// Do something with 'object'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// Dictionary</span></div><div class="line"><span class="built_in">NSDictionary</span> *aDictionary = <span class="comment">/* ... */</span>;</div><div class="line"><span class="built_in">NSArray</span> *keys = [aDictionary allKeys];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; keys.count; i++) &#123;</div><div class="line">   <span class="keyword">id</span> key = keys[i];</div><div class="line">   <span class="keyword">id</span> value = aDictionary[key];</div><div class="line">   <span class="comment">// Do something with 'key' and 'value'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// Set</span></div><div class="line"><span class="built_in">NSSet</span> *aSet = <span class="comment">/* ... */</span>;</div><div class="line"><span class="built_in">NSArray</span> *objects = [aSet allObjects];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; objects.count; i++) &#123;</div><div class="line">   <span class="keyword">id</span> object = objects[i];</div><div class="line">   <span class="comment">// Do something with 'object'</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨éå† NSDictionary,å’Œ NSet æ—¶ï¼Œæˆ‘ä»¬åˆæ–°åˆ›å»ºäº†ä¸€ä¸ªæ•°ç»„ã€‚è™½ç„¶éå†çš„ç›®çš„è¾¾æˆäº†ï¼Œä½†æ˜¯å´åŠ å¤§äº†ç³»ç»Ÿçš„å¼€é”€ã€‚</p>
<h4 id="åˆ©ç”¨å¿«é€Ÿéå†"><a href="#åˆ©ç”¨å¿«é€Ÿéå†" class="headerlink" title="åˆ©ç”¨å¿«é€Ÿéå†"></a>åˆ©ç”¨å¿«é€Ÿéå†</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSArray</span> *anArray = <span class="comment">/* ... */</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">id</span> object <span class="keyword">in</span> anArray) &#123;</div><div class="line"> <span class="comment">// Do something with 'object'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Dictionary</span></div><div class="line"><span class="built_in">NSDictionary</span> *aDictionary = <span class="comment">/* ... */</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">id</span> key <span class="keyword">in</span> aDictionary) &#123;</div><div class="line"> <span class="keyword">id</span> value = aDictionary[key];</div><div class="line"> <span class="comment">// Do something with 'key' and 'value'</span></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">NSSet</span> *aSet = <span class="comment">/* ... */</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">id</span> object <span class="keyword">in</span> aSet) &#123;</div><div class="line"> <span class="comment">// Do something with 'object'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ç§å¿«é€Ÿéå†çš„æ–¹æ³•è¦æ¯”ä¼ ç»Ÿçš„éå†æ–¹æ³•æ›´åŠ ç®€æ´æ˜“æ‡‚ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯æ— æ³•æ–¹ä¾¿è·å–å…ƒç´ çš„ä¸‹æ ‡ã€‚</p>
<h4 id="åˆ©ç”¨åŸºäºå—ï¼ˆblockï¼‰çš„éå†"><a href="#åˆ©ç”¨åŸºäºå—ï¼ˆblockï¼‰çš„éå†" class="headerlink" title="åˆ©ç”¨åŸºäºå—ï¼ˆblockï¼‰çš„éå†"></a>åˆ©ç”¨åŸºäºå—ï¼ˆblockï¼‰çš„éå†</h4><p>å…¶å®æˆ‘è§‰å¾—æ²¡å•¥ç”¨ï¼Œä¸çœ‹ä¹Ÿç½¢ã€‚</p>
<h3 id="ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„collectionä½¿ç”¨æ— ç¼æ¡¥æ¥"><a href="#ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„collectionä½¿ç”¨æ— ç¼æ¡¥æ¥" class="headerlink" title="ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„collectionä½¿ç”¨æ— ç¼æ¡¥æ¥"></a>ç¬¬49æ¡ï¼šå¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„collectionä½¿ç”¨æ— ç¼æ¡¥æ¥</h3><p>é€šè¿‡æ— ç¼æ¡¥æ¥æŠ€æœ¯ï¼Œå¯ä»¥åœ¨ Foundation æ¡†æ¶ä¸­çš„ OC å¯¹è±¡å’Œ CoreFoundation æ¡†æ¶ä¸­çš„ C è¯­è¨€æ•°æ®ç»“æ„ä¹‹é—´æ¥å›è½¬æ¢ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ— ç¼æ¡¥æ¥æŠ€æœ¯å‘¢ï¼Ÿå› ä¸ºæœ‰äº›OCå¯¹è±¡çš„ç‰¹æ€§æ˜¯å…¶å¯¹åº”çš„CFæ•°æ®ç»“æ„ä¸å…·å¤‡çš„ï¼Œåä¹‹äº¦ç„¶ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦é€šè¿‡æ— ç¼æ¡¥æ¥æŠ€æœ¯æ¥è®©è¿™ä¸¤è€…è¿›è¡ŒåŠŸèƒ½ä¸Šçš„â€œäº’è¡¥â€ã€‚</p>
<p>å…·ä½“æ€ä¹ˆç”¨ï¼Œç”¨åœ¨ä»€ä¹ˆåœºæ™¯å‘¢ï¼Ÿ æ²¡çœ‹æ‡‚ã€‚å‘µå‘µ</p>
<h3 id="ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨-NSCache-è€Œé-NSDictionary"><a href="#ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨-NSCache-è€Œé-NSDictionary" class="headerlink" title="ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨ NSCache è€Œé NSDictionary"></a>ç¬¬50æ¡ï¼šæ„å»ºç¼“å­˜æ—¶é€‰ç”¨ NSCache è€Œé NSDictionary</h3><p>ä¸çŸ¥é“æœ‰å•¥ç”¨ï¼Œç”¨åˆ°æ—¶å€™å†è¯´ã€‚</p>
<h3 id="ç¬¬51æ¡-ç²¾ç®€initialize-ä¸-loadçš„å®ç°ä»£ç "><a href="#ç¬¬51æ¡-ç²¾ç®€initialize-ä¸-loadçš„å®ç°ä»£ç " class="headerlink" title="ç¬¬51æ¡: ç²¾ç®€initialize ä¸ loadçš„å®ç°ä»£ç "></a>ç¬¬51æ¡: ç²¾ç®€initialize ä¸ loadçš„å®ç°ä»£ç </h3><p>æ¯ä¸ªç±»å’Œåˆ†ç±»åœ¨<strong>åŠ å…¥è¿è¡ŒæœŸç³»ç»Ÿæ—¶</strong>ï¼Œéƒ½ä¼šè°ƒç”¨ <code>load</code> æ–¹æ³•ï¼Œè€Œä¸”ä»…ä»…è°ƒç”¨ä¸€æ¬¡ã€‚<code>load</code> æ–¹æ³•ä¸éµå¾ªç»§æ‰¿è§„åˆ™ï¼ŒæŸä¸ªç±»æœ¬èº«æ²¡æœ‰é‡å†™ <code>load</code>ï¼Œé‚£ä¹Ÿä¸ä¼šè°ƒç”¨è¶…ç±»çš„ <code>load</code> æ–¹æ³•ã€‚å¯èƒ½æœ‰äº›å°ä¼™ä¼´ä¹ æƒ¯åœ¨è¿™é‡Œè°ƒç”¨ä¸€äº›æ–¹æ³•ï¼Œä½†æ˜¯ä½œè€…å»ºè®®å°½é‡ä¸è¦åœ¨è¿™ä¸ªæ–¹æ³•é‡Œè°ƒç”¨å…¶ä»–æ–¹æ³•ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨å…¶ä»–çš„ç±»ã€‚åŸå› æ˜¯æ¯ä¸ªç±»è½½å…¥ç¨‹åºåº“çš„æ—¶æœºæ˜¯ä¸åŒçš„ï¼Œå¦‚æœè¯¥ç±»è°ƒç”¨äº†è¿˜æœªè½½å…¥ç¨‹åºåº“çš„ç±»ï¼Œå°±ä¼šå¾ˆå±é™©ã€‚</p>
<p><code>initialize</code> æ–¹æ³•ä¸ <code>load</code> æ–¹æ³•ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯è¿™ä¸ªæ–¹æ³•ä¼šåœ¨ç¨‹åºé¦–æ¬¡è°ƒç”¨è¿™ä¸ªç±»çš„æ—¶å€™è°ƒç”¨ï¼ˆ<strong>æƒ°æ€§è°ƒç”¨</strong>ï¼‰ï¼Œè€Œä¸”åªè°ƒç”¨ä¸€æ¬¡ï¼ˆç»å¯¹ä¸èƒ½ä¸»åŠ¨ä½¿ç”¨ä»£ç è°ƒç”¨ï¼‰ã€‚å¦‚æœå­ç±»æ²¡æœ‰å®ç°å®ƒï¼Œå®ƒçš„è¶…ç±»å´å®ç°äº†ï¼Œé‚£ä¹ˆå°±ä¼šè¿è¡Œè¶…ç±»çš„ä»£ç ã€‚å¦‚æœåœ¨ <code>initialize</code> æ–¹æ³•é‡Œæ‰§è¡Œè¿‡å¤šçš„æ“ä½œçš„è¯ï¼Œä¼šä½¿å¾—ç¨‹åºéš¾ä»¥ç»´æŠ¤ï¼Œä¹Ÿå¯èƒ½å¼•èµ·å…¶ä»–çš„bugã€‚å› æ­¤ï¼Œåœ¨ <code>initialize</code> æ–¹æ³•é‡Œï¼Œæœ€å¥½åªæ˜¯è®¾ç½®å†…éƒ¨çš„æ•°æ®ï¼Œä¸è¦è°ƒç”¨å…¶ä»–çš„æ–¹æ³•ï¼Œå› ä¸ºå°†æ¥å¯èƒ½ä¼šç»™è¿™äº›æ–¹æ³•æ·»åŠ å…¶å®ƒçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆä¼šå¯èƒ½ä¼šå¼•èµ·éš¾ä»¥æ’æŸ¥çš„ bugã€‚</p>
<h3 id="ç¬¬52æ¡-åˆ«å¿˜äº†NSTimerä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡"><a href="#ç¬¬52æ¡-åˆ«å¿˜äº†NSTimerä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡" class="headerlink" title="ç¬¬52æ¡: åˆ«å¿˜äº†NSTimerä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡"></a>ç¬¬52æ¡: åˆ«å¿˜äº†NSTimerä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡</h3><p>åœ¨ä½¿ç”¨ <code>NSTimer</code> çš„æ—¶å€™ï¼Œ<code>NSTimer</code> ä¼šç”ŸæˆæŒ‡å‘å…¶ä½¿ç”¨è€…çš„å¼•ç”¨ï¼Œè€Œå…¶ä½¿ç”¨è€…å¦‚æœä¹Ÿå¼•ç”¨äº† <code>NSTimer</code>ï¼Œé‚£ä¹ˆå°±ä¼šç”Ÿæˆä¿ç•™ç¯ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCClass</span> : <span class="title">NSObject</span></span></div><div class="line">- (<span class="keyword">void</span>)startPolling;</div><div class="line">- (<span class="keyword">void</span>)stopPolling;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EOCClass</span> </span>&#123;</div><div class="line">     <span class="built_in">NSTimer</span> *_pollTimer;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">id</span>)init &#123;</div><div class="line">     <span class="keyword">return</span> [<span class="keyword">super</span> init];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)dealloc &#123;</div><div class="line">    [_pollTimer invalidate];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)stopPolling &#123;</div><div class="line"></div><div class="line">    [_pollTimer invalidate];</div><div class="line">    _pollTimer = <span class="literal">nil</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)startPolling &#123;</div><div class="line">   _pollTimer = [<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">5.0</span></div><div class="line">                                                 target:<span class="keyword">self</span></div><div class="line">                                               selector:<span class="keyword">@selector</span>(p_doPoll)</div><div class="line">                                               userInfo:<span class="literal">nil</span></div><div class="line">                                                repeats:<span class="literal">YES</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)p_doPoll &#123;</div><div class="line">    <span class="comment">// Poll the resource</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ° <code>EOCClass</code> å’Œ <code>_pollTimer</code> ä¹‹é—´ç”±äº <code>target:self</code> çš„å­˜åœ¨ï¼Œç›¸äº’å½¢æˆäº†ä¿ç•™ç¯ï¼Œå¦‚æœä¸ä¸»åŠ¨è°ƒç”¨ <code>stopPolling</code> æ–¹æ³•å°† <code>_pollTimer</code>å–æ¶ˆå¹¶æ¸…ç©ºå°±æ— æ³•æ‰“ç ´è¿™ä¸ªä¿ç•™ç¯ã€‚åƒè¿™ç§é€šè¿‡ä¸»åŠ¨è°ƒç”¨æ–¹æ³•æ¥æ‰“ç ´ä¿ç•™ç¯çš„è®¾è®¡æ˜¾ç„¶æ˜¯ä¸å¥½çš„ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªæå…¶å±é™©çš„æƒ…å†µï¼Œå› ä¸º NSTimer æ²¡æœ‰æ¶ˆå¤±ï¼Œå®ƒè¿˜æœ‰å¯èƒ½æŒç»­æ‰§è¡Œä¸€äº›ä»»åŠ¡ï¼Œä¸æ–­æ¶ˆè€—ç³»ç»Ÿèµ„æºã€‚è€Œä¸”ï¼Œå¦‚æœä»»åŠ¡æ¶‰åŠåˆ°ä¸‹è½½ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šæ›´ç³Ÿã€‚ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p>
<p>æˆ‘è§‰å¾—æ–‡ç« é‡Œä¸¾çš„æ–¹æ³•ç®€ç›´è„±è£¤å­æ”¾å±ï¼Œæ‰€ä»¥å°±ä¸åˆ—å‡ºæ¥äº†ã€‚ç›´æ¥å°† <code>target:self</code> è®¾ç½®æˆ <code>target:weakSelf</code> ä¸å°±è¡Œäº†ï¼Ÿ</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[runLoopå­¦ä¹ ç¬”è®°]]></title>
      <url>http://zhang759740844.github.io/2016/11/01/runloop/</url>
      <content type="html"><![CDATA[<p>runLoop è™½ç„¶å¹³æ—¶ç”¨ä¸åˆ°ï¼Œä½†æ˜¯é¢è¯•çš„æ—¶å€™é—®çš„å¤šå•Šã€‚é‚£æˆ‘ä¹Ÿå°±æ¥äº†è§£ä¸€ä¸‹ runLoop çš„åŸç†ã€‚</p>
<a id="more"></a>
<h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><h3 id="ä»€ä¹ˆæ˜¯RunLoop"><a href="#ä»€ä¹ˆæ˜¯RunLoop" class="headerlink" title="ä»€ä¹ˆæ˜¯RunLoop"></a>ä»€ä¹ˆæ˜¯RunLoop</h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ª iOS ç¨‹åºçš„ main å‡½æ•°ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">UIApplicationMain</span>(argc, argv, <span class="literal">nil</span>, <span class="built_in">NSStringFromClass</span>([AppDelegate <span class="keyword">class</span>]));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>main å‡½æ•°æ˜¯ç¨‹åºçš„å…¥å£ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆç¨‹åºæ‰§è¡Œå®Œæ¯•åæ²¡æœ‰é€€å‡ºå‘¢ï¼Ÿå› ä¸º RunLoopï¼Œä½¿çº¿ç¨‹å¾ªç¯ï¼Œèƒ½å¤Ÿéšæ—¶å¤„ç†äº‹ä»¶ä½†å¹¶ä¸é€€å‡ºã€‚è¿™ç§æ–¹å¼åœ¨å„ä¸ªæ¡†æ¶ä¸­éƒ½æœ‰å®ç°ï¼Œæ¯”å¦‚ Node.js çš„äº‹ä»¶å¤„ç†ï¼Œæ¯”å¦‚ Windows ç¨‹åºçš„æ¶ˆæ¯å¾ªç¯ï¼Œå…³é”®ç‚¹åœ¨äºï¼šå¦‚ä½•ç®¡ç†äº‹ä»¶/æ¶ˆæ¯ï¼Œå¦‚ä½•è®©çº¿ç¨‹åœ¨æ²¡æœ‰å¤„ç†æ¶ˆæ¯æ—¶ä¼‘çœ ä»¥é¿å…èµ„æºå ç”¨ã€åœ¨æœ‰æ¶ˆæ¯åˆ°æ¥æ—¶ç«‹åˆ»è¢«å”¤é†’ã€‚</p>
<p>ä¸Šé¢ä»£ç ä¸­ <code>UIApplicationMain()</code> æ–¹æ³•åœ¨è¿™é‡Œä¸ä»…å®Œæˆäº†åˆå§‹åŒ–æˆ‘ä»¬çš„ç¨‹åºå¹¶è®¾ç½®ç¨‹åº Delegate çš„ä»»åŠ¡ï¼Œè€Œä¸”éšä¹‹å¼€å¯äº†ä¸»çº¿ç¨‹çš„ RunLoopï¼Œå¼€å§‹æ¥å—å¤„ç†äº‹ä»¶ã€‚è¿™æ ·æˆ‘ä»¬çš„åº”ç”¨å°±å¯ä»¥åœ¨æ— äººæ“ä½œçš„æ—¶å€™ä¼‘æ¯ï¼Œéœ€è¦è®©å®ƒå¹²æ´»çš„æ—¶å€™åˆèƒ½ç«‹é©¬å“åº”ã€‚æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_1.png?raw=true" alt="runloop_1"></p>
<p>åœ¨ OS X/iOS ç³»ç»Ÿä¸­ï¼Œæä¾›äº†ä¸¤ä¸ªè¿™æ ·çš„å¯¹è±¡ï¼š</p>
<ul>
<li><strong>CFRunLoopRef</strong>ï¼šæ˜¯åœ¨ CoreFoundation æ¡†æ¶å†…çš„ï¼Œå®ƒæä¾›äº†çº¯ C å‡½æ•°çš„ APIï¼Œæ‰€æœ‰è¿™äº› API éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li>
<li><strong>NSRunLoop</strong>ï¼šæ˜¯åŸºäº CFRunLoopRef çš„å°è£…ï¼Œæä¾›äº†é¢å‘å¯¹è±¡çš„ APIï¼Œä½†æ˜¯è¿™äº› API ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li>
</ul>
<p>å…ˆæ¥ä¸€å¼  RunLoop æœºåˆ¶å…³ç³»å›¾æ€»è§ˆï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_2.png?raw=true" alt="runloop_2"></p>
<h3 id="RunLoopä¸çº¿ç¨‹çš„å…³ç³»"><a href="#RunLoopä¸çº¿ç¨‹çš„å…³ç³»" class="headerlink" title="RunLoopä¸çº¿ç¨‹çš„å…³ç³»"></a>RunLoopä¸çº¿ç¨‹çš„å…³ç³»</h3><p>è‹¹æœä¸å…è®¸ç›´æ¥åˆ›å»º RunLoopï¼Œæä¾›äº†ä¸¤ä¸ªè·å–å‡½æ•°ï¼ŒCFRunLoopRef çš„è·å–æ–¹æ³•ä¸º <code>CFRunLoopGetMain()</code>ï¼Œ <code>CFRunLoopGetCurrent()</code>ã€‚NSRunLoop çš„è·å–æ–¹æ³•æ˜¯ <code>currentRunLoop</code>,<code>mainRunLoop</code>ã€‚NSRunLoop å¯¹è±¡å¯ä»¥é€šè¿‡ <code>getCFRunLoop</code> æ–¹æ³•è·å¾— CFRunLoopRef å¯¹è±¡ã€‚CFRunLoopRef çš„å†…éƒ¨é€»è¾‘å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// å…¨å±€çš„ Dictionaryï¼Œkey æ˜¯ pthread_tï¼Œ value æ˜¯ CFRunLoopRef</span></div><div class="line"><span class="keyword">static</span> <span class="built_in">CFMutableDictionaryRef</span> loopsDic;</div><div class="line"><span class="comment">/// è®¿é—® loopsDic æ—¶çš„é”</span></div><div class="line"><span class="keyword">static</span> <span class="built_in">CFSpinLock_t</span> loopsLock;</div><div class="line"> </div><div class="line"><span class="comment">/// è·å–ä¸€ä¸ª pthread å¯¹åº”çš„ Run Loopã€‚</span></div><div class="line"><span class="built_in">CFRunLoopRef</span> _CFRunLoopGet(pthread_t thread) &#123;</div><div class="line">    OSSpinLockLock(&amp;loopsLock);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (!loopsDic) &#123;</div><div class="line">        <span class="comment">// ç¬¬ä¸€æ¬¡è¿›å…¥æ—¶ï¼Œåˆå§‹åŒ–å…¨å±€Dicï¼Œå¹¶å…ˆä¸ºä¸»çº¿ç¨‹åˆ›å»ºä¸€ä¸ª Run Loopã€‚</span></div><div class="line">        loopsDic = <span class="built_in">CFDictionaryCreateMutable</span>();</div><div class="line">        <span class="built_in">CFRunLoopRef</span> mainLoop = _CFRunLoopCreate();</div><div class="line">        <span class="built_in">CFDictionarySetValue</span>(loopsDic, pthread_main_thread_np(), mainLoop);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// ç›´æ¥ä» Dictionary é‡Œè·å–ã€‚</span></div><div class="line">    <span class="built_in">CFRunLoopRef</span> loop = <span class="built_in">CFDictionaryGetValue</span>(loopsDic, thread));</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (!loop) &#123;</div><div class="line">        <span class="comment">/// å–ä¸åˆ°æ—¶ï¼Œåˆ›å»ºä¸€ä¸ª</span></div><div class="line">        loop = _CFRunLoopCreate();</div><div class="line">        <span class="built_in">CFDictionarySetValue</span>(loopsDic, thread, loop);</div><div class="line">        <span class="comment">/// æ³¨å†Œä¸€ä¸ªå›è°ƒï¼Œå½“çº¿ç¨‹é”€æ¯æ—¶ï¼Œé¡ºä¾¿ä¹Ÿé”€æ¯å…¶å¯¹åº”çš„ Run Loopã€‚</span></div><div class="line">        _CFSetTSD(..., thread, loop, __CFFinalizeRunLoop);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    OSSpinLockUnLock(&amp;loopsLock);</div><div class="line">    <span class="keyword">return</span> loop;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="built_in">CFRunLoopRef</span> <span class="built_in">CFRunLoopGetMain</span>() &#123;</div><div class="line">    <span class="keyword">return</span> _CFRunLoopGet(pthread_main_thread_np());</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="built_in">CFRunLoopRef</span> <span class="built_in">CFRunLoopGetCurrent</span>() &#123;</div><div class="line">    <span class="keyword">return</span> _CFRunLoopGet(pthread_self());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œçº¿ç¨‹å’Œ RunLoop ä¹‹é—´æ˜¯ä¸€ä¸€å¯¹åº”çš„(è¿™ä¹Ÿå°±è§£é‡Šäº†å‰é¢å…³ç³»å›¾ä¸­ CFRunLoop å’Œ Thread è¿çº¿ä¸­çš„ä¸¤ä¸ª<code>1</code>çš„æ„ä¹‰)ï¼Œå…¶å…³ç³»æ˜¯ä¿å­˜åœ¨ä¸€ä¸ªå…¨å±€çš„ Dictionary é‡Œã€‚çº¿ç¨‹åˆšåˆ›å»ºæ—¶å¹¶æ²¡æœ‰ RunLoopï¼Œå¦‚æœä½ ä¸ä¸»åŠ¨è·å–ï¼Œé‚£å®ƒä¸€ç›´éƒ½ä¸ä¼šæœ‰ã€‚RunLoop çš„åˆ›å»ºæ˜¯å‘ç”Ÿåœ¨ç¬¬ä¸€æ¬¡è·å–æ—¶ï¼ŒRunLoop çš„é”€æ¯æ˜¯å‘ç”Ÿåœ¨çº¿ç¨‹ç»“æŸæ—¶ã€‚ä½ åªèƒ½åœ¨ä¸€ä¸ªçº¿ç¨‹çš„å†…éƒ¨è·å–å…¶ RunLoopï¼ˆä¸»çº¿ç¨‹é™¤å¤–ï¼‰ã€‚</p>
<h2 id="RunLoopå¯¹å¤–æ¥å£"><a href="#RunLoopå¯¹å¤–æ¥å£" class="headerlink" title="RunLoopå¯¹å¤–æ¥å£"></a>RunLoopå¯¹å¤–æ¥å£</h2><p>åœ¨ CoreFoundation é‡Œé¢å…³äº RunLoop æœ‰5ä¸ªç±»:</p>
<ul>
<li>CFRunLoopRef</li>
<li>CFRunLoopModeRef</li>
<li>CFRunLoopSourceRef</li>
<li>CFRunLoopTimerRef</li>
<li>CFRunLoopObserverRef</li>
</ul>
<p>å…¶ä¸­ï¼ŒCFRunLoopModeRef ç±»å¹¶æ²¡æœ‰å¯¹å¤–æš´éœ²ï¼Œä¸èƒ½ç›´æ¥å¾—åˆ°å…¶å¯¹è±¡ï¼Œåªæ˜¯é€šè¿‡ CFRunLoopRef çš„æ¥å£è¿›è¡Œäº†å°è£…ã€‚ä»–ä»¬çš„å…³ç³»å¦‚ä¸‹:<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_3.png?raw=true" alt="runloop_3"></p>
<p>ä¸€ä¸ª RunLoop åŒ…å«è‹¥å¹²ä¸ª Modeï¼Œæ¯ä¸ª Mode åˆåŒ…å«è‹¥å¹²ä¸ª Source/Timer/Observerã€‚æ¯æ¬¡è°ƒç”¨ RunLoop çš„ä¸»å‡½æ•°æ—¶ï¼Œåªèƒ½æŒ‡å®šå…¶ä¸­ä¸€ä¸ª Modeï¼Œè¿™ä¸ªModeè¢«ç§°ä½œ CurrentModeã€‚å¦‚æœéœ€è¦åˆ‡æ¢ Modeï¼Œåªèƒ½é€€å‡º Loopï¼Œå†é‡æ–°æŒ‡å®šä¸€ä¸ª Mode è¿›å…¥ã€‚è¿™æ ·åšä¸»è¦æ˜¯ä¸ºäº†åˆ†éš”å¼€ä¸åŒç»„çš„ Source/Timer/Observerï¼Œè®©å…¶äº’ä¸å½±å“ã€‚</p>
<h3 id="æ¥å£ç±»å‹"><a href="#æ¥å£ç±»å‹" class="headerlink" title="æ¥å£ç±»å‹"></a>æ¥å£ç±»å‹</h3><h4 id="RunLoopçš„Source"><a href="#RunLoopçš„Source" class="headerlink" title="RunLoopçš„Source"></a>RunLoopçš„Source</h4><p>RunLoop å¯¹è±¡å¤„ç†çš„äº‹ä»¶æºåˆ†ä¸ºä¸¤ç§ï¼šInput sources å’Œ Timer sourcesï¼ˆåˆ†åˆ«å¯¹åº”ä¸Šé¢çš„ CFRunLoopSourceRef å’Œ CFRunLoopTimerRefï¼Œç»Ÿç§°ä¸ºäº‹ä»¶æºï¼‰ï¼š</p>
<ul>
<li>Input sourcesï¼šç”¨åˆ†å‘å¼‚æ­¥äº‹ä»¶ï¼Œé€šå¸¸æ˜¯ç”¨äºå…¶ä»–çº¿ç¨‹æˆ–ç¨‹åºçš„æ¶ˆæ¯ï¼Œæ¯”å¦‚ï¼š<code>performSelector:onThread:</code></li>
<li>Timer sourcesï¼šç”¨åˆ†å‘åŒæ­¥äº‹ä»¶ï¼Œé€šå¸¸è¿™äº›äº‹ä»¶å‘ç”Ÿåœ¨ç‰¹å®šæ—¶é—´æˆ–è€…é‡å¤çš„æ—¶é—´é—´éš”ä¸Šï¼Œæ¯”å¦‚ï¼š<code>[NSTimer scheduledTimerWithTimeInterval:target:selector:]</code></li>
</ul>
<p>ä¸‹å›¾æ˜¯è‹¹æœå®˜æ–¹çš„ä¸€å¼ å›¾ï¼Œå±•ç¤ºäº† RunLoop çš„æ¦‚å¿µç»“æ„åŠå„ç§äº‹ä»¶æº<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_4.png?raw=true" alt="runloop_4"></p>
<h5 id="Input-Source"><a href="#Input-Source" class="headerlink" title="Input Source"></a>Input Source</h5><p>Input Source ä¹Ÿå°±æ˜¯ CFRunLoopSourceRef æœ‰ä¸¤ä¸ªç‰ˆæœ¬:Source0(Custom Input Sources)å’Œ Source1(Port-Based Sources)ï¼š</p>
<ul>
<li>Source0 åªåŒ…å«äº†ä¸€ä¸ªå›è°ƒï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰ï¼Œå®ƒå¹¶ä¸èƒ½ä¸»åŠ¨è§¦å‘äº‹ä»¶ã€‚ä½¿ç”¨æ—¶ï¼Œä½ éœ€è¦å…ˆè°ƒç”¨ <code>CFRunLoopSourceSignal(source)</code>ï¼Œå°†è¿™ä¸ª Source æ ‡è®°ä¸ºå¾…å¤„ç†ï¼Œç„¶åæ‰‹åŠ¨è°ƒç”¨ <code>CFRunLoopWakeUp(runloop)</code> æ¥å”¤é†’ RunLoopï¼Œè®©å…¶å¤„ç†è¿™ä¸ªäº‹ä»¶ã€‚</li>
<li>Source1 åŒ…å«äº†ä¸€ä¸ª mach_port å’Œä¸€ä¸ªå›è°ƒï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰ï¼Œè¢«ç”¨äºé€šè¿‡å†…æ ¸å’Œå…¶ä»–çº¿ç¨‹ç›¸äº’å‘é€æ¶ˆæ¯ã€‚è¿™ç§ Source èƒ½ä¸»åŠ¨å”¤é†’ RunLoop çš„çº¿ç¨‹ã€‚</li>
</ul>
<h5 id="Time-Source"><a href="#Time-Source" class="headerlink" title="Time Source"></a>Time Source</h5><p>åŸºäºæ—¶é—´çš„è§¦å‘å™¨ï¼Œå®ƒå’Œ NSTimer æ˜¯ Toll-Free Bridging çš„ï¼Œå¯ä»¥æ··ç”¨ã€‚å…¶åŒ…å«ä¸€ä¸ªæ—¶é—´é•¿åº¦å’Œä¸€ä¸ªå›è°ƒï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰ã€‚å½“å…¶åŠ å…¥åˆ° RunLoop æ—¶ï¼ŒRunLoop ä¼šæ³¨å†Œå¯¹åº”çš„æ—¶é—´ç‚¹ï¼Œå½“æ—¶é—´ç‚¹åˆ°æ—¶ï¼ŒRunLoop ä¼šè¢«å”¤é†’ä»¥æ‰§è¡Œé‚£ä¸ªå›è°ƒã€‚</p>
<p>Foundation ä¸­ NSTimer Class æä¾›äº†ç›¸å…³æ–¹æ³•æ¥è®¾ç½® Timer sourcesã€‚éœ€è¦æ³¨æ„çš„æ˜¯é™¤äº† <code>scheduledTimerWithTimeInterval</code> å¼€å¤´çš„æ–¹æ³•åˆ›å»ºçš„ Timer éƒ½éœ€è¦æ‰‹åŠ¨æ·»åŠ åˆ°å½“å‰ RunLoop ä¸­ã€‚ï¼ˆ<code>scheduledTimerWithTimeInterval</code> åˆ›å»ºçš„ Timer ä¼šè‡ªåŠ¨ä»¥ Default Mode åŠ è½½åˆ°å½“å‰ RunLoopä¸­ã€‚ï¼‰</p>
<h4 id="RunLoopçš„Mode"><a href="#RunLoopçš„Mode" class="headerlink" title="RunLoopçš„Mode"></a>RunLoopçš„Mode</h4><p>RunLoop Mode æ˜¯æŒ‡è¦è¢«ç›‘å¬çš„äº‹ä»¶æºï¼ˆåŒ…æ‹¬ Input sources å’Œ Timer sourcesï¼‰çš„é›†åˆ + è¦è¢«é€šçŸ¥çš„ run-loop observers çš„é›†åˆã€‚æ¯ä¸€æ¬¡è¿è¡Œè‡ªå·±çš„ RunLoop æ—¶ï¼Œéƒ½éœ€è¦æ˜¾ç¤ºæˆ–è€…éšç¤ºçš„æŒ‡å®šå…¶è¿è¡Œäºå“ªä¸€ç§ Modeã€‚åœ¨è®¾ç½® RunLoop Mode åï¼Œä½ çš„ RunLoop ä¼šè‡ªåŠ¨è¿‡æ»¤å’Œå…¶ä»– Mode ç›¸å…³çš„äº‹ä»¶æºï¼Œè€Œåªç›‘è§†å’Œå½“å‰è®¾ç½® Mode ç›¸å…³çš„æºï¼ˆé€šçŸ¥ç›¸å…³çš„è§‚å¯Ÿè€…ï¼‰ã€‚å¤§å¤šæ•°æ—¶å€™ï¼ŒRunLoop éƒ½æ˜¯è¿è¡Œåœ¨ç³»ç»Ÿå®šä¹‰çš„é»˜è®¤æ¨¡å¼ä¸Šã€‚</p>
<p>ç³»ç»Ÿé»˜è®¤å®šäº†ä¸€ä¸‹å‡ ä¸ª modeï¼š</p>
<ul>
<li>kCFRunLoopDefaultModeï¼šAppï¼šAppçš„é»˜è®¤ Modeï¼Œé€šå¸¸ä¸»çº¿ç¨‹æ˜¯åœ¨è¿™ä¸ª Mode ä¸‹è¿è¡Œçš„</li>
<li>UITrackingRunLoopModeï¼šç•Œé¢è·Ÿè¸ª Modeï¼Œç”¨äº ScrollView è¿½è¸ªè§¦æ‘¸æ»‘åŠ¨ï¼Œä¿è¯ç•Œé¢æ»‘åŠ¨æ—¶ä¸å—å…¶ä»– Mode å½±å“</li>
<li>UIInitializationRunLoopModeï¼šåœ¨åˆšå¯åŠ¨ App æ—¶ç¬¬è¿›å…¥çš„ç¬¬ä¸€ä¸ª Modeï¼Œå¯åŠ¨å®Œæˆåå°±ä¸å†ä½¿ç”¨ï¼ˆç§æœ‰ï¼‰</li>
<li>GSEventReceiveRunLoopModeï¼šæ¥å—ç³»ç»Ÿäº‹ä»¶çš„å†…éƒ¨ Modeï¼Œé€šå¸¸ç”¨ä¸åˆ°</li>
<li>kCFRunLoopCommonModesï¼šè¿™æ˜¯ä¸€ä¸ªå ä½çš„ Modeï¼ŒåŒ…å«ä¸Šé¢çš„ kCFRunLoopDefaultMode ä»¥åŠ UITrackingRunLoopMode</li>
</ul>
<p>åº”ç”¨åœºæ™¯ä¸¾ä¾‹ï¼šä¸»çº¿ç¨‹çš„ RunLoop é‡Œæœ‰ä¸¤ä¸ªé¢„ç½®çš„ Modeï¼škCFRunLoopDefaultMode å’Œ UITrackingRunLoopModeã€‚è¿™ä¸¤ä¸ª Mode éƒ½å·²ç»è¢«æ ‡è®°ä¸ºâ€Commonâ€å±æ€§ã€‚DefaultMode æ˜¯ App å¹³æ—¶æ‰€å¤„çš„çŠ¶æ€ï¼ŒTrackingRunLoopMode æ˜¯è¿½è¸ª ScrollView æ»‘åŠ¨æ—¶çš„çŠ¶æ€ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ª Timer å¹¶åŠ åˆ° DefaultMode æ—¶ï¼ŒTimer ä¼šå¾—åˆ°é‡å¤å›è°ƒï¼Œä½†æ­¤æ—¶æ»‘åŠ¨ä¸€ä¸ªTableViewæ—¶ï¼ŒRunLoop ä¼šå°† mode åˆ‡æ¢ä¸º TrackingRunLoopModeï¼Œè¿™æ—¶ Timer å°±ä¸ä¼šè¢«å›è°ƒï¼Œå¹¶ä¸”ä¹Ÿä¸ä¼šå½±å“åˆ°æ»‘åŠ¨æ“ä½œã€‚æœ‰æ—¶ä½ éœ€è¦ä¸€ä¸ª Timerï¼Œåœ¨ä¸¤ä¸ª Mode ä¸­éƒ½èƒ½å¾—åˆ°å›è°ƒï¼Œä¸€ç§åŠæ³•å°±æ˜¯å°†è¿™ä¸ª Timer åˆ†åˆ«åŠ å…¥è¿™ä¸¤ä¸ª Modeã€‚è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯å°† Timer åŠ å…¥ CommonModes ä¸­ã€‚</p>
<p>Mode æš´éœ²çš„ç®¡ç† mode item çš„æ¥å£æœ‰ä¸‹é¢å‡ ä¸ªï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CFRunLoopAddSource</span>(<span class="built_in">CFRunLoopRef</span> rl, <span class="built_in">CFRunLoopSourceRef</span> source, <span class="built_in">CFStringRef</span> modeName);</div><div class="line"><span class="built_in">CFRunLoopAddObserver</span>(<span class="built_in">CFRunLoopRef</span> rl, <span class="built_in">CFRunLoopObserverRef</span> observer, <span class="built_in">CFStringRef</span> modeName);</div><div class="line"><span class="built_in">CFRunLoopAddTimer</span>(<span class="built_in">CFRunLoopRef</span> rl, <span class="built_in">CFRunLoopTimerRef</span> timer, <span class="built_in">CFStringRef</span> mode);</div><div class="line"><span class="built_in">CFRunLoopRemoveSource</span>(<span class="built_in">CFRunLoopRef</span> rl, <span class="built_in">CFRunLoopSourceRef</span> source, <span class="built_in">CFStringRef</span> modeName);</div><div class="line"><span class="built_in">CFRunLoopRemoveObserver</span>(<span class="built_in">CFRunLoopRef</span> rl, <span class="built_in">CFRunLoopObserverRef</span> observer, <span class="built_in">CFStringRef</span> modeName);</div><div class="line"><span class="built_in">CFRunLoopRemoveTimer</span>(<span class="built_in">CFRunLoopRef</span> rl, <span class="built_in">CFRunLoopTimerRef</span> timer, <span class="built_in">CFStringRef</span> mode);</div></pre></td></tr></table></figure>
<h4 id="RunLoopçš„Observers"><a href="#RunLoopçš„Observers" class="headerlink" title="RunLoopçš„Observers"></a>RunLoopçš„Observers</h4><p>å¯¹æ¯”ä¸Šé¢è¯´çš„äº‹ä»¶æºï¼Œå®ƒä»¬æ˜¯åœ¨ç‰¹å®šçš„åŒæ­¥äº‹ä»¶æˆ–å¼‚æ­¥äº‹ä»¶å‘ç”Ÿæ—¶è¢«è§¦å‘ï¼ŒRunLoop Observers å°±ä¸ä¸€æ ·äº†ï¼Œå®ƒæ˜¯åœ¨ RunLoop æ‰§è¡Œè‡ªå·±çš„ä»£ç åˆ°æŸä¸€ä¸ªæŒ‡å®šä½ç½®æ—¶è¢«è§¦å‘ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ RunLoop Observers æ¥è·Ÿè¸ªåˆ°è¿™äº›äº‹ä»¶ï¼š</p>
<ul>
<li>è¿›å…¥ RunLoop çš„æ—¶å€™</li>
<li>RunLoop å°†è¦å¤„ç†ä¸€ä¸ª Timer source çš„æ—¶å€™</li>
<li>RunLoop å°†è¦å¤„ç†ä¸€ä¸ª Input source çš„æ—¶å€™</li>
<li>RunLoop å°†è¦ä¼‘çœ çš„æ—¶å€™</li>
<li>RunLoop è¢«å”¤é†’ï¼Œå¹¶å‡†å¤‡å¤„ç†å”¤é†’å®ƒçš„äº‹ä»¶çš„æ—¶å€™</li>
<li>RunLoop å°†è¦é€€å‡ºçš„æ—¶å€™</li>
</ul>
<h3 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h3><h4 id="Input-Source-1"><a href="#Input-Source-1" class="headerlink" title="Input Source"></a>Input Source</h4><h4 id="Timer-Source"><a href="#Timer-Source" class="headerlink" title="Timer Source"></a>Timer Source</h4><h4 id="Observers"><a href="#Observers" class="headerlink" title="Observers"></a>Observers</h4><p>è¿™å‡ ä¸ªæ–¹é¢çœ‹èµ·æ¥å¤ªéº»çƒ¦äº†ï¼Œè€Œä¸”çœŸçš„ç”¨ä¸åˆ°ï¼Œæ‰€ä»¥ä¸æƒ³çœ‹äº†ã€‚=ã€‚=55555ã€‚è´´å‡ ä¸ªä»‹ç»å¦‚ä½•ä½¿ç”¨çš„åšå®¢å§ï¼Œå¦‚æœçœŸçš„è¦ç”¨åˆ°äº†å†çœ‹ã€‚<br><a href="http://yangchao0033.github.io/blog/2016/01/18/runloop-5/" target="_blank" rel="external">RunLoopæ·±åº¦æ¢ç©¶ï¼ˆäº”ï¼‰</a><br><a href="http://blog.imemo8.com/2016/04/17/RunLoop/" target="_blank" rel="external">RunLoop</a><br><a href="http://chun.tips/blog/2014/10/20/zou-jin-run-loopde-shi-jie-%5B%3F%5D-:shi-yao-shi-run-loop%3F/" target="_blank" rel="external">èµ°è¿›Run Loopçš„ä¸–ç•Œ (ä¸€)ï¼šä»€ä¹ˆæ˜¯Run Loopï¼Ÿ</a><br><a href="https://www.dreamingwish.com/article/ios-multithread-program-runloop-the.html" target="_blank" rel="external">iOSå¤šçº¿ç¨‹ç¼–ç¨‹æŒ‡å—ï¼ˆä¸‰ï¼‰Run Loop</a><br>ç›¸å…³ä½¿ç”¨ Demo ä¹Ÿæ”¾åˆ° github ä¸Šäº†ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="å¤„ç†è¿‡ç¨‹"><a href="#å¤„ç†è¿‡ç¨‹" class="headerlink" title="å¤„ç†è¿‡ç¨‹"></a>å¤„ç†è¿‡ç¨‹</h3><p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_5.png?raw=true" alt="runloop_5"></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// ç”¨DefaultModeå¯åŠ¨</span></div><div class="line"><span class="keyword">void</span> <span class="built_in">CFRunLoopRun</span>(<span class="keyword">void</span>) &#123;</div><div class="line">    <span class="built_in">CFRunLoopRunSpecific</span>(<span class="built_in">CFRunLoopGetCurrent</span>(), kCFRunLoopDefaultMode, <span class="number">1.0e10</span>, <span class="literal">false</span>);</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="comment">/// ç”¨æŒ‡å®šçš„Modeå¯åŠ¨ï¼Œå…è®¸è®¾ç½®RunLoopè¶…æ—¶æ—¶é—´</span></div><div class="line"><span class="keyword">int</span> <span class="built_in">CFRunLoopRunInMode</span>(<span class="built_in">CFStringRef</span> modeName, <span class="built_in">CFTimeInterval</span> seconds, Boolean stopAfterHandle) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">CFRunLoopRunSpecific</span>(<span class="built_in">CFRunLoopGetCurrent</span>(), modeName, seconds, returnAfterSourceHandled);</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="comment">/// RunLoopçš„å®ç°</span></div><div class="line"><span class="keyword">int</span> <span class="built_in">CFRunLoopRunSpecific</span>(runloop, modeName, seconds, stopAfterHandle) &#123;</div><div class="line">    </div><div class="line">    <span class="comment">/// é¦–å…ˆæ ¹æ®modeNameæ‰¾åˆ°å¯¹åº”mode</span></div><div class="line">    <span class="built_in">CFRunLoopModeRef</span> currentMode = __CFRunLoopFindMode(runloop, modeName, <span class="literal">false</span>);</div><div class="line">    <span class="comment">/// å¦‚æœmodeé‡Œæ²¡æœ‰source/timer/observer, ç›´æ¥è¿”å›ã€‚</span></div><div class="line">    <span class="keyword">if</span> (__CFRunLoopModeIsEmpty(currentMode)) <span class="keyword">return</span>;</div><div class="line">    </div><div class="line">    <span class="comment">/// 1. é€šçŸ¥ Observers: RunLoop å³å°†è¿›å…¥ loopã€‚</span></div><div class="line">    __CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopEntry);</div><div class="line">    </div><div class="line">    <span class="comment">/// å†…éƒ¨å‡½æ•°ï¼Œè¿›å…¥loop</span></div><div class="line">    __CFRunLoopRun(runloop, currentMode, seconds, returnAfterSourceHandled) &#123;</div><div class="line">        </div><div class="line">        Boolean sourceHandledThisLoop = <span class="literal">NO</span>;</div><div class="line">        <span class="keyword">int</span> retVal = <span class="number">0</span>;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line"> </div><div class="line">            <span class="comment">/// 2. é€šçŸ¥ Observers: RunLoop å³å°†è§¦å‘ Timer å›è°ƒã€‚</span></div><div class="line">            __CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopBeforeTimers);</div><div class="line">            <span class="comment">/// 3. é€šçŸ¥ Observers: RunLoop å³å°†è§¦å‘ Source0 (éport) å›è°ƒã€‚</span></div><div class="line">            __CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopBeforeSources);</div><div class="line">            <span class="comment">/// æ‰§è¡Œè¢«åŠ å…¥çš„block</span></div><div class="line">            __CFRunLoopDoBlocks(runloop, currentMode);</div><div class="line">            </div><div class="line">            <span class="comment">/// 4. RunLoop è§¦å‘ Source0 (éport) å›è°ƒã€‚</span></div><div class="line">            sourceHandledThisLoop = __CFRunLoopDoSources0(runloop, currentMode, stopAfterHandle);</div><div class="line">            <span class="comment">/// æ‰§è¡Œè¢«åŠ å…¥çš„block</span></div><div class="line">            __CFRunLoopDoBlocks(runloop, currentMode);</div><div class="line"> </div><div class="line">            <span class="comment">/// 5. å¦‚æœæœ‰ Source1 (åŸºäºport) å¤„äº ready çŠ¶æ€ï¼Œç›´æ¥å¤„ç†è¿™ä¸ª Source1 ç„¶åè·³è½¬å»å¤„ç†æ¶ˆæ¯ã€‚</span></div><div class="line">            <span class="keyword">if</span> (__Source0DidDispatchPortLastTime) &#123;</div><div class="line">                Boolean hasMsg = __CFRunLoopServiceMachPort(dispatchPort, &amp;msg)</div><div class="line">                <span class="keyword">if</span> (hasMsg) <span class="keyword">goto</span> handle_msg;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">/// é€šçŸ¥ Observers: RunLoop çš„çº¿ç¨‹å³å°†è¿›å…¥ä¼‘çœ (sleep)ã€‚</span></div><div class="line">            <span class="keyword">if</span> (!sourceHandledThisLoop) &#123;</div><div class="line">                __CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopBeforeWaiting);</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">/// 7. è°ƒç”¨ mach_msg ç­‰å¾…æ¥å— mach_port çš„æ¶ˆæ¯ã€‚çº¿ç¨‹å°†è¿›å…¥ä¼‘çœ , ç›´åˆ°è¢«ä¸‹é¢æŸä¸€ä¸ªäº‹ä»¶å”¤é†’ã€‚</span></div><div class="line">            <span class="comment">/// â€¢ ä¸€ä¸ªåŸºäº port çš„Source çš„äº‹ä»¶ã€‚</span></div><div class="line">            <span class="comment">/// â€¢ ä¸€ä¸ª Timer åˆ°æ—¶é—´äº†</span></div><div class="line">            <span class="comment">/// â€¢ RunLoop è‡ªèº«çš„è¶…æ—¶æ—¶é—´åˆ°äº†</span></div><div class="line">            <span class="comment">/// â€¢ è¢«å…¶ä»–ä»€ä¹ˆè°ƒç”¨è€…æ‰‹åŠ¨å”¤é†’</span></div><div class="line">            __CFRunLoopServiceMachPort(waitSet, &amp;msg, <span class="keyword">sizeof</span>(msg_buffer), &amp;livePort) &#123;</div><div class="line">                mach_msg(msg, MACH_RCV_MSG, port); <span class="comment">// thread wait for receive msg</span></div><div class="line">            &#125;</div><div class="line"> </div><div class="line">            <span class="comment">/// 8. é€šçŸ¥ Observers: RunLoop çš„çº¿ç¨‹åˆšåˆšè¢«å”¤é†’äº†ã€‚</span></div><div class="line">            __CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopAfterWaiting);</div><div class="line">            </div><div class="line">            <span class="comment">/// æ”¶åˆ°æ¶ˆæ¯ï¼Œå¤„ç†æ¶ˆæ¯ã€‚</span></div><div class="line">            handle_msg:</div><div class="line"> </div><div class="line">            <span class="comment">/// 9.1 å¦‚æœä¸€ä¸ª Timer åˆ°æ—¶é—´äº†ï¼Œè§¦å‘è¿™ä¸ªTimerçš„å›è°ƒã€‚</span></div><div class="line">            <span class="keyword">if</span> (msg_is_timer) &#123;</div><div class="line">                __CFRunLoopDoTimers(runloop, currentMode, mach_absolute_time())</div><div class="line">            &#125; </div><div class="line"> </div><div class="line">            <span class="comment">/// 9.2 å¦‚æœæœ‰dispatchåˆ°main_queueçš„blockï¼Œæ‰§è¡Œblockã€‚</span></div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (msg_is_dispatch) &#123;</div><div class="line">                __CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__(msg);</div><div class="line">            &#125; </div><div class="line"> </div><div class="line">            <span class="comment">/// 9.3 å¦‚æœä¸€ä¸ª Source1 (åŸºäºport) å‘å‡ºäº‹ä»¶äº†ï¼Œå¤„ç†è¿™ä¸ªäº‹ä»¶</span></div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                <span class="built_in">CFRunLoopSourceRef</span> source1 = __CFRunLoopModeFindSourceForMachPort(runloop, currentMode, livePort);</div><div class="line">                sourceHandledThisLoop = __CFRunLoopDoSource1(runloop, currentMode, source1, msg);</div><div class="line">                <span class="keyword">if</span> (sourceHandledThisLoop) &#123;</div><div class="line">                    mach_msg(reply, MACH_SEND_MSG, reply);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">/// æ‰§è¡ŒåŠ å…¥åˆ°Loopçš„block</span></div><div class="line">            __CFRunLoopDoBlocks(runloop, currentMode);</div><div class="line">            </div><div class="line"> </div><div class="line">            <span class="keyword">if</span> (sourceHandledThisLoop &amp;&amp; stopAfterHandle) &#123;</div><div class="line">                <span class="comment">/// è¿›å…¥loopæ—¶å‚æ•°è¯´å¤„ç†å®Œäº‹ä»¶å°±è¿”å›ã€‚</span></div><div class="line">                retVal = kCFRunLoopRunHandledSource;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (timeout) &#123;</div><div class="line">                <span class="comment">/// è¶…å‡ºä¼ å…¥å‚æ•°æ ‡è®°çš„è¶…æ—¶æ—¶é—´äº†</span></div><div class="line">                retVal = kCFRunLoopRunTimedOut;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (__CFRunLoopIsStopped(runloop)) &#123;</div><div class="line">                <span class="comment">/// è¢«å¤–éƒ¨è°ƒç”¨è€…å¼ºåˆ¶åœæ­¢äº†</span></div><div class="line">                retVal = kCFRunLoopRunStopped;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (__CFRunLoopModeIsEmpty(runloop, currentMode)) &#123;</div><div class="line">                <span class="comment">/// source/timer/observerä¸€ä¸ªéƒ½æ²¡æœ‰äº†</span></div><div class="line">                retVal = kCFRunLoopRunFinished;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">/// å¦‚æœæ²¡è¶…æ—¶ï¼Œmodeé‡Œæ²¡ç©ºï¼Œloopä¹Ÿæ²¡è¢«åœæ­¢ï¼Œé‚£ç»§ç»­loopã€‚</span></div><div class="line">        &#125; <span class="keyword">while</span> (retVal == <span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// 10. é€šçŸ¥ Observers: RunLoop å³å°†é€€å‡ºã€‚</span></div><div class="line">    __CFRunLoopDoObservers(rl, currentMode, kCFRunLoopExit);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå®é™…ä¸Š RunLoop å°±æ˜¯è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œå…¶å†…éƒ¨æ˜¯ä¸€ä¸ª do-while å¾ªç¯ã€‚å½“ä½ è°ƒç”¨ CFRunLoopRun() æ—¶ï¼Œçº¿ç¨‹å°±ä¼šä¸€ç›´åœç•™åœ¨è¿™ä¸ªå¾ªç¯é‡Œï¼›ç›´åˆ°è¶…æ—¶æˆ–è¢«æ‰‹åŠ¨åœæ­¢ï¼Œè¯¥å‡½æ•°æ‰ä¼šè¿”å›ã€‚</p>
<h3 id="RunLoop-çš„åº•å±‚å®ç°"><a href="#RunLoop-çš„åº•å±‚å®ç°" class="headerlink" title="RunLoop çš„åº•å±‚å®ç°"></a>RunLoop çš„åº•å±‚å®ç°</h3><p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°ï¼ŒRunLoop çš„æ ¸å¿ƒæ˜¯åŸºäº mach port çš„ï¼Œå…¶è¿›å…¥ä¼‘çœ æ—¶è°ƒç”¨çš„å‡½æ•°æ˜¯ <code>mach_msg()</code>ã€‚ä¸ºäº†å®ç°æ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶ï¼Œ<code>mach_msg()</code> å‡½æ•°å®é™…ä¸Šæ˜¯è°ƒç”¨äº†ä¸€ä¸ª Mach é™·é˜± (trap)ï¼Œå³å‡½æ•° <code>mach_msg_trap()</code>ï¼Œé™·é˜±è¿™ä¸ªæ¦‚å¿µåœ¨ Mach ä¸­ç­‰åŒäºç³»ç»Ÿè°ƒç”¨ã€‚å½“ä½ åœ¨ç”¨æˆ·æ€è°ƒç”¨ <code>mach_msg_trap()</code> æ—¶ä¼šè§¦å‘é™·é˜±æœºåˆ¶ï¼Œåˆ‡æ¢åˆ°å†…æ ¸æ€ï¼›å†…æ ¸æ€ä¸­å†…æ ¸å®ç°çš„ <code>mach_msg()</code> å‡½æ•°ä¼šå®Œæˆå®é™…çš„å·¥ä½œï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_6.png?raw=true" alt="runloop_6"></p>
<p><strong>RunLoop çš„æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ª <code>mach_msg()</code>ï¼ŒRunLoop è°ƒç”¨è¿™ä¸ªå‡½æ•°å»æ¥æ”¶æ¶ˆæ¯ï¼Œå¦‚æœæ²¡æœ‰åˆ«äººå‘é€ port æ¶ˆæ¯è¿‡æ¥ï¼Œå†…æ ¸ä¼šå°†çº¿ç¨‹ç½®äºç­‰å¾…çŠ¶æ€ã€‚ä¾‹å¦‚ä½ åœ¨æ¨¡æ‹Ÿå™¨é‡Œè·‘èµ·ä¸€ä¸ª iOS çš„ Appï¼Œç„¶ååœ¨ App é™æ­¢æ—¶ç‚¹å‡»æš‚åœï¼Œä½ ä¼šçœ‹åˆ°ä¸»çº¿ç¨‹è°ƒç”¨æ ˆæ˜¯åœç•™åœ¨ <code>mach_msg_trap()</code> è¿™ä¸ªåœ°æ–¹ã€‚</strong></p>
<p>å…³äºå…·ä½“çš„å¦‚ä½•åˆ©ç”¨ mach port å‘é€ä¿¡æ¯ï¼Œå“ˆå“ˆï¼Œè¿™ä¸ªå°±ä¸æ˜¯æˆ‘ç ”ç©¶çš„ä¸œè¥¿äº†ã€‚</p>
<h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><p>è‹¹æœä½¿ç”¨ RunLoop å®ç°äº†è¯¸å¤šåŠŸèƒ½</p>
<h3 id="AutoreleasePool"><a href="#AutoreleasePool" class="headerlink" title="AutoreleasePool"></a>AutoreleasePool</h3><p>Autorelease å¯¹è±¡ä»€ä¹ˆæ—¶å€™é‡Šæ”¾ï¼Ÿç­”æ¡ˆå½“ç„¶ä¸æ˜¯â€œå½“å‰ä½œç”¨åŸŸå¤§æ‹¬å·ç»“æŸæ—¶é‡Šæ”¾â€ã€‚åœ¨æ²¡æœ‰æ‰‹åŠ  Autorelease Pool çš„æƒ…å†µä¸‹ï¼ŒAutorelease å¯¹è±¡æ˜¯åœ¨å½“å‰çš„ runloop è¿­ä»£ç»“æŸæ—¶é‡Šæ”¾çš„ï¼Œè€Œå®ƒèƒ½å¤Ÿé‡Šæ”¾çš„åŸå› æ˜¯ç³»ç»Ÿåœ¨æ¯ä¸ª runloop è¿­ä»£ä¸­éƒ½åŠ å…¥äº†è‡ªåŠ¨é‡Šæ”¾æ±  Push å’Œ Popã€‚</p>
<h4 id="ä¸€ä¸ªä¾‹å­"><a href="#ä¸€ä¸ªä¾‹å­" class="headerlink" title="ä¸€ä¸ªä¾‹å­"></a>ä¸€ä¸ªä¾‹å­</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">__<span class="keyword">weak</span> <span class="keyword">id</span> reference = <span class="literal">nil</span>;</div><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    <span class="built_in">NSString</span> *str = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"sunnyxx"</span>];</div><div class="line">    <span class="comment">// stræ˜¯ä¸€ä¸ªautoreleaseå¯¹è±¡ï¼Œè®¾ç½®ä¸€ä¸ªweakçš„å¼•ç”¨æ¥è§‚å¯Ÿå®ƒ</span></div><div class="line">    reference = str;</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)viewWillAppear:(<span class="built_in">BOOL</span>)animated &#123;</div><div class="line">    [<span class="keyword">super</span> viewWillAppear:animated];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, reference); <span class="comment">// Console: sunnyxx</span></div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)viewDidAppear:(<span class="built_in">BOOL</span>)animated &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidAppear:animated];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, reference); <span class="comment">// Console: (null)</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ <code>viewDidLoad</code> æ–¹æ³•åï¼Œä¸€ç›´åˆ° <code>viewWillAppear</code> å­—ç¬¦ä¸² reference éƒ½æ²¡æœ‰è¢«é”€æ¯ï¼Œç›´åˆ° <code>viewDidAppear</code> æ–¹æ³•åï¼Œæ‰ç½®ä¸º <code>null</code>(è¿™é‡Œåˆ›å»ºå­—ç¬¦ä¸²ç”¨çš„æ˜¯ <code>stringWithFormat</code>ï¼Œæ˜¯åœ¨å †ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯åœ¨å¸¸é‡åŒº)ã€‚ç”±äºè¿™ä¸ª vc åœ¨ <code>loadView</code> ä¹‹åä¾¿ add åˆ°äº† window å±‚çº§ä¸Šï¼Œæ‰€ä»¥ <code>viewDidLoad</code> å’Œ <code>viewWillAppear</code> æ˜¯åœ¨åŒä¸€ä¸ª <code>runloop</code> è°ƒç”¨çš„ï¼Œå› æ­¤åœ¨ <code>viewWillAppear</code> ä¸­ï¼Œè¿™ä¸ª autorelease çš„å˜é‡ä¾ç„¶æœ‰å€¼ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨å¹²é¢„Autoreleaseå¯¹è±¡çš„é‡Šæ”¾æ—¶æœºï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        <span class="built_in">NSString</span> *str = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"sunnyxx"</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, str); <span class="comment">// Console: (null)</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="AutoreleasePool-åŸç†"><a href="#AutoreleasePool-åŸç†" class="headerlink" title="AutoreleasePool åŸç†"></a>AutoreleasePool åŸç†</h4><p>ARCä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>@autoreleasepool{}</code> æ¥ä½¿ç”¨ä¸€ä¸ª AutoreleasePoolï¼Œéšåç¼–è¯‘å™¨å°†å…¶æ”¹å†™æˆä¸‹é¢çš„æ ·å­ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> *context = objc_autoreleasePoolPush();</div><div class="line"><span class="comment">// &#123;&#125;ä¸­çš„ä»£ç </span></div><div class="line">objc_autoreleasePoolPop(context);</div></pre></td></tr></table></figure>
<p>è€Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯å¯¹ <code>AutoreleasePoolPage</code> çš„ç®€å•å°è£…ï¼Œæ‰€ä»¥è‡ªåŠ¨é‡Šæ”¾æœºåˆ¶çš„æ ¸å¿ƒå°±åœ¨äºè¿™ä¸ªç±»ã€‚</p>
<p><code>AutoreleasePoolPage</code> æ˜¯ä¸€ä¸ª C++ å®ç°çš„ç±»<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_7.png?raw=true" alt="runloop_7"></p>
<ul>
<li>AutoreleasePool å¹¶æ²¡æœ‰å•ç‹¬çš„ç»“æ„ï¼Œè€Œæ˜¯ç”±è‹¥å¹²ä¸ª AutoreleasePoolPage ä»¥åŒå‘é“¾è¡¨çš„å½¢å¼ç»„åˆè€Œæˆï¼ˆåˆ†åˆ«å¯¹åº”ç»“æ„ä¸­çš„ parent æŒ‡é’ˆå’Œ child æŒ‡é’ˆï¼‰</li>
<li>AutoreleasePool æ˜¯æŒ‰çº¿ç¨‹ä¸€ä¸€å¯¹åº”çš„ï¼ˆç»“æ„ä¸­çš„ thread æŒ‡é’ˆæŒ‡å‘å½“å‰çº¿ç¨‹ï¼‰</li>
<li>AutoreleasePoolPage æ¯ä¸ªå¯¹è±¡ä¼šå¼€è¾Ÿ4096å­—èŠ‚å†…å­˜ï¼ˆä¹Ÿå°±æ˜¯è™šæ‹Ÿå†…å­˜ä¸€é¡µçš„å¤§å°ï¼‰ï¼Œé™¤äº†ä¸Šé¢çš„å®ä¾‹å˜é‡æ‰€å ç©ºé—´ï¼Œå‰©ä¸‹çš„ç©ºé—´å…¨éƒ¨ç”¨æ¥å‚¨å­˜ autorelease å¯¹è±¡çš„åœ°å€</li>
<li>ä¸Šé¢çš„ <code>id *next</code> æŒ‡é’ˆä½œä¸ºæ¸¸æ ‡æŒ‡å‘æ ˆé¡¶æœ€æ–° add è¿›æ¥çš„ autorelease å¯¹è±¡çš„ä¸‹ä¸€ä¸ªä½ç½®</li>
<li>ä¸€ä¸ª AutoreleasePoolPage çš„ç©ºé—´è¢«å æ»¡æ—¶ï¼Œä¼šæ–°å»ºä¸€ä¸ª AutoreleasePoolPage å¯¹è±¡ï¼Œè¿æ¥é“¾è¡¨ï¼Œåæ¥çš„ autorelease å¯¹è±¡åœ¨æ–°çš„ page åŠ å…¥</li>
</ul>
<p>æ‰€ä»¥ï¼Œè‹¥å½“å‰çº¿ç¨‹ä¸­åªæœ‰ä¸€ä¸ª AutoreleasePoolPage å¯¹è±¡ï¼Œå¹¶è®°å½•äº†å¾ˆå¤š autorelease å¯¹è±¡åœ°å€æ—¶å†…å­˜å¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_8.png?raw=true" alt="runloop_8"></p>
<p>å›¾ä¸­çš„æƒ…å†µï¼Œè¿™ä¸€é¡µå†åŠ å…¥ä¸€ä¸ª autorelease å¯¹è±¡å°±è¦æ»¡äº†ï¼ˆä¹Ÿå°±æ˜¯ next æŒ‡é’ˆé©¬ä¸ŠæŒ‡å‘æ ˆé¡¶ï¼‰ï¼Œè¿™æ—¶å°±è¦æ‰§è¡Œä¸Šé¢è¯´çš„æ“ä½œï¼Œå»ºç«‹ä¸‹ä¸€é¡µ page å¯¹è±¡ï¼Œä¸è¿™ä¸€é¡µé“¾è¡¨è¿æ¥å®Œæˆåï¼Œæ–°pageçš„nextæŒ‡é’ˆè¢«åˆå§‹åŒ–åœ¨æ ˆåº•ï¼ˆbeginçš„ä½ç½®ï¼‰ï¼Œç„¶åç»§ç»­å‘æ ˆé¡¶æ·»åŠ æ–°å¯¹è±¡ã€‚æ‰€ä»¥ï¼Œå‘ä¸€ä¸ªå¯¹è±¡å‘é€ <code>autorelease</code> æ¶ˆæ¯ï¼Œå°±æ˜¯å°†è¿™ä¸ªå¯¹è±¡åŠ å…¥åˆ°å½“å‰ AutoreleasePoolPage çš„æ ˆé¡¶ next æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ã€‚</p>
<p>æ¯å½“è¿›è¡Œä¸€æ¬¡ <code>objc_autoreleasePoolPush</code> è°ƒç”¨æ—¶ï¼Œruntime å‘å½“å‰çš„ AutoreleasePoolPage ä¸­ add è¿›ä¸€ä¸ªå“¨å…µå¯¹è±¡ï¼Œå€¼ä¸º0ï¼ˆä¹Ÿå°±æ˜¯ä¸ª nilï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸€ä¸ª page å°±å˜æˆäº†ä¸‹é¢çš„æ ·å­ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_9.png?raw=true" alt="runloop_9"></p>
<p><code>objc_autoreleasePoolPush</code> çš„è¿”å›å€¼æ­£æ˜¯è¿™ä¸ªå“¨å…µå¯¹è±¡çš„åœ°å€ï¼Œè¢« <code>objc_autoreleasePoolPop</code> (å“¨å…µå¯¹è±¡)ä½œä¸ºå…¥å‚ï¼Œäºæ˜¯ï¼š</p>
<ol>
<li>æ ¹æ®ä¼ å…¥çš„å“¨å…µå¯¹è±¡åœ°å€æ‰¾åˆ°å“¨å…µå¯¹è±¡æ‰€å¤„çš„ page</li>
<li>åœ¨å½“å‰ page ä¸­ï¼Œå°†æ™šäºå“¨å…µå¯¹è±¡æ’å…¥çš„æ‰€æœ‰ autorelease å¯¹è±¡éƒ½å‘é€ä¸€æ¬¡ <code>- release</code> æ¶ˆæ¯ï¼Œå¹¶å‘å›ç§»åŠ¨ next æŒ‡é’ˆåˆ°æ­£ç¡®ä½ç½®</li>
<li>è¡¥å……2ï¼šä»æœ€æ–°åŠ å…¥çš„å¯¹è±¡ä¸€ç›´å‘å‰æ¸…ç†ï¼Œå¯ä»¥å‘å‰è·¨è¶Šè‹¥å¹²ä¸ª pageï¼Œç›´åˆ°å“¨å…µæ‰€åœ¨çš„ page</li>
</ol>
<p>åˆšæ‰çš„ <code>objc_autoreleasePoolPop</code> æ‰§è¡Œåï¼Œæœ€ç»ˆå˜æˆäº†ä¸‹é¢çš„æ ·å­ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_10.png?raw=true" alt="runloop_10"></p>
<h3 id="äº‹ä»¶å“åº”"><a href="#äº‹ä»¶å“åº”" class="headerlink" title="äº‹ä»¶å“åº”"></a>äº‹ä»¶å“åº”</h3><p>è‹¹æœæ³¨å†Œäº†ä¸€ä¸ª Source1 (åŸºäº mach port çš„) ç”¨æ¥æ¥æ”¶ç³»ç»Ÿäº‹ä»¶ï¼Œå…¶å›è°ƒå‡½æ•°ä¸º <code>__IOHIDEventSystemClientQueueCallback()</code>ã€‚</p>
<p>å½“ä¸€ä¸ªç¡¬ä»¶äº‹ä»¶(è§¦æ‘¸/é”å±/æ‘‡æ™ƒç­‰)å‘ç”Ÿåï¼Œé¦–å…ˆç”± IOKit.framework ç”Ÿæˆä¸€ä¸ª IOHIDEvent äº‹ä»¶å¹¶ç”± SpringBoard æ¥æ”¶ã€‚ SpringBoard åªæ¥æ”¶æŒ‰é”®(é”å±/é™éŸ³ç­‰)ï¼Œè§¦æ‘¸ï¼ŒåŠ é€Ÿï¼Œæ¥è¿‘ä¼ æ„Ÿå™¨ç­‰å‡ ç§ Eventï¼Œéšåç”¨ mach port è½¬å‘ç»™éœ€è¦çš„ App è¿›ç¨‹ã€‚éšåè‹¹æœæ³¨å†Œçš„é‚£ä¸ª Source1 å°±ä¼šè§¦å‘å›è°ƒï¼Œå¹¶è°ƒç”¨ <code>_UIApplicationHandleEventQueue()</code> è¿›è¡Œåº”ç”¨å†…éƒ¨çš„åˆ†å‘ã€‚</p>
<p><code>_UIApplicationHandleEventQueue()</code> ä¼šæŠŠ IOHIDEvent å¤„ç†å¹¶åŒ…è£…æˆ UIEvent è¿›è¡Œå¤„ç†æˆ–åˆ†å‘ï¼Œå…¶ä¸­åŒ…æ‹¬è¯†åˆ« UIGesture/å¤„ç†å±å¹•æ—‹è½¬/å‘é€ç»™ UIWindow ç­‰ã€‚é€šå¸¸äº‹ä»¶æ¯”å¦‚ UIButton ç‚¹å‡»ã€touchesBegin/Move/End/Cancel äº‹ä»¶éƒ½æ˜¯åœ¨è¿™ä¸ªå›è°ƒä¸­å®Œæˆçš„ã€‚</p>
<h3 id="æ‰‹åŠ¿è¯†åˆ«"><a href="#æ‰‹åŠ¿è¯†åˆ«" class="headerlink" title="æ‰‹åŠ¿è¯†åˆ«"></a>æ‰‹åŠ¿è¯†åˆ«</h3><p>å½“ä¸Šé¢çš„ <code>_UIApplicationHandleEventQueue()</code> è¯†åˆ«äº†ä¸€ä¸ªæ‰‹åŠ¿æ—¶ï¼Œå…¶é¦–å…ˆä¼šè°ƒç”¨ Cancel å°†å½“å‰çš„ touchesBegin/Move/End ç³»åˆ—å›è°ƒæ‰“æ–­ã€‚éšåç³»ç»Ÿå°†å¯¹åº”çš„ UIGestureRecognizer æ ‡è®°ä¸ºå¾…å¤„ç†ã€‚</p>
<p>è‹¹æœæ³¨å†Œäº†ä¸€ä¸ª Observer ç›‘æµ‹ BeforeWaiting (Loop å³å°†è¿›å…¥ä¼‘çœ ) äº‹ä»¶ï¼Œè¿™ä¸ª Observer çš„å›è°ƒå‡½æ•°æ˜¯ <code>_UIGestureRecognizerUpdateObserver()</code>ï¼Œå…¶å†…éƒ¨ä¼šè·å–æ‰€æœ‰åˆšè¢«æ ‡è®°ä¸ºå¾…å¤„ç†çš„ GestureRecognizerï¼Œå¹¶æ‰§è¡Œ GestureRecognizer çš„å›è°ƒã€‚</p>
<p>å½“æœ‰ UIGestureRecognizer çš„å˜åŒ–(åˆ›å»º/é”€æ¯/çŠ¶æ€æ”¹å˜)æ—¶ï¼Œè¿™ä¸ªå›è°ƒéƒ½ä¼šè¿›è¡Œç›¸åº”å¤„ç†ã€‚</p>
<h3 id="ç•Œé¢æ›´æ–°"><a href="#ç•Œé¢æ›´æ–°" class="headerlink" title="ç•Œé¢æ›´æ–°"></a>ç•Œé¢æ›´æ–°</h3><p>å½“åœ¨æ“ä½œ UI æ—¶ï¼Œæ¯”å¦‚æ”¹å˜äº† Frameã€æ›´æ–°äº† UIView/CALayer çš„å±‚æ¬¡æ—¶ï¼Œæˆ–è€…æ‰‹åŠ¨è°ƒç”¨äº† UIView/CALayer çš„  <code>setNeedsLayout/setNeedsDisplay</code> æ–¹æ³•åï¼Œè¿™ä¸ª UIView/CALayer å°±è¢«æ ‡è®°ä¸ºå¾…å¤„ç†ï¼Œå¹¶è¢«æäº¤åˆ°ä¸€ä¸ªå…¨å±€çš„å®¹å™¨å»ã€‚</p>
<p>è‹¹æœæ³¨å†Œäº†ä¸€ä¸ª Observer ç›‘å¬ BeforeWaiting(å³å°†è¿›å…¥ä¼‘çœ ) å’Œ Exit (å³å°†é€€å‡ºLoop) äº‹ä»¶ï¼Œå›è°ƒå»æ‰§è¡Œä¸€ä¸ªå¾ˆé•¿çš„å‡½æ•°ï¼š<br><code>_ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv()</code> ã€‚è¿™ä¸ªå‡½æ•°é‡Œä¼šéå†æ‰€æœ‰å¾…å¤„ç†çš„ UIView/CAlayer ä»¥æ‰§è¡Œå®é™…çš„ç»˜åˆ¶å’Œè°ƒæ•´ï¼Œå¹¶æ›´æ–° UI ç•Œé¢ã€‚</p>
<p>è¿™ä¸ªå‡½æ•°å†…éƒ¨çš„è°ƒç”¨æ ˆå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv()</div><div class="line">    QuartzCore:CA::Transaction::observer_callback:</div><div class="line">        CA::Transaction::commit();</div><div class="line">            CA::Context::commit_transaction();</div><div class="line">                CA::Layer::layout_and_display_if_needed();</div><div class="line">                    CA::Layer::layout_if_needed();</div><div class="line">                        [<span class="built_in">CALayer</span> layoutSublayers];</div><div class="line">                            [<span class="built_in">UIView</span> layoutSubviews];</div><div class="line">                    CA::Layer::display_if_needed();</div><div class="line">                        [<span class="built_in">CALayer</span> display];</div><div class="line">                            [<span class="built_in">UIView</span> drawRect];</div></pre></td></tr></table></figure>
<h3 id="å®šæ—¶å™¨"><a href="#å®šæ—¶å™¨" class="headerlink" title="å®šæ—¶å™¨"></a>å®šæ—¶å™¨</h3><p>NSTimer å…¶å®å°±æ˜¯ CFRunLoopTimerRefï¼Œä»–ä»¬ä¹‹é—´æ˜¯ toll-free bridged çš„ã€‚ä¸€ä¸ª NSTimer æ³¨å†Œåˆ° RunLoop åï¼ŒRunLoop ä¼šä¸ºå…¶é‡å¤çš„æ—¶é—´ç‚¹æ³¨å†Œå¥½äº‹ä»¶ã€‚ä¾‹å¦‚ 10:00, 10:10, 10:20 è¿™å‡ ä¸ªæ—¶é—´ç‚¹ã€‚RunLoop ä¸ºäº†èŠ‚çœèµ„æºï¼Œå¹¶ä¸ä¼šåœ¨éå¸¸å‡†ç¡®çš„æ—¶é—´ç‚¹å›è°ƒè¿™ä¸ª Timerã€‚Timer æœ‰ä¸ªå±æ€§å«åš Tolerance (å®½å®¹åº¦)ï¼Œæ ‡ç¤ºäº†å½“æ—¶é—´ç‚¹åˆ°åï¼Œå®¹è®¸æœ‰å¤šå°‘æœ€å¤§è¯¯å·®ã€‚</p>
<p>å®šæ—¶å™¨ä½¿ç”¨æ–¹å¼ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">self</span>.timer = [<span class="built_in">NSTimer</span> timerWithTimeInterval:<span class="number">5</span> target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(showTime) userInfo:<span class="literal">nil</span> repeats:<span class="literal">YES</span>];</div><div class="line">[[<span class="built_in">NSRunLoop</span> currentRunLoop] addTimer:<span class="keyword">self</span>.timer forMode:<span class="built_in">NSRunLoopCommonModes</span>];</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå¦‚æœä¸æ˜¯ç”¨çš„ <code>NSRunLoopCommonModes</code> è€Œæ˜¯ <code>NSDefaultRunLoopMode</code> é‚£ä¹ˆå½“ç•Œé¢æ»‘åŠ¨æ—¶ï¼Œæ— æ³•æ‰§è¡Œ <code>showTime</code> æ–¹æ³•å›è°ƒã€‚å½“æ»‘åŠ¨åœæ­¢æ—¶ï¼Œç«‹åˆ»æ‰§è¡Œæœ€åˆçš„æ³¨å†Œçš„å®šæ—¶äº‹ä»¶ï¼Œä¹‹åç”±äºæ»‘åŠ¨å¯¼è‡´æœªèƒ½æ³¨å†Œçš„äº‹ä»¶çš„å›è°ƒä¸€å¾‹å¿½ç•¥ã€‚</p>
<h3 id="PerformSelector"><a href="#PerformSelector" class="headerlink" title="PerformSelector"></a>PerformSelector</h3><p>å½“è°ƒç”¨ NSObject çš„ <code>performSelector:afterDelay:</code> åï¼Œå®é™…ä¸Šå…¶å†…éƒ¨ä¼šåˆ›å»ºä¸€ä¸ª Timer å¹¶æ·»åŠ åˆ°å½“å‰çº¿ç¨‹çš„ Run Loop ä¸­ã€‚æ‰€ä»¥å¦‚æœå½“å‰çº¿ç¨‹æ²¡æœ‰ Run Loopï¼Œåˆ™è¿™ä¸ªæ–¹æ³•ä¼šå¤±æ•ˆã€‚</p>
<p>å½“è°ƒç”¨ <code>performSelector:onThread:</code> æ—¶ï¼Œå®é™…ä¸Šå…¶ä¼šåˆ›å»ºä¸€ä¸ª Timer åŠ åˆ°å¯¹åº”çš„çº¿ç¨‹å»ï¼ŒåŒæ ·çš„ï¼Œå¦‚æœå¯¹åº”çº¿ç¨‹æ²¡æœ‰ Run Loop è¯¥æ–¹æ³•ä¹Ÿä¼šå¤±æ•ˆã€‚</p>
<p>æ‰€ä»¥ä¸€èˆ¬è¿˜æ˜¯åœ¨ä¸»çº¿ç¨‹è°ƒç”¨è¿™äº›æ–¹æ³•ï¼Œå¦‚æœå®åœ¨è¦åœ¨å­çº¿ç¨‹é‡Œè°ƒç”¨ï¼Œé‚£ä¹ˆè®°å¾—åœ¨å…¶åè°ƒç”¨ <code>[[NSRunLoop currentRunLoop] run];</code></p>
<h3 id="å…³äº-GCD"><a href="#å…³äº-GCD" class="headerlink" title="å…³äº GCD"></a>å…³äº GCD</h3><p>GCD æä¾›çš„æŸäº›æ¥å£ä¹Ÿç”¨åˆ°äº† Run Loopï¼Œ ä¾‹å¦‚ <code>dispatch_async()</code>ã€‚</p>
<p>å½“è°ƒç”¨ <code>dispatch_async(dispatch_get_main_queue(), block)</code> æ—¶ï¼ŒlibDispatch ä¼šå‘ä¸»çº¿ç¨‹çš„ RunLoop å‘é€æ¶ˆæ¯ï¼ŒRunLoop ä¼šè¢«å”¤é†’ï¼Œå¹¶ä»æ¶ˆæ¯ä¸­å–å¾—è¿™ä¸ª blockï¼Œå¹¶åœ¨å›è°ƒ <code>__CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__()</code> é‡Œæ‰§è¡Œè¿™ä¸ª blockã€‚ä½†è¿™ä¸ªé€»è¾‘ä»…é™äº dispatch åˆ°ä¸»çº¿ç¨‹ï¼Œdispatch åˆ°å…¶ä»–çº¿ç¨‹ä»ç„¶æ˜¯ç”± libDispatch å¤„ç†çš„ã€‚</p>
<h3 id="å…³äºç½‘ç»œè¯·æ±‚"><a href="#å…³äºç½‘ç»œè¯·æ±‚" class="headerlink" title="å…³äºç½‘ç»œè¯·æ±‚"></a>å…³äºç½‘ç»œè¯·æ±‚</h3><p>iOS ä¸­ï¼Œå…³äºç½‘ç»œè¯·æ±‚çš„æ¥å£è‡ªä¸‹è‡³ä¸Šæœ‰å¦‚ä¸‹å‡ å±‚:</p>
<ul>
<li>CFSocket</li>
<li>CFNetwork       -&gt;ASIHttpRequest</li>
<li>NSURLConnection -&gt;AFNetworking</li>
<li>NSURLSession    -&gt;AFNetworking2, Alamofire</li>
</ul>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runloop_11.png?raw=true" alt="runloop_11"></p>
<p>NSURLConnectionLoader ä¸­çš„ RunLoop é€šè¿‡ä¸€äº›åŸºäº mach port çš„ Source æ¥æ”¶æ¥è‡ªåº•å±‚ CFSocket çš„é€šçŸ¥ã€‚å½“æ”¶åˆ°é€šçŸ¥åï¼Œå…¶ä¼šåœ¨åˆé€‚çš„æ—¶æœºå‘ CFMultiplexerSource ç­‰ Source0 å‘é€é€šçŸ¥ï¼ŒåŒæ—¶å”¤é†’ Delegate çº¿ç¨‹çš„ RunLoop æ¥è®©å…¶å¤„ç†è¿™äº›é€šçŸ¥ã€‚CFMultiplexerSource ä¼šåœ¨ Delegate çº¿ç¨‹çš„ RunLoop å¯¹ Delegate æ‰§è¡Œå®é™…çš„å›è°ƒã€‚</p>
<h3 id="AFNetworking"><a href="#AFNetworking" class="headerlink" title="AFNetworking"></a>AFNetworking</h3><p>AFURLConnectionOperation è¿™ä¸ªç±»æ˜¯åŸºäº NSURLConnection æ„å»ºçš„ï¼Œå…¶å¸Œæœ›èƒ½åœ¨åå°çº¿ç¨‹æ¥æ”¶ Delegate å›è°ƒã€‚ä¸ºæ­¤ AFNetworking å•ç‹¬åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶åœ¨è¿™ä¸ªçº¿ç¨‹ä¸­å¯åŠ¨äº†ä¸€ä¸ª RunLoopï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)networkRequestThreadEntryPoint:(<span class="keyword">id</span>)__unused object &#123;</div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        [[<span class="built_in">NSThread</span> currentThread] setName:<span class="string">@"AFNetworking"</span>];</div><div class="line">        <span class="built_in">NSRunLoop</span> *runLoop = [<span class="built_in">NSRunLoop</span> currentRunLoop];</div><div class="line">        [runLoop addPort:[<span class="built_in">NSMachPort</span> port] forMode:<span class="built_in">NSDefaultRunLoopMode</span>];</div><div class="line">        [runLoop run];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">+ (<span class="built_in">NSThread</span> *)networkRequestThread &#123;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">NSThread</span> *_networkRequestThread = <span class="literal">nil</span>;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> oncePredicate;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;oncePredicate, ^&#123;</div><div class="line">        _networkRequestThread = [[<span class="built_in">NSThread</span> alloc] initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(networkRequestThreadEntryPoint:) object:<span class="literal">nil</span>];</div><div class="line">        [_networkRequestThread start];</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> _networkRequestThread;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>RunLoop å¯åŠ¨å‰å†…éƒ¨å¿…é¡»è¦æœ‰è‡³å°‘ä¸€ä¸ª Timer/Observer/Sourceï¼Œæ‰€ä»¥ AFNetworking åœ¨ <code>[runLoop run]</code> ä¹‹å‰å…ˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ NSMachPort æ·»åŠ è¿›å»äº†ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè°ƒç”¨è€…éœ€è¦æŒæœ‰è¿™ä¸ª <code>NSMachPort (mach_port)</code> å¹¶åœ¨å¤–éƒ¨çº¿ç¨‹é€šè¿‡è¿™ä¸ª port å‘é€æ¶ˆæ¯åˆ° loop å†…ï¼›ä½†æ­¤å¤„æ·»åŠ  port åªæ˜¯ä¸ºäº†è®© RunLoop ä¸è‡³äºé€€å‡ºï¼Œå¹¶æ²¡æœ‰ç”¨äºå®é™…çš„å‘é€æ¶ˆæ¯ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)start &#123;</div><div class="line">    [<span class="keyword">self</span>.lock lock];</div><div class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span> isCancelled]) &#123;</div><div class="line">        [<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(cancelConnection) onThread:[[<span class="keyword">self</span> <span class="keyword">class</span>] networkRequestThread] withObject:<span class="literal">nil</span> waitUntilDone:<span class="literal">NO</span> modes:[<span class="keyword">self</span>.runLoopModes allObjects]];</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([<span class="keyword">self</span> isReady]) &#123;</div><div class="line">        <span class="keyword">self</span>.state = AFOperationExecutingState;</div><div class="line">        [<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(operationDidStart) onThread:[[<span class="keyword">self</span> <span class="keyword">class</span>] networkRequestThread] withObject:<span class="literal">nil</span> waitUntilDone:<span class="literal">NO</span> modes:[<span class="keyword">self</span>.runLoopModes allObjects]];</div><div class="line">    &#125;</div><div class="line">    [<span class="keyword">self</span>.lock unlock];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“éœ€è¦è¿™ä¸ªåå°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡æ—¶ï¼ŒAFNetworking é€šè¿‡è°ƒç”¨ <code>[NSObject performSelector:onThread:..]</code> å°†è¿™ä¸ªä»»åŠ¡æ‰”åˆ°äº†åå°çº¿ç¨‹çš„ RunLoop ä¸­ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="http://blog.sunnyxx.com/2014/10/15/behind-autorelease/" target="_blank" rel="external">é»‘å¹•èƒŒåçš„Autorelease</a><br><a href="http://itangqi.me/2016/04/14/the-first-meet-with-runloop/?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">åˆè¯† Run Loop</a><br><a href="http://blog.ibireme.com/2015/05/18/runloop/" target="_blank" rel="external">æ·±å…¥ç†è§£RunLoop</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iOSä¸­çš„å¤šçº¿ç¨‹å­¦ä¹ ç¬”è®°]]></title>
      <url>http://zhang759740844.github.io/2016/11/01/iOS%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<p>åœ¨å­¦ä¹  RunLoop çš„æ—¶å€™ï¼Œç¢°åˆ°äº†ä¸€äº›ä¸å¤ªç†è§£çš„ä¸œè¥¿ï¼ŒæŸ¥é˜…èµ„æ–™åå‘ç°æ˜¯å¤šçº¿ç¨‹çš„ç›¸å…³æ–¹æ³•ã€‚å› æ­¤åœ¨å®Œæˆ RunLoop çš„ç¬”è®°å‰ï¼Œå…ˆå­¦ä¹ ä¸‹å¤šçº¿ç¨‹çš„ä½¿ç”¨æ–¹æ³•ã€‚<br><a id="more"></a></p>
<p>å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼å®ç° iOS çš„å¤šçº¿ç¨‹ï¼š</p>
<ul>
<li>NSThread</li>
<li>GCD</li>
<li>NSOperation&amp;NSOperationQueue</li>
</ul>
<h2 id="NSThread"><a href="#NSThread" class="headerlink" title="NSThread"></a>NSThread</h2><h3 id="åˆ›å»ºå¹¶å¯åŠ¨"><a href="#åˆ›å»ºå¹¶å¯åŠ¨" class="headerlink" title="åˆ›å»ºå¹¶å¯åŠ¨"></a>åˆ›å»ºå¹¶å¯åŠ¨</h3><h4 id="å…ˆåˆ›å»ºçº¿ç¨‹ç±»ï¼Œå†å¯åŠ¨"><a href="#å…ˆåˆ›å»ºçº¿ç¨‹ç±»ï¼Œå†å¯åŠ¨" class="headerlink" title="å…ˆåˆ›å»ºçº¿ç¨‹ç±»ï¼Œå†å¯åŠ¨"></a>å…ˆåˆ›å»ºçº¿ç¨‹ç±»ï¼Œå†å¯åŠ¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åˆ›å»º</span></div><div class="line"><span class="built_in">NSThread</span> *thread = [[<span class="built_in">NSThread</span> alloc] initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(run:) object:<span class="literal">nil</span>];</div><div class="line"><span class="comment">// å¯åŠ¨</span></div><div class="line">[thread start];</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>run:</code> æ˜¯å³å°†æ‰§è¡Œçš„æ–¹æ³•ï¼Œ<code>object</code> æ˜¯ <code>run:</code> æ–¹æ³•çš„å‚æ•°ã€‚è§„å®š <code>run:</code> æ–¹æ³•æœ€å¤šå¯æœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¸”è¿”å›ç±»å‹å¿…é¡»æ˜¯ <code>void</code>ã€‚</p>
<h4 id="åˆ›å»ºå¹¶è‡ªåŠ¨å¯åŠ¨"><a href="#åˆ›å»ºå¹¶è‡ªåŠ¨å¯åŠ¨" class="headerlink" title="åˆ›å»ºå¹¶è‡ªåŠ¨å¯åŠ¨"></a>åˆ›å»ºå¹¶è‡ªåŠ¨å¯åŠ¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="built_in">NSThread</span> detachNewThreadSelector:<span class="keyword">@selector</span>(run:) toTarget:<span class="keyword">self</span> withObject:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨-NSObject-çš„æ–¹æ³•åˆ›å»ºå¹¶è‡ªåŠ¨å¯åŠ¨"><a href="#ä½¿ç”¨-NSObject-çš„æ–¹æ³•åˆ›å»ºå¹¶è‡ªåŠ¨å¯åŠ¨" class="headerlink" title="ä½¿ç”¨ NSObject çš„æ–¹æ³•åˆ›å»ºå¹¶è‡ªåŠ¨å¯åŠ¨"></a>ä½¿ç”¨ NSObject çš„æ–¹æ³•åˆ›å»ºå¹¶è‡ªåŠ¨å¯åŠ¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="keyword">self</span> performSelectorInBackground:<span class="keyword">@selector</span>(run:) withObject:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<h3 id="å…¶ä»–æ–¹æ³•"><a href="#å…¶ä»–æ–¹æ³•" class="headerlink" title="å…¶ä»–æ–¹æ³•"></a>å…¶ä»–æ–¹æ³•</h3><p>é™¤äº†åˆ›å»ºå¯åŠ¨å¤–ï¼ŒNSThread è¿˜ä»¥å¾ˆå¤šæ–¹æ³•ï¼Œä¸‹é¢æˆ‘åˆ—ä¸¾ä¸€äº›å¸¸è§çš„æ–¹æ³•ï¼Œå½“ç„¶æˆ‘åˆ—ä¸¾çš„å¹¶ä¸å®Œæ•´ï¼Œæ›´å¤šæ–¹æ³•å¯ä»¥å»ç±»çš„å®šä¹‰é‡Œå»çœ‹ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å–æ¶ˆçº¿ç¨‹</span></div><div class="line">- (<span class="keyword">void</span>)cancel;</div><div class="line"></div><div class="line"><span class="comment">//å¯åŠ¨çº¿ç¨‹</span></div><div class="line">- (<span class="keyword">void</span>)start;</div><div class="line"></div><div class="line"><span class="comment">//åˆ¤æ–­æŸä¸ªçº¿ç¨‹çš„çŠ¶æ€çš„å±æ€§</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isExecuting) <span class="built_in">BOOL</span> executing;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isFinished) <span class="built_in">BOOL</span> finished;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">getter</span>=isCancelled) <span class="built_in">BOOL</span> cancelled;</div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®å’Œè·å–çº¿ç¨‹åå­—</span></div><div class="line">-(<span class="keyword">void</span>)setName:(<span class="built_in">NSString</span> *)n;</div><div class="line">-(<span class="built_in">NSString</span> *)name;</div><div class="line"></div><div class="line"><span class="comment">//è·å–å½“å‰çº¿ç¨‹ä¿¡æ¯</span></div><div class="line">+ (<span class="built_in">NSThread</span> *)currentThread;</div><div class="line"></div><div class="line"><span class="comment">//è·å–ä¸»çº¿ç¨‹ä¿¡æ¯</span></div><div class="line">+ (<span class="built_in">NSThread</span> *)mainThread;</div><div class="line"></div><div class="line"><span class="comment">//ä½¿å½“å‰çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´ï¼Œæˆ–è€…æš‚åœåˆ°æŸä¸ªæ—¶åˆ»</span></div><div class="line">+ (<span class="keyword">void</span>)sleepForTimeInterval:(<span class="built_in">NSTimeInterval</span>)time;</div><div class="line">+ (<span class="keyword">void</span>)sleepUntilDate:(<span class="built_in">NSDate</span> *)date;</div></pre></td></tr></table></figure>
<h2 id="GCD"><a href="#GCD" class="headerlink" title="GCD"></a>GCD</h2><p>è¯¥éƒ¨åˆ†å‰ä¸€ç¯‡å…³äº GCD çš„æ–‡ç« å·²ç»è¾ƒä¸ºè¯¦ç»†çš„ç ”ç©¶è¿‡äº†ã€‚</p>
<h2 id="NSOperation"><a href="#NSOperation" class="headerlink" title="NSOperation"></a>NSOperation</h2><p>æš‚æ—¶æ²¡æœ‰æ—¶é—´çœ‹ï¼Œå…ˆå ä¸ªå‘</p>
<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><h3 id="çº¿ç¨‹åŒæ­¥"><a href="#çº¿ç¨‹åŒæ­¥" class="headerlink" title="çº¿ç¨‹åŒæ­¥"></a>çº¿ç¨‹åŒæ­¥</h3><h4 id="äº’æ–¥é”"><a href="#äº’æ–¥é”" class="headerlink" title="äº’æ–¥é”"></a>äº’æ–¥é”</h4><p>ä½¿ç”¨ <code>@synchronized</code>:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@synchronized</span>(<span class="keyword">self</span>) &#123;</div><div class="line">    <span class="comment">//éœ€è¦æ‰§è¡Œçš„ä»£ç å—</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="åŒæ­¥æ‰§è¡Œ"><a href="#åŒæ­¥æ‰§è¡Œ" class="headerlink" title="åŒæ­¥æ‰§è¡Œ"></a>åŒæ­¥æ‰§è¡Œ</h4><p>æŠŠå¤šä¸ªçº¿ç¨‹éƒ½è¦æ‰§è¡Œæ­¤æ®µä»£ç æ·»åŠ åˆ°åŒä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ï¼Œè¿™æ ·å°±å®ç°äº†çº¿ç¨‹åŒæ­¥çš„æ¦‚å¿µã€‚</p>
<h3 id="å»¶è¿Ÿæ‰§è¡Œ"><a href="#å»¶è¿Ÿæ‰§è¡Œ" class="headerlink" title="å»¶è¿Ÿæ‰§è¡Œ"></a>å»¶è¿Ÿæ‰§è¡Œ</h3><h4 id="perform"><a href="#perform" class="headerlink" title="perform"></a>perform</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 3ç§’åè‡ªåŠ¨è°ƒç”¨selfçš„run:æ–¹æ³•ï¼Œå¹¶ä¸”ä¼ é€’å‚æ•°ï¼š@"abc"</span></div><div class="line">[<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(run:) withObject:<span class="string">@"abc"</span> afterDelay:<span class="number">3</span>];</div></pre></td></tr></table></figure>
<h4 id="GCD-1"><a href="#GCD-1" class="headerlink" title="GCD"></a>GCD</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åˆ›å»ºé˜Ÿåˆ—</span></div><div class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</div><div class="line"><span class="comment">// è®¾ç½®å»¶æ—¶ï¼Œå•ä½ç§’</span></div><div class="line"><span class="keyword">double</span> delay = <span class="number">3</span>; </div><div class="line"></div><div class="line">dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delay * <span class="built_in">NSEC_PER_SEC</span>)), queue, ^&#123;</div><div class="line">    <span class="comment">// 3ç§’åéœ€è¦æ‰§è¡Œçš„ä»»åŠ¡</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="NSTimer"><a href="#NSTimer" class="headerlink" title="NSTimer"></a>NSTimer</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">3.0</span> target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(run:) userInfo:<span class="string">@"abc"</span> repeats:<span class="literal">NO</span>];</div></pre></td></tr></table></figure>
<h3 id="ä»å…¶ä»–çº¿ç¨‹å›åˆ°ä¸»çº¿ç¨‹çš„æ–¹æ³•"><a href="#ä»å…¶ä»–çº¿ç¨‹å›åˆ°ä¸»çº¿ç¨‹çš„æ–¹æ³•" class="headerlink" title="ä»å…¶ä»–çº¿ç¨‹å›åˆ°ä¸»çº¿ç¨‹çš„æ–¹æ³•"></a>ä»å…¶ä»–çº¿ç¨‹å›åˆ°ä¸»çº¿ç¨‹çš„æ–¹æ³•</h3><p>åœ¨å…¶ä»–çº¿ç¨‹æ“ä½œå®Œæˆåå¿…é¡»åˆ°ä¸»çº¿ç¨‹æ›´æ–°UI</p>
<h4 id="NSThread-1"><a href="#NSThread-1" class="headerlink" title="NSThread"></a>NSThread</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="keyword">self</span> performSelectorOnMainThread:<span class="keyword">@selector</span>(run) withObject:<span class="literal">nil</span> waitUntilDone:<span class="literal">NO</span>];</div></pre></td></tr></table></figure>
<h4 id="GCD-2"><a href="#GCD-2" class="headerlink" title="GCD"></a>GCD</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">  ...</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iosä¸­åº“çš„ä»‹ç»ä¸ä½¿ç”¨]]></title>
      <url>http://zhang759740844.github.io/2016/10/17/%E6%89%93%E5%8C%85%E9%9D%99%E6%80%81%E5%BA%93/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘ç”±äºè¦æ¥å…¥ç¬¬ä¸‰æ–¹åº“ï¼Œå› æ­¤æƒ³è¦äº†è§£åº“çš„ç›¸å…³çŸ¥è¯†ã€‚ç½‘ä¸ŠæŸ¥é˜…äº†è®¸å¤šèµ„æ–™ï¼Œä»ç„¶æ¯”è¾ƒç–‘æƒ‘ã€‚æ¯”å¦‚ï¼Œé™æ€åº“èƒ½å¦ä»¥åŠå¦‚ä½•å¼•å…¥åŠ¨æ€åº“ï¼ŸåŠ¨æ€åº“èƒ½å¦ä»¥åŠå¦‚ä½•å¼•å…¥é™æ€åº“ï¼Ÿè‡ªå»ºåŠ¨æ€åº“(éç³»ç»ŸåŠ¨æ€åº“)çš„å¥½å¤„ä½“ç°åœ¨å“ªï¼Œæ€ä¹ˆå®ç°ï¼Ÿç­‰ç­‰ã€‚åœ¨ä¸€ç•ªæ¢ç´¢ä¹‹åï¼Œæ€»ç»“äº†ä¸€ç¯‡è¾ƒä¸ºè¯¦å°½å…¨é¢çš„åº“çš„ä½¿ç”¨æ–¹æ³•ã€‚</p>
<a id="more"></a>
<p>å…ˆæ¥çœ‹ä¸€å¼ æ€ç»´å¯¼å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/åº“.png?raw=true" alt="åº“"></p>
<h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><h3 id="ä»€ä¹ˆæ˜¯åº“"><a href="#ä»€ä¹ˆæ˜¯åº“" class="headerlink" title="ä»€ä¹ˆæ˜¯åº“"></a>ä»€ä¹ˆæ˜¯åº“</h3><p>åº“æ˜¯å…±äº«ç¨‹åºä»£ç çš„æ–¹å¼ã€‚åº“ä»æœ¬è´¨ä¸Šæ¥è¯´æ˜¯ä¸€ç§å¯æ‰§è¡Œä»£ç çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œå¯ä»¥è¢«è½½å…¥å†…å­˜ä¸­æ‰§è¡Œã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸€äº›æ ¸å¿ƒæŠ€æœ¯æˆ–è€…å¸¸ç”¨æ¡†æ¶ï¼Œå‡ºäºå®‰å…¨æ€§å’Œç¨³å®šæ€§çš„è€ƒè™‘ï¼Œä¸æƒ³è¢«å¤–ç•ŒçŸ¥é“ï¼Œæ‰€ä»¥ä¼šæŠŠæ ¸å¿ƒä»£ç æ‰“åŒ…æˆåº“ï¼Œåªæš´éœ²å‡ºå¤´æ–‡ä»¶ä»¥ä¾›ä½¿ç”¨ã€‚åº“åˆ†é™æ€åº“å’ŒåŠ¨æ€åº“ä¸¤ç§ã€‚</p>
<h3 id="åº“çš„åˆ†ç±»"><a href="#åº“çš„åˆ†ç±»" class="headerlink" title="åº“çš„åˆ†ç±»"></a>åº“çš„åˆ†ç±»</h3><h4 id="é™æ€åº“"><a href="#é™æ€åº“" class="headerlink" title="é™æ€åº“"></a>é™æ€åº“</h4><p>å­˜åœ¨ <code>.a</code> å’Œ <code>.framework</code> ä¸¤ç§å½¢å¼ã€‚ <code>.a</code> æ˜¯ä¸€ä¸ªçº¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œ<code>.framework</code> ä¸­é™¤äº†æœ‰äºŒè¿›åˆ¶æ–‡ä»¶ä¹‹å¤–è¿˜æœ‰èµ„æºæ–‡ä»¶ã€‚ <code>.a</code> ï¼Œè¦æœ‰ <code>.h</code> æ–‡ä»¶ä»¥åŠèµ„æºæ–‡ä»¶é…åˆï¼Œ <code>.framework</code> æ–‡ä»¶å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚æ€»çš„æ¥è¯´ï¼Œ<code>.a + .h + sourceFile = .framework</code>ã€‚æ‰€ä»¥åˆ›å»ºé™æ€åº“æœ€å¥½è¿˜æ˜¯ç”¨<code>.framework</code>çš„å½¢å¼ã€‚</p>
<p>å¯¹äºé™æ€åº“è€Œè¨€ï¼Œç±»ä¼¼äºä¸€ä¸ªç¼–è¯‘å¥½çš„ <code>.o</code> çš„é›†åˆã€‚åœ¨buildçš„è¿‡ç¨‹ä¸­ï¼Œåªä¼šå‚ä¸é“¾æ¥çš„æ“ä½œï¼Œé“¾æ¥å™¨ä¼šå°†é™æ€åº“ä¸­è¢«ä½¿ç”¨çš„éƒ¨åˆ†åˆå¹¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­å»ï¼Œç”¨å‡½æ•°çš„å®é™…åœ°å€æ¥ä»£æ›¿å‡½æ•°å¼•ç”¨ã€‚é“¾æ¥æµç¨‹å¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_1.jpg?raw=true" alt="é™æ€åº“çš„é“¾æ¥è¿‡ç¨‹"></p>
<h4 id="åŠ¨æ€åº“"><a href="#åŠ¨æ€åº“" class="headerlink" title="åŠ¨æ€åº“"></a>åŠ¨æ€åº“</h4><p>å­˜åœ¨<code>.framework</code>å’Œ<code>.tbd</code>ä¸¤ç§å½¢å¼ã€‚</p>
<p>åœ¨ iOS8 ä¹‹å‰ï¼Œè‹¹æœä¸å…è®¸ç¬¬ä¸‰æ–¹æ¡†æ¶ä½¿ç”¨åŠ¨æ€æ–¹å¼åŠ è½½ï¼Œä» iOS8 å¼€å§‹å…è®¸å¼€å‘è€…æœ‰æ¡ä»¶åœ°åˆ›å»ºå’Œä½¿ç”¨åŠ¨æ€æ¡†æ¶ï¼Œè¿™ç§æ¡†æ¶å«åš Cocoa Touch Frameworkã€‚è™½ç„¶åŒæ ·æ˜¯åŠ¨æ€æ¡†æ¶ï¼Œä½†æ˜¯å’Œç³»ç»Ÿ framework ä¸åŒï¼Œapp ä¸­çš„ä½¿ç”¨çš„ Cocoa Touch Framework åœ¨æ‰“åŒ…å’Œæäº¤ app æ—¶ä¼šè¢«æ”¾åˆ° app bundle ä¸­ï¼Œè¿è¡Œåœ¨æ²™ç›’é‡Œï¼Œè€Œä¸æ˜¯ç³»ç»Ÿä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åŒçš„ app å°±ç®—ä½¿ç”¨äº†åŒæ ·çš„ frameworkï¼Œä½†è¿˜æ˜¯ä¼šæœ‰å¤šä»½çš„æ¡†æ¶è¢«åˆ†åˆ«ç­¾åï¼Œæ‰“åŒ…å’ŒåŠ è½½ã€‚ä¸è¿‡ iOS8 ä¸Šå¼€æ”¾äº† <strong>App Extension</strong> åŠŸèƒ½ï¼Œå¯ä»¥ä¸ºä¸€ä¸ªåº”ç”¨åˆ›å»ºæ’ä»¶ï¼Œè¿™æ ·ä¸»appå’Œæ’ä»¶ä¹‹é—´å…±äº«åŠ¨æ€åº“è¿˜æ˜¯å¯è¡Œçš„ã€‚</p>
<p>åŠ¨æ€é“¾æ¥æ˜¯ä½¿ç”¨äº† <strong>Procedure Linkage Table (PLT)</strong>ã€‚é¦–å…ˆè¿™ä¸ª <strong>PLT</strong> åˆ—å‡ºäº†ç¨‹åºä¸­æ¯ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨ï¼Œ<strong>å½“ç¨‹åºå¼€å§‹è¿è¡Œ</strong>ï¼Œå¦‚æœåŠ¨æ€åº“è¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œ<strong>PLT</strong> ä¼šå»å¯»æ‰¾åŠ¨æ€çš„åœ°å€å¹¶è®°å½•ä¸‹æ¥ï¼Œå¦‚æœå‡½æ•°è¢«è°ƒç”¨è¿‡çš„è¯ï¼Œä¸‹ä¸€æ¬¡è°ƒç”¨å°±å¯ä»¥é€šè¿‡ <strong>PLT</strong> ç›´æ¥è·³è½¬äº†ã€‚</p>
<h3 id="ä¼˜åŠ£"><a href="#ä¼˜åŠ£" class="headerlink" title="ä¼˜åŠ£"></a>ä¼˜åŠ£</h3><p>é™æ€åº“ï¼Œåœ¨é“¾æ¥æ—¶ä¼šè¢«å®Œæ•´åœ°å¤åˆ¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œè¢«å¤šæ¬¡ä½¿ç”¨å°±æœ‰å¤šä»½å†—ä½™æ‹·è´ã€‚<br>å¥½å¤„å¾ˆæ˜æ˜¾ï¼Œç¼–è¯‘å®Œæˆä¹‹åï¼Œåº“æ–‡ä»¶å®é™…ä¸Šå°±æ²¡æœ‰ä½œç”¨äº†ã€‚ç›®æ ‡ç¨‹åºæ²¡æœ‰å¤–éƒ¨ä¾èµ–ï¼Œç›´æ¥å°±å¯ä»¥è¿è¡Œã€‚å½“ç„¶å…¶ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯ä¼šä½¿ç”¨ç›®æ ‡ç¨‹åºçš„ä½“ç§¯å¢å¤§ã€‚</p>
<p>åŠ¨æ€åº“ï¼Œä¸é™æ€åº“ç›¸åï¼ŒåŠ¨æ€åº“åœ¨ç¼–è¯‘æ—¶å¹¶ä¸ä¼šè¢«æ‹·è´åˆ°ç›®æ ‡ç¨‹åºä¸­ï¼Œç›®æ ‡ç¨‹åºä¸­åªä¼šå­˜å‚¨æŒ‡å‘åŠ¨æ€åº“çš„å¼•ç”¨ã€‚ç­‰åˆ°ç¨‹åºè¿è¡Œæ—¶ï¼ŒåŠ¨æ€åº“æ‰ä¼šè¢«çœŸæ­£åŠ è½½è¿›æ¥ã€‚<br>ç³»ç»Ÿçš„åŠ¨æ€åº“ä¸éœ€è¦æ‹·è´åˆ°ç›®æ ‡ç¨‹åºä¸­ï¼Œè‡ªå»ºçš„åŠ¨æ€åº“å¯ä»¥ç”±å·¥ç¨‹å†…çš„å¤šä¸ªåº“å…±äº«ï¼Œå› æ­¤å¯ä»¥å‡å°ç›®æ ‡ç¨‹åºçš„ä½“ç§¯ã€‚ä½†æ˜¯ï¼Œç”±äºå…¶æŠŠé™æ€é“¾æ¥åšçš„äº‹æƒ…éƒ½æ¬åˆ°è¿è¡Œæ—¶æ¥åšï¼Œç¨‹åºçš„å¯åŠ¨ä¼šå˜æ…¢ã€‚</p>
<h2 id="åº“çš„åˆ›å»º"><a href="#åº“çš„åˆ›å»º" class="headerlink" title="åº“çš„åˆ›å»º"></a>åº“çš„åˆ›å»º</h2><h3 id="aé™æ€åº“çš„åˆ›å»º"><a href="#aé™æ€åº“çš„åˆ›å»º" class="headerlink" title=".aé™æ€åº“çš„åˆ›å»º"></a>.aé™æ€åº“çš„åˆ›å»º</h3><p>åˆ›å»ºä¸€ä¸ª <code>.a</code> é™æ€åº“é¡¹ç›®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_2.png?raw=true" alt="lib_2"><br>é™æ€åº“çš„æ–‡ä»¶åˆ—è¡¨å¦‚ä¸‹ï¼Œåœ¨ <strong>products</strong> æ–‡ä»¶å¤¹å†…çš„å°±æ˜¯è¦ç”Ÿæˆçš„é™æ€åº“ã€‚æ­¤åˆ»æ˜¯çº¢è‰²çš„ï¼Œç­‰åˆ°ç”ŸæˆæˆåŠŸå°±ä¼šå˜æˆé»‘è‰²ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_3.png?raw=true" alt="lib_3"><br>ç°åœ¨æ–°å»ºè‡ªå·±çš„ç±»<code>PrintString.h</code>ï¼Œå£°æ˜å’Œå®ç°ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“çš„æ–¹æ³•ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_4.png?raw=true" alt="lib_4"><br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_5.png?raw=true" alt="lib_5"><br>ç°åœ¨å¯ä»¥æ‰“åŒ…è¿™ä¸ªé™æ€åº“äº†ã€‚ç”±äºæ¨¡æ‹Ÿå™¨å’ŒçœŸæœºæ¶æ„ä¸åŒï¼Œéœ€è¦é€‰æ‹©è¯¥åŒ…å°†è¿è¡Œåœ¨å“ªä¸ªç¯å¢ƒä¸‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€‰æ‹©è¿è¡Œåœ¨çœŸæœºä¸Šï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_6.png?raw=true" alt="lib_6"><br>æ‰“åŒ…ç”Ÿæˆäº†é™æ€åº“åœ¨ <strong>products</strong> æ–‡ä»¶å¤¹å†…ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_7.png?raw=true" alt="lib_7"><br>æ‰“å¼€ <strong>products</strong> æ–‡ä»¶å¤¹ï¼Œ ä½†æ˜¯æ­¤æ—¶æš´éœ²å‡ºæ¥çš„å¤´æ–‡ä»¶å¹¶æ²¡æœ‰<code>PrintString.h</code>ã€‚éœ€è¦å¯¹æš´éœ²çš„å¤´æ–‡ä»¶è¿›è¡Œè®¾ç½®ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_8.png?raw=true" alt="lib_8"><br>å¦‚ä¸‹å›¾ï¼Œåœ¨ <strong>Build Phase</strong> ï¼Œçš„ <strong>Copy Files</strong> ç›®å½•ä¸‹åŠ å…¥æƒ³è¦å…¬å¼€çš„å¤´æ–‡ä»¶ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_9.png?raw=true" alt="lib_9"><br>ç°åœ¨å† run ä¸€æ¬¡ï¼Œå°±å¾—åˆ°äº†æ­£ç¡®çš„é™æ€åº“ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_10.png?raw=true" alt="lib_10"><br>ç°åœ¨ï¼Œå¯ä»¥æµ‹è¯•ä¸€ä¸‹è¿™ä¸ªé™æ€åº“ã€‚å¯ä»¥å†åˆ›å»ºä¸€ä¸ªå·¥ç¨‹ï¼ŒæŠŠåº“æ‹–è¿›å»ã€‚ä¸è¿‡æ›´æ¨èå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ–°å»ºä¸€ä¸ª <strong>target</strong> ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_11.png?raw=true" alt="lib_11"><br>å…ˆè¦åœ¨å·¥ç¨‹å’Œåº“é—´å»ºç«‹å…³è”ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨ <strong>Link Binary With Libraries</strong> ä¸­æ·»åŠ åº“ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_12.png?raw=true" alt="lib_12"><br>åœ¨ <code>ViewController.m</code> ä¸­è°ƒç”¨åº“çš„æ–¹æ³•ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_13.png?raw=true" alt="lib_13"><br>ç°åœ¨å¯ä»¥è¿è¡Œäº†ï¼Œä¸è¿‡è¿è¡Œå‰è¦é€‰æ‹©å¯¹ <strong>target</strong> ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_14.png?raw=true" alt="lib_14"><br>å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°åº“ä¸­çš„æ–¹æ³•è¢«è°ƒç”¨äº†ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lib_15.png?raw=true" alt="lib_15"></p>
<h3 id="frameworkçš„åˆ›å»º"><a href="#frameworkçš„åˆ›å»º" class="headerlink" title=".frameworkçš„åˆ›å»º"></a>.frameworkçš„åˆ›å»º</h3><h4 id="åŠ¨æ€framework"><a href="#åŠ¨æ€framework" class="headerlink" title="åŠ¨æ€framework"></a>åŠ¨æ€framework</h4><p>åˆ›å»ºä¸€ä¸ªframeworkï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/fram_1.png?raw=true" alt="frame_1"><br>åˆ›å»ºåçš„æ–‡ä»¶åˆ—è¡¨å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°åªæœ‰ä¸€ä¸ª <code>framework.h</code> å¤´æ–‡ä»¶ã€‚é€šè¿‡æ³¨é‡Šï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ï¼Œè¿™ä¸ªå¤´æ–‡ä»¶æ˜¯æ‰€æœ‰ public å¤´æ–‡ä»¶çš„é›†åˆï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/fram_2.png?raw=true" alt="frame_2"><br>å°†å‰é¢åˆ›å»ºçš„ <code>PrintString.h</code> å’Œ <code>PrintString.m</code> å¯¼å…¥ï¼Œå¹¶ä¸” import åˆ° <code>framework.h</code> ä¸­å»ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/fram_3.png?raw=true" alt="frame_3"><br>è®¾ç½®éœ€è¦æš´éœ²çš„å¤´æ–‡ä»¶ï¼Œå¤´æ–‡ä»¶é»˜è®¤åœ¨ <strong>project header</strong> ä¸­ï¼Œå°†éœ€è¦æš´éœ²å‡ºæ¥çš„æ‹–åˆ° <strong>public header</strong> ä¸­å»ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/fram_4.png?raw=true" alt="frame_4"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ­¤å¤„æœ‰ä¸‰ç§å¤´æ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ <strong>project header</strong> ï¼Œ <strong>public header</strong> ï¼Œ <strong>private header</strong> ã€‚åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>Public: The interface is finalized and meant to be used by your productâ€™s clients. A public header is included in the product as readable source code without restriction.</p>
<p>Private: The interface isnâ€™t intended for your clients or itâ€™s in early stages of development. A private header is included in the product, but itâ€™s marked â€œprivateâ€. Thus the symbols are visible to all clients, but clients should understand that theyâ€™re not supposed to use them.</p>
<p>Project: The interface is for use only by implementation files in the current project. A project header is not included in the target, except in object code. The symbols are not visible to clients at all, only to you.</p>
</blockquote>
<p>ç”Ÿæˆçš„ framework æ–‡ä»¶ç›®å½•å¦‚ä¸‹ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/fram_5.png?raw=true" alt="frame_5"></p>
<p>å°†ç”Ÿæˆçš„ framework æ”¾å…¥å·¥ç¨‹ä¸­æµ‹è¯•ï¼Œç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/fram_6.png?raw=true" alt="frame_6"></p>
<p>éœ€è¦å°†åŠ¨æ€åº“åµŒå…¥å·¥ç¨‹çš„ bundle ä¸­ã€‚å› æ­¤ï¼Œéœ€è¦åœ¨ General ä¸­çš„ <strong>Embedded Binary</strong> ä¸€é¡¹ä¸­åŠ å…¥ç›¸åº”åŠ¨æ€åº“ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/fram_7.png?raw=true" alt="frame_7"></p>
<p>ç°åœ¨å°±å¯ä»¥æ­£ç¡®è¿è¡Œäº†</p>
<h4 id="é™æ€framework"><a href="#é™æ€framework" class="headerlink" title="é™æ€framework"></a>é™æ€framework</h4><p>é™æ€frameworkå’ŒåŠ¨æ€frameworkåˆ›å»ºçš„åŸºæœ¬æµç¨‹ä¸€è‡´ï¼Œå”¯ä¸€çš„åŒºåˆ«éœ€è¦è®¾ç½® <strong>Mach-O Type</strong> ä¸º <code>Static Library</code> ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/fram_8.png?raw=true" alt="frame_8"></p>
<h3 id="é™æ€åº“ä¸åŠ¨æ€åº“çš„å¼•ç”¨"><a href="#é™æ€åº“ä¸åŠ¨æ€åº“çš„å¼•ç”¨" class="headerlink" title="é™æ€åº“ä¸åŠ¨æ€åº“çš„å¼•ç”¨"></a>é™æ€åº“ä¸åŠ¨æ€åº“çš„å¼•ç”¨</h3><p>ä¸€ä¸ªåº“çš„å¼€å‘ç»å¸¸ä¼šéœ€è¦ç”¨åˆ°å…¶ä»–çš„åº“(å¦‚ <code>AFNetWorking</code> )çš„é…åˆï¼Œå› æ­¤ï¼Œéœ€è¦åœ¨åº“ä¸­åµŒå…¥å…¶ä»–çš„åº“ã€‚å¦‚ä½•åœ¨è‡ªå·±çš„é™æ€/åŠ¨æ€åº“ä¸­é›†æˆç¬¬ä¸‰æ–¹çš„é™æ€/åŠ¨æ€åº“æ˜¯æˆ‘æ¯”è¾ƒå›°æƒ‘çš„ç‚¹ã€‚</p>
<p><em>ç½‘ä¸Šæ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ•™ç¨‹ï¼Œä»¥ä¸‹æ˜¯æˆ‘ä¸æ–­å°è¯•åå¾—å‡ºçš„ç»“è®ºï¼Œå¦‚æœæœ‰é”™è¯¯è¿˜è¯·æŒ‡æ­£ã€‚</em></p>
<h4 id="åŠ¨æ€åº“å¼•ç”¨é™æ€åº“"><a href="#åŠ¨æ€åº“å¼•ç”¨é™æ€åº“" class="headerlink" title="åŠ¨æ€åº“å¼•ç”¨é™æ€åº“"></a>åŠ¨æ€åº“å¼•ç”¨é™æ€åº“</h4><p>åˆ›å»ºä¸€ä¸ªåŠ¨æ€åº“ <code>DynamicWithStatic</code>ã€‚</p>
<p>ä½¿ç”¨ <strong>cocoapods</strong> çš„æ–¹å¼ä¸ºåŠ¨æ€åº“å¼•å…¥é™æ€åº“ã€‚åœ¨å·¥ç¨‹ç›®å½•ä¸‹æ–°å»º <code>podfile</code>,å†™å…¥:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">target <span class="string">'DynamicWithStatic'</span> <span class="keyword">do</span></div><div class="line">pod <span class="string">'SVProgressHUD'</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>è¿™é‡Œå¼•å…¥<code>SVProgressHUD</code>ï¼Œå› ä¸ºè°ƒè¯•èµ·æ¥æ¯”è¾ƒç®€å•ã€‚</p>
<p>åœ¨æ‰§è¡Œå®Œ <code>pod install</code> åï¼Œæ‰“å¼€ <code>Frameworks.xcworkspace</code> ,åœ¨å…¶ä¸­æ·»åŠ <code>SVProgress</code>ç±»ã€‚ç°åœ¨çš„å·¥ç¨‹ç›®å½•å¦‚ä¸‹ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/dynamicstatic_4.png?raw=true" alt="åŠ¨é™åº“å¼•ç”¨"></p>
<hr>
<p><strong>å…³äº <code>pod install</code> æ…¢çš„æ–¹æ³•</strong><br>è¿™é‡Œæ’ä¸€ä¸‹ï¼Œ<code>pod</code> çš„æ—¶å€™ç»å¸¸ä¼šå¡åœ¨ä¸€ä¸ªåŒ…ä¸Šï¼Œä¼šè®©äººä»¥ä¸ºæ²¡æœ‰ä¸‹è½½é€Ÿåº¦äº†ã€‚å¯ä»¥é€šè¿‡æ·»åŠ é€‰é¡¹ <code>pod install --verbose</code> çš„æ–¹å¼ï¼Œçœ‹åˆ°å®‰è£…è¯¦æƒ…ï¼Œå¯ä»¥çœ‹åˆ°é€Ÿåº¦å·²ç»ä¼°è®¡æ—¶é—´ï¼Œè¿™æ ·å¿ƒé‡Œå°±æœ‰æ•°äº†ã€‚</p>
<hr>
<p>åœ¨<code>SVProgress.h</code>ä¸­æ·»åŠ ä»£ç ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">void</span>(^SVProgresshud)();</div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">SVProgress</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line">+ (SVProgresshud)getBlock;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>åœ¨<code>SVProgress.m</code>ä¸­æ·»åŠ ä»£ç ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"SVProgress.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"SVProgressHUD.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">SVProgress</span></span></div><div class="line">+(SVProgresshud)getBlock&#123;</div><div class="line">    <span class="keyword">return</span> ^()&#123;</div><div class="line">        [SVProgressHUD showSuccessWithStatus:<span class="string">@"æˆåŠŸï¼"</span>];</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p><code>SVProgress</code>ç±»çš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ª block ä»¥ä¾›è°ƒç”¨ã€‚å°† <code>SVProgress.h</code> å¤´æ–‡ä»¶æš´éœ²å‡ºæ¥åï¼Œ run ç”ŸæˆåŠ¨æ€åº“ã€‚</p>
<p>åŠ¨æ€åº“å†…å¼•ç”¨é™æ€åº“ç›¸å½“äºç›´æ¥æŠŠä»£ç å†™å…¥åŠ¨æ€åº“ä¸­ï¼Œéå¸¸çš„ç®€å•ã€‚ç°åœ¨æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœå·¥ç¨‹ä¸­å¼•ç”¨äº†è¿™ä¸ªåŠ¨æ€åº“ï¼Œå¹¶ä¸”å·¥ç¨‹æœ¬èº«ä¹Ÿç”¨åˆ°äº† <code>SVProgressHUD</code> åº“ï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå°è¯•ä¸€ä¸‹ï¼Œåœ¨ Pod ä¸­ä¸º <code>FrameworkTest</code> æ·»åŠ  <code>SVProgressHUD</code> ,ä¼šäº§ç”Ÿå¦‚ä¸‹çš„è­¦å‘Šï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/dynamicstatic_1.png?raw=true" alt="é‡å¤å®ç°"></p>
<p><code>SVProgressHUD</code> åº“ä¸­çš„å„ä¸ªç±»åœ¨å·¥ç¨‹å’Œåº“ä¸­éƒ½è¿›è¡Œäº†å®ç°ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‡æ˜ä½¿ç”¨å“ªä¸€ä¸ªå®ç°ã€‚ä¸è¿‡è¿™ä¸ªè­¦å‘Šï¼Œå¹¶ä¸å½±å“è¿è¡Œï¼Œéå¼ºè¿«ç—‡å¯ä»¥é€‰æ‹©æ— è§†ï¼Œé‚£ä¹ˆå¯¹äºå¼ºè¿«ç—‡æ‚£è€…ï¼Œå¦‚ä½•æ¶ˆé™¤æ‰è¿™äº›è­¦å‘Šå‘¢ï¼Ÿä¿®æ”¹åº“ä¸­ <code>SVProgressHUD</code> ä¸­å„ä¸ªç±»çš„å‘½åã€‚æœ‰ä¸¤ç§æ–¹å¼ï¼šæ‰‹åŠ¨å’Œè‡ªåŠ¨ï¼Œå°†åœ¨ä¸‹é¢ä»‹ç»ã€‚</p>
<h4 id="åŠ¨æ€åº“å¼•ç”¨åŠ¨æ€åº“"><a href="#åŠ¨æ€åº“å¼•ç”¨åŠ¨æ€åº“" class="headerlink" title="åŠ¨æ€åº“å¼•ç”¨åŠ¨æ€åº“"></a>åŠ¨æ€åº“å¼•ç”¨åŠ¨æ€åº“</h4><p>è¿™æ¬¡è¢«å¼•ç”¨çš„åŠ¨æ€åº“è¿˜æ˜¯ <code>SVProgressHUD</code> åº“ã€‚å…ˆç”¨ pod ä¸‹è½½ <code>SVProgressHUD</code> çš„æºç ï¼Œç„¶åæ‰“åŒ…æˆåŠ¨æ€åº“ï¼Œè¿™é‡Œå°±ä¸å¤šåšè¯´æ˜äº†ã€‚</p>
<p>å°†åŠ¨æ€åº“ <code>SVProgressHUD</code> æ‹–å…¥å·¥ç¨‹ä¸­ï¼Œæ–°å»º <code>DynamicWithDynamic</code> åŠ¨æ€åº“ã€‚å°†ä¸Šé¢çš„ <code>SVProgress.h</code> å’Œ <code>SVProgress.m</code> æ‹–å…¥ <code>DynamicWithDynamic</code> ä¸­ï¼Œè®¾ç½®æš´éœ²å‡º <code>SVProgress.h</code>ã€‚</p>
<p>è®°å¾—æ³¨æ„ä¸€å®šè¦åœ¨ <code>DynamicWithDynamic</code> ä¸­å¼•å…¥ <code>SVProgressHUD</code> ,å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/dynamicstatic_2.png?raw=true" alt="å¼•å…¥SVProgressHUD"></p>
<p>ç°åœ¨ run ä¸€ä¸‹ï¼Œå°±å¯ä»¥æˆåŠŸç”Ÿæˆäº†ã€‚</p>
<p>ä¸‹é¢åœ¨ <code>FrameworkTest</code> ä¸­æµ‹è¯•ï¼Œä½¿å…¶ embed <code>DynamicWithDynamic</code> ã€‚å¾®è°ƒä¸€ä¸‹ <code>ViewController.m</code> ä½¿å…¶å¼•å…¥ç›®æ ‡åº“ï¼Œè¿è¡Œã€‚</p>
<p>åœ¨è¿è¡Œä¸­å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/dynamicstatic_3.png?raw=true" alt="é”™è¯¯åŸå› "></p>
<p>è¿™ä¸ªé”™è¯¯ä¸Šé¢ä¹Ÿæåˆ°è¿‡äº†ï¼Œæ˜¯å› ä¸ºå¿…è¦çš„åŠ¨æ€åº“æ²¡æœ‰ embed è¿›å·¥ç¨‹ä¸­ã€‚ä½†æ˜¯æ˜æ˜å·²ç»å°† <code>DynamicWithDynamic</code> embed äº†å•Šã€‚å¥½å§ï¼Œç”±äº <code>SVProgressHUD</code> ç°åœ¨æ˜¯åŠ¨æ€åº“äº†ï¼Œè¿˜éœ€è¦å°† <code>SVProgressHUD</code> åº“ embed è¿› <code>FrameworkTest</code> ä¸­ã€‚</p>
<p>åŠ¨æ€åº“å¼•å…¥åŠ¨æ€åº“ï¼Œä¸ä¼šå°†è¦å¼•å…¥çš„åŠ¨æ€åº“æ‰“åŒ…åˆ°è‡ªèº«ä¸­ï¼Œå³åªæ˜¯ link äº§ç”Ÿå…³è”ï¼Œè€Œä¸æ˜¯ embed åµŒå…¥ã€‚ éœ€è¦åœ¨å¤–éƒ¨ä½¿ç”¨è¯¥åŠ¨æ€åº“æ—¶ï¼Œæ‰‹åŠ¨ embed åŠ¨æ€åº“å†…è¦ä½¿ç”¨çš„åŠ¨æ€åº“ã€‚è¿™æ ·çš„åšæ³•å¾ˆéº»çƒ¦ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿæ­£å¦‚åŠ¨æ€åº“æœ¬èº«çš„ä½œç”¨ï¼Œå¦‚æœå·¥ç¨‹æœ¬èº«ä¹Ÿè¦ç”¨åˆ°è¯¥ <code>SVProgressHUD</code> åŠ¨æ€åº“æ—¶ï¼Œé‚£ä¹ˆä»…éœ€å¯¼å…¥ä¸€ä»½ï¼Œå°±ä¸ä¼šäº§ç”Ÿé‡å¤ä»£ç äº†ã€‚</p>
<h4 id="é™æ€åº“å¼•ç”¨é™æ€åº“"><a href="#é™æ€åº“å¼•ç”¨é™æ€åº“" class="headerlink" title="é™æ€åº“å¼•ç”¨é™æ€åº“"></a>é™æ€åº“å¼•ç”¨é™æ€åº“</h4><p>æ–°å»ºä¸€ä¸ª <code>target</code> å‘½åä¸º <code>StaticWithStatic</code> ï¼Œä½¿ç”¨ cocoapods ç®¡ç† <code>SVProgressHUD</code> ã€‚åŸºæœ¬æ–¹æ³•å’Œä¸Šé¢ä¸€æ ·ï¼Œå”¯ä¸€éœ€è¦æ”¹å˜çš„åœ°æ–¹æ˜¯ <strong>Mach-O</strong> éœ€è¦æ”¹ä¸º <strong>Static Library</strong> ï¼Œè¿è¡Œã€‚ </p>
<p>ç„¶è€Œè¿è¡Œå¤±è´¥ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/dynamicstatic_5.png?raw=true" alt="é”™è¯¯åŸå› "></p>
<p>å¤§æ¦‚æ„æ€æ˜¯åœ¨å¯¹ <code>ViewController.h</code> è¿›è¡Œé“¾æ¥çš„æ—¶å€™æ²¡æœ‰æ‰¾åˆ° <code>SVProgressHUD.m</code> ã€‚è¿™å°±å¾ˆå¥‡æ€ªäº†ï¼Œæ˜æ˜å·²ç»åœ¨ <code>StaticWithStatic</code> ä¸­é€šè¿‡ cocoapods ç®¡ç†äº†ï¼Œæ€ä¹ˆä¼šæ²¡æœ‰ <code>SVProgressHUD.m</code> å‘¢ï¼Ÿæˆ‘æƒ³å¯èƒ½æ˜¯å› ä¸ºcocoapodsåªæ˜¯èµ·åˆ° Link ä½œç”¨ï¼Œå¹¶æ²¡æœ‰æŠŠç¬¬ä¸‰æ–¹åº“ä¹Ÿæ‰“è¿›å»ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆåŠ¨æ€åº“å¼•å…¥é™æ€åº“çš„æ—¶å€™æ˜¯å¯è¡Œçš„å‘¢ï¼Ÿè¿™å°±ä¸å¤ªæ¸…æ¥šäº†ã€‚è™½ç„¶ä¸çŸ¥é“åŸå› ï¼Œä½†æ˜¯è§£å†³æ–¹æ³•æ˜¯æœ‰çš„ã€‚éœ€è¦åœ¨å·¥ç¨‹é‡Œï¼Œå³ <code>FrameworkTest</code> çš„ cocoapods ä¸­æ·»åŠ  <code>SVProgressHUD</code>ï¼š</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">target <span class="string">'DynamicWithStatic'</span> <span class="keyword">do</span></div><div class="line">pod <span class="string">'SVProgressHUD'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">target <span class="string">'StaticWithStatic'</span> <span class="keyword">do</span></div><div class="line">pod <span class="string">'SVProgressHUD'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">target <span class="string">'FrameworksTest'</span> <span class="keyword">do</span></div><div class="line">    pod <span class="string">'SVProgressHUD'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">target <span class="string">'DynamicWithDynamic'</span> <span class="keyword">do</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>å†æ¬¡ build ï¼Œé”™è¯¯æ¶ˆé™¤ï¼Œå¯ä»¥ä½¿ç”¨ã€‚</p>
<h4 id="é™æ€åº“å¼•ç”¨åŠ¨æ€åº“"><a href="#é™æ€åº“å¼•ç”¨åŠ¨æ€åº“" class="headerlink" title="é™æ€åº“å¼•ç”¨åŠ¨æ€åº“"></a>é™æ€åº“å¼•ç”¨åŠ¨æ€åº“</h4><p>é™æ€åº“è²Œä¼¼ä¸èƒ½å¼•ç”¨åŠ¨æ€åº“ã€‚å¦‚æœå°è¯•ä¸€ä¸‹ï¼Œä¼šå‘ç°ï¼Œå³ä½¿å°†åŠ¨æ€åº“ <strong>Link Binary With Libraries</strong> å…¥é™æ€åº“ï¼Œä¹Ÿæ˜¯æ‰¾ä¸åˆ° <code>SVProgressHUD.h</code> å¤´æ–‡ä»¶çš„ã€‚</p>
<h2 id="ä¸€äº›éœ€è¦çŸ¥é“çš„ç‚¹"><a href="#ä¸€äº›éœ€è¦çŸ¥é“çš„ç‚¹" class="headerlink" title="ä¸€äº›éœ€è¦çŸ¥é“çš„ç‚¹"></a>ä¸€äº›éœ€è¦çŸ¥é“çš„ç‚¹</h2><h3 id="debugä¸release"><a href="#debugä¸release" class="headerlink" title="debugä¸release"></a>debugä¸release</h3><p>åº“åˆ†ä¸º debug å’Œ release ä¸¤ç§ç‰ˆæœ¬ã€‚ä¸€èˆ¬æ¥è¯´, æˆ‘ä»¬åº”è¯¥å‘å¸ƒçš„æ˜¯ release ç‰ˆæœ¬ã€‚</p>
<ul>
<li><strong>debug</strong> :è°ƒè¯•ç‰ˆæœ¬, ç³»ç»Ÿæœ¬èº«ä¹Ÿä¼šæœ‰ä¸€äº›è°ƒè¯•ä»£ç . æ­¤ç‰ˆæœ¬ä½“ç§¯ä¼šç¨å¤§, è¿è¡Œä¼šç¨æ…¢ã€‚</li>
<li><strong>release</strong> : å‘å¸ƒç‰ˆæœ¬, ç³»ç»Ÿä¼šå»é™¤è°ƒè¯•ä»£ç , ä½“ç§¯å˜å°, è¿è¡Œé€Ÿåº¦å˜å¿«. å¯¹ç”¨æˆ·æ¥è¯´æ²¡æœ‰æ˜æ˜¾çš„æ„Ÿè§‰ã€‚</li>
</ul>
<p>debug ä¸ release çš„è®¾ç½®æ–¹å¼å¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_point_1.png?raw=true" alt="debugä¸releaseè®¾ç½®"></p>
<p>å¯¹äºåˆ«äººç»™çš„åº“ï¼Œè²Œä¼¼å¹¶ä¸èƒ½åŒºåˆ†æ˜¯ debug è¿˜æ˜¯ release ç‰ˆæœ¬çš„ã€‚</p>
<h3 id="å¤šæ¶æ„ç¼–è¯‘"><a href="#å¤šæ¶æ„ç¼–è¯‘" class="headerlink" title="å¤šæ¶æ„ç¼–è¯‘"></a>å¤šæ¶æ„ç¼–è¯‘</h3><p>åº“ä¸ä»…æŒ‰ debug å’Œ release åˆ†ç±»ï¼Œè¿˜ä¼šå› ä¸ºè¿è¡Œç³»ç»Ÿçš„ä¸åŒè€Œç¼–è¯‘å‡ºä¸åŒæ¡†æ¶çš„ç‰ˆæœ¬ã€‚ä¸Šé¢çš„ä¾‹å­éƒ½æ˜¯åœ¨çœŸæœºä¸‹çš„ç¼–è¯‘ï¼Œä¸º arm64 ç‰ˆæœ¬ï¼Œåœ¨å…¶ä»–çš„æ¡†æ¶ä¸‹ä¸èƒ½æ­£ç¡®è¿è¡Œã€‚</p>
<p>æ¡†æ¶åˆ†ç±»ï¼š</p>
<ul>
<li>æ¨¡æ‹Ÿå™¨æ¶æ„: <ul>
<li>i386   : 32ä½æ¶æ„  4S ~ 5</li>
<li>x86_64 : 64ä½æ¶æ„  5S ~ ç°åœ¨çš„æœºå‹</li>
</ul>
</li>
<li>çœŸæœºæ¶æ„:<ul>
<li>arm7: åœ¨æœ€è€çš„æ”¯æŒiOS7çš„è®¾å¤‡ä¸Šä½¿ç”¨</li>
<li>arm7s: åœ¨iPhone5å’Œ5Cä¸Šä½¿ç”¨ </li>
<li>arm64: è¿è¡ŒäºiPhone5Sçš„64ä½ ARM å¤„ç†å™¨ ä¸Š</li>
</ul>
</li>
</ul>
<p>ä¿®æ”¹æ¡†æ¶çš„æ–¹å¼å¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_point_2.png?raw=true" alt="ä¿®æ”¹æ¡†æ¶è®¾ç½®"></p>
<p>debug é¡¹é»˜è®¤ä¸º YES ï¼Œè¡¨ç¤ºä»…ç”Ÿæˆå½“å‰é€‰æ‹©çš„æ¡†æ¶çš„åº“ï¼› release é¡¹é»˜è®¤ä¸º NO ï¼Œè¡¨ç¤ºç”Ÿæˆæ”¯æŒæ‰€æœ‰æ¨¡æ‹Ÿå™¨æˆ–çœŸæœºçš„åº“ã€‚ç”Ÿæˆçš„åº“å°†ä¼šä¿å­˜åœ¨ products ç›®å½•ä¸‹çš„ä¸åŒåˆ†ç±»ç›®å½•å†…ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_point_3.png?raw=true" alt="åº“æ‰€åœ¨ç›®å½•"></p>
<h3 id="lipo"><a href="#lipo" class="headerlink" title="lipo"></a>lipo</h3><p>lipo æ˜¯ä¸ªå¾ˆæœ‰ç”¨çš„å‘½ä»¤ï¼Œä¸»è¦ç”¨æ¥æŸ¥çœ‹åº“æ”¯æŒçš„æ¶æ„ä»¥åŠåˆå¹¶æ‹†åˆ†åº“ã€‚</p>
<h4 id="info"><a href="#info" class="headerlink" title="-info"></a>-info</h4><p>æŸ¥çœ‹åˆšæ‰ç¼–è¯‘çš„ Framework åº“åœ¨ debug å’Œ release ä¸‹æ”¯æŒçš„æ¡†æ¶ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_point_4.png?raw=true" alt="æŸ¥çœ‹åº“"><br>å¯ä»¥çœ‹åˆ°æ­£å¦‚ä¸Šé¢æ‰€è¯´ debug ä¸‹ä¸æ˜¯ fat file ï¼Œåªæ”¯æŒ arm64 ï¼Œ release ä¸‹æ˜¯ fat file ï¼Œ æ”¯æŒ arm7 å’Œ arm64ã€‚</p>
<h4 id="create"><a href="#create" class="headerlink" title="-create"></a>-create</h4><p>ä¸Šé¢ç”Ÿæˆçš„åº“ï¼Œè¦ä¹ˆæ˜¯åªæ”¯æŒæ¨¡æ‹Ÿå™¨çš„ï¼Œè¦ä¹ˆæ˜¯åªæ”¯æŒçœŸæœºçš„ï¼Œé‚£ä¹ˆå¦‚ä½•æ‰èƒ½åˆèƒ½å…¼é¡¾çœŸæœºå’Œæ¨¡æ‹Ÿå™¨å‘¢ï¼Ÿ -create ä½¿ç”¨æ–¹å¼ï¼š</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lipo -create åº“<span class="number">1</span> åº“<span class="number">2</span> -output æ–°åº“</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ç»“æœå¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_point_5.png?raw=true" alt="åˆå¹¶"></p>
<h4 id="thin"><a href="#thin" class="headerlink" title="-thin"></a>-thin</h4><p>å¦‚æœæœ‰ä¸€ä¸ª fat file ä½†æ˜¯ä½ ä¸éœ€è¦æ”¯æŒé‚£ä¹ˆå¤šæ¡†æ¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ‹†åˆ†ï¼Œä¸ºåº“ç˜¦èº«ï¼Œ -thin ä½¿ç”¨æ–¹å¼ï¼š</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lipo æ—§åº“ -thin éœ€æ‹†åˆ†æ¡†æ¶ -output æ–°åº“</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ç»“æœå¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_point_6.png?raw=true" alt="æ‹†åˆ†"></p>
<h3 id="bundle"><a href="#bundle" class="headerlink" title="bundle"></a>bundle</h3><p>åœ¨ framework ä¸­ä½¿ç”¨ storyboard/xib åˆ›å»ºçš„é¡µé¢ï¼Œå¯ä»¥ç›´æ¥è®¿é—® framework ä¸­å›¾ç‰‡èµ„æºã€‚ä½†æ˜¯ framework ä¸­é€šè¿‡<code>imageNamedï¼š</code>æ–¹å¼åŠ è½½çš„ç…§ç‰‡éƒ½ä¼šä¸¢å¤±ã€‚è¿™æ˜¯å› ä¸º <code>imageNamed:</code>çš„æ–¹æ³•é»˜è®¤æ˜¯ä» <code>mainBundle</code> ä¸­æŸ¥æ‰¾èµ„æºçš„ï¼Œè€Œ framework ä¸­çš„ç…§ç‰‡æ˜¯ä» framework å†…éƒ¨åŠ è½½çš„ï¼Œè¿™æ˜¯çš„ bundle å¹¶ä¸æ˜¯ <code>mainBundle</code> ï¼Œè€Œæ˜¯å­˜åœ¨äºä¸»ç¨‹åºçš„ docment æ–‡ä»¶ä¸­çš„ framework åŒ…ï¼Œå›¾ç‰‡åŠ è½½çš„è·¯å¾„å‘ç”Ÿäº†å˜åŒ–ï¼Œè‡ªç„¶æ‰¾ä¸åˆ°å›¾ç‰‡èµ„æºï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹åŠ è½½å›¾ç‰‡çš„æ–¹æ³•ï¼</p>
<p>ä¸€èˆ¬çš„æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ª bundle ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_point_7.png?raw=true" alt="åˆ›å»ºbundle"></p>
<p>bundle ä¸€èˆ¬å’Œåº“å‘½åç›¸åŒã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ bundle å¹¶ä¸ä¼šè¢«æ‰“åŒ…è¿›åº“ä¸­çš„ï¼Œè€Œæ˜¯æ·»åŠ è¦å•ç‹¬æ·»åŠ åˆ°å·¥ç¨‹ä¸­ï¼Œå’Œ framework ç›¸ç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ã€‚å‘ bundle ä¸­ç›´æ¥æ·»åŠ å›¾ç‰‡ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_point_9.png?raw=true" alt="æ·»åŠ å›¾ç‰‡"></p>
<p>å…ˆåœ¨ä¸»å·¥ç¨‹çš„ <strong>Copy Bundle Resources</strong> ä¸­æ·»åŠ  bundle ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_point_8.png?raw=true" alt="æ·»åŠ bundle"></p>
<p>ç°åœ¨å°±å¯ä»¥é€šè¿‡<code>[NSBundle mainBundle]</code>è·å–å›¾ç‰‡ï¼Œä¸€ä¸‹ä¸¤ç§æ–¹å¼çš†å¯ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[<span class="built_in">UIImage</span> imageNamed:[[[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"Frameworks"</span> ofType:<span class="string">@"bundle"</span>] stringByAppendingString:<span class="string">@"/Images/author.png"</span>]]</div><div class="line"></div><div class="line">[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Frameworks.bundle/Images/author.png"</span>]</div></pre></td></tr></table></figure>
<h2 id="cocoapodsæ‰“åŒ…åº“"><a href="#cocoapodsæ‰“åŒ…åº“" class="headerlink" title="cocoapodsæ‰“åŒ…åº“"></a>cocoapodsæ‰“åŒ…åº“</h2><p>å¥½äº†ï¼Œç»ˆäºåˆ°æœ€åä¸€éƒ¨åˆ†äº†ã€‚å‰é¢å·²ç»ä»‹ç»äº†æ‰‹åŠ¨åˆ›å»ºåº“çš„æ–¹å¼ï¼Œé‚£ä¹ˆå¦‚ä½•è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåº“ï¼Ÿå¦å¤–ä¸€ç‚¹ï¼Œå‰é¢æåˆ°è¿‡ï¼Œåœ¨åŠ¨æ€åº“å†…å¼•å…¥é™æ€åº“ï¼Œä¼šå’Œé¡¹ç›®æœ¬èº«ç”± cocoapods å¼•å…¥çš„åº“åŒåå†²çªï¼Œå¦‚ä½•æ¶ˆé™¤è¿™ä¸€å†²çªï¼Ÿä»¥ä¸Šé—®é¢˜éƒ½å¯ä»¥é€šè¿‡ cocoapods æ‰“åŒ…åº“å®ç°</p>
<h3 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h3><p>åªéœ€è¦è¾“å…¥ pod çš„ <code>lib</code> å‘½ä»¤å³å¯å®Œæˆåˆå§‹é¡¹ç›®çš„æ­å»º:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod lib create StaticWithCocoapods</div></pre></td></tr></table></figure>
<p>è¾“å‡ºæŒ‡ä»¤åï¼Œä¼šæç¤ºç¡®è®¤äº”ä¸ªé—®é¢˜ï¼ŒæŒ‰éœ€æ±‚å›ç­”å³å¯ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_cocoapods_1.png?raw=true" alt="åˆ›å»ºåº“"></p>
<p>ç¨ç­‰ç‰‡åˆ»ï¼Œå°±ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå·¥ç¨‹ã€‚</p>
<h3 id="é…ç½®ä¿¡æ¯"><a href="#é…ç½®ä¿¡æ¯" class="headerlink" title="é…ç½®ä¿¡æ¯"></a>é…ç½®ä¿¡æ¯</h3><p>åœ¨é¡¹ç›®ç›®å½•ä¸‹æœ‰ä¸€ä¸ª <code>xxx.podspec</code> é…ç½®æ–‡ä»¶ï¼Œéœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œæ‘˜å½•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">Pod::Spec.new do |s|</div><div class="line">  s.name             = &apos;StaticWithCocoapods&apos;</div><div class="line">  s.version          = &apos;0.1.0&apos;</div><div class="line">  s.summary          = &apos;A short description of StaticWithCocoapods.&apos;</div><div class="line"></div><div class="line"># This description is used to generate tags and improve search results.</div><div class="line">#   * Think: What does it do? Why did you write it? What is the focus?</div><div class="line">#   * Try to keep it short, snappy and to the point.</div><div class="line">#   * Write the description between the DESC delimiters below.</div><div class="line">#   * Finally, don&apos;t worry about the indent, CocoaPods strips it!</div><div class="line"></div><div class="line">  s.description      = &lt;&lt;-DESC</div><div class="line">TODO: Add long description of the pod here.</div><div class="line">                       DESC</div><div class="line"></div><div class="line">  s.homepage         = &apos;https://github.com/zhang759740844&apos;</div><div class="line">  s.license          = &#123; :type =&gt; &apos;MIT&apos;, :file =&gt; &apos;LICENSE&apos; &#125;</div><div class="line">  s.author           = &#123; &apos;Zachary&apos; =&gt; &apos;759740844@qq.com&apos; &#125;</div><div class="line">  s.source           = &#123; :git =&gt; &apos;/Users/zachary/Desktop/StaticWithCocoapods&apos;, :tag =&gt; s.version.to_s &#125;</div><div class="line"></div><div class="line">  s.ios.deployment_target = &apos;8.0&apos;</div><div class="line"></div><div class="line">  s.source_files = &apos;StaticWithCocoapods/Classes/**/*&apos;</div><div class="line">  </div><div class="line">  s.resource_bundles = &#123;</div><div class="line">    &apos;StaticWithCocoapods&apos; =&gt; [&apos;StaticWithCocoapods/Assets/*.png&apos;]</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  s.public_header_files = &apos;StaticWithCocoapods/Classes/**/*.h&apos;</div><div class="line">  s.frameworks = &apos;UIKit&apos;, &apos;MapKit&apos;</div><div class="line">  s.dependency &apos;AFNetworking&apos;, &apos;~&gt; 2.3&apos;</div><div class="line">  s.denpendency &apos;SVProgressHUD&apos;</div><div class="line">end</div></pre></td></tr></table></figure>
<ul>
<li>s.version è¡¨ç¤ºçš„æ˜¯å½“å‰ç±»åº“çš„ç‰ˆæœ¬å·</li>
<li>s.source è¡¨ç¤ºå½“å‰ç±»åº“æº</li>
<li>s.sources_files è¡¨ç¤ºç±»åº“çš„æºæ–‡ä»¶å­˜æ”¾ç›®å½•</li>
<li>s.resource_bundles è¡¨ç¤ºèµ„æºæ–‡ä»¶å­˜æ”¾ç›®å½•</li>
<li>s.frameworks è¡¨ç¤ºç±»åº“ä¾èµ–çš„framework</li>
<li>s.dependency è¡¨ç¤ºä¾èµ–çš„ç¬¬ä¸‰æ–¹ç±»åº“</li>
</ul>
<p>å…¶ä¸­è¦è¯´æ˜çš„æ˜¯ï¼š </p>
<ol>
<li>source å¯ä»¥å¡«å†™è¿œç«¯ git ä»“åº“ï¼Œä¹Ÿå¯ä»¥æ˜¯åƒæˆ‘å†™çš„é‚£æ ·çš„æœ¬åœ° git ä»“åº“ã€‚</li>
<li>ä¾èµ–é¡¹ä¸ä»…è¦åŒ…å«ä½ è‡ªå·±ç±»åº“çš„ä¾èµ–ï¼Œè¿˜è¦åŒ…æ‹¬æ‰€æœ‰ç¬¬ä¸‰æ–¹ç±»åº“çš„ä¾èµ–ï¼Œåªæœ‰è¿™æ ·å½“ä½ çš„ç±»åº“æ‰“åŒ…æˆ .a æˆ– .framework æ—¶æ‰èƒ½è®©å…¶ä»–é¡¹ç›®æ­£å¸¸ä½¿ç”¨ã€‚</li>
<li>source_file è·¯å¾„ä¸­å‡ºç°çš„é€šé…ç¬¦ <code>*</code> è¡¨ç¤ºåŒ¹é…ä»»æ„å­—ç¬¦ï¼Œ <code>**</code> è¡¨ç¤ºåŒ¹é…æ‰€æœ‰å½“å‰æ–‡ä»¶å¤¹å’Œå­æ–‡ä»¶å¤¹ã€‚</li>
<li>source_bundles ä¸­èŠ±æ‹¬å·å†…çš„ <code>&#39;StaticWithCocoapods&#39;</code> å°±è¡¨ç¤ºä¸€ä¸ª <code>StaticWithCocoapods</code> bundleã€‚</li>
</ol>
<h3 id="æ·»åŠ æ–‡ä»¶"><a href="#æ·»åŠ æ–‡ä»¶" class="headerlink" title="æ·»åŠ æ–‡ä»¶"></a>æ·»åŠ æ–‡ä»¶</h3><p>å‘ <strong>sources_files</strong> å’Œ <strong>public_header_files</strong> ä»¥åŠ <strong>resource_bundle</strong> ä¸­æ·»åŠ å›¾ç‰‡å’Œç±»æ–‡ä»¶ã€‚åœ¨ demo çš„æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œ <code>pod install</code>ã€‚ç°åœ¨æ‰“å¼€ demo å·¥ç¨‹ï¼Œå¯ä»¥çœ‹åˆ°åˆ›å»ºçš„ <code>StaticWithCocoapods</code> åº“çš„æ–‡ä»¶ç»“æ„å¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_cocoapods_2.png?raw=true" alt="æ–‡ä»¶ç»“æ„"></p>
<p>åˆ°è¿™é‡Œä¸€åˆ‡æ­£å¸¸ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>SVProgressHUD</code> ï¼Œä½†æ˜¯å½“æˆ‘æƒ³ç”¨ <code>[UIImage imageNamed:[[[NSBundle mainBundle] pathForResource:@&quot;StaticWithCocoapods&quot; ofType:@&quot;bundle&quot;] stringByAppendingString:@&quot;/author.png&quot;]]</code> åŠ è½½å›¾ç‰‡èµ„æºæ–‡ä»¶æ—¶ï¼Œä¸€ç›´è¿”å› <code>nil</code> ã€‚</p>
<p>å¥½å§ã€‚è™½ç„¶ç½‘ä¸Šcocoapodsæ‰“åŒ…æ•™ç¨‹ä¸å°‘ï¼Œä½†æ˜¯çœŸæ­£è¯•è¿‡æ·»åŠ å›¾ç‰‡çš„äººåº”è¯¥ä¸å¤šï¼Œæœ€ååœ¨ Stackoverflow çš„ä¸€ä¸ªè¯„è®ºé‡Œæ€»ç®—æ‰¾åˆ°äº†è§£å†³æ–¹æ³•<a href="http://stackoverflow.com/questions/25402782/cocoapodsresource-bundle-not-accessbile" target="_blank" rel="external">[Cocoapods]:Resource Bundle not accessbile</a></p>
<p>åŸå…ˆ demo ä¸­ profile çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">use_frameworks!</div><div class="line"></div><div class="line">target <span class="string">'StaticWithCocoapods_Example'</span> <span class="keyword">do</span></div><div class="line">  pod <span class="string">'StaticW'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../'</span></div><div class="line"></div><div class="line">  target <span class="string">'StaticWithCocoapods_Tests'</span> <span class="keyword">do</span></div><div class="line">    inherit! <span class="symbol">:search_paths</span></div><div class="line"></div><div class="line">    pod <span class="string">'FBSnapshotTestCase'</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>ç°åœ¨è¦åˆ é™¤ <code>use_frameworks!</code> ä»¥åŠå…¶ç›¸å…³å†…å®¹ï¼Œå˜æˆè¿™æ ·ï¼š</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">target <span class="string">'StaticWithCocoapods_Example'</span> <span class="keyword">do</span></div><div class="line">  pod <span class="string">'StaticWithCocoapods'</span>, <span class="symbol">:path</span> =&gt; â€˜../â€˜</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>å†æ¬¡å°è¯•åŠ è½½å›¾ç‰‡ï¼Œå¯ä»¥å¾—åˆ°æ­£ç¡®ç»“æœ. ^_^</p>
<h3 id="æäº¤ä»£ç "><a href="#æäº¤ä»£ç " class="headerlink" title="æäº¤ä»£ç "></a>æäº¤ä»£ç </h3><ol>
<li>ä½¿ç”¨ sourcetree æ·»åŠ æœ¬åœ°ä»“åº“</li>
<li>æäº¤ä¸Šé¢çš„æ‰€æœ‰æ”¹åŠ¨</li>
<li>ä¸ºæ”¹åŠ¨æ·»åŠ  tag ä¸º <code>0.1.0</code></li>
</ol>
<p>è®¾ç½®å¥½åå¦‚å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_cocoapods_3.png?raw=true" alt="æäº¤ä»£ç "></p>
<p>è¿™é‡Œè¦æ³¨æ„ï¼Œtag ä¸€å®šè¦æ‰“ä¸Šï¼Œç‰ˆæœ¬æ§åˆ¶çš„æ—¶å€™å°±æ˜¯ä»¥ tag æ¥è¾¨åˆ«çš„ã€‚</p>
<h3 id="éªŒè¯ç±»åº“"><a href="#éªŒè¯ç±»åº“" class="headerlink" title="éªŒè¯ç±»åº“"></a>éªŒè¯ç±»åº“</h3><p>å¼€å‘å®Œæˆé™æ€ç±»åº“ä¹‹åï¼Œéœ€è¦è¿è¡Œpod lib lintéªŒè¯ä¸€ä¸‹ç±»åº“æ˜¯å¦ç¬¦åˆpodçš„è¦æ±‚ã€‚æ·»åŠ  <code>--allow-warnings</code> å¿½ç•¥è­¦å‘Šï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_cocoapods_4.png?raw=true" alt="éªŒè¯ç±»åº“"></p>
<h3 id="æ‰“åŒ…åº“"><a href="#æ‰“åŒ…åº“" class="headerlink" title="æ‰“åŒ…åº“"></a>æ‰“åŒ…åº“</h3><p>æ‰“åŒ…åº“éœ€è¦ä¸€ä¸ª cocoapods çš„æ’ä»¶ <strong>cocoapods-packager</strong>æ¥å®Œæˆç±»åº“çš„æ‰“åŒ…ã€‚</p>
<p>åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…æ’ä»¶ï¼š</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gem install cocoapods-packager</div></pre></td></tr></table></figure>
<p>åœ¨ç›®æ ‡æ–‡ä»¶å¤¹å†…æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®Œæˆæ‰“åŒ…ï¼š</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod package StaticWithCocoapods.podspec --force</div></pre></td></tr></table></figure>
<p>æ‰“åŒ…æˆ <code>.framework</code> ï¼Œä¹Ÿå¯ä»¥ç”¨ <code>--library</code> æ‰“åŒ…æˆ <code>.a</code> ã€‚ä¸è¿‡ cocoapods ä¹‹å‰æœ‰è¿‡æ‰“åŒ…æˆ <code>.a</code> ä½†æ˜¯æ²¡æœ‰æš´éœ²å‡ºå¤´æ–‡ä»¶çš„bugï¼Œæ‡’å¾—è¯•æœ‰æ²¡æœ‰ä¿®å¤äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯éƒ½æ‰“æˆ <code>.framework</code> å§ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/framework_cocoapods_5.png?raw=true" alt="æ‰“åŒ…è¿‡ç¨‹"></p>
<p>ç°åœ¨åœ¨ç›®æ ‡æ–‡ä»¶å¤¹ä¸‹å°±ä¼šå¤šå‡ºä¸€ä¸ª <code>StaticWithCocoapods-0.2.0</code> ç›®å½•ï¼Œé‡Œé¢æ˜¯æ‰“åŒ…å¥½çš„ framework ã€‚</p>
<p>è‡³äºå¦‚ä½•å°†æ‰“åŒ…å¥½çš„åº“æ·»åŠ åˆ° cocoapods çš„å®˜æ–¹åº“å†…ï¼Œè¿™ä¸ªå°±æ²¡æœ‰ç ”ç©¶äº†ï¼Œå› ä¸ºï¼Œåœ¨å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´å†…æˆ‘éƒ½ä¸ä¼šç”¨åˆ°ã€‚æœ‰å…´è¶£çš„å¯ä»¥çœ‹çœ‹ cocoapods çš„å®˜æ–¹æ–‡æ¡£ï¼Œè‡ªè¡Œç ”ç©¶ä¸‹ã€‚</p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://foggry.com/blog/2014/06/12/wwdc2014zhi-iosshi-yong-dong-tai-ku/" target="_blank" rel="external">WWDC2014ä¹‹iOSä½¿ç”¨åŠ¨æ€åº“</a><br><a href="http://blog.csdn.net/lijuan3203/article/details/52105911" target="_blank" rel="external">æ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨CocoaPodsæ‰“åŒ…é™æ€åº“</a><br><a href="http://www.jianshu.com/p/8f5b9855efb8" target="_blank" rel="external">iOS é™æ€åº“å¼€å‘</a><br><a href="http://www.cnblogs.com/brycezhang/p/4117180.html" target="_blank" rel="external">ä½¿ç”¨CocoaPodså¼€å‘å¹¶æ‰“åŒ…é™æ€åº“</a><br><a href="http://www.cocoachina.com/ios/20150228/11206.html" target="_blank" rel="external">ä½¿ç”¨Cocoapodsåˆ›å»ºç§æœ‰podspec</a><br><a href="https://my.oschina.net/kaqijiang/blog/649632" target="_blank" rel="external">iOSé™æ€åº“ ã€.a å’Œframeworkã€‘ã€è¶…è¯¦ç»†ã€‘</a><br><a href="http://www.samirchen.com/create-a-framework/" target="_blank" rel="external">åˆ›å»ºä¸€ä¸ª iOS Framework é¡¹ç›®</a><br><a href="http://blog.csdn.net/u013604612/article/details/43197465" target="_blank" rel="external">iOSå¼€å‘â€”â€”åˆ›å»ºä½ è‡ªå·±çš„Framework</a><br><a href="http://chenhuaizhe.com/jekyll/update/2015/12/13/iOSä¸­çš„workspaceä¸é™æ€åº“.html" target="_blank" rel="external">iOSä¸­workspaceä¸é™æ€åº“</a><br><a href="http://www.cocoachina.com/ios/20150906/13323.html" target="_blank" rel="external">Cocoapods åº”ç”¨ç¬¬ä¸€éƒ¨åˆ† - Xcode åˆ›å»º .framework ç›¸å…³</a><br><a href="http://www.lhjzzu.com/2016/05/06/static-lib/" target="_blank" rel="external">iosæ‰“åŒ…â€“æ‰“åŒ…é™æ€åº“(äº”)</a></p>
<p>å‘¼~æ€»ç®—æŠŠåº“çš„ç›¸å…³çŸ¥è¯†çœ‹å®Œäº†ï¼Œå†™æˆè¿™ç¬¬äºŒç¯‡ã€‚èŠ±äº†åŠä¸ªæœˆæ‰æ€»ç»“å®Œã€‚æœŸé—´å„ç§é—®é¢˜ï¼Œå„ç§é”™è¯¯ä¸çŸ¥é“æ€ä¹ˆè§£å†³ï¼ŒçœŸçš„ç´¯ã€‚ä»¥åè¿˜æ˜¯ç ”ç©¶äº›ç»å¸¸èƒ½ç”¨å¾—åˆ°çš„ä¸œè¥¿å§ã€‚è‡ªå·±åŸºæœ¬ä¸éœ€è¦æ‰“åŒ…åº“<del>~</del></p>
<p><a href="https://github.com/zhang759740844/MyOCDemo/tree/develop/Framework" target="_blank" rel="external">æˆ‘çš„demoåœ°å€ï¼Œæ¬¢è¿å‚è€ƒ</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Storyboard ä½¿ç”¨æ–¹æ³•]]></title>
      <url>http://zhang759740844.github.io/2016/10/13/storyboard%E5%9F%BA%E7%A1%80/</url>
      <content type="html"><![CDATA[<p>Storyboardæ˜¯è‹¹æœå®˜æ–¹ä¸»æ¨çš„ä¸€ä¸ªä»£æ›¿xibçš„ç­–ç•¥ã€‚æœ‰å¿…è¦è¯¦ç»†å­¦ä¹ ä¸‹å®ƒçš„ä½¿ç”¨æ–¹æ³•ã€‚</p>
<a id="more"></a>
<p>å…ˆæ¥çœ‹ä¸€ä¸‹æ€ç»´å¯¼å›¾<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_28.png?raw=true" alt="storyboard_28"></p>
<h2 id="storyboardåŸºç¡€"><a href="#storyboardåŸºç¡€" class="headerlink" title="storyboardåŸºç¡€"></a>storyboardåŸºç¡€</h2><h3 id="storyboardä¼˜åŠ¿"><a href="#storyboardä¼˜åŠ¿" class="headerlink" title="storyboardä¼˜åŠ¿"></a>storyboardä¼˜åŠ¿</h3><p>storyboardèƒ½ä»£æ›¿nibè‡ªç„¶æœ‰å…¶ä¼˜åŠ¿ï¼Œä¸€èˆ¬æ¥è¯´storyboardå…·æœ‰ä»¥ä¸‹å‡ ç§ä¼˜ç‚¹ï¼š</p>
<ul>
<li>storyboardèƒ½å°†nibæ±‡æ€»ç»Ÿä¸€ç®¡ç†</li>
<li>storyboardå¯ä»¥æè¿°å„ç§åœºæ™¯ä¹‹é—´çš„è¿‡æ¸¡ï¼Œè¿™ç§è¿‡æ¸¡è¢«ç§°ä½œ<code>segue</code>ï¼Œstoryboard æŠŠ view controllerå«åšï¼š<code>scene</code>ï¼Œå¯ä»¥é€šè¿‡æ‹–æ‹½å®ç°è¿‡åº¦ï¼Œå‡å°‘ä»£ç </li>
<li>æ”¯æŒtableviewçš„prototype cellï¼Œå¯ä»¥åœ¨storyboardä¸­ç¼–è¾‘cellï¼Œå‡å°‘ä»£ç é‡</li>
</ul>
<h3 id="storyboardçš„åŸºæœ¬ä½¿ç”¨"><a href="#storyboardçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="storyboardçš„åŸºæœ¬ä½¿ç”¨"></a>storyboardçš„åŸºæœ¬ä½¿ç”¨</h3><h4 id="å¯åŠ¨storyboard"><a href="#å¯åŠ¨storyboard" class="headerlink" title="å¯åŠ¨storyboard"></a>å¯åŠ¨storyboard</h4><p>åŠ è½½storyboardè‚¯å®šæ˜¯éœ€è¦ä¸€ä¸ªä¸»å…¥å£çš„ï¼Œè¿™ä¸ªä¸»å…¥å£åœ¨<code>info.plist</code>ä¸­ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_1.png?raw=true" alt="storyboard_1"></p>
<h4 id="åˆå§‹åŒ–ViewController"><a href="#åˆå§‹åŒ–ViewController" class="headerlink" title="åˆå§‹åŒ–ViewController"></a>åˆå§‹åŒ–ViewController</h4><p>ç¡®å®šäº†å“ªä¸ªstoryboardæ˜¯ä¸»å…¥å£ï¼Œé‚£æ˜¾ç„¶ä¹Ÿè¦ç¡®å®šå“ªä¸ªViewControlleræ˜¯storyboardçš„ä¸»å…¥å£ã€‚éœ€è¦é€‰ä¸­ç›¸åº”ViewControllerï¼Œå‹¾é€‰<code>Is Initial View Controller</code><br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_2.png?raw=true" alt="storyboard_2"><br>æ­¤æ—¶ï¼Œå¯¹åº”ViewControllerå‰å‡ºç°ä¸€ä¸ªç®­å¤´<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_3.png?raw=true" alt="storyboard_3"></p>
<h4 id="åˆ›å»ºrelationship-segue"><a href="#åˆ›å»ºrelationship-segue" class="headerlink" title="åˆ›å»ºrelationship segue"></a>åˆ›å»ºrelationship segue</h4><p>å¯¹äºä¸‰å¤§container view controllerï¼Œå³Tab Bar Controllerï¼ŒNavigation Controllerï¼ŒSplit View Controller ï¼Œå¯ä»¥é€šè¿‡æ‹–æ‹½åˆ›å»ºè®¾ç½®relationship segueã€‚</p>
<p>å¦‚ä¸‹å›¾çš„ popup menu æ˜¯ä»tab bar controller è¿åˆ°navigation controller,æ¾æ‰‹åçš„å¼¹å‡ºï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_4.png?raw=true" alt="storyboard_4"><br>è¿æ¥åçš„å›¾æ ‡å¦‚ä¸‹å›¾ï¼Œè¡¨ç¤ºrelationship segue<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_5.png?raw=true" alt="storyboard_5"></p>
<h4 id="å‘½åtabbar-controllerçš„tabbar"><a href="#å‘½åtabbar-controllerçš„tabbar" class="headerlink" title="å‘½åtabbar controllerçš„tabbar"></a>å‘½åtabbar controllerçš„tabbar</h4><p>å¹¶éåœ¨tabbar controlleré‡Œï¼Œè€Œæ˜¯åœ¨ä¸å…¶ç›¸è¿ã€å¯¹åº”çš„controlleré‡Œæ”¹åŠ¨ï¼Œå¦‚å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_6.png?raw=true" alt="storyboard_6"><br>navigation bar çš„ title ä¹Ÿæ˜¯åŒç†ã€‚ä½†æ˜¯ï¼Œå¼ºçƒˆä¸å»ºè®®åœ¨storyboardé‡Œè®¾ç½®navigationbarï¼Œå› ä¸ºstoryboardæ˜¯ä¸ºäº†ç®€åŒ–æ“ä½œçš„ï¼Œä½†æ˜¯è®¾ç½®navigationbarå¤ªéº»çƒ¦äº†ï¼Œè¿˜ä¸å¦‚ä»£ç æ–¹ä¾¿å®ç”¨ã€‚</p>
<h4 id="è®¾ç½®ViewControllerå¯¹åº”çš„ç±»"><a href="#è®¾ç½®ViewControllerå¯¹åº”çš„ç±»" class="headerlink" title="è®¾ç½®ViewControllerå¯¹åº”çš„ç±»"></a>è®¾ç½®ViewControllerå¯¹åº”çš„ç±»</h4><p>é€‰ä¸­ç›¸åº”ViewControllerï¼Œç„¶ååœ¨ Custom Class å†…å†™ä¸Šç›¸åº”ç±»åå³å¯ã€‚æ³¨æ„ï¼Œè¦é€‰ä¸­ ViewController è€Œä¸æ˜¯å…¶ä¸­çš„ Viewï¼Œè¦ç‚¹å‡»å›¾ä¸­çš„é»„è‰²åœ†å½¢æŒ‰é’®ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_7.png?raw=true" alt="storyboard_7"></p>
<h4 id="è·å–è§†å›¾æ§åˆ¶å™¨"><a href="#è·å–è§†å›¾æ§åˆ¶å™¨" class="headerlink" title="è·å–è§†å›¾æ§åˆ¶å™¨"></a>è·å–è§†å›¾æ§åˆ¶å™¨</h4><p>å°±æ˜¯é€šè¿‡<code>UITableViewController</code>å’Œ<code>UINavigationController</code>ä¸­çš„<code>viewControllers</code>è·å–ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UITabBarController</span> *tabBarController = (<span class="built_in">UITabBarController</span> *)<span class="keyword">self</span>.window.rootViewController;</div><div class="line"><span class="built_in">UINavigationController</span> *navigationController = [tabBarController viewControllers][<span class="number">0</span>];</div><div class="line">PlayersViewController *playersViewController = [navigationController viewControllers][<span class="number">0</span>];</div></pre></td></tr></table></figure>
<h4 id="Prototype-cells"><a href="#Prototype-cells" class="headerlink" title="Prototype cells"></a>Prototype cells</h4><p>é€‰ä¸­tableviewï¼Œè®¾ç½®tableviewçš„ cotent ä¸º Dynamic Propotype<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_8.png?raw=true" alt="storyboard_8"><br>ä¸€èˆ¬åœ¨<code>tableView: cellForRowAtIndexPath:</code>æ–¹æ³•ä¸­éƒ½åƒä¸‹é¢ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">NSString</span> *CellIdentifier = <span class="string">@"Cell"</span>;</div><div class="line"></div><div class="line">    <span class="built_in">UITableViewCell</span> *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];</div><div class="line">    <span class="keyword">if</span> (cell == <span class="literal">nil</span>) &#123;</div><div class="line">        cell = [[<span class="built_in">UITableViewCell</span> alloc] initWithStyle:<span class="built_in">UITableViewCellStyleDefault</span></div><div class="line">                                      reuseIdentifier:CellIdentifier];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Configure the cell...</span></div><div class="line">    <span class="keyword">return</span> cell;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œç”±äºåœ¨storyboardä¸­å·²ç»åˆ›å»ºäº†cellï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</div><div class="line">&#123;</div><div class="line">    <span class="built_in">UITableViewCell</span> *cell = [tableView dequeueReusableCellWithIdentifier:<span class="string">@"PlayerCell"</span>];</div><div class="line"></div><div class="line">    <span class="comment">// Configure the cell...</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> cell;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œä¸€ä¸ªtableviewé‡Œè‚¯å®šä¸åº”è¯¥åªæœ‰ä¸€ä¸ªï¼Œå¯ä»¥æŠŠä¸Šé¢çš„ Content ä¸‹é¢çš„ Prototype Cells å¢åŠ cellï¼Œç„¶åé€‰æ‹©ä»»æ„cellï¼Œå¦‚å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_9.png?raw=true" alt="storyboard_9"><br>è®¾ç½®ä¸åŒçš„ identifier æ¥æ ‡è¯†ä¸åŒçš„cellã€‚</p>
<p>é™¤äº†åœ¨viewcontrolleré‡Œç›´æ¥åˆ›å»ºcellï¼Œä¸éœ€è¦å¦ä¸€ä¸ªcellçš„xibçš„åŒºåˆ«å¤–ï¼Œå…¶ä»–æ–¹é¢å’Œxibæ— å¼‚ã€‚ä¹Ÿå¯ä»¥é€‰ä¸­cellï¼Œåœ¨å³è¾¹æ æŒ‡å®šå¯¹åº”çš„Controllerçš„custom classç”¨æ¥æ§åˆ¶cellã€‚åŒæ ·çš„ï¼Œä¹Ÿä¸èƒ½ç›´æ¥æŠŠcellä¸­çš„viewè¿çº¿åˆ°cellæ‰€å±çš„viewControllerä¸­ã€‚</p>
<h4 id="Static-cells"><a href="#Static-cells" class="headerlink" title="Static cells"></a>Static cells</h4><p>ä½¿ç”¨é™æ€çš„cellï¼Œé€‚ç”¨åœ¨ä»…æœ‰å‡ ä¸ªç¡®å®šcellçš„tableviewä¸­ï¼Œä¸èƒ½é‡ç”¨ï¼Œè®¾ç½®äº†å‡ ä¸ªcellï¼Œå°±æ˜¾ç¤ºå‡ ä¸ªcellã€‚static cellsçš„è®¾ç½®å¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_10.png?raw=true" alt="storyboard_10"><br>å› ä¸ºprototype cellsç©¶ç«Ÿæ€ä¹ˆæ˜¾ç¤ºå¯ä»¥åœ¨ä»£ç ä¸­è®¾ç½®ï¼Œæ‰€ä»¥åªéœ€è¦è®¾ç½®æœ‰å‡ ä¸ªå¯é‡ç”¨çš„cellå°±è¡Œäº†ï¼Œè€Œstatic cellså› ä¸ºä¸å¯é‡ç”¨ï¼Œé‚£ä¹ˆè¿™é‡Œçš„è®¾ç½®é€‰é¡¹å°±å˜æˆäº† Sections è®¾ç½®å¤šå°‘æ®µã€‚</p>
<p>é‚£ä¹ˆæ€ä¹ˆè®¾ç½®æ¯ä¸ªsectionæœ‰å¤šå°‘ä¸ªcellå‘¢ï¼Ÿé€‰ä¸­å¦‚ä¸‹å›¾æ‰€ç¤ºçš„åªæœ‰static cellsæ‰æœ‰çš„è“è‰²ç«‹æ–¹ä½“ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_11.png?raw=true" alt="storyboard_11"><br>æ­¤æ—¶å³è¾¹æ å‡ºç°å¦‚å›¾æ‰€ç¤º Table View Section<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_12.png?raw=true" alt="storyboard_12"><br>å¯ä»¥è®¾ç½®æ•°é‡ï¼Œè¡¨å¤´è¡¨å°¾çš„title</p>
<p>å’Œ prototype cell ä¸€æ ·ï¼Œstatic cellå¯ä»¥æŒ‡å®šä¸€ä¸ªä¸“é—¨çš„Controllerã€‚ä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œstatic cell çš„cellä»¥åŠcellä¸­çš„æ§ä»¶éƒ½ç›¸å½“äºç¡®å®šçš„viewï¼Œå› æ­¤ï¼Œstatic cellå¯ä»¥æŠŠcellä»¥åŠcellä¸­çš„æ§ä»¶è¿çº¿åˆ°cellæ‰€å±çš„viewControllerä¸­ã€‚<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåœ¨cellçš„Controllerä¸­è®¾ç½®äº†ä¸€ä¸ªbuttonçš„ç‚¹å‡»äº‹ä»¶ï¼Œç„¶ååˆåœ¨cellæ‰€å±viewControllerä¸­åˆè®¾ç½®äº†ä¸€æ¬¡è¯¥buttonçš„ç‚¹å‡»äº‹ä»¶ï¼Œä¸ä¼šæŠ¥é”™ï¼Œä¸¤ä¸ªç‚¹å‡»äº‹ä»¶éƒ½ä¼šè§¦å‘ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ–¹ä¾¿èµ·è§ï¼Œstatic cell ç›´æ¥åœ¨viewControllerä¸­è¿çº¿è®¾ç½®å°±å¯ä»¥äº†ã€‚</p>
<h2 id="ä½¿ç”¨segue"><a href="#ä½¿ç”¨segue" class="headerlink" title="ä½¿ç”¨segue"></a>ä½¿ç”¨segue</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><h4 id="ä»€ä¹ˆæ˜¯Segue"><a href="#ä»€ä¹ˆæ˜¯Segue" class="headerlink" title="ä»€ä¹ˆæ˜¯Segue"></a>ä»€ä¹ˆæ˜¯Segue</h4><p>Storyboardä¸Šæ¯ä¸€æ ¹ç”¨æ¥ç•Œé¢è·³è½¬çš„çº¿ï¼Œéƒ½æ˜¯ä¸€ä¸ªUIStoryboardSegueå¯¹è±¡ï¼ˆç®€ç§°Segueï¼‰</p>
<h4 id="Segueçš„å±æ€§"><a href="#Segueçš„å±æ€§" class="headerlink" title="Segueçš„å±æ€§"></a>Segueçš„å±æ€§</h4><p>æ¯ä¸€ä¸ªSegueå¯¹è±¡ï¼Œéƒ½æœ‰3ä¸ªå±æ€§</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å”¯ä¸€æ ‡è¯†</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">NSString</span> *identifier;</div><div class="line"><span class="comment">// æ¥æºæ§åˆ¶å™¨</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="keyword">id</span> sourceViewController;</div><div class="line"><span class="comment">// ç›®æ ‡æ§åˆ¶å™¨</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="keyword">id</span> destinationViewController;</div></pre></td></tr></table></figure>
<h4 id="Segueçš„ç±»å‹"><a href="#Segueçš„ç±»å‹" class="headerlink" title="Segueçš„ç±»å‹"></a>Segueçš„ç±»å‹</h4><p>æ ¹æ®Segueçš„æ‰§è¡Œï¼ˆè·³è½¬ï¼‰æ—¶åˆ»ï¼ŒSegueå¯ä»¥åˆ†ä¸º2å¤§ç±»å‹:</p>
<ul>
<li>è‡ªåŠ¨å‹(Action segue)ï¼šç‚¹å‡»æŸä¸ªæ§ä»¶åï¼ˆæ¯”å¦‚æŒ‰é’®ï¼‰ï¼Œè‡ªåŠ¨æ‰§è¡ŒSegueï¼Œè‡ªåŠ¨å®Œæˆç•Œé¢è·³è½¬ã€‚</li>
<li>æ‰‹åŠ¨å‹(Manual segue)ï¼šéœ€è¦é€šè¿‡å†™ä»£ç æ‰‹åŠ¨æ‰§è¡ŒSegueï¼Œæ‰èƒ½å®Œæˆç•Œé¢è·³è½¬ã€‚</li>
</ul>
<h4 id="segueæ‰§è¡Œè¿‡ç¨‹"><a href="#segueæ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="segueæ‰§è¡Œè¿‡ç¨‹"></a>segueæ‰§è¡Œè¿‡ç¨‹</h4><p>æ‰‹åŠ¨è°ƒç”¨<code>performSegueWithIdentifier:sender:</code>æ–¹æ³•å®ç°è·³è½¬ã€‚é‚£ä¹ˆè¿™æœŸé—´å‘ç”Ÿäº†ä»€ä¹ˆå‘¢ï¼Ÿå¤§è‡´åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ã€‚</p>
<ol>
<li>æ ¹æ®<code>identifier</code>å»storyboardä¸­æ‰¾åˆ°å¯¹åº”çš„çº¿ï¼Œæ–°å»ºUIStoryboardSegueå¯¹è±¡</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">instancetype</span>)initWithIdentifier:(<span class="built_in">NSString</span> *)identifier source:(<span class="built_in">UIViewController</span> *)source destination:(<span class="built_in">UIViewController</span> *)destination; <span class="comment">// Designated initializer</span></div></pre></td></tr></table></figure>
<p>å…¶å®å°±æ˜¯æ‰§è¡Œäº†UIStoryboardSegueä¸­<code>initWithIdentifier:source:destination:</code>æ–¹æ³•,å¹¶ä¸”<code>identifier</code>å°±æ˜¯åœ¨Storyboardä¸­Segueå±æ€§è®¾ç½®çš„æ ‡è¯†. æ¥æºå°±æ˜¯è¿çº¿çš„å¤´éƒ¨. ç›®æ ‡å°±æ˜¯è¿çº¿å°¾</p>
<ol>
<li>è°ƒç”¨sourceViewControllerçš„ä¸‹é¢æ–¹æ³•ï¼Œåšä¸€äº›è·³è½¬å‰çš„å‡†å¤‡å·¥ä½œå¹¶ä¸”ä¼ å…¥åˆ›å»ºå¥½çš„Segueå¯¹è±¡</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)prepareForSegue:(<span class="built_in">UIStoryboardSegue</span> *)segue sender:(<span class="keyword">id</span>)sender;</div></pre></td></tr></table></figure>
<p>æ‰€è°“è·³è½¬å‰çš„å‡†å¤‡ï¼Œå› ä¸ºå¯ä»¥æ‹¿åˆ°Segue(æ¥æºæ§åˆ¶å™¨,ç›®æ ‡æ§åˆ¶å™¨)ï¼Œæ‰€ä»¥å°±å¯ä»¥åœ¨è¿™é‡Œç»™ä¸‹ä¸€ä¸ªæ§åˆ¶å™¨ä¼ é€’æ•°æ®ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ç³»ç»Ÿé»˜è®¤è°ƒç”¨ï¼Œæ‰€ä»¥åªéœ€è¦å®ç°å³å¯ã€‚å¦å¤–ï¼Œåªèƒ½ç”±æ¥æºæ§åˆ¶å™¨è°ƒç”¨,æ¥æ‹¿åˆ°ç›®æ ‡æ§åˆ¶å™¨ã€‚</p>
<ol>
<li>è°ƒç”¨Segueå¯¹è±¡çš„<code>perform</code>æ–¹æ³•å¼€å§‹æ‰§è¡Œç•Œé¢è·³è½¬æ“ä½œã€‚</li>
</ol>
<h3 id="é¡µé¢è·³è½¬"><a href="#é¡µé¢è·³è½¬" class="headerlink" title="é¡µé¢è·³è½¬"></a>é¡µé¢è·³è½¬</h3><p>segueå¯ä»¥å®ç°é¡µé¢é—´è·³è½¬ï¼Œé™¤äº†ä¸Šé¢çš„ relationship segue è¿˜æœ‰ Action segue å’Œ Manual segueï¼Œåˆ†åˆ«å¯¹åº”buttonè·³è½¬å’ŒviewControllerè·³è½¬ã€‚</p>
<h4 id="è·³è¿›"><a href="#è·³è¿›" class="headerlink" title="è·³è¿›"></a>è·³è¿›</h4><h5 id="ä½¿ç”¨storyboard"><a href="#ä½¿ç”¨storyboard" class="headerlink" title="ä½¿ç”¨storyboard"></a>ä½¿ç”¨storyboard</h5><p>Action segue æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å°†buttonè¿åˆ°è¦å±•ç¤ºçš„viewControllerä¸Šï¼Œå½“ç‚¹å‡»æ—¶ï¼Œå°±ä¼šè§¦å‘ã€‚<br>Manual segue ç›¸å¯¹æ¯”è¾ƒéº»çƒ¦ï¼Œä½†æ˜¯æ¯”è¾ƒçµæ´»ã€‚å®ƒè®¾ç½®äº†ä¸¤ä¸ªviewControllerçš„è·³è½¬å…³ç³»ï¼Œåœ¨ä½ éœ€è¦çš„æ—¶å€™å‡ºå‘è·³è½¬ã€‚</p>
<p>é¦–å…ˆï¼Œå…ˆå¯¹ä¸¤ä¸ªviewControllerè¿›è¡Œè¿çº¿ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_14.png?raw=true" alt="storyboard_14"><br>ä¹‹åç‚¹å‡»è¿çº¿åä¸¤ä¸ªviewControllerä¹‹é—´äº§ç”Ÿçš„ç®­å¤´ï¼Œåœ¨å³è¾¹æ å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_15.png?raw=true" alt="storyboard_15"><br>å…¶ä¸­å‚æ•° <code>identifier</code> å°±æ˜¯è·³è½¬çš„æ ‡è¯†ç¬¦ï¼Œæ ¹æ®è¿™ä¸ªæ ‡è¯†ç¬¦æ¥ç¡®å®šè·³è½¬åˆ°æ˜¯é‚£ä¸ªé¡µé¢ã€‚ä¸‹é¢å‡ ä¸ªå‚æ•°ï¼Œä¸‹é¢å†è¯´ã€‚</p>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥è°ƒç”¨æ–¹æ³•ï¼Œåœ¨åˆé€‚çš„æ—¶æœºåŠ è½½äº†</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ ¹æ® segue Identifierè·³è½¬ç•Œé¢</span></div><div class="line">[<span class="keyword">self</span> performSegueWithIdentifier:<span class="string">@"GotoTwo"</span> sender:<span class="keyword">self</span>];</div></pre></td></tr></table></figure>
<p>å…¶ä¸­çš„<code>identifer</code>è‡ªç„¶ä¸ç”¨å¤šè¯´ï¼Œé‚£ä¹ˆ<code>sender</code>æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<code>sender</code>æ˜¯å‚æ•°åç§°ï¼Œç†è®ºä¸Šå¯ä»¥æŒ‡ä»£ä»»ä½•å¯¹è±¡ï¼Œç”¨æ¥åŒºåˆ†æ˜¯å“ªä¸ªæ§ä»¶è§¦å‘äº†segueã€‚æ¯”å¦‚æœ‰ä¸¤ä¸ªbuttonéƒ½è·³è½¬åˆ°ä¸€ä¸ªé¡µé¢ï¼Œé‚£ä¹ˆè¿™æ—¶å°±å¯ä»¥è®¾ç½®<code>sender</code>åŒºåˆ†äº†ã€‚å¼•ç”³å¼€æ¥ï¼Œåœ¨è®¾ç½®buttonç‚¹å‡»äº‹ä»¶æ—¶çš„<code>-(IBAction)click:(id)sender;</code>æ–¹æ³•ä¸­çš„<code>sender</code>å’Œè¿™é‡Œçš„<code>sender</code>æ˜¯ä¸€ä¸ªä½œç”¨ã€‚</p>
<h5 id="ä½¿ç”¨çº¯ä»£ç "><a href="#ä½¿ç”¨çº¯ä»£ç " class="headerlink" title="ä½¿ç”¨çº¯ä»£ç "></a>ä½¿ç”¨çº¯ä»£ç </h5><p>ä¸Šé¢çš„æ–¹æ³•å®ç°æ•ˆæœå’Œå¹³æ—¶ç”¨çš„ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•ç›¸åŒï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ä»¥modal æ–¹å¼è·³è½¬</span></div><div class="line">[<span class="keyword">self</span> presentViewController:ViewController animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</div><div class="line"><span class="comment">//å‹è¿›ä¸€ä¸ªviewcontroller</span></div><div class="line">[<span class="keyword">self</span>.navigationController pushViewController:ViewController animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<p>ä¸è¿‡ï¼Œæ—¢ç„¶ç”¨äº†storyboardäº†ï¼Œé‚£ä¹ˆå®ä¾‹åŒ–viewControlleræ—¶å°±ä¸èƒ½ç”¨<code>initWithNibName</code>äº†ã€‚åœ¨storyboardä¸­ï¼Œè¦é€šè¿‡storyboardæ‰¾åˆ°viewControllerçš„å¸ƒå±€ã€‚é¦–å…ˆè¦è®¾ç½®viewcontrollerçš„ storyboardIDï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_19.png?raw=true" alt="storyboard_19"><br>é‚£ä¸ª<code>use storyboardId</code>çš„å‹¾ä¸æ‰“ä¹Ÿè¡Œï¼Œä¸çŸ¥é“å¹²ä»€ä¹ˆç”¨çš„ï¼Œ</p>
<p>ç°åœ¨å°±å¯ä»¥åœ¨ä»£ç ä¸­æ‰¾åˆ°ç‰¹å®šstoryboardçš„viewcontrolleräº†ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">IBAction</span>)tapButton:(<span class="keyword">id</span>)sender &#123;</div><div class="line">    <span class="comment">//è·å–storyboard: é€šè¿‡bundleæ ¹æ®storyboardçš„åå­—æ¥è·å–æˆ‘ä»¬çš„storyboard,</span></div><div class="line">    <span class="built_in">UIStoryboard</span> *story = [<span class="built_in">UIStoryboard</span> storyboardWithName:<span class="string">@"Main"</span> bundle:<span class="literal">nil</span>];</div><div class="line">    <span class="comment">//ç”±storyboardæ ¹æ®myViewçš„storyBoardIDæ¥è·å–æˆ‘ä»¬è¦åˆ‡æ¢çš„è§†å›¾</span></div><div class="line">    <span class="built_in">UIViewController</span> *myView = [story instantiateViewControllerWithIdentifier:<span class="string">@"myView"</span>];</div><div class="line">    <span class="comment">//æ˜¾ç¤ºViewController</span></div><div class="line">    [<span class="keyword">self</span> presentViewController:myView animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="è·³å‡º"><a href="#è·³å‡º" class="headerlink" title="è·³å‡º"></a>è·³å‡º</h4><p>èƒ½è·³è¿›å½“ç„¶ä¹Ÿè¦èƒ½è·³å‡ºï¼Œå¯ä»¥ä½¿ç”¨ exit segue è·³è½¬è‡³ä»»æ„è¿çº¿çš„ä½ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä»£ç è·³è½¬ã€‚</p>
<h5 id="exit-segue"><a href="#exit-segue" class="headerlink" title="exit segue"></a>exit segue</h5><p>è·³å‡ºå’Œè·³è¿›çš„æ–¹æ³•ç±»ä¼¼ï¼Œç•¥æœ‰åŒºåˆ«ï¼Œæ¯”å¦‚è¦ä»ç•Œé¢2è·³è½¬å›ç•Œé¢1ï¼š</p>
<p>å…ˆæ‰“å¼€éœ€è¦è¿”å›åˆ°çš„ç•Œé¢ViewController1.m,åŠ ä¸Šä¸‹é¢æ–¹æ³•ï¼Œè¿”å›ç±»å‹ä¸€å®šæ˜¯<code>IBAction</code>ï¼Œå‚æ•°ç±»å‹<strong>ä¸€å®š</strong>æ˜¯<code>UIStoryboardSegue</code>ï¼Œåç§°éšä¾¿ï¼ˆè¿™ä¸ªæ–¹æ³•ä¸€å®šè¦åŠ ï¼Œè¿”å›æ—¶è°ƒç”¨çš„ï¼‰</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å…¶ä»–ç•Œé¢è¿”å›åˆ°æ­¤ç•Œé¢è°ƒç”¨çš„æ–¹æ³•</span></div><div class="line">- (<span class="keyword">IBAction</span>)ViewController1UnwindSegue:(<span class="built_in">UIStoryboardSegue</span> *)unwindSegue &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å³é”®2ç•Œé¢ä¸Šæ–¹çš„Exitï¼ˆä¸‹å›¾ä¸­ç”»ç»¿åœˆçš„ï¼‰å¼¹å‡ºèœå•ä¸­å¯ä»¥çœ‹åˆ°åˆšæ‰åœ¨1ç•Œé¢ä¸­åŠ çš„é‚£ä¸ªæ–¹æ³•çš„åç§°ï¼ˆä¸‹å›¾ä¸­çº¢è‰²åœˆé‡Œï¼‰ï¼Œç„¶åå¦‚ä¸‹å›¾ä¸€æ ·è¿çº¿ï¼Œå¼¹å‡ºèœå•é€‰æ‹©<code>manual</code>ï¼Œè¿™é‡Œè¿æ¥è‡ªå·±è¡¨ç¤ºè¦åœ¨å½“å‰viewcontrollerä¸­ç”¨ä»£ç çš„æ–¹å¼å›é€€ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_17.png?raw=true" alt="storyboard_17"></p>
<p>ç»™2è§†å›¾çš„unwind segueå–ä¸€ä¸ªåå­—å«<code>from2to1</code>çš„identifierå¦‚ä¸‹å›¾:<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_18.png?raw=true" alt="storyboard_18"></p>
<p>ç°åœ¨å°±å¯ä»¥åœ¨ç•Œé¢2ä¸­çš„ä»»æ„æ—¶å€™è°ƒç”¨æ–¹æ³•å›é€€äº†ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">IBAction</span>)back:(<span class="keyword">id</span>)sender &#123;</div><div class="line">ã€€ã€€<span class="comment">//æ‰§è¡Œsegueè·³é¡µçš„æ–¹æ³•</span></div><div class="line">    [<span class="keyword">self</span> performSegueWithIdentifier:<span class="string">@"from2to1"</span> sender:<span class="literal">nil</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨çš„ä»æ˜¯è·³è¿›æ—¶ç”¨çš„æ–¹æ³•ï¼Œä¸è¿‡ç¬¬ä¸€æ­¥çš„æ“ä½œå·²ç»å‘Šè¯‰xcodeè¿™æ˜¯ä¸€ä¸ªå›é€€æ“ä½œäº†ã€‚å¯ä»¥ä»ä¸Šå›¾çœ‹åˆ°ï¼Œè¿™ä¸ª Unwind Segue ç»‘å®šäº†å›é€€åˆ°çš„ç•Œé¢çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå› æ­¤ï¼Œæ‰§è¡Œè·³è½¬åä¼šæ‰§è¡Œç»‘å®šçš„æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å…¶ä»–ç•Œé¢è¿”å›åˆ°æ­¤ç•Œé¢è°ƒç”¨çš„æ–¹æ³•</span></div><div class="line">- (<span class="keyword">IBAction</span>)ViewController1UnwindSegue:(<span class="built_in">UIStoryboardSegue</span> *)unwindSegue &#123;</div><div class="line">    <span class="keyword">if</span> ([unwindSegue.identifier isEqualToString:<span class="string">@"from2to1"</span>]) &#123;</div><div class="line">        _lbShowMessage.text = <span class="string">@"ä»2é€€åˆ°1"</span>;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([unwindSegue.identifier isEqualToString:<span class="string">@"from3to1"</span>]) &#123;</div><div class="line">        _lbShowMessage.text = <span class="string">@"ä»3é€€åˆ°1"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå°±çœ‹å‡ºä¸Šé¢ä¸ºä»€ä¹ˆè¯´ç±»å‹ä¸€å®šæ˜¯<code>UIStoryboardSegue</code>äº†ï¼Œå› ä¸ºå¯ä»¥æ¥æ”¶ä¸€ä¸ªè¯¥ç±»å‹çš„å¯¹è±¡ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯ä»å“ªä¸ªé¡µé¢çš„å›é€€ã€‚</p>
<p>ä½¿ç”¨ exit segue çš„<strong>å¥½å¤„</strong>æ˜¯å¯ä»¥è·³è½¬åˆ°ä»»æ„æ‰“å¼€è¿‡çš„ç•Œé¢æ¯”å¦‚ä»3-&gt;1ï¼Œè€Œä¸æ˜¯åªèƒ½è¿”å›ä¸Šçº§ç•Œé¢ä»2-&gt;1ã€‚</p>
<h5 id="ä¸€èˆ¬è·³å‡ºæ–¹æ³•"><a href="#ä¸€èˆ¬è·³å‡ºæ–¹æ³•" class="headerlink" title="ä¸€èˆ¬è·³å‡ºæ–¹æ³•"></a>ä¸€èˆ¬è·³å‡ºæ–¹æ³•</h5><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä»£ç æ ¹æ®æ˜¯modelç±»å‹è¿˜æ˜¯pushç±»å‹é€‰æ‹©ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å¼¹å‡ºä¸€ä¸ªviewcontroller  ç›¸å½“ä¸è¿”å›ä¸Šä¸€ä¸ªç•Œé¢</span></div><div class="line">[<span class="keyword">self</span>.navigationController popViewControllerAnimated:<span class="literal">YES</span>];   </div><div class="line"><span class="comment">// ä»¥ modalè·³è½¬çš„è¿”å›æ–¹æ³•</span></div><div class="line">[<span class="keyword">self</span> dismissViewControllerAnimated:<span class="literal">YES</span>];</div></pre></td></tr></table></figure>
<h3 id="è·³è½¬çš„æ–¹å¼"><a href="#è·³è½¬çš„æ–¹å¼" class="headerlink" title="è·³è½¬çš„æ–¹å¼"></a>è·³è½¬çš„æ–¹å¼</h3><p>åœ¨è¿›è¡Œè·³è½¬è¿çº¿åä¼šå‡ºç°å¦‚ä¸‹çª—å£ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_13.png?raw=true" alt="storyboard_13"><br>å…±æœ‰ä¸‰ç§è·³è½¬æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢å³è¾¹æ çš„<code>Kind</code>å±æ€§</p>
<h4 id="push"><a href="#push" class="headerlink" title="push"></a>push</h4><p>Pushç±»å‹å¿…é¡»ç”¨åœ¨NavigationControllerä¸­ï¼Œå¦åˆ™æŠ¥é”™ã€‚æ˜¯åœ¨navigation View Controllerä¸­ä¸‹ä¸€çº§æ—¶ä½¿ç”¨çš„é‚£ç§ä»å³ä¾§åˆ’å…¥çš„æ–¹å¼ã€‚</p>
<h4 id="model"><a href="#model" class="headerlink" title="model"></a>model</h4><p>æœ€å¸¸ç”¨çš„åœºæ™¯ï¼Œæ–°çš„åœºæ™¯å®Œå…¨ç›–ä½äº†æ—§çš„é‚£ä¸ªã€‚ç”¨æˆ·æ— æ³•å†ä¸ä¸Šä¸€ä¸ªåœºæ™¯äº¤äº’ï¼Œé™¤éä»–ä»¬å…ˆå…³é—­è¿™ä¸ªåœºæ™¯ã€‚å¯ä»¥åœ¨å³è¾¹æ çš„<code>Presentation</code>é€‰æ‹©éœ€è¦å±•ç¤ºçš„åŠ¨ç”»æ•ˆæœã€‚</p>
<h4 id="custom"><a href="#custom" class="headerlink" title="custom"></a>custom</h4><p>è‡ªå®šä¹‰ç±»å‹ï¼Œéœ€è¦ç»§æ‰¿UIStoryboardSegueç±»ï¼Œç„¶åé‡å†™Performæ–¹æ³•,ç„¶ååœ¨Storyboardä¸Šå°†ç±»è®¾ç½®ä¸ºè‡ªå®šä¹‰çš„ç±»ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_16.png?raw=true" alt="storyboard_16"><br>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯åˆ›å»ºä»ä¸­å¿ƒæ¸å˜å……æ»¡å±å¹•çš„åŠ¨ç”»:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">-(<span class="keyword">void</span>)perform&#123;</div><div class="line">    <span class="built_in">UIViewController</span> * svc = <span class="keyword">self</span>.sourceViewController;</div><div class="line">    <span class="built_in">UIViewController</span> * dvc = <span class="keyword">self</span>.destinationViewController;</div><div class="line">    [svc.view addSubview:dvc.view];</div><div class="line">    [dvc.view setFrame:svc.view.frame];</div><div class="line">    [dvc.view setTransform:<span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">0.5</span>, <span class="number">0.5</span>)];</div><div class="line">    [dvc.view setAlpha:<span class="number">0.0</span>];</div><div class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">1.0</span></div><div class="line">                     animations:^&#123;</div><div class="line">                         [dvc.view setTransform:<span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">1.0</span>, <span class="number">1.0</span>)];</div><div class="line">                         [dvc.view setAlpha:<span class="number">1.0</span>];</div><div class="line">                     &#125;</div><div class="line">                     completion:^(<span class="built_in">BOOL</span> finished) &#123;</div><div class="line">                         [svc presentViewController:dvc animated:<span class="literal">NO</span> completion:<span class="literal">nil</span>];</div><div class="line">                     &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶å®å®è´¨è¿˜æ˜¯<code>presentViewController</code>ï¼Œä½†æ˜¯ä¸ç”¨ç³»ç»Ÿå¸¦çš„<code>animation</code>ï¼Œè€Œæ˜¯å…ˆå°†<code>destinationViewController</code>çš„é¡µé¢ç”¨åŠ¨ç”»åŠ è½½åï¼Œç›´æ¥<code>present</code>ã€‚</p>
<h3 id="è·³è½¬ä¼ å€¼"><a href="#è·³è½¬ä¼ å€¼" class="headerlink" title="è·³è½¬ä¼ å€¼"></a>è·³è½¬ä¼ å€¼</h3><p>å‰é¢è¯´åˆ°ï¼Œ<code>- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender</code>æ–¹æ³•ä¼šåœ¨è·³è½¬æ—¶è‡ªåŠ¨è§¦å‘ã€‚è·³è½¬ä¼ å€¼å°±åœ¨è¿™ä¸ªæ–¹æ³•å†…å®Œæˆã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å¯¹Segueçš„æ ‡è¯†è¿›è¡Œåˆ¤æ–­ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)prepareForSegue:(<span class="built_in">UIStoryboardSegue</span> *)segue sender:(<span class="keyword">id</span>)sender</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> ([segue.identifier  isEqual: <span class="string">@"login2index"</span>]) &#123;</div><div class="line">        <span class="comment">// éœ€è¦æ‰§è¡Œçš„ä»£ç </span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)prepareForSegue:(<span class="built_in">UIStoryboardSegue</span> *)segue sender:(<span class="keyword">id</span>)sender</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> ([segue.destinationViewController isKindOfClass:[IndexTableViewController <span class="keyword">class</span>]]) &#123;</div><div class="line">        <span class="comment">//  æ‰§è¡Œä»£ç </span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ç§éœ€è¦åœ¨è®¾ç½®æ ‡è¯†çš„å€¼,å¹¶ä¸”åŒ¹é…ã€‚ç¬¬äºŒç§å´æ˜¯é€šè¿‡ç›®æ ‡æ§åˆ¶å™¨åˆ¤æ–­ã€‚ä¸ªäººæ„Ÿè§‰è¿˜æ˜¯ç¬¬ä¸€ç§é è°±ä¸€äº›ã€‚</p>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥å¯¹<code>destination</code>è¿›è¡Œèµ‹å€¼äº†ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)prepareForSegue:(<span class="built_in">UIStoryboardSegue</span> *)segue sender:(<span class="keyword">id</span>)sender</div><div class="line">&#123;</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"è§¦å‘è¯¥åœºæ™¯åˆ‡æ¢çš„senderå¯¹è±¡çš„ç±»å‹æ˜¯:%@"</span>,[sender <span class="keyword">class</span>]);</div><div class="line">    </div><div class="line">    <span class="comment">//æ–¹æ³•ä¸€,ä½¿ç”¨KVCç»™B ä¹Ÿå°±æ˜¯ç›®æ ‡åœºæ™¯ä¼ å€¼</span></div><div class="line">    <span class="built_in">UIViewController</span> *destinationController=[segue destinationViewController];</div><div class="line">    [destinationController setValue:<span class="string">@"119"</span> forKey:<span class="string">@"number"</span>];</div><div class="line">    </div><div class="line">    <span class="comment">//æ–¹æ³•2,ä½¿ç”¨å±æ€§ä¼ å€¼,éœ€å¯¼å…¥ç›¸å…³çš„ç±».h</span></div><div class="line">    <span class="comment">//BViewController *bController=[segue destinationViewController];</span></div><div class="line">    <span class="comment">//bController.number=@188;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è·³è½¬ä¼ å€¼ä¸ä»…å¯ä»¥ç”¨<code>prepareForSegue:sender:</code>å®ç°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»£ç†ã€é€šçŸ¥çš„æ–¹å¼ï¼Œä¸è¿‡è¿™æ ·æŒºéº»çƒ¦çš„ï¼Œä¸æ¨èã€‚å…·ä½“å‚è§<a href="http://blog.csdn.net/mad1989/article/details/7919504#comments" target="_blank" rel="external">ä½¿ç”¨storyboardå®ç°é¡µé¢è·³è½¬ï¼Œç®€å•çš„æ•°æ®ä¼ é€’</a></p>
<h3 id="å¤šåˆ†æ”¯NavigationController"><a href="#å¤šåˆ†æ”¯NavigationController" class="headerlink" title="å¤šåˆ†æ”¯NavigationController"></a>å¤šåˆ†æ”¯NavigationController</h3><p>ä¸»è¦åº”ç”¨åœ¨ä¸‹é¢è¿™ç§æƒ…å†µï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_20.png?raw=true" alt="storyboard_20"><br>navigationControllerè¦åˆ†æƒ…å†µè·³è½¬åˆ°ç•Œé¢Aæˆ–è€…ç•Œé¢Bï¼Œä½†æ˜¯navigationControlleråªèƒ½æœ‰ä¸€ä¸ª<code>rootViewController</code>å•Šã€‚æ‰€ä»¥ï¼Œé€šè¿‡ä¸€ä¸ªç©ºçš„<code>ParentViewController</code>åœ¨<code>viewWillAppear:</code>æ–¹æ³•ä¸­åŠ è½½ä»»æ„ä¸€ä¸ª<code>ChildViewController</code>ã€‚å¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_22.png?raw=true" alt="storyboard_22"></p>
<p>æ³¨æ„ï¼Œä¸Šå›¾çº¢æ¡†ä¸­çš„åˆ†æ”¯ï¼Œå…¶å®<strong>è¡¨ç°çš„åªæ˜¯ä¸€ä¸ªé¡µé¢çš„ä¸¤ç§å½¢æ€</strong>ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªé¡µé¢ã€‚æ‰€ä»¥åŠ è½½<code>childViewController</code>çš„segueéƒ½è¦ç”¨ä¸å¸¦ä»»ä½•åŠ¨ç”»çš„<code>custome</code>ç±»å‹ã€‚å› ä¸ºå¦‚æœ<code>ChildViewController</code>æœ‰åŠ¨ç”»ï¼Œé‚£ä¹ˆå°±ä¼šæš´éœ²å‡º<code>ParentViewController</code>ä¸­çš„ç©ºç™½éƒ¨åˆ†ï¼Œå°±è¡¨ç°ä¸ºä¸¤ä¸ªé¡µé¢äº†ã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥é€šè¿‡<code>parent</code>ï¼Œä»<code>C1</code>ç›´æ¥è·³åˆ°<code>C2</code>ï¼Œå¦‚æœä¸ç”¨è¿™ç§çˆ¶å­ViewControllerçš„æ–¹å¼ï¼Œé‚£ä¹ˆä¸å¯é¿å…çš„å°±å¾—å…ˆä»<code>C1</code>è·³å›å‰ä¸€çº§é¡µé¢ï¼Œç„¶åå†ä»å‰ä¸€çº§é¡µé¢è·³åˆ°<code>C2</code>ã€‚ä¸è¿‡ç¼ºç‚¹å°±æ˜¯<code>C1</code>åˆ°<code>C2</code>çš„è·³è½¬æ²¡æœ‰ä»»ä½•è·³è½¬åŠ¨ç”»ã€‚</p>
<p>ä¸è¿‡ï¼Œæ€è€ƒäº†ä¸€æ®µæ—¶é—´åï¼Œè§‰å¾—å¤šåˆ†æ”¯NavigationControlleræœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œç”¨çˆ¶å­ViewControllerçš„æ–¹å¼è™½ç„¶èƒ½è§£å†³ï¼Œä½†æ˜¯æŠŠé—®é¢˜å¤æ‚åŒ–äº†ã€‚æ¯”å¦‚åº”ç”¨åœ¨ç™»å½•è·³è½¬ä¸Šï¼Œæˆ‘å®Œå…¨å¯ä»¥ä¸ç”¨åœ¨åŠ è½½NavigationControlleråå†åˆ¤æ–­æ˜¯å¦è¦ç™»å½•ï¼Œè€Œæ˜¯æŠŠè¿™ä¸€è¿‡ç¨‹æ”¾åˆ°åŠ è½½NavigationControllerä¹‹å‰ã€‚è‡³äºå¯ä»¥ç›´æ¥è·³è½¬çš„è¿™ä¸€å¥½å¤„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œäº§å“ä¹Ÿä¸ä¼šè¿™ä¹ˆè®¾è®¡ï¼Œè€Œä¸”å®ƒçš„å¼Šç«¯ä¹Ÿæ˜¯å¾ˆæ˜æ˜¾çš„ã€‚</p>
<p>å…·ä½“å®ç°çš„è¿‡ç¨‹å‚è§<a href="http://www.cnblogs.com/shanpow/p/4149462.html" target="_blank" rel="external">åŸºäºStoryboardçš„åˆ›å»ºå¤šåˆ†æ”¯NavigationControllerçš„æ–¹æ³•</a>ã€‚è®°å¾—å¦‚æœä½¿ç”¨è¿™ç§æ–¹æ³•çš„è¯ï¼Œä¸€å®šè¦æ¸…é™¤<code>Parent</code>ä¸­ä¸Šæ¬¡æ˜¾ç¤ºçš„<code>ChildViewController</code>ï¼Œæ–‡ä¸­åœ¨<code>prepareForSegue:sender:</code>æ–¹æ³•ä¸­æ¸…é™¤ï¼Œæ˜¯ä¸ªå¾ˆå¥½çš„æ—¶æœºã€‚ </p>
<h2 id="storyboard-reference"><a href="#storyboard-reference" class="headerlink" title="storyboard reference"></a>storyboard reference</h2><p>iOS9ä¸­ï¼Œè‹¹æœå¼•å…¥äº† storyboard reference ç”¨ä»¥å‡å°storyboardçš„ä½“ç§¯ï¼Œæ–¹ä¾¿ç®¡ç†ï¼ˆå¹¶ä¸çŸ¥é“iOS9ä¹‹å‰æ€ä¹ˆç”¨å¤šä¸ªstoryboardï¼‰ã€‚</p>
<h3 id="ç®€åŒ–ç°æœ‰storyboard"><a href="#ç®€åŒ–ç°æœ‰storyboard" class="headerlink" title="ç®€åŒ–ç°æœ‰storyboard"></a>ç®€åŒ–ç°æœ‰storyboard</h3><p>å¦‚ä¸‹å›¾ï¼Œæ˜¯åšä¸Šé¢ç»ƒä¹ æ—¶åˆ›å»ºçš„ä¸€ä¸ªstoryboardï¼Œç•Œé¢å·²ç»æœ‰ç‚¹å¤šäº†ã€‚å¯ä»¥ä½¿ç”¨storyboard referenceç®€åŒ–ï¼Œå°†ä¸€éƒ¨åˆ†viewcontrolleræ‹†åˆ†åˆ°å…¶ä»–storyboardé‡Œã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_23.png?raw=true" alt="storyboard_23"></p>
<p>åšæ³•å…¶å®å¾ˆç®€å•ï¼Œé€‰ä¸­æƒ³è¦æ‹†åˆ†çš„viewcontrollerï¼Œç„¶ååœ¨èœå•æ å¹²ä¸­â€œEditor-&gt;Refactor to Storyboardâ€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ç„¶åå‘½åæ–°çš„storyboardå³å¯ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_24.png?raw=true" alt="storyboard_24"></p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_25.png?raw=true" alt="storyboard_25"></p>
<h3 id="åŠ è½½storyboardä¸­ä¸€ä¸ªç‰¹å®šviewController"><a href="#åŠ è½½storyboardä¸­ä¸€ä¸ªç‰¹å®šviewController" class="headerlink" title="åŠ è½½storyboardä¸­ä¸€ä¸ªç‰¹å®šviewController"></a>åŠ è½½storyboardä¸­ä¸€ä¸ªç‰¹å®šviewController</h3><p>å’Œæ‹–æ‹½å…¶ä»–æ§ä»¶ä¸€æ ·ï¼Œæ‰¾åˆ°storyboardæ§ä»¶ï¼Œæ‹–æ‹½åˆ°storyboardä¸Šï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_26.png?raw=true" alt="storyboard_26"></p>
<p>ç„¶åè®¾ç½®storyboardï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/storyboard_27.png?raw=true" alt="storyboard_27"><br>è¿™é‡Œé¢<code>storyboard</code>å¡«çš„æ˜¯ç›®æ ‡storboardçš„æ–‡ä»¶åï¼›<code>Reference ID</code>æ˜¯å•¥ï¼Ÿä»å®ƒçš„æç¤ºä¹Ÿå°±æ‰å‡ºæ¥äº†ï¼Œç”¨æ¥ç¡®å®šè”ç»“çš„æ˜¯é‚£ä¸ªviewControllerï¼Œå¡«çš„æ˜¯ç›®æ ‡storyboardä¸­ç›®æ ‡viewControllerçš„<code>Storyboard ID</code>ï¼Œå…·ä½“åœ¨å“ªè®¾ï¼Œä¸Šé¢ä¹Ÿè¯´è¿‡ã€‚</p>
<p>è¿™æ ·ï¼Œä¸€ä¸ªç®€æ´çš„storyboardå°±èƒ½åˆ›å»ºå‡ºæ¥äº†ã€‚</p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://www.jianshu.com/p/2ec2c19f183e" target="_blank" rel="external">ã€Storyboardã€‘Storyboardä»‹ç»åŠä½¿ç”¨</a></p>
<p><a href="http://birdmichael.com/?p=180" target="_blank" rel="external">UIStoryboardSegueè®²è§£</a>;</p>
<p><a href="http://blog.csdn.net/yangbingbinga/article/details/43704269" target="_blank" rel="external">iOS-prepareForSegueåœºæ™¯åˆ‡æ¢,KVCä¼ å€¼</a>;</p>
<p><a href="http://blog.csdn.net/mad1989/article/details/7919504#comments" target="_blank" rel="external">(4.4.1)ä½¿ç”¨storyboardå®ç°é¡µé¢è·³è½¬ï¼Œç®€å•çš„æ•°æ®ä¼ é€’</a>;</p>
<p><a href="http://blog.csdn.net/xuqiang918/article/details/17023737" target="_blank" rel="external">ã€iOSç•Œé¢å¤„ç†ã€‘ä½¿ç”¨storyboardå®ç°é¡µé¢è·³è½¬ï¼Œç®€å•çš„æ•°æ®ä¼ é€’</a></p>
<p><a href="https://www.shinobicontrols.com/blog/ios9-day-by-day-day3-storyboard-references" target="_blank" rel="external">iOS9 Day-by-Day :: Day 3 :: Storyboard References</a>;</p>
<p><a href="http://www.cnblogs.com/shanpow/p/4149462.html" target="_blank" rel="external">åŸºäºStoryboardçš„åˆ›å»ºå¤šåˆ†æ”¯NavigationControllerçš„æ–¹æ³•</a>;</p>
<p><a href="http://blog.csdn.net/yangmeng13930719363/article/details/49886901" target="_blank" rel="external">iOS 9 Storyboard æ•™ç¨‹(ä¸€ä¸‹)</a>;</p>
<p><a href="http://www.xmcgraw.com/10-practical-tips-for-ios-developers-using-storyboards/" target="_blank" rel="external">10 Practical Tips for iOS Developers Using Storyboards</a>;</p>
<p>è¿˜æœ‰ä¸€äº›çœ‹å®Œéšæ‰‹å°±å…³äº†ï¼Œæ²¡æœ‰è®°å½•ã€‚</p>
<p>æ°´å¹³æœ‰é™ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œå¤šå¤šæŒ‡æ­£~</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[oc ä¸­çš„æ³›å‹ä¸nullability]]></title>
      <url>http://zhang759740844.github.io/2016/09/28/oc%E6%96%B0%E7%89%B9%E6%80%A7/</url>
      <content type="html"><![CDATA[<p>ocä¸­æ·»åŠ äº†ä¸€äº›å…³é”®å­—ï¼Œä¸»è¦ä½œç”¨äºç¼–è¯‘æœŸï¼Œå¯¹ç¨‹åºæ²¡æœ‰ä»»ä½•å½±å“ï¼Œç›¸å½“äºæ˜¯ä¸€ä¸ªæç¤ºã€‚ä¸‹é¢å°†ç»“åˆ<a href="https://my.oschina.net/u/2340880/blog/514804" target="_blank" rel="external">Objectiveâ€”Cè¯­è¨€çš„æ–°é­…åŠ›â€”â€”Nullabilityã€æ³›å‹é›†åˆä¸ç±»å‹å»¶æ‹“</a>å¯¹ocçš„è¿™äº›æ–°ç‰¹æ€§è¿›è¡Œç ”ç©¶ã€‚</p>
<a id="more"></a>
<h2 id="Nullabilityæ£€æµ‹çš„æ”¯æŒ"><a href="#Nullabilityæ£€æµ‹çš„æ”¯æŒ" class="headerlink" title="Nullabilityæ£€æµ‹çš„æ”¯æŒ"></a>Nullabilityæ£€æµ‹çš„æ”¯æŒ</h2><p>å¯ä»¥ä½¿ç”¨<code>nullable</code>å…³é”®å­—ï¼Œè¡¨æ˜è¯¥å¯¹è±¡å¯ä»¥æ˜¯ç©ºå€¼;ä½¿ç”¨<code>nonnull</code>å…³é”®å­—è¡¨æ˜ä¸å¯ä»¥æ˜¯ç©ºå¯¹è±¡ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) ObjectType firstObject;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) ObjectType lastObject;</div></pre></td></tr></table></figure>
<p>è¿™æ˜¯NSArrayä¸­çš„ä¸¤ä¸ªå±æ€§ï¼Œå…¶ä¸­<code>nullable</code>å…³é”®å­—è¯´æ˜äº†è¿™é‡Œå¯èƒ½è¿”å›ç©ºçš„å€¼ã€‚</p>
<p>å¦‚æœä»…ä»…æ˜¯åœ¨è¿”å›å€¼ä¸­ç»™å¼€å‘è€…ä¸€äº›æç¤ºï¼Œä½ å¯èƒ½è§‰å¾—åº”ç”¨å¹¶ä¸å¤§ï¼Œæ˜¯çš„ï¼Œå¯¹å¼€å‘è€…æœ€å¤§çš„å¸®åŠ©æ˜¯è¿™ä¸€ç‰¹æ€§å¯ä»¥ç”¨äºå‡½æ•°çš„å‚æ•°ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨è°ƒç”¨å‡½æ•°æ—¶èµ·åˆ°çš„æç¤ºä½œç”¨ï¼Œå°†æ˜¯éå¸¸é‡è¦çš„,ä¾‹å¦‚ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">-(<span class="keyword">void</span>)setValue:(<span class="built_in">NSNumber</span> * _Nonnull )number&#123;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœä¼ å…¥äº†ç©ºå€¼ï¼Œç¼–è¯‘å™¨ä¼šè­¦å‘Šï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/oc_new_1.png?raw=true" alt="oc_new_1"></p>
<h2 id="æ³›å‹çš„ä½¿ç”¨"><a href="#æ³›å‹çš„ä½¿ç”¨" class="headerlink" title="æ³›å‹çš„ä½¿ç”¨"></a>æ³›å‹çš„ä½¿ç”¨</h2><p>è¿™ä¸€ç‰¹æ€§å’ŒNullabilityä¸€æ ·ï¼Œåªä½œç”¨äºç¼–è¯‘æœŸï¼Œæ˜¯ä¸ºæˆ‘ä»¬å¼€å‘è€…æœåŠ¡çš„å¦ä¸€é‡è¦ç‰¹æ€§ã€‚</p>
<h3 id="æœ‰ç±»å‹çº¦å®šçš„é›†åˆ"><a href="#æœ‰ç±»å‹çº¦å®šçš„é›†åˆ" class="headerlink" title="æœ‰ç±»å‹çº¦å®šçš„é›†åˆ"></a>æœ‰ç±»å‹çº¦å®šçš„é›†åˆ</h3><p>åœ¨Xcode7ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»™é›†åˆç±»å‹æ·»åŠ ä¸€ä¸ªæ³›å‹çš„çº¦å®šï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSMutableArray</span>&lt;<span class="built_in">NSString</span> *&gt; *array = [[<span class="built_in">NSMutableArray</span> alloc]init];</div></pre></td></tr></table></figure>
<p>å£°æ˜äº†è¿™æ ·ä¸€ä¸ªæ•°ç»„åï¼Œå°±å‘Šè¯‰äº†ç¼–è¯‘å™¨ï¼Œè¿™ä¸ªæ•°ç»„ä¸­çš„æ•°æ®ç±»å‹éƒ½æ˜¯NSString*ç±»å‹çš„ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ç±»å‹çš„æ–¹æ³•ï¼Œå¦‚ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/oc_new_2.png?raw=true" alt="oc_new_2"></p>
<p>åœ¨æˆ‘ä»¬å‘è¿™ä¸ªæ•°ç»„ä¸­è¿½åŠ å…ƒç´ çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨å°†å…ƒç´ çš„ç±»å‹æç¤ºäº†å‡ºæ¥ï¼Œå¹¶ä¸”å°†FromArrayæ–¹æ³•ä¸­éœ€è¦çš„å…ƒç´ ç±»å‹ä¹Ÿæç¤ºäº†å‡ºæ¥:</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/oc_new_3.png?raw=true" alt="oc_new_3"></p>
<p>å¦‚æœæˆ‘ä»¬å‘è¿™ä¸ªæ•°ç»„ä¸­è¿½åŠ ç±»å‹ä¸åŒ¹é…çš„å…ƒç´ ,ç¼–è¯‘å™¨ä¼šç»™æˆ‘ä»¬ä¸€ä¸ªè¿™æ ·çš„è­¦å‘Šï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/oc_new_4.png?raw=true" alt="oc_new_4"></p>
<h3 id="ç±»å‹é€šé…ç¬¦"><a href="#ç±»å‹é€šé…ç¬¦" class="headerlink" title="ç±»å‹é€šé…ç¬¦"></a>ç±»å‹é€šé…ç¬¦</h3><p>iOSçš„ç³»ç»Ÿç±»ä¸­ï¼Œå¤§é‡ä½¿ç”¨äº†<code>ObjectType</code>å…³é”®å­—ï¼Œå¦‚ä¸‹æ˜¯ç³»ç»Ÿçš„<code>NSMutableArray</code>çš„å¤´æ–‡ä»¶ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSMutableArray</span>&lt;<span class="title">ObjectType</span>&gt; : <span class="title">NSArray</span>&lt;<span class="title">ObjectType</span>&gt;</span></div><div class="line">- (<span class="keyword">void</span>)addObject:(ObjectType)anObject;</div><div class="line">- (<span class="keyword">void</span>)insertObject:(ObjectType)anObject atIndex:(<span class="built_in">NSUInteger</span>)index;</div><div class="line">- (<span class="keyword">void</span>)removeLastObject;</div><div class="line">- (<span class="keyword">void</span>)removeObjectAtIndex:(<span class="built_in">NSUInteger</span>)index;</div><div class="line">- (<span class="keyword">void</span>)replaceObjectAtIndex:(<span class="built_in">NSUInteger</span>)index withObject:(ObjectType)anObject;</div><div class="line">- (<span class="keyword">instancetype</span>)init <span class="built_in">NS_DESIGNATED_INITIALIZER</span>;</div><div class="line">- (<span class="keyword">instancetype</span>)initWithCapacity:(<span class="built_in">NSUInteger</span>)numItems <span class="built_in">NS_DESIGNATED_INITIALIZER</span>;</div><div class="line">- (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder <span class="built_in">NS_DESIGNATED_INITIALIZER</span>;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ª<code>ObjectType</code>å°±æ˜¯æ³›å‹çš„ç±»å‹æ ‡è¯†ç¬¦,æˆ‘ä»¬å¯ä»¥ç”¨å®ƒè‡ªå·±å®šä¹‰ä¸€ä¸ªé›†åˆç±»ï¼Œå¦‚åŒ…è£…ä¸€ä¸ªNSSarrayï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyArray</span>&lt;<span class="title">Type</span>&gt; : <span class="title">NSObject</span></span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>,<span class="keyword">nonnull</span>)<span class="built_in">NSMutableArray</span>&lt;Type&gt; *array;</div><div class="line">-(<span class="keyword">void</span>)addObject:(<span class="keyword">nonnull</span> Type)obj;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">instancetype</span>)init</div><div class="line">&#123;</div><div class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</div><div class="line">        _array = [[<span class="built_in">NSMutableArray</span> alloc]init];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)addObject:(<span class="keyword">id</span>)obj&#123;</div><div class="line">    [_array addObject:obj];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>æ³¨æ„</strong>ï¼š</p>
<ul>
<li>è¿™ä¸ªç±»å‹é€šé…ç¬¦åªèƒ½åœ¨interfaveé‡Œä½¿ç”¨ï¼Œä½œç”¨åŸŸä¸º@interfaceåˆ°@endä¹‹é—´ã€‚</li>
<li>å®ç°æ—¶ï¼Œå¯¹äºå®šä¹‰çš„<code>Type</code>ç±»å‹çš„å‚æ•°ï¼Œä½¿ç”¨<code>id</code>ä»£æ›¿ã€‚</li>
<li>æ³›å‹<code>Type</code>ä¸ç”¨å†™æˆ<code>Type *</code>ã€‚</li>
<li>å¯¹äºå¤šå‚çš„é›†åˆï¼Œå°†å‚æ•°ç±»å‹ç”¨â€œ,â€éš”å¼€å³å¯ï¼Œå¦‚<code>NSMultableDictionary&lt;NSString * ,NSString *&gt; *dic = [[NSMultableDictionary alloc] init];</code></li>
</ul>
<h3 id="kindof"><a href="#kindof" class="headerlink" title="__kindof"></a>__kindof</h3><p>åœ¨å°ç±»å‘å¤§ç±»èµ‹å€¼æ—¶ï¼Œå¾€å¾€æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ä½†æ˜¯å¤§ç±»å‘å°ç±»èµ‹å€¼æ—¶ï¼Œå°±ä¼šäº§ç”Ÿè­¦å‘Šã€‚è­¬å¦‚<code>UIView</code>çš„å®ä¾‹<code>view</code>å’Œ<code>UIButton</code>çš„å®ä¾‹<code>button</code>,å¯ä»¥<code>view = button</code>ï¼Œä½†æ˜¯æœ€å¥½ä¸è¦<code>button = view</code>ã€‚å¦‚æœæƒ³è¦ä½¿ç”¨ï¼Œåˆä¸å¸Œæœ›äº§ç”Ÿè­¦å‘Šæ€ä¹ˆåŠï¼Ÿä½¿ç”¨<code>__kindof</code>ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIButton</span> *b = [[<span class="built_in">UIButton</span> alloc] init];</div><div class="line">__kindof <span class="built_in">UIView</span> *view = [[<span class="built_in">UIButton</span> alloc]init];</div><div class="line">b = view;</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œï¼Œç”±äº<code>view</code>ä½¿ç”¨<code>__kindof</code>è¡¨ç¤º<code>UIView</code>çš„å­ç±»ï¼Œä¸ä¼šäº§ç”Ÿè­¦å‘Šã€‚å¦åˆ™è¦è¿›è¡Œå¼ºè½¬<code>b = (UIButton *)view;</code></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iOSå¼€å‘å·¥å…·åº”ç”¨ä¸­çš„å‘]]></title>
      <url>http://zhang759740844.github.io/2016/09/23/Xcode%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>è¿™é‡Œä¸»è¦æ€»ç»“ä¸€ä¸‹å¼€å‘ iOS ä½¿ç”¨å·¥å…·ä¸Šé‡åˆ°çš„ä¸€äº›é—®é¢˜ã€‚</p>
<a id="more"></a>
<h2 id="å®‰è£…-XVim"><a href="#å®‰è£…-XVim" class="headerlink" title="å®‰è£… XVim"></a>å®‰è£… XVim</h2><p>æ…•åä¸‹è½½äº†<a href="https://github.com/XVimProject/XVim" target="_blank" rel="external">Xcode</a>ï¼Œä½†æ˜¯å®‰è£…èµ·æ¥æœ‰ç‚¹æ›²æŠ˜ã€‚</p>
<p>å…ˆç”¨SourceTreeåˆ›å»ºäº†æœ¬åœ°ä»“åº“ï¼Œ<code>clone</code>äº†ä»£ç ã€‚è²Œä¼¼Xcode8å’ŒXcode7å®‰è£…èµ·æ¥æœ‰ç‚¹åŒºåˆ«ã€‚</p>
<p>Xcode8 çš„ç”¨æˆ·è¦æŒ‰ç…§ä»–çš„æ–¹æ³•è®¾ç½®ä¸ªäººè¯ä¹¦ã€‚ä¸»è¦æ˜¯å› ä¸ºåœ¨ Xcode8 ä¸­ï¼Œå‡ºäºå®‰å…¨åŸå› ï¼Œå®˜æ–¹å·²ç»ä¸æ”¯æŒç¬¬ä¸‰æ–¹æ’ä»¶äº†ã€‚æƒ³è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œå°±å¾—å¼€ä¸ªåé—¨ï¼Œå›åˆ° Xcode7 çš„å®‰å…¨é…ç½®ã€‚æ“ä½œæ²¡æœ‰æ­§ä¹‰ï¼ŒæŒ‰ç…§æ•™ç¨‹å°±å¯ä»¥å®Œæˆã€‚</p>
<p>Xcode7ä¸èƒ½ç”¨æœ€æ–°çš„ç‰ˆæœ¬ï¼Œéœ€è¦ä½¿ç”¨<code>commit</code>åœ¨<code>809527b</code>ä¹‹å‰çš„ç‰ˆæœ¬ã€‚(MDï¼Œå°±ä¸èƒ½åŠ ä¸ªtag!)éœ€è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªæœ¬åœ°branchã€‚</p>
<p>ä¹‹åæœ‰ä¸€æ­¥åœ¨ä¸‹è½½ä¸‹æ¥çš„ XVim æ–‡ä»¶å¤¹ä¸‹ç¼–è¯‘çš„æ“ä½œï¼Œéœ€è¦ <code>cd XVim/</code>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ make</div></pre></td></tr></table></figure>
<p>è‡³äºä¸‹é¢è¿™ä¸ªæŒ‡ä»¤ï¼Œå…¶å®ä¸ç”¨å¤ªåœ¨æ„:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ xcode-select -p</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæŒ‡ä»¤ä¸»è¦æ˜¯çœ‹çœ‹ Xcode çš„ç‰ˆæœ¬æ˜¯å¦æŒ‡å®šåœ¨ <code>/Applications/Xcode.app/Contents/Developer</code> ç›®å½•ä¸‹ï¼Œä¸æ˜¯çš„è¯è¦æ‰‹åŠ¨æŒ‡å®šã€‚å…·ä½“è¿™æ ·æ˜¯ä¸ºäº†ä»€ä¹ˆï¼Œæˆ‘ä¹Ÿæ²¡è®¤çœŸå»ææ˜ç™½ã€‚</p>
<p>é‡å¯xcodeï¼Œä¼šæç¤ºæ˜¯å¦ä½¿ç”¨Xvimï¼Œé€‰æ‹©<code>load</code>å°±OKäº†ã€‚</p>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>é™¤äº†Vimè‡ªèº«çš„å‘½ä»¤å¤–,XVimè¿˜æœ‰å‡ ä¸ªXcodeå‘½ä»¤:</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/XVim_1.png?raw=true" alt="XVim_1"></p>
<p>é™„å¸¦Vimä½¿ç”¨è¯¦è§£ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/XVim_2.png?raw=true" alt="XVim_2"></p>
<h2 id="pod-çš„å®‰è£…å’Œä½¿ç”¨"><a href="#pod-çš„å®‰è£…å’Œä½¿ç”¨" class="headerlink" title="pod çš„å®‰è£…å’Œä½¿ç”¨"></a>pod çš„å®‰è£…å’Œä½¿ç”¨</h2><h3 id="å®‰è£…-cocoapods"><a href="#å®‰è£…-cocoapods" class="headerlink" title="å®‰è£… cocoapods"></a>å®‰è£… cocoapods</h3><p>å®‰è£… cocoapods æœ¬èº«å¹¶æ²¡æœ‰éš¾åº¦ã€‚åªæ˜¯ä¸€ç‚¹ï¼ŒRuby çš„é»˜è®¤æºä½¿ç”¨çš„æ˜¯cocoapods.orgï¼Œå›½å†…è®¿é—®è¿™ä¸ªç½‘å€æœ‰æ—¶å€™ä¼šæœ‰é—®é¢˜ï¼Œç½‘ä¸Šçš„ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å°†è¿œç«¯æ›¿æ¢æˆæ·˜å®çš„ã€‚ä¸è¿‡å¥½åƒæœ€è¿‘<strong>æ·˜å®çš„é•œåƒä¹Ÿä¸èƒ½ç”¨äº†</strong>ï¼Œæ‰€ä»¥å†æ¢ä¸€ä¸ªé•œåƒå§ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">//åˆ é™¤é»˜è®¤æº</div><div class="line">$gem sources --remove https://rubygems.org/</div><div class="line">//æ·»åŠ æ–°æº</div><div class="line">$gem sources -a http://gems.ruby-china.org/</div><div class="line">//æŸ¥çœ‹</div><div class="line">$ gem sources -l</div></pre></td></tr></table></figure>
<p>è¿™æ ·å†å®‰è£…ä¸€æ¬¡ï¼Œå°±èƒ½å®‰è£…æˆåŠŸäº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo gem install cocoapods</div></pre></td></tr></table></figure>
<h3 id="pod-install-å¡åœ¨-Setting-up-CocoaPods-master-repo"><a href="#pod-install-å¡åœ¨-Setting-up-CocoaPods-master-repo" class="headerlink" title="pod install å¡åœ¨ Setting up CocoaPods master repo"></a>pod install å¡åœ¨ Setting up CocoaPods master repo</h3><p>å®‰è£…å®Œ pod åå°±å¯ä»¥ä½¿ç”¨ <code>pod install</code> å®‰è£…ç¬¬ä¸‰æ–¹åº“äº†ï¼Œä½†æ˜¯ç¬¬ä¸€æ¬¡ <code>pod install</code> çš„æ—¶å€™ä¼šè‡ªåŠ¨ä» <code>https://github.com/CocoaPods/Specs</code> å…‹éš†åˆ°æœ¬åœ°çš„ <code>.cocoapods</code> ç›®å½•ä¸‹ã€‚</p>
<p>ä½†æ˜¯å¾€å¾€å°±ä¼šå¡åœ¨è¿™é‡Œï¼Œå¦‚æœç½‘ç»œä¸ç•…ï¼Œææœ‰å¯èƒ½å¤±è´¥ã€‚å› æ­¤ï¼Œéœ€è¦æ¢æ‰‹åŠ¨å…‹éš†çš„æ–¹å¼ã€‚</p>
<p>é¦–å…ˆè¿›å…¥è¯¥ç›®å½•ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd ~/.cocoapods/repos</div></pre></td></tr></table></figure>
<p>å…‹éš†ä¸€ä¸ªSpecsåº“ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/CocoaPods/Specs</div></pre></td></tr></table></figure></p>
<p>ç„¶åæ‰“å¼€ç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ ·çš„ç›®å½•ç»“æ„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">repos</div><div class="line">	Specs</div><div class="line">		CocoaPods-version.yml</div><div class="line">		README.md</div><div class="line">		Specs</div><div class="line">		.git</div></pre></td></tr></table></figure>
<p>ç°åœ¨å°†ç¬¬ä¸€ä¸ª <code>Specs</code> æ–‡ä»¶å¤¹ä¿®æ”¹ä¸º <code>master</code> å³å¯å®Œæˆ <code>Setting up CocoaPods master repo</code> çš„æ“ä½œã€‚</p>
<p>ç›®å½•ç»“æ„ä¸ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">repos</div><div class="line">	master</div><div class="line">		CocoaPods-version.yml</div><div class="line">		README.md</div><div class="line">		Specs</div><div class="line">		.git</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨å¯ä»¥æ”¾å¿ƒ <code>pod install</code> äº†ã€‚</p>
<h3 id="pod-install-å¡åœ¨-Analyzing-dependencies"><a href="#pod-install-å¡åœ¨-Analyzing-dependencies" class="headerlink" title="pod install å¡åœ¨ Analyzing dependencies"></a>pod install å¡åœ¨ Analyzing dependencies</h3><p>åŸå› åœ¨äºå½“æ‰§è¡Œä»¥ä¸Šä¸¤ä¸ªå‘½ä»¤çš„æ—¶å€™ä¼šå‡çº§ CocoaPods çš„ spec ä»“åº“ï¼ŒåŠ ä¸€ä¸ªå‚æ•°å¯ä»¥çœç•¥è¿™ä¸€æ­¥ï¼Œç„¶åé€Ÿåº¦å°±ä¼šæå‡ä¸å°‘ã€‚åŠ å‚æ•°çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod install --verbose --no-repo-update</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ <code>--verbose</code> è¡¨ç¤ºæ˜¾ç¤ºè¯¦æƒ…ã€‚åé¢çš„ <code>--no-repo-update</code> æ‰æ˜¯æ­£çœŸèµ·ä½œç”¨çš„ã€‚</p>
<h3 id="gem-ä¸-pod-çš„æ›´æ–°"><a href="#gem-ä¸-pod-çš„æ›´æ–°" class="headerlink" title="gem ä¸ pod çš„æ›´æ–°"></a>gem ä¸ pod çš„æ›´æ–°</h3><p>Gem æ˜¯ä¸€ä¸ªç®¡ç† Ruby åº“å’Œç¨‹åºçš„æ ‡å‡†åŒ…ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ cocoapods ä¹Ÿæ˜¯é€šè¿‡ gem å®‰è£…çš„ã€‚</p>
<h4 id="gem-çš„ä¸€äº›æŒ‡ä»¤"><a href="#gem-çš„ä¸€äº›æŒ‡ä»¤" class="headerlink" title="gem çš„ä¸€äº›æŒ‡ä»¤"></a>gem çš„ä¸€äº›æŒ‡ä»¤</h4><ol>
<li><code>gem install xxx</code>:å®‰è£…æŸä¸ªåŒ…ã€‚</li>
<li><code>gem install xxx -v 1.5.4</code>:å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„åŒ…</li>
<li><code>gem update</code>:æ›´æ–°æ‰€æœ‰åŒ…</li>
<li><code>gem update --system</code>:æ›´æ–° Gem è‡ªèº«</li>
<li><code>gem list</code>:åˆ—å‡ºæ‰€æœ‰çš„åŒ…</li>
</ol>
<h4 id="pod-æ›´æ–°"><a href="#pod-æ›´æ–°" class="headerlink" title="pod æ›´æ–°"></a>pod æ›´æ–°</h4><p>æœ‰æ—¶å€™ pod å®‰è£…æˆ–è€…æ›´æ–°çš„æ—¶å€™ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/pod_install_error.png?raw=true" alt="å®‰è£…å¤±è´¥"><br>è§£å†³æ–¹æ³•æ˜¯<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/pod_update.png?raw=true" alt="æ›´æ–°æˆåŠŸ"></p>
<h2 id="XcodeæŠ¥é”™-code-signing-is-required-for-product-type-â€˜Unit-Test-Bundleâ€™-in-SDK-â€˜iOS-10-1â€™"><a href="#XcodeæŠ¥é”™-code-signing-is-required-for-product-type-â€˜Unit-Test-Bundleâ€™-in-SDK-â€˜iOS-10-1â€™" class="headerlink" title="XcodeæŠ¥é”™ code signing is required for product type â€˜Unit Test Bundleâ€™ in SDK â€˜iOS 10.1â€™"></a>XcodeæŠ¥é”™ code signing is required for product type â€˜Unit Test Bundleâ€™ in SDK â€˜iOS 10.1â€™</h2><p>åœ¨ç½‘ä¸Šä¸‹è½½åˆ«äººé¡¹ç›®åï¼Œè¿ä¸èµ·æ¥ï¼Œæ€»æ˜¯æŠ¥è¿™ä¸ªé”™ã€‚è™½ç„¶ä¸çŸ¥é“è¿™ä¸ªé”™è¯¯æœ€æ ¹æœ¬çš„è§£å†³åŠæ³•æ˜¯ä»€ä¹ˆã€‚ä½†æ˜¯ä¸´æ—¶æ€§çš„è§£å†³æ–¹æ³•è¿˜æ˜¯æœ‰çš„ã€‚åšæ³•å°±æ˜¯ä¸è¦ build é¡¹ç›®é‡Œé¢çš„æµ‹è¯•å·¥ç¨‹ã€‚</p>
<p>Edit scheme -&gt; build -&gt; remove xxxtest<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/xcode_debug.png?raw=true" alt="XcodeæŠ¥é”™è§£å†³"></p>
<h2 id="Podfile-lock"><a href="#Podfile-lock" class="headerlink" title="Podfile.lock"></a>Podfile.lock</h2><p>åœ¨ååŒå¼€å‘æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°ï¼ŒPodfile.lock ä¸ä¸€è‡´ï¼Œå¯¼è‡´ç¼–è¯‘å¤±è´¥ï¼Œéœ€è¦é‡æ–° <code>pod install</code> çš„æƒ…å†µã€‚è¿™é‡Œå°†ç®€å•ä»‹ç»ä¸‹ Podfile.lock</p>
<h3 id="Podfile-lockçš„ä½œç”¨"><a href="#Podfile-lockçš„ä½œç”¨" class="headerlink" title="Podfile.lockçš„ä½œç”¨"></a>Podfile.lockçš„ä½œç”¨</h3><h4 id="Podfile-lock-1"><a href="#Podfile-lock-1" class="headerlink" title="Podfile.lock"></a>Podfile.lock</h4><p>Podfile.lock æ˜¯åœ¨ç¬¬ä¸€æ¬¡è¿è¡Œ <code>pod install</code> æ—¶å€™è‡ªåŠ¨ç”Ÿæˆçš„ã€‚Podfile.lock ä¸­ä¼šæ ‡æ³¨é¡¹ç›®å½“å‰ä¾èµ–åº“çš„å‡†ç¡®ç‰ˆæœ¬ï¼Œå…¶ä¸­åŒ…æ‹¬äº†é¡¹ç›®åœ¨ Podfile ä¸­ç›´æ¥æ ‡æ³¨ä½¿ç”¨çš„åº“ï¼Œä»¥åŠè¿™äº›åº“ä¾èµ–çš„å…¶ä»–åº“ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯å½“ä½ è·Ÿå°ä¼™ä¼´ååŒå¼€å‘æ—¶ï¼Œä½ çš„å°ä¼™ä¼´åŒæ­¥äº†ä½ çš„ Podfile.lock æ–‡ä»¶åï¼Œä»–æ‰§è¡Œ <code>pod install</code> ä¼šå®‰è£… Podfile.lock æŒ‡å®šç‰ˆæœ¬çš„ä¾èµ–åº“ï¼Œè¿™æ ·å°±å¯ä»¥é˜²æ­¢å¤§å®¶çš„ä¾èµ–åº“ä¸ä¸€è‡´è€Œé€ æˆé—®é¢˜ã€‚å› æ­¤ï¼ŒCocoaPods å®˜æ–¹å¼ºçƒˆæ¨èæŠŠ Podfile.lock çº³å…¥ç‰ˆæœ¬æ§åˆ¶ä¹‹ä¸‹ã€‚</p>
<p>ä½†æ˜¯ï¼ŒPodfile.lock å¹¶ä¸æ˜¯ä¸€æˆä¸å˜çš„ï¼Œå½“ä½ ä¿®æ”¹äº† Podfile æ–‡ä»¶é‡Œä½¿ç”¨çš„ä¾èµ–åº“æˆ–è€…è¿è¡Œ <code>pod update</code> å‘½ä»¤æ—¶ï¼Œå°±ä¼šç”Ÿæˆæ–°çš„ Podfile.lock æ–‡ä»¶ã€‚æ‰€ä»¥ï¼ŒååŒå¼€å‘æ—¶éœ€è¦æ³¨æ„ä½¿ç”¨ <code>pod install</code> å’Œ <code>pod update</code> çš„åŒºåˆ«:</p>
<ul>
<li>ä½¿ç”¨ <code>pod install</code>ï¼Œä½ åªä¼šå®‰è£… Podfile ä¸­æ–°æ”¹å˜çš„ä¸œè¥¿ï¼Œå¹¶ä¸”ä¼šï¼šä¼˜å…ˆéµå¾ª Podfile é‡ŒæŒ‡å®šçš„ç‰ˆæœ¬ä¿¡æ¯ï¼›å…¶æ¬¡éµå¾ª Podfile.lock é‡ŒæŒ‡å®šçš„ç‰ˆæœ¬ä¿¡æ¯æ¥å®‰è£…å¯¹åº”çš„ä¾èµ–åº“ã€‚æ¯”å¦‚ï¼šä¸‹é¢åœ¨ Podfile é‡Œæ²¡æŒ‡å®š iRate çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯ Podfile.lock é‡ŒæŒ‡å®šäº† iRate çš„ç‰ˆæœ¬æ˜¯ 1.11.1ï¼Œé‚£ä¹ˆå³ä½¿ç°åœ¨æœ‰æœ€æ–°çš„ 1.11.4ï¼Œæœ€ç»ˆä¹Ÿä¼šå®‰è£… 1.11.1ã€‚ä½†æ˜¯å¦‚æœ Podfile é‡ŒæŒ‡å®šäº† iRate ç‰ˆæœ¬æ˜¯ 1.11.3ï¼Œé‚£ä¹ˆåˆ™ä¼šå®‰è£… 1.11.3ï¼Œå¹¶æ›´æ–° Podfile.lock é‡Œçš„ä¿¡æ¯ã€‚</li>
<li>ä½¿ç”¨ <code>pod update</code>ï¼Œä½ ä¼šæ ¹æ® Podfile çš„è§„åˆ™æ›´æ–°æ‰€æœ‰ä¾èµ–åº“ï¼Œä¸ä¼šç†ç¬ç°æœ‰çš„ Podfile.lockï¼Œè€Œæ˜¯æ ¹æ®å®‰è£…ä¾èµ–åº“çš„æƒ…å†µç”Ÿæˆæ–°çš„ Podfile.lock æ–‡ä»¶ã€‚</li>
</ul>
<h4 id="Manifest-lock"><a href="#Manifest-lock" class="headerlink" title="Manifest.lock"></a>Manifest.lock</h4><p>é‚£ä¹ˆæ˜¯å¦‚ä½•çŸ¥é“æ‹‰å–çš„ Podfile.lock å’Œ Pod å†…ï¼Œåº“çš„ç‰ˆæœ¬ä¸ä¸€è‡´çš„å‘¢ï¼Ÿåœ¨æ¯æ¬¡ç”Ÿæˆ Podfile.lock çš„æ—¶å€™ï¼Œéƒ½ä¼šåœ¨ Podå†…ç”Ÿæˆä¸€ä¸ª Podfile.lock çš„å‰¯æœ¬Manifest.lockã€‚ç”±äº Pod ä¸€èˆ¬ä¸ä¼šä¸Šä¼ ç‰ˆæœ¬æ§åˆ¶ï¼ŒManifest.lock å°±ä»£è¡¨äº†æœ¬åœ°çš„ Pod ç‰ˆæœ¬ã€‚å¦‚æœæ‹‰å–äº†åˆ«äººçš„ Podfile.lockï¼Œé‚£ä¹ˆ Podfile.lock å’Œ Manifest.lock å°±ä¼šäº§ç”Ÿä¸ä¸€è‡´ï¼Œå°±ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ã€‚</p>
<h4 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h4><p>æœ‰äº†è¿™ä¸ªæ£€æŸ¥æœºåˆ¶å°±èƒ½ä¿è¯å¼€å‘å›¢é˜Ÿçš„å„ä¸ªå°ä¼™ä¼´èƒ½åœ¨è¿è¡Œé¡¹ç›®å‰æ›´æ–°ä»–ä»¬çš„ä¾èµ–åº“ï¼Œå¹¶ä¿æŒè¿™äº›ä¾èµ–åº“çš„ç‰ˆæœ¬ä¸€è‡´ï¼Œä»è€Œé˜²æ­¢åœ¨ä¾èµ–åº“çš„ç‰ˆæœ¬ä¸ç»Ÿä¸€é€ æˆç¨‹åºåœ¨ä¸€äº›ä¸æ˜æ˜¾çš„åœ°æ–¹ç¼–è¯‘å¤±è´¥æˆ–è¿è¡Œå´©æºƒã€‚</p>
<h4 id="Podfile-lock-ä¸åŒçš„å¯èƒ½åŸå› "><a href="#Podfile-lock-ä¸åŒçš„å¯èƒ½åŸå› " class="headerlink" title="Podfile.lock ä¸åŒçš„å¯èƒ½åŸå› "></a>Podfile.lock ä¸åŒçš„å¯èƒ½åŸå› </h4><p>æœ‰æ—¶å¯èƒ½ Podfile æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯ä½ ä»¬çš„ Podfile.lock è¿˜ä¼šä¸åŒã€‚ä¸‹é¢ <code>Podfile.lock çš„å¼•å·é—®é¢˜</code>å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p>
<p>é™¤äº† gemï¼Œrubyç­‰åº“çš„ç‰ˆæœ¬ä¸åŒå¯¼è‡´ä¹‹å¤–ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯å› ä¸ºæœ¬åœ°çš„ Podspec æ–‡ä»¶ä¸åŒå¯¼è‡´çš„ã€‚æ‰€æœ‰çš„é¡¹ç›®çš„ Podspec æ–‡ä»¶éƒ½æ‰˜ç®¡åœ¨ <code>https://github.com/CocoaPods/Specs</code>ã€‚ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼ŒCocoaPods ä¼šå°†è¿™äº› podspec ç´¢å¼•æ–‡ä»¶æ›´æ–°åˆ°æœ¬åœ°çš„ <code>~/.cocoapods/</code> ç›®å½•ä¸‹ã€‚å¦‚æœé•¿æ—¶é—´ä¸æ›´æ–° podspecï¼Œé‚£ä¹ˆæ‰€è¦ä¸‹è½½çš„ç›´æ¥ä¾èµ–åº“æˆ–é—´æ¥ä¾èµ–åº“çš„æœ€æ–°ç‰ˆæœ¬å¯èƒ½å‘ç”Ÿäº†å˜åŒ–ï¼Œå°±ä¼šå¯¼è‡´å®‰è£…äº†ä¸ä¸€æ ·çš„ä¾èµ–ç‰ˆæœ¬ï¼Œé‚£ä¹ˆ Podfile.lock çš„è®°å½•å°±ä¸ä¸€æ ·äº†ã€‚å»ºè®®å¯ä»¥æ‰§è¡Œ <code>pod repo update</code> æ›´æ–°ä¸€ä¸‹ spec repo(ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ‰§è¡Œ <code>pod install</code> æ—¶ä¼šå…ˆè‡ªåŠ¨æ›´æ–° spec çš„ï¼Œé™¤éå‘ä¸Šé¢è¯´çš„ä½¿ç”¨ <code>pod install --no-repo-update</code>ï¼Œå½“ç„¶ï¼Œç°åœ¨åªæ˜¯è®°å½•ä¸‹å¯èƒ½å¯¼è‡´ Podfile.lock ä¸ä¸€è‡´çš„åŸå› ï¼Œä¸‡ä¸€çœŸçš„å‘ç”Ÿäº†å‘¢ï¼Ÿ)</p>
<h3 id="Podfile-lock-çš„å¼•å·é—®é¢˜"><a href="#Podfile-lock-çš„å¼•å·é—®é¢˜" class="headerlink" title="Podfile.lock çš„å¼•å·é—®é¢˜"></a>Podfile.lock çš„å¼•å·é—®é¢˜</h3><p>æœ€è¿‘åœ¨åä½œçš„æ—¶å€™é‡åˆ°äº†è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘çš„ pod lock æ€»æ˜¯å’ŒåŒäº‹çš„ä¸ä¸€è‡´ï¼Œå·®åˆ«åœ¨äºæ˜¯å¦æœ‰å¼•å·ã€‚è¿™å°±å¯¼è‡´äº†æ¯æ¬¡æ‹‰å–åˆ«äººçš„ä»£ç æˆ‘éƒ½è¦ pod install ä¸€éï¼Œåˆ«äººä¹Ÿæ˜¯ä¸€æ ·ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/podlock.png?raw=true" alt="podfile.lock"> </p>
<p>æŸ¥äº†ä¸€äº›èµ„æ–™<a href="https://github.com/CocoaPods/CocoaPods/issues/3452" target="_blank" rel="external">Inconsistent Podfile.lock files between Ruby versions</a>,<a href="https://github.com/CocoaPods/CocoaPods/issues/6255" target="_blank" rel="external">Strange quotes in Podfile.lock?!</a> å‘ç°å¤§è‡´æ˜¯å› ä¸º gem çš„ä¸€ä¸ª YAML è§£æå·¥å…· psych ç‰ˆæœ¬ä¸åŒå¯¼è‡´çš„ã€‚æ‰€ä»¥ï¼Œè§£å†³é—®é¢˜çš„å…³é”®ä¸æ˜¯æ›´æ–° cocoapods è€Œæ˜¯æ›´æ–° psych (æ›´æ–° psych å‰ï¼Œå…ˆæŠŠ rubyï¼Œgemä¹Ÿå…ˆæ›´æ–°äº†ï¼Œä»¥é˜²æœ‰ä»€ä¹ˆå·®é”™).</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/å®‰è£…psych.png?raw=true" alt="å®‰è£…psych"></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[NodeJså­¦ä¹ ç¬”è®°]]></title>
      <url>http://zhang759740844.github.io/2016/09/22/Nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<p>æœ¬ç¯‡æ˜¯NodeJsçš„å­¦ä¹ ç¬”è®°</p>
<a id="more"></a>
<h2 id="å•çº¿ç¨‹"><a href="#å•çº¿ç¨‹" class="headerlink" title="å•çº¿ç¨‹"></a>å•çº¿ç¨‹</h2><p>node ä¸­ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½<strong>åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å®Œæˆ(I/Oç­‰é™¤å¤–)</strong>ï¼Œåœ¨ node.js æ‰§è¡Œçš„æ—¶å€™ç»´æŠ¤ç€ä¸€ä¸ªäº‹ä»¶é˜Ÿåˆ—ï¼›ç¨‹åºåœ¨æ‰§è¡Œæ—¶è¿›å…¥<strong>äº‹ä»¶å¾ªç¯</strong>ç­‰å¾…ä¸‹ä¸€ä¸ªäº‹ä»¶åˆ°æ¥ï¼Œæ¯ä¸ªå¼‚æ­¥ I/O è¯·æ±‚å®Œæˆåéƒ½ä¼šè¢«æ¨é€åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­çš„ç­‰å¾…æ‰§è¡Œã€‚</p>
<p>ä¼˜åŠ¿æ˜¯é¿å…äº†é¢‘ç¹çš„åˆ‡æ¢çº¿ç¨‹å¸¦æ¥çš„æ¶ˆè€—ï¼Œç¼ºç‚¹æ˜¯é¢å¯¹ cpu å¯†é›†å‹æ¨¡å‹(æ¯”å¦‚ while å¾ªç¯)ï¼Œå°±ä¼šé€ æˆé˜»å¡ã€‚</p>
<p>æ‰€è°“äº‹ä»¶å¾ªç¯æ˜¯æŒ‡node.jsä¼šæŠŠæ‰€æœ‰çš„å¼‚æ­¥æ“ä½œä½¿ç”¨äº‹ä»¶æœºåˆ¶è§£å†³ï¼Œæœ‰ä¸ªçº¿ç¨‹åœ¨ä¸æ–­åœ°å¾ªç¯æ£€æµ‹äº‹ä»¶é˜Ÿåˆ—ã€‚<br>node.jsä¸­æ‰€æœ‰çš„é€»è¾‘éƒ½æ˜¯äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œæ‰€ä»¥node.jså§‹ç»ˆåœ¨äº‹ä»¶å¾ªç¯ä¸­ï¼Œç¨‹åºå…¥å£å°±æ˜¯äº‹ä»¶å¾ªç¯ç¬¬ä¸€ä¸ªäº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚äº‹ä»¶çš„å›è°ƒå‡½æ•°ä¸­å¯èƒ½ä¼šå‘å‡ºI/Oè¯·æ±‚æˆ–ç›´æ¥å‘å°„ï¼ˆemitï¼‰äº‹ä»¶ï¼Œæ‰§è¡Œå®Œæ¯•åè¿”å›äº‹ä»¶å¾ªç¯ã€‚äº‹ä»¶å¾ªç¯ä¼šæ£€æŸ¥äº‹ä»¶é˜Ÿåˆ—ä¸­æœ‰æ²¡æœ‰æœªå¤„ç†çš„äº‹ä»¶ï¼Œç›´åˆ°ç¨‹åºç»“æŸã€‚node.jsçš„äº‹ä»¶å¾ªç¯å¯¹å¼€å‘è€…ä¸å¯è§ï¼Œç”±libevåº“å®ç°ï¼Œlibevä¸æ–­æ£€æŸ¥æ˜¯å¦æœ‰æ´»åŠ¨çš„ã€å¯ä¾›æ£€æµ‹çš„äº‹ä»¶ç›‘å¬å™¨ï¼Œç›´åˆ°æ£€æŸ¥ä¸åˆ°æ—¶æ‰é€€å‡ºäº‹ä»¶å¾ªç¯ï¼Œç¨‹åºç»“æŸã€‚</p>
<p><a href="http://blog.csdn.net/leftfist/article/details/41891407" target="_blank" rel="external">Node.jsæœºåˆ¶åŠåŸç†ç†è§£åˆæ­¥</a></p>
<h2 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h2><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>æ¨¡å—åŒ–çš„å¥½å¤„ä¸å¤šè¯´ï¼Œä¸‹é¢çœ‹çœ‹Nodeä¸­å¦‚ä½•æ¨¡å—åŒ–.æˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ª<code>hello.js</code>æ–‡ä»¶ï¼Œè¿™ä¸ª<code>hello.js</code>æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæ¨¡å—çš„åå­—å°±æ˜¯æ–‡ä»¶åï¼ˆå»æ‰<code>.js</code>åç¼€ï¼‰ï¼Œæ‰€ä»¥<code>hello.js</code>æ–‡ä»¶å°±æ˜¯åä¸º<code>hello</code>çš„æ¨¡å—:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'Hello'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(s + <span class="string">', '</span> + name + <span class="string">'!'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = greet;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°<code>greet()</code>ï¼Œ<code>module.exports = greet</code>çš„æ„æ€æ˜¯ï¼ŒæŠŠå‡½æ•°greetä½œä¸ºæ¨¡å—çš„è¾“å‡ºæš´éœ²å‡ºå»ï¼Œè¿™æ ·å…¶ä»–æ¨¡å—å°±å¯ä»¥ä½¿ç”¨greetå‡½æ•°äº†ã€‚</p>
<p>å…¶ä»–æ¨¡å—æ€ä¹ˆä½¿ç”¨<code>hello</code>æ¨¡å—çš„è¿™ä¸ª<code>greet</code>å‡½æ•°å‘¢ï¼Ÿæˆ‘ä»¬å†ç¼–å†™ä¸€ä¸ª<code>main.js</code>æ–‡ä»¶ï¼Œè°ƒç”¨<code>hello</code>æ¨¡å—çš„<code>greet</code>å‡½æ•°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¼•å…¥helloæ¨¡å—:</span></div><div class="line"><span class="keyword">var</span> greet = <span class="built_in">require</span>(<span class="string">'./hello'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> s = <span class="string">'Michael'</span>;</div><div class="line"></div><div class="line">greet(s); <span class="comment">// Hello, Michael!</span></div></pre></td></tr></table></figure>
<p><code>greet</code>å˜é‡å°±æ˜¯ä¸Šé¢<code>module.exports = greet</code>è¾“å‡ºçš„<code>greet</code>ã€‚åœ¨ä½¿ç”¨<code>require()</code>å¼•å…¥æ¨¡å—çš„æ—¶å€™ï¼Œè¯·æ³¨æ„æ¨¡å—çš„ç›¸å¯¹è·¯å¾„ã€‚</p>
<p>ä¸€ä¸ªæ¨¡å—æƒ³è¦å¯¹å¤–æš´éœ²å˜é‡ï¼ˆå‡½æ•°ä¹Ÿæ˜¯å˜é‡ï¼‰ï¼Œå¯ä»¥ç”¨<code>module.exports = variable;</code>ï¼Œä¸€ä¸ªæ¨¡å—è¦å¼•ç”¨å…¶ä»–æ¨¡å—æš´éœ²çš„å˜é‡ï¼Œç”¨<code>var ref = require(&#39;module_name&#39;);</code>å°±æ‹¿åˆ°äº†å¼•ç”¨æ¨¡å—çš„å˜é‡ã€‚</p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>æ¨¡å—åŒ–ä¿è¯ä¸åŒæ¨¡å—å¯ä»¥ä½¿ç”¨ç›¸åŒçš„å˜é‡åï¼Œé‚£ä¹ˆè¿™æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‡†å¤‡moduleå¯¹è±¡,requireå°±æ˜¯æ ¹æ®idè·å¾—ç›¸åº”moduleçš„exports:</span></div><div class="line"><span class="keyword">var</span> <span class="built_in">module</span> = &#123;</div><div class="line">    id: <span class="string">'hello'</span>,</div><div class="line">    exports: &#123;&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> load = <span class="function"><span class="keyword">function</span> (<span class="params">module</span>) </span>&#123;</div><div class="line">    <span class="comment">// è¯»å–çš„hello.jsä»£ç :</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Hello, '</span> + name + <span class="string">'!'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">module</span>.exports = greet;</div><div class="line">    <span class="comment">// hello.jsä»£ç ç»“æŸ</span></div><div class="line">    <span class="keyword">return</span> <span class="built_in">module</span>.exports;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> exported = load(<span class="built_in">module</span>);</div><div class="line"><span class="comment">// ä¿å­˜module:</span></div><div class="line">save(<span class="built_in">module</span>, exported);</div></pre></td></tr></table></figure>
<p>å…¨å±€å˜é‡ç°åœ¨å˜æˆäº†åŒ¿åå‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œæ‰€ä»¥ï¼ŒNodeåˆ©ç”¨JavaScriptçš„å‡½æ•°å¼ç¼–ç¨‹çš„ç‰¹æ€§ï¼Œè½»è€Œæ˜“ä¸¾åœ°å®ç°äº†æ¨¡å—çš„éš”ç¦»ã€‚</p>
<p>å˜é‡<code>module</code>æ˜¯Nodeåœ¨åŠ è½½jsæ–‡ä»¶å‰å‡†å¤‡çš„ä¸€ä¸ªå˜é‡ï¼Œå¹¶å°†å…¶ä¼ å…¥åŠ è½½å‡½æ•°ï¼Œæˆ‘ä»¬åœ¨<code>hello.js</code>ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨å˜é‡<code>module</code>åŸå› å°±åœ¨äºå®ƒå®é™…ä¸Šæ˜¯å‡½æ•°çš„ä¸€ä¸ªå‚æ•°.</p>
<p>é€šè¿‡æŠŠå‚æ•°<code>module</code>ä¼ é€’ç»™<code>load()</code>å‡½æ•°ï¼Œ<code>hello.js</code>å°±é¡ºåˆ©åœ°æŠŠä¸€ä¸ªå˜é‡ä¼ é€’ç»™äº†Nodeæ‰§è¡Œç¯å¢ƒï¼ŒNodeä¼šæŠŠ<code>module</code>å˜é‡ä¿å­˜åˆ°æŸä¸ªåœ°æ–¹ã€‚</p>
<p>ç”±äºNodeä¿å­˜äº†æ‰€æœ‰å¯¼å…¥çš„<code>module</code>ï¼Œå½“æˆ‘ä»¬ç”¨<code>require()</code>è·å–<code>module</code>æ—¶ï¼ŒNodeæ‰¾åˆ°å¯¹åº”çš„<code>module</code>ï¼ŒæŠŠè¿™ä¸ª<code>module</code>çš„<code>exports</code>å˜é‡è¿”å›ï¼Œè¿™æ ·ï¼Œå¦ä¸€ä¸ªæ¨¡å—å°±é¡ºåˆ©æ‹¿åˆ°äº†æ¨¡å—çš„è¾“å‡ºã€‚</p>
<h2 id="åŸºæœ¬æ¨¡å—"><a href="#åŸºæœ¬æ¨¡å—" class="headerlink" title="åŸºæœ¬æ¨¡å—"></a>åŸºæœ¬æ¨¡å—</h2><h3 id="åŸºæœ¬æ¨¡å—-1"><a href="#åŸºæœ¬æ¨¡å—-1" class="headerlink" title="åŸºæœ¬æ¨¡å—"></a>åŸºæœ¬æ¨¡å—</h3><h4 id="global"><a href="#global" class="headerlink" title="global"></a>global</h4><p>JavaScriptæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ä¸­ï¼Œå«<code>window</code>å¯¹è±¡ã€‚è€Œåœ¨Node.jsç¯å¢ƒä¸­ï¼Œä¹Ÿæœ‰å”¯ä¸€çš„å…¨å±€å¯¹è±¡ï¼Œå«<code>global</code>ã€‚</p>
<h4 id="process"><a href="#process" class="headerlink" title="process"></a>process</h4><p><code>process</code>ä¹Ÿæ˜¯Node.jsæä¾›çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä»£è¡¨å½“å‰Node.jsè¿›ç¨‹ã€‚é€šè¿‡<code>process</code>å¯¹è±¡å¯ä»¥æ‹¿åˆ°è®¸å¤šæœ‰ç”¨ä¿¡æ¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; process === global.process;</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; process.version;</div><div class="line"><span class="string">'v4.5.0'</span></div><div class="line">&gt; process.platform;</div><div class="line"><span class="string">'darwin'</span></div><div class="line">&gt; process.arch;</div><div class="line"><span class="string">'x64'</span></div><div class="line">&gt; process.cwd(); <span class="comment">//è¿”å›å½“å‰å·¥ä½œç›®å½•</span></div><div class="line"><span class="string">'/Users/michael'</span></div><div class="line">&gt; process.chdir(<span class="string">'/private/tmp'</span>); <span class="comment">// åˆ‡æ¢å½“å‰å·¥ä½œç›®å½•</span></div><div class="line"><span class="literal">undefined</span></div><div class="line">&gt; process.cwd();</div><div class="line"><span class="string">'/private/tmp'</span></div></pre></td></tr></table></figure>
<p>JavaScriptç¨‹åºæ˜¯ç”±äº‹ä»¶é©±åŠ¨æ‰§è¡Œçš„å•çº¿ç¨‹æ¨¡å‹ï¼ŒNode.jsä¹Ÿä¸ä¾‹å¤–ã€‚Node.jsä¸æ–­æ‰§è¡Œå“åº”äº‹ä»¶çš„JavaScriptå‡½æ•°ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•å“åº”äº‹ä»¶çš„å‡½æ•°å¯ä»¥æ‰§è¡Œæ—¶ï¼ŒNode.jså°±é€€å‡ºäº†ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ä¸‹ä¸€æ¬¡äº‹ä»¶å“åº”ä¸­æ‰§è¡Œä»£ç ï¼Œå¯ä»¥è°ƒç”¨<code>process.nextTick()</code>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// process.nextTick()å°†åœ¨ä¸‹ä¸€è½®äº‹ä»¶å¾ªç¯ä¸­è°ƒç”¨:</div><div class="line">process.nextTick(function () &#123;</div><div class="line">    console.log(&apos;nextTick callback!&apos;);</div><div class="line">&#125;);</div><div class="line">console.log(&apos;nextTick was set!&apos;);</div></pre></td></tr></table></figure>
<p>ç”¨Nodeæ‰§è¡Œä¸Šé¢çš„ä»£ç <code>node test.js</code>ï¼Œä½ ä¼šçœ‹åˆ°ï¼Œæ‰“å°è¾“å‡ºæ˜¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">nextTick was set!</div><div class="line">nextTick callback!</div></pre></td></tr></table></figure>
<p>è¿™è¯´æ˜ä¼ å…¥<code>process.nextTick()</code>çš„å‡½æ•°ä¸æ˜¯ç«‹åˆ»æ‰§è¡Œï¼Œè€Œæ˜¯è¦ç­‰åˆ°ä¸‹ä¸€æ¬¡äº‹ä»¶å¾ªç¯ã€‚</p>
<p>Node.jsè¿›ç¨‹æœ¬èº«çš„äº‹ä»¶å°±ç”±<code>process</code>å¯¹è±¡æ¥å¤„ç†ã€‚å¦‚æœæˆ‘ä»¬å“åº”<code>exit</code>äº‹ä»¶ï¼Œå°±å¯ä»¥åœ¨ç¨‹åºå³å°†é€€å‡ºæ—¶æ‰§è¡ŒæŸä¸ªå›è°ƒå‡½æ•°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ç¨‹åºå³å°†é€€å‡ºæ—¶çš„å›è°ƒå‡½æ•°:</span></div><div class="line">process.on(<span class="string">'exit'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">code</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'about to exit with code: '</span> + code);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="åˆ¤æ–­JavaScriptæ‰§è¡Œç¯å¢ƒ"><a href="#åˆ¤æ–­JavaScriptæ‰§è¡Œç¯å¢ƒ" class="headerlink" title="åˆ¤æ–­JavaScriptæ‰§è¡Œç¯å¢ƒ"></a>åˆ¤æ–­JavaScriptæ‰§è¡Œç¯å¢ƒ</h4><p>æœ‰å¾ˆå¤šJavaScriptä»£ç æ—¢èƒ½åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä¹Ÿèƒ½åœ¨Nodeç¯å¢ƒæ‰§è¡Œï¼Œä½†æœ‰äº›æ—¶å€™ï¼Œç¨‹åºæœ¬èº«éœ€è¦åˆ¤æ–­è‡ªå·±åˆ°åº•æ˜¯åœ¨ä»€ä¹ˆç¯å¢ƒä¸‹æ‰§è¡Œçš„ï¼Œå¸¸ç”¨çš„æ–¹å¼å°±æ˜¯æ ¹æ®æµè§ˆå™¨å’ŒNodeç¯å¢ƒæä¾›çš„å…¨å±€å˜é‡åç§°æ¥åˆ¤æ–­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">if (typeof(window) === &apos;undefined&apos;) &#123;</div><div class="line">    console.log(&apos;node.js&apos;);</div><div class="line">&#125; else &#123;</div><div class="line">    console.log(&apos;browser&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="fs"><a href="#fs" class="headerlink" title="fs"></a>fs</h3><h4 id="å¼‚æ­¥è¯»å–æ–‡ä»¶"><a href="#å¼‚æ­¥è¯»å–æ–‡ä»¶" class="headerlink" title="å¼‚æ­¥è¯»å–æ–‡ä»¶"></a>å¼‚æ­¥è¯»å–æ–‡ä»¶</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line">fs.readFile(<span class="string">'sample.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="built_in">console</span>.log(err);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(data);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>sample.txt</code>æ–‡ä»¶å¿…é¡»åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä¸”æ–‡ä»¶ç¼–ç ä¸º<code>utf-8</code>ã€‚å¼‚æ­¥è¯»å–æ—¶ï¼Œä¼ å…¥çš„å›è°ƒå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œå½“æ­£å¸¸è¯»å–æ—¶ï¼Œ<code>err</code>å‚æ•°ä¸º<code>null</code>ï¼Œ<code>data</code>å‚æ•°ä¸ºè¯»å–åˆ°çš„<code>String</code>ã€‚å½“è¯»å–å‘ç”Ÿé”™è¯¯æ—¶ï¼Œ<code>err</code>å‚æ•°ä»£è¡¨ä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼Œ<code>data</code>ä¸º<code>undefined</code>ã€‚è¿™ä¹Ÿæ˜¯Node.jsæ ‡å‡†çš„å›è°ƒå‡½æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨é”™è¯¯ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨ç»“æœã€‚</p>
<p>å½“è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œä¸ä¼ å…¥æ–‡ä»¶ç¼–ç æ—¶ï¼Œå›è°ƒå‡½æ•°çš„<code>data</code>å‚æ•°å°†è¿”å›ä¸€ä¸ª<code>Buffer</code>å¯¹è±¡ã€‚åœ¨Node.jsä¸­ï¼Œ<code>Buffer</code>å¯¹è±¡å°±æ˜¯ä¸€ä¸ªåŒ…å«é›¶ä¸ªæˆ–ä»»æ„ä¸ªå­—èŠ‚çš„æ•°ç»„ï¼ˆæ³¨æ„å’Œ<code>Array</code>ä¸åŒï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line">fs.readFile(<span class="string">'sample.png'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="built_in">console</span>.log(err);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(data);</div><div class="line">        <span class="built_in">console</span>.log(data.length + <span class="string">' bytes'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>Buffer</code>å¯¹è±¡å¯ä»¥å’Œ<code>String</code>ä½œè½¬æ¢ï¼Œä¾‹å¦‚ï¼ŒæŠŠä¸€ä¸ª<code>Buffer</code>å¯¹è±¡è½¬æ¢æˆ<code>String</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Buffer -&gt; String</span></div><div class="line"><span class="keyword">var</span> text = data.toString(<span class="string">'utf-8'</span>);</div><div class="line"><span class="built_in">console</span>.log(text);</div></pre></td></tr></table></figure>
<p>æˆ–è€…æŠŠä¸€ä¸ª<code>String</code>è½¬æ¢æˆ<code>Buffer</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// String -&gt; Buffer</span></div><div class="line"><span class="keyword">var</span> buf = <span class="keyword">new</span> Buffer(text, <span class="string">'utf-8'</span>);</div><div class="line"><span class="built_in">console</span>.log(buf);</div></pre></td></tr></table></figure>
<h4 id="åŒæ­¥è¯»å–æ–‡ä»¶"><a href="#åŒæ­¥è¯»å–æ–‡ä»¶" class="headerlink" title="åŒæ­¥è¯»å–æ–‡ä»¶"></a>åŒæ­¥è¯»å–æ–‡ä»¶</h4><p>fsä¹Ÿæä¾›ç›¸åº”çš„åŒæ­¥è¯»å–å‡½æ•°ã€‚åŒæ­¥è¯»å–çš„å‡½æ•°å’Œå¼‚æ­¥å‡½æ•°ç›¸æ¯”ï¼Œå¤šäº†ä¸€ä¸ª<code>Sync</code>åç¼€ï¼Œå¹¶ä¸”ä¸æ¥æ”¶å›è°ƒå‡½æ•°ï¼Œå‡½æ•°ç›´æ¥è¿”å›ç»“æœ:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> data = fs.readFileSync(<span class="string">'sample.txt'</span>, <span class="string">'utf-8'</span>);</div><div class="line"><span class="built_in">console</span>.log(data);</div></pre></td></tr></table></figure>
<h4 id="å†™æ–‡ä»¶"><a href="#å†™æ–‡ä»¶" class="headerlink" title="å†™æ–‡ä»¶"></a>å†™æ–‡ä»¶</h4><p>å°†æ•°æ®å†™å…¥æ–‡ä»¶æ˜¯é€šè¿‡<code>fs.writeFile()</code>å®ç°çš„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> data = <span class="string">'Hello, Node.js'</span>;</div><div class="line">fs.writeFile(<span class="string">'output.txt'</span>, data, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="built_in">console</span>.log(err);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'ok.'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å’Œ<code>readFile()</code>ç±»ä¼¼ï¼Œ<code>writeFile()</code>ä¹Ÿæœ‰ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œå«<code>writeFileSync()</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> data = <span class="string">'Hello, Node.js'</span>;</div><div class="line">fs.writeFileSync(<span class="string">'output.txt'</span>, data);</div></pre></td></tr></table></figure>
<h4 id="stat"><a href="#stat" class="headerlink" title="stat"></a>stat</h4><p>å¦‚æœæˆ‘ä»¬è¦è·å–æ–‡ä»¶å¤§å°ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨<code>fs.stat()</code>ï¼Œå®ƒè¿”å›ä¸€ä¸ª<code>Stat</code>å¯¹è±¡ï¼Œèƒ½å‘Šè¯‰æˆ‘ä»¬æ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line">fs.stat(<span class="string">'sample.txt'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, stat</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="built_in">console</span>.log(err);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// æ˜¯å¦æ˜¯æ–‡ä»¶:</span></div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'isFile: '</span> + stat.isFile());</div><div class="line">        <span class="comment">// æ˜¯å¦æ˜¯ç›®å½•:</span></div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'isDirectory: '</span> + stat.isDirectory());</div><div class="line">        <span class="keyword">if</span> (stat.isFile()) &#123;</div><div class="line">            <span class="comment">// æ–‡ä»¶å¤§å°:</span></div><div class="line">            <span class="built_in">console</span>.log(<span class="string">'size: '</span> + stat.size);</div><div class="line">            <span class="comment">// åˆ›å»ºæ—¶é—´, Dateå¯¹è±¡:</span></div><div class="line">            <span class="built_in">console</span>.log(<span class="string">'birth time: '</span> + stat.birthtime);</div><div class="line">            <span class="comment">// ä¿®æ”¹æ—¶é—´, Dateå¯¹è±¡:</span></div><div class="line">            <span class="built_in">console</span>.log(<span class="string">'modified time: '</span> + stat.mtime);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="åŒæ­¥è¿˜æ˜¯å¼‚æ­¥"><a href="#åŒæ­¥è¿˜æ˜¯å¼‚æ­¥" class="headerlink" title="åŒæ­¥è¿˜æ˜¯å¼‚æ­¥"></a>åŒæ­¥è¿˜æ˜¯å¼‚æ­¥</h4><p>åŒæ­¥æ–¹æ³•æ˜¯ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨,ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹è¿˜æ˜¯ä½¿ç”¨å¼‚æ­¥çš„æ–¹å¼ã€‚æœåŠ¡å™¨å¯åŠ¨æ—¶å¦‚æœéœ€è¦è¯»å–é…ç½®æ–‡ä»¶ï¼Œæˆ–è€…ç»“æŸæ—¶éœ€è¦å†™å…¥åˆ°çŠ¶æ€æ–‡ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨åŒæ­¥ä»£ç ï¼Œå› ä¸ºè¿™äº›ä»£ç åªåœ¨å¯åŠ¨å’Œç»“æŸæ—¶æ‰§è¡Œä¸€æ¬¡ã€‚</p>
<h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a>stream</h3><p>åœ¨Node.jsä¸­ï¼Œæµä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬åªéœ€è¦å“åº”æµçš„äº‹ä»¶å°±å¯ä»¥äº†ï¼š<code>data</code>äº‹ä»¶è¡¨ç¤ºæµçš„æ•°æ®å·²ç»å¯ä»¥è¯»å–äº†ï¼Œ<code>end</code>äº‹ä»¶è¡¨ç¤ºè¿™ä¸ªæµå·²ç»åˆ°æœ«å°¾äº†ï¼Œæ²¡æœ‰æ•°æ®å¯ä»¥è¯»å–äº†ï¼Œ<code>error</code>äº‹ä»¶è¡¨ç¤ºå‡ºé”™äº†ã€‚</p>
<h4 id="æµè¯»å–æ–‡ä»¶"><a href="#æµè¯»å–æ–‡ä»¶" class="headerlink" title="æµè¯»å–æ–‡ä»¶"></a>æµè¯»å–æ–‡ä»¶</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="comment">// æ‰“å¼€ä¸€ä¸ªæµ:</span></div><div class="line"><span class="keyword">var</span> rs = fs.createReadStream(<span class="string">'sample.txt'</span>, <span class="string">'utf-8'</span>);</div><div class="line"></div><div class="line">rs.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'DATA:'</span>)</div><div class="line">    <span class="built_in">console</span>.log(chunk);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">rs.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'END'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">rs.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'ERROR: '</span> + err);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="æµå†™å…¥æ–‡ä»¶"><a href="#æµå†™å…¥æ–‡ä»¶" class="headerlink" title="æµå†™å…¥æ–‡ä»¶"></a>æµå†™å…¥æ–‡ä»¶</h4><p>è¦ä»¥æµçš„å½¢å¼å†™å…¥æ–‡ä»¶ï¼Œåªéœ€è¦ä¸æ–­è°ƒç”¨<code>write()</code>æ–¹æ³•ï¼Œæœ€åä»¥<code>end()</code>ç»“æŸï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> ws1 = fs.createWriteStream(<span class="string">'output1.txt'</span>, <span class="string">'utf-8'</span>);</div><div class="line">ws1.write(<span class="string">'ä½¿ç”¨Streamå†™å…¥æ–‡æœ¬æ•°æ®...\n'</span>);</div><div class="line">ws1.write(<span class="string">'END.'</span>);</div><div class="line">ws1.end();</div><div class="line"></div><div class="line"><span class="keyword">var</span> ws2 = fs.createWriteStream(<span class="string">'output2.txt'</span>);</div><div class="line">ws2.write(<span class="keyword">new</span> Buffer(<span class="string">'ä½¿ç”¨Streamå†™å…¥äºŒè¿›åˆ¶æ•°æ®...\n'</span>, <span class="string">'utf-8'</span>));</div><div class="line">ws2.write(<span class="keyword">new</span> Buffer(<span class="string">'END.'</span>, <span class="string">'utf-8'</span>));</div><div class="line">ws2.end();</div></pre></td></tr></table></figure>
<h4 id="pipe"><a href="#pipe" class="headerlink" title="pipe"></a>pipe</h4><p>å°±åƒå¯ä»¥æŠŠä¸¤ä¸ªæ°´ç®¡ä¸²æˆä¸€ä¸ªæ›´é•¿çš„æ°´ç®¡ä¸€æ ·ï¼Œä¸¤ä¸ªæµä¹Ÿå¯ä»¥ä¸²èµ·æ¥ã€‚ä¸€ä¸ª<code>Readable</code>æµå’Œä¸€ä¸ª<code>Writable</code>æµä¸²èµ·æ¥åï¼Œæ‰€æœ‰çš„æ•°æ®è‡ªåŠ¨ä»<code>Readable</code>æµè¿›å…¥<code>Writable</code>æµï¼Œè¿™ç§æ“ä½œå«<code>pipe</code>ã€‚åœ¨Node.jsä¸­ï¼Œ<code>Readable</code>æµæœ‰ä¸€ä¸ª<code>pipe()</code>æ–¹æ³•ï¼Œå°±æ˜¯ç”¨æ¥å¹²è¿™ä»¶äº‹çš„ã€‚</p>
<p>è®©æˆ‘ä»¬ç”¨<code>pipe()</code>æŠŠä¸€ä¸ªæ–‡ä»¶æµå’Œå¦ä¸€ä¸ªæ–‡ä»¶æµä¸²èµ·æ¥ï¼Œè¿™æ ·æºæ–‡ä»¶çš„æ‰€æœ‰æ•°æ®å°±è‡ªåŠ¨å†™å…¥åˆ°ç›®æ ‡æ–‡ä»¶é‡Œäº†ï¼Œæ‰€ä»¥ï¼Œè¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¤åˆ¶æ–‡ä»¶çš„ç¨‹åºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> rs = fs.createReadStream(<span class="string">'sample.txt'</span>);</div><div class="line"><span class="keyword">var</span> ws = fs.createWriteStream(<span class="string">'copied.txt'</span>);</div><div class="line"></div><div class="line">rs.pipe(ws);</div></pre></td></tr></table></figure>
<h3 id="http"><a href="#http" class="headerlink" title="http"></a>http</h3><h4 id="HttpæœåŠ¡å™¨"><a href="#HttpæœåŠ¡å™¨" class="headerlink" title="HttpæœåŠ¡å™¨"></a>HttpæœåŠ¡å™¨</h4><p>Node.jsè‡ªå¸¦çš„<code>http</code>æ¨¡å—å®Œæˆäº†å¯¹httpåè®®çš„è§£æã€‚ç›´æ¥æ“ä½œ<code>http</code>æ¨¡å—æä¾›çš„<code>request</code>å’Œ<code>response</code>å¯¹è±¡ã€‚</p>
<p><code>request</code>å¯¹è±¡å°è£…äº†HTTPè¯·æ±‚ï¼Œæˆ‘ä»¬è°ƒç”¨<code>request</code>å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å°±å¯ä»¥æ‹¿åˆ°æ‰€æœ‰HTTPè¯·æ±‚çš„ä¿¡æ¯ï¼›<br><code>response</code>å¯¹è±¡å°è£…äº†HTTPå“åº”ï¼Œæˆ‘ä»¬æ“ä½œ<code>response</code>å¯¹è±¡çš„æ–¹æ³•ï¼Œå°±å¯ä»¥æŠŠHTTPå“åº”è¿”å›ç»™æµè§ˆå™¨ã€‚</p>
<p>æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªæœ€ç®€å•çš„Webç¨‹åº<code>hello.js</code>ï¼Œå®ƒå¯¹äºæ‰€æœ‰è¯·æ±‚ï¼Œéƒ½è¿”å›<code>Hello world!</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¯¼å…¥httpæ¨¡å—:</span></div><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"></div><div class="line"><span class="comment">// åˆ›å»ºhttp serverï¼Œå¹¶ä¼ å…¥å›è°ƒå‡½æ•°:</span></div><div class="line"><span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">request, response</span>) </span>&#123;</div><div class="line">    <span class="comment">// å›è°ƒå‡½æ•°æ¥æ”¶requestå’Œresponseå¯¹è±¡,</span></div><div class="line">    <span class="comment">// è·å¾—HTTPè¯·æ±‚çš„methodå’Œurl:</span></div><div class="line">    <span class="built_in">console</span>.log(request.method + <span class="string">': '</span> + request.url);</div><div class="line">    <span class="comment">// å°†HTTPå“åº”200å†™å…¥response, åŒæ—¶è®¾ç½®Content-Type: text/html:</span></div><div class="line">    response.writeHead(<span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/html'</span>&#125;);</div><div class="line">    <span class="comment">// å°†HTTPå“åº”çš„HTMLå†…å®¹å†™å…¥response:</span></div><div class="line">    response.end(<span class="string">'&lt;h1&gt;Hello world!&lt;/h1&gt;'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// è®©æœåŠ¡å™¨ç›‘å¬8080ç«¯å£:</span></div><div class="line">server.listen(<span class="number">8080</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Server is running at http://127.0.0.1:8080/'</span>);</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ node hello.js </div><div class="line">Server is running at http:<span class="comment">//127.0.0.1:8080/</span></div></pre></td></tr></table></figure>
<p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥<code>http://localhost:8080</code>å³å¯çœ‹åˆ°è¾“å‡ºã€‚</p>
<h4 id="æ–‡ä»¶æœåŠ¡å™¨"><a href="#æ–‡ä»¶æœåŠ¡å™¨" class="headerlink" title="æ–‡ä»¶æœåŠ¡å™¨"></a>æ–‡ä»¶æœåŠ¡å™¨</h4><p>æˆ‘ä»¬å¯ä»¥è®¾å®šä¸€ä¸ªç›®å½•ï¼Œç„¶åè®©Webç¨‹åºå˜æˆä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨ã€‚è¦å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦è§£æ<code>request.url</code>ä¸­çš„è·¯å¾„ï¼Œç„¶ååœ¨æœ¬åœ°æ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶ï¼ŒæŠŠæ–‡ä»¶å†…å®¹å‘é€å‡ºå»å°±å¯ä»¥äº†ã€‚</p>
<p>è§£æURLéœ€è¦ç”¨åˆ°Node.jsæä¾›çš„<code>url</code>æ¨¡å—ï¼Œå®ƒä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œé€šè¿‡<code>parse()</code>å°†ä¸€ä¸ªå­—ç¬¦ä¸²è§£æä¸ºä¸€ä¸ª<code>Url</code>å¯¹è±¡ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(url.parse(<span class="string">'http://user:pass@host.com:8080/path/to/file?query=string#hash'</span>));</div></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Url &#123;</div><div class="line">  protocol: <span class="string">'http:'</span>,</div><div class="line">  slashes: <span class="literal">true</span>,</div><div class="line">  auth: <span class="string">'user:pass'</span>,</div><div class="line">  host: <span class="string">'host.com:8080'</span>,</div><div class="line">  port: <span class="string">'8080'</span>,</div><div class="line">  hostname: <span class="string">'host.com'</span>,</div><div class="line">  hash: <span class="string">'#hash'</span>,</div><div class="line">  search: <span class="string">'?query=string'</span>,</div><div class="line">  query: <span class="string">'query=string'</span>,</div><div class="line">  pathname: <span class="string">'/path/to/file'</span>,</div><div class="line">  path: <span class="string">'/path/to/file?query=string'</span>,</div><div class="line">  href: <span class="string">'http://user:pass@host.com:8080/path/to/file?query=string#hash'</span> &#125;</div></pre></td></tr></table></figure>
<p>å¤„ç†æœ¬åœ°æ–‡ä»¶ç›®å½•éœ€è¦ä½¿ç”¨Node.jsæä¾›çš„<code>path</code>æ¨¡å—ï¼Œå®ƒå¯ä»¥æ–¹ä¾¿åœ°æ„é€ ç›®å½•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var path = require(&apos;path&apos;);</div><div class="line"></div><div class="line">// è§£æå½“å‰ç›®å½•:</div><div class="line">var workDir = path.resolve(&apos;.&apos;); // &apos;/Users/michael&apos;</div><div class="line"></div><div class="line">// ç»„åˆå®Œæ•´çš„æ–‡ä»¶è·¯å¾„:å½“å‰ç›®å½•+&apos;pub&apos;+&apos;index.html&apos;:</div><div class="line">var filePath = path.join(workDir, &apos;pub&apos;, &apos;index.html&apos;);</div><div class="line">// &apos;/Users/michael/pub/index.html&apos;</div></pre></td></tr></table></figure>
<p>æœ€åï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨<code>file_server.js</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span></div><div class="line">    fs = <span class="built_in">require</span>(<span class="string">'fs'</span>),</div><div class="line">    url = <span class="built_in">require</span>(<span class="string">'url'</span>),</div><div class="line">    path = <span class="built_in">require</span>(<span class="string">'path'</span>),</div><div class="line">    http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"></div><div class="line"><span class="comment">// ä»å‘½ä»¤è¡Œå‚æ•°è·å–rootç›®å½•ï¼Œé»˜è®¤æ˜¯å½“å‰ç›®å½•:</span></div><div class="line"><span class="comment">//processæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå¯é€šè¿‡process.argvè·å¾—å‘½ä»¤è¡Œå‚æ•°ã€‚ç”±äºargv[0]å›ºå®šç­‰äºNodeJSæ‰§è¡Œç¨‹åºçš„ç»å¯¹è·¯å¾„ï¼Œargv[1]å›ºå®šç­‰äºä¸»æ¨¡å—çš„ç»å¯¹è·¯å¾„ï¼Œå› æ­¤ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ä»argv[2]è¿™ä¸ªä½ç½®å¼€å§‹ã€‚</span></div><div class="line"><span class="keyword">var</span> root = path.resolve(process.argv[<span class="number">2</span>] || <span class="string">'.'</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Static root dir: '</span> + root);</div><div class="line"></div><div class="line"><span class="comment">// åˆ›å»ºæœåŠ¡å™¨:</span></div><div class="line"><span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">request, response</span>) </span>&#123;</div><div class="line">    <span class="comment">// è·å¾—URLçš„pathï¼Œç±»ä¼¼ '/css/bootstrap.css':</span></div><div class="line">    <span class="keyword">var</span> pathname = url.parse(request.url).pathname;</div><div class="line">    <span class="comment">// è·å¾—å¯¹åº”çš„æœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼Œç±»ä¼¼ '/srv/www/css/bootstrap.css':</span></div><div class="line">    <span class="keyword">var</span> filepath = path.join(root, pathname);</div><div class="line">    <span class="comment">// è·å–æ–‡ä»¶çŠ¶æ€:</span></div><div class="line">    fs.stat(filepath, <span class="function"><span class="keyword">function</span> (<span class="params">err, stats</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!err &amp;&amp; stats.isFile()) &#123;</div><div class="line">            <span class="comment">// æ²¡æœ‰å‡ºé”™å¹¶ä¸”æ–‡ä»¶å­˜åœ¨:</span></div><div class="line">            <span class="built_in">console</span>.log(<span class="string">'200 '</span> + request.url);</div><div class="line">            <span class="comment">// å‘é€200å“åº”:</span></div><div class="line">            response.writeHead(<span class="number">200</span>);</div><div class="line">            <span class="comment">// å°†æ–‡ä»¶æµå¯¼å‘response:</span></div><div class="line">            fs.createReadStream(filepath).pipe(response);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">// å‡ºé”™äº†æˆ–è€…æ–‡ä»¶ä¸å­˜åœ¨:</span></div><div class="line">            <span class="built_in">console</span>.log(<span class="string">'404 '</span> + request.url);</div><div class="line">            <span class="comment">// å‘é€404å“åº”:</span></div><div class="line">            response.writeHead(<span class="number">404</span>);</div><div class="line">            response.end(<span class="string">'404 Not Found'</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">server.listen(<span class="number">8080</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Server is running at http://127.0.0.1:8080/'</span>);</div></pre></td></tr></table></figure>
<p>æ²¡æœ‰å¿…è¦æ‰‹åŠ¨è¯»å–æ–‡ä»¶å†…å®¹ã€‚ç”±äº<code>response</code>å¯¹è±¡æœ¬èº«æ˜¯ä¸€ä¸ª<code>Writable Stream</code>ï¼Œç›´æ¥ç”¨<code>pipe()</code>æ–¹æ³•å°±å®ç°äº†è‡ªåŠ¨è¯»å–æ–‡ä»¶å†…å®¹å¹¶è¾“å‡ºåˆ°HTTPå“åº”ã€‚</p>
<p>åœ¨å‘½ä»¤è¡Œè¿è¡Œ<code>node file_server.js /path/to/dir</code>ï¼ŒæŠŠ<code>/path/to/dir</code>æ”¹æˆä½ æœ¬åœ°çš„ä¸€ä¸ªæœ‰æ•ˆçš„ç›®å½•ï¼Œç„¶ååœ¨æµè§ˆå™¨ä¸­è¾“å…¥<code>http://localhost:8080/index.html</code>ã€‚åªè¦å½“å‰ç›®å½•ä¸‹å­˜åœ¨æ–‡ä»¶<code>index.html</code>ï¼ŒæœåŠ¡å™¨å°±å¯ä»¥æŠŠæ–‡ä»¶å†…å®¹å‘é€ç»™æµè§ˆå™¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[lldb è°ƒè¯•æ–¹æ³•]]></title>
      <url>http://zhang759740844.github.io/2016/09/21/lldb%E8%B0%83%E8%AF%95%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>å¶ç„¶çœ‹åˆ°ä½¿ç”¨ lldb é‡Œçš„ watchpoint è°ƒè¯•ï¼Œæ„Ÿè§‰å¾ˆç¥å¥‡ï¼Œå°±è¯¦ç»†äº†è§£äº†ä¸‹ lldb è°ƒè¯•çš„ä½¿ç”¨æ–¹æ³•ã€‚ æŸ¥é˜…äº†è®¸å¤šæ–‡ç« <a href="https://objccn.io/issue-19-2/" target="_blank" rel="external">ä¸è°ƒè¯•å™¨å…±èˆ - LLDB çš„åå°”å…¹</a>è¿™ç¯‡æ–‡ç« å¸®åŠ©æœ€å¤§ã€‚</p>
<a id="more"></a>
<p>Xcodeä¸­å†…åµŒäº†LLDBæ§åˆ¶å°ï¼Œåœ¨Xcodeä¸­ä»£ç çš„ä¸‹æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°LLDBæ§åˆ¶å°ã€‚</p>
<p>LLDBæ§åˆ¶å°å¹³æ—¶ä¼šè¾“å‡ºä¸€äº›logä¿¡æ¯(Debugger outputä¸­)ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¾“å…¥å‘½ä»¤è°ƒè¯•ï¼Œå¿…é¡»è®©ç¨‹åºè¿›å…¥æš‚åœçŠ¶æ€ã€‚è®©ç¨‹åºè¿›å…¥æš‚åœçŠ¶æ€çš„æ–¹å¼ä¸»è¦æœ‰2ç§ï¼š</p>
<ol>
<li>æ–­ç‚¹æˆ–è€…watchpoint: åœ¨ä»£ç ä¸­è®¾ç½®ä¸€ä¸ªæ–­ç‚¹ï¼ˆwatchpointï¼‰ï¼Œå½“ç¨‹åºè¿è¡Œåˆ°æ–­ç‚¹ä½ç½®çš„æ—¶å€™ï¼Œä¼šè¿›å…¥stopçŠ¶æ€</li>
<li>ç›´æ¥æš‚åœï¼Œæ§åˆ¶å°ä¸Šæ–¹æœ‰ä¸€ä¸ªæš‚åœæŒ‰é’®ï¼Œä¸Šå›¾çº¢æ¡†å·²æ ‡å‡ºï¼Œç‚¹å‡»å³å¯æš‚åœç¨‹åº</li>
</ol>
<p>ä¸è¿‡æœ€å¥½è¿˜æ˜¯ä¸è¦ç›´æ¥æš‚åœï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹çš„å½“å‰ä½œç”¨åŸŸæ²¡æœ‰ä»»ä½•å˜é‡ï¼Œå³ä½¿è¿›å…¥äº† lldb ä¹Ÿåšä¸äº†ä»€ä¹ˆäº‹ã€‚</p>
<h2 id="expression"><a href="#expression" class="headerlink" title="expression"></a>expression</h2><p>expressionçš„å‡ ä¸ªå‘½ä»¤æ˜¯æœ€å¸¸ç”¨çš„ï¼Œèƒ½æå‡debugæ•ˆç‡çš„å‘½ä»¤ã€‚</p>
<h3 id="print"><a href="#print" class="headerlink" title="print"></a>print</h3><p>æ‰“å°ä¸€ä¸ªå¯¹è±¡:<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_1.png?raw=true" alt="print"><br>å¯ä»¥ç›´æ¥ç¼©å†™<code>p</code>è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚</p>
<p>ç»“æœä¸­æœ‰ä¸ª<code>$0</code>ï¼Œå¯ä»¥ä½¿ç”¨å®ƒæŒ‡å‘è¿™ä¸ªç»“æœã€‚lldb ä¸­å¯ä»¥åˆ›å»ºå¯¹è±¡ï¼Œä½†æ˜¯è¿™ä¸ªå¯¹è±¡çš„å‘½åå¿…é¡»è¦ä»¥<code>$</code>å¼€å¤´,è¡¨ç¤ºå‘½åç©ºé—´æ˜¯lldbï¼Œä»¥å…å’Œå¤–éƒ¨ä»£ç ä¸­çš„åå­—å†²çªï¼Œå¦‚ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_2.png?raw=true" alt="print2"></p>
<h3 id="expression-1"><a href="#expression-1" class="headerlink" title="expression"></a>expression</h3><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><p>å¦‚æœæƒ³è¦æ”¹å˜ä¸€ä¸ªå€¼ï¼Œæˆ–è€…æ‰§è¡Œä¸€ä¸ªæ–¹æ³•ã€‚å¯ä»¥ä½¿ç”¨<code>expression</code>æˆ–è€…<code>e</code>ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_3.png?raw=true" alt="expression"></p>
<p>printå…¶å®æ˜¯ç‰¹æ®Šçš„expressionï¼Œæ¯”å¦‚<code>p count =18</code>å…¶ç»“æœå’Œ<code>expression count = 18</code>ç»“æœä¸€æ ·ã€‚äº‹å®ä¸Šï¼Œ<code>print</code>æ˜¯ <code>expression --</code> çš„ç¼©å†™ã€‚</p>
<h4 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h4><p>ç”±äº<code>expression</code>å¯ä»¥æ”¹å˜å€¼ï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€çš„æ”¹å˜Viewçš„é¢œè‰²ï¼Œè€Œä¸éœ€è¦é‡æ–°ç¼–è¯‘ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ”¹å˜é¢œè‰²</span></div><div class="line">(lldb) expression <span class="keyword">self</span>.view.backgroundColor = [<span class="built_in">UIColor</span> redColor]</div><div class="line"><span class="comment">// åˆ·æ–°ç•Œé¢</span></div><div class="line">(lldb) expression [<span class="built_in">CATransaction</span> flush]</div></pre></td></tr></table></figure></p>
<p>ä¸åªæ˜¯æ”¹å˜é¢œè‰²ï¼Œframeï¼Œanimationç­‰éƒ½èƒ½æ”¹å˜ï¼Œéå¸¸æœ‰ç”¨ã€‚</p>
<p>å¦‚æœ€å¼€å§‹æ‰€è¯´ï¼Œä¸èƒ½ç›´æ¥æš‚åœï¼Œå¿…é¡»è¦åœ¨å½“å‰ç•Œé¢ä¸­è§¦å‘æ–­ç‚¹ï¼Œæ¯”å¦‚é‡å†™touchæ–¹æ³•æ·»åŠ æ–­ç‚¹ç­‰ã€‚</p>
<h3 id="po"><a href="#po" class="headerlink" title="po"></a>po</h3><p><code>print</code>è¾“å‡ºæ¯”è¾ƒå•°å—¦ï¼Œè€Œä¸”å½“å°è¯•æ‰“å°å¤æ‚å¯¹è±¡çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¼šå¾ˆè›‹ç–¼ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(lldb) p @[ <span class="string">@"foo"</span>, <span class="string">@"bar"</span> ]</div><div class="line"></div><div class="line">(<span class="built_in">NSArray</span> *) $<span class="number">8</span> = <span class="number">0x00007fdb9b71b3e0</span> <span class="string">@"2 objects"</span></div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨<code>po</code>(print object çš„ç¼©å†™)ï¼Œç›¸å½“äºè°ƒç”¨å¯¹è±¡çš„<code>description</code>æ–¹æ³•ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">(lldb) po $<span class="number">8</span></div><div class="line">&lt;__NSArrayI <span class="number">0x7fdb9b71b3e0</span>&gt;(</div><div class="line">foo,</div><div class="line">bar</div><div class="line">)</div><div class="line">(lldb) po <span class="string">@"lunar"</span></div><div class="line">lunar</div></pre></td></tr></table></figure></p>
<h2 id="thread"><a href="#thread" class="headerlink" title="thread"></a>thread</h2><h3 id="bt"><a href="#bt" class="headerlink" title="bt"></a>bt</h3><p>å¯ä»¥æ‰“æ ˆä¸­çš„æ‰€æœ‰å¸§(frame)ã€‚è¿™äº›frameå’Œå·¦è¾¹çº¢æ¡†é‡Œçš„å †æ ˆæ˜¯ä¸€è‡´çš„ã€‚å¹³æ—¶æˆ‘ä»¬çœ‹åˆ°çš„å·¦è¾¹çš„å †æ ˆå°±æ˜¯frame:<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_4.png?raw=true" alt="frame"></p>
<h3 id="thread-return"><a href="#thread-return" class="headerlink" title="thread return"></a>thread return</h3><p>è¿™ä¹Ÿæ˜¯æ¯”è¾ƒæœ‰ç”¨çš„ä¸€ä¸ªå‘½ä»¤ã€‚Debugçš„æ—¶å€™ï¼Œä¹Ÿè®¸ä¼šå› ä¸ºå„ç§åŸå› ï¼Œæˆ‘ä»¬ä¸æƒ³è®©ä»£ç æ‰§è¡ŒæŸä¸ªæ–¹æ³•ï¼Œæˆ–è€…è¦ç›´æ¥è¿”å›ä¸€ä¸ªæƒ³è¦çš„å€¼ã€‚è¿™æ—¶å€™å°±è¯¥thread returnä¸Šåœºäº†ã€‚</p>
<p>å®ƒæœ‰ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œåœ¨æ‰§è¡Œæ—¶å®ƒä¼šæŠŠå¯é€‰å‚æ•°åŠ è½½è¿›è¿”å›å¯„å­˜å™¨é‡Œï¼Œç„¶å<strong>ç«‹åˆ»æ‰§è¡Œè¿”å›å‘½ä»¤ï¼Œè·³å‡ºå½“å‰æ ˆå¸§</strong>ã€‚è¿™æ„å‘³è¿™å‡½æ•°å‰©ä½™çš„éƒ¨åˆ†<strong>ä¸ä¼šè¢«æ‰§è¡Œ</strong>ã€‚è¿™ä¼šç»™ ARC çš„å¼•ç”¨è®¡æ•°é€ æˆä¸€äº›é—®é¢˜ï¼Œæˆ–è€…ä¼šä½¿å‡½æ•°å†…çš„æ¸…ç†éƒ¨åˆ†å¤±æ•ˆã€‚ä½†æ˜¯<strong>åœ¨å‡½æ•°çš„å¼€å¤´æ‰§è¡Œè¿™ä¸ªå‘½ä»¤</strong>ï¼Œæ˜¯ä¸ªéå¸¸å¥½çš„éš”ç¦»è¿™ä¸ªå‡½æ•°ï¼Œä¼ªé€ è¿”å›å€¼çš„æ–¹å¼ ã€‚</p>
<p>æ¯”å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_5.png?raw=true" alt="return"><br>æ­£å¸¸é€šè¿‡<code>isOdd</code>æ–¹æ³•ï¼Œä¸€å®šæ˜¯<code>return NO</code>çš„ï¼Œä½†æ˜¯é€šè¿‡<code>(lldb) thread return YES</code>ï¼Œè·³è¿‡äº†<code>isOdd</code>æ–¹æ³•é‡Œçš„æ–¹æ³•å—ï¼Œç›´æ¥<code>return YES</code></p>
<p>æ­£å¦‚ä¸Šé¢æ‰€è¿°ï¼Œå¿…é¡»è¦åœ¨æ–­ç‚¹è¿›è¡Œåˆ°å¦‚å›¾æ‰€ç¤ºçš„åœ°æ–¹æ‰å¯ä»¥ä½¿ç”¨<code>thread return</code>ï¼Œå› ä¸º:</p>
<ol>
<li>æ­¤æ—¶å½“å‰æ ˆå¸§æ˜¯<code>isOdd</code></li>
<li>ä¸ä¼šé€ æˆå¼•ç”¨é—®é¢˜</li>
</ol>
<h2 id="breakpoint"><a href="#breakpoint" class="headerlink" title="breakpoint"></a>breakpoint</h2><p>æ–­ç‚¹å½“ç„¶æ˜¯è°ƒè¯•å¿…ä¸å¯å°‘çš„ä¸œè¥¿ï¼Œä¸‹é¢ä¸ä¼šè¯´æ˜æ€æ ·æ·»åŠ æ–­ç‚¹ï¼Œè€Œæ˜¯å°†åˆ—ä¸¾ä¸€äº›æ–­ç‚¹çš„ä½¿ç”¨æŠ€å·§.</p>
<h3 id="æµç¨‹æ§åˆ¶"><a href="#æµç¨‹æ§åˆ¶" class="headerlink" title="æµç¨‹æ§åˆ¶"></a>æµç¨‹æ§åˆ¶</h3><p>å½“æ’å…¥æ–­ç‚¹åï¼Œç¨‹åºåˆ°è¾¾æ–­ç‚¹æ—¶ä¼šå°±ä¼šåœæ­¢è¿è¡Œã€‚è°ƒè¯•æ¡ä¸Šä¼šå‡ºç°å¦‚ä¸‹å››ä¸ªæŒ‰é’®:<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_6.png?raw=true" alt="debug"><br>æ„ä¹‰éƒ½å¾ˆæ˜ç¡®ï¼Œä¸å¤šè¯´äº†ï¼Œåˆ—ä¸¾ä¸‹å¯¹åº”çš„å‘½ä»¤ï¼š</p>
<ol>
<li>continueæŒ‰é’® =&gt; <code>continue</code>,ç¼©å†™<code>c</code></li>
<li>step overæŒ‰é’® =&gt; <code>next</code>ï¼Œç¼©å†™<code>n</code></li>
<li>step inæŒ‰é’® =&gt; <code>step</code>,ç¼©å†™<code>s</code></li>
<li>step outæŒ‰é’® =&gt; <code>finish</code></li>
</ol>
<h3 id="è®¾ç½®æ–­ç‚¹"><a href="#è®¾ç½®æ–­ç‚¹" class="headerlink" title="è®¾ç½®æ–­ç‚¹"></a>è®¾ç½®æ–­ç‚¹</h3><p>åœ¨æ–­ç‚¹å¤„å³å‡»ï¼Œé€‰æ‹©<code>Edit Breakpoint</code>å¼¹å‡ºå¦‚ä¸‹è®¾ç½®æ¡†ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_7.png?raw=true" alt="breakpoint"></p>
<h4 id="è“è‰²çš„å‹¾"><a href="#è“è‰²çš„å‹¾" class="headerlink" title="è“è‰²çš„å‹¾"></a>è“è‰²çš„å‹¾</h4><p>è¡¨ç¤ºenableå’Œdisableæ–­ç‚¹ã€‚</p>
<h4 id="Condition"><a href="#Condition" class="headerlink" title="Condition"></a>Condition</h4><p>æŒ‡çš„æ˜¯æ¡ä»¶è¡¨è¾¾å¼ï¼Œè¯¥é¡¹å…è®¸æˆ‘ä»¬å¯¹æ–­ç‚¹ç”Ÿæ•ˆè®¾ç½®æ¡ä»¶ï¼Œè¡¨ç¤ºå½“æ»¡è¶³æŸä¸€ç‰¹å®šæ¡ä»¶çš„å‰æä¸‹ï¼Œè¯¥æ–­ç‚¹æ‰ç”Ÿæ•ˆã€‚ï¼ˆè¯¥æ¡ä»¶çš„å½•å…¥ï¼Œ<strong>ä¸èƒ½å¤Ÿè¯†åˆ«é¢„å¤„ç†çš„å®å®šä¹‰ï¼Œä¹Ÿä¸èƒ½è¯†åˆ«æ–­ç‚¹ä½œç”¨åŸŸä¹‹å¤–çš„å˜é‡å’Œæ–¹æ³•</strong>ï¼‰ã€‚</p>
<h4 id="Ignore"><a href="#Ignore" class="headerlink" title="Ignore"></a>Ignore</h4><p>å¿½ç•¥æ¬¡æ•°ã€‚å®ƒæŒ‡å®šäº†åœ¨æ–­ç‚¹ç”Ÿæ•ˆï¼Œåº”ç”¨æš‚åœä¹‹å‰ï¼Œä»£ç å¿½ç•¥æ–­ç‚¹çš„æ¬¡æ•°ã€‚ä½ å¦‚æœå¸Œæœ›åº”ç”¨è¿è¡Œä¸€æ®µæ—¶é—´åæ–­ç‚¹æ‰ç”Ÿæ•ˆï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ã€‚æ¯”å¦‚è¯´åœ¨è°ƒè¯•æŸä¸€å¾ªç¯ä½“çš„æ—¶å€™ã€‚</p>
<h4 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h4><p>å®ƒè¡¨ç¤ºå½“æ–­ç‚¹ç”Ÿæ•ˆæ—¶ï¼ŒXcodeä½œå‡ºååº”åçš„è¡Œä¸ºåŠ¨ä½œã€‚ç‚¹å‡»å³è¾¹çš„Add Actioné€‰é¡¹ä¼šå¼¹å‡ºå¦‚ä¸‹èœå•ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_8.jpg?raw=true" alt="menu"><br>é»˜è®¤çš„æ˜¯Debugger Commandã€‚è¿˜æœ‰ä»¥ä¸‹å‡ ç§åŠ¨ä½œä¾›é€‰æ‹©ï¼Œä¸‹é¢å°†ä»‹ç»ä¸¤ä¸ªå¸¸ç”¨çš„ï¼š</p>
<ol>
<li><strong>Debugger Command</strong>ï¼šé»˜è®¤çš„é€‰é¡¹ï¼Œå¯ä»¥è®©æ–­ç‚¹æ‰§è¡ŒLLDBè°ƒè¯•å‘½ä»¤ã€‚</li>
<li><strong>Log Message</strong>ï¼šå¯ä»¥ç”Ÿæˆæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå°†ç›¸å…³çš„æ¶ˆæ¯è¾“å‡ºåˆ°æ§åˆ¶å°ä¸Š.éšä¾¿å†™ä»€ä¹ˆéƒ½èƒ½è¾“å‡ºï¼Œè¾“å‡ºçš„å¯¹è±¡éœ€è¦ä½¿ç”¨<code>@exp@</code>å½¢å¼ã€‚</li>
</ol>
<h4 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h4><p>ä¸€ä¸ªé€‰é¡¹ï¼Œå‹¾ä¸Šå¯ä»¥åœ¨è¿è¡Œåˆ°æ–­ç‚¹åä¸æš‚åœï¼Œè‡ªåŠ¨å‘ä¸‹è¿è¡Œï¼Œé…åˆActionç›¸å½“äºæ‰“äº†æ–­ç‚¹ã€‚</p>
<h3 id="æ–­ç‚¹ç±»å‹"><a href="#æ–­ç‚¹ç±»å‹" class="headerlink" title="æ–­ç‚¹ç±»å‹"></a>æ–­ç‚¹ç±»å‹</h3><h4 id="å¼‚å¸¸æ–­ç‚¹"><a href="#å¼‚å¸¸æ–­ç‚¹" class="headerlink" title="å¼‚å¸¸æ–­ç‚¹"></a>å¼‚å¸¸æ–­ç‚¹</h4><p>å¼‚å¸¸æ–­ç‚¹æ˜¯ä»£ç å‡ºç°é—®é¢˜å¯¼è‡´ç¼–è¯‘å™¨æŠ›å‡ºå¼‚å¸¸æ—¶è§¦å‘çš„æ–­ç‚¹ã€‚å®ƒåœ¨æ–­ç‚¹å¯¼èˆªå™¨ä¸­è®¾ç½®ã€‚ç‚¹å‡»ï¼‹å·ï¼Œé€‰æ‹©Exception Breakpointé€‰é¡¹ã€‚å¦‚ä¸‹å›¾ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_9.png?raw=true" alt="exception"></p>
<h4 id="ç¬¦å·æ–­ç‚¹"><a href="#ç¬¦å·æ–­ç‚¹" class="headerlink" title="ç¬¦å·æ–­ç‚¹"></a>ç¬¦å·æ–­ç‚¹</h4><p>ä»–å¯ä»¥ä¸­æ–­æŸä¸ªæ–¹æ³•çš„è°ƒç”¨ï¼Œå¯è°“æ˜¯å¼‚å¸¸å¼ºå¤§ï¼Œåœ¨æ–­ç‚¹å¯¼èˆªå™¨ç•Œé¢ï¼Œç‚¹å‡»ï¼‹å·ï¼Œé€‰æ‹©Add Symbolic Breakpointé€‰é¡¹ï¼Œç„¶åä¼šå¼¹å‡ºå¦‚å›¾æ‰€ç¤ºçš„å¯¹è¯æ¡†:<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_10.png?raw=true" alt="exception"></p>
<p>å®ƒæ¯”æ™®é€šæ–­ç‚¹çš„è‡ªå®šä¹‰è®¾ç½®ç•Œé¢å¤šå‡ºäº†ä¸¤ä¸ªå†…å®¹</p>
<ul>
<li><p><strong>Symbol</strong>ï¼šç”¨æ¥è®¾ç½®å½“å‰æ–­ç‚¹ä½œç”¨åŸŸæ‰€èƒ½è¯†åˆ«çš„æ–¹æ³•ï¼Œè¿™é‡Œé¢æ—¢å¯ä»¥æ˜¯è‡ªå®šä¹‰çš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯ç³»ç»Ÿçš„APIæ–¹æ³•ã€‚ï¼ˆæ³¨æ„å¿…é¡»è¡¨æ˜æ˜¯ç±»æ–¹æ³•è¿˜æ˜¯æˆå‘˜æ–¹æ³•ï¼‰ä¾‹å¦‚:</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-[MyViewController viewDidAppear:]</div><div class="line">+[MyViewController sharedInstance]</div></pre></td></tr></table></figure>
</li>
<li><p><strong>Module</strong>ï¼šæ¨¡ç»„çš„æ„æ€ï¼Œç”¨æ¥é™åˆ¶æ»¡è¶³ç¬¦å·çš„æ–¹æ³•ï¼Œç¼–è¯‘å™¨å°†åªä¼šåœ¨æ–­ç‚¹æ»¡è¶³è¿™ä¸ªæ¨¡ç»„çš„ç¬¦å·çš„æ—¶å€™æ‰å›æš‚åœã€‚</p>
</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªå­ç±»æ²¡æœ‰é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè®¾ç½®å­ç±»è¿™ä¸ªæ–¹æ³•çš„ç¬¦å·æ–­ç‚¹æ˜¯ä¸ä¼šè¢«è§¦å‘çš„ã€‚</p>
<h3 id="watchpoint"><a href="#watchpoint" class="headerlink" title="watchpoint"></a>watchpoint</h3><p>æœ‰æ—¶å€™ï¼Œç”±äºä¸æ¶‰åŠåˆ°æ–¹æ³•ï¼Œæ— æ³•ä½¿ç”¨æ–­ç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬ä»è¦ç›‘è§†æŸä¸€ä¸ªå€¼æ˜¯å¦å˜åŒ–ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨<code>watchpoin</code>tæ¥ç›‘è§†ä¸€ä¸ªæŒ‡é’ˆçš„æŒ‡å‘ã€‚</p>
<p>å½“æŒ‡é’ˆæŒ‡å‘å˜åŒ–æ—¶ï¼Œ<code>watchpoint</code>ä¼šè§¦å‘:<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_11.png?raw=true" alt="watchpoint"></p>
<h4 id="set"><a href="#set" class="headerlink" title="set"></a>set</h4><p>æ·»åŠ watchpointçš„æ–¹å¼å¦‚ä¸Šå›¾æ‰€ç¤º<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(lldb) watchpoint set variable xxx</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹ï¼Œwatchpointè¦ç›‘å¬çš„å¯¹è±¡å¿…é¡»æ˜¯<strong>å½“å‰ç±»çš„å¯¹è±¡</strong>ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_12.png?raw=true" alt="watchpoint2"><br>ç”±äº<code>self.view</code>æ˜¯ä»<code>UIViewController</code>ä¸­ç»§æ‰¿è¿‡æ¥çš„ï¼Œå› æ­¤æ— æ³•ç›‘å¬ã€‚</p>
<p>å¦å¤–ï¼Œä¸Šé¢çš„<code>addr = 0x1556747f0</code><strong>ä¸æ˜¯æŒ‡<code>_myView</code>åœ¨æ ˆä¸­çš„ç´¢å¼•</strong>ï¼Œè€Œæ˜¯æŒ‡è¿™ä¸ªWatchpointåœ¨å †ä¸­çš„åœ°å€ã€‚</p>
<p>Watchpointçš„<strong>åŸç†</strong>åº”è¯¥æ˜¯åœ¨è¿™ä¸ªåœ°å€ä¸­å†™å…¥äº†åŸæ¥<code>_myView</code>æŒ‡å‘çš„åœ°å€ï¼Œç„¶åå¯¹æ–°<code>_myView</code>æŒ‡å‘çš„åœ°å€å’ŒWatchpointæŒ‡å‘çš„åœ°å€æ˜¯å¦ç›¸åŒæ¥åšå‡ºåˆ¤æ–­çš„ã€‚</p>
<h4 id="disable-delete-enable"><a href="#disable-delete-enable" class="headerlink" title="disable/delete/enable"></a>disable/delete/enable</h4><p>watchpointèµ„æºä¹Ÿæ˜¯æ¯”è¾ƒæœ‰é™çš„ï¼Œå¯¹äºä¸éœ€è¦ç›‘å¬çš„å¯¹è±¡è¦åŠæ—¶é‡Šæ”¾ã€‚æ¯ä¸ªwatchpointéƒ½æœ‰ä¸€ä¸ªåºå·ï¼Œæ“ä½œå¯¹åº”çš„éœ€è¦å³å¯ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/lldb_13.png?raw=true" alt="watchpoint3"></p>
<h2 id="å…¶ä»–æŠ€å·§"><a href="#å…¶ä»–æŠ€å·§" class="headerlink" title="å…¶ä»–æŠ€å·§"></a>å…¶ä»–æŠ€å·§</h2><h3 id="run"><a href="#run" class="headerlink" title="run"></a>run</h3><p>è¿™æ˜¯æˆ‘æ¯”è¾ƒå–œæ¬¢çš„æ–¹æ³•ï¼Œæ‰€ä»¥å•ç‹¬åˆ—å‡ºæ¥ã€‚</p>
<p>è°ƒè¯•çš„æ—¶å€™ç»å¸¸éœ€è¦é‡æ–°å¯åŠ¨ç¨‹åºã€‚ä½†æ˜¯å¦‚æœé‡æ–°Runç¨‹åºï¼Œéœ€è¦é‡æ–°ç¼–è¯‘ï¼Œéå¸¸æµªè´¹æ—¶é—´ã€‚å¯ä»¥åœ¨ lldb ä¸­è¾“å…¥<code>run</code>å°±èƒ½ç›´æ¥è®©ç¨‹åºé‡æ–°åŠ è½½äº†ã€‚</p>
<h3 id="é€šè¿‡åœ°å€æ“ä½œ"><a href="#é€šè¿‡åœ°å€æ“ä½œ" class="headerlink" title="é€šè¿‡åœ°å€æ“ä½œ"></a>é€šè¿‡åœ°å€æ“ä½œ</h3><p>æ¯”å¦‚expression,printéƒ½å¯ä»¥é€šè¿‡åœ°å€æ¥è®¿é—®å¯¹è±¡ï¼Œä½†æ˜¯å®éªŒä¸‹æ¥ï¼Œæ„Ÿè§‰æ²¡æœ‰å¤ªå¤§ç”¨å¤„ã€‚</p>
<p>æœ¬æ¥æƒ³è¦ç›‘æ§<code>self.view.backgroundColor</code>çš„æ”¹å˜æƒ…å†µï¼Œä½†æ˜¯ä¸èƒ½é€šè¿‡å˜é‡åï¼Œå°±å°è¯•èƒ½å¦é€šè¿‡åœ°å€ï¼Œç»“æœå‘ç°ä¹Ÿä¸è¡Œã€‚</p>
<p>å› æ­¤ï¼Œå¯ä»¥å¤§ä½“ä¸Šè®¤ä¸ºï¼Œèƒ½é€šè¿‡åœ°å€è®¿é—®çš„ï¼Œé‚£ä¹Ÿèƒ½é€šè¿‡å˜é‡åè®¿é—®ï¼Œå¹¶ä¸”é€šè¿‡å˜é‡åè®¿é—®æ›´æ¸…æ™°è¿…é€Ÿï¼Œé€šè¿‡åœ°å€è®¿é—®æ²¡æœ‰ä¼˜åŠ¿ï¼Œæ•…ä¸æ¨èä½¿ç”¨ã€‚</p>
<h3 id="ä»£æ›¿NSLog"><a href="#ä»£æ›¿NSLog" class="headerlink" title="ä»£æ›¿NSLog"></a>ä»£æ›¿NSLog</h3><p>çœ‹<code>NSLog</code>çš„æ–‡æ¡£ï¼Œç¬¬ä¸€å¥è¯å°±è¯´ï¼š<code>Logs an error message to the Apple System Log facility.</code>ï¼Œæ‰€ä»¥é¦–å…ˆï¼Œ<code>NSLog</code>å°±ä¸æ˜¯è®¾è®¡ä½œä¸ºæ™®é€šçš„<code>debug log</code>çš„ï¼Œè€Œæ˜¯<code>error log</code>ï¼›æ¯æ¬¡<code>NSLog</code>éƒ½ä¼šè¿›è¡Œå¾ˆå¤šè€—æ—¶å·¥ä½œï¼Œå› æ­¤ï¼Œéé‡è¦å‚æ•°å°½é‡ä¸è¦ç”¨ï¼Œä½¿ç”¨è°ƒè¯•ä»£æ›¿ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[UIScrollViewè¯¦ç»†ä»‹ç»]]></title>
      <url>http://zhang759740844.github.io/2016/09/18/Scrollview%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p>æœ¬æ¬¡å°†å‚è€ƒ<a href="https://my.oschina.net/zhxx/blog/620969#OSC_h3_11" target="_blank" rel="external">iOS æ€§èƒ½ä¼˜åŒ–ä¹‹ UIScrollView å®è·µç»éªŒ</a>å¯¹UIScrollViewçš„ä½¿ç”¨æ–¹å¼è¿›è¡Œè¯¦ç»†ä»‹ç»<br><a id="more"></a></p>
<h2 id="ScrollViewå’ŒAuto-Layout"><a href="#ScrollViewå’ŒAuto-Layout" class="headerlink" title="ScrollViewå’ŒAuto Layout"></a>ScrollViewå’ŒAuto Layout</h2><p><code>UIScrollView</code> åœ¨ <code>Auto Layout</code> æ˜¯ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„ <code>view</code>ï¼Œå¯¹äº <code>UIScrollView</code> çš„ <code>subview</code> æ¥è¯´ï¼Œå®ƒçš„ <code>leading/trailing/top/bottom space</code> æ˜¯<strong>ç›¸å¯¹äº <code>UIScrollView</code>çš„ <code>contentSize</code> è€Œä¸æ˜¯ <code>bounds</code> (è‡ªèº«åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„è¾¹ç•Œï¼Œä¸æ˜ç™½çš„å¯ä»¥æŸ¥ä¸€ä¸‹ bounds å’Œ frame çš„åŒºåˆ«)æ¥ç¡®å®šçš„ã€‚</strong></p>
<p>æ‰€ä»¥ï¼Œä¸€èˆ¬çš„åšæ³•æ˜¯åœ¨<code>UIScrollVIew</code>å’Œå®ƒçš„<code>subViews</code>ä¹‹é—´å¢åŠ ä¸€ä¸ª<code>content view</code>ã€‚è¿™æ ·å¯ä»¥æ–¹ä¾¿åœ°ç»™ <code>subview</code> æä¾› <code>leading/trailing/top/bottom</code>ï¼Œæ–¹ä¾¿ <code>subview</code> çš„å¸ƒå±€ï¼Œå¹¶ä¸”å¯ä»¥ é€šè¿‡è°ƒæ•´<code>content view</code> çš„ <code>size</code>ï¼ˆè°ƒæ•´<code>constraint</code> çš„ <code>IBOutlet</code>ï¼‰æ¥è°ƒæ•´ <code>contentSize</code>ã€‚</p>
<h3 id="æ·»åŠ ContentViewçš„æ³¨æ„ç‚¹"><a href="#æ·»åŠ ContentViewçš„æ³¨æ„ç‚¹" class="headerlink" title="æ·»åŠ ContentViewçš„æ³¨æ„ç‚¹"></a>æ·»åŠ ContentViewçš„æ³¨æ„ç‚¹</h3><p><code>scrollview</code>ä¸­æ·»åŠ çš„<code>contentview</code>å’Œæ·»åŠ ä¸€èˆ¬çš„è§†å›¾ä¸åŒï¼Œä¸€èˆ¬çš„è§†å›¾åªè¦æä¾›<code>leading/trailing/top/bottom space</code>å°±èƒ½å”¯ä¸€ç¡®å®šé•¿å®½ï¼Œä½ç½®ã€‚<br>è€Œ<code>ScrollView</code>çš„<code>contentView</code>é™¤äº†ä¸Šè¿°å››ä¸ªçº¦æŸï¼Œè¿˜éœ€è¦è®¾ç½®é•¿å®½ï¼Œä½œä¸ºæ»šåŠ¨çš„èŒƒå›´çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>æ‰€ä»¥æ•´ä¸ª<code>scrollview</code>çš„<code>contentSize</code>çš„ç­‰å¼åº”è¯¥æ˜¯ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scrollView.contentSize.width = (scrollviewä¸contentviewä¹‹é—´leadingçš„constant)+ï¼ˆcontentViewçš„widthï¼‰+ï¼ˆscrollviewä¸contentviewä¹‹é—´trailingçš„constantï¼‰</div></pre></td></tr></table></figure></p>
<p><strong>å¦å¤–ä¸€ç‚¹éœ€è¦å¼ºè°ƒä¸¤ç‚¹ï¼š</strong></p>
<ol>
<li><code>ScrollView</code>çš„<code>bounds</code>æ—©å°±ç¡®å®šäº†ä¸‹æ¥ï¼Œåœ¨è®¾ç½®<code>contentview</code>çš„å®½åº¦çš„æ—¶å€™ï¼Œå¦‚æœè®¾ç½®<code>contentview.width = superview.width + constant</code>è¿™é‡Œçš„<code>superview.width</code>æ˜¯æŒ‡<code>ScrollView.bounds</code>è€Œä¸æ˜¯<code>contentSize</code></li>
<li>åœ¨è®¾ç½®<code>contentview</code>çš„ä¸Šä¸‹å·¦å³çº¦æŸçš„æ—¶å€™ï¼Œå¦‚æœè®¾ç½®<code>contentview.trailing = superview.trailing + constant</code>,è¿™é‡Œçš„<code>superview.trailing</code>æŒ‡çš„æ˜¯<code>contentSize.trailing</code>è€Œä¸æ˜¯<code>bounds</code>ã€‚æ­¤æ—¶å°±å¯ä»¥é€šè¿‡ä¸Šé¢çš„å…¬å¼è®¡ç®—<code>contentSize</code>çš„å®½åº¦äº†ã€‚</li>
</ol>
<blockquote>
<p>Demoå‚è§AutoLayout</p>
</blockquote>
<h2 id="UIScrollViewéƒ¨åˆ†å±æ€§"><a href="#UIScrollViewéƒ¨åˆ†å±æ€§" class="headerlink" title="UIScrollViewéƒ¨åˆ†å±æ€§"></a>UIScrollViewéƒ¨åˆ†å±æ€§</h2><h3 id="contentSizeã€contentInsetå’ŒcontentOffset"><a href="#contentSizeã€contentInsetå’ŒcontentOffset" class="headerlink" title="contentSizeã€contentInsetå’ŒcontentOffset"></a><strong>contentSize</strong>ã€<strong>contentInset</strong>å’Œ<strong>contentOffset</strong></h3><ul>
<li>contentSize: å°±æ˜¯scrollviewå¯ä»¥æ»šåŠ¨çš„åŒºåŸŸ.<br>æ¯”å¦‚frame = (0 ,0 ,320 ,480) contentSize = (320 ,960)ï¼Œä»£è¡¨ä½ çš„scrollviewå¯ä»¥ä¸Šä¸‹æ»šåŠ¨ï¼Œæ»šåŠ¨åŒºåŸŸä¸ºframeå¤§å°çš„ä¸¤å€ã€‚</li>
<li>contentOffset:å°±æ˜¯scrollviewå½“å‰æ˜¾ç¤ºåŒºåŸŸé¡¶ç‚¹ç›¸å¯¹äºframeé¡¶ç‚¹çš„åç§»é‡ã€‚<br>æ¯”å¦‚ä¸Šä¸ªä¾‹å­ä½ æ‹‰åˆ°æœ€ä¸‹é¢ï¼Œcontentoffsetå°±æ˜¯(0 ,480)ï¼Œä¹Ÿå°±æ˜¯yåç§»äº†480 </li>
<li>contentInset:å°±æ˜¯scrollviewçš„contentviewçš„é¡¶ç‚¹ç›¸å¯¹äºscrollviewçš„ä½ç½®ã€‚<br>ä¾‹å¦‚ä½ çš„contentInset = (0 ,100)ï¼Œé‚£ä¹ˆä½ çš„contentviewå°±æ˜¯ä»scrollviewçš„(0 ,100)å¼€å§‹æ˜¾ç¤º </li>
</ul>
<p>/<em> ä¸Šæ‹‰åˆ·æ–°ä¸€èˆ¬å®ç°ä»£ç å¦‚ä¸‹ </em>/<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)scrollViewDidEndDragging:(<span class="built_in">UIScrollView</span> *)scrollView willDecelerate:(<span class="built_in">BOOL</span>)decelerate&#123;     </div><div class="line">    [_refreshHeaderView egoRefreshScrollViewDidEndDragging:scrollView];  </div><div class="line">    <span class="keyword">float</span> offset=scrollView.contentOffset.y;  </div><div class="line">    <span class="keyword">float</span> contentHeight=scrollView.contentSize.height;  </div><div class="line">    <span class="keyword">float</span> sub=contentHeight-offset;  </div><div class="line">    <span class="keyword">if</span> ((scrollView.height-sub)&gt;<span class="number">20</span>) &#123;<span class="comment">//å¦‚æœä¸Šæ‹‰è·ç¦»è¶…è¿‡20pï¼Œåˆ™åŠ è½½æ›´å¤šæ•°æ®  </span></div><div class="line">        <span class="comment">//[self loadMoreData];//æ­¤å¤„åœ¨viewåº•éƒ¨åŠ è½½æ›´å¤šæ•°æ®  </span></div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="UIScrollViewDelegate"><a href="#UIScrollViewDelegate" class="headerlink" title="UIScrollViewDelegate"></a>UIScrollViewDelegate</h2><p><code>UIScrollViewDelegate</code> æ˜¯ <code>UIScrollView</code> çš„ <code>delegate protocol</code>ï¼Œ<code>UIScrollView</code> æœ‰æ„æ€çš„åŠŸèƒ½éƒ½æ˜¯é€šè¿‡å®ƒçš„ delegate æ–¹æ³•å®ç°çš„ã€‚</p>
<h3 id="void-scrollViewDidScroll-UIScrollView-scrollView"><a href="#void-scrollViewDidScroll-UIScrollView-scrollView" class="headerlink" title="- (void)scrollViewDidScroll:(UIScrollView *)scrollView"></a>- (void)scrollViewDidScroll:(UIScrollView *)scrollView</h3><p>è¿™ä¸ªæ–¹æ³•åœ¨ä»»ä½•æ–¹å¼è§¦å‘ <code>contentOffset</code> å˜åŒ–çš„æ—¶å€™éƒ½ä¼šè¢«è°ƒç”¨ï¼ˆåŒ…æ‹¬ç”¨æˆ·æ‹–åŠ¨ï¼Œå‡é€Ÿè¿‡ç¨‹ï¼Œç›´æ¥é€šè¿‡ä»£ç è®¾ç½®ç­‰ï¼‰ï¼Œå¯ä»¥ç”¨äºç›‘æ§ <code>contentOffset</code> çš„å˜åŒ–ï¼Œå¹¶æ ¹æ®å½“å‰çš„ <code>contentOffset</code> å¯¹å…¶ä»– view åšå‡ºéšåŠ¨è°ƒæ•´ã€‚</p>
<h3 id="void-scrollViewWillBeginDragging-UIScrollView-scrollView"><a href="#void-scrollViewWillBeginDragging-UIScrollView-scrollView" class="headerlink" title="- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView"></a>- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView</h3><p>ç”¨æˆ·å¼€å§‹æ‹–åŠ¨ scroll view çš„æ—¶å€™è¢«è°ƒç”¨ã€‚</p>
<h3 id="void-scrollViewWillEndDragging-UIScrollView-scrollView-withVelocity-CGPoint-velocity-targetContentOffset-inout-CGPoint-targetContentOffset"><a href="#void-scrollViewWillEndDragging-UIScrollView-scrollView-withVelocity-CGPoint-velocity-targetContentOffset-inout-CGPoint-targetContentOffset" class="headerlink" title="- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset"></a>- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset</h3><p>åœ¨ didEndDragging å‰è¢«è°ƒç”¨ï¼Œå½“ willEndDragging æ–¹æ³•ä¸­ <code>velocity</code> ä¸º <code>CGPointZero</code>ï¼ˆç»“æŸæ‹–åŠ¨æ—¶ä¸¤ä¸ªæ–¹å‘éƒ½æ²¡æœ‰é€Ÿåº¦ï¼‰æ—¶ï¼ŒdidEndDragging ä¸­çš„ <code>decelerate</code> ä¸º <code>NO</code>ï¼Œå³æ²¡æœ‰å‡é€Ÿè¿‡ç¨‹ï¼ŒwillBeginDecelerating å’Œ didEndDecelerating ä¹Ÿå°±ä¸ä¼šè¢«è°ƒç”¨ã€‚åä¹‹ï¼Œå½“ <code>velocity</code> ä¸ä¸º <code>CGPointZero</code> æ—¶ï¼Œscroll view ä¼šä»¥ <code>velocity</code> ä¸ºåˆé€Ÿåº¦ï¼Œå‡é€Ÿç›´åˆ° <code>targetContentOffset</code>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„ <code>targetContentOffset</code> æ˜¯ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥æ”¹å˜å‡é€Ÿè¿åŠ¨çš„ç›®çš„åœ°ï¼Œè¿™åœ¨ä¸€äº›æ•ˆæœçš„å®ç°æ—¶ååˆ†æœ‰ç”¨ã€‚</p>
<h3 id="void-scrollViewDidEndDragging-UIScrollView-scrollView-willDecelerate-BOOL-decelerate"><a href="#void-scrollViewDidEndDragging-UIScrollView-scrollView-willDecelerate-BOOL-decelerate" class="headerlink" title="- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate"></a>- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate</h3><p>åœ¨ç”¨æˆ·ç»“æŸæ‹–åŠ¨åè¢«è°ƒç”¨ï¼Œ<code>decelerate</code> ä¸º <code>YES</code> æ—¶ï¼Œç»“æŸæ‹–åŠ¨åä¼šæœ‰å‡é€Ÿè¿‡ç¨‹ã€‚æ³¨ï¼Œåœ¨ didEndDragging ä¹‹åï¼Œå¦‚æœæœ‰å‡é€Ÿè¿‡ç¨‹ï¼Œscroll view çš„ dragging å¹¶ä¸ä¼šç«‹å³ç½®ä¸º <code>NO</code>ï¼Œè€Œæ˜¯è¦ç­‰åˆ°å‡é€Ÿç»“æŸä¹‹åï¼Œæ‰€ä»¥<strong>è¿™ä¸ª dragging å±æ€§çš„å®é™…è¯­ä¹‰æ›´æ¥è¿‘ scrolling</strong>ã€‚</p>
<h3 id="void-scrollViewWillBeginDecelerating-UIScrollView-scrollView"><a href="#void-scrollViewWillBeginDecelerating-UIScrollView-scrollView" class="headerlink" title="- (void)scrollViewWillBeginDecelerating:(UIScrollView *)scrollView"></a>- (void)scrollViewWillBeginDecelerating:(UIScrollView *)scrollView</h3><p>å‡é€ŸåŠ¨ç”»å¼€å§‹å‰è¢«è°ƒç”¨ã€‚</p>
<h3 id="void-scrollViewDidEndDecelerating-UIScrollView-scrollView"><a href="#void-scrollViewDidEndDecelerating-UIScrollView-scrollView" class="headerlink" title="- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView"></a>- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView</h3><p>å‡é€ŸåŠ¨ç”»ç»“æŸæ—¶è¢«è°ƒç”¨ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼šå½“ä¸€æ¬¡å‡é€ŸåŠ¨ç”»å°šæœªç»“æŸçš„æ—¶å€™å†æ¬¡ drag scroll viewï¼ŒdidEndDecelerating ä¸ä¼šè¢«è°ƒç”¨ï¼Œ<strong>å¹¶ä¸”è¿™æ—¶ scroll view çš„ <code>dragging</code> å’Œ <code>decelerating</code> å±æ€§éƒ½æ˜¯ <code>YES</code></strong>(å› ä¸ºï¼Œæ­¤æ—¶ScrollViewè¿˜åœ¨æ»šåŠ¨ï¼Œå¹¶ä¸”è¿˜åœ¨å‡é€Ÿ)ã€‚æ–°çš„ dragging å¦‚æœæœ‰åŠ é€Ÿåº¦ï¼Œé‚£ä¹ˆ willBeginDecelerating ä¼šå†ä¸€æ¬¡è¢«è°ƒç”¨ï¼Œç„¶åæ‰æ˜¯ didEndDeceleratingï¼›å¦‚æœæ²¡æœ‰åŠ é€Ÿåº¦ï¼Œè™½ç„¶ willBeginDecelerating ä¸ä¼šè¢«è°ƒç”¨ï¼Œä½†å‰ä¸€æ¬¡ç•™ä¸‹çš„ didEndDecelerating ä¼šè¢«è°ƒç”¨ã€‚</p>
<blockquote>
<p>Demoå‚è§Delegate</p>
</blockquote>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><h3 id="Table-View-ä¸­å›¾ç‰‡åŠ è½½é€»è¾‘çš„ä¼˜åŒ–"><a href="#Table-View-ä¸­å›¾ç‰‡åŠ è½½é€»è¾‘çš„ä¼˜åŒ–" class="headerlink" title="Table View ä¸­å›¾ç‰‡åŠ è½½é€»è¾‘çš„ä¼˜åŒ–"></a>Table View ä¸­å›¾ç‰‡åŠ è½½é€»è¾‘çš„ä¼˜åŒ–</h3><p><strong>ä¼˜åŒ–ç›®çš„</strong>ï¼šæ»‘åŠ¨æ—¶ä¸åŠ è½½å›¾ç‰‡ï¼Œåœ¨æ»‘åŠ¨åœæ­¢æ—¶åŠ è½½å›¾ç‰‡</p>
<p><strong>ä¼˜åŒ–éš¾ç‚¹</strong>ï¼šå‰é¢æåˆ°ï¼Œåˆšå¼€å§‹æ‹–åŠ¨çš„æ—¶å€™ï¼Œ<code>dragging</code> ä¸º <code>YES</code>ï¼Œ<code>decelerating</code> ä¸º <code>NO</code>ï¼›<code>decelerate</code> è¿‡ç¨‹ä¸­ï¼Œ<code>dragging</code> å’Œ <code>decelerating</code> éƒ½ä¸º <code>YES</code>ï¼›decelerate æœªç»“æŸæ—¶å¼€å§‹ä¸‹ä¸€æ¬¡æ‹–åŠ¨ï¼Œ<code>dragging</code> å’Œ <code>decelerating</code> ä¾ç„¶éƒ½ä¸º <code>YES</code>ã€‚æ‰€ä»¥æ— æ³•ç®€å•é€šè¿‡ table view çš„ <code>dragging</code> å’Œ <code>decelerating</code> åˆ¤æ–­æ˜¯åœ¨ç”¨æˆ·æ‹–åŠ¨è¿˜æ˜¯å‡é€Ÿè¿‡ç¨‹ã€‚</p>
<p>æ‰€ä»¥ä¸èƒ½ä»…é€šè¿‡<code>decelerating</code>æ¥åˆ¤æ–­æ˜¯å¦åŠ è½½å›¾ç‰‡ï¼Œè¿˜éœ€è¦è‡ªå·±è®°å½•ç”¨æˆ·æ‹–åŠ¨çŠ¶æ€ï¼Œåœ¨æ‹–åŠ¨æ—¶ä¹Ÿè¦åŠ è½½å›¾ç‰‡ã€‚ï¼ˆæ¶‰åŠåˆ°éœ€è¦æ³¨æ„çš„ç‚¹å¾ˆå¤šï¼Œè¿˜æ˜¯ç›´æ¥çœ‹<a href="https://my.oschina.net/zhxx/blog/620969#OSC_h3_11" target="_blank" rel="external">åŸæ–‡</a>æ¯”è¾ƒå¥½ï¼‰</p>
<p><strong>ä¼˜åŒ–æ–¹æ³•</strong>ï¼š</p>
<ol>
<li>æ¯æ¬¡å¼€å§‹æ‹–åŠ¨æ—¶scrollViewWillBeginDraggingï¼Œé€šè¿‡<code>NSArray *cells = [self.tableView visibleCells];</code>è·å–å±å¹•ä¸Šæ‰€æœ‰æ˜¾ç¤ºçš„<code>Cell</code>ï¼Œå…¨éƒ¨åŠ è½½ä¸€éå›¾ç‰‡ï¼ˆè§£å†³é—®é¢˜ä¸‰ï¼‰</li>
<li>åˆ©ç”¨<code>scrollViewWillEndDragging: withVelocity: targetContentOffset:</code>æ–¹æ³•ï¼Œå°†<code>targetContentOffset</code>å³æœ€åå‡é€Ÿç»“æŸååœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„ä½ç½®ï¼Œè½¬æ¢ä¸ºä¸€ä¸ª<code>CGRect</code>ï¼Œåœ¨<code>CGRect</code>èŒƒå›´é‡Œçš„<code>Cell</code>æ‰åœ¨<code>CellForRowAtIndex</code>ä¸­åŠ è½½ã€‚</li>
</ol>
<blockquote>
<p>Demoè¯¦è§LazyLoad</p>
</blockquote>
<h3 id="åˆ†é¡µçš„å‡ ç§å®ç°æ–¹æ³•"><a href="#åˆ†é¡µçš„å‡ ç§å®ç°æ–¹æ³•" class="headerlink" title="åˆ†é¡µçš„å‡ ç§å®ç°æ–¹æ³•"></a>åˆ†é¡µçš„å‡ ç§å®ç°æ–¹æ³•</h3><p>åˆ†é¡µç±»ä¼¼äº android ä¸­çš„ viewpager ï¼Œåˆ©ç”¨ UIScrollView æœ‰å¤šç§æ–¹æ³•å®ç°åˆ†é¡µï¼Œä½†æ˜¯å„è‡ªçš„æ•ˆæœå’Œç”¨é€”ä¸å°½ç›¸åŒã€‚</p>
<h4 id="pagingEnabled"><a href="#pagingEnabled" class="headerlink" title="pagingEnabled"></a>pagingEnabled</h4><p>ç³»ç»Ÿæä¾›çš„åˆ†é¡µæ–¹å¼ï¼Œå®ç°ç®€å•ï¼Œåªéœ€è¦<code>_scrollView.pagingEnabled = YES</code>å³å¯ï¼Œä½†æ˜¯æœ‰å±€é™æ€§ï¼š</p>
<ul>
<li>åªèƒ½ä»¥ ScrollView çš„ frame size ä¸ºå•ä½ç¿»é¡µï¼Œå‡é€ŸåŠ¨ç”»é˜»å°¼å¤§ï¼Œå‡é€Ÿè¿‡ç¨‹ä¸è¶…è¿‡ä¸€é¡µã€‚</li>
<li>éœ€è¦ä¸€äº› hacking å®ç° bleeding å’Œ paddingï¼ˆå³é¡µä¸é¡µä¹‹é—´æœ‰ paddingï¼Œåœ¨å½“å‰é¡µå¯ä»¥çœ‹åˆ°å‰åé¡µçš„éƒ¨åˆ†å†…å®¹ï¼‰</li>
</ul>
<p>Sample ä¸­ Pagination æœ‰ç®€å•å®ç° bleeding å’Œ padding æ•ˆæœçš„ä»£ç ï¼Œä¸»è¦çš„æ€è·¯æ˜¯ï¼š</p>
<ul>
<li>è®© scroll view çš„å®½åº¦ä¸º page å®½åº¦ + paddingï¼Œå¹¶ä¸”è®¾ç½® <code>clipsToBounds</code> ä¸º <code>NO</code>,è¿™æ ·å‰åä¸åœ¨ scrollView ä¸­çš„éƒ¨åˆ†å°±èƒ½æ˜¾ç¤ºä¸€éƒ¨åˆ†å‡ºæ¥ã€‚è§ä¸‹å›¾:</li>
<li>è¿™æ ·è™½ç„¶èƒ½çœ‹åˆ°å‰åé¡µçš„å†…å®¹ï¼Œä½†æ˜¯æ— æ³•å“åº” touchï¼Œæ‰€ä»¥éœ€è¦å¦ä¸€ä¸ªè¦†ç›–æœŸæœ›çš„å¯è§¦æ‘¸åŒºåŸŸçš„ view æ¥å®ç°ç±»ä¼¼ touch bridging çš„åŠŸèƒ½</li>
</ul>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/UIScrollView_pagingEnabled.png?raw=true" alt="UIScrollView_pagingEnabled"></p>
<p>é€‚ç”¨åœºæ™¯ï¼šä¸Šè¿°å±€é™æ€§åŒæ—¶ä¹Ÿæ˜¯è¿™ç§å®ç°æ–¹å¼çš„ä¼˜ç‚¹ï¼Œæ¯”å¦‚ä¸€èˆ¬ App çš„å¼•å¯¼é¡µï¼ˆæ•™ç¨‹ï¼‰ï¼ŒCalendar é‡Œçš„æœˆè§†å›¾ï¼Œéƒ½å¯ä»¥ç”¨è¿™ç§æ–¹æ³•å®ç°ã€‚</p>
<h4 id="Snap"><a href="#Snap" class="headerlink" title="Snap"></a>Snap</h4><p>æ ¸å¿ƒç®—æ³•æ˜¯åœ¨ <code>didEndDragging</code> æ–¹æ³•ä¸­ï¼Œé€šè¿‡å½“å‰ contentOffset è®¡ç®—æœ€è¿‘çš„æ•´æ•°é¡µåŠå…¶å¯¹åº”çš„ contentOffsetï¼Œé€šè¿‡åŠ¨ç”» snap åˆ°è¯¥é¡µã€‚è¿™ä¸ªæ–¹æ³•å®ç°çš„æ•ˆæœéƒ½æœ‰ä¸ªé€šç—…ï¼Œå°±æ˜¯æœ€åçš„ snap ä¼šåœ¨ decelerate ç»“æŸä»¥åæ‰å‘ç”Ÿï¼Œæ€»æ„Ÿè§‰å¾ˆçªå…€ã€‚ä½¿ç”¨ä½“éªŒä¸å¦‚ä¸‹é¢çš„æ–¹æ³•ã€‚</p>
<h4 id="ä¿®æ”¹targetContentOffset"><a href="#ä¿®æ”¹targetContentOffset" class="headerlink" title="ä¿®æ”¹targetContentOffset"></a>ä¿®æ”¹targetContentOffset</h4><p>é€šè¿‡ä¿®æ”¹ <code>scrollViewWillEndDragging: withVelocity: targetContentOffset:</code> æ–¹æ³•ä¸­çš„ <code>targetContentOffset</code> ç›´æ¥ä¿®æ”¹ç›®æ ‡ <code>offset</code> ä¸ºæ•´æ•°é¡µä½ç½®ã€‚å…¶ä¸­æ ¸å¿ƒä»£ç ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGPoint</span>)nearestTargetOffsetForOffset:(<span class="built_in">CGPoint</span>)offset</div><div class="line">&#123;    <span class="built_in">CGFloat</span> pageSize = BUBBLE_DIAMETER + BUBBLE_PADDING;    <span class="built_in">NSInteger</span> page = roundf(offset.x / pageSize);    <span class="built_in">CGFloat</span> targetX = pageSize * page;    <span class="keyword">return</span> <span class="built_in">CGPointMake</span>(targetX, offset.y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)scrollViewWillEndDragging:(<span class="built_in">UIScrollView</span> *)scrollView withVelocity:(<span class="built_in">CGPoint</span>)velocity targetContentOffset:(<span class="keyword">inout</span> <span class="built_in">CGPoint</span> *)targetContentOffset</div><div class="line">&#123;    <span class="built_in">CGPoint</span> targetOffset = [<span class="keyword">self</span> nearestTargetOffsetForOffset:*targetContentOffset];</div><div class="line">    targetContentOffset-&gt;x = targetOffset.x;</div><div class="line">    targetContentOffset-&gt;y = targetOffset.y;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>é€‚ç”¨åœºæ™¯ï¼šæ–¹æ³• 2 å’Œ æ–¹æ³• 3 çš„åŸç†è¿‘ä¼¼ï¼Œæ•ˆæœä¹Ÿç›¸è¿‘ï¼Œé€‚ç”¨åœºæ™¯ä¹ŸåŸºæœ¬ç›¸åŒï¼Œä½†æ–¹æ³• 3 çš„ä½“éªŒä¼šå¥½å¾ˆå¤šï¼Œsnap åˆ°æ•´æ•°é¡µçš„è¿‡ç¨‹å¾ˆè‡ªç„¶ï¼Œæˆ–è€…è¯´ç”¨æˆ·å®Œå…¨æ„ŸçŸ¥ä¸åˆ° snap è¿‡ç¨‹çš„å­˜åœ¨ã€‚è¿™ä¸¤ç§æ–¹æ³•çš„å‡é€Ÿè¿‡ç¨‹æµç•…ï¼Œé€‚ç”¨äºä¸€å±æœ‰å¤šé¡µï¼Œä½†éœ€è¦æŒ‰æ•´æ•°é¡µæ»‘åŠ¨çš„åœºæ™¯ï¼›ä¹Ÿé€‚ç”¨äºå¦‚å›¾è¡¨ä¸­è‡ªåŠ¨ snap åˆ°æ•´æ•°å¤©çš„åœºæ™¯ï¼›è¿˜é€‚ç”¨äºæ¯é¡µå¤§å°ä¸åŒçš„æƒ…å†µä¸‹ snap åˆ°æ•´æ•°é¡µçš„åœºæ™¯ï¼ˆä¸åšä¸¾ä¾‹ï¼Œè‡ªè¡Œå‘æŒ¥ï¼Œå…¶å®åªéœ€è¦ä¿®æ”¹è®¡ç®—ç›®æ ‡ offset çš„æ–¹æ³•ï¼‰ã€‚</p>
<blockquote>
<p>Demoè¯¦è§Pagination</p>
</blockquote>
<h4 id="UIPageControl"><a href="#UIPageControl" class="headerlink" title="UIPageControl"></a>UIPageControl</h4><p>é¦–å…ˆå£°æ˜è¿™ä¸ªå’Œ ScrollView å¦‚ä½•è®¾ç½®åˆ†é¡µæ²¡æœ‰å…³ç³»ã€‚è¿™ä¸ªç»„ä»¶æ˜¯ iOS åœ¨åˆ†é¡µä¸­ç»å¸¸ç”¨çš„è¡¨ç¤ºé¡µæ•°çš„å°ç™½ç‚¹ã€‚ç®€å•è®°å½•ä¸€ä¸‹æ€ä¹ˆä½¿ç”¨ã€‚</p>
<p>ä½¿ç”¨èµ·æ¥å…¶å®è›®ç®€å•çš„ï¼Œå°±å½“ä¸€ä¸ª View æ¥ä½¿ç”¨å°±è¡Œäº†ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">_pageControl = [[<span class="built_in">UIPageControl</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(SCREEN_WIDTH/<span class="number">2</span><span class="number">-75</span>, SCREEN_HEIGHT<span class="number">-30</span><span class="number">-20</span>, <span class="number">150</span>, <span class="number">20</span>)];</div><div class="line">_pageControl.numberOfPages = <span class="number">3</span>;</div><div class="line">_pageControl.currentPage = <span class="number">0</span>;</div><div class="line">_pageControl.pageIndicatorTintColor = [<span class="built_in">UIColor</span> colorWithHexString:<span class="string">@"E1E1E1"</span>];</div><div class="line">_pageControl.currentPageIndicatorTintColor = COLOR_MAINRED;</div><div class="line">[<span class="keyword">self</span>.view addSubview:_pageControl];</div></pre></td></tr></table></figure>
<p>å‡ ä¸ªå±æ€§ä¹Ÿæ¯”è¾ƒæ˜“æ‡‚ï¼ŒåŸºæœ¬ä¸Šå°±è®¾ç½®å¥½äº†ï¼Œå½“ç„¶è¿™é‡Œè¿˜æ²¡æœ‰è®¾ç½®å’Œ Scrollview çš„è”åŠ¨ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ç›‘å¬scrollViewæ»šåŠ¨äº‹ä»¶</span></div><div class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView &#123;</div><div class="line">    <span class="keyword">int</span> page = scrollView.contentOffset.x / SCREEN_WIDTH;</div><div class="line">    _pageControl.currentPage = page;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç›‘å¬ Scrollview çš„æ»šåŠ¨äº‹ä»¶å°±å¯ä»¥äº†ã€‚</p>
<h3 id="é‡ç”¨"><a href="#é‡ç”¨" class="headerlink" title="é‡ç”¨"></a>é‡ç”¨</h3><p>å¤§éƒ¨åˆ†çš„ iOS å¼€å‘åº”è¯¥éƒ½æ¸…æ¥š <code>UITableView</code> çš„ cell é‡ç”¨æœºåˆ¶ï¼Œè¿™ç§é‡ç”¨æœºåˆ¶å‡å°‘äº†å†…å­˜å¼€é”€ä¹Ÿæé«˜äº† performanceï¼Œ<code>UIScrollView</code> ä½œä¸º <code>UITableView</code> çš„çˆ¶ç±»ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸­ä¹Ÿå¾ˆé€‚åˆåº”ç”¨é‡ç”¨æœºåˆ¶ã€‚</p>
<p>å¯ä»¥å‚ç…§ <code>UITableView</code> çš„ cell é‡ç”¨æœºåˆ¶ï¼Œæ€»ç»“é‡ç”¨æœºåˆ¶å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç»´æŠ¤ä¸€ä¸ªé‡ç”¨é˜Ÿåˆ—</li>
<li>å½“å…ƒç´ ç¦»å¼€å¯è§èŒƒå›´æ—¶ï¼Œ<code>removeFromSuperview</code> å¹¶åŠ å…¥é‡ç”¨é˜Ÿåˆ—ï¼ˆenqueueï¼‰</li>
<li>å½“éœ€è¦åŠ å…¥æ–°çš„å…ƒç´ æ—¶ï¼Œå…ˆå°è¯•ä»é‡ç”¨é˜Ÿåˆ—è·å–å¯é‡ç”¨å…ƒç´ ï¼ˆdequeueï¼‰å¹¶ä¸”ä»é‡ç”¨é˜Ÿåˆ—ç§»é™¤</li>
<li>å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œæ–°å»ºå…ƒç´ </li>
<li>å°†æ–°å»ºå…ƒç´ çš„viewé€šè¿‡<code>addSubView</code>æ·»åŠ è‡³ <code>contentView</code>ä¸Š</li>
<li>è¿™äº›ä¸€èˆ¬éƒ½åœ¨ <code>scrollViewDidScroll:</code> æ–¹æ³•ä¸­å®Œæˆ</li>
</ul>
<p>Demoä¸­æ¼”ç¤ºäº†ä¸€ä¸ªåœ¨scrollViewä¸­æ·»åŠ å¤šä¸ªé‡ç”¨ViewControllerçš„åœºæ™¯ï¼Œå…·ä½“é‡ç”¨æ–¹æ³•å‚è§Demo</p>
<hr>
<p>è¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹Demoä¸­ç”¨åˆ°çš„<code>addChildViewController</code>ã€‚</p>
<p>è‹¹æœåœ¨iOS 5 æ·»åŠ äº†ä¸€ç³»åˆ—çš„æ–¹æ³•ï¼Œå¸Œæœ›æˆ‘ä»¬åœ¨ä½¿ç”¨<code>addSubView</code>æ—¶ï¼ŒåŒæ—¶è°ƒç”¨<code>[self addChildViewController:child]</code>æ–¹æ³•å°†sub viewå¯¹åº”çš„viewControllerä¹ŸåŠ åˆ°å½“å‰ViewControllerçš„ç®¡ç†ä¸­ã€‚</p>
<p>å¯¹äºé‚£äº›å½“å‰æš‚æ—¶ä¸éœ€è¦æ˜¾ç¤ºçš„subviewï¼Œåªé€šè¿‡<code>addChildViewController</code>æŠŠsubViewControlleråŠ è¿›å»ï¼›éœ€è¦æ˜¾ç¤ºæ—¶å†è°ƒç”¨<code>transitionFromViewController</code>æ–¹æ³•ã€‚å°†å…¶æ·»åŠ è¿›å…¥åº•å±‚çš„ViewControllerä¸­ã€‚</p>
<p>è¿™æ ·åšçš„å¥½å¤„ï¼š</p>
<ol>
<li>å¯¹é¡µé¢ä¸­çš„é€»è¾‘æ›´åŠ åˆ†æ˜äº†ã€‚ç›¸åº”çš„Viewå¯¹åº”ç›¸åº”çš„ViewControllerã€‚</li>
<li>å½“æŸä¸ªå­Viewæ²¡æœ‰æ˜¾ç¤ºæ—¶ï¼Œå°†ä¸ä¼šè¢«Loadï¼Œå‡å°‘äº†å†…å­˜çš„ä½¿ç”¨ã€‚</li>
<li>å½“å†…å­˜ç´§å¼ æ—¶ï¼Œæ²¡æœ‰Loadçš„Viewå°†è¢«é¦–å…ˆé‡Šæ”¾ï¼Œä¼˜åŒ–äº†ç¨‹åºçš„å†…å­˜é‡Šæ”¾æœºåˆ¶ã€‚</li>
<li>å¯ä»¥è°ƒç”¨<code>transitionFromViewController</code>ç­‰ç³»ç»Ÿæ–¹æ³•ï¼Œioså¯¹äºæ˜¾ç¤ºä»¥åŠåŠ¨ç”»åšäº†æ¯”è¾ƒå¥½çš„å°è£…</li>
<li>ç›¸å½“äºå¯¹äº ViewController å®ä¾‹çš„ä¿å­˜ã€‚å®ä¾‹éƒ½ä¿å­˜åœ¨<code>self.childViewControllers</code>ä¸­ï¼Œéœ€è¦ä½¿ç”¨çš„æ—¶å€™ä»ä¸­å–å‡ºå³å¯ã€‚</li>
</ol>
<p>å½“ç„¶ï¼Œåƒæœ¬ä¾‹ä¸­åœ¨ ScrollView ä¸­æ·»åŠ  ViewController ï¼Œåªéœ€è¦å¯¹ ViewController è¿›è¡Œå¤ç”¨ï¼Œä½†æ˜¯ç”¨ä¸åˆ°å…¶æä¾›çš„ç³»ç»Ÿæ–¹æ³•æ—¶ï¼Œå…¶å®åªè¦ä½¿ç”¨ä¸€ä¸ªæ•°ç»„å°†å„ä¸ª ViewController ä¿å­˜èµ·æ¥å°±å¯ä»¥äº†ã€‚</p>
<p>å…¶å®è¿™äº›éƒ½ä¸é‡è¦ï¼Œå¦‚æœä¸éœ€è¦å¯¹ ViewController åšå¤ç”¨æˆ–è€…ä¸€äº›å…¶ä»–æ“ä½œï¼Œæˆ‘ä»¬è¿ViewControllerçš„å®ä¾‹éƒ½ä¸å¿…ä¿å­˜ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨éœ€è¦æ˜¾ç¤ºçš„æ—¶å€™<code>[self.contentView addSubview:vc.view];</code>,ä¸éœ€è¦æ˜¾ç¤ºçš„æ—¶å€™<code>[vc.view removeFromSuperview];</code>ï¼Œå°±å¯ä»¥è¾¾åˆ°æ˜¾ç¤ºå’Œç›¸åº”äº‹ä»¶çš„éœ€æ±‚äº†ã€‚</p>
<hr>
<blockquote>
<p>Demoè¯¦è§Reuse</p>
</blockquote>
<h3 id="è”åŠ¨"><a href="#è”åŠ¨" class="headerlink" title="è”åŠ¨"></a>è”åŠ¨</h3><p>æ‰€è°“è”åŠ¨ï¼Œå°±æ˜¯å½“ A æ»šåŠ¨çš„æ—¶å€™ï¼Œåœ¨ <strong><code>scrollViewDidScroll:</code></strong> é‡Œæ ¹æ® A çš„ <code>contentOffset</code> åŠ¨æ€è®¡ç®— B çš„ <code>contentOffset</code> å¹¶è®¾ç»™ Bã€‚åŒæ ·å¯¹äºé scroll view çš„ Cï¼Œä¹Ÿå¯ä»¥åŠ¨æ€è®¡ç®— C çš„ frame æˆ–æ˜¯ transformå®ç°è§†å·®æ»šåŠ¨æˆ–è€…å…¶ä»–é«˜çº§åŠ¨ç”»ï¼Œè¿™åœ¨ç°åœ¨è®¸å¤šåº”ç”¨çš„å¼•å¯¼é¡µé¢é‡Œä¼šè¢«ç”¨åˆ°ã€‚</p>
<p>Demoä¸­çš„æ ¸å¿ƒä»£ç :<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView&#123;</div><div class="line">    <span class="keyword">if</span> (scrollView == <span class="keyword">self</span>.titleScrollView) &#123;</div><div class="line">        <span class="built_in">CGFloat</span> contentX = <span class="keyword">self</span>.titleScrollView.contentOffset.x / <span class="keyword">self</span>.titleScrollView.frame.size.width * <span class="keyword">self</span>.contentScrollView.frame.size.width;</div><div class="line">        <span class="keyword">self</span>.contentScrollView.contentOffset = <span class="built_in">CGPointMake</span>(contentX, <span class="number">0.0</span>);</div><div class="line">        <span class="built_in">CGFloat</span> transX = <span class="keyword">self</span>.titleScrollView.contentOffset.x / (<span class="keyword">self</span>.titleScrollView.contentSize.width - <span class="keyword">self</span>.titleScrollView.frame.size.width) * (<span class="keyword">self</span>.backgroundImage.frame.size.width - <span class="keyword">self</span>.view.frame.size.width);</div><div class="line">        transX = MAX(<span class="number">0.0</span>, transX);</div><div class="line">        transX = MIN(<span class="keyword">self</span>.backgroundImage.frame.size.width - <span class="keyword">self</span>.view.frame.size.width, transX);</div><div class="line">        <span class="keyword">self</span>.backgroundImage.transform = <span class="built_in">CGAffineTransformMakeTranslation</span>(-transX, <span class="number">0.0</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡<code>titleScrollView</code>è®¡ç®—<code>contentX</code>å’Œ<code>transX</code>æ¥åˆ†åˆ«æ§åˆ¶<code>contentScrollView</code>ä»¥åŠ<code>backgroundImage</code>è¿™ä¸¤ä¸ªViewçš„ä½ç½®å˜åŒ–ã€‚</p>
<blockquote>
<p>Demoå‚è§Parallax</p>
</blockquote>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ScrollViewçœ‹ä¼¼ç®€å•ï¼Œå…¶å®è¿˜æ˜¯æœ‰éå¸¸å¤šçš„åœ°æ–¹å€¼å¾—å»æŒ–æ˜çš„ã€‚ä½¿ç”¨å¥½ï¼Œèƒ½å¤Ÿå®ç°å¾ˆå¤šéå¸¸é…·ç‚«çš„æ•ˆæœã€‚ä¸Šé¢çš„åŸç†å’Œåº”ç”¨æ¶‰åŠåˆ°çš„ç‚¹å¾ˆå¤šï¼Œè¿˜éœ€è¦ç»†ç»†ç¢ç£¨ï¼Œå­¦ä»¥è‡´ç”¨.</p>
<blockquote>
<p>ä¸Šè¿°æ‰€æœ‰Demoå‡åœ¨UIScrollViewDemoæ–‡ä»¶å¤¹ä¸­</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[NSNotificationçš„ä½¿ç”¨]]></title>
      <url>http://zhang759740844.github.io/2016/09/13/NSNotification%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>æœ¬ç¯‡æ˜¯å¯¹iosçš„é€šçŸ¥ä½¿ç”¨æ–¹æ³•çš„ä¸€ä¸ªç®€å•ç½—åˆ—ã€‚</p>
<a id="more"></a>
<h2 id="NSNotificationCenter"><a href="#NSNotificationCenter" class="headerlink" title="NSNotificationCenter"></a>NSNotificationCenter</h2><p><code>NSNotificationCenter</code>å°±æ˜¯ä¸€ä¸ªæ¶ˆæ¯é€šçŸ¥æœºåˆ¶ï¼Œç±»ä¼¼å¹¿æ’­ã€‚è§‚å¯Ÿè€…åªéœ€è¦å‘æ¶ˆæ¯ä¸­å¿ƒæ³¨å†Œæ„Ÿå…´è¶£çš„ä¸œè¥¿ï¼Œå½“æœ‰åœ°æ–¹å‘å‡ºè¿™ä¸ªæ¶ˆæ¯çš„æ—¶å€™ï¼Œé€šçŸ¥ä¸­å¿ƒä¼šå‘é€ç»™æ³¨å†Œè¿™ä¸ªæ¶ˆæ¯çš„å¯¹è±¡ã€‚è¿™æ ·ä¹Ÿèµ·åˆ°äº†å¤šä¸ªå¯¹è±¡ä¹‹é—´è§£è€¦çš„ä½œç”¨ã€‚è‹¹æœç»™æˆ‘ä»¬å°è£…äº†è¿™ä¸ª<code>NSNotificationCenter</code>ï¼Œè®©æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œé€šçŸ¥çš„æ³¨å†Œå’Œç§»é™¤ã€‚</p>
<h2 id="æ³¨å†Œ"><a href="#æ³¨å†Œ" class="headerlink" title="æ³¨å†Œ"></a>æ³¨å†Œ</h2><h3 id="addObserver-selector-name-object"><a href="#addObserver-selector-name-object" class="headerlink" title="addObserver:selector:name:object:"></a>addObserver:selector:name:object:</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(test) name:<span class="string">@"test"</span> object:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<p>å‚æ•°ï¼š</p>
<ul>
<li><code>addObserver</code>:è²Œä¼¼éƒ½æ˜¯<code>controller</code>å› ä¸ºè¿˜éœ€è¦<code>selector</code>æ¥æ‰§è¡Œ</li>
<li><code>name</code>:é€šçŸ¥åã€‚å½“å‘é€è¯¥é€šçŸ¥åçš„é€šçŸ¥æ˜¯ï¼Œè§‚å¯Ÿè€…æ”¶åˆ°æ¶ˆæ¯ã€‚</li>
<li><code>object</code>:ç¼©å°æ¥å—é€šçŸ¥çš„èŒƒå›´ï¼Œåªæ¥å—ç›¸å¯¹åº”çš„<code>object</code>å¯¹è±¡å‘æ¥çš„é€šçŸ¥ã€‚<code>nil</code>åˆ™å…¨éƒ¨æ¥æ”¶ã€‚</li>
</ul>
<h3 id="addObserverForName-object-queue-usingBlock"><a href="#addObserverForName-object-queue-usingBlock" class="headerlink" title="addObserverForName:object:queue:usingBlock:"></a>addObserverForName:object:queue:usingBlock:</h3><p><code>NSNotificationCenter</code>æ¶ˆæ¯çš„æ¥å—çº¿ç¨‹æ˜¯åŸºäºå‘é€æ¶ˆæ¯çš„çº¿ç¨‹çš„,ä¹Ÿå°±æ˜¯<strong>åŒæ­¥</strong>çš„ï¼Œå› æ­¤ï¼Œæœ‰æ—¶å€™ï¼Œä½ å‘é€çš„æ¶ˆæ¯å¯èƒ½ä¸åœ¨ä¸»çº¿ç¨‹ï¼Œè€Œå¤§å®¶éƒ½çŸ¥é“æ“ä½œUIå¿…é¡»åœ¨ä¸»çº¿ç¨‹ï¼Œä¸ç„¶ä¼šå‡ºç°ä¸å“åº”çš„æƒ…å†µã€‚æ‰€ä»¥ï¼Œåœ¨ä½ æ”¶åˆ°æ¶ˆæ¯é€šçŸ¥çš„æ—¶å€™ï¼Œæ³¨æ„é€‰æ‹©ä½ è¦æ‰§è¡Œçš„çº¿ç¨‹ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">id</span> observer = [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserverForName:notification object:<span class="literal">nil</span> queue:[<span class="built_in">NSOperationQueue</span> mainQueue] usingBlock:^()&#123;...&#125;];</div></pre></td></tr></table></figure></p>
<p>å‚æ•°ï¼š</p>
<ul>
<li><code>queue</code>:<code>block</code>æ‰§è¡Œæ‰€åœ¨çš„çº¿ç¨‹ã€‚å¦‚æœæ˜¯<code>nil</code>é‚£ä¹ˆå°±åœ¨å½“å‰çº¿ç¨‹(posting thread)</li>
<li><code>block</code>:è¯¥ç§æ–¹å¼ä¸ç”¨<code>selector</code>è€Œä½¿ç”¨<code>block</code>å›è°ƒã€‚</li>
</ul>
<h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><p>åªè¦å¾€<code>NSNotificationCenter</code>æ³¨å†Œäº†ï¼Œå°±å¿…é¡»æœ‰<code>remove</code>çš„å­˜åœ¨ã€‚</p>
<h3 id="removeObserver"><a href="#removeObserver" class="headerlink" title="removeObserver:"></a>removeObserver:</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)removeObserver:(<span class="keyword">id</span>)notificationObserver</div></pre></td></tr></table></figure>
<p>å¯¹åº”<code>addObserverForName</code>æ–¹å¼ï¼Œç›´æ¥æŠŠä¸Šé¢çš„<code>id observer</code>ä½œä¸ºå‚æ•°ä¼ å…¥å³å¯ã€‚<br>å¯¹åº”<code>addObserver</code>æ–¹å¼ï¼Œåˆ é™¤<code>controller</code>ä¸­å…¨éƒ¨é€šçŸ¥.</p>
<h3 id="removeObserver-name-object"><a href="#removeObserver-name-object" class="headerlink" title="removeObserver:name:object:"></a>removeObserver:name:object:</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span> name:NotificationCitySelect object:<span class="literal">nil</span>]</div></pre></td></tr></table></figure>
<p>åˆ é™¤æŒ‡å®š<code>name</code>çš„é€šçŸ¥ã€‚</p>
<h2 id="å‘é€"><a href="#å‘é€" class="headerlink" title="å‘é€"></a>å‘é€</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:NotificationCitySelectChanged object:@&#123;NotificationCitySelect_ObjectLocationChange:@(<span class="literal">YES</span>)&#125;]</div></pre></td></tr></table></figure>
<p>å‘é€æŒ‡å®š<code>objcet</code>çš„é€šçŸ¥ï¼Œåªæœ‰æ³¨å†Œæ—¶æ³¨å†Œäº†è¯¥å¯¹è±¡çš„é€šçŸ¥æ‰å¯ä»¥æ¥æ”¶ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[UILabelé«˜åº¦æ§åˆ¶]]></title>
      <url>http://zhang759740844.github.io/2016/09/12/UILabel%E7%9A%84%E9%AB%98%E5%BA%A6%E8%AE%A1%E7%AE%97/</url>
      <content type="html"><![CDATA[<p>åœ¨<a href="https://zhang759740844.github.io/2016/08/26/UITableviewè‡ªé€‚åº”é«˜åº¦/">tableviewè‡ªé€‚åº”é«˜åº¦</a>ä¸€ç¯‡ä¸­å­¦ä¹ äº†å¦‚ä½•ç”¨<code>systemLayoutSizeFittingSize:</code>æ–¹æ³•å¾—åˆ°UITableViewçš„Cellçš„é«˜åº¦ã€‚æœ¬æ–‡å°†æ¢ç©¶ä¸€èˆ¬æƒ…å†µä¸‹å¦‚ä½•å¾—åˆ°UILabelçš„é«˜åº¦ã€‚</p>
<a id="more"></a>
<h2 id="sizeThatFitsçš„ä½¿ç”¨"><a href="#sizeThatFitsçš„ä½¿ç”¨" class="headerlink" title="sizeThatFitsçš„ä½¿ç”¨"></a>sizeThatFitsçš„ä½¿ç”¨</h2><p><code>sizeThatFits</code>æ˜¯UIViewä¸­çš„æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGSize</span>)sizeThatFits:(<span class="built_in">CGSize</span>)size;</div></pre></td></tr></table></figure></p>
<p>å®˜æ–¹æ–‡æ¡£çš„æ³¨é‡Šï¼š</p>
<blockquote>
<p>return â€˜bestâ€™ size to fit given size. does not actually resize view. Default is return existing view size<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥æ–¹æ³•å°†ä¼šæ ¹æ®ä¼ å…¥çš„<code>size</code>,è®¡ç®—å¾—åˆ°æœ€ä½³çš„UIViewçš„å®½é«˜ï¼Œç›´æ¥è¿”å›ï¼Œä¸å¯¹Viewåšä»»ä½•ä¿®æ”¹ã€‚</p>
</blockquote>
<p>UILabelä¼šæ ¹æ®ä¼ å…¥çš„<code>size</code>çš„<code>width</code>è‡ªåŠ¨æ¢è¡Œï¼Œå¾—åˆ°<code>height</code>åï¼Œå°†è¿™ä¸¤ä¸ªå€¼ä½œä¸ºä¼°ç®—å‡ºçš„<code>CGSize</code>è¿”å›ã€‚<br>å¦‚æœä¼ å…¥çš„æ˜¯<code>CGSizeZero</code>ç›¸å½“äºä¸è®¾ç½®æ¢è¡Œå®½åº¦ï¼Œä¸€è¡Œåˆ°åº•ã€‚</p>
<p>ç”±äº<code>SizeThatFits</code>åªä¼°ç®—ï¼Œä¸ä¿®æ”¹ã€‚åœ¨å¾—åˆ°ä¼°ç®—å€¼åï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½®UILabelçš„<code>frame</code>æˆ–è€…<code>constraint</code>ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>) useSizeThatFitsZeroWithLabel:(<span class="built_in">UILabel</span> *)label&#123;</div><div class="line">    <span class="comment">//ä½¿ç”¨CGSizeZeroç›¸å½“äºä¸è®¾ç½®æ¢è¡Œå®½åº¦ï¼Œä¸€è¡Œåˆ°åº•</span></div><div class="line">    <span class="built_in">CGSize</span> size = [label sizeThatFits:<span class="built_in">CGSizeZero</span>];</div><div class="line">    label.frame = <span class="built_in">CGRectMake</span>(label.frame.origin.x, label.frame.origin.y, size.width, size.height);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>) useSizeThatFitsCustomWithLabel:(<span class="built_in">UILabel</span> *)label&#123;</div><div class="line">    <span class="comment">//ä½¿ç”¨è‡ªå®šä¹‰çš„CGSizeï¼Œä¼šæ ¹æ®sizeçš„å®½åº¦è¿›è¡Œæ¢è¡Œ</span></div><div class="line">    <span class="built_in">CGSize</span> size = [label sizeThatFits:<span class="built_in">CGSizeMake</span>(<span class="number">50</span>, <span class="number">50</span>)];</div><div class="line">    label.frame = <span class="built_in">CGRectMake</span>(label.frame.origin.x, label.frame.origin.y, size.width, size.height);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="SizeToFit"><a href="#SizeToFit" class="headerlink" title="SizeToFit"></a>SizeToFit</h2><p><code>SizeToFit</code>çš„æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)sizeToFit;</div></pre></td></tr></table></figure></p>
<p><code>SizeToFit</code>çš„æ–‡æ¡£æ³¨é‡Šï¼š</p>
<blockquote>
<p>calls sizeThatFits: with current view bounds and changes bounds size.<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¼šè°ƒç”¨<code>SizeThatFits</code>,å¹¶ä¸”ç›´æ¥è®¾ç½®Viewçš„<code>bounds</code>ã€‚</p>
</blockquote>
<p>æ—¢ç„¶è¦è°ƒç”¨<code>sizeThatFits</code>é‚£å°±éœ€è¦ä¼ å…¥ä¸€ä¸ª<code>CGSize</code>ã€‚è¿™ä¸ª<code>CGSize</code>å°±æ˜¯è®¾ç½®Viewçš„<code>frame</code>æ—¶ä¼ å…¥çš„<code>height</code>,<code>width</code>ã€‚</p>
<h2 id="frameä¸constraint"><a href="#frameä¸constraint" class="headerlink" title="frameä¸constraint"></a>frameä¸constraint</h2><p>åœ¨ä»£ç æ·»åŠ Viewæ—¶ï¼Œinitéƒ½ä¼šä½¿ç”¨<code>initWithFrame:</code>æ–¹æ³•ã€‚åœ¨AutoLayoutåï¼Œ<code>constraint</code>è¢«ä½¿ç”¨ï¼Œæ˜¯ä¸ºäº†é€‚é…ä¸åŒå±å¹•çš„æœºå™¨ã€‚</p>
<ul>
<li>è®¾ç½®å¥½Viewä¹‹é—´çš„<code>constraint</code>åï¼Œä¸€ä¸ªViewçš„çº¦æŸæ”¹å˜ï¼Œå°†ä¼šè”åŠ¨æ”¹å˜å…¶ä»–Viewçš„ä½ç½®ã€å¤§å°ã€‚</li>
<li>è®¾ç½®å¥½Viewçš„<code>frame</code>æˆ–è€…<code>bound</code>åï¼Œæ”¹å˜Viewçš„<code>frame</code>ï¼Œä¸ä¼šå¯¹å…¶å®ƒViewé€ æˆä»»ä½•å½±å“ã€‚</li>
<li>åœ¨è®¾ç½®å¥½<code>constraint</code>åï¼Œæ˜¾ç¤ºçš„Viewå°±ä»¥çº¦æŸä¸ºå‡†ã€‚ä¿®æ”¹<code>frame</code>ï¼ŒViewçš„æ˜¾ç¤ºæ²¡æœ‰ä»»ä½•æ”¹å˜ï¼Œè™½ç„¶<code>frame</code>ç¡®å®å˜äº†ã€‚</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"æ”¹å˜å‰%f,%f,%f,%f"</span>,_label.frame.size.height,_label.frame.size.width,_label.frame.origin.x,_label.frame.origin.y);</div><div class="line">_label.frame = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">200</span>, <span class="number">200</span>);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"æ”¹å˜å%f,%f,%f,%f"</span>,_label.frame.size.height,_label.frame.size.width,_label.frame.origin.x,_label.frame.origin.y);</div><div class="line"></div><div class="line"><span class="number">2016</span><span class="number">-09</span><span class="number">-12</span> <span class="number">15</span>:<span class="number">32</span>:<span class="number">44.458</span> Parallax[<span class="number">2126</span>:<span class="number">578089</span>] <span class="number">66.000000</span>,<span class="number">147.000000</span>,<span class="number">180.000000</span>,<span class="number">117.000000</span></div><div class="line"><span class="number">2016</span><span class="number">-09</span><span class="number">-12</span> <span class="number">15</span>:<span class="number">32</span>:<span class="number">44.459</span> Parallax[<span class="number">2126</span>:<span class="number">578089</span>] æ”¹å˜å<span class="number">200.000000</span>,<span class="number">200.000000</span>,<span class="number">0.000000</span>,<span class="number">0.000000</span></div></pre></td></tr></table></figure>
<h2 id="ä¸systemLayoutSizeFittingSizeçš„æ¯”è¾ƒ"><a href="#ä¸systemLayoutSizeFittingSizeçš„æ¯”è¾ƒ" class="headerlink" title="ä¸systemLayoutSizeFittingSizeçš„æ¯”è¾ƒ"></a>ä¸systemLayoutSizeFittingSizeçš„æ¯”è¾ƒ</h2><p><code>systemLayoutSizeFittingSize</code>æ–¹æ³•æ˜¯åœ¨æ•´ä¸ªviewçš„çº¦æŸå·²ç»ç¡®å®šï¼Œé€šè¿‡è®¡ç®—UILabelçš„é«˜åº¦(æˆ–è®¸å…¶ä¸­ä¹Ÿè°ƒç”¨äº†<code>sizeThatFits</code>å§)ï¼Œå¾—åˆ°æœ€é€‚åˆçš„supviewçš„é«˜åº¦ã€‚</p>
<p><code>sizetofit</code>å’Œ<code>sizethatfits</code>åˆ™æ˜¯åœ¨supviewçš„é«˜åº¦ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œè®¡ç®—å¾—åˆ°UILabelçš„é«˜åº¦ï¼Œç„¶åé€šè¿‡æ‰‹åŠ¨è®¾ç½®frameæˆ–è€…çº¦æŸæ¡ä»¶ï¼Œå°†å…¶æ·»åŠ åˆ°supviewä¸Šã€‚</p>
<blockquote>
<p>Demo è¯¦è§ UIScrollViewDemo/Parallax</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[JavaScriptåŸºæœ¬è¯­æ³•]]></title>
      <url>http://zhang759740844.github.io/2016/09/09/JavaScript%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>å‚è€ƒè‡ª<a href="http://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000" target="_blank" rel="external">å»–é›ªå³°çš„JavaScriptæ•™ç¨‹</a></p>
<a id="more"></a>
<h2 id="åŸºç¡€è¯­æ³•"><a href="#åŸºç¡€è¯­æ³•" class="headerlink" title="åŸºç¡€è¯­æ³•"></a>åŸºç¡€è¯­æ³•</h2><h3 id="æ•°æ®ç±»å‹å’Œå˜é‡"><a href="#æ•°æ®ç±»å‹å’Œå˜é‡" class="headerlink" title="æ•°æ®ç±»å‹å’Œå˜é‡"></a>æ•°æ®ç±»å‹å’Œå˜é‡</h3><h4 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h4><p>JSä¸åŒºåˆ†æ•´æ•°æµ®ç‚¹æ•°ï¼Œç»Ÿä¸€ç”¨<code>Number</code>è¡¨ç¤ºï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.2345e3</span>; <span class="comment">// ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤º1.2345x1000ï¼Œç­‰åŒäº1234.5</span></div><div class="line"><span class="literal">NaN</span>; <span class="comment">// NaNè¡¨ç¤ºNot a Numberï¼Œå½“æ— æ³•è®¡ç®—ç»“æœæ—¶ç”¨NaNè¡¨ç¤º</span></div><div class="line"><span class="literal">Infinity</span>; <span class="comment">// Infinityè¡¨ç¤ºæ— é™å¤§ï¼Œå½“æ•°å€¼è¶…è¿‡äº†JavaScriptçš„Numberæ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§å€¼æ—¶ï¼Œå°±è¡¨ç¤ºä¸ºInfinity</span></div></pre></td></tr></table></figure></p>
<p><code>Number</code>å¯ä»¥ç›´æ¥è¿ç®—ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(<span class="number">1</span> + <span class="number">2</span>) * <span class="number">5</span> / <span class="number">2</span>; <span class="comment">// 7.5</span></div><div class="line"><span class="number">2</span> / <span class="number">0</span>; <span class="comment">// Infinity</span></div><div class="line"><span class="number">0</span> / <span class="number">0</span>; <span class="comment">// NaN</span></div><div class="line"><span class="number">10</span> % <span class="number">3</span>; <span class="comment">// 1 (å–ä½™)</span></div><div class="line"><span class="number">10.5</span> % <span class="number">3</span>; <span class="comment">// 1.5</span></div></pre></td></tr></table></figure></p>
<h4 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h4><p>ä»¥å•å¼•å·<code>&#39;</code>æˆ–åŒå¼•å·<code>&quot;</code>æ‹¬èµ·æ¥çš„ä»»æ„æ–‡æœ¬.å¦‚<code>&#39;abc&#39;</code> </p>
<h4 id="å¸ƒå°”å€¼"><a href="#å¸ƒå°”å€¼" class="headerlink" title="å¸ƒå°”å€¼"></a>å¸ƒå°”å€¼</h4><p>ç”¨<code>true</code>å’Œ<code>false</code>è¡¨ç¤ºã€‚</p>
<h4 id="æ¯”è¾ƒè¿ç®—ç¬¦"><a href="#æ¯”è¾ƒè¿ç®—ç¬¦" class="headerlink" title="æ¯”è¾ƒè¿ç®—ç¬¦"></a>æ¯”è¾ƒè¿ç®—ç¬¦</h4><p>JavaScriptåœ¨è®¾è®¡æ—¶ï¼Œæœ‰ä¸¤ç§æ¯”è¾ƒè¿ç®—ç¬¦ï¼š<br>ç¬¬ä¸€ç§æ˜¯<code>==</code>æ¯”è¾ƒï¼Œå®ƒä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹å†æ¯”è¾ƒ.<br>ç¬¬äºŒç§æ˜¯<code>===</code>æ¯”è¾ƒï¼Œå®ƒä¸ä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹ï¼Œå¦‚æœæ•°æ®ç±»å‹ä¸ä¸€è‡´ï¼Œè¿”å›falseï¼Œå¦‚æœä¸€è‡´ï¼Œå†æ¯”è¾ƒã€‚</p>
<p><code>NaN</code>è¿™ä¸ªç‰¹æ®Šçš„<code>Number</code>ä¸æ‰€æœ‰å…¶ä»–å€¼éƒ½ä¸ç›¸ç­‰ï¼ŒåŒ…æ‹¬å®ƒè‡ªå·±ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="literal">NaN</span> == <span class="literal">NaN</span>; <span class="comment">// false</span></div><div class="line"><span class="literal">NaN</span> === <span class="literal">NaN</span>; <span class="comment">// false</span></div></pre></td></tr></table></figure></p>
<p>å”¯ä¸€èƒ½åˆ¤æ–­<code>NaN</code>çš„æ–¹æ³•æ˜¯é€šè¿‡<code>isNaN()</code>å‡½æ•°ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">isNaN</span>(<span class="literal">NaN</span>); <span class="comment">// true</span></div></pre></td></tr></table></figure></p>
<p>æµ®ç‚¹æ•°åœ¨è¿ç®—è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿè¯¯å·®ï¼Œå› ä¸ºè®¡ç®—æœºæ— æ³•ç²¾ç¡®è¡¨ç¤ºæ— é™å¾ªç¯å°æ•°ã€‚è¦æ¯”è¾ƒä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯å¦ç›¸ç­‰ï¼Œåªèƒ½è®¡ç®—å®ƒä»¬ä¹‹å·®çš„ç»å¯¹å€¼ï¼Œçœ‹æ˜¯å¦å°äºæŸä¸ªé˜ˆå€¼ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.abs(<span class="number">1</span> / <span class="number">3</span> - (<span class="number">1</span> - <span class="number">2</span> / <span class="number">3</span>)) &lt; <span class="number">0.0000001</span>; <span class="comment">// true</span></div></pre></td></tr></table></figure></p>
<h4 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h4><p>JavaScriptçš„æ•°ç»„å¯ä»¥åŒ…æ‹¬ä»»æ„æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.14</span>, <span class="string">'Hello'</span>, <span class="literal">null</span>, <span class="literal">true</span>];</div></pre></td></tr></table></figure></p>
<p>å¦ä¸€ç§åˆ›å»ºæ•°ç»„çš„æ–¹æ³•æ˜¯é€šè¿‡Array()å‡½æ•°å®ç°ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// åˆ›å»ºäº†æ•°ç»„[1, 2, 3]</span></div></pre></td></tr></table></figure></p>
<p>ç„¶è€Œï¼Œå‡ºäºä»£ç çš„å¯è¯»æ€§è€ƒè™‘ï¼Œå¼ºçƒˆå»ºè®®ç›´æ¥ä½¿ç”¨<code>[]</code>ã€‚</p>
<p>æ•°ç»„çš„å…ƒç´ å¯ä»¥é€šè¿‡ç´¢å¼•æ¥è®¿é—®ã€‚è¯·æ³¨æ„ï¼Œç´¢å¼•çš„èµ·å§‹å€¼ä¸º0ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.14</span>, <span class="string">'Hello'</span>, <span class="literal">null</span>, <span class="literal">true</span>];</div><div class="line">arr[<span class="number">0</span>]; <span class="comment">// è¿”å›ç´¢å¼•ä¸º0çš„å…ƒç´ ï¼Œå³1</span></div><div class="line">arr[<span class="number">5</span>]; <span class="comment">// è¿”å›ç´¢å¼•ä¸º5çš„å…ƒç´ ï¼Œå³true</span></div><div class="line">arr[<span class="number">6</span>]; <span class="comment">// ç´¢å¼•è¶…å‡ºäº†èŒƒå›´ï¼Œè¿”å›undefined</span></div></pre></td></tr></table></figure></p>
<h4 id="å¯¹è±¡"><a href="#å¯¹è±¡" class="headerlink" title="å¯¹è±¡"></a>å¯¹è±¡</h4><p>JavaScriptçš„å¯¹è±¡æ˜¯ä¸€ç»„ç”±é”®-å€¼ç»„æˆçš„æ— åºé›†åˆï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> person = &#123;</div><div class="line">    name: <span class="string">'Bob'</span>,</div><div class="line">    age: <span class="number">20</span>,</div><div class="line">    tags: [<span class="string">'js'</span>, <span class="string">'web'</span>, <span class="string">'mobile'</span>],</div><div class="line">    city: <span class="string">'Beijing'</span>,</div><div class="line">    hasCar: <span class="literal">true</span>,</div><div class="line">    zipcode: <span class="literal">null</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>JavaScriptå¯¹è±¡çš„é”®éƒ½æ˜¯<strong>å­—ç¬¦ä¸²ç±»å‹</strong>ï¼Œå€¼å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»å‹ã€‚</p>
<p>è¦è·å–ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œæˆ‘ä»¬ç”¨å¯¹è±¡å˜é‡.å±æ€§åçš„æ–¹å¼ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">person.name; <span class="comment">// 'Bob'</span></div><div class="line">person.zipcode; <span class="comment">// null</span></div></pre></td></tr></table></figure></p>
<h4 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h4><p>ç”³æ˜ä¸€ä¸ªå˜é‡ç”¨varè¯­å¥ï¼Œæ¯”å¦‚ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a; <span class="comment">// ç”³æ˜äº†å˜é‡aï¼Œæ­¤æ—¶açš„å€¼ä¸ºundefined</span></div><div class="line"><span class="keyword">var</span> $b = <span class="number">1</span>; <span class="comment">// ç”³æ˜äº†å˜é‡$bï¼ŒåŒæ—¶ç»™$bèµ‹å€¼ï¼Œæ­¤æ—¶$bçš„å€¼ä¸º1</span></div><div class="line"><span class="keyword">var</span> s_007 = <span class="string">'007'</span>; <span class="comment">// s_007æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</span></div><div class="line"><span class="keyword">var</span> Answer = <span class="literal">true</span>; <span class="comment">// Answeræ˜¯ä¸€ä¸ªå¸ƒå°”å€¼true</span></div><div class="line"><span class="keyword">var</span> t = <span class="literal">null</span>; <span class="comment">// tçš„å€¼æ˜¯null</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„åªèƒ½ç”¨varç”³æ˜ä¸€æ¬¡ã€‚</p>
<h4 id="strictæ¨¡å¼"><a href="#strictæ¨¡å¼" class="headerlink" title="strictæ¨¡å¼"></a>strictæ¨¡å¼</h4><p>ä¸ºäº†ä¿®è¡¥JavaScriptè¿™ä¸€ä¸¥é‡è®¾è®¡ç¼ºé™·ï¼ŒECMAåœ¨åç»­è§„èŒƒä¸­æ¨å‡ºäº†strictæ¨¡å¼ã€‚</p>
<p>å¯ç”¨strictæ¨¡å¼çš„æ–¹æ³•æ˜¯åœ¨JavaScriptä»£ç çš„ç¬¬ä¸€è¡Œå†™ä¸Šï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div></pre></td></tr></table></figure></p>
<p>ä¸æ”¯æŒstrictæ¨¡å¼çš„æµè§ˆå™¨ä¼šæŠŠå®ƒå½“åšä¸€ä¸ªå­—ç¬¦ä¸²è¯­å¥æ‰§è¡Œï¼Œæ”¯æŒstrictæ¨¡å¼çš„æµè§ˆå™¨å°†å¼€å¯strictæ¨¡å¼è¿è¡ŒJavaScriptã€‚</p>
<h3 id="å­—ç¬¦ä¸²-1"><a href="#å­—ç¬¦ä¸²-1" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h3><h4 id="æ¨¡æ¿å­—ç¬¦ä¸²"><a href="#æ¨¡æ¿å­—ç¬¦ä¸²" class="headerlink" title="æ¨¡æ¿å­—ç¬¦ä¸²"></a>æ¨¡æ¿å­—ç¬¦ä¸²</h4><p>è¦æŠŠå¤šä¸ªå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œå¯ä»¥ç”¨<code>+</code>å·è¿æ¥ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">'å°æ˜'</span>;</div><div class="line"><span class="keyword">var</span> age = <span class="number">20</span>;</div><div class="line"><span class="keyword">var</span> message = <span class="string">'ä½ å¥½, '</span> + name + <span class="string">', ä½ ä»Šå¹´'</span> + age + <span class="string">'å²äº†!'</span>;</div><div class="line">alert(message);</div></pre></td></tr></table></figure></p>
<p>å¦‚æœæœ‰å¾ˆå¤šå˜é‡éœ€è¦è¿æ¥ï¼Œç”¨<code>+</code>å·å°±æ¯”è¾ƒéº»çƒ¦ã€‚ES6æ–°å¢äº†ä¸€ç§æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ–¹æ³•å’Œä¸Šé¢çš„å¤šè¡Œå­—ç¬¦ä¸²ä¸€æ ·ï¼Œä½†æ˜¯å®ƒä¼šè‡ªåŠ¨æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„å˜é‡ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">'å°æ˜'</span>;</div><div class="line"><span class="keyword">var</span> age = <span class="number">20</span>;</div><div class="line"><span class="keyword">var</span> message = <span class="string">`ä½ å¥½, <span class="subst">$&#123;name&#125;</span>, ä½ ä»Šå¹´<span class="subst">$&#123;age&#125;</span>å²äº†!`</span>;</div><div class="line">alert(message);</div></pre></td></tr></table></figure></p>
<h4 id="æ“ä½œå­—ç¬¦ä¸²"><a href="#æ“ä½œå­—ç¬¦ä¸²" class="headerlink" title="æ“ä½œå­—ç¬¦ä¸²"></a>æ“ä½œå­—ç¬¦ä¸²</h4><p>å­—ç¬¦ä¸²å¸¸è§çš„æ“ä½œå¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'Hello, world!'</span>;</div><div class="line">s.length; <span class="comment">// 13</span></div></pre></td></tr></table></figure></p>
<p>è¦è·å–å­—ç¬¦ä¸²æŸä¸ªæŒ‡å®šä½ç½®çš„å­—ç¬¦ï¼Œä½¿ç”¨ç±»ä¼¼Arrayçš„ä¸‹æ ‡æ“ä½œï¼Œç´¢å¼•å·ä»0å¼€å§‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'Hello, world!'</span>;</div><div class="line"></div><div class="line">s[<span class="number">0</span>]; <span class="comment">// 'H'</span></div><div class="line">s[<span class="number">6</span>]; <span class="comment">// ' '</span></div><div class="line">s[<span class="number">7</span>]; <span class="comment">// 'w'</span></div><div class="line">s[<span class="number">12</span>]; <span class="comment">// '!'</span></div><div class="line">s[<span class="number">13</span>]; <span class="comment">// undefined è¶…å‡ºèŒƒå›´çš„ç´¢å¼•ä¸ä¼šæŠ¥é”™ï¼Œä½†ä¸€å¾‹è¿”å›undefined</span></div></pre></td></tr></table></figure></p>
<p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œå¦‚æœå¯¹å­—ç¬¦ä¸²çš„æŸä¸ªç´¢å¼•èµ‹å€¼ï¼Œä¸ä¼šæœ‰ä»»ä½•é”™è¯¯ï¼Œä½†æ˜¯ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•æ•ˆæœ.</p>
<h4 id="toUpperCase"><a href="#toUpperCase" class="headerlink" title="toUpperCase"></a>toUpperCase</h4><p><code>toUpperCase()</code>è¿”å›ä¸€ä¸ªå…¨å¤§å†™çš„å­—ç¬¦ä¸²</p>
<h4 id="toLowerCase"><a href="#toLowerCase" class="headerlink" title="toLowerCase"></a>toLowerCase</h4><p><code>toLowerCase()</code>fè¿”å›ä¸€ä¸ªå…¨å°å†™çš„å­—ç¬¦ä¸²</p>
<h4 id="indexOf"><a href="#indexOf" class="headerlink" title="indexOf"></a>indexOf</h4><p><code>indexOf()</code>ä¼šæœç´¢æŒ‡å®šå­—ç¬¦ä¸²å‡ºç°çš„ä½ç½®:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'hello, world'</span>;</div><div class="line">s.indexOf(<span class="string">'world'</span>); <span class="comment">// è¿”å›7</span></div><div class="line">s.indexOf(<span class="string">'World'</span>); <span class="comment">// æ²¡æœ‰æ‰¾åˆ°æŒ‡å®šçš„å­ä¸²ï¼Œè¿”å›-1</span></div></pre></td></tr></table></figure></p>
<h4 id="substring"><a href="#substring" class="headerlink" title="substring"></a>substring</h4><p><code>substring()</code>è¿”å›æŒ‡å®šç´¢å¼•åŒºé—´çš„å­ä¸²ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'hello, world'</span></div><div class="line">s.substring(<span class="number">0</span>, <span class="number">5</span>); <span class="comment">// ä»ç´¢å¼•0å¼€å§‹åˆ°5ï¼ˆä¸åŒ…æ‹¬5ï¼‰ï¼Œè¿”å›'hello'</span></div><div class="line">s.substring(<span class="number">7</span>); <span class="comment">// ä»ç´¢å¼•7å¼€å§‹åˆ°ç»“æŸï¼Œè¿”å›'world'</span></div></pre></td></tr></table></figure></p>
<h3 id="æ•°ç»„-1"><a href="#æ•°ç»„-1" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><p>è¦å–å¾—<code>Array</code>çš„é•¿åº¦ï¼Œç›´æ¥è®¿é—®<code>length</code>å±æ€§ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.14</span>, <span class="string">'Hello'</span>, <span class="literal">null</span>, <span class="literal">true</span>];</div><div class="line">arr.length; <span class="comment">// 6</span></div></pre></td></tr></table></figure></p>
<p><strong>è¯·æ³¨æ„</strong>ï¼Œç›´æ¥ç»™<code>Array</code>çš„<code>length</code>èµ‹ä¸€ä¸ªæ–°çš„å€¼ä¼šå¯¼è‡´<code>Array</code>å¤§å°çš„å˜åŒ–ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">arr.length; <span class="comment">// 3</span></div><div class="line">arr.length = <span class="number">6</span>;</div><div class="line">arr; <span class="comment">// arrå˜ä¸º[1, 2, 3, undefined, undefined, undefined]</span></div><div class="line">arr.length = <span class="number">2</span>;</div><div class="line">arr; <span class="comment">// arrå˜ä¸º[1, 2]</span></div></pre></td></tr></table></figure></p>
<p><strong>è¯·æ³¨æ„</strong>ï¼Œå¦‚æœé€šè¿‡ç´¢å¼•èµ‹å€¼æ—¶ï¼Œç´¢å¼•è¶…è¿‡äº†èŒƒå›´ï¼ŒåŒæ ·ä¼šå¼•èµ·<code>Array</code>å¤§å°çš„å˜åŒ–ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">arr[<span class="number">5</span>] = <span class="string">'x'</span>;</div><div class="line">arr; <span class="comment">// arrå˜ä¸º[1, 2, 3, undefined, undefined, 'x']</span></div></pre></td></tr></table></figure></p>
<p><strong>å¤§å¤šæ•°å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸å…è®¸ç›´æ¥æ”¹å˜æ•°ç»„çš„å¤§å°ï¼Œè¶Šç•Œè®¿é—®ç´¢å¼•ä¼šæŠ¥é”™ã€‚ç„¶è€Œï¼ŒJavaScriptçš„Arrayå´ä¸ä¼šæœ‰ä»»ä½•é”™è¯¯ã€‚åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œä¸å»ºè®®ç›´æ¥ä¿®æ”¹Arrayçš„å¤§å°ï¼Œè®¿é—®ç´¢å¼•æ—¶è¦ç¡®ä¿ç´¢å¼•ä¸ä¼šè¶Šç•Œã€‚</strong></p>
<h4 id="indexOf-1"><a href="#indexOf-1" class="headerlink" title="indexOf"></a>indexOf</h4><p>ä¸<code>String</code>ç±»ä¼¼ï¼Œ<code>Array</code>ä¹Ÿå¯ä»¥é€šè¿‡<code>indexOf()</code>æ¥æœç´¢ä¸€ä¸ªæŒ‡å®šçš„å…ƒç´ çš„ä½ç½®ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="string">'30'</span>, <span class="string">'xyz'</span>];</div><div class="line">arr.indexOf(<span class="number">10</span>); <span class="comment">// å…ƒç´ 10çš„ç´¢å¼•ä¸º0</span></div><div class="line">arr.indexOf(<span class="number">20</span>); <span class="comment">// å…ƒç´ 20çš„ç´¢å¼•ä¸º1</span></div><div class="line">arr.indexOf(<span class="number">30</span>); <span class="comment">// å…ƒç´ 30æ²¡æœ‰æ‰¾åˆ°ï¼Œè¿”å›-1</span></div><div class="line">arr.indexOf(<span class="string">'30'</span>); <span class="comment">// å…ƒç´ '30'çš„ç´¢å¼•ä¸º2</span></div></pre></td></tr></table></figure></p>
<h4 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h4><p><code>slice()</code>å°±æ˜¯å¯¹åº”<code>String</code>çš„<code>substring()</code>ç‰ˆæœ¬ï¼Œå®ƒæˆªå–<code>Array</code>çš„éƒ¨åˆ†å…ƒç´ ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„<code>Array</code>ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>];</div><div class="line">arr.slice(<span class="number">0</span>, <span class="number">3</span>); <span class="comment">// ä»ç´¢å¼•0å¼€å§‹ï¼Œåˆ°ç´¢å¼•3ç»“æŸï¼Œä½†ä¸åŒ…æ‹¬ç´¢å¼•3: ['A', 'B', 'C']</span></div><div class="line">arr.slice(<span class="number">3</span>); <span class="comment">// ä»ç´¢å¼•3å¼€å§‹åˆ°ç»“æŸ: ['D', 'E', 'F', 'G']</span></div></pre></td></tr></table></figure></p>
<p>å¦‚æœä¸ç»™<code>slice()</code>ä¼ é€’ä»»ä½•å‚æ•°ï¼Œå®ƒå°±ä¼šä»å¤´åˆ°å°¾æˆªå–æ‰€æœ‰å…ƒç´ ã€‚åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å¤åˆ¶ä¸€ä¸ª<code>Array</code></p>
<h4 id="pushå’Œpop"><a href="#pushå’Œpop" class="headerlink" title="pushå’Œpop"></a>pushå’Œpop</h4><p><code>push()</code>å‘<code>Array</code>çš„æœ«å°¾æ·»åŠ <strong>è‹¥å¹²</strong>å…ƒç´ ï¼Œ<code>pop()</code>åˆ™æŠŠ<code>Array</code>çš„æœ€åä¸€ä¸ªå…ƒç´ åˆ é™¤æ‰ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>];</div><div class="line">arr.push(<span class="string">'A'</span>, <span class="string">'B'</span>); <span class="comment">// è¿”å›Arrayæ–°çš„é•¿åº¦: 4</span></div><div class="line">arr; <span class="comment">// [1, 2, 'A', 'B']</span></div><div class="line">arr.pop(); <span class="comment">// pop()è¿”å›'B'</span></div><div class="line">arr; <span class="comment">// [1, 2, 'A']</span></div><div class="line">arr.pop(); arr.pop(); arr.pop(); <span class="comment">// è¿ç»­pop 3æ¬¡</span></div><div class="line">arr; <span class="comment">// []</span></div><div class="line">arr.pop(); <span class="comment">// ç©ºæ•°ç»„ç»§ç»­popä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯è¿”å›undefined</span></div><div class="line">arr; <span class="comment">// []</span></div></pre></td></tr></table></figure></p>
<h4 id="unshiftå’Œshift"><a href="#unshiftå’Œshift" class="headerlink" title="unshiftå’Œshift"></a>unshiftå’Œshift</h4><p>å¦‚æœè¦å¾€<code>Array</code>çš„å¤´éƒ¨æ·»åŠ è‹¥å¹²å…ƒç´ ï¼Œä½¿ç”¨<code>unshift()</code>æ–¹æ³•ï¼Œ<code>shift()</code>æ–¹æ³•åˆ™æŠŠ<code>Array</code>çš„ç¬¬ä¸€ä¸ªå…ƒç´ åˆ æ‰ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>];</div><div class="line">arr.unshift(<span class="string">'A'</span>, <span class="string">'B'</span>); <span class="comment">// è¿”å›Arrayæ–°çš„é•¿åº¦: 4</span></div><div class="line">arr; <span class="comment">// ['A', 'B', 1, 2]</span></div><div class="line">arr.shift(); <span class="comment">// 'A'</span></div><div class="line">arr; <span class="comment">// ['B', 1, 2]</span></div><div class="line">arr.shift(); arr.shift(); arr.shift(); <span class="comment">// è¿ç»­shift 3æ¬¡</span></div><div class="line">arr; <span class="comment">// []</span></div><div class="line">arr.shift(); <span class="comment">// ç©ºæ•°ç»„ç»§ç»­shiftä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯è¿”å›undefined</span></div><div class="line">arr; <span class="comment">// []</span></div></pre></td></tr></table></figure></p>
<h4 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h4><p><code>sort()</code>å¯ä»¥å¯¹å½“å‰<code>Array</code>è¿›è¡Œæ’åºï¼Œå®ƒä¼šç›´æ¥ä¿®æ”¹å½“å‰<code>Array</code>çš„å…ƒç´ ä½ç½®ï¼Œç›´æ¥è°ƒç”¨æ—¶ï¼ŒæŒ‰ç…§é»˜è®¤é¡ºåºæ’åºï¼š</p>
<h4 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h4><p>reverse()æŠŠæ•´ä¸ªArrayçš„å…ƒç´ ç»™æ‰ä¸ªä¸ªï¼Œä¹Ÿå°±æ˜¯åè½¬.</p>
<h4 id="splice"><a href="#splice" class="headerlink" title="splice"></a>splice</h4><p><code>splice()</code>æ–¹æ³•æ˜¯ä¿®æ”¹<code>Array</code>çš„â€œä¸‡èƒ½æ–¹æ³•â€ï¼Œå®ƒå¯ä»¥ä»æŒ‡å®šçš„ç´¢å¼•å¼€å§‹åˆ é™¤è‹¥å¹²å…ƒç´ ï¼Œç„¶åå†ä»è¯¥ä½ç½®æ·»åŠ è‹¥å¹²å…ƒç´ ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">var arr = [&apos;Microsoft&apos;, &apos;Apple&apos;, &apos;Yahoo&apos;, &apos;AOL&apos;, &apos;Excite&apos;, &apos;Oracle&apos;];</div><div class="line">// ä»ç´¢å¼•2å¼€å§‹åˆ é™¤3ä¸ªå…ƒç´ ,ç„¶åå†æ·»åŠ ä¸¤ä¸ªå…ƒç´ :</div><div class="line">arr.splice(2, 3, &apos;Google&apos;, &apos;Facebook&apos;); // è¿”å›åˆ é™¤çš„å…ƒç´  [&apos;Yahoo&apos;, &apos;AOL&apos;, &apos;Excite&apos;]</div><div class="line">arr; // [&apos;Microsoft&apos;, &apos;Apple&apos;, &apos;Google&apos;, &apos;Facebook&apos;, &apos;Oracle&apos;]</div><div class="line">// åªåˆ é™¤,ä¸æ·»åŠ :</div><div class="line">arr.splice(2, 2); // [&apos;Google&apos;, &apos;Facebook&apos;]</div><div class="line">arr; // [&apos;Microsoft&apos;, &apos;Apple&apos;, &apos;Oracle&apos;]</div><div class="line">// åªæ·»åŠ ,ä¸åˆ é™¤:</div><div class="line">arr.splice(2, 0, &apos;Google&apos;, &apos;Facebook&apos;); // è¿”å›[],å› ä¸ºæ²¡æœ‰åˆ é™¤ä»»ä½•å…ƒç´ </div><div class="line">arr; // [&apos;Microsoft&apos;, &apos;Apple&apos;, &apos;Google&apos;, &apos;Facebook&apos;, &apos;Oracle&apos;]</div></pre></td></tr></table></figure></p>
<h4 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h4><p><code>concat()</code>æ–¹æ³•æŠŠå½“å‰çš„<code>Array</code>å’Œå¦ä¸€ä¸ª<code>Array</code>è¿æ¥èµ·æ¥ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„<code>Array</code>ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>];</div><div class="line"><span class="keyword">var</span> added = arr.concat([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div><div class="line">added; <span class="comment">// ['A', 'B', 'C', 1, 2, 3]</span></div><div class="line">arr; <span class="comment">// ['A', 'B', 'C']</span></div></pre></td></tr></table></figure></p>
<p>è¯·æ³¨æ„ï¼Œ<code>concat()</code>æ–¹æ³•å¹¶æ²¡æœ‰ä¿®æ”¹å½“å‰<code>Array</code>ï¼Œè€Œæ˜¯è¿”å›äº†ä¸€ä¸ªæ–°çš„<code>Array</code>ã€‚<br>å®é™…ä¸Šï¼Œ<code>concat()</code>æ–¹æ³•å¯ä»¥æ¥æ”¶ä»»æ„ä¸ªå…ƒç´ å’Œ<code>Array</code>ï¼Œå¹¶ä¸”è‡ªåŠ¨æŠŠ<code>Array</code>æ‹†å¼€ï¼Œç„¶åå…¨éƒ¨æ·»åŠ åˆ°æ–°çš„<code>Array</code>é‡Œï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>];</div><div class="line">arr.concat(<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]); <span class="comment">// ['A', 'B', 'C', 1, 2, 3, 4]</span></div></pre></td></tr></table></figure></p>
<h4 id="join"><a href="#join" class="headerlink" title="join"></a>join</h4><p><code>join()</code>æ–¹æ³•æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„æ–¹æ³•ï¼Œå®ƒæŠŠå½“å‰<code>Array</code>çš„æ¯ä¸ªå…ƒç´ éƒ½ç”¨æŒ‡å®šçš„å­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œç„¶åè¿”å›è¿æ¥åçš„å­—ç¬¦ä¸²ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">arr.join(<span class="string">'-'</span>); <span class="comment">// 'A-B-C-1-2-3'</span></div></pre></td></tr></table></figure></p>
<p>å¦‚æœ<code>Array</code>çš„å…ƒç´ ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå°†è‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²åå†è¿æ¥ã€‚</p>
<h3 id="å¯¹è±¡-1"><a href="#å¯¹è±¡-1" class="headerlink" title="å¯¹è±¡"></a>å¯¹è±¡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xiaohong = &#123;</div><div class="line">    name: <span class="string">'å°çº¢'</span>,</div><div class="line">    <span class="string">'middle-school'</span>: <span class="string">'No.1 Middle School'</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><code>xiaohong</code>çš„å±æ€§å<code>middle-school</code>ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å˜é‡ï¼Œå°±éœ€è¦ç”¨<code>&#39;&#39;</code>æ‹¬èµ·æ¥ã€‚è®¿é—®è¿™ä¸ªå±æ€§ä¹Ÿæ— æ³•ä½¿ç”¨<code>.</code>æ“ä½œç¬¦ï¼Œå¿…é¡»ç”¨<code>[&#39;xxx&#39;]</code>æ¥è®¿é—®ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">xiaohong[<span class="string">'middle-school'</span>]; <span class="comment">// 'No.1 Middle School'</span></div><div class="line">xiaohong[<span class="string">'name'</span>]; <span class="comment">// 'å°çº¢'</span></div><div class="line">xiaohong.name; <span class="comment">// 'å°çº¢'</span></div></pre></td></tr></table></figure></p>
<p>å¦‚æœå±æ€§åæ˜¯å…¶ä»–å¯¹è±¡ï¼Œé‚£ä¹ˆéœ€è¦ç”¨<code>[]</code>å°†å…¶æ‹¬èµ·æ¥ï¼Œè¡¨ç¤ºå¯¹å¤–éƒ¨å¯¹è±¡æ‰§è¡Œ<code>toString()</code>æ“ä½œï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> weight = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"1weight"</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> xiaoming = &#123;</div><div class="line">    name :  <span class="string">"å°æ˜"</span>,</div><div class="line">    [weight()] :<span class="string">"å±æ€§åæ˜¯è¿”å›å€¼1weight"</span>,</div><div class="line">    [weight]:<span class="string">"å±æ€§åæ˜¯æ•´ä¸ªfunction"</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(xiaoming)</div><div class="line">è¿”å›ï¼š</div><div class="line">&#123; name: <span class="string">'å°æ˜'</span>,</div><div class="line">  <span class="string">'1weight'</span>: <span class="string">'å±æ€§åæ˜¯è¿”å›å€¼1weight'</span>,</div><div class="line">  <span class="string">'function () &#123;\n    return "1weight"\n&#125;'</span>: <span class="string">'å±æ€§åæ˜¯æ•´ä¸ªfunction'</span> &#125;</div></pre></td></tr></table></figure></p>
<p>ç”±äºJavaScriptçš„å¯¹è±¡æ˜¯åŠ¨æ€ç±»å‹ï¼Œä½ å¯ä»¥è‡ªç”±åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ æˆ–åˆ é™¤å±æ€§ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xiaoming = &#123;</div><div class="line">    name: <span class="string">'å°æ˜'</span></div><div class="line">&#125;;</div><div class="line">xiaoming.age; <span class="comment">// undefined</span></div><div class="line">xiaoming.age = <span class="number">18</span>; <span class="comment">// æ–°å¢ä¸€ä¸ªageå±æ€§</span></div><div class="line">xiaoming.age; <span class="comment">// 18</span></div><div class="line"><span class="keyword">delete</span> xiaoming.age; <span class="comment">// åˆ é™¤ageå±æ€§</span></div><div class="line">xiaoming.age; <span class="comment">// undefined</span></div><div class="line"><span class="keyword">delete</span> xiaoming[<span class="string">'name'</span>]; <span class="comment">// åˆ é™¤nameå±æ€§</span></div><div class="line">xiaoming.name; <span class="comment">// undefined</span></div><div class="line"><span class="keyword">delete</span> xiaoming.school; <span class="comment">// åˆ é™¤ä¸€ä¸ªä¸å­˜åœ¨çš„schoolå±æ€§ä¹Ÿä¸ä¼šæŠ¥é”™</span></div></pre></td></tr></table></figure></p>
<p>å¦‚æœæˆ‘ä»¬è¦æ£€æµ‹<code>xiaoming</code>æ˜¯å¦æ‹¥æœ‰æŸä¸€å±æ€§ï¼Œå¯ä»¥ç”¨<code>in</code>æ“ä½œç¬¦,ä¸è¿‡è¦å°å¿ƒï¼Œå¦‚æœ<code>in</code>åˆ¤æ–­ä¸€ä¸ªå±æ€§å­˜åœ¨ï¼Œè¿™ä¸ªå±æ€§ä¸ä¸€å®šæ˜¯<code>xiaoming</code>çš„ï¼Œå®ƒå¯èƒ½æ˜¯<code>xiaoming</code>ç»§æ‰¿å¾—åˆ°çš„ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'name'</span> <span class="keyword">in</span> xiaoming; <span class="comment">// true</span></div><div class="line"><span class="string">'toString'</span> <span class="keyword">in</span> xiaoming; <span class="comment">// true</span></div></pre></td></tr></table></figure></p>
<p>è¦åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦æ˜¯<code>xiaoming</code>è‡ªèº«æ‹¥æœ‰çš„ï¼Œè€Œä¸æ˜¯ç»§æ‰¿å¾—åˆ°çš„ï¼Œå¯ä»¥ç”¨<code>hasOwnProperty()</code>æ–¹æ³•ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xiaoming = &#123;</div><div class="line">    name: <span class="string">'å°æ˜'</span></div><div class="line">&#125;;</div><div class="line">xiaoming.hasOwnProperty(<span class="string">'name'</span>); <span class="comment">// true</span></div><div class="line">xiaoming.hasOwnProperty(<span class="string">'toString'</span>); <span class="comment">// false</span></div></pre></td></tr></table></figure></p>
<h3 id="Mapå’ŒSet"><a href="#Mapå’ŒSet" class="headerlink" title="Mapå’ŒSet"></a>Mapå’ŒSet</h3><p>JSä¸­é»˜è®¤å¯¹è±¡è¡¨è¾¾æ–¹å¼<code>{}</code>å¯ä»¥è§†ä¸ºå…¶ä»–è¯­è¨€ä¸­çš„<code>Map</code>æˆ–<code>Dictionary</code>çš„æ•°æ®ç»“æ„ï¼Œå³ä¸€ç»„é”®å€¼å¯¹ã€‚<br>ä½†æ˜¯JavaScriptçš„å¯¹è±¡æœ‰ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯<strong>é”®å¿…é¡»æ˜¯å­—ç¬¦ä¸²</strong>ã€‚ä½†å®é™…ä¸ŠNumberæˆ–è€…å…¶ä»–æ•°æ®ç±»å‹ä½œä¸ºé”®ä¹Ÿæ˜¯éå¸¸åˆç†çš„ã€‚<br>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ€æ–°çš„ES6è§„èŒƒå¼•å…¥äº†æ–°çš„æ•°æ®ç±»å‹<code>Map</code>ã€‚</p>
<h4 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="string">'Michael'</span>, <span class="number">95</span>], [<span class="string">'Bob'</span>, <span class="number">75</span>], [<span class="string">'Tracy'</span>, <span class="number">85</span>]]);</div><div class="line">m.delete(<span class="string">'Adam'</span>); <span class="comment">// åˆ é™¤key 'Adam'</span></div><div class="line">m.get(<span class="string">'Michael'</span>); <span class="comment">// 95</span></div><div class="line">m.set(<span class="string">'Zachary'</span>, <span class="number">100</span>);</div></pre></td></tr></table></figure>
<h4 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h4><p>é‡å¤å…ƒç´ åœ¨Setä¸­è‡ªåŠ¨è¢«è¿‡æ»¤ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="string">'3'</span>]);</div><div class="line">s; <span class="comment">// Set &#123;1, 2, 3, "3"&#125;</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„æ•°å­—<code>3</code>å’Œå­—ç¬¦ä¸²<code>&#39;3&#39;</code>æ˜¯ä¸åŒçš„å…ƒç´ ã€‚</p>
<p>é€šè¿‡<code>add(key)</code>æ–¹æ³•å¯ä»¥æ·»åŠ å…ƒç´ åˆ°<code>Set</code>ä¸­ï¼Œå¯ä»¥é‡å¤æ·»åŠ ï¼Œä½†ä¸ä¼šæœ‰æ•ˆæœï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; s.add(<span class="number">4</span>)</div><div class="line">&gt;&gt;&gt; s</div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</div><div class="line">&gt;&gt;&gt; s.add(<span class="number">4</span>)</div><div class="line">&gt;&gt;&gt; s</div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡delete(key)æ–¹æ³•å¯ä»¥åˆ é™¤å…ƒç´ ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div><div class="line">s; <span class="comment">// Set &#123;1, 2, 3&#125;</span></div><div class="line">s.delete(<span class="number">3</span>);</div><div class="line">s; <span class="comment">// Set &#123;1, 2&#125;</span></div></pre></td></tr></table></figure></p>
<h3 id="iterable"><a href="#iterable" class="headerlink" title="iterable"></a>iterable</h3><p>ES6æ ‡å‡†å¼•å…¥äº†æ–°çš„<code>iterable</code>ç±»å‹ï¼Œ<code>Array</code>ã€<code>Map</code>å’Œ<code>Set</code>éƒ½å±äº<code>iterable</code>ç±»å‹ã€‚<br>å…·æœ‰<code>iterable</code>ç±»å‹çš„é›†åˆå¯ä»¥é€šè¿‡æ–°çš„<code>for ... of</code>å¾ªç¯æ¥éå†ã€‚</p>
<p>ç”¨<code>for ... of</code>å¾ªç¯éå†é›†åˆï¼Œç”¨æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>];</div><div class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>]);</div><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="number">1</span>, <span class="string">'x'</span>], [<span class="number">2</span>, <span class="string">'y'</span>], [<span class="number">3</span>, <span class="string">'z'</span>]]);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> a) &#123; <span class="comment">// éå†Array</span></div><div class="line">    alert(x);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> s) &#123; <span class="comment">// éå†Set</span></div><div class="line">    alert(x);</div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> m) &#123; <span class="comment">// éå†Map</span></div><div class="line">    alert(x[<span class="number">0</span>] + <span class="string">'='</span> + x[<span class="number">1</span>]);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong><code>for ... of</code>å¾ªç¯å’Œ<code>for ... in</code>å¾ªç¯æœ‰ä½•åŒºåˆ«ï¼Ÿ</strong><br><code>for ... in</code>å®é™…ä¸Šæ˜¯<strong>å¯¹è±¡çš„å±æ€§åç§°(æ³¨æ„ï¼Œæ˜¯é”®ï¼Œä¸æ˜¯å€¼)</strong>ã€‚ä¸è¦ç”¨åœ¨<code>Array</code>,<code>Set</code>,<code>Map</code>ä¸Šï¼Œä¼šå‡ºç°å¥‡æ€ªçš„é—®é¢˜ã€‚<br><code>for ... of</code>å¾ªç¯åˆ™å®Œå…¨ä¿®å¤äº†è¿™äº›é—®é¢˜ï¼Œå®ƒ<strong>åªå¾ªç¯å¾—åˆ°é›†åˆå†…è¯¥å‡ºç°çš„å…ƒç´ (æ³¨æ„ï¼Œæ˜¯å€¼ï¼Œä¸æ˜¯é”®)</strong>ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>];</div><div class="line">a.name = <span class="string">'Hello'</span>;</div><div class="line">a[<span class="string">'4'</span>] = <span class="string">'D'</span>;</div><div class="line"><span class="built_in">console</span>.log(a);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> num <span class="keyword">of</span> a)&#123;</div><div class="line">    <span class="built_in">console</span>.log(num)</div><div class="line">&#125;</div><div class="line">è¾“å‡ºï¼š</div><div class="line">[ <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, , <span class="string">'D'</span>, name: <span class="string">'Hello'</span> ]</div><div class="line">A</div><div class="line">B</div><div class="line">C</div><div class="line"><span class="literal">undefined</span></div><div class="line">D</div></pre></td></tr></table></figure></p>
<p><code>name</code>ç”±äºä¸æ˜¯æ­£å¸¸<code>Array</code>è¯¥æœ‰çš„ï¼Œæ‰€ä»¥åœ¨<code>for ... of</code>å¾ªç¯æ—¶ï¼Œå…¶å¯¹åº”çš„å€¼ä¸ä¼šè¢«è¾“å‡ºã€‚</p>
<p>ç„¶è€Œï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨<code>iterable</code>å†…ç½®çš„<code>forEach</code>æ–¹æ³•ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œæ¯æ¬¡è¿­ä»£å°±è‡ªåŠ¨å›è°ƒè¯¥å‡½æ•°ã€‚ä»¥<code>Array</code>ä¸ºä¾‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>];</div><div class="line">a.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">element, index, array</span>) </span>&#123;</div><div class="line">    <span class="comment">// element: æŒ‡å‘å½“å‰å…ƒç´ çš„å€¼</span></div><div class="line">    <span class="comment">// index: æŒ‡å‘å½“å‰ç´¢å¼•</span></div><div class="line">    <span class="comment">// array: æŒ‡å‘Arrayå¯¹è±¡æœ¬èº«</span></div><div class="line">    alert(element);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>å¯¹äº<code>Set</code>æ¥è¯´ï¼Œç”±äºæ²¡æœ‰ç´¢å¼•ï¼Œ<code>index</code>ä¹Ÿæ˜¯æŒ‡å½“å‰å…ƒç´ ã€‚<br>å¯¹äº<code>Map</code>æ¥è¯´ï¼Œ<code>element</code>å’Œ<code>index</code>åˆ†åˆ«å¯¹åº”<code>Value</code>å’Œ<code>Key</code>.</p>
<h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><h3 id="å‡½æ•°å®šä¹‰å’Œè°ƒç”¨"><a href="#å‡½æ•°å®šä¹‰å’Œè°ƒç”¨" class="headerlink" title="å‡½æ•°å®šä¹‰å’Œè°ƒç”¨"></a>å‡½æ•°å®šä¹‰å’Œè°ƒç”¨</h3><h4 id="å®šä¹‰å‡½æ•°"><a href="#å®šä¹‰å‡½æ•°" class="headerlink" title="å®šä¹‰å‡½æ•°"></a>å®šä¹‰å‡½æ•°</h4><p>æ–¹å¼ä¸€ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">abs</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (x &gt;= <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> x;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> -x;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç”±äºJavaScriptçš„å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸Šè¿°å®šä¹‰çš„<code>abs()</code>å‡½æ•°å®é™…ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œè€Œå‡½æ•°å<code>abs</code>å¯ä»¥è§†ä¸ºæŒ‡å‘è¯¥å‡½æ•°çš„å˜é‡ã€‚</p>
<p>æ–¹å¼äºŒï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> abs = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (x &gt;= <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> x;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> -x;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œ<code>function (x) { ... }</code>æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå®ƒæ²¡æœ‰å‡½æ•°åã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªåŒ¿åå‡½æ•°èµ‹å€¼ç»™äº†å˜é‡<code>abs</code>ï¼Œæ‰€ä»¥ï¼Œé€šè¿‡å˜é‡<code>abs</code>å°±å¯ä»¥è°ƒç”¨è¯¥å‡½æ•°ã€‚</p>
<p>ä¸Šè¿°ä¸¤ç§å®šä¹‰å®Œå…¨ç­‰ä»·ï¼Œæ³¨æ„ç¬¬äºŒç§æ–¹å¼æŒ‰ç…§å®Œæ•´è¯­æ³•éœ€è¦åœ¨å‡½æ•°ä½“æœ«å°¾åŠ ä¸€ä¸ª<code>;</code>ï¼Œè¡¨ç¤ºèµ‹å€¼è¯­å¥ç»“æŸã€‚</p>
<h4 id="è°ƒç”¨å‡½æ•°"><a href="#è°ƒç”¨å‡½æ•°" class="headerlink" title="è°ƒç”¨å‡½æ•°"></a>è°ƒç”¨å‡½æ•°</h4><p>ç”±äºJavaScriptå…è®¸ä¼ å…¥ä»»æ„ä¸ªå‚æ•°è€Œä¸å½±å“è°ƒç”¨ï¼Œå› æ­¤ä¼ å…¥çš„å‚æ•°æ¯”å®šä¹‰çš„å‚æ•°å¤šä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œè™½ç„¶å‡½æ•°å†…éƒ¨å¹¶ä¸éœ€è¦è¿™äº›å‚æ•°ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">abs(<span class="number">10</span>, <span class="string">'blablabla'</span>); <span class="comment">// è¿”å›10</span></div><div class="line">abs(<span class="number">-9</span>, <span class="string">'haha'</span>, <span class="string">'hehe'</span>, <span class="literal">null</span>); <span class="comment">// è¿”å›9</span></div></pre></td></tr></table></figure></p>
<p>ä¼ å…¥çš„å‚æ•°æ¯”å®šä¹‰çš„å°‘ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">abs(); <span class="comment">// è¿”å›NaN</span></div></pre></td></tr></table></figure></p>
<p>æ­¤æ—¶<code>abs(x)</code>å‡½æ•°çš„å‚æ•°<code>x</code>å°†æ”¶åˆ°<code>undefined</code>ï¼Œè®¡ç®—ç»“æœä¸º<code>NaN</code>ã€‚</p>
<p>è¦é¿å…æ”¶åˆ°undefinedï¼Œå¯ä»¥å¯¹å‚æ•°è¿›è¡Œæ£€æŸ¥ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">abs</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> ((<span class="keyword">typeof</span> x) !== <span class="string">'number'</span>) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="string">'Not a number'</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (x &gt;= <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> x;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> -x;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h4><p>JavaScriptè¿˜æœ‰ä¸€ä¸ªå…è´¹èµ é€çš„å…³é”®å­—<code>arguments</code>ï¼Œå®ƒåªåœ¨å‡½æ•°å†…éƒ¨èµ·ä½œç”¨ï¼Œå¹¶ä¸”æ°¸è¿œæŒ‡å‘å½“å‰å‡½æ•°çš„è°ƒç”¨è€…ä¼ å…¥çš„æ‰€æœ‰å‚æ•°ã€‚<code>arguments</code>ç±»ä¼¼<code>Array</code>ä½†å®ƒä¸æ˜¯ä¸€ä¸ª<code>Array</code>ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    alert(x); <span class="comment">// 10</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="built_in">arguments</span>.length; i++) &#123;</div><div class="line">        alert(<span class="built_in">arguments</span>[i]); <span class="comment">// 10, 20, 30</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">foo(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>);</div></pre></td></tr></table></figure></p>
<p>åˆ©ç”¨<code>arguments</code>ï¼Œä½ å¯ä»¥è·å¾—è°ƒç”¨è€…ä¼ å…¥çš„æ‰€æœ‰å‚æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿å‡½æ•°ä¸å®šä¹‰ä»»ä½•å‚æ•°ï¼Œè¿˜æ˜¯å¯ä»¥æ‹¿åˆ°å‚æ•°çš„å€¼.å®é™…ä¸Šargumentsæœ€å¸¸ç”¨äºåˆ¤æ–­ä¼ å…¥å‚æ•°çš„ä¸ªæ•°ã€‚</p>
<h4 id="restå‚æ•°"><a href="#restå‚æ•°" class="headerlink" title="restå‚æ•°"></a>restå‚æ•°</h4><p>ç”±äºJavaScriptå‡½æ•°å…è®¸æ¥æ”¶ä»»æ„ä¸ªå‚æ•°ï¼Œäºæ˜¯æˆ‘ä»¬å°±ä¸å¾—ä¸ç”¨<code>arguments</code>æ¥è·å–æ‰€æœ‰å‚æ•°.<br>ES6æ ‡å‡†å¼•å…¥äº†<code>rest</code>å‚æ•°ï¼Œå¯ä»¥å°†å‰©ä½™çš„å‚æ•°æ”¾åœ¨<code>rest</code>ä¸­ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a, b, ...rest</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'a = '</span> + a);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'b = '</span> + b);</div><div class="line">    <span class="built_in">console</span>.log(rest);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line"><span class="comment">// ç»“æœ:</span></div><div class="line"><span class="comment">// a = 1</span></div><div class="line"><span class="comment">// b = 2</span></div><div class="line"><span class="comment">// Array [ 3, 4, 5 ]</span></div><div class="line"></div><div class="line">foo(<span class="number">1</span>);</div><div class="line"><span class="comment">// ç»“æœ:</span></div><div class="line"><span class="comment">// a = 1</span></div><div class="line"><span class="comment">// b = undefined</span></div><div class="line"><span class="comment">// Array []</span></div></pre></td></tr></table></figure></p>
<p><code>rest</code>å‚æ•°åªèƒ½å†™åœ¨æœ€åï¼Œå‰é¢ç”¨<code>...</code>æ ‡è¯†ï¼Œä»è¿è¡Œç»“æœå¯çŸ¥ï¼Œä¼ å…¥çš„å‚æ•°å…ˆç»‘å®š<code>a</code>ã€<code>b</code>ï¼Œå¤šä½™çš„å‚æ•°ä»¥æ•°ç»„å½¢å¼äº¤ç»™å˜é‡<code>rest</code>ï¼Œæ‰€ä»¥ï¼Œä¸å†éœ€è¦<code>arguments</code>æˆ‘ä»¬å°±è·å–äº†å…¨éƒ¨å‚æ•°ã€‚<br>å¦‚æœä¼ å…¥çš„å‚æ•°è¿æ­£å¸¸å®šä¹‰çš„å‚æ•°éƒ½æ²¡å¡«æ»¡ï¼Œä¹Ÿä¸è¦ç´§ï¼Œ<code>rest</code>å‚æ•°ä¼šæ¥æ”¶ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆæ³¨æ„ä¸æ˜¯<code>undefined</code>ï¼‰ã€‚</p>
<h3 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a>å˜é‡ä½œç”¨åŸŸ</h3><p>åœ¨JavaScriptä¸­ï¼Œç”¨varç”³æ˜çš„å˜é‡å®é™…ä¸Šæ˜¯æœ‰ä½œç”¨åŸŸçš„ã€‚</p>
<ul>
<li>å¦‚æœä¸€ä¸ªå˜é‡åœ¨å‡½æ•°ä½“å†…éƒ¨ç”³æ˜ï¼Œåˆ™è¯¥å˜é‡çš„ä½œç”¨åŸŸä¸ºæ•´ä¸ª<strong>å‡½æ•°ä½“</strong>(æ³¨æ„ï¼Œvarçš„ä½œç”¨åŸŸæ˜¯å‡½æ•°ä½“ï¼Œä¸æ˜¯è¯­å¥å—)ï¼Œåœ¨å‡½æ•°ä½“å¤–ä¸å¯å¼•ç”¨è¯¥å˜é‡ã€‚</li>
<li>ç”±äºJavaScriptçš„å‡½æ•°å¯ä»¥åµŒå¥—ï¼Œæ­¤æ—¶ï¼Œå†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°å®šä¹‰çš„å˜é‡</li>
<li>å¦‚æœå†…éƒ¨å‡½æ•°å’Œå¤–éƒ¨å‡½æ•°çš„å˜é‡åé‡åæ€ä¹ˆåŠï¼ŸJavaScriptçš„å‡½æ•°åœ¨æŸ¥æ‰¾å˜é‡æ—¶ä»è‡ªèº«å‡½æ•°å®šä¹‰å¼€å§‹ï¼Œä»â€œå†…â€å‘â€œå¤–â€æŸ¥æ‰¾ã€‚å¦‚æœå†…éƒ¨å‡½æ•°å®šä¹‰äº†ä¸å¤–éƒ¨å‡½æ•°é‡åçš„å˜é‡ï¼Œåˆ™å†…éƒ¨å‡½æ•°çš„å˜é‡å°†â€œå±è”½â€å¤–éƒ¨å‡½æ•°çš„å˜é‡ã€‚</li>
</ul>
<h4 id="å˜é‡æå‡"><a href="#å˜é‡æå‡" class="headerlink" title="å˜é‡æå‡"></a>å˜é‡æå‡</h4><p>JavaScriptçš„å‡½æ•°å®šä¹‰æœ‰ä¸ªç‰¹ç‚¹ï¼Œå®ƒä¼šå…ˆæ‰«ææ•´ä¸ªå‡½æ•°ä½“çš„è¯­å¥ï¼ŒæŠŠæ‰€æœ‰ç”³æ˜çš„å˜é‡â€œæå‡â€åˆ°å‡½æ•°é¡¶éƒ¨ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> x = <span class="string">'Hello, '</span> + y;</div><div class="line">    alert(x);</div><div class="line">    <span class="keyword">var</span> y = <span class="string">'Bob'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo();</div></pre></td></tr></table></figure></p>
<p>è™½ç„¶æ˜¯<code>strict</code>æ¨¡å¼ï¼Œä½†è¯­å¥<code>var x = &#39;Hello, &#39; + y;</code>å¹¶ä¸æŠ¥é”™ï¼ŒåŸå› æ˜¯å˜é‡<code>y</code>åœ¨ç¨åç”³æ˜äº†ã€‚ä½†æ˜¯<code>alert</code>æ˜¾ç¤º<code>Hello, undefined</code>ï¼Œè¯´æ˜å˜é‡<code>y</code>çš„å€¼ä¸º<code>undefined</code>ã€‚è¿™æ­£æ˜¯å› ä¸ºJavaScriptå¼•æ“è‡ªåŠ¨æå‡äº†å˜é‡<code>y</code>çš„å£°æ˜ï¼Œä½†ä¸ä¼šæå‡å˜é‡<code>y</code>çš„èµ‹å€¼ã€‚</p>
<h4 id="å…¨å±€ä½œç”¨åŸŸ"><a href="#å…¨å±€ä½œç”¨åŸŸ" class="headerlink" title="å…¨å±€ä½œç”¨åŸŸ"></a>å…¨å±€ä½œç”¨åŸŸ</h4><p>ä¸åœ¨ä»»ä½•å‡½æ•°å†…å®šä¹‰çš„å˜é‡å°±å…·æœ‰å…¨å±€ä½œç”¨åŸŸã€‚</p>
<h4 id="åå­—ç©ºé—´"><a href="#åå­—ç©ºé—´" class="headerlink" title="åå­—ç©ºé—´"></a>åå­—ç©ºé—´</h4><p>ä¸åŒçš„JavaScriptæ–‡ä»¶å¦‚æœä½¿ç”¨äº†ç›¸åŒçš„å…¨å±€å˜é‡ï¼Œæˆ–è€…å®šä¹‰äº†ç›¸åŒåå­—çš„é¡¶å±‚å‡½æ•°ï¼Œéƒ½ä¼šé€ æˆå‘½åå†²çª.å‡å°‘å†²çªçš„ä¸€ä¸ªæ–¹æ³•æ˜¯æŠŠè‡ªå·±çš„æ‰€æœ‰å˜é‡å’Œå‡½æ•°å…¨éƒ¨ç»‘å®šåˆ°ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ã€‚ä¾‹å¦‚ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å”¯ä¸€çš„å…¨å±€å˜é‡MYAPP:</span></div><div class="line"><span class="keyword">var</span> MYAPP = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="comment">// å…¶ä»–å˜é‡:</span></div><div class="line">MYAPP.name = <span class="string">'myapp'</span>;</div><div class="line">MYAPP.version = <span class="number">1.0</span>;</div><div class="line"></div><div class="line"><span class="comment">// å…¶ä»–å‡½æ•°:</span></div><div class="line">MYAPP.foo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'foo'</span>;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>æŠŠè‡ªå·±çš„ä»£ç å…¨éƒ¨æ”¾å…¥å”¯ä¸€çš„åå­—ç©ºé—´<code>MYAPP</code>ä¸­ï¼Œä¼šå¤§å¤§å‡å°‘å…¨å±€å˜é‡å†²çªçš„å¯èƒ½ã€‚<br>è®¸å¤šè‘—åçš„JavaScriptåº“éƒ½æ˜¯è¿™ä¹ˆå¹²çš„ï¼šjQueryï¼ŒYUIï¼Œunderscoreç­‰ç­‰ã€‚</p>
<h4 id="å±€éƒ¨ä½œç”¨åŸŸ"><a href="#å±€éƒ¨ä½œç”¨åŸŸ" class="headerlink" title="å±€éƒ¨ä½œç”¨åŸŸ"></a>å±€éƒ¨ä½œç”¨åŸŸ</h4><p>ç”±äºJavaScriptçš„å˜é‡ä½œç”¨åŸŸå®é™…ä¸Šæ˜¯å‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬åœ¨forå¾ªç¯ç­‰è¯­å¥å—ä¸­æ˜¯æ— æ³•å®šä¹‰å…·æœ‰å±€éƒ¨ä½œç”¨åŸŸçš„å˜é‡çš„ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++) &#123;</div><div class="line">        <span class="comment">//</span></div><div class="line">    &#125;</div><div class="line">    i += <span class="number">100</span>; <span class="comment">// ä»ç„¶å¯ä»¥å¼•ç”¨å˜é‡i</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä¸ºäº†è§£å†³å—çº§ä½œç”¨åŸŸï¼ŒES6å¼•å…¥äº†æ–°çš„å…³é”®å­—<code>let</code>ï¼Œç”¨<code>let</code>æ›¿ä»£<code>var</code>å¯ä»¥ç”³æ˜ä¸€ä¸ªå—çº§ä½œç”¨åŸŸçš„å˜é‡ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> sum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++) &#123;</div><div class="line">        sum += i;</div><div class="line">    &#125;</div><div class="line">    i += <span class="number">1</span>; <span class="comment">// SyntaxError</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h4><p>ç”±äºvarå’Œletç”³æ˜çš„æ˜¯å˜é‡ï¼Œå¦‚æœè¦ç”³æ˜ä¸€ä¸ªå¸¸é‡ï¼Œåœ¨ES6ä¹‹å‰æ˜¯ä¸è¡Œçš„ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨å…¨éƒ¨å¤§å†™çš„å˜é‡æ¥è¡¨ç¤ºâ€œè¿™æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œä¸è¦ä¿®æ”¹å®ƒçš„å€¼â€.</p>
<p>ES6æ ‡å‡†å¼•å…¥äº†æ–°çš„å…³é”®å­—<code>const</code>æ¥å®šä¹‰å¸¸é‡ï¼Œ<code>const</code>ä¸<code>let</code>éƒ½å…·æœ‰å—çº§ä½œç”¨åŸŸï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> PI = <span class="number">3.14</span>;</div><div class="line">PI = <span class="number">3</span>; <span class="comment">// æŸäº›æµè§ˆå™¨ä¸æŠ¥é”™ï¼Œä½†æ˜¯æ— æ•ˆæœï¼</span></div><div class="line">PI; <span class="comment">// 3.14</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼Œä¸€å®šè¦åŠ ä¸Š<code>use strict</code>,å¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p>ç»‘å®šåˆ°å¯¹è±¡ä¸Šçš„å‡½æ•°ç§°ä¸ºæ–¹æ³•:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xiaoming = &#123;</div><div class="line">    name: <span class="string">'å°æ˜'</span>,</div><div class="line">    birth: <span class="number">1990</span>,</div><div class="line">    age: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</div><div class="line">        <span class="keyword">return</span> y - <span class="keyword">this</span>.birth;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">xiaoming.age; <span class="comment">// function xiaoming.age()</span></div><div class="line">xiaoming.age(); <span class="comment">// ä»Šå¹´è°ƒç”¨æ˜¯25,æ˜å¹´è°ƒç”¨å°±å˜æˆ26äº†</span></div></pre></td></tr></table></figure></p>
<p>å’Œæ™®é€šå‡½æ•°ä¹Ÿæ²¡å•¥åŒºåˆ«ï¼Œä½†æ˜¯å®ƒåœ¨å†…éƒ¨ä½¿ç”¨äº†ä¸€ä¸ª<code>this</code>å…³é”®å­—.<br>åœ¨ä¸€ä¸ªæ–¹æ³•å†…éƒ¨ï¼Œ<code>this</code>æ˜¯ä¸€ä¸ªç‰¹æ®Šå˜é‡ï¼Œ<strong>å®ƒå§‹ç»ˆæŒ‡å‘å½“å‰å¯¹è±¡</strong>ï¼Œä¹Ÿå°±æ˜¯<code>xiaoming</code>è¿™ä¸ªå˜é‡ã€‚æ‰€ä»¥ï¼Œ<code>this.birth</code>å¯ä»¥æ‹¿åˆ°<code>xiaoming</code>çš„<code>birth</code>å±æ€§ã€‚</p>
<p>è®©æˆ‘ä»¬æ‹†å¼€å†™ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAge</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</div><div class="line">    <span class="keyword">return</span> y - <span class="keyword">this</span>.birth;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> xiaoming = &#123;</div><div class="line">    name: <span class="string">'å°æ˜'</span>,</div><div class="line">    birth: <span class="number">1990</span>,</div><div class="line">    age: getAge</div><div class="line">&#125;;</div><div class="line"></div><div class="line">xiaoming.age(); <span class="comment">// 25, æ­£å¸¸ç»“æœ</span></div><div class="line">getAge(); <span class="comment">// NaN</span></div></pre></td></tr></table></figure></p>
<p>å•ç‹¬è°ƒç”¨å‡½æ•°<code>getAge()</code>æ€ä¹ˆè¿”å›äº†<code>NaN</code>ï¼Ÿè¯·æ³¨æ„ï¼Œæˆ‘ä»¬å·²ç»è¿›å…¥åˆ°äº†JavaScriptçš„ä¸€ä¸ªå¤§å‘é‡Œã€‚<br>JavaScriptçš„å‡½æ•°å†…éƒ¨å¦‚æœè°ƒç”¨äº†<code>this</code>ï¼Œé‚£ä¹ˆè¿™ä¸ª<code>this</code>åˆ°åº•æŒ‡å‘è°ï¼Ÿ<br>ç­”æ¡ˆæ˜¯ï¼Œè§†æƒ…å†µè€Œå®šï¼<br>å¦‚æœä»¥å¯¹è±¡çš„æ–¹æ³•å½¢å¼è°ƒç”¨ï¼Œæ¯”å¦‚<code>xiaoming.age()</code>ï¼Œè¯¥å‡½æ•°çš„<code>this</code>æŒ‡å‘è¢«è°ƒç”¨çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯<code>xiaoming</code>ï¼Œè¿™æ˜¯ç¬¦åˆæˆ‘ä»¬é¢„æœŸçš„ã€‚<br>å¦‚æœå•ç‹¬è°ƒç”¨å‡½æ•°ï¼Œæ¯”å¦‚<code>getAge()</code>ï¼Œæ­¤æ—¶ï¼Œè¯¥å‡½æ•°çš„<code>this</code>æŒ‡å‘<strong>å…¨å±€å¯¹è±¡</strong>.</p>
<p>æ›´å‘çˆ¹çš„æ˜¯ï¼Œå¦‚æœè¿™ä¹ˆå†™ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fn = xiaoming.age; <span class="comment">// å…ˆæ‹¿åˆ°xiaomingçš„ageå‡½æ•°</span></div><div class="line">fn(); <span class="comment">// NaN</span></div></pre></td></tr></table></figure></p>
<p>ä¹Ÿæ˜¯ä¸è¡Œçš„ï¼è¦ä¿è¯<code>this</code>æŒ‡å‘æ­£ç¡®ï¼Œå¿…é¡»è¦ç»™å‡ºæ˜ç¡®çš„ä¸Šä¸‹æ–‡ï¼Œå¿…é¡»ç”¨<code>obj.xxx()</code>çš„å½¢å¼è°ƒç”¨ï¼è°è°ƒç”¨ï¼Œ<code>this</code>å°±æ˜¯æŒ‡è°ã€‚ä¸Šé¢ä»…ä»…ç›¸å½“äºå°†<code>age</code>æ–¹æ³•èµ‹ç»™<code>fn</code>.</p>
<p>å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xiaoming = &#123;</div><div class="line">    name: <span class="string">'å°æ˜'</span>,</div><div class="line">    birth: <span class="number">1990</span>,</div><div class="line">    age: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">getAgeFromBirth</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</div><div class="line">            <span class="keyword">return</span> y - <span class="keyword">this</span>.birth;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> getAgeFromBirth();</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">xiaoming.age();</div></pre></td></tr></table></figure></p>
<p>åˆä¸å¯¹äº†ã€‚åŸå› æ˜¯<code>this</code>æŒ‡é’ˆåªåœ¨<code>age</code>æ–¹æ³•çš„å‡½æ•°å†…æŒ‡å‘<code>xiaoming</code>ï¼Œåœ¨å‡½æ•°å†…éƒ¨å®šä¹‰çš„å‡½æ•°ï¼Œ<code>this</code>åˆæŒ‡å‘<code>undefined</code>äº†ï¼éœ€è¦è¿™æ ·ä¿®æ”¹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xiaoming = &#123;</div><div class="line">    name: <span class="string">'å°æ˜'</span>,</div><div class="line">    birth: <span class="number">1990</span>,</div><div class="line">    age: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> that = <span class="keyword">this</span>; <span class="comment">// åœ¨æ–¹æ³•å†…éƒ¨ä¸€å¼€å§‹å°±æ•è·this</span></div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">getAgeFromBirth</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</div><div class="line">            <span class="keyword">return</span> y - that.birth; <span class="comment">// ç”¨thatè€Œä¸æ˜¯this</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> getAgeFromBirth();</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">xiaoming.age(); <span class="comment">// 25</span></div></pre></td></tr></table></figure></p>
<p>ç”¨<code>var that = this</code>;å°†<code>age</code>ä¸­çš„<code>this</code>æ•è·ï¼Œå°±å¯ä»¥æ”¾å¿ƒåœ°åœ¨æ–¹æ³•å†…éƒ¨å®šä¹‰å…¶ä»–å‡½æ•°ï¼Œè€Œä¸æ˜¯æŠŠæ‰€æœ‰è¯­å¥éƒ½å †åˆ°ä¸€ä¸ªæ–¹æ³•ä¸­ã€‚</p>
<h4 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h4><p>æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥æ§åˆ¶<code>this</code>çš„æŒ‡å‘çš„ï¼</p>
<p>è¦æŒ‡å®šå‡½æ•°çš„<code>this</code>æŒ‡å‘å“ªä¸ªå¯¹è±¡ï¼Œå¯ä»¥ç”¨å‡½æ•°æœ¬èº«çš„<code>apply</code>æ–¹æ³•ï¼Œå®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯éœ€è¦ç»‘å®šçš„<code>this</code>å˜é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯<code>Array</code>ï¼Œè¡¨ç¤ºå‡½æ•°æœ¬èº«çš„å‚æ•°ã€‚</p>
<p>ç”¨<code>apply</code>ä¿®å¤<code>getAge()</code>è°ƒç”¨:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAge</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</div><div class="line">    <span class="keyword">return</span> y - <span class="keyword">this</span>.birth;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> xiaoming = &#123;</div><div class="line">    name: <span class="string">'å°æ˜'</span>,</div><div class="line">    birth: <span class="number">1990</span>,</div><div class="line">    age: getAge</div><div class="line">&#125;;</div><div class="line"></div><div class="line">xiaoming.age(); <span class="comment">// 25</span></div><div class="line">getAge.apply(xiaoming, []); <span class="comment">// 25, thisæŒ‡å‘xiaoming, å‚æ•°ä¸ºç©º</span></div></pre></td></tr></table></figure></p>
<p>å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> numbers = &#123;  </div><div class="line">   numberA: <span class="number">5</span>,</div><div class="line">   numberB: <span class="number">10</span>,</div><div class="line">   sum: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="built_in">console</span>.log(<span class="keyword">this</span> === numbers); <span class="comment">// =&gt; true</span></div><div class="line">     <span class="function"><span class="keyword">function</span> <span class="title">calculate</span>(<span class="params"></span>) </span>&#123;</div><div class="line">       <span class="comment">// this is window or undefined in strict mode</span></div><div class="line">       <span class="built_in">console</span>.log(<span class="keyword">this</span> === numbers); <span class="comment">// =&gt; false</span></div><div class="line">       <span class="keyword">return</span> <span class="keyword">this</span>.numberA + <span class="keyword">this</span>.numberB;</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">return</span> calculate();</div><div class="line">   &#125;</div><div class="line">&#125;;</div><div class="line">numbers.sum(); <span class="comment">// =&gt; NaN or throws TypeError in strict mode  </span></div><div class="line"></div><div class="line"><span class="keyword">var</span> numbers = &#123;  </div><div class="line">   numberA: <span class="number">5</span>,</div><div class="line">   numberB: <span class="number">10</span>,</div><div class="line">   sum: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="built_in">console</span>.log(<span class="keyword">this</span> === numbers); <span class="comment">// =&gt; true</span></div><div class="line">     <span class="function"><span class="keyword">function</span> <span class="title">calculate</span>(<span class="params"></span>) </span>&#123;</div><div class="line">       <span class="built_in">console</span>.log(<span class="keyword">this</span> === numbers); <span class="comment">// =&gt; true</span></div><div class="line">       <span class="keyword">return</span> <span class="keyword">this</span>.numberA + <span class="keyword">this</span>.numberB;</div><div class="line">     &#125;</div><div class="line">     <span class="comment">// use .call() method to modify the context</span></div><div class="line">     <span class="keyword">return</span> calculate.call(<span class="keyword">this</span>);</div><div class="line">   &#125;</div><div class="line">&#125;;</div><div class="line">numbers.sum(); <span class="comment">// =&gt; 15</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„<code>call()</code>ä¸<code>apply()</code>æ˜¯ç±»ä¼¼çš„æ–¹æ³•ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯ï¼š</p>
<ul>
<li><code>apply()</code>æŠŠå‚æ•°æ‰“åŒ…æˆ<code>Array</code>å†ä¼ å…¥ï¼›</li>
<li><code>call()</code>æŠŠå‚æ•°æŒ‰é¡ºåºä¼ å…¥ã€‚ </li>
</ul>
<p>æ¯”å¦‚è°ƒç”¨<code>Math.max(3, 5, 4)</code>ï¼Œåˆ†åˆ«ç”¨<code>apply()</code>å’Œ<code>call()</code>å®ç°å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, [<span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>]); <span class="comment">// 5</span></div><div class="line"><span class="built_in">Math</span>.max.call(<span class="literal">null</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>); <span class="comment">// 5</span></div></pre></td></tr></table></figure></p>
<p>å¯¹æ™®é€šå‡½æ•°è°ƒç”¨ï¼Œæˆ‘ä»¬é€šå¸¸æŠŠthisç»‘å®šä¸ºnullã€‚</p>
<h4 id="bind"><a href="#bind" class="headerlink" title=".bind()"></a>.bind()</h4><p>å¯¹æ¯”æ–¹æ³• <code>.apply()</code> å’Œ <code>.call()</code>ï¼Œå®ƒä¿©éƒ½ç«‹å³æ‰§è¡Œäº†å‡½æ•°ï¼Œè€Œ <code>.bind()</code> å‡½æ•°è¿”å›äº†ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œç»‘å®šäº†é¢„å…ˆæŒ‡å®šå¥½çš„ <code>this</code> ï¼Œå¹¶å¯ä»¥å»¶åè°ƒç”¨ã€‚<code>.bind()</code> æ–¹æ³•çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæ‰§è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¸º <code>.bind()</code> ä¼ é€’çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå®ƒå…è®¸åˆ›å»ºé¢„å…ˆè®¾ç½®å¥½ <code>this</code> çš„å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> numbers = &#123;  </div><div class="line">  array: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">10</span>],</div><div class="line">  getNumbers: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.array;    </div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// Create a bound function</span></div><div class="line"><span class="keyword">var</span> boundGetNumbers = numbers.getNumbers.bind(numbers);  </div><div class="line">boundGetNumbers(); <span class="comment">// =&gt; [3, 5, 10]  </span></div><div class="line"><span class="comment">// Extract method from object</span></div><div class="line"><span class="keyword">var</span> simpleGetNumbers = numbers.getNumbers;  </div><div class="line">simpleGetNumbers(); <span class="comment">// =&gt; undefined or throws an error in strict mode</span></div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ <code>.bind()</code> æ—¶åº”è¯¥æ³¨æ„ï¼Œ<code>.bind()</code> åˆ›å»ºäº†ä¸€ä¸ªæ°¸æ’çš„ä¸Šä¸‹æ–‡é“¾å¹¶ä¸å¯ä¿®æ”¹ã€‚ä¸€ä¸ªç»‘å®šå‡½æ•°å³ä½¿ä½¿ç”¨ <code>.call()</code> æˆ–è€… <code>.apply()</code>ä¼ å…¥å…¶ä»–ä¸åŒçš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä¹Ÿä¸ä¼šæ›´æ”¹å®ƒä¹‹å‰è¿æ¥çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œé‡æ–°ç»‘å®šä¹Ÿä¸ä¼šèµ·ä»»ä½•ä½œç”¨ã€‚</p>
<h4 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h4><p>åˆ©ç”¨<code>apply()</code>ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åŠ¨æ€æ”¹å˜å‡½æ•°çš„è¡Œä¸ºã€‚</p>
<p>JavaScriptçš„æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯åŠ¨æ€çš„ï¼Œå³ä½¿å†…ç½®çš„å‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥<strong>é‡æ–°æŒ‡å‘æ–°çš„å‡½æ•°</strong>ã€‚</p>
<p>ç°åœ¨å‡å®šæˆ‘ä»¬æƒ³ç»Ÿè®¡ä¸€ä¸‹ä»£ç ä¸€å…±è°ƒç”¨äº†å¤šå°‘æ¬¡<code>parseInt()</code>ï¼Œå¯ä»¥æŠŠæ‰€æœ‰çš„è°ƒç”¨éƒ½æ‰¾å‡ºæ¥ï¼Œç„¶åæ‰‹åŠ¨åŠ ä¸Š<code>count += 1</code>ï¼Œä¸è¿‡è¿™æ ·åšå¤ªå‚»äº†ã€‚æœ€ä½³æ–¹æ¡ˆæ˜¯ç”¨æˆ‘ä»¬è‡ªå·±çš„å‡½æ•°æ›¿æ¢æ‰é»˜è®¤çš„<code>parseInt()</code>ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> count = <span class="number">0</span>;</div><div class="line"><span class="keyword">var</span> oldParseInt = <span class="built_in">parseInt</span>; <span class="comment">// ä¿å­˜åŸå‡½æ•°</span></div><div class="line"></div><div class="line"><span class="built_in">window</span>.parseInt = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    count += <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> oldParseInt.apply(<span class="literal">null</span>, <span class="built_in">arguments</span>); <span class="comment">// è°ƒç”¨åŸå‡½æ•°</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// æµ‹è¯•:</span></div><div class="line"><span class="built_in">parseInt</span>(<span class="string">'10'</span>);</div><div class="line"><span class="built_in">parseInt</span>(<span class="string">'20'</span>);</div><div class="line"><span class="built_in">parseInt</span>(<span class="string">'30'</span>);</div><div class="line">count; <span class="comment">// 3</span></div></pre></td></tr></table></figure></p>
<h3 id="é«˜é˜¶å‡½æ•°"><a href="#é«˜é˜¶å‡½æ•°" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h3><p>ä¸€ä¸ªå¯ä»¥æ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚çš„å‡½æ•°ï¼Œç§°ä¸ºé«˜é˜¶å‡½æ•°ã€‚</p>
<h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><p><code>map()</code>æ–¹æ³•å®šä¹‰åœ¨JavaScriptçš„<code>Array</code>ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨<code>Array</code>çš„<code>map()</code>æ–¹æ³•ï¼Œä¼ å…¥æˆ‘ä»¬è‡ªå·±çš„å‡½æ•°ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„<code>Array</code>ä½œä¸ºç»“æœï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">pow</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x * x;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</div><div class="line">arr.map(pow); <span class="comment">// [1, 4, 9, 16, 25, 36, 49, 64, 81]</span></div></pre></td></tr></table></figure></p>
<p><code>map()</code>å°†ä¼ å…¥çš„å‡½æ•°ä¸€ä¸€ä½œç”¨åœ¨æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Šã€‚</p>
<h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><p><code>Array</code>çš„<code>reduce()</code>æŠŠä¸€ä¸ªå‡½æ•°ä½œç”¨åœ¨è¿™ä¸ª<code>Array</code>çš„<code>[x1, x2, x3...]</code>ä¸Šï¼Œè¿™ä¸ªå‡½æ•°å¿…é¡»æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œ<code>reduce()</code>æŠŠç»“æœç»§ç»­å’Œåºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ åšç´¯ç§¯è®¡ç®—ï¼Œå…¶æ•ˆæœå°±æ˜¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[x1, x2, x3, x4].reduce(f) = f(f(f(x1, x2), x3), x4)</div></pre></td></tr></table></figure></p>
<p>æ¯”å¦‚å¯¹<code>Array</code>æ±‚å’Œï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>];</div><div class="line">arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x + y;</div><div class="line">&#125;); <span class="comment">// 25</span></div></pre></td></tr></table></figure></p>
<h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><p>ç”¨äºæŠŠ<code>Array</code>çš„æŸäº›å…ƒç´ è¿‡æ»¤æ‰ï¼Œç„¶åè¿”å›å‰©ä¸‹çš„å…ƒç´ <br><code>Array</code>çš„<code>filter()</code>æ¥æ”¶ä¸€ä¸ªå‡½æ•°,æŠŠä¼ å…¥çš„å‡½æ•°ä¾æ¬¡ä½œç”¨äºæ¯ä¸ªå…ƒç´ ï¼Œç„¶åæ ¹æ®è¿”å›å€¼æ˜¯<code>true</code>è¿˜æ˜¯<code>false</code>å†³å®šä¿ç•™è¿˜æ˜¯ä¸¢å¼ƒè¯¥å…ƒç´ ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ª<code>Array</code>ä¸­ï¼Œåˆ æ‰å¶æ•°ï¼Œåªä¿ç•™å¥‡æ•°ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">15</span>];</div><div class="line"><span class="keyword">var</span> r = arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> x % <span class="number">2</span> !== <span class="number">0</span>;</div><div class="line">&#125;);</div><div class="line">r; <span class="comment">// [1, 5, 9, 15]</span></div></pre></td></tr></table></figure></p>
<h4 id="sort-1"><a href="#sort-1" class="headerlink" title="sort"></a>sort</h4><p>å¯ä»¥æ¥æ”¶ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°æ¥å®ç°è‡ªå®šä¹‰çš„æ’åº<br>è¦æŒ‰æ•°å­—å¤§å°æ’åºï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>];</div><div class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (x &lt; y) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (x &gt; y) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;); <span class="comment">// [1, 2, 10, 20]</span></div></pre></td></tr></table></figure></p>
<p><strong>æ³¨æ„</strong>ï¼š<code>sort()</code>æ–¹æ³•ä¼šç›´æ¥å¯¹<code>Array</code>è¿›è¡Œä¿®æ”¹ï¼Œå®ƒè¿”å›çš„ç»“æœä»æ˜¯å½“å‰<code>Array</code></p>
<h3 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h3><h4 id="å‡½æ•°ä½œä¸ºè¿”å›å€¼"><a href="#å‡½æ•°ä½œä¸ºè¿”å›å€¼" class="headerlink" title="å‡½æ•°ä½œä¸ºè¿”å›å€¼"></a>å‡½æ•°ä½œä¸ºè¿”å›å€¼</h4><p>é«˜é˜¶å‡½æ•°é™¤äº†å¯ä»¥æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°å¤–ï¼Œè¿˜å¯ä»¥æŠŠå‡½æ•°ä½œä¸ºç»“æœå€¼è¿”å›ã€‚</p>
<p>æ¯”å¦‚è¿”å›ä¸€ä¸ªæ±‚å’Œçš„å‡½æ•°ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">lazy_sum</span>(<span class="params">arr</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> sum = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> x + y;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> sum;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å½“æˆ‘ä»¬è°ƒç”¨<code>lazy_sum()</code>æ—¶ï¼Œè¿”å›çš„å¹¶ä¸æ˜¯æ±‚å’Œç»“æœï¼Œè€Œæ˜¯æ±‚å’Œå‡½æ•°ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> f = lazy_sum([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]); <span class="comment">// function sum()</span></div></pre></td></tr></table></figure></p>
<p>è°ƒç”¨å‡½æ•°fæ—¶ï¼Œæ‰çœŸæ­£è®¡ç®—æ±‚å’Œçš„ç»“æœï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">f(); <span class="comment">// 15</span></div></pre></td></tr></table></figure></p>
<p>å½“<code>lazy_sum</code>è¿”å›å‡½æ•°<code>sum</code>æ—¶ï¼Œç›¸å…³å‚æ•°å’Œå˜é‡éƒ½ä¿å­˜åœ¨è¿”å›çš„å‡½æ•°ä¸­ï¼Œè¿™ç§ç§°ä¸ºâ€œé—­åŒ…ï¼ˆClosureï¼‰â€(ä½†æ˜¯JSä¸­<code>this</code>ä¸éµå¾ªé—­åŒ…)</p>
<h4 id="é—­åŒ…-1"><a href="#é—­åŒ…-1" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h4><p>éœ€è¦æ³¨æ„çš„é—®é¢˜æ˜¯ï¼Œè¿”å›çš„å‡½æ•°å¹¶æ²¡æœ‰ç«‹åˆ»æ‰§è¡Œï¼Œè€Œæ˜¯ç›´åˆ°è°ƒç”¨äº†f()æ‰æ‰§è¡Œã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">count</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> arr = [];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;=<span class="number">3</span>; i++) &#123;</div><div class="line">        arr.push(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> i * i;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> arr;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> results = count();</div><div class="line"><span class="keyword">var</span> f1 = results[<span class="number">0</span>];</div><div class="line"><span class="keyword">var</span> f2 = results[<span class="number">1</span>];</div><div class="line"><span class="keyword">var</span> f3 = results[<span class="number">2</span>];</div></pre></td></tr></table></figure></p>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ¯æ¬¡å¾ªç¯ï¼Œéƒ½åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œç„¶åï¼ŒæŠŠåˆ›å»ºçš„3ä¸ªå‡½æ•°éƒ½æ·»åŠ åˆ°ä¸€ä¸ªArrayä¸­è¿”å›äº†ï¼Œ<strong>æˆ–è€…è¯´è¿”å›äº†ä¸‰ä¸ªé—­åŒ…</strong>.<br>è°ƒç”¨çš„ç»“æœå…¨æ˜¯<code>16</code>,å› ä¸ºè¿”å›å‡½æ•°éƒ½å¼•ç”¨äº†å˜é‡<code>i</code>ï¼Œç”±äºé—­åŒ…æ€§ï¼Œç­‰åˆ°3ä¸ªå‡½æ•°éƒ½è¿”å›æ—¶ï¼Œå®ƒä»¬æ‰€å¼•ç”¨çš„å˜é‡iå·²ç»å˜æˆäº†<code>4</code>ã€‚</p>
<p><strong>è¿”å›é—­åŒ…æ—¶ç‰¢è®°çš„ä¸€ç‚¹å°±æ˜¯ï¼šè¿”å›å‡½æ•°ä¸è¦å¼•ç”¨ä»»ä½•å¾ªç¯å˜é‡ï¼Œæˆ–è€…åç»­ä¼šå‘ç”Ÿå˜åŒ–çš„å˜é‡ã€‚</strong></p>
<p>å¦‚ä½•ä¸€å®šè¦å¼•ç”¨å¾ªç¯å˜é‡ï¼Ÿæ–¹æ³•æ˜¯å†åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œç”¨è¯¥å‡½æ•°çš„å‚æ•°ç»‘å®šå¾ªç¯å˜é‡å½“å‰çš„å€¼ï¼Œæ— è®ºè¯¥å¾ªç¯å˜é‡åç»­å¦‚ä½•æ›´æ”¹ï¼Œå·²ç»‘å®šåˆ°å‡½æ•°å‚æ•°çš„å€¼ä¸å˜ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">count</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> arr = [];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;=<span class="number">3</span>; i++) &#123;</div><div class="line">        arr.push((<span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="keyword">return</span> n * n;</div><div class="line">            &#125;</div><div class="line">        &#125;)(i));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> arr;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> results = count();</div><div class="line"><span class="keyword">var</span> f1 = results[<span class="number">0</span>];</div><div class="line"><span class="keyword">var</span> f2 = results[<span class="number">1</span>];</div><div class="line"><span class="keyword">var</span> f3 = results[<span class="number">2</span>];</div><div class="line"></div><div class="line">f1(); <span class="comment">// 1</span></div><div class="line">f2(); <span class="comment">// 4</span></div><div class="line">f3(); <span class="comment">// 9</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„è¿™é‡Œç”¨äº†ä¸€ä¸ªâ€œåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°å¹¶ç«‹åˆ»æ‰§è¡Œâ€çš„è¯­æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">(function (x) &#123;</div><div class="line">    return x * x;</div><div class="line">&#125;)(3); // 9</div><div class="line">``` </div><div class="line"></div><div class="line">**å®é™…ä¸Šï¼Œä¸Šé¢çš„ä»£ç ç›¸å½“äºåœ¨å¤–å±‚å‡½æ•°æ‹¿äº†ä¸€ä¸ªå˜é‡`n`æˆªå–äº†`i`,ç”±äºå¤–å±‚å‡½æ•°æ˜¯ç«‹åˆ»æ‰§è¡Œäº†çš„åŒ¿åå‡½æ•°(å³ç«‹åˆ»æ‰§è¡Œäº†`var n = i;`)ï¼Œé‚£ä¹ˆ`n`å°±å›ºå®šäº†ä¸‹æ¥**ï¼š</div><div class="line">```javascript</div><div class="line">function count() &#123;</div><div class="line">    var arr = [];</div><div class="line">    for (var i=1; i&lt;=3; i++) &#123;</div><div class="line">        arr.push((function () &#123;</div><div class="line">            var n =i</div><div class="line">            return function () &#123;</div><div class="line">                return n*n;</div><div class="line">            &#125;</div><div class="line">        &#125;)());</div><div class="line">    &#125;</div><div class="line">    return arr;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç›¸åçš„ï¼Œå¦‚æœå†…å­˜å‡½æ•°è¿˜æ˜¯ç”¨çš„<code>i</code>ï¼Œé‚£ä¹ˆç»“æœå°±ä¼šå…¨æ˜¯<code>16</code>.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">count</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> arr = [];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;=<span class="number">3</span>; i++) &#123;</div><div class="line">        arr.push((<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="comment">// var n =i</span></div><div class="line">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="keyword">return</span> i*i;</div><div class="line">            &#125;</div><div class="line">        &#125;)());</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> arr;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h3><p>ES6æ ‡å‡†æ–°å¢äº†ä¸€ç§æ–°çš„å‡½æ•°ï¼šArrow Functionï¼ˆç®­å¤´å‡½æ•°ï¼‰ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">x =&gt; x*x</div></pre></td></tr></table></figure></p>
<p>ç›¸å½“äºä¸€ä¸ªè¾“å…¥ä¸º<code>x</code>è¾“å‡ºä¸º<code>x*x</code>çš„åŒ¿åå‡½æ•°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">function (x) &#123;</div><div class="line">    return x * x;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¦‚æœå‚æ•°ä¸æ˜¯ä¸€ä¸ªï¼Œå°±éœ€è¦ç”¨æ‹¬å·()æ‹¬èµ·æ¥ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¸¤ä¸ªå‚æ•°:</span></div><div class="line">(x, y) =&gt; x * x + y * y</div><div class="line"></div><div class="line"><span class="comment">// æ— å‚æ•°:</span></div><div class="line">() =&gt; <span class="number">3.14</span></div><div class="line"></div><div class="line"><span class="comment">// å¯å˜å‚æ•°:</span></div><div class="line">(x, y, ...rest) =&gt; &#123;</div><div class="line">    <span class="keyword">var</span> i, sum = x + y;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;rest.length; i++) &#123;</div><div class="line">        sum += rest[i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> sum;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¯­æ³•ç³–ï¼Œç±»ä¼¼äºpythonä¸­çš„lambdaå‡½æ•°</p>
<p>å½“ç„¶ï¼Œç®­å¤´å‡½æ•°è¿˜æ˜¯æœ‰ç‚¹ç”¨å¤„çš„ï¼Œç”±äºæ˜¯es6çš„æ–°ç‰¹æ€§ï¼Œ<strong>ç®­å¤´å‡½æ•°å†…éƒ¨çš„thisæ˜¯è¯æ³•ä½œç”¨åŸŸ</strong>ï¼Œç”±ä¸Šä¸‹æ–‡ç¡®å®šã€‚<br>è¯•åšæ¯”è¾ƒï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">//ç”±äºJavaScriptå‡½æ•°å¯¹thisç»‘å®šçš„é”™è¯¯å¤„ç†ï¼Œä¸‹é¢çš„ä¾‹å­æ— æ³•å¾—åˆ°é¢„æœŸç»“æœ</div><div class="line">var obj = &#123;</div><div class="line">    birth: 1990,</div><div class="line">    getAge: function () &#123;</div><div class="line">        var b = this.birth; // 1990</div><div class="line">        var fn = function () &#123;</div><div class="line">            return new Date().getFullYear() - this.birth; // thisæŒ‡å‘windowæˆ–undefined</div><div class="line">        &#125;;</div><div class="line">        return fn();</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">//ç®­å¤´å‡½æ•°å®Œå…¨ä¿®å¤äº†thisçš„æŒ‡å‘ï¼Œthisæ€»æ˜¯æŒ‡å‘è¯æ³•ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯å¤–å±‚è°ƒç”¨è€…objï¼š</div><div class="line">var obj = &#123;</div><div class="line">    birth: 1990,</div><div class="line">    getAge: function () &#123;</div><div class="line">        var b = this.birth; // 1990</div><div class="line">        var fn = () =&gt; new Date().getFullYear() - this.birth; // thisæŒ‡å‘objå¯¹è±¡</div><div class="line">        return fn();</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">obj.getAge(); // 25</div></pre></td></tr></table></figure></p>
<p>å¦‚æœä½¿ç”¨ç®­å¤´å‡½æ•°,ä»¥å‰ <code>var that = this;</code> ä»¥åŠ <code>.apply()</code> å’Œ <code>.call()</code> è¿™ç§å†™æ³•å°±ä¸éœ€è¦äº†ã€‚</p>
<p>ç®­å¤´å‡½æ•°å¹¶ä¸åˆ›å»ºå®ƒè‡ªèº«æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ï¼Œä½¿å¾— <code>this</code> å–å†³äºå®ƒåœ¨å®šä¹‰æ—¶çš„å¤–éƒ¨å‡½æ•°ã€‚<strong>ç®­å¤´å‡½æ•°ä¸€æ¬¡ç»‘å®šä¸Šä¸‹æ–‡åä¾¿ä¸å¯æ›´æ”¹ï¼Œå³ä½¿ä½¿ç”¨äº†ä¸Šä¸‹æ–‡æ›´æ”¹çš„æ–¹æ³•</strong>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> numbers = [<span class="number">1</span>, <span class="number">2</span>];  </div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  </div><div class="line">  <span class="keyword">var</span> get = () =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span> === numbers); <span class="comment">// =&gt; true</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">  &#125;;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span> === numbers); <span class="comment">// =&gt; true</span></div><div class="line">  get(); <span class="comment">// =&gt; [1, 2]</span></div><div class="line">  <span class="comment">// ç®­å¤´å‡½æ•°ä½¿ç”¨ .apply() å’Œ .call()</span></div><div class="line">  get.call([<span class="number">0</span>]);  <span class="comment">// =&gt; [1, 2]</span></div><div class="line">  get.apply([<span class="number">0</span>]); <span class="comment">// =&gt; [1, 2]</span></div><div class="line">  <span class="comment">// Bind</span></div><div class="line">  get.bind([<span class="number">0</span>])(); <span class="comment">// =&gt; [1, 2]</span></div><div class="line">&#125;).call(numbers);</div></pre></td></tr></table></figure>
<p>è¿™æ˜¯å› ä¸ºç®­å¤´å‡½æ•°æ‹¥æœ‰é™æ€çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä¸ä¼šå› ä¸ºä¸åŒçš„è°ƒç”¨è€Œæ”¹å˜ã€‚ä½†æ˜¯è¦æ³¨æ„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Period</span> (<span class="params">hours, minutes</span>) </span>&#123;  </div><div class="line">     <span class="keyword">this</span>.hours = hours;</div><div class="line">     <span class="keyword">this</span>.minutes = minutes;</div><div class="line">   &#125;</div><div class="line">   Period.prototype.format = () =&gt; &#123;  </div><div class="line">     <span class="built_in">console</span>.log(<span class="keyword">this</span> === <span class="built_in">window</span>); <span class="comment">// =&gt; true</span></div><div class="line">     <span class="keyword">return</span> <span class="keyword">this</span>.hours + <span class="string">' hours and '</span> + <span class="keyword">this</span>.minutes + <span class="string">' minutes'</span>;</div><div class="line">   &#125;;</div><div class="line">   <span class="keyword">var</span> walkPeriod = <span class="keyword">new</span> Period(<span class="number">2</span>, <span class="number">30</span>);  </div><div class="line">   walkPeriod.format(); <span class="comment">// =&gt; 'undefined hours and undefined minutes'</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„è¿™é‡Œçš„ <code>this === window</code> è¿”å›çš„æ˜¯ <code>true</code>ã€‚</p>
<h3 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h3><p>generatorï¼ˆç”Ÿæˆå™¨ï¼‰æ˜¯ES6æ ‡å‡†å¼•å…¥çš„æ–°çš„æ•°æ®ç±»å‹ï¼Œç±»ä¼¼äºPythonçš„generatorçš„æ¦‚å¿µå’Œè¯­æ³•ã€‚ä¸€ä¸ªgeneratorçœ‹ä¸Šå»åƒä¸€ä¸ªå‡½æ•°ï¼Œä½†å¯ä»¥è¿”å›å¤šæ¬¡ã€‚</p>
<p>å®šä¹‰å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">foo</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">    <span class="keyword">yield</span> x + <span class="number">1</span>;</div><div class="line">    <span class="keyword">yield</span> x + <span class="number">2</span>;</div><div class="line">    <span class="keyword">return</span> x + <span class="number">3</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>generatorç”±<code>function*</code>å®šä¹‰ï¼ˆæ³¨æ„å¤šå‡ºçš„<code>*</code>å·ï¼‰ï¼Œå¹¶ä¸”ï¼Œé™¤äº†<code>return</code>è¯­å¥ï¼Œè¿˜å¯ä»¥ç”¨<code>yield</code>è¿”å›å¤šæ¬¡ã€‚å¥½å¤„å°±æ˜¯<strong>å‡½æ•°åªèƒ½è¿”å›ä¸€æ¬¡ï¼Œæ‰€ä»¥å¿…é¡»è¿”å›ä¸€ä¸ªArrayã€‚ä½†æ˜¯ï¼Œå¦‚æœæ¢æˆgeneratorï¼Œå°±å¯ä»¥ä¸€æ¬¡è¿”å›ä¸€ä¸ªæ•°ï¼Œä¸æ–­è¿”å›å¤šæ¬¡ã€‚</strong>(å…¶å®è¿™ä¸œè¥¿å¾ˆåƒè°ƒè¯•å‡½æ•°æ—¶å€™çš„æ–­ç‚¹ï¼)</p>
<p>æ‰§è¡Œgeneratorå’Œè°ƒç”¨å‡½æ•°ä¸ä¸€æ ·ï¼Œè°ƒç”¨generatorå¯¹è±¡æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€æ˜¯ä¸æ–­åœ°è°ƒç”¨generatorå¯¹è±¡çš„<code>next()</code>æ–¹æ³•ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> f = fib(<span class="number">5</span>);</div><div class="line">f.next(); <span class="comment">// &#123;value: 0, done: false&#125;</span></div><div class="line">f.next(); <span class="comment">// &#123;value: 1, done: false&#125;</span></div><div class="line">f.next(); <span class="comment">// &#123;value: 1, done: true&#125;</span></div></pre></td></tr></table></figure></p>
<p><code>next()</code>æ–¹æ³•ä¼šæ‰§è¡Œgeneratorçš„ä»£ç ï¼Œç„¶åï¼Œæ¯æ¬¡é‡åˆ°<code>yield x;</code>å°±è¿”å›ä¸€ä¸ªå¯¹è±¡<code>{value: x, done: true/false}</code>ï¼Œç„¶åâ€œæš‚åœâ€ã€‚è¿”å›çš„<code>value</code>å°±æ˜¯<code>yield</code>çš„è¿”å›å€¼ï¼Œ<code>done</code>è¡¨ç¤ºè¿™ä¸ªgeneratoræ˜¯å¦å·²ç»æ‰§è¡Œç»“æŸäº†ã€‚å¦‚æœ<code>done</code>ä¸º<code>true</code>ï¼Œåˆ™<code>value</code>å°±æ˜¯<code>return</code>çš„è¿”å›å€¼ã€‚</p>
<p>ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯ç›´æ¥ç”¨<code>for ... of</code>å¾ªç¯è¿­ä»£generatorå¯¹è±¡ï¼Œè¿™ç§æ–¹å¼ä¸éœ€è¦æˆ‘ä»¬è‡ªå·±åˆ¤æ–­<code>done</code>ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> fib(<span class="number">5</span>)) &#123;</div><div class="line">    <span class="built_in">console</span>.log(x); <span class="comment">// ä¾æ¬¡è¾“å‡º0, 1, 1</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å› ä¸ºgeneratorå¯ä»¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¤šæ¬¡è¿”å›ï¼Œæ‰€ä»¥å®ƒçœ‹ä¸Šå»å°±åƒä¸€ä¸ªå¯ä»¥è®°ä½æ‰§è¡ŒçŠ¶æ€çš„å‡½æ•°ã€‚<strong>çœ‹èµ·æ¥è›®æœ‰ç”¨çš„</strong></p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œè¦ç”Ÿæˆä¸€ä¸ªè‡ªå¢çš„IDï¼Œå¯ä»¥ç¼–å†™ä¸€ä¸ªnext_id()å‡½æ•°ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> current_id = <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">next_id</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    current_id ++;</div><div class="line">    <span class="keyword">return</span> current_id;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç”±äºå‡½æ•°æ— æ³•ä¿å­˜çŠ¶æ€ï¼Œæ•…éœ€è¦ä¸€ä¸ªå…¨å±€å˜é‡<code>current_id</code>æ¥ä¿å­˜æ•°å­—ã€‚ç°åœ¨æ”¹ç”¨generatorï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">next_id</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (<span class="literal">true</span>)&#123;</div><div class="line">    	<span class="keyword">yield</span> ++i;</div><div class="line">   	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="æ ‡å‡†å¯¹è±¡"><a href="#æ ‡å‡†å¯¹è±¡" class="headerlink" title="æ ‡å‡†å¯¹è±¡"></a>æ ‡å‡†å¯¹è±¡</h2><p>ä¸€äº›åŸåˆ™ï¼š</p>
<ul>
<li>ä¸è¦ä½¿ç”¨<code>new Number()</code>ã€<code>new Boolean()</code>ã€<code>new String()</code>åˆ›å»ºåŒ…è£…å¯¹è±¡ï¼›</li>
<li>ç”¨<code>parseInt()</code>æˆ–<code>parseFloat()</code>æ¥è½¬æ¢ä»»æ„ç±»å‹åˆ°<code>number</code>ï¼›</li>
<li>ç”¨<code>String()</code>æ¥è½¬æ¢ä»»æ„ç±»å‹åˆ°<code>string</code>ï¼Œæˆ–è€…ç›´æ¥è°ƒç”¨æŸä¸ªå¯¹è±¡çš„<code>toString()</code>æ–¹æ³•ï¼›</li>
<li>é€šå¸¸ä¸å¿…æŠŠä»»æ„ç±»å‹è½¬æ¢ä¸º<code>boolean</code>å†åˆ¤æ–­ï¼Œå› ä¸ºå¯ä»¥ç›´æ¥å†™<code>if (myVar) {...}</code>ï¼›</li>
<li><code>typeof</code>æ“ä½œç¬¦å¯ä»¥åˆ¤æ–­å‡º<code>number</code>ã€<code>boolean</code>ã€<code>string</code>ã€<code>function</code>å’Œ<code>undefined</code>ï¼›</li>
<li>åˆ¤æ–­<code>Array</code>è¦ä½¿ç”¨<code>Array.isArray(arr)</code>ï¼›</li>
<li>åˆ¤æ–­<code>null</code>è¯·ä½¿ç”¨<code>myVar === null</code>ï¼›</li>
<li>åˆ¤æ–­æŸä¸ªå…¨å±€å˜é‡æ˜¯å¦å­˜åœ¨ç”¨<code>typeof window.myVar === &#39;undefined&#39;</code>ï¼›</li>
</ul>
<h3 id="Date"><a href="#Date" class="headerlink" title="Date"></a>Date</h3><p>åœ¨JavaScriptä¸­ï¼Œ<code>Date</code>å¯¹è±¡ç”¨æ¥è¡¨ç¤ºæ—¥æœŸå’Œæ—¶é—´ã€‚</p>
<p>è¦è·å–ç³»ç»Ÿå½“å‰æ—¶é—´ï¼Œç”¨ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">now; <span class="comment">// Wed Jun 24 2015 19:49:22 GMT+0800 (CST)</span></div><div class="line">now.getFullYear(); <span class="comment">// 2015, å¹´ä»½</span></div><div class="line">now.getMonth(); <span class="comment">// 5, æœˆä»½ï¼Œæ³¨æ„æœˆä»½èŒƒå›´æ˜¯0~11ï¼Œ5è¡¨ç¤ºå…­æœˆ</span></div><div class="line">now.getDate(); <span class="comment">// 24, è¡¨ç¤º24å·</span></div><div class="line">now.getDay(); <span class="comment">// 3, è¡¨ç¤ºæ˜ŸæœŸä¸‰</span></div><div class="line">now.getHours(); <span class="comment">// 19, 24å°æ—¶åˆ¶</span></div><div class="line">now.getMinutes(); <span class="comment">// 49, åˆ†é’Ÿ</span></div><div class="line">now.getSeconds(); <span class="comment">// 22, ç§’</span></div><div class="line">now.getMilliseconds(); <span class="comment">// 875, æ¯«ç§’æ•°</span></div><div class="line">now.getTime(); <span class="comment">// 1435146562875, ä»¥numberå½¢å¼è¡¨ç¤ºçš„æ—¶é—´æˆ³</span></div></pre></td></tr></table></figure></p>
<p>å¦‚æœè¦åˆ›å»ºä¸€ä¸ªæŒ‡å®šæ—¥æœŸå’Œæ—¶é—´çš„Dateå¯¹è±¡ï¼Œå¯ä»¥ç”¨ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">30</span>, <span class="number">123</span>);</div><div class="line">d; <span class="comment">// Fri Jun 19 2015 20:15:30 GMT+0800 (CST)</span></div></pre></td></tr></table></figure></p>
<p>ä¸€ä¸ªéå¸¸éå¸¸å‘çˆ¹çš„åœ°æ–¹ï¼Œå°±æ˜¯JavaScriptçš„æœˆä»½èŒƒå›´ç”¨æ•´æ•°è¡¨ç¤ºæ˜¯<code>0~11</code>ï¼Œ<code>0</code>è¡¨ç¤ºä¸€æœˆï¼Œ<code>1</code>è¡¨ç¤ºäºŒæœˆâ€¦â€¦ï¼Œæ‰€ä»¥è¦è¡¨ç¤º<code>6</code>æœˆï¼Œæˆ‘ä»¬ä¼ å…¥çš„æ˜¯<code>5</code>ï¼</p>
<p>ç¬¬äºŒç§åˆ›å»ºä¸€ä¸ªæŒ‡å®šæ—¥æœŸå’Œæ—¶é—´çš„æ–¹æ³•æ˜¯è§£æä¸€ä¸ªç¬¦åˆISO 8601æ ¼å¼çš„å­—ç¬¦ä¸²ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> d = <span class="built_in">Date</span>.parse(<span class="string">'2015-06-24T19:49:22.875+08:00'</span>);</div><div class="line">d; <span class="comment">// 1435146562875</span></div></pre></td></tr></table></figure></p>
<p>ä½†å®ƒè¿”å›çš„ä¸æ˜¯<code>Date</code>å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ª<strong>æ—¶é—´æˆ³</strong>ã€‚ä¸è¿‡æœ‰æ—¶é—´æˆ³å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°æŠŠå®ƒè½¬æ¢ä¸ºä¸€ä¸ª<code>Date</code>ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">1435146562875</span>);</div><div class="line">d; <span class="comment">// Wed Jun 24 2015 19:49:22 GMT+0800 (CST)</span></div></pre></td></tr></table></figure></p>
<p>æ—¶é—´æˆ³æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿæ—¶é—´æˆ³æ˜¯ä¸€ä¸ªè‡ªå¢çš„æ•´æ•°ï¼Œå®ƒè¡¨ç¤ºä»1970å¹´1æœˆ1æ—¥é›¶æ—¶æ•´çš„GMTæ—¶åŒºå¼€å§‹çš„é‚£ä¸€åˆ»ï¼Œåˆ°ç°åœ¨çš„æ¯«ç§’æ•°ã€‚å‡è®¾æµè§ˆå™¨æ‰€åœ¨ç”µè„‘çš„æ—¶é—´æ˜¯å‡†ç¡®çš„ï¼Œé‚£ä¹ˆä¸–ç•Œä¸Šæ— è®ºå“ªä¸ªæ—¶åŒºçš„ç”µè„‘ï¼Œå®ƒä»¬æ­¤åˆ»äº§ç”Ÿçš„æ—¶é—´æˆ³æ•°å­—éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ï¼Œæ—¶é—´æˆ³å¯ä»¥ç²¾ç¡®åœ°è¡¨ç¤ºä¸€ä¸ªæ—¶åˆ»ï¼Œå¹¶ä¸”ä¸æ—¶åŒºæ— å…³ã€‚</p>
<p>è¦è·å–å½“å‰æ—¶é—´æˆ³ï¼Œå¯ä»¥ç”¨ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="built_in">Date</span>.now) &#123;</div><div class="line">    alert(<span class="built_in">Date</span>.now()); <span class="comment">// è€ç‰ˆæœ¬IEæ²¡æœ‰now()æ–¹æ³•</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    alert(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime());</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Json"><a href="#Json" class="headerlink" title="Json"></a>Json</h3><p>JSONï¼ˆJavaScript Object Notationï¼‰å®é™…ä¸Šæ˜¯JavaScriptçš„ä¸€ä¸ªå­é›†ã€‚åœ¨JSONä¸­ï¼Œä¸€å…±å°±è¿™ä¹ˆå‡ ç§æ•°æ®ç±»å‹ï¼š</p>
<ul>
<li>numberï¼šå’ŒJavaScriptçš„<code>number</code>å®Œå…¨ä¸€è‡´ï¼›</li>
<li>booleanï¼šå°±æ˜¯JavaScriptçš„<code>true</code>æˆ–<code>false</code>ï¼›</li>
<li>stringï¼šå°±æ˜¯JavaScriptçš„<code>string</code>ï¼›</li>
<li>nullï¼šå°±æ˜¯JavaScriptçš„<code>null</code>ï¼›</li>
<li>arrayï¼šå°±æ˜¯JavaScriptçš„<code>Array</code>è¡¨ç¤ºæ–¹å¼â€”â€”<code>[]</code>ï¼›</li>
<li>objectï¼šå°±æ˜¯JavaScriptçš„<code>{ ... }</code>è¡¨ç¤ºæ–¹å¼ã€‚</li>
</ul>
<h4 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h4><p>å…ˆæŠŠå°æ˜è¿™ä¸ªå¯¹è±¡åºåˆ—åŒ–æˆJSONæ ¼å¼çš„å­—ç¬¦ä¸²ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xiaoming = &#123;</div><div class="line">    name: <span class="string">'å°æ˜'</span>,</div><div class="line">    age: <span class="number">14</span>,</div><div class="line">    gender: <span class="literal">true</span>,</div><div class="line">    height: <span class="number">1.65</span>,</div><div class="line">    grade: <span class="literal">null</span>,</div><div class="line">    <span class="string">'middle-school'</span>: <span class="string">'\"W3C\" Middle School'</span>,</div><div class="line">    skills: [<span class="string">'JavaScript'</span>, <span class="string">'Java'</span>, <span class="string">'Python'</span>, <span class="string">'Lisp'</span>]</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">JSON</span>.stringify(xiaoming); <span class="comment">// '&#123;"name":"å°æ˜","age":14,"gender":true,"height":1.65,"grade":null,"middle-school":"\"W3C\" Middle School","skills":["JavaScript","Java","Python","Lisp"]&#125;'</span></div></pre></td></tr></table></figure></p>
<p>è¦è¾“å‡ºå¾—å¥½çœ‹ä¸€äº›ï¼Œå¯ä»¥åŠ ä¸Šå‚æ•°ï¼ŒæŒ‰ç¼©è¿›è¾“å‡ºï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">JSON</span>.stringify(xiaoming, <span class="literal">null</span>, <span class="string">'  '</span>);</div></pre></td></tr></table></figure></p>
<p>ç»“æœï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"name"</span>: <span class="string">"å°æ˜"</span>,</div><div class="line">  <span class="string">"age"</span>: <span class="number">14</span>,</div><div class="line">  <span class="string">"gender"</span>: <span class="literal">true</span>,</div><div class="line">  <span class="string">"height"</span>: <span class="number">1.65</span>,</div><div class="line">  <span class="string">"grade"</span>: <span class="literal">null</span>,</div><div class="line">  <span class="string">"middle-school"</span>: <span class="string">"\"W3C\" Middle School"</span>,</div><div class="line">  <span class="string">"skills"</span>: [</div><div class="line">    <span class="string">"JavaScript"</span>,</div><div class="line">    <span class="string">"Java"</span>,</div><div class="line">    <span class="string">"Python"</span>,</div><div class="line">    <span class="string">"Lisp"</span></div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç¬¬äºŒä¸ªå‚æ•°ç”¨äºæ§åˆ¶å¦‚ä½•ç­›é€‰å¯¹è±¡çš„é”®å€¼ï¼Œå¦‚æœæˆ‘ä»¬åªæƒ³è¾“å‡ºæŒ‡å®šçš„å±æ€§ï¼Œå¯ä»¥ä¼ å…¥<code>Array</code>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">JSON.stringify(xiaoming, [&apos;name&apos;, &apos;skills&apos;], &apos;  &apos;);</div></pre></td></tr></table></figure></p>
<p>ç»“æœ:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"name"</span>: <span class="string">"å°æ˜"</span>,</div><div class="line">  <span class="string">"skills"</span>: [</div><div class="line">    <span class="string">"JavaScript"</span>,</div><div class="line">    <span class="string">"Java"</span>,</div><div class="line">    <span class="string">"Python"</span>,</div><div class="line">    <span class="string">"Lisp"</span></div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿˜å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ ·å¯¹è±¡çš„æ¯ä¸ªé”®å€¼å¯¹éƒ½ä¼šè¢«å‡½æ•°å…ˆå¤„ç†ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">convert</span>(<span class="params">key, value</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">'string'</span>) &#123;</div><div class="line">        <span class="keyword">return</span> value.toUpperCase();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> value;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">JSON</span>.stringify(xiaoming, convert, <span class="string">'  '</span>);</div></pre></td></tr></table></figure></p>
<p>ä¸Šé¢çš„ä»£ç æŠŠæ‰€æœ‰å±æ€§å€¼éƒ½å˜æˆå¤§å†™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"name"</span>: <span class="string">"å°æ˜"</span>,</div><div class="line">  <span class="string">"age"</span>: <span class="number">14</span>,</div><div class="line">  <span class="string">"gender"</span>: <span class="literal">true</span>,</div><div class="line">  <span class="string">"height"</span>: <span class="number">1.65</span>,</div><div class="line">  <span class="string">"grade"</span>: <span class="literal">null</span>,</div><div class="line">  <span class="string">"middle-school"</span>: <span class="string">"\"W3C\" MIDDLE SCHOOL"</span>,</div><div class="line">  <span class="string">"skills"</span>: [</div><div class="line">    <span class="string">"JAVASCRIPT"</span>,</div><div class="line">    <span class="string">"JAVA"</span>,</div><div class="line">    <span class="string">"PYTHON"</span>,</div><div class="line">    <span class="string">"LISP"</span></div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬è¿˜æƒ³è¦ç²¾ç¡®æ§åˆ¶å¦‚ä½•åºåˆ—åŒ–å°æ˜ï¼Œå¯ä»¥ç»™<code>xiaoming</code>å®šä¹‰ä¸€ä¸ª<code>toJSON()</code>çš„æ–¹æ³•ï¼Œç›´æ¥è¿”å›JSONåº”è¯¥åºåˆ—åŒ–çš„æ•°æ®ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xiaoming = &#123;</div><div class="line">    name: <span class="string">'å°æ˜'</span>,</div><div class="line">    age: <span class="number">14</span>,</div><div class="line">    gender: <span class="literal">true</span>,</div><div class="line">    height: <span class="number">1.65</span>,</div><div class="line">    grade: <span class="literal">null</span>,</div><div class="line">    <span class="string">'middle-school'</span>: <span class="string">'\"W3C\" Middle School'</span>,</div><div class="line">    skills: [<span class="string">'JavaScript'</span>, <span class="string">'Java'</span>, <span class="string">'Python'</span>, <span class="string">'Lisp'</span>],</div><div class="line">    toJSON: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> &#123; <span class="comment">// åªè¾“å‡ºnameå’Œageï¼Œå¹¶ä¸”æ”¹å˜äº†keyï¼š</span></div><div class="line">            <span class="string">'Name'</span>: <span class="keyword">this</span>.name,</div><div class="line">            <span class="string">'Age'</span>: <span class="keyword">this</span>.age</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">JSON</span>.stringify(xiaoming); <span class="comment">// '&#123;"Name":"å°æ˜","Age":14&#125;'</span></div></pre></td></tr></table></figure></p>
<h4 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h4><p>æ‹¿åˆ°ä¸€ä¸ªJSONæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨<code>JSON.parse()</code>æŠŠå®ƒå˜æˆä¸€ä¸ªJavaScriptå¯¹è±¡ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">JSON</span>.parse(<span class="string">'[1,2,3,true]'</span>); <span class="comment">// [1, 2, 3, true]</span></div><div class="line"><span class="built_in">JSON</span>.parse(<span class="string">'&#123;"name":"å°æ˜","age":14&#125;'</span>); <span class="comment">// Object &#123;name: 'å°æ˜', age: 14&#125;</span></div><div class="line"><span class="built_in">JSON</span>.parse(<span class="string">'true'</span>); <span class="comment">// true</span></div><div class="line"><span class="built_in">JSON</span>.parse(<span class="string">'123.45'</span>); <span class="comment">// 123.45</span></div></pre></td></tr></table></figure></p>
<p><code>JSON.parse()</code>è¿˜å¯ä»¥æ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥è½¬æ¢è§£æå‡ºçš„å±æ€§ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">JSON</span>.parse(<span class="string">'&#123;"name":"å°æ˜","age":14&#125;'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">key, value</span>) </span>&#123;</div><div class="line">    <span class="comment">// æŠŠnumber * 2:</span></div><div class="line">    <span class="keyword">if</span> (key === <span class="string">'name'</span>) &#123;</div><div class="line">        <span class="keyword">return</span> value + <span class="string">'åŒå­¦'</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> value;</div><div class="line">&#125;); <span class="comment">// Object &#123;name: 'å°æ˜åŒå­¦', age: 14&#125;</span></div></pre></td></tr></table></figure></p>
<h2 id="é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>é¢å‘å¯¹è±¡ç¼–ç¨‹</h2><p>JavaScriptä¸åŒºåˆ†ç±»å’Œå®ä¾‹çš„æ¦‚å¿µï¼Œè€Œæ˜¯é€šè¿‡åŸå‹ï¼ˆprototypeï¼‰æ¥å®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚</p>
<p>prototypeæœ‰ç‚¹ç±»ä¼¼äºç»§æ‰¿ï¼Œ<code>A</code>çš„åŸå‹æ˜¯<code>B</code>ï¼Œæ„å‘³ç€ï¼Œ<code>A</code>æ‹¥æœ‰<code>B</code>çš„å…¨éƒ¨å±æ€§ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åŸå‹å¯¹è±¡:</span></div><div class="line"><span class="keyword">var</span> Student = &#123;</div><div class="line">    name: <span class="string">'Robot'</span>,</div><div class="line">    height: <span class="number">1.2</span>,</div><div class="line">    run: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name + <span class="string">' is running...'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createStudent</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">    <span class="comment">// åŸºäºStudentåŸå‹åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡:</span></div><div class="line">    <span class="keyword">var</span> s = <span class="built_in">Object</span>.create(Student);</div><div class="line">    <span class="comment">// åˆå§‹åŒ–æ–°å¯¹è±¡:</span></div><div class="line">    s.name = name;</div><div class="line">    <span class="keyword">return</span> s;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> xiaoming = createStudent(<span class="string">'å°æ˜'</span>);</div><div class="line">xiaoming.run(); <span class="comment">// å°æ˜ is running...</span></div><div class="line">xiaoming.__proto__ === Student; <span class="comment">// true</span></div></pre></td></tr></table></figure></p>
<h3 id="åˆ›å»ºå¯¹è±¡"><a href="#åˆ›å»ºå¯¹è±¡" class="headerlink" title="åˆ›å»ºå¯¹è±¡"></a>åˆ›å»ºå¯¹è±¡</h3><p>JavaScriptå¯¹æ¯ä¸ªåˆ›å»ºçš„å¯¹è±¡éƒ½ä¼šè®¾ç½®ä¸€ä¸ªåŸå‹ï¼ŒæŒ‡å‘å®ƒçš„åŸå‹å¯¹è±¡ã€‚å½“æˆ‘ä»¬ç”¨<code>obj.xxx</code>è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼ŒJavaScriptå¼•æ“å…ˆåœ¨å½“å‰å¯¹è±¡ä¸ŠæŸ¥æ‰¾è¯¥å±æ€§ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±åˆ°å…¶åŸå‹å¯¹è±¡ä¸Šæ‰¾ï¼Œå¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä¸€ç›´ä¸Šæº¯åˆ°<code>Object.prototype</code>å¯¹è±¡ï¼Œæœ€åï¼Œå¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±åªèƒ½è¿”å›<code>undefined</code>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ª<code>Array</code>å¯¹è±¡ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div></pre></td></tr></table></figure></p>
<p>å…¶åŸå‹é“¾æ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">arr ----&gt; <span class="built_in">Array</span>.prototype ----&gt; <span class="built_in">Object</span>.prototype ----&gt; <span class="literal">null</span></div></pre></td></tr></table></figure></p>
<p><code>Array.prototype</code>å®šä¹‰äº†<code>indexOf()</code>ã€<code>shift()</code>ç­‰æ–¹æ³•ï¼Œå› æ­¤ä½ å¯ä»¥åœ¨æ‰€æœ‰çš„<code>Array</code>å¯¹è±¡ä¸Šç›´æ¥è°ƒç”¨è¿™äº›æ–¹æ³•ã€‚</p>
<p>å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°æ—¶ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„åŸå‹é“¾æ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">foo ----&gt; <span class="built_in">Function</span>.prototype ----&gt; <span class="built_in">Object</span>.prototype ----&gt; <span class="literal">null</span></div></pre></td></tr></table></figure></p>
<p>ç”±äº<code>Function.prototype</code>å®šä¹‰äº†<code>apply()</code>ç­‰æ–¹æ³•ï¼Œå› æ­¤ï¼Œæ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥è°ƒç”¨<code>apply()</code>æ–¹æ³•ã€‚</p>
<h4 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h4><p>é™¤äº†ç›´æ¥ç”¨<code>{ ... }</code>åˆ›å»ºä¸€ä¸ªå¯¹è±¡å¤–ï¼ŒJavaScriptè¿˜å¯ä»¥ç”¨ä¸€ç§æ„é€ å‡½æ•°çš„æ–¹æ³•æ¥åˆ›å»ºå¯¹è±¡ã€‚å®ƒçš„ç”¨æ³•æ˜¯ï¼Œå…ˆå®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">    <span class="keyword">this</span>.hello = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        alert(<span class="string">'Hello, '</span> + <span class="keyword">this</span>.name + <span class="string">'!'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åœ¨JavaScriptä¸­ï¼Œå¯ä»¥ç”¨å…³é”®å­—<code>new</code>æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xiaoming = <span class="keyword">new</span> Student(<span class="string">'å°æ˜'</span>);</div><div class="line">xiaoming.name; <span class="comment">// 'å°æ˜'</span></div><div class="line">xiaoming.hello(); <span class="comment">// Hello, å°æ˜!</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼Œå¦‚æœä¸å†™<code>new</code>ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œå®ƒè¿”å›<code>undefined</code>ã€‚ä½†æ˜¯ï¼Œå¦‚æœå†™äº†<code>new</code>ï¼Œå®ƒå°±å˜æˆäº†ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒç»‘å®šçš„<code>this</code>æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œå¹¶é»˜è®¤è¿”å›<code>this</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸éœ€è¦åœ¨æœ€åå†™<code>return this;</code>ã€‚</p>
<p>ç”¨<code>new Student()</code>åˆ›å»ºçš„å¯¹è±¡è¿˜ä»åŸå‹ä¸Šè·å¾—äº†ä¸€ä¸ª<code>constructor</code>å±æ€§ï¼Œå®ƒæŒ‡å‘å‡½æ•°<code>Student</code>æœ¬èº«ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">xiaoming.constructor === Student.prototype.constructor; <span class="comment">// true</span></div><div class="line">Student.prototype.constructor === Student; <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getPrototypeOf(xiaoming) === Student.prototype; <span class="comment">// true</span></div><div class="line"></div><div class="line">xiaoming <span class="keyword">instanceof</span> Student; <span class="comment">// true</span></div></pre></td></tr></table></figure></p>
<p>ä»–ä»¬ä¹‹é—´çš„å…³ç³»å°±æ˜¯:<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/js_constructor.png?raw=true" alt="constructor"></p>
<p>çº¢è‰²ç®­å¤´æ˜¯åŸå‹é“¾ã€‚æ³¨æ„ï¼Œ<code>Student.prototype</code>æŒ‡å‘çš„å¯¹è±¡å°±æ˜¯<code>xiaoming</code>ã€<code>xiaohong</code>çš„åŸå‹å¯¹è±¡ï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡è‡ªå·±è¿˜æœ‰ä¸ªå±æ€§<code>constructor</code>ï¼ŒæŒ‡å‘<code>Student</code>å‡½æ•°æœ¬èº«ã€‚</p>
<p>å¦å¤–ï¼Œå‡½æ•°<code>Student</code>æ°å¥½æœ‰ä¸ªå±æ€§<code>prototype</code>æŒ‡å‘<code>xiaoming</code>ã€<code>xiaohong</code>çš„åŸå‹å¯¹è±¡ï¼Œä½†æ˜¯<code>xiaoming</code>ã€<code>xiaohong</code>è¿™äº›å¯¹è±¡å¯æ²¡æœ‰<code>prototype</code>è¿™ä¸ªå±æ€§ï¼Œä¸è¿‡å¯ä»¥ç”¨<code>__proto__</code>è¿™ä¸ªéæ ‡å‡†ç”¨æ³•æ¥æŸ¥çœ‹ã€‚</p>
<p>ä¸è¿‡è¿˜æœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œæ³¨æ„è§‚å¯Ÿï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">xiaoming.name; <span class="comment">// 'å°æ˜'</span></div><div class="line">xiaohong.name; <span class="comment">// 'å°çº¢'</span></div><div class="line">xiaoming.hello; <span class="comment">// function: Student.hello()</span></div><div class="line">xiaohong.hello; <span class="comment">// function: Student.hello()</span></div><div class="line">xiaoming.hello === xiaohong.hello; <span class="comment">// false</span></div></pre></td></tr></table></figure></p>
<p><code>xiaoming</code>å’Œ<code>xiaohong</code>å„è‡ªçš„<code>hello</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä½†å®ƒä»¬æ˜¯ä¸¤ä¸ªä¸åŒçš„å‡½æ•°ï¼Œè™½ç„¶å‡½æ•°åç§°å’Œä»£ç éƒ½æ˜¯ç›¸åŒçš„ï¼</p>
<p>å¦‚æœæˆ‘ä»¬é€šè¿‡<code>new Student()</code>åˆ›å»ºäº†å¾ˆå¤šå¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡çš„<code>hello</code>å‡½æ•°å®é™…ä¸Šåªéœ€è¦å…±äº«åŒä¸€ä¸ªå‡½æ•°å°±å¯ä»¥äº†ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœå¾ˆå¤šå†…å­˜ã€‚<br>è¦è®©åˆ›å»ºçš„å¯¹è±¡å…±äº«ä¸€ä¸ª<code>hello</code>å‡½æ•°ï¼Œæ ¹æ®å¯¹è±¡çš„å±æ€§æŸ¥æ‰¾åŸåˆ™ï¼Œæˆ‘ä»¬åªè¦æŠŠ<code>hello</code>å‡½æ•°ç§»åŠ¨åˆ°<code>xiaoming</code>ã€<code>xiaohong</code>è¿™äº›å¯¹è±¡å…±åŒçš„åŸå‹ä¸Šå°±å¯ä»¥äº†ï¼Œä¹Ÿå°±æ˜¯<code>Student.prototype</code>ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/js_constructor2.png?raw=true" alt="constructor2"><br>ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Student.prototype.hello = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    alert(<span class="string">'Hello, '</span> + <span class="keyword">this</span>.name + <span class="string">'!'</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="classç»§æ‰¿"><a href="#classç»§æ‰¿" class="headerlink" title="classç»§æ‰¿"></a>classç»§æ‰¿</h3><p>æ–°çš„å…³é”®å­—<code>class</code>ä»ES6å¼€å§‹æ­£å¼è¢«å¼•å…¥åˆ°JavaScriptä¸­ã€‚<code>class</code>çš„ç›®çš„å°±æ˜¯è®©å®šä¹‰ç±»æ›´ç®€å•ã€‚</p>
<p>æˆ‘ä»¬å…ˆå›é¡¾ç”¨å‡½æ•°å®ç°<code>Student</code>çš„æ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function Student(name) &#123;</div><div class="line">    this.name = name;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Student.prototype.hello = function () &#123;</div><div class="line">    alert(&apos;Hello, &apos; + this.name + &apos;!&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¦‚æœç”¨æ–°çš„<code>class</code>å…³é”®å­—æ¥ç¼–å†™<code>Student</code>ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(name) &#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    hello() &#123;</div><div class="line">        alert(<span class="string">'Hello, '</span> + <span class="keyword">this</span>.name + <span class="string">'!'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ¯”è¾ƒä¸€ä¸‹å°±å¯ä»¥å‘ç°ï¼Œ<code>class</code>çš„å®šä¹‰åŒ…å«äº†<strong>æ„é€ å‡½æ•°</strong><code>constructor</code>å’Œå®šä¹‰åœ¨åŸå‹å¯¹è±¡ä¸Šçš„å‡½æ•°<code>hello()</code>ï¼ˆæ³¨æ„æ²¡æœ‰<code>function</code>å…³é”®å­—ï¼‰ï¼Œè¿™æ ·å°±é¿å…äº†<code>Student.prototype.hello = function () {...}</code>è¿™æ ·åˆ†æ•£çš„ä»£ç ã€‚</p>
<p>æœ€åï¼Œåˆ›å»ºä¸€ä¸ªStudentå¯¹è±¡ä»£ç å’Œå‰é¢ç« èŠ‚å®Œå…¨ä¸€æ ·ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> xiaoming = <span class="keyword">new</span> Student(<span class="string">'å°æ˜'</span>);</div><div class="line">xiaoming.hello();</div></pre></td></tr></table></figure></p>
<h4 id="classç»§æ‰¿-1"><a href="#classç»§æ‰¿-1" class="headerlink" title="classç»§æ‰¿"></a>classç»§æ‰¿</h4><p>ç”¨<code>class</code>å®šä¹‰å¯¹è±¡çš„å¦ä¸€ä¸ªå·¨å¤§çš„å¥½å¤„æ˜¯ç»§æ‰¿æ›´æ–¹ä¾¿äº†,ç›´æ¥é€šè¿‡<code>extends</code>æ¥å®ç°ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PrimaryStudent</span> <span class="keyword">extends</span> <span class="title">Student</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(name, grade) &#123;</div><div class="line">        <span class="keyword">super</span>(name); <span class="comment">// è®°å¾—ç”¨superè°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•!</span></div><div class="line">        <span class="keyword">this</span>.grade = grade;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    myGrade() &#123;</div><div class="line">        alert(<span class="string">'I am at grade '</span> + <span class="keyword">this</span>.grade);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡<code>super(name)</code>æ¥è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚<code>PrimaryStudent</code>å·²ç»è‡ªåŠ¨è·å¾—äº†çˆ¶ç±»<code>Student</code>çš„<code>hello</code>æ–¹æ³•ï¼Œæˆ‘ä»¬åˆåœ¨å­ç±»ä¸­å®šä¹‰äº†æ–°çš„<code>myGrade</code>æ–¹æ³•ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[NSLayoutConstraint å­¦ä¹ ç¬”è®°]]></title>
      <url>http://zhang759740844.github.io/2016/09/08/NSLayoutConstraint/</url>
      <content type="html"><![CDATA[<p><code>AutoLayout</code>æ˜¯ä¸€ç§åŸºäºçº¦æŸçš„ï¼Œæè¿°æ€§çš„å¸ƒå±€ç³»ç»Ÿã€‚å‚è€ƒäº†ç½‘ä¸Šçš„è®¸å¤šæ–‡ç« ï¼Œè¿›è¡Œæ€»ç»“ã€‚åŸºæœ¬è¿˜æ˜¯ä»¥ios6ä¸ºä¸»ï¼Œios8çš„ä¸€äº›ç‰¹æ€§å¹¶æ²¡æœ‰ä»”ç»†ç ”ç©¶ã€‚ä»¥åéœ€è¦ç”¨åˆ°å†è¯´ã€‚<br>å‚è€ƒä¸<a href="http://www.jianshu.com/p/79f92139ffdf" target="_blank" rel="external">AutoLayoutè¯¦è§£</a></p>
<a id="more"></a>
<h2 id="ä»£ç æ·»åŠ AutoLayout"><a href="#ä»£ç æ·»åŠ AutoLayout" class="headerlink" title="ä»£ç æ·»åŠ AutoLayout"></a>ä»£ç æ·»åŠ AutoLayout</h2><h3 id="å…³é—­Autoresizing"><a href="#å…³é—­Autoresizing" class="headerlink" title="å…³é—­Autoresizing"></a>å…³é—­Autoresizing</h3><p><code>AutoLayout</code>æ—¨åœ¨æ›¿ä»£<code>Autoresizing</code>ï¼Œæ‰€ä»¥åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œ<code>AutoLayout</code>å’Œ<code>Autoresizing</code>æ˜¯ä¸èƒ½å…±å­˜çš„ã€‚è¦å®ç°è‡ªåŠ¨å¸ƒå±€ï¼Œå¿…é¡»å…³æ‰viewçš„<code>AutoresizeingMask</code></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">view.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„viewæŒ‡çš„æ˜¯éœ€è¦æ·»åŠ çº¦æŸçš„viewã€‚</p>
<h3 id="NSLayoutConstraintç›¸å…³"><a href="#NSLayoutConstraintç›¸å…³" class="headerlink" title="NSLayoutConstraintç›¸å…³"></a>NSLayoutConstraintç›¸å…³</h3><h4 id="çº¦æŸæ–¹æ³•"><a href="#çº¦æŸæ–¹æ³•" class="headerlink" title="çº¦æŸæ–¹æ³•"></a>çº¦æŸæ–¹æ³•</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">+(<span class="keyword">instancetype</span>)constraintWithItem:(<span class="keyword">id</span>)view1                  <span class="comment">//è¢«çº¦æŸçš„è§†å›¾ä¸€</span></div><div class="line">                        attribute:(<span class="built_in">NSLayoutAttribute</span>)attr1   <span class="comment">//view1çš„å±æ€§</span></div><div class="line">                        relatedBy:(<span class="built_in">NSLayoutRelation</span>)relation <span class="comment">//å·¦å³è§†å›¾çš„å…³ç³»</span></div><div class="line">                           toItem:(<span class="keyword">id</span>)view2                  <span class="comment">//è¢«çº¦æŸçš„è§†å›¾äºŒ</span></div><div class="line">                        attribute:(<span class="built_in">NSLayoutAttribute</span>)attr2   <span class="comment">//view2çš„å±æ€§</span></div><div class="line">                       multiplier:(<span class="built_in">CGFloat</span>)multiplier        <span class="comment">//ä¹˜æ•°</span></div><div class="line">                         constant:(<span class="built_in">CGFloat</span>)c;                <span class="comment">//å¸¸é‡</span></div></pre></td></tr></table></figure>
<p>å…¬å¼æ˜¯è¿™æ ·çš„ï¼š<code>view1.attr1 = view2.attr2 * multiplier + constant</code></p>
<h4 id="NSLayoutAttributeå±æ€§"><a href="#NSLayoutAttributeå±æ€§" class="headerlink" title="NSLayoutAttributeå±æ€§"></a>NSLayoutAttributeå±æ€§</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">NSLayoutAttribute</span>) &#123;</div><div class="line">    <span class="built_in">NSLayoutAttributeLeft</span> = <span class="number">1</span>, <span class="comment">//å·¦è¾¹</span></div><div class="line">    <span class="built_in">NSLayoutAttributeRight</span>,    <span class="comment">//å³è¾¹</span></div><div class="line">    <span class="built_in">NSLayoutAttributeTop</span>,      <span class="comment">//é¡¶éƒ¨</span></div><div class="line">    <span class="built_in">NSLayoutAttributeBottom</span>,   <span class="comment">//åº•éƒ¨</span></div><div class="line">    <span class="built_in">NSLayoutAttributeLeading</span>,  <span class="comment">//é¦–éƒ¨</span></div><div class="line">    <span class="built_in">NSLayoutAttributeTrailing</span>, <span class="comment">//å°¾éƒ¨</span></div><div class="line">    <span class="built_in">NSLayoutAttributeWidth</span>,    <span class="comment">//å®½åº¦</span></div><div class="line">    <span class="built_in">NSLayoutAttributeHeight</span>,   <span class="comment">//é«˜åº¦</span></div><div class="line">    <span class="built_in">NSLayoutAttributeCenterX</span>,  <span class="comment">//Xè½´ä¸­å¿ƒ</span></div><div class="line">    <span class="built_in">NSLayoutAttributeCenterY</span>,  <span class="comment">//Yè½´ä¸­å¿ƒ</span></div><div class="line">    <span class="built_in">NSLayoutAttributeBaseline</span>, <span class="comment">//åŸºçº¿</span></div><div class="line">    <span class="built_in">NSLayoutAttributeLastBaseline</span> = <span class="built_in">NSLayoutAttributeBaseline</span>,</div><div class="line">    <span class="built_in">NSLayoutAttributeFirstBaseline</span> <span class="built_in">NS_ENUM_AVAILABLE_IOS</span>(<span class="number">8</span>_0),</div><div class="line"></div><div class="line">    <span class="comment">//iOS8çš„æš‚æ—¶æ²¡æœ‰ç ”ç©¶</span></div><div class="line">    <span class="built_in">NSLayoutAttributeLeftMargin</span> <span class="built_in">NS_ENUM_AVAILABLE_IOS</span>(<span class="number">8</span>_0),</div><div class="line">    <span class="built_in">NSLayoutAttributeRightMargin</span> <span class="built_in">NS_ENUM_AVAILABLE_IOS</span>(<span class="number">8</span>_0),</div><div class="line">    <span class="built_in">NSLayoutAttributeTopMargin</span> <span class="built_in">NS_ENUM_AVAILABLE_IOS</span>(<span class="number">8</span>_0),</div><div class="line">    <span class="built_in">NSLayoutAttributeBottomMargin</span> <span class="built_in">NS_ENUM_AVAILABLE_IOS</span>(<span class="number">8</span>_0),</div><div class="line">    <span class="built_in">NSLayoutAttributeLeadingMargin</span> <span class="built_in">NS_ENUM_AVAILABLE_IOS</span>(<span class="number">8</span>_0),</div><div class="line">    <span class="built_in">NSLayoutAttributeTrailingMargin</span> <span class="built_in">NS_ENUM_AVAILABLE_IOS</span>(<span class="number">8</span>_0),</div><div class="line">    <span class="built_in">NSLayoutAttributeCenterXWithinMargins</span> <span class="built_in">NS_ENUM_AVAILABLE_IOS</span>(<span class="number">8</span>_0),</div><div class="line">    <span class="built_in">NSLayoutAttributeCenterYWithinMargins</span> <span class="built_in">NS_ENUM_AVAILABLE_IOS</span>(<span class="number">8</span>_0),</div><div class="line"></div><div class="line">    <span class="built_in">NSLayoutAttributeNotAnAttribute</span> = <span class="number">0</span> <span class="comment">//æ— å±æ€§</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h4 id="NSLayoutRelationå…³ç³»"><a href="#NSLayoutRelationå…³ç³»" class="headerlink" title="NSLayoutRelationå…³ç³»"></a>NSLayoutRelationå…³ç³»</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">NSLayoutRelation</span>) &#123;</div><div class="line">    <span class="built_in">NSLayoutRelationLessThanOrEqual</span> = <span class="number">-1</span>,   <span class="comment">//å°äºç­‰äº</span></div><div class="line">    <span class="built_in">NSLayoutRelationEqual</span> = <span class="number">0</span>,              <span class="comment">//ç­‰äº</span></div><div class="line">    <span class="built_in">NSLayoutRelationGreaterThanOrEqual</span> = <span class="number">1</span>, <span class="comment">//å¤§äºç­‰äº</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºview"><a href="#åˆ›å»ºview" class="headerlink" title="åˆ›å»ºview"></a>åˆ›å»ºview</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ›å»ºview</span></div><div class="line"><span class="built_in">UIView</span> *view = [[<span class="built_in">UIView</span> alloc] init]; <span class="comment">//è¿™é‡Œä¸éœ€è¦è®¾ç½®frame</span></div><div class="line">view.backgroundColor = [<span class="built_in">UIColor</span> brownColor];</div><div class="line">view.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>; <span class="comment">//è¦å®ç°è‡ªåŠ¨å¸ƒå±€ï¼Œå¿…é¡»æŠŠè¯¥å±æ€§è®¾ç½®ä¸ºNO</span></div><div class="line">[<span class="keyword">self</span>.view addSubview:view];</div><div class="line"></div><div class="line"><span class="comment">//æ·»åŠ çº¦æŸ</span></div><div class="line">[<span class="keyword">self</span>.view addConstraint:</div><div class="line"> [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:view</div><div class="line">                              attribute:<span class="built_in">NSLayoutAttributeLeft</span></div><div class="line">                              relatedBy:<span class="built_in">NSLayoutRelationEqual</span></div><div class="line">                                 toItem:<span class="keyword">self</span>.view</div><div class="line">                              attribute:<span class="built_in">NSLayoutAttributeLeft</span></div><div class="line">                             multiplier:<span class="number">1</span></div><div class="line">                               constant:<span class="number">20</span>]];</div><div class="line">[<span class="keyword">self</span>.view addConstraint:</div><div class="line"> [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:view</div><div class="line">                              attribute:<span class="built_in">NSLayoutAttributeRight</span></div><div class="line">                              relatedBy:<span class="built_in">NSLayoutRelationEqual</span></div><div class="line">                                 toItem:<span class="keyword">self</span>.view</div><div class="line">                              attribute:<span class="built_in">NSLayoutAttributeRight</span></div><div class="line">                             multiplier:<span class="number">1</span></div><div class="line">                               constant:<span class="number">-10</span>]];</div><div class="line">[<span class="keyword">self</span>.view addConstraint:</div><div class="line"> [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:view</div><div class="line">                              attribute:<span class="built_in">NSLayoutAttributeTop</span></div><div class="line">                              relatedBy:<span class="built_in">NSLayoutRelationEqual</span></div><div class="line">                                 toItem:<span class="keyword">self</span>.view</div><div class="line">                              attribute:<span class="built_in">NSLayoutAttributeTop</span></div><div class="line">                             multiplier:<span class="number">1</span></div><div class="line">                               constant:<span class="number">30</span>]];</div><div class="line">[<span class="keyword">self</span>.view addConstraint:</div><div class="line"> [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:view</div><div class="line">                              attribute:<span class="built_in">NSLayoutAttributeBottom</span></div><div class="line">                              relatedBy:<span class="built_in">NSLayoutRelationEqual</span></div><div class="line">                                 toItem:<span class="keyword">self</span>.view</div><div class="line">                              attribute:<span class="built_in">NSLayoutAttributeBottom</span></div><div class="line">                             multiplier:<span class="number">1</span></div><div class="line">                               constant:<span class="number">-20</span>]];</div></pre></td></tr></table></figure>
<h3 id="æ·»åŠ çº¦æŸçš„è§„åˆ™"><a href="#æ·»åŠ çº¦æŸçš„è§„åˆ™" class="headerlink" title="æ·»åŠ çº¦æŸçš„è§„åˆ™"></a>æ·»åŠ çº¦æŸçš„è§„åˆ™</h3><ul>
<li>å¯¹äºä¸¤ä¸ªåŒå±‚çº§viewä¹‹é—´çš„çº¦æŸå…³ç³»ï¼Œæ·»åŠ åˆ°å®ƒä»¬çš„çˆ¶viewä¸Š</li>
<li>å¯¹äºä¸¤ä¸ªä¸åŒå±‚çº§viewä¹‹é—´çš„çº¦æŸå…³ç³»ï¼Œæ·»åŠ åˆ°ä»–ä»¬æœ€è¿‘çš„å…±åŒçˆ¶viewä¸Š</li>
<li>å¯¹äºæœ‰å±‚æ¬¡å…³ç³»çš„ä¸¤ä¸ªviewä¹‹é—´çš„çº¦æŸå…³ç³»ï¼Œæ·»åŠ åˆ°å±‚æ¬¡è¾ƒé«˜çš„çˆ¶viewä¸Š</li>
</ul>
<h3 id="Autolayoutæ¥å®ç°åŠ¨ç”»åŠŸèƒ½"><a href="#Autolayoutæ¥å®ç°åŠ¨ç”»åŠŸèƒ½" class="headerlink" title="Autolayoutæ¥å®ç°åŠ¨ç”»åŠŸèƒ½"></a>Autolayoutæ¥å®ç°åŠ¨ç”»åŠŸèƒ½</h3><p>åœ¨æ‰§è¡ŒåŠ¨ç”»æ—¶è®°å¾—è°ƒç”¨ä¸€ä¸‹æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åœ¨ä¿®æ”¹äº†çº¦æŸä¹‹åï¼Œåªè¦æ‰§è¡Œä¸‹é¢ä»£ç ï¼Œå°±èƒ½åšåŠ¨ç”»æ•ˆæœ</span></div><div class="line">[<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.5</span> animations:^&#123;</div><div class="line">      [<span class="keyword">self</span>.view layoutIfNeeded];</div><div class="line">&#125;];</div></pre></td></tr></table></figure></p>
<h2 id="ç¬¬ä¸‰æ–¹æ¡†æ¶å®ç°AutoLayout"><a href="#ç¬¬ä¸‰æ–¹æ¡†æ¶å®ç°AutoLayout" class="headerlink" title="ç¬¬ä¸‰æ–¹æ¡†æ¶å®ç°AutoLayout"></a>ç¬¬ä¸‰æ–¹æ¡†æ¶å®ç°AutoLayout</h2><p>Masonryæ¡†æ¶æ˜¯ç›®å‰æœ€æµè¡Œçš„Autolayoutç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œç”¨ä¼˜é›…çš„ä»£ç æ–¹å¼ç¼–å†™Autolayoutï¼Œçœå»äº†è‹¹æœå®˜æ–¹æ¶å¿ƒçš„Autolayoutä»£ç ï¼Œå¤§å¤§æé«˜äº†å¼€å‘æ•ˆç‡ã€‚</p>
<h3 id="æ¡†æ¶å¯¼å…¥"><a href="#æ¡†æ¶å¯¼å…¥" class="headerlink" title="æ¡†æ¶å¯¼å…¥"></a>æ¡†æ¶å¯¼å…¥</h3><p>è¿™é‡Œå…ˆä»‹ç»ä¸‹iosçš„åŒ…ç®¡ç†å·¥å…·cocoaPodsï¼Œå¦‚ä½•ä¸‹è½½å®‰è£…å°±ä¸è¯´äº†ï¼Œä»‹ç»ä¸‹å¦‚ä½•ä½¿ç”¨ã€‚</p>
<h4 id="åˆ›å»ºPodfile"><a href="#åˆ›å»ºPodfile" class="headerlink" title="åˆ›å»ºPodfile"></a>åˆ›å»ºPodfile</h4><p>åœ¨å·¥ç¨‹çš„ç›®å½•ä¸‹æ–°å»ºPodfileæ–‡ä»¶ï¼Œå†™å…¥æˆ‘ä»¬éœ€è¦çš„ç¬¬ä¸‰æ–¹åº“ï¼š<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">target 'NSLayoutConstraintDemo' do</div><div class="line">pod 'Masonry'</div><div class="line">end</div></pre></td></tr></table></figure></p>
<h4 id="å¯¼å…¥ç¬¬ä¸‰æ–¹åº“"><a href="#å¯¼å…¥ç¬¬ä¸‰æ–¹åº“" class="headerlink" title="å¯¼å…¥ç¬¬ä¸‰æ–¹åº“"></a>å¯¼å…¥ç¬¬ä¸‰æ–¹åº“</h4><p>è¿›å…¥ç»ˆç«¯ï¼Œè¿è¡Œå‘½ä»¤<code>pod install</code>,å¯¼å…¥ç¬¬ä¸‰æ–¹åº“ã€‚</p>
<h3 id="MasonryåŸºæœ¬ä½¿ç”¨"><a href="#MasonryåŸºæœ¬ä½¿ç”¨" class="headerlink" title="MasonryåŸºæœ¬ä½¿ç”¨"></a>MasonryåŸºæœ¬ä½¿ç”¨</h3><p>æœ€åŸºæœ¬çš„ä½¿ç”¨æ–¹å¼ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.å±æ€§.equalTo(å¦ä¸€ä¸ªview).with.insets(å·®å€¼);</div><div class="line">&#125;];</div></pre></td></tr></table></figure></p>
<h3 id="Masonryå±æ€§"><a href="#Masonryå±æ€§" class="headerlink" title="Masonryå±æ€§"></a>Masonryå±æ€§</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *left;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *top;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *right;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *bottom;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *leading;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *trailing;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *width;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *height;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *centerX;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *centerY;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *baseline;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­leadingä¸left trailingä¸right åœ¨æ­£å¸¸æƒ…å†µä¸‹æ˜¯ç­‰ä»·çš„ã€‚</p>
<h3 id="ä½¿ç”¨å®ä¾‹"><a href="#ä½¿ç”¨å®ä¾‹" class="headerlink" title="ä½¿ç”¨å®ä¾‹"></a>ä½¿ç”¨å®ä¾‹</h3><p>å±…ä¸­æ˜¾ç¤ºä¸€ä¸ªviewï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ä»æ­¤ä»¥ååŸºæœ¬å¯ä»¥æŠ›å¼ƒCGRectMakeäº†</span></div><div class="line"><span class="built_in">UIView</span> *sv = [<span class="built_in">UIView</span> new];</div><div class="line"></div><div class="line"><span class="comment">//åœ¨åšautoLayoutä¹‹å‰ ä¸€å®šè¦å…ˆå°†viewæ·»åŠ åˆ°superviewä¸Š å¦åˆ™ä¼šæŠ¥é”™</span></div><div class="line">[<span class="keyword">self</span>.view addSubview:sv];</div><div class="line"></div><div class="line"><span class="comment">//mas_makeConstraintså°±æ˜¯Masonryçš„autolayoutæ·»åŠ å‡½æ•° å°†æ‰€éœ€çš„çº¦æŸæ·»åŠ åˆ°blockä¸­è¡Œäº†</span></div><div class="line">[sv mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line"></div><div class="line">    <span class="comment">//å°†svå±…ä¸­(å¾ˆå®¹æ˜“ç†è§£å§?)</span></div><div class="line">    make.center.equalTo(<span class="keyword">self</span>.view);</div><div class="line">    </div><div class="line">    <span class="comment">//å°†sizeè®¾ç½®æˆ(300,300)</span></div><div class="line">    make.size.mas_equalTo(<span class="built_in">CGSizeMake</span>(<span class="number">300</span>, <span class="number">300</span>));</div><div class="line">&#125;];</div></pre></td></tr></table></figure></p>
<h3 id="æ–¹æ³•ç®€æ"><a href="#æ–¹æ³•ç®€æ" class="headerlink" title="æ–¹æ³•ç®€æ"></a>æ–¹æ³•ç®€æ</h3><h4 id="æ·»åŠ autolayoutçº¦æŸ"><a href="#æ·»åŠ autolayoutçº¦æŸ" class="headerlink" title="æ·»åŠ autolayoutçº¦æŸ"></a>æ·»åŠ autolayoutçº¦æŸ</h4><p>æœ‰ä¸‰ä¸ªå¯ä»¥æ·»åŠ çº¦æŸçš„æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSArray</span> *)mas_makeConstraints:(<span class="keyword">void</span>(^)(MASConstraintMaker *make))block;</div><div class="line">- (<span class="built_in">NSArray</span> *)mas_updateConstraints:(<span class="keyword">void</span>(^)(MASConstraintMaker *make))block;</div><div class="line">- (<span class="built_in">NSArray</span> *)mas_remakeConstraints:(<span class="keyword">void</span>(^)(MASConstraintMaker *make))block;</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">    mas_makeConstraints åªè´Ÿè´£æ–°å¢çº¦æŸ Autolayoutä¸èƒ½åŒæ—¶å­˜åœ¨ä¸¤æ¡é’ˆå¯¹äºåŒä¸€å¯¹è±¡çš„çº¦æŸ å¦åˆ™ä¼šæŠ¥é”™ </div><div class="line">    mas_updateConstraints é’ˆå¯¹ä¸Šé¢çš„æƒ…å†µ ä¼šæ›´æ–°åœ¨blockä¸­å‡ºç°çš„çº¦æŸ ä¸ä¼šå¯¼è‡´å‡ºç°ä¸¤ä¸ªç›¸åŒçº¦æŸçš„æƒ…å†µ</div><div class="line">    mas_remakeConstraints åˆ™ä¼šæ¸…é™¤ä¹‹å‰çš„æ‰€æœ‰çº¦æŸ ä»…ä¿ç•™æœ€æ–°çš„çº¦æŸ</div><div class="line">    </div><div class="line">    ä¸‰ç§å‡½æ•°å–„åŠ åˆ©ç”¨ å°±å¯ä»¥åº”å¯¹å„ç§æƒ…å†µäº†</div><div class="line">*/</div></pre></td></tr></table></figure></p>
<h4 id="equalTo-å’Œ-mas-equalToçš„åŒºåˆ«"><a href="#equalTo-å’Œ-mas-equalToçš„åŒºåˆ«" class="headerlink" title="equalTo å’Œ mas_equalToçš„åŒºåˆ«"></a>equalTo å’Œ mas_equalToçš„åŒºåˆ«</h4><p><code>mas_equalTo</code>åªæ˜¯å¯¹å…¶å‚æ•°è¿›è¡Œäº†ä¸€ä¸ªBOXæ“ä½œ(è£…ç®±)ã€‚æ‰€æ”¯æŒçš„ç±»å‹ é™¤äº†<code>NSNumber</code>æ”¯æŒçš„é‚£äº›æ•°å€¼ç±»å‹ä¹‹å¤– å°±åªæ”¯æŒ<code>CGPoint</code> <code>CGSize</code> <code>UIEdgeInsets</code></p>
<h3 id="å¦ä¸€ä¸ªç¤ºä¾‹"><a href="#å¦ä¸€ä¸ªç¤ºä¾‹" class="headerlink" title="å¦ä¸€ä¸ªç¤ºä¾‹"></a>å¦ä¸€ä¸ªç¤ºä¾‹</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIView</span> *sv1 = [<span class="built_in">UIView</span> new];</div><div class="line">[sv1 showPlaceHolder];</div><div class="line">sv1.backgroundColor = [<span class="built_in">UIColor</span> redColor];</div><div class="line">[sv addSubview:sv1];</div><div class="line">[sv1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.edges.equalTo(sv).with.insets(<span class="built_in">UIEdgeInsetsMake</span>(<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>));</div><div class="line">    </div><div class="line">    <span class="comment">/* ç­‰ä»·äº</span></div><div class="line">    make.top.equalTo(sv).with.offset(10);</div><div class="line">    make.left.equalTo(sv).with.offset(10);</div><div class="line">    make.bottom.equalTo(sv).with.offset(-10);</div><div class="line">    make.right.equalTo(sv).with.offset(-10);</div><div class="line">    */</div><div class="line">    </div><div class="line">    <span class="comment">/* ä¹Ÿç­‰ä»·äº</span></div><div class="line">    make.top.left.bottom.and.right.equalTo(sv).with.insets(UIEdgeInsetsMake(10, 10, 10, 10));</div><div class="line">    */</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ° edges å…¶å®å°±æ˜¯top,left,bottom,rightçš„ä¸€ä¸ªç®€åŒ– åˆ†å¼€å†™ä¹Ÿå¯ä»¥ ä¸€å¥è¯æ›´çœäº‹.</p>
<p>è¿™é‡Œandå’Œwith ä¸¤ä¸ªå‡½æ•°ä»€ä¹ˆäº‹æƒ…éƒ½æ²¡åš.</p>
<h3 id="è¿˜æœ‰ä¸€ä¸ªç¤ºä¾‹"><a href="#è¿˜æœ‰ä¸€ä¸ªç¤ºä¾‹" class="headerlink" title="è¿˜æœ‰ä¸€ä¸ªç¤ºä¾‹"></a>è¿˜æœ‰ä¸€ä¸ªç¤ºä¾‹</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIView</span> *lastView = <span class="literal">nil</span>;</div><div class="line">    </div><div class="line"><span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= count ; ++i )&#123;</div><div class="line">    <span class="built_in">UIView</span> *subv = [<span class="built_in">UIView</span> new];</div><div class="line">    [container addSubview:subv];</div><div class="line">    subv.backgroundColor = [<span class="built_in">UIColor</span> colorWithHue:( arc4random() % <span class="number">256</span> / <span class="number">256.0</span> )</div><div class="line">                                      saturation:( arc4random() % <span class="number">128</span> / <span class="number">256.0</span> ) + <span class="number">0.5</span></div><div class="line">                                      brightness:( arc4random() % <span class="number">128</span> / <span class="number">256.0</span> ) + <span class="number">0.5</span></div><div class="line">                                           alpha:<span class="number">1</span>];</div><div class="line">        </div><div class="line">    [subv mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        make.left.and.right.equalTo(container);</div><div class="line">        make.height.mas_equalTo(@(<span class="number">20</span>*i));</div><div class="line">           </div><div class="line">        <span class="keyword">if</span> ( lastView )&#123;</div><div class="line">            make.top.mas_equalTo(lastView.mas_bottom);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            make.top.mas_equalTo(container.mas_top);</div><div class="line">        &#125;</div><div class="line">    &#125;];</div><div class="line">       </div><div class="line">    lastView = subv;</div><div class="line">&#125;</div><div class="line">   </div><div class="line">    </div><div class="line">[container mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.bottom.equalTo(lastView.mas_bottom);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>æ¡†æ¶é€šè¿‡èŒƒç•´ä¸ºUIViewæ·»åŠ äº†<code>mas_bottom</code>ã€<code>mas_top</code>ç­‰å±æ€§ï¼Œç”¨æ¥è¡¨ç¤ºviewçš„ä¸Šä¸‹å·¦å³çš„ä½ç½®ã€‚è¿™æ ·ï¼Œæœ‰åˆ©äº<strong>åœ¨viewä¹‹é—´çš„çº¦æŸæ¡ä»¶çš„å»ºç«‹</strong>ï¼Œä¹‹å‰çš„ç¤ºä¾‹éƒ½æ˜¯viewä¸çˆ¶viewçš„çº¦æŸå…³ç³»ã€‚</p>
<p>è¿˜æœ‰ä¸€äº›å…¶ä»–çš„ç¤ºä¾‹ï¼Œå¯ä»¥å‚è§<a href="http://adad184.com/2014/09/28/use-masonry-to-quick-solve-autolayout/" target="_blank" rel="external">Masonryä»‹ç»ä¸ä½¿ç”¨å®è·µ</a></p>
<blockquote>
<p>Demo è¯¦è§NSLayoutConstraintDemo</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ç§»ä½ä¸æšä¸¾]]></title>
      <url>http://zhang759740844.github.io/2016/09/07/oc%E4%B8%AD%E7%9A%84%E6%9E%9A%E4%B8%BE/</url>
      <content type="html"><![CDATA[<p>ocä¸­çš„æšä¸¾ä½¿ç”¨enumï¼ŒiOSæœ¬èº«å®šä¹‰çš„æšä¸¾é‡Œé¢ç»å¸¸ä¼šä½¿ç”¨å·¦ç§»ï¼ˆ&lt;&lt;ï¼‰æ¥å®šä¹‰æšä¸¾çš„å€¼ï¼Œå…¶åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<a id="more"></a>
<h2 id="enumçš„åŸºæœ¬ç”¨æ³•ä½¿ç”¨"><a href="#enumçš„åŸºæœ¬ç”¨æ³•ä½¿ç”¨" class="headerlink" title="enumçš„åŸºæœ¬ç”¨æ³•ä½¿ç”¨"></a>enumçš„åŸºæœ¬ç”¨æ³•ä½¿ç”¨</h2><p>å®šä¹‰ä¸€ç»„å¸¸é‡ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span>&#123;</div><div class="line">	BlenderSpeedStir=<span class="number">1</span>ï¼Œ</div><div class="line">	BlenderSpeedChop=<span class="number">1</span>&lt;&lt;<span class="number">1</span>ï¼Œ</div><div class="line">&#125; BlenderSpeedï¼›</div></pre></td></tr></table></figure></p>
<p>è¿˜å¯ä»¥å†™æˆè¿™æ ·ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, BlenderSpeed) &#123;</div><div class="line"><span class="comment">//ä»¥ä¸‹æ˜¯æšä¸¾æˆå‘˜</span></div><div class="line">    Test1A = <span class="number">1</span>,</div><div class="line">    Test1B = <span class="number">1</span>&lt;&lt;<span class="number">1</span>,</div><div class="line">    Test1C = <span class="number">1</span>&lt;&lt;<span class="number">2</span>,</div><div class="line">    Test1D = <span class="number">1</span>&lt;&lt;<span class="number">3</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">BlenderSpeed speed = Test1Aï¼›</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨<code>BlenderSpeed</code>ä»£æ›¿<code>NSInteger</code>ã€‚</p>
<h2 id="ç§»ä½å®šä¹‰enum"><a href="#ç§»ä½å®šä¹‰enum" class="headerlink" title="ç§»ä½å®šä¹‰enum"></a>ç§»ä½å®šä¹‰enum</h2><h3 id="ä½¿ç”¨ç§»ä½å®šä¹‰enumçš„å¥½å¤„"><a href="#ä½¿ç”¨ç§»ä½å®šä¹‰enumçš„å¥½å¤„" class="headerlink" title="ä½¿ç”¨ç§»ä½å®šä¹‰enumçš„å¥½å¤„"></a>ä½¿ç”¨ç§»ä½å®šä¹‰enumçš„å¥½å¤„</h3><p>enumä¸€èˆ¬çš„æšä¸¾æ•°å€¼éƒ½ç”¨ç§»ä½è¡¨ç¤ºï¼Œä¸€èˆ¬å’Œæ•°å­—æ²¡æœ‰å¤ªå¤§å·®åˆ«ã€‚ä¸è¿‡ï¼Œæ¯”èµ·ä½¿ç”¨æ•°å­—çš„ä¸€ä¸ªæ˜¾è‘—çš„å¥½å¤„å°±æ˜¯ï¼š<strong>ç”¨ç§»ä½æ¥å®šä¹‰æšä¸¾èƒ½æŠŠ1çš„ä½ç½®é”™å¼€ï¼Œå¯ä»¥ä½¿ç”¨<code>æŒ‰ä½æˆ–</code>å°†å‡ ä¸ªæšä¸¾å€¼è¡¨ç¤ºæˆä¸€ä¸ªæ•°ï¼Œè€Œä¸ä¼šäº’ç›¸å½±å“</strong>ã€‚å¦‚æœç”¨æ•°å­—å°±è¦ä½¿ç”¨ä¸€ä¸ªæ•°ç»„ã€‚</p>
<p>æ¯”å¦‚ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[<span class="built_in">UIView</span> animateWithDuration:<span class="number">1</span> delay:<span class="number">0</span> options:<span class="built_in">UIViewAnimationOptionTransitionFlipFromRight</span> |<span class="built_in">UIViewAnimationOptionRepeat</span> animations:^&#123;</div><div class="line">	<span class="literal">nil</span></div><div class="line">&#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</div><div class="line">	<span class="literal">nil</span>;</div><div class="line">&#125;];</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­<code>options</code>åªèƒ½ä¼ å…¥ä¸€ä¸ªæ•°å€¼ï¼Œä½¿ç”¨æ•°å­—å°±ä¸èƒ½ä¼ å…¥å¤šä¸ªæšä¸¾å€¼ï¼Œä½†æ˜¯å½“enumä½¿ç”¨äº†ç§»ä½ï¼Œé‚£ä¹ˆä¹…å¯ä»¥ä¼ å…¥<code>UIViewAnimationOptionTransitionFlipFromRight |UIViewAnimationOptionRepeat</code>è¡¨ç¤ºæ—¢<code>FlipFromRight</code>åˆ<code>repeat</code>ã€‚</p>
<h3 id="å–å‡ºenumå€¼"><a href="#å–å‡ºenumå€¼" class="headerlink" title="å–å‡ºenumå€¼"></a>å–å‡ºenumå€¼</h3><p>å°†å‡ ä¸ªæšä¸¾å€¼æ”¾å…¥ä¸€ä¸ªæ•°ä¸­ï¼Œæ–¹æ³•å¤„ç†çš„æ—¶å€™æ€»çš„å–å‡ºæ¥å§ã€‚é‚£ä¹ˆæ€ä¹ˆå–å‘¢ï¼Ÿå…ˆæ¥çœ‹ä¸€ä¸‹<code>æŒ‰ä½ä¸&amp;</code>æ“ä½œç¬¦çš„ç‰¹æ€§ï¼š</p>
<blockquote>
<p>æ•°bä¸å·²çŸ¥æ•°aè¿›è¡ŒæŒ‰ä½ä¸æ“ä½œã€‚aä¸­ä¸º0çš„ä½ï¼Œç»“æœå¿…ä¸º0ï¼Œaä¸­ä¸º1çš„ä½ï¼Œç»“æœä¸ºbä¸­ç›¸åº”çš„ä½ã€‚<br>æ‰€ä»¥ï¼Œè‹¥è¦åˆ¤æ–­æŸä¸€ä¸ªæ•°ä¸­çš„æŸä¸€ä½æ˜¯å¦ä¸º1ï¼Œåªè¦å°†è¿™ä¸ªæ•°ä¸ä¸€ä¸ªè¯¥ä½ä¸º1å…¶ä½™ä½ä¸º0çš„æ•°è¿›è¡ŒæŒ‰ä½ä¸ï¼Œç»“æœä¸ä¸º0è¡¨ç¤ºè¯¥ä½ä¸º1ï¼Œåä¹‹ä¸º0ã€‚</p>
</blockquote>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å–å‡ºæšä¸¾å€¼ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span>&#123;</div><div class="line">    a = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</div><div class="line">    b = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</div><div class="line">    c = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</div><div class="line">    d = <span class="number">1</span> &lt;&lt; <span class="number">3</span></div><div class="line">&#125;testEnum;</div><div class="line"></div><div class="line">testEnum e = a | b;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (e &amp; a) &#123;</div><div class="line">    printf(<span class="string">"æ»¡è¶³æ¡ä»¶a"</span>);</div><div class="line">    <span class="comment">//æ»¡è¶³aè¦åšçš„äº‹</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (e &amp; b) &#123;</div><div class="line">    printf(<span class="string">"æ»¡è¶³æ¡ä»¶b"</span>);</div><div class="line">    <span class="comment">//æ»¡è¶³bè¦åšçš„äº‹</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (e &amp; c) &#123;</div><div class="line">    printf(<span class="string">"æ»¡è¶³æ¡ä»¶c"</span>);</div><div class="line">    <span class="comment">//æ»¡è¶³cè¦åšçš„äº‹</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å°†æ•°å€¼ä¸å„ä¸ªæšä¸¾å€¼æŒ‰ä½ä¸ï¼Œéé›¶å³åŒ…å«è¯¥æšä¸¾å€¼ã€‚</p>
<p>ä¹Ÿå¯ä»¥é€šè¿‡ä¸€ä¸ªforå¾ªç¯ï¼Œå†é€šè¿‡switch-caseå¤„ç†ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, AnimationType) &#123;</div><div class="line">    <span class="comment">//ä»¥ä¸‹æ˜¯æšä¸¾æˆå‘˜</span></div><div class="line">    BaseAnimation = <span class="number">1</span>,</div><div class="line">    KeyFrameAnimation_Value = <span class="number">1</span>&lt;&lt;<span class="number">1</span>,</div><div class="line">    KeyFrameAnimation_Path = <span class="number">1</span>&lt;&lt;<span class="number">2</span>,</div><div class="line">    KeyFrameAnimation_shake = <span class="number">1</span>&lt;&lt;<span class="number">3</span>,</div><div class="line">    Transition = <span class="number">1</span>&lt;&lt;<span class="number">4</span>,</div><div class="line">    AnimationGroup = <span class="number">1</span>&lt;&lt;<span class="number">5</span>,</div><div class="line">    ViewAnimation = <span class="number">1</span>&lt;&lt;<span class="number">6</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)initAnimationWithType:(<span class="built_in">NSInteger</span>)type&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="built_in">NSInteger</span> animationType = <span class="number">1</span>; animationType&lt;(ViewAnimation&lt;&lt;<span class="number">1</span>); animationType = animationType&lt;&lt;<span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (type &amp; animationType) &#123;</div><div class="line">            [<span class="keyword">self</span> startAnimationInitialWithType:animationType];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)startAnimationInitialWithType:(<span class="built_in">NSInteger</span>)type&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">switch</span> (type) &#123;</div><div class="line">        <span class="keyword">case</span> BaseAnimation:&#123;</div><div class="line">            <span class="built_in">CALayer</span> *myLayer=[<span class="built_in">CALayer</span> layer];</div><div class="line">            myLayer.bounds=<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">80</span>);</div><div class="line">            myLayer.backgroundColor=[<span class="built_in">UIColor</span> yellowColor].CGColor;</div><div class="line">            myLayer.position=<span class="built_in">CGPointMake</span>(<span class="number">50</span>, <span class="number">50</span>);</div><div class="line">            myLayer.anchorPoint=<span class="built_in">CGPointMake</span>(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line">            myLayer.cornerRadius=<span class="number">20</span>;</div><div class="line">            <span class="comment">//æ·»åŠ layer</span></div><div class="line">            [<span class="keyword">self</span>.view.layer addSublayer:myLayer];</div><div class="line">            <span class="keyword">self</span>.myLayer=myLayer;</div><div class="line">        &#125;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> Transition:</div><div class="line">            _index = <span class="number">1</span>;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯</strong>ï¼š<code>case</code>ä¸­å¦‚æœå£°æ˜äº†å˜é‡ï¼Œå¿…é¡»è¦ç”¨<code>{}</code>åŒ…ä½ï¼Œè¿™æ˜¯ç¼–è¯‘å™¨å¼ºåˆ¶çš„ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼Œåº”è¯¥æ˜¯ä¸ºäº†é¿å…<a href="http://blog.csdn.net/fanjunxi1990/article/details/9162945" target="_blank" rel="external">switch caseè¯­å¥é‡Œé¢ä¸èƒ½å®šä¹‰å¯¹è±¡ï¼Œæœ‰è¯­æ³•é”™è¯¯ï¼Œé™¤éåŠ ä¸€ä¸ªèŠ±æ‹¬å·</a>è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 id="å¼•ç”³"><a href="#å¼•ç”³" class="headerlink" title="å¼•ç”³"></a>å¼•ç”³</h3><p>ä¸Šé¢æ˜¯ä½¿ç”¨äº†2è¿›åˆ¶æ¥é”™å¼€ï¼Œä¿ç•™æ¯ä¸ªä½ï¼Œå…¶å®å…¶ä»–è¿›åˆ¶ä¹Ÿå¯ä»¥,ä½†ä½æ•°æ˜¯2çš„næ¬¡æ–¹ã€‚<br>æ¯”å¦‚0000 0000 8ä¸ªä½ï¼Œå¯ä»¥å‰4ä¸ªä½å­˜å‚¨ä¸€ä¸ªå€¼ï¼Œå4ä¸ªä½å­˜å‚¨ä¸€ä¸ªå€¼ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span>&#123;</div><div class="line">    a = <span class="number">0</span> &lt;&lt; <span class="number">0</span>,</div><div class="line">    b = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</div><div class="line">    c = <span class="number">2</span> &lt;&lt; <span class="number">0</span>,</div><div class="line">    d = <span class="number">3</span> &lt;&lt; <span class="number">0</span>,</div><div class="line"></div><div class="line">    e = <span class="number">0</span> &lt;&lt; <span class="number">4</span>,</div><div class="line">    f = <span class="number">1</span> &lt;&lt; <span class="number">4</span>,</div><div class="line">    g = <span class="number">2</span> &lt;&lt; <span class="number">4</span>,</div><div class="line">    h = <span class="number">3</span> &lt;&lt; <span class="number">4</span></div><div class="line">&#125;testEnum;</div></pre></td></tr></table></figure></p>
<p>a b c dçš„å‰4ä¸ºéƒ½æ˜¯0ï¼Œå€¼çš„å˜åŒ–åœ¨å4ä½ï¼Œè€Œe f g hæ­£å¥½ç›¸åã€‚a,b,c,dä¹‹é—´æ— æ³•é€šè¿‡æŒ‰ä½ä¸åŒºåˆ†ï¼Œä½†æ˜¯a,b,c,då¯ä»¥å’Œe,f,g,håŒºåˆ†ã€‚è¿™æ ·ï¼Œæ•´ä¸ªæšä¸¾å€¼è¢«åˆ†æˆäº†ä¸¤ç»„ã€‚å¦‚ä½•åˆ¤æ–­å€¼æ˜¯å“ªä¸ªç»„çš„æšä¸¾å€¼å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå’Œ<code>00001111</code>æŒ‰ä½ä¸ï¼Œåå››ä½ä¸­æœ‰ä¸€ä¸ªæ•°ä¸º1ï¼Œé‚£ä¹ˆæ•´ä¸ªæŒ‰ä½ä¸çš„å€¼å°±ä¸ä¸º0ã€‚åŒç†ï¼Œä¸<code>11110000</code>æŒ‰ä½ä¸å¾—åˆ°å¦å¤–ä¸€ç»„ã€‚</p>
<blockquote>
<p>Demoè¯¦è§CALayer_Transform</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[IPhone6å…¨å±é»‘è¾¹å¤„ç†]]></title>
      <url>http://zhang759740844.github.io/2016/09/05/IPhone6%E5%85%A8%E5%B1%8F%E9%BB%91%E8%BE%B9%E5%A4%84%E7%90%86/</url>
      <content type="html"><![CDATA[<p>å†™ioså°demoçš„æ—¶å€™ï¼ŒçœŸæœºè°ƒè¯•å‡ºç°Viewä¸èƒ½æ»¡å±æ˜¾ç¤ºçš„æƒ…å†µã€‚å±å¹•ä¸Šä¸‹éƒ½æœ‰ä¸€æ¡ç²—ç²—çš„é»‘æ¡ã€‚</p>
<a id="more"></a>
<p>æ£€æŸ¥äº†è®¸ä¹…ï¼Œä»£ç é‡Œéƒ½æ˜¯ç›´æ¥è®¾ç½®çš„<code>UIScreen</code>çš„<code>bounds</code>ã€‚å› æ­¤ï¼Œä¸å¯èƒ½æ˜¯ä»£ç çš„é—®é¢˜ã€‚é‚£ä¹ˆéœ€è¦åœ¨è®¾ç½®ä¸­æ‰¾åŸå› ã€‚</p>
<p>é€šè¿‡å’Œæ­£ç¡®çš„demoè¿›è¡Œå¯¹æ¯”ï¼Œå‘ç°äº†å·®å¼‚æ‰€åœ¨ã€‚</p>
<p>è¿™æ˜¯æœ‰é»‘è¾¹æƒ…å†µä¸‹çš„è®¾ç½®ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/SetLaunchImage2.png?raw=true" alt="é”™è¯¯è®¾ç½®"></p>
<p>è¿™æ˜¯æ²¡æœ‰é»‘è¾¹æƒ…å†µä¸‹çš„è®¾ç½®ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/SetLaunchImage1.png?raw=true" alt="æ­£ç¡®è®¾ç½®"></p>
<p>é€šè¿‡æ¯”è¾ƒå¯ä»¥å‘ç°ï¼š<br>å‡ºç°é»‘è¾¹çš„åŸå› æ˜¯åœ¨è®¾ç½®é‡Œè®¾ç½®äº†<code>Launch Images Source</code>ä¸º<code>LaunchImage</code>,ä½†æ˜¯åœ¨Images.xcassetsä¸­å¹¶æ²¡æœ‰<code>LaunchImage</code>èµ„æºã€‚æ‰€ä»¥ï¼Œéœ€è¦ç»™<code>LaunchImage</code>è®¾ç½®å›¾ç‰‡èµ„æºã€‚<br>ä¹Ÿå¯ä»¥åƒä¸Šé¢çš„é‚£æ ·è®¾ç½®<code>Launch Images Source</code>ä¸º<code>Use Asset Catalog</code>,å¹¶ä¸”å°†<code>Launch Screen File</code>è®¾ç½®ä¸º<code>LaunchImage</code>å³å¯è§£å†³ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[UIGestureRecognizer]]></title>
      <url>http://zhang759740844.github.io/2016/09/05/UIGestureRecognizer/</url>
      <content type="html"><![CDATA[<p>åœ¨iOSç³»ç»Ÿä¸­ï¼Œæ‰‹åŠ¿æ˜¯è¿›è¡Œç”¨æˆ·äº¤äº’çš„é‡è¦æ–¹å¼ï¼Œé€šè¿‡<code>UIGestureRecognizer</code>ç±»ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾çš„åˆ›å»ºå‡ºå„ç§æ‰‹åŠ¿åº”ç”¨äºappä¸­ã€‚å…³äº<code>UIGestureRecognizer</code>ç±»ï¼Œæ˜¯å¯¹iOSä¸­çš„äº‹ä»¶ä¼ é€’æœºåˆ¶é¢å‘åº”ç”¨çš„å°è£…ï¼Œå°†æ‰‹åŠ¿æ¶ˆæ¯çš„ä¼ é€’æŠ½è±¡ä¸ºäº†å¯¹è±¡ã€‚æœ‰å…³æ¶ˆæ¯ä¼ é€’çš„è®¨è®ºï¼Œåœ¨ä¸Šä¸€ç¯‡ä¸­å·²ç»è®¨è®ºè¿‡äº†ã€‚</p>
<a id="more"></a>
<h2 id="æ‰‹åŠ¿çš„æŠ½è±¡ç±»â€”â€”UIGestureRecognizer"><a href="#æ‰‹åŠ¿çš„æŠ½è±¡ç±»â€”â€”UIGestureRecognizer" class="headerlink" title="æ‰‹åŠ¿çš„æŠ½è±¡ç±»â€”â€”UIGestureRecognizer"></a>æ‰‹åŠ¿çš„æŠ½è±¡ç±»â€”â€”UIGestureRecognizer</h2><p><code>UIGestureRecognizer</code>å°†ä¸€äº›å’Œæ‰‹åŠ¿æ“ä½œç›¸å…³çš„æ–¹æ³•æŠ½è±¡äº†å‡ºæ¥ï¼Œä½†å®ƒæœ¬èº«å¹¶ä¸å®ç°ä»€ä¹ˆæ‰‹åŠ¿ï¼Œå› æ­¤ï¼Œåœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šç›´æ¥ä½¿ç”¨<code>UIGestureRecognizer</code>çš„å¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡å…¶å­ç±»è¿›è¡Œå®ä¾‹åŒ–ï¼ŒiOSç³»ç»Ÿç»™æˆ‘ä»¬æä¾›äº†è®¸å¤šç”¨äºæˆ‘ä»¬å®ä¾‹çš„å­ç±»ï¼Œè¿™äº›æˆ‘ä»¬åé¢å†è¯´ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ï¼Œ<code>UIGestureRecognizer</code>ä¸­æŠ½è±¡å‡ºäº†å“ªäº›æ–¹æ³•ã€‚</p>
<h3 id="åˆå§‹åŒ–æ–¹æ³•"><a href="#åˆå§‹åŒ–æ–¹æ³•" class="headerlink" title="åˆå§‹åŒ–æ–¹æ³•"></a>åˆå§‹åŒ–æ–¹æ³•</h3><p><code>UIGestureRecognizer</code>ç±»ä¸ºå…¶å­ç±»å‡†å¤‡å¥½äº†ä¸€ä¸ªç»Ÿä¸€çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•è¿›è¡Œç»Ÿä¸€çš„åˆå§‹åŒ–ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">instancetype</span>)initWithTarget:(<span class="keyword">nullable</span> <span class="keyword">id</span>)target action:(<span class="keyword">nullable</span> SEL)action;</div></pre></td></tr></table></figure></p>
<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨<code>alloc-init</code>çš„æ–¹å¼ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸‹é¢çš„æ–¹æ³•å¯ä»¥ä¸ºæ‰‹åŠ¿æ·»åŠ è§¦å‘çš„<code>selector</code>ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)addTarget:(<span class="keyword">id</span>)target action:(SEL)action;</div></pre></td></tr></table></figure></p>
<p>ä¸ä¹‹ç›¸å¯¹åº”çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸€ä¸ª<code>selector</code>ä»å…¶æ‰‹åŠ¿å¯¹è±¡ä¸Šç§»é™¤ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)removeTarget:(<span class="keyword">nullable</span> <span class="keyword">id</span>)target action:(<span class="keyword">nullable</span> SEL)action;</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œçš„<code>target</code>ä¸€èˆ¬éƒ½æ˜¯<code>self</code>,å› ä¸º<code>selector</code>ä¸€èˆ¬éƒ½æ˜¯åœ¨<code>self</code>ä¸­å®šä¹‰ã€‚</p>
<p>å› ä¸º<code>addTarget</code>æ–¹å¼çš„å­˜åœ¨ï¼ŒiOSç³»ç»Ÿå…è®¸ä¸€ä¸ªæ‰‹åŠ¿å¯¹è±¡å¯ä»¥æ·»åŠ å¤šä¸ª<code>selector</code>è§¦å‘æ–¹æ³•ï¼Œå¹¶ä¸”è§¦å‘çš„æ—¶å€™ï¼Œæ‰€æœ‰æ·»åŠ çš„<code>selector</code>éƒ½ä¼šè¢«æ‰§è¡Œï¼Œæˆ‘ä»¬ä»¥ç‚¹å‡»æ‰‹åŠ¿ç¤ºä¾‹å¦‚ä¸‹:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></div><div class="line">     <span class="built_in">UITapGestureRecognizer</span> * ges = [[<span class="built_in">UITapGestureRecognizer</span> alloc]initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(click:)];</div><div class="line">    [ges addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(haha)];</div><div class="line">     [<span class="keyword">self</span>.view addGestureRecognizer:ges];</div><div class="line">&#125;</div><div class="line">-(<span class="keyword">void</span>)click:(<span class="built_in">UIGestureRecognizer</span> *)ges&#123;</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ç¬¬ä¸€ä¸ªæ‰‹åŠ¿çš„è§¦å‘æ–¹æ³•"</span>);</div><div class="line">    </div><div class="line">&#125;</div><div class="line">-(<span class="keyword">void</span>)haha&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"haha"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç‚¹å‡»å±å¹•åï¼Œä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šè§¦å‘ã€‚</p>
<h3 id="æ‰‹åŠ¿çŠ¶æ€"><a href="#æ‰‹åŠ¿çŠ¶æ€" class="headerlink" title="æ‰‹åŠ¿çŠ¶æ€"></a>æ‰‹åŠ¿çŠ¶æ€</h3><p>UIgestureRecognizerç±»ä¸­æœ‰å¦‚ä¸‹ä¸€ä¸ªå±æ€§ï¼Œé‡Œé¢æšä¸¾äº†ä¸€äº›æ‰‹åŠ¿çš„å½“å‰çŠ¶æ€:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>) <span class="built_in">UIGestureRecognizerState</span> state;</div></pre></td></tr></table></figure></p>
<p>æšä¸¾å€¼å¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">UIGestureRecognizerState</span>) &#123;</div><div class="line">    <span class="built_in">UIGestureRecognizerStatePossible</span>,   <span class="comment">// é»˜è®¤çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™çš„æ‰‹åŠ¿å¹¶æ²¡æœ‰å…·ä½“çš„æƒ…å½¢çŠ¶æ€</span></div><div class="line">    <span class="built_in">UIGestureRecognizerStateBegan</span>,      <span class="comment">// æ‰‹åŠ¿å¼€å§‹è¢«è¯†åˆ«çš„çŠ¶æ€</span></div><div class="line">    <span class="built_in">UIGestureRecognizerStateChanged</span>,    <span class="comment">// æ‰‹åŠ¿è¯†åˆ«å‘ç”Ÿæ”¹å˜çš„çŠ¶æ€</span></div><div class="line">    <span class="built_in">UIGestureRecognizerStateEnded</span>,      <span class="comment">// æ‰‹åŠ¿è¯†åˆ«ç»“æŸï¼Œå°†ä¼šæ‰§è¡Œè§¦å‘çš„æ–¹æ³•</span></div><div class="line">    <span class="built_in">UIGestureRecognizerStateCancelled</span>,  <span class="comment">// æ‰‹åŠ¿è¯†åˆ«å–æ¶ˆ</span></div><div class="line">    <span class="built_in">UIGestureRecognizerStateFailed</span>,     <span class="comment">// è¯†åˆ«å¤±è´¥ï¼Œæ–¹æ³•å°†ä¸ä¼šè¢«è°ƒç”¨</span></div><div class="line">    <span class="built_in">UIGestureRecognizerStateRecognized</span> = <span class="built_in">UIGestureRecognizerStateEnded</span> </div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥åœ¨æ‰‹åŠ¿çš„å¤„ç†æ–¹æ³•ä¸­ï¼Œåˆ¤æ–­æ‰‹åŠ¿çš„çŠ¶æ€ï¼ŒåŒºåˆ†ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚</p>
<h3 id="å¸¸ç”¨å±æ€§å’Œæ–¹æ³•"><a href="#å¸¸ç”¨å±æ€§å’Œæ–¹æ³•" class="headerlink" title="å¸¸ç”¨å±æ€§å’Œæ–¹æ³•"></a>å¸¸ç”¨å±æ€§å’Œæ–¹æ³•</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®ä»£ç†ï¼Œå…·ä½“çš„åè®®åé¢ä¼šè¯´</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nullable</span>,<span class="keyword">nonatomic</span>,<span class="keyword">weak</span>) <span class="keyword">id</span> &lt;<span class="built_in">UIGestureRecognizerDelegate</span>&gt; delegate; </div><div class="line"><span class="comment">//è®¾ç½®æ‰‹åŠ¿æ˜¯å¦æœ‰æ•ˆ</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">getter</span>=isEnabled) <span class="built_in">BOOL</span> enabled;</div><div class="line"><span class="comment">//è·å–æ‰‹åŠ¿æ‰€åœ¨çš„view</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nullable</span>, <span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>) <span class="built_in">UIView</span> *view; </div><div class="line"><span class="comment">//è·å–è§¦å‘è§¦æ‘¸çš„ç‚¹</span></div><div class="line">- (<span class="built_in">CGPoint</span>)locationInView:(<span class="keyword">nullable</span> <span class="built_in">UIView</span>*)view; </div><div class="line"><span class="comment">//è®¾ç½®è§¦æ‘¸ç‚¹æ•°</span></div><div class="line">- (<span class="built_in">NSUInteger</span>)numberOfTouches; </div><div class="line"><span class="comment">//è·å–æŸä¸€ä¸ªè§¦æ‘¸ç‚¹çš„è§¦æ‘¸ä½ç½®</span></div><div class="line">- (<span class="built_in">CGPoint</span>)locationOfTouch:(<span class="built_in">NSUInteger</span>)touchIndex inView:(<span class="keyword">nullable</span> <span class="built_in">UIView</span>*)view;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>UITouch</code>ä¹Ÿæœ‰ä¸€ä¸ªæ–¹æ³•æ˜¯<code>locationInView:</code>å¯ä»¥è·å–è§¦æ‘¸ç‚¹åœ¨viewä¸­çš„ä½ç½®ã€‚<br>å¯ä»¥é€šè¿‡è®¾ç½®<code>numberOfTapsRequired</code>æ¥åŒºåˆ†å•å‡»åŒå‡»ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UITapGestureRecognizer</span> *doubleTap = [[<span class="built_in">UITapGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(DoubleTap:)];</div><div class="line">doubleTap.numberOfTapsRequired = <span class="number">2</span>; <span class="comment">//ç‚¹å‡»çš„æ¬¡æ•° ï¼2 åŒå‡»</span></div><div class="line">[_imageView addGestureRecognizer:doubleTap];<span class="comment">//ç»™å¯¹è±¡æ·»åŠ ä¸€ä¸ªæ‰‹åŠ¿ç›‘æµ‹ï¼›</span></div></pre></td></tr></table></figure></p>
<p>å¦å¤–è¿˜æœ‰ä¸‰ä¸ªå±æ€§ç”¨æ¥æ§åˆ¶è§¦æ‘¸äº‹ä»¶ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> cancelsTouchesInView;</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> delaysTouchesBegan;</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> delaysTouchesEnded;</div></pre></td></tr></table></figure></p>
<p><strong>cancelsTouchesInView</strong><br>é»˜è®¤ä¸ºYES,è¿™ç§æƒ…å†µä¸‹å½“æ‰‹åŠ¿è¯†åˆ«å™¨è¯†åˆ«åˆ°touchä¹‹åï¼Œä¼šå‘é€<code>touchesCancelled:withEvent:</code>æ¶ˆæ¯,ç»ˆæ­¢è§¦æ‘¸äº‹ä»¶çš„ä¼ é€’,ä»¥å–æ¶ˆ <code>UIResponder</code>å¯¹touchçš„å“åº”ï¼Œè¿™ä¸ªæ—¶å€™åªæœ‰æ‰‹åŠ¿è¯†åˆ«å™¨å“åº”touchã€‚<br>å½“è®¾ç½®æˆNOæ—¶ï¼Œæ‰‹åŠ¿è¯†åˆ«å™¨è¯†åˆ«åˆ°touchä¹‹åä¸ä¼šå‘é€<code>touchesCancelled:withEvent:</code>æ¶ˆæ¯ï¼Œè¿™ä¸ªæ—¶å€™æ‰‹åŠ¿è¯†åˆ«å™¨å’Œ<code>UIResponder</code>å‡å“åº”touchã€‚<br><strong>æ³¨æ„ï¼š</strong>å‘é€<code>touchesCancelled:withEvent:</code>æ¶ˆæ¯ä¹Ÿæ˜¯éœ€è¦æ—¶é—´çš„ã€‚åœ¨æ¯æ¬¡æ‰‹åŠ¿æ“ä½œçš„æ—¶å€™éƒ½ä¼šå…ˆè§¦å‘1-2æ¬¡touchæ“ä½œï¼Œç„¶å<code>touchesCancelled:withEvent:</code>æ¶ˆæ¯æ‰ä¼šç”Ÿæ•ˆï¼Œå±è”½touchæ“ä½œã€‚</p>
<p><strong>delaysTouchesBegan</strong><br>åœ¨å‰é¢<code>cancelsTouchesInView</code>å±æ€§ä¸ºNOçš„åŸºç¡€ä¸Š.<br>é»˜è®¤æ˜¯NOï¼Œè¿™ç§æƒ…å†µä¸‹å½“å‘ç”Ÿä¸€ä¸ªtouchæ—¶ï¼Œæ‰‹åŠ¿è¯†åˆ«å™¨å…ˆæ•æ‰åˆ°åˆ°touchï¼Œç„¶åå‘ç»™<code>UIResponder</code>ï¼Œä¸¤è€…å„è‡ªåšå‡ºå“åº”ã€‚<br>å¦‚æœè®¾ç½®ä¸ºYESï¼Œæ‰‹åŠ¿è¯†åˆ«å™¨åœ¨è¯†åˆ«çš„è¿‡ç¨‹ä¸­ï¼ˆæ³¨æ„æ˜¯è¯†åˆ«è¿‡ç¨‹ï¼‰ï¼Œä¸ä¼šå°†touchå‘ç»™<code>UIResponder</code>ï¼Œå³<code>UIResponder</code>ä¸ä¼šæœ‰ä»»ä½•è§¦æ‘¸äº‹ä»¶ã€‚åªæœ‰åœ¨è¯†åˆ«å¤±è´¥ä¹‹åæ‰ä¼šå°†touchå‘ç»™<code>UIResponder</code>ï¼Œè¿™ç§æƒ…å†µä¸‹<code>UIResponder</code>çš„å“åº”ä¼šå»¶è¿Ÿçº¦0.15msã€‚</p>
<p><strong>delaysTouchesEnded</strong><br>åœ¨å‰é¢<code>cancelsTouchesInView</code>å±æ€§ä¸ºNOçš„åŸºç¡€ä¸Š.<br>é»˜è®¤ä¸ºYESã€‚è¿™ç§æƒ…å†µä¸‹å‘ç”Ÿä¸€ä¸ªtouchæ—¶ï¼Œåœ¨æ‰‹åŠ¿è¯†åˆ«æˆåŠŸå,å‘é€ç»™<code>touchesCancelled:withEvent:</code>æ¶ˆæ¯ç»™<code>UIResponder</code>ï¼Œæ‰‹åŠ¿è¯†åˆ«å¤±è´¥æ—¶ï¼Œä¼šå»¶è¿Ÿå¤§æ¦‚0.15ms,æœŸé—´æ²¡æœ‰æ¥æ”¶åˆ°åˆ«çš„touchæ‰ä¼šå‘é€<code>touchesEnded:withEvent:</code>ã€‚<br>å¦‚æœè®¾ç½®ä¸ºNOï¼Œåˆ™ä¸ä¼šå»¶è¿Ÿï¼Œå³ä¼šç«‹å³å‘é€<code>touchesEnded:withEvent:</code>ä»¥ç»“æŸå½“å‰è§¦æ‘¸ã€‚</p>
<h3 id="æ‰‹åŠ¿é—´çš„äº’æ–¥"><a href="#æ‰‹åŠ¿é—´çš„äº’æ–¥" class="headerlink" title="æ‰‹åŠ¿é—´çš„äº’æ–¥"></a>æ‰‹åŠ¿é—´çš„äº’æ–¥</h3><p>æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼ŒåŒä¸€ä¸ªViewä¸Šæ˜¯å¯ä»¥æ·»åŠ å¤šä¸ªæ‰‹åŠ¿å¯¹è±¡çš„ï¼Œé»˜è®¤è¿™ä¸ªæ‰‹åŠ¿æ˜¯äº’æ–¥çš„ï¼Œä¸€ä¸ªæ‰‹åŠ¿è§¦å‘äº†å°±ä¼šé»˜è®¤å±è”½å…¶ä»–ç›¸ä¼¼çš„æ‰‹åŠ¿åŠ¨ä½œï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></div><div class="line">     <span class="built_in">UITapGestureRecognizer</span> * ges = [[<span class="built_in">UITapGestureRecognizer</span> alloc]initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(click:)];;</div><div class="line">    </div><div class="line">    <span class="comment">//view.backgroundColor = [UIColor redColor];</span></div><div class="line">   </div><div class="line">    <span class="comment">//ges.delegate=self;</span></div><div class="line">    [<span class="keyword">self</span>.view addGestureRecognizer:ges];</div><div class="line">    </div><div class="line">    <span class="built_in">UITapGestureRecognizer</span> * ges2 = [[<span class="built_in">UITapGestureRecognizer</span> alloc]initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(click1:)];</div><div class="line"><span class="comment">//    ges2.delegate=self;</span></div><div class="line">        [<span class="keyword">self</span>.view addGestureRecognizer:ges2];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)click:(<span class="built_in">UIGestureRecognizer</span> *)ges&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ç¬¬ä¸€ä¸ªæ‰‹åŠ¿çš„è§¦å‘æ–¹æ³•"</span>);</div><div class="line">&#125;</div><div class="line">-(<span class="keyword">void</span>)click1:(<span class="built_in">UIGestureRecognizer</span> *)ges1&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ç¬¬äºŒä¸ªæ‰‹åŠ¿çš„è§¦å‘æ–¹æ³•"</span>);   </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬æ·»åŠ çš„ä¸¤ä¸ªæ‰‹åŠ¿éƒ½æ˜¯å•æœºæ‰‹åŠ¿ï¼Œä¼šäº§ç”Ÿå†²çªï¼Œè§¦å‘æ˜¯å¾ˆéšæœºçš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®¾ç½®ä¸€ä¸‹å½“æ‰‹åŠ¿äº’æ–¥æ—¶è¦ä¼˜å…ˆè§¦å‘çš„æ‰‹åŠ¿ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ges requireGestureRecognizerToFail:ges2];</div></pre></td></tr></table></figure></p>
<p>è¡¨ç¤ºå¦‚æœ<code>ges2</code>åŒ¹é…ï¼Œé‚£ä¹ˆä¸ä¼šæ‰§è¡Œ<code>ges</code>ã€‚åªæœ‰å½“<code>ges2</code>ä¸åŒ¹é…çš„æ—¶å€™ï¼Œæ‰ä¼šæ‰§è¡Œ<code>ges</code>ã€‚</p>
<h3 id="UIGestureRecognizerDelegate"><a href="#UIGestureRecognizerDelegate" class="headerlink" title="UIGestureRecognizerDelegate"></a>UIGestureRecognizerDelegate</h3><p>å‰é¢æˆ‘ä»¬æåˆ°è¿‡å…³äºæ‰‹åŠ¿å¯¹è±¡çš„åè®®ä»£ç†ï¼Œé€šè¿‡ä»£ç†çš„å›è°ƒï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œè‡ªå®šä¹‰æ‰‹åŠ¿ï¼Œä¹Ÿå¯ä»¥å¤„ç†ä¸€äº›å¤æ‚çš„æ‰‹åŠ¿å…³ç³»ï¼Œå…¶ä¸­æ–¹æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ‰‹æŒ‡è§¦æ‘¸å±å¹•åå›è°ƒçš„æ–¹æ³•ï¼Œè¿”å›NOåˆ™ä¸å†è¿›è¡Œæ‰‹åŠ¿è¯†åˆ«ï¼Œæ–¹æ³•è§¦å‘ç­‰</span></div><div class="line">- (<span class="built_in">BOOL</span>)gestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer shouldReceiveTouch:(<span class="built_in">UITouch</span> *)touch;</div><div class="line"><span class="comment">//å¼€å§‹è¿›è¡Œæ‰‹åŠ¿è¯†åˆ«æ—¶è°ƒç”¨çš„æ–¹æ³•ï¼Œè¿”å›NOåˆ™ç»“æŸï¼Œä¸å†è§¦å‘æ‰‹åŠ¿</span></div><div class="line">- (<span class="built_in">BOOL</span>)gestureRecognizerShouldBegin:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer;</div><div class="line"><span class="comment">//æ˜¯å¦æ”¯æŒå¤šæ—¶å€™è§¦å‘ï¼Œè¿”å›YESï¼Œåˆ™å¯ä»¥å¤šä¸ªæ‰‹åŠ¿ä¸€èµ·è§¦å‘æ–¹æ³•ï¼Œè¿”å›NOåˆ™ä¸ºäº’æ–¥</span></div><div class="line">- (<span class="built_in">BOOL</span>)gestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)otherGestureRecognizer;</div><div class="line"><span class="comment">//ä¸‹é¢è¿™ä¸ªä¸¤ä¸ªæ–¹æ³•ä¹Ÿæ˜¯ç”¨æ¥æ§åˆ¶æ‰‹åŠ¿çš„äº’æ–¥æ‰§è¡Œçš„</span></div><div class="line"><span class="comment">//è¿™ä¸ªæ–¹æ³•è¿”å›YESï¼Œç¬¬ä¸€ä¸ªæ‰‹åŠ¿å’Œç¬¬äºŒä¸ªäº’æ–¥æ—¶ï¼Œç¬¬ä¸€ä¸ªä¼šå¤±æ•ˆ</span></div><div class="line">- (<span class="built_in">BOOL</span>)gestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer shouldRequireFailureOfGestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)otherGestureRecognizer <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">7</span>_0);</div><div class="line"><span class="comment">//è¿™ä¸ªæ–¹æ³•è¿”å›YESï¼Œç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªäº’æ–¥æ—¶ï¼Œç¬¬äºŒä¸ªä¼šå¤±æ•ˆ</span></div><div class="line">- (<span class="built_in">BOOL</span>)gestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer shouldBeRequiredToFailByGestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)otherGestureRecognizer <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">7</span>_0);</div></pre></td></tr></table></figure></p>
<p>æœ€ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•ç”¨èµ·æ¥è¿˜æŒºéº»çƒ¦çš„ï¼Œå› ä¸ºä½ ä¸çŸ¥é“å“ªä¸ªæ˜¯<code>gestureRecognizer</code>å“ªä¸ªæ˜¯<code>otherGestureRecognizer</code>,å› æ­¤ï¼Œåªèƒ½ç¬¼ç»Ÿçš„è®¾ç½®ã€‚</p>
<h3 id="æ‰‹åŠ¿å’Œè§¦æ‘¸çš„åŒºåˆ«"><a href="#æ‰‹åŠ¿å’Œè§¦æ‘¸çš„åŒºåˆ«" class="headerlink" title="æ‰‹åŠ¿å’Œè§¦æ‘¸çš„åŒºåˆ«"></a>æ‰‹åŠ¿å’Œè§¦æ‘¸çš„åŒºåˆ«</h3><p>å‰ä¸€ç¯‡æˆ‘ä»¬å­¦ä¹ äº†<code>UITouch</code>,å¯ä»¥é€šè¿‡é‡å†™<code>UIResponder</code>çš„å‡ ä¸ª<code>touch</code>æ–¹æ³•æ¥å¤„ç†è§¦æ‘¸äº‹ä»¶ã€‚<br><code>UIGestureRecognizer</code>å’Œè§¦æ‘¸äº‹ä»¶æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„äº‹,æ‰‹åŠ¿å’Œ<code>UITouch</code>æœ¬èº«å…³ç³»ä¸å¤§ã€‚ä¸è¿‡æ‰‹åŠ¿å¯ä»¥é€šè¿‡<code>cancelsTouchesInView</code>,<code>delaysTouchesBegan</code>,<code>delaysTouchesEnded</code>è¿™ä¸‰ä¸ªå±æ€§æ¥å½±å“è§¦æ‘¸äº‹ä»¶ã€‚</p>
<h2 id="UIGestureRecognizerçš„å­ç±»"><a href="#UIGestureRecognizerçš„å­ç±»" class="headerlink" title="UIGestureRecognizerçš„å­ç±»"></a>UIGestureRecognizerçš„å­ç±»</h2><h3 id="ç‚¹å‡»æ‰‹åŠ¿â€”â€”UITapGestureRecognizer"><a href="#ç‚¹å‡»æ‰‹åŠ¿â€”â€”UITapGestureRecognizer" class="headerlink" title="ç‚¹å‡»æ‰‹åŠ¿â€”â€”UITapGestureRecognizer"></a>ç‚¹å‡»æ‰‹åŠ¿â€”â€”UITapGestureRecognizer</h3><p>ç‚¹å‡»æ‰‹åŠ¿ååˆ†ç®€å•ï¼Œæ”¯æŒå•å‡»å’Œå¤šæ¬¡ç‚¹å‡»ï¼Œåœ¨æˆ‘ä»¬æ‰‹æŒ‡è§¦æ‘¸å±å¹•å¹¶æŠ¬èµ·æ‰‹æŒ‡æ—¶ä¼šè¿›è¡Œè§¦å‘ï¼Œå…¶ä¸­æœ‰å¦‚ä¸‹ä¸¤ä¸ªå±æ€§æˆ‘ä»¬å¯ä»¥è¿›è¡Œè®¾ç½®ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®ç‚¹å‡»æ¬¡æ•°ï¼Œé»˜è®¤ä¸ºå•å‡»</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSUInteger</span>  numberOfTapsRequired; </div><div class="line"><span class="comment">//è®¾ç½®åŒæ—¶ç‚¹å‡»çš„æ‰‹æŒ‡æ•°</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSUInteger</span>  numberOfTouchesRequired;</div></pre></td></tr></table></figure></p>
<h3 id="æåˆæ‰‹åŠ¿â€”â€”UIPinchGestureRecognizer"><a href="#æåˆæ‰‹åŠ¿â€”â€”UIPinchGestureRecognizer" class="headerlink" title="æåˆæ‰‹åŠ¿â€”â€”UIPinchGestureRecognizer"></a>æåˆæ‰‹åŠ¿â€”â€”UIPinchGestureRecognizer</h3><p>æåˆæ‰‹åŠ¿æ˜¯å½“æˆ‘ä»¬åŒæŒ‡æåˆå’Œæ‰©å¼ ä¼šè§¦å‘åŠ¨ä½œçš„æ‰‹åŠ¿ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®çš„å±æ€§å¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®ç¼©æ”¾æ¯”ä¾‹</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>)          <span class="built_in">CGFloat</span> scale; </div><div class="line"><span class="comment">//è®¾ç½®æåˆé€Ÿåº¦</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>) <span class="built_in">CGFloat</span> velocity;</div></pre></td></tr></table></figure></p>
<p>åœ¨è®¾ç½®å®Œç¼©æ”¾åï¼Œä¸€å®šè¦æŠŠ<code>recognizer.scale</code>è®¾ç½®ä¸º1<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)handlePinch:(<span class="built_in">UIPinchGestureRecognizer</span>*)recognizer&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ç¼©æ”¾æ“ä½œ"</span>);<span class="comment">//å¤„ç†ç¼©æ”¾æ“ä½œ</span></div><div class="line">    <span class="comment">//å¯¹imageviewç¼©æ”¾</span></div><div class="line">    _imageView.transform = <span class="built_in">CGAffineTransformScale</span>(_imageView.transform, recognizer.scale, recognizer.scale);</div><div class="line">    recognizer.scale = <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="æ‹–æ‹½æ‰‹åŠ¿â€”â€”UIPanGestureRecognzer"><a href="#æ‹–æ‹½æ‰‹åŠ¿â€”â€”UIPanGestureRecognzer" class="headerlink" title="æ‹–æ‹½æ‰‹åŠ¿â€”â€”UIPanGestureRecognzer"></a>æ‹–æ‹½æ‰‹åŠ¿â€”â€”UIPanGestureRecognzer</h3><p>å½“æˆ‘ä»¬ç‚¹ä¸­è§†å›¾è¿›è¡Œæ…¢é€Ÿæ‹–æ‹½æ—¶ä¼šè§¦å‘æ‹–æ‹½æ‰‹åŠ¿çš„æ–¹æ³•ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®è§¦å‘æ‹–æ‹½çš„æœ€å°‘è§¦æ‘¸ç‚¹ï¼Œé»˜è®¤ä¸º1</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>)          <span class="built_in">NSUInteger</span> minimumNumberOfTouches; </div><div class="line"><span class="comment">//è®¾ç½®è§¦å‘æ‹–æ‹½çš„æœ€å¤šè§¦æ‘¸ç‚¹</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>)          <span class="built_in">NSUInteger</span> maximumNumberOfTouches;  </div><div class="line"><span class="comment">//è·å–å½“å‰ä½ç½®</span></div><div class="line">- (<span class="built_in">CGPoint</span>)translationInView:(<span class="keyword">nullable</span> <span class="built_in">UIView</span> *)view;            </div><div class="line"><span class="comment">//è®¾ç½®å½“å‰ä½ç½®</span></div><div class="line">- (<span class="keyword">void</span>)setTranslation:(<span class="built_in">CGPoint</span>)translation inView:(<span class="keyword">nullable</span> <span class="built_in">UIView</span> *)view;</div><div class="line"><span class="comment">//è®¾ç½®æ‹–æ‹½é€Ÿåº¦</span></div><div class="line">- (<span class="built_in">CGPoint</span>)velocityInView:(<span class="keyword">nullable</span> <span class="built_in">UIView</span> *)view;</div></pre></td></tr></table></figure></p>
<p>ä»£ç ç¤ºä¾‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">-(<span class="keyword">void</span>)handlePan:(<span class="built_in">UIPanGestureRecognizer</span>*)recognizer&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æ‹–åŠ¨æ“ä½œ"</span>);</div><div class="line">    <span class="comment">//å¤„ç†æ‹–åŠ¨æ“ä½œ,æ‹–åŠ¨æ˜¯åŸºäºimageviewï¼Œå¦‚æœç»è¿‡æ—‹è½¬ï¼Œæ‹–åŠ¨æ–¹å‘ä¹Ÿæ˜¯ç›¸å¯¹imageviewä¸Šä¸‹å·¦å³ç§»åŠ¨ï¼Œè€Œä¸æ˜¯å±å¹•å¯¹ä¸Šä¸‹å·¦å³</span></div><div class="line">    <span class="built_in">CGPoint</span> translation = [recognizer translationInView:_imageView];</div><div class="line">    recognizer.view.center = <span class="built_in">CGPointMake</span>(recognizer.view.center.x + translation.x,</div><div class="line">                                         recognizer.view.center.y + translation.y);</div><div class="line">    [recognizer setTranslation:<span class="built_in">CGPointZero</span> inView:_imageView];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¿…é¡»ä½¿ç”¨<code>setTranslation</code>è®¾ç½®ä¸º<code>CGPointZero</code>,ä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p>
<h3 id="æ»‘åŠ¨æ‰‹åŠ¿â€”â€”UISwipeGestureRecognizer"><a href="#æ»‘åŠ¨æ‰‹åŠ¿â€”â€”UISwipeGestureRecognizer" class="headerlink" title="æ»‘åŠ¨æ‰‹åŠ¿â€”â€”UISwipeGestureRecognizer"></a>æ»‘åŠ¨æ‰‹åŠ¿â€”â€”UISwipeGestureRecognizer</h3><p>æ»‘åŠ¨æ‰‹åŠ¿å’Œæ‹–æ‹½æ‰‹åŠ¿çš„ä¸åŒä¹‹å¤„åœ¨äºæ»‘åŠ¨æ‰‹åŠ¿æ›´å¿«ï¼Œæ‹–æ‹½æ¯”è¾ƒæ…¢<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®è§¦å‘æ»‘åŠ¨æ‰‹åŠ¿çš„è§¦æ‘¸ç‚¹æ•°</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">NSUInteger</span>                        numberOfTouchesRequired; </div><div class="line"><span class="comment">//è®¾ç½®æ»‘åŠ¨æ–¹å‘</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">UISwipeGestureRecognizerDirection</span> direction;  </div><div class="line"><span class="comment">//æšä¸¾å¦‚ä¸‹</span></div><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_OPTIONS</span>(<span class="built_in">NSUInteger</span>, <span class="built_in">UISwipeGestureRecognizerDirection</span>) &#123;</div><div class="line">    <span class="built_in">UISwipeGestureRecognizerDirectionRight</span> = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</div><div class="line">    <span class="built_in">UISwipeGestureRecognizerDirectionLeft</span>  = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</div><div class="line">    <span class="built_in">UISwipeGestureRecognizerDirectionUp</span>    = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</div><div class="line">    <span class="built_in">UISwipeGestureRecognizerDirectionDown</span>  = <span class="number">1</span> &lt;&lt; <span class="number">3</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="æ—‹è½¬æ‰‹åŠ¿â€”â€”UIRotationGestureRecognizer"><a href="#æ—‹è½¬æ‰‹åŠ¿â€”â€”UIRotationGestureRecognizer" class="headerlink" title="æ—‹è½¬æ‰‹åŠ¿â€”â€”UIRotationGestureRecognizer"></a>æ—‹è½¬æ‰‹åŠ¿â€”â€”UIRotationGestureRecognizer</h3><p>è¿›è¡Œæ—‹è½¬åŠ¨ä½œæ—¶è§¦å‘æ‰‹åŠ¿æ–¹æ³•<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®æ—‹è½¬è§’åº¦</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>)          <span class="built_in">CGFloat</span> rotation;</div><div class="line"><span class="comment">//è®¾ç½®æ—‹è½¬é€Ÿåº¦ </span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>) <span class="built_in">CGFloat</span> velocity;</div></pre></td></tr></table></figure></p>
<p>åœ¨è®¾ç½®å®Œæ—‹è½¬åï¼Œ<code>recognizer.rotation</code>ä¸€å®šè¦æ¸…é›¶.<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)handleRotate:(<span class="built_in">UIRotationGestureRecognizer</span>*) recognizer&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æ—‹è½¬æ“ä½œ"</span>);<span class="comment">//å¤„ç†æ—‹è½¬æ“ä½œ</span></div><div class="line">    <span class="comment">//å¯¹imageviewæ—‹è½¬</span></div><div class="line">    _imageView.transform = <span class="built_in">CGAffineTransformRotate</span>(_imageView.transform, recognizer.rotation);</div><div class="line">    recognizer.rotation = <span class="number">0</span>;    <span class="comment">//ä¸€å®šè¦æ¸…é›¶</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="é•¿æŒ‰æ‰‹åŠ¿â€”â€”UILongPressGestureRecognizer"><a href="#é•¿æŒ‰æ‰‹åŠ¿â€”â€”UILongPressGestureRecognizer" class="headerlink" title="é•¿æŒ‰æ‰‹åŠ¿â€”â€”UILongPressGestureRecognizer"></a>é•¿æŒ‰æ‰‹åŠ¿â€”â€”UILongPressGestureRecognizer</h3><p>è¿›è¡Œé•¿æŒ‰çš„æ—¶å€™è§¦å‘çš„æ‰‹åŠ¿æ–¹æ³•<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®è§¦å‘å‰çš„ç‚¹å‡»æ¬¡æ•°</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSUInteger</span> numberOfTapsRequired;    </div><div class="line"><span class="comment">//è®¾ç½®è§¦å‘çš„è§¦æ‘¸ç‚¹æ•°</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSUInteger</span> numberOfTouchesRequired; </div><div class="line"><span class="comment">//è®¾ç½®æœ€çŸ­çš„é•¿æŒ‰æ—¶é—´</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">CFTimeInterval</span> minimumPressDuration; </div><div class="line"><span class="comment">//è®¾ç½®åœ¨æŒ‰è§¦æ—¶æ—¶å…è®¸ç§»åŠ¨çš„æœ€å¤§è·ç¦» é»˜è®¤ä¸º10åƒç´ </span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> allowableMovement;</div></pre></td></tr></table></figure></p>
<h3 id="æ‰‹åŠ¿ç»„åˆçš„é—®é¢˜"><a href="#æ‰‹åŠ¿ç»„åˆçš„é—®é¢˜" class="headerlink" title="æ‰‹åŠ¿ç»„åˆçš„é—®é¢˜"></a>æ‰‹åŠ¿ç»„åˆçš„é—®é¢˜</h3><p>è¿™ä¹ˆå¤šæ‰‹åŠ¿å¯ä»¥ç»„åˆä½¿ç”¨ã€‚ä½†æ˜¯ä½¿ç”¨çš„æ—¶å€™ä¼šäº§ç”Ÿå¦‚å›¾æ‰€ç¤ºçš„é—®é¢˜ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/UIGestureRecognizer.gif?raw=true" alt="æ‰‹åŠ¿ç»„åˆ"><br>å½“å›¾ç‰‡æ­£å¸¸å¤§å°æ—¶ï¼Œæ‹–åŠ¨æ­£å¸¸ã€‚å½“å›¾ç‰‡å˜å°æˆ–è€…å˜å¤§æ—¶ï¼Œæ‹–åŠ¨è·ç¦»å˜å¤§ä»¥åŠå˜å°ã€‚æ¯”å¦‚ç¼©å°å›¾ç‰‡åï¼Œç›¸å½“äºèƒŒæ™¯ä¹Ÿç¼©å°äº†ï¼Œåœ¨æ‰‹æŒ‡æ»‘åŠ¨ç›¸åŒçš„è·ç¦»ä¸‹ï¼Œç›¸å¯¹æ¥è¯´ç§»åŠ¨çš„è·ç¦»å°±å˜å¤§äº†ã€‚</p>
<blockquote>
<p>Demo è¯¦è§UIGestureRecognizer</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ioså“åº”æœºåˆ¶]]></title>
      <url>http://zhang759740844.github.io/2016/09/03/ios%E5%93%8D%E5%BA%94%E4%BA%8B%E4%BB%B6/</url>
      <content type="html"><![CDATA[<p>ä»ç‚¹å‡»å±å¹•åˆ°ç³»ç»Ÿåšå‡ºå“åº”ï¼Œç»å†äº†å“ªäº›è¿‡ç¨‹ï¼Ÿéœ€è¦è¯¦ç»†æ¢ç©¶ä¸‹iosçš„å“åº”æœºåˆ¶ã€‚æœ¬æ–‡å‚è€ƒè‡ª<a href="http://www.jianshu.com/p/2e074db792ba" target="_blank" rel="external">å²ä¸Šæœ€è¯¦ç»†çš„iOSä¹‹äº‹ä»¶çš„ä¼ é€’å’Œå“åº”æœºåˆ¶
</a></p>
<a id="more"></a>
<h2 id="iOSä¸­çš„äº‹ä»¶"><a href="#iOSä¸­çš„äº‹ä»¶" class="headerlink" title="iOSä¸­çš„äº‹ä»¶"></a>iOSä¸­çš„äº‹ä»¶</h2><p>iosä¸­çš„äº‹ä»¶å¯ä»¥è¢«åˆ†ä¸ºä¸‰ç±»ï¼š<strong>è§¦æ‘¸äº‹ä»¶</strong>ï¼Œ<strong>åŠ é€Ÿè®¡äº‹ä»¶</strong>ï¼Œ<strong>è¿œç¨‹æ§åˆ¶äº‹ä»¶</strong>ã€‚æœ¬æ–‡è®¨è®ºçš„æ˜¯è§¦æ‘¸äº‹ä»¶ã€‚</p>
<h3 id="å“åº”è€…å¯¹è±¡-UIResponder"><a href="#å“åº”è€…å¯¹è±¡-UIResponder" class="headerlink" title="å“åº”è€…å¯¹è±¡(UIResponder)"></a>å“åº”è€…å¯¹è±¡(UIResponder)</h3><p>åœ¨iOSä¸­ä¸æ˜¯ä»»ä½•å¯¹è±¡éƒ½èƒ½å¤„ç†äº‹ä»¶ï¼Œåªæœ‰ç»§æ‰¿äº†<code>UIResponder</code>çš„å¯¹è±¡æ‰èƒ½æ¥å—å¹¶å¤„ç†äº‹ä»¶ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œå“åº”è€…å¯¹è±¡â€ã€‚</p>
<p>ä»¥ä¸‹éƒ½æ˜¯ç»§æ‰¿è‡ª<code>UIResponder</code>çš„ï¼Œæ‰€ä»¥éƒ½èƒ½æ¥æ”¶å¹¶å¤„ç†äº‹ä»¶:</p>
<ul>
<li>UIApplication</li>
<li>UIViewController</li>
<li>UIView</li>
</ul>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆç»§æ‰¿è‡ªUIResponderçš„ç±»å°±èƒ½å¤Ÿæ¥æ”¶å¹¶å¤„ç†äº‹ä»¶å‘¢ï¼Ÿå› ä¸ºUIResponderä¸­æä¾›äº†ä»¥ä¸‹4ä¸ªå¯¹è±¡æ–¹æ³•æ¥å¤„ç†è§¦æ‘¸äº‹ä»¶ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIResponder</span>å†…éƒ¨æä¾›äº†ä»¥ä¸‹æ–¹æ³•æ¥å¤„ç†äº‹ä»¶è§¦æ‘¸äº‹ä»¶</div><div class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event;</div><div class="line">- (<span class="keyword">void</span>)touchesMoved:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event;</div><div class="line">- (<span class="keyword">void</span>)touchesEnded:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event;</div><div class="line">- (<span class="keyword">void</span>)touchesCancelled:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event;</div><div class="line">åŠ é€Ÿè®¡äº‹ä»¶</div><div class="line">- (<span class="keyword">void</span>)motionBegan:(<span class="built_in">UIEventSubtype</span>)motion withEvent:(<span class="built_in">UIEvent</span> *)event;</div><div class="line">- (<span class="keyword">void</span>)motionEnded:(<span class="built_in">UIEventSubtype</span>)motion withEvent:(<span class="built_in">UIEvent</span> *)event;</div><div class="line">- (<span class="keyword">void</span>)motionCancelled:(<span class="built_in">UIEventSubtype</span>)motion withEvent:(<span class="built_in">UIEvent</span> *)event;</div><div class="line">è¿œç¨‹æ§åˆ¶äº‹ä»¶</div><div class="line">- (<span class="keyword">void</span>)remoteControlReceivedWithEvent:(<span class="built_in">UIEvent</span> *)event;</div></pre></td></tr></table></figure></p>
<h2 id="äº‹ä»¶çš„å¤„ç†"><a href="#äº‹ä»¶çš„å¤„ç†" class="headerlink" title="äº‹ä»¶çš„å¤„ç†"></a>äº‹ä»¶çš„å¤„ç†</h2><h3 id="è§¦æ‘¸äº‹ä»¶ï¼š"><a href="#è§¦æ‘¸äº‹ä»¶ï¼š" class="headerlink" title="è§¦æ‘¸äº‹ä»¶ï¼š"></a>è§¦æ‘¸äº‹ä»¶ï¼š</h3><p>ä¸‹é¢ä»¥UIViewä¸ºä¾‹æ¥è¯´æ˜è§¦æ‘¸äº‹ä»¶çš„å¤„ç†:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// UIViewæ˜¯UIResponderçš„å­ç±»ï¼Œå¯ä»¥è¦†ç›–ä¸‹åˆ—4ä¸ªæ–¹æ³•å¤„ç†ä¸åŒçš„è§¦æ‘¸äº‹ä»¶</span></div><div class="line"><span class="comment">// ä¸€æ ¹æˆ–è€…å¤šæ ¹æ‰‹æŒ‡å¼€å§‹è§¦æ‘¸viewï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨viewçš„ä¸‹é¢æ–¹æ³•</span></div><div class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line"><span class="comment">// ä¸€æ ¹æˆ–è€…å¤šæ ¹æ‰‹æŒ‡åœ¨viewä¸Šç§»åŠ¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨viewçš„ä¸‹é¢æ–¹æ³•ï¼ˆéšç€æ‰‹æŒ‡çš„ç§»åŠ¨ï¼Œä¼šæŒç»­è°ƒç”¨è¯¥æ–¹æ³•ï¼‰</span></div><div class="line">- (<span class="keyword">void</span>)touchesMoved:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line"><span class="comment">// ä¸€æ ¹æˆ–è€…å¤šæ ¹æ‰‹æŒ‡ç¦»å¼€viewï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨viewçš„ä¸‹é¢æ–¹æ³•- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event</span></div><div class="line"><span class="comment">// è§¦æ‘¸ç»“æŸå‰ï¼ŒæŸä¸ªç³»ç»Ÿäº‹ä»¶(ä¾‹å¦‚ç”µè¯å‘¼å…¥)ä¼šæ‰“æ–­è§¦æ‘¸è¿‡ç¨‹ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨viewçš„ä¸‹é¢æ–¹æ³•</span></div><div class="line">- (<span class="keyword">void</span>)touchesCancelled:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line"><span class="comment">// æç¤ºï¼štouchesä¸­å­˜æ”¾çš„éƒ½æ˜¯UITouchå¯¹è±¡</span></div></pre></td></tr></table></figure></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>ä»¥ä¸Šå››ä¸ªæ–¹æ³•æ˜¯ç”±ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡é‡å†™è¯¥æ–¹æ³•æ¥å¤„ç†ä¸€äº›äº‹ä»¶ã€‚å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼š<strong>å¦‚æœæƒ³å¤„ç†UIViewçš„è§¦æ‘¸äº‹ä»¶ï¼Œé‚£ä¹ˆå°±åœ¨UIViewä¸­é‡å†™ï¼›å¦‚æœæƒ³å¤„ç†UIViewControllerçš„è§¦æ‘¸äº‹ä»¶ï¼Œé‚£ä¹ˆå°±åœ¨UIViewControllerä¸­é‡å†™ã€‚</strong></li>
<li>å¦‚æœä¸¤æ ¹æ‰‹æŒ‡åŒæ—¶è§¦æ‘¸ä¸€ä¸ªviewï¼Œé‚£ä¹ˆviewåªä¼šè°ƒç”¨ä¸€æ¬¡<code>touchesBegan:withEvent:</code>æ–¹æ³•ï¼Œ<code>touches</code>å‚æ•°ä¸­è£…ç€2ä¸ª<code>UITouch</code>å¯¹è±¡.</li>
<li>å¦‚æœè¿™ä¸¤æ ¹æ‰‹æŒ‡ä¸€å‰ä¸€ååˆ†å¼€è§¦æ‘¸åŒä¸€ä¸ªviewï¼Œé‚£ä¹ˆviewä¼šåˆ†åˆ«è°ƒç”¨2æ¬¡<code>touchesBegan:withEvent:</code>æ–¹æ³•ï¼Œå¹¶ä¸”æ¯æ¬¡è°ƒç”¨æ—¶çš„<code>touches</code>å‚æ•°ä¸­åªåŒ…å«ä¸€ä¸ª<code>UITouch</code>å¯¹è±¡.</li>
</ul>
<h3 id="UITouch"><a href="#UITouch" class="headerlink" title="UITouch"></a>UITouch</h3><p>å½“ç”¨æˆ·ç”¨ä¸€æ ¹æ‰‹æŒ‡è§¦æ‘¸å±å¹•æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªä¸æ‰‹æŒ‡ç›¸å…³çš„UITouchå¯¹è±¡ã€‚</p>
<h4 id="UITouchä½œç”¨"><a href="#UITouchä½œç”¨" class="headerlink" title="UITouchä½œç”¨"></a>UITouchä½œç”¨</h4><ul>
<li>ä¿å­˜ç€è·Ÿæ‰‹æŒ‡ç›¸å…³çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è§¦æ‘¸çš„ä½ç½®ã€æ—¶é—´ã€é˜¶æ®µ</li>
<li>å½“æ‰‹æŒ‡ç§»åŠ¨æ—¶ï¼Œç³»ç»Ÿä¼šæ›´æ–°åŒä¸€ä¸ªUITouchå¯¹è±¡ï¼Œä½¿ä¹‹èƒ½å¤Ÿä¸€ç›´ä¿å­˜è¯¥æ‰‹æŒ‡åœ¨çš„è§¦æ‘¸ä½ç½®</li>
<li>å½“æ‰‹æŒ‡ç¦»å¼€å±å¹•æ—¶ï¼Œç³»ç»Ÿä¼šé”€æ¯ç›¸åº”çš„UITouchå¯¹è±¡</li>
</ul>
<h4 id="UITouchå±æ€§"><a href="#UITouchå±æ€§" class="headerlink" title="UITouchå±æ€§"></a>UITouchå±æ€§</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">è§¦æ‘¸äº§ç”Ÿæ—¶æ‰€å¤„çš„çª—å£</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">retain</span>) <span class="built_in">UIWindow</span> *window;</div><div class="line"></div><div class="line">è§¦æ‘¸äº§ç”Ÿæ—¶æ‰€å¤„çš„è§†å›¾</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">retain</span>) <span class="built_in">UIView</span> *view</div><div class="line">;</div><div class="line"></div><div class="line">çŸ­æ—¶é—´å†…ç‚¹æŒ‰å±å¹•çš„æ¬¡æ•°ï¼Œå¯ä»¥æ ¹æ®tapCountåˆ¤æ–­å•å‡»ã€åŒå‡»æˆ–æ›´å¤šçš„ç‚¹å‡»</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>) <span class="built_in">NSUInteger</span> tapCount;</div><div class="line"></div><div class="line">è®°å½•äº†è§¦æ‘¸äº‹ä»¶äº§ç”Ÿæˆ–å˜åŒ–æ—¶çš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>) <span class="built_in">NSTimeInterval</span> timestamp;</div><div class="line"></div><div class="line">å½“å‰è§¦æ‘¸äº‹ä»¶æ‰€å¤„çš„çŠ¶æ€</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>) <span class="built_in">UITouchPhase</span> phase;</div></pre></td></tr></table></figure>
<h4 id="UITouchæ–¹æ³•"><a href="#UITouchæ–¹æ³•" class="headerlink" title="UITouchæ–¹æ³•"></a>UITouchæ–¹æ³•</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">(<span class="built_in">CGPoint</span>)locationInView:(<span class="built_in">UIView</span> *)view;</div><div class="line"><span class="comment">// è¿”å›å€¼è¡¨ç¤ºè§¦æ‘¸åœ¨viewä¸Šçš„ä½ç½®</span></div><div class="line"><span class="comment">// è¿™é‡Œè¿”å›çš„ä½ç½®æ˜¯é’ˆå¯¹viewçš„åæ ‡ç³»çš„ï¼ˆä»¥viewçš„å·¦ä¸Šè§’ä¸ºåŸç‚¹(0, 0)ï¼‰</span></div><div class="line"><span class="comment">// è°ƒç”¨æ—¶ä¼ å…¥çš„viewå‚æ•°ä¸ºnilçš„è¯ï¼Œè¿”å›çš„æ˜¯è§¦æ‘¸ç‚¹åœ¨UIWindowçš„ä½ç½®</span></div><div class="line"></div><div class="line">(<span class="built_in">CGPoint</span>)previousLocationInView:(<span class="built_in">UIView</span> *)view;</div><div class="line"><span class="comment">// è¯¥æ–¹æ³•è®°å½•äº†å‰ä¸€ä¸ªè§¦æ‘¸ç‚¹çš„ä½ç½®</span></div></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨UITouchå®ç°UIViewçš„æ‹–æ‹½"><a href="#ä½¿ç”¨UITouchå®ç°UIViewçš„æ‹–æ‹½" class="headerlink" title="ä½¿ç”¨UITouchå®ç°UIViewçš„æ‹–æ‹½"></a>ä½¿ç”¨UITouchå®ç°UIViewçš„æ‹–æ‹½</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)touchesMoved:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event&#123; </div><div class="line">    <span class="comment">// æƒ³è®©æ§ä»¶éšç€æ‰‹æŒ‡ç§»åŠ¨è€Œç§»åŠ¨,ç›‘å¬æ‰‹æŒ‡ç§»åŠ¨ </span></div><div class="line">    <span class="comment">// è·å–UITouchå¯¹è±¡ </span></div><div class="line">    <span class="built_in">UITouch</span> *touch = [touches anyObject]; </div><div class="line">    <span class="comment">// è·å–å½“å‰ç‚¹çš„ä½ç½® </span></div><div class="line">    <span class="built_in">CGPoint</span> curP = [touch locationInView:<span class="keyword">self</span>]; </div><div class="line">    <span class="comment">// è·å–ä¸Šä¸€ä¸ªç‚¹çš„ä½ç½® </span></div><div class="line">    <span class="built_in">CGPoint</span> preP = [touch previousLocationInView:<span class="keyword">self</span>]; </div><div class="line">    <span class="comment">// è·å–å®ƒä»¬xè½´çš„åç§»é‡,æ¯æ¬¡éƒ½æ˜¯ç›¸å¯¹ä¸Šä¸€æ¬¡ </span></div><div class="line">    <span class="built_in">CGFloat</span> offsetX = curP.x - preP.x; </div><div class="line">    <span class="comment">// è·å–yè½´çš„åç§»é‡ </span></div><div class="line">    <span class="built_in">CGFloat</span> offsetY = curP.y - preP.y; </div><div class="line">    <span class="comment">// ä¿®æ”¹æ§ä»¶çš„å½¢å˜æˆ–è€…frame,center,å°±å¯ä»¥æ§åˆ¶æ§ä»¶çš„ä½ç½® </span></div><div class="line">    <span class="comment">// å½¢å˜ä¹Ÿæ˜¯ç›¸å¯¹ä¸Šä¸€æ¬¡å½¢å˜(å¹³ç§») </span></div><div class="line">    <span class="comment">// CGAffineTransformMakeTranslation:ä¼šæŠŠä¹‹å‰å½¢å˜ç»™æ¸…ç©º,é‡æ–°å¼€å§‹è®¾ç½®å½¢å˜å‚æ•° </span></div><div class="line">    <span class="comment">// make:ç›¸å¯¹äºæœ€åŸå§‹çš„ä½ç½®å½¢å˜ </span></div><div class="line">    <span class="comment">// CGAffineTransform t:ç›¸å¯¹è¿™ä¸ªtçš„å½¢å˜çš„åŸºç¡€ä¸Šå†å»å½¢å˜ </span></div><div class="line">    <span class="comment">// å¦‚æœç›¸å¯¹å“ªä¸ªå½¢å˜å†æ¬¡å½¢å˜,å°±ä¼ å…¥å®ƒçš„å½¢å˜ </span></div><div class="line">    <span class="keyword">self</span>.transform = <span class="built_in">CGAffineTransformTranslate</span>(<span class="keyword">self</span>.transform, offsetX, offsetY);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é€šè¿‡UITouchå¯¹è±¡è·å¾—å½“å‰ç‚¹å’Œä¸Šä¸€ä¸ªç‚¹çš„ä½ç½®ï¼Œæ±‚å¾—åç§»é‡</p>
<h2 id="iOSä¸­çš„äº‹ä»¶çš„äº§ç”Ÿå’Œä¼ é€’"><a href="#iOSä¸­çš„äº‹ä»¶çš„äº§ç”Ÿå’Œä¼ é€’" class="headerlink" title="iOSä¸­çš„äº‹ä»¶çš„äº§ç”Ÿå’Œä¼ é€’"></a>iOSä¸­çš„äº‹ä»¶çš„äº§ç”Ÿå’Œä¼ é€’</h2><h3 id="äº‹ä»¶çš„äº§ç”Ÿè¿‡ç¨‹"><a href="#äº‹ä»¶çš„äº§ç”Ÿè¿‡ç¨‹" class="headerlink" title="äº‹ä»¶çš„äº§ç”Ÿè¿‡ç¨‹"></a>äº‹ä»¶çš„äº§ç”Ÿè¿‡ç¨‹</h3><ol>
<li>å‘ç”Ÿè§¦æ‘¸äº‹ä»¶åï¼Œç³»ç»Ÿä¼šå°†è¯¥äº‹ä»¶åŠ å…¥åˆ°ä¸€ä¸ªç”±UIApplicationç®¡ç†çš„äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚</li>
<li>UIApplicationä¼šä»äº‹ä»¶é˜Ÿåˆ—ä¸­å–å‡ºæœ€å‰é¢çš„äº‹ä»¶ï¼Œå¹¶å°†äº‹ä»¶åˆ†å‘ä¸‹å»ä»¥ä¾¿å¤„ç†ï¼Œé€šå¸¸ï¼Œå…ˆå‘é€äº‹ä»¶ç»™åº”ç”¨ç¨‹åºçš„ä¸»çª—å£ï¼ˆkeyWindowï¼‰ã€‚</li>
<li>ä¸»çª—å£ä¼šåœ¨è§†å›¾å±‚æ¬¡ç»“æ„ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€åˆé€‚çš„è§†å›¾æ¥å¤„ç†è§¦æ‘¸äº‹ä»¶ï¼Œè¿™ä¹Ÿæ˜¯æ•´ä¸ªäº‹ä»¶å¤„ç†è¿‡ç¨‹çš„ç¬¬ä¸€æ­¥ã€‚<ol>
<li>é¦–å…ˆåˆ¤æ–­ä¸»çª—å£ï¼ˆkeyWindowï¼‰è‡ªå·±æ˜¯å¦èƒ½æ¥å—è§¦æ‘¸äº‹ä»¶ã€‚</li>
<li>åˆ¤æ–­è§¦æ‘¸ç‚¹æ˜¯å¦åœ¨è‡ªå·±èº«ä¸Šã€‚</li>
<li>å­æ§ä»¶æ•°ç»„ä¸­ä»åå¾€å‰éå†å­æ§ä»¶(åæ·»åŠ çš„viewåœ¨ä¸Šé¢ï¼Œé™ä½å¾ªç¯æ¬¡æ•°)ï¼Œé‡å¤å‰é¢çš„ä¸¤ä¸ªæ­¥éª¤ã€‚</li>
<li>å¦‚æœè§¦æ‘¸ç‚¹åœ¨å­æ§ä»¶ä¸Šï¼Œé‚£ä¹ˆé‡å¤3</li>
<li>å¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å­æ§ä»¶ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºè‡ªå·±æœ€åˆé€‚å¤„ç†è¿™ä¸ªäº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è‡ªå·±æ˜¯æœ€åˆé€‚çš„viewã€‚</li>
</ol>
</li>
<li>æ‰¾åˆ°æœ€åˆé€‚çš„viewåï¼Œ<strong>å°†è¿™ä¸ªviewå±‚å±‚è¿”å›ç»™viewController,viewcontrollerå°±ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥viewçš„touchesæ–¹æ³•å¤„ç†å…·ä½“çš„äº‹ä»¶</strong>ã€‚</li>
</ol>
<p>è§¦æ‘¸äº‹ä»¶çš„ä¼ é€’æ˜¯ä»çˆ¶æ§ä»¶ä¼ é€’åˆ°å­æ§ä»¶,ä¹Ÿå°±æ˜¯UIApplication-&gt;window-&gt;å¯»æ‰¾å¤„ç†äº‹ä»¶æœ€åˆé€‚çš„viewã€‚æ³¨æ„: å¦‚æœçˆ¶æ§ä»¶ä¸èƒ½æ¥å—è§¦æ‘¸äº‹ä»¶ï¼Œé‚£ä¹ˆå­æ§ä»¶å°±ä¸å¯èƒ½æ¥æ”¶åˆ°è§¦æ‘¸äº‹ä»¶ã€‚</p>
<h3 id="UIViewä¸èƒ½æ¥å—è§¦æ‘¸äº‹ä»¶çš„ä¸‰ç§æƒ…å†µ"><a href="#UIViewä¸èƒ½æ¥å—è§¦æ‘¸äº‹ä»¶çš„ä¸‰ç§æƒ…å†µ" class="headerlink" title="UIViewä¸èƒ½æ¥å—è§¦æ‘¸äº‹ä»¶çš„ä¸‰ç§æƒ…å†µ"></a>UIViewä¸èƒ½æ¥å—è§¦æ‘¸äº‹ä»¶çš„ä¸‰ç§æƒ…å†µ</h3><ul>
<li>ä¸å…è®¸äº¤äº’ï¼š<code>userInteractionEnabled = NO</code></li>
<li>éšè—ï¼šå¦‚æœæŠŠçˆ¶æ§ä»¶éšè—ï¼Œé‚£ä¹ˆå­æ§ä»¶ä¹Ÿä¼šéšè—ï¼Œéšè—çš„æ§ä»¶ä¸èƒ½æ¥å—äº‹ä»¶</li>
<li>é€æ˜åº¦ï¼šå¦‚æœè®¾ç½®ä¸€ä¸ªæ§ä»¶çš„é€æ˜åº¦&lt;0.01ï¼Œä¼šç›´æ¥å½±å“å­æ§ä»¶çš„é€æ˜åº¦ã€‚alphaï¼š0.0~0.01ä¸ºé€æ˜ã€‚</li>
</ul>
<p><strong>æ³¨ æ„</strong>:</p>
<ul>
<li>é»˜è®¤UIImageViewä¸èƒ½æ¥å—è§¦æ‘¸äº‹ä»¶ï¼Œå› ä¸ºä¸å…è®¸äº¤äº’ï¼Œå³<code>userInteractionEnabled = NO</code>ï¼Œæ‰€ä»¥å¦‚æœå¸Œæœ›UIImageViewå¯ä»¥äº¤äº’ï¼Œéœ€è¦<code>userInteractionEnabled = YES</code>ã€‚</li>
<li>ä¸ç®¡è§†å›¾èƒ½ä¸èƒ½å¤„ç†äº‹ä»¶ï¼Œåªè¦ç‚¹å‡»äº†è§†å›¾å°±éƒ½ä¼šäº§ç”Ÿäº‹ä»¶ï¼Œå…³é”®çœ‹è¯¥äº‹ä»¶æ˜¯ç”±è°æ¥å¤„ç†ï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè§†å›¾ä¸èƒ½å¤„ç†äº‹ä»¶ï¼Œç‚¹å‡»è§†å›¾ï¼Œè¿˜æ˜¯ä¼šäº§ç”Ÿä¸€ä¸ªè§¦æ‘¸äº‹ä»¶ï¼Œåªæ˜¯è¯¥äº‹ä»¶ä¸ä¼šç”±è¢«ç‚¹å‡»çš„è§†å›¾å¤„ç†è€Œå·²ï¼</li>
</ul>
<h3 id="æ‰¾åˆ°æœ€åˆé€‚æ§ä»¶çš„æ–¹æ³•"><a href="#æ‰¾åˆ°æœ€åˆé€‚æ§ä»¶çš„æ–¹æ³•" class="headerlink" title="æ‰¾åˆ°æœ€åˆé€‚æ§ä»¶çš„æ–¹æ³•"></a>æ‰¾åˆ°æœ€åˆé€‚æ§ä»¶çš„æ–¹æ³•</h3><h4 id="hitTestï¼šwithEventï¼š"><a href="#hitTestï¼šwithEventï¼š" class="headerlink" title="hitTestï¼šwithEventï¼š"></a>hitTestï¼šwithEventï¼š</h4><p>åªè¦äº‹ä»¶ä¸€ä¼ é€’ç»™ä¸€ä¸ªæ§ä»¶,è¿™ä¸ªæ§ä»¶å°±ä¼šè°ƒç”¨ä»–è‡ªå·±çš„<code>hitTestï¼šwithEventï¼š</code>æ–¹æ³•.ç”¨æ¥å¯»æ‰¾å¹¶è¿”å›æœ€åˆé€‚çš„view(èƒ½å¤Ÿå“åº”äº‹ä»¶çš„é‚£ä¸ªæœ€åˆé€‚çš„view)</p>
<h4 id="æ‹¦æˆªäº‹ä»¶"><a href="#æ‹¦æˆªäº‹ä»¶" class="headerlink" title="æ‹¦æˆªäº‹ä»¶"></a>æ‹¦æˆªäº‹ä»¶</h4><p>ä¸ç®¡ç‚¹å‡»å“ªé‡Œï¼Œæœ€åˆé€‚çš„viewéƒ½æ˜¯<code>hitTestï¼šwithEventï¼š</code>æ–¹æ³•ä¸­è¿”å›çš„é‚£ä¸ªviewã€‚å› æ­¤ï¼Œå¯ä»¥é€šè¿‡é‡å†™<code>hitTestï¼šwithEventï¼š</code>æ–¹æ³•ï¼Œè¿”å›æŒ‡å®šçš„viewä½œä¸ºæœ€åˆé€‚çš„viewï¼Œè¿™æ ·å°±å®Œæˆäº†äº‹ä»¶çš„æ‹¦æˆªã€‚å¦‚æœä¸æƒ³æ‹¦æˆªï¼Œå°±è°ƒç”¨<code>[super touchesMoved:touches withEvent:event];</code></p>
<h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h4><ul>
<li><strong><code>hitTestï¼šwithEventï¼š</code>æ˜¯UIViewçš„æ–¹æ³•ï¼Œä¸æ˜¯UIResponseçš„æ–¹æ³•ï¼æ‰€ä»¥Controlleré‡Œä¸èƒ½ç”¨ã€‚è¿™ç‚¹å¾ˆé‡è¦ï¼è¿™è¯´æ˜åªèƒ½æ§åˆ¶UIViewé‡Œçš„å­View</strong></li>
<li>ä¸ç®¡è¿™ä¸ªæ§ä»¶èƒ½ä¸èƒ½å¤„ç†äº‹ä»¶ï¼Œä¹Ÿä¸ç®¡è§¦æ‘¸ç‚¹åœ¨ä¸åœ¨è¿™ä¸ªæ§ä»¶ä¸Šï¼Œäº‹ä»¶éƒ½ä¼šå…ˆä¼ é€’ç»™è¿™ä¸ªæ§ä»¶ï¼Œéšåå†è°ƒç”¨<code>hitTest:withEvent:</code>æ–¹æ³•ã€‚<code>hitTest</code>çš„è¿™ä¸ª<code>CGPoint point</code>è¡¨ç¤ºå½“å‰æ‰‹æŒ‡è§¦æ‘¸çš„ç‚¹ï¼Œå…¶å€¼æ˜¯ä»¥æ–¹æ³•è°ƒç”¨è€…çš„å·¦ä¸Šè§’(0,0)ä¸ºåŸºå‡†çš„(å°±æ˜¯touchçš„<code>locationInView:</code>æ–¹æ³•çš„è¿”å›å€¼)ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åŒçš„æ§ä»¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªpointéƒ½æ˜¯ç»è¿‡è®¡ç®—è€Œäº§ç”Ÿçš„ä¸åŒçš„å€¼ã€‚</li>
<li><code>hitTestï¼šwithEventï¼š</code>æ‰¾åˆ°æœ€ä½³Viewåï¼Œä¼šä¸€å±‚å±‚è¿”å›ï¼Œå°†è¿™ä¸ªViewè¿”å›ç»™ViewControllerã€‚å¦‚<code>hitTest:withEvent:</code>æ–¹æ³•ä¸­è¿”å›<code>nil</code>ï¼Œé‚£ä¹ˆè°ƒç”¨è¯¥æ–¹æ³•çš„æ§ä»¶æœ¬èº«å’Œå…¶å­æ§ä»¶éƒ½ä¸æ˜¯æœ€åˆé€‚çš„viewï¼Œä¹Ÿå°±æ˜¯åœ¨è‡ªå·±èº«ä¸Šæ²¡æœ‰æ‰¾åˆ°æ›´åˆé€‚çš„viewã€‚é‚£ä¹ˆæœ€åˆé€‚çš„viewå°±æ˜¯è¯¥æ§ä»¶çš„çˆ¶æ§ä»¶ã€‚</li>
</ul>
<h4 id="æŠ€å·§"><a href="#æŠ€å·§" class="headerlink" title="æŠ€å·§"></a>æŠ€å·§</h4><p>æƒ³è®©è°æˆä¸ºæœ€åˆé€‚çš„viewå°±é‡å†™è°è‡ªå·±çš„çˆ¶æ§ä»¶çš„<code>hitTest:withEvent:</code>æ–¹æ³•è¿”å›æŒ‡å®šçš„å­æ§ä»¶ã€‚è¿™é‡Œåˆè¦æ³¨æ„ï¼Œæœ€å¥½ä¸è¦åœ¨å­æ§ä»¶å†…<code>return self</code>ã€‚å› ä¸ºï¼Œåœ¨éå†å­æ§ä»¶çš„æ—¶å€™ï¼Œå¾ˆæœ‰å¯èƒ½æ²¡æœ‰éå†åˆ°ä½ çœŸæ­£æƒ³è¦è¿”å›çš„é‚£ä¸ªæ§ä»¶ï¼Œå°±åœ¨å…¶ä»–æ§ä»¶å·²ç»returnäº†ã€‚</p>
<p>ä¾‹å¦‚ï¼šwhiteViewæœ‰redViewå’ŒgreenViewä¸¤ä¸ªå­æ§ä»¶ã€‚redViewå…ˆæ·»åŠ ï¼ŒgreenViewåæ·»åŠ ã€‚å¦‚æœè¦æ±‚æ— è®ºç‚¹å‡»é‚£é‡Œéƒ½è¦è®©redViewä½œä¸ºæœ€åˆé€‚çš„viewï¼ˆæŠŠäº‹ä»¶äº¤ç»™redViewæ¥å¤„ç†ï¼‰é‚£ä¹ˆåªèƒ½åœ¨whiteViewçš„<code>hitTest:withEvent:</code>æ–¹æ³•ä¸­<code>return self.subViews[0]</code>;è¿™ç§æƒ…å†µä¸‹åœ¨redViewçš„<code>hitTest:withEvent:</code>æ–¹æ³•ä¸­<code>return self;</code>æ˜¯ä¸å¥½ä½¿çš„ï¼</p>
<h4 id="hitTest-withEventï¼šçš„åº•å±‚å®ç°"><a href="#hitTest-withEventï¼šçš„åº•å±‚å®ç°" class="headerlink" title="hitTest:withEventï¼šçš„åº•å±‚å®ç°"></a>hitTest:withEventï¼šçš„åº•å±‚å®ç°</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"WSWindow.h"</span></span></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">WSWindow</span></span></div><div class="line"><span class="comment">// ä»€ä¹ˆæ—¶å€™è°ƒç”¨:åªè¦äº‹ä»¶ä¸€ä¼ é€’ç»™ä¸€ä¸ªæ§ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ§ä»¶å°±ä¼šè°ƒç”¨è‡ªå·±çš„è¿™ä¸ªæ–¹æ³•</span></div><div class="line"><span class="comment">// ä½œç”¨:å¯»æ‰¾å¹¶è¿”å›æœ€åˆé€‚çš„view</span></div><div class="line"><span class="comment">// UIApplication -&gt; [UIWindow hitTest:withEvent:]å¯»æ‰¾æœ€åˆé€‚çš„viewå‘Šè¯‰ç³»ç»Ÿ</span></div><div class="line"><span class="comment">// point:å½“å‰æ‰‹æŒ‡è§¦æ‘¸çš„ç‚¹</span></div><div class="line"><span class="comment">// point:æ˜¯æ–¹æ³•è°ƒç”¨è€…åæ ‡ç³»ä¸Šçš„ç‚¹</span></div><div class="line">- (<span class="built_in">UIView</span> *)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event&#123;</div><div class="line">    <span class="comment">// 1.åˆ¤æ–­ä¸‹çª—å£èƒ½å¦æ¥æ”¶äº‹ä»¶</span></div><div class="line">     <span class="keyword">if</span> (<span class="keyword">self</span>.userInteractionEnabled == <span class="literal">NO</span> || <span class="keyword">self</span>.hidden == <span class="literal">YES</span> ||  <span class="keyword">self</span>.alpha &lt;= <span class="number">0.01</span>) <span class="keyword">return</span> <span class="literal">nil</span>; </div><div class="line">    <span class="comment">// 2.åˆ¤æ–­ä¸‹ç‚¹åœ¨ä¸åœ¨çª—å£ä¸Š </span></div><div class="line">    <span class="comment">// ä¸åœ¨çª—å£ä¸Š </span></div><div class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span> pointInside:point withEvent:event] == <span class="literal">NO</span>) <span class="keyword">return</span> <span class="literal">nil</span>; </div><div class="line">    <span class="comment">// 3.ä»åå¾€å‰éå†å­æ§ä»¶æ•°ç»„ </span></div><div class="line">    <span class="keyword">int</span> count = (<span class="keyword">int</span>)<span class="keyword">self</span>.subviews.count; </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = count - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123; </div><div class="line">    	<span class="comment">// è·å–å­æ§ä»¶</span></div><div class="line">    	<span class="built_in">UIView</span> *childView = <span class="keyword">self</span>.subviews[i]; </div><div class="line">    	<span class="comment">// åæ ‡ç³»çš„è½¬æ¢,æŠŠçª—å£ä¸Šçš„ç‚¹è½¬æ¢ä¸ºå­æ§ä»¶ä¸Šçš„ç‚¹ </span></div><div class="line">    	<span class="comment">// æŠŠè‡ªå·±æ§ä»¶ä¸Šçš„ç‚¹è½¬æ¢æˆå­æ§ä»¶ä¸Šçš„ç‚¹ </span></div><div class="line">    	<span class="built_in">CGPoint</span> childP = [<span class="keyword">self</span> convertPoint:point toView:childView]; </div><div class="line">    	<span class="built_in">UIView</span> *fitView = [childView hitTest:childP withEvent:event]; </div><div class="line">    	<span class="keyword">if</span> (fitView) &#123;</div><div class="line">    		<span class="comment">// å¦‚æœèƒ½æ‰¾åˆ°æœ€åˆé€‚çš„view </span></div><div class="line">    		<span class="keyword">return</span> fitView; </div><div class="line">    	&#125;</div><div class="line">    &#125; </div><div class="line">    <span class="comment">// 4.æ²¡æœ‰æ‰¾åˆ°æ›´åˆé€‚çš„viewï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ¯”è‡ªå·±æ›´åˆé€‚çš„view </span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">// ä½œç”¨:åˆ¤æ–­ä¸‹ä¼ å…¥è¿‡æ¥çš„ç‚¹åœ¨ä¸åœ¨æ–¹æ³•è°ƒç”¨è€…çš„åæ ‡ç³»ä¸Š</span></div><div class="line"><span class="comment">// point:æ˜¯æ–¹æ³•è°ƒç”¨è€…åæ ‡ç³»ä¸Šçš„ç‚¹</span></div><div class="line"><span class="comment">//- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event&#123;</span></div><div class="line"><span class="comment">//		return NO;</span></div><div class="line"><span class="comment">//&#125;</span></div><div class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event&#123; </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>,__func__);</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p><code>hit:withEvent:</code>æ–¹æ³•åº•å±‚ä¼šè°ƒç”¨<code>pointInside:withEvent:</code>æ–¹æ³•åˆ¤æ–­ç‚¹åœ¨ä¸åœ¨æ–¹æ³•è°ƒç”¨è€…çš„åæ ‡ç³»ä¸Šã€‚</p>
<h4 id="pointInside-withEvent-æ–¹æ³•"><a href="#pointInside-withEvent-æ–¹æ³•" class="headerlink" title="pointInside:withEvent:æ–¹æ³•"></a>pointInside:withEvent:æ–¹æ³•</h4><p><code>pointInside:withEvent:</code>æ–¹æ³•åˆ¤æ–­ç‚¹åœ¨ä¸åœ¨å½“å‰viewä¸Šï¼ˆæ–¹æ³•è°ƒç”¨è€…çš„åæ ‡ç³»ä¸Šï¼‰å¦‚æœè¿”å›YESï¼Œä»£è¡¨ç‚¹åœ¨æ–¹æ³•è°ƒç”¨è€…çš„åæ ‡ç³»ä¸Š;è¿”å›NOä»£è¡¨ç‚¹ä¸åœ¨æ–¹æ³•è°ƒç”¨è€…çš„åæ ‡ç³»ä¸Šï¼Œé‚£ä¹ˆæ–¹æ³•è°ƒç”¨è€…ä¹Ÿå°±ä¸èƒ½å¤„ç†äº‹ä»¶ã€‚</p>
<h2 id="äº‹ä»¶çš„å“åº”"><a href="#äº‹ä»¶çš„å“åº”" class="headerlink" title="äº‹ä»¶çš„å“åº”"></a>äº‹ä»¶çš„å“åº”</h2><h3 id="äº‹ä»¶çš„ä¼ é€’ä¸å“åº”åŒºåˆ«"><a href="#äº‹ä»¶çš„ä¼ é€’ä¸å“åº”åŒºåˆ«" class="headerlink" title="äº‹ä»¶çš„ä¼ é€’ä¸å“åº”åŒºåˆ«"></a>äº‹ä»¶çš„ä¼ é€’ä¸å“åº”åŒºåˆ«</h3><p>å‰é¢è¯´åˆ°äº†ï¼Œå½“ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿåï¼Œäº‹ä»¶ä¼šä»çˆ¶æ§ä»¶ä¼ ç»™å­æ§ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ç”±UIApplication -&gt; UIWindow -&gt; UIView -&gt; initial view,ä»¥ä¸Šå°±æ˜¯äº‹ä»¶çš„ä¼ é€’ï¼Œä¹Ÿå°±æ˜¯å¯»æ‰¾æœ€åˆé€‚çš„viewçš„è¿‡ç¨‹ã€‚</p>
<p>åœ¨æ‰¾åˆ°äº†æœ€åˆé€‚çš„viewåï¼Œæ¥ä¸‹æ¥å°±æ˜¯äº‹ä»¶çš„å“åº”è¿‡ç¨‹ã€‚å“åº”è¿‡ç¨‹æ˜¯ä¼ é€’è¿‡ç¨‹çš„é€†è¿‡ç¨‹ã€‚åœ¨äº‹ä»¶çš„å“åº”ä¸­ï¼Œå¦‚æœæŸä¸ªæ§ä»¶å®ç°äº†<code>touches...</code>æ–¹æ³•ï¼Œåˆ™è¿™ä¸ªäº‹ä»¶å°†ç”±è¯¥æ§ä»¶æ¥æ¥å—ï¼Œå¦‚æœè°ƒç”¨äº†<code>[super touchesâ€¦.]</code>;å°±ä¼šå°†äº‹ä»¶é¡ºç€å“åº”è€…é“¾æ¡å¾€ä¸Šä¼ é€’ï¼Œä¼ é€’ç»™ä¸Šä¸€ä¸ªå“åº”è€…ï¼›æ¥ç€å°±ä¼šè°ƒç”¨ä¸Šä¸€ä¸ªå“åº”è€…çš„<code>touchesâ€¦.</code>æ–¹æ³•ã€‚</p>
<p>touchesé»˜è®¤åšæ³•æ˜¯æŠŠäº‹ä»¶é¡ºç€å“åº”è€…é“¾æ¡å‘ä¸ŠæŠ›ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"WSView.h"</span></span></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">WSView</span> </span></div><div class="line"><span class="comment">//åªè¦ç‚¹å‡»æ§ä»¶,å°±ä¼šè°ƒç”¨touchBegin,å¦‚æœæ²¡æœ‰é‡å†™è¿™ä¸ªæ–¹æ³•,è‡ªå·±å¤„ç†ä¸äº†è§¦æ‘¸äº‹ä»¶</span></div><div class="line"><span class="comment">// ä¸Šä¸€ä¸ªå“åº”è€…å¯èƒ½æ˜¯çˆ¶æ§ä»¶</span></div><div class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event&#123; </div><div class="line">	<span class="comment">// é»˜è®¤ä¼šæŠŠäº‹ä»¶ä¼ é€’ç»™ä¸Šä¸€ä¸ªå“åº”è€…,ä¸Šä¸€ä¸ªå“åº”è€…æ˜¯çˆ¶æ§ä»¶,äº¤ç»™çˆ¶æ§ä»¶å¤„ç†</span></div><div class="line">	[<span class="keyword">super</span> touchesBegan:touches withEvent:event]; </div><div class="line">	<span class="comment">// æ³¨æ„ä¸æ˜¯è°ƒç”¨çˆ¶æ§ä»¶çš„touchesæ–¹æ³•ï¼Œè€Œæ˜¯è°ƒç”¨çˆ¶ç±»çš„touchesæ–¹æ³•</span></div><div class="line">	<span class="comment">// superæ˜¯çˆ¶ç±» superviewæ˜¯çˆ¶æ§ä»¶ </span></div><div class="line">	<span class="comment">// ä¸è¿‡superå†…è¿˜æ˜¯è¦è°ƒç”¨superviewçš„touchçš„æ–¹æ³•æ¥äº¤ç»™ä¸Šä¸€ä¸ªå“åº”è€…çš„ã€‚</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>äº‹ä»¶çš„ä¼ é€’æ˜¯ä»ä¸Šåˆ°ä¸‹ï¼ˆçˆ¶æ§ä»¶åˆ°å­æ§ä»¶ï¼‰ï¼Œäº‹ä»¶çš„å“åº”æ˜¯ä»ä¸‹åˆ°ä¸Šï¼ˆé¡ºç€å“åº”è€…é“¾æ¡å‘ä¸Šä¼ é€’ï¼šå­æ§ä»¶åˆ°çˆ¶æ§ä»¶ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>ViewControllerä¸­å¦‚æœè‡ªå®šä¹‰äº†<code>touchesBegan:withEvent:</code>æ–¹æ³•ï¼Œä»»ä½•æƒ…å†µéƒ½ä¼šæ‰§è¡Œã€‚åªæœ‰åœ¨UIViewä¸­å®šä¹‰çš„<code>touchesBegan:withEvent:</code>æ–¹æ³•ï¼Œæ‰ä¼šæ ¹æ®<code>hitTestï¼šwithEventï¼š</code>çš„ä¸åŒè¿”å›ï¼Œæ‰§è¡Œè¿”å›Viewçš„<code>touchesBegan:withEvent:</code>æ–¹æ³•ã€‚ä¼°è®¡æ˜¯å› ä¸ºUIViewControllerä¸­æ²¡æœ‰<code>hitTestï¼šwithEventï¼š</code>æ–¹æ³•çš„ç¼˜æ•…ã€‚</p>
<h3 id="ä¸€ä¸ªäº‹ä»¶å¤šä¸ªå¯¹è±¡å¤„ç†"><a href="#ä¸€ä¸ªäº‹ä»¶å¤šä¸ªå¯¹è±¡å¤„ç†" class="headerlink" title="ä¸€ä¸ªäº‹ä»¶å¤šä¸ªå¯¹è±¡å¤„ç†"></a>ä¸€ä¸ªäº‹ä»¶å¤šä¸ªå¯¹è±¡å¤„ç†</h3><p>å› ä¸ºç³»ç»Ÿé»˜è®¤åšæ³•(superæ–¹æ³•)æ˜¯æŠŠäº‹ä»¶ä¸ŠæŠ›ç»™çˆ¶æ§ä»¶ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡é‡å†™è‡ªå·±çš„touchesæ–¹æ³•å’Œçˆ¶æ§ä»¶çš„touchesæ–¹æ³•æ¥è¾¾åˆ°ä¸€ä¸ªäº‹ä»¶å¤šä¸ªå¯¹è±¡å¤„ç†çš„ç›®çš„ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event&#123; </div><div class="line">	<span class="comment">// 1.è‡ªå·±å…ˆå¤„ç†äº‹ä»¶...</span></div><div class="line">	<span class="built_in">NSLog</span>(<span class="string">@"do somthing..."</span>);</div><div class="line">	<span class="comment">// 2.å†è°ƒç”¨ç³»ç»Ÿçš„é»˜è®¤åšæ³•ï¼Œå†æŠŠäº‹ä»¶äº¤ç»™ä¸Šä¸€ä¸ªå“åº”è€…å¤„ç†</span></div><div class="line">	[<span class="keyword">super</span> touchesBegan:touches withEvent:event]; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Demo è¯·çœ‹UIGestureRecognizer</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[CALayerçš„transform]]></title>
      <url>http://zhang759740844.github.io/2016/09/02/CALayer%E7%9A%84transform%E5%B1%9E%E6%80%A7/</url>
      <content type="html"><![CDATA[<p>åœ¨<a href="https://zhang759740844.github.io/2016/08/05/UICollectionView/">CollectionViewçš„ä½¿ç”¨</a>ä¸­ï¼Œæœ‰ä¸ºcellæ·»åŠ transformå±æ€§ï¼Œå®ç°è‡ªå®šä¹‰åŠ¨ç”»ã€‚ç°åœ¨ï¼Œè¯¦ç»†äº†è§£ä¸‹ViewåŠå…¶Layerçš„transformå±æ€§ã€‚</p>
<a id="more"></a>
<h2 id="UIViewçš„transformå±æ€§"><a href="#UIViewçš„transformå±æ€§" class="headerlink" title="UIViewçš„transformå±æ€§"></a>UIViewçš„transformå±æ€§</h2><p>transformæ˜¯viewçš„ä¸€ä¸ªé‡è¦å±æ€§,å®ƒåœ¨çŸ©é˜µå±‚é¢ä¸Šæ”¹å˜viewçš„æ˜¾â½°çŠ¶æ€,èƒ½å®ç°viewçš„ç¼©æ”¾ã€æ—‹è½¬ã€å¹³ç§»ç­‰åŠŸèƒ½ã€‚transformæ˜¯<code>CGAffineTransform</code>ç±»å‹çš„ã€‚</p>
<h3 id="transformç»“æ„"><a href="#transformç»“æ„" class="headerlink" title="transformç»“æ„"></a>transformç»“æ„</h3><p>transformæ˜¯ä¸€ä¸ª<code>CGAffineTransform</code>ç±»å‹ï¼Œç»“æ„å¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> <span class="built_in">CGAffineTransform</span> &#123;</div><div class="line">  <span class="built_in">CGFloat</span> a, b, c, d;</div><div class="line">  <span class="built_in">CGFloat</span> tx, ty;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>CGAffineTransformå®é™…ä¸Šæ˜¯ä¸€ä¸ªçŸ©é˜µ<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">| a,  b,  <span class="number">0</span> |</div><div class="line">| c,  d,  <span class="number">0</span> |</div><div class="line">| tx, ty, <span class="number">1</span> |</div></pre></td></tr></table></figure></p>
<p>ç”±äºtransformåªæœ‰ä¸¤ç»´ï¼Œéœ€è¦ä¸€ä¸ª3é˜¶çŸ©é˜µæ¥è¡¨ç¤ºå…¶ç¼©æ”¾ä»¥åŠå¹³ç§»çš„å˜åŒ–ã€‚</p>
<p>åæ ‡å˜æ¢è¿‡ç¨‹ï¼š<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">                    | a,  b,  0 |</div><div class="line">&#123;x',y',1&#125;=&#123;x,y,1&#125; x | c,  d,  0 |</div><div class="line">                    | tx, ty, 1 |</div><div class="line">                    </div><div class="line">==&gt;</div><div class="line"></div><div class="line">xn=ax+cy+tx;</div><div class="line">yn=bx+dy+ty;</div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªçŸ©é˜µçš„ç¬¬ä¸‰åˆ—æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æ¯æ¬¡å˜æ¢æ—¶ï¼Œåªéœ€ä¼ å…¥å‰ä¸¤åˆ—çš„å…­ä¸ªå‚æ•°[a,b,c,d,tx,ty]å³å¯ã€‚</p>
<h3 id="transformæ–¹æ³•"><a href="#transformæ–¹æ³•" class="headerlink" title="transformæ–¹æ³•"></a>transformæ–¹æ³•</h3><p>åœ¨<code>CGAffineTransform</code>çš„ç”Ÿæˆå‡½æ•°ä¸­ï¼Œå¤§å¤šæ˜¯ä¸¤ä¸¤å¯¹åº”çš„ï¼Œä¸€ä¸ªå¸¦<br>makeå­—æ ·ï¼Œä¸€ä¸ªä¸å¸¦ã€‚å¸¦makeå­—æ ·çš„æ˜¯ç›´æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„<code>CGAffineTransform</code>ï¼Œä¸å¸¦makeå­—æ ·çš„åˆ™æ˜¯åœ¨ä¸€ä¸ª<code>CGAffineTransform</code>çš„åŸºç¡€ä¸Šç”Ÿæˆæ–°çš„ã€‚å‡½æ•°è¿”å›å€¼å‡æ˜¯<code>CGAffineTransform</code>ç±»å‹ã€‚</p>
<p>å¤šä¸ª<code>CGAffineTransform</code>å¯¹è±¡èµ‹ç»™viewï¼Œæœ€ç»ˆåªæ‰§è¡Œæœ€åä¸€ä¸ªåŠ¨ç”»ï¼Œå¤šä¸ªåŠ¨ç”»éœ€è¦ç»„åˆåœ¨ä¸€èµ·ã€‚</p>
<h4 id="scale"><a href="#scale" class="headerlink" title="scale"></a>scale</h4><p>å®ç°çš„æ˜¯æ”¾å¤§å’Œç¼©å°:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CGAffineTransformScale</span>(<span class="built_in">CGAffineTransform</span> t,</div><div class="line">  <span class="built_in">CGFloat</span> sx, <span class="built_in">CGFloat</span> sy)ï¼›</div><div class="line"><span class="built_in">CGAffineTransformMakeScale</span>(<span class="built_in">CGFloat</span> sx, <span class="built_in">CGFloat</span> sy)ï¼›</div></pre></td></tr></table></figure></p>
<p>ç”Ÿæˆæ–°çš„transformç›¸å½“äºå°†<code>t&#39; = [sx ï¼Œ0 ï¼Œ0ï¼Œsy ï¼Œ0ï¼Œ 0]</code>è¿™å…­ä¸ªå‚æ•°ä»£å…¥çŸ©é˜µä¸­,å³æ”¹å˜aå’Œdã€‚</p>
<h4 id="rotate"><a href="#rotate" class="headerlink" title="rotate"></a>rotate</h4><p>å®ç°çš„æ˜¯æ—‹è½¬ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CGAffineTransformRotate</span>(<span class="built_in">CGAffineTransform</span> t,</div><div class="line">  <span class="built_in">CGFloat</span> angle)</div><div class="line"><span class="built_in">CGAffineTransformMakeRotation</span>(<span class="built_in">CGFloat</span> angle)ï¼›</div></pre></td></tr></table></figure></p>
<p>angleä¸ºè§’åº¦ï¼Œangle=Ï€åˆ™æ—‹è½¬180åº¦ã€‚çŸ©é˜µçš„å…­ä¸ªå‚æ•°ä¸º<code>t&#39; =  [ cos(angle)ï¼Œsin(angle)ï¼Œ-sin(angle)ï¼Œcos(angle) 0ï¼Œ0]ï¼›</code></p>
<h4 id="translate"><a href="#translate" class="headerlink" title="translate"></a>translate</h4><p>å®ç°çš„æ˜¯å¹³ç§»ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CGAffineTransformTranslate</span>(<span class="built_in">CGAffineTransform</span> t,</div><div class="line">  <span class="built_in">CGFloat</span> tx, <span class="built_in">CGFloat</span> ty)ï¼›</div><div class="line"><span class="built_in">CGAffineTransformMakeTranslation</span>(<span class="built_in">CGFloat</span> tx,</div><div class="line">  <span class="built_in">CGFloat</span> ty)ï¼›</div></pre></td></tr></table></figure></p>
<p>çŸ©é˜µçš„å…­ä¸ªå‚æ•°ä¸º<code>t&#39; = [1ï¼Œ0ï¼Œ0ï¼Œ1ï¼Œtxï¼Œty] ï¼›</code>ä»£å…¥å…¬å¼ï¼Œ<code>xn=x+tx,yn=y+ty</code></p>
<h4 id="å¤åŸ"><a href="#å¤åŸ" class="headerlink" title="å¤åŸ"></a>å¤åŸ</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">view.transformï¼<span class="built_in">CGAffineTransformIdentity</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šè¿°çš„å„ç§åŠ¨ç”»çš„å˜åŒ–éƒ½æ˜¯ä»¥åŸå§‹å›¾åƒä¸ºåŸºå‡†çš„ï¼Œè€Œä¸æ˜¯åœ¨å˜åŒ–åç»§ç»­å˜åŒ–ã€‚<code>CGAffineTransformIdentity</code>å°†viewä»å½“å‰çŠ¶æ€å¤åŸå›viewæœ€åˆå§‹çš„çŠ¶æ€ã€‚</p>
<h2 id="CALayerçš„transformå±æ€§"><a href="#CALayerçš„transformå±æ€§" class="headerlink" title="CALayerçš„transformå±æ€§"></a>CALayerçš„transformå±æ€§</h2><h3 id="transformç»“æ„-1"><a href="#transformç»“æ„-1" class="headerlink" title="transformç»“æ„"></a>transformç»“æ„</h3><p>CALayerçš„transformæ˜¯ä¸€ä¸ª<code>CATransform3D</code>ç»“æ„ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> <span class="built_in">CATransform3D</span></div><div class="line">&#123;</div><div class="line">  <span class="built_in">CGFloat</span> m11, m12, m13, m14;</div><div class="line">  <span class="built_in">CGFloat</span> m21, m22, m23, m24;</div><div class="line">  <span class="built_in">CGFloat</span> m31, m32, m33, m34;</div><div class="line">  <span class="built_in">CGFloat</span> m41, m42, m43, m44;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>æœ‰åˆ«äº<code>CGAffineTransform</code>,<code>CATransform3D</code>æ˜¯ä¸€ä¸ªä¸‰ç»´å˜åŒ–ï¼Œéœ€è¦ä¸€ä¸ª4é˜¶çŸ©é˜µè¡¨ç¤ºã€‚å…¶ä»–ç±»ä¼¼ï¼Œå†æ¬¡ä¸è¡¨ã€‚</p>
<h3 id="transformæ–¹æ³•-1"><a href="#transformæ–¹æ³•-1" class="headerlink" title="transformæ–¹æ³•"></a>transformæ–¹æ³•</h3><p>CALayerçš„transformæ–¹æ³•å’ŒViewçš„transformåŸºæœ¬ä¸€è‡´ã€‚ä¸¾å‡ ç‚¹ä¸åŒï¼š</p>
<ul>
<li><p>CALayerç”±äºæœ‰zè½´ï¼Œå› æ­¤å¯¹ä¸åŒå›¾å±‚ä½¿ç”¨<code>CATransform3DMakeTranslation (CGFloat tx, CGFloat ty, CGFloat tz)</code>æ–¹æ³•çš„æ—¶å€™å¯ä»¥é€šè¿‡æ”¹å˜tzçš„å€¼ï¼Œæ¥å®ç°å›¾å±‚çš„è¦†ç›–ã€‚å¯¹äºtzæ¥è¯´ï¼Œå€¼è¶Šå¤§ï¼Œé‚£ä¹ˆå›¾å±‚å°±è¶Šå¾€å¤–ï¼ˆæ¥è¿‘å±å¹•ï¼‰ï¼Œå€¼è¶Šå°ï¼Œå›¾å±‚è¶Šå¾€é‡Œï¼ˆå±å¹•é‡Œï¼‰ã€‚</p>
</li>
<li><p>ç”±äºå›¾åƒæ˜¯ä»æ­£é¢æŠ•å½±ï¼Œç›´æ¥ç»•ç€xæˆ–yè½´æ—‹è½¬è¾¾ä¸åˆ°é€è§†çš„æ•ˆæœï¼Œå¦‚æœè¦è¾¾åˆ°é€è§†æ•ˆæœï¼Œéœ€è¦æ”¹å˜<code>m34</code>(å…¶å®æ”¹å˜m14ï¼Œm24ä¹Ÿèƒ½è¾¾åˆ°æ•ˆæœï¼Œå¯ä»¥è‡ªè¡Œé€šè¿‡è¡Œåˆ—å¼æ¨å¯¼ã€‚)ï¼Œå†å¯¹å›¾å±‚è¿›è¡Œæ—‹è½¬ã€‚<code>m34</code>çš„å€¼å¯ä»¥æ ¹æ®éœ€è¦å®ç°çš„æ•ˆæœæ¨å¯¼å¾—åˆ°ï¼Œä¸ç›´æ¥çš„æ–¹æ³•è¿˜æ˜¯ç›´æ¥è¯•ã€‚</p>
</li>
<li><p>å¦‚æœæƒ³è¦ç›´æ¥æ”¹å˜çŸ©é˜µé‡Œçš„å€¼ï¼Œå¯ä»¥å…ˆä½¿ç”¨<code>CATransform3DIdentity</code>çš„æ–¹å¼ï¼Œåˆå§‹åŒ–ä¸€ä¸ª<code>CATransform3D</code>å®ä¾‹ï¼Œç„¶åå†èµ‹å€¼ã€‚</p>
</li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Block çš„ä½¿ç”¨]]></title>
      <url>http://zhang759740844.github.io/2016/09/01/Block%E5%9F%BA%E7%A1%80/</url>
      <content type="html"><![CDATA[<p>ç±»ä¼¼äºåŒ¿åå‡½æ•°ï¼Œocä¸­æä¾›<code>block</code>,å¯ä»¥å°†ä¸€æ®µä»£ç å—åƒå¯¹è±¡ä¸€æ ·ä½œä¸ºå‚æ•°ä¼ é€’ã€æ‰§è¡Œã€‚</p>
<a id="more"></a>
<h2 id="Blockçš„ä½¿ç”¨"><a href="#Blockçš„ä½¿ç”¨" class="headerlink" title="Blockçš„ä½¿ç”¨"></a>Blockçš„ä½¿ç”¨</h2><h3 id="Blockå®ä¾‹"><a href="#Blockå®ä¾‹" class="headerlink" title="Blockå®ä¾‹"></a>Blockå®ä¾‹</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">^(<span class="keyword">double</span> dividend)&#123;</div><div class="line">	<span class="keyword">double</span> quotient = dividend / divisor;</div><div class="line">	<span class="keyword">return</span> quotient;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Blockå¯¹è±¡å¯ä»¥è¢«å½“åšä¸€ä¸ªå®å‚æ¥ä¼ é€’ç»™å¯ä»¥æ¥æ”¶blockçš„æ–¹æ³•ã€‚</p>
<h3 id="å£°æ˜blockå˜é‡"><a href="#å£°æ˜blockå˜é‡" class="headerlink" title="å£°æ˜blockå˜é‡:"></a>å£°æ˜blockå˜é‡:</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> (^devowelizer)(<span class="keyword">id</span>, <span class="built_in">NSUInteger</span>, <span class="built_in">BOOL</span>*);</div></pre></td></tr></table></figure>
<p><code>void</code> è¡¨ç¤ºè¿”å›ç±»å‹<br><code>^</code> è¡¨ç¤ºæ˜¯ä¸€ä¸ªblockå¯¹è±¡<br><code>devowelizer</code> è¡¨ç¤ºblockå˜é‡çš„åç§°<br>åé¢çš„æ˜¯å®å‚ç±»å‹<br>æ–¹æ³•çš„è°ƒç”¨å‚æ•°ç±»å‹ä¸º<code>^(id  string, NSUInteger i, BOOL *stop)block</code></p>
<h3 id="ç¼–å†™Blockå¯¹è±¡"><a href="#ç¼–å†™Blockå¯¹è±¡" class="headerlink" title="ç¼–å†™Blockå¯¹è±¡"></a>ç¼–å†™Blockå¯¹è±¡</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">devowelizer = ^(<span class="keyword">id</span> string,<span class="built_in">NSUInteger</span> i, <span class="built_in">BOOL</span> *stop)&#123;</div><div class="line">	â€¦â€¦</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="è°ƒç”¨blockå˜é‡"><a href="#è°ƒç”¨blockå˜é‡" class="headerlink" title="è°ƒç”¨blockå˜é‡"></a>è°ƒç”¨blockå˜é‡</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">devowelizer(string,i,stop);</div></pre></td></tr></table></figure>
<h3 id="typedef"><a href="#typedef" class="headerlink" title="typedef"></a>typedef</h3><p>ä¸èƒ½åœ¨æ–¹æ³•çš„å®ç°ä»£ç ä¸­ä½¿ç”¨typedefï¼Œéœ€è¦åœ¨å®ç°æ–‡ä»¶çš„é¡¶éƒ¨ï¼Œæˆ–è€…å¤´æ–‡ä»¶å†…ä½¿ç”¨typedefã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">void</span>(^ArrayEnumerationBlock)(<span class="keyword">id</span>,<span class="built_in">NSUInteger</span>,<span class="built_in">BOOL</span> *);</div></pre></td></tr></table></figure></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œå®šä¹‰çš„æ˜¯ä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œä¸æ˜¯å˜é‡ã€‚è·Ÿåœ¨^åé¢çš„æ˜¯ç±»å‹åç§°ã€‚åˆ›å»ºè¿™ä¸ªæ–°ç±»å‹åï¼Œå¯ä»¥ç®€åŒ–ç›¸åº”Blockçš„å£°æ˜ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ArrayEnumerationBlock devowelizerï¼›</div></pre></td></tr></table></figure></p>
<h3 id="å¤–éƒ¨å˜é‡"><a href="#å¤–éƒ¨å˜é‡" class="headerlink" title="å¤–éƒ¨å˜é‡"></a>å¤–éƒ¨å˜é‡</h3><p>åœ¨æ‰§è¡ŒBlockå¯¹è±¡æ—¶ï¼Œä¸ºäº†ç¡®ä¿å…¶ä¸‹çš„å¤–éƒ¨å˜é‡èƒ½å¤Ÿå§‹ç»ˆå­˜åœ¨ï¼Œç›¸åº”çš„Blockå¯¹è±¡ä¼šæ•è·è¿™äº›å˜é‡ï¼Œæ„å‘³ç€ç¨‹åºä¼šæ‹·è´å˜é‡çš„å€¼ã€‚</p>
<p><strong>å½“å¤–éƒ¨å¯¹è±¡æ˜¯å¼•ç”¨æ—¶ï¼Œblockä¼šå¤åˆ¶å…¶å¼•ç”¨çš„åœ°å€(æŒ‡é’ˆæŒ‡å‘çš„å †ä¸Šçš„åœ°å€)ï¼Œåªèƒ½æ”¹å˜åœ°å€æŒ‡å‘çš„å¯¹è±¡çš„å±æ€§ï¼Œä¸èƒ½å°†å¤–éƒ¨å¯¹è±¡æŒ‡å‘æ–°çš„åœ°å€ï¼Œç±»ä¼¼äºJavaçš„å¼•ç”¨æœºåˆ¶ã€‚</strong></p>
<h3 id="ä¿®æ”¹å¤–éƒ¨å˜é‡"><a href="#ä¿®æ”¹å¤–éƒ¨å˜é‡" class="headerlink" title="ä¿®æ”¹å¤–éƒ¨å˜é‡"></a>ä¿®æ”¹å¤–éƒ¨å˜é‡</h3><p>å¦‚æœéœ€è¦åœ¨Blockå¯¹è±¡å†…ä¿®æ”¹æŸä¸ªå¤–éƒ¨å˜é‡ï¼Œåˆ™å¯ä»¥å£°æ˜ç›¸åº”çš„å¤–éƒ¨å˜é‡æ—¶ï¼Œåœ¨å‰é¢åŠ ä¸Š__blockå…³é”®å­—ã€‚</p>
<p><strong>__blockå…³é”®å­—è®©blockå†…éƒ¨æ‹¿åˆ°å¤–éƒ¨å¯¹è±¡çš„æŒ‡é’ˆã€‚è¿™æ ·å°±å¯ä»¥æ”¹å˜åœ°å€ä¸ŠæŒ‡å‘å®ä¾‹å¯¹è±¡åœ°å€çš„æŒ‡é’ˆçš„æŒ‡å‘ï¼Œä»è€Œè¾¾åˆ°æ”¹å˜å¤–éƒ¨å¯¹è±¡çš„ç»“æœã€‚</strong></p>
<h3 id="åœ¨Blockä¸­ä½¿ç”¨self"><a href="#åœ¨Blockä¸­ä½¿ç”¨self" class="headerlink" title="åœ¨Blockä¸­ä½¿ç”¨self"></a>åœ¨Blockä¸­ä½¿ç”¨self</h3><p>å¦‚æœè¦å†™ä¸€ä¸ªä½¿ç”¨selfçš„Blockå¯¹è±¡ï¼Œéœ€è¦é¿å…å¼ºå¼•ç”¨å¾ªç¯ã€‚<br>åœ¨Blockå¤–å£°æ˜ä¸€ä¸ª_weakæŒ‡æ­£ï¼Œç„¶åå°†è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘Blockå¯¹è±¡ä½¿ç”¨çš„selfï¼Œæœ€ååœ¨Blockå¯¹è±¡ä¸­ä½¿ç”¨è¿™ä¸ªæ–°çš„æŒ‡é’ˆã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">_<span class="keyword">weak</span> BNREmployee *weakSelf = <span class="keyword">self</span>;	<span class="comment">//å¼±å¼•ç”¨æŒ‡é’ˆ</span></div><div class="line">	myBlock = ^&#123;</div><div class="line">		<span class="built_in">NSLog</span>(@â€œEmployee:%@â€,weakSelf);</div><div class="line">	&#125;;</div></pre></td></tr></table></figure></p>
<h2 id="blockçš„å®ç°"><a href="#blockçš„å®ç°" class="headerlink" title="blockçš„å®ç°"></a>blockçš„å®ç°</h2><p>blockçš„å®ç°ä¸»è¦å‚è€ƒ<a href="http://blog.devtang.com/2013/07/28/a-look-inside-blocks/#" target="_blank" rel="external">å”å·§è°ˆObjective-C blockçš„å®ç°</a></p>
<h3 id="blockçš„ç»“æ„"><a href="#blockçš„ç»“æ„" class="headerlink" title="blockçš„ç»“æ„"></a>blockçš„ç»“æ„</h3><p>blockçš„ç»“æ„å¦‚ä¸‹:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> Block_descriptor &#123;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> reserved;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> size;</div><div class="line">    <span class="keyword">void</span> (*<span class="keyword">copy</span>)(<span class="keyword">void</span> *dst, <span class="keyword">void</span> *src);</div><div class="line">    <span class="keyword">void</span> (*dispose)(<span class="keyword">void</span> *);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Block_layout &#123;</div><div class="line">    <span class="keyword">void</span> *isa;</div><div class="line">    <span class="keyword">int</span> flags;</div><div class="line">    <span class="keyword">int</span> reserved;</div><div class="line">    <span class="keyword">void</span> (*invoke)(<span class="keyword">void</span> *, ...);</div><div class="line">    <span class="keyword">struct</span> Block_descriptor *descriptor;</div><div class="line">    <span class="comment">/* Imported variables. */</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>ç»“æ„å›¾å¦‚ä¸‹ï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/block_struct.jpg?raw=true" alt="blockç»“æ„å›¾"></p>
<p>é€šè¿‡è¯¥å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¸€ä¸ª block å®ä¾‹å®é™…ä¸Šç”± 6 éƒ¨åˆ†æ„æˆï¼š</p>
<ol>
<li><code>isa</code> æŒ‡é’ˆï¼Œæ‰€æœ‰å¯¹è±¡éƒ½æœ‰è¯¥æŒ‡é’ˆï¼Œç”¨äºå®ç°å¯¹è±¡ç›¸å…³çš„åŠŸèƒ½ã€‚</li>
<li><code>flags</code>ï¼Œç”¨äºæŒ‰ bit ä½è¡¨ç¤ºä¸€äº› block çš„é™„åŠ ä¿¡æ¯ã€‚</li>
<li><code>reserved</code>ï¼Œä¿ç•™å˜é‡ã€‚</li>
<li><code>invoke</code>ï¼Œå‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘å…·ä½“çš„ block å®ç°çš„å‡½æ•°è°ƒç”¨åœ°å€ã€‚</li>
<li><code>descriptor</code>ï¼Œ è¡¨ç¤ºè¯¥ block çš„é™„åŠ æè¿°ä¿¡æ¯ï¼Œä¸»è¦æ˜¯ size å¤§å°ï¼Œä»¥åŠ copy å’Œ dispose å‡½æ•°çš„æŒ‡é’ˆã€‚</li>
<li>å„ç§ä»å¤–éƒ¨å¤åˆ¶è¿‡æ¥çš„å˜é‡ï¼Œblock èƒ½å¤Ÿè®¿é—®å®ƒå¤–éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œå°±æ˜¯å› ä¸ºå°†è¿™äº›å˜é‡ï¼ˆæˆ–å˜é‡çš„åœ°å€ï¼‰å¤åˆ¶åˆ°äº†ç»“æ„ä½“ä¸­ã€‚</li>
</ol>
<h3 id="blockç§ç±»"><a href="#blockç§ç±»" class="headerlink" title="blockç§ç±»"></a>blockç§ç±»</h3><p>blockçš„isaæ˜¯ä»¥ä¸‹ä¸‰ä¸ªçš„ä¸€ç§ï¼š</p>
<ol>
<li><code>_NSConcreteGlobalBlock</code> å…¨å±€çš„é™æ€ blockï¼Œä¸ä¼šè®¿é—®ä»»ä½•å¤–éƒ¨å˜é‡ã€‚</li>
<li><code>_NSConcreteStackBlock</code> ä¿å­˜åœ¨æ ˆä¸­çš„ blockï¼Œå½“å‡½æ•°è¿”å›æ—¶ä¼šè¢«é”€æ¯ã€‚</li>
<li><code>_NSConcreteMallocBlock</code> ä¿å­˜åœ¨å †ä¸­çš„ blockï¼Œå½“å¼•ç”¨è®¡æ•°ä¸º 0 æ—¶ä¼šè¢«é”€æ¯ã€‚</li>
</ol>
<p>åœ¨ ARC å¼€å¯çš„æƒ…å†µä¸‹ï¼Œå°†åªä¼šæœ‰ <code>NSConcreteGlobalBlock</code> å’Œ <code>NSConcreteMallocBlock</code>ç±»å‹çš„ blockã€‚åŸæœ¬çš„ <code>NSConcreteStackBlock</code> çš„ block ä¼šè¢« <code>NSConcreteMallocBlock</code> ç±»å‹çš„ block æ›¿ä»£ã€‚</p>
<h3 id="ç ”ç©¶å·¥å…·ï¼šclang"><a href="#ç ”ç©¶å·¥å…·ï¼šclang" class="headerlink" title="ç ”ç©¶å·¥å…·ï¼šclang"></a>ç ”ç©¶å·¥å…·ï¼šclang</h3><p>clang æä¾›ä¸€ä¸ªå‘½ä»¤ï¼Œå¯ä»¥å°† Objetive-C çš„æºç æ”¹å†™æˆ c è¯­è¨€çš„ï¼Œå€Ÿæ­¤å¯ä»¥ç ”ç©¶å„ç§ç»“æ„çš„æºç å®ç°æ–¹å¼ã€‚è¯¥å‘½ä»¤æ˜¯<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">clang -rewrite-objc xxxx</div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[UITableView åŸºç¡€]]></title>
      <url>http://zhang759740844.github.io/2016/08/30/UITableView%E5%9F%BA%E7%A1%80/</url>
      <content type="html"><![CDATA[<p>UITableViewæ˜¯æœ€å¸¸ç”¨çš„åŸºæœ¬æ§ä»¶ã€‚æ­¤å¤„å¯¹å…¶ä¸€èˆ¬ç”¨æ³•è¿›è¡Œæ€»ç»“ã€‚</p>
<a id="more"></a>
<h2 id="UITableViewåŸºç¡€"><a href="#UITableViewåŸºç¡€" class="headerlink" title="UITableViewåŸºç¡€"></a>UITableViewåŸºç¡€</h2><h3 id="UITableView-çš„æ ·å¼"><a href="#UITableView-çš„æ ·å¼" class="headerlink" title="UITableView çš„æ ·å¼"></a>UITableView çš„æ ·å¼</h3><ol>
<li>UITableViewStylePlain        å°†ä¼šä¿æŒåœ¨é¡¶éƒ¨ç›´åˆ°è¢«é¡¶æ‰</li>
<li>UITableViewStyleGrouped        å°†ä¼šéšç€cellä¸€èµ·æ»šåŠ¨</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UITableView</span> *tableView = [[<span class="built_in">UITableView</span> alloc] initWithFrame:<span class="built_in">CGRectZero</span> style:<span class="built_in">UITableViewStyle</span>];</div></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>CGRectZero</code>è¡¨ç¤º<code>equivalent to CGRectMake(0, 0, 0, 0)</code>.ä¹‹åä»£ç ä¼šæ”¹UITableViewçš„Frameï¼Œæ‰€ä»¥æš‚ä¸”éƒ½æ˜¯0ã€‚</p>
<h3 id="UITableViewå¯¹è±¡æä¾›æ•°æ®"><a href="#UITableViewå¯¹è±¡æä¾›æ•°æ®" class="headerlink" title="UITableViewå¯¹è±¡æä¾›æ•°æ®"></a>UITableViewå¯¹è±¡æä¾›æ•°æ®</h3><p>UITableViewä¸åŒ…å«ä»»ä½•æ•°æ®ï¼Œéœ€è¦æä¾›ä¸€ä¸ªæ•°æ®æº.<br>æˆ‘ä»¬å°†BNRAppDelegateå®ä¾‹è®¾ç½®ä¸ºUITableViewå¯¹è±¡çš„æ•°æ®æºã€‚BNRAPPDelegateå¿…é¡»éµå¾ªUITableViewDataSourceåè®®ã€‚<br>åœ¨BNRAPPDelegate.hæ–‡ä»¶ä¸­ï¼Œå£°æ˜BNRAPPDelegateéµå¾ªUITableViewDataSourceåè®®<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BNRAppDelegate</span>: <span class="title">UIResponder</span> &lt;<span class="title">UIApplicationDelegate</span>,<span class="title">UITableViewDataSource</span>&gt;</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">UITableView</span> *taskTable;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSMutable</span> Array *tasks;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>åœ¨.mä¸­å‘UITableViewå‘é€<code>setDataSource</code>æ¶ˆæ¯ï¼Œå°†BNRAPPDelegateå®ä¾‹è®¾ç½®ä¸ºæ•°æ®æº</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">self</span>.taskTable.dataSource = <span class="keyword">self</span>;</div></pre></td></tr></table></figure>
<p>UITableViewDataSourceè®¾ç½®äº†ä¸¤ä¸ªå¿…é¡»æ–¹æ³•ï¼š</p>
<ol>
<li>æ ¹æ®æŒ‡å®šçš„è¡¨æ ¼ç´¢å¼•ç»™å‡ºç›¸åº”è¡¨æ ¼æ®µåŒ…å«çš„è¡Œæ•°ï¼ˆ<code>tableViewï¼šnumberOfRowsInSectionï¼š</code>ï¼‰</li>
<li>æ ¹æ®æŒ‡å®šè¡¨æ ¼æ®µç´¢å¼•å’Œè¡Œç´¢å¼•ç»™å‡ºç›¸åº”çš„UITableViewCellå¯¹è±¡ï¼ˆ<code>tableViewï¼šcellForRowAtIndexPathï¼š</code>ï¼‰<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">BNRAppDelegate</span></span></div><div class="line">-(<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section&#123;</div><div class="line">	    <span class="keyword">return</span> [<span class="keyword">self</span>.tasks count];</div><div class="line">&#125;</div><div class="line">-(<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">        <span class="built_in">UITableViewCell</span> *c = [<span class="keyword">self</span>.taskTable dequeueReusableCellWithIdentifier:@â€œcellâ€];</div><div class="line">	    <span class="comment">//é‡ç”¨cell</span></div><div class="line">	    <span class="built_in">NSString</span> *item = [<span class="keyword">self</span>.tasks objectAtIndex:indexPath.row];</div><div class="line">	    c.textLabel.text = item;</div><div class="line">	    <span class="keyword">return</span> c;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>åˆ·æ–°è¡¨æ ¼ï¼š<code>[self.taskTable reloadData];</code></p>
<h3 id="é‡ç”¨UITableViewCellå¯¹è±¡"><a href="#é‡ç”¨UITableViewCellå¯¹è±¡" class="headerlink" title="é‡ç”¨UITableViewCellå¯¹è±¡"></a>é‡ç”¨UITableViewCellå¯¹è±¡</h3><p>éœ€è¦å°†è‡ªå®šä¹‰çš„cellç±»å’Œidentifierè¿›è¡Œå…³è”ã€‚<br>åœ¨ViewController.mä¸­è¦†ç›–viewDidLoadæ–¹æ³•ï¼Œå‘è¡¨è§†å›¾æ³¨å†Œåº”è¯¥ä½¿ç”¨çš„UITabeViewCell<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">-(<span class="keyword">void</span>)viewDidLoad&#123;</div><div class="line">	[<span class="keyword">super</span> viewDidLoad];</div><div class="line">	[<span class="keyword">self</span>.tableView registerClass:[<span class="built_in">UITableViewCell</span> <span class="keyword">class</span>] forCellReuseIdentifier:@â€œ<span class="built_in">UITableViewCell</span>â€];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™æ ·UITableViewCellç±»å°±å’Œè¿™ä¸ªstringå…³è”èµ·æ¥äº†ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨nibæ–‡ä»¶å…³è”<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="keyword">self</span>.tableView registerNib:[<span class="built_in">UINib</span> nibWithNibName:<span class="string">@"MineUserInfoCell"</span> bundle:<span class="literal">nil</span>]  forCellReuseIdentifier:<span class="string">@"MineUserInfoCellIdentifier"</span>];</div></pre></td></tr></table></figure></p>
<h3 id="ä½¿ç”¨UIViewControlleråˆ›å»ºtabeView"><a href="#ä½¿ç”¨UIViewControlleråˆ›å»ºtabeView" class="headerlink" title="ä½¿ç”¨UIViewControlleråˆ›å»ºtabeView"></a>ä½¿ç”¨UIViewControlleråˆ›å»ºtabeView</h3><p>éœ€è¦è‡ªå·±åˆ›å»ºtableviewå±æ€§ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UITableView</span> *tableView;</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œè¦ç”¨strong ï¼Œå› ä¸ºè¿™ä¸ªtableviewæ˜¯è‡ªå·±åˆ›å»ºçš„ã€‚å¦‚æœæ˜¯weaké‚£ä¹ˆæŒ‡å‘çš„åœ°æ–¹åœ¨åˆ›å»ºåå°±è¢«ARCå›æ”¶äº†,é‚£ä¹ˆè¿™ä¸ªtableviewæŒ‡é’ˆå°±æˆäº†é‡æŒ‡é’ˆäº†ã€‚<br>å¦‚æœæ˜¯è¿çº¿çš„å°±å¯ä»¥ç”¨weakï¼Œweakå±æ€§ä¸€èˆ¬ç”¨åœ¨å½“å‰å±æ€§æ˜¯å…¶ä»–ç±»åˆ›å»ºï¼Œåªå­˜ä¸€ä¸ªè¯¥å±æ€§çš„å¼•ç”¨çš„æ—¶å€™ï¼Œä¸ºäº†å¼ºå¼•ç”¨é‚£ä¸ªç±»ã€‚</p>
<h3 id="åˆ›å»ºå¤šä¸ªsectionçš„tableview"><a href="#åˆ›å»ºå¤šä¸ªsectionçš„tableview" class="headerlink" title="åˆ›å»ºå¤šä¸ªsectionçš„tableview"></a>åˆ›å»ºå¤šä¸ªsectionçš„tableview</h3><p>åˆ›å»ºå¤šä¸ªsectionçš„tableviewéœ€è¦å®ç°æ–¹æ³•<code>numberOfSectionsInTableView:</code>è¿”å›tableviewä¸­sectionçš„ä¸ªæ•°ã€‚å…¶ä½™ä½¿ç”¨å’Œå•ä¸ªsectionä¸€æ ·ã€‚</p>
<p>åœ¨<code>cellForRowAtIndexPath:</code>æ–¹æ³•ä¸­ï¼Œéœ€è¦åŒºåˆ†ä¸åŒsectionè¿”å›ä¸åŒcellã€‚åŒºåˆ†sectionçš„æ–¹å¼åœ¨äºè¯¥æ–¹æ³•ä¼ å…¥çš„å‚æ•°<code>(NSIndexPath *)indexPath</code>ã€‚</p>
<p><code>NSIndexPath</code>æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå…·æœ‰ä¸¤ä¸ªå±æ€§<code>row</code>å’Œ<code>section</code>ã€‚è¡¨ç¤ºæ‰€åœ¨sectionå’Œsectionå†…rowã€‚<br><code>NSIndexPath</code>ä¸­çš„å±æ€§æ˜¯åªè¯»çš„ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ã€‚åªèƒ½é€šè¿‡é‡æ–°åˆ›å»ºçš„å½¢å¼ï¼Œè¾¾åˆ°ä¿®æ”¹å±æ€§çš„ç›®çš„ã€‚<br>åˆ›å»ºæ–¹å¼:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSIndexPath</span> *indexPath = [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">1</span> inSection:<span class="number">1</span>];</div></pre></td></tr></table></figure></p>
<h3 id="TableViewè¡¨å¤´è§†å›¾"><a href="#TableViewè¡¨å¤´è§†å›¾" class="headerlink" title="TableViewè¡¨å¤´è§†å›¾"></a>TableViewè¡¨å¤´è§†å›¾</h3><p>è¡¨å¤´è§†å›¾æ˜¯æŒ‡UITableViewå¯¹è±¡å¯ä»¥åœ¨å…¶è¡¨æ ¼ä¸Šæ–¹æ˜¾ç¤ºçš„ç‰¹å®šè§†å›¾ï¼Œæ˜¯å’Œæ”¾ç½®é’ˆå¯¹æŸä¸ªè¡¨æ ¼æ®µæˆ–æ•´å¼ è¡¨æ ¼çš„æ ‡é¢˜å’Œæ§ä»¶ã€‚è¡¨å¤´è§†å›¾å¯ä»¥æ˜¯ä»»æ„UIViewå¯¹è±¡ã€‚è¡¨æ ¼è§†å›¾æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«é’ˆå¯¹è¡¨æ ¼æ®µå’Œè¡¨æ ¼ã€‚ç±»ä¼¼çš„ï¼Œè¿˜æœ‰è¡¨å°¾è§†å›¾ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIView</span> *headerView = [[[<span class="built_in">NSBundle</span> mainBundle] loadNibNamed:<span class="string">@"HotelReviewsHeaderView"</span> owner:<span class="literal">nil</span> options:<span class="literal">nil</span>]lastObject];</div></pre></td></tr></table></figure></p>
<p><strong>loadNibNamed:owner:options:</strong>è¿”å›çš„æ˜¯ä¸ªæ•°ç»„ï¼Œä¿å­˜äº†xibä¸­çš„å„ä¸ªviewã€‚xibä¸­æœ‰å‡ ä¸ªviewï¼Œæ•°ç»„å…ƒç´ å°±æ˜¯å‡ ã€‚å› æ­¤ï¼Œå¯ä»¥å°†å¤šä¸ªè‡ªå®šä¹‰çš„viewæˆ–è€…cellæ”¾åœ¨ä¸€ä¸ªxibä¸­ï¼Œé€šè¿‡æ•°ç»„çš„æ–¹å¼è·å–æƒ³è¦çš„viewã€‚<code>initWithNibName</code>çš„å®ç°å’Œè¯¥æ–¹æ³•ç±»ä¼¼ï¼Œå…¶ä¸­ä¹Ÿä¼šç”¨åˆ°è¯¥æ–¹æ³•ã€‚ä¸è¿‡<code>initWithNibName</code>ç”¨åœ¨è·å–Controllerçš„xibä¸­ã€‚</p>
<hr>
<p>å·®ä¸ªé¢˜å¤–è¯ï¼Œè¿™é‡Œæˆ‘ä»¬æ¥ä»‹ç»ä¸‹<code>loaNibNamed</code>æ–¹æ³•å’Œ<code>initWithNibName</code>æ–¹æ³•çš„å¼‚åŒã€‚</p>
<p>é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼š<code>loadNibNamed</code>ã€<code>initWithNibName</code>ä»¥åŠ<code>nibWithNibName</code>åé¢è·Ÿçš„éƒ½æ˜¯<strong>æ–‡ä»¶å</strong>ï¼Œé‚£ä¹ˆï¼Œæ€ä¹ˆç¡®å®šè¯¥xibæ–‡ä»¶ä¸‹å¯¹åº”çš„æ˜¯å“ªä¸ªviewå‘¢ï¼Ÿ</p>
<p>å…ˆä»‹ç»ä¸‹xibæ–‡ä»¶ä¸­çš„<code>File&#39;s Owner</code>:<br><code>File&#39;s Owner</code> è¡¨ç¤ºè§†å›¾æ§åˆ¶å™¨ã€‚UIViewController(æˆ–å…¶å­ç±»)åœ¨ç”Ÿæˆçš„æ—¶å€™ï¼Œé¦–å…ˆä¼šå¯»æ‰¾ç›¸åº”çš„<code>.xib</code>å»ç”Ÿæˆï¼Œäºæ˜¯controllerçš„å®ä¾‹(instance)å°±æŠŠ<code>.xib</code>è½½å…¥å†…å­˜ï¼Œå¹¶æˆä¸º<code>FIle&#39;s Owner</code>ï¼ˆä¹Ÿå°±æ˜¯è¯´æ˜äº†ä¸ºä»€ä¹ˆå«åšå ä½ç¬¦ï¼‰ã€‚<strong>æ‰€ä»¥æˆ‘ä»¬å®šä¹‰çš„controlleræ˜¯è¿™ä¸ª<code>.xib</code>çš„<code>custom class</code>ã€‚</strong>å¹¶ä¸”éœ€è¦æŠŠè¿™ä¸ª<code>FIle Owner</code>ä¸Šçš„<code>outlet</code>è¿åˆ°æŸä¸ªæ§ä»¶ä¸Šå»ã€‚ï¼ˆActionä¹ŸåŒæ ·é“ç†ï¼‰æ¢ä¸ªè§’åº¦ï¼Œå¦‚æœæˆ‘ä»¬çœ‹<code>.xib</code>æ–‡ä»¶ï¼Œå‘ç°å®ƒæœ‰ä¸ª<code>File
 Owner</code>,å…¶å®å°±æ˜¯æˆ‘ä»¬ç”¨æ¥è®¾å®šï¼Œç©¶ç«Ÿæ˜¯é‚£ä¸ªObjectæ¥è¯»å–å¹¶è½½å…¥è¿™ä¸ª<code>.xib</code>æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè°ownè¿™ä¸ªæ–‡ä»¶ã€‚</p>
<p>é‚£ä¹ˆï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äº<code>initWithNibName</code>æ–¹æ³•è€Œè¨€ï¼Œå®ƒåŠ è½½çš„å¿…é¡»æ˜¯è®¾ç½®äº†<code>File&#39;s Owner</code>ä¸ºè‡ªèº«çš„xibï¼Œ<strong>è®¾ç½®äº†<code>File&#39;s Owner</code>å°±è¯´æ˜ï¼Œè¿™ä¸ªxibè¢«è¿™ä¸ªControlleræ‰¿åŒ…äº†ï¼Œåˆ«çš„Controllerç”¨ä¸äº†ã€‚</strong><code>File&#39;s Owner</code>ä¼šå’Œæ–‡ä»¶ä¸­éœ€è¦åŠ è½½çš„viewå…³è”(ä¹Ÿå°±æ˜¯è¿çº¿ï¼Œ<code>File&#39;s Owner</code>çš„viewå±æ€§ä¼šè”ç»“è¦æ˜¾ç¤ºçš„view)ï¼Œä»è€Œä»ä¼—å¤šviewä¸­ç¡®å®šè¦æ˜¾ç¤ºçš„viewæ˜¯å“ªä¸€ä¸ªã€‚è¿™å°±è¯´æ˜äº†ä¸¤ç‚¹ï¼šç¬¬ä¸€ï¼Œä¸€ä¸ªControllerå¯ä»¥æœ‰å¤šä¸ªxibï¼Œåªè¦xibçš„<code>File&#39;s Owner</code>éƒ½æŒ‡å‘é‚£ä¸ªControllerå°±è¡Œã€‚ç¬¬äºŒï¼Œä¸ç”¨æ‹…å¿ƒä¸€ä¸ªxibä¸­æœ‰å¤šä¸ªå¹¶åˆ—çš„viewå¯¼è‡´æœºå™¨ä¸çŸ¥é“è¦åŠ è½½å“ªä¸ªçš„æƒ…å†µï¼Œå› ä¸º<code>File&#39;s Owner</code>çš„<code>view</code>åªä¼šè”ç»“è¿™äº›viewä¸­çš„ä¸€ä¸ªã€‚</p>
<p>å¯¹äºè‡ªå®šä¹‰çš„viewï¼Œä»»ä½•Controlleréƒ½èƒ½è·å¾—è¯¥viewï¼Œå› æ­¤ï¼Œä¸èƒ½è®¾ç½®å…¶xibæ–‡ä»¶çš„<code>File&#39;s Owner</code>ã€‚ä¸Šé¢ä¹Ÿè¯´äº†ï¼Œé€šè¿‡<code>loadNibNamed</code>æ–¹æ³•ä¼šè¿”å›å„ä¸ªviewçš„æ•°ç»„ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨é€‰æ‹©è¦åŠ è½½å“ªä¸ªã€‚</p>
<p><code>loadNibNamed</code>æ–¹æ³•ä¹Ÿå¯ä»¥è·å¾—<code>initWithNibName</code>çš„viewã€‚<code>loadNibNamed:owner:options:</code>æ–¹æ³•ä¸­æœ‰ä¸€ä¸ª<code>owner</code>å‚æ•°ï¼Œå°±æ˜¯ç”¨æ¥ä¼ <code>File&#39;s Owner</code>çš„ã€‚<br>å¯¹äºè‡ªå®šä¹‰çš„viewæ‰€å±çš„xibæ–‡ä»¶ï¼Œç”±äºæ²¡æœ‰<code>File&#39;s Owner</code>ï¼Œå› æ­¤åŠ è½½çš„æ—¶å€™<code>owner</code>ä¼ å…¥<code>nil</code>ã€‚<br>å¯¹äºæœ‰<code>File&#39;s Owner</code>çš„Controllerçš„xibï¼Œ<code>owner</code>éœ€è¦ä¼ å…¥è¯¥xibæ–‡ä»¶ç›¸åº”<code>File&#39;s Owner</code>çš„å®ä¾‹ï¼Œå¦åˆ™æ— æ³•åŠ è½½ï¼Œè¿”å›è¯¥xibå†…æ‰€æœ‰viewçš„æ•°ç»„ã€‚åœ¨lldbä¸­å¯ä»¥éªŒè¯Controllerçš„viewå±æ€§å°±æ˜¯é€šè¿‡<code>loadNibNamed</code>æ‹¿åˆ°çš„viewï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(lldb) p [[[<span class="built_in">NSBundle</span> mainBundle]loadNibNamed:<span class="string">@"xxxController"</span> owner:<span class="keyword">self</span> options:<span class="literal">nil</span>] firstObject] == <span class="keyword">self</span>.view</div><div class="line">(<span class="keyword">bool</span>) $<span class="number">1</span> = <span class="literal">true</span></div></pre></td></tr></table></figure>
<hr>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad&#123;</div><div class="line">	<span class="built_in">UIView</span> *header = <span class="keyword">self</span>.headerView;</div><div class="line">	[<span class="keyword">self</span>.tableView setTableHeaderView:header];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åŠ è½½å®ŒheaderViewåï¼Œå°†å…¶è®¾ç½®ä¸ºUITableViewå¯¹è±¡çš„è¡¨å¤´è§†å›¾ã€‚<br>ä¹Ÿå¯ä»¥åœ¨ <strong>(UIView *)tableView:viewForHeaderInSection:</strong>æ–¹æ³•ä¸­è®¾ç½®ï¼Œå½“åªæœ‰ä¸€ä¸ªsectionæ—¶æ•ˆæœç›¸åŒã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UIView</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView viewForHeaderInSection:(<span class="built_in">NSInteger</span>)section&#123;</div><div class="line">    <span class="built_in">UIView</span> *view = [[[<span class="built_in">NSBundle</span> mainBundle] loadNibNamed:<span class="string">@"HeaderView"</span> owner:<span class="literal">nil</span> options:<span class="literal">nil</span>] lastObject];</div><div class="line">    <span class="keyword">return</span> view;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="tableviewçš„å­—æ¯ç´¢å¼•"><a href="#tableviewçš„å­—æ¯ç´¢å¼•" class="headerlink" title="tableviewçš„å­—æ¯ç´¢å¼•"></a>tableviewçš„å­—æ¯ç´¢å¼•</h3><p>å®ç°<code>sectionIndexTitlesForTableView</code>æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)sectionIndexTitlesForTableView:(<span class="built_in">UITableView</span> *)tableView&#123;</div><div class="line">    <span class="built_in">NSMutableArray</span> *indexs = [[<span class="built_in">NSMutableArray</span> alloc]init];</div><div class="line">    [indexs addObject:<span class="string">@"æˆ‘"</span>];</div><div class="line">    [indexs addObject:<span class="string">@"æ˜¯"</span>];</div><div class="line">    <span class="keyword">return</span> indexs;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªè¿”å›æ•°ç»„çš„å†…å®¹å’Œå„ä¸ªsectionå¯¹åº”ï¼Œç‚¹å‡»ç´¢å¼•ï¼Œå°±èƒ½è·³è½¬åˆ°å¯¹åº”sectionã€‚</p>
<h3 id="ç‚¹å‡»cellä¸­buttonè·å–æ‰€å±indexpath"><a href="#ç‚¹å‡»cellä¸­buttonè·å–æ‰€å±indexpath" class="headerlink" title="ç‚¹å‡»cellä¸­buttonè·å–æ‰€å±indexpath"></a>ç‚¹å‡»cellä¸­buttonè·å–æ‰€å±indexpath</h3><p>buttonç‚¹å‡»äº‹ä»¶ä¸­æœ‰ä¸€ä¸ªeventå¯¹è±¡ï¼Œè®°å½•äº†å½“å‰ç‚¹å‡»åæ ‡ï¼Œç„¶åé€šè¿‡åæ ‡èƒ½å¤Ÿæ‰¾åˆ°æ‰€å±çš„cellã€‚å¯ä»¥åœ¨cellä¸­ä¸ºç‚¹å‡»äº‹ä»¶è®¾ç½®ä»£ç†ï¼Œç„¶ååœ¨viewcontrollerä¸­å®ç°ã€‚å½“ç„¶ï¼Œæ›´æ¨èçš„æ˜¯ç›´æ¥åœ¨viewcontrollerä¸­æ·»åŠ å’Œå®ç°ç‚¹å‡»äº‹ä»¶ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">[cell.btn addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(cellBtnClicked:event:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)cellBtnClicked:(<span class="keyword">id</span>)sender event:(<span class="keyword">id</span>)event</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSSet</span> *touches =[event allTouches];</div><div class="line">    <span class="built_in">UITouch</span> *touch =[touches anyObject];</div><div class="line">    <span class="built_in">CGPoint</span> currentTouchPosition = [touch locationInView:_tableView];</div><div class="line">    <span class="built_in">NSIndexPath</span> *indexPath= [_tableView indexPathForRowAtPoint:currentTouchPosition];</div><div class="line">    <span class="keyword">if</span> (indexPath!= <span class="literal">nil</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="comment">// do something</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥é€šè¿‡<code>event</code>æ‹¿åˆ°åœ¨tableViewä¸­çš„ä½ç½®<code>cure</code>ï¼Œå†é€šè¿‡<code>indexPathForRowAtPoint:</code>æ–¹æ³•è·å–<code>NSIndexPath</code>ã€‚</p>
<p>å¦å¤–ä¸€ç§æ–¹æ³•æ˜¯ï¼Œåœ¨cellä¸­ä½¿ç”¨ä»£ç†ï¼Œç›´æ¥å°†cellä¼ ç»™viewcontrollerï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//cell.hä¸­çš„å£°æ˜</span></div><div class="line">- (<span class="keyword">IBAction</span>)buttonPressed :(<span class="keyword">id</span>)ï¼›</div><div class="line"></div><div class="line"><span class="comment">//cell.mä¸­çš„å®ç°ï¼Œè®¾ç½®ä»£ç†</span></div><div class="line">- (<span class="keyword">void</span>)buttonPressed:(<span class="keyword">id</span>)sender&#123;</div><div class="line">    [<span class="keyword">self</span>.delegate buttonPressed:<span class="keyword">self</span> event:event];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//viewcontrollerä¸­çš„å®ç°</span></div><div class="line">- (<span class="keyword">void</span>)buttonPressed:(TableViewCell1 *)cell&#123;</div><div class="line">    <span class="built_in">NSIndexPath</span> *indexPath2 = [_tableView indexPathForCell:cell];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æ‰€å±è¡Œæ•°ï¼š%ld"</span>,(<span class="keyword">long</span>)indexPath2.row+<span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡è®¾ç½®delegateï¼Œå°†buttonçš„ç‚¹å‡»äº‹ä»¶äº¤ç»™viewControllerå®Œæˆã€‚</p>
<h2 id="ç¼–è¾‘UITableView"><a href="#ç¼–è¾‘UITableView" class="headerlink" title="ç¼–è¾‘UITableView"></a>ç¼–è¾‘UITableView</h2><h3 id="ç¼–è¾‘æ¨¡å¼ä¸‹çš„UITableView"><a href="#ç¼–è¾‘æ¨¡å¼ä¸‹çš„UITableView" class="headerlink" title="ç¼–è¾‘æ¨¡å¼ä¸‹çš„UITableView"></a>ç¼–è¾‘æ¨¡å¼ä¸‹çš„UITableView</h3><h4 id="è¿›å…¥ç¼–è¾‘æ¨¡å¼"><a href="#è¿›å…¥ç¼–è¾‘æ¨¡å¼" class="headerlink" title="è¿›å…¥ç¼–è¾‘æ¨¡å¼"></a>è¿›å…¥ç¼–è¾‘æ¨¡å¼</h4><p>é€šè¿‡è°ƒç”¨<code>[_tableView setEditing:!_tableView.isEditing animated:true]</code>è¿›å…¥ç¼–è¾‘æ¨¡å¼,å¯å®ç°æ·»åŠ ï¼Œåˆ é™¤ï¼Œç§»åŠ¨æ“ä½œã€‚<br>é»˜è®¤æ˜¯åˆ é™¤ï¼Œå³cellå·¦è¾¹å‡ºç°ä¸€ä¸ªçº¢è‰²çš„å‡å·ï¼Œç‚¹å‡»å¯ä»¥åˆ é™¤è¯¥è¡Œã€‚</p>
<h4 id="TableView-ç¼–è¾‘è¡Œ"><a href="#TableView-ç¼–è¾‘è¡Œ" class="headerlink" title="TableView ç¼–è¾‘è¡Œ"></a>TableView ç¼–è¾‘è¡Œ</h4><p>ä½¿ç”¨<strong>setEditing:animated:</strong>æ–¹æ³•è®©tableViewè¿›å…¥ç¼–è¾‘æ¨¡å¼.å¯ä»¥ä½¿ç”¨<strong>tableView:canEditRowAtIndexPath</strong>æ–¹æ³•ç­›é€‰èƒ½è¿›å…¥ç¼–è¾‘æ¨¡å¼çš„è¡Œï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)tableView:(<span class="built_in">UITableView</span> *)tableView canEditRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    <span class="keyword">if</span>(indexPath.row == (<span class="number">10</span> | <span class="number">12</span> | <span class="number">14</span>))&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¦‚æœä¸å®ç°è¯¥æ–¹æ³•ï¼Œé»˜è®¤ä¸ºYESã€‚</p>
<h4 id="ç¼–è¾‘æ¨¡å¼"><a href="#ç¼–è¾‘æ¨¡å¼" class="headerlink" title="ç¼–è¾‘æ¨¡å¼"></a>ç¼–è¾‘æ¨¡å¼</h4><p>é€šè¿‡è®¾ç½®<code>UITableViewCellEditingStyle</code>å¯ä»¥åˆ‡æ¢è¿›å…¥çš„ç¼–è¾‘æ¨¡å¼æ˜¯å®ç°æ’å…¥è¿˜æ˜¯åˆ é™¤æ“ä½œã€‚è¿™ä¸ªè¿”å›å€¼å°†ä½œä¸ºä¸‹é¢çš„<code>commitEditingStyle:forRowAtIndexPath:</code>æ–¹æ³•çš„å…¥å‚ä¼ å…¥ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">-(<span class="built_in">UITableViewCellEditingStyle</span>)tableView:(<span class="built_in">UITableView</span> *)tableView editingStyleForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    <span class="keyword">if</span> (condition) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">UITableViewCellEditingStyleInsert</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">   		<span class="keyword">return</span> <span class="built_in">UITableViewCellEditingStyleDelete</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ’å…¥å’Œåˆ é™¤è¡Œ"><a href="#ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ’å…¥å’Œåˆ é™¤è¡Œ" class="headerlink" title="ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ’å…¥å’Œåˆ é™¤è¡Œ"></a>ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ’å…¥å’Œåˆ é™¤è¡Œ</h4><p>å®ç°<code>tableView:commitEditingStyle:forRowAtIndexPath:</code>æ–¹æ³•ã€‚ä¼ å…¥ä¸‰ä¸ªå‚æ•°ã€‚<br>ç¬¬ä¸€ä¸ªå®å‚æ˜¯å‘é€è¯¥æ¶ˆæ¯çš„UITableViewå¯¹è±¡ã€‚<br>ç¬¬äºŒä¸ªå®å‚æ˜¯<code>UITableViewCellEditingStyle</code>ç±»å‹çš„å¸¸æ•°(åˆ é™¤è¡¨æ ¼è¡Œæ—¶ï¼Œä¼ å…¥çš„æ˜¯<code>UITableViewCellEditingStyleDelete</code>;æ’å…¥è¡¨æ ¼è¡Œæ—¶ï¼Œä¼ å…¥çš„æ˜¯<code>UITableViewCellEditingStyleInsert</code>)ã€‚<br>ç¬¬ä¸‰ä¸ªå®å‚æ˜¯ä¸€ä¸ªNSIndexPathå¯¹è±¡ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView commitEditingStyle:(<span class="built_in">UITableViewCellEditingStyle</span>)editingStyle forRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    <span class="keyword">if</span> (editingStyle == <span class="built_in">UITableViewCellEditingStyleDelete</span>) &#123;</div><div class="line">        [<span class="keyword">self</span>.dataSource removeObjectAtIndex:indexPath.row];</div><div class="line">        [<span class="keyword">self</span>.tableView deleteRowsAtIndexPaths:[<span class="built_in">NSArray</span> arrayWithObject:indexPath] withRowAnimation:<span class="built_in">UITableViewRowAnimationFade</span>];</div><div class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (editingStyle == <span class="built_in">UITableViewCellEditingStyleInsert</span>)&#123;</div><div class="line">    	[<span class="keyword">self</span>.dataSource insertObject:<span class="string">@"æˆ‘æ˜¯æ–°æ¥çš„"</span> atIndex:indexPath.row];</div><div class="line">        [_tableView insertRowsAtIndexPaths:@[indexPath] withRowAnimation:<span class="built_in">UITableViewRowAnimationBottom</span>];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨<code>deleteRowsAtIndexPaths</code>å’Œ<code>insertRowsAtIndexPaths</code>å¯ä»¥è¿›è¡Œå±€éƒ¨åˆ·æ–°ï¼ŒèŠ‚çœèµ„æºï¼Œå¹¶ä¸”è¿˜èƒ½æ·»åŠ æŒ‡å®šåŠ¨ç”»ã€‚<br>deleteæ“ä½œå¯ä»¥ä¸åœ¨ç¼–è¾‘æ¨¡å¼çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡å·¦æ»‘cellç›´æ¥è§¦å‘ã€‚æ’å…¥åˆ™å¿…é¡»è¿›å…¥ç¼–è¾‘æ¨¡å¼ã€‚</p>
<h4 id="cellçš„ç§»åŠ¨"><a href="#cellçš„ç§»åŠ¨" class="headerlink" title="cellçš„ç§»åŠ¨"></a>cellçš„ç§»åŠ¨</h4><p>è¿›å…¥ç¼–è¾‘æ¨¡å¼å<br>å®ç°<code>tableView:moveRowAtIndexPath:</code>æ–¹æ³•<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView moveRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)sourceIndexPath toIndexPath:(<span class="built_in">NSIndexPath</span> *)destinationIndexPath&#123;</div><div class="line">    <span class="keyword">if</span>(sourceIndexPath == destinationIndexPath)&#123;</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        Comment *comment = [<span class="keyword">self</span>.dataSource objectAtIndex:sourceIndexPath.row];</div><div class="line">        [<span class="keyword">self</span>.dataSource removeObjectAtIndex:sourceIndexPath.row];</div><div class="line">        [<span class="keyword">self</span>.dataSource insertObject:comment atIndex:destinationIndexPath.row];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä¸€å®šè¦å¯¹æ•°æ®æºè¿›è¡Œæ­£ç¡®æ“ä½œã€‚</p>
<h4 id="TableView-ä¿®æ”¹åˆ é™¤æŒ‰é’®"><a href="#TableView-ä¿®æ”¹åˆ é™¤æŒ‰é’®" class="headerlink" title="TableView ä¿®æ”¹åˆ é™¤æŒ‰é’®"></a>TableView ä¿®æ”¹åˆ é™¤æŒ‰é’®</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSString</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView titleForDeleteConfirmationButtonForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">@"åˆ é™¤"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ä¸åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹çš„ç¼–è¾‘æ–¹å¼"><a href="#ä¸åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹çš„ç¼–è¾‘æ–¹å¼" class="headerlink" title="ä¸åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹çš„ç¼–è¾‘æ–¹å¼"></a>ä¸åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹çš„ç¼–è¾‘æ–¹å¼</h3><h4 id="åˆ·æ–°æ–¹å¼"><a href="#åˆ·æ–°æ–¹å¼" class="headerlink" title="åˆ·æ–°æ–¹å¼"></a>åˆ·æ–°æ–¹å¼</h4><p>ç®€å•æ€»ç»“ä¸€äº›UITableViewçš„åˆ·æ–°æ–¹æ³•ï¼š</p>
<ul>
<li>reloadData                                    åˆ·æ–°æ•´ä¸ªè¡¨æ ¼</li>
<li>reloadRowsAtIndexPaths:withRowAnimation:        åˆ·æ–°indexPathæŒ‡å‘çš„cell</li>
<li>reloadSections:withRowAnimation:                åˆ·æ–°NSIndexSetå†…åŒ…å«çš„Section</li>
</ul>
<p>è¿™ä¸‰ä¸ªåˆ†åˆ«åˆ·æ–°tableviewçš„å„ä¸ªéƒ¨åˆ†<br>ç¬¬ä¸€ä¸ªæ²¡æœ‰åŠ¨ç”»æ•ˆæœã€‚<br>ç¬¬äºŒä¸ªå¯ä»¥ä¼ å…¥ä¸€ä¸ªæ•°ç»„<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[_tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:<span class="built_in">UITableViewRowAnimationTop</span>];</div></pre></td></tr></table></figure></p>
<p>ç¬¬ä¸‰ä¸ªå¯ä»¥ä¼ å…¥ä¸€ä¸ªNSIndexSeté›†åˆ<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="keyword">self</span>.tableView reloadSections:[<span class="built_in">NSIndexSet</span> indexSetWithIndexesInRange:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, <span class="number">2</span>)] withRowAnimation:<span class="built_in">UITableViewRowAnimationFade</span>];</div><div class="line">[_tableView reloadSections:[<span class="built_in">NSIndexSet</span> indexSetWithIndex:indexPath.section]withRowAnimation:<span class="built_in">UITableViewRowAnimationLeft</span>];</div></pre></td></tr></table></figure></p>
<h4 id="æ’å…¥åˆ é™¤"><a href="#æ’å…¥åˆ é™¤" class="headerlink" title="æ’å…¥åˆ é™¤"></a>æ’å…¥åˆ é™¤</h4><p>åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ’å…¥åˆ é™¤æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥ç”¨åœ¨ä»»ä½•æƒ³ç”¨çš„åœºæ™¯ä¸‹ï¼Œåªéœ€è¦è°ƒç”¨ä¸€ä¸‹æ–¹æ³•ï¼Œå¹¶ä¸”ä¿æŒdataSourceæ­£ç¡®å³å¯ã€‚</p>
<ul>
<li>deleteRowsAtIndexPaths:withRowAnimation:</li>
<li>insertRowsAtIndexPaths:withRowAnimation:</li>
</ul>
<p>å°±ä¸ä¸¾ä¾‹äº†ã€‚åŒä¸Šé¢ä¸€æ ·ã€‚</p>
<h2 id="å°æŠ€å·§"><a href="#å°æŠ€å·§" class="headerlink" title="å°æŠ€å·§"></a>å°æŠ€å·§</h2><h3 id="å½“cellæœªèƒ½å¡«æ»¡tableviewæ—¶ï¼Œæ€ä¹ˆå“åº”ç©ºç™½éƒ¨åˆ†ç‚¹å‡»äº‹ä»¶"><a href="#å½“cellæœªèƒ½å¡«æ»¡tableviewæ—¶ï¼Œæ€ä¹ˆå“åº”ç©ºç™½éƒ¨åˆ†ç‚¹å‡»äº‹ä»¶" class="headerlink" title="å½“cellæœªèƒ½å¡«æ»¡tableviewæ—¶ï¼Œæ€ä¹ˆå“åº”ç©ºç™½éƒ¨åˆ†ç‚¹å‡»äº‹ä»¶"></a>å½“cellæœªèƒ½å¡«æ»¡tableviewæ—¶ï¼Œæ€ä¹ˆå“åº”ç©ºç™½éƒ¨åˆ†ç‚¹å‡»äº‹ä»¶</h3><p>å½“ tableview å¤ªå¤§ï¼Œcell å¤ªå°‘ï¼Œä»¥è‡³äºä¸èƒ½å¡«æ»¡tableviewçš„æ—¶å€™ï¼Œé‚£ä¹ˆç©ºç™½éƒ¨åˆ†çš„ç‚¹å‡»äº‹ä»¶è¯¥æ€ä¹ˆè®¾ç½®å‘¢ï¼Ÿåªè¦ç»™ tableview æ·»åŠ ä¸€ä¸ª footerviewï¼Œè¿™ä¸ª footerview çš„å¤§å°æ˜¯æ•´ä¸ª tableview çš„å¤§å°ï¼Œç„¶åè®¾ç½®è¿™ä¸ª footerview çš„ç‚¹å‡»äº‹ä»¶å³å¯ã€‚</p>
<p>ä¸ºä»€ä¹ˆèƒ½è¿™æ ·å‘¢ï¼Ÿå› ä¸º cell æ²¡æœ‰å¡«å……æ»¡çš„éƒ¨åˆ†éƒ½ç”¨ footerview å¡«å……äº†ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[UIButton ç®€ä»‹]]></title>
      <url>http://zhang759740844.github.io/2016/08/29/UIButton%E5%9F%BA%E7%A1%80/</url>
      <content type="html"><![CDATA[<p>ä»æœ€åŸºç¡€çš„æ§ä»¶å¼€å§‹ä¸€ç‚¹ç‚¹å­¦ä¹ ã€‚å…ˆæ¥æ€»ç»“ä¸‹UIButtonã€‚</p>
<a id="more"></a>
<h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><h3 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIButton</span> *btn1 = [[<span class="built_in">UIButton</span> alloc] init];</div><div class="line"><span class="built_in">CGRect</span> btn1Frame = <span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">50</span>, <span class="number">200</span>, <span class="number">100</span>);</div><div class="line">btn1.frame = btn1Frame;</div><div class="line">[<span class="keyword">self</span>.view addSubview:btn1];</div></pre></td></tr></table></figure>
<p>é€šè¿‡<code>init</code>å’Œè®¾ç½®<code>frame</code>ä»¥åŠ<code>addSubView</code>å°±å¯ä»¥å°†buttonæ·»åŠ åˆ°Voewä¸Šã€‚</p>
<h3 id="ç‚¹å‡»äº‹ä»¶"><a href="#ç‚¹å‡»äº‹ä»¶" class="headerlink" title="ç‚¹å‡»äº‹ä»¶"></a>ç‚¹å‡»äº‹ä»¶</h3><h4 id="é€šè¿‡xibå…³è”"><a href="#é€šè¿‡xibå…³è”" class="headerlink" title="é€šè¿‡xibå…³è”"></a>é€šè¿‡xibå…³è”</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">IBAction</span>)btn2Pressed:(<span class="keyword">id</span>)sender&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ç‚¹å‡»æ“ä½œ"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸xibå…³è”å³å¯ï¼Œå…¶ä¸­<code>(id)sender</code>å°±è¡¨ç¤ºçš„æ˜¯è¿™ä¸ªButton</p>
<h4 id="é€šè¿‡ä»£ç "><a href="#é€šè¿‡ä»£ç " class="headerlink" title="é€šè¿‡ä»£ç "></a>é€šè¿‡ä»£ç </h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ·»åŠ </span></div><div class="line">[btn1 addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btn1Pressed:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</div><div class="line"><span class="comment">//ç§»é™¤</span></div><div class="line">[btn1 removeTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(btn1Pressed:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</div></pre></td></tr></table></figure>
<p>ä¸º<code>btn1</code>æ·»åŠ å’Œåˆ é™¤ä¸€ä¸ª<code>btn1Pressed</code>çš„ç‚¹å‡»äº‹ä»¶ã€‚</p>
<p>ä¸Šé¢æ·»åŠ ç‚¹å‡»äº‹ä»¶çš„æ–¹å¼éœ€è¦å…ˆå®šä¹‰ä¸€ä¸ªç‚¹å‡»æ–¹æ³• <code>btn1Pressed</code>ï¼Œç‚¹å‡»æ–¹æ³•å’Œ button æ·»åŠ äº‹ä»¶æ˜¯åˆ†ç¦»çš„ã€‚é‚£ä¹ˆå¦‚ä½•ç›´æ¥é€šè¿‡ block çš„å½¢å¼ä¸€æ­¥åˆ°ä½å‘¢ï¼Ÿå¯ä»¥å°è£…ç‚¹å‡»æ–¹æ³•ï¼Œåœ¨ç‚¹å‡»æ–¹æ³•æ‰§è¡Œæ˜¯è°ƒç”¨ä¼ å…¥çš„ blockï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®ç‚¹å‡»äº‹ä»¶</span></div><div class="line">[button handleClickBlock:^(<span class="built_in">UIButton</span> *button) &#123;</div><div class="line">	...</div><div class="line">&#125;];</div><div class="line"></div><div class="line"><span class="comment">//UIButtonçš„èŒƒç•´</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">void</span> (^ButtonActionBlock)(<span class="built_in">UIButton</span> *button);</div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIButton</span> (<span class="title">Block</span>)</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)handleClickBlock:(ButtonActionBlock)action &#123;</div><div class="line">    [<span class="keyword">self</span> handleControlEvents:<span class="built_in">UIControlEventTouchUpInside</span> withBlock:action];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)handleControlEvents:(<span class="built_in">UIControlEvents</span>)events withBlock:(ButtonActionBlock)action &#123;</div><div class="line">    [<span class="keyword">self</span> setAssociateCopyValue:action withKey:<span class="keyword">@selector</span>(handleControlEvents:withBlock:)];</div><div class="line">    [<span class="keyword">self</span> addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(buttonAction:) forControlEvents:events];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)buttonAction:(<span class="keyword">id</span>)sender &#123;</div><div class="line">    ButtonActionBlock block = (ButtonActionBlock)[<span class="keyword">self</span> associatedValueForKey:<span class="keyword">@selector</span>(handleControlEvents:withBlock:)];</div><div class="line">    <span class="keyword">if</span> (block) &#123;</div><div class="line">      	<span class="comment">// è®¾ç½®enabled ä¸ºçš„æ˜¯è®© button åœ¨æ‰§è¡Œå®Œ block å‰åªèƒ½ç›¸åº”ä¸€æ¬¡ç‚¹å‡»äº‹ä»¶</span></div><div class="line">        <span class="keyword">self</span>.enabled = <span class="literal">NO</span>;		</div><div class="line">        block(sender);</div><div class="line">        <span class="keyword">self</span>.enabled = <span class="literal">YES</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//å°è£…äº†ç»™categoryæ·»åŠ å±æ€§çš„æ–¹æ³•</span></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSObject</span> (<span class="title">Associate</span>)</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)setAssociateValue:(<span class="keyword">id</span>)value withKey:(<span class="keyword">void</span> *)key&#123;</div><div class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, key, value, OBJC_ASSOCIATION_RETAIN);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)setAssociateWeakValue:(<span class="keyword">id</span>)value withKey:(<span class="keyword">void</span> *)key&#123;</div><div class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, key, value, OBJC_ASSOCIATION_ASSIGN);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)setAssociateCopyValue:(<span class="keyword">id</span>)value withKey:(<span class="keyword">void</span> *)key &#123;</div><div class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, key, value, OBJC_ASSOCIATION_COPY_NONATOMIC);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">id</span>)associatedValueForKey:(<span class="keyword">void</span> *)key&#123;</div><div class="line">    <span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, key);</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h2 id="è®¾ç½®titleå’Œimage"><a href="#è®¾ç½®titleå’Œimage" class="headerlink" title="è®¾ç½®titleå’Œimage"></a>è®¾ç½®titleå’Œimage</h2><p>buttonæœ‰<code>imageView</code>å’Œ<code>titleLabel</code>ä¸¤ä¸ªå±æ€§ï¼Œé»˜è®¤imageåœ¨å·¦ï¼Œlabelåœ¨å³ã€‚</p>
<h3 id="æ·»åŠ titleå’Œimage"><a href="#æ·»åŠ titleå’Œimage" class="headerlink" title="æ·»åŠ titleå’Œimage"></a>æ·»åŠ titleå’Œimage</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[btn1 setImage:[UIImage imageNamed:@&quot;Image&quot;] forState:UIControlStateNormal];</div><div class="line">[btn1 setTitle:@&quot;BTN1&quot; forState:UIControlStateNormal];</div></pre></td></tr></table></figure>
<p>è¿™é‡Œ<code>forState</code>å¸¸ç”¨çš„æœ‰ä¸€ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>UIControlStateNormal          å¸¸æ€<ul>
<li>UIControlStateHighlighted é«˜äº®<ul>
<li>UIControlStateDisabledç¦ç”¨</li>
<li>UIControlStateSelectedé€‰ä¸­</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>å…¶ä¸­éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œé«˜äº®å°±æ˜¯ç‚¹å‡»æ—¶çš„çŠ¶æ€ã€‚å…¶å®è¿˜æœ‰ä¸€ç§<code>UIControlStateSelected | UIControlStateHighlighted</code>è¿™ä¸ªç»„åˆæ˜¯é€‰ä¸­æ—¶å€™çš„é«˜äº®çŠ¶æ€ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒæœ‰ç”¨çš„ã€‚</p>
<h3 id="è®¾ç½®buttoné€‰ä¸­"><a href="#è®¾ç½®buttoné€‰ä¸­" class="headerlink" title="è®¾ç½®buttoné€‰ä¸­"></a>è®¾ç½®buttoné€‰ä¸­</h3><p>buttoné€‰ä¸­ä¸å¦æ˜¯ç”±<code>UIControlStateSelected</code>æ§åˆ¶çš„ã€‚</p>
<p>å¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„æƒ…æ™¯ï¼šç‚¹å‡»ä¸€ä¸‹buttonåˆ‡æ¢æˆå¦å¤–ä¸€ä¸ªå›¾ï¼Œå†ç‚¹ä¸€ä¸‹åˆ‡æ¢å›å»ï¼Œå®é™…ä¸Šå°±æ˜¯ç±»ä¼¼äº<em>ç‚¹èµ</em>ã€‚ä¸€èˆ¬æƒ…å†µæˆ‘ä»¬å®ç°æ–¹å¼æ˜¯è¿™æ ·çš„ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)buttonClick:(<span class="built_in">UIButton</span> *)button &#123;</div><div class="line">    <span class="keyword">if</span> ([button.currentImage isEqual:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"like"</span>]]) &#123;</div><div class="line">        [button setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"like_selected"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        [button setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"like"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯æœ€å¥½ä¸è¦è¿™æ ·å®ç°ã€‚å¯ä»¥ä½¿ç”¨<code>UIControlStateSelected</code>æ¥æ§åˆ¶ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[btn1 setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Image"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line">[btn1 setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Image2"</span>] forState:<span class="built_in">UIControlStateSelected</span>];</div><div class="line"></div><div class="line"><span class="comment">//ç‚¹å‡»äº‹ä»¶</span></div><div class="line">- (<span class="keyword">void</span>)btn1Pressed:(<span class="built_in">UIButton</span> *)button&#123;</div><div class="line">    <span class="comment">//button.enabled è®¾ç½®æ˜¯å¦å¯ç‚¹å‡»ã€‚</span></div><div class="line">    button.selected = !button.selected;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™æ ·ï¼Œæ¯æ¬¡ç‚¹å‡»çš„æ—¶å€™åˆ‡æ¢é€‰ä¸­çŠ¶æ€è¾¾åˆ°æ•ˆæœã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™æ ·å¤„ç†ä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜:ä¸ç®¡æŒ‰é’®ä»normalçŠ¶æ€è½¬ä¸ºselectedçŠ¶æ€,è¿˜æ˜¯åè¿‡æ¥,ä¸­é—´éƒ½ä¼šç»å†ä¸€ä¸ªhighLightedçŠ¶æ€,è¿™å°±å¯¼è‡´åœ¨çŠ¶æ€åˆ‡æ¢çš„è¿‡ç¨‹ä¸­æœ‰ä¸€æ¬¡å›¾ç‰‡çš„è·³å˜ã€‚</p>
<p>å› æ­¤ï¼Œéœ€è¦å°†normal-&gt;selectedä»¥åŠselected-&gt;normalä¹‹é—´çš„highlightéƒ½è®¾ç½®ä¸€ä¸‹:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//normal-&gt;selected</span></div><div class="line">[btn1 setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Image"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</div><div class="line"><span class="comment">//selected-&gt;normal</span></div><div class="line">[btn1 setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"Image2"</span>] forState:<span class="built_in">UIControlStateSelected</span> | <span class="built_in">UIControlStateHighlighted</span>];</div></pre></td></tr></table></figure></p>
<p>å¥½çš„ï¼Œè¿™æ ·å°±å®Œæˆäº†åˆ‡æ¢çŠ¶æ€çš„è¿‡ç¨‹ã€‚</p>
<h3 id="è®¾ç½®imageå’Œtitleä½ç½®"><a href="#è®¾ç½®imageå’Œtitleä½ç½®" class="headerlink" title="è®¾ç½®imageå’Œtitleä½ç½®"></a>è®¾ç½®imageå’Œtitleä½ç½®</h3><p>imageå’Œtitleé»˜è®¤imageåœ¨å·¦ï¼Œtitleç´§è´´åœ¨å…¶å³è¾¹ã€‚ä¸è¿‡è¿™ä¸ªä½ç½®å…¶å®æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚</p>
<h4 id="imageå’Œtitleä½ç½®äº’æ¢"><a href="#imageå’Œtitleä½ç½®äº’æ¢" class="headerlink" title="imageå’Œtitleä½ç½®äº’æ¢"></a>imageå’Œtitleä½ç½®äº’æ¢</h4><p>å…ˆçœ‹ä»£ç ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[btn1 setTitleEdgeInsets:<span class="built_in">UIEdgeInsetsMake</span>(<span class="number">0</span>, -btn1.imageView.bounds.size.width, <span class="number">0</span>, btn1.imageView.bounds.size.width)];</div><div class="line">[btn1 setImageEdgeInsets:<span class="built_in">UIEdgeInsetsMake</span>(<span class="number">0</span>, btn1.titleLabel.bounds.size.width, <span class="number">0</span>, -btn1.titleLabel.bounds.size.width)];</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œéœ€è¦å¼ºè°ƒçš„æ˜¯ä¸€å®šè¦å…ˆè®¾ç½®<code>title</code>å†è®¾ç½®<code>image</code>ã€‚å› ä¸º<code>title</code>æ˜¯ä¾èµ–äº<code>image</code>çš„ï¼Œåœ¨å¦‚æœå…ˆè®¾ç½®<code>image</code>ï¼Œè¿™ä¸ªæ—¶å€™<code>title</code>è¿˜æ²¡æœ‰ç¡®å®šï¼Œäºæ˜¯<code>titleLabel.bounds.size.width</code>ä¸€å®šæ˜¯<code>0</code>ï¼Œå³<code>image</code>æ²¡æœ‰å˜ã€‚</p>
<p>è¿™é‡Œçš„<code>UIEdgeInsetsMake</code>é‡Œçš„å››ä¸ªå‚æ•°åˆ†åˆ«æ˜¯<code>top</code>,<code>left</code>,<code>bottom</code>,<code>right</code>å››ä¸ªæ–¹å‘çš„<code>inset</code>,é»˜è®¤æ˜¯<code>0</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰å˜åŒ–éƒ½æ˜¯é’ˆå¯¹å½“å‰ä½ç½®çš„ã€‚<code>-btn1.imageView.bounds.size.width</code>è¡¨ç¤ºè®©<code>title</code>çš„å·¦è¾¹è·<strong>å‡å°‘</strong><code>image</code>çš„å®½åº¦ï¼ŒåŒç†<code>btn1.imageView.bounds.size.width</code>è¡¨ç¤ºè®©å³è¾¹è·<strong>å¢åŠ </strong><code>image</code>çš„å®½åº¦ã€‚</p>
<h4 id="æ§åˆ¶imageçš„å¤§å°"><a href="#æ§åˆ¶imageçš„å¤§å°" class="headerlink" title="æ§åˆ¶imageçš„å¤§å°"></a>æ§åˆ¶imageçš„å¤§å°</h4><p>äº¤æ¢äº†imageçš„ä½ç½®åï¼Œæˆ‘å°±æƒ³æ€ä¹ˆæ§åˆ¶imageçš„å¤§å°ã€‚å°è¯•æ”¹å˜äº†<code>UIEdgeInsetsMake</code>çš„å‚æ•°ï¼Œå‘ç°æ”¹å˜<code>top</code>å’Œ<code>bottom</code>å¯ä»¥å°†å›¾ç‰‡å‹ç¼©ï¼Œä½†æ˜¯æ”¹å˜<code>left</code> <code>right</code>å›¾ç‰‡å§‹ç»ˆä¸åŠ¨ã€‚</p>
<p>ç»è¿‡æˆ‘ä¸æ–­å°è¯•åç»ˆäºå¾—å‡ºäº†ç»“è®ºï¼š<br>ä»¥æ¨ªè½´ä¸ºä¾‹ï¼Œåªæœ‰å½“<strong>å·¦è¾¹è·+å³è¾¹è·+å›¾ç‰‡å®½åº¦=buttonå®½åº¦</strong>æ—¶ï¼Œç»§ç»­å¢åŠ è¾¹è·ï¼Œæ‰ä¼šå¯¼è‡´å›¾ç‰‡çš„å‹ç¼©ã€‚å½“<strong>å·¦è¾¹è·+å³è¾¹è·+å›¾ç‰‡å®½åº¦&lt;buttonå®½åº¦</strong>æ—¶ï¼Œå¢åŠ ä¸€è¾¹ä¼šè®©å›¾åƒåƒå¦ä¸€è¾¹ç§»åŠ¨ï¼›åŒæ—¶å¢åŠ ä¸¤è¾¹ï¼Œä¸¤è¾¹æŠµæ¶ˆï¼Œåœ¨åŸå¤„ä¸åŠ¨ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºä»€ä¹ˆæ”¹å˜<code>top</code>å’Œ<code>bottom</code>å¯ä»¥å°†å›¾ç‰‡å‹ç¼©å‘¢ï¼Ÿå› ä¸ºç”±äºbuttoné«˜åº¦è¾ƒå°ï¼Œimageåœ¨çºµè½´å°†buttonå¡«æ»¡ï¼Œæ­¤æ—¶<code>top</code>å’Œ<code>bottom</code>éƒ½ä¸º0ï¼Œä½†æ˜¯ç”±äº<strong>imageé«˜åº¦=buttoné«˜åº¦</strong>ï¼Œæ­¤æ—¶å¢åŠ <code>top</code>å’Œ<code>bottom</code>å°±ä¼šå°†å›¾ç‰‡å‹ç¼©ã€‚å½“ç„¶ï¼Œå¦‚æœä¸€ä¸ªå¢åŠ ï¼Œä¸€ä¸ªç­‰é‡å‡å°ï¼Œå›¾ç‰‡å°±ä¼šåƒå‡å°‘é‚£è¾¹ç§»åŠ¨ã€‚</p>
<p>è€Œåœ¨æ¨ªè½´æ–¹é¢ï¼Œå¼€å§‹æ—¶ï¼Œ<strong>å·¦è¾¹è·+å³è¾¹è·+å›¾ç‰‡å®½åº¦&lt;buttonå®½åº¦</strong>ã€‚å›¾ç‰‡åªä¼šå¹³ç§»ç›´åˆ°è¾¹è·å¢åŠ åˆ°ä½¿ç­‰å¼ç›¸ç­‰æ‰ä¼šè¿›è¡Œå‹ç¼©ã€‚</p>
<h2 id="UIControl"><a href="#UIControl" class="headerlink" title="UIControl"></a>UIControl</h2><h3 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h3><p><code>UIControl</code> æ˜¯æ§ä»¶ç±»çš„åŸºç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥ä½¿ç”¨ <code>UIControl</code> ç±»æ¥å®ä¾‹åŒ–æ§ä»¶ï¼Œå®ƒåªæ˜¯ä¸ºæ§ä»¶å­ç±»å®šä¹‰ä¸€äº›é€šç”¨çš„æ¥å£ï¼Œå¹¶æä¾›ä¸€äº›åŸºç¡€å®ç°ï¼Œä»¥åœ¨äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œé¢„å¤„ç†è¿™äº›æ¶ˆæ¯å¹¶å°†å®ƒä»¬å‘é€åˆ°æŒ‡å®šç›®æ ‡å¯¹è±¡ä¸Šã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/uibutton_1.png?raw=true" alt="UIControl"></p>
<h3 id="Target-Actionæœºåˆ¶"><a href="#Target-Actionæœºåˆ¶" class="headerlink" title="Target-Actionæœºåˆ¶"></a>Target-Actionæœºåˆ¶</h3><p>Target-action æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç›´è¯‘è¿‡æ¥å°±æ˜¯â€ç›®æ ‡-è¡Œä¸ºâ€ã€‚å½“æˆ‘ä»¬é€šè¿‡ä»£ç ä¸ºä¸€ä¸ªæŒ‰é’®æ·»åŠ ä¸€ä¸ªç‚¹å‡»äº‹ä»¶æ—¶ï¼Œé€šå¸¸æ˜¯å¦‚ä¸‹å¤„ç†ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[button addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(tapButton:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä¼šå°†æ¶ˆæ¯å‘é€åˆ° <code>target</code>(æ­¤å¤„å³ä¸º <code>self</code> å¯¹è±¡)ï¼Œå¹¶ç”± <code>target</code> å¯¹è±¡çš„ <code>tapButton:</code> æ–¹æ³•æ¥å¤„ç†ç›¸åº”çš„äº‹ä»¶ã€‚å› æ­¤ï¼ŒTarget-Action æœºåˆ¶ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šå³ç›®æ ‡å¯¹è±¡å’Œè¡Œä¸º <code>Selector</code>ã€‚ç›®æ ‡å¯¹è±¡æŒ‡å®šæœ€ç»ˆå¤„ç†äº‹ä»¶çš„å¯¹è±¡ï¼Œè€Œè¡Œä¸º <code>Selector</code> åˆ™æ˜¯å¤„ç†äº‹ä»¶çš„æ–¹æ³•ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ UIControl ä¸ºæˆ‘ä»¬æä¾›äº†å“ªäº›è‡ªå®šä¹‰è·Ÿè¸ªè¡Œä¸ºçš„æ–¹æ³•:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)beginTrackingWithTouch:(<span class="built_in">UITouch</span> *)touch withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">- (<span class="built_in">BOOL</span>)continueTrackingWithTouch:(<span class="built_in">UITouch</span> *)touch withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">- (<span class="keyword">void</span>)endTrackingWithTouch:(<span class="built_in">UITouch</span> *)touch withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">- (<span class="keyword">void</span>)cancelTrackingWithEvent:(<span class="built_in">UIEvent</span> *)event</div></pre></td></tr></table></figure></p>
<p>è¿™å››ä¸ªæ–¹æ³•åˆ†åˆ«å¯¹åº”çš„æ—¶è·Ÿè¸ªå¼€å§‹ã€ç§»åŠ¨ã€ç»“æŸã€å–æ¶ˆå››ç§çŠ¶æ€ã€‚è·Ÿ <code>UIResponse</code> æä¾›çš„å››ä¸ªäº‹ä»¶è·Ÿè¸ªæ–¹æ³•æ˜¯ä¸æ˜¯æŒºåƒçš„ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹ <code>UIResponse</code> çš„å››ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">- (<span class="keyword">void</span>)touchesMoved:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">- (<span class="keyword">void</span>)touchesEnded:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">- (<span class="keyword">void</span>)touchesCancelled:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸¤ç»„æ–¹æ³•çš„å‚æ•°åŸºæœ¬ç›¸åŒï¼Œåªä¸è¿‡ <code>UIControl</code> çš„æ˜¯é’ˆå¯¹å•ç‚¹è§¦æ‘¸ï¼Œè€Œ <code>UIResponse</code> å¯èƒ½æ˜¯å¤šç‚¹è§¦æ‘¸ã€‚å¦å¤–ï¼Œè¿”å›å€¼ä¹Ÿæ˜¯å¤§åŒå°å¼‚ã€‚ç”±äº <code>UIControl</code> æœ¬èº«æ˜¯è§†å›¾ï¼Œæ‰€ä»¥å®ƒå®é™…ä¸Šä¹Ÿç»§æ‰¿äº† <code>UIResponse</code> çš„è¿™å››ä¸ªæ–¹æ³•ã€‚å¦‚æœæµ‹è¯•ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°<strong>åœ¨é’ˆå¯¹æ§ä»¶çš„è§¦æ‘¸äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè¿™ä¸¤ç»„æ–¹æ³•éƒ½ä¼šè¢«è°ƒç”¨ï¼Œè€Œä¸”äº’ä¸å¹²æ¶‰ã€‚</strong></p>
<p>å¯¹äºä¸€ä¸ªç»™å®šçš„äº‹ä»¶ï¼Œ<code>UIControl</code> ä¼šè°ƒç”¨ <code>sendAction:to:forEvent:</code> æ¥å°†è¡Œä¸ºæ¶ˆæ¯è½¬å‘åˆ° <code>UIApplication</code>å¯¹è±¡ï¼Œå†ç”± <code>UIApplication</code> å¯¹è±¡è°ƒç”¨å…¶ <code>sendAction:to:fromSender:forEvent:</code> æ–¹æ³•æ¥å°†æ¶ˆæ¯åˆ†å‘åˆ°æŒ‡å®šçš„ <code>target</code> ä¸Šã€‚è€Œå¦‚æœå­ç±»æƒ³ç›‘æ§æˆ–ä¿®æ”¹è¿™ç§è¡Œä¸ºçš„è¯ï¼Œåˆ™å¯ä»¥é‡å†™è¿™ä¸ªæ–¹æ³•:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ImageControl.m</span></div><div class="line">- (<span class="keyword">void</span>)sendAction:(SEL)action to:(<span class="keyword">id</span>)target forEvent:(<span class="built_in">UIEvent</span> *)event &#123;</div><div class="line">  <span class="comment">// å°†äº‹ä»¶ä¼ é€’åˆ°å¯¹è±¡æœ¬èº«æ¥å¤„ç†</span></div><div class="line">    [<span class="keyword">super</span> sendAction:<span class="keyword">@selector</span>(handleAction:) to:<span class="keyword">self</span> forEvent:event];</div><div class="line">&#125;</div><div class="line"> </div><div class="line">- (<span class="keyword">void</span>)handleAction:(<span class="keyword">id</span>)sender &#123;</div><div class="line"> </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"handle Action"</span>);</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="comment">// ViewController.m</span></div><div class="line"> </div><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line"> </div><div class="line">    <span class="keyword">self</span>.view.backgroundColor = [<span class="built_in">UIColor</span> whiteColor];</div><div class="line"> </div><div class="line">    ImageControl *control = [[ImageControl alloc] initWithFrame:(<span class="built_in">CGRect</span>)&#123;<span class="number">50.0</span>f, <span class="number">100.0</span>f, <span class="number">200.0</span>f, <span class="number">300.0</span>f&#125; title:<span class="string">@"This is a demo"</span> image:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"demo"</span>]];</div><div class="line">    <span class="comment">// ...</span></div><div class="line"> </div><div class="line">    [control addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(tapImageControl:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)tapImageControl:(<span class="keyword">id</span>)sender &#123;</div><div class="line"> </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"sender = %@"</span>, sender);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç”±äºæˆ‘ä»¬é‡å†™äº† <code>sendAction:to:forEvent:</code> æ–¹æ³•ï¼Œæ‰€ä»¥æœ€åå¤„ç†äº‹ä»¶çš„ <code>Selector</code> æ˜¯ <code>ImageControlçš„handleAction:</code> æ–¹æ³•ï¼Œè€Œä¸æ˜¯ <code>ViewController</code> çš„ <code>tapImageControl:</code> æ–¹æ³•ã€‚</p>
<h3 id="Target-Actionçš„ç®¡ç†"><a href="#Target-Actionçš„ç®¡ç†" class="headerlink" title="Target-Actionçš„ç®¡ç†"></a>Target-Actionçš„ç®¡ç†</h3><p>ä¸ºä¸€ä¸ªæ§ä»¶å¯¹è±¡æ·»åŠ ã€åˆ é™¤Target-Actionçš„æ“ä½œæˆ‘ä»¬éƒ½å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼Œä¸»è¦ä½¿ç”¨çš„æ˜¯ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ·»åŠ </span></div><div class="line">- (<span class="keyword">void</span>)addTarget:(<span class="keyword">id</span>)target action:(SEL)action forControlEvents:(<span class="built_in">UIControlEvents</span>)controlEvents</div><div class="line"> </div><div class="line">- (<span class="keyword">void</span>)removeTarget:(<span class="keyword">id</span>)target action:(SEL)action forControlEvents:(<span class="built_in">UIControlEvents</span>)controlEvents</div></pre></td></tr></table></figure></p>
<p>å¦‚æœæƒ³è·å–æ§ä»¶å¯¹è±¡æ‰€æœ‰ç›¸å…³çš„ <code>target</code> å¯¹è±¡ï¼Œåˆ™å¯ä»¥è°ƒç”¨ <code>allTargets</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªé›†åˆã€‚é›†åˆä¸­å¯èƒ½åŒ…å« <code>NSNull</code> å¯¹è±¡ï¼Œè¡¨ç¤ºè‡³å°‘æœ‰ä¸€ä¸ª <code>nil</code> ç›®æ ‡å¯¹è±¡ã€‚</p>
<p>è€Œå¦‚æœæƒ³è·å–æŸä¸ª <code>target</code> å¯¹è±¡åŠäº‹ä»¶ç›¸å…³çš„æ‰€æœ‰ <code>action</code>ï¼Œåˆ™å¯ä»¥è°ƒç”¨ <code>actionsForTarget:forControlEvent:</code> æ–¹æ³•ã€‚è¿”å›ä¸€ä¸ªå¯å˜æ•°ç»„ã€‚</p>
<p>å°±æ˜¯è¿™æ ·<del>O(âˆ©_âˆ©)O</del></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[GitæŠ€å·§]]></title>
      <url>http://zhang759740844.github.io/2016/08/27/git%E6%8A%80%E5%B7%A7/</url>
      <content type="html"><![CDATA[<p>è™½ç„¶ä¸€ç›´ä½¿ç”¨sourcetreeï¼Œè¿˜æ˜¯åº”è¯¥å¯¹gitæŒ‡ä»¤åšä¸€äº›äº†è§£çš„ã€‚æœ¬ç¯‡å°†åˆ—ä¸¾ä½¿ç”¨ä¸­é‡åˆ°çš„å…³äºgitçš„ä¸€äº›ä½¿ç”¨æŠ€å·§ã€‚ä¸å®šæœŸæ›´æ–°ã€‚</p>
<a id="more"></a>
<h2 id="git-rm"><a href="#git-rm" class="headerlink" title="git rm"></a>git rm</h2><p>iosä¸­podçš„ç¬¬ä¸‰æ–¹åº“ç»å¸¸ä¼šè¢«<code>gitignore</code>æ‰ï¼Œè®©ä½¿ç”¨è€…è‡ªå·±ä¸‹è½½ã€‚</p>
<p>æƒ³è¦è¾¾åˆ°ä¸€ä¸ªæ•ˆæœï¼šä½¿æ–‡ä»¶è„±ç¦»gitçš„ç‰ˆæœ¬ç®¡ç†ï¼Œä½†ä¸æ˜¯ä¼šåˆ é™¤å®ƒ.</p>
<h3 id="ä½¿ç”¨å‘½ä»¤è¡Œ"><a href="#ä½¿ç”¨å‘½ä»¤è¡Œ" class="headerlink" title="ä½¿ç”¨å‘½ä»¤è¡Œ"></a>ä½¿ç”¨å‘½ä»¤è¡Œ</h3><p>å¯ä»¥ä½¿ç”¨<code>git rm --cached file</code><br>Git å°†ä¸å†è·Ÿè¸ªæ­¤æ–‡ä»¶ï¼Œå°½ç®¡å®ƒä»ç„¶æ˜¯åœ¨æ‚¨çš„ç¡¬ç›˜ä¸Š.<br>å¯¹äºæ–‡ä»¶å¤¹ï¼Œå¯ä»¥ä½¿ç”¨<code>git rm -r --cached file</code>å–æ¶ˆå…³è”æ•´ä¸ªæ–‡ä»¶å¤¹ã€‚</p>
<h3 id="ä½¿ç”¨sourcetree"><a href="#ä½¿ç”¨sourcetree" class="headerlink" title="ä½¿ç”¨sourcetree"></a>ä½¿ç”¨sourcetree</h3><p>åœ¨sourcetreeä¸­æ“ä½œè¦éº»çƒ¦ä¸€äº›ã€‚åœ¨æ·»åŠ å®Œ<code>gitignore</code>åï¼Œå°†æƒ³è¦ignoreçš„æ–‡ä»¶ç§»å‡ºgitç›®å½•ï¼Œç„¶å<code>commit</code>è¯¥æ“ä½œï¼Œå†å°†æ–‡ä»¶ç§»å›æ¥ã€‚è¿™ä¸ªæ—¶å€™æ–‡ä»¶å°±è¢«ignoreäº†ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€å®šè¦å…ˆæ‰§è¡Œ<code>commit</code>æ“ä½œã€‚å› ä¸ºï¼Œåœ¨<code>.git</code>ä¸­å­˜åœ¨äº†podçš„ç‰ˆæœ¬æ§åˆ¶çš„æ–‡ä»¶å…³è”ï¼Œæ·»åŠ äº†<code>gitignore</code>åï¼Œgitå¹¶ä¸ä¼šä¸»åŠ¨å°†podæ–‡ä»¶å…³è”åˆ æ‰ã€‚<br>å› æ­¤ï¼Œéœ€è¦å…ˆç”¨<code>commit</code>å°†è¯¥æ–‡ä»¶å…³è”åˆ é™¤ï¼Œæ‰èƒ½æ­£ç¡®ignoreè¯¥æ–‡ä»¶å¤¹ã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™é‡Œçš„ç§»é™¤ç›¸å½“äºæ‰§è¡Œäº† <code>rm æ–‡ä»¶</code>çš„æ“ä½œï¼Œå› è€Œéœ€è¦ä½¿ç”¨<code>commit</code>,è€Œä½¿ç”¨å‘½ä»¤è¡Œçš„<code>git rm æ–‡ä»¶</code>åˆ™æ˜¯é€šè¿‡gitæŒ‡ä»¤ï¼Œç›´æ¥ç§»é™¤äº†å…³è”ã€‚</p>
<h2 id="git-add"><a href="#git-add" class="headerlink" title="git add"></a>git add</h2><p>ä¸ç®¡æ˜¯ä»€ä¹ˆé¡¹ç›®æ€»æ˜¯éœ€è¦æ·»åŠ æ–°æ–‡ä»¶çš„ã€‚æ·»åŠ æ–°æ–‡ä»¶å³addï¼Œä½†æ˜¯ä»githubä¸Šcloneçš„æ¡†æ¶æ€»æ˜¯ä¸èƒ½è‡ªåŠ¨æ·»åŠ åˆ°æœ¬åœ°çš„gitç‰ˆæœ¬é‡Œã€‚å¯èƒ½æ˜¯ç”±äºcloneçš„æ¡†æ¶æœ¬ç”Ÿå¸¦æœ‰<code>.git</code>çš„ç¼˜æ•…å§ã€‚</p>
<p>å› æ­¤ï¼Œå¦‚æœå½“gitä¸èƒ½è‡ªåŠ¨æ·»åŠ æ–‡ä»¶å…³è”çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨<code>git add æ–‡ä»¶</code>çš„æ–¹å¼æ‰‹åŠ¨æ·»åŠ ã€‚</p>
<p>ä½¿ç”¨sourcetreeæ—¶ï¼Œä¹Ÿå¯ä»¥å°†è¦æ·»åŠ çš„éƒ¨åˆ†å…ˆä¿å­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œç„¶åå°†æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶å¤åˆ¶åˆ°æƒ³è¦æ”¾çš„åœ°æ–¹ã€‚è¿™æ ·éšè—çš„<code>.git</code>ä¸ä¼šè¢«å¤åˆ¶ï¼Œæ–‡ä»¶ä¹Ÿå°±èƒ½æ·»åŠ è¿›sourcetreeäº†ã€‚</p>
<h2 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h2><p>mergeå¯ä»¥è¯´æ˜¯å¾ˆå¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨äºä»£ç åˆå¹¶ã€‚</p>
<p>ä¸è¿‡ç”±äºä¹‹å‰æ²¡çœŸæ­£ç”¨è¿‡ï¼Œç”¨èµ·æ¥è¿˜æ¯”è¾ƒæ­»æ¿ã€‚æ¯”å¦‚ï¼Œå­¦çš„æ—¶å€™ç•™ä¸‹åˆ»æ¿å°è±¡å°±æ˜¯ï¼Œå°†feature branchåˆå¹¶è¿›developç”¨mergeï¼Œä½†æ˜¯åˆšåˆšé‡åˆ°è¦æŠŠdevelopåˆå¹¶åˆ°feature branchçš„æ—¶å€™å°±å¿˜æ‰mergeè¿™ä¸ªåŠŸèƒ½äº†ã€‚<strong>åªè¦æ˜¯å…³ä¹äºä¸åŒbranchçš„ä»£ç è¿›è¡Œåˆå¹¶éƒ½å¯ä»¥ç”¨mergeå•Š</strong>ã€‚</p>
<p>å¥½å§ã€‚å¯èƒ½åªæ˜¯æˆ‘è ¢è€Œå·²ã€‚ç¨å¾®åšä¸ªè®°å½•ï¼Œè¯æ˜è‡ªå·±æ›¾è ¢è¿‡ã€‚ä½†æ„¿ä¸è¦ä¸€ç›´è ¢ä¸‹å»ã€‚</p>
<h2 id="rebase"><a href="#rebase" class="headerlink" title="rebase"></a>rebase</h2><p>å˜åŸºæ“ä½œæ˜¯gitå¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œè¿™é‡Œä¸å†è¯´æ˜å…¶ä½œç”¨ï¼Œè€Œæ˜¯å¼ºè°ƒä¸€ä¸‹ä»–çš„é£é™©ã€‚</p>
<p>å˜åŸºæ“ä½œçš„ä¸€æ¡å‡†åˆ™æ˜¯ï¼š<strong>ä¸è¦å¯¹åœ¨ä½ çš„ä»“åº“å¤–æœ‰å‰¯æœ¬çš„åˆ†æ”¯æ‰§è¡Œå˜åŸº</strong>ã€‚</p>
<blockquote>
<p>å˜åŸºæ“ä½œçš„å®è´¨æ˜¯ä¸¢å¼ƒä¸€äº›ç°æœ‰çš„æäº¤ï¼Œç„¶åç›¸åº”åœ°æ–°å»ºä¸€äº›å†…å®¹ä¸€æ ·ä½†å®é™…ä¸Šä¸åŒçš„æäº¤ã€‚</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼šå˜åŸºæ“ä½œå°†å¼ºè¡Œæ”¹å˜ä»“åº“çš„æäº¤æƒ…å†µã€‚æ³¨æ„ï¼Œæ˜¯ä¸¢å¼ƒä¸æ˜¯åˆ é™¤ï¼Œgitå¯¹äºè¿™ç§ä¸¢å¼ƒæ²¡æœ‰ä»»ä½•è®°å½•ã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ<code>C5</code>æ˜¯å…¶ä»–åˆ†æ”¯çš„åˆå¹¶ã€‚å…ˆå°†masteré‡ç½®åˆ°<code>C1</code>çš„æäº¤ï¼Œç„¶årebase<code>C5</code>æ‰€åœ¨åˆ†æ”¯ï¼Œå¾—åˆ°æ–°çš„æäº¤<code>C4&#39;</code>ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œgitæ˜¯ä¸å…è®¸è¿™æ ·çš„æäº¤åˆ°remoteçš„ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>git push --force</code>å¼ºåˆ¶è¦†ç›–remoteçš„ä»“åº“ã€‚è¿™æ ·<code>C4``C6</code>å°±ä¸å¤å­˜åœ¨äº†ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/git_rebase_1.png?raw=true" alt="git_rebase_1"></p>
<p>è¯åˆ†ä¸¤å¤´ï¼Œåˆ«äººä¹Ÿæœ‰è‡ªå·±çš„æœ¬åœ°masterï¼Œå¹¶ä¸”åˆ«äººå·²ç»åˆå¹¶äº†ä¹‹å‰çš„æäº¤<code>C6</code>åˆ°<code>C7</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/git_rebase_2.png?raw=true" alt="git_rebase_2"></p>
<p>ç”±äºåˆ«äººçš„æœ¬åœ°gitå¹¶ä¸çŸ¥é“<code>C4``C6</code>å·²ç»ç”±äºrebaseè¢«åˆ é™¤ã€‚æ¯”å¯¹ä»“åº“ä¿¡æ¯åï¼Œåœ¨å®ƒçœ‹æ¥ï¼Œå°±æ˜¯remoteçš„masteræœ‰äº†ä¸€ä¸ªæ–°çš„æäº¤<code>C4&#39;</code>ï¼Œäºæ˜¯å°±æ‹‰å–ï¼Œä½†æ˜¯æœ¬åœ°gitä¸€çœ‹è¿œç«¯æäº¤<code>C4&#39;</code>å’Œæœ¬åœ°æäº¤<code>C4``C6</code>éƒ½ä¿®æ”¹äº†ç›¸åŒçš„æ–‡ä»¶ï¼Œé‚£å°±äº§ç”Ÿå†²çªäº†å•Šã€‚é‚£ä¹ˆåˆ«äººå°±å¿…é¡»è¦åˆå¹¶è¿™ä¸¤æ¡æäº¤å†å²çš„å†…å®¹ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„åˆå¹¶æäº¤ï¼Œæœ€ç»ˆä»“åº“ä¼šå¦‚å›¾æ‰€ç¤ºï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/git_rebase_3.png?raw=true" alt="git_rebase_3"></p>
<p>è¿™æ ·å°±æ¯”è¾ƒå°´å°¬äº†ï¼Œå› ä¸ºå½“æ—¶ä½¿ç”¨rebaseå°±æ˜¯ä¸ºäº†åˆ æ‰<code>C4``C6</code>ï¼Œä½†æ˜¯åˆ«äººè¿™ä¹ˆä¸€åˆå¹¶ä¸€æäº¤ï¼Œ<code>C4``C6</code>åˆå…¨å›æ¥äº†ã€‚</p>
<p>å¦‚æœåªæ˜¯å•äººå¼€å‘ï¼Œå˜åŸºæ“ä½œæ²¡æœ‰ä»»ä½•å±é™©ï¼Œæƒ³æ€ä¹ˆå˜æ€ä¹ˆå˜ã€‚ä½†æ˜¯åœ¨å¤šäººå¼€å‘ï¼Œåˆ‡è®°<strong>åªæŠŠå˜åŸºå‘½ä»¤å½“ä½œæ˜¯åœ¨æ¨é€å‰æ¸…ç†æäº¤ä½¿ä¹‹æ•´æ´çš„å·¥å…·ï¼Œå¹¶ä¸”åªåœ¨ä»æœªæ¨é€è‡³å…±ç”¨ä»“åº“çš„æäº¤ä¸Šæ‰§è¡Œå˜åŸºå‘½ä»¤</strong>ã€‚å‡å¦‚ä½ åœ¨é‚£äº›å·²ç»è¢«æ¨é€è‡³å…±ç”¨ä»“åº“çš„æäº¤ä¸Šæ‰§è¡Œå˜åŸºå‘½ä»¤ï¼Œå¹¶å› æ­¤ä¸¢å¼ƒäº†ä¸€äº›åˆ«äººçš„å¼€å‘æ‰€åŸºäºçš„æäº¤ï¼Œé‚£ä¹ˆé—®é¢˜å°±å¤§äº†ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[åˆè¯†Provisioning Profile]]></title>
      <url>http://zhang759740844.github.io/2016/08/26/%E5%88%9D%E8%AF%86Provisioning_Profile/</url>
      <content type="html"><![CDATA[<p>çœŸæœºè°ƒè¯•çš„æ—¶å€™é‡åˆ°äº†<em>provisioning profileå³å°†è¿‡æœŸ</em>çš„è­¦å‘Šï¼Œäºæ˜¯æœç´¢å¹¶å¯¹provisioning profileä½œäº†ä¸€å®šäº†è§£ã€‚ç»“åˆ<a href="http://www.cnblogs.com/cywin888/p/3263027.html" target="_blank" rel="external">å…³äºCertificateã€Provisioning Profileã€App IDçš„ä»‹ç»åŠå…¶ä¹‹é—´çš„å…³ç³»</a>è¿›è¡Œæ¢³ç†ã€‚</p>
<a id="more"></a>
<h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><h3 id="Certificate"><a href="#Certificate" class="headerlink" title="Certificate"></a>Certificate</h3><p>è¯ä¹¦æ˜¯ç”¨æ¥ç»™åº”ç”¨ç¨‹åºç­¾åçš„ï¼Œåªæœ‰ç»è¿‡ç­¾åçš„åº”ç”¨ç¨‹åºæ‰èƒ½ä¿è¯ä»–çš„æ¥æºæ˜¯å¯ä¿¡ä»»çš„ï¼Œå¹¶ä¸”ä»£ç æ˜¯å®Œæ•´çš„ï¼Œ æœªç»ä¿®æ”¹çš„ã€‚åœ¨Xcode Build Setting(ç‚¹å‡»å·¥ç¨‹æ–‡ä»¶)çš„Code Signing Identityä¸­ï¼Œä½ å¯ä»¥è®¾ç½®ç”¨äºä¸ºä»£ç ç­¾åçš„è¯ä¹¦ã€‚</p>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæˆ‘ä»¬ç”³è¯·ä¸€ä¸ªCertificateä¹‹å‰ï¼Œéœ€è¦å…ˆç”³è¯·ä¸€ä¸ªCertificate Signing Request (CSR) æ–‡ä»¶ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹ä¸­å®é™…ä¸Šæ˜¯ç”Ÿæˆäº†ä¸€å¯¹å…¬é’¥å’Œç§é’¥ï¼Œä¿å­˜åœ¨ä½ Macçš„Keychainä¸­ã€‚ä»£ç ç­¾åæ­£æ˜¯ä½¿ç”¨è¿™ç§åŸºäºéå¯¹ç§°ç§˜é’¥çš„åŠ å¯†æ–¹å¼ï¼Œç”¨ç§é’¥è¿›è¡Œç­¾åï¼Œç”¨å…¬é’¥è¿›è¡ŒéªŒè¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨ä½ Macçš„keychainçš„loginä¸­å­˜å‚¨ç€ç›¸å…³çš„å…¬é’¥å’Œç§é’¥ï¼Œè€Œè¯ä¹¦ä¸­åŒ…å«äº†å…¬é’¥ã€‚ä½ åªèƒ½ç”¨ç§é’¥æ¥è¿›è¡Œç­¾åï¼Œæ‰€ä»¥å¦‚æœæ²¡æœ‰äº†ç§é’¥ï¼Œå°±æ„å‘³ç€ä½ ä¸èƒ½è¿›è¡Œç­¾åäº†ï¼Œæ‰€ä»¥å°±æ— æ³•ä½¿ç”¨è¿™ä¸ªè¯ä¹¦äº†ï¼Œæ­¤æ—¶ä½ åªèƒ½revokeä¹‹å‰çš„è¯ä¹¦å†ç”³è¯·ä¸€ä¸ªã€‚å› æ­¤åœ¨ç”³è¯·å®Œè¯ä¹¦æ—¶ï¼Œæœ€å¥½å¯¼å‡ºå¹¶ä¿å­˜å¥½ä½ çš„ç§é’¥ã€‚å½“ä½ æƒ³ä¸å…¶ä»–äººæˆ–å…¶ä»–è®¾å¤‡å…±äº«è¯ä¹¦æ—¶ï¼ŒæŠŠç§é’¥ä¼ ç»™å®ƒå°±å¯ä»¥äº†ã€‚ç§é’¥ä¿å­˜åœ¨ä½ çš„Macä¸­ï¼Œè€Œè‹¹æœç”Ÿæˆçš„Certificateä¸­åŒ…å«äº†å…¬é’¥ã€‚å½“ä½ ç”¨è‡ªå·±çš„ç§é’¥å¯¹ä»£ç ç­¾ååï¼Œè‹¹æœå°±å¯ä»¥ç”¨è¯ä¹¦ä¸­çš„å…¬é’¥æ¥è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿æ˜¯ä½ å¯¹ä»£ç è¿›è¡Œäº†ç­¾åï¼Œè€Œä¸æ˜¯åˆ«äººå†’å……ä½ ï¼ŒåŒæ—¶ä¹Ÿç¡®ä¿ä»£ç çš„å®Œæ•´æ€§ç­‰ã€‚ </p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/profile_certificate.png?raw=true" alt="è¯ä¹¦çš„ç§é’¥å’Œå…¬é’¥"></p>
<p>è¯ä¹¦ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼šDevelopmentå’ŒProductionï¼ŒDevelopmentè¯ä¹¦ç”¨æ¥å¼€å‘å’Œè°ƒè¯•åº”ç”¨ç¨‹åºï¼ŒProductionä¸»è¦ç”¨æ¥åˆ†å‘ï¼ˆç”Ÿäº§ï¼Œä¸Šæ¶Appstoreï¼‰åº”ç”¨ç¨‹åºï¼ˆæ ¹æ®è¯ä¹¦ç§ç±»æœ‰ä¸åŒä½œç”¨ï¼‰</p>
<h3 id="APP-ID"><a href="#APP-ID" class="headerlink" title="APP ID"></a>APP ID</h3><p>App IDç”¨äºæ ‡è¯†ä¸€ä¸ªæˆ–è€…ä¸€ç»„Appï¼ŒApp IDåº”è¯¥æ˜¯å’ŒXcodeä¸­çš„Bundle IDæ˜¯ä¸€è‡´çš„æˆ–è€…åŒ¹é…çš„ã€‚App IDä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p>
<ul>
<li>Explicit App IDï¼šå”¯ä¸€çš„App IDï¼Œè¿™ç§App IDç”¨äºå”¯ä¸€æ ‡è¯†ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚com.ABC.demo1ï¼Œæ ‡è¯†Bundle IDä¸ºcom.ABC.demo1çš„ç¨‹åºã€‚</li>
<li>Wildcard App IDï¼šé€šé…ç¬¦App IDï¼Œç”¨äºæ ‡è¯†ä¸€ç»„åº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚*å¯ä»¥è¡¨ç¤ºæ‰€æœ‰åº”ç”¨ç¨‹åºï¼Œè€Œcom.ABC.*å¯ä»¥è¡¨ç¤ºä»¥com.ABCå¼€å¤´çš„æ‰€æœ‰åº”ç”¨ç¨‹åºã€‚</li>
</ul>
<p>æ¯åˆ›å»ºä¸€ä¸ªApp IDï¼Œæˆ‘ä»¬éƒ½å¯ä»¥è®¾ç½®è¯¥App IDæ‰€ä½¿ç”¨çš„APP Servicesï¼Œä¹Ÿå°±æ˜¯å…¶æ‰€ä½¿ç”¨çš„é¢å¤–æœåŠ¡ã€‚æ¯ç§é¢å¤–æœåŠ¡éƒ½æœ‰ç€ä¸åŒçš„è¦æ±‚ï¼Œä¾‹å¦‚ï¼Œå¦‚æœè¦ä½¿ç”¨Apple Push Notification Servicesï¼Œåˆ™å¿…é¡»æ˜¯ä¸€ä¸ªexplicit App IDï¼Œä»¥ä¾¿èƒ½å”¯ä¸€æ ‡è¯†ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚</p>
<h3 id="Device"><a href="#Device" class="headerlink" title="Device"></a>Device</h3><p>Deviceæœ€ç®€å•äº†ï¼Œå°±æ˜¯iOSè®¾å¤‡ã€‚Devicesä¸­åŒ…å«äº†è¯¥è´¦æˆ·ä¸­æ‰€æœ‰å¯ç”¨äºå¼€å‘å’Œæµ‹è¯•çš„è®¾å¤‡ã€‚ æ¯å°è®¾å¤‡ä½¿ç”¨UDIDæ¥å”¯ä¸€æ ‡è¯†ã€‚</p>
<p>æ¯ä¸ªè´¦æˆ·ä¸­çš„è®¾å¤‡æ•°é‡é™åˆ¶æ˜¯100ä¸ªã€‚Disable ä¸€å°è®¾å¤‡ä¹Ÿä¸ä¼šå¢åŠ åé¢ï¼Œåªèƒ½åœ¨membership year å¼€å§‹çš„æ—¶å€™æ‰èƒ½é€šè¿‡åˆ é™¤è®¾å¤‡æ¥å¢åŠ åé¢ã€‚</p>
<h3 id="Provisioning-Profile"><a href="#Provisioning-Profile" class="headerlink" title="Provisioning Profile"></a>Provisioning Profile</h3><p>ä¸€ä¸ªProvisioning Profileæ–‡ä»¶åŒ…å«äº†ä¸Šè¿°çš„æ‰€æœ‰å†…å®¹ï¼šè¯ä¹¦ã€App IDã€è®¾å¤‡ã€‚</p>
<p>è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬è¦æ‰“åŒ…æˆ–è€…åœ¨çœŸæœºä¸Šè¿è¡Œä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦è¯ä¹¦æ¥è¿›è¡Œç­¾åï¼Œç”¨æ¥æ ‡è¯†è¿™ä¸ªåº”ç”¨ç¨‹åºæ˜¯åˆæ³•çš„ã€å®‰å…¨çš„ã€å®Œæ•´çš„ç­‰ç­‰ï¼›ç„¶åéœ€è¦æŒ‡æ˜å®ƒçš„App IDï¼Œå¹¶ä¸”éªŒè¯Bundle IDæ˜¯å¦ä¸å…¶ä¸€è‡´ï¼›å†æ¬¡ï¼Œå¦‚æœæ˜¯çœŸæœºè°ƒè¯•ï¼Œéœ€è¦ç¡®è®¤è¿™å°è®¾å¤‡èƒ½å¦ç”¨æ¥è¿è¡Œç¨‹åºã€‚è€ŒProvisioning Profileå°±æŠŠè¿™äº›ä¿¡æ¯å…¨éƒ¨æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨è°ƒè¯•å’Œå‘å¸ƒç¨‹åºæ‰“åŒ…æ—¶ä½¿ç”¨ï¼Œè¿™æ ·æˆ‘ä»¬åªè¦åœ¨ä¸åŒçš„æƒ…å†µä¸‹é€‰æ‹©ä¸åŒçš„profileæ–‡ä»¶å°±å¯ä»¥äº†ã€‚è€Œä¸”è¿™ä¸ªProvisioning Profileæ–‡ä»¶ä¼šåœ¨æ‰“åŒ…æ—¶åµŒå…¥.ipaçš„åŒ…é‡Œã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸€ä¸ªç”¨äºDevelopmentçš„Provisioning Profileä¸­åŒ…å«äº†è¯¥Provisioning Profileå¯¹åº”çš„App IDï¼Œå¯ä½¿ç”¨çš„è¯ä¹¦å’Œè®¾å¤‡ã€‚è¿™æ„å‘³ç€ä½¿ç”¨è¿™ä¸ªProvisioning Profileæ‰“åŒ…ç¨‹åºå¿…é¡»æ‹¥æœ‰ç›¸åº”çš„è¯ä¹¦ï¼Œå¹¶ä¸”æ˜¯å°†App IDå¯¹åº”çš„ç¨‹åºè¿è¡Œåˆ°Devicesä¸­åŒ…å«çš„è®¾å¤‡ä¸Šå»ã€‚</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/Provisioning_Profile_consist.png?raw=true" alt="Provisioning Profileç»„æˆ"></p>
<p>å¦‚ä¸Šæ‰€è¿°ï¼Œåœ¨ä¸€å°è®¾å¤‡ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/Provisioning_Profile_Confirm.png?raw=true" alt="Provisioning ProfileéªŒè¯"></p>
<p>ä¸è¯ä¹¦ä¸€æ ·ï¼ŒProvisioning Profileä¹Ÿåˆ†ä¸ºDevelopmentå’ŒDistributionä¸¤ç§</p>
<h2 id="Xcode-7-å…è¯ä¹¦çœŸæœºè°ƒè¯•"><a href="#Xcode-7-å…è¯ä¹¦çœŸæœºè°ƒè¯•" class="headerlink" title="Xcode 7+ å…è¯ä¹¦çœŸæœºè°ƒè¯•"></a>Xcode 7+ å…è¯ä¹¦çœŸæœºè°ƒè¯•</h2><p>åœ¨Xcode 7+ ä¸­ï¼Œè‹¹æœæ”¹å˜äº†è‡ªå·±åœ¨è®¸å¯æƒé™ä¸Šçš„ç­–ç•¥ï¼Œæ­¤å‰Xcodeåªå¼€æ”¾ç»™æ³¨å†Œå¼€å‘è€…ä¸‹è½½ï¼Œä½†Xcode 7æ”¹å˜äº†è¿™ç§æƒ¯æœ‰çš„åšæ³•ï¼Œæ— éœ€æ³¨å†Œå¼€å‘è€…è´¦å·ï¼Œä»…ä½¿ç”¨æ™®é€šçš„Apple IDå°±èƒ½ä¸‹è½½å’Œä¸Šæ‰‹ä½“éªŒã€‚æ­¤å‰å¼€å‘è€…éœ€æ¯å¹´æ”¯ä»˜99ç¾å…ƒçš„è´¹ç”¨æˆä¸ºæ³¨å†Œå¼€å‘è€…æ‰èƒ½åœ¨iPhoneã€iPadã€Apple Watchç­‰çœŸæœºä¸Šè¿è¡Œä»£ç ï¼Œè‹¹æœæ–°çš„å¼€å‘è€…è®¡åˆ’åˆ™æ”¾å®½è¦æ±‚ï¼Œæ— éœ€è´­ä¹°ï¼Œåªè¦ä½ æ„Ÿå…´è¶£åŒæ ·å¯ä»¥åœ¨çœŸæœºè®¾å¤‡ä¸Šæµ‹è¯•app</p>
<h3 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h3><ol>
<li>æ‰“å¼€è‡ªå·±å·²æœ‰çš„å·¥ç¨‹æˆ–è€…æ‰“å¼€Xcodeæ–°å»ºä¸€ä¸ªç®€å•å·¥ç¨‹</li>
<li>èœå•æ é€‰æ‹©Xcode,ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©Preferencesâ€¦(å¿«æ·é”® command + , )<br> <img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/NoCertificateDebug.png?raw=true" alt="1"></li>
<li>åœ¨Accountsé€‰é¡¹å¡æ·»åŠ è‡ªå·±çš„Apple IDã€‚æ·»åŠ å®Œæˆåä½ ä¼šçœ‹åˆ°è¿™æ ·çš„ä¿¡æ¯ã€‚å¯ä»¥çœ‹åˆ°ä¸‹é¢æ˜¾ç¤ºäº†iOSå’ŒMacçš„Freeæ ‡è®°äº†ï¼Œåœ¨è¿™ä¹‹å‰æ˜¯æ²¡æœ‰è¿™äº›æ ‡è®°çš„ã€‚<br> <img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/NoCertificateDebg2.png?raw=true" alt="2"></li>
<li>å°†æµ‹è¯•çš„iPhoneæˆ–è€…å…¶ä»–çœŸæœºæµ‹è¯•è®¾å¤‡è¿æ¥Macï¼ŒXcodeé€‰ä¸­çœŸæœºæµ‹è¯•è®¾å¤‡ï¼Œç›´æ¥ç‚¹å‡»è¿è¡Œã€‚<br> <img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/NoCertificateDebg3.png?raw=true" alt="3"></li>
<li>XcodeæŠ¥é”™å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç›´æ¥ç‚¹å‡»Fix Issueã€‚<br> <img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/NoCertificateDebg4.png?raw=true" alt="4"></li>
<li>è­¦å‘Šä¹Ÿæ²¡äº†ï¼Œè¯ä¹¦ä¹Ÿç”Ÿæˆäº†ï¼Œé‡æ–°ç‚¹å‡»runæŒ‰é’®ï¼Œå¯ä»¥å¼€å§‹æ„‰å¿«çš„ç©è€äº†ğŸ˜ã€‚<br> <img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/NoCertificateDebg5.png?raw=true" alt="5"></li>
</ol>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[tableviewè‡ªé€‚åº”é«˜åº¦]]></title>
      <url>http://zhang759740844.github.io/2016/08/26/UITableview%E8%87%AA%E9%80%82%E5%BA%94%E9%AB%98%E5%BA%A6/</url>
      <content type="html"><![CDATA[<p>ç”±äºtableviewçš„cellçš„é«˜åº¦ä¼šéšç€å†…éƒ¨labelä»¥åŠtextviewå­—ç¬¦é•¿åº¦çš„å˜åŒ–è€Œå˜åŒ–ï¼Œå› æ­¤ä¸èƒ½ä¸€å‘³çš„è®¾ç½®heightForRowAtIndexPathä¸ºå®šå€¼ã€‚</p>
<a id="more"></a>
<h2 id="è®¾ç½®å¸ƒå±€çº¦æŸ"><a href="#è®¾ç½®å¸ƒå±€çº¦æŸ" class="headerlink" title="è®¾ç½®å¸ƒå±€çº¦æŸ"></a>è®¾ç½®å¸ƒå±€çº¦æŸ</h2><p>åœ¨UITableViewCellå­ç±»ä¸­ï¼Œæ·»åŠ çº¦æŸï¼Œä½¿å­è§†å›¾çš„è¾¹ç¼˜ä¸contentViewçš„è¾¹ç¼˜å›ºå®šã€‚ç¡®ä¿æ¯ä¸ªå­è§†å›¾åœ¨å‚ç›´æ–¹å‘ä¸Šçš„å†…å®¹å‹ç¼©é˜»åŠ›(compression resistance)å’Œå†…å®¹å¸é™„æ€§çº¦æŸ(content hugging constraints)æ²¡æœ‰è¢«ä½ æ·»åŠ çš„æ›´é«˜ä¼˜å…ˆçº§çš„çº¦æŸè¦†ç›–ï¼Œä»¥ä½¿å¾—è¿™äº›å­è§†å›¾çš„å›ºæœ‰å†…å®¹å°ºå¯¸(intrinsic content size)æ¥æ¨åŠ¨contentViewçš„é«˜åº¦ã€‚</p>
<p>è®°ä½ï¼Œé‡ç‚¹æ˜¯cellçš„å­è§†å›¾ä¸contentViewè¦æœ‰å‚ç›´æ–¹å‘ä¸Šçš„è¿ç»“ï¼Œè®©å®ƒä»¬èƒ½å¤Ÿå¯¹contentViewâ€œæ–½åŠ å‹åŠ›â€ï¼Œä½¿contentViewæ‰©å¼ ä»¥é€‚åˆå®ƒä»¬çš„å°ºå¯¸ã€‚</p>
<p>ä¸‹é¢ç”¨ä¸€ä¸ªå¸¦æœ‰ä¸€äº›å­è§†å›¾çš„cellä½œä¸ºç¤ºä¾‹ï¼Œå±•ç¤ºäº†ä¸€äº›å¿…è¦çš„çº¦æŸï¼ˆæ²¡æœ‰å±•ç¤ºå…¨éƒ¨çš„çº¦æŸï¼‰ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/tableviewautolayout1.png?raw=true" alt="å¸ƒå±€ç¤ºä¾‹"></p>
<p>å¯ä»¥æƒ³è±¡ï¼Œå½“æ›´å¤šçš„æ–‡æœ¬è¢«æ·»åŠ åˆ°â€œMulti-line bodyâ€é‚£ä¸ªlabelä¸Šé¢åï¼Œå®ƒå°±éœ€è¦å‚ç›´åœ°å¢é«˜ä»¥é€‚åº”æ–‡æœ¬ï¼Œè¿™å®é™…ä¸Šå°†å¼ºè¿«cellå¢åŠ é«˜åº¦ã€‚</p>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></p>
<ol>
<li>å¦‚æœæ²¡æœ‰è®¾ç½®å¥½çº¦æŸï¼Œæ¯”å¦‚:ç¼ºå¤±äº†â€œMulti-line bodyâ€é‚£ä¸ªlabelåˆ°åº•éƒ¨çš„çº¦æŸï¼Œé‚£ä¹ˆé«˜åº¦ææœ‰å¯èƒ½å˜æˆ0ï¼›</li>
<li>labelè¦æ˜¾ç¤ºå¤šè¡Œï¼Œéœ€è¦å°†å…¶<code>Lines</code>è®¾ç½®ä¸º0ã€‚</li>
<li>é¢˜å¤–è¯ï¼Œå¦‚æœä¸æ˜¯åœ¨cellé‡Œçš„labelè¦è®¾ç½®é«˜åº¦åŒ…å«æ–‡å­—çš„è¯ï¼Œå¯ä»¥å°‘è®¾ç½®ä¸€ä¸ªçº¦æŸï¼Œè¿™æ ·å¸ƒå±€çš„æ—¶å€™ä¼šè‡ªåŠ¨æ’‘æ»¡æ•´ä¸ªlabelã€‚</li>
</ol>
<h2 id="cellçš„è‡ªé€‚åº”"><a href="#cellçš„è‡ªé€‚åº”" class="headerlink" title="cellçš„è‡ªé€‚åº”"></a>cellçš„è‡ªé€‚åº”</h2><h3 id="labelçš„ios8å®ç°"><a href="#labelçš„ios8å®ç°" class="headerlink" title="labelçš„ios8å®ç°"></a>labelçš„ios8å®ç°</h3><p>åœ¨iOS8ä¸Šï¼Œè‹¹æœå°†è®¸å¤šåœ¨ä¹‹å‰ä½ æ¯”è¾ƒéš¾å®ç°çš„ä¸œè¥¿éƒ½å†…ç½®å®ç°äº†ã€‚ä¸ºäº†è®©cellå®ç°è‡ªé€‚åº”ï¼ˆself-sizingï¼‰ï¼Œå¿…é¡»å…ˆå°†tableViewçš„<code>rowHeight</code>å±æ€§è®¾ç½®ä¸ºå¸¸é‡<code>UITableViewAutomaticDimension</code>ã€‚ç„¶åï¼Œåªéœ€å°†tableViewçš„<code>estimatedRowHeight</code>å±æ€§è®¾ç½®ä¸ºä¸€ä¸ªéé›¶å€¼å³å¯å¼€å¯è¡Œé«˜ä¼°ç®—åŠŸèƒ½,å¦‚ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">self</span>.tableView.rowHeight = <span class="built_in">UITableViewAutomaticDimension</span>;</div><div class="line"><span class="keyword">self</span>.tableView.estimatedRowHeight = <span class="number">44.0</span>; <span class="comment">// è®¾ç½®ä¸ºä¸€ä¸ªæ¥è¿‘äºè¡Œé«˜â€œå¹³å‡å€¼â€çš„æ•°å€¼</span></div></pre></td></tr></table></figure></p>
<p>è¿™æ ·å°±ä¸ºtableViewæä¾›äº†ä¸€ä¸ªè¿˜æ²¡æœ‰è¢«æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„cellçš„ä¸´æ—¶ä¼°ç®—çš„è¡Œé«˜ã€‚å½“cellå³å°†æ»šå…¥å±å¹•èŒƒå›´å†…çš„æ—¶å€™ï¼Œä¼šè®¡ç®—å‡ºçœŸå®çš„é«˜åº¦ã€‚ä¸ºäº†ç¡®å®šæ¯ä¸€è¡Œçš„å®é™…é«˜åº¦ï¼ŒtableViewä¼šè‡ªåŠ¨è®©æ¯ä¸ªcellåŸºäºå…¶contentViewçš„å·²çŸ¥å›ºå®šå®½åº¦ï¼ˆtableViewçš„å®½åº¦å‡å»å…¶ä»–é¢å¤–çš„ï¼Œåƒsection indexæˆ–accessoryViewè¿™äº›å®½åº¦ï¼‰å’Œè¢«æ·»åŠ åˆ°contentViewåŠå…¶å­è§†å›¾ä¸Šçš„å¸ƒå±€çº¦æŸæ¥è®¡ç®—<code>contentView</code>çš„é«˜åº¦ã€‚çœŸå®çš„è¡Œé«˜è¢«è®¡ç®—å‡ºæ¥ä¹‹åï¼Œæ—§çš„ä¼°ç®—çš„è¡Œé«˜ä¼šè¢«æ›´æ–°ä¸ºè¿™ä¸ªçœŸå®çš„è¡Œé«˜ï¼ˆå¹¶ä¸”å…¶ä»–ä»»ä½•éœ€è¦å¯¹tableViewçš„contentSizeæˆ–contentOffsetçš„æ›´æ”¹éƒ½è‡ªåŠ¨æ›¿ä½ å®Œæˆï¼‰ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œè¡Œé«˜çš„ä¼°ç®—å€¼ä¸éœ€è¦å¤ªç²¾ç¡®â€”â€”å®ƒåªæ˜¯ç”¨æ¥ä¿®æ­£tableViewä¸­æ»šåŠ¨æ¡çš„å°ºå¯¸çš„ï¼Œå½“ä½ åœ¨å±å¹•ä¸Šæ»‘åŠ¨cellçš„æ—¶å€™ï¼Œå³ä½¿ä¼°ç®—å€¼ä¸å‡†ç¡®ï¼ŒtableViewè¿˜æ˜¯èƒ½å¾ˆå¥½åœ°è°ƒèŠ‚æ»šåŠ¨æ¡ã€‚å°†tableViewçš„<code>estimatedRowHeight</code>å±æ€§è®¾ç½®æˆï¼ˆåœ¨<code>viewDidLoad</code>æˆ–ç±»ä¼¼çš„æ–¹æ³•ä¸­ï¼‰ä¸€ä¸ªæ¥è¿‘äºè¡Œé«˜â€œå¹³å‡å€¼â€çš„å¸¸é‡å€¼å³å¯ã€‚ä»…åœ¨è¡Œé«˜æç«¯å˜åŒ–çš„æ—¶å€™ï¼ˆæ¯”å¦‚ç›¸å·®ä¸€ä¸ªæ•°é‡çº§ï¼‰ï¼Œæ»šåŠ¨è¿‡ç¨‹ä¸­æ‰ä¼šäº§ç”Ÿæ»šåŠ¨æ¡çš„â€œè·³è·ƒâ€ç°è±¡ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä½ æ‰éœ€è¦è€ƒè™‘å®ç°<code>tableView:estimatedHeightForRowAtIndexPath:</code>æ–¹æ³•ï¼Œä¸ºæ¯ä¸€è¡Œè¿”å›ä¸€ä¸ªæ›´ç²¾ç¡®çš„ä¼°ç®—å€¼ã€‚</p>
<h3 id="labelçš„ios7å®ç°"><a href="#labelçš„ios7å®ç°" class="headerlink" title="labelçš„ios7å®ç°"></a>labelçš„ios7å®ç°</h3><p>é¦–å…ˆï¼Œå®ä¾‹åŒ–ä¸€ä¸ªç¦»å±(offscreen)çš„cellå®ä¾‹ï¼Œä¸ºæ¯ä¸ªé‡ç”¨æ ‡ç¤ºç¬¦å®ä¾‹åŒ–ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„cellå®ä¾‹ï¼Œè¿™äº›cellå®ä¾‹ä¸¥æ ¼çš„ä»…ç”¨äºé«˜åº¦è®¡ç®—ã€‚ï¼ˆç¦»å±è¡¨ç¤ºcellçš„å¼•ç”¨è¢«å­˜å‚¨åœ¨view controllerçš„ä¸€ä¸ªå±æ€§æˆ–å®ä¾‹å˜é‡ä¹‹ä¸­ï¼Œå¹¶ä¸”è¿™ä¸ªcellç»å¯¹ä¸ä¼šè¢«ç”¨ä½œ<code>tableView:cellForRowAtIndexPath:</code>æ–¹æ³•çš„è¿”å›å€¼æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚ï¼‰æ¥ä¸‹æ¥ï¼Œè¿™ä¸ªcellçš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæ–‡æœ¬ã€å›¾ç‰‡ç­‰ç­‰ï¼‰è¿˜å¿…é¡»è¢«é…ç½®ä¸ºä¸æ˜¾ç¤ºåœ¨table viewä¸­çš„å†…å®¹å®Œå…¨ä¸€æ ·ã€‚<br><strong>å› ä¸ºè¦åœ¨<code>heightForRowAtIndexPath</code>ä¸­è®¡ç®—é«˜åº¦ï¼Œéœ€è¦ä¸€ä¸ªcellå®ä¾‹ï¼Œè¿™ä¸ªç¦»å±cellå°±æ˜¯ä¸ºäº†è¿™ä¸ªç”¨çš„ã€‚</strong></p>
<p>ç„¶åï¼Œå¼ºåˆ¶cellç«‹å³æ›´æ–°å­è§†å›¾çš„å¸ƒå±€ï¼Œå†åœ¨cellçš„<code>contentView</code>ä¸Šè°ƒç”¨<code>systemLayoutSizeFittingSize:</code>æ–¹æ³•ä»¥è®¡ç®—å‡ºcellæ‰€éœ€çš„é«˜åº¦ã€‚ä½¿ç”¨<code>UILayoutFittingCompressedSize</code>å‚æ•°å¾—åˆ°é€‚åˆcellä¸­æ‰€æœ‰å†…å®¹æ‰€éœ€çš„æœ€å°å°ºå¯¸ã€‚ç„¶åå°†å…¶é«˜åº¦ä½œä¸º<code>tableView:heightForRowAtIndexPath:</code>æ–¹æ³•çš„è¿”å›å€¼è¿”å›ç»™table viewã€‚</p>
<p>é€šè¿‡<code>systemLayoutSizeFittingSize:</code>æ–¹æ³•è®¡ç®—å‡ºçš„é«˜åº¦è¿˜éœ€è¦åŠ 1æ‰æ˜¯çœŸæ­£çš„é«˜åº¦ï¼Œè¿™ä¸ª1pté«˜åº¦æ˜¯cellåˆ†å‰²çº¿çš„é«˜åº¦ã€‚</p>
<p>iOS7ä¸­ï¼Œä½ å¯ä»¥ï¼ˆä¹Ÿç»å¯¹åº”å½“ï¼‰ä½¿ç”¨table viewçš„<code>estimatedRowHeight</code>å±æ€§ã€‚è¿™æ ·ä¼šä¸ºè¿˜ä¸åœ¨å±å¹•èŒƒå›´å†…çš„cellæä¾›ä¸€ä¸ªä¸´æ—¶ä¼°ç®—çš„è¡Œé«˜å€¼ã€‚ç„¶åï¼Œå½“è¿™äº›cellå³å°†è¦æ»šå…¥å±å¹•èŒƒå›´å†…çš„æ—¶å€™ï¼ŒçœŸå®çš„è¡Œé«˜å€¼ä¼šè¢«è®¡ç®—å‡ºæ¥ï¼ˆé€šè¿‡<code>tableView:heightForRowAtIndexPath:</code>æ–¹æ³•ï¼‰ï¼Œä¼°ç®—çš„è¡Œé«˜ä¼šè¢«æ›¿æ¢æ‰ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œè¡Œé«˜çš„ä¼°ç®—å€¼ä¸éœ€è¦å¤ªç²¾ç¡®â€”â€”å®ƒåªæ˜¯ç”¨æ¥ä¿®æ­£tableViewä¸­æ»šåŠ¨æ¡çš„å°ºå¯¸çš„ï¼Œå½“ä½ åœ¨å±å¹•ä¸Šæ»‘åŠ¨cellçš„æ—¶å€™ï¼Œå³ä½¿ä¼°ç®—å€¼ä¸å‡†ç¡®ï¼ŒtableViewè¿˜æ˜¯èƒ½å¾ˆå¥½åœ°è°ƒèŠ‚æ»šåŠ¨æ¡ã€‚å°†tableViewçš„<code>estimatedRowHeight</code>å±æ€§è®¾ç½®æˆï¼ˆåœ¨viewDidLoadæˆ–ç±»ä¼¼çš„æ–¹æ³•ä¸­ï¼‰ä¸€ä¸ªæ¥è¿‘äºè¡Œé«˜â€œå¹³å‡å€¼â€çš„å¸¸é‡å€¼å³å¯ã€‚ä»…åœ¨è¡Œé«˜æç«¯å˜åŒ–çš„æ—¶å€™ï¼ˆæ¯”å¦‚ç›¸å·®ä¸€ä¸ªæ•°é‡çº§ï¼‰ï¼Œæ»šåŠ¨è¿‡ç¨‹ä¸­æ‰ä¼šäº§ç”Ÿæ»šåŠ¨æ¡çš„â€œè·³è·ƒâ€ç°è±¡ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä½ æ‰éœ€è¦è€ƒè™‘å®ç°<code>tableView:estimatedHeightForRowAtIndexPath:</code>æ–¹æ³•ï¼Œä¸ºæ¯ä¸€è¡Œè¿”å›ä¸€ä¸ªæ›´ç²¾ç¡®çš„ä¼°ç®—å€¼ã€‚</p>
<p>è¿™æ ·å°±æ˜¯å°†ç¬¬ä¸€æ¬¡åŠ è½½æ—¶æ—¶é—´æ¶ˆè€—é™ä½ï¼Œä½†æ˜¯åœ¨åŠ è½½æ¯ä¸ªviewçš„æ—¶å€™éƒ½è¦åŠ¨æ€è®¡ç®—æ¯ä¸€ä¸ªcellçš„é«˜åº¦ï¼Œå³æ»‘åŠ¨æ—¶æ¯”è¾ƒè€—æ—¶ï¼Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªç¼“å­˜å°†é«˜åº¦å­˜å–ï¼ŒåŒæ—¶è¿™ä¸ªç¼“å­˜è¦èƒ½åº”å¯¹cellé«˜åº¦çš„å˜åŒ–è¿›è¡Œä¿®æ”¹ã€‚</p>
<p>ç¤ºä¾‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    _cell.label.text = [_data objectAtIndex:indexPath.row];</div><div class="line">    <span class="built_in">CGSize</span> textHeight = [_cell.contentView systemLayoutSizeFittingSize:<span class="built_in">UILayoutFittingCompressedSize</span>];</div><div class="line">    <span class="built_in">CGFloat</span> height = textHeight.height+<span class="number">1</span>&gt;<span class="number">90</span>?textHeight.height+<span class="number">1</span>:<span class="number">90</span>;</div><div class="line">    <span class="keyword">return</span> height;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="textViewçš„è‡ªé€‚åº”"><a href="#textViewçš„è‡ªé€‚åº”" class="headerlink" title="textViewçš„è‡ªé€‚åº”"></a>textViewçš„è‡ªé€‚åº”</h3><p>textViewzåœ¨tableviewä¸­ç”¨çš„ä¸å¤šï¼Œä½†æ˜¯å…¶è‡ªé€‚åº”é«˜åº¦æ–¹å¼å’Œlabelæœ‰æ‰€ä¸åŒã€‚å› ä¸ºè°ƒç”¨<code>systemLayoutSizeFittingSize</code>æ–¹æ³•è¿”å›çš„é«˜åº¦å¹¶ä¸åŒ…å«textviewçš„é«˜åº¦ï¼Œéœ€è¦è°ƒç”¨<code>sizeThatFits</code>æ–¹æ³•è·å¾—textviewçš„å®Œæ•´é«˜åº¦ï¼Œç„¶åå°†ä¸¤ä¸ªé«˜åº¦ç›¸åŠ æ‰èƒ½å¾—åˆ°cellçœŸæ­£çš„é«˜åº¦ã€‚</p>
<p>ç¤ºä¾‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    _cell.textView.text = [_data objectAtIndex:indexPath.row];</div><div class="line">    <span class="built_in">CGSize</span> textHeight = [_cell.contentView systemLayoutSizeFittingSize:<span class="built_in">UILayoutFittingCompressedSize</span>];</div><div class="line">    <span class="built_in">CGSize</span> textViewSize = [_cell.textView sizeThatFits:<span class="built_in">CGSizeMake</span>(_cell.textView.frame.size.width, FLT_MAX)];</div><div class="line">    <span class="built_in">CGFloat</span> h  = textHeight.height + textViewSize.height;</div><div class="line">    <span class="built_in">CGFloat</span> height = h+<span class="number">1</span>&gt;<span class="number">90</span>?h+<span class="number">1</span>:<span class="number">90</span>;</div><div class="line">    <span class="keyword">return</span> height;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="UITableView-FDTemplateLayoutCellä½¿ç”¨ç®€ä»‹"><a href="#UITableView-FDTemplateLayoutCellä½¿ç”¨ç®€ä»‹" class="headerlink" title="UITableView+FDTemplateLayoutCellä½¿ç”¨ç®€ä»‹"></a>UITableView+FDTemplateLayoutCellä½¿ç”¨ç®€ä»‹</h2><p>è¿™æ˜¯ä¸€ä¸ªç”±å›½äººå›¢é˜Ÿå¼€å‘çš„ä¼˜åŒ–è®¡ç®— UITableViewCell é«˜åº¦çš„è½»é‡çº§æ¡†æ¶ã€‚ä¸»è¦ä¹Ÿæ˜¯é€šè¿‡<code>systemLayoutSizeFittingSize</code>æ–¹æ³•è®¡ç®—é«˜åº¦ï¼Œä½†æ˜¯è¯¥æ¡†æ¶é€šè¿‡<strong>ç¼“å­˜</strong>åŠ<strong>é¢„åŠ è½½</strong>å°†æ•ˆç‡å¤§å¹…çš„åœ°æé«˜ã€‚</p>
<p>è¿™é‡Œå°±ä¸å…·ä½“åˆ†æè¯¥æ¡†æ¶çš„å®ç°åŸç†äº†ã€‚å¯ä»¥å‚è€ƒ<a href="http://blog.qiji.tech/archives/9538?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">æ¡†æ¶å­¦ä¹ </a>è·Ÿè¿›ã€‚</p>
<p>è¿™é‡Œä¸»è¦åˆ—ä¸¾ä¸‹ä½¿ç”¨æ–¹æ³•,å…¶å®åœ¨<a href="https://github.com/forkingdog/UITableView-FDTemplateLayoutCell" target="_blank" rel="external">forkingdogçš„github</a>ä¸Šéƒ½æœ‰ï¼Œæˆ‘è¿™é‡Œåªæ˜¯æ‘˜å½•ä¸‹ã€‚</p>
<h3 id="åŸºæœ¬ä½¿ç”¨-ä¸å¸¦cache"><a href="#åŸºæœ¬ä½¿ç”¨-ä¸å¸¦cache" class="headerlink" title="åŸºæœ¬ä½¿ç”¨(ä¸å¸¦cache)"></a>åŸºæœ¬ä½¿ç”¨(ä¸å¸¦cache)</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"UITableView+FDTemplateLayoutCell.h"</span></span></div><div class="line"></div><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> [tableView fd_heightForCellWithIdentifier:<span class="string">@"reuse identifer"</span> configuration:^(<span class="keyword">id</span> cell) &#123;</div><div class="line">        <span class="comment">// Configure this cell with data, same as what you've done in "-tableView:cellForRowAtIndexPath:"</span></div><div class="line">        <span class="comment">// Like:</span></div><div class="line">        <span class="comment">//    cell.entity = self.feedEntities[indexPath.row];</span></div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨çš„æ—¶å€™éœ€è¦å°†ä¸€ä¸ªå®ä¾‹åŒ–åçš„cellä½œä¸ºblockä¼ å…¥ã€‚å¦‚ä¹‹å‰è®²åˆ°çš„ï¼Œ<code>systemLayoutSizeFittingSize:</code>æ‰€å¿…é¡»çš„ã€‚</p>
<h3 id="å¸¦cacheçš„æ–¹æ³•"><a href="#å¸¦cacheçš„æ–¹æ³•" class="headerlink" title="å¸¦cacheçš„æ–¹æ³•"></a>å¸¦cacheçš„æ–¹æ³•</h3><h4 id="ä»¥indexPathåŒºåˆ†"><a href="#ä»¥indexPathåŒºåˆ†" class="headerlink" title="ä»¥indexPathåŒºåˆ†"></a>ä»¥indexPathåŒºåˆ†</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    <span class="keyword">return</span> [tableView fd_heightForCellWithIdentifier:<span class="string">@"identifer"</span> cacheByIndexPath:indexPath configuration:^(<span class="keyword">id</span> cell) &#123;</div><div class="line">        <span class="comment">// configurations</span></div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¼“å­˜ä¸‹æ¯ä¸ªindexPathå¯¹åº”çš„é«˜åº¦ã€‚</p>
<h4 id="ä»¥keyåŒºåˆ†"><a href="#ä»¥keyåŒºåˆ†" class="headerlink" title="ä»¥keyåŒºåˆ†"></a>ä»¥keyåŒºåˆ†</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    Entity *entity = <span class="keyword">self</span>.entities[indexPath.row];</div><div class="line">    <span class="keyword">return</span> [tableView fd_heightForCellWithIdentifier:<span class="string">@"identifer"</span> cacheByKey:entity.uid configuration:^(<span class="keyword">id</span> cell) &#123;</div><div class="line">        <span class="comment">// configurations</span></div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç”¨æˆ·å°†è¦å±•ç¤ºçš„cellåˆ†ç±»ï¼Œç„¶åå°†åˆ†ç±»çš„keyä¼ å…¥ã€‚</p>
<h3 id="Frame-layout-mode"><a href="#Frame-layout-mode" class="headerlink" title="Frame layout mode"></a>Frame layout mode</h3><p>å¯¹äº<code>Auto layout mode</code>å’Œ<code>Frame layout mode</code>ã€‚æ¡†æ¶æä¾›äº†ä¸¤ç§æ–¹å¼ï¼Œé»˜è®¤æ˜¯è‡ªåŠ¨å¸ƒå±€ã€‚ </p>
<h3 id="å†æ¬¡æ³¨æ„"><a href="#å†æ¬¡æ³¨æ„" class="headerlink" title="å†æ¬¡æ³¨æ„"></a>å†æ¬¡æ³¨æ„</h3><p>éœ€è¦å†æ¬¡æé†’çš„æ˜¯ï¼Œå¦‚ä¸Šæ–‡æ‰€è¯´ï¼Œä¸€ä¸ªå¥½çš„è‡ªé€‚åº”cellï¼Œä¸€å®šè¦å°†cellå†…subviewçš„ä¸Šä¸‹å·¦å³çº¦æŸè®¾ç½®å¥½ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[runtimeåº”ç”¨ç¬”è®°]]></title>
      <url>http://zhang759740844.github.io/2016/08/23/runtime%E5%BA%94%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>äº†è§£äº†runtimeçš„åŸºæœ¬åŸç†ï¼Œé‚£ä¹ˆruntimeç©¶ç«Ÿæœ‰ä»€ä¹ˆç”¨å¤„å‘¢ï¼Ÿå‚è€ƒ<a href="http://www.jianshu.com/p/efeb33712445" target="_blank" rel="external">Runtimeå…¨æ–¹ä½è£…é€¼æŒ‡å—</a>ï¼Œæ€»ç»“äº†ä»¥ä¸‹å‡ ç‚¹åº”ç”¨åœºæ™¯ã€‚</p>
<a id="more"></a>
<h2 id="ç»™categoryæ·»åŠ å±æ€§"><a href="#ç»™categoryæ·»åŠ å±æ€§" class="headerlink" title="ç»™categoryæ·»åŠ å±æ€§"></a>ç»™categoryæ·»åŠ å±æ€§</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p><strong>å¯¹è±¡å…³è”</strong>å…è®¸å¼€å‘è€…å¯¹å·²ç»å­˜åœ¨çš„ç±»åœ¨ Category ä¸­æ·»åŠ è‡ªå®šä¹‰çš„å±æ€§ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">OBJC_EXPORT <span class="keyword">void</span> objc_setAssociatedObject(<span class="keyword">id</span> object, <span class="keyword">const</span> <span class="keyword">void</span> *key, <span class="keyword">id</span> value, objc_AssociationPolicy policy) __OSX_AVAILABLE_STARTING(__MAC_10_6, __IPHONE_3_1);</div></pre></td></tr></table></figure></p>
<ul>
<li>object æ˜¯æºå¯¹è±¡.</li>
<li>value æ˜¯è¢«å…³è”çš„å¯¹è±¡.</li>
<li>key æ˜¯å…³è”çš„é”®ï¼Œobjc_getAssociatedObject æ–¹æ³•é€šè¿‡ä¸åŒçš„ key å³å¯å–å‡ºå¯¹åº”çš„è¢«å…³è”å¯¹è±¡.</li>
<li>policy æ˜¯ä¸€ä¸ªæšä¸¾å€¼ï¼Œè¡¨ç¤ºå…³è”å¯¹è±¡çš„è¡Œä¸ºï¼Œä»å‘½åå°±èƒ½çœ‹å‡ºå„ä¸ªæšä¸¾å€¼çš„å«ä¹‰ï¼š<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> OBJC_ENUM(uintptr_t, objc_AssociationPolicy) &#123;</div><div class="line">    OBJC_ASSOCIATION_ASSIGN = <span class="number">0</span>,           <span class="comment">/**&lt; Specifies a weak reference to the associated object. */</span></div><div class="line">    OBJC_ASSOCIATION_RETAIN_NONATOMIC = <span class="number">1</span>, <span class="comment">/**&lt; Specifies a strong reference to the associated object. </span></div><div class="line">                                            *   The association is not made atomically. */</div><div class="line">    OBJC_ASSOCIATION_COPY_NONATOMIC = <span class="number">3</span>,   <span class="comment">/**&lt; Specifies that the associated object is copied. </span></div><div class="line">                                            *   The association is not made atomically. */</div><div class="line">    OBJC_ASSOCIATION_RETAIN = <span class="number">01401</span>,       <span class="comment">/**&lt; Specifies a strong reference to the associated object.</span></div><div class="line">                                            *   The association is made atomically. */</div><div class="line">    OBJC_ASSOCIATION_COPY = <span class="number">01403</span>          <span class="comment">/**&lt; Specifies that the associated object is copied.</span></div><div class="line">                                            *   The association is made atomically. */</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>è¦å–å‡ºè¢«å…³è”çš„å¯¹è±¡ä½¿ç”¨ objc_getAssociatedObject æ–¹æ³•å³å¯ï¼Œè¦åˆ é™¤ä¸€ä¸ªè¢«å…³è”çš„å¯¹è±¡ï¼Œä½¿ç”¨ objc_setAssociatedObject æ–¹æ³•å°†å¯¹åº”çš„ key è®¾ç½®æˆ nil å³å¯ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">objc_setAssociatedObject(<span class="keyword">self</span>, associatedKey, <span class="literal">nil</span>, OBJC_ASSOCIATION_COPY_NONATOMIC);</div></pre></td></tr></table></figure></p>
<p>objc_removeAssociatedObjects æ–¹æ³•å°†ä¼šç§»é™¤æºå¯¹è±¡ä¸­æ‰€æœ‰çš„å…³è”å¯¹è±¡.</p>
<h3 id="ç¤ºä¾‹ï¼š"><a href="#ç¤ºä¾‹ï¼š" class="headerlink" title="ç¤ºä¾‹ï¼š"></a>ç¤ºä¾‹ï¼š</h3><p>æ–°å»º UIButton çš„ Categoryï¼Œåœ¨å…¶ä¸­è®¾ç½®clickBlockå±æ€§(UIButton+ClickBlock.h):<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">void</span>(^clickBlock)(<span class="keyword">void</span>);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIButton</span> (<span class="title">ClickBlock</span>)</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) clickBlock click;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>åœ¨.mä¸­è®¾ç½®clickçš„setï¼Œgetæ–¹æ³•(UIButton+ClickBlock.m):<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"UIButton+ClickBlock.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">void</span> *associatedKey = <span class="string">"associatedKey"</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIButton</span> (<span class="title">ClickBlock</span>)</span></div><div class="line"></div><div class="line"><span class="comment">//Categoryä¸­çš„å±æ€§ï¼Œåªä¼šç”Ÿæˆsetterå’Œgetteræ–¹æ³•ï¼Œä¸ä¼šç”Ÿæˆæˆå‘˜å˜é‡</span></div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)setClick:(clickBlock)click&#123;</div><div class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, associatedKey, click, OBJC_ASSOCIATION_COPY_NONATOMIC);</div><div class="line">    [<span class="keyword">self</span> removeTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(buttonClick) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</div><div class="line">    <span class="keyword">if</span> (click) &#123;</div><div class="line">        [<span class="keyword">self</span> addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(buttonClick) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(clickBlock)click&#123;</div><div class="line">    <span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, associatedKey);</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)buttonClick&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.click) &#123;</div><div class="line">        <span class="keyword">self</span>.click();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼Œåœ¨setæ–¹æ³•ä¸­ä½¿ç”¨<code>addTarget:action:forControlEvents:</code>ç»™buttonè®¾ç½®äº†ç‚¹å‡»äº‹ä»¶ã€‚</p>
<p><code>self.click()</code>è¡¨ç¤ºä½¿ç”¨<code>self.click</code>è·å¾—blockï¼Œå†é€šè¿‡<code>block()</code>æ‰§è¡Œå—ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸ç›´æ¥ç»™clickèµ‹å€¼ï¼Œè€Œæ˜¯é€šè¿‡runtimeçš„<code>objc_setAssociatedObject</code>æ–¹æ³•å‘¢ï¼Ÿ<br>@propertyå±æ€§ä¼šåœ¨ç¼–è¯‘æ—¶è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå®ä¾‹å˜é‡_clickä»¥åŠå…¶setï¼Œgetæ–¹æ³•ã€‚ä½†æ˜¯ç”±äºruntimeåªèƒ½æ·»åŠ æ–¹æ³•ï¼Œä¸èƒ½æ·»åŠ å®ä¾‹å˜é‡ã€‚å› æ­¤ï¼Œ_clickå¹¶æ²¡æœ‰æ·»åŠ è¿›UIButtonçš„ivarä¸­ï¼Œå› è€Œä¸èƒ½ä½¿ç”¨ã€‚åªèƒ½é€šè¿‡runtimeçš„æ–¹æ³•ï¼Œæ·»åŠ å¯¹åº”é”®å€¼å¯¹ã€‚</p>
<p>@propertyåœ¨æœ¬ä¾‹ä¸­åªæ˜¯ä¸ºäº†åœ¨.hé‡Œå£°æ˜ä¸€ä¸ªgetsetæ–¹æ³•ã€‚å¯æ›¿æ¢æˆï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">void</span>(^clickBlock)(<span class="keyword">void</span>);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIButton</span> (<span class="title">ClickBlock</span>)</span></div><div class="line"><span class="comment">//@property (nonatomic,copy) clickBlock click;</span></div><div class="line">- (clickBlock)click;</div><div class="line">- (<span class="keyword">void</span>)setClick:(clickBlock)click;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<h2 id="å­—å…¸ä¸æ¨¡å‹è½¬æ¢"><a href="#å­—å…¸ä¸æ¨¡å‹è½¬æ¢" class="headerlink" title="å­—å…¸ä¸æ¨¡å‹è½¬æ¢"></a>å­—å…¸ä¸æ¨¡å‹è½¬æ¢</h2><h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>å­—å…¸è½¬æ¨¡å‹çš„æ—¶å€™ï¼š</p>
<ol>
<li>æ ¹æ®å­—å…¸çš„ key ç”Ÿæˆ setter æ–¹æ³•.</li>
<li>ä½¿ç”¨ objc_msgSend è°ƒç”¨ setter æ–¹æ³•ä¸º Model çš„å±æ€§èµ‹å€¼ï¼ˆæˆ–è€… KVCï¼‰.</li>
</ol>
<p>æ¨¡å‹è½¬å­—å…¸çš„æ—¶å€™ï¼š</p>
<ol>
<li>è°ƒç”¨ class_copyPropertyList æ–¹æ³•è·å–å½“å‰ Model çš„æ‰€æœ‰å±æ€§.</li>
<li>è°ƒç”¨ property_getName è·å–å±æ€§åç§°.</li>
<li>æ ¹æ®å±æ€§åç§°ç”Ÿæˆ getter æ–¹æ³•.</li>
<li>ä½¿ç”¨ objc_msgSend è°ƒç”¨ getter æ–¹æ³•è·å–å±æ€§å€¼ï¼ˆæˆ–è€… KVCï¼‰.</li>
</ol>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSObject</span> (<span class="title">KeyValues</span>)</span></div><div class="line"></div><div class="line">+(<span class="keyword">id</span>)objectWithKeyValues:(<span class="built_in">NSDictionary</span> *)aDictionary;</div><div class="line"></div><div class="line">-(<span class="built_in">NSDictionary</span> *)keyValuesWithObject;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"NSObject+KeyValues.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/message.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSObject</span> (<span class="title">KeyValues</span>)</span></div><div class="line"></div><div class="line"><span class="comment">//å­—å…¸è½¬æ¨¡å‹</span></div><div class="line">+(<span class="keyword">id</span>)objectWithKeyValues:(<span class="built_in">NSDictionary</span> *)aDictionary&#123;</div><div class="line">    <span class="keyword">id</span> objc = [[<span class="keyword">self</span> alloc] init];</div><div class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span> *key <span class="keyword">in</span> aDictionary.allKeys) &#123;</div><div class="line">        <span class="keyword">id</span> value = aDictionary[key];</div><div class="line">        </div><div class="line">        <span class="comment">/*åˆ¤æ–­å½“å‰å±æ€§æ˜¯ä¸æ˜¯Model*/</span></div><div class="line">        objc_property_t property = class_getProperty(<span class="keyword">self</span>, key.UTF8String);</div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> outCount = <span class="number">0</span>;</div><div class="line">        objc_property_attribute_t *attributeList = property_copyAttributeList(property, &amp;outCount);</div><div class="line">        objc_property_attribute_t attribute = attributeList[<span class="number">0</span>];</div><div class="line">        <span class="built_in">NSString</span> *typeString = [<span class="built_in">NSString</span> stringWithUTF8String:attribute.value];</div><div class="line">        <span class="keyword">if</span> ([typeString isEqualToString:<span class="string">@"@\"TestModel\""</span>]) &#123;</div><div class="line">            value = [<span class="keyword">self</span> objectWithKeyValues:value];</div><div class="line">        &#125;</div><div class="line">        <span class="comment">/**********************/</span></div><div class="line">        </div><div class="line">        <span class="comment">//ç”Ÿæˆsetteræ–¹æ³•ï¼Œå¹¶ç”¨objc_msgSendè°ƒç”¨</span></div><div class="line">        <span class="built_in">NSString</span> *methodName = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"set%@%@:"</span>,[key substringToIndex:<span class="number">1</span>].uppercaseString,[key substringFromIndex:<span class="number">1</span>]];</div><div class="line">        SEL <span class="keyword">setter</span> = sel_registerName(methodName.UTF8String);</div><div class="line">        <span class="keyword">if</span> ([objc respondsToSelector:<span class="keyword">setter</span>]) &#123;</div><div class="line">            ((<span class="keyword">void</span> (*) (<span class="keyword">id</span>,SEL,<span class="keyword">id</span>)) objc_msgSend) (objc,<span class="keyword">setter</span>,value);</div><div class="line">        &#125;</div><div class="line">        free(attributeList);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> objc;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//æ¨¡å‹è½¬å­—å…¸</span></div><div class="line">-(<span class="built_in">NSDictionary</span> *)keyValuesWithObject&#123;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> outCount = <span class="number">0</span>;</div><div class="line">    objc_property_t *propertyList = class_copyPropertyList([<span class="keyword">self</span> <span class="keyword">class</span>], &amp;outCount);</div><div class="line">    <span class="built_in">NSMutableDictionary</span> *dict = [<span class="built_in">NSMutableDictionary</span> dictionary];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; outCount; i ++) &#123;</div><div class="line">        objc_property_t property = propertyList[i];</div><div class="line">        </div><div class="line">        <span class="comment">//ç”Ÿæˆgetteræ–¹æ³•ï¼Œå¹¶ç”¨objc_msgSendè°ƒç”¨</span></div><div class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *propertyName = property_getName(property);</div><div class="line">        SEL <span class="keyword">getter</span> = sel_registerName(propertyName);</div><div class="line">        <span class="keyword">if</span> ([<span class="keyword">self</span> respondsToSelector:<span class="keyword">getter</span>]) &#123;</div><div class="line">            <span class="keyword">id</span> value = ((<span class="keyword">id</span> (*) (<span class="keyword">id</span>,SEL)) objc_msgSend) (<span class="keyword">self</span>,<span class="keyword">getter</span>);</div><div class="line">            </div><div class="line">            <span class="comment">/*åˆ¤æ–­å½“å‰å±æ€§æ˜¯ä¸æ˜¯Model*/</span></div><div class="line">            <span class="keyword">if</span> ([value isKindOfClass:[<span class="keyword">self</span> <span class="keyword">class</span>]] &amp;&amp; value) &#123;</div><div class="line">                value = [value keyValuesWithObject];</div><div class="line">            &#125;</div><div class="line">            <span class="comment">/**********************/</span></div><div class="line">            </div><div class="line">            <span class="keyword">if</span> (value) &#123;</div><div class="line">                <span class="built_in">NSString</span> *key = [<span class="built_in">NSString</span> stringWithUTF8String:propertyName];</div><div class="line">                [dict setObject:value forKey:key];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    free(propertyList);</div><div class="line">    <span class="keyword">return</span> dict;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">-(<span class="keyword">void</span>)keyValuesTest&#123;</div><div class="line">    </div><div class="line">    TestModel *model = [TestModel objectWithKeyValues:dictionary];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"name is %@"</span>,model.name);</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"son name is %@"</span>,model.son.name);</div><div class="line">    </div><div class="line">    <span class="built_in">NSDictionary</span> *dict = [model keyValuesWithObject];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"dict is %@"</span>,dict);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼š</p>
<ol>
<li>åœ¨NSObjectä¸­æ·»åŠ ç±»æ–¹æ³•ï¼Œå…¶ä¸­çš„<code>self</code>æŒ‡çš„æ˜¯<code>TestModel</code>è¿™ä¸ªç±»ã€‚</li>
<li><code>objc_property_t</code>å…·æœ‰ä¸¤ä¸ªå±æ€§ï¼Œnameå’Œattributeã€‚è°ƒç”¨<code>property_getAttribute</code>å°†è¿”å›attributeçš„å­—ç¬¦ä¸²ã€‚è°ƒç”¨<code>property_copyAttributeList</code>åˆ™å°†å­—ç¬¦ä¸²åˆ‡åˆ†ï¼Œè¿”å›ä¸€ä¸ª<code>objc_property_attribute_t</code>ç±»å‹çš„æŒ‡é’ˆï¼Œ<code>outCount</code>è¿”å›äº†å±æ€§çš„æ•°é‡ã€‚</li>
</ol>
<hr>
<p>outCountä½¿ç”¨äº†<strong>æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ</strong>çš„æ–¹å¼ï¼Œä½¿æ²¡æœ‰è¿”å›outCountçš„æƒ…å†µä¸‹ï¼Œä¿®æ”¹äº†outCountçš„å€¼ã€‚</p>
<p>ä¾‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSArray</span> *)scanBeginStr:(<span class="built_in">NSString</span> *)beginstr endStr:(<span class="built_in">NSString</span> *)endstr inText:(<span class="built_in">NSMutableString</span> * *)textPointer&#123;</div><div class="line">    <span class="built_in">NSRange</span> range1,range2;</div><div class="line">    <span class="built_in">NSUInteger</span> location =<span class="number">0</span>,length=<span class="number">0</span>;</div><div class="line">    range1.location = <span class="number">0</span>;</div><div class="line">    <span class="built_in">NSMutableString</span> *text = *textPointer;</div><div class="line">    <span class="built_in">NSMutableArray</span> *rangeArray = [<span class="built_in">NSMutableArray</span> array];</div><div class="line">    <span class="keyword">while</span> (range1.location != <span class="built_in">NSNotFound</span>) &#123;</div><div class="line">        range1 = [text rangeOfString:beginstr];</div><div class="line">        range2 = [text rangeOfString:endstr];</div><div class="line">        <span class="keyword">if</span> (range1.location != <span class="built_in">NSNotFound</span>) &#123;</div><div class="line">            location = range1.location;</div><div class="line">            length = range2.location - range1.location - <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span> (length &gt; <span class="number">5000</span>)<span class="keyword">break</span>;</div><div class="line">            [text replaceOccurrencesOfString:beginstr withString:<span class="string">@""</span> options:<span class="built_in">NSCaseInsensitiveSearch</span> range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, range1.location + range1.length)];</div><div class="line">            [text replaceOccurrencesOfString:endstr withString:<span class="string">@""</span> options:<span class="built_in">NSCaseInsensitiveSearch</span> range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, range2.location + range2.length - <span class="number">1</span>)];</div><div class="line">        &#125;</div><div class="line">        [rangeArray addObject:@&#123;<span class="string">@"location"</span>:@(location),<span class="string">@"length"</span>:@(length)&#125;];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> rangeArray;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨ï¼šé€šè¿‡&amp;å–æŒ‡é’ˆçš„åœ°å€<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NSArray *rangeArray = [self scanBegin3Str:@&quot;&lt;&quot; endStr:@&quot;&gt;&quot; inText:&amp;mutableText];</div></pre></td></tr></table></figure></p>
<hr>
<h2 id="è‡ªåŠ¨å½’æ¡£"><a href="#è‡ªåŠ¨å½’æ¡£" class="headerlink" title="è‡ªåŠ¨å½’æ¡£"></a>è‡ªåŠ¨å½’æ¡£</h2><h3 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>å½’æ¡£æ˜¯ä¸€ç§å¾ˆå¸¸ç”¨çš„æ–‡ä»¶å‚¨å­˜æ–¹æ³•ï¼Œå‡ ä¹ä»»ä½•ç±»å‹çš„å¯¹è±¡éƒ½èƒ½å¤Ÿè¢«å½’æ¡£å‚¨å­˜ã€‚è‡ªåŠ¨å½’æ¡£å°±æ˜¯åŠ¨æ€è·å–modelçš„å„ä¸ªå±æ€§ï¼Œè¿›è¡Œä¿å­˜ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)encodeWithCoder:(<span class="built_in">NSCoder</span> *)aCoder&#123;</div><div class="line">    [aCoder encodeObject:<span class="keyword">self</span>.name forKey:<span class="string">@"name"</span>];</div><div class="line">    [aCoder encodeObject:<span class="keyword">self</span>.ID forKey:<span class="string">@"ID"</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">id</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> init]) &#123;</div><div class="line">        <span class="keyword">self</span>.ID = [aDecoder decodeObjectForKey:<span class="string">@"ID"</span>];</div><div class="line">        <span class="keyword">self</span>.name = [aDecoder decodeObjectForKey:<span class="string">@"name"</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¦‚æœå½“å‰ Model æœ‰100ä¸ªå±æ€§çš„è¯ï¼Œå°±éœ€è¦å†™100è¡Œè¿™ç§ä»£ç .é€šè¿‡ Runtime æˆ‘ä»¬å°±å¯ä»¥è½»æ¾è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>ä½¿ç”¨ class_copyIvarList æ–¹æ³•è·å–å½“å‰ Model çš„æ‰€æœ‰æˆå‘˜å˜é‡.</li>
<li>ä½¿ç”¨ ivar_getName æ–¹æ³•è·å–æˆå‘˜å˜é‡çš„åç§°.</li>
<li>é€šè¿‡ KVC æ¥è¯»å– Model çš„å±æ€§å€¼ï¼ˆencodeWithCoder:ï¼‰ï¼Œä»¥åŠç»™ Model çš„å±æ€§èµ‹å€¼ï¼ˆinitWithCoder:ï¼‰.</li>
</ol>
<h3 id="ç¤ºä¾‹ï¼š-1"><a href="#ç¤ºä¾‹ï¼š-1" class="headerlink" title="ç¤ºä¾‹ï¼š"></a>ç¤ºä¾‹ï¼š</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"TestModel.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/message.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">TestModel</span></span></div><div class="line">- (<span class="keyword">void</span>)encodeWithCoder:(<span class="built_in">NSCoder</span> *)aCoder&#123;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> outCount = <span class="number">0</span>;</div><div class="line">    Ivar *vars = class_copyIvarList([<span class="keyword">self</span> <span class="keyword">class</span>], &amp;outCount);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; outCount; i ++) &#123;</div><div class="line">        Ivar var = vars[i];</div><div class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *name = ivar_getName(var);</div><div class="line">        <span class="built_in">NSString</span> *key = [<span class="built_in">NSString</span> stringWithUTF8String:name];</div><div class="line">        </div><div class="line">        <span class="comment">// æ³¨æ„kvcçš„ç‰¹æ€§æ˜¯ï¼Œå¦‚æœèƒ½æ‰¾åˆ°keyè¿™ä¸ªå±æ€§çš„setteræ–¹æ³•ï¼Œåˆ™è°ƒç”¨setteræ–¹æ³•</span></div><div class="line">        <span class="comment">// å¦‚æœæ‰¾ä¸åˆ°setteræ–¹æ³•ï¼Œåˆ™æŸ¥æ‰¾æˆå‘˜å˜é‡keyæˆ–è€…æˆå‘˜å˜é‡_keyï¼Œå¹¶ä¸”ä¸ºå…¶èµ‹å€¼</span></div><div class="line">        <span class="comment">// æ‰€ä»¥è¿™é‡Œä¸éœ€è¦å†å¦å¤–å¤„ç†æˆå‘˜å˜é‡åç§°çš„â€œ_â€å‰ç¼€</span></div><div class="line">        <span class="keyword">id</span> value = [<span class="keyword">self</span> valueForKey:key];</div><div class="line">        [aCoder encodeObject:value forKey:key];</div><div class="line">    &#125;</div><div class="line">    free(vars);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> init]) &#123;</div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> outCount = <span class="number">0</span>;</div><div class="line">        Ivar *vars = class_copyIvarList([<span class="keyword">self</span> <span class="keyword">class</span>], &amp;outCount);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; outCount; i ++) &#123;</div><div class="line">            Ivar var = vars[i];</div><div class="line">            <span class="keyword">const</span> <span class="keyword">char</span> *name = ivar_getName(var);</div><div class="line">            <span class="built_in">NSString</span> *key = [<span class="built_in">NSString</span> stringWithUTF8String:name];</div><div class="line">            <span class="keyword">id</span> value = [aDecoder decodeObjectForKey:key];</div><div class="line">            [<span class="keyword">self</span> setValue:value forKey:key];</div><div class="line">        &#125;</div><div class="line">        free(vars);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">-(<span class="keyword">void</span>)keyedArchiverTest&#123;</div><div class="line">    </div><div class="line">    TestModel *model = [TestModel objectWithKeyValues:dictionary];</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span> *path = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>).lastObject;</div><div class="line">    path = [path stringByAppendingPathComponent:<span class="string">@"test"</span>];</div><div class="line">    [<span class="built_in">NSKeyedArchiver</span> archiveRootObject:model toFile:path];</div><div class="line">    </div><div class="line">    TestModel *m = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithFile:path];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"m.name is %@"</span>,m.name);</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"m.son name is %@"</span>,m.son.name);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="åŠ¨æ€æ–¹æ³•è§£æä¸æ¶ˆæ¯è½¬å‘"><a href="#åŠ¨æ€æ–¹æ³•è§£æä¸æ¶ˆæ¯è½¬å‘" class="headerlink" title="åŠ¨æ€æ–¹æ³•è§£æä¸æ¶ˆæ¯è½¬å‘"></a>åŠ¨æ€æ–¹æ³•è§£æä¸æ¶ˆæ¯è½¬å‘</h2><h3 id="åŸç†-3"><a href="#åŸç†-3" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>æ¶ˆæ¯è½¬å‘çš„å¤§è‡´è¿‡ç¨‹å¦‚å›¾ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runtime_dynamicMethod.jpg?raw=true" alt="æ¶ˆæ¯è½¬å‘æµç¨‹"></p>
<ol>
<li>å½“ Runtime ç³»ç»Ÿåœ¨<code>Cache</code>å’Œæ–¹æ³•åˆ†å‘è¡¨ä¸­ï¼ˆåŒ…æ‹¬è¶…ç±»ï¼‰æ‰¾ä¸åˆ°è¦æ‰§è¡Œçš„æ–¹æ³•æ—¶ï¼ŒRuntimeä¼šè°ƒç”¨<code>resolveInstanceMethod:</code>æˆ–<code>resolveClassMethod:</code>(æ·»åŠ å®ä¾‹æ–¹æ³•å®ç°å’Œç±»æ–¹æ³•å®ç°)æ¥ç»™ç¨‹åºå‘˜ä¸€æ¬¡åŠ¨æ€æ·»åŠ æ–¹æ³•å®ç°çš„æœºä¼šï¼ŒæŒ‡å®šæ˜¯å¦åŠ¨æ€æ·»åŠ æ–¹æ³•ã€‚è‹¥è¿”å›<code>NO</code>ï¼Œåˆ™è¿›å…¥ä¸‹ä¸€æ­¥ï¼Œè‹¥è¿”å›<code>YES</code>ï¼Œåˆ™é€šè¿‡ <code>class_addMethod</code> å‡½æ•°åŠ¨æ€åœ°æ·»åŠ æ–¹æ³•ï¼Œæ¶ˆæ¯å¾—åˆ°å¤„ç†ï¼Œæ­¤æµç¨‹å®Œæ¯•.</li>
<li><code>resolveInstanceMethod:</code> æ–¹æ³•è¿”å› <code>NO</code> æ—¶ï¼Œå°±ä¼šè¿›å…¥ <code>forwardingTargetForSelector:</code> æ–¹æ³•ï¼Œè¿™æ˜¯ Runtime ç»™æˆ‘ä»¬çš„ç¬¬äºŒæ¬¡æœºä¼šï¼Œç”¨äºæŒ‡å®šå“ªä¸ªå¯¹è±¡å“åº”è¿™ä¸ª <code>selector</code>ã€‚è¿”å›<code>nil</code>ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥ï¼Œè¿”å›æŸä¸ªå¯¹è±¡ï¼Œåˆ™ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„æ–¹æ³•.</li>
<li>è‹¥ <code>forwardingTargetForSelector:</code> è¿”å›çš„æ˜¯<code>nil</code>ï¼Œåˆ™æˆ‘ä»¬é¦–å…ˆè¦é€šè¿‡ <code>methodSignatureForSelector:</code> æ¥æŒ‡å®šæ–¹æ³•ç­¾åï¼Œè¿”å›<code>nil</code>ï¼Œè¡¨ç¤ºä¸å¤„ç†ï¼Œè‹¥è¿”å›æ–¹æ³•ç­¾åï¼Œåˆ™ä¼šè¿›å…¥ä¸‹ä¸€æ­¥.</li>
<li>å½“ç¬¬ <code>methodSignatureForSelector:</code> æ–¹æ³•è¿”å›æ–¹æ³•ç­¾ååï¼Œå°±ä¼šè°ƒç”¨ <code>forwardInvocation:</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>anInvocation</code> å¯¹è±¡åšå¾ˆå¤šå¤„ç†ï¼Œæ¯”å¦‚ä¿®æ”¹å®ç°æ–¹æ³•ï¼Œä¿®æ”¹å“åº”å¯¹è±¡ç­‰.</li>
<li>å¦‚æœåˆ°æœ€åï¼Œæ¶ˆæ¯è¿˜æ˜¯æ²¡æœ‰å¾—åˆ°å“åº”ï¼Œç¨‹åºå°±ä¼šcrash.</li>
</ol>
<h3 id="ç¤ºä¾‹ï¼š-2"><a href="#ç¤ºä¾‹ï¼š-2" class="headerlink" title="ç¤ºä¾‹ï¼š"></a>ç¤ºä¾‹ï¼š</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"Monkey.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Bird.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Monkey</span></span></div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)jump&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"monkey can not fly, but! monkey can jump"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">+(<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/*</span></div><div class="line">     å¦‚æœå½“å‰å¯¹è±¡è°ƒç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•</div><div class="line">     Runtimeä¼šè°ƒç”¨resolveInstanceMethod:æ¥è¿›è¡ŒåŠ¨æ€æ–¹æ³•è§£æ</div><div class="line">     æˆ‘ä»¬éœ€è¦ç”¨class_addMethodå‡½æ•°å®Œæˆå‘ç‰¹å®šç±»æ·»åŠ ç‰¹å®šæ–¹æ³•å®ç°çš„æ“ä½œ</div><div class="line">     è¿”å›NOï¼Œåˆ™è¿›å…¥ä¸‹ä¸€æ­¥forwardingTargetForSelector:</div><div class="line">     */</div><div class="line">    </div><div class="line">	<span class="keyword">if</span>(sel == <span class="keyword">@selector</span>(fly))&#123;</div><div class="line">    	class_addMethod(<span class="keyword">self</span>, sel, class_getMethodImplementation(<span class="keyword">self</span>, sel_registerName(<span class="string">"jump"</span>)), <span class="string">"v@:"</span>);</div><div class="line">    	<span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveInstanceMethod:sel];</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)aSelector&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/*</span></div><div class="line">     åœ¨æ¶ˆæ¯è½¬å‘æœºåˆ¶æ‰§è¡Œå‰ï¼ŒRuntime ç³»ç»Ÿä¼šå†ç»™æˆ‘ä»¬ä¸€æ¬¡é‡å®šå‘çš„æœºä¼š</div><div class="line">     é€šè¿‡é‡è½½forwardingTargetForSelector:æ–¹æ³•æ¥æ›¿æ¢æ¶ˆæ¯çš„æ¥å—è€…ä¸ºå…¶ä»–å¯¹è±¡</div><div class="line">     è¿”å›nilåˆ™è¿›æ­¥ä¸‹ä¸€æ­¥forwardInvocation:</div><div class="line">     */</div><div class="line">    </div><div class="line"><span class="meta">#if 0</span></div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line"><span class="meta">#else</span></div><div class="line">    <span class="keyword">return</span> [[Bird alloc] init];</div><div class="line"><span class="meta">#endif</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="built_in">NSMethodSignature</span> *)methodSignatureForSelector:(SEL)aSelector&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/*</span></div><div class="line">     è·å–æ–¹æ³•ç­¾åè¿›å…¥ä¸‹ä¸€æ­¥ï¼Œè¿›è¡Œæ¶ˆæ¯è½¬å‘</div><div class="line">     */</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> [<span class="built_in">NSMethodSignature</span> signatureWithObjCTypes:<span class="string">"v@:"</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)forwardInvocation:(<span class="built_in">NSInvocation</span> *)anInvocation&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/*</span></div><div class="line">     æ¶ˆæ¯è½¬å‘</div><div class="line">     */</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> [anInvocation invokeWithTarget:[[Bird alloc] init]];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>å…¶ä¸­ <code>&quot;v@:&quot;</code> è¡¨ç¤ºè¿”å›å€¼å’Œå‚æ•°,è¿™ä¸ªç¬¦å·æ¶‰åŠ<a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtPropertyIntrospection.html" target="_blank" rel="external">Type Encoding</a>ä»¥åŠ<a href="http://www.jianshu.com/p/f4129b5194c0" target="_blank" rel="external">å…³äºtype encodingsçš„ç†è§£â€“runtime programming guide</a>ã€‚</p>
<hr>
<p>å…¶ä¸­<strong>v</strong>è¡¨ç¤ºè¿”å›<code>void</code>ç±»å‹ï¼Œ<strong>@</strong>è¡¨ç¤ºå‚æ•°<code>id(self)</code>ï¼Œ<strong>ï¼š</strong>è¡¨ç¤º<code>SEL(_cmd)</code>è¿™å‡ ä¸ªæ˜¯å¿…é¡»è¦æœ‰çš„ï¼Œåé¢å¯ä»¥æ¥å…¥å‚ç±»å‹ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š<code>&quot;i@:@&quot;</code><br><strong>i</strong>è¡¨ç¤ºè¿”å›å€¼ç±»å‹<code>int</code><br><strong>@ï¼š</strong>å’Œä¸Šé¢æ„ä¹‰ç›¸åŒ<br><strong>@</strong>æœ€åä¸€ä¸ª@è¡¨ç¤ºæœ‰ä¸€ä¸ªå…¥å‚ï¼Œæ˜¯<code>id</code>ç±»å‹ã€‚</p>
<p>ä¸è¿‡ï¼Œå®é™…ä¸Šï¼Œè¿™ä¸ªä¸œè¥¿å¥½åƒæ²¡ä»€ä¹ˆç”¨ï¼Œå› ä¸ºåœ¨<code>class_addMethod</code>ä¸Šè¯•éªŒè¿‡ï¼Œéšä¾¿ä¼ ä»»ä½•å­—ç¬¦ä¸²éƒ½ä¸€æ ·èƒ½æ­£å¸¸è¿è¡Œã€‚</p>
<hr>
<p>ä¸€èˆ¬æ¥è¯´å¯ä»¥ä½¿ç”¨<code>method_getTypeEncoding()</code>è·å–æ›´è¯¦ç»†çš„Type_Encoding,ä¸‹é¢ä¾‹å­ä¸­ä¹Ÿä¼šç”¨åˆ°ã€‚</p>
<h3 id="è½¬å‘ä¸å¤šç»§æ‰¿"><a href="#è½¬å‘ä¸å¤šç»§æ‰¿" class="headerlink" title="è½¬å‘ä¸å¤šç»§æ‰¿"></a>è½¬å‘ä¸å¤šç»§æ‰¿</h3><p>è½¬å‘å’Œç»§æ‰¿ç›¸ä¼¼ï¼Œå¯ä»¥ç”¨äºä¸ºObjcç¼–ç¨‹æ·»åŠ ä¸€äº›å¤šç»§æ‰¿çš„æ•ˆæœã€‚å°±åƒä¸‹å›¾é‚£æ ·ï¼Œä¸€ä¸ªå¯¹è±¡æŠŠæ¶ˆæ¯è½¬å‘å‡ºå»ï¼Œå°±å¥½ä¼¼å®ƒæŠŠå¦ä¸€ä¸ªå¯¹è±¡ä¸­çš„æ–¹æ³•å€Ÿè¿‡æ¥æˆ–æ˜¯â€œç»§æ‰¿â€è¿‡æ¥ä¸€æ ·ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runtime_transmit.png?raw=true" alt="runtime_transmit"></p>
<p>è¿™ä½¿å¾—ä¸åŒç»§æ‰¿ä½“ç³»åˆ†æ”¯ä¸‹çš„ä¸¤ä¸ªç±»å¯ä»¥â€œç»§æ‰¿â€å¯¹æ–¹çš„æ–¹æ³•ï¼Œåœ¨ä¸Šå›¾ä¸­<code>Warrior</code>å’Œ<code>Diplomat</code>æ²¡æœ‰ç»§æ‰¿å…³ç³»ï¼Œä½†æ˜¯<code>Warrior</code>å°†<code>negotiate</code>æ¶ˆæ¯è½¬å‘ç»™äº†<code>Diplomat</code>åï¼Œå°±å¥½ä¼¼<code>Diplomat</code>æ˜¯<code>Warrior</code>çš„è¶…ç±»ä¸€æ ·ã€‚</p>
<p>æ¶ˆæ¯è½¬å‘å¼¥è¡¥äº† Objc ä¸æ”¯æŒå¤šç»§æ‰¿çš„æ€§è´¨ï¼Œä¹Ÿé¿å…äº†å› ä¸ºå¤šç»§æ‰¿å¯¼è‡´å•ä¸ªç±»å˜å¾—è‡ƒè‚¿å¤æ‚ã€‚å®ƒå°†é—®é¢˜åˆ†è§£å¾—å¾ˆç»†ï¼Œåªé’ˆå¯¹æƒ³è¦å€Ÿé‰´çš„æ–¹æ³•æ‰è½¬å‘ï¼Œè€Œä¸”è½¬å‘æœºåˆ¶æ˜¯é€æ˜çš„ã€‚</p>
<h2 id="Runtime-åŠ¨æ€åˆ›å»ºç±»æ·»åŠ å±æ€§å’Œæ–¹æ³•"><a href="#Runtime-åŠ¨æ€åˆ›å»ºç±»æ·»åŠ å±æ€§å’Œæ–¹æ³•" class="headerlink" title="Runtime-åŠ¨æ€åˆ›å»ºç±»æ·»åŠ å±æ€§å’Œæ–¹æ³•"></a>Runtime-åŠ¨æ€åˆ›å»ºç±»æ·»åŠ å±æ€§å’Œæ–¹æ³•</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)createClass</div><div class="line">&#123;</div><div class="line">    Class MyClass = objc_allocateClassPair([<span class="built_in">NSObject</span> <span class="keyword">class</span>], <span class="string">"myclass"</span>, <span class="number">0</span>);</div><div class="line">    <span class="comment">//æ·»åŠ ä¸€ä¸ªNSStringçš„å˜é‡ï¼Œç¬¬å››ä¸ªå‚æ•°æ˜¯å¯¹å…¶æ–¹å¼ï¼Œç¬¬äº”ä¸ªå‚æ•°æ˜¯å‚æ•°ç±»å‹</span></div><div class="line">    <span class="keyword">if</span> (class_addIvar(MyClass, <span class="string">"itest"</span>, <span class="keyword">sizeof</span>(<span class="built_in">NSString</span> *), <span class="number">0</span>, <span class="string">"@"</span>)) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"add ivar success"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//myclasstestæ˜¯å·²ç»å®ç°çš„å‡½æ•°ï¼Œ"v@:"è¿™ç§å†™æ³•è§type encoding</span></div><div class="line">    class_addMethod(MyClass, <span class="keyword">@selector</span>(myclasstest:), (IMP)myclasstest, <span class="string">"v@:"</span>);</div><div class="line">    <span class="comment">//æ³¨å†Œè¿™ä¸ªç±»åˆ°runtimeç³»ç»Ÿä¸­å°±å¯ä»¥ä½¿ç”¨ä»–äº†</span></div><div class="line">    objc_registerClassPair(MyClass);</div><div class="line">    <span class="comment">//ç”Ÿæˆäº†ä¸€ä¸ªå®ä¾‹åŒ–å¯¹è±¡</span></div><div class="line">    <span class="keyword">id</span> myobj = [[MyClass alloc] init];</div><div class="line">    <span class="built_in">NSString</span> *str = <span class="string">@"asdb"</span>;</div><div class="line">    <span class="comment">//ç»™åˆšåˆšæ·»åŠ çš„å˜é‡èµ‹å€¼</span></div><div class="line">    <span class="comment">//    object_setInstanceVariable(myobj, "itest", (void *)&amp;str);åœ¨ARCä¸‹ä¸å…è®¸ä½¿ç”¨</span></div><div class="line">    [myobj setValue:str forKey:<span class="string">@"itest"</span>];</div><div class="line">    <span class="comment">//è°ƒç”¨myclasstestæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç»™myobjè¿™ä¸ªæ¥å—è€…å‘é€myclasstestè¿™ä¸ªæ¶ˆæ¯</span></div><div class="line">    [myobj myclasstest:<span class="number">10</span>];</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="comment">//è¿™ä¸ªæ–¹æ³•å®é™…ä¸Šæ²¡æœ‰è¢«è°ƒç”¨,ä½†æ˜¯å¿…é¡»å®ç°å¦åˆ™ç¼–è¯‘éƒ½ä¸èƒ½é€šè¿‡</span></div><div class="line">- (<span class="keyword">void</span>)myclasstest:(<span class="keyword">int</span>)a</div><div class="line">&#123;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"><span class="comment">//è°ƒç”¨çš„æ˜¯è¿™ä¸ªæ–¹æ³•</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">void</span> myclasstest(<span class="keyword">id</span> <span class="keyword">self</span>, SEL _cmd, <span class="keyword">int</span> a) <span class="comment">//selfå’Œ_cmdæ˜¯å¿…é¡»çš„ï¼Œåœ¨ä¹‹åå¯ä»¥éšæ„æ·»åŠ å…¶ä»–å‚æ•°</span></div><div class="line">&#123;</div><div class="line">    </div><div class="line">    Ivar v = class_getInstanceVariable([<span class="keyword">self</span> <span class="keyword">class</span>], <span class="string">"itest"</span>);</div><div class="line">    <span class="comment">//è¿”å›åä¸ºitestçš„ivarçš„å˜é‡çš„å€¼</span></div><div class="line">    <span class="keyword">id</span> o = object_getIvar(<span class="keyword">self</span>, v);</div><div class="line">    <span class="comment">//æˆåŠŸæ‰“å°å‡ºç»“æœ</span></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, o);</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"int a is %d"</span>, a);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Method-Swizzling"><a href="#Method-Swizzling" class="headerlink" title="Method Swizzling"></a>Method Swizzling</h2><p>æ­¤éƒ¨åˆ†å‚è€ƒè‡ª<a href="http://blog.csdn.net/horkychen/article/details/8532087" target="_blank" rel="external">Objective-Cçš„æ–¹æ³•æ›¿æ¢</a>ã€<a href="http://yulingtianxia.com/blog/2014/11/05/objective-c-runtime/" target="_blank" rel="external">Objective-C Runtime</a>ç­‰ç³»åˆ—æ–‡ç« </p>
<h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span> </span></div><div class="line"> </div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIViewController</span> (<span class="title">Tracking</span>) </span></div><div class="line"> </div><div class="line">+ (<span class="keyword">void</span>)load &#123; </div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken; </div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123; </div><div class="line">        Class aClass = [<span class="keyword">self</span> <span class="keyword">class</span>]; </div><div class="line"> </div><div class="line">        SEL originalSelector = <span class="keyword">@selector</span>(viewWillAppear:); </div><div class="line">        SEL swizzledSelector = <span class="keyword">@selector</span>(xxx_viewWillAppear:); </div><div class="line"> </div><div class="line">        Method originalMethod = class_getInstanceMethod(aClass, originalSelector); </div><div class="line">        Method swizzledMethod = class_getInstanceMethod(aClass, swizzledSelector); </div><div class="line">        </div><div class="line">        <span class="comment">// When swizzling a class method, use the following:</span></div><div class="line">        <span class="comment">// Class aClass = object_getClass((id)self);</span></div><div class="line">        <span class="comment">// ...</span></div><div class="line">        <span class="comment">// Method originalMethod = class_getClassMethod(aClass, originalSelector);</span></div><div class="line">        <span class="comment">// Method swizzledMethod = class_getClassMethod(aClass, swizzledSelector);</span></div><div class="line"> </div><div class="line">        <span class="built_in">BOOL</span> didAddMethod = </div><div class="line">            class_addMethod(aClass, </div><div class="line">                originalSelector, </div><div class="line">                method_getImplementation(swizzledMethod), </div><div class="line">                method_getTypeEncoding(swizzledMethod)); </div><div class="line"> </div><div class="line">        <span class="keyword">if</span> (didAddMethod) &#123; </div><div class="line">            class_replaceMethod(aClass, </div><div class="line">                swizzledSelector, </div><div class="line">                method_getImplementation(originalMethod), </div><div class="line">                method_getTypeEncoding(originalMethod)); </div><div class="line">        &#125; <span class="keyword">else</span> &#123; </div><div class="line">            method_exchangeImplementations(originalMethod, swizzledMethod); </div><div class="line">        &#125; </div><div class="line">    &#125;); </div><div class="line">&#125; </div><div class="line"> </div><div class="line"><span class="meta">#pragma mark - Method Swizzling </span></div><div class="line"> </div><div class="line">- (<span class="keyword">void</span>)xxx_viewWillAppear:(<span class="built_in">BOOL</span>)animated &#123; </div><div class="line">    [<span class="keyword">self</span> xxx_viewWillAppear:animated]; </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"viewWillAppear: %@"</span>, <span class="keyword">self</span>); </div><div class="line">&#125; </div><div class="line"> </div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h3 id="åŸç†-4"><a href="#åŸç†-4" class="headerlink" title="åŸç†"></a>åŸç†</h3><h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p>åœ¨Objective-Cä¸­è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œå…¶å®æ˜¯å‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯ï¼ŒæŸ¥æ‰¾æ¶ˆæ¯çš„å”¯ä¸€ä¾æ®æ˜¯selectorçš„åå­—ã€‚åˆ©ç”¨Objective-Cçš„åŠ¨æ€ç‰¹æ€§ï¼Œå¯ä»¥å®ç°åœ¨è¿è¡Œæ—¶å·æ¢selectorå¯¹åº”çš„æ–¹æ³•å®ç°ï¼Œè¾¾åˆ°ç»™æ–¹æ³•æŒ‚é’©çš„ç›®çš„ã€‚</p>
<p>æ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªæ–¹æ³•åˆ—è¡¨ï¼Œå­˜æ”¾ç€selectorçš„åå­—å’Œæ–¹æ³•å®ç°çš„æ˜ å°„å…³ç³»ã€‚IMPæœ‰ç‚¹ç±»ä¼¼å‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘å…·ä½“çš„Methodå®ç°ã€‚å¦‚ä¸‹å›¾<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runtime_swizzling_1.png?raw=true" alt="runtime_swizzling_1"></p>
<p>é€šè¿‡Swizzlingéœ€è¦å®ç°çš„æ˜¯å·æ¢selectorçš„IMPï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runtime_swizzling_2.png?raw=true" alt="runtime_swizzling_2"></p>
<h4 id="å®ç°è¿‡ç¨‹"><a href="#å®ç°è¿‡ç¨‹" class="headerlink" title="å®ç°è¿‡ç¨‹"></a>å®ç°è¿‡ç¨‹</h4><p>ä¸Šé¢çš„ä»£ç é€šè¿‡æ·»åŠ ä¸€ä¸ª<code>Tracking</code>ç±»åˆ«åˆ°<code>UIViewController</code>ç±»ä¸­ï¼Œå°†<code>UIViewController</code>ç±»çš„<code>viewWillAppear:</code>æ–¹æ³•å’Œ<code>Tracking</code>ç±»åˆ«ä¸­<code>xxx_viewWillAppear:</code>æ–¹æ³•çš„å®ç°ç›¸äº’è°ƒæ¢ã€‚Swizzling åº”è¯¥åœ¨<code>+load</code>æ–¹æ³•ä¸­å®ç°ï¼Œå› ä¸º<code>+load</code>æ˜¯åœ¨ä¸€ä¸ªç±»æœ€å¼€å§‹åŠ è½½æ—¶è°ƒç”¨ã€‚<code>dispatch_once</code>æ˜¯GCDä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒä¿è¯äº†ä»£ç å—åªæ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶è®©å…¶ä¸ºä¸€ä¸ªåŸå­æ“ä½œï¼Œçº¿ç¨‹å®‰å…¨æ˜¯å¾ˆé‡è¦çš„ã€‚</p>
<p>å®ç°Swizzlingéœ€è¦è€ƒè™‘ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯è¢«æ›¿æ¢æ–¹æ³•æ²¡æœ‰åœ¨å½“å‰ç±»ä¸­é‡å†™è¿‡ï¼Œè€Œæ˜¯åªåœ¨å…¶çˆ¶ç±»ä¸­å®ç°äº†;ç¬¬äºŒç§æƒ…å†µæ˜¯è¿™ä¸ªæ–¹æ³•å·²ç»å­˜åœ¨äºå½“å‰ç±»ä¸­ï¼Œå°±å¦‚æœ¬ä¾‹ä¸­æƒ³è¦æ›¿æ¢æ‰<code>UIViewController</code>ä¸­çš„<code>viewWillAppear:</code>æ–¹æ³•ã€‚è¿™ä¸¤ç§æƒ…å†µè¦åŒºåˆ«å¯¹å¾…ã€‚</p>
<p>å¯¹äºç¬¬ä¸€ç§æƒ…å†µï¼Œç”±äºå½“å‰ç±»å†…æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œåº”å½“ç°åœ¨å½“å‰ç±»ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„å®ç°æ–¹æ³•(<code>xxx_viewWillAppear:</code>)ï¼Œç„¶åå°†å¤å†™çš„æ–¹æ³•æ›¿æ¢ä¸ºåŸå…ˆçš„å®ç°(<code>viewWillAppear:</code>).</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">BOOL</span> didAddMethod = </div><div class="line">    class_addMethod(aClass, </div><div class="line">        originalSelector, </div><div class="line">        method_getImplementation(swizzledMethod), </div><div class="line">        method_getTypeEncoding(swizzledMethod));</div></pre></td></tr></table></figure>
<p><code>class_addMethod</code>å°†æœ¬æ¥ä¸å­˜åœ¨äºè¢«æ“ä½œçš„Classé‡Œçš„<code>swizzledMethod</code>çš„å®ç°æ·»åŠ åœ¨è¢«æ“ä½œçš„Classé‡Œ,å¹¶ä½¿ç”¨<code>originalSelector</code>ä½œä¸ºå…¶é€‰æ‹©å­ã€‚å¦‚æœå‘ç°æ–¹æ³•å·²ç»å­˜åœ¨ï¼Œä¼šå¤±è´¥è¿”å›ã€‚</p>
<hr>
<p>é€šè¿‡ä¸Šä¸€ç¯‡<a href="https://zhang759740844.github.io/2016/08/22/runtimeåŸç†/">runtimeåŸç†</a>çš„åˆ†æï¼Œ<code>class_addMethod</code>åº”è¯¥æ˜¯å…ˆåœ¨ç±»çš„methodæ•°ç»„é‡Œæ‰¾æ˜¯å¦æœ‰è¿™ä¸ª<code>SEL</code>,å¦‚æœæ²¡æœ‰å°±æ·»åŠ ä¸€ä¸ª<code>method_t</code>ã€‚</p>
<hr>
<p>å¦‚æœæ·»åŠ æˆåŠŸ(å½“å‰ç±»ä¸­æ²¡æœ‰é‡å†™è¿‡çˆ¶ç±»çš„è¯¥æ–¹æ³•)ï¼Œå†æŠŠç›®æ ‡ç±»ä¸­çš„æ–¹æ³•æ›¿æ¢ä¸ºæ—§æœ‰çš„å®ç°:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (didAddMethod) &#123; </div><div class="line">    class_replaceMethod(aClass, </div><div class="line">        swizzledSelector, </div><div class="line">        method_getImplementation(originalMethod), </div><div class="line">        method_getTypeEncoding(originalMethod));</div></pre></td></tr></table></figure></p>
<p><code>addMethod</code>ä¼šè®©å½“å‰ç±»çš„æ–¹æ³•(IMP)æŒ‡å‘æ–°çš„å®ç°(SEL)ï¼Œä½¿ç”¨<code>replaceMethod</code>å†å°†æ–°çš„æ–¹æ³•(IMP)æŒ‡å‘åŸå…ˆçš„å®ç°(SEL)ï¼Œè¿™æ ·å°±å®Œæˆäº†äº¤æ¢æ“ä½œã€‚ç°åœ¨é€šè¿‡æ—§æ–¹æ³•<code>SEL</code>æ¥è°ƒç”¨ï¼Œå°±ä¼šå®ç°æ–°æ–¹æ³•çš„<code>IMP</code>ï¼Œé€šè¿‡æ–°æ–¹æ³•çš„<code>SEL</code>æ¥è°ƒç”¨ï¼Œå°±ä¼šå®ç°æ—§æ–¹æ³•çš„<code>IMP</code>ã€‚</p>
<p>å¦‚æœæ·»åŠ å¤±è´¥äº†ï¼Œå°±æ˜¯ç¬¬äºŒæƒ…å†µ(æ–¹æ³•å·²ç»åœ¨å½“å‰ç±»ä¸­å®ç°è¿‡äº†)ã€‚è¿™æ—¶å¯ä»¥é€šè¿‡<code>method_exchangeImplementations</code>ç›´æ¥äº¤æ¢ä¸¤ä¸ª<code>method_t</code>çš„<code>IMP</code>:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">    method_exchangeImplementations(originalMethod, overrideMethod);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥æœ¬ä¾‹ä¸­ç”±äº<code>viewWillAppear:</code>å·²ç»åœ¨UIViewControllerä¸­å®ç°è¿‡äº†ï¼Œæ‰€ä»¥ï¼Œ<code>class_addMethod</code>å¤±è´¥ï¼Œé€šè¿‡<code>method_exchangeImplementations</code>è¾¾åˆ°äº¤æ¢å®ç°ã€‚å¦‚æœè¦é€šè¿‡<code>class_addMethod</code>æ·»åŠ ï¼Œéœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªViewç»§æ‰¿UIViewControllerï¼Œå†åœ¨è¿™ä¸ªç±»ä¸­æ›¿æ¢<code>viewWillAppear:</code>ã€‚</p>
<p>å¦‚æœç±»ä¸­æ²¡æœ‰æƒ³è¢«æ›¿æ¢å®ç°çš„åŸæ–¹æ³•æ—¶ï¼Œ<code>class_replaceMethod</code>ç›¸å½“äºç›´æ¥è°ƒç”¨<code>class_addMethod</code>å‘ç±»ä¸­æ·»åŠ è¯¥æ–¹æ³•çš„å®ç°ã€‚</p>
<p><code>method_exchangeImplementations</code>æ–¹æ³•åšçš„äº‹æƒ…ä¸å¦‚ä¸‹çš„åŸå­æ“ä½œç­‰ä»·ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">IMP imp1 = method_getImplementation(m1);</div><div class="line">IMP imp2 = method_getImplementation(m2);</div><div class="line">method_setImplementation(m1, imp2);</div><div class="line">method_setImplementation(m2, imp1);</div></pre></td></tr></table></figure></p>
<p>ç›´æ¥è®¾ç½®äº†<code>method</code>:<code>m1</code>,<code>m2</code>çš„<code>IMP</code>ï¼Œç®€å•æš´åŠ›ã€‚</p>
<p>å¯¹äºæ³¨é‡Šäº†çš„è¿™å‡ è¡Œ:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// When swizzling a class method, use the following:</span></div><div class="line"><span class="comment">// Class aClass = object_getClass((id)self);</span></div><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="comment">// Method originalMethod = class_getClassMethod(aClass, originalSelector);</span></div><div class="line"><span class="comment">// Method swizzledMethod = class_getClassMethod(aClass, swizzledSelector);</span></div></pre></td></tr></table></figure></p>
<p><code>object_getClass((id)self)</code> ä¸ <code>[self class]</code> è¿”å›çš„ç»“æœç±»å‹éƒ½æ˜¯ <code>Class</code>,ä½†å‰è€…ä¸ºå…ƒç±»,åè€…ä¸ºå…¶æœ¬èº«,å› ä¸ºæ­¤æ—¶ <code>self</code> ä¸º <code>Class</code> è€Œä¸æ˜¯å®ä¾‹.æ³¨æ„ <code>[NSObject class]</code> ä¸ <code>[objectå®ä¾‹ class]</code> çš„åŒºåˆ«ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">+ (Class)<span class="keyword">class</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (Class)<span class="keyword">class</span> &#123;</div><div class="line">    <span class="keyword">return</span> object_getClass(<span class="keyword">self</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>object_getClass()</code>æ–¹æ³•è¿”å›å¯¹è±¡çš„<code>isa</code>ã€‚</p>
<p>æœ€åï¼Œ<code>xxx_viewWillAppear:</code>æ–¹æ³•çš„å®šä¹‰çœ‹ä¼¼æ˜¯é€’å½’è°ƒç”¨å¼•å‘æ­»å¾ªç¯ï¼Œå…¶å®ä¸ä¼šçš„ã€‚å› ä¸º<code>[self xxx_viewWillAppear:animated]</code>æ¶ˆæ¯ä¼šåŠ¨æ€æ‰¾åˆ°<code>xxx_viewWillAppear:</code>æ–¹æ³•çš„å®ç°ï¼Œè€Œå®ƒçš„å®ç°å·²ç»è¢«æˆ‘ä»¬ä¸<code>viewWillAppear:</code>æ–¹æ³•å®ç°è¿›è¡Œäº†äº’æ¢ï¼Œæ‰€ä»¥è¿™æ®µä»£ç ä¸ä»…ä¸ä¼šæ­»å¾ªç¯ï¼Œå¦‚æœä½ æŠŠ<code>[self xxx_viewWillAppear:animated]æ¢æˆ[self viewWillAppear:animated]</code>åè€Œä¼šå¼•å‘æ­»å¾ªç¯ã€‚</p>
<blockquote>
<p>Demo è¯¦è§RuntimeLearn</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 å¸¸ç”¨å…§å»ºæ¨¡å—]]></title>
      <url>http://zhang759740844.github.io/2016/08/23/python_%E5%B8%B8%E7%94%A8%E5%85%A7%E5%BB%BA%E6%A8%A1%E5%9D%97/</url>
      <content type="html"><![CDATA[<p>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<h3 id="datetime"><a href="#datetime" class="headerlink" title="datetime"></a>datetime</h3><h4 id="è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´"><a href="#è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´" class="headerlink" title="è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´"></a>è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´</h4><p>datetimeæ˜¯æ¨¡å—ï¼Œdatetimeæ¨¡å—è¿˜åŒ…å«ä¸€ä¸ªdatetimeç±»ï¼Œé€šè¿‡from datetime import datetimeå¯¼å…¥çš„æ‰æ˜¯datetimeè¿™ä¸ªç±»ã€‚<br>å¦‚æœä»…å¯¼å…¥import datetimeï¼Œåˆ™å¿…é¡»å¼•ç”¨å…¨ådatetime.datetimeã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>now = datetime.now() <span class="comment"># è·å–å½“å‰datetime</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(now)</div><div class="line"><span class="number">2015</span><span class="number">-05</span><span class="number">-18</span> <span class="number">16</span>:<span class="number">28</span>:<span class="number">07.198690</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(now))</div><div class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">datetime</span>.<span class="title">datetime</span>'&gt;</span></div></pre></td></tr></table></figure></p>
<p>datetime.now()è¿”å›å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼Œå…¶ç±»å‹æ˜¯datetimeã€‚</p>
<h4 id="è·å–æŒ‡å®šæ—¥æœŸå’Œæ—¶é—´"><a href="#è·å–æŒ‡å®šæ—¥æœŸå’Œæ—¶é—´" class="headerlink" title="è·å–æŒ‡å®šæ—¥æœŸå’Œæ—¶é—´"></a>è·å–æŒ‡å®šæ—¥æœŸå’Œæ—¶é—´</h4><p>è¦æŒ‡å®šæŸä¸ªæ—¥æœŸå’Œæ—¶é—´ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨å‚æ•°æ„é€ ä¸€ä¸ªdatetimeï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dt = datetime(<span class="number">2015</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">20</span>) <span class="comment"># ç”¨æŒ‡å®šæ—¥æœŸæ—¶é—´åˆ›å»ºdatetime</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(dt)</div><div class="line"><span class="number">2015</span><span class="number">-04</span><span class="number">-19</span> <span class="number">12</span>:<span class="number">20</span>:<span class="number">00</span></div></pre></td></tr></table></figure></p>
<h4 id="datetimeè½¬æ¢ä¸ºtimestamp"><a href="#datetimeè½¬æ¢ä¸ºtimestamp" class="headerlink" title="datetimeè½¬æ¢ä¸ºtimestamp"></a>datetimeè½¬æ¢ä¸ºtimestamp</h4><p>æŠŠä¸€ä¸ªdatetimeç±»å‹è½¬æ¢ä¸ºtimestampåªéœ€è¦ç®€å•è°ƒç”¨<strong>timestamp()</strong>æ–¹æ³•ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dt = datetime(<span class="number">2015</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">20</span>) <span class="comment"># ç”¨æŒ‡å®šæ—¥æœŸæ—¶é—´åˆ›å»ºdatetime</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dt.timestamp() <span class="comment"># æŠŠdatetimeè½¬æ¢ä¸ºtimestamp</span></div><div class="line"><span class="number">1429417200.0</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„Pythonçš„timestampæ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ã€‚å¦‚æœæœ‰å°æ•°ä½ï¼Œå°æ•°ä½è¡¨ç¤ºæ¯«ç§’æ•°ã€‚<br>æŸäº›ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚Javaå’ŒJavaScriptï¼‰çš„timestampä½¿ç”¨æ•´æ•°è¡¨ç¤ºæ¯«ç§’æ•°ï¼Œè¿™ç§æƒ…å†µä¸‹åªéœ€è¦æŠŠtimestampé™¤ä»¥1000å°±å¾—åˆ°Pythonçš„æµ®ç‚¹è¡¨ç¤ºæ–¹æ³•.</p>
<h4 id="timestampè½¬æ¢ä¸ºdatetime"><a href="#timestampè½¬æ¢ä¸ºdatetime" class="headerlink" title="timestampè½¬æ¢ä¸ºdatetime"></a>timestampè½¬æ¢ä¸ºdatetime</h4><p>è¦æŠŠtimestampè½¬æ¢ä¸ºdatetimeï¼Œä½¿ç”¨datetimeæä¾›çš„<strong>fromtimestamp()</strong>æ–¹æ³•ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t = <span class="number">1429417200.0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(datetime.fromtimestamp(t))</div><div class="line"><span class="number">2015</span><span class="number">-04</span><span class="number">-19</span> <span class="number">12</span>:<span class="number">20</span>:<span class="number">00</span></div></pre></td></tr></table></figure></p>
<h4 id="strè½¬æ¢ä¸ºdatetime"><a href="#strè½¬æ¢ä¸ºdatetime" class="headerlink" title="strè½¬æ¢ä¸ºdatetime"></a>strè½¬æ¢ä¸ºdatetime</h4><p>è½¬æ¢æ–¹æ³•æ˜¯é€šè¿‡<strong>datetime.strptime()</strong>å®ç°ï¼Œéœ€è¦ä¸€ä¸ªæ—¥æœŸå’Œæ—¶é—´çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>cday = datetime.strptime(<span class="string">'2015-6-1 18:19:59'</span>, <span class="string">'%Y-%m-%d %H:%M:%S'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(cday)</div><div class="line"><span class="number">2015</span><span class="number">-06</span><span class="number">-01</span> <span class="number">18</span>:<span class="number">19</span>:<span class="number">59</span></div></pre></td></tr></table></figure></p>
<h4 id="datetimeè½¬æ¢ä¸ºstr"><a href="#datetimeè½¬æ¢ä¸ºstr" class="headerlink" title="datetimeè½¬æ¢ä¸ºstr"></a>datetimeè½¬æ¢ä¸ºstr</h4><p>å¦‚æœå·²ç»æœ‰äº†datetimeå¯¹è±¡ï¼Œè¦æŠŠå®ƒæ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²æ˜¾ç¤ºç»™ç”¨æˆ·ï¼Œå°±éœ€è¦è½¬æ¢ä¸ºstrï¼Œè½¬æ¢æ–¹æ³•æ˜¯é€šè¿‡strftime()å®ç°çš„<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>now = datetime.now()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(now.strftime(<span class="string">'%a, %b %d %H:%M'</span>))</div><div class="line">Mon, May <span class="number">05</span> <span class="number">16</span>:<span class="number">28</span></div></pre></td></tr></table></figure></p>
<h4 id="datetimeåŠ å‡"><a href="#datetimeåŠ å‡" class="headerlink" title="datetimeåŠ å‡"></a>datetimeåŠ å‡</h4><p>å¯¹æ—¥æœŸå’Œæ—¶é—´è¿›è¡ŒåŠ å‡å®é™…ä¸Šå°±æ˜¯æŠŠdatetimeå¾€åæˆ–å¾€å‰è®¡ç®—ï¼Œå¾—åˆ°æ–°çš„datetimeã€‚åŠ å‡å¯ä»¥ç›´æ¥ç”¨+å’Œ-è¿ç®—ç¬¦ï¼Œä¸è¿‡éœ€è¦å¯¼å…¥timedeltaè¿™ä¸ªç±»<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>now = datetime.now()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>now</div><div class="line">datetime.datetime(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">57</span>, <span class="number">3</span>, <span class="number">540997</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>now + timedelta(hours=<span class="number">10</span>)</div><div class="line">datetime.datetime(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">19</span>, <span class="number">2</span>, <span class="number">57</span>, <span class="number">3</span>, <span class="number">540997</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>now - timedelta(days=<span class="number">1</span>)</div><div class="line">datetime.datetime(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">57</span>, <span class="number">3</span>, <span class="number">540997</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>now + timedelta(days=<span class="number">2</span>, hours=<span class="number">12</span>)</div><div class="line">datetime.datetime(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">21</span>, <span class="number">4</span>, <span class="number">57</span>, <span class="number">3</span>, <span class="number">540997</span>)</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨timedeltaä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ç®—å‡ºå‰å‡ å¤©å’Œåå‡ å¤©çš„æ—¶åˆ»</p>
<h3 id="collections"><a href="#collections" class="headerlink" title="collections"></a>collections</h3><p>collectionsæ˜¯Pythonå†…å»ºçš„ä¸€ä¸ªé›†åˆæ¨¡å—ï¼Œæä¾›äº†è®¸å¤šæœ‰ç”¨çš„é›†åˆç±»ã€‚</p>
<h4 id="namedtuple"><a href="#namedtuple" class="headerlink" title="namedtuple"></a>namedtuple</h4><p><code>namedtuple</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨æ¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„<code>tuple</code>å¯¹è±¡ï¼Œå¹¶ä¸”è§„å®šäº†<code>tuple</code>å…ƒç´ çš„ä¸ªæ•°ï¼Œå¹¶å¯ä»¥ç”¨å±æ€§è€Œä¸æ˜¯ç´¢å¼•æ¥å¼•ç”¨<code>tuple</code>çš„æŸä¸ªå…ƒç´ ã€‚<br>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬ç”¨<code>namedtuple</code>å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®šä¹‰ä¸€ç§æ•°æ®ç±»å‹ï¼Œå®ƒå…·å¤‡<code>tuple</code>çš„ä¸å˜æ€§ï¼Œåˆå¯ä»¥æ ¹æ®å±æ€§æ¥å¼•ç”¨ï¼Œä½¿ç”¨ååˆ†æ–¹ä¾¿ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>Point = namedtuple(<span class="string">'Point'</span>, [<span class="string">'x'</span>, <span class="string">'y'</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = Point(<span class="number">1</span>, <span class="number">2</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p.x</div><div class="line"><span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p.y</div><div class="line"><span class="number">2</span></div><div class="line"></div><div class="line"><span class="comment"># namedtuple('åç§°', [å±æ€§list]):</span></div><div class="line">Circle = namedtuple(<span class="string">'Circle'</span>, [<span class="string">'x'</span>, <span class="string">'y'</span>, <span class="string">'r'</span>])</div></pre></td></tr></table></figure></p>
<h4 id="deque"><a href="#deque" class="headerlink" title="deque"></a>deque</h4><p>ä½¿ç”¨listå­˜å‚¨æ•°æ®æ—¶ï¼ŒæŒ‰ç´¢å¼•è®¿é—®å…ƒç´ å¾ˆå¿«ï¼Œä½†æ˜¯æ’å…¥å’Œåˆ é™¤å…ƒç´ å°±å¾ˆæ…¢äº†ï¼Œå› ä¸ºlistæ˜¯çº¿æ€§å­˜å‚¨ï¼Œæ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œæ’å…¥å’Œåˆ é™¤æ•ˆç‡å¾ˆä½ã€‚<br><code>deque</code>æ˜¯ä¸ºäº†é«˜æ•ˆå®ç°æ’å…¥å’Œåˆ é™¤æ“ä½œçš„åŒå‘åˆ—è¡¨ï¼Œé€‚åˆç”¨äºé˜Ÿåˆ—å’Œæ ˆï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> deque</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>q = deque([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>q.append(<span class="string">'x'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>q.appendleft(<span class="string">'y'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>q</div><div class="line">deque([<span class="string">'y'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'x'</span>])</div></pre></td></tr></table></figure></p>
<p><code>deque</code>é™¤äº†å®ç°listçš„<code>append()</code>å’Œ<code>pop()</code>å¤–ï¼Œè¿˜æ”¯æŒ<code>appendleft()</code>å’Œ<code>popleft()</code>ï¼Œè¿™æ ·å°±å¯ä»¥éå¸¸é«˜æ•ˆåœ°å¾€å¤´éƒ¨æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ã€‚</p>
<h4 id="defaultdict"><a href="#defaultdict" class="headerlink" title="defaultdict"></a>defaultdict</h4><p>ä½¿ç”¨<code>dict</code>æ—¶ï¼Œå¦‚æœå¼•ç”¨çš„<code>Key</code>ä¸å­˜åœ¨ï¼Œå°±ä¼šæŠ›å‡º<code>KeyError</code>ã€‚å¦‚æœå¸Œæœ›<code>key</code>ä¸å­˜åœ¨æ—¶ï¼Œè¿”å›ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå°±å¯ä»¥ç”¨<code>defaultdict</code>ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dd = defaultdict(<span class="keyword">lambda</span>: <span class="string">'N/A'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dd[<span class="string">'key1'</span>] = <span class="string">'abc'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dd[<span class="string">'key1'</span>] <span class="comment"># key1å­˜åœ¨</span></div><div class="line"><span class="string">'abc'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dd[<span class="string">'key2'</span>] <span class="comment"># key2ä¸å­˜åœ¨ï¼Œè¿”å›é»˜è®¤å€¼</span></div><div class="line"><span class="string">'N/A'</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„é»˜è®¤å€¼æ˜¯è°ƒç”¨å‡½æ•°è¿”å›çš„ï¼Œè€Œå‡½æ•°åœ¨åˆ›å»º<code>defaultdict</code>å¯¹è±¡æ—¶ä¼ å…¥ã€‚<br>é™¤äº†åœ¨<code>Key</code>ä¸å­˜åœ¨æ—¶è¿”å›é»˜è®¤å€¼ï¼Œ<code>defaultdict</code>çš„å…¶ä»–è¡Œä¸ºè·Ÿ<code>dict</code>æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚</p>
<h4 id="OrderedDict"><a href="#OrderedDict" class="headerlink" title="OrderedDict"></a>OrderedDict</h4><p>ä½¿ç”¨<code>dict</code>æ—¶ï¼ŒKeyæ˜¯æ— åºçš„ã€‚åœ¨å¯¹<code>dict</code>åšè¿­ä»£æ—¶ï¼Œæˆ‘ä»¬æ— æ³•ç¡®å®šKeyçš„é¡ºåºã€‚å¦‚æœè¦ä¿æŒKeyçš„é¡ºåºï¼Œå¯ä»¥ç”¨<code>OrderedDict</code>ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d = dict([(<span class="string">'a'</span>, <span class="number">1</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'c'</span>, <span class="number">3</span>)])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d <span class="comment"># dictçš„Keyæ˜¯æ— åºçš„</span></div><div class="line">&#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'b'</span>: <span class="number">2</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>od = OrderedDict([(<span class="string">'a'</span>, <span class="number">1</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'c'</span>, <span class="number">3</span>)])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>od <span class="comment"># OrderedDictçš„Keyæ˜¯æœ‰åºçš„</span></div><div class="line">OrderedDict([(<span class="string">'a'</span>, <span class="number">1</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'c'</span>, <span class="number">3</span>)])</div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼Œ<code>OrderedDict</code>çš„Keyä¼šæŒ‰ç…§æ’å…¥çš„é¡ºåºæ’åˆ—ï¼Œä¸æ˜¯Keyæœ¬èº«æ’åºï¼š</p>
<h4 id="Counter"><a href="#Counter" class="headerlink" title="Counter"></a>Counter</h4><p><code>Counter</code>æ˜¯ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ï¼Œä¾‹å¦‚ï¼Œç»Ÿè®¡å­—ç¬¦å‡ºç°çš„ä¸ªæ•°ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = Counter()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> ch <span class="keyword">in</span> <span class="string">'programming'</span>:</div><div class="line"><span class="meta">... </span>    c[ch] = c[ch] + <span class="number">1</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter(&#123;<span class="string">'g'</span>: <span class="number">2</span>, <span class="string">'m'</span>: <span class="number">2</span>, <span class="string">'r'</span>: <span class="number">2</span>, <span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'i'</span>: <span class="number">1</span>, <span class="string">'o'</span>: <span class="number">1</span>, <span class="string">'n'</span>: <span class="number">1</span>, <span class="string">'p'</span>: <span class="number">1</span>&#125;)</div></pre></td></tr></table></figure></p>
<p><code>Counter</code>å®é™…ä¸Šä¹Ÿæ˜¯<code>dict</code>çš„ä¸€ä¸ªå­ç±»ï¼Œä¸Šé¢çš„ç»“æœå¯ä»¥çœ‹å‡ºï¼Œå­—ç¬¦â€™gâ€™ã€â€™mâ€™ã€â€™râ€™å„å‡ºç°äº†ä¸¤æ¬¡ï¼Œå…¶ä»–å­—ç¬¦å„å‡ºç°äº†ä¸€æ¬¡ã€‚</p>
<p>æœ€åå†æ¬¡æ„Ÿè°¢å»–è€å¸ˆçš„è¾›å‹¤åŠ³åŠ¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[runtimeåŸç†ç¬”è®°]]></title>
      <url>http://zhang759740844.github.io/2016/08/22/runtime%E5%8E%9F%E7%90%86/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘å°è¯•å¾€categoryä¸­æ·»åŠ å®ä¾‹å˜é‡å¤±è´¥ï¼Œä½†æ˜¯å¯ä»¥æ·»åŠ æ–¹æ³•ã€‚äºæ˜¯ï¼Œç ”ç©¶äº†ä¸€ä¸‹runtimeçš„å®ç°å’Œä½¿ç”¨ã€‚runtimeçš„åŸç†å±•å¼€æ¥åˆ†æçš„è¯è¿˜æ˜¯æŒºå¤æ‚çš„ã€‚ä¸‹è½½äº†æœ€æ–°çš„æºç ï¼ˆobjc4-680ï¼‰,å‘ç°å’Œç°åœ¨ç½‘ä¸Šçš„å¤šæ•°æ•™ç¨‹è¿˜æ˜¯æœ‰å‡ºå…¥çš„ï¼Œè·Ÿè¿›èµ·æ¥å¾ˆå›°éš¾ã€‚<br>æ‰€ä»¥å°è¯•è‡ªå·±æ•´ç†äº†ä¸€ä¸‹ï¼ŒåŠ äº†ä¸€äº›è‡ªå·±çš„ç†è§£ï¼Œå…·ä½“ç»†èŠ‚å¯èƒ½æœ‰äº›å°å‡ºå…¥ã€‚å‚è€ƒæ–‡ç« ï¼š<a href="http://yulingtianxia.com/blog/2014/11/05/objective-c-runtime/" target="_blank" rel="external">Objective-C Runtime</a><br><a id="more"></a></p>
<h2 id="RuntimeåŸºç¡€"><a href="#RuntimeåŸºç¡€" class="headerlink" title="RuntimeåŸºç¡€"></a>RuntimeåŸºç¡€</h2><p>åœ¨Objective-Cä¸­ï¼Œä½¿ç”¨<code>[receiver message]</code>è¯­æ³•å¹¶ä¸ä¼šé©¬ä¸Šæ‰§è¡Œ<code>receiver</code>å¯¹è±¡çš„<code>message</code>æ–¹æ³•çš„ä»£ç ï¼Œè€Œæ˜¯å‘<code>receiver</code>å‘é€ä¸€æ¡<code>message</code>æ¶ˆæ¯ã€‚<br>å…¶å®<code>[receiver message]</code>è¢«ç¼–è¯‘å™¨è½¬åŒ–ä¸º:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">id</span> objc_msgSend ( <span class="keyword">id</span> <span class="keyword">self</span>, SEL op, ... );</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨å¯ä»¥çœ‹å‡º<code>[receiver message]</code>çœŸçš„ä¸æ˜¯ä¸€ä¸ªç®€ç®€å•å•çš„æ–¹æ³•è°ƒç”¨ã€‚å› ä¸ºè¿™åªæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µç¡®å®šäº†è¦å‘æ¥æ”¶è€…å‘é€<code>message</code>è¿™æ¡æ¶ˆæ¯ï¼Œè€Œ<code>receive</code>å°†è¦å¦‚ä½•å“åº”è¿™æ¡æ¶ˆæ¯ï¼Œé‚£å°±è¦çœ‹è¿è¡Œæ—¶å‘ç”Ÿçš„æƒ…å†µæ¥å†³å®šäº†ã€‚å¦‚æœæ¶ˆæ¯çš„æ¥æ”¶è€…èƒ½å¤Ÿæ‰¾åˆ°å¯¹åº”çš„<code>selector</code>ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºç›´æ¥æ‰§è¡Œäº†æ¥æ”¶è€…è¿™ä¸ªå¯¹è±¡çš„ç‰¹å®šæ–¹æ³•ï¼›å¦åˆ™ï¼Œæ¶ˆæ¯è¦ä¹ˆè¢«è½¬å‘ï¼Œæˆ–æ˜¯ä¸´æ—¶å‘æ¥æ”¶è€…åŠ¨æ€æ·»åŠ è¿™ä¸ª<code>selector</code>å¯¹åº”çš„å®ç°å†…å®¹ï¼Œè¦ä¹ˆå°±å¹²è„†ç©å®Œå´©æºƒæ‰ã€‚</p>
<h3 id="id"><a href="#id" class="headerlink" title="id"></a>id</h3><p><code>objc_msgSend</code>ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>id</code>,å®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘<code>objc_object</code>ç»“æ„ä½“æŒ‡é’ˆ,å®ƒåŒ…å«ä¸€ä¸ª<code>Class isa</code>æŒ‡é’ˆ(å®Œæ•´çš„å®šä¹‰åœ¨<code>objc_private.h</code>ä¸­)ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_object *<span class="keyword">id</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> objc_object &#123;</div><div class="line">    Class isa  OBJC_ISA_AVAILABILITY;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="SEL"><a href="#SEL" class="headerlink" title="SEL"></a>SEL</h3><p><code>objc_msgSend</code>å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ç±»å‹ä¸º<code>SEL</code>ï¼Œå®ƒæ˜¯<code>selector</code>åœ¨Objcä¸­çš„è¡¨ç¤ºç±»å‹.<code>selector</code>æ˜¯æ–¹æ³•é€‰æ‹©å™¨ï¼Œå¯ä»¥ç†è§£ä¸ºåŒºåˆ†æ–¹æ³•çš„ IDï¼Œè€Œè¿™ä¸ª ID çš„æ•°æ®ç»“æ„æ˜¯<code>SEL</code>:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_selector *SEL;</div></pre></td></tr></table></figure></p>
<h3 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h3><p>ä¹‹æ‰€ä»¥è¯´<code>isa</code>æ˜¯æŒ‡é’ˆæ˜¯å› ä¸º<code>Class</code>å…¶å®æ˜¯ä¸€ä¸ªæŒ‡å‘<code>objc_class</code>ç»“æ„ä½“çš„æŒ‡é’ˆï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_class *Class;</div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªç»“æ„ä½“åœ¨<code>runtime.h</code>ä¸­æœ‰å®šä¹‰:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> objc_class &#123;</div><div class="line">    Class isa  OBJC_ISA_AVAILABILITY;</div><div class="line"><span class="meta">#if !__OBJC2__</span></div><div class="line">    Class super_class                                        OBJC2_UNAVAILABLE;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *name                                         OBJC2_UNAVAILABLE;</div><div class="line">    <span class="keyword">long</span> version                                             OBJC2_UNAVAILABLE;</div><div class="line">    <span class="keyword">long</span> info                                                OBJC2_UNAVAILABLE;</div><div class="line">    <span class="keyword">long</span> instance_size                                       OBJC2_UNAVAILABLE;</div><div class="line">    <span class="keyword">struct</span> objc_ivar_list *ivars                             OBJC2_UNAVAILABLE;</div><div class="line">    <span class="keyword">struct</span> objc_method_list **methodLists                    OBJC2_UNAVAILABLE;</div><div class="line">    <span class="keyword">struct</span> objc_cache *cache                                 OBJC2_UNAVAILABLE;</div><div class="line">    <span class="keyword">struct</span> objc_protocol_list *protocols                     OBJC2_UNAVAILABLE;</div><div class="line"><span class="meta">#endif</span></div><div class="line">&#125; OBJC2_UNAVAILABLE;</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­<code>OBJC2_UNAVAILABLE</code>è¡¨ç¤ºï¼šåœ¨objc2ä¸­è¿™äº›å±æ€§å·²ç»ä¸åœ¨æ­¤å®šä¹‰ã€‚</p>
<p>åœ¨objc2ä¸­ï¼Œ<code>objc_class</code>çš„å®Œæ•´å®šä¹‰åœ¨<code>objc-runtime-new.h</code>ä¸­ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> objc_object &#123;</div><div class="line">    Class isa  OBJC_ISA_AVAILABILITY;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> objc_class : objc_object &#123;</div><div class="line">    Class superclass;</div><div class="line">    cache_t cache;             <span class="comment">// formerly cache pointer and vtable</span></div><div class="line">    class_data_bits_t bits;    <span class="comment">// class_rw_t * plus custom rr/alloc flags</span></div><div class="line"></div><div class="line">    class_rw_t *data() &#123; </div><div class="line">        <span class="keyword">return</span> bits.data();</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>å’Œ<code>runtime.h</code>ä¸­çš„å®šä¹‰å¯¹æ¯”ï¼Œå°‘äº†è®¸å¤šå±æ€§ï¼Œå¤šå‡ºä¸€ä¸ª<code>bits</code>å±æ€§ã€‚è¿™äº›å±æ€§éƒ½åŒ…å«åœ¨äº†<code>class_rw_t</code>çš„<code>data</code>å¯¹è±¡ä¸­ã€‚</p>
<p>æ³¨æ„åˆ°<code>objc_class</code>ä¸­ä¹Ÿæœ‰ä¸€ä¸ª<code>isa</code>å¯¹è±¡(ç»§æ‰¿è‡ª<code>objc_object</code>)ï¼Œè¿™æ˜¯å› ä¸ºä¸€ä¸ªObjCç±»æœ¬èº«åŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸ºäº†å¤„ç†ç±»å’Œå¯¹è±¡çš„å…³ç³»ï¼Œruntimeåº“åˆ›å»ºäº†ä¸€ç§å«åš <strong>å…ƒç±» (Meta Class)</strong>çš„ä¸œè¥¿ï¼Œç±»å¯¹è±¡æ‰€å±ç±»å‹å°±å«åšå…ƒç±»ï¼Œå®ƒç”¨æ¥è¡¨è¿°ç±»å¯¹è±¡æœ¬èº«æ‰€å…·å¤‡çš„å…ƒæ•°æ®ã€‚<strong>ç±»æ–¹æ³•å°±å®šä¹‰äºæ­¤å¤„</strong>ï¼Œå› ä¸ºè¿™äº›æ–¹æ³•å¯ä»¥ç†è§£æˆç±»å¯¹è±¡çš„å®ä¾‹æ–¹æ³•ã€‚æ¯ä¸ªç±»ä»…æœ‰ä¸€ä¸ªç±»å¯¹è±¡ï¼Œè€Œæ¯ä¸ªç±»å¯¹è±¡ä»…æœ‰ä¸€ä¸ªä¸ä¹‹ç›¸å…³çš„å…ƒç±»ã€‚<br>å½“ä½ å‘å‡ºä¸€ä¸ªç±»ä¼¼<code>[NSObject alloc]</code>çš„æ¶ˆæ¯æ—¶ï¼Œä½ äº‹å®ä¸Šæ˜¯æŠŠè¿™ä¸ªæ¶ˆæ¯å‘ç»™äº†ä¸€ä¸ª<strong>ç±»å¯¹è±¡ (Class Object)</strong> ï¼Œè¿™ä¸ªç±»å¯¹è±¡å¿…é¡»æ˜¯ä¸€ä¸ªå…ƒç±»çš„å®ä¾‹ï¼Œè€Œè¿™ä¸ªå…ƒç±»åŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ª<strong>æ ¹å…ƒç±» (root meta class)</strong>çš„å®ä¾‹ã€‚æ‰€æœ‰çš„å…ƒç±»æœ€ç»ˆéƒ½æŒ‡å‘æ ¹å…ƒç±»ä¸ºå…¶è¶…ç±»ã€‚æ‰€æœ‰çš„å…ƒç±»çš„æ–¹æ³•åˆ—è¡¨éƒ½æœ‰èƒ½å¤Ÿå“åº”æ¶ˆæ¯çš„ç±»æ–¹æ³•ã€‚æ‰€ä»¥å½“ <code>[NSObject alloc]</code>è¿™æ¡æ¶ˆæ¯å‘ç»™ç±»å¯¹è±¡çš„æ—¶å€™ï¼Œ<code>objc_msgSend()</code>ä¼šå»å®ƒçš„å…ƒç±»é‡Œé¢å»æŸ¥æ‰¾èƒ½å¤Ÿå“åº”æ¶ˆæ¯çš„æ–¹æ³•ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œç„¶åå¯¹è¿™ä¸ªç±»å¯¹è±¡æ‰§è¡Œæ–¹æ³•è°ƒç”¨ã€‚<br><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/runtime_principle.jpg?raw=true" alt="Class isa and superclass relationship"></p>
<h3 id="class-rw-t"><a href="#class-rw-t" class="headerlink" title="class_rw_t"></a>class_rw_t</h3><p><code>bits</code> ä¸­åŒ…å«äº†ä¸€ä¸ªæŒ‡å‘ <code>class_rw_t</code> ç»“æ„ä½“çš„æŒ‡é’ˆï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> class_rw_t &#123;</div><div class="line">    uint32_t flags;</div><div class="line">    uint32_t version;</div><div class="line"></div><div class="line">    <span class="keyword">const</span> class_ro_t *ro;</div><div class="line"></div><div class="line">    method_array_t methods;</div><div class="line">    property_array_t properties;</div><div class="line">    protocol_array_t protocols;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼Œ<code>const class_ro_t *ro</code>åŒ…å«äº†æ‰€æœ‰<strong>æˆå‘˜å˜é‡</strong>çš„ä¸€ç»´æ•°ç»„ä»¥åŠ<strong>å„ä¸ªåŸºç¡€çš„(base)å±æ€§ã€æ–¹æ³•å’Œåè®®</strong><br><code>method_array_t methods</code>ã€<code>property_array_t properties</code>ã€<code>protocol_array_t protocols</code>åˆ™åŒ…å«äº†æ‰€æœ‰<strong>æ‹“å±•çš„å±æ€§æ–¹æ³•å’Œåè®®</strong>ã€‚<strong>æ³¨æ„ï¼šè¿™é‡Œçš„å±æ€§åªæ˜¯getsetæ–¹æ³•ï¼Œä¸åŒ…å«æˆå‘˜å˜é‡ã€‚</strong><br>è¿™ä¹Ÿå°±è§£é‡Šäº†ï¼Œå¼€ç¯‡ä¸èƒ½æ·»åŠ æˆå‘˜å˜é‡çš„åŸå› ã€‚</p>
<p>å…·ä½“å¦‚ä½•åº”ç”¨å¯çœ‹ä¸‹ä¸€ç¯‡ã€‚</p>
<h3 id="éƒ¨åˆ†ç±»çš„å£°æ˜"><a href="#éƒ¨åˆ†ç±»çš„å£°æ˜" class="headerlink" title="éƒ¨åˆ†ç±»çš„å£°æ˜"></a>éƒ¨åˆ†ç±»çš„å£°æ˜</h3><p>è¿™éƒ¨åˆ†å°†ä¸Šé¢æ¶‰åŠçš„ç±»çš„å£°æ˜è´´å‡ºä»¥ä¾›å‚ç…§ï¼Œå¯ä»¥ç›´æ¥è·³è¿‡ã€‚</p>
<h4 id="class-ro-t"><a href="#class-ro-t" class="headerlink" title="class_ro_t:"></a>class_ro_t:</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> class_ro_t &#123;</div><div class="line">	...</div><div class="line">    method_list_t * baseMethodList;</div><div class="line">    protocol_list_t * baseProtocols;</div><div class="line">    <span class="keyword">const</span> ivar_list_t * ivars;</div><div class="line">    property_list_t *baseProperties;</div><div class="line">    ...</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h4 id="method-t"><a href="#method-t" class="headerlink" title="method_t"></a>method_t</h4><p><code>method_list_t</code>å’Œ<code>method_array_t</code>å†…éƒ½æ˜¯<code>method_t</code>ç±»å‹:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> method_t &#123;</div><div class="line">    SEL name;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *types;</div><div class="line">    IMP imp;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>æ–¹æ³•åç±»å‹ä¸º<code>SEL</code></li>
<li>æ–¹æ³•ç±»å‹<code>types</code>æ˜¯ä¸ª<code>char</code>æŒ‡é’ˆï¼Œå…¶å®å­˜å‚¨ç€æ–¹æ³•çš„å‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹ã€‚</li>
<li><code>imp</code>æŒ‡å‘äº†æ–¹æ³•çš„å®ç°ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ</li>
</ul>
<h4 id="ivar-t"><a href="#ivar-t" class="headerlink" title="ivar_t"></a>ivar_t</h4><p><code>ivar_list_t</code>å’Œ<code>ivar_array_t</code>å†…éƒ½æ˜¯<code>ivar_t</code>ç±»å‹:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> ivar_t &#123;</div><div class="line">    int32_t *offset;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *name;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *type;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="property-t"><a href="#property-t" class="headerlink" title="property_t"></a>property_t</h4><p><code>ivar_list_t</code>å’Œ<code>ivar_array_t</code>å†…éƒ½æ˜¯<code>ivar_t</code>ç±»å‹:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> property_t &#123;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *name;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *attributes;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h4 id="protocol-t"><a href="#protocol-t" class="headerlink" title="protocol_t"></a>protocol_t</h4><p><code>protocol_list_t</code>å’Œ<code>protocol_array_t</code>å†…éƒ½æ˜¯<code>protocol_t</code>ç±»å‹:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> protocol_t : objc_object &#123;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *mangledName;</div><div class="line">    <span class="keyword">struct</span> protocol_list_t *protocols;</div><div class="line">    method_list_t *instanceMethods;</div><div class="line">    method_list_t *classMethods;</div><div class="line">    method_list_t *optionalInstanceMethods;</div><div class="line">    method_list_t *optionalClassMethods;</div><div class="line">    property_list_t *instanceProperties;</div><div class="line">    uint32_t size;   <span class="comment">// sizeof(protocol_t)</span></div><div class="line">    uint32_t flags;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h4 id="Ivar-Method-Category-objc-property-t"><a href="#Ivar-Method-Category-objc-property-t" class="headerlink" title="Ivar,Method,Category,objc_property_t"></a>Ivar,Method,Category,objc_property_t</h4><p>å¤–éƒ¨å¯ä»¥é€šè¿‡ä¸€ç³»åˆ—çš„æ–¹æ³•è·å¾—ç±»çš„ä¿¡æ¯ï¼Œè¯¸å¦‚ï¼š<code>class_copyIvarList</code>,<code>class_copyPropertyList</code>ç­‰æ–¹æ³•ï¼Œå¯ä»¥è·å¾—ç±»çš„å®ä¾‹å˜é‡å’Œå±æ€§ï¼Œå¯¹åº”çš„ç±»å‹æ˜¯<code>Ivar</code>ã€<code>objc_property_t</code>ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯<code>ivar_t</code>,<code>property_t</code>ç±»å‹çš„æŒ‡é’ˆã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> method_t *Method;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> ivar_t *Ivar;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> category_t *Category;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> property_t *objc_property_t;</div></pre></td></tr></table></figure>
<h2 id="æ¶ˆæ¯"><a href="#æ¶ˆæ¯" class="headerlink" title="æ¶ˆæ¯"></a>æ¶ˆæ¯</h2><h3 id="objc-msgSendå‡½æ•°"><a href="#objc-msgSendå‡½æ•°" class="headerlink" title="objc_msgSendå‡½æ•°"></a>objc_msgSendå‡½æ•°</h3><p>çœ‹èµ·æ¥åƒæ˜¯<code>objc_msgSend</code>è¿”å›äº†æ•°æ®ï¼Œå…¶å®<code>objc_msgSend</code>ä»ä¸è¿”å›æ•°æ®è€Œæ˜¯ä½ çš„æ–¹æ³•è¢«è°ƒç”¨åè¿”å›äº†æ•°æ®ã€‚ä¸‹é¢è¯¦ç»†å™è¿°ä¸‹æ¶ˆæ¯å‘é€æ­¥éª¤ï¼š</p>
<ol>
<li>æ£€æµ‹è¿™ä¸ª <code>selector</code> æ˜¯ä¸æ˜¯è¦å¿½ç•¥çš„ã€‚æ¯”å¦‚æœ‰äº†åƒåœ¾å›æ”¶å°±ä¸ç†ä¼š <code>retain</code>, <code>release</code> è¿™äº›å‡½æ•°äº†ã€‚</li>
<li>æ£€æµ‹è¿™ä¸ª <code>target</code> æ˜¯ä¸æ˜¯ <code>nil</code> å¯¹è±¡ã€‚ObjC çš„ç‰¹æ€§æ˜¯å…è®¸å¯¹ä¸€ä¸ª <code>nil</code>å¯¹è±¡æ‰§è¡Œä»»ä½•ä¸€ä¸ªæ–¹æ³•ä¸ä¼š Crashï¼Œå› ä¸ºä¼šè¢«å¿½ç•¥æ‰ã€‚</li>
<li>å¦‚æœä¸Šé¢ä¸¤ä¸ªéƒ½è¿‡äº†ï¼Œé‚£å°±å¼€å§‹æŸ¥æ‰¾è¿™ä¸ªç±»çš„ <code>IMP</code>ï¼Œå…ˆä» <code>cache</code> é‡Œé¢æ‰¾ï¼Œå®Œäº†æ‰¾å¾—åˆ°å°±è·³åˆ°å¯¹åº”çš„å‡½æ•°å»æ‰§è¡Œã€‚</li>
<li>å¦‚æœ <code>cache</code> æ‰¾ä¸åˆ°å°±æ‰¾ä¸€ä¸‹æ–¹æ³•åˆ†å‘è¡¨ã€‚</li>
<li>å¦‚æœåˆ†å‘è¡¨æ‰¾ä¸åˆ°å°±åˆ°è¶…ç±»çš„åˆ†å‘è¡¨å»æ‰¾ï¼Œä¸€ç›´æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°<code>NSObject</code>ç±»ä¸ºæ­¢ã€‚</li>
<li>å¦‚æœè¿˜æ‰¾ä¸åˆ°å°±è¦å¼€å§‹è¿›å…¥åŠ¨æ€æ–¹æ³•è§£æäº†.</li>
</ol>
<p>ç¼–è¯‘å™¨ä¼šæ ¹æ®æƒ…å†µåœ¨<code>objc_msgSend</code>, <code>objc_msgSend_stret</code>, <code>objc_msgSendSuper</code>, æˆ– <code>objc_msgSendSuper_stret</code>å››ä¸ªæ–¹æ³•ä¸­é€‰æ‹©ä¸€ä¸ªæ¥è°ƒç”¨ã€‚å¦‚æœæ¶ˆæ¯æ˜¯ä¼ é€’ç»™è¶…ç±»ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨åå­—å¸¦æœ‰<code>Super</code>çš„å‡½æ•°ï¼›å¦‚æœæ¶ˆæ¯è¿”å›å€¼æ˜¯æ•°æ®ç»“æ„è€Œä¸æ˜¯ç®€å•å€¼æ—¶ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨åå­—å¸¦æœ‰<code>stret</code>çš„å‡½æ•°ã€‚</p>
<p>å½“æˆ‘ä»¬è°ƒç”¨<code>[super selector]</code> æ—¶ï¼ŒRuntime ä¼šè°ƒç”¨ <code>objc_msgSendSuper</code>æ–¹æ³•ï¼Œ<code>objc_msgSendSuper</code> æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œ<code>super</code> å’Œ <code>op</code>ï¼Œ<code>Runtime</code> ä¼šæŠŠ <code>selector</code> æ–¹æ³•é€‰æ‹©å™¨èµ‹å€¼ç»™ <code>op</code>ã€‚è€Œ <code>super</code> æ˜¯ä¸€ä¸ª <code>objc_super</code> ç»“æ„ä½“æŒ‡é’ˆï¼Œ<code>objc_super</code> ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> objc_super &#123; <span class="keyword">id</span> receiver; Class <span class="keyword">class</span>; &#125;;</div></pre></td></tr></table></figure></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¿™é‡Œçš„<code>receiver</code>ä»ç„¶æ˜¯<code>self</code>æœ¬èº«ã€‚å½“æˆ‘ä»¬æƒ³é€šè¿‡<code>[super class]</code>è·å–è¶…ç±»æ—¶ï¼Œç¼–è¯‘å™¨åªæ˜¯å°†æŒ‡å‘<code>self</code>çš„<code>id</code>æŒ‡é’ˆå’Œ<code>class</code>çš„<code>SEL</code>ä¼ é€’ç»™äº†<code>objc_msgSendSuper</code>å‡½æ•°ï¼Œå› ä¸ºåªæœ‰åœ¨<code>NSObject</code>ç±»æ‰èƒ½æ‰¾åˆ°<code>class</code>æ–¹æ³•ï¼Œç„¶å<code>class</code>æ–¹æ³•è°ƒç”¨<code>object_getClass()</code>ï¼Œæ¥ç€è°ƒç”¨<code>objc_msgSend(objc_super-&gt;receiver, @selector(class))</code>ï¼Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æŒ‡å‘<code>self</code>çš„<code>id</code>æŒ‡é’ˆï¼Œä¸è°ƒç”¨<code>[self class]</code>ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—åˆ°çš„æ°¸è¿œéƒ½æ˜¯<code>self</code>çš„ç±»å‹ã€‚</p>
<p>ä¸¾ä¸ªæ —å­ï¼Œé—®ä¸‹é¢çš„ä»£ç è¾“å‡ºä»€ä¹ˆï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Son</span> : <span class="title">Father</span></span></div><div class="line">- (<span class="keyword">id</span>)init</div><div class="line">&#123;</div><div class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, <span class="built_in">NSStringFromClass</span>([<span class="keyword">self</span> <span class="keyword">class</span>]));</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, <span class="built_in">NSStringFromClass</span>([<span class="keyword">super</span> <span class="keyword">class</span>]));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ç­”æ¡ˆæ˜¯å…¨éƒ¨è¾“å‡º <code>Son</code>.</p>
<p>å½“è°ƒç”¨ <code>[super class]</code> æ—¶ï¼Œä¼šè½¬æ¢æˆ <code>objc_msgSendSuper</code> å‡½æ•°ï¼š</p>
<ol>
<li>å…ˆæ„é€  <code>objc_super</code> ç»“æ„ä½“ï¼Œç»“æ„ä½“ç¬¬ä¸€ä¸ªæˆå‘˜å°±æ˜¯ <code>self</code>ã€‚ç¬¬äºŒä¸ªæˆå‘˜æ˜¯ <code>(id)class_getSuperclass(objc_getClass(â€œSonâ€))</code>.</li>
<li>å» <code>Father</code> è¿™ä¸ªç±»é‡Œå»æ‰¾ <code>- (Class)class</code>ï¼Œæ²¡æœ‰ï¼Œç„¶åå» <code>NSObject</code> ç±»å»æ‰¾ï¼Œæ‰¾åˆ°äº†ã€‚æœ€åå†…éƒ¨æ˜¯ä½¿ç”¨ <code>objc_msgSend(objc_super-&gt;receiver, @selector(class))</code> å»è°ƒç”¨ï¼Œæ­¤æ—¶å·²ç»å’Œ <code>[self class]</code> è°ƒç”¨ç›¸åŒäº†ï¼Œæ‰€ä»¥ä¸¤ä¸ªè¾“å‡ºç»“æœéƒ½æ˜¯ <code>Son</code>ã€‚</li>
</ol>
<p>è¿™é‡Œè°ƒç”¨<code>class</code>åªæ˜¯ä¸¾ä¾‹ï¼Œæ‰€æœ‰è°ƒç”¨<code>super</code>çš„æ–¹æ³•ï¼Œæœ€åéƒ½å˜æˆäº†<code>self</code>çš„è°ƒç”¨ã€‚</p>
<h2 id="Category-çš„å®ç°åŸç†"><a href="#Category-çš„å®ç°åŸç†" class="headerlink" title="Category çš„å®ç°åŸç†"></a>Category çš„å®ç°åŸç†</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>runtime ä¾èµ–äº dyld åŠ¨æ€åŠ è½½ï¼Œåœ¨ objc-os.mm æ–‡ä»¶ä¸­å¯ä»¥æ‰¾åˆ°å…¥å£ï¼Œå®ƒçš„è°ƒç”¨æ ˆç®€å•æ•´ç†å¦‚ä¸‹:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> _objc_init(<span class="keyword">void</span>)</div><div class="line">â””â”€â”€<span class="keyword">const</span> <span class="keyword">char</span> \*map_2_images(...)</div><div class="line">    â””â”€â”€<span class="keyword">const</span> <span class="keyword">char</span> \*map_images_nolock(...)</div><div class="line">        â””â”€â”€<span class="keyword">void</span> _read_images(header_info **hList, uint32_t hCount)</div><div class="line">        	â””â”€â”€<span class="keyword">static</span> <span class="keyword">void</span> remethodizeClass(Class cls)</div><div class="line">        		â””â”€â”€<span class="keyword">static</span> <span class="keyword">void</span> attachCategories(Class cls, category_list *cats, <span class="keyword">bool</span> flush_caches)</div></pre></td></tr></table></figure></p>
<h3 id="Category-ç›¸å…³çš„æ•°æ®ç»“æ„"><a href="#Category-ç›¸å…³çš„æ•°æ®ç»“æ„" class="headerlink" title="Category ç›¸å…³çš„æ•°æ®ç»“æ„"></a>Category ç›¸å…³çš„æ•°æ®ç»“æ„</h3><p>é¦–å…ˆæ¥äº†è§£ä¸€ä¸‹ä¸€ä¸ª Category æ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Œåœ¨ objc-runtime-new.h ä¸­å¯ä»¥çœ‹åˆ°å¦‚ä¸‹å®šä¹‰ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> category_t &#123;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *name;</div><div class="line">    classref_t cls;</div><div class="line">    <span class="keyword">struct</span> method_list_t *instanceMethods;</div><div class="line">    <span class="keyword">struct</span> method_list_t *classMethods;</div><div class="line">    <span class="keyword">struct</span> protocol_list_t *protocols;</div><div class="line">    <span class="keyword">struct</span> property_list_t *instanceProperties;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>ä»categoryçš„å®šä¹‰ä¹Ÿå¯ä»¥çœ‹å‡ºcategoryçš„å¯ä¸ºï¼ˆå¯ä»¥æ·»åŠ å®ä¾‹æ–¹æ³•ï¼Œç±»æ–¹æ³•ï¼Œç”šè‡³å¯ä»¥å®ç°åè®®ï¼Œæ·»åŠ å±æ€§ï¼‰å’Œä¸å¯ä¸ºï¼ˆæ— æ³•æ·»åŠ å®ä¾‹å˜é‡ï¼‰ã€‚</p>
<h3 id="å¤„ç†-Category"><a href="#å¤„ç†-Category" class="headerlink" title="å¤„ç† Category"></a>å¤„ç† Category</h3><p>å¯¹ Category ä¸­æ–¹æ³•çš„è§£æå¹¶ä¸å¤æ‚ï¼Œé¦–å…ˆæ¥çœ‹ä¸€ä¸‹ attachCategories çš„ç®€åŒ–ç‰ˆä»£ç :<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">void</span> attachCategories(Class cls, category_list *cats, <span class="keyword">bool</span> flush_caches) &#123;</div><div class="line">    <span class="keyword">if</span> (!cats) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">bool</span> isMeta = cls-&gt;isMetaClass();</div><div class="line"></div><div class="line">    method_list_t **mlists = (method_list_t **)malloc(cats-&gt;count * <span class="keyword">sizeof</span>(*mlists));</div><div class="line">    <span class="comment">// Count backwards through cats to get newest categories first</span></div><div class="line">    <span class="keyword">int</span> mcount = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> i = cats-&gt;count;</div><div class="line">    <span class="keyword">while</span> (i--) &#123;</div><div class="line">        auto&amp; entry = cats-&gt;list[i];</div><div class="line"></div><div class="line">        method_list_t *mlist = entry.cat-&gt;methodsForMeta(isMeta);</div><div class="line">        <span class="keyword">if</span> (mlist) &#123;</div><div class="line">            mlists[mcount++] = mlist;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    auto rw = cls-&gt;data();</div><div class="line"></div><div class="line">    prepareMethodLists(cls, mlists, mcount, <span class="literal">NO</span>, fromBundle);</div><div class="line">    rw-&gt;methods.attachLists(mlists, mcount);</div><div class="line">    free(mlists);</div><div class="line">    <span class="keyword">if</span> (flush_caches  &amp;&amp;  mcount &gt; <span class="number">0</span>) flushCaches(cls);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>é¦–å…ˆï¼Œé€šè¿‡ <code>while</code> å¾ªç¯ï¼Œæˆ‘ä»¬éå†æ‰€æœ‰çš„ categoryï¼Œä¹Ÿå°±æ˜¯å‚æ•° <code>cats</code> ä¸­çš„ <code>list</code> å±æ€§ã€‚å¯¹äºæ¯ä¸€ä¸ª categoryï¼Œå¾—åˆ°å®ƒçš„æ–¹æ³•åˆ—è¡¨ <code>mlist</code> å¹¶å­˜å…¥ <code>mlists</code> ä¸­ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰ category ä¸­çš„æ–¹æ³•æ‹¼æ¥åˆ°äº†ä¸€ä¸ªå¤§çš„äºŒç»´æ•°ç»„ä¸­ï¼Œæ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯è£…æœ‰ä¸€ä¸ª category æ‰€æœ‰æ–¹æ³•çš„å®¹å™¨ã€‚</p>
<p>åœ¨ <code>while</code> å¾ªç¯å¤–ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ‹¼æ¥æˆçš„æ–¹æ³•ï¼Œæ­¤æ—¶éœ€è¦ä¸ç±»åŸæ¥çš„æ–¹æ³•åˆå¹¶:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">auto rw = cls-&gt;data();</div><div class="line">rw-&gt;methods.attachLists(mlists, mcount);</div></pre></td></tr></table></figure></p>
<p><code>rw</code> æ˜¯ä¸€ä¸ª <code>class_rw_t</code>ç±»å‹çš„ç»“æ„ä½“æŒ‡é’ˆã€‚æ ¹æ® runtime ä¸­çš„æ•°æ®ç»“æ„ï¼Œå®ƒæœ‰ä¸€ä¸ª <code>methods</code> ç»“æ„ä½“æˆå‘˜ï¼Œå¹¶ä»çˆ¶ç±»ç»§æ‰¿äº† <code>attachLists</code> æ–¹æ³•ï¼Œç”¨æ¥åˆå¹¶ category ä¸­çš„æ–¹æ³•:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> attachLists(List* <span class="keyword">const</span> * addedLists, uint32_t addedCount) &#123;</div><div class="line">    <span class="keyword">if</span> (addedCount == <span class="number">0</span>) <span class="keyword">return</span>;</div><div class="line">    uint32_t oldCount = array()-&gt;count;</div><div class="line">    uint32_t newCount = oldCount + addedCount;</div><div class="line">    setArray((array_t *)realloc(array(), array_t::byteSize(newCount)));</div><div class="line">    array()-&gt;count = newCount;</div><div class="line">    memmove(array()-&gt;lists + addedCount, array()-&gt;lists, oldCount * <span class="keyword">sizeof</span>(array()-&gt;lists[<span class="number">0</span>]));</div><div class="line">    memcpy(array()-&gt;lists, addedLists, addedCount * <span class="keyword">sizeof</span>(array()-&gt;lists[<span class="number">0</span>]));</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ— è®ºæ‰§è¡Œå“ªç§é€»è¾‘ï¼Œå‚æ•°åˆ—è¡¨ä¸­çš„æ–¹æ³•éƒ½ä¼šè¢«æ·»åŠ åˆ°äºŒç»´æ•°ç»„çš„å‰é¢ã€‚å› æ­¤ category ä¸­å®šä¹‰çš„åŒåæ–¹æ³•ä¸ä¼šæ›¿æ¢ç±»ä¸­åŸæœ‰çš„æ–¹æ³•ï¼Œä½†æ˜¯å¯¹åŸæ–¹æ³•çš„è°ƒç”¨å®é™…ä¸Šä¼šè°ƒç”¨ category ä¸­çš„æ–¹æ³•ã€‚</p>
<p><a href="http://www.jianshu.com/p/9d649ce6d0b8" target="_blank" rel="external">runtimeçš„ä¸€ç¯‡è¾ƒå¥½çš„å‚è€ƒèµ„æ–™</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 æ­£åˆ™è¡¨è¾¾å¼]]></title>
      <url>http://zhang759740844.github.io/2016/08/20/python_%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><ul>
<li>\då¯ä»¥åŒ¹é…ä¸€ä¸ªæ•°å­—</li>
<li>\wå¯ä»¥åŒ¹é…ä¸€ä¸ªå­—æ¯æˆ–æ•°å­—</li>
<li>.å¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦</li>
<li>*è¡¨ç¤ºä»»æ„ä¸ªå­—ç¬¦ï¼ˆåŒ…æ‹¬0ä¸ªï¼‰</li>
<li>ç”¨+è¡¨ç¤ºè‡³å°‘ä¸€ä¸ªå­—ç¬¦</li>
<li>ç”¨?è¡¨ç¤º0ä¸ªæˆ–1ä¸ªå­—ç¬¦</li>
<li>ç”¨{n}è¡¨ç¤ºnä¸ªå­—ç¬¦</li>
<li>ç”¨{n,m}è¡¨ç¤ºn-mä¸ªå­—ç¬¦</li>
<li>\så¯ä»¥åŒ¹é…ä¸€ä¸ªç©ºæ ¼ï¼ˆä¹ŸåŒ…æ‹¬Tabç­‰ç©ºç™½ç¬¦ï¼‰</li>
<li>è¦åšæ›´ç²¾ç¡®åœ°åŒ¹é…ï¼Œå¯ä»¥ç”¨[]è¡¨ç¤ºèŒƒå›´    <ul>
<li>[0-9a-zA-Z_]å¯ä»¥åŒ¹é…ä¸€ä¸ªæ•°å­—ã€å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿</li>
</ul>
</li>
<li>[0-9a-zA-Z_]å¯ä»¥åŒ¹é…ä¸€ä¸ªæ•°å­—ã€å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿<ul>
<li>(P|p)ythonå¯ä»¥åŒ¹é…â€™Pythonâ€™æˆ–è€…â€™pythonâ€™</li>
</ul>
</li>
<li>^è¡¨ç¤ºè¡Œçš„å¼€å¤´</li>
<li>$è¡¨ç¤ºè¡Œçš„ç»“æŸ</li>
<li>^py$å°±å˜æˆäº†æ•´è¡ŒåŒ¹é…,å°±åªèƒ½åŒ¹é…â€™pyâ€™</li>
</ul>
<h3 id="reæ¨¡å—"><a href="#reæ¨¡å—" class="headerlink" title="reæ¨¡å—"></a>reæ¨¡å—</h3><p>Pythonæä¾›reæ¨¡å—ï¼ŒåŒ…å«æ‰€æœ‰æ­£åˆ™è¡¨è¾¾å¼çš„åŠŸèƒ½ã€‚<br>Pythonçš„å­—ç¬¦ä¸²æœ¬èº«ä¹Ÿç”¨\è½¬ä¹‰ï¼Œå› æ­¤æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨Pythonçš„rå‰ç¼€ï¼Œå°±ä¸ç”¨è€ƒè™‘è½¬ä¹‰çš„é—®é¢˜äº†ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">s = <span class="string">r'ABC\-001'</span> <span class="comment"># Pythonçš„å­—ç¬¦ä¸²</span></div><div class="line"><span class="comment"># å¯¹åº”çš„æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²ä¸å˜ï¼š</span></div><div class="line"><span class="comment"># 'ABC\-001'</span></div></pre></td></tr></table></figure></p>
<p>match()æ–¹æ³•åˆ¤æ–­æ˜¯å¦åŒ¹é…ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œè¿”å›ä¸€ä¸ªMatchå¯¹è±¡ï¼Œå¦åˆ™è¿”å›Noneã€‚å¸¸è§çš„åˆ¤æ–­æ–¹æ³•å°±æ˜¯ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">test = <span class="string">'ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²'</span></div><div class="line"><span class="keyword">if</span> re.match(<span class="string">r'æ­£åˆ™è¡¨è¾¾å¼'</span>, test):</div><div class="line">    print(<span class="string">'ok'</span>)</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    print(<span class="string">'failed'</span>)</div></pre></td></tr></table></figure></p>
<h3 id="åˆ‡åˆ†å­—ç¬¦ä¸²"><a href="#åˆ‡åˆ†å­—ç¬¦ä¸²" class="headerlink" title="åˆ‡åˆ†å­—ç¬¦ä¸²"></a>åˆ‡åˆ†å­—ç¬¦ä¸²</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">r'[\s\,\;]+'</span>, <span class="string">'a,b;; c  d'</span>)</div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</div></pre></td></tr></table></figure>
<p>é™¤äº†ç®€å•åœ°åˆ¤æ–­æ˜¯å¦åŒ¹é…ä¹‹å¤–ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¿˜æœ‰æå–å­ä¸²çš„å¼ºå¤§åŠŸèƒ½ã€‚ç”¨()è¡¨ç¤ºçš„å°±æ˜¯è¦æå–çš„åˆ†ç»„ï¼ˆGroupï¼‰ã€‚æ¯”å¦‚ï¼š<strong>^(\d{3})-(\d{3,8})$</strong>åˆ†åˆ«å®šä¹‰äº†ä¸¤ä¸ªç»„ï¼Œå¯ä»¥ç›´æ¥ä»åŒ¹é…çš„å­—ç¬¦ä¸²ä¸­æå–å‡ºåŒºå·å’Œæœ¬åœ°å·ç ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>m = re.match(<span class="string">r'^(\d&#123;3&#125;)-(\d&#123;3,8&#125;)$'</span>, <span class="string">'010-12345'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m</div><div class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">9</span>), match=<span class="string">'010-12345'</span>&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m.group(<span class="number">0</span>)</div><div class="line"><span class="string">'010-12345'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m.group(<span class="number">1</span>)</div><div class="line"><span class="string">'010'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m.group(<span class="number">2</span>)</div><div class="line"><span class="string">'12345'</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„åˆ°group(0)æ°¸è¿œæ˜¯åŸå§‹å­—ç¬¦ä¸²ï¼Œgroup(1)ã€group(2)â€¦â€¦è¡¨ç¤ºç¬¬1ã€2ã€â€¦â€¦ä¸ªå­ä¸²ã€‚</p>
<h3 id="è´ªå©ªåŒ¹é…"><a href="#è´ªå©ªåŒ¹é…" class="headerlink" title="è´ªå©ªåŒ¹é…"></a>è´ªå©ªåŒ¹é…</h3><p>æ­£åˆ™åŒ¹é…é»˜è®¤æ˜¯è´ªå©ªåŒ¹é…ï¼Œä¹Ÿå°±æ˜¯åŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼ŒåŒ¹é…å‡ºæ•°å­—åé¢çš„0ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>re.match(<span class="string">r'^(\d+)(0*)$'</span>, <span class="string">'102300'</span>).groups()</div><div class="line">(<span class="string">'102300'</span>, <span class="string">''</span>)</div></pre></td></tr></table></figure></p>
<p>ç”±äº\d+é‡‡ç”¨è´ªå©ªåŒ¹é…ï¼Œç›´æ¥æŠŠåé¢çš„0å…¨éƒ¨åŒ¹é…äº†ï¼Œç»“æœ0*åªèƒ½åŒ¹é…ç©ºå­—ç¬¦ä¸²äº†ã€‚<br>å¿…é¡»è®©\d+é‡‡ç”¨éè´ªå©ªåŒ¹é…ï¼ˆä¹Ÿå°±æ˜¯å°½å¯èƒ½å°‘åŒ¹é…ï¼‰ï¼Œæ‰èƒ½æŠŠåé¢çš„0åŒ¹é…å‡ºæ¥ï¼ŒåŠ ä¸ª?å°±å¯ä»¥è®©\d+é‡‡ç”¨éè´ªå©ªåŒ¹é…ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>re.match(<span class="string">r'^(\d+?)(0*)$'</span>, <span class="string">'102300'</span>).groups()</div><div class="line">(<span class="string">'1023'</span>, <span class="string">'00'</span>)</div></pre></td></tr></table></figure></p>
<h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><p>å¦‚æœä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¦é‡å¤ä½¿ç”¨å‡ åƒæ¬¡ï¼Œå‡ºäºæ•ˆç‡çš„è€ƒè™‘ï¼Œæˆ‘ä»¬å¯ä»¥é¢„ç¼–è¯‘è¯¥æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¥ä¸‹æ¥é‡å¤ä½¿ç”¨æ—¶å°±ä¸éœ€è¦ç¼–è¯‘è¿™ä¸ªæ­¥éª¤äº†ï¼Œç›´æ¥åŒ¹é…ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</div><div class="line"><span class="comment"># ç¼–è¯‘:</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>re_telephone = re.compile(<span class="string">r'^(\d&#123;3&#125;)-(\d&#123;3,8&#125;)$'</span>)</div><div class="line"><span class="comment"># ä½¿ç”¨ï¼š</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>re_telephone.match(<span class="string">'010-12345'</span>).groups()</div><div class="line">(<span class="string">'010'</span>, <span class="string">'12345'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>re_telephone.match(<span class="string">'010-8086'</span>).groups()</div><div class="line">(<span class="string">'010'</span>, <span class="string">'8086'</span>)</div></pre></td></tr></table></figure></p>
<p>æœ€åå†æ¬¡æ„Ÿè°¢å»–è€å¸ˆçš„è¾›å‹¤åŠ³åŠ¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 è¿›ç¨‹ä¸çº¿ç¨‹]]></title>
      <url>http://zhang759740844.github.io/2016/08/18/python_%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<h3 id="å¤šè¿›ç¨‹"><a href="#å¤šè¿›ç¨‹" class="headerlink" title="å¤šè¿›ç¨‹"></a>å¤šè¿›ç¨‹</h3><h4 id="multiprocessing"><a href="#multiprocessing" class="headerlink" title="multiprocessing"></a>multiprocessing</h4><p>multiprocessingæ¨¡å—å°±æ˜¯è·¨å¹³å°ç‰ˆæœ¬çš„å¤šè¿›ç¨‹æ¨¡å—ã€‚<br>multiprocessingæ¨¡å—æä¾›äº†ä¸€ä¸ªProcessç±»æ¥ä»£è¡¨ä¸€ä¸ªè¿›ç¨‹å¯¹è±¡<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</div><div class="line"><span class="keyword">import</span> os</div><div class="line"></div><div class="line"><span class="comment"># å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç </span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_proc</span><span class="params">(name)</span>:</span></div><div class="line">    print(<span class="string">'Run child process %s (%s)...'</span> % (name, os.getpid()))</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</div><div class="line">    print(<span class="string">'Parent process %s.'</span> % os.getpid())</div><div class="line">    p = Process(target=run_proc, args=(<span class="string">'test'</span>,))</div><div class="line">    print(<span class="string">'Child process will start.'</span>)</div><div class="line">    p.start()</div><div class="line">    p.join()</div><div class="line">    print(<span class="string">'Child process end.'</span>)</div></pre></td></tr></table></figure></p>
<p>åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ªæ‰§è¡Œå‡½æ•°å’Œå‡½æ•°çš„å‚æ•°ï¼Œåˆ›å»ºä¸€ä¸ªProcesså®ä¾‹ï¼Œç”¨start()æ–¹æ³•å¯åŠ¨ï¼Œè¿™æ ·åˆ›å»ºè¿›ç¨‹æ¯”fork()è¿˜è¦ç®€å•ã€‚<br>join()æ–¹æ³•å¯ä»¥ç­‰å¾…å­è¿›ç¨‹ç»“æŸåå†ç»§ç»­å¾€ä¸‹è¿è¡Œï¼Œé€šå¸¸ç”¨äºè¿›ç¨‹é—´çš„åŒæ­¥ã€‚</p>
<h4 id="pool"><a href="#pool" class="headerlink" title="pool"></a>pool</h4><p>å¦‚æœè¦å¯åŠ¨å¤§é‡çš„å­è¿›ç¨‹ï¼Œå¯ä»¥ç”¨è¿›ç¨‹æ± çš„æ–¹å¼æ‰¹é‡åˆ›å»ºå­è¿›ç¨‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</div><div class="line"><span class="keyword">import</span> os, time, random</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">long_time_task</span><span class="params">(name)</span>:</span></div><div class="line">    print(<span class="string">'Run task %s (%s)...'</span> % (name, os.getpid()))</div><div class="line">    start = time.time()</div><div class="line">    time.sleep(random.random() * <span class="number">3</span>)</div><div class="line">    end = time.time()</div><div class="line">    print(<span class="string">'Task %s runs %0.2f seconds.'</span> % (name, (end - start)))</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</div><div class="line">    print(<span class="string">'Parent process %s.'</span> % os.getpid())</div><div class="line">    p = Pool(<span class="number">4</span>)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</div><div class="line">        p.apply_async(long_time_task, args=(i,))</div><div class="line">    print(<span class="string">'Waiting for all subprocesses done...'</span>)</div><div class="line">    p.close()</div><div class="line">    p.join()</div><div class="line">    print(<span class="string">'All subprocesses done.'</span>)</div></pre></td></tr></table></figure></p>
<p>ç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Parent process <span class="number">669.</span></div><div class="line">Waiting <span class="keyword">for</span> all subprocesses done...</div><div class="line">Run task <span class="number">0</span> (<span class="number">671</span>)...</div><div class="line">Run task <span class="number">1</span> (<span class="number">672</span>)...</div><div class="line">Run task <span class="number">2</span> (<span class="number">673</span>)...</div><div class="line">Run task <span class="number">3</span> (<span class="number">674</span>)...</div><div class="line">Task <span class="number">2</span> runs <span class="number">0.14</span> seconds.</div><div class="line">Run task <span class="number">4</span> (<span class="number">673</span>)...</div><div class="line">Task <span class="number">1</span> runs <span class="number">0.27</span> seconds.</div><div class="line">Task <span class="number">3</span> runs <span class="number">0.86</span> seconds.</div><div class="line">Task <span class="number">0</span> runs <span class="number">1.41</span> seconds.</div><div class="line">Task <span class="number">4</span> runs <span class="number">1.91</span> seconds.</div><div class="line">All subprocesses done.</div></pre></td></tr></table></figure></p>
<p>å¯¹Poolå¯¹è±¡è°ƒç”¨join()æ–¹æ³•ä¼šç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œè°ƒç”¨join()ä¹‹å‰å¿…é¡»å…ˆè°ƒç”¨close()ï¼Œè°ƒç”¨close()ä¹‹åå°±ä¸èƒ½ç»§ç»­æ·»åŠ æ–°çš„Processäº†ã€‚<br>æ³¨æ„è¾“å‡ºçš„ç»“æœï¼Œtask 0ï¼Œ1ï¼Œ2ï¼Œ3æ˜¯ç«‹åˆ»æ‰§è¡Œçš„ï¼Œè€Œtask 4è¦ç­‰å¾…å‰é¢æŸä¸ªtaskå®Œæˆåæ‰æ‰§è¡Œï¼Œè¿™æ˜¯å› ä¸ºPoolçš„é»˜è®¤å¤§å°åœ¨æˆ‘çš„ç”µè„‘ä¸Šæ˜¯4ï¼Œå› æ­¤ï¼Œæœ€å¤šåŒæ—¶æ‰§è¡Œ4ä¸ªè¿›ç¨‹ã€‚è¿™æ˜¯Poolæœ‰æ„è®¾è®¡çš„é™åˆ¶ï¼Œå¹¶ä¸æ˜¯æ“ä½œç³»ç»Ÿçš„é™åˆ¶ã€‚å¦‚æœæ”¹æˆï¼š<code>p = ool(5)</code>å°±å¯ä»¥åŒæ—¶è·‘5ä¸ªè¿›ç¨‹ã€‚</p>
<h4 id="å­è¿›ç¨‹-amp-è¿›ç¨‹é—´é€šä¿¡"><a href="#å­è¿›ç¨‹-amp-è¿›ç¨‹é—´é€šä¿¡" class="headerlink" title="å­è¿›ç¨‹&amp;è¿›ç¨‹é—´é€šä¿¡"></a>å­è¿›ç¨‹&amp;è¿›ç¨‹é—´é€šä¿¡</h4><p>åˆ°æ—¶å€™å†çœ‹</p>
<h3 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h3><p>å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å°±æ˜¯æŠŠä¸€ä¸ªå‡½æ•°ä¼ å…¥å¹¶åˆ›å»ºThreadå®ä¾‹ï¼Œç„¶åè°ƒç”¨start()å¼€å§‹æ‰§è¡Œï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> time, threading</div><div class="line"></div><div class="line"><span class="comment"># æ–°çº¿ç¨‹æ‰§è¡Œçš„ä»£ç :</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">loop</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'thread %s is running...'</span> % threading.current_thread().name)</div><div class="line">    n = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> n &lt; <span class="number">5</span>:</div><div class="line">        n = n + <span class="number">1</span></div><div class="line">        print(<span class="string">'thread %s &gt;&gt;&gt; %s'</span> % (threading.current_thread().name, n))</div><div class="line">        time.sleep(<span class="number">1</span>)</div><div class="line">    print(<span class="string">'thread %s ended.'</span> % threading.current_thread().name)</div><div class="line"></div><div class="line">print(<span class="string">'thread %s is running...'</span> % threading.current_thread().name)</div><div class="line">t = threading.Thread(target=loop, name=<span class="string">'LoopThread'</span>)</div><div class="line">t.start()</div><div class="line">t.join()</div><div class="line">print(<span class="string">'thread %s ended.'</span> % threading.current_thread().name)</div></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">thread MainThread <span class="keyword">is</span> running...</div><div class="line">thread LoopThread <span class="keyword">is</span> running...</div><div class="line">thread LoopThread &gt;&gt;&gt; <span class="number">1</span></div><div class="line">thread LoopThread &gt;&gt;&gt; <span class="number">2</span></div><div class="line">thread LoopThread &gt;&gt;&gt; <span class="number">3</span></div><div class="line">thread LoopThread &gt;&gt;&gt; <span class="number">4</span></div><div class="line">thread LoopThread &gt;&gt;&gt; <span class="number">5</span></div><div class="line">thread LoopThread ended.</div><div class="line">thread MainThread ended.</div></pre></td></tr></table></figure>
<p>ä»»ä½•è¿›ç¨‹é»˜è®¤å°±ä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ‘ä»¬æŠŠè¯¥çº¿ç¨‹ç§°ä¸ºä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹åˆå¯ä»¥å¯åŠ¨æ–°çš„çº¿ç¨‹ï¼ŒPythonçš„threadingæ¨¡å—æœ‰ä¸ªcurrent_thread()å‡½æ•°ï¼Œå®ƒæ°¸è¿œè¿”å›å½“å‰çº¿ç¨‹çš„å®ä¾‹ã€‚ä¸»çº¿ç¨‹å®ä¾‹çš„åå­—å«MainThreadï¼Œå­çº¿ç¨‹çš„åå­—åœ¨åˆ›å»ºæ—¶æŒ‡å®šï¼Œæˆ‘ä»¬ç”¨LoopThreadå‘½åå­çº¿ç¨‹ã€‚åå­—ä»…ä»…åœ¨æ‰“å°æ—¶ç”¨æ¥æ˜¾ç¤ºï¼Œå®Œå…¨æ²¡æœ‰å…¶ä»–æ„ä¹‰ï¼Œå¦‚æœä¸èµ·åå­—Pythonå°±è‡ªåŠ¨ç»™çº¿ç¨‹å‘½åä¸ºThread-1ï¼ŒThread-2</p>
<h4 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h4><p>å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹æœ€å¤§çš„ä¸åŒåœ¨äºï¼Œå¤šè¿›ç¨‹ä¸­ï¼ŒåŒä¸€ä¸ªå˜é‡ï¼Œå„è‡ªæœ‰ä¸€ä»½æ‹·è´å­˜åœ¨äºæ¯ä¸ªè¿›ç¨‹ä¸­ï¼Œäº’ä¸å½±å“ï¼Œè€Œå¤šçº¿ç¨‹ä¸­ï¼Œæ‰€æœ‰å˜é‡éƒ½ç”±æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œæ‰€ä»¥ï¼Œä»»ä½•ä¸€ä¸ªå˜é‡éƒ½å¯ä»¥è¢«ä»»ä½•ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹ï¼Œå› æ­¤ï¼Œçº¿ç¨‹ä¹‹é—´å…±äº«æ•°æ®æœ€å¤§çš„å±é™©åœ¨äºå¤šä¸ªçº¿ç¨‹åŒæ—¶æ”¹ä¸€ä¸ªå˜é‡ï¼ŒæŠŠå†…å®¹ç»™æ”¹ä¹±äº†ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">balance = <span class="number">0</span></div><div class="line">lock = threading.Lock()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_thread</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>):</div><div class="line">        <span class="comment"># å…ˆè¦è·å–é”:</span></div><div class="line">        lock.acquire()</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            <span class="comment"># æ”¾å¿ƒåœ°æ”¹å§:</span></div><div class="line">            change_it(n)</div><div class="line">        <span class="keyword">finally</span>:</div><div class="line">            <span class="comment"># æ”¹å®Œäº†ä¸€å®šè¦é‡Šæ”¾é”:</span></div><div class="line">            lock.release()</div></pre></td></tr></table></figure></p>
<p>åˆ›å»ºä¸€ä¸ªé”å°±æ˜¯é€šè¿‡threading.Lock()æ¥å®ç°.å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œlock.acquire()æ—¶ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æˆåŠŸåœ°è·å–é”ï¼Œç„¶åç»§ç»­æ‰§è¡Œä»£ç ï¼Œå…¶ä»–çº¿ç¨‹å°±ç»§ç»­ç­‰å¾…ç›´åˆ°è·å¾—é”ä¸ºæ­¢ã€‚è·å¾—é”çš„çº¿ç¨‹ç”¨å®Œåä¸€å®šè¦é‡Šæ”¾é”ï¼Œå¦åˆ™é‚£äº›è‹¦è‹¦ç­‰å¾…é”çš„çº¿ç¨‹å°†æ°¸è¿œç­‰å¾…ä¸‹å»ï¼Œæˆä¸ºæ­»çº¿ç¨‹ã€‚æ‰€ä»¥æˆ‘ä»¬ç”¨tryâ€¦finallyæ¥ç¡®ä¿é”ä¸€å®šä¼šè¢«é‡Šæ”¾ã€‚</p>
<h3 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h3><p>ä¸€ä¸ªThreadLocalå˜é‡è™½ç„¶æ˜¯å…¨å±€å˜é‡ï¼Œä½†æ¯ä¸ªçº¿ç¨‹éƒ½åªèƒ½è¯»å†™è‡ªå·±çº¿ç¨‹çš„ç‹¬ç«‹å‰¯æœ¬ï¼Œäº’ä¸å¹²æ‰°ã€‚ThreadLocalè§£å†³äº†å‚æ•°åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å„ä¸ªå‡½æ•°ä¹‹é—´äº’ç›¸ä¼ é€’çš„é—®é¢˜ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> threading</div><div class="line"></div><div class="line"><span class="comment"># åˆ›å»ºå…¨å±€ThreadLocalå¯¹è±¡:</span></div><div class="line">local_school = threading.local()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_student</span><span class="params">()</span>:</span></div><div class="line">    <span class="comment"># è·å–å½“å‰çº¿ç¨‹å…³è”çš„student:</span></div><div class="line">    std = local_school.student</div><div class="line">    print(<span class="string">'Hello, %s (in %s)'</span> % (std, threading.current_thread().name))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_thread</span><span class="params">(name)</span>:</span></div><div class="line">    <span class="comment"># ç»‘å®šThreadLocalçš„student:</span></div><div class="line">    local_school.student = name</div><div class="line">    process_student()</div><div class="line"></div><div class="line">t1 = threading.Thread(target= process_thread, args=(<span class="string">'Alice'</span>,), name=<span class="string">'Thread-A'</span>)</div><div class="line">t2 = threading.Thread(target= process_thread, args=(<span class="string">'Bob'</span>,), name=<span class="string">'Thread-B'</span>)</div><div class="line">t1.start()</div><div class="line">t2.start()</div><div class="line">t1.join()</div><div class="line">t2.join()</div></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œç»“æœï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Hello, Alice (<span class="keyword">in</span> Thread-A)</div><div class="line">Hello, Bob (<span class="keyword">in</span> Thread-B)</div></pre></td></tr></table></figure>
<p>å…¨å±€å˜é‡local_schoolå°±æ˜¯ä¸€ä¸ªThreadLocalå¯¹è±¡ï¼Œæ¯ä¸ªThreadå¯¹å®ƒéƒ½å¯ä»¥è¯»å†™studentå±æ€§ï¼Œä½†äº’ä¸å½±å“ã€‚ä½ å¯ä»¥æŠŠlocal_schoolçœ‹æˆå…¨å±€å˜é‡ï¼Œä½†æ¯ä¸ªå±æ€§å¦‚local_school.studentéƒ½æ˜¯çº¿ç¨‹çš„å±€éƒ¨å˜é‡ï¼Œå¯ä»¥ä»»æ„è¯»å†™è€Œäº’ä¸å¹²æ‰°ï¼Œä¹Ÿä¸ç”¨ç®¡ç†é”çš„é—®é¢˜ï¼ŒThreadLocalå†…éƒ¨ä¼šå¤„ç†ã€‚</p>
<p>å¯ä»¥ç†è§£ä¸ºå…¨å±€å˜é‡local_schoolæ˜¯ä¸€ä¸ªdictï¼Œä¸ä½†å¯ä»¥ç”¨local_school.studentï¼Œè¿˜å¯ä»¥ç»‘å®šå…¶ä»–å˜é‡ï¼Œå¦‚local_school.teacherç­‰ç­‰ã€‚</p>
<p>ThreadLocalæœ€å¸¸ç”¨çš„åœ°æ–¹å°±æ˜¯ä¸ºæ¯ä¸ªçº¿ç¨‹ç»‘å®šä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼ŒHTTPè¯·æ±‚ï¼Œç”¨æˆ·èº«ä»½ä¿¡æ¯ç­‰ï¼Œè¿™æ ·ä¸€ä¸ªçº¿ç¨‹çš„æ‰€æœ‰è°ƒç”¨åˆ°çš„å¤„ç†å‡½æ•°éƒ½å¯ä»¥éå¸¸æ–¹ä¾¿åœ°è®¿é—®è¿™äº›èµ„æºã€‚</p>
<h3 id="åˆ†å¸ƒå¼è¿›ç¨‹"><a href="#åˆ†å¸ƒå¼è¿›ç¨‹" class="headerlink" title="åˆ†å¸ƒå¼è¿›ç¨‹"></a>åˆ†å¸ƒå¼è¿›ç¨‹</h3><p>ç”¨åˆ°å†çœ‹</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iosæ ¸å¿ƒåŠ¨ç”»]]></title>
      <url>http://zhang759740844.github.io/2016/08/16/ios%E5%8A%A8%E7%94%BB/</url>
      <content type="html"><![CDATA[<p>ä¾æ—§æ˜¯<a href="http://www.cnblogs.com/wendingding/tag/UIé«˜çº§/" target="_blank" rel="external">æ–‡é¡¶é¡¶çš„ioså¼€å‘UIç¯‡</a>å…³äºæ ¸å¿ƒåŠ¨ç”»çš„å†…å®¹ã€‚ä½œä¸ºå…¥é—¨</p>
<p><strong>æ ¸å¿ƒåŠ¨ç”»ä¸»è¦å°±æ˜¯æŒ‰ç…§è®¾å®šçš„è§„åˆ™(é‡å¤ï¼Œå»¶è¿Ÿï¼ŒæŒç»­æ—¶é—´ç­‰)ï¼Œæ“ä½œlayeræˆ–è€…viewçš„ä¸€äº›å±æ€§(position,bound,transformç­‰)ã€‚</strong></p>
<a id="more"></a>
<h2 id="æ ¸å¿ƒåŠ¨ç”»ç®€ä»‹"><a href="#æ ¸å¿ƒåŠ¨ç”»ç®€ä»‹" class="headerlink" title="æ ¸å¿ƒåŠ¨ç”»ç®€ä»‹"></a>æ ¸å¿ƒåŠ¨ç”»ç®€ä»‹</h2><p>CAAnimationæ˜¯æ‰€æœ‰åŠ¨ç”»ç±»çš„çˆ¶ç±»ï¼Œä½†æ˜¯å®ƒä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œèƒ½ç”¨çš„åŠ¨ç”»ç±»åªæœ‰4ä¸ªå­ç±»ï¼šCABasicAnimationã€CAKeyframeAnimationã€CATransitionã€CAAnimationGroupã€‚</p>
<p>CAPropertyAnimationæ˜¯CAAnimationçš„å­ç±»ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œè¦æƒ³åˆ›å»ºåŠ¨ç”»å¯¹è±¡ï¼Œåº”è¯¥ä½¿ç”¨å®ƒçš„ä¸¤ä¸ªå­ç±»ï¼šCABasicAnimationå’ŒCAKeyframeAnimation<br>å®ƒæœ‰ä¸ªNSStringç±»å‹çš„keyPathå±æ€§ï¼Œä½ å¯ä»¥æŒ‡å®šCALayerçš„æŸä¸ªå±æ€§åä¸ºkeyPathï¼Œå¹¶ä¸”å¯¹CALayerçš„è¿™ä¸ªå±æ€§çš„å€¼è¿›è¡Œä¿®æ”¹ï¼Œè¾¾åˆ°ç›¸åº”çš„åŠ¨ç”»æ•ˆæœã€‚æ¯”å¦‚ï¼ŒæŒ‡å®š@â€positionâ€ä¸ºkeyPathï¼Œå°±ä¼šä¿®æ”¹CALayerçš„positionå±æ€§çš„å€¼ï¼Œä»¥è¾¾åˆ°å¹³ç§»çš„åŠ¨ç”»æ•ˆæœ</p>
<p>å¸¸è§å±æ€§ï¼š</p>
<ul>
<li>durationï¼šåŠ¨ç”»çš„æŒç»­æ—¶é—´</li>
<li>repeatCountï¼šåŠ¨ç”»çš„é‡å¤æ¬¡æ•°</li>
<li>repeatDurationï¼šåŠ¨ç”»çš„é‡å¤æ—¶é—´</li>
<li>removedOnCompletionï¼šé»˜è®¤ä¸ºYESï¼Œä»£è¡¨åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åå°±ä»å›¾å±‚ä¸Šç§»é™¤ï¼Œå›¾å½¢ä¼šæ¢å¤åˆ°åŠ¨ç”»æ‰§è¡Œå‰çš„çŠ¶æ€ã€‚å¦‚æœæƒ³è®©å›¾å±‚ä¿æŒæ˜¾ç¤ºåŠ¨ç”»æ‰§è¡Œåçš„çŠ¶æ€ï¼Œé‚£å°±è®¾ç½®ä¸ºNOï¼Œä¸è¿‡è¿˜è¦è®¾ç½®fillModeä¸ºkCAFillModeForwards</li>
<li>fillModeï¼šå†³å®šå½“å‰å¯¹è±¡åœ¨éactiveæ—¶é—´æ®µçš„è¡Œä¸º.æ¯”å¦‚åŠ¨ç”»å¼€å§‹ä¹‹å‰,åŠ¨ç”»ç»“æŸä¹‹å</li>
<li>beginTimeï¼šå¯ä»¥ç”¨æ¥è®¾ç½®åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œæ—¶é—´ï¼Œè‹¥æƒ³å»¶è¿Ÿ2sï¼Œå°±è®¾ç½®ä¸ºCACurrentMediaTime()+2ï¼ŒCACurrentMediaTime()ä¸ºå›¾å±‚çš„å½“å‰æ—¶é—´</li>
<li>timingFunctionï¼šé€Ÿåº¦æ§åˆ¶å‡½æ•°ï¼Œæ§åˆ¶åŠ¨ç”»è¿è¡Œçš„èŠ‚å¥</li>
<li>delegateï¼šåŠ¨ç”»ä»£ç†</li>
</ul>
<h2 id="åŸºç¡€åŠ¨ç”»"><a href="#åŸºç¡€åŠ¨ç”»" class="headerlink" title="åŸºç¡€åŠ¨ç”»"></a>åŸºç¡€åŠ¨ç”»</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>CABasicAnimationï¼Œæ˜¯CApropertyAnimationçš„å­ç±»</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>fromValueï¼škeyPathç›¸åº”å±æ€§çš„åˆå§‹å€¼</li>
<li>toValueï¼škeyPathç›¸åº”å±æ€§çš„ç»“æŸå€¼</li>
</ul>
<p>éšç€åŠ¨ç”»çš„è¿›è¡Œï¼Œåœ¨é•¿åº¦ä¸ºdurationçš„æŒç»­æ—¶é—´å†…ï¼ŒkeyPathç›¸åº”å±æ€§çš„å€¼ä»fromValueæ¸æ¸åœ°å˜ä¸ºtoValue</p>
<p>å¦‚æœfillMode=kCAFillModeForwardså’ŒremovedOnComletion=NOï¼Œé‚£ä¹ˆåœ¨åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åï¼Œå›¾å±‚ä¼šä¿æŒæ˜¾ç¤ºåŠ¨ç”»æ‰§è¡Œåçš„çŠ¶æ€ã€‚ä½†<strong>åœ¨å®è´¨ä¸Šï¼Œå›¾å±‚çš„å±æ€§å€¼è¿˜æ˜¯åŠ¨ç”»æ‰§è¡Œå‰çš„åˆå§‹å€¼ï¼Œå¹¶æ²¡æœ‰çœŸæ­£è¢«æ”¹å˜ã€‚</strong>æ¯”å¦‚ï¼ŒCALayerçš„positionåˆå§‹å€¼ä¸º(0,0)ï¼ŒCABasicAnimationçš„fromValueä¸º(10,10)ï¼ŒtoValueä¸º(100,100)ï¼Œè™½ç„¶åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åå›¾å±‚ä¿æŒåœ¨(100,100)è¿™ä¸ªä½ç½®ï¼Œå®è´¨ä¸Šå›¾å±‚çš„positionè¿˜æ˜¯ä¸º(0,0)ã€‚</p>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"YYViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YYViewController</span> ()</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)<span class="built_in">CALayer</span> *myLayer;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YYViewController</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">    <span class="comment">//åˆ›å»ºlayer</span></div><div class="line">    <span class="built_in">CALayer</span> *myLayer=[<span class="built_in">CALayer</span> layer];</div><div class="line">    <span class="comment">//è®¾ç½®layerçš„å±æ€§</span></div><div class="line">    myLayer.bounds=<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>, <span class="number">80</span>);</div><div class="line">    myLayer.backgroundColor=[<span class="built_in">UIColor</span> yellowColor].CGColor;</div><div class="line">    myLayer.position=<span class="built_in">CGPointMake</span>(<span class="number">50</span>, <span class="number">50</span>);</div><div class="line">    myLayer.anchorPoint=<span class="built_in">CGPointMake</span>(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line">    myLayer.cornerRadius=<span class="number">20</span>;</div><div class="line">    <span class="comment">//æ·»åŠ layer</span></div><div class="line">    [<span class="keyword">self</span>.view.layer addSublayer:myLayer];</div><div class="line">    <span class="keyword">self</span>.myLayer=myLayer;</div><div class="line">&#125;</div><div class="line"><span class="comment">//è®¾ç½® å¹³ç§» åŠ¨ç”»</span></div><div class="line">-(<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">&#123;</div><div class="line">    <span class="comment">//1.åˆ›å»ºæ ¸å¿ƒåŠ¨ç”»</span></div><div class="line">    <span class="comment">//    CABasicAnimation *anima=[CABasicAnimation animationWithKeyPath:&lt;#(NSString *)#&gt;]</span></div><div class="line">    <span class="built_in">CABasicAnimation</span> *anima=[<span class="built_in">CABasicAnimation</span> animation];</div><div class="line">    </div><div class="line">    <span class="comment">//1.1å‘Šè¯‰ç³»ç»Ÿè¦æ‰§è¡Œä»€ä¹ˆæ ·çš„åŠ¨ç”»</span></div><div class="line">    anima.keyPath=<span class="string">@"position"</span>;</div><div class="line">    <span class="comment">//è®¾ç½®é€šè¿‡åŠ¨ç”»ï¼Œå°†layerä»å“ªå„¿ç§»åŠ¨åˆ°å“ªå„¿</span></div><div class="line">    anima.fromValue=[<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(<span class="number">0</span>, <span class="number">0</span>)];</div><div class="line">    anima.toValue=[<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(<span class="number">200</span>, <span class="number">300</span>)];</div><div class="line">    </div><div class="line">    <span class="comment">//1.2è®¾ç½®åŠ¨ç”»æ‰§è¡Œå®Œæ¯•ä¹‹åä¸åˆ é™¤åŠ¨ç”»</span></div><div class="line">    anima.removedOnCompletion=<span class="literal">NO</span>;</div><div class="line">    <span class="comment">//1.3è®¾ç½®ä¿å­˜åŠ¨ç”»çš„æœ€æ–°çŠ¶æ€</span></div><div class="line">    anima.fillMode=kCAFillModeForwards;</div><div class="line"></div><div class="line">    <span class="comment">//2.æ·»åŠ æ ¸å¿ƒåŠ¨ç”»åˆ°layer</span></div><div class="line">    [<span class="keyword">self</span>.myLayer addAnimation:anima forKey:<span class="literal">nil</span>];</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)animationDidStart:(<span class="built_in">CAAnimation</span> *)anim</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"å¼€å§‹æ‰§è¡ŒåŠ¨ç”»"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)animationDidStop:(<span class="built_in">CAAnimation</span> *)anim finished:(<span class="built_in">BOOL</span>)flag</div><div class="line">&#123;</div><div class="line">    <span class="comment">//åŠ¨ç”»æ‰§è¡Œå®Œæ¯•ï¼Œæ‰“å°æ‰§è¡Œå®Œæ¯•åçš„positionå€¼</span></div><div class="line">    <span class="built_in">NSString</span> *str=<span class="built_in">NSStringFromCGPoint</span>(<span class="keyword">self</span>.myLayer.position);</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æ‰§è¡Œåï¼š%@"</span>,str);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>å…¶ä¸­keypathçš„å€¼å†³å®šäº§ç”Ÿä»€ä¹ˆåŠ¨ç”»</p>
<ol>
<li>positionï¼šæ‰§è¡Œå¹³ç§»åŠ¨ç”»</li>
<li>boundsï¼šæ‰§è¡Œç¼©æ”¾åŠ¨ç”»</li>
<li>transformï¼šæ‰§è¡Œæ—‹è½¬åŠ¨ç”»</li>
</ol>
<h2 id="å…³é”®å¸§åŠ¨ç”»"><a href="#å…³é”®å¸§åŠ¨ç”»" class="headerlink" title="å…³é”®å¸§åŠ¨ç”»"></a>å…³é”®å¸§åŠ¨ç”»</h2><h3 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>CAKeyframeAnimationï¼Œæ˜¯CApropertyAnimationçš„å­ç±»ã€‚CABasicAnimationåªèƒ½ä»ä¸€ä¸ªæ•°å€¼(fromValue)å˜åˆ°å¦ä¸€ä¸ªæ•°å€¼(toValue)ï¼Œè€ŒCAKeyframeAnimationä¼šä½¿ç”¨ä¸€ä¸ªNSArrayä¿å­˜è¿™äº›æ•°å€¼</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>valuesï¼šå°±æ˜¯ä¸Šè¿°çš„NSArrayå¯¹è±¡ã€‚é‡Œé¢çš„å…ƒç´ ç§°ä¸ºâ€å…³é”®å¸§â€(keyframe)ã€‚åŠ¨ç”»å¯¹è±¡ä¼šåœ¨æŒ‡å®šçš„æ—¶é—´(duration)å†…ï¼Œä¾æ¬¡æ˜¾ç¤ºvaluesæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…³é”®å¸§</li>
<li>pathï¼šå¯ä»¥è®¾ç½®ä¸€ä¸ªCGPathRef\CGMutablePathRef,è®©å±‚è·Ÿç€è·¯å¾„ç§»åŠ¨ã€‚pathåªå¯¹CALayerçš„anchorPointå’Œpositionèµ·ä½œç”¨ã€‚å¦‚æœä½ è®¾ç½®äº†pathï¼Œé‚£ä¹ˆvalueså°†è¢«å¿½ç•¥</li>
<li>keyTimesï¼šå¯ä»¥ä¸ºå¯¹åº”çš„å…³é”®å¸§æŒ‡å®šå¯¹åº”çš„æ—¶é—´ç‚¹,å…¶å–å€¼èŒƒå›´ä¸º0åˆ°1.0,keyTimesä¸­çš„æ¯ä¸€ä¸ªæ—¶é—´å€¼éƒ½å¯¹åº”valuesä¸­çš„æ¯ä¸€å¸§.å½“keyTimesæ²¡æœ‰è®¾ç½®çš„æ—¶å€™,å„ä¸ªå…³é”®å¸§çš„æ—¶é—´æ˜¯å¹³åˆ†çš„</li>
</ul>
<p>è¯´æ˜ï¼šCABasicAnimationå¯çœ‹åšæ˜¯æœ€å¤šåªæœ‰2ä¸ªå…³é”®å¸§çš„CAKeyframeAnimation</p>
<h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><h4 id="ä½¿ç”¨value"><a href="#ä½¿ç”¨value" class="headerlink" title="ä½¿ç”¨value"></a>ä½¿ç”¨value</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"YYViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YYViewController</span> ()</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIView</span> *customView;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YYViewController</span></span></div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">&#123;</div><div class="line">    <span class="comment">//1.åˆ›å»ºæ ¸å¿ƒåŠ¨ç”»</span></div><div class="line">    <span class="built_in">CAKeyframeAnimation</span> *keyAnima=[<span class="built_in">CAKeyframeAnimation</span> animation];</div><div class="line">    <span class="comment">//å¹³ç§»</span></div><div class="line">    keyAnima.keyPath=<span class="string">@"position"</span>;</div><div class="line">    <span class="comment">//1.1å‘Šè¯‰ç³»ç»Ÿè¦æ‰§è¡Œä»€ä¹ˆåŠ¨ç”»</span></div><div class="line">    <span class="built_in">NSValue</span> *value1=[<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(<span class="number">100</span>, <span class="number">100</span>)];</div><div class="line">    <span class="built_in">NSValue</span> *value2=[<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(<span class="number">200</span>, <span class="number">100</span>)];</div><div class="line">    <span class="built_in">NSValue</span> *value3=[<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(<span class="number">200</span>, <span class="number">200</span>)];</div><div class="line">    <span class="built_in">NSValue</span> *value4=[<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(<span class="number">100</span>, <span class="number">200</span>)];</div><div class="line">    <span class="built_in">NSValue</span> *value5=[<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(<span class="number">100</span>, <span class="number">100</span>)];</div><div class="line">    keyAnima.values=@[value1,value2,value3,value4,value5];</div><div class="line">    <span class="comment">//1.2è®¾ç½®åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åï¼Œä¸åˆ é™¤åŠ¨ç”»</span></div><div class="line">    keyAnima.removedOnCompletion=<span class="literal">NO</span>;</div><div class="line">    <span class="comment">//1.3è®¾ç½®ä¿å­˜åŠ¨ç”»çš„æœ€æ–°çŠ¶æ€</span></div><div class="line">    keyAnima.fillMode=kCAFillModeForwards;</div><div class="line">    <span class="comment">//1.4è®¾ç½®åŠ¨ç”»æ‰§è¡Œçš„æ—¶é—´</span></div><div class="line">    keyAnima.duration=<span class="number">4.0</span>;</div><div class="line">    <span class="comment">//1.5è®¾ç½®åŠ¨ç”»çš„èŠ‚å¥</span></div><div class="line">    keyAnima.timingFunction=[<span class="built_in">CAMediaTimingFunction</span> functionWithName:kCAMediaTimingFunctionEaseInEaseOut];</div><div class="line">    </div><div class="line">    <span class="comment">//è®¾ç½®ä»£ç†ï¼Œå¼€å§‹â€”ç»“æŸ</span></div><div class="line">    keyAnima.delegate=<span class="keyword">self</span>;</div><div class="line">    <span class="comment">//2.æ·»åŠ æ ¸å¿ƒåŠ¨ç”»</span></div><div class="line">    [<span class="keyword">self</span>.customView.layer addAnimation:keyAnima forKey:<span class="literal">nil</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)animationDidStart:(<span class="built_in">CAAnimation</span> *)anim</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"å¼€å§‹åŠ¨ç”»"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)animationDidStop:(<span class="built_in">CAAnimation</span> *)anim finished:(<span class="built_in">BOOL</span>)flag</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ç»“æŸåŠ¨ç”»"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨path"><a href="#ä½¿ç”¨path" class="headerlink" title="ä½¿ç”¨path"></a>ä½¿ç”¨path</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"YYViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YYViewController</span> ()</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIView</span> *customView;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YYViewController</span></span></div><div class="line"></div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">&#123;</div><div class="line">    <span class="comment">//1.åˆ›å»ºæ ¸å¿ƒåŠ¨ç”»</span></div><div class="line">    <span class="built_in">CAKeyframeAnimation</span> *keyAnima=[<span class="built_in">CAKeyframeAnimation</span> animation];</div><div class="line">    <span class="comment">//å¹³ç§»</span></div><div class="line">    keyAnima.keyPath=<span class="string">@"position"</span>;</div><div class="line">    <span class="comment">//1.1å‘Šè¯‰ç³»ç»Ÿè¦æ‰§è¡Œä»€ä¹ˆåŠ¨ç”»</span></div><div class="line">    <span class="comment">//åˆ›å»ºä¸€æ¡è·¯å¾„</span></div><div class="line">    <span class="built_in">CGMutablePathRef</span> path=<span class="built_in">CGPathCreateMutable</span>();</div><div class="line">    <span class="comment">//è®¾ç½®ä¸€ä¸ªåœ†çš„è·¯å¾„</span></div><div class="line">    <span class="built_in">CGPathAddEllipseInRect</span>(path, <span class="literal">NULL</span>, <span class="built_in">CGRectMake</span>(<span class="number">150</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>));</div><div class="line">    keyAnima.path=path;</div><div class="line">    </div><div class="line">    <span class="comment">//æœ‰createå°±ä¸€å®šè¦æœ‰release</span></div><div class="line">    <span class="built_in">CGPathRelease</span>(path);</div><div class="line">    <span class="comment">//1.2è®¾ç½®åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åï¼Œä¸åˆ é™¤åŠ¨ç”»</span></div><div class="line">    keyAnima.removedOnCompletion=<span class="literal">NO</span>;</div><div class="line">    <span class="comment">//1.3è®¾ç½®ä¿å­˜åŠ¨ç”»çš„æœ€æ–°çŠ¶æ€</span></div><div class="line">    keyAnima.fillMode=kCAFillModeForwards;</div><div class="line">    <span class="comment">//1.4è®¾ç½®åŠ¨ç”»æ‰§è¡Œçš„æ—¶é—´</span></div><div class="line">    keyAnima.duration=<span class="number">5.0</span>;</div><div class="line">    <span class="comment">//1.5è®¾ç½®åŠ¨ç”»çš„èŠ‚å¥</span></div><div class="line">    keyAnima.timingFunction=[<span class="built_in">CAMediaTimingFunction</span> functionWithName:kCAMediaTimingFunctionEaseInEaseOut];</div><div class="line">    </div><div class="line">    <span class="comment">//è®¾ç½®ä»£ç†ï¼Œå¼€å§‹â€”ç»“æŸ</span></div><div class="line">    keyAnima.delegate=<span class="keyword">self</span>;</div><div class="line">    <span class="comment">//2.æ·»åŠ æ ¸å¿ƒåŠ¨ç”»</span></div><div class="line">    [<span class="keyword">self</span>.customView.layer addAnimation:keyAnima forKey:<span class="string">@"wendingding"</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">IBAction</span>)stopOnClick:(<span class="built_in">UIButton</span> *)sender &#123;</div><div class="line">    <span class="comment">//åœæ­¢self.customView.layerä¸Šåç§°æ ‡ç¤ºä¸ºwendingdingçš„åŠ¨ç”»</span></div><div class="line">    [<span class="keyword">self</span>.customView.layer removeAnimationForKey:<span class="string">@"wendingding"</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)animationDidStart:(<span class="built_in">CAAnimation</span> *)anim</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"å¼€å§‹åŠ¨ç”»"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)animationDidStop:(<span class="built_in">CAAnimation</span> *)anim finished:(<span class="built_in">BOOL</span>)flag</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ç»“æŸåŠ¨ç”»"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ç‚¹å‡»åœæ­¢åŠ¨ç”»ï¼Œç¨‹åºå†…éƒ¨ä¼šè°ƒç”¨  <code>[self.customView.layer removeAnimationForKey:@&quot;wendingding&quot;];</code>åœæ­¢<code>self.customView.layer</code>ä¸Šåç§°æ ‡ç¤ºä¸ºwendingdingçš„åŠ¨ç”»ã€‚</p>
<h4 id="å›¾æ ‡æŠ–åŠ¨"><a href="#å›¾æ ‡æŠ–åŠ¨" class="headerlink" title="å›¾æ ‡æŠ–åŠ¨"></a>å›¾æ ‡æŠ–åŠ¨</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"YYViewController.h"</span></span></div><div class="line"><span class="meta">#define angle2Radian(angle)  ((angle)/180.0*M_PI)</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YYViewController</span> ()</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIImageView</span> *iconView;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YYViewController</span></span></div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">&#123;</div><div class="line">    <span class="comment">//1.åˆ›å»ºæ ¸å¿ƒåŠ¨ç”»</span></div><div class="line">    <span class="built_in">CAKeyframeAnimation</span> *keyAnima=[<span class="built_in">CAKeyframeAnimation</span> animation];</div><div class="line">    keyAnima.keyPath=<span class="string">@"transform.rotation"</span>;</div><div class="line">    <span class="comment">//è®¾ç½®åŠ¨ç”»æ—¶é—´</span></div><div class="line">    keyAnima.duration=<span class="number">0.1</span>;</div><div class="line">    <span class="comment">//è®¾ç½®å›¾æ ‡æŠ–åŠ¨å¼§åº¦</span></div><div class="line">    <span class="comment">//æŠŠåº¦æ•°è½¬æ¢ä¸ºå¼§åº¦  åº¦æ•°/180*M_PI</span></div><div class="line">    keyAnima.values=@[@(-angle2Radian(<span class="number">4</span>)),@(angle2Radian(<span class="number">4</span>)),@(-angle2Radian(<span class="number">4</span>))];</div><div class="line">    <span class="comment">//è®¾ç½®åŠ¨ç”»çš„é‡å¤æ¬¡æ•°(è®¾ç½®ä¸ºæœ€å¤§å€¼)</span></div><div class="line">    keyAnima.repeatCount=MAXFLOAT;</div><div class="line">    </div><div class="line">    keyAnima.fillMode=kCAFillModeForwards;</div><div class="line">    keyAnima.removedOnCompletion=<span class="literal">NO</span>;</div><div class="line">    <span class="comment">//2.æ·»åŠ åŠ¨ç”»</span></div><div class="line">    [<span class="keyword">self</span>.iconView.layer addAnimation:keyAnima forKey:<span class="literal">nil</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>keyAnima.values=@[@(-angle2Radian(4)),@(angle2Radian(4)),@(-angle2Radian(4))];</code>è¡¨ç¤ºä»-angle2Radian(4)è½¬åˆ°angle2Radian(4)å†è½¬å›-angle2Radian(4))ã€‚</p>
<p><strong>@()è¡¨ç¤ºåˆå§‹åŒ–ocå¯¹è±¡ï¼Œå³å°†doubleè½¬æ¢ä¸ºocå¯¹è±¡ã€‚å› ä¸ºocçš„æ•°ç»„ä¸­ä¸å…è®¸å‡ºç°éocå¾—å¯¹è±¡</strong></p>
<h2 id="è½¬åœºåŠ¨ç”»å’Œç»„åŠ¨ç”»"><a href="#è½¬åœºåŠ¨ç”»å’Œç»„åŠ¨ç”»" class="headerlink" title="è½¬åœºåŠ¨ç”»å’Œç»„åŠ¨ç”»"></a>è½¬åœºåŠ¨ç”»å’Œç»„åŠ¨ç”»</h2><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>CATransitionç”¨äºåšè½¬åœºåŠ¨ç”»<br>å±æ€§ï¼š</p>
<ul>
<li>typeï¼šåŠ¨ç”»è¿‡æ¸¡ç±»å‹</li>
<li>subtypeï¼šåŠ¨ç”»è¿‡æ¸¡æ–¹å‘</li>
<li>startProgressï¼šåŠ¨ç”»èµ·ç‚¹(åœ¨æ•´ä½“åŠ¨ç”»çš„ç™¾åˆ†æ¯”)</li>
<li>endProgressï¼šåŠ¨ç”»ç»ˆç‚¹(åœ¨æ•´ä½“åŠ¨ç”»çš„ç™¾åˆ†æ¯”)</li>
</ul>
<h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"YYViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YYViewController</span> ()</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) <span class="keyword">int</span> index;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIImageView</span> *iconView;</div><div class="line"></div><div class="line">- (<span class="keyword">IBAction</span>)preOnClick:(<span class="built_in">UIButton</span> *)sender;</div><div class="line">- (<span class="keyword">IBAction</span>)nextOnClick:(<span class="built_in">UIButton</span> *)sender;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YYViewController</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    <span class="keyword">self</span>.index=<span class="number">1</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">IBAction</span>)preOnClick:(<span class="built_in">UIButton</span> *)sender &#123;</div><div class="line">    <span class="keyword">self</span>.index--;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.index&lt;<span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.index=<span class="number">7</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">self</span>.iconView.image=[<span class="built_in">UIImage</span> imageNamed: [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%d.jpg"</span>,<span class="keyword">self</span>.index]];</div><div class="line">    </div><div class="line">    <span class="comment">//åˆ›å»ºæ ¸å¿ƒåŠ¨ç”»</span></div><div class="line">    <span class="built_in">CATransition</span> *ca=[<span class="built_in">CATransition</span> animation];</div><div class="line">    <span class="comment">//å‘Šè¯‰è¦æ‰§è¡Œä»€ä¹ˆåŠ¨ç”»</span></div><div class="line">    <span class="comment">//è®¾ç½®è¿‡åº¦æ•ˆæœ</span></div><div class="line">    ca.type=<span class="string">@"cube"</span>;</div><div class="line">    <span class="comment">//è®¾ç½®åŠ¨ç”»çš„è¿‡åº¦æ–¹å‘ï¼ˆå‘å·¦ï¼‰</span></div><div class="line">    ca.subtype=kCATransitionFromLeft;</div><div class="line">    <span class="comment">//è®¾ç½®åŠ¨ç”»çš„æ—¶é—´</span></div><div class="line">    ca.duration=<span class="number">2.0</span>;</div><div class="line">    <span class="comment">//æ·»åŠ åŠ¨ç”»</span></div><div class="line">    [<span class="keyword">self</span>.iconView.layer addAnimation:ca forKey:<span class="literal">nil</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//ä¸‹ä¸€å¼ </span></div><div class="line">- (<span class="keyword">IBAction</span>)nextOnClick:(<span class="built_in">UIButton</span> *)sender &#123;</div><div class="line">    <span class="keyword">self</span>.index++;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.index&gt;<span class="number">7</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.index=<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">        <span class="keyword">self</span>.iconView.image=[<span class="built_in">UIImage</span> imageNamed: [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%d.jpg"</span>,<span class="keyword">self</span>.index]];</div><div class="line">    </div><div class="line">    <span class="comment">//1.åˆ›å»ºæ ¸å¿ƒåŠ¨ç”»</span></div><div class="line">    <span class="built_in">CATransition</span> *ca=[<span class="built_in">CATransition</span> animation];</div><div class="line">    </div><div class="line">    <span class="comment">//1.1å‘Šè¯‰è¦æ‰§è¡Œä»€ä¹ˆåŠ¨ç”»</span></div><div class="line">    <span class="comment">//1.2è®¾ç½®è¿‡åº¦æ•ˆæœ</span></div><div class="line">    ca.type=<span class="string">@"cube"</span>;</div><div class="line">    <span class="comment">//1.3è®¾ç½®åŠ¨ç”»çš„è¿‡åº¦æ–¹å‘ï¼ˆå‘å³ï¼‰</span></div><div class="line">    ca.subtype=kCATransitionFromRight;</div><div class="line">    <span class="comment">//1.4è®¾ç½®åŠ¨ç”»çš„æ—¶é—´</span></div><div class="line">    ca.duration=<span class="number">2.0</span>;</div><div class="line">    <span class="comment">//1.5è®¾ç½®åŠ¨ç”»çš„èµ·ç‚¹</span></div><div class="line">    ca.startProgress=<span class="number">0.5</span>;</div><div class="line">    <span class="comment">//1.6è®¾ç½®åŠ¨ç”»çš„ç»ˆç‚¹</span></div><div class="line"><span class="comment">//    ca.endProgress=0.5;</span></div><div class="line">    </div><div class="line">    <span class="comment">//2.æ·»åŠ åŠ¨ç”»</span></div><div class="line">    [<span class="keyword">self</span>.iconView.layer addAnimation:ca forKey:<span class="literal">nil</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h3 id="ç»„åŠ¨ç”»"><a href="#ç»„åŠ¨ç”»" class="headerlink" title="ç»„åŠ¨ç”»"></a>ç»„åŠ¨ç”»</h3><p>å°†CAAnimationGroupå¯¹è±¡åŠ å…¥å±‚åï¼Œç»„ä¸­æ‰€æœ‰åŠ¨ç”»å¯¹è±¡å¯ä»¥åŒæ—¶å¹¶å‘è¿è¡Œå±æ€§è§£æ.</p>
<h3 id="ç¤ºä¾‹-3"><a href="#ç¤ºä¾‹-3" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"YYViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YYViewController</span> ()</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIView</span> *iconView;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NJViewController</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event&#123;</div><div class="line">    <span class="comment">// å¹³ç§»åŠ¨ç”»</span></div><div class="line">    <span class="built_in">CABasicAnimation</span> *a1 = [<span class="built_in">CABasicAnimation</span> animation];</div><div class="line">    a1.keyPath = <span class="string">@"transform.translation.y"</span>;</div><div class="line">    a1.toValue = @(<span class="number">100</span>);</div><div class="line">    <span class="comment">// ç¼©æ”¾åŠ¨ç”»</span></div><div class="line">    <span class="built_in">CABasicAnimation</span> *a2 = [<span class="built_in">CABasicAnimation</span> animation];</div><div class="line">    a2.keyPath = <span class="string">@"transform.scale"</span>;</div><div class="line">    a2.toValue = @(<span class="number">0.0</span>);</div><div class="line">    <span class="comment">// æ—‹è½¬åŠ¨ç”»</span></div><div class="line">    <span class="built_in">CABasicAnimation</span> *a3 = [<span class="built_in">CABasicAnimation</span> animation];</div><div class="line">    a3.keyPath = <span class="string">@"transform.rotation"</span>;</div><div class="line">    a3.toValue = @(M_PI_2);</div><div class="line">    <span class="comment">// ç»„åŠ¨ç”»</span></div><div class="line">    <span class="built_in">CAAnimationGroup</span> *groupAnima = [<span class="built_in">CAAnimationGroup</span> animation];</div><div class="line">    </div><div class="line">    groupAnima.animations = @[a1, a2, a3];</div><div class="line">    </div><div class="line">    <span class="comment">//è®¾ç½®ç»„åŠ¨ç”»çš„æ—¶é—´</span></div><div class="line">    groupAnima.duration = <span class="number">2</span>;</div><div class="line">    groupAnima.fillMode = kCAFillModeForwards;</div><div class="line">    groupAnima.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line">    </div><div class="line">    [<span class="keyword">self</span>.iconView.layer addAnimation:groupAnima forKey:<span class="literal">nil</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h2 id="UIViewå°è£…åŠ¨ç”»"><a href="#UIViewå°è£…åŠ¨ç”»" class="headerlink" title="UIViewå°è£…åŠ¨ç”»"></a>UIViewå°è£…åŠ¨ç”»</h2><h3 id="UIViewåŠ¨ç”»ï¼ˆé¦–å°¾ï¼‰"><a href="#UIViewåŠ¨ç”»ï¼ˆé¦–å°¾ï¼‰" class="headerlink" title="UIViewåŠ¨ç”»ï¼ˆé¦–å°¾ï¼‰"></a>UIViewåŠ¨ç”»ï¼ˆé¦–å°¾ï¼‰</h3><h4 id="ç®€ä»‹-2"><a href="#ç®€ä»‹-2" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>æ‰§è¡ŒåŠ¨ç”»æ‰€éœ€è¦çš„å·¥ä½œç”±UIViewç±»è‡ªåŠ¨å®Œæˆï¼Œä½†ä»è¦åœ¨å¸Œæœ›æ‰§è¡ŒåŠ¨ç”»æ—¶é€šçŸ¥è§†å›¾ï¼Œä¸ºæ­¤éœ€è¦å°†æ”¹å˜å±æ€§çš„ä»£ç æ”¾åœ¨[UIView beginAnimations:nil context:nil]å’Œ[UIView commitAnimations]ä¹‹é—´ã€‚<br>å¸¸è§æ–¹æ³•ï¼š</p>
<ul>
<li><strong>+ (void)setAnimationDelegate:(id)delegate</strong>     è®¾ç½®åŠ¨ç”»ä»£ç†å¯¹è±¡ï¼Œå½“åŠ¨ç”»å¼€å§‹æˆ–è€…ç»“æŸæ—¶ä¼šå‘æ¶ˆæ¯ç»™ä»£ç†å¯¹è±¡</li>
<li><strong>+ (void)setAnimationWillStartSelector:(SEL)selector</strong>   å½“åŠ¨ç”»å³å°†å¼€å§‹æ—¶ï¼Œæ‰§è¡Œdelegateå¯¹è±¡çš„selectorï¼Œå¹¶ä¸”æŠŠbeginAnimations:context:ä¸­ä¼ å…¥çš„å‚æ•°ä¼ è¿›selector</li>
<li><strong>+ (void)setAnimationDidStopSelector:(SEL)selector</strong>  å½“åŠ¨ç”»ç»“æŸæ—¶ï¼Œæ‰§è¡Œdelegateå¯¹è±¡çš„selectorï¼Œå¹¶ä¸”æŠŠbeginAnimations:context:ä¸­ä¼ å…¥çš„å‚æ•°ä¼ è¿›selector</li>
<li><strong>+ (void)setAnimationDuration:(NSTimeInterval)duration</strong>   åŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼Œç§’ä¸ºå•ä½</li>
<li><strong>+ (void)setAnimationDelay:(NSTimeInterval)delay</strong>  åŠ¨ç”»å»¶è¿Ÿdelayç§’åå†å¼€å§‹</li>
<li><strong>+ (void)setAnimationStartDate:(NSDate *)startDate</strong>   åŠ¨ç”»çš„å¼€å§‹æ—¶é—´ï¼Œé»˜è®¤ä¸ºnow</li>
<li><strong>+ (void)setAnimationCurve:(UIViewAnimationCurve)curve</strong>  åŠ¨ç”»çš„èŠ‚å¥æ§åˆ¶</li>
<li><strong>+ (void)setAnimationRepeatCount:(float)repeatCount</strong>  åŠ¨ç”»çš„é‡å¤æ¬¡æ•°</li>
<li><strong>+ (void)setAnimationRepeatAutoreverses:(BOOL)repeatAutoreverses</strong>  å¦‚æœè®¾ç½®ä¸ºYES,ä»£è¡¨åŠ¨ç”»æ¯æ¬¡é‡å¤æ‰§è¡Œçš„æ•ˆæœä¼šè·Ÿä¸Šä¸€æ¬¡ç›¸å</li>
<li><strong>+ (void)setAnimationTransition:(UIViewAnimationTransition)transition forView:(UIView *)view cache:(BOOL)cache</strong>  è®¾ç½®è§†å›¾viewçš„è¿‡æ¸¡æ•ˆæœ, transitionæŒ‡å®šè¿‡æ¸¡ç±»å‹, cacheè®¾ç½®YESä»£è¡¨ä½¿ç”¨è§†å›¾ç¼“å­˜ï¼Œæ€§èƒ½è¾ƒå¥½</li>
</ul>
<h4 id="ç¤ºä¾‹-4"><a href="#ç¤ºä¾‹-4" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"YYViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YYViewController</span> ()</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIView</span> *customView;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YYViewController</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">&#123;</div><div class="line">    <span class="comment">//æ‰“å°åŠ¨ç”»å—çš„ä½ç½®</span></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"åŠ¨ç”»æ‰§è¡Œä¹‹å‰çš„ä½ç½®ï¼š%@"</span>,<span class="built_in">NSStringFromCGPoint</span>(<span class="keyword">self</span>.customView.center));</div><div class="line">    </div><div class="line">    <span class="comment">//é¦–å°¾å¼åŠ¨ç”»</span></div><div class="line">    [<span class="built_in">UIView</span> beginAnimations:<span class="literal">nil</span> context:<span class="literal">nil</span>];</div><div class="line">    <span class="comment">//æ‰§è¡ŒåŠ¨ç”»</span></div><div class="line">    <span class="comment">//è®¾ç½®åŠ¨ç”»æ‰§è¡Œæ—¶é—´</span></div><div class="line">    [<span class="built_in">UIView</span> setAnimationDuration:<span class="number">2.0</span>];</div><div class="line">    <span class="comment">//è®¾ç½®ä»£ç†</span></div><div class="line">    [<span class="built_in">UIView</span> setAnimationDelegate:<span class="keyword">self</span>];</div><div class="line">    <span class="comment">//è®¾ç½®åŠ¨ç”»æ‰§è¡Œå®Œæ¯•è°ƒç”¨çš„äº‹ä»¶</span></div><div class="line">    [<span class="built_in">UIView</span> setAnimationDidStopSelector:<span class="keyword">@selector</span>(didStopAnimation)];</div><div class="line">    <span class="keyword">self</span>.customView.center=<span class="built_in">CGPointMake</span>(<span class="number">200</span>, <span class="number">300</span>);</div><div class="line">    [<span class="built_in">UIView</span> commitAnimations];</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)didStopAnimation</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"åŠ¨ç”»æ‰§è¡Œå®Œæ¯•"</span>);</div><div class="line">    <span class="comment">//æ‰“å°åŠ¨ç”»å—çš„ä½ç½®</span></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"åŠ¨ç”»æ‰§è¡Œä¹‹åçš„ä½ç½®ï¼š%@"</span>,<span class="built_in">NSStringFromCGPoint</span>(<span class="keyword">self</span>.customView.center));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h4 id="UIViewå°è£…çš„åŠ¨ç”»ä¸CALayeråŠ¨ç”»çš„å¯¹æ¯”"><a href="#UIViewå°è£…çš„åŠ¨ç”»ä¸CALayeråŠ¨ç”»çš„å¯¹æ¯”" class="headerlink" title="UIViewå°è£…çš„åŠ¨ç”»ä¸CALayeråŠ¨ç”»çš„å¯¹æ¯”"></a>UIViewå°è£…çš„åŠ¨ç”»ä¸CALayeråŠ¨ç”»çš„å¯¹æ¯”</h4><p>ä½¿ç”¨UIViewå’ŒCALayeréƒ½èƒ½å®ç°åŠ¨ç”»æ•ˆæœï¼Œä½†æ˜¯åœ¨çœŸå®çš„å¼€å‘ä¸­ï¼Œä¸€èˆ¬è¿˜æ˜¯ä¸»è¦ä½¿ç”¨UIViewå°è£…çš„åŠ¨ç”»ï¼Œè€Œå¾ˆå°‘ä½¿ç”¨CALayerçš„åŠ¨ç”»ã€‚</p>
<p><strong>CALayeræ ¸å¿ƒåŠ¨ç”»ä¸UIViewåŠ¨ç”»çš„åŒºåˆ«</strong>ï¼š<br>UIViewå°è£…çš„åŠ¨ç”»ï¼Œæ”¹å˜<code>view</code>æˆ–è€…<code>layer</code>æ‰§è¡Œå®Œæ¯•ä¹‹åä¸ä¼šåå¼¹ã€‚å¦‚æœæ˜¯é€šè¿‡<strong>CALayeræ ¸å¿ƒåŠ¨ç”»</strong>æ”¹å˜<code>layer</code>çš„ä½ç½®çŠ¶æ€ï¼Œè¡¨é¢ä¸Šçœ‹è™½ç„¶å·²ç»æ”¹å˜äº†ï¼Œä½†æ˜¯å®é™…ä¸Šå®ƒçš„ä½ç½®æ˜¯æ²¡æœ‰æ”¹å˜çš„ã€‚</p>
<h3 id="blockåŠ¨ç”»"><a href="#blockåŠ¨ç”»" class="headerlink" title="blockåŠ¨ç”»"></a>blockåŠ¨ç”»</h3><h4 id="æ–¹æ³•ï¼š"><a href="#æ–¹æ³•ï¼š" class="headerlink" title="æ–¹æ³•ï¼š"></a>æ–¹æ³•ï¼š</h4><ul>
<li><strong>+(void)animateWithDuration:delay:options:animations:completion:</strong></li>
<li><strong>+(void)transitionWithView:duration:options:animations:completion:</strong></li>
<li><strong>+(void)transitionFromView:toView:duration:options:completion:</strong><br>å±æ€§ç®€ä»‹ï¼š</li>
</ul>
<ol>
<li>durationï¼šåŠ¨ç”»çš„æŒç»­æ—¶é—´</li>
<li>delayï¼šåŠ¨ç”»å»¶è¿Ÿdelayç§’åå¼€å§‹</li>
<li>optionsï¼šåŠ¨ç”»çš„èŠ‚å¥æ§åˆ¶/è½¬åœºåŠ¨ç”»çš„ç±»å‹(é‡å¤ï¼Œè½¬åœºç­‰)</li>
<li>animationsï¼šå°†æ”¹å˜è§†å›¾å±æ€§çš„ä»£ç æ”¾åœ¨è¿™ä¸ªblockä¸­</li>
<li>completionï¼šåŠ¨ç”»ç»“æŸåï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªblock</li>
</ol>
<p>å‰ä¸¤ä¸ªæ–¹æ³•ç”¨èµ·æ¥å¥½åƒæ²¡ä»€ä¹ˆåŒºåˆ«ã€‚</p>
<h4 id="ç¤ºä¾‹ï¼š"><a href="#ç¤ºä¾‹ï¼š" class="headerlink" title="ç¤ºä¾‹ï¼š"></a>ç¤ºä¾‹ï¼š</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">-(<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">&#123;</div><div class="line">    <span class="comment">//blockä»£ç å—åŠ¨ç”»</span></div><div class="line">        [<span class="built_in">UIView</span> transitionWithView:<span class="keyword">self</span>.customView duration:<span class="number">3.0</span> options:<span class="number">0</span> animations:^&#123;</div><div class="line">            <span class="comment">//æ‰§è¡Œçš„åŠ¨ç”»</span></div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"åŠ¨ç”»å¼€å§‹æ‰§è¡Œå‰çš„ä½ç½®ï¼š%@"</span>,<span class="built_in">NSStringFromCGPoint</span>(<span class="keyword">self</span>.customView.center));</div><div class="line">            <span class="keyword">self</span>.customView.center=<span class="built_in">CGPointMake</span>(<span class="number">200</span>, <span class="number">300</span>);</div><div class="line">        &#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</div><div class="line">            <span class="comment">//åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åçš„é¦–ä½æ“ä½œ</span></div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"åŠ¨ç”»æ‰§è¡Œå®Œæ¯•"</span>);</div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åçš„ä½ç½®ï¼š%@"</span>,<span class="built_in">NSStringFromCGPoint</span>( <span class="keyword">self</span>.customView.center));</div><div class="line">        &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Demoè¯¦è§CALayer_Transform</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 IOç¼–ç¨‹]]></title>
      <url>http://zhang759740844.github.io/2016/08/15/python_IO%E7%BC%96%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<h3 id="æ–‡ä»¶è¯»å†™"><a href="#æ–‡ä»¶è¯»å†™" class="headerlink" title="æ–‡ä»¶è¯»å†™"></a>æ–‡ä»¶è¯»å†™</h3><h4 id="è¯»æ–‡ä»¶"><a href="#è¯»æ–‡ä»¶" class="headerlink" title="è¯»æ–‡ä»¶"></a>è¯»æ–‡ä»¶</h4><p>ä½¿ç”¨Pythonå†…ç½®çš„open()å‡½æ•°ï¼Œä¼ å…¥æ–‡ä»¶åå’Œæ ‡ç¤ºç¬¦<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'/Users/test.txt'</span>, <span class="string">'r'</span>)</div></pre></td></tr></table></figure></p>
<p>æ ‡ç¤ºç¬¦â€™râ€™è¡¨ç¤ºè¯».</p>
<p>å¦‚æœæ–‡ä»¶æ‰“å¼€æˆåŠŸï¼Œæ¥ä¸‹æ¥ï¼Œè°ƒç”¨read()æ–¹æ³•å¯ä»¥ä¸€æ¬¡è¯»å–æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼ŒPythonæŠŠå†…å®¹è¯»åˆ°å†…å­˜ï¼Œç”¨ä¸€ä¸ªstrå¯¹è±¡è¡¨ç¤ºï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.read()</div><div class="line"><span class="string">'Hello, world!'</span></div></pre></td></tr></table></figure></p>
<p>æœ€åä¸€æ­¥æ˜¯è°ƒç”¨close()æ–¹æ³•å…³é—­æ–‡ä»¶ã€‚æ–‡ä»¶ä½¿ç”¨å®Œæ¯•åå¿…é¡»å…³é—­ï¼Œå› ä¸ºæ–‡ä»¶å¯¹è±¡ä¼šå ç”¨æ“ä½œç³»ç»Ÿçš„èµ„æºï¼Œå¹¶ä¸”æ“ä½œç³»ç»ŸåŒä¸€æ—¶é—´èƒ½æ‰“å¼€çš„æ–‡ä»¶æ•°é‡ä¹Ÿæ˜¯æœ‰é™çš„<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.close()</div></pre></td></tr></table></figure></p>
<p>ç”±äºæ–‡ä»¶è¯»å†™æ—¶éƒ½æœ‰å¯èƒ½äº§ç”ŸIOErrorï¼Œä¸€æ—¦å‡ºé”™ï¼Œåé¢çš„f.close()å°±ä¸ä¼šè°ƒç”¨ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ä¿è¯æ— è®ºæ˜¯å¦å‡ºé”™éƒ½èƒ½æ­£ç¡®åœ°å…³é—­æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨try â€¦ finallyæ¥å®ç°ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span>:</div><div class="line">    f = open(<span class="string">'/path/to/file'</span>, <span class="string">'r'</span>)</div><div class="line">    print(f.read())</div><div class="line"><span class="keyword">finally</span>:</div><div class="line">    <span class="keyword">if</span> f:</div><div class="line">        f.close()</div></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯æ¯æ¬¡éƒ½è¿™ä¹ˆå†™å®åœ¨å¤ªç¹çï¼Œæ‰€ä»¥ï¼ŒPythonå¼•å…¥äº†withè¯­å¥æ¥è‡ªåŠ¨å¸®æˆ‘ä»¬è°ƒç”¨close()æ–¹æ³•ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span> open(<span class="string">'/path/to/file'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line">    print(f.read())</div></pre></td></tr></table></figure></p>
<p>è¿™å’Œå‰é¢çš„try â€¦ finallyæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ä»£ç æ›´ä½³ç®€æ´ï¼Œå¹¶ä¸”ä¸å¿…è°ƒç”¨f.close()æ–¹æ³•ã€‚</p>
<p>è°ƒç”¨read()ä¼šä¸€æ¬¡æ€§è¯»å–æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶æœ‰10Gï¼Œå†…å­˜å°±çˆ†äº†ï¼Œæ‰€ä»¥ï¼Œè¦ä¿é™©èµ·è§ï¼Œå¯ä»¥åå¤è°ƒç”¨read(size)æ–¹æ³•ï¼Œæ¯æ¬¡æœ€å¤šè¯»å–sizeä¸ªå­—èŠ‚çš„å†…å®¹ã€‚å¦å¤–ï¼Œè°ƒç”¨readline()å¯ä»¥æ¯æ¬¡è¯»å–ä¸€è¡Œå†…å®¹ï¼Œè°ƒç”¨readlines()ä¸€æ¬¡è¯»å–æ‰€æœ‰å†…å®¹å¹¶æŒ‰è¡Œè¿”å›listã€‚å› æ­¤ï¼Œè¦æ ¹æ®éœ€è¦å†³å®šæ€ä¹ˆè°ƒç”¨ã€‚</p>
<p>å¦‚æœæ–‡ä»¶å¾ˆå°ï¼Œread()ä¸€æ¬¡æ€§è¯»å–æœ€æ–¹ä¾¿ï¼›å¦‚æœä¸èƒ½ç¡®å®šæ–‡ä»¶å¤§å°ï¼Œåå¤è°ƒç”¨read(size)æ¯”è¾ƒä¿é™©ï¼›å¦‚æœæ˜¯é…ç½®æ–‡ä»¶ï¼Œè°ƒç”¨readlines()æœ€æ–¹ä¾¿ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</div><div class="line">    print(line.strip()) <span class="comment"># æŠŠæœ«å°¾çš„'\n'åˆ æ‰</span></div></pre></td></tr></table></figure></p>
<h4 id="äºŒè¿›åˆ¶æ–‡ä»¶"><a href="#äºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="äºŒè¿›åˆ¶æ–‡ä»¶"></a>äºŒè¿›åˆ¶æ–‡ä»¶</h4><p>å‰é¢è®²çš„é»˜è®¤éƒ½æ˜¯è¯»å–æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶ä¸”æ˜¯UTF-8ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶ã€‚è¦è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ¯”å¦‚å›¾ç‰‡ã€è§†é¢‘ç­‰ç­‰ï¼Œç”¨â€™rbâ€™æ¨¡å¼æ‰“å¼€æ–‡ä»¶å³å¯ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'/Users/michael/test.jpg'</span>, <span class="string">'rb'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.read()</div><div class="line"><span class="string">b'\xff\xd8\xff\xe1\x00\x18Exif\x00\x00...'</span> <span class="comment"># åå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—èŠ‚</span></div></pre></td></tr></table></figure></p>
<h4 id="æ–‡ä»¶è¯»å†™-1"><a href="#æ–‡ä»¶è¯»å†™-1" class="headerlink" title="æ–‡ä»¶è¯»å†™"></a>æ–‡ä»¶è¯»å†™</h4><p>é˜…è¯»: 100273<br>è¯»å†™æ–‡ä»¶æ˜¯æœ€å¸¸è§çš„IOæ“ä½œã€‚Pythonå†…ç½®äº†è¯»å†™æ–‡ä»¶çš„å‡½æ•°ï¼Œç”¨æ³•å’ŒCæ˜¯å…¼å®¹çš„ã€‚</p>
<p>è¯»å†™æ–‡ä»¶å‰ï¼Œæˆ‘ä»¬å…ˆå¿…é¡»äº†è§£ä¸€ä¸‹ï¼Œåœ¨ç£ç›˜ä¸Šè¯»å†™æ–‡ä»¶çš„åŠŸèƒ½éƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿæä¾›çš„ï¼Œç°ä»£æ“ä½œç³»ç»Ÿä¸å…è®¸æ™®é€šçš„ç¨‹åºç›´æ¥æ“ä½œç£ç›˜ï¼Œæ‰€ä»¥ï¼Œè¯»å†™æ–‡ä»¶å°±æ˜¯è¯·æ±‚æ“ä½œç³»ç»Ÿæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼ˆé€šå¸¸ç§°ä¸ºæ–‡ä»¶æè¿°ç¬¦ï¼‰ï¼Œç„¶åï¼Œé€šè¿‡æ“ä½œç³»ç»Ÿæä¾›çš„æ¥å£ä»è¿™ä¸ªæ–‡ä»¶å¯¹è±¡ä¸­è¯»å–æ•°æ®ï¼ˆè¯»æ–‡ä»¶ï¼‰ï¼Œæˆ–è€…æŠŠæ•°æ®å†™å…¥è¿™ä¸ªæ–‡ä»¶å¯¹è±¡ï¼ˆå†™æ–‡ä»¶ï¼‰ã€‚</p>
<p>è¯»æ–‡ä»¶</p>
<p>è¦ä»¥è¯»æ–‡ä»¶çš„æ¨¡å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œä½¿ç”¨Pythonå†…ç½®çš„open()å‡½æ•°ï¼Œä¼ å…¥æ–‡ä»¶åå’Œæ ‡ç¤ºç¬¦ï¼š</p>
<blockquote>
<blockquote>
<blockquote>
<p>f = open(â€˜/Users/michael/test.txtâ€™, â€˜râ€™)<br>æ ‡ç¤ºç¬¦â€™râ€™è¡¨ç¤ºè¯»ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±æˆåŠŸåœ°æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ã€‚</p>
</blockquote>
</blockquote>
</blockquote>
<p>å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œopen()å‡½æ•°å°±ä¼šæŠ›å‡ºä¸€ä¸ªIOErrorçš„é”™è¯¯ï¼Œå¹¶ä¸”ç»™å‡ºé”™è¯¯ç å’Œè¯¦ç»†çš„ä¿¡æ¯å‘Šè¯‰ä½ æ–‡ä»¶ä¸å­˜åœ¨ï¼š</p>
<blockquote>
<blockquote>
<blockquote>
<p>f=open(â€˜/Users/michael/notfound.txtâ€™, â€˜râ€™)<br>Traceback (most recent call last):<br>  File â€œ<stdin>â€œ, line 1, in <module><br>FileNotFoundError: [Errno 2] No such file or directory: â€˜/Users/michael/notfound.txtâ€™<br>å¦‚æœæ–‡ä»¶æ‰“å¼€æˆåŠŸï¼Œæ¥ä¸‹æ¥ï¼Œè°ƒç”¨read()æ–¹æ³•å¯ä»¥ä¸€æ¬¡è¯»å–æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼ŒPythonæŠŠå†…å®¹è¯»åˆ°å†…å­˜ï¼Œç”¨ä¸€ä¸ªstrå¯¹è±¡è¡¨ç¤ºï¼š</module></stdin></p>
<p>f.read()<br>â€˜Hello, world!â€™<br>æœ€åä¸€æ­¥æ˜¯è°ƒç”¨close()æ–¹æ³•å…³é—­æ–‡ä»¶ã€‚æ–‡ä»¶ä½¿ç”¨å®Œæ¯•åå¿…é¡»å…³é—­ï¼Œå› ä¸ºæ–‡ä»¶å¯¹è±¡ä¼šå ç”¨æ“ä½œç³»ç»Ÿçš„èµ„æºï¼Œå¹¶ä¸”æ“ä½œç³»ç»ŸåŒä¸€æ—¶é—´èƒ½æ‰“å¼€çš„æ–‡ä»¶æ•°é‡ä¹Ÿæ˜¯æœ‰é™çš„ï¼š</p>
<p>f.close()<br>ç”±äºæ–‡ä»¶è¯»å†™æ—¶éƒ½æœ‰å¯èƒ½äº§ç”ŸIOErrorï¼Œä¸€æ—¦å‡ºé”™ï¼Œåé¢çš„f.close()å°±ä¸ä¼šè°ƒç”¨ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ä¿è¯æ— è®ºæ˜¯å¦å‡ºé”™éƒ½èƒ½æ­£ç¡®åœ°å…³é—­æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨try â€¦ finallyæ¥å®ç°ï¼š</p>
</blockquote>
</blockquote>
</blockquote>
<p>try:<br>    f = open(â€˜/path/to/fileâ€™, â€˜râ€™)<br>    print(f.read())<br>finally:<br>    if f:<br>        f.close()<br>ä½†æ˜¯æ¯æ¬¡éƒ½è¿™ä¹ˆå†™å®åœ¨å¤ªç¹çï¼Œæ‰€ä»¥ï¼ŒPythonå¼•å…¥äº†withè¯­å¥æ¥è‡ªåŠ¨å¸®æˆ‘ä»¬è°ƒç”¨close()æ–¹æ³•ï¼š</p>
<p>with open(â€˜/path/to/fileâ€™, â€˜râ€™) as f:<br>    print(f.read())<br>è¿™å’Œå‰é¢çš„try â€¦ finallyæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ä»£ç æ›´ä½³ç®€æ´ï¼Œå¹¶ä¸”ä¸å¿…è°ƒç”¨f.close()æ–¹æ³•ã€‚</p>
<p>è°ƒç”¨read()ä¼šä¸€æ¬¡æ€§è¯»å–æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶æœ‰10Gï¼Œå†…å­˜å°±çˆ†äº†ï¼Œæ‰€ä»¥ï¼Œè¦ä¿é™©èµ·è§ï¼Œå¯ä»¥åå¤è°ƒç”¨read(size)æ–¹æ³•ï¼Œæ¯æ¬¡æœ€å¤šè¯»å–sizeä¸ªå­—èŠ‚çš„å†…å®¹ã€‚å¦å¤–ï¼Œè°ƒç”¨readline()å¯ä»¥æ¯æ¬¡è¯»å–ä¸€è¡Œå†…å®¹ï¼Œè°ƒç”¨readlines()ä¸€æ¬¡è¯»å–æ‰€æœ‰å†…å®¹å¹¶æŒ‰è¡Œè¿”å›listã€‚å› æ­¤ï¼Œè¦æ ¹æ®éœ€è¦å†³å®šæ€ä¹ˆè°ƒç”¨ã€‚</p>
<p>å¦‚æœæ–‡ä»¶å¾ˆå°ï¼Œread()ä¸€æ¬¡æ€§è¯»å–æœ€æ–¹ä¾¿ï¼›å¦‚æœä¸èƒ½ç¡®å®šæ–‡ä»¶å¤§å°ï¼Œåå¤è°ƒç”¨read(size)æ¯”è¾ƒä¿é™©ï¼›å¦‚æœæ˜¯é…ç½®æ–‡ä»¶ï¼Œè°ƒç”¨readlines()æœ€æ–¹ä¾¿ï¼š</p>
<p>for line in f.readlines():<br>    print(line.strip()) # æŠŠæœ«å°¾çš„â€™\nâ€™åˆ æ‰<br>file-like Object</p>
<p>åƒopen()å‡½æ•°è¿”å›çš„è¿™ç§æœ‰ä¸ªread()æ–¹æ³•çš„å¯¹è±¡ï¼Œåœ¨Pythonä¸­ç»Ÿç§°ä¸ºfile-like Objectã€‚é™¤äº†fileå¤–ï¼Œè¿˜å¯ä»¥æ˜¯å†…å­˜çš„å­—èŠ‚æµï¼Œç½‘ç»œæµï¼Œè‡ªå®šä¹‰æµç­‰ç­‰ã€‚file-like Objectä¸è¦æ±‚ä»ç‰¹å®šç±»ç»§æ‰¿ï¼Œåªè¦å†™ä¸ªread()æ–¹æ³•å°±è¡Œã€‚</p>
<p>StringIOå°±æ˜¯åœ¨å†…å­˜ä¸­åˆ›å»ºçš„file-like Objectï¼Œå¸¸ç”¨ä½œä¸´æ—¶ç¼“å†²ã€‚</p>
<h4 id="äºŒè¿›åˆ¶æ–‡ä»¶-1"><a href="#äºŒè¿›åˆ¶æ–‡ä»¶-1" class="headerlink" title="äºŒè¿›åˆ¶æ–‡ä»¶"></a>äºŒè¿›åˆ¶æ–‡ä»¶</h4><p>å‰é¢è®²çš„é»˜è®¤éƒ½æ˜¯è¯»å–æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶ä¸”æ˜¯UTF-8ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶ã€‚è¦è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ¯”å¦‚å›¾ç‰‡ã€è§†é¢‘ç­‰ç­‰ï¼Œç”¨â€™rbâ€™æ¨¡å¼æ‰“å¼€æ–‡ä»¶å³å¯ï¼š</p>
<blockquote>
<blockquote>
<blockquote>
<p>f = open(â€˜/Users/michael/test.jpgâ€™, â€˜rbâ€™)<br>f.read()<br>bâ€™\xff\xd8\xff\xe1\x00\x18Exif\x00\x00â€¦â€™ # åå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—èŠ‚<br>å­—ç¬¦ç¼–ç </p>
</blockquote>
</blockquote>
</blockquote>
<h4 id="å­—ç¬¦ç¼–ç "><a href="#å­—ç¬¦ç¼–ç " class="headerlink" title="å­—ç¬¦ç¼–ç "></a>å­—ç¬¦ç¼–ç </h4><p>è¦è¯»å–éUTF-8ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶ï¼Œéœ€è¦ç»™open()å‡½æ•°ä¼ å…¥encodingå‚æ•°ï¼Œä¾‹å¦‚ï¼Œè¯»å–GBKç¼–ç çš„æ–‡ä»¶ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'/Users/michael/gbk.txt'</span>, <span class="string">'r'</span>, encoding=<span class="string">'gbk'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.read()</div><div class="line"><span class="string">'æµ‹è¯•'</span></div></pre></td></tr></table></figure></p>
<p>é‡åˆ°æœ‰äº›ç¼–ç ä¸è§„èŒƒçš„æ–‡ä»¶ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°UnicodeDecodeErrorï¼Œå› ä¸ºåœ¨æ–‡æœ¬æ–‡ä»¶ä¸­å¯èƒ½å¤¹æ‚äº†ä¸€äº›éæ³•ç¼–ç çš„å­—ç¬¦ã€‚é‡åˆ°è¿™ç§æƒ…å†µï¼Œopen()å‡½æ•°è¿˜æ¥æ”¶ä¸€ä¸ªerrorså‚æ•°ï¼Œè¡¨ç¤ºå¦‚æœé‡åˆ°ç¼–ç é”™è¯¯åå¦‚ä½•å¤„ç†ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥å¿½ç•¥ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'/Users/michael/gbk.txt'</span>, <span class="string">'r'</span>, encoding=<span class="string">'gbk'</span>, errors=<span class="string">'ignore'</span>)</div></pre></td></tr></table></figure></p>
<h4 id="å†™æ–‡ä»¶"><a href="#å†™æ–‡ä»¶" class="headerlink" title="å†™æ–‡ä»¶"></a>å†™æ–‡ä»¶</h4><p>å†™æ–‡ä»¶å’Œè¯»æ–‡ä»¶æ˜¯ä¸€æ ·çš„ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯è°ƒç”¨open()å‡½æ•°æ—¶ï¼Œä¼ å…¥æ ‡è¯†ç¬¦â€™wâ€™æˆ–è€…â€™wbâ€™è¡¨ç¤ºå†™æ–‡æœ¬æ–‡ä»¶æˆ–å†™äºŒè¿›åˆ¶æ–‡ä»¶ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'/Users/michael/test.txt'</span>, <span class="string">'w'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.write(<span class="string">'Hello, world!'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.close()</div></pre></td></tr></table></figure></p>
<p>ä½ å¯ä»¥åå¤è°ƒç”¨write()æ¥å†™å…¥æ–‡ä»¶ï¼Œä½†æ˜¯åŠ¡å¿…è¦è°ƒç”¨f.close()æ¥å…³é—­æ–‡ä»¶ã€‚å½“æˆ‘ä»¬å†™æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¾€å¾€ä¸ä¼šç«‹åˆ»æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯æ”¾åˆ°å†…å­˜ç¼“å­˜èµ·æ¥ï¼Œç©ºé—²çš„æ—¶å€™å†æ…¢æ…¢å†™å…¥ã€‚åªæœ‰è°ƒç”¨close()æ–¹æ³•æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰ä¿è¯æŠŠæ²¡æœ‰å†™å…¥çš„æ•°æ®å…¨éƒ¨å†™å…¥ç£ç›˜ã€‚å¿˜è®°è°ƒç”¨close()çš„åæœæ˜¯æ•°æ®å¯èƒ½åªå†™äº†ä¸€éƒ¨åˆ†åˆ°ç£ç›˜ï¼Œå‰©ä¸‹çš„ä¸¢å¤±äº†ã€‚æ‰€ä»¥ï¼Œè¿˜æ˜¯ç”¨withè¯­å¥æ¥å¾—ä¿é™©ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span> open(<span class="string">'/Users/michael/test.txt'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</div><div class="line">    f.write(<span class="string">'Hello, world!'</span>)</div></pre></td></tr></table></figure></p>
<h3 id="StringIOå’ŒBytesIO"><a href="#StringIOå’ŒBytesIO" class="headerlink" title="StringIOå’ŒBytesIO"></a>StringIOå’ŒBytesIO</h3><p>è¯»å–å†™å†…å®¹åˆ°å†…å­˜ä¸­ï¼Œä¸å†™äº†ã€‚ç”¨åˆ°å†çœ‹ã€‚</p>
<h3 id="æ“ä½œæ–‡ä»¶å’Œç›®å½•"><a href="#æ“ä½œæ–‡ä»¶å’Œç›®å½•" class="headerlink" title="æ“ä½œæ–‡ä»¶å’Œç›®å½•"></a>æ“ä½œæ–‡ä»¶å’Œç›®å½•</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</div><div class="line"><span class="comment"># æŸ¥çœ‹å½“å‰ç›®å½•çš„ç»å¯¹è·¯å¾„:</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.path.abspath(<span class="string">'.'</span>)</div><div class="line"><span class="string">'/Users/michael'</span></div><div class="line"><span class="comment"># åœ¨æŸä¸ªç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼Œé¦–å…ˆæŠŠæ–°ç›®å½•çš„å®Œæ•´è·¯å¾„è¡¨ç¤ºå‡ºæ¥:</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.path.join(<span class="string">'/Users/michael'</span>, <span class="string">'testdir'</span>)</div><div class="line"><span class="string">'/Users/michael/testdir'</span></div><div class="line"><span class="comment"># ç„¶ååˆ›å»ºä¸€ä¸ªç›®å½•:</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.mkdir(<span class="string">'/Users/michael/testdir'</span>)</div><div class="line"><span class="comment"># åˆ æ‰ä¸€ä¸ªç›®å½•:</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.rmdir(<span class="string">'/Users/michael/testdir'</span>)</div></pre></td></tr></table></figure>
<p>æŠŠä¸¤ä¸ªè·¯å¾„åˆæˆä¸€ä¸ªæ—¶ï¼Œä¸è¦ç›´æ¥æ‹¼å­—ç¬¦ä¸²ï¼Œè€Œè¦é€šè¿‡os.path.join()å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æ­£ç¡®å¤„ç†ä¸åŒæ“ä½œç³»ç»Ÿçš„è·¯å¾„åˆ†éš”ç¬¦ã€‚<br>åŒæ ·çš„é“ç†ï¼Œè¦æ‹†åˆ†è·¯å¾„æ—¶ï¼Œä¹Ÿä¸è¦ç›´æ¥å»æ‹†å­—ç¬¦ä¸²ï¼Œè€Œè¦é€šè¿‡os.path.split()å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æŠŠä¸€ä¸ªè·¯å¾„æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåä¸€éƒ¨åˆ†æ€»æ˜¯æœ€åçº§åˆ«çš„ç›®å½•æˆ–æ–‡ä»¶åï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.path.split(<span class="string">'/Users/michael/testdir/file.txt'</span>)</div><div class="line">(<span class="string">'/Users/michael/testdir'</span>, <span class="string">'file.txt'</span>)</div></pre></td></tr></table></figure></p>
<p>æ–‡ä»¶æ“ä½œ<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># å¯¹æ–‡ä»¶é‡å‘½å:</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.rename(<span class="string">'test.txt'</span>, <span class="string">'test.py'</span>)</div><div class="line"><span class="comment"># åˆ æ‰æ–‡ä»¶:</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.remove(<span class="string">'test.py'</span>)</div></pre></td></tr></table></figure></p>
<h3 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h3><p>æˆ‘ä»¬æŠŠå˜é‡ä»å†…å­˜ä¸­å˜æˆå¯å­˜å‚¨æˆ–ä¼ è¾“çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºåºåˆ—åŒ–ï¼Œåœ¨Pythonä¸­å«picklingã€‚<br>åºåˆ—åŒ–ä¹‹åï¼Œå°±å¯ä»¥æŠŠåºåˆ—åŒ–åçš„å†…å®¹å†™å…¥ç£ç›˜ï¼Œæˆ–è€…é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°åˆ«çš„æœºå™¨ä¸Šã€‚<br>åè¿‡æ¥ï¼ŒæŠŠå˜é‡å†…å®¹ä»åºåˆ—åŒ–çš„å¯¹è±¡é‡æ–°è¯»åˆ°å†…å­˜é‡Œç§°ä¹‹ä¸ºååºåˆ—åŒ–ï¼Œå³unpicklingã€‚</p>
<p>Pythonæä¾›äº†pickleæ¨¡å—æ¥å®ç°åºåˆ—åŒ–ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pickle</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d = dict(name=<span class="string">'Bob'</span>, age=<span class="number">20</span>, score=<span class="number">88</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'dump.txt'</span>, <span class="string">'wb'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>pickle.dump(d, f)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.close()</div></pre></td></tr></table></figure></p>
<p>pickle.dumps()æ–¹æ³•æŠŠä»»æ„å¯¹è±¡åºåˆ—åŒ–æˆä¸€ä¸ªbytesï¼Œç„¶åï¼Œå°±å¯ä»¥æŠŠè¿™ä¸ªbyteså†™å…¥æ–‡ä»¶ã€‚æˆ–è€…ç”¨å¦ä¸€ä¸ªæ–¹æ³•pickle.dump()ç›´æ¥æŠŠå¯¹è±¡åºåˆ—åŒ–åå†™å…¥ä¸€ä¸ªfile-like Object.<br>å½“æˆ‘ä»¬è¦æŠŠå¯¹è±¡ä»ç£ç›˜è¯»åˆ°å†…å­˜æ—¶ï¼Œå¯ä»¥å…ˆæŠŠå†…å®¹è¯»åˆ°ä¸€ä¸ªbytesï¼Œç„¶åç”¨pickle.loads()æ–¹æ³•ååºåˆ—åŒ–å‡ºå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨pickle.load()æ–¹æ³•ä»ä¸€ä¸ªfile-like Objectä¸­ç›´æ¥ååºåˆ—åŒ–å‡ºå¯¹è±¡:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = open(<span class="string">'dump.txt'</span>, <span class="string">'rb'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d = pickle.load(f)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.close()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d</div><div class="line">&#123;<span class="string">'age'</span>: <span class="number">20</span>, <span class="string">'score'</span>: <span class="number">88</span>, <span class="string">'name'</span>: <span class="string">'Bob'</span>&#125;</div></pre></td></tr></table></figure></p>
<h3 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h3><p>Pythonå†…ç½®çš„jsonæ¨¡å—æä¾›äº†éå¸¸å®Œå–„çš„Pythonå¯¹è±¡åˆ°JSONæ ¼å¼çš„è½¬æ¢ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> json</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d = dict(name=<span class="string">'Bob'</span>, age=<span class="number">20</span>, score=<span class="number">88</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>json.dumps(d)</div><div class="line"><span class="string">'&#123;"age": 20, "score": 88, "name": "Bob"&#125;'</span></div></pre></td></tr></table></figure></p>
<p>dumps()æ–¹æ³•è¿”å›ä¸€ä¸ªstrï¼Œå†…å®¹å°±æ˜¯æ ‡å‡†çš„JSONã€‚ç±»ä¼¼çš„ï¼Œdump()æ–¹æ³•å¯ä»¥ç›´æ¥æŠŠJSONå†™å…¥ä¸€ä¸ªfile-like Objectã€‚</p>
<p>è¦æŠŠJSONååºåˆ—åŒ–ä¸ºPythonå¯¹è±¡ï¼Œç”¨loads()æˆ–è€…å¯¹åº”çš„load()æ–¹æ³•ï¼Œå‰è€…æŠŠJSONçš„å­—ç¬¦ä¸²ååºåˆ—åŒ–ï¼Œåè€…ä»file-like Objectä¸­è¯»å–å­—ç¬¦ä¸²å¹¶ååºåˆ—åŒ–ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>json_str = <span class="string">'&#123;"age": 20, "score": 88, "name": "Bob"&#125;'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>json.loads(json_str)</div><div class="line">&#123;<span class="string">'age'</span>: <span class="number">20</span>, <span class="string">'score'</span>: <span class="number">88</span>, <span class="string">'name'</span>: <span class="string">'Bob'</span>&#125;</div></pre></td></tr></table></figure></p>
<p>æœ€åå†æ¬¡æ„Ÿè°¢å»–è€å¸ˆçš„è¾›å‹¤åŠ³åŠ¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[CALayerå­¦ä¹ å°ç»“]]></title>
      <url>http://zhang759740844.github.io/2016/08/12/CALayer%E5%AD%A6%E4%B9%A0%E5%B0%8F%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>è¿™ä¸¤å¤©æƒ³å¤§è‡´å­¦ä¹ ä¸‹animationçš„ä½¿ç”¨æ–¹æ³•ã€‚çœ‹äº†<a href="http://www.cnblogs.com/wendingding/tag/UIé«˜çº§/" target="_blank" rel="external">æ–‡é¡¶é¡¶çš„ioså¼€å‘UIç¯‡</a>ä¸“é¢˜ï¼Œå†™çš„å¾ˆå¥½ï¼Œå­¦ä¹ äº†å¾ˆå¤šã€‚å†æ‘˜å½•éƒ¨åˆ†ï¼Œä»¥ä½œå¤‡å¿˜ã€‚</p>
<a id="more"></a>
<h2 id="CALayerç®€ä»‹"><a href="#CALayerç®€ä»‹" class="headerlink" title="CALayerç®€ä»‹"></a>CALayerç®€ä»‹</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>UIViewä¹‹æ‰€ä»¥èƒ½æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œå› ä¸ºå†…éƒ¨çš„layerã€‚åˆ›å»ºUIViewçš„æ—¶å€™è‡ªåŠ¨åˆ›å»ºCALayerå¯¹è±¡ã€‚<br>å½“UIViewéœ€è¦æ˜¾ç¤ºåˆ°å±å¹•ä¸Šæ—¶ï¼Œä¼šè°ƒç”¨drawRect:æ–¹æ³•è¿›è¡Œç»˜å›¾ï¼Œå¹¶ä¸”ä¼šå°†æ‰€æœ‰å†…å®¹ç»˜åˆ¶åœ¨è‡ªå·±çš„å›¾å±‚ä¸Šï¼Œç»˜å›¾å®Œæ¯•åï¼Œç³»ç»Ÿä¼šå°†å›¾å±‚æ‹·è´åˆ°å±å¹•ä¸Šï¼Œäºæ˜¯å°±å®Œæˆäº†UIViewçš„æ˜¾ç¤ºã€‚<br>UIViewæœ¬èº«ä¸å…·å¤‡æ˜¾ç¤ºçš„åŠŸèƒ½ï¼Œæ‹¥æœ‰æ˜¾ç¤ºåŠŸèƒ½çš„æ˜¯å®ƒå†…éƒ¨çš„å›¾å±‚ã€‚</p>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>é€šè¿‡æ“ä½œè¿™ä¸ªCALayerå¯¹è±¡ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è°ƒæ•´UIViewçš„ä¸€äº›ç•Œé¢å±æ€§ï¼Œæ¯”å¦‚ï¼šé˜´å½±ã€åœ†è§’å¤§å°ã€è¾¹æ¡†å®½åº¦å’Œé¢œè‰²ç­‰ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®è¾¹æ¡†çš„å®½åº¦ä¸º20</span></div><div class="line"><span class="keyword">self</span>.customView.layer.borderWidth=<span class="number">20</span>;</div><div class="line"><span class="comment">//è®¾ç½®è¾¹æ¡†çš„é¢œè‰²(borderColoræ˜¯CGColorç±»å‹)</span></div><div class="line"><span class="keyword">self</span>.customView.layer.borderColor=[<span class="built_in">UIColor</span> greenColor].CGColor;</div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®layerçš„åœ†è§’</span></div><div class="line"><span class="keyword">self</span>.customView.layer.cornerRadius=<span class="number">20</span>;</div><div class="line"><span class="comment">//è®¾ç½®è¶…è¿‡å­å›¾å±‚çš„éƒ¨åˆ†è£å‡æ‰</span></div><div class="line"><span class="keyword">self</span>.iconView.layer.masksToBounds=<span class="literal">YES</span>;</div><div class="line"></div><div class="line"><span class="comment">//åœ¨viewçš„å›¾å±‚ä¸Šæ·»åŠ ä¸€ä¸ªimageï¼Œcontentsè¡¨ç¤ºæ¥å—å†…å®¹</span></div><div class="line"><span class="keyword">self</span>.customView.layer.contents=(<span class="keyword">id</span>)[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"cat"</span>].CGImage;</div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®é˜´å½±çš„é¢œè‰²</span></div><div class="line"><span class="keyword">self</span>.customView.layer.shadowColor=[<span class="built_in">UIColor</span> blackColor].CGColor;</div><div class="line"><span class="comment">//è®¾ç½®é˜´å½±çš„åç§»é‡ï¼Œå¦‚æœä¸ºæ­£æ•°ï¼Œåˆ™ä»£è¡¨ä¸ºå¾€å³è¾¹åç§»</span></div><div class="line"><span class="keyword">self</span>.customView.layer.shadowOffset=<span class="built_in">CGSizeMake</span>(<span class="number">15</span>, <span class="number">5</span>);</div><div class="line"><span class="comment">//è®¾ç½®é˜´å½±çš„é€æ˜åº¦(0~1ä¹‹é—´ï¼Œ0è¡¨ç¤ºå®Œå…¨é€æ˜)</span></div><div class="line"><span class="keyword">self</span>.customView.layer.shadowOpacity=<span class="number">0.6</span>;</div><div class="line"></div><div class="line"><span class="comment">//é€šè¿‡uiviewè®¾ç½®ï¼ˆ2Dæ•ˆæœï¼‰</span></div><div class="line"><span class="keyword">self</span>.customView.transform=<span class="built_in">CGAffineTransformMakeTranslation</span>(<span class="number">0</span>, <span class="number">-100</span>);</div><div class="line"><span class="comment">//é€šè¿‡layeræ¥è®¾ç½®ï¼ˆ3Dæ•ˆæœ,xï¼Œyï¼Œzä¸‰ä¸ªæ–¹å‘ï¼‰</span></div><div class="line"><span class="keyword">self</span>.iconView.layer.transform=<span class="built_in">CATransform3DMakeTranslation</span>(<span class="number">100</span>, <span class="number">20</span>, <span class="number">0</span>);</div><div class="line"><span class="comment">//æ—‹è½¬</span></div><div class="line"><span class="keyword">self</span>.iconView.layer.transform=<span class="built_in">CATransform3DMakeRotation</span>(M_PI_4, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0.5</span>);</div></pre></td></tr></table></figure></p>
<h2 id="åˆ›å»ºå›¾å±‚"><a href="#åˆ›å»ºå›¾å±‚" class="headerlink" title="åˆ›å»ºå›¾å±‚"></a>åˆ›å»ºå›¾å±‚</h2><h3 id="åŸºæœ¬æ–¹æ³•"><a href="#åŸºæœ¬æ–¹æ³•" class="headerlink" title="åŸºæœ¬æ–¹æ³•"></a>åŸºæœ¬æ–¹æ³•</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    <span class="comment">//åˆ›å»ºä¸€ä¸ªlayer</span></div><div class="line">    <span class="built_in">CALayer</span> *Mylayer=[<span class="built_in">CALayer</span> layer];</div><div class="line">    <span class="comment">//è®¾ç½®layerçš„å±æ€§</span></div><div class="line">    Mylayer.bounds=<span class="built_in">CGRectMake</span>(<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>);</div><div class="line">    Mylayer.position=<span class="built_in">CGPointMake</span>(<span class="number">100</span>, <span class="number">100</span>);</div><div class="line">    </div><div class="line">    <span class="comment">//è®¾ç½®éœ€è¦æ˜¾ç¤ºçš„å›¾ç‰‡</span></div><div class="line">    Mylayer.contents=(<span class="keyword">id</span>)[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"me"</span>].CGImage;</div><div class="line">    <span class="comment">//è®¾ç½®åœ†è§’åŠå¾„ä¸º10</span></div><div class="line">    Mylayer.cornerRadius=<span class="number">10</span>;</div><div class="line">    <span class="comment">//å¦‚æœè®¾ç½®äº†å›¾ç‰‡ï¼Œé‚£ä¹ˆéœ€è¦è®¾ç½®è¿™ä¸ªå±æ€§ä¸ºYESæ‰èƒ½æ˜¾ç¤ºåœ†è§’æ•ˆæœ</span></div><div class="line">    Mylayer.masksToBounds=<span class="literal">YES</span>;</div><div class="line">    <span class="comment">//è®¾ç½®è¾¹æ¡†</span></div><div class="line">    Mylayer.borderWidth=<span class="number">3</span>;</div><div class="line">    Mylayer.borderColor=[<span class="built_in">UIColor</span> brownColor].CGColor;</div><div class="line">    </div><div class="line">    <span class="comment">//æŠŠlayeræ·»åŠ åˆ°ç•Œé¢ä¸Š</span></div><div class="line">    [<span class="keyword">self</span>.view.layer addSublayer:Mylayer];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¯¹æ¯”CALayerï¼ŒUIViewå¤šäº†ä¸€ä¸ªäº‹ä»¶å¤„ç†çš„åŠŸèƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒCALayerä¸èƒ½å¤„ç†ç”¨æˆ·çš„è§¦æ‘¸äº‹ä»¶ï¼Œè€ŒUIViewå¯ä»¥ã€‚<br>å¦‚æœæ˜¾ç¤ºå‡ºæ¥çš„ä¸œè¥¿éœ€è¦è·Ÿç”¨æˆ·è¿›è¡Œäº¤äº’çš„è¯ï¼Œç”¨UIViewï¼›å¦‚æœä¸éœ€è¦è·Ÿç”¨æˆ·è¿›è¡Œäº¤äº’ï¼Œç”¨UIViewæˆ–è€…CALayeréƒ½å¯ä»¥</p>
<h2 id="CAlayerå±æ€§"><a href="#CAlayerå±æ€§" class="headerlink" title="CAlayerå±æ€§"></a>CAlayerå±æ€§</h2><h3 id="positionå’ŒanchorPoint"><a href="#positionå’ŒanchorPoint" class="headerlink" title="positionå’ŒanchorPoint"></a>positionå’ŒanchorPoint</h3><ul>
<li>position:è®¾ç½®CALayeråœ¨çˆ¶å±‚ä¸­çš„ä½ç½®ï¼Œè¿™ä¸ªä½ç½®è¦å’Œé”šç‚¹é‡åˆã€‚</li>
<li>anchorPoint:å†³å®šç€CALayerèº«ä¸Šçš„å“ªä¸ªç‚¹ä¼šåœ¨positionå±æ€§æ‰€æŒ‡çš„ä½ç½®ã€‚ä»¥è‡ªå·±çš„å·¦ä¸Šè§’ä¸ºåŸç‚¹(0, 0)ï¼Œå®ƒçš„xã€yå–å€¼èŒƒå›´éƒ½æ˜¯0~1ï¼Œ<strong>é»˜è®¤å€¼ä¸ºï¼ˆ0.5, 0.5ï¼‰</strong></li>
</ul>
<h3 id="éšå¼åŠ¨ç”»"><a href="#éšå¼åŠ¨ç”»" class="headerlink" title="éšå¼åŠ¨ç”»"></a>éšå¼åŠ¨ç”»</h3><p>æ¯ä¸ªViewå†…éƒ¨éƒ½å…³è”ç€ä¸€ä¸ªRoot Layerã€‚æ‰€æœ‰érootlayeréƒ½å­˜åœ¨ç€éšå¼åŠ¨ç”»ã€‚éšå¼åŠ¨ç”»å°±æ˜¯å¯¹äºlayerçš„éƒ¨åˆ†å±æ€§è¿›è¡Œä¿®æ”¹æ—¶ï¼Œé»˜è®¤ä¼šäº§ç”Ÿçš„ä¸€äº›åŠ¨ç”»ã€‚</p>
<p>å¸¸è§çš„åŠ¨ç”»å±æ€§ï¼š</p>
<ul>
<li>boundsï¼šç”¨äºè®¾ç½®CALayerçš„å®½åº¦å’Œé«˜åº¦ã€‚ä¿®æ”¹è¿™ä¸ªå±æ€§ä¼šäº§ç”Ÿç¼©æ”¾åŠ¨ç”»</li>
<li>backgroundColorï¼šç”¨äºè®¾ç½®CALayerçš„èƒŒæ™¯è‰²ã€‚ä¿®æ”¹è¿™ä¸ªå±æ€§ä¼šäº§ç”ŸèƒŒæ™¯è‰²çš„æ¸å˜åŠ¨ç”»</li>
<li>positionï¼šç”¨äºè®¾ç½®CALayerçš„ä½ç½®ã€‚ä¿®æ”¹è¿™ä¸ªå±æ€§ä¼šäº§ç”Ÿå¹³ç§»åŠ¨ç”»</li>
</ul>
<h2 id="è‡ªå®šä¹‰layer"><a href="#è‡ªå®šä¹‰layer" class="headerlink" title="è‡ªå®šä¹‰layer"></a>è‡ªå®šä¹‰layer</h2><h3 id="ç¬¬ä¸€ç§æ–¹å¼ï¼šæ–°å»ºlayerç±»"><a href="#ç¬¬ä¸€ç§æ–¹å¼ï¼šæ–°å»ºlayerç±»" class="headerlink" title="ç¬¬ä¸€ç§æ–¹å¼ï¼šæ–°å»ºlayerç±»"></a>ç¬¬ä¸€ç§æ–¹å¼ï¼šæ–°å»ºlayerç±»</h3><p>æƒ³è¦åœ¨viewä¸­ç”»ä¸œè¥¿ï¼Œéœ€è¦è‡ªå®šä¹‰view,åˆ›å»ºä¸€ä¸ªç±»ä¸ä¹‹å…³è”ï¼Œè®©è¿™ä¸ªç±»ç»§æ‰¿è‡ªUIViewï¼Œç„¶åé‡å†™å®ƒçš„DrawRectï¼šæ–¹æ³•ï¼Œç„¶ååœ¨è¯¥æ–¹æ³•ä¸­ç”»å›¾ã€‚</p>
<p>å¦‚æœåœ¨layerä¸Šç”»ä¸œè¥¿ï¼Œä¸ä¸Šé¢çš„è¿‡ç¨‹ç±»ä¼¼ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"YYMylayer.h"</span></span></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YYMylayer</span></span></div><div class="line"><span class="comment">//é‡å†™è¯¥æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•å†…ç»˜åˆ¶å›¾å½¢</span></div><div class="line">-(<span class="keyword">void</span>)drawInContext:(<span class="built_in">CGContextRef</span>)ctx</div><div class="line">&#123;</div><div class="line">    <span class="comment">//1.ç»˜åˆ¶å›¾å½¢</span></div><div class="line">    <span class="comment">//ç”»ä¸€ä¸ªåœ†</span></div><div class="line">    <span class="built_in">CGContextAddEllipseInRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">50</span>, <span class="number">100</span>, <span class="number">100</span>));</div><div class="line">    <span class="comment">//è®¾ç½®å±æ€§ï¼ˆé¢œè‰²ï¼‰</span></div><div class="line"><span class="comment">//    [[UIColor yellowColor]set];	ä¸èƒ½è¿™æ ·è®¾ç½®</span></div><div class="line">    <span class="built_in">CGContextSetRGBFillColor</span>(ctx, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>);</div><div class="line">     <span class="comment">//2.æ¸²æŸ“</span></div><div class="line">    <span class="built_in">CGContextFillPath</span>(ctx);</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼š</p>
<ol>
<li>é»˜è®¤ä¸ºæ— è‰²ï¼Œä¸ä¼šæ˜¾ç¤ºã€‚è¦æƒ³è®©ç»˜åˆ¶çš„å›¾å½¢æ˜¾ç¤ºå‡ºæ¥ï¼Œè¿˜éœ€è¦è®¾ç½®å›¾å½¢çš„é¢œè‰²ã€‚æ³¨æ„ä¸èƒ½ç›´æ¥ä½¿ç”¨UIæ¡†æ¶ä¸­çš„ç±»</li>
<li>åœ¨è‡ªå®šä¹‰layerä¸­<code>drawInContext:</code>æ–¹æ³•ä¸ä¼šè‡ªå·±è°ƒç”¨ï¼Œåªèƒ½è‡ªå·±é€šè¿‡<code>setNeedDisplay</code>æ–¹æ³•è°ƒç”¨ï¼Œåœ¨viewä¸­ç”»ä¸œè¥¿<code>DrawRect:</code>æ–¹æ³•åœ¨viewç¬¬ä¸€æ¬¡æ˜¾ç¤ºçš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚</li>
</ol>
<p>åœ¨viewä¸­ç»˜å›¾ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"YYVIEW.h"</span></span></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YYVIEW</span></span></div><div class="line">- (<span class="keyword">void</span>)drawRect:(<span class="built_in">CGRect</span>)rect</div><div class="line">&#123;</div><div class="line">    <span class="comment">//1.è·å–ä¸Šä¸‹æ–‡</span></div><div class="line">    <span class="built_in">CGContextRef</span> ctx=<span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line">    <span class="comment">//2.ç»˜åˆ¶å›¾å½¢</span></div><div class="line">    <span class="built_in">CGContextAddEllipseInRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">50</span>, <span class="number">100</span>, <span class="number">100</span>));</div><div class="line">    <span class="comment">//è®¾ç½®å±æ€§ï¼ˆé¢œè‰²ï¼‰</span></div><div class="line">    <span class="comment">//    [[UIColor yellowColor]set];</span></div><div class="line">    <span class="built_in">CGContextSetRGBFillColor</span>(ctx, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>);</div><div class="line">    <span class="comment">//3.æ¸²æŸ“</span></div><div class="line">    <span class="built_in">CGContextFillPath</span>(ctx);</div><div class="line">    <span class="comment">//åœ¨æ‰§è¡Œæ¸²æŸ“æ“ä½œçš„æ—¶å€™ï¼Œæœ¬è´¨ä¸Šå®ƒçš„å†…éƒ¨ç›¸å½“äºè°ƒç”¨äº†ä¸‹é¢çš„æ–¹æ³•</span></div><div class="line">    <span class="comment">//[self.layer drawInContext:ctx];</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="ç¬¬äºŒç§æ–¹å¼ï¼šå®ç°delegateæ–¹æ³•"><a href="#ç¬¬äºŒç§æ–¹å¼ï¼šå®ç°delegateæ–¹æ³•" class="headerlink" title="ç¬¬äºŒç§æ–¹å¼ï¼šå®ç°delegateæ–¹æ³•"></a>ç¬¬äºŒç§æ–¹å¼ï¼šå®ç°delegateæ–¹æ³•</h3><p>è®¾ç½®viewcontrollerä¸ºCALayerçš„delegateï¼Œç„¶åè®©delegateå®ç°drawLayer:inContext:æ–¹æ³•ï¼Œå½“CALayeréœ€è¦ç»˜å›¾æ—¶ï¼Œä¼šè°ƒç”¨delegateçš„drawLayer:inContext:æ–¹æ³•è¿›è¡Œç»˜å›¾ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YYViewController</span></span></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad&#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    <span class="comment">//1.åˆ›å»ºè‡ªå®šä¹‰çš„layer</span></div><div class="line">    <span class="built_in">CALayer</span> *layer=[<span class="built_in">CALayer</span> layer];</div><div class="line">    <span class="comment">//2.è®¾ç½®layerçš„å±æ€§</span></div><div class="line">	...</div><div class="line">    <span class="comment">//è®¾ç½®ä»£ç†</span></div><div class="line">    layer.delegate=<span class="keyword">self</span>;</div><div class="line">    [layer setNeedsDisplay];</div><div class="line">    <span class="comment">//3.æ·»åŠ layer</span></div><div class="line">    [<span class="keyword">self</span>.view.layer addSublayer:layer];</div><div class="line">&#125;</div><div class="line">-(<span class="keyword">void</span>)drawLayer:(<span class="built_in">CALayer</span> *)layer inContext:(<span class="built_in">CGContextRef</span>)ctx&#123;</div><div class="line">    <span class="comment">//1.ç»˜åˆ¶å›¾å½¢</span></div><div class="line">    <span class="comment">//ç”»ä¸€ä¸ªåœ†</span></div><div class="line">    <span class="built_in">CGContextAddEllipseInRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">50</span>, <span class="number">100</span>, <span class="number">100</span>));</div><div class="line">    <span class="comment">//è®¾ç½®å±æ€§ï¼ˆé¢œè‰²ï¼‰</span></div><div class="line">    <span class="comment">//    [[UIColor yellowColor]set];</span></div><div class="line">    <span class="built_in">CGContextSetRGBFillColor</span>(ctx, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>);   </div><div class="line">    <span class="comment">//2.æ¸²æŸ“</span></div><div class="line">    <span class="built_in">CGContextFillPath</span>(ctx);</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼š</p>
<ol>
<li>åœ¨è®¾ç½®ä»£ç†çš„æ—¶å€™ï¼Œå®ƒå¹¶ä¸è¦æ±‚æˆ‘ä»¬éµå®ˆåè®®ï¼Œè¯´æ˜è¿™ä¸ªæ–¹æ³•æ˜¯nsobjectä¸­çš„ï¼Œå°±ä¸éœ€è¦å†é¢å¤–çš„æ˜¾ç¤ºéµå®ˆåè®®äº†ã€‚</li>
<li>ä¸èƒ½å†å°†æŸä¸ªUIViewè®¾ç½®ä¸ºCALayerçš„delegateï¼Œå› ä¸ºUIViewå¯¹è±¡å·²ç»æ˜¯å®ƒå†…éƒ¨æ ¹å±‚çš„delegateï¼Œå†æ¬¡è®¾ç½®ä¸ºå…¶ä»–å±‚çš„delegateå°±ä¼šå‡ºé—®é¢˜ã€‚</li>
</ol>
<h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><ol>
<li>æ— è®ºé‡‡å–å“ªç§æ–¹æ³•æ¥è‡ªå®šä¹‰å±‚ï¼Œéƒ½å¿…é¡»è°ƒç”¨CALayerçš„setNeedsDisplayæ–¹æ³•æ‰èƒ½æ­£å¸¸ç»˜å›¾ã€‚</li>
<li><strong>å½“UIViewéœ€è¦æ˜¾ç¤ºæ—¶</strong>ï¼Œå®ƒå†…éƒ¨çš„å±‚ä¼šå‡†å¤‡å¥½ä¸€ä¸ªCGContextRef(å›¾å½¢ä¸Šä¸‹æ–‡)ï¼Œç„¶å<strong>è°ƒç”¨delegate(è¿™é‡Œå°±æ˜¯UIView)</strong>çš„drawLayer:inContext:æ–¹æ³•ï¼Œå¹¶ä¸”ä¼ å…¥å·²ç»å‡†å¤‡å¥½çš„CGContextRefå¯¹è±¡ã€‚è€ŒUIViewåœ¨drawLayer:inContext:æ–¹æ³•ä¸­åˆä¼šè°ƒç”¨è‡ªå·±çš„drawRect:æ–¹æ³•ã€‚å¹³æ—¶åœ¨drawRect:ä¸­é€šè¿‡UIGraphicsGetCurrentContext()è·å–çš„å°±æ˜¯ç”±å±‚ä¼ å…¥çš„CGContextRefå¯¹è±¡ï¼Œåœ¨drawRect:ä¸­å®Œæˆçš„æ‰€æœ‰ç»˜å›¾éƒ½ä¼šå¡«å…¥å±‚çš„CGContextRefä¸­ï¼Œç„¶åè¢«æ‹·è´è‡³å±å¹•ã€‚</li>
</ol>
<blockquote>
<p>Demo è¯¦è§ CALayer-transform</p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[åˆ é™¤Storyboard]]></title>
      <url>http://zhang759740844.github.io/2016/08/11/%E5%88%A0%E9%99%A4storyboard/</url>
      <content type="html"><![CDATA[<p>xcodeç‰ˆæœ¬å‡çº§åï¼Œstoryboardæˆäº†iosæ–°å»ºé¡¹ç›®åé»˜è®¤çš„å¸ƒå±€ã€‚ä½†æ˜¯å°è¯•äº†ä¸€ä¼šåå‘è§‰å¾ˆä¸ä¹ æƒ¯ï¼Œäºæ˜¯ç ”ç©¶äº†ä¸‹åˆ é™¤storyboardçš„æ–¹æ³•ã€‚<br><a id="more"></a></p>
<p>storyboardçš„å…¥å£åœ¨<strong>targets-&gt;General-&gt;Deployment Info-&gt;Main Interface</strong>ï¼Œé»˜è®¤çš„å€¼ä¸ºMainï¼Œå³åˆå§‹é»˜è®¤storyboardçš„åå­—ã€‚å› æ­¤ï¼Œæƒ³è¦ä¸åŠ è½½storyboardï¼Œéœ€è¦å°†è¿™ä¸ªé»˜è®¤å€¼åˆ æ‰ï¼Œå°±ä¸ä¼šå†ä»storyboardè¿›å…¥äº†ã€‚</p>
<p>åˆ é™¤åï¼ŒviewControlleréœ€è¦ä¸€ä¸ªå¸ƒå±€ï¼Œéœ€è¦æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªxibæ–‡ä»¶ã€‚éœ€è¦å¯¹xibæ–‡ä»¶å’Œviewcontrollerè¿›è¡Œå…³è”ã€‚</p>
<ul>
<li>ç‚¹å‡»placeholdersä¸‹çš„Fileâ€™s Ownerå°†Custom Classçš„Classè®¾ç½®ä¸ºviewcControllerçš„åå­—ã€‚</li>
<li>å°†Fileâ€™s Ownerçš„viewå’Œxibçš„Viewè¿›è¡Œå…³è”ã€‚</li>
</ul>
<p>ä½¿ç”¨storyboardçš„æ—¶å€™application:didFinishWithOptions:æ–¹æ³•åªè¿”å›ä¸€ä¸ªYESã€‚åˆ é™¤åï¼Œéœ€è¦æ·»åŠ ä»£ç å¯¹windowåˆå§‹åŒ–ï¼Œå¦åˆ™appä»€ä¹ˆä¹Ÿæ˜¾ç¤ºä¸äº†ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions &#123;</div><div class="line">	<span class="keyword">self</span>.window = [[<span class="built_in">UIWindow</span> alloc] initWithFrame:[[<span class="built_in">UIScreen</span> mainScreen] bounds]];</div><div class="line">	ViewController *uv = [[ViewController alloc] initWithNibName:<span class="string">@"ViewController"</span> bundle:<span class="literal">nil</span>];</div><div class="line">	[<span class="keyword">self</span>.window setRootViewController:uv];</div><div class="line">	[<span class="keyword">self</span>.window makeKeyAndVisible];</div><div class="line">	<span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼šè¿™é‡Œçš„<code>ViewController</code>æ˜¯ä½ è‡ªå®šä¹‰çš„ViewControllerã€‚</p>
<p>å¦‚æœè¦ä½¿ç”¨NavigationControlleréœ€è¦å†™æˆè¿™æ ·:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions &#123;</div><div class="line">    <span class="comment">// Override point for customization after application launch.</span></div><div class="line">   	<span class="keyword">self</span>.window = [[<span class="built_in">UIWindow</span> alloc] initWithFrame:[[<span class="built_in">UIScreen</span> mainScreen] bounds]];</div><div class="line">    ViewController *vc = [[ViewController alloc]initWithNibName:<span class="string">@"ViewController"</span> bundle:<span class="literal">nil</span>];</div><div class="line">    vc.title = <span class="string">@"AutoHeightTableView"</span>;</div><div class="line">    <span class="built_in">UINavigationController</span> *uv = [[<span class="built_in">UINavigationController</span> alloc] initWithRootViewController:vc];</div><div class="line">    [<span class="keyword">self</span>.window setRootViewController:uv];</div><div class="line">    [<span class="keyword">self</span>.window makeKeyAndVisible];</div><div class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è‡³æ­¤ï¼Œappå°±å¯ä»¥æ˜¾ç¤ºæ–°å»ºçš„xibæ–‡ä»¶çš„å¸ƒå±€äº†</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨xibè®¾ç½®viewçš„borderçš„å®½åº¦å’Œé¢œè‰²]]></title>
      <url>http://zhang759740844.github.io/2016/08/10/xib%E8%AE%BE%E7%BD%AEborder/</url>
      <content type="html"><![CDATA[<p>ä½¿ç”¨User Defined Runtime Attributeså¯ä»¥é…ç½®ä¸€äº›åœ¨interface builder ä¸­ä¸èƒ½é…ç½®çš„å±æ€§ã€‚æœ‰åŠ©äºç¼–å†™æ›´åŠ è½»é‡çº§çš„viewcontrollerã€‚</p>
<a id="more"></a>
<p>å†™ä¸€ä¸ªbuttonçš„æ—¶å€™ç»å¸¸ä¼šéœ€è¦è®¾ç½®å…¶cornerRadiousï¼ŒborderWidthå’ŒborderColorä¸‰ä¸ªå±æ€§ã€‚å¦‚æœåœ¨ä»£ç ä¸­å®ç°ï¼Œéœ€è¦è®¾ç½®ä¸€ä¸ªbuttonå±æ€§ï¼Œå†ä¸xibè¿›è¡Œå…³è”ã€‚<br>å¯ä»¥ä½¿ç”¨User Defined Runtime Attributesåœ¨xibä¸­è¿›è¡Œè®¾ç½®ã€‚</p>
<p>å¯¹ä¸€ä¸ªviewè¿›è¡Œè®¾ç½®ä¸»è¦è¿˜æ˜¯è®¾ç½®å®ƒçš„layerã€‚å› æ­¤ï¼Œè®¾ç½®çš„key,typeä¾æ¬¡æ˜¯ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">layer.cornerRadius				Number</div><div class="line">layer.borderWidth				Number</div><div class="line">layer.borderColor				Color</div></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯ï¼Œè¿›è¿‡è®¾ç½®åä¼šå‘ç°borderColorå±æ€§è®¾ç½®å¹¶ä¸æˆåŠŸã€‚è¿™æ˜¯å› ä¸ºè¿™é‡Œè®¾ç½®çš„é¢œè‰²ç±»å‹æ˜¯UIColorè€ŒborderColoræ˜¯CGColorå› æ­¤æ˜¾ç¤ºä¸å‡ºæ¥ã€‚</p>
<p>éœ€è¦ä½¿ç”¨categoryå®šä¹‰ä¸€ä¸ªCALayerçš„æ–¹æ³•<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"CALayer+Additions.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">CALayer</span> (<span class="title">Additions</span>)</span></div><div class="line">- (<span class="keyword">void</span>)setBorderColorFromUIColor:(<span class="built_in">UIColor</span> *)color&#123;</div><div class="line">    <span class="keyword">self</span>.borderColor = color.CGColor;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>é€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥æŠŠColorè®¾ç½®ä¸ºborderColorã€‚<br>xibä¸­çš„keyéœ€è¦æ”¹æˆæ­¤æ–¹æ³•å<br><strong>layer.borderColorFromUIColor</strong></p>
<p>åœ¨xibä¸­è®¾ç½®borderColorFromUIColorçš„æ—¶å€™ï¼Œä¸éœ€è¦å°†æ–°å»ºçš„CALayer+Additions.hå¤´æ–‡ä»¶importå…¥ä»»ä½•ç±»ï¼Œç¼–è¯‘çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚</p>
<p>è®¾ç½®masksToBoundsä¸ºYESï¼ˆä¹Ÿå°±æ˜¯xibä¸­çš„clip boundsï¼‰å¯ä»¥å°†å›¾å±‚é‡Œé¢ä¸œè¥¿æˆªå–ï¼Œå¦åˆ™ï¼Œè¶…å‡ºçˆ¶å¸ƒå±€çš„å­è§†å›¾ä¹Ÿå°†å…¨éƒ¨æ˜¾ç¤ºã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 é¢å‘å¯¹è±¡é«˜çº§ç¼–ç¨‹]]></title>
      <url>http://zhang759740844.github.io/2016/08/10/python_%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<h3 id="ä½¿ç”¨slots"><a href="#ä½¿ç”¨slots" class="headerlink" title="ä½¿ç”¨slots"></a>ä½¿ç”¨<strong>slots</strong></h3><p>æˆ‘ä»¬å¯ä»¥ç»™å®ä¾‹ç»‘å®šä»»ä½•å±æ€§å’Œæ–¹æ³•ã€‚<br>åˆ›å»ºå®ä¾‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="keyword">pass</span></div></pre></td></tr></table></figure></p>
<p>ç»™å®ä¾‹ç»‘å®šæ–¹æ³•ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">set_age</span><span class="params">(self, age)</span>:</span> <span class="comment"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ä½œä¸ºå®ä¾‹æ–¹æ³•</span></div><div class="line"><span class="meta">... </span>    self.age = age</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> types <span class="keyword">import</span> MethodType</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.set_age = MethodType(set_age, s) <span class="comment"># ç»™å®ä¾‹ç»‘å®šä¸€ä¸ªæ–¹æ³•</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.set_age(<span class="number">25</span>) <span class="comment"># è°ƒç”¨å®ä¾‹æ–¹æ³•</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.age <span class="comment"># æµ‹è¯•ç»“æœ</span></div><div class="line"><span class="number">25</span></div></pre></td></tr></table></figure></p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ol>
<li>è¿™é‡Œä½¿ç”¨MethodTypeæ–¹æ³•ç»™å®ä¾‹ç»‘å®šæ–¹æ³•ï¼Œä¹‹åè°ƒç”¨çš„æ—¶å€™å°±ä¸ç”¨è®¾ç½®selfäº†ã€‚å¦‚æœä½¿ç”¨s.set_age = set_ageçš„æ–¹å¼ç»‘å®šï¼Œé‚£ä¹ˆè°ƒç”¨æ—¶è¦è‡ªå·±ä¼ å…¥selfå˜é‡ã€‚ </li>
<li>MethodType()è¿™ä¸ªæ–¹æ³•ä¸è¦ç”¨åœ¨ç»™ç±»ç»‘å®šå±æ€§ä¸Šã€‚</li>
</ol>
<p>ç»™ç±»ç»‘å®šæ–¹æ³•:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">set_score</span><span class="params">(self, score)</span>:</span></div><div class="line"><span class="meta">... </span>    self.score = score</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>Student.set_score = set_score</div></pre></td></tr></table></figure></p>
<p><strong>æ³¨æ„ï¼š</strong>åƒè¿™æ ·ç»™ç±»ç»‘å®šæ–¹æ³•åï¼Œå®ä¾‹å˜é‡ä¸ç”¨è‡ªå·±ä¼ å…¥selfäº†ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æƒ³è¦é™åˆ¶å®ä¾‹çš„å±æ€§ã€‚æ¯”å¦‚ï¼Œåªå…è®¸å¯¹Studentå®ä¾‹æ·»åŠ nameå’Œageå±æ€§ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>slots</strong>æ¥é™åˆ¶å±æ€§ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line">    __slots__ = (<span class="string">'name'</span>, <span class="string">'age'</span>) <span class="comment"># ç”¨tupleå®šä¹‰å…è®¸ç»‘å®šçš„å±æ€§åç§°</span></div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨<strong>slots</strong>è¦æ³¨æ„ï¼Œ<strong>slots</strong>å®šä¹‰çš„å±æ€§ä»…å¯¹å½“å‰ç±»å®ä¾‹èµ·ä½œç”¨ï¼Œå¯¹ç»§æ‰¿çš„å­ç±»æ˜¯ä¸èµ·ä½œç”¨çš„,å³<strong><strong>slots</strong>å±æ€§å¹¶ä¸ä¼šè¢«ç»§æ‰¿</strong></p>
<p>slotsçš„æœ¬è´¨ä¸æ˜¯é™åˆ¶å®ä¾‹æ·»åŠ å±æ€§ï¼Œè€Œæ˜¯ä¼˜åŒ–æ€§èƒ½ã€‚slotsç»‘å®šçš„å®ä¾‹å±æ€§ä¸ä¿å­˜åœ¨dictä¸­ï¼Œæ‰€ä»¥åœ¨æœ‰å¤§é‡å®ä¾‹å­˜åœ¨çš„æƒ…å†µä¸‹èƒ½å‡å°‘hash tableçš„å†…å­˜å¼€é”€ã€‚ä¸èƒ½ç»™å®ä¾‹å¢åŠ ,ä¸èƒ½ç»™å®ä¾‹åŠ¨æ€æ·»åŠ å±æ€§åªæ˜¯<strong>slots</strong>çš„å‰¯ä½œç”¨ã€‚</p>
<h3 id="ä½¿ç”¨-property"><a href="#ä½¿ç”¨-property" class="headerlink" title="ä½¿ç”¨@property"></a>ä½¿ç”¨@property</h3><p>ç±»çš„å±æ€§éƒ½æ˜¯æš´éœ²å‡ºæ¥çš„ï¼Œå†™èµ·æ¥æ–¹ä¾¿ï¼Œä½†æ˜¯æ²¡åŠæ³•æ£€æŸ¥å‚æ•°ã€‚å¦‚æœä½¿ç”¨getï¼Œsetæ–¹æ³•åˆæ˜¾å¾—éº»çƒ¦ã€‚å¯ä»¥ä½¿ç”¨è£…é¥°å™¨(decorator)ä¸­çš„@propertyè£…é¥°å™¨ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line"></div><div class="line"><span class="meta">    @property</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self._score</div><div class="line"></div><div class="line"><span class="meta">    @score.setter</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span><span class="params">(self, value)</span>:</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> isinstance(value, int):</div><div class="line">            <span class="keyword">raise</span> ValueError(<span class="string">'score must be an integer!'</span>)</div><div class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; <span class="number">100</span>:</div><div class="line">            <span class="keyword">raise</span> ValueError(<span class="string">'score must between 0 ~ 100!'</span>)</div><div class="line">        self._score = value</div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼š</p>
<ol>
<li>æŠŠä¸€ä¸ªgetteræ–¹æ³•å˜æˆå±æ€§ï¼Œåªéœ€è¦åŠ ä¸Š@propertyå°±å¯ä»¥äº†ï¼Œæ­¤æ—¶ï¼Œ@propertyæœ¬èº«åˆåˆ›å»ºäº†å¦ä¸€ä¸ªè£…é¥°å™¨@score.setterï¼Œè´Ÿè´£æŠŠä¸€ä¸ªsetteræ–¹æ³•å˜æˆå±æ€§èµ‹å€¼.</li>
<li>åªå®šä¹‰getteræ–¹æ³•ï¼Œä¸å®šä¹‰setteræ–¹æ³•å°±æ˜¯ä¸€ä¸ªåªè¯»å±æ€§ã€‚</li>
</ol>
<h3 id="å¤šé‡ç»§æ‰¿"><a href="#å¤šé‡ç»§æ‰¿" class="headerlink" title="å¤šé‡ç»§æ‰¿"></a>å¤šé‡ç»§æ‰¿</h3><p>pythonå…è®¸å¤šé‡ç»§æ‰¿ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span><span class="params">(Mammal, Runnable)</span>:</span></div><div class="line">    <span class="keyword">pass</span></div></pre></td></tr></table></figure></p>
<p><strong>å¦‚æœç»§æ‰¿çš„ç±»æœ‰åŒåæ–¹æ³•ï¼ŒæŒ‰ç…§ç»§æ‰¿çš„é¡ºåºæ‰§è¡Œï¼Œå³å…ˆæ‰§è¡ŒMammalé‡Œçš„ï¼Œæ²¡æœ‰å†æ‰§è¡ŒRunnableé‡Œçš„ã€‚</strong></p>
<p>åœ¨è®¾è®¡ç±»çš„ç»§æ‰¿å…³ç³»æ—¶ï¼Œé€šå¸¸ï¼Œä¸»çº¿éƒ½æ˜¯å•ä¸€ç»§æ‰¿ä¸‹æ¥çš„ï¼Œä¾‹å¦‚ï¼ŒOstrichç»§æ‰¿è‡ªBirdã€‚ä½†æ˜¯ï¼Œå¦‚æœéœ€è¦â€œæ··å…¥â€é¢å¤–çš„åŠŸèƒ½ï¼Œé€šè¿‡å¤šé‡ç»§æ‰¿å°±å¯ä»¥å®ç°ï¼Œæ¯”å¦‚ï¼Œè®©Ostriché™¤äº†ç»§æ‰¿è‡ªBirdå¤–ï¼Œå†åŒæ—¶ç»§æ‰¿Runnableã€‚è¿™ç§è®¾è®¡é€šå¸¸ç§°ä¹‹ä¸ºMixInã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span><span class="params">(Mammal, RunnableMixIn, CarnivorousMixIn)</span>:</span></div><div class="line">    <span class="keyword">pass</span></div></pre></td></tr></table></figure></p>
<p>æ„Ÿè§‰MixInå°±æ˜¯ä¸ªçº¦å®šå•Šï¼Œå¹¶æ²¡æœ‰å¤ªå¤šå®è´¨æ•ˆæœå•Š=ã€‚=</p>
<h3 id="å®šåˆ¶ç±»"><a href="#å®šåˆ¶ç±»" class="headerlink" title="å®šåˆ¶ç±»"></a>å®šåˆ¶ç±»</h3><p>å½¢å¦‚<strong>xxx</strong>çš„å˜é‡æˆ–è€…å‡½æ•°åå°±è¦æ³¨æ„ï¼Œè¿™äº›åœ¨Pythonä¸­æ˜¯æœ‰ç‰¹æ®Šç”¨é€”çš„ã€‚</p>
<h4 id="str"><a href="#str" class="headerlink" title="str"></a><strong>str</strong></h4><p>æ€ä¹ˆæ‰èƒ½æ‰“å°å¾—å¥½çœ‹å‘¢ï¼Ÿåªéœ€è¦å®šä¹‰å¥½<strong>str</strong>()æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå¥½çœ‹çš„å­—ç¬¦ä¸²å°±å¯ä»¥äº†ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line"><span class="meta">... </span>        self.name = name</div><div class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line"><span class="meta">... </span>        <span class="keyword">return</span> <span class="string">'Student object (name: %s)'</span> % self.name</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(Student(<span class="string">'Michael'</span>))</div><div class="line">Student object (name: Michael)</div></pre></td></tr></table></figure></p>
<h4 id="iter"><a href="#iter" class="headerlink" title="iter"></a><strong>iter</strong></h4><p>å¦‚æœä¸€ä¸ªç±»æƒ³è¢«ç”¨äº<strong>forâ€¦in</strong>å¾ªç¯ï¼Œç±»ä¼¼listæˆ–tupleé‚£æ ·ï¼Œå°±å¿…é¡»å®ç°ä¸€ä¸ª<strong><strong>iter</strong>()</strong>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªè¿­ä»£å¯¹è±¡ï¼Œç„¶åï¼ŒPythonçš„forå¾ªç¯å°±ä¼šä¸æ–­è°ƒç”¨è¯¥è¿­ä»£å¯¹è±¡çš„<strong><strong>next</strong>()</strong>æ–¹æ³•æ‹¿åˆ°å¾ªç¯çš„ä¸‹ä¸€ä¸ªå€¼ï¼Œç›´åˆ°é‡åˆ°<strong>StopIteration</strong>é”™è¯¯æ—¶é€€å‡ºå¾ªç¯ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fib</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.a, self.b = <span class="number">0</span>, <span class="number">1</span> <span class="comment"># åˆå§‹åŒ–ä¸¤ä¸ªè®¡æ•°å™¨aï¼Œb</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self <span class="comment"># å®ä¾‹æœ¬èº«å°±æ˜¯è¿­ä»£å¯¹è±¡ï¼Œæ•…è¿”å›è‡ªå·±</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span><span class="params">(self)</span>:</span></div><div class="line">        self.a, self.b = self.b, self.a + self.b <span class="comment"># è®¡ç®—ä¸‹ä¸€ä¸ªå€¼</span></div><div class="line">        <span class="keyword">if</span> self.a &gt; <span class="number">100000</span>: <span class="comment"># é€€å‡ºå¾ªç¯çš„æ¡ä»¶</span></div><div class="line">            <span class="keyword">raise</span> StopIteration();</div><div class="line">        <span class="keyword">return</span> self.a <span class="comment"># è¿”å›ä¸‹ä¸€ä¸ªå€¼</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> n <span class="keyword">in</span> Fib():</div><div class="line"><span class="meta">... </span>    print(n)</div></pre></td></tr></table></figure></p>
<h4 id="getitem"><a href="#getitem" class="headerlink" title="getitem"></a><strong>getitem</strong></h4><p>è¦è¡¨ç°å¾—åƒlisté‚£æ ·æŒ‰ç…§ä¸‹æ ‡å–å‡ºå…ƒç´ ï¼Œéœ€è¦å®ç°<strong>getitem</strong>()æ–¹æ³•ã€‚<strong>getitem</strong>()ä¼ å…¥çš„å‚æ•°å¯èƒ½æ˜¯ä¸€ä¸ªintï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªåˆ‡ç‰‡å¯¹è±¡slice:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fib</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">(self, n)</span>:</span></div><div class="line">        <span class="keyword">if</span> isinstance(n, int): <span class="comment"># næ˜¯ç´¢å¼•</span></div><div class="line">            a, b = <span class="number">1</span>, <span class="number">1</span></div><div class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> range(n):</div><div class="line">                a, b = b, a + b</div><div class="line">            <span class="keyword">return</span> a</div><div class="line">        <span class="keyword">if</span> isinstance(n, slice): <span class="comment"># næ˜¯åˆ‡ç‰‡</span></div><div class="line">            start = n.start</div><div class="line">            stop = n.stop</div><div class="line">            <span class="keyword">if</span> start <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">                start = <span class="number">0</span></div><div class="line">            a, b = <span class="number">1</span>, <span class="number">1</span></div><div class="line">            L = []</div><div class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> range(stop):</div><div class="line">                <span class="keyword">if</span> x &gt;= start:</div><div class="line">                    L.append(a)</div><div class="line">                a, b = b, a + b</div><div class="line">            <span class="keyword">return</span> L</div></pre></td></tr></table></figure></p>
<p>ä¸ä¹‹å¯¹åº”çš„æ˜¯<strong>setitem</strong>()æ–¹æ³•ï¼ŒæŠŠå¯¹è±¡è§†ä½œlistæˆ–dictæ¥å¯¹é›†åˆèµ‹å€¼ã€‚æœ€åï¼Œè¿˜æœ‰ä¸€ä¸ª<strong>delitem</strong>()æ–¹æ³•ï¼Œç”¨äºåˆ é™¤æŸä¸ªå…ƒç´ ã€‚</p>
<h4 id="getattr"><a href="#getattr" class="headerlink" title="getattr"></a><strong>getattr</strong></h4><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬è°ƒç”¨ç±»çš„æ–¹æ³•æˆ–å±æ€§æ—¶ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¼šæŠ¥é”™ã€‚è¦é¿å…è¿™ä¸ªé”™è¯¯ï¼Œé™¤äº†å¯ä»¥åŠ ä¸Šä¸€ä¸ªscoreå±æ€§å¤–ï¼ŒPythonè¿˜æœ‰å¦ä¸€ä¸ªæœºåˆ¶ï¼Œé‚£å°±æ˜¯å†™ä¸€ä¸ª<strong>getattr</strong>()æ–¹æ³•ï¼ŒåŠ¨æ€è¿”å›ä¸€ä¸ªå±æ€§ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.name = <span class="string">'Michael'</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span><span class="params">(self, attr)</span>:</span></div><div class="line">        <span class="keyword">if</span> attr==<span class="string">'score'</span>:</div><div class="line">            <span class="keyword">return</span> <span class="number">99</span></div></pre></td></tr></table></figure></p>
<p>å½“è°ƒç”¨<strong>ä¸å­˜åœ¨çš„å±æ€§</strong>æ—¶ï¼Œæ¯”å¦‚scoreï¼ŒPythonè§£é‡Šå™¨ä¼šè¯•å›¾è°ƒç”¨<strong>getattr</strong>(self, â€˜scoreâ€™)æ¥å°è¯•è·å¾—å±æ€§ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±æœ‰æœºä¼šè¿”å›scoreçš„å€¼.</p>
<h4 id="call"><a href="#call" class="headerlink" title="call"></a><strong>call</strong></h4><p>ä»»ä½•ç±»ï¼Œåªéœ€è¦å®šä¹‰ä¸€ä¸ª<strong>call</strong>()æ–¹æ³•ï¼Œå°±å¯ä»¥ç›´æ¥å¯¹å®ä¾‹è¿›è¡Œè°ƒç”¨ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></div><div class="line">        self.name = name</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'My name is %s.'</span> % self.name)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = Student(<span class="string">'Michael'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s() <span class="comment"># selfå‚æ•°ä¸è¦ä¼ å…¥</span></div><div class="line">My name <span class="keyword">is</span> Michael.</div></pre></td></tr></table></figure></p>
<h3 id="æšä¸¾ç±»"><a href="#æšä¸¾ç±»" class="headerlink" title="æšä¸¾ç±»"></a>æšä¸¾ç±»</h3><p>Pythonæä¾›äº†Enumç±»æ¥å®ç°è¿™ä¸ªåŠŸèƒ½<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</div><div class="line">Month = Enum(<span class="string">'Month'</span>, (<span class="string">'Jan'</span>, <span class="string">'Feb'</span>, <span class="string">'Mar'</span>, <span class="string">'Apr'</span>, <span class="string">'May'</span>, <span class="string">'Jun'</span>, <span class="string">'Jul'</span>, <span class="string">'Aug'</span>, <span class="string">'Sep'</span>, <span class="string">'Oct'</span>, <span class="string">'Nov'</span>, <span class="string">'Dec'</span>))</div><div class="line"></div><div class="line"><span class="keyword">for</span> name, member <span class="keyword">in</span> Month.__members__.items():</div><div class="line">    print(name, <span class="string">'=&gt;'</span>, member, <span class="string">','</span>, member.value)</div></pre></td></tr></table></figure></p>
<p>valueå±æ€§åˆ™æ˜¯è‡ªåŠ¨èµ‹ç»™æˆå‘˜çš„intå¸¸é‡ï¼Œé»˜è®¤ä»1å¼€å§‹è®¡æ•°ã€‚<br>å¦‚æœéœ€è¦æ›´ç²¾ç¡®åœ°æ§åˆ¶æšä¸¾ç±»å‹ï¼Œå¯ä»¥ä»Enumæ´¾ç”Ÿå‡ºè‡ªå®šä¹‰ç±»ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum, unique</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Weekday</span><span class="params">(Enum)</span>:</span></div><div class="line">    Sun = <span class="number">0</span> <span class="comment"># Sunçš„valueè¢«è®¾å®šä¸º0</span></div><div class="line">    Mon = <span class="number">1</span></div><div class="line">    Tue = <span class="number">2</span></div><div class="line">    Wed = <span class="number">3</span></div><div class="line">    Thu = <span class="number">4</span></div><div class="line">    Fri = <span class="number">5</span></div><div class="line">    Sat = <span class="number">6</span></div></pre></td></tr></table></figure>
<h3 id="å…ƒç±»"><a href="#å…ƒç±»" class="headerlink" title="å…ƒç±»"></a>å…ƒç±»</h3><p>æ²¡çœ‹</p>
<p>æœ€åå†æ¬¡æ„Ÿè°¢å»–è€å¸ˆçš„è¾›å‹¤åŠ³åŠ¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 é¢å‘å¯¹è±¡ç¼–ç¨‹]]></title>
      <url>http://zhang759740844.github.io/2016/08/09/python_%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<h3 id="ç±»å’Œå®ä¾‹"><a href="#ç±»å’Œå®ä¾‹" class="headerlink" title="ç±»å’Œå®ä¾‹"></a>ç±»å’Œå®ä¾‹</h3><p>å®šä¹‰ç±»æ˜¯é€šè¿‡classå…³é”®å­—ï¼Œåé¢ç´§æ¥ç€æ˜¯ç±»åï¼Œç´§æ¥ç€æ˜¯(object)ï¼Œè¡¨ç¤ºè¯¥ç±»æ˜¯ä»å“ªä¸ªç±»ç»§æ‰¿ä¸‹æ¥çš„ã€‚<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">class Student(object)</div><div class="line">	pass</div></pre></td></tr></table></figure></p>
<p>å®šä¹‰å¥½ç±»ï¼Œå°±å¯ä»¥åˆ›å»ºå‡ºå®ä¾‹äº†ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bart = Student()</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥<strong>è‡ªç”±åœ°ç»™ä¸€ä¸ªå®ä¾‹å˜é‡ç»‘å®šå±æ€§</strong>ï¼Œæ¯”å¦‚ï¼Œç»™å®ä¾‹bartç»‘å®šä¸€ä¸ªnameå±æ€§ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bart.name = <span class="string">'Zachary'</span></div></pre></td></tr></table></figure></p>
<p>å’Œé™æ€è¯­è¨€ä¸åŒï¼ŒPythonå…è®¸å¯¹å®ä¾‹å˜é‡ç»‘å®šä»»ä½•æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸¤ä¸ªå®ä¾‹å˜é‡ï¼Œè™½ç„¶å®ƒä»¬éƒ½æ˜¯åŒä¸€ä¸ªç±»çš„ä¸åŒå®ä¾‹ï¼Œä½†æ‹¥æœ‰çš„å˜é‡åç§°éƒ½å¯èƒ½ä¸åŒã€‚</p>
<p>åˆ›å»ºå®ä¾‹çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„<strong><strong>init</strong></strong>æ–¹æ³•åˆå§‹åŒ–ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, score)</span>:</span></div><div class="line">        self.name = name</div><div class="line">        self.score = score</div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼š</p>
<ol>
<li>æ³¨æ„åˆ°<strong>init</strong>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œæ˜¯selfï¼Œè¡¨ç¤ºåˆ›å»ºçš„å®ä¾‹æœ¬èº«ï¼Œå› æ­¤ï¼Œåœ¨<strong>init</strong>æ–¹æ³•å†…éƒ¨ï¼Œå°±å¯ä»¥æŠŠå„ç§å±æ€§ç»‘å®šåˆ°selfï¼Œå› ä¸ºselfå°±æŒ‡å‘åˆ›å»ºçš„å®ä¾‹æœ¬èº«ã€‚</li>
<li>æœ‰äº†<strong>init</strong>æ–¹æ³•ï¼Œåœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™ï¼Œå°±ä¸èƒ½ä¼ å…¥ç©ºçš„å‚æ•°äº†ï¼Œå¿…é¡»ä¼ å…¥ä¸<strong>init</strong>æ–¹æ³•åŒ¹é…çš„å‚æ•°ï¼Œä½†selfä¸éœ€è¦ä¼ ï¼ŒPythonè§£é‡Šå™¨è‡ªå·±ä¼šæŠŠå®ä¾‹å˜é‡ä¼ è¿›å»ã€‚</li>
</ol>
<p>å¦å¤–ï¼š</p>
<ol>
<li>å’Œæ™®é€šçš„å‡½æ•°ç›¸æ¯”ï¼Œåœ¨ç±»ä¸­å®šä¹‰çš„å‡½æ•°åªæœ‰ä¸€ç‚¹ä¸åŒï¼Œå°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œæ˜¯å®ä¾‹å˜é‡selfï¼Œå¹¶ä¸”ï¼Œè°ƒç”¨æ—¶ï¼Œä¸ç”¨ä¼ é€’è¯¥å‚æ•°</li>
<li>å¦‚æœæ˜¯ç±»çš„æ–¹æ³•ï¼Œä¸éœ€è¦ä¼ å…¥selfï¼Œä½¿ç”¨ç±»å.æ–¹æ³•åè°ƒç”¨ã€‚å’Œå…¶ä»–è¯­è¨€ä¸€æ ·ã€‚</li>
</ol>
<h3 id="è®¿é—®é™åˆ¶"><a href="#è®¿é—®é™åˆ¶" class="headerlink" title="è®¿é—®é™åˆ¶"></a>è®¿é—®é™åˆ¶</h3><p>å¦‚æœè¦è®©å†…éƒ¨å±æ€§ä¸è¢«å¤–éƒ¨è®¿é—®ï¼Œå¯ä»¥æŠŠå±æ€§çš„åç§°å‰åŠ ä¸Šä¸¤ä¸ªä¸‹åˆ’çº¿__ï¼Œå°±å˜æˆäº†ä¸€ä¸ªç§æœ‰å˜é‡ï¼ˆprivateï¼‰ï¼Œåªæœ‰å†…éƒ¨å¯ä»¥è®¿é—®ï¼Œå¤–éƒ¨ä¸èƒ½è®¿é—®ã€‚</p>
<p>ocä¸­ä½¿ç”¨.hå’Œ.må®šä¹‰å±æ€§çš„æ–¹å¼åŒºåˆ†å…±æœ‰ç§æœ‰ã€‚<br>Javaä¸­é€šè¿‡publicï¼Œprivateçš„æ–¹å¼åŒºåˆ†å…±æœ‰ç§æœ‰ã€‚<br>pythoné€šè¿‡__çš„æ–¹å¼åŒºåˆ†å…±æœ‰ç§æœ‰ã€‚</p>
<p>ä»¥_å¼€å¤´çš„å˜é‡è¡¨ç¤ºï¼šå¯ä»¥è®¿é—®ï¼Œä½†æ˜¯æœ€å¥½è§†ä¸ºç§æœ‰å˜é‡ã€‚</p>
<h3 id="ç»§æ‰¿å’Œå¤šæ€"><a href="#ç»§æ‰¿å’Œå¤šæ€" class="headerlink" title="ç»§æ‰¿å’Œå¤šæ€"></a>ç»§æ‰¿å’Œå¤šæ€</h3><p>ç»§æ‰¿å’Œå¤šæ€å’Œå…¶ä»–è¯­è¨€æ²¡ä»€ä¹ˆä¸åŒï¼Œå°±ä¸é‡å¤äº†ã€‚</p>
<p>å¯¹äºé™æ€è¯­è¨€ï¼ˆä¾‹å¦‚Javaï¼‰æ¥è¯´ï¼Œå¦‚æœéœ€è¦ä¼ å…¥Animalç±»å‹ï¼Œåˆ™ä¼ å…¥çš„å¯¹è±¡å¿…é¡»æ˜¯Animalç±»å‹æˆ–è€…å®ƒçš„å­ç±»ï¼Œå¦åˆ™ï¼Œå°†æ— æ³•è°ƒç”¨run()æ–¹æ³•ã€‚<br>å¯¹äºPythonè¿™æ ·çš„åŠ¨æ€è¯­è¨€æ¥è¯´ï¼Œåˆ™ä¸ä¸€å®šéœ€è¦ä¼ å…¥Animalç±»å‹ã€‚æˆ‘ä»¬åªéœ€è¦ä¿è¯ä¼ å…¥çš„å¯¹è±¡æœ‰ä¸€ä¸ªrun()æ–¹æ³•å°±å¯ä»¥äº†</p>
<h3 id="è·å–å¯¹è±¡ä¿¡æ¯"><a href="#è·å–å¯¹è±¡ä¿¡æ¯" class="headerlink" title="è·å–å¯¹è±¡ä¿¡æ¯"></a>è·å–å¯¹è±¡ä¿¡æ¯</h3><h4 id="type"><a href="#type" class="headerlink" title="type"></a>type</h4><p>ä½¿ç”¨type()å‡½æ•°,åˆ¤æ–­å¯¹è±¡ç±»å‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> types</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">()</span>:</span></div><div class="line"><span class="meta">... </span>    <span class="keyword">pass</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>type(fn)==types.FunctionType</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>type(abs)==types.BuiltinFunctionType</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>type(<span class="keyword">lambda</span> x: x)==types.LambdaType</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>type((x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>)))==types.GeneratorType</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure></p>
<h4 id="isinstance"><a href="#isinstance" class="headerlink" title="isinstance()"></a>isinstance()</h4><p>ä½¿ç”¨isinstance()å‡½æ•°,åˆ¤æ–­classçš„ç»§æ‰¿å…³ç³»<br>åˆ¤æ–­åŸºæœ¬ç±»å‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="string">'a'</span>, str)</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="number">123</span>, int)</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="string">b'a'</span>, bytes)</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure></p>
<p>åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æ˜¯æŸäº›ç±»å‹ä¸­çš„ä¸€ç§ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç å°±å¯ä»¥åˆ¤æ–­æ˜¯å¦æ˜¯listæˆ–è€…tupleï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], (list, tuple))</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), (list, tuple))</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure></p>
<h4 id="dir"><a href="#dir" class="headerlink" title="dir()"></a>dir()</h4><p>å¦‚æœè¦è·å¾—ä¸€ä¸ªå¯¹è±¡çš„<strong>æ‰€æœ‰å±æ€§å’Œæ–¹æ³•</strong>ï¼Œå¯ä»¥ä½¿ç”¨dir()å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²çš„list.</p>
<p>ä»…ä»…æŠŠå±æ€§å’Œæ–¹æ³•åˆ—å‡ºæ¥æ˜¯ä¸å¤Ÿçš„ï¼Œé…åˆ<strong>getattr()</strong>ã€<strong>setattr()</strong>ä»¥åŠ<strong>hasattr()</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥<strong>æ“ä½œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€</strong>ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">MyObject</span><span class="params">(object)</span>:</span></div><div class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line"><span class="meta">... </span>        self.x = <span class="number">9</span></div><div class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">power</span><span class="params">(self)</span>:</span></div><div class="line"><span class="meta">... </span>        <span class="keyword">return</span> self.x * self.x</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>obj = MyObject()</div></pre></td></tr></table></figure></p>
<p>ç´§æ¥ç€ï¼Œå¯ä»¥æµ‹è¯•è¯¥å¯¹è±¡çš„å±æ€§ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>hasattr(obj, <span class="string">'x'</span>) <span class="comment"># æœ‰å±æ€§'x'å—ï¼Ÿ</span></div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>obj.x</div><div class="line"><span class="number">9</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hasattr(obj, <span class="string">'y'</span>) <span class="comment"># æœ‰å±æ€§'y'å—ï¼Ÿ</span></div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>setattr(obj, <span class="string">'y'</span>, <span class="number">19</span>) <span class="comment"># è®¾ç½®ä¸€ä¸ªå±æ€§'y'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hasattr(obj, <span class="string">'y'</span>) <span class="comment"># æœ‰å±æ€§'y'å—ï¼Ÿ</span></div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>getattr(obj, <span class="string">'y'</span>) <span class="comment"># è·å–å±æ€§'y'</span></div><div class="line"><span class="number">19</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>obj.y <span class="comment"># è·å–å±æ€§'y'</span></div><div class="line"><span class="number">19</span></div></pre></td></tr></table></figure></p>
<p>å¦‚æœè¯•å›¾è·å–ä¸å­˜åœ¨çš„å±æ€§ï¼Œä¼šæŠ›å‡ºAttributeErrorçš„é”™è¯¯<br>å¯ä»¥ä¼ å…¥ä¸€ä¸ªdefaultå‚æ•°ï¼Œå¦‚æœå±æ€§ä¸å­˜åœ¨ï¼Œå°±è¿”å›é»˜è®¤å€¼ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>getattr(obj, <span class="string">'z'</span>, <span class="number">404</span>) <span class="comment"># è·å–å±æ€§'z'ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›é»˜è®¤å€¼404</span></div><div class="line"><span class="number">404</span></div></pre></td></tr></table></figure></p>
<p>ä¹Ÿå¯ä»¥è·å¾—å¯¹è±¡çš„æ–¹æ³•ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>hasattr(obj, <span class="string">'power'</span>) <span class="comment"># æœ‰å±æ€§'power'å—ï¼Ÿ</span></div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>getattr(obj, <span class="string">'power'</span>) <span class="comment"># è·å–å±æ€§'power'</span></div><div class="line">&lt;bound method MyObject.power of &lt;__main__.MyObject object at <span class="number">0x10077a6a0</span>&gt;&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fn = getattr(obj, <span class="string">'power'</span>) <span class="comment"># è·å–å±æ€§'power'å¹¶èµ‹å€¼åˆ°å˜é‡fn</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fn <span class="comment"># fnæŒ‡å‘obj.power</span></div><div class="line">&lt;bound method MyObject.power of &lt;__main__.MyObject object at <span class="number">0x10077a6a0</span>&gt;&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fn() <span class="comment"># è°ƒç”¨fn()ä¸è°ƒç”¨obj.power()æ˜¯ä¸€æ ·çš„</span></div><div class="line"><span class="number">81</span></div></pre></td></tr></table></figure></p>
<p><strong>æ„Ÿè§‰ä¸Šï¼Œç”¨setï¼Œgetï¼Œhasæ–¹æ³•å’Œç›´æ¥è®¾ç½®æ²¡ä»€ä¹ˆå¤ªå¤§åŒºåˆ«ã€‚</strong></p>
<h3 id="å®ä¾‹å±æ€§å’Œç±»å±æ€§"><a href="#å®ä¾‹å±æ€§å’Œç±»å±æ€§" class="headerlink" title="å®ä¾‹å±æ€§å’Œç±»å±æ€§"></a>å®ä¾‹å±æ€§å’Œç±»å±æ€§</h3><p>pythonä¸­å¹¶æ²¡æœ‰staticä¿®é¥°ç¬¦ï¼Œåœ¨ä¸€ä¸ªclassä¸­å®šä¹‰çš„å±æ€§ï¼Œå®ä¾‹å’Œç±»éƒ½å¯ä»¥è®¿é—®ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(object)</span>:</span></div><div class="line"><span class="meta">... </span>    name = <span class="string">'Student'</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = Student() <span class="comment"># åˆ›å»ºå®ä¾‹s</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(s.name) <span class="comment"># æ‰“å°nameå±æ€§ï¼Œå› ä¸ºå®ä¾‹å¹¶æ²¡æœ‰nameå±æ€§ï¼Œæ‰€ä»¥ä¼šç»§ç»­æŸ¥æ‰¾classçš„nameå±æ€§</span></div><div class="line">Student</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(Student.name) <span class="comment"># æ‰“å°ç±»çš„nameå±æ€§</span></div><div class="line">Student</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.name = <span class="string">'Michael'</span> <span class="comment"># ç»™å®ä¾‹ç»‘å®šnameå±æ€§</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(s.name) <span class="comment"># ç”±äºå®ä¾‹å±æ€§ä¼˜å…ˆçº§æ¯”ç±»å±æ€§é«˜ï¼Œå› æ­¤ï¼Œå®ƒä¼šå±è”½æ‰ç±»çš„nameå±æ€§</span></div><div class="line">Michael</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(Student.name) <span class="comment"># ä½†æ˜¯ç±»å±æ€§å¹¶æœªæ¶ˆå¤±ï¼Œç”¨Student.nameä»ç„¶å¯ä»¥è®¿é—®</span></div><div class="line">Student</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> s.name <span class="comment"># å¦‚æœåˆ é™¤å®ä¾‹çš„nameå±æ€§</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(s.name) <span class="comment"># å†æ¬¡è°ƒç”¨s.nameï¼Œç”±äºå®ä¾‹çš„nameå±æ€§æ²¡æœ‰æ‰¾åˆ°ï¼Œç±»çš„nameå±æ€§å°±æ˜¾ç¤ºå‡ºæ¥äº†</span></div><div class="line">Student</div></pre></td></tr></table></figure></p>
<p>åœ¨ç¼–å†™ç¨‹åºçš„æ—¶å€™ï¼Œåƒä¸‡ä¸è¦æŠŠå®ä¾‹å±æ€§å’Œç±»å±æ€§ä½¿ç”¨ç›¸åŒçš„åå­—ï¼Œå› ä¸ºç›¸åŒåç§°çš„å®ä¾‹å±æ€§å°†å±è”½æ‰ç±»å±æ€§ï¼Œä½†æ˜¯å½“ä½ åˆ é™¤å®ä¾‹å±æ€§åï¼Œå†ä½¿ç”¨ç›¸åŒçš„åç§°ï¼Œè®¿é—®åˆ°çš„å°†æ˜¯ç±»å±æ€§ã€‚</p>
<p>æœ€åå†æ¬¡æ„Ÿè°¢å»–è€å¸ˆçš„è¾›å‹¤åŠ³åŠ¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 æ¨¡å—]]></title>
      <url>http://zhang759740844.github.io/2016/08/09/python_%E6%A8%A1%E5%9D%97/</url>
      <content type="html"><![CDATA[<p>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<p>Pythonåˆå¼•å…¥äº†æŒ‰ç›®å½•æ¥ç»„ç»‡æ¨¡å—çš„æ–¹æ³•ï¼Œç§°ä¸ºåŒ…ï¼ˆPackageï¼‰ã€‚å¼•å…¥äº†åŒ…ä»¥åï¼Œåªè¦é¡¶å±‚çš„åŒ…åä¸ä¸åˆ«äººå†²çªï¼Œé‚£æ‰€æœ‰æ¨¡å—éƒ½ä¸ä¼šä¸åˆ«äººå†²çªã€‚<br>è¯·æ³¨æ„ï¼Œæ¯ä¸€ä¸ªåŒ…ç›®å½•ä¸‹é¢éƒ½ä¼šæœ‰ä¸€ä¸ª<strong>init__.pyçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å¿…é¡»å­˜åœ¨çš„ï¼Œå¦åˆ™ï¼ŒPythonå°±æŠŠè¿™ä¸ªç›®å½•å½“æˆæ™®é€šç›®å½•ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåŒ…ã€‚</strong>init__.pyå¯ä»¥æ˜¯ç©ºæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æœ‰Pythonä»£ç ï¼Œå› ä¸º<strong>init</strong>.pyæœ¬èº«å°±æ˜¯ä¸€ä¸ªæ¨¡å—</p>
<h3 id="ä½¿ç”¨æ¨¡å—"><a href="#ä½¿ç”¨æ¨¡å—" class="headerlink" title="ä½¿ç”¨æ¨¡å—"></a>ä½¿ç”¨æ¨¡å—</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></div><div class="line">	<span class="keyword">pass</span></div><div class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</div><div class="line">	test()</div></pre></td></tr></table></figure>
<p>å¯¼å…¥sysæ¨¡å—å,å°±æœ‰äº†å˜é‡sysæŒ‡å‘è¯¥æ¨¡å—ï¼Œåˆ©ç”¨sysè¿™ä¸ªå˜é‡ï¼Œå°±å¯ä»¥è®¿é—®sysæ¨¡å—çš„æ‰€æœ‰åŠŸèƒ½ã€‚<br>sysæ¨¡å—æœ‰ä¸€ä¸ªargvå˜é‡ï¼Œç”¨listå­˜å‚¨äº†<strong>å‘½ä»¤è¡Œçš„æ‰€æœ‰å‚æ•°</strong>ã€‚argvè‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œæ˜¯è¯¥.pyæ–‡ä»¶çš„åç§°ã€‚<br>åœ¨å‘½ä»¤è¡Œè¿è¡Œè¯¥æ¨¡å—æ–‡ä»¶æ—¶ï¼ŒPythonè§£é‡Šå™¨æŠŠä¸€ä¸ªç‰¹æ®Šå˜é‡<strong>name</strong>ç½®ä¸º<strong>main</strong>ï¼Œè€Œå¦‚æœåœ¨å…¶ä»–åœ°æ–¹å¯¼å…¥è¯¥æ¨¡å—æ—¶ï¼Œifåˆ¤æ–­å°†å¤±è´¥ï¼Œå› æ­¤ï¼Œè¿™ç§ifæµ‹è¯•å¯ä»¥è®©ä¸€ä¸ªæ¨¡å—é€šè¿‡å‘½ä»¤è¡Œè¿è¡Œæ—¶æ‰§è¡Œä¸€äº›é¢å¤–çš„ä»£ç ï¼Œæœ€å¸¸è§çš„å°±æ˜¯è¿è¡Œæµ‹è¯•ã€‚</p>
<p>ä½œç”¨åŸŸï¼š</p>
<ul>
<li>æ­£å¸¸çš„å‡½æ•°å’Œå˜é‡åæ˜¯å…¬å¼€çš„ï¼ˆpublicï¼‰ï¼Œå¯ä»¥è¢«ç›´æ¥å¼•ç”¨</li>
<li>ç±»ä¼¼<strong>xxx</strong>è¿™æ ·çš„å˜é‡æ˜¯ç‰¹æ®Šå˜é‡ï¼Œå¯ä»¥è¢«ç›´æ¥å¼•ç”¨ï¼Œä½†æ˜¯æœ‰ç‰¹æ®Šç”¨é€”ã€‚</li>
<li>ç±»ä¼¼_xxxå’Œ__xxxè¿™æ ·çš„å‡½æ•°æˆ–å˜é‡å°±æ˜¯éå…¬å¼€çš„ï¼ˆprivateï¼‰ï¼Œä¸åº”è¯¥è¢«ç›´æ¥å¼•ç”¨ã€‚</li>
</ul>
<h3 id="å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—"><a href="#å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—" class="headerlink" title="å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—"></a>å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—</h3><p>ä½¿ç”¨pip3 install XXX å®‰è£…ç¬¬ä¸‰æ–¹åº“<br>å½“æˆ‘ä»¬è¯•å›¾åŠ è½½ä¸€ä¸ªæ¨¡å—æ—¶ï¼ŒPythonä¼šåœ¨æŒ‡å®šçš„è·¯å¾„ä¸‹æœç´¢å¯¹åº”çš„.pyæ–‡ä»¶ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå°±ä¼šæŠ¥é”™ã€‚<br>æœç´¢è·¯å¾„å­˜æ”¾åœ¨sysæ¨¡å—çš„pathå˜é‡ä¸­<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line">print(sys.path)</div></pre></td></tr></table></figure></p>
<p>å½“è¦æ·»åŠ è‡ªå·±çš„æœç´¢ç›®å½•æ—¶å¯ä»¥</p>
<ol>
<li>ç›´æ¥ä¿®æ”¹sys.path:<strong>sys.path.append(â€˜/Users/xxx/xxxâ€™)</strong></li>
<li>è®¾ç½®ç¯å¢ƒå˜é‡PYTHONPATH</li>
</ol>
<p>æœ€åå†æ¬¡æ„Ÿè°¢å»–è€å¸ˆçš„è¾›å‹¤åŠ³åŠ¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 é«˜çº§ç‰¹æ€§]]></title>
      <url>http://zhang759740844.github.io/2016/08/08/python_%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/</url>
      <content type="html"><![CDATA[<p>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<h3 id="åˆ‡ç‰‡"><a href="#åˆ‡ç‰‡" class="headerlink" title="åˆ‡ç‰‡"></a>åˆ‡ç‰‡</h3><p>åˆ‡ç‰‡ï¼ˆSliceï¼‰æ“ä½œç¬¦ç”¨æ¥ç®€åŒ–ç»å¸¸å–æŒ‡å®šç´¢å¼•èŒƒå›´çš„æ“ä½œ<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>L = [<span class="string">'Michael'</span>, <span class="string">'Sarah'</span>, <span class="string">'Tracy'</span>, <span class="string">'Bob'</span>, <span class="string">'Jack'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L[<span class="number">0</span>:<span class="number">3</span>]</div><div class="line">[<span class="string">'Michael'</span>, <span class="string">'Sarah'</span>, <span class="string">'Tracy'</span>]</div></pre></td></tr></table></figure></p>
<p>ä»ç´¢å¼•0å¼€å§‹å–ï¼Œç›´åˆ°ç´¢å¼•3ä¸ºæ­¢ï¼Œä½†ä¸åŒ…æ‹¬ç´¢å¼•3,æ­£å¥½æ˜¯3ä¸ªå…ƒç´ .</p>
<p>å„ç§ç”¨æ³•ç¤ºä¾‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Pythonæ”¯æŒL[-1]å–å€’æ•°ç¬¬ä¸€ä¸ªå…ƒç´ ,åŒæ ·æ”¯æŒå€’æ•°åˆ‡ç‰‡</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L[<span class="number">-2</span>:]</div><div class="line">[<span class="string">'Bob'</span>, <span class="string">'Jack'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L[<span class="number">-2</span>:<span class="number">-1</span>]</div><div class="line">[<span class="string">'Bob'</span>]</div><div class="line"></div><div class="line"><span class="comment"># å‰10ä¸ªæ•°ï¼Œæ¯ä¸¤ä¸ªå–ä¸€ä¸ªï¼š</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L[:<span class="number">10</span>:<span class="number">2</span>]</div><div class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>]</div><div class="line"></div><div class="line"><span class="comment"># æ‰€æœ‰æ•°ï¼Œæ¯5ä¸ªå–ä¸€ä¸ªï¼š</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L[::<span class="number">5</span>]</div><div class="line">[<span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">40</span>, <span class="number">45</span>, <span class="number">50</span>, <span class="number">55</span>, <span class="number">60</span>, <span class="number">65</span>, <span class="number">70</span>, <span class="number">75</span>, <span class="number">80</span>, <span class="number">85</span>, <span class="number">90</span>, <span class="number">95</span>]</div><div class="line"></div><div class="line"><span class="comment"># ä»€ä¹ˆéƒ½ä¸å†™ï¼Œåªå†™[:]å°±å¯ä»¥åŸæ ·å¤åˆ¶ä¸€ä¸ªlist</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>L[:]</div><div class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, ..., <span class="number">99</span>]</div><div class="line"></div><div class="line"><span class="comment"># tupleä¹Ÿæ˜¯ä¸€ç§listï¼Œå”¯ä¸€åŒºåˆ«æ˜¯tupleä¸å¯å˜ã€‚å› æ­¤ï¼Œtupleä¹Ÿå¯ä»¥ç”¨åˆ‡ç‰‡æ“ä½œï¼Œåªæ˜¯æ“ä½œçš„ç»“æœä»æ˜¯tuple</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)[:<span class="number">3</span>]</div><div class="line">(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="comment">#å­—ç¬¦ä¸²'xxx'ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ç§listï¼Œæ¯ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ã€‚å› æ­¤ï¼Œå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥ç”¨åˆ‡ç‰‡æ“ä½œï¼Œåªæ˜¯æ“ä½œç»“æœä»æ˜¯å­—ç¬¦ä¸²ï¼š</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'ABCDEFG'</span>[:<span class="number">3</span>]</div><div class="line"><span class="string">'ABC'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'ABCDEFG'</span>[::<span class="number">2</span>]</div><div class="line"><span class="string">'ACEG'</span></div></pre></td></tr></table></figure></p>
<h3 id="è¿­ä»£"><a href="#è¿­ä»£" class="headerlink" title="è¿­ä»£"></a>è¿­ä»£</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡forå¾ªç¯æ¥éå†è¿™ä¸ªlistæˆ–tupleï¼Œè¿™ç§éå†æˆ‘ä»¬ç§°ä¸ºè¿­ä»£ï¼ˆIterationï¼‰ã€‚åªè¦æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Œæ— è®ºæœ‰æ— ä¸‹æ ‡ï¼Œéƒ½å¯ä»¥è¿­ä»£ã€‚</p>
<p>åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Iterable</div><div class="line">isinstance(<span class="string">'abc'</span>, Iterable)</div></pre></td></tr></table></figure></p>
<h3 id="åˆ—è¡¨ç”Ÿæˆå¼"><a href="#åˆ—è¡¨ç”Ÿæˆå¼" class="headerlink" title="åˆ—è¡¨ç”Ÿæˆå¼"></a>åˆ—è¡¨ç”Ÿæˆå¼</h3><p>æ„Ÿè§‰æ²¡å•¥ç”¨ã€‚</p>
<h3 id="ç”Ÿæˆå™¨"><a href="#ç”Ÿæˆå™¨" class="headerlink" title="ç”Ÿæˆå™¨"></a>ç”Ÿæˆå™¨</h3><p>åˆ—è¡¨å…ƒç´ å¯ä»¥æŒ‰ç…§æŸç§ç®—æ³•åœ¨ä¸æ–­å¾ªç¯çš„è¿‡ç¨‹ä¸­æ¨ç®—å‡ºåç»­å…ƒç´ ï¼Œä¸å¿…åˆ›å»ºå®Œæ•´çš„listï¼ŒèŠ‚çœå¤§é‡ç©ºé—´ã€‚è¿™ç§ä¸€è¾¹å¾ªç¯ä¸€è¾¹è®¡ç®—çš„æœºåˆ¶ï¼Œå«åšgeneratorã€‚<br>ä¾‹å¦‚å®ç°æ–æ³¢é‚£å¥‘å‡½æ•°ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(max)</span>:</span></div><div class="line">    n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></div><div class="line">    <span class="keyword">while</span> n &lt; max:</div><div class="line">        <span class="keyword">yield</span> b</div><div class="line">        a, b = b, a + b</div><div class="line">        n = n + <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'done'</span></div><div class="line">    </div><div class="line"><span class="keyword">for</span> n <span class="keyword">in</span> fib(<span class="number">6</span>):</div><div class="line">	print(n)</div></pre></td></tr></table></figure></p>
<p>å¦‚æœä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸­åŒ…å«yieldå…³é”®å­—ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±ä¸å†æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªgenerator.<br>å‡½æ•°æ˜¯é¡ºåºæ‰§è¡Œï¼Œé‡åˆ°returnè¯­å¥æˆ–è€…æœ€åä¸€è¡Œå‡½æ•°è¯­å¥å°±è¿”å›ã€‚è€Œå˜æˆgeneratorçš„å‡½æ•°ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨next()çš„æ—¶å€™æ‰§è¡Œï¼Œé‡åˆ°yieldè¯­å¥è¿”å›ï¼Œå†æ¬¡æ‰§è¡Œæ—¶ä»ä¸Šæ¬¡è¿”å›çš„yieldè¯­å¥å¤„ç»§ç»­æ‰§è¡Œã€‚</p>
<p>å…¶å®å°±ç›¸å½“äºåœ¨yieldå¤„æœ‰ä¸ªæ–­ç‚¹ï¼Œå¯ä»¥è·å¾—å½“æ—¶çš„yieldå¤„çš„å€¼ï¼Œä¾›forå¾ªç¯å†…ä½¿ç”¨ã€‚</p>
<p>æœ€åå†æ¬¡æ„Ÿè°¢å»–è€å¸ˆçš„è¾›å‹¤åŠ³åŠ¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 æ¨¡å—]]></title>
      <url>http://zhang759740844.github.io/2016/08/08/python_%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<p>å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯ï¼Œå…è®¸æŠŠå‡½æ•°æœ¬èº«ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°ï¼Œè¿˜å…è®¸è¿”å›ä¸€ä¸ªå‡½æ•°ï¼<br>Pythonå¯¹å‡½æ•°å¼ç¼–ç¨‹æä¾›éƒ¨åˆ†æ”¯æŒã€‚ç”±äºPythonå…è®¸ä½¿ç”¨å˜é‡ï¼Œå› æ­¤ï¼ŒPythonä¸æ˜¯çº¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ã€‚</p>
<h3 id="é«˜é˜¶å‡½æ•°"><a href="#é«˜é˜¶å‡½æ•°" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h3><h4 id="å˜é‡å¯ä»¥æŒ‡å‘å‡½æ•°"><a href="#å˜é‡å¯ä»¥æŒ‡å‘å‡½æ•°" class="headerlink" title="å˜é‡å¯ä»¥æŒ‡å‘å‡½æ•°"></a>å˜é‡å¯ä»¥æŒ‡å‘å‡½æ•°</h4><p>æŠŠå‡½æ•°æœ¬èº«èµ‹å€¼ç»™å˜é‡,å³ï¼šå˜é‡å¯ä»¥æŒ‡å‘å‡½æ•°ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f = abs</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f(<span class="number">-10</span>)</div><div class="line"><span class="number">10</span></div></pre></td></tr></table></figure></p>
<p>è¯´æ˜å˜é‡fç°åœ¨å·²ç»æŒ‡å‘äº†abså‡½æ•°æœ¬èº«ã€‚ç›´æ¥è°ƒç”¨abs()å‡½æ•°å’Œè°ƒç”¨å˜é‡f()å®Œå…¨ç›¸åŒã€‚</p>
<h4 id="ä¼ å…¥å‡½æ•°"><a href="#ä¼ å…¥å‡½æ•°" class="headerlink" title="ä¼ å…¥å‡½æ•°"></a>ä¼ å…¥å‡½æ•°</h4><p>é‚£ä¹ˆä¸€ä¸ªå‡½æ•°å°±å¯ä»¥æ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ç§å‡½æ•°å°±ç§°ä¹‹ä¸ºé«˜é˜¶å‡½æ•°<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x, y, f)</span>:</span></div><div class="line">    <span class="keyword">return</span> f(x) + f(y)</div></pre></td></tr></table></figure></p>
<h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><p>map()å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯Iterableï¼Œmapå°†ä¼ å…¥çš„å‡½æ•°ä¾æ¬¡ä½œç”¨åˆ°åºåˆ—çš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶æŠŠç»“æœä½œä¸ºæ–°çš„Iteratorè¿”å›ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></div><div class="line"><span class="meta">... </span>    <span class="keyword">return</span> x * x</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>r = map(f, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list(r)</div><div class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">81</span>]</div></pre></td></tr></table></figure></p>
<h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><p>reduceæŠŠä¸€ä¸ªå‡½æ•°ä½œç”¨åœ¨ä¸€ä¸ªåºåˆ—[x1, x2, x3, â€¦]ä¸Šï¼Œè¿™ä¸ªå‡½æ•°<strong>å¿…é¡»æ¥æ”¶ä¸¤ä¸ªå‚æ•°</strong>ï¼ŒreduceæŠŠç»“æœç»§ç»­å’Œåºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ åšç´¯ç§¯è®¡ç®—ï¼Œå…¶æ•ˆæœå°±æ˜¯ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">reduce(f, [x1, x2, x3, x4]) = f(f(f(x1, x2), x3), x4)</div></pre></td></tr></table></figure></p>
<h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><p>filter()ä¹Ÿæ¥æ”¶ä¸€ä¸ªå‡½æ•°å’Œä¸€ä¸ªåºåˆ—.filter()æŠŠä¼ å…¥çš„å‡½æ•°ä¾æ¬¡ä½œç”¨äºæ¯ä¸ªå…ƒç´ ï¼Œç„¶åæ ¹æ®è¿”å›å€¼æ˜¯Trueè¿˜æ˜¯Falseå†³å®šä¿ç•™è¿˜æ˜¯ä¸¢å¼ƒè¯¥å…ƒç´ ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_odd</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">return</span> n % <span class="number">2</span> == <span class="number">1</span></div><div class="line">list(filter(is_odd, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">15</span>]))</div><div class="line"><span class="comment"># ç»“æœ: [1, 5, 9, 15]</span></div></pre></td></tr></table></figure></p>
<h4 id="sorted"><a href="#sorted" class="headerlink" title="sorted"></a>sorted</h4><p>ä½¿ç”¨sorted()å‡½æ•°å°±å¯ä»¥å¯¹listè¿›è¡Œæ’åºã€‚<br>sorted()å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå®ƒè¿˜å¯ä»¥æ¥æ”¶ä¸€ä¸ªkeyå‡½æ•°æ¥å®ç°è‡ªå®šä¹‰çš„æ’åºï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>sorted([<span class="number">36</span>, <span class="number">5</span>, <span class="number">-12</span>, <span class="number">9</span>, <span class="number">-21</span>], key=abs)</div><div class="line">[<span class="number">5</span>, <span class="number">9</span>, <span class="number">-12</span>, <span class="number">-21</span>, <span class="number">36</span>]</div></pre></td></tr></table></figure></p>
<p><strong>keyæŒ‡å®šçš„å‡½æ•°å°†ä½œç”¨äºlistçš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶æ ¹æ®keyå‡½æ•°è¿”å›çš„ç»“æœè¿›è¡Œæ’åºã€‚å¯¹æ¯”åŸå§‹çš„listå’Œç»è¿‡key=abså¤„ç†è¿‡çš„listï¼š</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">list = [<span class="number">36</span>, <span class="number">5</span>, <span class="number">-12</span>, <span class="number">9</span>, <span class="number">-21</span>]</div><div class="line">keys = [<span class="number">36</span>, <span class="number">5</span>,  <span class="number">12</span>, <span class="number">9</span>,  <span class="number">21</span>]</div></pre></td></tr></table></figure></p>
<h3 id="è¿”å›å‡½æ•°"><a href="#è¿”å›å‡½æ•°" class="headerlink" title="è¿”å›å‡½æ•°"></a>è¿”å›å‡½æ•°</h3><p>é«˜é˜¶å‡½æ•°é™¤äº†æ¥æ”¶å‡½æ•°ä½œä¸ºå‚æ•°å¤–ï¼Œè¿˜èƒ½å°†å‡½æ•°ä½œä¸ºç»“æœè¿”å›ã€‚å¥½å¤„æ˜¯ï¼Œä¸éœ€è¦ç«‹å³æ‰§è¡Œï¼Œåœ¨æƒ³è¦è°ƒç”¨çš„æ—¶å€™æ‰§è¡Œã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">()</span>:</span></div><div class="line">    fs = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>):</div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></div><div class="line">             <span class="keyword">return</span> i*i</div><div class="line">        fs.append(f)</div><div class="line">    <span class="keyword">return</span> fs</div><div class="line"></div><div class="line">f1, f2, f3 = count()</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f1()</div><div class="line"><span class="number">9</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f2()</div><div class="line"><span class="number">9</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f3()</div><div class="line"><span class="number">9</span></div></pre></td></tr></table></figure></p>
<p>æœ¬ä¾‹ä¸­ï¼Œæ‰§è¡Œcount()è¿”å›äº†ä¸€ä¸ªä»¥få‡½æ•°ä½œä¸ºå…ƒç´ çš„æ•°ç»„ï¼Œåˆ†åˆ«èµ‹ç»™f1ï¼Œf2ï¼Œf3ã€‚è¿™é‡Œé¢æ‰§è¡Œä¸‰ä¸ªå‡½æ•°çš„ç»“æœéƒ½æ˜¯9ï¼Œå› ä¸ºå¤–å±‚iåœ¨å¾ªç¯çš„æ—¶å€™å¹¶æ²¡æœ‰æ‰§è¡Œi*iï¼Œå½“å¾ªç¯å®Œåï¼Œiä¸º3ï¼Œç”±äºé—­åŒ…æ€§ï¼Œi=3è¢«ä¿å­˜åœ¨æ ˆä¸­ï¼Œç›´åˆ°å‡½æ•°æ‰§è¡Œã€‚<br>å› æ­¤ï¼Œè¿”å›é—­åŒ…æ—¶ç‰¢è®°çš„ä¸€ç‚¹å°±æ˜¯ï¼šè¿”å›å‡½æ•°ä¸è¦å¼•ç”¨ä»»ä½•å¾ªç¯å˜é‡ï¼Œæˆ–è€…åç»­ä¼šå‘ç”Ÿå˜åŒ–çš„å˜é‡ã€‚</p>
<h3 id="åŒ¿åå‡½æ•°"><a href="#åŒ¿åå‡½æ•°" class="headerlink" title="åŒ¿åå‡½æ•°"></a>åŒ¿åå‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">lambda</span> x: x * x</div><div class="line">=&gt;</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> x * x</div></pre></td></tr></table></figure>
<p>å…³é”®å­—lambdaè¡¨ç¤ºåŒ¿åå‡½æ•°ï¼Œå†’å·å‰é¢çš„xè¡¨ç¤ºå‡½æ•°å‚æ•°ã€‚<br>åŒ¿åå‡½æ•°æœ‰ä¸ªé™åˆ¶ï¼Œå°±æ˜¯<strong>åªèƒ½æœ‰ä¸€ä¸ªè¡¨è¾¾å¼</strong>ï¼Œä¸ç”¨å†™returnï¼Œè¿”å›å€¼å°±æ˜¯è¯¥è¡¨è¾¾å¼çš„ç»“æœã€‚<br>åŒ¿åå‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æŠŠåŒ¿åå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œå†åˆ©ç”¨å˜é‡æ¥è°ƒç”¨è¯¥å‡½æ•°</p>
<h3 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h3><h4 id="ä¸å¸¦å‚æ•°"><a href="#ä¸å¸¦å‚æ•°" class="headerlink" title="ä¸å¸¦å‚æ•°"></a>ä¸å¸¦å‚æ•°</h4><p>åœ¨ä»£ç è¿è¡ŒæœŸé—´åŠ¨æ€å¢åŠ åŠŸèƒ½çš„æ–¹å¼ï¼Œç§°ä¹‹ä¸ºâ€œè£…é¥°å™¨â€ï¼ˆDecoratorï¼‰ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(func)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></div><div class="line">    	<span class="comment"># å‡½æ•°å¯¹è±¡æœ‰ä¸€ä¸ª__name__å±æ€§ï¼Œå¯ä»¥æ‹¿åˆ°å‡½æ•°çš„åå­—</span></div><div class="line">        print(<span class="string">'call %s():'</span> % func.__name__)</div><div class="line">        <span class="keyword">return</span> func(*args, **kw)</div><div class="line">    <span class="keyword">return</span> wrapper</div><div class="line"><span class="meta">@log</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">now</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'2015-3-25'</span>)</div><div class="line">    </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>now()</div><div class="line">call now():</div><div class="line"><span class="number">2015</span><span class="number">-3</span><span class="number">-25</span></div></pre></td></tr></table></figure></p>
<p>æ­¤å¤„æŠŠ<strong>@log</strong>æ”¾åˆ°<strong>now()</strong>å®šä¹‰å¤„ï¼Œç›¸å½“äºæ‰§è¡Œäº†<br><strong>now = log(now)</strong>: <strong>now() =&gt; wrapper()</strong><br>å°†åŸæ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚ç±»ä¼¼äºè£…é¥°è€…æ¨¡å¼ï¼Œåªä¸è¿‡ç”±äºpythonçš„åŠ¨æ€æ€§ï¼Œä¸éœ€è¦è°ƒç”¨æ–°å®šä¹‰çš„æ–¹æ³•ï¼Œåªè¦è°ƒç”¨åŸæ–¹æ³•å°±å¯ä»¥åŠ¨æ€è§£æã€‚</p>
<h4 id="å¸¦å‚æ•°"><a href="#å¸¦å‚æ•°" class="headerlink" title="å¸¦å‚æ•°"></a>å¸¦å‚æ•°</h4><p>å¦‚æœlogå¸¦å‚æ•°<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(text)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorator</span><span class="params">(func)</span>:</span></div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kw)</span>:</span></div><div class="line">            print(<span class="string">'%s %s():'</span> % (text, func.__name__))</div><div class="line">            <span class="keyword">return</span> func(*args, **kw)</div><div class="line">        <span class="keyword">return</span> wrapper</div><div class="line">    <span class="keyword">return</span> decorator</div><div class="line"></div><div class="line"><span class="meta">@log('execute')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">now</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'2015-3-25'</span>)</div></pre></td></tr></table></figure></p>
<p>é¦–å…ˆæ‰§è¡Œlog(â€˜executeâ€™)ï¼Œè¿”å›çš„æ˜¯decoratorå‡½æ•°ï¼Œå†è°ƒç”¨è¿”å›çš„å‡½æ•°ï¼Œå‚æ•°æ˜¯nowå‡½æ•°ï¼Œè¿”å›å€¼æœ€ç»ˆæ˜¯wrapperå‡½æ•°ã€‚å³<strong>now()=&gt;wrapper()</strong></p>
<h4 id="å¸¦æ¥çš„é—®é¢˜"><a href="#å¸¦æ¥çš„é—®é¢˜" class="headerlink" title="å¸¦æ¥çš„é—®é¢˜"></a>å¸¦æ¥çš„é—®é¢˜</h4><p>ä¸Šé¢çš„è¿‡ç¨‹è§£æå·²ç»è¯´æ˜ï¼Œæœ€ånow()çš„è°ƒç”¨ï¼Œéƒ½è½¬åŒ–æˆäº†wrapper()çš„è°ƒç”¨ã€‚é‚£ä¹ˆï¼Œåœ¨è°ƒç”¨<strong>now.<strong>name</strong></strong>æ—¶ï¼Œç»“æœå°±ä¼šä½¿wrapperï¼Œè€Œä¸æ˜¯nowã€‚<br>å› æ­¤ï¼Œéœ€è¦å°†<strong>wrapper.<strong>name</strong> = func.<strong>name</strong></strong>ã€‚å¯ä»¥ä½¿ç”¨pythonå†…ç½®çš„æ–¹æ³•<strong>functools.wraps</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">import functools</div><div class="line">def log(func):</div><div class="line">    @functools.wraps(func)</div><div class="line">    def wrapper(*args, **kw):</div><div class="line">        print(&apos;call %s():&apos; % func.__name__)</div><div class="line">        return func(*args, **kw)</div><div class="line">    return wrapper</div><div class="line"># æˆ–è€…</div><div class="line">import functools</div><div class="line">def log(text):</div><div class="line">    def decorator(func):</div><div class="line">        @functools.wraps(func)</div><div class="line">        def wrapper(*args, **kw):</div><div class="line">            print(&apos;%s %s():&apos; % (text, func.__name__))</div><div class="line">            return func(*args, **kw)</div><div class="line">        return wrapper</div><div class="line">    return decorator</div></pre></td></tr></table></figure>
<h3 id="åå‡½æ•°"><a href="#åå‡½æ•°" class="headerlink" title="åå‡½æ•°"></a>åå‡½æ•°</h3><p>ä½¿ç”¨functools.partialå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªæ–°å‡½æ•°å¯ä»¥å›ºå®šä½åŸå‡½æ•°çš„éƒ¨åˆ†å‚æ•°ï¼Œä»è€Œåœ¨è°ƒç”¨æ—¶æ›´ç®€å•</p>
<p>å‡è®¾è¦è½¬æ¢å¤§é‡çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œæ¯æ¬¡éƒ½ä¼ å…¥int(x, base=2)éå¸¸éº»çƒ¦ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬æƒ³åˆ°ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªint2()çš„å‡½æ•°ï¼Œé»˜è®¤æŠŠbase=2ä¼ è¿›å»ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2</span><span class="params">(x, base=<span class="number">2</span>)</span>:</span></div><div class="line">    <span class="keyword">return</span> int(x, base)</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>functools.partial</strong>åˆ›å»ºä¸€ä¸ªåå‡½æ•°ï¼Œä¸éœ€è¦è‡ªå·±å®šä¹‰int2<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> functools</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>int2 = functools.partial(int, base=<span class="number">2</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>int2(<span class="string">'1000000'</span>)</div><div class="line"><span class="number">64</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>int2(<span class="string">'1010101'</span>)</div><div class="line"><span class="number">85</span></div></pre></td></tr></table></figure></p>
<p>ç®€å•æ€»ç»“functools.partialçš„ä½œç”¨å°±æ˜¯ï¼ŒæŠŠä¸€ä¸ªå‡½æ•°çš„æŸäº›å‚æ•°ç»™å›ºå®šä½ï¼ˆä¹Ÿå°±æ˜¯è®¾ç½®é»˜è®¤å€¼ï¼‰ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè°ƒç”¨è¿™ä¸ªæ–°å‡½æ•°ä¼šæ›´ç®€å•</p>
<p>åˆ›å»ºåå‡½æ•°æ—¶ï¼Œå®é™…ä¸Šå¯ä»¥æ¥æ”¶å‡½æ•°å¯¹è±¡ã€*argså’Œ**kwè¿™3ä¸ªå‚æ•°.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">max2 = functools.partial(max, <span class="number">10</span>)</div></pre></td></tr></table></figure></p>
<p>å®é™…ä¸Šä¼šæŠŠ10ä½œä¸º*argsçš„ä¸€éƒ¨åˆ†<strong>è‡ªåŠ¨åŠ åˆ°å·¦è¾¹</strong>ï¼Œä¹Ÿå°±æ˜¯ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">max2(<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>)</div><div class="line">ç›¸å½“äºï¼š</div><div class="line">args = (<span class="number">10</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>)</div><div class="line">max(*args)</div></pre></td></tr></table></figure></p>
<p>æœ€åå†æ¬¡æ„Ÿè°¢å»–è€å¸ˆçš„è¾›å‹¤åŠ³åŠ¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 åŸºç¡€è¯­æ³•]]></title>
      <url>http://zhang759740844.github.io/2016/08/07/python%E8%AF%AD%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>pythonè¿˜æ˜¯å¤§ä¸€æ—¶å­¦çš„ç¬¬ä¸€é—¨è¯¾ç¼–ç¨‹è¯¾ï¼Œå­¦çš„æ—¶å€™ç”±äºæ²¡æœ‰ç¼–ç¨‹åŸºç¡€ï¼Œæœ€ä¸»è¦çš„æ˜¯å®Œå…¨æ²¡æœ‰å¥½å¥½å­¦ï¼Œå¾ˆç…ç†¬ã€‚ç°åœ¨çœŸæ˜¯æ‚”ä¸å½“åˆã€‚<br>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<p>Pythoné‡‡ç”¨ç¼©è¿›æ–¹å¼,å†™å‡ºæ¥çš„ä»£ç å°±åƒä¸‹é¢çš„æ ·å­ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># print absolute value of an integer:</span></div><div class="line">a = <span class="number">100</span></div><div class="line"><span class="keyword">if</span> a &gt;= <span class="number">0</span>:</div><div class="line">    print(a)</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    print(-a)</div></pre></td></tr></table></figure></p>
<p>ä»¥#å¼€å¤´çš„è¯­å¥æ˜¯æ³¨é‡Š<br>å…¶ä»–æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªè¯­å¥ï¼Œå½“è¯­å¥ä»¥å†’å·:ç»“å°¾æ—¶ï¼Œç¼©è¿›çš„è¯­å¥è§†ä¸ºä»£ç å—.</p>
<h3 id="æ•°æ®ç±»å‹å’Œå˜é‡"><a href="#æ•°æ®ç±»å‹å’Œå˜é‡" class="headerlink" title="æ•°æ®ç±»å‹å’Œå˜é‡"></a>æ•°æ®ç±»å‹å’Œå˜é‡</h3><h4 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h4><p>å­—ç¬¦ä¸²æ˜¯ä»¥å•å¼•å·â€™æˆ–åŒå¼•å·â€æ‹¬èµ·æ¥çš„ä»»æ„æ–‡æœ¬.å¦‚æœå­—ç¬¦ä¸²å†…éƒ¨æ—¢åŒ…å«â€™åˆåŒ…å«â€,å¯ä»¥ç”¨è½¬ä¹‰å­—ç¬¦\æ¥æ ‡è¯†ã€‚<br>è¦è®¡ç®—stråŒ…å«å¤šå°‘ä¸ªå­—ç¬¦ï¼Œå¯ä»¥ç”¨len()å‡½æ•°ã€‚<br>%è¿ç®—ç¬¦å°±æ˜¯ç”¨æ¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå¦‚ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Hello, %s'</span> % <span class="string">'world'</span></div><div class="line"><span class="string">'Hello, world'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Hi, %s, you have $%d.'</span> % (<span class="string">'Michael'</span>, <span class="number">1000000</span>)</div><div class="line"><span class="string">'Hi, Michael, you have $1000000.'</span></div></pre></td></tr></table></figure></p>
<p>æœ‰äº›æ—¶å€™ï¼Œå­—ç¬¦ä¸²é‡Œé¢çš„%æ˜¯ä¸€ä¸ªæ™®é€šå­—ç¬¦æ€ä¹ˆåŠï¼Ÿè¿™ä¸ªæ—¶å€™å°±éœ€è¦è½¬ä¹‰ï¼Œç”¨%%æ¥è¡¨ç¤ºä¸€ä¸ª%.</p>
<h4 id="å¸ƒå°”å€¼"><a href="#å¸ƒå°”å€¼" class="headerlink" title="å¸ƒå°”å€¼"></a>å¸ƒå°”å€¼</h4><p>ä¸€ä¸ªå¸ƒå°”å€¼åªæœ‰Trueã€Falseä¸¤ç§å€¼<br>å¸ƒå°”å€¼å¯ä»¥ç”¨andã€orå’Œnotè¿ç®—ã€‚</p>
<h4 id="ç©ºå€¼"><a href="#ç©ºå€¼" class="headerlink" title="ç©ºå€¼"></a>ç©ºå€¼</h4><p>ç©ºå€¼æ˜¯Pythoné‡Œä¸€ä¸ªç‰¹æ®Šçš„å€¼ï¼Œç”¨Noneè¡¨ç¤ºã€‚</p>
<h4 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h4><p>ç­‰å·=æ˜¯èµ‹å€¼è¯­å¥ï¼Œå¯ä»¥æŠŠä»»æ„æ•°æ®ç±»å‹èµ‹å€¼ç»™å˜é‡ï¼ŒåŒä¸€ä¸ªå˜é‡å¯ä»¥åå¤èµ‹å€¼ï¼Œè€Œä¸”å¯ä»¥æ˜¯ä¸åŒç±»å‹çš„å˜é‡</p>
<h3 id="æ•°ç»„å’Œå…ƒç»„"><a href="#æ•°ç»„å’Œå…ƒç»„" class="headerlink" title="æ•°ç»„å’Œå…ƒç»„"></a>æ•°ç»„å’Œå…ƒç»„</h3><h4 id="list"><a href="#list" class="headerlink" title="list"></a>list</h4><p>listæ˜¯ä¸€ç§<strong>å¯å˜çš„</strong>æœ‰åºçš„é›†åˆï¼Œç”¨len()å‡½æ•°å¯ä»¥è·å¾—listå…ƒç´ çš„ä¸ªæ•°<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">classmates = [<span class="string">'Michael'</span>, <span class="string">'Bob'</span>, <span class="string">'Tracy'</span>]</div></pre></td></tr></table></figure></p>
<p>è¦æŠŠæŸä¸ªå…ƒç´ æ›¿æ¢æˆåˆ«çš„å…ƒç´ ï¼Œå¯ä»¥ç›´æ¥èµ‹å€¼ç»™å¯¹åº”çš„ç´¢å¼•ä½ç½®<br>listé‡Œé¢çš„å…ƒç´ çš„æ•°æ®ç±»å‹ä¹Ÿå¯ä»¥ä¸åŒ<br>åˆ—è¡¨å¯ä»¥çœ‹æˆä¸€ä¸ªå¤šç»´æ•°ç»„ s[2][1]æ‹¿åˆ°å…ƒç´ ã€‚<br>å¦‚æœä¸€ä¸ªlistä¸­ä¸€ä¸ªå…ƒç´ ä¹Ÿæ²¡æœ‰ï¼Œå°±æ˜¯ä¸€ä¸ªç©ºçš„listï¼Œå®ƒçš„é•¿åº¦ä¸º0</p>
<h4 id="tuple"><a href="#tuple" class="headerlink" title="tuple"></a>tuple</h4><p>å¦ä¸€ç§æœ‰åºåˆ—è¡¨å«å…ƒç»„ï¼Œä½†æ˜¯tupleä¸€æ—¦åˆå§‹åŒ–å°±ä¸èƒ½ä¿®æ”¹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">classmates = (<span class="string">'Michael'</span>, <span class="string">'Bob'</span>, <span class="string">'Tracy'</span>)</div></pre></td></tr></table></figure></p>
<p>å› ä¸ºtupleä¸å¯å˜ï¼Œæ‰€ä»¥ä»£ç æ›´å®‰å…¨ã€‚å¦‚æœå¯èƒ½ï¼Œèƒ½ç”¨tupleä»£æ›¿listå°±å°½é‡ç”¨tupleã€‚<br>å½“ä½ å®šä¹‰ä¸€ä¸ªtupleæ—¶ï¼Œåœ¨å®šä¹‰çš„æ—¶å€™ï¼Œtupleçš„å…ƒç´ å°±å¿…é¡»è¢«ç¡®å®šä¸‹æ¥.</p>
<p>å¦‚æœè¦å®šä¹‰ä¸€ä¸ªç©ºçš„tupleï¼Œå¯ä»¥å†™æˆ(),ä½†æ˜¯ï¼Œè¦å®šä¹‰ä¸€ä¸ªåªæœ‰1ä¸ªå…ƒç´ çš„tuple,å¿…é¡»å†™æˆå¦‚ä¸‹<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">t = (<span class="number">1</span>,)</div></pre></td></tr></table></figure></p>
<p>è¿™æ˜¯å› ä¸ºæ‹¬å·()æ—¢å¯ä»¥è¡¨ç¤ºtupleï¼Œåˆå¯ä»¥è¡¨ç¤ºæ•°å­¦å…¬å¼ä¸­çš„å°æ‹¬å·ï¼Œè¿™å°±äº§ç”Ÿäº†æ­§ä¹‰</p>
<h3 id="æ¡ä»¶åˆ¤æ–­"><a href="#æ¡ä»¶åˆ¤æ–­" class="headerlink" title="æ¡ä»¶åˆ¤æ–­"></a>æ¡ä»¶åˆ¤æ–­</h3><p>if-elseè¯­å¥å®ç°ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">age = <span class="number">20</span></div><div class="line"><span class="keyword">if</span> age &gt;= <span class="number">18</span>:</div><div class="line">    print(<span class="string">'your age is'</span>, age)</div><div class="line">    print(<span class="string">'adult'</span>)</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    print(<span class="string">'your age is'</span>, age)</div><div class="line">    print(<span class="string">'teenager'</span>)</div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ä¸è¦å°‘å†™äº†å†’å·:<br>å®Œå…¨å¯ä»¥ç”¨elifåšæ›´ç»†è‡´çš„åˆ¤æ–­,elifæ˜¯else ifçš„ç¼©å†™</p>
<h3 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h3><h4 id="forâ€¦in"><a href="#forâ€¦in" class="headerlink" title="forâ€¦in"></a>forâ€¦in</h4><p>ä¾æ¬¡æŠŠlistæˆ–tupleä¸­çš„æ¯ä¸ªå…ƒç´ è¿­ä»£å‡ºæ¥<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">names = [<span class="string">'Michael'</span>, <span class="string">'Bob'</span>, <span class="string">'Tracy'</span>]</div><div class="line"><span class="keyword">for</span> name <span class="keyword">in</span> names:</div><div class="line">    print(name)</div></pre></td></tr></table></figure></p>
<p>Pythonæä¾›ä¸€ä¸ªrange()å‡½æ•°ï¼Œå¯ä»¥ç”Ÿæˆä¸€ä¸ªæ•´æ•°åºåˆ—ï¼Œå†é€šè¿‡list()å‡½æ•°å¯ä»¥è½¬æ¢ä¸ºlist.åœ¨forâ€¦inä¸­å¯ä»¥ç®€å†™æˆrange()<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sum = <span class="number">0</span></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">101</span>):</div><div class="line">    sum = sum + x</div><div class="line">print(sum)</div></pre></td></tr></table></figure></p>
<h4 id="while"><a href="#while" class="headerlink" title="while"></a>while</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">sum = <span class="number">0</span></div><div class="line">n = <span class="number">99</span></div><div class="line"><span class="keyword">while</span> n &gt; <span class="number">0</span>:</div><div class="line">    sum = sum + n</div><div class="line">    n = n - <span class="number">2</span></div><div class="line">print(sum)</div></pre></td></tr></table></figure>
<h3 id="å®¹å™¨"><a href="#å®¹å™¨" class="headerlink" title="å®¹å™¨"></a>å®¹å™¨</h3><h4 id="dict"><a href="#dict" class="headerlink" title="dict"></a>dict</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d = &#123;<span class="string">'Michael'</span>: <span class="number">95</span>, <span class="string">'Bob'</span>: <span class="number">75</span>, <span class="string">'Tracy'</span>: <span class="number">85</span>&#125;</div></pre></td></tr></table></figure>
<p><strong>è¦ä¿è¯hashçš„æ­£ç¡®æ€§ï¼Œä½œä¸ºkeyçš„å¯¹è±¡å°±ä¸èƒ½å˜ã€‚åœ¨Pythonä¸­ï¼Œå­—ç¬¦ä¸²ã€æ•´æ•°ç­‰éƒ½æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ï¼Œå¯ä»¥æ”¾å¿ƒåœ°ä½œä¸ºkeyã€‚è€Œlistæ˜¯å¯å˜çš„ï¼Œå°±ä¸èƒ½ä½œä¸ºkey</strong></p>
<h4 id="set"><a href="#set" class="headerlink" title="set"></a>set</h4><p>setå’Œdictç±»ä¼¼ï¼Œ<strong>ä¹Ÿæ˜¯ä¸€ç»„keyçš„é›†åˆ</strong>ï¼Œä½†ä¸å­˜å‚¨valueã€‚ç”±äºkeyä¸èƒ½é‡å¤ï¼Œæ‰€ä»¥ï¼Œåœ¨setä¸­ï¼Œæ²¡æœ‰é‡å¤çš„keyã€‚<br>è¦åˆ›å»ºä¸€ä¸ªsetï¼Œéœ€è¦<strong>æä¾›ä¸€ä¸ªlistä½œä¸ºè¾“å…¥é›†åˆ</strong>ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = set([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s</div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</div></pre></td></tr></table></figure></p>
<p>é‡å¤å…ƒç´ åœ¨setä¸­è‡ªåŠ¨è¢«è¿‡æ»¤<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = set([<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s</div><div class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</div></pre></td></tr></table></figure></p>
<p>æœ€åå†æ¬¡æ„Ÿè°¢å»–è€å¸ˆçš„è¾›å‹¤åŠ³åŠ¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python 3.5 å‡½æ•°]]></title>
      <url>http://zhang759740844.github.io/2016/08/07/python_%E5%87%BD%E6%95%B0/</url>
      <content type="html"><![CDATA[<p>å½“æ—¶å­¦çš„æ˜¯2.xç‰ˆæœ¬ï¼Œæœ‰ç‚¹è¿‡æ—¶äº†ï¼Œç°åœ¨çœ‹äº†<a href="http://www.liaoxuefeng.com/" target="_blank" rel="external">å»–é›ªå³°çš„åšå®¢</a>çš„3.5ç‰ˆæœ¬çš„è¯­æ³•ä»‹ç»ï¼Œåšä¸€äº›æ‘˜å½•ã€‚</p>
<a id="more"></a>
<h3 id="è°ƒç”¨å‡½æ•°"><a href="#è°ƒç”¨å‡½æ•°" class="headerlink" title="è°ƒç”¨å‡½æ•°"></a>è°ƒç”¨å‡½æ•°</h3><h4 id="æ•°æ®ç±»å‹è½¬æ¢"><a href="#æ•°æ®ç±»å‹è½¬æ¢" class="headerlink" title="æ•°æ®ç±»å‹è½¬æ¢"></a>æ•°æ®ç±»å‹è½¬æ¢</h4><p>Pythonå†…ç½®çš„å¸¸ç”¨å‡½æ•°è¿˜åŒ…æ‹¬æ•°æ®ç±»å‹è½¬æ¢å‡½æ•°ï¼Œæ¯”å¦‚int()å‡½æ•°å¯ä»¥æŠŠå…¶ä»–æ•°æ®ç±»å‹è½¬æ¢ä¸ºæ•´æ•°</p>
<h4 id="å‡½æ•°å"><a href="#å‡½æ•°å" class="headerlink" title="å‡½æ•°å"></a>å‡½æ•°å</h4><p>å‡½æ•°åå…¶å®å°±æ˜¯æŒ‡å‘ä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„å¼•ç”¨ï¼Œå®Œå…¨å¯ä»¥æŠŠå‡½æ•°åèµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œç›¸å½“äºç»™è¿™ä¸ªå‡½æ•°èµ·äº†ä¸€ä¸ªâ€œåˆ«åâ€<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = abs <span class="comment"># å˜é‡aæŒ‡å‘abså‡½æ•°</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a(<span class="number">-1</span>) <span class="comment"># æ‰€ä»¥ä¹Ÿå¯ä»¥é€šè¿‡aè°ƒç”¨abså‡½æ•°</span></div><div class="line"><span class="number">1</span></div></pre></td></tr></table></figure></p>
<h3 id="å®šä¹‰å‡½æ•°"><a href="#å®šä¹‰å‡½æ•°" class="headerlink" title="å®šä¹‰å‡½æ•°"></a>å®šä¹‰å‡½æ•°</h3><p>å®šä¹‰ä¸€ä¸ªå‡½æ•°è¦ä½¿ç”¨defè¯­å¥ï¼Œä¾æ¬¡å†™å‡ºå‡½æ•°åã€æ‹¬å·ã€æ‹¬å·ä¸­çš„å‚æ•°å’Œå†’å·:ï¼Œç„¶åï¼Œåœ¨ç¼©è¿›å—ä¸­ç¼–å†™å‡½æ•°ä½“ï¼Œå‡½æ•°çš„è¿”å›å€¼ç”¨returnè¯­å¥è¿”å›ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_abs</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">if</span> x &gt;= <span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> x</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> -x</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥ä½¿ç”¨from abstest import my_absæ¥å¯¼å…¥my_abs()å‡½æ•°ï¼Œabstestæ˜¯my_absæ‰€åœ¨çš„æ–‡ä»¶å.</p>
<h4 id="ç©ºå‡½æ•°"><a href="#ç©ºå‡½æ•°" class="headerlink" title="ç©ºå‡½æ•°"></a>ç©ºå‡½æ•°</h4><p>ç”¨passè¯­å¥å®šä¹‰ä¸€ä¸ªä»€ä¹ˆäº‹éƒ½ä¸åšçš„ç©ºå‡½æ•°ï¼Œä¸ç”¨passä¼šæŠ¥é”™ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">nop</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"><span class="comment"># æˆ–è€…    </span></div><div class="line"><span class="keyword">if</span> age &gt;= <span class="number">18</span>:</div><div class="line">    <span class="keyword">pass</span></div></pre></td></tr></table></figure></p>
<h4 id="è¿”å›å¤šä¸ªå€¼"><a href="#è¿”å›å¤šä¸ªå€¼" class="headerlink" title="è¿”å›å¤šä¸ªå€¼"></a>è¿”å›å¤šä¸ªå€¼</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> math</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">move</span><span class="params">(x, y, step, angle=<span class="number">0</span>)</span>:</span></div><div class="line">    nx = x + step * math.cos(angle)</div><div class="line">    ny = y - step * math.sin(angle)</div><div class="line">    <span class="keyword">return</span> nx, ny</div></pre></td></tr></table></figure>
<p>å¾—åˆ°è¿”å›å€¼<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x, y = move(<span class="number">100</span>, <span class="number">100</span>, <span class="number">60</span>, math.pi / <span class="number">6</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(x, y)</div><div class="line"><span class="number">151.96152422706632</span> <span class="number">70.0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>r = move(<span class="number">100</span>, <span class="number">100</span>, <span class="number">60</span>, math.pi / <span class="number">6</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(r)</div><div class="line">(<span class="number">151.96152422706632</span>, <span class="number">70.0</span>)</div></pre></td></tr></table></figure></p>
<p>å…¶å®Pythonå‡½æ•°è¿”å›çš„ä»ç„¶æ˜¯å•ä¸€å€¼.è¿”å›å€¼æ˜¯ä¸€ä¸ªtupleï¼ä½†æ˜¯ï¼Œåœ¨è¯­æ³•ä¸Šï¼Œè¿”å›ä¸€ä¸ªtupleå¯ä»¥çœç•¥æ‹¬å·ï¼Œè€Œå¤šä¸ªå˜é‡å¯ä»¥åŒæ—¶æ¥æ”¶ä¸€ä¸ªtupleï¼ŒæŒ‰ä½ç½®èµ‹ç»™å¯¹åº”çš„å€¼ï¼Œæ‰€ä»¥ï¼ŒPythonçš„å‡½æ•°è¿”å›å¤šå€¼å…¶å®å°±æ˜¯è¿”å›ä¸€ä¸ªtupleï¼Œä½†å†™èµ·æ¥æ›´æ–¹ä¾¿ã€‚</p>
<h3 id="å‡½æ•°çš„å‚æ•°"><a href="#å‡½æ•°çš„å‚æ•°" class="headerlink" title="å‡½æ•°çš„å‚æ•°"></a>å‡½æ•°çš„å‚æ•°</h3><h4 id="é»˜è®¤å‚æ•°"><a href="#é»˜è®¤å‚æ•°" class="headerlink" title="é»˜è®¤å‚æ•°"></a>é»˜è®¤å‚æ•°</h4><p>pythonä¸æ”¯æŒé‡è½½ï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤å‚æ•°çš„æ–¹å¼æ›¿ä»£ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">power</span><span class="params">(x, n=<span class="number">2</span>)</span>:</span></div><div class="line">    s = <span class="number">1</span></div><div class="line">    <span class="keyword">while</span> n &gt; <span class="number">0</span>:</div><div class="line">        n = n - <span class="number">1</span></div><div class="line">        s = s * x</div><div class="line">    <span class="keyword">return</span> s</div></pre></td></tr></table></figure></p>
<p>ç¬¬äºŒä¸ªå‚æ•°nçš„é»˜è®¤å€¼è®¾å®šä¸º2.è¿™æ ·ï¼Œå½“æˆ‘ä»¬è°ƒç”¨power(5)æ—¶ï¼Œç›¸å½“äºè°ƒç”¨power(5, 2).</p>
<p>ä½†æ˜¯éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>å¿…é€‰å‚æ•°åœ¨å‰ï¼Œé»˜è®¤å‚æ•°åœ¨åï¼Œå¦åˆ™Pythonçš„è§£é‡Šå™¨ä¼šæŠ¥é”™ã€‚<strong>å¦‚æœä¸æŒ‰é¡ºåºæä¾›å‚æ•°æ—¶ï¼Œéœ€è¦å†™æˆ å‚æ•°å=xx çš„å½¢å¼ã€‚</strong></li>
<li>é»˜è®¤å‚æ•°å¿…é¡»æŒ‡å‘ä¸å˜å¯¹è±¡ã€‚<br>ä¾‹å¦‚ï¼š<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_end</span><span class="params">(L=[])</span>:</span></div><div class="line">    L.append(<span class="string">'END'</span>)</div><div class="line">    <span class="keyword">return</span> L</div><div class="line">    </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>add_end()</div><div class="line">[<span class="string">'END'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>add_end()</div><div class="line">[<span class="string">'END'</span>, <span class="string">'END'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>add_end()</div><div class="line">[<span class="string">'END'</span>, <span class="string">'END'</span>, <span class="string">'END'</span>]</div></pre></td></tr></table></figure>
</li>
</ol>
<p>å½“Lç¼ºçœåï¼ŒLæŒ‡å‘ä¸€ä¸ªæ•°ç»„å¯¹è±¡çš„åœ°å€ã€‚æ¯æ¬¡appendåï¼Œé‚£ä¸ªåœ°å€çš„æ•°ç»„å…ƒç´ å‘ç”Ÿæ”¹å˜ã€‚</p>
<p>å¦‚æœè¦é»˜è®¤æ˜¯listï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_end</span><span class="params">(L=None)</span>:</span></div><div class="line">    <span class="keyword">if</span> L <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">        L = []</div><div class="line">    L.append(<span class="string">'END'</span>)</div><div class="line">    <span class="keyword">return</span> L</div></pre></td></tr></table></figure></p>
<h4 id="å¯å˜å‚æ•°"><a href="#å¯å˜å‚æ•°" class="headerlink" title="å¯å˜å‚æ•°"></a>å¯å˜å‚æ•°</h4><p>é€šå¸¸å¯ä»¥é€šè¿‡listæˆ–tupleå®ç°ä¼ å…¥ä¸ç¡®å®šæ•°é‡çš„å‚æ•°ã€‚pythonæ”¯æŒå¯å˜å‚æ•°ï¼Œå†™æ³•å¦‚ä¸‹:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(*numbers)</span>:</span></div><div class="line">    sum = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> numbers:</div><div class="line">        sum = sum + n * n</div><div class="line">    <span class="keyword">return</span> sum</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>calc(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line"><span class="number">14</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>calc(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>)</div><div class="line"><span class="number">84</span></div></pre></td></tr></table></figure></p>
<p><strong>å¯å˜å‚æ•°å…è®¸ä½ ä¼ å…¥0ä¸ªæˆ–ä»»æ„ä¸ªå‚æ•°ï¼Œè¿™äº›å¯å˜å‚æ•°åœ¨å‡½æ•°è°ƒç”¨æ—¶è‡ªåŠ¨ç»„è£…ä¸ºä¸€ä¸ªtupleã€‚å› æ­¤æ— æ³•å†å†…éƒ¨å‡½æ•°æ”¹å˜ä¼ å…¥çš„list</strong><br><strong>ä¸æ˜¯å¯å˜å‚æ•°çš„è¯ï¼Œå‚æ•°éœ€è¦ä¸€ä¸€å¯¹åº”</strong></p>
<p>å¦‚æœå·²ç»æœ‰ä¸€ä¸ªlistæˆ–è€…tupleï¼Œè¦è°ƒç”¨ä¸€ä¸ªå¯å˜å‚æ•°å¯ä»¥å†™æˆè¿™æ ·ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(nums)</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(*nums)</div><div class="line"><span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></div><div class="line"><span class="comment"># è°ƒç”¨</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>calc(*nums)</div><div class="line"><span class="number">14</span></div></pre></td></tr></table></figure></p>
<p><strong>numsè¡¨ç¤ºä¸€ä¸ªæ•°ç»„æˆ–è€…å…ƒç»„<br>*numsè¡¨ç¤ºå–å‡ºnumsè¿™ä¸ªlisté‡Œçš„æ‰€æœ‰å…ƒç´ ï¼Œä»£è¡¨å¤šä¸ªå‚æ•°</strong></p>
<h4 id="å…³é”®å­—å‚æ•°"><a href="#å…³é”®å­—å‚æ•°" class="headerlink" title="å…³é”®å­—å‚æ•°"></a>å…³é”®å­—å‚æ•°</h4><p>å…³é”®å­—å‚æ•°å…è®¸ä½ ä¼ å…¥0ä¸ªæˆ–ä»»æ„ä¸ªå«å‚æ•°åçš„å‚æ•°ï¼Œè¿™äº›å…³é”®å­—å‚æ•°åœ¨å‡½æ•°å†…éƒ¨è‡ªåŠ¨ç»„è£…ä¸ºä¸€ä¸ªdictã€‚å¦‚ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># å®šä¹‰å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span><span class="params">(name, age, **kw)</span>:</span></div><div class="line">    print(<span class="string">'name:'</span>, name, <span class="string">'age:'</span>, age, <span class="string">'other:'</span>, kw)</div><div class="line"><span class="comment"># è°ƒç”¨</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>person(<span class="string">'Adam'</span>, <span class="number">45</span>, gender=<span class="string">'M'</span>, job=<span class="string">'Engineer'</span>)</div><div class="line">name: Adam age: <span class="number">45</span> other: &#123;<span class="string">'gender'</span>: <span class="string">'M'</span>, <span class="string">'job'</span>: <span class="string">'Engineer'</span>&#125;</div><div class="line"><span class="comment"># å¦ä¸€ç§ç®€åŒ–å†™æ³•</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>extra = &#123;<span class="string">'city'</span>: <span class="string">'Beijing'</span>, <span class="string">'job'</span>: <span class="string">'Engineer'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>person(<span class="string">'Jack'</span>, <span class="number">24</span>, **extra)</div><div class="line">name: Jack age: <span class="number">24</span> other: &#123;<span class="string">'city'</span>: <span class="string">'Beijing'</span>, <span class="string">'job'</span>: <span class="string">'Engineer'</span>&#125;</div></pre></td></tr></table></figure></p>
<p><strong>kwè¡¨ç¤ºä¸€ä¸ªdict<br>**kwè¡¨ç¤ºå–å‡ºkwä¸­çš„æ‰€æœ‰é”®å€¼å¯¹å…ƒç´ ï¼Œä»£è¡¨å¤šä¸ªå‚æ•°</strong></p>
<p><strong>å¦å¤–ï¼Œå’Œä¸Šé¢çš„listä¼ å…¥çš„æ˜¯tupleä¸€æ ·ï¼Œkwè·å¾—çš„dictæ˜¯å¤–éƒ¨ä¼ å…¥çš„ä¸€ä»½æ‹·è´ï¼Œåœ¨å‡½æ•°å†…éƒ¨å¯¹kwçš„ä¿®æ”¹ä¸ä¼šå½±å“åˆ°å¤–éƒ¨dictã€‚</strong></p>
<h4 id="å‘½åå…³é”®å­—å‚æ•°"><a href="#å‘½åå…³é”®å­—å‚æ•°" class="headerlink" title="å‘½åå…³é”®å­—å‚æ•°"></a>å‘½åå…³é”®å­—å‚æ•°</h4><p>ä¸çŸ¥é“è¿™ä¹ˆè„‘æ®‹çš„è¯­æ³•æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚</p>
<p>æœ€åå†æ¬¡æ„Ÿè°¢å»–è€å¸ˆçš„è¾›å‹¤åŠ³åŠ¨ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[UICollectionView ä½¿ç”¨æ–¹æ³•æ€»ç»“]]></title>
      <url>http://zhang759740844.github.io/2016/08/05/UICollectionView/</url>
      <content type="html"><![CDATA[<p>UICollectionViewæœ€å¼ºå¤§ã€åŒæ—¶æ˜¾è‘—è¶…å‡ºUITableViewçš„ç‰¹è‰²å°±æ˜¯å…¶å®Œå…¨çµæ´»çš„å¸ƒå±€ç»“æ„ã€‚æœ¬ç¯‡å°†å¯¹UICollectionViewçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•è¿›è¡Œæ€»ç»“ã€‚</p>
<a id="more"></a>
<h2 id="è§†å›¾"><a href="#è§†å›¾" class="headerlink" title="è§†å›¾"></a>è§†å›¾</h2><p>UICollectionViewä¸Šé¢æ˜¾ç¤ºå†…å®¹çš„è§†å›¾æœ‰ä¸‰ç§<strong>Cell</strong>è§†å›¾ã€<strong>Supplementary View</strong>å’Œ<strong>Decoration View</strong>ã€‚</p>
<ul>
<li>Cellè§†å›¾<br>CollectionViewä¸­ä¸»è¦çš„å†…å®¹éƒ½æ˜¯ç”±å®ƒå±•ç¤ºçš„ï¼Œå®ƒæ˜¯ä»æ•°æ®æºå¯¹è±¡è·å–çš„ã€‚</li>
<li>Supplementary View<br>å®ƒå±•ç¤ºäº†æ¯ä¸€ç»„å½“ä¸­çš„ä¿¡æ¯ï¼Œä¸cellç±»ä¼¼ï¼Œå®ƒæ˜¯ä»æ•°æ®æºæ–¹æ³•å½“ä¸­è·å–çš„ï¼Œä½†æ˜¯ä¸cellä¸åŒçš„æ˜¯ï¼Œå®ƒå¹¶ä¸æ˜¯å¼ºåˆ¶éœ€è¦çš„ã€‚<br>ä¾‹å¦‚flow layoutå½“ä¸­çš„headerså’Œfooterså°±æ˜¯å¯é€‰çš„Supplementary Viewã€‚</li>
<li>Decoration View<br>è¿™ä¸ªè§†å›¾æ˜¯ä¸€ä¸ªè£…é¥°è§†å›¾ï¼Œå®ƒæ²¡æœ‰ä»€ä¹ˆåŠŸèƒ½æ€§ï¼Œå®ƒä¸è·Ÿæ•°æ®æºæœ‰ä»»ä½•å…³ç³»ï¼Œå®ƒå®Œå…¨å±äºlayoutå¯¹è±¡ã€‚</li>
</ul>
<h2 id="æ³¨å†Œä¸é‡ç”¨"><a href="#æ³¨å†Œä¸é‡ç”¨" class="headerlink" title="æ³¨å†Œä¸é‡ç”¨"></a>æ³¨å†Œä¸é‡ç”¨</h2><h3 id="æ³¨å†Œ"><a href="#æ³¨å†Œ" class="headerlink" title="æ³¨å†Œ"></a>æ³¨å†Œ</h3><p>åœ¨ä½¿ç”¨æ•°æ®æºè¿”å›cellæˆ–è€…Supplementary Viewç»™collectionViewä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆè¦æ³¨å†Œã€‚</p>
<ul>
<li>registerClass: forCellWithReuseIdentifier:</li>
<li>registerNib: forCellWithReuseIdentifier:</li>
<li>registerClass: forSupplementaryViewOfKind: withReuseIdentifier:</li>
<li>registerNib: forSupplementaryViewOfKind: withReuseIdentifier:</li>
</ul>
<p>å‰é¢ä¸¤ä¸ªæ–¹æ³•æ˜¯æ³¨å†Œcellï¼Œåä¸¤ä¸ªæ–¹æ³•æ³¨å†ŒSupplementary Viewã€‚æ³¨å†ŒSupplementary Viewæ—¶éœ€è¦æŒ‡å®šæ˜¯headerviewè¿˜æ˜¯footerã€‚</p>
<h3 id="é‡ç”¨"><a href="#é‡ç”¨" class="headerlink" title="é‡ç”¨"></a>é‡ç”¨</h3><p>æ³¨å†Œåï¼Œè°ƒç”¨ä¸€ä¸‹æ–¹æ³•è¿›è¡Œé‡ç”¨:</p>
<ul>
<li>dequeueReusableCellWithReuseIdentifier:forIndexPath:</li>
<li>dequeueReusableSupplementaryViewOfKind:withReuseIdentifier:forIndexPath:</li>
</ul>
<h2 id="æ•°æ®æºæ–¹æ³•"><a href="#æ•°æ®æºæ–¹æ³•" class="headerlink" title="æ•°æ®æºæ–¹æ³•"></a>æ•°æ®æºæ–¹æ³•</h2><h3 id="åŸºæœ¬æ–¹æ³•"><a href="#åŸºæœ¬æ–¹æ³•" class="headerlink" title="åŸºæœ¬æ–¹æ³•"></a>åŸºæœ¬æ–¹æ³•</h3><p>æ•°æ®æºæ–¹æ³•ä¸UITableViewç±»ä¼¼ï¼Œä¸»è¦æœ‰ï¼š</p>
<ul>
<li>numberOfSectionsInCollectionView:</li>
<li>collectionView: numberOfItemsInSection:</li>
<li>collectionView: cellForItemAtIndexPath:</li>
<li>collectionView: viewForSupplementaryElementOfKind: atIndexPath:</li>
</ul>
<h3 id="æ·»åŠ å¤´éƒ¨å’Œå°¾éƒ¨è§†å›¾"><a href="#æ·»åŠ å¤´éƒ¨å’Œå°¾éƒ¨è§†å›¾" class="headerlink" title="æ·»åŠ å¤´éƒ¨å’Œå°¾éƒ¨è§†å›¾"></a>æ·»åŠ å¤´éƒ¨å’Œå°¾éƒ¨è§†å›¾</h3><p>collection view é¢å¤–ç®¡ç†ç€ä¸¤ç§è§†å›¾ï¼šsupplementary views ï¼Œ Supplementary views ç›¸å½“äº table view çš„ section header å’Œ footer viewsã€‚åƒcellsä¸€æ ·ï¼Œä»–ä»¬çš„å†…å®¹éƒ½ç”±æ•°æ®æºå¯¹è±¡é©±åŠ¨ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">-(<span class="built_in">UICollectionReusableView</span> *)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView viewForSupplementaryElementOfKind:(<span class="built_in">NSString</span> *)kind atIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    <span class="keyword">if</span> ([kind isEqual:<span class="built_in">UICollectionElementKindSectionFooter</span>] ) &#123;</div><div class="line">        MineTicketListReusableView *mineTicketListReusableView = [collectionView dequeueReusableSupplementaryViewOfKind:<span class="built_in">UICollectionElementKindSectionFooter</span> withReuseIdentifier:MineTicketListReusableViewIdentifier forIndexPath:indexPath];</div><div class="line">        mineTicketListReusableView.delegate = <span class="keyword">self</span>;</div><div class="line">        <span class="keyword">return</span> mineTicketListReusableView;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">    	<span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="éƒ¨åˆ†ä»£ç†æ–¹æ³•"><a href="#éƒ¨åˆ†ä»£ç†æ–¹æ³•" class="headerlink" title="éƒ¨åˆ†ä»£ç†æ–¹æ³•"></a>éƒ¨åˆ†ä»£ç†æ–¹æ³•</h2><h3 id="ç§»åŠ¨cell"><a href="#ç§»åŠ¨cell" class="headerlink" title="ç§»åŠ¨cell"></a>ç§»åŠ¨cell</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è¿”å›YESå…è®¸å…¶itemç§»åŠ¨</span></div><div class="line">- (<span class="built_in">BOOL</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView canMoveItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//ç§»åŠ¨itemæ—¶å›è°ƒ</span></div><div class="line">- (<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView moveItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)sourceIndexPath toIndexPath:(<span class="built_in">NSIndexPath</span>*)destinationIndexPath &#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//collectionViewä¸åƒtableViewå¯ä»¥è®¾ç½®setEditingå±æ€§åˆ‡æ¢æ˜¯å¦èƒ½å¤Ÿç¼–è¾‘ï¼Œéœ€è¦å£°æ˜é•¿æŒ‰æ‰‹åŠ¿</span></div><div class="line"><span class="built_in">UILongPressGestureRecognizer</span> *longGesture = [[<span class="built_in">UILongPressGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(handlelongGesture:)];</div><div class="line">    [<span class="keyword">self</span>.collectionView addGestureRecognizer:longGesture];</div><div class="line">    </div><div class="line"><span class="comment">//å†å®ç°æ‰‹åŠ¿æ“ä½œ</span></div><div class="line">- (<span class="keyword">void</span>)handlelongGesture:(<span class="built_in">UILongPressGestureRecognizer</span> *)longGesture &#123;</div><div class="line">    <span class="comment">//åˆ¤æ–­æ‰‹åŠ¿çŠ¶æ€</span></div><div class="line">    <span class="keyword">switch</span> (longGesture.state) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="built_in">UIGestureRecognizerStateBegan</span>:&#123;</div><div class="line">            <span class="comment">//åˆ¤æ–­æ‰‹åŠ¿è½ç‚¹ä½ç½®æ˜¯å¦åœ¨è·¯å¾„ä¸Š</span></div><div class="line">            <span class="built_in">NSIndexPath</span> *indexPath = [<span class="keyword">self</span>.collectionView indexPathForItemAtPoint:[longGesture locationInView:<span class="keyword">self</span>.collectionView]];</div><div class="line">            <span class="keyword">if</span> (indexPath == <span class="literal">nil</span>) &#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//åœ¨è·¯å¾„ä¸Šåˆ™å¼€å§‹ç§»åŠ¨è¯¥è·¯å¾„ä¸Šçš„cell</span></div><div class="line">            [<span class="keyword">self</span>.collectionView beginInteractiveMovementForItemAtIndexPath:indexPath];</div><div class="line">        &#125;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="built_in">UIGestureRecognizerStateChanged</span>:</div><div class="line">            <span class="comment">//ç§»åŠ¨è¿‡ç¨‹å½“ä¸­éšæ—¶æ›´æ–°cellä½ç½®</span></div><div class="line">            [<span class="keyword">self</span>.collectionView updateInteractiveMovementTargetPosition:[longGesture locationInView:<span class="keyword">self</span>.collectionView]];</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="built_in">UIGestureRecognizerStateEnded</span>:</div><div class="line">            <span class="comment">//ç§»åŠ¨ç»“æŸåå…³é—­cellç§»åŠ¨</span></div><div class="line">            [<span class="keyword">self</span>.collectionView endInteractiveMovement];</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            [<span class="keyword">self</span>.collectionView cancelInteractiveMovement];</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ç‚¹å‡»cellé«˜äº®"><a href="#ç‚¹å‡»cellé«˜äº®" class="headerlink" title="ç‚¹å‡»cellé«˜äº®"></a>ç‚¹å‡»cellé«˜äº®</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å…è®¸é€‰ä¸­æ—¶ï¼Œé«˜äº®</span></div><div class="line">-(<span class="built_in">BOOL</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView shouldHighlightItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// é«˜äº®å®Œæˆåå›è°ƒ  </span></div><div class="line"><span class="comment">// æ”¾å¤§ç¼©å°æ•ˆæœ</span></div><div class="line">-(<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView didHighlightItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    <span class="built_in">UICollectionViewCell</span> *selectedCell = [collectionView cellForItemAtIndexPath:indexPath];</div><div class="line">    [<span class="built_in">UIView</span> animateWithDuration:kAnimationDuration animations:^&#123;</div><div class="line">        selectedCell.transform = <span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">2.0</span>f, <span class="number">2.0</span>f);</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç”±é«˜äº®è½¬æˆéé«˜äº®å®Œæˆæ—¶çš„å›è°ƒ  </span></div><div class="line">-(<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView didUnhighlightItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</div><div class="line">    <span class="built_in">UICollectionViewCell</span> *selectedCell = [collectionView cellForItemAtIndexPath:indexPath];</div><div class="line">    [<span class="built_in">UIView</span> animateWithDuration:kAnimationDuration animations:^&#123;</div><div class="line">        selectedCell.transform = <span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">1.0</span>f, <span class="number">1.0</span>f);</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ç‚¹å‡»cellé€‰ä¸­"><a href="#ç‚¹å‡»cellé€‰ä¸­" class="headerlink" title="ç‚¹å‡»cellé€‰ä¸­"></a>ç‚¹å‡»cellé€‰ä¸­</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è®¾ç½®æ˜¯å¦å…è®¸é€‰ä¸­  </span></div><div class="line">- (<span class="built_in">BOOL</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView shouldSelectItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;  </div><div class="line">  <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>, __FUNCTION__);  </div><div class="line">  <span class="keyword">return</span> <span class="literal">YES</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">// è®¾ç½®æ˜¯å¦å…è®¸å–æ¶ˆé€‰ä¸­  </span></div><div class="line">- (<span class="built_in">BOOL</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView shouldDeselectItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;  </div><div class="line">  <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>, __FUNCTION__);  </div><div class="line">  <span class="keyword">return</span> <span class="literal">YES</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">// é€‰ä¸­æ“ä½œ  </span></div><div class="line">- (<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView didSelectItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;  </div><div class="line">  <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>, __FUNCTION__);  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">// å–æ¶ˆé€‰ä¸­æ“ä½œ  </span></div><div class="line">- (<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView didDeselectItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;  </div><div class="line">  <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>, __FUNCTION__);  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="FlowLayoutä»£ç†æ–¹æ³•"><a href="#FlowLayoutä»£ç†æ–¹æ³•" class="headerlink" title="FlowLayoutä»£ç†æ–¹æ³•"></a>FlowLayoutä»£ç†æ–¹æ³•</h2><h3 id="è®¾ç½®æ¯ä¸ªitemå¤§å°"><a href="#è®¾ç½®æ¯ä¸ªitemå¤§å°" class="headerlink" title="è®¾ç½®æ¯ä¸ªitemå¤§å°"></a>è®¾ç½®æ¯ä¸ªitemå¤§å°</h3><ul>
<li>@property (CGSize)itemSize</li>
<li>-collectionView:ayout:sizeForItemAtIndexPath:</li>
</ul>
<p>å¯ä»¥è®¾ç½®å…¨å±€å±æ€§ä¹Ÿå¯ä»¥å¯¹æŸä¸ªcellå®šåˆ¶å°ºå¯¸ã€‚</p>
<h3 id="itemé—´éš”"><a href="#itemé—´éš”" class="headerlink" title="itemé—´éš”"></a>itemé—´éš”</h3><ul>
<li>@property (CGSize) minimumInteritemSpacing</li>
<li>@property (CGSize) minimumLineSpacing</li>
<li>-collectionView:layout:minimumInteritemSpacingForSectionAtIndex:</li>
<li>-collectionView:layout:minimumLineSpacingForSectionAtIndex:</li>
</ul>
<p>åŒitemsizeï¼Œå¯ä»¥è®¾ç½®å…¨å±€å±æ€§ä¹Ÿå¯ä»¥å®šåˆ¶ã€‚</p>
<h3 id="ç¼©è¿›ï¼ˆpaddingï¼‰"><a href="#ç¼©è¿›ï¼ˆpaddingï¼‰" class="headerlink" title="ç¼©è¿›ï¼ˆpaddingï¼‰"></a>ç¼©è¿›ï¼ˆpaddingï¼‰</h3><ul>
<li>@property UIEdgeInsets sectionInset;</li>
<li>-collectionView:layout:insetForSectionAtIndex:</li>
</ul>
<p>åŒä¸Šã€‚</p>
<h3 id="è®¾ç½®headerviewçš„layout"><a href="#è®¾ç½®headerviewçš„layout" class="headerlink" title="è®¾ç½®headerviewçš„layout"></a>è®¾ç½®headerviewçš„layout</h3><ul>
<li>@property (CGSize) headerReferenceSize</li>
<li>@property (CGSize) footerReferenceSize</li>
<li>-collectionView:layout:referenceSizeForHeaderInSection:</li>
<li>-collectionView:layout:referenceSizeForFooterInSection:</li>
</ul>
<p>åŒä¸Šã€‚</p>
<h2 id="UICollectionViewLayoutå­ç±»"><a href="#UICollectionViewLayoutå­ç±»" class="headerlink" title="UICollectionViewLayoutå­ç±»"></a>UICollectionViewLayoutå­ç±»</h2><h2 id="åŸºæœ¬æ–¹æ³•-1"><a href="#åŸºæœ¬æ–¹æ³•-1" class="headerlink" title="åŸºæœ¬æ–¹æ³•"></a>åŸºæœ¬æ–¹æ³•</h2><p>UICollectionViewå’ŒUITableViewæœ€é‡è¦çš„åŒºåˆ«å°±æ˜¯UICollectionViewå¹¶ä¸çŸ¥é“å¦‚ä½•å¸ƒå±€ï¼Œå®ƒæŠŠå¸ƒå±€æœºåˆ¶å§”æ‰˜ç»™äº†UICollectionViewLayoutå­ç±»ï¼Œé»˜è®¤çš„å¸ƒå±€æ–¹å¼æ˜¯UICollectionFlowViewLayoutç±»æä¾›çš„æµå¼å¸ƒå±€ã€‚ä¸è¿‡ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„å¸ƒå±€æ–¹å¼ï¼Œé€šè¿‡ç»§æ‰¿UICollectionViewLayoutã€‚</p>
<p>å­ç±»éœ€è¦è¦†ç›–çˆ¶ç±»ä»¥ä¸‹3ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li>prepareLayout</li>
<li>layoutAttributesForElementsInRect:(CGRect)rect</li>
<li>collectionViewContentSize</li>
</ul>
<hr>
<p>åº”ç”¨åœºæ™¯ç¤ºä¾‹ï¼š<br>ä¸ºäº†å®ç°å¤§å°ä¸åŒçš„cellï¼Œå¯ä»¥åº”ç”¨åœ¨ä¸Šæ–‡å®ç°UICollectionViewDelegateFlowLayoutçš„åè®®æ–¹æ³•collectionView:layout:sizeForItemAtIndexPath:ã€‚ä½†æ˜¯å®ƒä¼šè®¡ç®—æ¯æ’çš„æœ€å¤§é«˜åº¦ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªæµå¼è§†å›¾ã€‚<br>å› æ­¤å°±éœ€è¦ç»§æ‰¿UICollectionViewLayoutæ¥è‡ªå·±å®ç°ä¸€ä¸ªæµå¼å¸ƒå±€çš„æ•ˆæœã€‚</p>
<hr>
<h3 id="void-prepareLayout"><a href="#void-prepareLayout" class="headerlink" title="-(void)prepareLayout"></a>-(void)prepareLayout</h3><p>åˆå§‹åŒ–å‚æ•°</p>
<h3 id="CGSize-collectionViewContentSize"><a href="#CGSize-collectionViewContentSize" class="headerlink" title="-(CGSize)collectionViewContentSize"></a>-(CGSize)collectionViewContentSize</h3><p>å¸ƒå±€é¦–å…ˆè¦æä¾›çš„ä¿¡æ¯å°±æ˜¯æ»šåŠ¨åŒºåŸŸå¤§å°ï¼Œè¿™æ ·collection viewæ‰èƒ½æ­£ç¡®çš„ç®¡ç†æ»šåŠ¨ã€‚å¸ƒå±€å¯¹è±¡å¿…é¡»åœ¨æ­¤æ—¶è®¡ç®—å®ƒå†…å®¹çš„æ€»å¤§å°ï¼ŒåŒ…æ‹¬supplementary viewså’Œdecoration viewsã€‚</p>
<h3 id="NSArray-layoutAttributesForElementsInRect-CGRect-rect"><a href="#NSArray-layoutAttributesForElementsInRect-CGRect-rect" class="headerlink" title="-(NSArray *)layoutAttributesForElementsInRect:(CGRect)rect"></a>-(NSArray *)layoutAttributesForElementsInRect:(CGRect)rect</h3><p>å®ç°å¿…é¡»è¿”å›ä¸€ä¸ªåŒ…å«<strong>UICollectionViewLayoutAttributes</strong>å¯¹è±¡çš„æ•°ç»„.å…¶ä¸­åŒ…æ‹¬ï¼šä¸­å¿ƒ(center)ï¼Œå°ºå¯¸(size)ï¼Œé€æ˜åº¦(alpha)ï¼Œå±‚çº§(zIndex)ï¼ŒåŠ¨ç”»æ•ˆæœ(transform3D),éšè—(hidden)ç­‰ã€‚UICollectionViewLayoutAttributeså¯¹è±¡å†³å®šäº†cellçš„æ‘†è®¾ä½ç½®ï¼ˆframeï¼‰ã€‚</p>
<p>ä¼ å…¥å‚æ•°rectæ˜¯ä¸€ä¸ªåŒ…å«è¦æ˜¾ç¤ºåŒºåŸŸçš„å—ã€‚è¿™ä¸ªå—çš„å¤§å°ä¸€èˆ¬ä¸º2å€çš„collectionviewçš„é•¿åº¦ï¼Œåªæœ‰æ»‘åŠ¨å³å°†è¶…è¿‡rectçš„èŒƒå›´ï¼Œrectæ‰ä¼šæ”¹å˜æ•°å€¼ï¼Œä¿è¯äº†æ˜¾ç¤ºèŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ éƒ½åœ¨rectå†…ã€‚è¿™ä¸ªå‚æ•°åªæ˜¯æ¡†å®šäº†æ˜¾ç¤ºèŒƒå›´ï¼Œè‡ªå®šä¹‰layoutçš„æ—¶å€™å¹¶ä¸éœ€è¦ç”¨åˆ°è¿™ä¸ªå‚æ•°ï¼Œè€Œæ˜¯ä½¿ç”¨contentOffsetç­‰å±æ€§ï¼Œè®¾ç½®ä½ç½®ä¿¡æ¯ã€‚</p>
<h2 id="å…¶ä»–è®¾ç½®"><a href="#å…¶ä»–è®¾ç½®" class="headerlink" title="å…¶ä»–è®¾ç½®"></a>å…¶ä»–è®¾ç½®</h2><h3 id="å¯¹é½"><a href="#å¯¹é½" class="headerlink" title="å¯¹é½"></a>å¯¹é½</h3><ul>
<li><strong>-(CGPoint)targetContentOffsetForProposedContentOffset:withScrollingVelocityï¼š</strong><br>å½“æ‰‹æ”¾å¼€æ—¶è°ƒç”¨ï¼Œè¿”å›å€¼ä»¥åŠå‚æ•°proposedContentOffsetå†³å®šäº†collectionviewåœæ­¢æ»šåŠ¨æ—¶çš„åç§»é‡ã€‚velocityæ˜¯æ»šåŠ¨é€Ÿç‡ï¼Œæœ‰xå’Œyä¸¤ä¸ªåˆ†é‡ï¼Œæ­£è¡¨ç¤ºå‘å³æˆ–å‘ä¸‹è¿åŠ¨ã€‚<br>æ¯æ¬¡ç§»åŠ¨æ•´æ•°ä¸ªviewçš„é•¿åº¦ï¼Œç¤ºä¾‹ä»£ç ï¼š<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGPoint</span>)targetContentOffsetForProposedContentOffset:(<span class="built_in">CGPoint</span>)proposedContentOffset withScrollingVelocity:(<span class="built_in">CGPoint</span>)velocity &#123;</div><div class="line">    <span class="built_in">CGFloat</span> index = roundf((<span class="keyword">self</span>.scrollDirection == <span class="built_in">UICollectionViewScrollDirectionVertical</span> ? proposedContentOffset.y : proposedContentOffset.x)/ _itemHeight);</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.scrollDirection == <span class="built_in">UICollectionViewScrollDirectionVertical</span>) &#123;</div><div class="line">        proposedContentOffset.y = _itemHeight * index;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        proposedContentOffset.x = _itemHeight * index;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> proposedContentOffset;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="å¯¹itemç¼©æ”¾ç¿»è½¬"><a href="#å¯¹itemç¼©æ”¾ç¿»è½¬" class="headerlink" title="å¯¹itemç¼©æ”¾ç¿»è½¬"></a>å¯¹itemç¼©æ”¾ç¿»è½¬</h3><p>åœ¨layoutAttributesForElementsInRect:(CGRect)rectæ–¹æ³•ä¸­è®¾ç½®<strong>transform3D</strong>çš„å€¼ã€‚transform3Dæ˜¯ä¸€ä¸ª4*4çš„çŸ©é˜µï¼Œç”¨æ¥æ§åˆ¶viewçš„å½¢çŠ¶ã€‚å…¶ä¸­ï¼š</p>
<ul>
<li>m11ä¸»è¦è´Ÿè´£xè½´ç¼©æ”¾</li>
<li>m22ä¸»è¦è´Ÿè´£yè½´ç¼©æ”¾</li>
<li>m33ä¸»è¦è´Ÿè´£zè½´ç¼©æ”¾</li>
<li>å…¶ä½™å€¼ç»¼åˆæ§åˆ¶æ—‹è½¬ä¸ç¿»æŠ˜</li>
</ul>
<p>å…·ä½“ä½¿ç”¨æ–¹æ³•ä»¥åå†å†™ã€‚</p>
<h3 id="æ˜¯å¦åˆ·æ–°å¸ƒå±€"><a href="#æ˜¯å¦åˆ·æ–°å¸ƒå±€" class="headerlink" title="æ˜¯å¦åˆ·æ–°å¸ƒå±€"></a>æ˜¯å¦åˆ·æ–°å¸ƒå±€</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">-(<span class="built_in">BOOL</span>)shouldInvalidateLayoutForBoundsChange:(<span class="built_in">CGRect</span>)newBounds</div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> !<span class="built_in">CGRectEqualToRect</span>(newBounds, <span class="keyword">self</span>.collectionView.bounds);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åˆ’å‡ºèŒƒå›´å°±ä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œæ§åˆ¶æ˜¯å¦åˆ·æ–°è§†å›¾ã€‚å¦‚æœè¿”å›noï¼Œé‚£ä¹ˆä¹…ä¸ä¼šå†è°ƒç”¨prepareLayoutä»¥åŠlayoutAttributesForElementsInRectç­‰æ–¹æ³•ã€‚</p>
<h3 id="åˆ é™¤item"><a href="#åˆ é™¤item" class="headerlink" title="åˆ é™¤item"></a>åˆ é™¤item</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-(void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath</div><div class="line">&#123;</div><div class="line">    [self.dataArr removeObjectAtIndex:indexPath.item];</div><div class="line">    //TODO:  è¿™ä¸ªæ–¹æ³• ç‰¹åˆ«æ³¨æ„ åˆ é™¤itemçš„æ–¹æ³•</div><div class="line">    [self.myCollectionView deleteItemsAtIndexPaths:@[indexPath]];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[GCDé˜Ÿåˆ— å­¦ä¹ ä¸æ•´ç†]]></title>
      <url>http://zhang759740844.github.io/2016/08/02/GCD%E9%98%9F%E5%88%97/</url>
      <content type="html"><![CDATA[<p>Grand Central Dispatchæˆ–è€…GCDï¼Œæ˜¯ä¸€å¥—ä½å±‚APIï¼Œæä¾›äº†ä¸€ç§æ–°çš„æ–¹æ³•æ¥è¿›è¡Œå¹¶å‘ç¨‹åºç¼–å†™ã€‚ä»åŸºæœ¬åŠŸèƒ½ä¸Šè®²ï¼ŒGCDæœ‰ç‚¹åƒNSOperationQueueï¼Œä»–ä»¬éƒ½å…è®¸ç¨‹åºå°†ä»»åŠ¡åˆ‡åˆ†ä¸ºå¤šä¸ªå•ä¸€ä»»åŠ¡ç„¶åæäº¤è‡³å·¥ä½œé˜Ÿåˆ—æ¥å¹¶å‘åœ°æˆ–è€…ä¸²è¡Œåœ°æ‰§è¡Œã€‚GCDæ¯”ä¹‹NSOpertionQueueæ›´åº•å±‚æ›´é«˜æ•ˆï¼Œå¹¶ä¸”å®ƒä¸æ˜¯Cocoaæ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚</p>
<a id="more"></a>
<h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><ul>
<li><strong>Serial vs. Concurrent ä¸²è¡Œ vs. å¹¶å‘</strong><br>è¿™äº›æœ¯è¯­æè¿°å½“ä»»åŠ¡ç›¸å¯¹äºå…¶å®ƒä»»åŠ¡è¢«æ‰§è¡Œï¼Œä»»åŠ¡ä¸²è¡Œæ‰§è¡Œå°±æ˜¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªä»»åŠ¡è¢«æ‰§è¡Œï¼Œä»»åŠ¡å¹¶å‘æ‰§è¡Œå°±æ˜¯åœ¨åŒä¸€æ—¶é—´å¯ä»¥æœ‰å¤šä¸ªä»»åŠ¡è¢«æ‰§è¡Œã€‚</li>
<li><strong>Synchronous vs. Asynchronous åŒæ­¥ vs. å¼‚æ­¥</strong><br>åœ¨ GCD ä¸­ï¼Œè¿™äº›æœ¯è¯­æè¿°å½“ä¸€ä¸ªå‡½æ•°ç›¸å¯¹äºå¦ä¸€ä¸ªä»»åŠ¡å®Œæˆï¼Œæ­¤ä»»åŠ¡æ˜¯è¯¥å‡½æ•°è¦æ±‚ GCD æ‰§è¡Œçš„ã€‚ä¸€ä¸ªåŒæ­¥å‡½æ•°åªåœ¨å®Œæˆäº†å®ƒé¢„å®šçš„ä»»åŠ¡åæ‰è¿”å›ã€‚ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œåˆšå¥½ç›¸åï¼Œä¼šç«‹å³è¿”å›ï¼Œé¢„å®šçš„ä»»åŠ¡ä¼šå®Œæˆä½†ä¸ä¼šç­‰å®ƒå®Œæˆã€‚å› æ­¤ï¼Œä¸€ä¸ªå¼‚æ­¥å‡½æ•°ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹å»æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°ã€‚</li>
</ul>
<h3 id="é˜Ÿåˆ—åˆ†ç±»"><a href="#é˜Ÿåˆ—åˆ†ç±»" class="headerlink" title="é˜Ÿåˆ—åˆ†ç±»"></a>é˜Ÿåˆ—åˆ†ç±»</h3><ol>
<li><strong>Serial Queues ä¸²è¡Œé˜Ÿåˆ—</strong><br>è¿™äº›ä»»åŠ¡çš„æ‰§è¡Œæ—¶æœºå—åˆ° GCD çš„æ§åˆ¶ï¼›å”¯ä¸€èƒ½ç¡®ä¿çš„äº‹æƒ…æ˜¯ GCD ä¸€æ¬¡åªæ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶ä¸”æŒ‰ç…§æˆ‘ä»¬æ·»åŠ åˆ°é˜Ÿåˆ—çš„é¡ºåºæ¥æ‰§è¡Œã€‚<br>ç”±äºåœ¨ä¸²è¡Œé˜Ÿåˆ—ä¸­ä¸ä¼šæœ‰ä¸¤ä¸ªä»»åŠ¡å¹¶å‘è¿è¡Œï¼Œå› æ­¤ä¸ä¼šå‡ºç°åŒæ—¶è®¿é—®ä¸´ç•ŒåŒºçš„é£é™©ï¼›ç›¸å¯¹äºè¿™äº›ä»»åŠ¡æ¥è¯´ï¼Œè¿™å°±ä»ç«æ€æ¡ä»¶ä¸‹ä¿æŠ¤äº†ä¸´ç•ŒåŒºï¼Œå®ç°äº†é”çš„åŠŸèƒ½ã€‚</li>
<li><strong>Concurrent Queues å¹¶å‘é˜Ÿåˆ—</strong><br>åœ¨å¹¶å‘é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡èƒ½å¾—åˆ°çš„ä¿è¯æ˜¯å®ƒä»¬ä¼šæŒ‰ç…§è¢«æ·»åŠ çš„é¡ºåºå¼€å§‹æ‰§è¡Œï¼Œä½†è¿™å°±æ˜¯å…¨éƒ¨çš„ä¿è¯äº†ã€‚ä»»åŠ¡å¯èƒ½ä»¥ä»»æ„é¡ºåºå®Œæˆï¼Œä½ ä¸ä¼šçŸ¥é“ä½•æ—¶å¼€å§‹è¿è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œæˆ–è€…ä»»æ„æ—¶åˆ»æœ‰å¤šå°‘ Block åœ¨è¿è¡Œã€‚å†è¯´ä¸€éï¼Œè¿™å®Œå…¨å–å†³äº GCD ã€‚</li>
</ol>
<h3 id="é˜Ÿåˆ—ç±»å‹"><a href="#é˜Ÿåˆ—ç±»å‹" class="headerlink" title="é˜Ÿåˆ—ç±»å‹"></a>é˜Ÿåˆ—ç±»å‹</h3><ol>
<li><strong>The main queue</strong><br>ä¸ä¸»çº¿ç¨‹åŠŸèƒ½ç›¸åŒã€‚å®é™…ä¸Šï¼Œæäº¤è‡³main queueçš„ä»»åŠ¡ä¼šåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œã€‚å› ä¸ºmain queueæ˜¯ä¸ä¸»çº¿ç¨‹ç›¸å…³çš„ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ã€‚ç”±äºæ˜¯ç³»ç»Ÿé»˜è®¤ç”Ÿæˆçš„ï¼Œæ‰€ä»¥æ— æ³•è°ƒç”¨dispatch_resume()å’Œdispatch_suspend()æ¥æ§åˆ¶æ‰§è¡Œç»§ç»­æˆ–ä¸­æ–­ã€‚è¿™æ˜¯åœ¨ä¸€ä¸ªå¹¶å‘é˜Ÿåˆ—ä¸Šå®Œæˆä»»åŠ¡åæ›´æ–° UI çš„å…±åŒé€‰æ‹©ã€‚</li>
<li><strong>Global queues</strong><br>å…¨å±€é˜Ÿåˆ—æ˜¯å¹¶å‘é˜Ÿåˆ—ï¼Œå¹¶ç”±æ•´ä¸ªè¿›ç¨‹å…±äº«ã€‚è¿›ç¨‹ä¸­å­˜åœ¨ä¸‰ä¸ªå…¨å±€é˜Ÿåˆ—ï¼šé«˜ã€ä¸­ï¼ˆé»˜è®¤ï¼‰ã€ä½ä¸‰ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚åŒæ ·æ— æ³•æ§åˆ¶ä¸»çº¿ç¨‹dispatché˜Ÿåˆ—çš„æ‰§è¡Œç»§ç»­æˆ–ä¸­æ–­ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸‰ä¸ªé˜Ÿåˆ—ä¸ä»£è¡¨ä¸‰ä¸ªçº¿ç¨‹ï¼Œå¯èƒ½ä¼šæœ‰æ›´å¤šçš„çº¿ç¨‹ã€‚å¹¶å‘é˜Ÿåˆ—å¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ¥è‡ªåŠ¨äº§ç”Ÿåˆç†çš„çº¿ç¨‹æ•°ã€‚</li>
<li><strong>ç”¨æˆ·é˜Ÿåˆ—</strong><br>ç”¨æˆ·è‡ªå·±åˆ›å»ºçš„é˜Ÿåˆ—ã€‚å¯ä»¥åˆ›å»ºå•çº¿ç¨‹çš„ä¸²è¡Œé˜Ÿåˆ—ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºå¤šçº¿ç¨‹çš„å¹¶è¡Œé˜Ÿåˆ—ã€‚</li>
</ol>
<h3 id="é˜Ÿåˆ—åˆ›å»ºæ–¹å¼"><a href="#é˜Ÿåˆ—åˆ›å»ºæ–¹å¼" class="headerlink" title="é˜Ÿåˆ—åˆ›å»ºæ–¹å¼"></a>é˜Ÿåˆ—åˆ›å»ºæ–¹å¼</h3><ol>
<li><strong>dispatch_queue_t queue = dispatch_queue_create(â€œcom.dispatch.serialâ€, DISPATCH_QUEUE_SERIAL);</strong><br>ç”Ÿæˆä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é˜Ÿåˆ—çš„åç§°ï¼Œåœ¨è°ƒè¯•ç¨‹åºæ—¶ä¼šéå¸¸æœ‰ç”¨ï¼Œæ‰€æœ‰å°½é‡ä¸è¦é‡åã€‚ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºç”Ÿæˆçš„é˜Ÿåˆ—æ˜¯ä¸²è¡Œçš„ï¼Œå¦‚æœä¼ å…¥ null é»˜è®¤æ˜¯ä¸²è¡Œçš„ã€‚</li>
<li><strong>dispatch_queue_t queue = dispatch_queue_create(â€œcom.dispatch.concurrentâ€, DISPATCH_QUEUE_CONCURRENT);</strong><br>ç”Ÿæˆä¸€ä¸ªå¹¶å‘æ‰§è¡Œé˜Ÿåˆ—ã€‚</li>
<li><strong>dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);</strong><br>è·å¾—å…¨å±€é˜Ÿåˆ—ã€‚</li>
<li><strong>dispatch_queue_t queue = dispatch_get_main_queue()</strong><br>è·å¾—ä¸»çº¿ç¨‹é˜Ÿåˆ—ã€‚</li>
</ol>
<h3 id="æäº¤-Job"><a href="#æäº¤-Job" class="headerlink" title="æäº¤ Job"></a>æäº¤ Job</h3><p>å‘ä¸€ä¸ªé˜Ÿåˆ—æäº¤Jobå¾ˆç®€å•ï¼šè°ƒç”¨dispatch_asyncæˆ–dispatch_syncå‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªé˜Ÿåˆ—å’Œä¸€ä¸ªblockã€‚é˜Ÿåˆ—ä¼šåœ¨è½®åˆ°è¿™ä¸ªblockæ‰§è¡Œæ—¶æ‰§è¡Œè¿™ä¸ªblockçš„ä»£ç ã€‚</p>
<ol>
<li><p><strong>dispatch_async</strong><br>dispatch_async å‡½æ•°ä¼šç«‹å³è¿”å›, blockä¼šåœ¨åå°å¼‚æ­¥æ‰§è¡Œã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>), ^&#123;</div><div class="line">        [<span class="keyword">self</span> goDoSomethingLongAndInvolved];</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Done doing something long and involved"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p> åœ¨å…¸å‹çš„Cocoaç¨‹åºä¸­ï¼Œä½ å¾ˆæœ‰å¯èƒ½å¸Œæœ›åœ¨ä»»åŠ¡å®Œæˆæ—¶æ›´æ–°ç•Œé¢ï¼Œè¿™å°±æ„å‘³ç€éœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œä¸€äº›ä»£ç ã€‚ä½ å¯ä»¥ç®€å•åœ°å®Œæˆè¿™ä¸ªä»»åŠ¡â€”â€”ä½¿ç”¨åµŒå¥—çš„dispatchï¼Œåœ¨å¤–å±‚ä¸­æ‰§è¡Œåå°ä»»åŠ¡ï¼Œåœ¨å†…å±‚ä¸­å°†ä»»åŠ¡dispatchåˆ°main queueï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>), ^&#123;</div><div class="line">        [<span class="keyword">self</span> goDoSomethingLongAndInvolved];</div><div class="line">        <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">            [textField setStringValue:<span class="string">@"Done doing something long and involved"</span>];</div><div class="line">        &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><strong>dispatch_sync</strong><br>dispatch_sync åŒæ­¥æ‰§è¡Œ blockï¼Œå‡½æ•°ä¸è¿”å›ï¼Œä¸€ç›´ç­‰åˆ° block æ‰§è¡Œå®Œæ¯•ã€‚ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯åœ¨å½“å‰çº¿ç¨‹ä¸­å®Œæˆï¼Œå› ä¸ºæ´¾å‘åŒæ­¥ä»»åŠ¡ï¼Œæœ¬èº«å°±è¦ç­‰åˆ°ä»»åŠ¡å®Œæˆæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦å†å¼€ä¸€ä¸ªçº¿ç¨‹å»ä¸“é—¨æ‰§è¡Œè¿™ä¸ªåŒæ­¥ä»»åŠ¡ï¼Œæ‰§è¡Œå®Œåï¼Œå†è¿”å›è¯¥çº¿ç¨‹äº†ã€‚ä½†æ˜¯å¦‚æœåœ¨å…¶ä»–çº¿ç¨‹é‡Œå¾€ä¸»é˜Ÿåˆ—é‡Œæ´¾å‘åŒæ­¥ä»»åŠ¡ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒæ­¥ä»»åŠ¡è¿˜æ˜¯ä¼šåœ¨ä¸»çº¿ç¨‹é‡Œæ‰§è¡Œï¼Œå½“å‰çº¿ç¨‹é˜»å¡ã€‚</p>
</li>
</ol>
<p>å®é™…ç¼–ç¨‹ç»éªŒå‘Šè¯‰æˆ‘ä»¬ï¼Œå°½å¯èƒ½é¿å…ä½¿ç”¨ dispatch_syncï¼ŒåµŒå¥—ä½¿ç”¨åŒä¸€ä¸ªé˜Ÿåˆ—æ—¶ææ˜“äº§ç”Ÿç¨‹åºæ­»é”ï¼Œæ¯”å¦‚åµŒå¥—è°ƒç”¨ä¸»çº¿ç¨‹ï¼š</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/gcd_æ­»é”.png?raw=true" alt="gcd_æ­»é”"></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><strong>é˜Ÿåˆ—æ˜¯ä¸²è¡Œæˆ–å¹¶å‘çš„ï¼Œæ“ä½œé˜Ÿåˆ—çš„å‡½æ•°æ˜¯åŒæ­¥æˆ–è€…å¼‚æ­¥æ‰§è¡Œçš„ï¼ˆä¹Ÿå°±æ˜¯åœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œå®Œè¿”å›å’Œç«‹å³è¿”å›å¦å¼€çº¿ç¨‹æ‰§è¡Œçš„åŒºåˆ«ï¼‰ã€‚ä¸²è¡Œé˜Ÿåˆ—å…¶å®å°±ç›¸å½“äºåŠ äº†ä¸€ä¸ªèµ„æºé”ï¼Œæ— è®ºåœ¨å¤šå°‘ä¸ªçº¿ç¨‹é‡Œï¼Œåªæœ‰å½“é˜Ÿåˆ—ä¸­å‰ä¸€ä¸ªå…ƒç´ æ‰§è¡Œå®Œï¼Œåä¸€ä¸ªå…ƒç´ çš„ä»£ç å—æ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œå¹¶è¡Œé˜Ÿåˆ—åˆ™æ²¡æœ‰ä»»ä½•è¦æ±‚ï¼Œæœ‰éœ€è¦æ‰§è¡Œå°±ç«‹å³æ‰§è¡Œã€‚</strong> </p>
<p>æ¯”å¦‚ä¸‹é¢å†™åœ¨ä¸»çº¿ç¨‹é‡Œçš„ç¤ºä¾‹çš„å››ç§ç»„åˆï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++) &#123;  </div><div class="line">    dispatch_(a)sync(queue, ^&#123;  </div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%d___%@"</span>,i, [<span class="built_in">NSThread</span> currentThread]);  </div><div class="line">    &#125;);  </div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"over"</span>);</div></pre></td></tr></table></figure>
<p>ç»“è®º:</p>
<ul>
<li>ä¸²è¡ŒåŒæ­¥é˜Ÿåˆ—ï¼šè¿è¡Œåœ¨ä¸»çº¿ç¨‹é‡Œï¼Œå…ˆä¾æ¬¡æ‰“å° <code>i</code> åï¼Œå†æ‰“å° <code>over</code>ã€‚</li>
<li>ä¸²è¡Œå¼‚æ­¥é˜Ÿåˆ—ï¼šå…ˆæ‰“å° <code>over</code>ï¼Œå†ä¾æ¬¡æ‰“å° <code>i</code>ã€‚ç”±äºæ˜¯å¼‚æ­¥çš„ï¼Œ<code>over</code> æ‰§è¡Œåœ¨ä¸»çº¿ç¨‹é‡Œæ¯‹åº¸ç½®ç–‘ï¼Œæ‰“å° <code>i</code> æ—¶ï¼Œæ–°å»ºäº†ä¸€ä¸ªçº¿ç¨‹ã€‚ä¸ºä»€ä¹ˆæ˜¯ä¸€ä¸ªå‘¢ï¼Ÿå› ä¸ºä¸²è¡Œé˜Ÿåˆ—ï¼Œä»£ç å—ä¾æ¬¡æ‰§è¡Œã€‚åˆ›å»ºæ–°çº¿ç¨‹ï¼Œæ‰§è¡Œï¼Œé”€æ¯ï¼Œå†åˆ›å»ºæ–°çº¿ç¨‹çš„æ“ä½œå¤ªè€—æ—¶ã€‚æ‰€ä»¥ç¼–è¯‘å™¨ä¼˜åŒ–åï¼Œä»…åˆ›å»ºäº†ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚</li>
<li>å¹¶è¡ŒåŒæ­¥é˜Ÿåˆ—ï¼šè¿è¡Œåœ¨ä¸»çº¿ç¨‹é‡Œï¼Œå…ˆä¾æ¬¡æ‰“å° <code>i</code> åï¼Œå†æ‰“å° <code>over</code>ã€‚ç°åœ¨çœ‹èµ·æ¥å’Œä¸²è¡ŒåŒæ­¥é˜Ÿåˆ—ä¸€æ ·å¯¹ä¸å¯¹ï¼Ÿé‚£ä¹ˆä»€ä¹ˆæ—¶å€™æ‰ä¸åŒå‘¢ï¼Ÿå‡å¦‚ä½ æ‰‹åŠ¨å¼€äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶ä¸”åœ¨é‚£ä¸ªçº¿ç¨‹é‡Œï¼Œåˆè¿è¡Œäº†ä¸€éä¸Šé¢çš„ä»£ç ã€‚ä¸²è¡ŒåŒæ­¥é˜Ÿåˆ—ç”±äºæœ‰é”ï¼Œæ‰§è¡Œå½“å‰ä»£ç å—çš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œåªèƒ½ç­‰åˆ°å½“å‰ä»£ç å—æ‰§è¡Œå®Œæ¯•æ‰èƒ½è·³åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ï¼›å¹¶è¡ŒåŒæ­¥é˜Ÿåˆ—æ²¡æœ‰é”ï¼Œå¯èƒ½ä»£ç å—æ²¡æœ‰æ‰§è¡Œå®Œï¼Œç”±äºçº¿ç¨‹çš„æ—¶é—´ç‰‡ç”¨å®Œäº†ï¼Œå°±ç«‹å³è·³åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸Šå»æ‰§è¡Œäº†ã€‚</li>
<li>å¹¶è¡Œå¼‚æ­¥é˜Ÿåˆ—ï¼šå…ˆæ‰“å° <code>over</code>ï¼Œç„¶åçJBæ‰“å°<code>i</code>ã€‚</li>
</ul>
<h3 id="å¸¸ç”¨æ–¹æ³•"><a href="#å¸¸ç”¨æ–¹æ³•" class="headerlink" title="å¸¸ç”¨æ–¹æ³•"></a>å¸¸ç”¨æ–¹æ³•</h3><h4 id="dispatch-apply"><a href="#dispatch-apply" class="headerlink" title="dispatch_apply"></a>dispatch_apply</h4><p>é‡å¤æ‰§è¡Œblockï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªæ–¹æ³•æ˜¯åŒæ­¥è¿”å›ï¼Œä¹Ÿå°±æ˜¯è¯´ç­‰åˆ°æ‰€æœ‰blockæ‰§è¡Œå®Œæ¯•æ‰è¿”å›ã€‚å¤šä¸ªblockçš„è¿è¡Œæ˜¯å¦å¹¶å‘æˆ–ä¸²è¡Œæ‰§è¡Œä¹Ÿä¾èµ–queueçš„æ˜¯å¦å¹¶å‘æˆ–ä¸²è¡Œã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</div><div class="line">dispatch_apply([array count], queue, ^(size_t index)&#123;</div><div class="line">    [<span class="keyword">self</span> doSomethingIntensiveWith:[array objectAtIndex:index]];</div><div class="line">&#125;);</div><div class="line">[<span class="keyword">self</span> doSomethingWith:array];</div></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦å¼‚æ­¥æ‰§è¡Œè¿™äº›ä»£ç ï¼Œåªéœ€è¦ç”¨dispatch_asyncæ–¹æ³•ï¼Œå°†æ‰€æœ‰ä»£ç æ¨è‡³åå°ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</div><div class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</div><div class="line">    dispatch_apply([array count], queue, ^(size_t index)&#123;</div><div class="line">        [<span class="keyword">self</span> doSomethingIntensiveWith:[array objectAtIndex:index]];</div><div class="line">    &#125;);</div><div class="line">    [<span class="keyword">self</span> doSomethingWith:array];</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>é‚£ä½•æ—¶æ‰é€‚åˆç”¨ dispatch_apply å‘¢ï¼Ÿ</p>
<ul>
<li>è‡ªå®šä¹‰ä¸²è¡Œé˜Ÿåˆ—ï¼šä¸²è¡Œé˜Ÿåˆ—ä¼šå®Œå…¨æŠµæ¶ˆ dispatch_apply çš„åŠŸèƒ½ï¼›ä½ è¿˜ä¸å¦‚ç›´æ¥ä½¿ç”¨æ™®é€šçš„ for å¾ªç¯ã€‚</li>
<li>ä¸»é˜Ÿåˆ—ï¼ˆä¸²è¡Œï¼‰ï¼šä¸ä¸Šé¢ä¸€æ ·ï¼Œåœ¨ä¸²è¡Œé˜Ÿåˆ—ä¸Šä¸é€‚åˆä½¿ç”¨ dispatch_apply ã€‚è¿˜æ˜¯ç”¨æ™®é€šçš„ for å¾ªç¯å§ã€‚</li>
<li>å¹¶å‘é˜Ÿåˆ—ï¼šå¯¹äºå¹¶å‘å¾ªç¯æ¥è¯´æ˜¯å¾ˆå¥½é€‰æ‹©ï¼Œç‰¹åˆ«æ˜¯å½“ä½ éœ€è¦è¿½è¸ªä»»åŠ¡çš„è¿›åº¦æ—¶ã€‚</li>
</ul>
<h4 id="dispatch-after"><a href="#dispatch-after" class="headerlink" title="dispatch_after"></a>dispatch_after</h4><p>å»¶è¿Ÿæäº¤ blockï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">double</span> delayInSeconds = <span class="number">1.0</span>; </div><div class="line">dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delayInSeconds * <span class="built_in">NSEC_PER_SEC</span>));</div><div class="line">dispatch_after(popTime, dispatch_get_main_queue(), ^(<span class="keyword">void</span>)&#123;</div><div class="line">     <span class="comment">// code to be executed on the main queue after delay</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>dispatch_after æ˜¯å»¶è¿Ÿæäº¤ï¼Œä¸æ˜¯å»¶è¿Ÿè¿è¡Œï¼Œ<strong>ä¸æ˜¯åœ¨ç‰¹å®šçš„æ—¶é—´åç«‹å³è¿è¡Œï¼</strong>ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ›å»ºä¸²è¡Œé˜Ÿåˆ—</span></div><div class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_queue_create(<span class="string">"me.tutuge.test.gcd"</span>, DISPATCH_QUEUE_SERIAL);</div><div class="line"></div><div class="line"><span class="comment">//ç«‹å³æ‰“å°ä¸€æ¡ä¿¡æ¯</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"Begin add block..."</span>);</div><div class="line"></div><div class="line"><span class="comment">//æäº¤ä¸€ä¸ªblock</span></div><div class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</div><div class="line">    <span class="comment">//Sleep 10ç§’</span></div><div class="line">    [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">10</span>];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"First block done..."</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//5 ç§’ä»¥åæäº¤block</span></div><div class="line">dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">5</span> * <span class="built_in">NSEC_PER_SEC</span>)), queue, ^&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"After..."</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-31</span> <span class="number">20</span>:<span class="number">57</span>:<span class="number">27.122</span> GCDTest[<span class="number">45633</span>:<span class="number">1812016</span>] Begin add block...</div><div class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-31</span> <span class="number">20</span>:<span class="number">57</span>:<span class="number">37.127</span> GCDTest[<span class="number">45633</span>:<span class="number">1812041</span>] First block done...</div><div class="line"><span class="number">2015</span><span class="number">-03</span><span class="number">-31</span> <span class="number">20</span>:<span class="number">57</span>:<span class="number">37.127</span> GCDTest[<span class="number">45633</span>:<span class="number">1812041</span>] After...</div></pre></td></tr></table></figure>
<p>å¯¹äºè¿™ä¸ªä¸²è¡Œçš„é˜Ÿåˆ—ï¼Œå…ˆ async æ‰§è¡Œäº†é˜»å¡10ç§’ï¼Œæ­¤æ—¶ï¼Œæ·»åŠ ä¸€ä¸ª5ç§’çš„å»¶æ—¶ä»»åŠ¡ã€‚ç”±äº5ç§’å‰ä¸€ä¸ªä»»åŠ¡è¿˜æœªè¿”å›ï¼Œæ‰€ä»¥å»¶è¿Ÿä»»åŠ¡ä¸èƒ½ç«‹åˆ»æ‰§è¡Œã€‚å½“å‰ä¸€ä¸ªä»»åŠ¡è¿”å›åï¼Œå»¶è¿Ÿä»»åŠ¡æ‰§è¡Œæ—¶å‘ç°å·²ç»è¿‡äº†é¢„å®šæ—¶é—´ï¼Œé‚£ä¹ˆç«‹å³æ‰§è¡Œã€‚</p>
<h4 id="dispatch-once"><a href="#dispatch-once" class="headerlink" title="dispatch_once"></a>dispatch_once</h4><p>ä¿è¯åœ¨APPè¿è¡ŒæœŸé—´ï¼Œblockä¸­çš„ä»£ç åªæ‰§è¡Œä¸€æ¬¡<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line"><span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">    <span class="comment">// code to be executed once</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>ä¸€å®šè¦æ³¨æ„çš„æ˜¯ <code>dispatch_once_t</code> <strong>å¿…é¡»æ˜¯å…¨å±€æˆ– static å˜é‡</strong>ã€‚å¦åˆ™ä½¿ç”¨æ—¶ä¼šå¯¼è‡´éå¸¸ä¸å¥½æ’æŸ¥çš„ bugã€‚</p>
<h4 id="dispatch-group"><a href="#dispatch-group" class="headerlink" title="dispatch_group"></a>dispatch_group</h4><p>ä¸€ä¸ªdispatch groupå¯ä»¥ç”¨æ¥å°†å¤šä¸ªblockç»„æˆä¸€ç»„ä»¥ç›‘æµ‹è¿™äº›Blockå…¨éƒ¨å®Œæˆæˆ–è€…ç­‰å¾…å…¨éƒ¨å®Œæˆæ—¶å‘å‡ºçš„æ¶ˆæ¯ã€‚</p>
<ul>
<li><em>dispatch_group_create</em>åˆ›å»ºä¸€ä¸ªè°ƒåº¦ä»»åŠ¡ç»„</li>
<li><em>dispatch_group_async</em> æŠŠä¸€ä¸ªä»»åŠ¡å¼‚æ­¥æäº¤åˆ°ä»»åŠ¡ç»„é‡Œ</li>
<li><em>dispatch_group_notify</em> ç”¨æ¥ç›‘å¬ä»»åŠ¡ç»„äº‹ä»¶çš„æ‰§è¡Œå®Œæ¯•</li>
<li><em>dispatch_group_wait</em> è®¾ç½®ç­‰å¾…æ—¶é—´ï¼Œåœ¨ç­‰å¾…æ—¶é—´ç»“æŸåï¼Œå¦‚æœè¿˜æ²¡æœ‰æ‰§è¡Œå®Œä»»åŠ¡ç»„ï¼Œåˆ™è¿”å›ã€‚è¿”å›0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0åˆ™æ‰§è¡Œå¤±è´¥<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</div><div class="line">dispatch_group_t group = dispatch_group_create();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">id</span> obj <span class="keyword">in</span> array)</div><div class="line">    dispatch_group_async(group, queue, ^&#123;</div><div class="line">        [<span class="keyword">self</span> doSomethingIntensiveWith:obj];</div><div class="line">    &#125;);</div><div class="line">dispatch_group_notify(group, queue, ^&#123;</div><div class="line">    [<span class="keyword">self</span> doSomethingWith:array];</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>è¿˜æœ‰ä¸€ä¸ªå‚è€ƒæ–‡ç« ï¼š<br><a href="http://tutuge.me/2015/04/03/something-about-gcd/" target="_blank" rel="external">GCDä½¿ç”¨ç»éªŒä¸æŠ€å·§æµ…è°ˆ</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[å›¾è§£TCP-IPå­¦ä¹ ç¬”è®°]]></title>
      <url>http://zhang759740844.github.io/2016/07/31/%E5%9B%BE%E8%A7%A3TCP_IP/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡æ˜¯å¯¹ã€Šå›¾è§£TCP-IPã€‹ä¸€ä¹¦å­¦ä¹ åæ‘˜å½•çš„ç¬”è®°ã€‚éƒ½æ˜¯ç½‘ç»œä¸­æœ€åŸºç¡€çš„çŸ¥è¯†ã€‚è™½ç„¶æ˜¯å›¾è§£ï¼Œä½†æ˜¯ä¼ å›¾å¤ªéº»çƒ¦ã€‚å°±ä¸æˆªå›¾äº†ã€‚Ë™<br><a id="more"></a></p>
<h2 id="ç½‘ç»œåŸºç¡€çŸ¥è¯†"><a href="#ç½‘ç»œåŸºç¡€çŸ¥è¯†" class="headerlink" title="ç½‘ç»œåŸºç¡€çŸ¥è¯†"></a>ç½‘ç»œåŸºç¡€çŸ¥è¯†</h2><h3 id="åè®®åˆ†å±‚"><a href="#åè®®åˆ†å±‚" class="headerlink" title="åè®®åˆ†å±‚"></a>åè®®åˆ†å±‚</h3><p>ISOåˆ¶å®šäº†å›½é™…æ ‡å‡†OSIï¼Œå¯¹é€šä¿¡ç³»ç»Ÿè¿›è¡Œäº†æ ‡å‡†åŒ–ã€‚</p>
<ul>
<li><strong>åº”ç”¨å±‚</strong>ï¼šé’ˆå¯¹ç‰¹å®šåº”ç”¨çš„åè®®ã€‚</li>
<li><strong>è¡¨ç¤ºå±‚</strong>ï¼šè®¾å¤‡å›ºæœ‰æ•°æ®æ ¼å¼å’Œç½‘ç»œæ ‡å‡†è®¾å±€æ ¼å¼çš„è½¬æ¢ã€‚</li>
<li><strong>ä¼šè¯å±‚</strong>ï¼šé€šä¿¡ç®¡ç†ï¼Œè´Ÿè´£å»ºç«‹å’Œæ–­å¼€é€šä¿¡è¿æ¥ã€‚</li>
<li><strong>ä¼ è¾“å±‚</strong>ï¼šç®¡ç†ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚</li>
<li><strong>ç½‘ç»œå±‚</strong>ï¼šåœ°å€ç®¡ç†å’Œè·¯ç”±é€‰æ‹©ã€‚</li>
<li><strong>æ•°æ®é“¾è·¯å±‚</strong>ï¼šäº’è”è®¾å¤‡é—´ä¼ é€å’Œè¯†åˆ«æ•°æ®å¸§ã€‚</li>
<li><strong>ç‰©ç†å±‚</strong>ï¼š01ä»£è¡¨é«˜ä½å¹³çš„äº’æ¢</li>
</ul>
<h3 id="ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢"><a href="#ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢" class="headerlink" title="ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢"></a>ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢</h3><ul>
<li><strong>ç”µè·¯äº¤æ¢</strong>ï¼šäº¤æ¢æœºè´Ÿè´£æ•°æ®ä¸­è½¬å¤„ç†ã€‚è®¡ç®—æœºé¦–å…ˆè¢«è¿æ¥åˆ°äº¤æ¢æœºä¸Šï¼Œäº¤æ¢æœºä¸äº¤æ¢æœºä¹‹é—´ç”±ä¼—å¤šé€šä¿¡çº¿è·¯å†ç»§ç»­è¿æ¥ã€‚å› æ­¤è®¡ç®—æœºé—´å‘é€æ•°æ®æ—¶ï¼Œéœ€è¦é€šè¿‡äº¤æ¢æœºä¸ç›®æ ‡ä¸»æœºå»ºç«‹é€šä¿¡ç”µè·¯ã€‚å»ºç«‹å¥½åï¼Œå¯ä»¥ä¸€ç›´ä½¿ç”¨è¯¥æ¡ç”µè·¯ï¼Œç›´åˆ°æ–­å¼€è¿æ¥ã€‚ä¸€å°è®¡ç®—æœºåœ¨æ”¶å‘ä¿¡æ¯æ—¶ä¼šç‹¬å æ•´æ¡ç”µè·¯ï¼Œå…¶ä»–è®¡ç®—æœºåªèƒ½ç­‰å¾…è¯¥è®¡ç®—æœºå¤„ç†ç»“æŸã€‚å¦‚ç”µè¯çº¿è·¯ã€‚</li>
<li><strong>åˆ†ç»„äº¤æ¢</strong>ï¼šå°†è¦å‘é€çš„æ•°æ®åˆ†æˆå¤šä¸ªæ•°æ®åŒ…ï¼ŒæŒ‰ç…§ä¸€å®šçš„é¡ºåºæ’åˆ—åå‘é€ã€‚æ•°æ®è¢«ç»†åˆ†åï¼Œæ‰€æœ‰è®¡ç®—æœºå¯ä»¥ä¸€é½å‘é€æ•°æ®ã€‚</li>
</ul>
<h3 id="åœ°å€"><a href="#åœ°å€" class="headerlink" title="åœ°å€"></a>åœ°å€</h3><ul>
<li><strong>MACåœ°å€</strong>ï¼šMACåœ°å€ç”±è®¾å¤‡çš„åˆ¶é€ å‚å•†é’ˆå¯¹æ¯å—ç½‘å¡è¿›è¡Œåˆ¶å®šã€‚é€šè¿‡åˆ¶é€ å•†è¯†åˆ«å·ï¼Œå†…éƒ¨äº§å“ç¼–å·ç­‰ç¡®ä¿MACåœ°å€çš„å”¯ä¸€æ€§ã€‚</li>
<li><strong>IPåœ°å€</strong>ï¼šIPåœ°å€ç”±ç½‘ç»œå·å’Œä¸»æœºå·ä¸¤éƒ¨åˆ†ç»„æˆã€‚å…·æœ‰å±‚æ¬¡æ€§ã€‚</li>
</ul>
<p>MACå¯»å€å‚è€ƒçš„è¡¨å«åœ°å€è½¬å‘è¡¨ï¼ŒIPå¯»å€å‚è€ƒçš„æ˜¯è·¯ç”±æ§åˆ¶è¡¨ã€‚äº¤æ¢æœºé€šè¿‡åœ°å€è½¬å‘è¡¨ï¼Œå°†æ•°æ®è½¬å‘è‡³å¯¹åº”è·¯ç”±å™¨ã€‚è·¯ç”±å™¨é€šè¿‡è·¯ç”±æ§åˆ¶è¡¨å°†æ•°æ®è½¬å‘ç»™å¯¹åº”è·¯ç”±ã€‚å†ç”±è·¯ç”±è½¬å‘ç»™æ¥æ”¶çš„äº¤æ¢æœºï¼Œè¿›è€Œè½¬ç»™æ¥æ”¶çš„ä¸»æœºã€‚ã€‚</p>
<h3 id="ç½‘ç»œçš„æ„æˆå…ƒç´ "><a href="#ç½‘ç»œçš„æ„æˆå…ƒç´ " class="headerlink" title="ç½‘ç»œçš„æ„æˆå…ƒç´ "></a>ç½‘ç»œçš„æ„æˆå…ƒç´ </h3><ul>
<li><strong>ç½‘å¡</strong>ï¼šè®¡ç®—æœºè¿æ¥ç½‘ç»œéœ€è¦ä½¿ç”¨ç½‘å¡ï¼Œå…¨ç§°ï¼šç½‘ç»œæ¥å£å¡(NIC)ã€‚</li>
<li><strong>ä¸­ç»§å™¨</strong>ï¼šOSIæ¨¡å‹ç¬¬ä¸€å±‚ï¼Œç‰©ç†å±‚é¢ä¸Šå»¶é•¿ç½‘è·¯çš„è®¾å¤‡ã€‚å¯¹ç”µç¼†ä¼ æ¥çš„å‡å¼±çš„ä¿¡å·è¿›è¡Œæ”¾å¤§å’Œå‘é€ç»™å¦å¤–ä¸€ä¸ªç”µç¼†çš„è®¾å¤‡ã€‚</li>
<li><strong>ç½‘æ¡¥</strong>ï¼šOSIæ¨¡å‹ç¬¬äºŒå±‚ï¼Œæ•°æ®é“¾è·¯ä¸Šè¿æ¥ä¸¤ä¸ªç½‘ç»œè®¾å¤‡ã€‚èƒ½å¤Ÿè¯†åˆ«æ•°æ®é“¾è·¯å±‚ä¸­çš„æ•°æ®å¸§ï¼Œå°†æ•°æ®å¸§å­˜å‚¨äºå†…å­˜ï¼Œåœ¨é‡æ–°ç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„å¸§è½¬å‘ç»™ç›¸è¿çš„å¦ä¸€ä¸ªç½‘æ®µã€‚</li>
<li><strong>è·¯ç”±å™¨/3å±‚äº¤æ¢æœº</strong>ï¼šOSIç¬¬ä¸‰å±‚ï¼Œè¿æ¥ä¸¤ä¸ªç½‘ç»œï¼Œå¹¶å¯¹åˆ†ç»„æŠ¥æ–‡è¿›è¡Œè½¬å‘çš„è®¾å¤‡ã€‚ç½‘æ¡¥æ›´å…·MACåœ°å€è¿›è¡Œå¤„ç†ï¼Œè€Œè·¯ç”±å™¨/3å±‚äº¤æ¢æœºæ›´å…·IPåœ°å€è¿›è¡Œå¤„ç†ã€‚</li>
<li><strong>4-7å±‚äº¤æ¢æœº</strong>ï¼šè´Ÿè´£å¤„ç†OSIæ¨¡å‹ä¸­ä»ä¼ è¾“å±‚åˆ°åº”ç”¨å±‚çš„æ•°æ®ã€‚</li>
<li><strong>ç½‘å…³</strong>ï¼šè´Ÿè´£OSIä¼ è¾“å±‚åˆ°åº”ç”¨å±‚çš„æ•°æ®è¿›è¡Œè½¬æ¢å’Œè½¬å‘çš„è®¾å¤‡ã€‚è¿˜å¯ä»¥æ ¹æ®ä¸¤ä¸ªä¸èƒ½é€šè¡Œçš„åè®®ä¹‹é—´è¿›è¡Œç¿»è¯‘ï¼Œæœ€ç»ˆå®ç°ä¸¤è€…çš„é€šä¿¡ã€‚ä»£ç†æœåŠ¡å™¨ä¹Ÿæ˜¯ç½‘å…³çš„ä¸€ç§ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é—´ä¸æ˜¯åœ¨ç½‘ç»œå±‚ä¸Šç›´æ¥é€šä¿¡ï¼Œè€Œæ˜¯ä»ä¼ è¾“å±‚åˆ°åº”ç”¨å±‚å¯¹æ•°æ®çš„è®¿é—®è¿›è¡Œå„ç§æ§åˆ¶å’Œå¤„ç†ã€‚é˜²ç«å¢™ä¹Ÿæ˜¯ä¸€ç§ç½‘å…³ã€‚</li>
</ul>
<h2 id="TCP-IPåŸºç¡€çŸ¥è¯†"><a href="#TCP-IPåŸºç¡€çŸ¥è¯†" class="headerlink" title="TCP/IPåŸºç¡€çŸ¥è¯†"></a>TCP/IPåŸºç¡€çŸ¥è¯†</h2><h3 id="TCP-IPæ¨¡å‹"><a href="#TCP-IPæ¨¡å‹" class="headerlink" title="TCP/IPæ¨¡å‹"></a>TCP/IPæ¨¡å‹</h3><ul>
<li><strong>ç¡¬ä»¶(ç‰©ç†å±‚)</strong></li>
<li><strong>ç½‘ç»œæ¥å£å±‚(æ•°æ®é“¾è·¯å±‚)</strong></li>
<li><strong>äº’è”ç½‘å±‚(ç½‘ç»œå±‚)</strong><ul>
<li>IPï¼šè·¨è¶Šç½‘ç»œå‘é€æ•°æ®åŒ…ï¼Œä½¿æ•´ä¸ªäº’è”ç½‘éƒ½èƒ½æ”¶åˆ°æ•°æ®çš„åè®®ã€‚</li>
<li>ICMPï¼šIPæ•°æ®åŒ…å‘é€é€”ä¸­å‡ºç°å¼‚å¸¸æ— æ³•å‘é€åˆ°ç›®æ ‡åœ°å€æ—¶ï¼Œç»™å‘é€ç«¯ä¸€ä¸ªå¼‚å¸¸é€šçŸ¥ã€‚ICMPå°±æ˜¯ä¸ºè¿™ä¸€åŠŸèƒ½å®šåˆ¶çš„</li>
<li>ARPï¼šä»åˆ†ç»„æ•°æ®åŒ…çš„IPåœ°å€è§£æå‡ºç‰©ç†åœ°å€(MACåœ°å€)çš„ä¸€ç§åè®®ã€‚</li>
</ul>
</li>
<li><strong>ä¼ è¾“å±‚</strong><ul>
<li>TCPï¼šé¢å‘è¿æ¥çš„ä¼ è¾“å±‚åè®®ã€‚å¯ä»¥ä¿è¯ä¸¤ç«¯é€šä¿¡ä¸»æœºé—´çš„é€šä¿¡å¯è¾¾ã€‚</li>
<li>UDPï¼šé¢å‘æ— è¿æ¥çš„ä¼ è¾“å±‚åè®®ã€‚</li>
</ul>
</li>
<li><strong>åº”ç”¨å±‚(ä¼šè¯å±‚ä»¥ä¸Šçš„åˆ†å±‚)</strong><ul>
<li>WWW</li>
<li>ç”µå­é‚®ä»¶(E-Mail)</li>
<li>æ–‡ä»¶ä¼ è¾“(FTP)</li>
<li>è¿œç¨‹ç™»å½•(TELNET,SSH)</li>
<li>ç½‘ç»œç®¡ç†(SNMP)</li>
</ul>
</li>
</ul>
<h2 id="æ•°æ®é“¾è·¯"><a href="#æ•°æ®é“¾è·¯" class="headerlink" title="æ•°æ®é“¾è·¯"></a>æ•°æ®é“¾è·¯</h2><h3 id="æ•°æ®é“¾è·¯çš„ä½œç”¨"><a href="#æ•°æ®é“¾è·¯çš„ä½œç”¨" class="headerlink" title="æ•°æ®é“¾è·¯çš„ä½œç”¨"></a>æ•°æ®é“¾è·¯çš„ä½œç”¨</h3><p>æ•°æ®é“¾è·¯å±‚å®šä¹‰äº†ä¸€ä¸ªé€šè¿‡é€šä¿¡åª’ä»‹äº’è¿çš„è®¾å¤‡ä¹‹é—´ä¼ è¾“çš„è§„èŒƒã€‚</p>
<p>æ•°æ®é“¾è·¯çš„<strong>æ®µ</strong>æ˜¯æŒ‡ä¸€ä¸ªè¢«åˆ†å‰²çš„ç½‘ç»œã€‚å¼•å…¥ä¸­ç»§å™¨ï¼Œå°†ä¸¤æ¡ç½‘çº¿è¿æ¥ç»„æˆä¸€ä¸ªç½‘ç»œã€‚</p>
<p>ç½‘ç»œçš„è¿æ¥å’Œæ„æˆå½¢æ€æˆä¸º<strong>ç½‘ç»œæ‹“æ‰‘</strong>ã€‚</p>
<h3 id="æ•°æ®é“¾è·¯ç›¸å…³æŠ€æœ¯"><a href="#æ•°æ®é“¾è·¯ç›¸å…³æŠ€æœ¯" class="headerlink" title="æ•°æ®é“¾è·¯ç›¸å…³æŠ€æœ¯"></a>æ•°æ®é“¾è·¯ç›¸å…³æŠ€æœ¯</h3><p><strong>å…±äº«ä»‹è´¨å‹ç½‘ç»œ</strong>ï¼šå¤šä¸ªè®¾å¤‡å…±äº«ä¸€ä¸ªé€šä¿¡ä»‹è´¨çš„ä¸€ç§ç½‘ç»œã€‚å…±äº«ä»‹è´¨ç½‘ç»œä¸¤ç§è®¿é—®æ–¹å¼ï¼šäº‰ç”¨æ–¹å¼ï¼Œä»¤ç‰Œä¼ é€’æ–¹å¼ã€‚æ—©æœŸä»¥å¤ªç½‘å°±æ˜¯å…±äº«ä»‹è´¨å‹ç½‘ç»œã€‚</p>
<p><strong>éå…±äº«ä»‹è´¨ç½‘ç»œ</strong>ï¼šç½‘ç»œä¸­æ¯ä¸ªç«™ç›´è¿äº¤æ¢æœºï¼Œç”±äº¤æ¢æœºè½¬å‘æ•°æ®å¸§ã€‚æ­¤æ–¹æ³•ä¸‹ï¼Œå‘é€ç«¯å’Œæ¥æ”¶ç«¯å¹¶ä¸å…±äº«é€šä¿¡ä»‹è´¨ã€‚</p>
<p>ä»¥å¤ªç½‘äº¤æ¢æœºæ˜¯æŒæœ‰å¤šä¸ªç«¯å£çš„ç½‘æ¡¥ï¼Œæ ¹æ®æ•°æ®é“¾è·¯å±‚ä¸­æ¯ä¸ªå¸§çš„ç›®æ ‡MACåœ°å€ï¼Œå†³å®šä»å“ªä¸ªç½‘ç»œæ¥å£å‘é€æ•°æ®ã€‚è¿™æ—¶æ‰€å‚è€ƒçš„ï¼Œç”¨ä»¥è®°å½•å‘é€æ¥å£çš„è¡¨å°±æ˜¯è½¬å‘è¡¨ã€‚</p>
<h3 id="ä»¥å¤ªç½‘"><a href="#ä»¥å¤ªç½‘" class="headerlink" title="ä»¥å¤ªç½‘"></a>ä»¥å¤ªç½‘</h3><p>ä¼—å¤šæ•°æ®é“¾è·¯ä¸­æœ€è‘—åï¼Œä½¿ç”¨æœ€å¹¿å‘çš„æ˜¯ä»¥å¤ªç½‘ã€‚</p>
<h2 id="IPåè®®"><a href="#IPåè®®" class="headerlink" title="IPåè®®"></a>IPåè®®</h2><h3 id="IPå³ç½‘ç»œåè®®"><a href="#IPå³ç½‘ç»œåè®®" class="headerlink" title="IPå³ç½‘ç»œåè®®"></a>IPå³ç½‘ç»œåè®®</h3><p>ç½‘ç»œå±‚çš„ä¸‹ä¸€å±‚â€”â€”æ•°æ®é“¾è·¯å±‚ä¸»è¦ä½œç”¨æ˜¯åœ¨äº’è¿<strong>åŒä¸€ç§æ•°æ®é“¾è·¯èŠ‚ç‚¹</strong>ä¹‹é—´è¿›è¡ŒåŒ…ä¼ é€’ã€‚è€Œä¸€æ—¦è·¨è¶Šå¤šç§æ•°æ®é“¾è·¯ï¼Œå°±éœ€è¦å€ŸåŠ©ç½‘ç»œå±‚ã€‚ç½‘ç»œå±‚å¯ä»¥è·¨è¶Šä¸åŒæ•°æ®é“¾è·¯ï¼Œå³ä½¿åœ¨ä¸åŒæ•°æ®é“¾è·¯ä¸Šä¹Ÿèƒ½å®ç°ä¸¤ç«¯èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®åŒ…ä¼ è¾“ã€‚</p>
<p>é…æœ‰IPçš„åœ°å€çš„è®¾å¤‡ç§°ä¸ºä¸»æœºã€‚å’Œè·¯ç”±å™¨ä¸åŒï¼Œè·¯ç”±å™¨å³é…æœ‰IPåœ°å€ï¼Œåˆå…·æœ‰è·¯ç”±æ§åˆ¶èƒ½åŠ›ã€‚èŠ‚ç‚¹æ˜¯ä¸»æœºå’Œè·¯ç”±å™¨çš„ç»Ÿç§°ã€‚</p>
<p><strong>ç½‘ç»œå±‚ä¸æ•°æ®é“¾è·¯å±‚å…³ç³»</strong>ï¼šæ•°æ®é“¾è·¯å±‚æä¾›ç›´è¿ä¸¤ä¸ªè®¾å¤‡çš„èƒ½åŠ›ã€‚ä¸ä¹‹ç›¸æ¯”ï¼Œç½‘ç»œå±‚çš„IPåˆ™è´Ÿè´£åœ¨æ²¡æœ‰ç›´è¿çš„ä¸¤ä¸ªç½‘ç»œä¹‹é—´è¿›è¡Œé€šä¿¡ä¼ è¾“ã€‚æ¯”å¦‚æ—…è¡Œï¼Œæ•°æ®é“¾è·¯ç›¸å½“äºå„ä¸ªä¸­è½¬çš„ç«è½¦ç¥¨ï¼Œè€ŒIPç›¸å½“äºçœŸä¸ªæ—…è¡Œè¡¨ã€‚æ²¡æœ‰è½¦ç¥¨ï¼Œæ— æ³•è¾¾åˆ°ç›®çš„åœ°ï¼Œæ²¡æœ‰æ—…è¡Œè¡¨ï¼Œåˆ™ä¸çŸ¥é“åšä»€ä¹ˆè½¦ã€‚</p>
<h3 id="IPåŸºç¡€çŸ¥è¯†"><a href="#IPåŸºç¡€çŸ¥è¯†" class="headerlink" title="IPåŸºç¡€çŸ¥è¯†"></a>IPåŸºç¡€çŸ¥è¯†</h3><p>IPå¤§è‡´åˆ†ä¸ºä¸‰å¤§æ¨¡å—ï¼ŒIPå¯»å€ï¼Œè·¯ç”±ï¼ŒIPåˆ†åŒ…å’Œç»„åŒ…ã€‚</p>
<p>ä¸ºè¯†åˆ«é€šä¿¡å¯¹ç«¯ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªç±»ä¼¼äºåœ°å€çš„è¯†åˆ«ç è¿›è¡Œæ ‡è¯†ã€‚MACåœ°å€æ­£æ˜¯ç”¨æ¥æ ‡è¯†åŒä¸€ä¸ªé“¾è·¯ä¸­ä¸åŒè®¡ç®—æœºçš„ä¸€ç§è¯†åˆ«ç ã€‚IPä¹Ÿæœ‰è¿™ç§åœ°å€ä¿¡æ¯ï¼Œç”¨äºåœ¨è¿æ¥åˆ°ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºä¸­è¯†åˆ«å‡ºè¿›è¡Œé€šä¿¡çš„ç›®æ ‡åœ°å€ã€‚å› æ­¤ï¼ŒTCP/IPä¸­æ‰€æœ‰ä¸»æœºæˆ–è·¯ç”±å¿…é¡»è®¾å®šè‡ªå·±çš„IPåœ°å€ã€‚</p>
<p>è·¯ç”±æ§åˆ¶å°†åˆ†ç»„æ•°æ®å‘é€åˆ°æœ€ç»ˆç›®æ ‡åœ°å€ã€‚ä¸ºäº†å°†æ•°æ®å‘ç»™ç›®æ ‡ä¸»æœºï¼Œæ‰€æœ‰ä¸»æœºéƒ½ç»´æŠ¤ç€ä¸€å¼ è·¯ç”±æ§åˆ¶è¡¨ã€‚è¯¥è¡¨è®°å½•IPæ•°æ®åœ¨ä¸‹ä¸€æ­¥åº”è¯¥å‘ç»™å“ªä¸ªè·¯ç”±å™¨ã€‚IPåŒ…å°†æ›´å…·è¿™ä¸ªè·¯ç”±è¡¨åœ¨å„ä¸ªæ•°æ®é“¾è·¯ä¸Šä¼ è¾“ã€‚</p>
<p>IPæ˜¯å®ç°å¤šä¸ªæ•°æ®é“¾è·¯ä¹‹é—´é€šä¿¡çš„åè®®ã€‚æ•°æ®é“¾è·¯æ ¹æ®ç§ç±»ä¸åŒå„æœ‰ç‰¹ç‚¹ã€‚ä¸åŒæ•°æ®é“¾è·¯æœ€å¤§åŒºåˆ«åœ¨äºå®ƒä»¬å„è‡ªçš„æœ€å¤§ä¼ è¾“å•ä½ä¸åŒã€‚ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒIPè¿›è¡Œåˆ†ç‰‡å¤„ç†ã€‚å°†è¾ƒå¤§çš„IPåŒ…åˆ†æˆå¤šä¸ªè¾ƒå°çš„IPåŒ…ï¼Œåˆ°è¾¾å¯¹ç«¯ç›®æ ‡åœ°å€åå†ç»„åˆä¼ è¾“ç»™ä¸Šä¸€å±‚ã€‚</p>
<h3 id="IPåœ°å€çš„åŸºç¡€çŸ¥è¯†"><a href="#IPåœ°å€çš„åŸºç¡€çŸ¥è¯†" class="headerlink" title="IPåœ°å€çš„åŸºç¡€çŸ¥è¯†"></a>IPåœ°å€çš„åŸºç¡€çŸ¥è¯†</h3><p>IPåœ°å€ç”±ç½‘ç»œæ ‡è¯†å’Œä¸»æœºæ ‡è¯†ç»„æˆã€‚ç½‘ç»œæ ‡è¯†å¿…é¡»ä¿è¯ç›¸äº’è¿æ¥çš„æ¯ä¸ªæ®µçš„åœ°å€ä¸é‡å¤ã€‚è€Œç›¸åŒæ®µå†…ç›¸è¿çš„ä¸»æœºå¿…é¡»æœ‰ç›¸åŒçš„ç½‘ç»œåœ°å€ã€‚IPåœ°å€çš„â€œä¸»æœºæ ‡è¯†â€åˆ™ä¸å…è®¸åœ¨åŒä¸€ä¸ªç½‘æ®µå†…é‡å¤å‡ºç°ã€‚</p>
<p>IPåœ°å€çš„åˆ†ç±»ï¼š</p>
<ol>
<li>Aç±»ï¼šä»¥0å¼€å¤´çš„åœ°å€ï¼Œå³0.0.0.0-127.0.0.0ï¼Œåœ°å€å24ä½ä¸ºä¸»æœºæ ‡è¯†</li>
<li>Bç±»ï¼šä»¥10å¼€å¤´çš„åœ°å€ï¼Œå³128.0.0.1-191.255.0.0 åœ°å€å16ä¸ºä¸ºä¸»æœºæ ‡è¯†</li>
<li>Cç±»ï¼šä»¥110å¼€å¤´çš„åœ°å€ï¼Œå³192.168.0.0-239.255.255.0 åœ°å€å8ä½ä¸ºä¸»æœºæ ‡è¯†</li>
<li>Dç±»ï¼šä»¥1110å¼€å¤´çš„åœ°å€ï¼Œå³224.0.0.0-239.255.255.255 æ— ä¸»æœºæ ‡è¯†ï¼Œå¤šç”¨äºå¤šæ’­ã€‚</li>
</ol>
<p><strong>å¹¿æ’­åœ°å€</strong>ç”¨äºåœ¨åŒä¸€ä¸ªé“¾è·¯ä¸­äº’ç›¸è¿æ¥çš„ä¸»æœºé—´å‘é€æ•°æ®ã€‚å°†ä¸»æœºåœ°å€éƒ¨åˆ†å…¨éƒ¨è®¾ç½®ä¸º1ï¼Œå°±æˆäº†å¹¿æ’­åœ°å€ã€‚</p>
<p><strong>å¤šæ’­</strong>ç”¨äºå°†åŒ…å‘é€ç»™ç‰¹å®šç»„å†…çš„æ‰€æœ‰ä¸»æœºã€‚å‡¡æ˜¯ä»¥1110å¼€å¤´çš„éƒ½æ˜¯å¤šæ’­åœ°å€ï¼Œå‰©ä¸‹çš„28ä¸ºæ˜¯å¤šæ’­çš„ç»„ç¼–å·ã€‚</p>
<p>ç½‘ç»œæ ‡è¯†ç›¸åŒçš„è®¡ç®—æœºå¿…é¡»å±äºåŒä¸€é“¾è·¯ï¼Œä½†å¦‚Aç±»Bç±»å°†äº§ç”Ÿå¤§é‡æµªè´¹çš„åœ°å€ï¼Œå› ä¸ºä¸å¯èƒ½æœ‰é‚£ä¹ˆå¤šä¸»æœºè¿æ¥åœ¨ä¸€ä¸ªé“¾è·¯ä¸Šã€‚ç°åœ¨ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªå«åšâ€<strong>å­ç½‘æ©ç </strong>â€œçš„è¯†åˆ«ç é€šè¿‡å­ç½‘ç½‘ç»œåœ°å€ç»†åˆ†å‡ºæ¯”ABCæ›´å°ç²’åº¦çš„ç½‘ç»œã€‚<br>å­ç½‘æ©ç ä¹Ÿæ˜¯32ä½ï¼Œå¯¹åº”ç½‘ç»œåœ°å€çš„éƒ¨åˆ†ä¸º1ï¼Œå¯¹åº”ä¸»æœºåœ°å€çš„éƒ¨åˆ†å¯¹åº”ä¸º0.</p>
<p>ç”±äºäº’è”ç½‘çš„æ™®åŠï¼ŒIPåœ°å€ä¸è¶³é—®é¢˜ä¸¥é‡ã€‚äºæ˜¯å‡ºç°ç§æœ‰ç½‘ç»œçš„IPåœ°å€ã€‚å®ƒçš„åœ°å€èŒƒå›´ï¼šAç±»ï¼Œ10.0.0.0-10.2555.255.255ï¼›Bç±»ï¼Œ172.16.0.0-172.31.255.255ï¼›Cç±»ï¼Œ12.168.0.0-192.168.255.255ã€‚åŒ…å«åœ¨è¿™ä¸ªèŒƒå›´å†…çš„IPéƒ½å±äº<strong>ç§æœ‰IP</strong>ï¼Œåœ¨æ­¤ä¹‹å¤–çš„IPç§°ä¸º<strong>å…¨å±€IP</strong>ã€‚å†…éƒ¨æ¯ä¸ªç»ˆç«¯ä½¿ç”¨ç§æœ‰IPï¼Œè€Œåœ¨è·¯ç”±å™¨(å®½å¸¦è·¯ç”±å™¨)æˆ–å¿…è¦æœåŠ¡å™¨ä¸Šè®¾ç½®å…¨å±€IPã€‚å½“é…æœ‰ç§æœ‰IPçš„ä¸»æœºè”ç½‘æ—¶ï¼Œä½¿ç”¨NATè¿›è¡Œé€šä¿¡ã€‚</p>
<p>å¯¹äºFTTHå’ŒADSLæœåŠ¡ï¼Œç½‘ç»œä¾›åº”å•†ç›´æ¥ç»™ç”¨æˆ·åˆ†é…å…¨å±€IPåœ°å€ï¼Œå¹¶ä¸”æ¯æ¬¡ç”¨æˆ·é‡è¿ï¼Œè¯¥IPåœ°å€éƒ½å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚è¿™é‡Œçš„IPåœ°å€ç”±ä¾›åº”å•†ç»´æŠ¤ï¼Œä¸éœ€è¦ç”¨æˆ·è‡ªå·±ç”³è¯·å…¨å±€IPã€‚</p>
<h3 id="è·¯ç”±æ§åˆ¶"><a href="#è·¯ç”±æ§åˆ¶" class="headerlink" title="è·¯ç”±æ§åˆ¶"></a>è·¯ç”±æ§åˆ¶</h3><p>ä»…ä»…æœ‰IPåœ°å€ä¸è¶³ä»¥å®ç°å°†æ•°æ®åŒ…å‘é€åˆ°å¯¹ç«¯ç›®æ ‡åœ°å€ï¼Œåœ¨æ•°æ®å‘é€è¿‡ç¨‹ä¸­è¿˜éœ€è¦æŒ‡æ˜è·¯ç”±å™¨æˆ–ä¸»æœºçš„ä¿¡æ¯ï¼Œä»¥ä¾¿çœŸæ­£å‘å¾€ç›®æ ‡åœ°å€ã€‚ä¿å­˜è¿™ç§ä¿¡æ¯çš„å°±æ˜¯<strong>è·¯ç”±æ§åˆ¶è¡¨</strong>ã€‚</p>
<p>è·¯ç”±æ§åˆ¶è¡¨è®°å½•ç€ç½‘ç»œåœ°å€å’Œä¸‹ä¸€æ­¥åº”è¯¥å‘é€è‡³è·¯ç”±å™¨çš„åœ°å€ã€‚å‘é€IPåŒ…æ—¶ï¼Œå…ˆç¡®å®šIPåŒ…é¦–éƒ¨ä¸­çš„ç›®æ ‡åœ°å€ï¼Œå†ä»è·¯ç”±æ§åˆ¶è¡¨ä¸­æ‰¾åˆ°ä¸è¯¥åœ°å€å…·æœ‰ç›¸åŒç½‘ç»œåœ°å€çš„è®°å½•ï¼Œæ ¹æ®è¯¥è®°å½•å°†IPåŒ…è½¬å‘ç»™ç›¸åº”çš„ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ã€‚</p>
<h2 id="IPåè®®ç›¸å…³"><a href="#IPåè®®ç›¸å…³" class="headerlink" title="IPåè®®ç›¸å…³"></a>IPåè®®ç›¸å…³</h2><h3 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h3><p>DNSå°†ä¸»æœºåå­—ç¬¦ä¸²è½¬æ¢ä¸ºå…·ä½“çš„IPåœ°å€ã€‚</p>
<h3 id="ARP"><a href="#ARP" class="headerlink" title="ARP"></a>ARP</h3><p>åªè¦ç¡®å®šäº†IPåœ°å€ï¼Œå°±å¯ä»¥æƒ³è¿™ä¸ªç›®æ ‡å‘é€IPæ•°æ®åŒ…ï¼Œä½†æ˜¯åº•å±‚æ•°æ®é“¾è·¯å±‚ï¼Œè¿›è¡Œå®é™…é€šä¿¡æ˜¯å´è¦äº†è§£æ¯ä¸ªIPåœ°å€æ‰€å¯¹åº”çš„MACåœ°å€ã€‚</p>
<p>ARPæ˜¯ä¸€ç§è§£å†³åœ°å€é—®é¢˜çš„åè®®ã€‚ä»¥ç›®æ ‡IPåœ°å€ä¸ºçº¿ç´¢ï¼Œç”¨æ¥å®šä½ä¸‹ä¸€ä¸ªåº”è¯¥æ¥æ”¶æ•°æ®åˆ†åŒ…çš„ç½‘ç»œè®¾å¤‡å¯¹åº”çš„MACåœ°å€ã€‚å¦‚æœç›®æ ‡ä¸»æœºä¸å†åŒä¸€ä¸ªé“¾è·¯ä¸Šï¼Œå¯ä»¥é€šè¿‡ARPæŸ¥æ‰¾ä¸‹ä¸€è·³è·¯ç”±å™¨çš„MACåœ°å€ã€‚</p>
<p>ä»ä¸€ä¸ªIPåœ°å€å‘é€ARPè¯·æ±‚åŒ…ä»¥äº†è§£å…¶MACåœ°å€ã€‚ç›®æ ‡åœ°å€å°†è‡ªå·±çš„MACåœ°å€å¡«å…¥å…¶ä¸­çš„ARPå“åº”åŒ…è¿”å›åˆ°IPåœ°å€ã€‚ç”±æ­¤ï¼Œå¯ä»¥é€šè¿‡<strong>ARP</strong>ä»IPåœ°å€è·å¾—MACåœ°å€ï¼Œå®ç°é“¾è·¯å†…çš„IPé€šä¿¡ã€‚</p>
<p>æ ¹æ®ARPå¯ä»¥è¿›è¡ŒåŠ¨æ€çš„åœ°å€è§£æã€‚å› æ­¤ï¼Œåœ¨TCP/IPç½‘ç»œæ„é€ å’Œç½‘ç»œé€šä¿¡ä¸­æ— éœ€äº‹å…ˆçŸ¥é“MACåœ°å€ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Œåªè¦æœ‰IPåœ°å€å³å¯ã€‚</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iosç¼–ç¨‹(ç¬¬å››ç‰ˆ) å­¦ä¹ ç¬”è®°]]></title>
      <url>http://zhang759740844.github.io/2016/07/31/ios%E7%BC%96%E7%A8%8B%EF%BC%88%E7%AC%AC%E5%9B%9B%E7%89%88/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡æ˜¯å¯¹ã€Šiosç¼–ç¨‹(ç¬¬å››ç‰ˆ)ã€‹ä¸€ä¹¦å­¦ä¹ åæ‘˜å½•çš„ç¬”è®°ï¼Œå±äºioså¼€å‘åŸºç¡€ã€‚</p>
<a id="more"></a>
<h2 id="ç¬¬ä¸€ä¸ªiosåº”ç”¨"><a href="#ç¬¬ä¸€ä¸ªiosåº”ç”¨" class="headerlink" title="ç¬¬ä¸€ä¸ªiosåº”ç”¨"></a>ç¬¬ä¸€ä¸ªiosåº”ç”¨</h2><h3 id="å£°æ˜æ’åº§å˜é‡"><a href="#å£°æ˜æ’åº§å˜é‡" class="headerlink" title="å£°æ˜æ’åº§å˜é‡"></a>å£°æ˜æ’åº§å˜é‡</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UILabel</span> *questionLabel</div></pre></td></tr></table></figure>
<p>å£°æ˜äº†ä¸€ä¸ªå«questionLabelçš„æ’åº§å˜é‡.<br><strong>IBOutlet</strong>å‘Šè¯‰Xcodeéœ€è¦ä½¿ç”¨Interface Builderå…³è”è¯¥æ’åº§å˜é‡ã€‚</p>
<h3 id="å£°æ˜åŠ¨ä½œæ–¹æ³•"><a href="#å£°æ˜åŠ¨ä½œæ–¹æ³•" class="headerlink" title="å£°æ˜åŠ¨ä½œæ–¹æ³•"></a>å£°æ˜åŠ¨ä½œæ–¹æ³•</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">IBAction</span>)showQuestion:(<span class="keyword">id</span>)sender&#123;</div><div class="line">	â€¦â€¦</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>IBAction</strong>å…³é”®å­—å‘Šè¯‰Xcodeä¼šä½¿ç”¨Interface Builderå…³è”è¯¥æ•°æ®ã€‚ä¹‹ååˆ›å»ºå…³è”ã€‚</p>
<h3 id="åº”ç”¨å›¾æ ‡"><a href="#åº”ç”¨å›¾æ ‡" class="headerlink" title="åº”ç”¨å›¾æ ‡"></a>åº”ç”¨å›¾æ ‡</h3><p>Images.xcassetsç›®å½•ä¸‹å­˜æ”¾ç€æ‰€æœ‰å›¾ç‰‡ï¼Œå…¶ä¸­LaunchImageä¿å­˜å¯åŠ¨å›¾ç‰‡ã€‚</p>
<h2 id="objective-c"><a href="#objective-c" class="headerlink" title="objective-c"></a>objective-c</h2><h3 id="ç±»æ–¹æ³•"><a href="#ç±»æ–¹æ³•" class="headerlink" title="ç±»æ–¹æ³•"></a>ç±»æ–¹æ³•</h3><p>å®ä¾‹æ–¹æ³•ä½¿ç”¨çš„å­—ç¬¦æ˜¯-ï¼Œç±»æ–¹æ³•ä½¿ç”¨å­—ç¬¦+ã€‚<br>ç±»æ–¹æ³•ä½œç”¨é€šå¸¸æ˜¯åˆ›å»ºå¯¹è±¡ï¼Œè·å–ç±»çš„æŸäº›å…¨å±€å±æ€§ã€‚</p>
<h2 id="é€šè¿‡ARCç®¡ç†å†…å­˜"><a href="#é€šè¿‡ARCç®¡ç†å†…å­˜" class="headerlink" title="é€šè¿‡ARCç®¡ç†å†…å­˜"></a>é€šè¿‡ARCç®¡ç†å†…å­˜</h2><h3 id="copy"><a href="#copy" class="headerlink" title="copy"></a>copy</h3><p>å½“æŸä¸ªå±æ€§æ˜¯æŒ‡å‘å…¶ä»–å¯¹è±¡çš„æŒ‡é’ˆï¼Œå¹¶ä¸”è¯¥å¯¹è±¡çš„ç±»æœ‰å¯ä¿®æ”¹çš„å­ç±»ï¼Œå¦‚NSStringã€NSArrayæ—¶ï¼Œåº”è¯¥å°†è¯¥å±æ€§çš„å†…å­˜ç®¡ç†ç‰¹æ€§è®¾ç½®ä¸ºcopyã€‚ç›¸å½“äºå‘é€ä¸€ä¸ªcopyæ¶ˆæ¯ã€‚<br>å½“ä¸€ä¸ªä¸å¯ä¿®æ”¹çš„å¯¹è±¡è¿›è¡Œcopyæ—¶ï¼Œè¿”å›åŸæ¥å¯¹è±¡ã€‚å½“ä¸€ä¸ªå¯ä¿®æ”¹å¯¹è±¡è¿›è¡Œcopyæ—¶ï¼Œè¿”å›æ–°åˆ›å»ºçš„ä¸å¯ä¿®æ”¹å¯¹è±¡ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚æœ‰ä¸ª<code>@property(nonatomic,copy) NSString *name</code>ã€‚å¦‚æœä¸ç”¨<code>copy</code>è€Œç”¨<code>strong</code>é‚£ä¹ˆå°†ä¸€ä¸ªå¯ä¿®æ”¹çš„<code>NSMutableString</code>å¯¹è±¡èµ‹ç»™<code>name</code>æ—¶ï¼Œé‚£å°±ç›´æ¥å°†<code>name</code>æŒ‡å‘<code>NSMutableString</code>å¯¹è±¡ã€‚æ­¤æ—¶ï¼Œ<code>NSMutableString</code>ä¿®æ”¹äº†è‡ªèº«çš„stringå€¼ï¼Œé‚£ä¹ˆç›¸å½“äº<code>name</code>çš„å€¼ä¹Ÿæ”¹å˜äº†ï¼Œè¿™å’Œè®¾è®¡åŸåˆ™ç›¸æ‚–ã€‚å› æ­¤ï¼Œéœ€è¦ä½¿ç”¨<code>copy</code>,å½“<code>NSMutableString</code>å¯¹è±¡èµ‹ç»™<code>name</code>æ—¶ï¼Œæ·±å¤åˆ¶ä¸€ä¸ªæ–°çš„ä¸å¯ä¿®æ”¹çš„å¯¹è±¡ï¼Œè®©<code>name</code>æŒ‡å‘å®ƒï¼Œå¦‚æœ<code>NSString</code>å¯¹è±¡èµ‹ç»™<code>name</code>æ—¶ï¼Œæµ…èµ‹å€¼ï¼Œå°†<code>NSString</code>çš„å¼•ç”¨è®¡æ•°å™¨åŠ ä¸€ã€‚</p>
<p>copyå’Œstrongçš„åŒºåˆ«å°±æ˜¯ï¼š</p>
<ul>
<li>å¯¹äºä¸å¯ä¿®æ”¹å¯¹è±¡æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½æ˜¯ç›´æ¥è¿”å›å¯¹è±¡åœ°å€</li>
<li>å¯¹äºå¯ä¿®æ”¹å¯¹è±¡ï¼Œcopyæ–°åˆ›å»ºä¸€ä¸ªä¸å¯ä¿®æ”¹çš„åŸå¯¹è±¡çš„å®ä¾‹ï¼Œå¹¶è¿”å›åœ°å€ã€‚strongç›´æ¥è¿”å›åŸå¯¹è±¡åœ°å€ã€‚</li>
</ul>
<h2 id="è§†å›¾ä¸è§†å›¾å±‚æ¬¡ç»“æ„"><a href="#è§†å›¾ä¸è§†å›¾å±‚æ¬¡ç»“æ„" class="headerlink" title="è§†å›¾ä¸è§†å›¾å±‚æ¬¡ç»“æ„"></a>è§†å›¾ä¸è§†å›¾å±‚æ¬¡ç»“æ„</h2><h3 id="è§†å›¾å±‚æ¬¡ç»“æ„"><a href="#è§†å›¾å±‚æ¬¡ç»“æ„" class="headerlink" title="è§†å›¾å±‚æ¬¡ç»“æ„"></a>è§†å›¾å±‚æ¬¡ç»“æ„</h3><p>ä»»ä½•ä¸€ä¸ªåº”ç”¨æœ‰ä¸”åªæœ‰ä¸€ä¸ªUIWindowå¯¹è±¡ã€‚UIWindowåŒ…å«åº”ç”¨ä¸­çš„æ‰€æœ‰è§†å›¾ã€‚åº”ç”¨éœ€è¦åœ¨å¯åŠ¨æ—¶åˆ›å»ºå¹¶è®¾ç½®UIWindowå¯¹è±¡ï¼Œç„¶åä¸ºå…¶æ·»åŠ å…¶ä»–è§†å›¾ã€‚<br>å±‚æ¬¡ç»“æ„ä¸­æ¯ä¸ªè§†å›¾åˆ†åˆ«ç»˜åˆ¶è‡ªå·±ã€‚è§†å›¾ä¼šå°†è‡ªå·±ç»˜åˆ¶åˆ°å›¾å±‚(layer)ä¸Šï¼Œæ¯ä¸ªUIViewå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªlayerå±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªCALayerç±»çš„å¯¹è±¡ã€‚</p>
<h3 id="åˆ›å»ºUIViewå­ç±»"><a href="#åˆ›å»ºUIViewå­ç±»" class="headerlink" title="åˆ›å»ºUIViewå­ç±»"></a>åˆ›å»ºUIViewå­ç±»</h3><p>UIViewå­ç±»æ¨¡æ¿ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ–¹æ³• <strong>initWithFrame:</strong>ï¼Œè¯¥æ–¹æ³•æ˜¯UIViewçš„æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•ï¼Œå¸¦æœ‰ä¸€ä¸ªCGRectç»“æ„ç±»å‹çš„å‚æ•°ï¼Œè¯¥å‚æ•°ä¼šè¢«èµ‹ç»™UIViewçš„frameå±æ€§ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> ï¼ˆ<span class="keyword">nonatomic</span>ï¼‰ <span class="built_in">CGRect</span> frameï¼›</div></pre></td></tr></table></figure>
<p>CGRectç»“æ„åŒ…å«å¦å¤–ä¸¤ä¸ªç»“æ„ï¼šoriginå’Œsizeã€‚originæ˜¯CGPointç±»å‹ï¼ŒåŒ…å«ä¸¤ä¸ªfloatç±»å‹çš„xï¼Œyã€‚sizeæ˜¯CGSizeç»“æ„ï¼ŒåŒ…å«ä¸¤ä¸ªfloatç±»å‹çš„widthå’Œheightã€‚<br>åˆ›å»ºCGRectå¯¹è±¡ï¼šCGRect firstFrame = CGRectMakeï¼ˆ160ï¼Œ240ï¼Œ100ï¼Œ150ï¼‰ï¼›</p>
<p>å¯ä»¥ä½¿ç”¨addSubViewæ–¹æ³•æ¥æ·»åŠ å­è§†å›¾ï¼š [self.window addSubview:firstView]ã€‚<br>æ¯ä¸ªUIViewå¯¹è±¡éƒ½è¿˜æœ‰ä¸€ä¸ªsuperViewå±æ€§ï¼Œå°†ä¸€ä¸ªè§†å›¾ä½œä¸ºå­è§†å›¾åŠ å…¥å¦ä¸€ä¸ªè§†å›¾åï¼Œä¼šè‡ªåŠ¨åˆ›å»ºç›¸åº”çš„åå‘å…³è”ã€‚ä¸ºé¿å…å¼ºå¼•ç”¨å¾ªç¯ï¼Œsuperviewæ˜¯å¼±å¼•ç”¨ã€‚<br>boundsè¡¨ç¤ºçš„çŸ©å½¢ä½äºè‡ªå·±çš„åæ ‡ç³»ï¼Œframeè¡¨ç¤ºçš„çŸ©å½¢ä½äºçˆ¶è§†å›¾çš„åæ ‡ç³»ã€‚</p>
<h3 id="å›¾å½¢ç»˜åˆ¶"><a href="#å›¾å½¢ç»˜åˆ¶" class="headerlink" title="å›¾å½¢ç»˜åˆ¶"></a>å›¾å½¢ç»˜åˆ¶</h3><p>æ²¡çœ‹</p>
<h2 id="è§†å›¾ï¼šé‡ç»˜ä¸UIScrollView"><a href="#è§†å›¾ï¼šé‡ç»˜ä¸UIScrollView" class="headerlink" title="è§†å›¾ï¼šé‡ç»˜ä¸UIScrollView"></a>è§†å›¾ï¼šé‡ç»˜ä¸UIScrollView</h2><h3 id="ScrollView"><a href="#ScrollView" class="headerlink" title="ScrollView"></a>ScrollView</h3><p>è®¾ç½®scrollView.contentSize = bigRect.size;è¿™æ˜¯æ•´ä¸ªæ»šåŠ¨èŒƒå›´çš„å¤§å°ã€‚<br>åœ¨scrollviewä¸­addSubViewã€‚</p>
<h2 id="è§†å›¾æ§åˆ¶å™¨"><a href="#è§†å›¾æ§åˆ¶å™¨" class="headerlink" title="è§†å›¾æ§åˆ¶å™¨"></a>è§†å›¾æ§åˆ¶å™¨</h2><h3 id="è§†å›¾æ§åˆ¶å™¨-1"><a href="#è§†å›¾æ§åˆ¶å™¨-1" class="headerlink" title="è§†å›¾æ§åˆ¶å™¨"></a>è§†å›¾æ§åˆ¶å™¨</h3><p>è§†å›¾æ§åˆ¶å™¨æ˜¯UIViewControllerç±»æˆ–å…¶å­ç±»çš„å¯¹è±¡ã€‚æ¯ä¸ªè§†å›¾æ§åˆ¶å™¨éƒ½è´Ÿè´£ç®¡ç†ä¸€ä¸ªè§†å›¾å±‚æ¬¡ç»“æ„ã€‚<br>ä½¿ç”¨UITabBarControllerçš„ç±»åœ¨ä¸¤ä¸ªè§†å›¾æ§åˆ¶å™¨é—´åˆ‡æ¢ã€‚  </p>
<p>UIViewControlleræœ‰ä¸€ä¸ªé‡è¦å±æ€§ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIView</span> *view;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªviewå°±æ˜¯è§†å›¾çš„æ ¹è§†å›¾ã€‚</p>
<h3 id="åˆ›å»ºè§†å›¾å±‚æ¬¡ç»“æ„"><a href="#åˆ›å»ºè§†å›¾å±‚æ¬¡ç»“æ„" class="headerlink" title="åˆ›å»ºè§†å›¾å±‚æ¬¡ç»“æ„"></a>åˆ›å»ºè§†å›¾å±‚æ¬¡ç»“æ„</h3><ol>
<li><p>è¦†ç›–UIViewControllerçš„loadViewæ–¹æ³•</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">-(<span class="keyword">void</span>)loadView&#123;</div><div class="line">        BNRHypnosisView *backgroundView = [[BNRHypnosisView alloc] init];</div><div class="line">        <span class="keyword">self</span>.view = backgroundView;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> æ­¤æ—¶viewå°šæœªåˆ›å»ºï¼Œä¸èƒ½å¯¹å…¶è¿›è¡Œaddviewæ“ä½œã€‚åªèƒ½åˆ›å»ºä¸€ä¸ªviewè®©self.viewæŒ‡å‘ã€‚</p>
</li>
<li><p>é€šè¿‡xibåˆ›å»º<br>.mä¸­å£°æ˜å„ä¸ªæ§ä»¶(æ³¨æ„æ§ä»¶ä½¿ç”¨å¼±å¼•ç”¨)</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UILabel</span> *questionLabel</div></pre></td></tr></table></figure>
<p> å†é€šè¿‡è¿çº¿å°†Fileâ€™s Ownerçš„viewä»¥åŠå„ç§æ§ä»¶è¿æ¥åˆ°xibçš„å›¾åƒä¸Šã€‚</p>
</li>
</ol>
<h3 id="è®¾ç½®æ ¹è§†å›¾æ§åˆ¶å™¨"><a href="#è®¾ç½®æ ¹è§†å›¾æ§åˆ¶å™¨" class="headerlink" title="è®¾ç½®æ ¹è§†å›¾æ§åˆ¶å™¨"></a>è®¾ç½®æ ¹è§†å›¾æ§åˆ¶å™¨</h3><p>UIWindowå¯¹è±¡æä¾›äº†setRootViewControllerï¼šæ–¹æ³•ã€‚å½“ç¨‹åºå°†æŸä¸ªè§†å›¾æ§åˆ¶å™¨è®¾ç½®ä¸ºUIWindowå¯¹è±¡çš„rootViewControlleræ—¶ï¼ŒUIWindowå¯¹è±¡ä¼šå°†è¯¥è§†å›¾æ§åˆ¶å™¨çš„viewä½œä¸ºå­è§†å›¾åŠ å…¥çª—å£ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">BNRHypnosisViewController *hvc = [[BNRHypnosisViewController alloc] init];</div><div class="line"><span class="keyword">self</span>.window.rootViewController = hvc;</div></pre></td></tr></table></figure></p>
<p>setRootViewControllerå…¶å®å°±æ˜¯å°†ViewControllerçš„viewè®¾ç½®ä¸ºå…¶subviewã€‚</p>
<h3 id="åŠ è½½nibæ–‡ä»¶"><a href="#åŠ è½½nibæ–‡ä»¶" class="headerlink" title="åŠ è½½nibæ–‡ä»¶"></a>åŠ è½½nibæ–‡ä»¶</h3><p>åŠ è½½ä¸åŒåçš„nibæ–‡ä»¶æ—¶ï¼Œéœ€è¦ä½¿ç”¨<strong>initWithNibName:Bundle:</strong>æ–¹æ³•ã€‚è¯¥æ–¹æ³•çš„ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ç”¨äºæŒ‡å®šNIBæ–‡ä»¶æ–‡ä»¶åå’Œå…¶<strong>æ‰€åœ¨çš„ç¨‹åºåŒ…</strong>ã€‚å¦‚æœæ˜¯Bundleä¼ å…¥nilé»˜è®¤æ˜¯[NSBundle mainBundle];</p>
<h3 id="UITabBarController"><a href="#UITabBarController" class="headerlink" title="UITabBarController"></a>UITabBarController</h3><p>UITabBarControllerå¯¹è±¡å¯ä»¥ä¿å­˜ä¸€ç»„è§†å›¾æ§åˆ¶å™¨ã€‚è¯¥å¯¹è±¡ä¼šåœ¨å±å¹•åº•éƒ¨æ˜¾ç¤ºä¸€ä¸ªæ ‡ç­¾æ ï¼Œæ ‡ç­¾æ ä¼šæœ‰å¤šä¸ªæ ‡ç­¾é¡¹ï¼Œåˆ†åˆ«å¯¹åº”UITabBarControllerå¯¹è±¡æ‰€ä¿å­˜çš„æ¯ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ã€‚å•å‡»æŸä¸ªæ ‡ç­¾é¡¹ï¼ŒUITabBarControllerå¯¹è±¡å°±ä¼šæ˜¾ç¤ºè¯¥æ ‡ç­¾é¡¹æ‰€å¯¹åº”çš„è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾ã€‚   </p>
<p>åœ¨APPDelegateä¸­åˆ›å»ºä¸¤ä¸ªè§†å›¾æ§åˆ¶å™¨ï¼ŒåŠ å…¥Tabbarçš„<strong>viewControllers</strong>å±æ€§ä¸­ï¼Œå¹¶å°†tabbarè®¾ç½®ä¸ºrootViewController<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UITabBarController</span> *tabBarController = [[<span class="built_in">UITabBarController</span> alloc] init];</div><div class="line">tabBarController.viewControllers = @[hvc,rvc] <span class="comment">//ä¸¤ä¸ªviewController å¯ä»¥å†™åœ¨tabbarControllerçš„viewDidLoadæ–¹æ³•é‡Œ</span></div><div class="line"><span class="keyword">self</span>.window.rootViewController = tabBarController;</div></pre></td></tr></table></figure></p>
<p>è®¾ç½®æ ‡ç­¾é¡¹ï¼Œä½¿ç”¨<strong>tabBarItem</strong>å±æ€§ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIImage</span> *orderImage = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"tab_order"</span>];</div><div class="line"><span class="built_in">UIImage</span> *orderImageSel = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"tab_order_active"</span>];</div><div class="line">orderImage = [orderImage imageWithRenderingMode:<span class="built_in">UIImageRenderingModeAlwaysTemplate</span>];</div><div class="line">orderImageSel = [orderImageSel imageWithRenderingMode:<span class="built_in">UIImageRenderingModeAlwaysTemplate</span>];</div><div class="line"><span class="built_in">UITabBarItem</span> *orderTabBarItem = [[<span class="built_in">UITabBarItem</span> alloc] initWithTitle:<span class="string">@"è®¢å•"</span> image:orderImage selectedImage:orderImageSel];</div><div class="line">orderNav.tabBarItem = orderTabBarItem;</div></pre></td></tr></table></figure>
<p>ä¸ºtabbaræ·»åŠ subviewï¼ŒUITabBarControlleré‡Œæœ‰ä¸€ä¸ª<strong>tabBar</strong>çš„view</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIView</span> *backview = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="keyword">self</span>.tabBar.bounds];</div><div class="line">[backview setBackgroundColor:[<span class="built_in">UIColor</span> whiteColor]];</div><div class="line">[<span class="keyword">self</span>.tabBar addSubview:backview];</div></pre></td></tr></table></figure>
<h3 id="æœ¬åœ°é€šçŸ¥"><a href="#æœ¬åœ°é€šçŸ¥" class="headerlink" title="æœ¬åœ°é€šçŸ¥"></a>æœ¬åœ°é€šçŸ¥</h3><p>æœ¬åœ°é€šçŸ¥éœ€è¦åˆ›å»ºä¸€ä¸ªUILocalNotificationå¯¹è±¡å¹¶è®¾ç½®å…¶æ˜¾ç¤ºå†…å®¹å’Œæé†’æ—¶é—´ï¼Œç„¶åè°ƒç”¨UIApplicationå•ä¾‹å¯¹è±¡çš„scheduleLocalNotification:æ–¹æ³•å°±å®ç°äº†æ³¨å†Œé€šçŸ¥ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UILocalNotification</span> *note = [][<span class="built_in">UILocalNotification</span> alloc] init];</div><div class="line">note.alertBody = <span class="string">@"xxx"</span>;</div><div class="line">note.fireDate = date;</div><div class="line">[[<span class="built_in">UIApplication</span> sharedApplication] scheduleLocalNotification:note];</div></pre></td></tr></table></figure></p>
<h3 id="åŠ è½½å’Œæ˜¾ç¤ºè§†å›¾"><a href="#åŠ è½½å’Œæ˜¾ç¤ºè§†å›¾" class="headerlink" title="åŠ è½½å’Œæ˜¾ç¤ºè§†å›¾"></a>åŠ è½½å’Œæ˜¾ç¤ºè§†å›¾</h3><p>viewDidLoadæ–¹æ³•æ£€æŸ¥è§†å›¾æ§åˆ¶å™¨æ˜¯å¦å·²ç»åŠ è½½ï¼Œæ¯ä¸ªUIViewControllerå¯¹è±¡å®ç°äº†viewDidLoadæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨è½½å…¥è§†å›¾åè¢«è°ƒç”¨ã€‚ä¸ºäº†å®ç°è§†å›¾å»¶è¿ŸåŠ è½½ï¼Œåœ¨initWithNibNameæ–¹æ³•ä¸­ä¸èƒ½è®¿é—®ä»»ä½•viewå’Œviewçš„ä»»ä½•å­è§†å›¾ã€‚å‡¡æ˜¯å’Œviewæˆ–viewå­è§†å›¾æœ‰å…³çš„åˆå§‹åŒ–ä»£ç ï¼Œéƒ½åº”è¯¥åœ¨viewDidLoadæ–¹æ³•ä¸­å®ç°ã€‚<br>å¦å¤–ä¸€ä¸ªæ–¹æ³•viewWillAppearæ–¹æ³•ä¼šåœ¨è§†å›¾æ§åˆ¶å™¨çš„viewæ·»åŠ åˆ°åº”ç”¨çª—å£ä¹‹å‰è¢«è°ƒç”¨ã€‚</p>
<p>å¦‚æœåªè¦åœ¨åº”ç”¨å¯åŠ¨åè®¾ç½®ä¸€æ¬¡è§†å›¾å¯¹è±¡ï¼Œé‚£ä¹ˆç”¨viewDidLoadï¼Œå¦‚æœæ¯æ¬¡çœ‹åˆ°è§†å›¾éƒ½éœ€è¦å¯¹å…¶è¿›è¡Œè®¾ç½®ï¼Œé‚£ä¹ˆç”¨viewWillAppearï¼Œç±»ä¼¼äºonCreateå’ŒonResumeçš„åŒºåˆ«ã€‚</p>
<h3 id="ä¸è§†å›¾æ§åˆ¶å™¨åŠå…¶è§†å›¾äº¤äº’"><a href="#ä¸è§†å›¾æ§åˆ¶å™¨åŠå…¶è§†å›¾äº¤äº’" class="headerlink" title="ä¸è§†å›¾æ§åˆ¶å™¨åŠå…¶è§†å›¾äº¤äº’"></a>ä¸è§†å›¾æ§åˆ¶å™¨åŠå…¶è§†å›¾äº¤äº’</h3><p><strong>application:didFinishLaunchingWithOptions:</strong>    è¯¥æ–¹æ³•ä¸­è®¾ç½®å’Œåˆå§‹åŒ–åº”ç”¨çª—å£çš„æ ¹è§†å›¾æ§åˆ¶å™¨ã€‚è¯¥æ–¹æ³•åªä¼šåœ¨åº”ç”¨å¯åŠ¨åè°ƒç”¨ä¸€æ¬¡ã€‚å¦‚æœä»å…¶ä»–åº”ç”¨åˆ‡æ¢å›æœ¬åœ°åº”ç”¨ï¼Œè¯¥æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ï¼Œå¦‚æœå…³é—­åº”ç”¨åå°åœ¨é‡å¯æ‰ä¼šå†æ¬¡è°ƒç”¨ã€‚<br><strong>initWithNibNameï¼šbundleï¼š</strong>è¯¥æ–¹æ³•æ˜¯UIViewControllerçš„æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•ï¼Œåˆ›å»ºè§†å›¾æ§åˆ¶å™¨æ—¶ï¼Œå°±ä¼šè°ƒç”¨è¯¥æ–¹æ³•ã€‚<br><strong>loadViewï¼š</strong>è¦†ç›–è¯¥æ–¹æ³•ï¼Œä½¿ç”¨ä»£ç æ–¹å¼è®¾ç½®è§†å›¾æ§åˆ¶çš„çš„viewå±æ€§ã€‚<br><strong>viewDidLoadï¼š</strong>è¯¥æ–¹æ³•ä¼šåœ¨è§†å›¾æ§åˆ¶å™¨åŠ è½½å®Œè§†å›¾åè¢«è°ƒç”¨ã€‚<br><strong>viewWillAppearï¼š</strong>è¯¥æ–¹æ³•ä¼šåœ¨è§†å›¾æ§åˆ¶å™¨çš„viewæ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ—¶è¢«è°ƒç”¨ã€‚  </p>
<h2 id="å§”æ‰˜ä¸æ–‡æœ¬è¾“å…¥"><a href="#å§”æ‰˜ä¸æ–‡æœ¬è¾“å…¥" class="headerlink" title="å§”æ‰˜ä¸æ–‡æœ¬è¾“å…¥"></a>å§”æ‰˜ä¸æ–‡æœ¬è¾“å…¥</h2><h3 id="å§”æ‰˜ï¼ˆä»£ç†æ¨¡å¼ï¼‰"><a href="#å§”æ‰˜ï¼ˆä»£ç†æ¨¡å¼ï¼‰" class="headerlink" title="å§”æ‰˜ï¼ˆä»£ç†æ¨¡å¼ï¼‰"></a>å§”æ‰˜ï¼ˆä»£ç†æ¨¡å¼ï¼‰</h3><p>å½“æŸä¸ªç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå‘ç”Ÿäº‹ä»¶çš„ä¸€æ–¹ä¼šå‘æŒ‡å®šçš„ç›®æ ‡å¯¹è±¡å‘é€ä¸€ä¸ªä¹‹å‰è®¾å®šå¥½çš„åŠ¨ä½œæ¶ˆæ¯ã€‚<br>ä¾‹ï¼šUITextFieldå¯¹è±¡æœ‰ä¸€ä¸ªå§”æ‰˜å±æ€§ï¼Œé€šè¿‡ä¸ºUITextFieldå¯¹è±¡è®¾ç½®å§”æ‰˜ï¼Œå§”æ‰˜å®ç°ä¸€ä¸ªåè®®ä¸­çš„å„ä¸ªæ–¹æ³•ï¼ŒUITextFieldå¯¹è±¡ä¼šåœ¨å‘ç”Ÿäº‹ä»¶æ—¶å‘å§”æ‰˜å‘é€ç›¸åº”æ¶ˆæ¯ï¼Œç”±å§”æ‰˜å¤„ç†è¯¥äº‹ä»¶ã€‚  </p>
<p>ç±»ä¼¼äºandroidä¸­setOnClickListener(this); ç»§æ‰¿onClickListeneræ¥å£ï¼Œè¿™é‡Œåˆ™æ˜¯è®¾ç½®delegateä¸ºselfï¼Œéµå®ˆç›¸åº”åè®®ã€‚ä¸è¿‡androidå¯ä»¥ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»ä»£æ›¿è¿™é‡Œçš„thisã€‚</p>
<h3 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h3><p>å‡¡æ˜¯æ”¯æŒå§”æ‰˜çš„å¯¹è±¡ï¼ŒèƒŒåéƒ½æœ‰ä¸€ä¸ªç›¸åº”çš„åè®®ï¼Œå£°æ˜å¯ä»¥å‘è¯¥å¯¹è±¡çš„å§”æ‰˜å¯¹è±¡å‘é€çš„æ¶ˆæ¯ã€‚å§”æ‰˜å¯¹è±¡éœ€è¦æ›´å…·è¿™ä¸ªåè®®é€‰å–éœ€è¦çš„æ–¹æ³•å®ç°ã€‚å¦‚æœä¸€ä¸ªç±»å®ç°äº†æŸä¸ªåè®®ä¸­è§„å®šçš„æ–¹æ³•ï¼Œåˆ™ç§°ç±»éµå®ˆè¯¥åè®®ã€‚  </p>
<p>åè®®å£°æ˜ä½¿ç”¨@protocolæŒ‡ä»¤å¼€å¤´ï¼Œåé¢è·Ÿåè®®çš„åç§°ã€‚æœ€åä½¿ç”¨@endç»“æŸ<br>ä½¿ç”¨@optionalæŒ‡ä»¤ï¼Œå¯ä»¥å°†å†™åœ¨æŒ‡ä»¤åçš„å…¨éƒ¨å£°æ˜ä¸ºå¯é€‰çš„ã€‚<br>å‘é€æ–¹åœ¨å‘é€å¯é€‰æ–¹æ³•å‰ï¼Œä¼šå…ˆå‘å…¶å§”æ‰˜å‘é€å¦ä¸€ä¸ªåä¸ºrespondsToSelectorçš„æ¶ˆæ¯ã€‚æ‰€æœ‰ocå¯¹è±¡éƒ½ä»NSObjectç»§æ‰¿ respondsToSelectorï¼šæ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨è¿è¡Œæ—¶æ£€æŸ¥å¯¹è±¡æ˜¯å¦å®ç°äº†æŒ‡å®šçš„æ–¹æ³•ã€‚  </p>
<p>å£°æ˜ç¤ºä¾‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BNRHypnosisViewController</span>()&lt;<span class="title">UITextFieldDelegate</span>&gt;</span></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<h3 id="è®¾ç½®å¼‚å¸¸æ–­ç‚¹"><a href="#è®¾ç½®å¼‚å¸¸æ–­ç‚¹" class="headerlink" title="è®¾ç½®å¼‚å¸¸æ–­ç‚¹"></a>è®¾ç½®å¼‚å¸¸æ–­ç‚¹</h3><p>å½“æœ‰é—®é¢˜æ— æ³•æ‰¾åˆ°é”™è¯¯åŸå› æ—¶ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ å¼‚å¸¸æ–­ç‚¹å®šä½æœ‰é—®é¢˜çš„ä»£ç ã€‚</p>
<h3 id="ç±»æ–¹æ³•ä¸å®ä¾‹æ–¹æ³•"><a href="#ç±»æ–¹æ³•ä¸å®ä¾‹æ–¹æ³•" class="headerlink" title="ç±»æ–¹æ³•ä¸å®ä¾‹æ–¹æ³•"></a>ç±»æ–¹æ³•ä¸å®ä¾‹æ–¹æ³•</h3><p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>ç±»æ–¹æ³•å¯ä»¥è°ƒç”¨ç±»æ–¹æ³•ã€‚</li>
<li>ç±»æ–¹æ³•ä¸å¯ä»¥è°ƒç”¨å®ä¾‹æ–¹æ³•ï¼Œä½†æ˜¯ç±»æ–¹æ³•å¯ä»¥é€šè¿‡åˆ›å»ºå¯¹è±¡æ¥è®¿é—®å®ä¾‹æ–¹æ³•ã€‚</li>
<li>ç±»æ–¹æ³•ä¸å¯ä»¥ä½¿ç”¨å®ä¾‹å˜é‡ã€‚ç±»æ–¹æ³•å¯ä»¥ä½¿ç”¨selfï¼Œå› ä¸ºselfä¸æ˜¯å®ä¾‹å˜é‡ã€‚<ul>
<li>å®ä¾‹æ–¹æ³•é‡Œé¢çš„selfï¼Œæ˜¯å¯¹è±¡çš„é¦–åœ°å€ã€‚</li>
<li>ç±»æ–¹æ³•é‡Œé¢çš„selfï¼Œæ˜¯Class.</li>
</ul>
</li>
<li>ç±»æ–¹æ³•ä½œä¸ºæ¶ˆæ¯ï¼Œå¯ä»¥è¢«å‘é€åˆ°ç±»æˆ–è€…å¯¹è±¡é‡Œé¢å»ï¼ˆå®é™…ä¸Šï¼Œå°±æ˜¯å¯ä»¥é€šè¿‡ç±»æˆ–è€…å¯¹è±¡è°ƒç”¨ç±»æ–¹æ³•çš„æ„æ€ï¼‰ã€‚</li>
</ol>
<h2 id="UINavigationController"><a href="#UINavigationController" class="headerlink" title="UINavigationController"></a>UINavigationController</h2><h3 id="UINavigationControllerå¯¹è±¡"><a href="#UINavigationControllerå¯¹è±¡" class="headerlink" title="UINavigationControllerå¯¹è±¡"></a>UINavigationControllerå¯¹è±¡</h3><p>UINavigationControllerç‹¬äº«æ˜¾ç¤ºå¤šä¸ªå±å¹•ä¿¡æ¯æ—¶ï¼Œç›¸åº”çš„UINavigationControllerå¯¹è±¡ä¼šä»¥æ ˆçš„å½¢å¼ä¿å­˜æ‰€æœ‰å±å¹•ä¿¡æ¯ã€‚åˆå§‹åŒ–UINavigationControllerå¯¹è±¡æ—¶ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªUIViewControllerå¯¹è±¡ä½œä¸ºUINavigationControllerå¯¹è±¡çš„æ ¹è§†å›¾æ§åˆ¶å™¨ï¼Œä¸”æ ¹è§†å›¾æ§åˆ¶å™¨å°†æ°¸è¿œä½äºæ ˆåº•ã€‚</p>
<p>UINavigationControllerå¯¹è±¡æœ‰ä¸€ä¸ªåä¸º<strong>viewControllers</strong>çš„å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªè´Ÿè´£ä¿å­˜è§†å›¾æ§åˆ¶å™¨çš„æ•°ç»„ã€‚<strong>topViewController</strong>å±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å½“å‰ä½äºæ ˆé¡¶çš„è§†å›¾æ§åˆ¶å™¨ã€‚</p>
<p>UINavigationControlleræ˜¯UIViewControllerçš„å­ç±»ï¼Œæ‰€ä»¥UINavigationControlleræœ‰è‡ªå·±çš„è§†å›¾ã€‚è¯¥è§†å›¾æœ‰<strong>ä¸¤ä¸ªå­è§†å›¾</strong>ï¼šä¸€ä¸ªæ˜¯<strong>UINavigationBarå¯¹è±¡</strong>ï¼Œä¸€ä¸ªæ˜¯<strong>topViewControllerçš„è§†å›¾</strong>ã€‚</p>
<p>åˆå§‹åŒ–UINavigationControllerå¯¹è±¡ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UINavigationController</span> *navController = [[<span class="built_in">UINavigationController</span> alloc]initWithRootViewController:viewController];</div></pre></td></tr></table></figure></p>
<h3 id="å…³è”xib"><a href="#å…³è”xib" class="headerlink" title="å…³è”xib"></a>å…³è”xib</h3><p>ä¸è¦å°†å­è§†å›¾è®¾ç½®åœ¨viewçš„æœ€é¡¶ç«¯ã€‚åœ¨è§†å›¾æ§åˆ¶å™¨ä¸­ï¼Œviewä¼šè¡¬äºUINavigationBarä¸‹æ–¹ï¼Œå¯¼è‡´UInavigationBaré®æŒ¡viewæœ€é¡¶ç«¯å†…å®¹ã€‚ï¼ˆUITabBaråŒæ ·ï¼‰</p>
<p>åœ¨xibä¸­æŒ‰ä½Controlæ‹–æ‹½åˆ°ç±»æ‹“å±•ä¸­ï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªå¸¦IBOutletå‰ç¼€çš„å±æ€§ã€‚</p>
<p>è®¾ç½®xibæ–‡ä»¶æ—¶ï¼Œè¦ç¡®ä¿å…³è”æ­£ç¡®ï¼Œäº§ç”Ÿé”™è¯¯çš„å¸¸è§åŸå› æ˜¯ï¼šä¿®æ”¹äº†æŸä¸ªæ’åº§å˜é‡çš„å˜é‡åï¼Œä½†æ˜¯æ²¡æœ‰æ›´æ–°xibæ–‡ä»¶ä¸­çš„ç›¸åº”å…³è”ã€‚</p>
<h3 id="å°†è§†å›¾æ§åˆ¶å™¨å‹å…¥æ ˆ"><a href="#å°†è§†å›¾æ§åˆ¶å™¨å‹å…¥æ ˆ" class="headerlink" title="å°†è§†å›¾æ§åˆ¶å™¨å‹å…¥æ ˆ"></a>å°†è§†å›¾æ§åˆ¶å™¨å‹å…¥æ ˆ</h3><p>ä½¿ç”¨UINavigationControllerå¯¹è±¡æ—¶ï¼Œé€šå¸¸ä¼šç”±å¤„äºæ ˆé¡¶çš„è§†å›¾æ§åˆ¶å™¨æ¥è´Ÿè´£å‹å…¥å¦ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="keyword">self</span>.navigationController pushViewController:detailController animated:<span class="literal">YES</span>];</div></pre></td></tr></table></figure></p>
<p>è§†å›¾æ§åˆ¶å™¨å‘é€navigationControlleræ¶ˆæ¯ï¼Œå¯ä»¥å¾—åˆ°æŒ‡å‘UINavigationControllerå¯¹è±¡çš„æŒ‡é’ˆã€‚</p>
<h3 id="è§†å›¾æ§åˆ¶å™¨é—´ä¼ é€’æ•°æ®"><a href="#è§†å›¾æ§åˆ¶å™¨é—´ä¼ é€’æ•°æ®" class="headerlink" title="è§†å›¾æ§åˆ¶å™¨é—´ä¼ é€’æ•°æ®"></a>è§†å›¾æ§åˆ¶å™¨é—´ä¼ é€’æ•°æ®</h3><h3 id="NavigationBar"><a href="#NavigationBar" class="headerlink" title="NavigationBar"></a>NavigationBar</h3><p>UIViewControllerå¯¹è±¡æœ‰ä¸€ä¸ªnavigationItemå±æ€§ï¼Œç±»å‹ä¸ºUINavigationItemã€‚å’ŒNavigationBarä¸åŒï¼Œä¸æ˜¯UIViewçš„å­ç±»ï¼Œä¸èƒ½æ˜¾ç¤ºï¼Œè€Œæ˜¯ä¸ºUINavigationBaræä¾›ç»˜å›¾æ‰€éœ€å†…å®¹ã€‚å½“UIViewControlleræˆä¸ºUINavigationControllerçš„æ ˆé¡¶å¯¹è±¡æ—¶ï¼ŒUINavigationBarå¯¹è±¡ä¼šè®¿é—®è¯¥UIViewControllerå¯¹è±¡çš„navigationItemï¼Œè·å–å’Œç•Œé¢æ˜¾ç¤ºç›¸å…³çš„å†…å®¹ã€‚</p>
<p>UINavigationItemé™¤äº†è®¾ç½®titleå±æ€§å¤–ï¼Œè¿˜å¯ä»¥è®¾ç½®å…¶ä»–å±æ€§ï¼šleftBarButtonItemï¼ŒrightBarButtonItemå’ŒtitleViewã€‚titleViewå¯ä»¥å°†åŸæœ‰titleçš„ä½ç½®æ›¿æ¢ä¸ºä¸€ä¸ªviewã€‚</p>
<p>åˆ›å»ºä¸€ä¸ªbuttonItemï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)initNavigationView&#123;</div><div class="line">    <span class="built_in">UIButton</span> *backBtn = [[<span class="built_in">UIButton</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">26</span>, <span class="number">44</span>)];</div><div class="line">    [backBtn setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"systemback"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line">    [backBtn addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(backButtonPressedForOrder:) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</div><div class="line">    <span class="built_in">UIBarButtonItem</span> *leftItem  = [[<span class="built_in">UIBarButtonItem</span> alloc]initWithCustomView:backBtn];</div><div class="line">    [<span class="keyword">self</span>.navigationItem setLeftBarButtonItem:leftItem];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[coding æ€»ç»“]]></title>
      <url>http://zhang759740844.github.io/2016/07/31/coding%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>è®°å½•ä¸€äº› coding æ—¶å€™çš„ç»éªŒå§ã€‚æŒç»­æ›´æ–°</p>
<a id="more"></a>
<ul>
<li>åº”è¯¥æ˜¯å“ªä¸ªç±»çš„å·¥ä½œï¼Œå°±å°†ç›¸å…³çš„ä¸œè¥¿æ”¾åˆ°é‚£ä¸ªç±»ä¸­ï¼Œèƒ½è®©æ€è·¯æ›´æ¸…æ™°ã€‚</li>
<li>ç±»ä¹‹é—´æ“ä½œï¼Œæˆ‘å¯ä»¥ç›´æ¥æ“ä½œé‚£ä¸ªç±»ï¼Œä¹Ÿå¯ä»¥ç­‰åˆ°ä¸€ä¸ªè§¦å‘äº‹ä»¶åï¼Œè®©é‚£ä¸ªç±»é—®æˆ‘å¦‚ä½•æ“ä½œã€‚è¿™æ¡è¦çµæ´»è¿ç”¨ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç­‰é‚£ä¸ªç±»é—®æˆ‘è¦å†æ“ä½œï¼Œæ˜¯ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ï¼Œç±»ä¼¼äºæ‡’åŠ è½½ï¼Œè€Œä¸”å¦‚æœé‚£ç§ç±»å¤šçš„è¯ï¼Œä¸éœ€è¦æˆ‘ä¸€ä¸ªä¸ªå»æ“ä½œï¼Œå“ªä¸ªç±»è¦æ‰§è¡Œäº†ï¼Œæ‰¾æˆ‘å°±å¯ä»¥äº†ã€‚ä½†æ˜¯ï¼Œè¿™ä¹Ÿæ˜¯æœ‰é™åˆ¶çš„ï¼Œä¸€ä¸ªå°±æ˜¯å¿…é¡»è¦æœ‰è§¦å‘æ¡ä»¶ï¼Œé‚£ä¸ªç±»èƒ½ä¸»åŠ¨æ‰¾æˆ‘è¦æ“ä½œæ–¹æ³•ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯ï¼Œæˆ‘å¿…é¡»æŠŠè¦ç»™å…¶ä»–ç±»çš„ä¸œè¥¿å…ˆå­˜èµ·æ¥ï¼Œè¿™æ ·æ‰èƒ½è®©åˆ«çš„ç±»è¯»å–ã€‚</li>
<li>å–„ç”¨ä»£ç†æ¨¡å¼ï¼Œå¯ä»¥å°†è‡ªèº«ä½œä¸ºä»£ç†å¯¹è±¡ä¿å­˜åœ¨åˆ«äººdelegateå±æ€§ä¸­ï¼Œåˆ«äººè¦ç”¨çš„æ—¶å€™å°±èƒ½è°ƒæˆ‘çš„æ–¹æ³•ã€‚ä½†æ˜¯è¦æ³¨æ„åŠæ—¶å°†é‚£ä¸ªdelegateå±æ€§æ¸…ç©ºï¼Œä»¥é˜²è‡ªèº«ä¸èƒ½åŠæ—¶è¢«é‡Šæ”¾ã€‚</li>
<li>ä»£ç ä¸­é™¤äº†ç›´æ¥æ“ä½œçš„æ•°å¯ä»¥ç”¨æ•°å­—ï¼Œå¦åˆ™å¦‚indexï¼Œtagä¹‹ç±»çš„æ•°<strong>ä¸€å®šä¸è¦ç›´æ¥å†™æ•°å­—ä¸€å®šä¸è¦ç›´æ¥å†™æ•°å­—ä¸€å®šä¸è¦ç›´æ¥å†™æ•°å­—</strong>ï¼Œå¯ä»¥å†™ä¸ªæšä¸¾ç±»å‹ã€‚å¦åˆ™ä¸€æ—¦ä¸€ä¸ªindexå˜åŒ–ï¼Œé‚£ä¹ˆå°±è¦åœ¨æ•´ä¸ªé¡¹ç›®é‡Œåˆ°å¤„æ‰¾ä¿®æ”¹å’Œè¿™ä¸ªindexæœ‰å…³çš„åœ°æ–¹ã€‚</li>
</ul>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[objective-c å­¦ä¹ ç¬”è®°]]></title>
      <url>http://zhang759740844.github.io/2016/07/31/objectice-c/</url>
      <content type="html"><![CDATA[<p>å¼€å§‹IOSå¼€å‘å¿…ç„¶è¦å…ˆå­¦ä¼šobjective-cï¼Œæœ¬ç¯‡æ˜¯é˜…è¯»äº†ã€Šobject-cç¼–ç¨‹ã€‹ä¸€ä¹¦åæ‘˜å½•çš„ç¬”è®°ï¼Œæ¯”è¾ƒæµ…æ˜¾ã€‚</p>
<a id="more"></a>
<h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><p>å‡½æ•°å¯ä»¥æœ‰å¾ˆå¤šå±€éƒ¨å˜é‡ï¼Œè¿™äº›å˜é‡éƒ½ä¼šä¿å­˜åœ¨å‡½æ•°çš„å¸§ä¸­ã€‚è¿™äº›å¸§å­˜äºæ ˆå†…ã€‚æ‰§è¡Œå‡½æ•°æ—¶ï¼Œå‡½æ•°çš„å¸§ä¼šåœ¨æ ˆçš„é¡¶éƒ¨è¢«åˆ›å»ºã€‚å‡½æ•°è¿”å›æ—¶ï¼Œå¸§é€€å‡ºæ ˆï¼Œç­‰å¾…ä¸‹ä¸€ä¸ªè°ƒç”¨å®ƒçš„å‡½æ•°ç»§ç»­æ‰§è¡Œã€‚</p>
<h3 id="å…¨å±€å˜é‡"><a href="#å…¨å±€å˜é‡" class="headerlink" title="å…¨å±€å˜é‡"></a>å…¨å±€å˜é‡</h3><p>åœ¨å‡½æ•°å¤–å£°æ˜çš„å˜é‡ï¼Œåªè¦ç±»è¢«importå°±èƒ½ä½¿ç”¨ã€‚<br>Javaä¸­ä¸å­˜åœ¨è¿™ç§å…¨å±€å˜é‡ï¼Œåªèƒ½å®šä¹‰ä¸€ä¸ªç±»ï¼Œé€šè¿‡ç±»åï¼Œèµ„æºåè®¿é—®ã€‚<br>ä¸ºäº†é˜²æ­¢æ··æ·†é—®é¢˜ï¼Œå¼•ç”¨é™æ€å˜é‡ã€‚ä¸å…¨å±€å˜é‡ä¸€æ ·ï¼Œä¹Ÿéœ€è¦åœ¨å‡½æ•°å¤–å£°æ˜ã€‚ä¸è¿‡åªæœ‰æŸä¸ªå£°æ˜é™æ€å˜é‡çš„æ–‡ä»¶æ‰èƒ½è®¿é—®ã€‚å¥½å¤„æ˜¯ï¼šæ—¢ä¿ç•™äº†éå±€éƒ¨çš„ã€å­˜åœ¨äºä»»ä½•å‡½æ•°ä¹‹å¤–çš„ä¼˜ç‚¹ï¼Œåˆé¿å…äº†å…¶ä»–æ–‡ä»¶ä¿®æ”¹çš„é—®é¢˜ã€‚<br><strong>é‚£ä¹ˆè¿™å’Œ@propertyæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong>é™æ€å˜é‡æ˜¯æŒä¹…çš„ï¼Œå­˜å‚¨äºé™æ€å­˜å‚¨åŒºï¼Œåœ¨ç¨‹åºåˆšè¿è¡Œæ—¶å°±è¢«å”¯ä¸€ä¸€æ¬¡åˆå§‹åŒ–ï¼Œä¸ä¼šåƒpropertyéšç€å®ä¾‹åŒ–è€Œå˜åŒ–ã€‚</p>
<h3 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h3><p>&amp;è¡¨ç¤ºå–åœ°å€ï¼Œ*è¡¨ç¤ºå–å€¼ã€‚<br>ç©ºæŒ‡é’ˆç”¨nilè€Œä¸æ˜¯nullã€‚</p>
<h3 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h3><p>ä½¿ç”¨ç»“æ„ä¿å­˜å¤šä¸ªç›¸å…³æ•°æ®ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> Person&#123;</div><div class="line">	<span class="keyword">float</span> heightï¼›</div><div class="line">	<span class="keyword">int</span> ageï¼›</div><div class="line">&#125;ï¼›</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨ï¼š<code>struct Person mikeyï¼›</code><br>ä½¿ç”¨typedefç®€åŒ–ã€‚typedefå¯ä»¥ä¸ºæŸç±»å‹å£°æ˜ä¸€ä¸ªç­‰ä»·çš„åˆ«åï¼Œè¯¥åˆ«åç”¨æ³•å’Œå¸¸è§„æ•°æ®ç±»å‹æ— å¼‚ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</div><div class="line">	<span class="keyword">float</span> heightï¼›</div><div class="line">	<span class="keyword">int</span> ageï¼›</div><div class="line">&#125; Personï¼›</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨ï¼š<code>Person mikeyï¼›</code></p>
<h3 id="è·å–ç»“æ„ä¸­çš„å±æ€§ï¼š"><a href="#è·å–ç»“æ„ä¸­çš„å±æ€§ï¼š" class="headerlink" title="è·å–ç»“æ„ä¸­çš„å±æ€§ï¼š"></a>è·å–ç»“æ„ä¸­çš„å±æ€§ï¼š</h3><p>å½“ç»“æ„çš„ä½¿ç”¨è€…æ˜¯ä¸€ä¸ªæŒ‡é’ˆæ—¶ï¼Œä½¿ç”¨-&gt;è¡¨ç¤ºå…ˆè·å–æŒ‡é’ˆpæŒ‡å‘çš„æ•°æ®ç»“æ„ï¼Œç„¶åè¿”å›è¯¥ç»“æ„çš„æˆå‘˜å˜é‡ã€‚<br>å½“ç»“æ„çš„ä½¿ç”¨è€…æ˜¯ä¸€ä¸ªå®ä¾‹æ—¶ï¼Œä½¿ç”¨.è¡¨ç¤ºè®¿é—®å±æ€§ã€‚</p>
<h3 id="id"><a href="#id" class="headerlink" title="id %@"></a>id %@</h3><p>idè¡¨ç¤ºå¯ä»¥æŒ‡å‘ä»»æ„ç±»å‹çš„æŒ‡é’ˆã€‚å˜é‡å£°æ˜ä¸ä½¿ç”¨æ˜Ÿå·ã€‚idå·²ç»éšå«äº†æ˜Ÿå·çš„ä½œç”¨ã€‚<br>InstanceTypeè¡¨ç¤ºæ–¹æ³•çš„è¿”å›ç±»å‹ã€‚<br>%@è¡¨ç¤ºå ä½ç¬¦ï¼Œä»£è¡¨æŒ‡é’ˆï¼Œä¼šå‘ç›¸åº”æŒ‡é’ˆå˜é‡å¯¹è±¡å‘é€descriptionæ¶ˆæ¯ã€‚</p>
<h3 id="NSString"><a href="#NSString" class="headerlink" title="NSString"></a>NSString</h3><p>@â€œâ€¦â€è¡¨ç¤ºåˆ›å»ºä¸€ä¸ªNSStringå¯¹è±¡ã€‚éœ€è¦çŸ¥é“å­—ç¬¦ä¸²å®Œæ•´å†…å®¹ã€‚<br>ä¹Ÿå¯ä½¿ç”¨stringWithFormatæ–¹æ³•åŠ¨æ€åˆ›å»ºï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *dateString = [<span class="built_in">NSString</span> stringWithFormat:@â€œThe date is %@â€, now]</div></pre></td></tr></table></figure></p>
<h3 id="NSArray"><a href="#NSArray" class="headerlink" title="NSArray"></a>NSArray</h3><p>åˆ›å»ºï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSArray</span> *dateList = @[now, tomorrow ,yesterday];</div></pre></td></tr></table></figure></p>
<p>NSArrayæ˜¯æ— æ³•æ”¹å˜çš„ï¼Œè¢«åˆ›å»ºåæ— æ³•æ·»åŠ åˆ é™¤ä»¥åŠæ”¹å˜é¡ºåºã€‚<br>å¿«é€Ÿéå†æ•°ç»„ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="built_in">NSDate</span> *d <span class="keyword">in</span> daeList)&#123;&#125;</div></pre></td></tr></table></figure></p>
<h3 id="NSMutableArray"><a href="#NSMutableArray" class="headerlink" title="NSMutableArray"></a>NSMutableArray</h3><p>å¯å˜æ•°ç»„ï¼Œå¯æ·»åŠ åˆ é™¤å’Œä¿®æ”¹é¡ºåºã€‚<br>insertObjectï¼šatIndexåœ¨æŒ‡å®šä½ç½®æ’å…¥<br>removeObjectï¼šatIndexåˆ é™¤æ•°ç»„ä¸­å¯¹è±¡<br>å¿«é€Ÿéå†æ—¶ä¸èƒ½æ·»åŠ åˆ é™¤æ•°ç»„å†…æ•°æ®ã€‚</p>
<h3 id="è‡ªå®šä¹‰ä¸€ä¸ªç±»"><a href="#è‡ªå®šä¹‰ä¸€ä¸ªç±»" class="headerlink" title="è‡ªå®šä¹‰ä¸€ä¸ªç±»"></a>è‡ªå®šä¹‰ä¸€ä¸ªç±»</h3><p>å¤´æ–‡ä»¶ä»¥@interfaceå¼€å§‹ï¼Œ@endç»“æŸã€‚èŠ±æ‹¬å·å†…å£°æ˜å®ä¾‹å˜é‡ï¼Œå®ä¾‹å˜é‡ä»¥ä¸‹åˆ’çº¿â€_â€å¼€å§‹<br>å–æ–¹æ³•åå­—å’Œç›¸åº”å®ä¾‹å˜é‡ä¸€æ ·ï¼Œå¼¹è¯å»æ‰å®ä¾‹å˜é‡å¼€å¤´çš„ä¸‹åˆ’çº¿ã€‚å­˜æ–¹æ³•ä»¥setå¼€å¤´ï¼Œåé¢æ›´ä¸Šå»æ‰ä¸‹åˆ’çº¿çš„å®ä¾‹å˜é‡åã€‚</p>
<h3 id="self"><a href="#self" class="headerlink" title="self"></a>self</h3><p>selfæ˜¯æŒ‡é’ˆï¼ŒæŒ‡å‘è¿è¡Œå½“å‰æ–¹æ³•çš„å¯¹è±¡ã€‚</p>
<h3 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h3><p>å±æ€§çš„å£°æ˜ä»¥@propertyå¼€å¤´ï¼Œç„¶åæ˜¯ç±»å‹å’Œåç§°ã€‚å±æ€§è‡ªåŠ¨å£°æ˜å­˜å–æ–¹æ³•ã€‚<br>ä½¿ç”¨â€.â€è·å–å±æ€§å…¶å®æ˜¯åœ¨å‘é€æ¶ˆæ¯ï¼Œè°ƒç”¨getsetæ–¹æ³•ã€‚è¯­æ³•ç³–ã€‚</p>
<h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h3><p>NSObjectæ˜¯æ‰€æœ‰ç±»çš„åŸºç±»ï¼Œæ‹¥æœ‰ä¸€ä¸ªå®ä¾‹å˜é‡ï¼šisaæŒ‡é’ˆã€‚ä»»ä½•ä¸€ä¸ªå¯¹è±¡çš„isaæŒ‡é’ˆéƒ½æŒ‡å‘åˆ›å»ºçˆ±ä½ è¯¥å¯¹è±¡çš„ç±»ã€‚å‘é€æ¶ˆæ¯æ—¶ï¼Œå¯¹è±¡æŸ¥è¯¢æ˜¯å¦æœ‰è¯¥æ¶ˆæ¯åçš„æ–¹æ³•ã€‚æ²¡æœ‰åˆ™ç»§ç»­æŸ¥è¯¢çˆ¶ç±»ã€‚çˆ¶ç±»ä¹Ÿæ²¡æœ‰ï¼ŒæŸ¥æ‰¾å‚æ•°è¶…ç±»ã€‚</p>
<h3 id="class"><a href="#class" class="headerlink" title="@class"></a>@class</h3><p>ä¸€èˆ¬æ¥è¯´ï¼Œ@classæ˜¯æ”¾åœ¨interfaceä¸­çš„ï¼Œåªæ˜¯ä¸ºäº†åœ¨interfaceä¸­å¼•ç”¨è¿™ä¸ªç±»ï¼ŒæŠŠè¿™ä¸ªç±»ä½œä¸ºä¸€ä¸ªç±»å‹æ¥ç”¨çš„ã€‚ åœ¨å®ç°è¿™ä¸ªæ¥å£çš„å®ç°ç±»ä¸­ï¼Œå¦‚æœéœ€è¦å¼•ç”¨è¿™ä¸ªç±»çš„å®ä½“å˜é‡æˆ–è€…æ–¹æ³•ä¹‹ç±»çš„ï¼Œè¿˜æ˜¯éœ€è¦importåœ¨@classä¸­å£°æ˜çš„ç±»è¿›æ¥.<br>å¦‚æœClassA.hä¸­ä»…éœ€è¦å£°æ˜ä¸€ä¸ªClassBçš„æŒ‡é’ˆï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨ClassA.hä¸­å£°æ˜@ClassB</p>
<h3 id="ç±»æ‹“å±•"><a href="#ç±»æ‹“å±•" class="headerlink" title="ç±»æ‹“å±•"></a>ç±»æ‹“å±•</h3><p>ç±»æ‹“å±•æ˜¯ä¸€ç»„ç§æœ‰çš„å£°æ˜ã€‚åªæœ‰ç±»å’Œå…¶å®ä¾‹æ‰èƒ½ä½¿ç”¨åœ¨ç±»æ‹“å±•ä¸­å£°æ˜çš„å±æ€§æ–¹æ³•ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import â€œBNREmployee.hâ€</span></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BNREmployee</span>()	</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="keyword">unsigned</span> <span class="keyword">int</span> officeAlarmCode;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„è¦æœ‰æ‹¬å·ï¼Œå†™åœ¨implementå‰é¢ã€‚<br>å¤´æ–‡ä»¶ä¸­çš„å±æ€§ç›¸å½“äºå…¬æœ‰ï¼Œå¯ä»¥é€šè¿‡åŒæ ·å…¬æœ‰çš„getsetæ–¹æ³•è·å–ã€‚ç±»æ‹“å±•æ— æ³•åˆ™æ— æ³•åœ¨å…¶å®ƒç±»ä¸­ç›´æ¥è·å¾—ï¼Œå¿…é¡»æ‰‹åŠ¨è®¾ç½®getsetæ–¹æ³•ã€‚</p>
<h3 id="å¼±å¼•ç”¨"><a href="#å¼±å¼•ç”¨" class="headerlink" title="å¼±å¼•ç”¨"></a>å¼±å¼•ç”¨</h3><p>é€šè¿‡å¼±å¼•ç”¨å¯ä»¥è§£å†³å¼ºå¼•ç”¨å¾ªç¯ã€‚å¼ºå¼•ç”¨ä¼šä¿ç•™å¯¹è±¡çš„æ‹¥æœ‰æ–¹ï¼Œä½¿å…¶ä¸ä¼šé‡Šæ”¾ã€‚å¼±å¼•ç”¨åˆ™ä¸ä¼šä¿ç•™ã€‚</p>
<h3 id="Collectionç±»"><a href="#Collectionç±»" class="headerlink" title="Collectionç±»"></a>Collectionç±»</h3><p>NSSetå¯¹è±¡åŒ…å«çš„å†…å®¹æ˜¯æ— åºçš„ï¼Œå¹¶ä¸”åœ¨NSSetå¯¹è±¡ä¸­ï¼Œç‰¹å®šå¯¹è±¡åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚å…¶æœ€å¤§ç”¨å¤„æ˜¯æ£€æŸ¥æŸä¸ªå¯¹è±¡æ˜¯å¦å­˜åœ¨ã€‚NSMutableSetå¯ä»¥æ·»åŠ åˆ é™¤setå†…æ•°æ®ã€‚<br>NSDictionaryå¯¹è±¡æ˜¯é”®å€¼å¯¹é›†åˆã€‚å­—å…¸çš„å­—é¢é‡è¯­æ³•ç”±@å’Œ{}ç»„æˆã€‚å­—å…¸é‡Œçš„é”®æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚<br>NSMutableæ˜¯NSçš„å­ç±»ã€‚<br>collectionä¸èƒ½ä¿å­˜nilã€‚å¦‚æœè¦ä¿å­˜nilåˆ™è¦ä¿å­˜NSNullç±»çš„å®ä¾‹ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[hotel addObject:[<span class="built_in">NSNull</span> null]];</div></pre></td></tr></table></figure></p>
<h3 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h3><p>å¯ä»¥é€šè¿‡ä¸¤ç§é€”å¾„å®šä¹‰å¸¸é‡ï¼Œ#defineå’Œå…¨å±€å˜é‡ã€‚  </p>
<ol>
<li>#define A B å‘Šè¯‰ç¼–è¯‘å™¨çœ‹åˆ°Aç”¨Bæ›¿æ¢</li>
<li>extern NSString const *NSLocaleCurrencyCodeï¼›<br>constè¡¨ç¤ºæŒ‡é’ˆçš„ä¸ä¼šå˜åŒ–,externè¡¨ç¤ºæŒ‡é’ˆæ˜¯å­˜åœ¨çš„ï¼Œä½†æ˜¯ä¼šåœ¨å¦ä¸€ä¸ªæ–‡ä»¶é‡Œå®šä¹‰ã€‚æç¤ºç¼–è¯‘å™¨é‡åˆ°æ­¤å˜é‡å’Œå‡½æ•°æ—¶åœ¨å…¶ä»–æ¨¡å—ä¸­å¯»æ‰¾å…¶å®šä¹‰</li>
</ol>
<h3 id="includeå’Œ-import"><a href="#includeå’Œ-import" class="headerlink" title="#includeå’Œ#import"></a>#includeå’Œ#import</h3><p>importä¼šç¡®ä¿é¢„å¤„ç†å™¨åªå¯¼å…¥ç‰¹å®šçš„æ–‡ä»¶ä¸€æ¬¡ï¼Œincludeå…è®¸å¤šæ¬¡å¯¼å…¥åŒä¸€ä¸ªæ–‡ä»¶ã€‚æœ€å¥½ä½¿ç”¨importã€‚</p>
<h3 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h3><p>åè®®å¯ä»¥ä¸ºä¸€ä¸ªå¯¹è±¡æŒ‡å®šè§’è‰²ã€‚ç±»ä¼¼äºæ¥å£ã€‚å¦‚æœæŸä¸ªå¯¹è±¡è¦æ‰®æ¼”ç‰¹å®šçš„è§’è‰²ï¼Œå°±ä¸€å®šè¦å®ç°ç›¸åº”çš„å¿…é¡»æ–¹æ³•ï¼Œå¹¶é€‰æ‹©å®ç°éƒ¨åˆ†å¯é€‰æ–¹æ³•ã€‚<br>UITableViewæ•°æ®æºåè®®æ˜¯UITableViewDataSourceï¼Œæ–¹æ³•å£°æ˜å¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@protocal <span class="built_in">UITableViewDataSource</span>&lt;<span class="built_in">NSObject</span>&gt;</div><div class="line"><span class="keyword">@required</span></div><div class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tv</div><div class="line">	numberOfRowsInSection:(<span class="built_in">NSInteger</span>) section;</div><div class="line"><span class="keyword">@optional</span></div><div class="line">â€¦â€¦.</div></pre></td></tr></table></figure></p>
<h3 id="èŒƒç•´"><a href="#èŒƒç•´" class="headerlink" title="èŒƒç•´"></a>èŒƒç•´</h3><p>é€šè¿‡èŒƒç•´ï¼ˆcategoryï¼‰å¯ä»¥ä¸ºä»»ä½•å·²æœ‰çš„ç±»æ·»åŠ æ–¹æ³•ã€‚<br>åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œç±»å‹ä¸ºObjective-c categoryï¼Œå°†æ–°èŒƒç•´å‘½åä¸ºBNRVowelCountingï¼Œå¯¹åº”ç±»ä¸ºNSStringã€‚<br>æ‰“å¼€NSString+BNRVowelCounting.hä¸ºèŒƒç•´å£°æ˜ä¸€ä¸ªæ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šè¢«åŠ å…¥NSStringç±»ã€‚<br>å£°æ˜ç¤ºä¾‹ï¼šNSString+MD5.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSString</span> (<span class="title">MD5</span>)</span></div><div class="line">+ (<span class="built_in">NSString</span> *)md5:(<span class="built_in">NSString</span> *)originalStr;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[é‡æ–°å¼€å§‹]]></title>
      <url>http://zhang759740844.github.io/2016/07/30/%E9%87%8D%E6%96%B0%E5%BC%80%E5%A7%8B/</url>
      <content type="html"><![CDATA[<p>æ—¶éš”æ¥è¿‘ä¸€å¹´ï¼Œç»ˆäºè¿˜æ˜¯å‡†å¤‡é‡å¼€ä¸ªäººç½‘ç«™ã€‚è¿‡å»ä¸€å¹´å­¦äº†å¾ˆå¤šï¼Œè®°äº†å¾ˆå¤šï¼Œè¿™æ˜¯æˆ‘æ„Ÿåˆ°éå¸¸å®½æ…°çš„ã€‚çŸ¥è¯†æ˜¯è¦ä¸æ–­å·©å›ºçš„ï¼Œä¸ªäººç½‘é¡µä¸è§å¾—è¦ç»™åˆ«äººçœ‹åˆ°ï¼Œè‡ªå·±æ²¡äº‹çš„æ—¶å€™ç»å¸¸ç¿»ç¿»è‡ªå·±æ›¾ç»åšäº†ä»€ä¹ˆï¼Œå­¦äº†ä»€ä¹ˆã€‚æ— å½¢ä¸­ï¼Œä¹Ÿæ˜¯ä¸€ç§è®°å¿†çš„è„šå°ã€‚</p>
<a id="more"></a>
<p>ä¸è¿‡ï¼Œä¹‹å‰ä¸€æ¥å¯¹äºgitï¼Œhexoçš„æŒæ¡ç¨‹åº¦è¾ƒä½ï¼ŒäºŒæ¥æ²¡æœ‰ä»”ç»†æ£€æŸ¥å¤‡ä»½ï¼Œå¯¼è‡´åœ¨è¿ç§»çš„æ—¶å€™ï¼Œè¾›è¾›è‹¦è‹¦å†™çš„åå‡ ç¯‡ç¬”è®°éƒ½ä¸¢å¤±äº†ã€‚ä¸€åº¦éå¸¸æ‡Šæ¼ï¼Œä¸æƒ³å†åšè¿™äº›è´¹æ—¶è´¹åŠ›çš„äº‹äº†ã€‚</p>
<p>ä»Šå¤©ï¼Œç»ˆäºåˆè€ä¸‹æ€§å­ï¼ŒæŠŠæ•´ä¸ªä¸ªäººç½‘ç«™åˆå¼„èµ·æ¥äº†ã€‚è™½ç„¶åŠŸèƒ½è¿˜æ˜¯å¾ˆç®€å•ï¼Œå…¨å½“æ˜¯ä¸€ä¸ªè®°å½•çš„åœ°æ–¹å§ã€‚æ€»ä¹‹ï¼Œè¿™å°±ç®—æ˜¯é‡æ–°å¼€å§‹äº†ã€‚è¿™ä¹Ÿç®—æ˜¯ä¸€ä¸ªæ–°çš„èµ·ç‚¹å§ã€‚å¤šåšæ€»ç»“ï¼Œå¤šåšåˆ†äº«ã€‚å¸Œæœ›è‡ªå·±èƒ½å¤Ÿä¿æŒå­¦ä¹ çš„åŠ¨åŠ›ï¼Œå†æ¥å†å‰ï¼</p>
<p><img src="https://github.com/zhang759740844/MyImgs/blob/master/MyBlog/Come_on.jpg?raw=true" alt="fighting"></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>http://zhang759740844.github.io/2016/07/29/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<a id="more"></a>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    </entry>
    
  
  
</search>
