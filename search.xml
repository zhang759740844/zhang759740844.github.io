<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[JS ‰∏≠ÁöÑÊ≠£ÂàôË°®ËææÂºèÁöÑ‰ΩøÁî®]]></title>
    <url>%2F2020%2F03%2F25%2FJS%E4%B8%AD%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[ÁªèÂ∏∏‰ºöÊúâÂÜôËÑöÊú¨ÂÅöÊñáÊú¨ÊõøÊç¢ÁöÑÈúÄÊ±Ç„ÄÇ‰∏ÄÊúâËøôÁßçÈúÄÊ±ÇÂ∞±Ë¶ÅÂéªÂ∑ÆÊÄé‰πàÂÜôÊ≠£ÂàôË°®ËææÂºèÔºåÈùûÂ∏∏ÁöÑË¥πÊó∂„ÄÇËøôÈáåÊää‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÂàó‰∏æ‰∏Ä‰∏ãÊñπ‰æø‰ª•ÂêéÂõûÈ°æ„ÄÇ Ê≠£ÂàôË°®ËææÂºèÂÖÉÂ≠óÁ¨¶ ÂÖÉÂ≠óÁ¨¶ ËØ¥Êòé $ ÂåπÈÖçÂ≠óÁ¨¶‰∏≤ÁöÑÁªìÊùü ^ ÂåπÈÖçÂ≠óÁ¨¶‰∏≤ÁöÑÂºÄÂßã . ÂåπÈÖçÈô§Êç¢Ë°åÁ¨¶‰ª•Â§ñÁöÑ‰ªªÊÑèÂ≠óÁ¨¶ [a-zA-Z] ÂåπÈÖçÊâÄÊúâËã±ÊñáÂ≠óÁ¨¶ [0-9] ÂåπÈÖçÊâÄÊúâÊï∞Â≠ó [^a-z] ÂåπÈÖçÈô§‰∫ÜÂ∞èÂÜôÂ≠óÊØçÁöÑÊâÄÊúâÂ≠óÁ¨¶ ÈáçÂ§ç ÈáçÂ§ç ËØ¥Êòé * ÈáçÂ§çÈõ∂Ê¨°ÊàñÊõ¥Â§öÊ¨° + ÈáçÂ§ç‰∏ÄÊ¨°ÊàñÊõ¥Â§öÊ¨° ? ÈáçÂ§çÈõ∂Ê¨°Êàñ‰∏ÄÊ¨° {n} ÈáçÂ§çnÊ¨° {n,} ÈáçÂ§çnÊ¨°ÊàñÊõ¥Â§öÊ¨° {n,m} ÈáçÂ§çnÂà∞mÊ¨° ÂàÜÊîØ ÂàÜÊîØ ËØ¥Êòé Á´ñÁ∫ø Áõ∏ÂΩì‰∫éÊàñ ÂàÜÊîØÊòØÊåá‰∏§‰∏™ÂÆåÊï¥ÁöÑÊ≠£Âú®Ë°®ËææÂºèÂèñÊàñÔºåËÄå‰∏çÊòØÈÉ®ÂàÜÊàñ |ÂâçÂêéÁî®ÔºàÔºâÂåÖÊã¨Ôºö(A)|(B) Âè¶Â§ñ | ‰∏çËÉΩÊúâÁ©∫Ê†ºÔºåÂê¶Âàô‰ºö‰ª•‰∏∫Ë¶ÅÂåπÈÖçÁ©∫Ê†º ‰øÆÈ•∞Á¨¶ ‰øÆÈ•∞Á¨¶ ËØ¥Êòé i ÊâßË°åÂØπÂ§ßÂ∞èÂÜô‰∏çÊïèÊÑüÁöÑÂåπÈÖç„ÄÇ g ÊâßË°åÂÖ®Â±ÄÂåπÈÖçÔºàÊü•ÊâæÊâÄÊúâÂåπÈÖçËÄåÈùûÂú®ÊâæÂà∞Á¨¨‰∏Ä‰∏™ÂåπÈÖçÂêéÂÅúÊ≠¢Ôºâ„ÄÇ m ÊâßË°åÂ§öË°åÂåπÈÖç„ÄÇ Ê≠£ÂàôË°®ËææÂºèÂíåÈÄöÈÖçÁ¨¶ÁöÑ‰∏çÂêåÂú® sql ÁöÑ like ËØ≠Âè•‰∏≠Ôºö% ‰ªªÊÑèÂ§ö‰∏™Ôºå _Ë°®Á§∫ ‰∏Ä‰∏™ ÊôÆÈÄöÁöÑÁªüÈÖçÁ¨¶Ôºö * ‰ªªÊÑèÂ§ö‰∏™ ? ‰∏Ä‰∏™ JS ‰∏≠ÁöÑÊ≠£ÂàôË°®ËææÂºèjs ‰∏≠‰ΩøÁî® Ê≠£ÂàôË°®ËææÂºè.exec(ÁõÆÊ†áÂ≠óÁ¨¶‰∏≤) ÁöÑÂΩ¢ÂºèÂ§ÑÁêÜ„ÄÇÊ≠£ÂàôË°®ËææÂºè‰ª• // ÂåÖË£π„ÄÇ 1234567891011var reg = /(.a)t/g;var str ="1at,2at,3at";console.log(reg.exec(str));console.log(reg.exec(str));console.log(reg.exec(str));console.log(reg.exec(str));‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî[ '1at', '1a', index: 0, input: '1at,2at,3at' ][ '2at', '2a', index: 4, input: '1at,2at,3at' ][ '3at', '3a', index: 8, input: '1at,2at,3at' ]null ‰∏äÈù¢Ê≤°ÊúâËØ¥Âà∞‰øÆÈ•∞Á¨¶Ôºå‰ΩÜÊòØ‰øÆÈ•∞Á¨¶ÁöÑ‰ΩúÁî®ÂèØËÉΩ‰∏çÊòéÁ°ÆÔºåÂ∞§ÂÖ∂ÊòØËøô‰∏™ g„ÄÇg ‰ª£Ë°®ÁöÑÊòØÂåπÈÖç‰∫Ü‰πãÂêéÂÜçÊ¨°ÊâßË°å‰∏ç‰ºö‰ªéÂ§¥ÂºÄÂßã„ÄÇ‰∏äÈù¢ÁöÑËæìÂá∫‰∏≠ÂèØ‰ª•ÁúãÂà∞ÔºåÊØèÊ¨°ÊâßË°åÈÉΩ‰ºöÊâæ‰∏ã‰∏Ä‰∏™ÂåπÈÖçÈ°π„ÄÇËÄåÂ¶ÇÊûú‰∏çÊòØ gÔºåÈÇ£‰πàÂ∞±‰ºö‰ªéÂ§¥ÂºÄÂßã„ÄÇ 1234567891011var reg = /(.a)t/;var str ="1at,2at,3at";console.log(reg.exec(str));console.log(reg.exec(str));console.log(reg.exec(str));console.log(reg.exec(str));‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî[ '1at', '1a', index: 0, input: '1at,2at,3at' ][ '1at', '1a', index: 0, input: '1at,2at,3at' ][ '1at', '1a', index: 0, input: '1at,2at,3at' ][ '1at', '1a', index: 0, input: '1at,2at,3at' ] Ê≠£ÂàôË°®ËææÂºè.exec(ÁõÆÊ†áÂ≠óÁ¨¶‰∏≤) ËøîÂõûÁöÑÁªìÊûú‰∏ÄËà¨ÊòØ‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫1ÁöÑÁ¥†ÁªÑÔºåÊâÄ‰ª•Áõ¥Êé•ÊâìÂç∞Â∞±Ë°å‰∫ÜÔºå‰ΩÜÊòØÊúâÊó∂ÂÄô‰ºöËøîÂõû‰∏Ä‰∏™ÈïøÂ∫¶Èùû1ÁöÑÊï∞ÁªÑÔºåÂéüÂõ†Êú™Áü•„ÄÇÂõ†Ê≠§ÊúÄÂ•ΩËøîÂõûÁªìÊûúÂèñÁ¨¨‰∏Ä‰∏™]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[C++ÁÆÄÁï•ËØ≠Ê≥ï]]></title>
    <url>%2F2020%2F01%2F23%2FC%2B%2B%2F</url>
    <content type="text"><![CDATA[ÂÅáÊúüÊó†‰∫ãÔºåÈáçÂ≠¶C++ÔºåÁÆÄÂçïÊëòÂΩï‰∫Ü‰∏Ä‰∫õ C++ ÁöÑÂü∫Êú¨ËØ≠Ê≥ïÔºåÂÖ∑‰ΩìËøòÈúÄË¶ÅÂÜçÁúã C++ Primer„ÄÇ .cpp ÁöÑÁî±Êù•.cpp ÊÑè‰∏∫ c plus plus Áî® C ËØ≠Ë®ÄÁöÑÊñπÂºèÂéªÁºñËØë‰ΩøÁî®Âú∫ÊôØÊòØÂ¶ÇÊûú‰Ω†Ë¶Å‰ΩøÁî®Âà´‰∫∫Áî® c ÂÜôÁöÑÁ¨¨‰∏âÊñπÂ∫ìÁöÑÊó∂ÂÄôÔºåÁî±‰∫é C++ ÁöÑÂáΩÊï∞ÁºñËØëÊñπÂºèÂíå C ‰∏çÂêå„ÄÇC++ ‰ºöÈªòËÆ§ÊåâÁÖß C++ ÁöÑÊñπÂºèÂéªÊü•ÊâæÂáΩÊï∞ÔºåËøôÊ†∑ÊòØÊó†Ê≥ïÊâæÂà∞ C ÁöÑÂáΩÊï∞ÂÆûÁé∞ÁöÑÔºåÊâÄ‰ª•ÂøÖÈ°ªÂÖàÂ£∞ÊòéËØ•ÂáΩÊï∞ÊòØ C ÁöÑÂáΩÊï∞1234567891011// .cpp ‰∏≠ÁöÑÂ£∞Êòéextern "C" void test(int a);extern "C" &#123; // ÂºïÁî® c Â§¥Êñá‰ª∂ #include "math.h"&#125;// .c ‰∏≠ÁöÑÂÆûÁé∞void test(int a)&#123; cout &lt;&lt; "single";&#125; C++ Áî±‰∫éÊîØÊåÅÂáΩÊï∞ÈáçËΩΩÔºå‰ºöÂú®ÁºñËØëÂáΩÊï∞ÁöÑÊó∂ÂÄôÊääÂèÇÊï∞Á±ªÂûã‰πüÊ∑ªÂä†‰∏∫ÂáΩÊï∞Ê†áËØÜ‰∏≠ÔºåËÄå C ‰∏çÊîØÊåÅÈáçËΩΩÔºå‰∏çÂÖ≥ÂøÉÂáΩÊï∞ÂèÇÊï∞„ÄÇÂõ†Ê≠§ C++ ‰∏≠Áõ¥Êé•Ë∞ÉÁî® C ÁöÑÂáΩÊï∞ÊòØÊâæ‰∏çÂà∞ÁöÑ .h Êñá‰ª∂‰∏≠ #ifndef #define #endifÁöÑ‰ΩúÁî®ÂØπ‰∫é OC Êù•ËØ¥Ê≤°ÊúâÂ§öÂ§ßÁöÑ‰ΩúÁî®ÔºåOC ÁºñËØëÂô®‰∏ç‰ºöÈáçÂ§çÂºïÂÖ•Âêå‰∏Ä‰∏™Â§¥Êñá‰ª∂„ÄÇ‰ΩÜÊòØÂØπ‰∫é C Êñá‰ª∂Êù•ËØ¥ÔºåÈÄöËøáÂ§öÊ¨° #include ‰ºöÈáçÂ§çÂåÖÂê´Â£∞ÊòéÔºåÂõ†Ê≠§ÈúÄË¶ÅÈÄöËøá #ifndef #define Âíå #endif ÈÅøÂÖçÈáçÂ§çÂ£∞Êòé„ÄÇ ÂÆè #pragma once ‰πüÂèØ‰ª•ËææÂà∞Áõ∏ÂêåÁöÑÊïàÊûúÔºàËæÉÊñ∞ÁöÑÁâπÊÄßÔºâ ÂºïÁî®ÂºïÁî®Â∞±Áõ∏ÂΩì‰∫éÂèòÈáèÁöÑÂà´ÂêçÔºåÂºïÁî®‰∏çÂèØ‰ª•‰øÆÊîπÊåáÂêëÔºö1234567int age = 10;int &amp;rage = age; int age2 = 20;// Áõ∏ÂΩì‰∫éÁªô age ËµãÂÄºÔºåËÄå‰∏çÊòØÂ∞Ü rage ÊåáÂêë age2rage = age2 // age = 20 &amp;rage = age2 // ‚ùå ÂºïÁî®Áõ∏ÂΩì‰∫éÂà´ÂêçÔºåÂèØ‰ª•ÁêÜËß£‰∏∫‰πãÂêéÁî®Âà∞ÂºïÁî®ÁöÑÈÉ®ÂàÜÈÉΩÊõøÊç¢‰∏∫ÂéüÂèòÈáè Class Âíå Struct Âå∫Âà´C++ ‰∏≠ Struct ‰πüËÉΩÂÆö‰πâÂáΩÊï∞ÔºåÂíå Class Á±ª‰ºº„ÄÇ C++ ‰∏≠ Struct Âíå Class ÁöÑÂîØ‰∏ÄÂå∫Âà´Âú®‰∫éÔºö Class ÈªòËÆ§ÊàêÂëòÊùÉÈôêÊòØ privateÔºåËÄåStruct ÈªòËÆ§ÊàêÂëòÊùÉÈôêÊòØ public C++ ÂáΩÊï∞Ë∞ÉÁî®Âíå OC ÁöÑÂå∫Âà´Êàë‰ª¨Áü•ÈÅì C++ ÂáΩÊï∞Ë∞ÉÁî®Êó∂Áõ¥Êé•Ë∞ÉÁî®ÔºåÂç≥Âú®ÁºñËØëÁöÑÊó∂ÂÄôÂØπ‰∫éÂáΩÊï∞ÁöÑË∞ÉÁî®Áõ¥Êé•ËΩ¨‰∏∫ call ÂáΩÊï∞Âú∞ÂùÄ„ÄÇÂõ†Ê≠§Ôºå ÂàõÂª∫ÁöÑ C++ Á±ªÁöÑÂÆû‰æãÂú®ÂÜÖÂ≠ò‰∏≠Âè™ÊúâÊàêÂëòÂèòÈáè„ÄÇ ËÄå OC ÂáΩÊï∞Ë∞ÉÁî®Âü∫‰∫éÊ∂àÊÅØÔºåÊâÄ‰ª•ÈúÄË¶ÅÊúâ‰∏Ä‰∏™ isa ÊåáÈíàÊåáÂêë meta classÔºå‰ª•Ê≠§Êü•ÊâæË∞ÉÁî®ÁöÑÊñπÊ≥ï„ÄÇÂõ†Ê≠§ OC Á±ªÁöÑÂÆû‰æãÈô§‰∫ÜÊàêÂëòÂèòÈáèÂ§ñÔºåËøòÈúÄË¶Å‰∏Ä‰∏™ isa ÊåáÈíà„ÄÇ C++ ‰∏≠ÁöÑ . ‰∏é -&gt;ÁÇπËØ≠Ê≥ïÁöÑÂ∑¶ËæπÂè™ËÉΩÊòØÂØπË±°ÔºåÂ¶ÇÊûúÊòØÊåáÈíàÔºåÂøÖÈ°ªË¶ÅÁî® -&gt;Ôºö12345Person person;person.age = 3; // ‚àöPerson *person2 = &amp;person;person2.age = 5; // √óperson2-&gt;age = 5; // ‚àö ÊûÑÈÄ†ÂíåÊûêÊûÑÂõûÊî∂Âú®ÂàõÂª∫ÂØπË±°ÁöÑÊó∂ÂÄôÊûÑÈÄ†ÂáΩÊï∞‰ºöËá™Âä®Ë∞ÉÁî®„ÄÇÊûÑÈÄ†ÂáΩÊï∞ÂíåÁ±ªÂêåÂêçÔºåÂèØ‰ª•ÊúâÂèÇÊï∞ÔºåÂèØ‰ª•ÈáçËΩΩ„ÄÇ ÂõûÊî∂ÂØπË±°ÈÄöËøá delete ÂØπË±° Êù•ËøõË°åÔºåË∞ÉÁî®‰πãÂêéÂØπË±°ÂõûÊî∂(‰∏çÊòØÂºïÁî®ËÆ°Êï∞Âáè‰∏ÄÔºåÊòØÁõ¥Êé•ÂõûÊî∂)„ÄÇ ÂõûÊî∂Êó∂Ë∞ÉÁî®ÊûêÊûÑÂáΩÊï∞ÔºåÊûêÊûÑÂáΩÊï∞‰∏çÂèØ‰ª•ÈáçËΩΩ„ÄÇÊûêÊûÑÂáΩÊï∞‰∏≠Ë¶ÅÈáäÊîæÂÜÖÈÉ®ÁöÑÂØπË±°Ôºö123456789101112131415161718192021222324struct Car &#123;&#125;;struct Person &#123; int age; Car *car; // ÊûÑÈÄ†ÂáΩÊï∞ÁöÑÁõ∏‰∫íË∞ÉÁî® Person() :Person(12) &#123; cout &lt;&lt; "Person build" &lt;&lt; endl; &#125; Person(int age) &#123; this-&gt;age = age; this-&gt;car = new Car(); cont &lt;&lt; "has age is" &lt;&lt; age &lt;&lt; endl; &#125; ~Person() &#123; cout &lt;&lt; "destructor" &lt;&lt; endl; delete this-&gt;car; &#125;&#125;;int main() &#123; Person *person = new Person(23); delete person; return 0;&#125; Ê≥®ÊÑèËøôÈáåÁöÑÊûÑÈÄ†ÂáΩÊï∞ÁöÑÁõ∏‰∫íË∞ÉÁî®ÁöÑÊñπÂºè„ÄÇÁî±‰∫é C ‰∏çÂÉè OCÔºåJava ËøôÁßçÊûÑÈÄ†ÂáΩÊï∞ËøîÂõûËá™Ë∫´ÔºåËÄåÊòØËøîÂõû voidÔºåÂõ†Ê≠§Ôºå‰∏çËÉΩÂú®ÊñπÊ≥ï‰∏≠‰∏ªÂä®Ë∞ÉÁî®ÂÖ∂‰ªñÊûÑÈÄ†ÂáΩÊï∞ÔºåËÄåÊòØÈúÄË¶Å‰ΩøÁî®Â¶Ç‰∏äÁöÑËØ≠Ê≥ïÁ≥ñÂëäÁü•ÁºñËØëÂô® C ËØ≠Ë®Ä‰∏≠ÁöÑÂàõÂª∫‰∏éÂõûÊî∂ÈÄöËøá malloc ÂàÜÈÖçÁöÑÂØπË±°‰∏ç‰ºöË∞ÉÁî®ÊûÑÈÄ†ÂáΩÊï∞ÂíåÊûêÊûÑÂáΩÊï∞Ôºö123Person *person = (Person *)malloc(sizeof(Person));person-&gt;age = 12;free(person); Â£∞ÊòéÂÆûÁé∞ÂàÜÁ¶ªC++ ‰∏≠Â£∞ÊòéÊñá‰ª∂ÂíåÂÆûÁé∞Êñá‰ª∂ÂàÜÁ¶ªÔºö123456789101112131415161718// .h ‰∏≠#ifndef Person_hpp#define Person_hpp#include &lt;stdio.h&gt;class Car &#123;&#125;;class Person &#123;public: int age; Car *car; void run(); Person(int age); ~Person();&#125;;#endif /* Person_hpp */ Â£∞Êòé‰πãÂêéÁöÑÂÆûÁé∞ÊñπÂºèÂ¶Ç‰∏ãÔºö12345678910111213141516// .cpp ‰∏≠#include "Person.h"#include &lt;iostream&gt;Person::Person(int age) &#123; this-&gt;age = age; this-&gt;car = new Car();&#125;Person::~Person() &#123; std::cout &lt;&lt; ‚Äúdealloc‚Äù &lt;&lt; std::endl; delete this-&gt;car;&#125;void Person::run() &#123; cout &lt;&lt; "run" &lt;&lt; endl;&#125; ÁºñËØëÁöÑÊó∂ÂÄôÂè™‰ºöÁºñËØë cpp Êñá‰ª∂ÔºåÂ§¥Êñá‰ª∂‰∏≠ÊîæÂÖ•ÁöÑÂ£∞ÊòéÔºåÂú®ÁºñËØëÁöÑÊó∂ÂÄô‰ºöË¢´Áõ¥Êé•ÂÜôÂÖ• cpp ‰∏≠„ÄÇÂ£∞ÊòéÂØπÂ∫îÁöÑÂÖ∑‰ΩìÂÆûÁé∞‰ºöÂú®ÈìæÊé•ËøáÁ®ã‰∏≠ÊõøÊç¢‰∏∫ÂÖ∑‰ΩìÁöÑÂú∞ÂùÄ„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•ÂæóÂá∫‰∏Ä‰∏™ÁªìËÆ∫ÔºåÂú® .h ‰∏≠‰∏çËÉΩÁõ¥Êé•ÂÜôÂáΩÊï∞ÂÆûÁé∞ÊòØÂõ†‰∏∫‰ºöË¢´Â§ö‰∏™Êñá‰ª∂ÂØºÂÖ•Ôºå‰ªéËÄåÂØºËá¥ duplicate symbol„ÄÇËÄå .h ‰∏≠ÂÆö‰πâÁöÑ class ‰∏≠ÁöÑÊñπÊ≥ïÂèØ‰ª•ÂÜôÂáΩÊï∞ÂÆûÁé∞ÊòØÂõ†‰∏∫ class ÂåÖË£πÁöÑÂÖ≥Á≥ªÔºå‰∏ç‰ºöÂõ†‰∏∫Â§öÊ¨°ÂØºÂÖ•ËÄåÂèòÊàê‰∏§‰ªΩÂÆûÁé∞„ÄÇ ÂëΩÂêçÁ©∫Èó¥‰ΩøÁî® namespace ÂÖ≥ÈîÆÂ≠óÂåÖË£π„ÄÇÂêåÂêçÁöÑÂëΩÂêçÁ©∫Èó¥‰ºöË¢´ÂêàÂπ∂Ôºö123456namespace ZAC &#123; class Car &#123;&#125;;&#125;namespace ZAC &#123; class Bike &#123;&#125;;&#125; ‰ΩøÁî®Ôºö12345678// Áõ¥Êé•ÂÜôÊòéÂëΩÂêçÁ©∫Èó¥ZAC::Car *car = new ZAC::Car();// ÁúÅÁï•ÂëΩÂêçÁ©∫Èó¥,‰ΩÜÊòØËøôÊ†∑‰ºöÂØºËá¥ÂÖ®ÈÉ®ÁöÑÂëΩÂêçÁ©∫Èó¥ÈªòËÆ§ÈÉΩÊòØ ZACusing namespace ZAC;int main() &#123; Car *car = new Car(); return 0;&#125; ÂØπ‰∫éÂ£∞ÊòéÂÆûÁé∞ÂàÜÁ¶ªÁöÑÁ±ª‰ΩøÁî®ÂëΩÂêçÁ©∫Èó¥ÔºåÂ£∞ÊòéÂíåÂÆûÁé∞ÈÉΩË¶ÅÂåÖÊã¨Âú® namespace ‰∏≠ ÁªßÊâøC++ ÁªßÊâøÂíå OC ÁªßÊâøÁ±ª‰ºº:12struct Person &#123;&#125;;struct Student : Person &#123;&#125;; Â§öÊÄÅC++ ÁöÑÂáΩÊï∞Ë∞ÉÁî®ÊñπÂºèÊòØÁºñËØëÊó∂Ê†πÊçÆÊåáÈíàÁ±ªÂûãÔºåÁõ¥Êé•Ë∞ÉÁî®ÂáΩÊï∞Âú∞ÂùÄ„ÄÇË¶ÅÂÆûÁé∞Â§öÊÄÅÔºåÈúÄË¶ÅÂÄüÂä©ËôöÂáΩÊï∞„ÄÇÂ¶ÇÊûúÊúâÂ§öÊÄÅÔºåÈúÄË¶ÅÊääÂÖ∂ÊûêÊûÑÂáΩÊï∞‰πüÂ£∞Êòé‰∏∫ËôöÊûêÊûÑÂáΩÊï∞ÔºàÂ¶ÇÊûú‰∏çËÆæÁΩÆ‰∏∫ËôöÊûêÊûÑÂáΩÊï∞ÔºåÈÇ£‰πàÂ∞±‰ºöË∞ÉÁî®Áà∂Á±ªÁöÑÊûêÊûÑÂáΩÊï∞ËÄå‰∏çÊòØÁúüÊ≠£ÁöÑÊûêÊûÑÂáΩÊï∞ÔºâÔºö12345678910111213struct Person &#123; virtual void walk() &#123; cout &lt;&lt; "person walk" &lt;&lt; endl; &#125; virtual ~Person() &#123;&#125;&#125;;struct Student &#123; void walk() &#123; count &lt;&lt; "student walk" &lt;&lt; endl; &#125; ~Student() &#123;&#125;&#125;; ‰ΩøÁî®ËôöÂáΩÊï∞ÂêéÔºåÂØπË±°ÁöÑÂâç4‰∏™Â≠óËäÇ‰ºöÂ≠ò‰∏Ä‰∏™ËôöÂáΩÊï∞Ë°®ÁöÑÂú∞ÂùÄÔºåÂÖ∂‰ªñÂ±ûÊÄßÁöÑÂú∞ÂùÄ‰ºö‰æùÊ¨°ÂêëÂêéÁßªÂä®4‰∏™Â≠óËäÇ„ÄÇ Á∫ØËôöÂáΩÊï∞Ê≤°ÊúâÂáΩÊï∞‰ΩìÔºå‰∏îÂáΩÊï∞ÂàùÂßãÂåñ‰∏∫0ÁöÑÂè´ÂÅöÁ∫ØËôöÂáΩÊï∞„ÄÇÂê´ÊúâÁ∫ØËôöÂáΩÊï∞ÁöÑÁ±ªÂè´ÂÅöÊäΩË±°Á±ªÔºå‰∏çÂèØ‰ª•Ë¢´ÂÆû‰æãÂåñÔºåÂè™ËÉΩÁî®Êù•ÂÆö‰πâÊé•Âè£ËßÑËåÉÔºö123struct Person &#123; virtual void walk() = 0;&#125;; ËôöÁªßÊâøC++ ÊòØÂ§öÁªßÊâøÁöÑÔºåËøôÊ†∑Â∞±ÈÄ†Êàê‰∫ÜÂú®Ëè±ÂΩ¢ÁªßÊâøÊÉÖÂÜµ‰∏ã‰ºöÂêåÊó∂ÁªßÊâøÂ§ö‰∏™Âü∫Á±ªÁöÑÂêåÂêçÂ±ûÊÄßÁöÑÊÉÖÂÜµ„ÄÇËôöÁªßÊâøÂàôÊòØÂëäÁü•ÁºñËØëÂô®ÔºåÂÖ±Áî®Âêå‰∏Ä‰∏™Â±ûÊÄßÔºö123456789101112131415struct Person &#123; int age;&#125;struct Student : virtual Person &#123; int score;&#125;;struct Worker : virtual Person &#123; int salary;&#125;;struct Me : Student, Worker &#123; int name;&#125;; ÈùôÊÄÅÊàêÂëòÂèòÈáèC++ ‰∏≠ËÆøÈóÆÈùôÊÄÅÊàêÂëòÂèòÈáèÁöÑÊñπÂºèÂíåÂÖ∂‰ªñËØ≠Ë®Ä‰∏çÂêå„ÄÇÂÆÉÁöÑÂàùÂßãÂåñÊñπÂºè‰πüÂíåÂÖ∂‰ªñËØ≠Ë®Ä‰∏çÂêåÔºö1234567891011class Person &#123;public: static int age;&#125;;// Âú®Á±ªÂ§ñÈÉ®ÂàùÂßãÂåñ„ÄÇ‰∏ÄËà¨ÊîæÂú® .cpp ‰∏≠int Person::age = 12;int main(int argc, const char * argv[]) &#123; Person::age = 12; return 0;&#125; OC ‰∏≠Áî±‰∫éÊúâ meta class ÁöÑÂ≠òÂú®ÔºåÈùôÊÄÅÊàêÂëòÂèòÈáèÂíåÈùôÊÄÅÊñπÊ≥ïÊòØÂ≠òÂú® meta class ‰∏≠ÁöÑ„ÄÇ ËÄå C++ ‰∏≠ÁöÑÈùôÊÄÅÊàêÂëòÂèòÈáè‰∏çÂêåÔºåÈùôÊÄÅÊàêÂëòÂèòÈáèÂ∞±Áõ∏ÂΩì‰∫éÊòØ‰∏™ÈôêÂà∂‰∫Ü‰ΩúÁî®ÂüüÁöÑÂÖ®Â±ÄÂèòÈáè„ÄÇ constC++ ‰∏≠ÁöÑ const Êúâ‰∏§ÁßçÂú∫ÊôØÔºö‰øÆÈ•∞ÂÄºÊó∂‰∏çËÉΩÊîπÂèòÂØπË±°ÁöÑÂ±ûÊÄßÔºå‰øÆÈ•∞ÊåáÈíàÊó∂‰∏çËÉΩÊîπÂèòÊåáÈíàÁöÑÊåáÂêë„ÄÇ C++ ‰∏≠ÁöÑÊñπÊ≥ï‰πüÂèØ‰ª•ÊòØ const ÁöÑÔºåË°®Á§∫ËØ•ÊñπÊ≥ï‰∏ç‰ºö‰øÆÊîπÂØπË±°ÁöÑÊàêÂëòÂèòÈáè„ÄÇÂú® const ‰øÆÈ•∞ÂØπË±°ÁöÑÊó∂ÂÄôÔºå‰∏çËÉΩË∞ÉÁî®Èùû const ÁöÑÊñπÊ≥ïÔºö1234567891011121314class Person &#123;public: // ËøôÈáåÂøÖÈ°ªË¶ÅÊúâ const void run() const &#123; cout &lt;&lt; "run" &lt;&lt; endl; &#125;&#125;;int main(int argc, const char * argv[]) &#123; const Person *p = new Person(); // const ‰øÆÈ•∞ÂØπË±°ÔºåÈÇ£‰πà‰∏ÄÂÆöÂè™ËÉΩË∞ÉÁî® const ÁöÑÊñπÊ≥ï p-&gt;run(); return 0;&#125; const ÁöÑ‰ΩçÁΩÆÊ†áÁ§∫ÁöÑÁªìÊûúÁöÑ‰∏çÂêåËøôÊòØ‰∏Ä‰∏™ËÄÅÈóÆÈ¢òÔºåconst ‰ΩçÁΩÆÁöÑ‰∏çÂêåÊâÄ‰ª£Ë°®ÁöÑÊÑè‰πâ‰πü‰∏çÂêåÔºö1234// ÊåáÂêëÁöÑÂÄº‰∏çËÉΩÊîπÂèòÔºåÂØπË±°ÁöÑËØù‰∏çËÉΩÊîπÂèòÂ±ûÊÄßPerson const *person = new Person();// ÊåáÈíàÊåáÂêë‰∏çËÉΩÊîπÂèòPerson * const person = new Person(); const Ê∞∏Ëøú‰øÆÈ•∞ÂÆÉÁöÑüëâÔºåÂè≥ËæπÊòØ *person Â∞±Ë°®Á§∫ÊåáÈíàÊåáÂêëÁöÑÂÄº‰∏çËÉΩÂèòÔºåÂè≥ËæπÊòØ person Â∞±Ë°®Á§∫ÊåáÈíà‰∏çËÉΩÊîπÂèòÊåáÂêë„ÄÇ Ê®°ÊùøÂáΩÊï∞Ê®°ÊùøC++ Ê®°ÊùøÂÜôÊ≥ïÂ¶Ç‰∏ãÔºö123456// ÂÜôÂú® .h Êñá‰ª∂‰∏≠template &lt;typename T&gt; T add(T a, T b) &#123; return a + b;&#125;add&lt;double&gt;(1.5, 2); ÁºñËØëÁöÑÊó∂ÂÄôÊ†πÊçÆÁ±ªÂûãÁîüÊàê‰∏çÂêåÁöÑÂáΩÊï∞ C++ Ê®°ÊùøÂú®Â£∞ÊòéÂÆûÁé∞ÂàÜÁ¶ªÁöÑÊó∂ÂÄô‰∏çËÉΩÂú® .cpp ‰∏≠ÂÆûÁé∞ËÄåË¶ÅÁõ¥Êé•Âú® .h ‰∏≠ÂÆûÁé∞„ÄÇËøôÊòØÂõ†‰∏∫Ê®°ÊùøÂÆûÁé∞ÁöÑ .cpp Êñá‰ª∂Âú®ÂçïÁã¨ÁºñËØëÁöÑÊó∂ÂÄô‰∏çÁü•ÈÅìË¢´‰º†ÂÖ•‰∫ÜÂì™‰∫õÁ±ªÂûãÔºåÂõ†Ê≠§Êó†Ê≥ïÂàõÂª∫Áõ∏Â∫îÁ±ªÂûãÁöÑÂáΩÊï∞ÂÆûÁé∞„ÄÇËÄåÂÜôÂú® .h ‰∏≠Áõ¥Êé•Ë¢´ÂºïÂÖ•ÂÖ∂‰ªñ .cpp ‰∏≠ÂêéÔºåÂú®ÁºñËØëÁöÑÊó∂ÂÄôÂ∞±ËÉΩÁü•ÈÅìÂÖ∂‰ªñ .cpp Êñá‰ª∂‰º†ÂÖ•‰∫Ü‰ªÄ‰πàÁ±ªÂûãÔºåËøõËÄåÂàõÂª∫Áõ∏Â∫îÁöÑÂáΩÊï∞„ÄÇ Á±ªÊ®°ÊùøÁ±ªÊ®°ÊùøÂÜôËµ∑Êù•ÈùûÂ∏∏È∫ªÁÉ¶ÔºåËÆæÁΩÆ‰∫ÜÁ±ªÊ®°Êùø‰πãÂêéÔºåÊØè‰∏™ÊñπÊ≥ïÁöÑÂÆûÁé∞ÈÉΩË¶ÅÂ£∞Êòé‰∏ÄÈÅçÊ®°ÊùøÔºåÂê¶ÂàôÊä•ÈîôÔºö1234567891011121314151617181920212223242526// .h ‰∏≠template &lt;class Food&gt;class Person &#123;public: void eat(Food *a); Person(); Person(int age); ~Person();&#125;;template &lt;class Food&gt;void Person&lt;Food&gt;::eat(Food *a) &#123; cout &lt;&lt; "food" &lt;&lt; endl;&#125;// .cpp ‰∏≠template &lt;class Food&gt;Person&lt;Food&gt;::Person() &#123;&#125;template &lt;class Food&gt;Person&lt;Food&gt;::Person(int age) &#123;&#125;template &lt;class Food&gt;Person&lt;Food&gt;::~Person() &#123; std::cout &lt;&lt; "dealloc" &lt;&lt; std::endl;&#125; Á±ªÊ®°ÊùøÁöÑÂÆûÁé∞Â£∞ÊòéÂàÜÁ¶ªÂêåÊ†∑ËøòÊòØÂÜôÂú®Â§¥Êñá‰ª∂‰∏≠ Ëá™Âä®Á±ªÂûãÊé®Êñ≠Âíå dart Á±ª‰ººÔºåÂèØ‰ª•‰∏çÁî®ÂÜôÊòéÂèòÈáèÁöÑÁ±ªÂûãÔºåÈÄöËøá auto Â£∞ÊòéËÆ©ÁºñËØëÂô®Ëá™Ë°åÊé®Êñ≠Ôºö1auto a = 10; lamda Ë°®ËææÂºèlamda Ë°®ËææÂºèÁöÑ‰∏ÄËà¨ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºå[] Ë°®Á§∫ÁöÑÊòØÊçïËé∑ÁöÑÂ§ñÈÉ®ÁöÑÂèòÈáèÔºå() ÂÜÖÊòØÂèÇÊï∞„ÄÇËøôÁßçÊçïËé∑ÊñπÂºèÊòØÂÄºÊçïËé∑Ôºö1234int a = 10;int (*p)(int) = [a](int param) -&gt; int &#123; return param * a;&#125; Â¶ÇÊûúË¶ÅÊçïËé∑ÁöÑÂèòÈáè‰ºöÊ†πÊçÆÂ§ñÈÉ®ÁöÑ‰øÆÊîπËÄåÂèòÂåñÔºåÂπ∂‰∏îÂÜÖÈÉ®ÁöÑÂèòÂåñ‰πü‰ºöÂΩ±ÂìçÂ§ñÈÉ®ÁöÑÂÄºÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅËé∑ÂèñÂèòÈáèÁöÑÂú∞ÂùÄ„ÄÇËøôÁßçÊçïËé∑ÊñπÂºèÊòØÂºïÁî®ÊçïËé∑Ôºö1234int a = 10;int (*p)(int) = [&amp;a](int param) -&gt; int &#123; return param * a;&#125; Âíå OC ‰∏≠ÁöÑ __block Á±ª‰ººÔºåÈÉΩÊòØÂèØ‰ª•ÂÜÖÈÉ®‰øÆÊîπÂ§ñÈÉ®ÁöÑÂÄº‰ª•ÂèäÂ§ñÈÉ®ÂèØ‰ª•‰øÆÊîπÂÜÖÈÉ®ÁöÑÂÄº„ÄÇÂè™‰∏çËøá C++ ‰∏≠ÊòØÈÄöËøáÊåáÈíà‰º†ÈÄíÁöÑÊñπÂºèÔºåËÄå OC ‰∏≠ÂàôÊòØÈÄöËøáÁîüÊàê‰∏Ä‰∏™ÂåÖË£πÂØπË±°ÁöÑÂΩ¢Âºè„ÄÇ Âè¶Â§ñÂêà OC Á±ª‰ººÁöÑÔºåÂÖ®Â±ÄÂèòÈáè‰∏çÁî®ÊçïËé∑„ÄÇ]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS Crash Êî∂ÈõÜÊ°ÜÊû∂ KSCrash Ê∫êÁ†ÅËß£Êûê(‰∏≠)]]></title>
    <url>%2F2019%2F11%2F01%2Fkscrash2%2F</url>
    <content type="text"><![CDATA[Ââç‰∏ÄÁØáÁúã‰∫ÜÂ¶Ç‰ΩïÊçïËé∑ÂêÑÁßçÁ±ªÂûãÁöÑÂºÇÂ∏∏ÔºåËøô‰∏ÄÁØáÂ∞ÜÊé¢Á©∂Â¶Ç‰ΩïËß£ÊûêÂºÇÂ∏∏„ÄÇËøô‰∏ÄÁØáÁöÑÁêÜËß£Êúâ‰∏ÄÂÆöÁöÑÈöæÂ∫¶Ôºå‰Ω†ÈúÄË¶ÅÊèêÂâçÂØπ Mach-O ÁöÑÁªìÊûÑÊúâ‰∏Ä‰∏™Â§ß‰Ωì‰∏äÁöÑ‰∫ÜËß£„ÄÇÂÖ∂‰∏≠Ê∂âÂèäÂà∞Â¶Ç‰ΩïÂ∞Ü crash ÁöÑÂú∞ÂùÄ symbolicate ÁöÑËøáÁ®ãÔºåÊ≠•È™§Á±ª‰ºº‰∫é fishhookÔºåÂèØ‰ª•ÁøªÈòÖÊàë‰πãÂâçÂØπ fishhook ÁöÑËß£Êûê„ÄÇ Crash ÂõûË∞ÉÂú®Êé•Êî∂Âà∞ÂêÑÁßçÁ±ªÂûãÁöÑ Crash ‰ø°ÊÅØ‰πãÂêéÔºå‰ºöÁªü‰∏ÄÂõûË∞É‰∏Ä‰∏™Â§ÑÁêÜÂáΩÊï∞ÔºåÂÆÉÂ∞±ÊòØ KSCrashC.c ‰∏≠ÁöÑ onCrash() ÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627/// Êé•Êî∂Âà∞ crash ‰ø°ÊÅØÁöÑÂ§ÑÁêÜÂáΩÊï∞static void onCrash(struct KSCrash_MonitorContext* monitorContext)&#123; if (monitorContext-&gt;currentSnapshotUserReported == false) &#123; KSLOG_DEBUG("Updating application state to note crash."); kscrashstate_notifyAppCrash(); &#125; monitorContext-&gt;consoleLogPath = g_shouldAddConsoleLogToReport ? g_consoleLogPath : NULL; if(monitorContext-&gt;crashedDuringCrashHandling) &#123; kscrashreport_writeRecrashReport(monitorContext, g_lastCrashReportFilePath); &#125; else &#123; char crashReportFilePath[KSFU_MAX_PATH_LENGTH]; int64_t reportID = kscrs_getNextCrashReport(crashReportFilePath); strncpy(g_lastCrashReportFilePath, crashReportFilePath, sizeof(g_lastCrashReportFilePath)); /// Â∞Ü context ËΩ¨‰∏∫ report ÂÜôÂÖ•Ë∑ØÂæÑs‰∏≠ kscrashreport_writeStandardReport(monitorContext, crashReportFilePath); if(g_reportWrittenCallback) &#123; g_reportWrittenCallback(reportID); &#125; &#125;&#125; ÂÖ∂‰∏≠ÈáçË¶ÅÁöÑÂ∞±ÊòØËÆ≤ context ÂÜôÂÖ•Êñá‰ª∂ÁöÑ kscrashreport_writeStandardReport() ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889/// Â∞Ü context ËΩ¨‰∏∫ report ÂÜôÂÖ• pathvoid kscrashreport_writeStandardReport(const KSCrash_MonitorContext* const monitorContext, const char* const path)&#123; KSLOG_INFO("Writing crash report to %s", path); char writeBuffer[1024]; KSBufferedWriter bufferedWriter; if(!ksfu_openBufferedWriter(&amp;bufferedWriter, path, writeBuffer, sizeof(writeBuffer))) &#123; return; &#125; ksccd_freeze(); KSJSONEncodeContext jsonContext; /// jsonContext ÁöÑ userData ÊòØ writer writer ÁöÑ context ÊòØ jsonContext jsonContext.userData = &amp;bufferedWriter; /// ÂÜôÂÖ•Êìç‰ΩúÁöÑÊâßË°åËÄÖ KSCrashReportWriter concreteWriter; KSCrashReportWriter* writer = &amp;concreteWriter; /// ÂàùÂßãÂåñ writer ÁöÑÂêÑ‰∏™ÊñπÊ≥ï prepareReportWriter(writer, &amp;jsonContext); ksjson_beginEncode(getJsonContext(writer), true, addJSONData, &amp;bufferedWriter); /// Â∞Ü ‚Äú&#123;‚Äù ÂÜôÂÖ• buffer writer-&gt;beginObject(writer, KSCrashField_Report); &#123; /// ÂÜôÂÖ•Âü∫Êú¨‰ø°ÊÅØ writeReportInfo(writer, KSCrashField_Report, KSCrashReportType_Standard, monitorContext-&gt;eventID, monitorContext-&gt;System.processName); /// Â∞Ü buffer ‰øùÂ≠òÂà∞Á£ÅÁõò‰∏≠ ksfu_flushBufferedWriter(&amp;bufferedWriter); /// ÊääÊâÄÊúâ image ‰ø°ÊÅØÂÜôÂÖ•Á£ÅÁõò writeBinaryImages(writer, KSCrashField_BinaryImages); ksfu_flushBufferedWriter(&amp;bufferedWriter); /// ÂÜôÂÖ• NSException Âá∫ÈîôÁöÑ‰ø°ÊÅØ writeProcessState(writer, KSCrashField_ProcessState, monitorContext); ksfu_flushBufferedWriter(&amp;bufferedWriter); /// ÂÜôÂÖ•Á≥ªÁªü‰ø°ÊÅØ writeSystemInfo(writer, KSCrashField_System, monitorContext); ksfu_flushBufferedWriter(&amp;bufferedWriter); writer-&gt;beginObject(writer, KSCrashField_Crash); &#123; writeError(writer, KSCrashField_Error, monitorContext); ksfu_flushBufferedWriter(&amp;bufferedWriter); /// ÂÜôÂÖ•ÊâÄÊúâÁöÑÁ∫øÁ®ã‰ø°ÊÅØ writeAllThreads(writer, KSCrashField_Threads, monitorContext, g_introspectionRules.enabled); ksfu_flushBufferedWriter(&amp;bufferedWriter); &#125; writer-&gt;endContainer(writer); if(g_userInfoJSON != NULL) &#123; addJSONElement(writer, KSCrashField_User, g_userInfoJSON, false); ksfu_flushBufferedWriter(&amp;bufferedWriter); &#125; else &#123; writer-&gt;beginObject(writer, KSCrashField_User); &#125; if(g_userSectionWriteCallback != NULL) &#123; ksfu_flushBufferedWriter(&amp;bufferedWriter); if (monitorContext-&gt;currentSnapshotUserReported == false) &#123; g_userSectionWriteCallback(writer); &#125; &#125; writer-&gt;endContainer(writer); ksfu_flushBufferedWriter(&amp;bufferedWriter); writeDebugInfo(writer, KSCrashField_Debug, monitorContext); &#125; writer-&gt;endContainer(writer); ksjson_endEncode(getJsonContext(writer)); ksfu_closeBufferedWriter(&amp;bufferedWriter); ksccd_unfreeze();&#125; ÂÜôÂÖ•ÊñπÊ≥ïÂÖàÊù•ÁúãÊÄé‰πàÂÜôÂÖ•ÁöÑ„ÄÇ‰∏çÁî®ÁÆ°ÈÇ£‰∫õÂàùÂßãÂåñÊñπÊ≥ïÔºåÁõ¥Êé•Áúã beginObject()ÔºåÂÆÉÂú®ÂÖúÂÖúËΩ¨ËΩ¨ÂêéË∞ÉÁî®‰∫ÜÂ¶Ç‰∏ãÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556/// Â∞Ü data ‰øùÂ≠òÂà∞ buffer ÊàñËÄÖÊñá‰ª∂Á≥ªÁªü‰∏≠static int addJSONData(const char* restrict const data, const int length, void* restrict userData)&#123; KSBufferedWriter* writer = (KSBufferedWriter*)userData; const bool success = ksfu_writeBufferedWriter(writer, data, length); return success ? KSJSON_OK : KSJSON_ERROR_CANNOT_ADD_DATA;&#125;/// Â∞Ü data ÂÜôÂÖ• buffer ÊàñËÄÖÊñá‰ª∂Á≥ªÁªü‰∏≠bool ksfu_writeBufferedWriter(KSBufferedWriter* writer, const char* restrict const data, const int length)&#123; /// Â¶ÇÊûú buffer ‰∏≠ÁöÑÂ≠óÁ¨¶Êï∞ÈáèË∂ÖÂá∫ÊúÄÂ§ßÂÄº‰∫ÜÔºåÈÇ£‰πà flush buffer Âà∞Êñá‰ª∂Á≥ªÁªü‰∏≠ if(length &gt; writer-&gt;bufferLength - writer-&gt;position) &#123; ksfu_flushBufferedWriter(writer); &#125; if(length &gt; writer-&gt;bufferLength) &#123; return ksfu_writeBytesToFD(writer-&gt;fd, data, length); &#125; /// Âê¶ÂàôÂÜôÂÖ• buffer ‰∏≠ memcpy(writer-&gt;buffer + writer-&gt;position, data, length); writer-&gt;position += length; return true;&#125;/// Âà§Êñ≠ÊòØÂê¶Ë¶ÅÂ∞Ü buffer ÂÜôÂÖ•Êñá‰ª∂bool ksfu_flushBufferedWriter(KSBufferedWriter* writer)&#123; if(writer-&gt;fd &gt; 0 &amp;&amp; writer-&gt;position &gt; 0) &#123; if(!ksfu_writeBytesToFD(writer-&gt;fd, writer-&gt;buffer, writer-&gt;position)) &#123; return false; &#125; writer-&gt;position = 0; &#125; return true;&#125;bool ksfu_writeBytesToFD(const int fd, const char* const bytes, int length)&#123; const char* pos = bytes; while(length &gt; 0) &#123; int bytesWritten = (int)write(fd, pos, (unsigned)length); if(bytesWritten == -1) &#123; KSLOG_ERROR("Could not write to fd %d: %s", fd, strerror(errno)); return false; &#125; length -= bytesWritten; pos += bytesWritten; &#125; return true;&#125; KSBufferedWriter ÊâìÂºÄ‰∫Ü‰∏Ä‰∏™ÂÜôÂÖ•ÊµÅÔºåÂêåÊó∂Áª¥Êä§‰∫Ü‰∏Ä‰∏™ 1024 Â§ßÂ∞èÁöÑ buffer„ÄÇÂΩì buffer ‰∏≠ÁöÑÊï∞ÊçÆË∂ÖÂá∫‰πãÂêéÔºåÂ∞±‰ºöÂ∞Ü buffer ÂÜôÂÖ•Êñá‰ª∂‰∏≠„ÄÇ ÂÜôÂÖ• image ‰ø°ÊÅØÂÜôÂÖ• image ‰ø°ÊÅØÈÄöËøá writeBinaryImages() ÂÆûÁé∞Ôºö 1234567891011121314151617181920static void writeBinaryImages(const KSCrashReportWriter* const writer, const char* const key)&#123; /// ÈÄöËøá _dyld_image_count Ëé∑Âèñ image ÁöÑÊï∞Èáè const int imageCount = ksdl_imageCount(); writer-&gt;beginArray(writer, key); &#123; for(int iImg = 0; iImg &lt; imageCount; iImg++) &#123; /// ÈÄöËøá _dyld_get_image_header Ëé∑Âèñ image ‰ø°ÊÅØ writeBinaryImage(writer, NULL, iImg); &#125; &#125; writer-&gt;endContainer(writer);&#125;int ksdl_imageCount()&#123; return (int)_dyld_image_count();&#125; ÈÄöËøá dyld Êèê‰æõÁöÑ _dyld_image_count() ÊñπÊ≥ïËé∑ÂèñÂä†ËΩΩÁöÑ image Êï∞Èáè„ÄÇÂÖ∑‰ΩìÁöÑ image ‰∏≠ÁöÑ‰ø°ÊÅØÂú® writeBinaryImage() ‰∏≠Ëé∑ÂèñÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104static void writeBinaryImage(const KSCrashReportWriter* const writer, const char* const key, const int index)&#123; KSBinaryImage image = &#123;0&#125;; /// ÈÄöËøá _dyld_get_image_header Ëé∑Âèñ image ‰ø°ÊÅØ if(!ksdl_getBinaryImage(index, &amp;image)) &#123; return; &#125; writer-&gt;beginObject(writer, key); &#123; writer-&gt;addUIntegerElement(writer, KSCrashField_ImageAddress, image.address); writer-&gt;addUIntegerElement(writer, KSCrashField_ImageVmAddress, image.vmAddress); writer-&gt;addUIntegerElement(writer, KSCrashField_ImageSize, image.size); writer-&gt;addStringElement(writer, KSCrashField_Name, image.name); writer-&gt;addUUIDElement(writer, KSCrashField_UUID, image.uuid); writer-&gt;addIntegerElement(writer, KSCrashField_CPUType, image.cpuType); writer-&gt;addIntegerElement(writer, KSCrashField_CPUSubType, image.cpuSubType); writer-&gt;addUIntegerElement(writer, KSCrashField_ImageMajorVersion, image.majorVersion); writer-&gt;addUIntegerElement(writer, KSCrashField_ImageMinorVersion, image.minorVersion); writer-&gt;addUIntegerElement(writer, KSCrashField_ImageRevisionVersion, image.revisionVersion); &#125; writer-&gt;endContainer(writer);&#125;bool ksdl_getBinaryImage(int index, KSBinaryImage* buffer)&#123; /// ÈÄöËøá _dyld_get_image_header Ëé∑Âèñ image ÁöÑ header const struct mach_header* header = _dyld_get_image_header((unsigned)index); if(header == NULL) &#123; return false; &#125; uintptr_t cmdPtr = firstCmdAfterHeader(header); if(cmdPtr == 0) &#123; return false; &#125; // Look for the TEXT segment to get the image size. // Also look for a UUID command. uint64_t imageSize = 0; uint64_t imageVmAddr = 0; uint64_t version = 0; uint8_t* uuid = NULL; for(uint32_t iCmd = 0; iCmd &lt; header-&gt;ncmds; iCmd++) &#123; struct load_command* loadCmd = (struct load_command*)cmdPtr; switch(loadCmd-&gt;cmd) &#123; case LC_SEGMENT: &#123; struct segment_command* segCmd = (struct segment_command*)cmdPtr; if(strcmp(segCmd-&gt;segname, SEG_TEXT) == 0) &#123; imageSize = segCmd-&gt;vmsize; imageVmAddr = segCmd-&gt;vmaddr; &#125; break; &#125; case LC_SEGMENT_64: &#123; struct segment_command_64* segCmd = (struct segment_command_64*)cmdPtr; if(strcmp(segCmd-&gt;segname, SEG_TEXT) == 0) &#123; imageSize = segCmd-&gt;vmsize; imageVmAddr = segCmd-&gt;vmaddr; &#125; break; &#125; case LC_UUID: &#123; struct uuid_command* uuidCmd = (struct uuid_command*)cmdPtr; uuid = uuidCmd-&gt;uuid; break; &#125; case LC_ID_DYLIB: &#123; struct dylib_command* dc = (struct dylib_command*)cmdPtr; version = dc-&gt;dylib.current_version; break; &#125; &#125; cmdPtr += loadCmd-&gt;cmdsize; &#125; buffer-&gt;address = (uintptr_t)header; buffer-&gt;vmAddress = imageVmAddr; buffer-&gt;size = imageSize; buffer-&gt;name = _dyld_get_image_name((unsigned)index); buffer-&gt;uuid = uuid; buffer-&gt;cpuType = header-&gt;cputype; buffer-&gt;cpuSubType = header-&gt;cpusubtype; buffer-&gt;majorVersion = version &gt;&gt; 16; buffer-&gt;minorVersion = (version &gt;&gt; 8) &amp; 0xff; buffer-&gt;revisionVersion = version &amp; 0xff; return true;&#125; ÊÄªÁöÑÊù•ËØ¥ÔºåÈÄöËøá _dyld_get_image_header Ëé∑Âèñ image ÁöÑ header ÈÉ®ÂàÜ„ÄÇÁÑ∂ÂêéÈÄöËøá header ‰ΩçÁΩÆÂÆö‰ΩçÂà∞ load commandÔºåÈÅçÂéÜ load command ÁöÑ‰ø°ÊÅØ ÂÜôÂÖ•Á∫øÁ®ã‰ø°ÊÅØÂâç‰∏ÄÁØáËÆ≤Âà∞ËøáÔºåÂú® crash ÁöÑÊó∂ÂÄôÔºå‰ºö suspend ÊâÄÊúâÁöÑÁ∫øÁ®ãÔºåÂπ∂‰∏îËé∑ÂèñÂÆÉ‰ª¨ÁöÑÂü∫Êú¨‰ø°ÊÅØ„ÄÇÁé∞Âú®Â∞±Ë¶ÅÂØπËé∑ÂèñÂà∞ÁöÑÁ∫øÁ®ãËøõË°åËß£ÊûêÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657static void writeThread(const KSCrashReportWriter* const writer, const char* const key, const KSCrash_MonitorContext* const crash, const struct KSMachineContext* const machineContext, const int threadIndex, const bool shouldWriteNotableAddresses)&#123; bool isCrashedThread = ksmc_isCrashedContext(machineContext); KSThread thread = ksmc_getThreadFromContext(machineContext); KSLOG_DEBUG("Writing thread %x (index %d). is crashed: %d", thread, threadIndex, isCrashedThread); KSStackCursor stackCursor; bool hasBacktrace = getStackCursor(crash, machineContext, &amp;stackCursor); writer-&gt;beginObject(writer, key); &#123; if(hasBacktrace) &#123; /// ÂÜôÂÖ•Ë∞ÉÁî®Ê†à writeBacktrace(writer, KSCrashField_Backtrace, &amp;stackCursor); &#125; if(ksmc_canHaveCPUState(machineContext)) &#123; /// ÂÜôÂÖ•ÂØÑÂ≠òÂô® writeRegisters(writer, KSCrashField_Registers, machineContext); &#125; /// ÂÜôÂÖ•Á∫øÁ®ãindex writer-&gt;addIntegerElement(writer, KSCrashField_Index, threadIndex); const char* name = ksccd_getThreadName(thread); if(name != NULL) &#123; /// Á∫øÁ®ãÊúâÂêçÁß∞Â∞±ÂÜôÂÖ•Á∫øÁ®ãÂêçÁß∞ writer-&gt;addStringElement(writer, KSCrashField_Name, name); &#125; name = ksccd_getQueueName(thread); if(name != NULL) &#123; /// ÂÜôÂÖ• dispatch_queue ÁöÑÂêçÁß∞ writer-&gt;addStringElement(writer, KSCrashField_DispatchQueue, name); &#125; /// ÊòØÂê¶ÊòØÂ¥©Ê∫ÉÁ∫øÁ®ã writer-&gt;addBooleanElement(writer, KSCrashField_Crashed, isCrashedThread); writer-&gt;addBooleanElement(writer, KSCrashField_CurrentThread, thread == ksthread_self()); /// Â¶ÇÊûúÊòØÂ¥©Ê∫ÉÁöÑÁ∫øÁ®ã if(isCrashedThread) &#123; /// Â∞Ü stack pointer ‰∏äÁöÑÈÉ®ÂàÜÊï∞ÊçÆÊã∑Ë¥ùÂá∫Êù• writeStackContents(writer, KSCrashField_Stack, machineContext, stackCursor.state.hasGivenUp); if(shouldWriteNotableAddresses) &#123; /// Â∞ÜÈÄöËøá zombie ËÆ∞ÂΩïÁöÑÂú∞ÂùÄÊã∑Ë¥ùÂá∫Êù• writeNotableAddresses(writer, KSCrashField_NotableAddresses, machineContext); &#125; &#125; &#125; writer-&gt;endContainer(writer);&#125; ÂÖ∂‰∏≠ÊØîËæÉÈáçË¶ÅÁöÑÊòØÁ¨¶Âè∑ÂåñË∞ÉÁî®Â†ÜÊ†àÔºåÂÜôÂÖ•ÂØÑÂ≠òÂô®ÁöÑÂÄºÔºå‰ª•ÂèäÂÜôÂÖ• zombie ËÆ∞ÂΩïÁöÑ‰ø°ÊÅØ„ÄÇ Á¨¶Âè∑ÂåñË∞ÉÁî®Â†ÜÊ†àÁ¨¶Âè∑ÂåñÁöÑËøáÁ®ãÂÖ∂ÂÆûÂú® fishhock ‰∏≠Êúâ‰ªãÁªç„ÄÇÂ∞±ÊòØÈÄöËøáÂÆûÈôÖÁöÑÂú∞ÂùÄÊâæÂà∞Á¨¶Âè∑Ë°®‰∏≠Áõ∏Â∫îÁöÑÁ¨¶Âè∑ÔºåÂÜçÂà∞Â≠óÁ¨¶‰∏≤Ë°®‰∏≠ÊâæÂà∞ÂØπÂ∫îÁöÑÂ≠óÁ¨¶‰∏≤Ôºö 1234567891011121314151617181920212223242526272829303132333435363738static void writeBacktrace(const KSCrashReportWriter* const writer, const char* const key, KSStackCursor* stackCursor)&#123; writer-&gt;beginObject(writer, key); &#123; writer-&gt;beginArray(writer, KSCrashField_Contents); &#123; /// ÂØπÊØè‰∏ÄÂ±ÇË∞ÉÁî®Ê†àËøõË°åÁ¨¶Âè∑Âåñ while(stackCursor-&gt;advanceCursor(stackCursor)) &#123; writer-&gt;beginObject(writer, NULL); &#123; /// ÂØπË∞ÉÁî®Ê†àÁ¨¶Âè∑Âåñ if(stackCursor-&gt;symbolicate(stackCursor)) &#123; /// ÊääÁ¨¶Âè∑ÂåñÂêéÁöÑ image ÂêçÔºåÂú∞ÂùÄÔºåsymbol ÂêçÔºåÂú∞ÂùÄÂÜôÂÖ• if(stackCursor-&gt;stackEntry.imageName != NULL) &#123; writer-&gt;addStringElement(writer, KSCrashField_ObjectName, ksfu_lastPathEntry(stackCursor-&gt;stackEntry.imageName)); &#125; writer-&gt;addUIntegerElement(writer, KSCrashField_ObjectAddr, stackCursor-&gt;stackEntry.imageAddress); if(stackCursor-&gt;stackEntry.symbolName != NULL) &#123; writer-&gt;addStringElement(writer, KSCrashField_SymbolName, stackCursor-&gt;stackEntry.symbolName); &#125; writer-&gt;addUIntegerElement(writer, KSCrashField_SymbolAddr, stackCursor-&gt;stackEntry.symbolAddress); &#125; writer-&gt;addUIntegerElement(writer, KSCrashField_InstructionAddr, stackCursor-&gt;stackEntry.address); &#125; writer-&gt;endContainer(writer); &#125; &#125; writer-&gt;endContainer(writer); writer-&gt;addIntegerElement(writer, KSCrashField_Skipped, 0); &#125; writer-&gt;endContainer(writer);&#125; ÂÖ∂Ê†∏ÂøÉÈÄªËæëÂú®‰ª•‰∏ãÊñπÊ≥ï‰∏≠Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495/// Ê†πÊçÆ address Ëé∑ÂèñÁ¨¶Âè∑Âêçbool ksdl_dladdr(const uintptr_t address, Dl_info* const info)&#123; info-&gt;dli_fname = NULL; info-&gt;dli_fbase = NULL; info-&gt;dli_sname = NULL; info-&gt;dli_saddr = NULL; /// Âà§Êñ≠ address ÊòØÂú®Á¨¨Âá†‰∏™ image ÂÜÖ const uint32_t idx = imageIndexContainingAddress(address); if(idx == UINT_MAX) &#123; return false; &#125; /// Ëé∑ÂæóËØ• image ÁöÑ header const struct mach_header* header = _dyld_get_image_header(idx); /// Ëé∑ÂæóËØ• image ÁöÑÂü∫Âú∞ÂùÄ const uintptr_t imageVMAddrSlide = (uintptr_t)_dyld_get_image_vmaddr_slide(idx); /// Ëé∑Âèñ address Áõ∏ÂØπ‰∫é image ÁöÑÂÅèÁßª const uintptr_t addressWithSlide = address - imageVMAddrSlide; /// Ëé∑Âæó segment Âú®ËôöÊãüÂÜÖÂ≠ò‰∏≠ÁöÑÂü∫Âú∞ÂùÄ const uintptr_t segmentBase = segmentBaseOfImageIndex(idx) + imageVMAddrSlide; if(segmentBase == 0) &#123; return false; &#125; /// Ëé∑Âèñ image ÁöÑÂêçÂ≠ó info-&gt;dli_fname = _dyld_get_image_name(idx); /// Ëé∑Âèñ header Âú∞ÂùÄ info-&gt;dli_fbase = (void*)header; // Find symbol tables and get whichever symbol is closest to the address. const STRUCT_NLIST* bestMatch = NULL; uintptr_t bestDistance = ULONG_MAX; uintptr_t cmdPtr = firstCmdAfterHeader(header); if(cmdPtr == 0) &#123; return false; &#125; for(uint32_t iCmd = 0; iCmd &lt; header-&gt;ncmds; iCmd++) &#123; const struct load_command* loadCmd = (struct load_command*)cmdPtr; if(loadCmd-&gt;cmd == LC_SYMTAB) &#123; /// ÊâæÂà∞ symbol table ÁöÑ load command const struct symtab_command* symtabCmd = (struct symtab_command*)cmdPtr; /// ÈÄöËøá load command ‰∏≠ÁöÑ offset + segment ÁöÑÂü∫Âú∞ÂùÄÔºåÂæóÂà∞ symbol table ÁöÑÂÆûÈôÖÂú∞ÂùÄ const STRUCT_NLIST* symbolTable = (STRUCT_NLIST*)(segmentBase + symtabCmd-&gt;symoff); /// ÊâæÂà∞ string table ÁöÑ‰ΩçÁΩÆ const uintptr_t stringTable = segmentBase + symtabCmd-&gt;stroff; /// ÊâæÂà∞ÊúÄ‰Ω≥ÁöÑÁ¨¶Âè∑ for(uint32_t iSym = 0; iSym &lt; symtabCmd-&gt;nsyms; iSym++) &#123; // If n_value is 0, the symbol refers to an external object. if(symbolTable[iSym].n_value != 0) &#123; uintptr_t symbolBase = symbolTable[iSym].n_value; /// uintptr_t currentDistance = addressWithSlide - symbolBase; if((addressWithSlide &gt;= symbolBase) &amp;&amp; (currentDistance &lt;= bestDistance)) &#123; bestMatch = symbolTable + iSym; bestDistance = currentDistance; &#125; &#125; &#125; /// Ê†πÊçÆÁ¨¶Âè∑ÁöÑ‰ΩçÁΩÆÊâæÂà∞ÂÖ∂Âú® string table ‰∏≠Ë°®Á§∫ÁöÑÂ≠óÁ¨¶‰∏≤ if(bestMatch != NULL) &#123; info-&gt;dli_saddr = (void*)(bestMatch-&gt;n_value + imageVMAddrSlide); if(bestMatch-&gt;n_desc == 16) &#123; // This image has been stripped. The name is meaningless, and // almost certainly resolves to "_mh_execute_header" info-&gt;dli_sname = NULL; &#125; else &#123; info-&gt;dli_sname = (char*)((intptr_t)stringTable + (intptr_t)bestMatch-&gt;n_un.n_strx); if(*info-&gt;dli_sname == '_') &#123; info-&gt;dli_sname++; &#125; &#125; break; &#125; &#125; cmdPtr += loadCmd-&gt;cmdsize; &#125; return true;&#125; ‰ª£Á†Å‰∏≠Â∑≤ÁªèÂÅö‰∫ÜËØ¶Â∞ΩÁöÑÊ≥®ÈáäÔºåÂØπ‰∫éÂéüÁêÜÊàëÂ∞±‰∏çÂÜçÂÅöËØ¶Â∞ΩÁöÑÈòêËø∞‰∫Ü„ÄÇÂ¶ÇÊûúÂØπËøôÈÉ®ÂàÜ‰∏çÊòéÁôΩÔºå‰πüÂèØ‰ª•ÂèÇËÄÉÊàëÂØπ‰∫é fishhook ÁöÑËß£Êûê„ÄÇÊÄª‰πãÔºåÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠Â∞±ÂÆåÊàê‰∫Ü‰ªéÂú∞ÂùÄÂà∞ image ‰∏≠Á¨¶Âè∑ÁöÑËΩ¨Âåñ„ÄÇ ÂÜôÂÖ•ÂØÑÂ≠òÂô®Âú®ÈÄöËøá crash Ëé∑ÂèñÁöÑ context ‰ø°ÊÅØ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÊãøÂà∞ÂØÑÂ≠òÂô®Áõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØÔºö 1234567891011121314151617181920212223static void writeBasicRegisters(const KSCrashReportWriter* const writer, const char* const key, const struct KSMachineContext* const machineContext)&#123; char registerNameBuff[30]; const char* registerName; writer-&gt;beginObject(writer, key); &#123; const int numRegisters = kscpu_numRegisters(); for(int reg = 0; reg &lt; numRegisters; reg++) &#123; registerName = kscpu_registerName(reg); if(registerName == NULL) &#123; snprintf(registerNameBuff, sizeof(registerNameBuff), "r%d", reg); registerName = registerNameBuff; &#125; writer-&gt;addUIntegerElement(writer, registerName, kscpu_registerValue(machineContext, reg)); &#125; &#125; writer-&gt;endContainer(writer);&#125; Ëé∑ÂèñÂà∞ÁöÑÂØÑÂ≠òÂô®Êúâ‰ª•‰∏ãÊâÄÁ§∫Ôºö 123456789static const char* g_registerNames[] =&#123; "rax", "rbx", "rcx", "rdx", "rdi", "rsi", "rbp", "rsp", "r8", "r9", "r10", "r11", "r12", "r13", "r14", "r15", "rip", "rflags", "cs", "fs", "gs"&#125;; Ê†πÊçÆÂØÑÂ≠òÂô®ÁöÑÂ∫èÂè∑ÈÄöËøáÂ¶Ç‰∏ãÊñπÊ≥ïÂú® context ‰∏≠Ëé∑ÂèñÂØÑÂ≠òÂô®‰∏≠Â≠òÂÇ®ÁöÑÂÄºÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051uint64_t kscpu_registerValue(const KSMachineContext* const context, const int regNumber)&#123; switch(regNumber) &#123; case 0: return context-&gt;machineContext.__ss.__rax; case 1: return context-&gt;machineContext.__ss.__rbx; case 2: return context-&gt;machineContext.__ss.__rcx; case 3: return context-&gt;machineContext.__ss.__rdx; case 4: return context-&gt;machineContext.__ss.__rdi; case 5: return context-&gt;machineContext.__ss.__rsi; case 6: return context-&gt;machineContext.__ss.__rbp; case 7: return context-&gt;machineContext.__ss.__rsp; case 8: return context-&gt;machineContext.__ss.__r8; case 9: return context-&gt;machineContext.__ss.__r9; case 10: return context-&gt;machineContext.__ss.__r10; case 11: return context-&gt;machineContext.__ss.__r11; case 12: return context-&gt;machineContext.__ss.__r12; case 13: return context-&gt;machineContext.__ss.__r13; case 14: return context-&gt;machineContext.__ss.__r14; case 15: return context-&gt;machineContext.__ss.__r15; case 16: return context-&gt;machineContext.__ss.__rip; case 17: return context-&gt;machineContext.__ss.__rflags; case 18: return context-&gt;machineContext.__ss.__cs; case 19: return context-&gt;machineContext.__ss.__fs; case 20: return context-&gt;machineContext.__ss.__gs; &#125; KSLOG_ERROR("Invalid register number: %d", regNumber); return 0;&#125; ËÆ∞ÂΩïË∞ÉÁî®Â†ÜÊ†àÁöÑÈÉ®ÂàÜ‰ø°ÊÅØÂàÜÊûê crash ÁöÑÂéüÂõ†ÔºåÊÄé‰πàËÉΩÂ∞ë‰∫ÜÂá∫ÈîôÁ∫øÁ®ãÂ†ÜÊ†àÁöÑËß£ÊûêÂë¢ÔºüKSCrash Êèê‰æõ‰∫ÜÊñπÊ≥ïÂ∞ÜÂá∫ÈîôÁ∫øÁ®ãÁöÑÂ†ÜÊ†à‰∏äÁöÑÈÉ®ÂàÜ‰ø°ÊÅØÊã∑Ë¥ùÂá∫Êù•Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041static void writeStackContents(const KSCrashReportWriter* const writer, const char* const key, const struct KSMachineContext* const machineContext, const bool isStackOverflow)&#123; /// ÊãøÂà∞ stack pointer uintptr_t sp = kscpu_stackPointer(machineContext); if((void*)sp == NULL) &#123; return; &#125; uintptr_t lowAddress = sp + (uintptr_t)(kStackContentsPushedDistance * (int)sizeof(sp) * kscpu_stackGrowDirection() * -1); uintptr_t highAddress = sp + (uintptr_t)(kStackContentsPoppedDistance * (int)sizeof(sp) * kscpu_stackGrowDirection()); if(highAddress &lt; lowAddress) &#123; uintptr_t tmp = lowAddress; lowAddress = highAddress; highAddress = tmp; &#125; writer-&gt;beginObject(writer, key); &#123; writer-&gt;addStringElement(writer, KSCrashField_GrowDirection, kscpu_stackGrowDirection() &gt; 0 ? "+" : "-"); writer-&gt;addUIntegerElement(writer, KSCrashField_DumpStart, lowAddress); writer-&gt;addUIntegerElement(writer, KSCrashField_DumpEnd, highAddress); writer-&gt;addUIntegerElement(writer, KSCrashField_StackPtr, sp); writer-&gt;addBooleanElement(writer, KSCrashField_Overflow, isStackOverflow); uint8_t stackBuffer[kStackContentsTotalDistance * sizeof(sp)]; int copyLength = (int)(highAddress - lowAddress); /// Êã∑Ë¥ù lowAddress ‰∏äÁöÑÊï∞ÊçÆÂà∞ buffer ‰∏≠ if(ksmem_copySafely((void*)lowAddress, stackBuffer, copyLength)) &#123; writer-&gt;addDataElement(writer, KSCrashField_Contents, (void*)stackBuffer, copyLength); &#125; else &#123; writer-&gt;addStringElement(writer, KSCrashField_Error, "Stack contents not accessible"); &#125; &#125; writer-&gt;endContainer(writer);&#125; ÊãøÂà∞ stack pointer ÊòØÁõ¥Êé•ÈÄöËøá sp ÂØÑÂ≠òÂô®Ôºö 1234uintptr_t kscpu_stackPointer(const KSMachineContext* const context)&#123; return context-&gt;machineContext.__ss.__rsp;&#125; Êã∑Ë¥ùÊ†à‰∏äÁöÑ‰ø°ÊÅØÁöÑËåÉÂõ¥ÊòØÔºö 123#define kStackContentsPushedDistance 20#define kStackContentsPoppedDistance 10#define kStackContentsTotalDistance (kStackContentsPushedDistance + kStackContentsPoppedDistance) Ëøô‰∏™ÊòØ‰ΩúËÄÖËÆæÁΩÆÁöÑÔºå‰πüÂ∞±ËØ¥ÊòØÔºåÊã∑Ë¥ùÊ†àÂÜÖ 20 ‰∏™ÂØπË±°Ôºå‰ª•ÂèäÂàöÂàöÂá∫Ê†àÁöÑ 10 ‰∏™ÂØπË±°ÁöÑÂú∞ÂùÄ„ÄÇÂú®ÊãøÂà∞ sp ÂíåËåÉÂõ¥‰πãÂêéÔºåÂ∞±ÂèØ‰ª•ÈÄöËøá c ÁöÑÊñπÊ≥ïËé∑ÂèñÔºö 1234567891011121314static inline int copySafely(const void* restrict const src, void* restrict const dst, const int byteCount)&#123; vm_size_t bytesCopied = 0; kern_return_t result = vm_read_overwrite(mach_task_self(), (vm_address_t)src, (vm_size_t)byteCount, (vm_address_t)dst, &amp;bytesCopied); if(result != KERN_SUCCESS) &#123; return 0; &#125; return (int)bytesCopied;&#125; ÂèñÂá∫Âú∞ÂùÄ‰∏äÁöÑÂØπË±°‰∏äÈù¢Êó†ËÆ∫ÊòØÂØÑÂ≠òÂô®ËøòÊòØÂ†ÜÊ†àÔºåÂèñÂá∫ÁöÑÈÉΩÊòØÂú∞ÂùÄ„ÄÇ‰ΩÜÊòØÊàë‰ª¨ÂÖ∂ÂÆûÊõ¥ÈúÄË¶ÅÁöÑÊòØÂØπË±°ÁöÑ‰ø°ÊÅØ„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ËøòÈúÄË¶ÅÂà∞Âú∞ÂùÄ‰∏äÂéªËß£ÊûêÂØπË±°‰ø°ÊÅØÔºö 12345678910111213141516static void writeNotableAddresses(const KSCrashReportWriter* const writer, const char* const key, const struct KSMachineContext* const machineContext)&#123; writer-&gt;beginObject(writer, key); &#123; /// Ëé∑Âèñ register ‰∏äÁöÑÂØπË±° writeNotableRegisters(writer, machineContext); /// Ëé∑Âèñ stack ‰∏äÁöÑÂØπË±° writeNotableStackContents(writer, machineContext, kStackNotableSearchBackDistance, kStackNotableSearchForwardDistance); &#125; writer-&gt;endContainer(writer);&#125; Êàë‰ª¨‰ª•Ëß£ÊûêÂØÑÂ≠òÂô®‰∏äÁöÑÂØπË±°‰∏∫‰æãÔºö 123456789101112131415161718192021222324252627282930static void writeMemoryContents(const KSCrashReportWriter* const writer, const char* const key, const uintptr_t address, int* limit)&#123; (*limit)--; const void* object = (const void*)address; writer-&gt;beginObject(writer, key); &#123; writer-&gt;addUIntegerElement(writer, KSCrashField_Address, address); writeZombieIfPresent(writer, KSCrashField_LastDeallocObject, address); if(!writeObjCObject(writer, address, limit)) &#123; if(object == NULL) &#123; writer-&gt;addStringElement(writer, KSCrashField_Type, KSCrashMemType_NullPointer); &#125; else if(isValidString(object)) &#123; writer-&gt;addStringElement(writer, KSCrashField_Type, KSCrashMemType_String); writer-&gt;addStringElement(writer, KSCrashField_Value, (const char*)object); &#125; else &#123; writer-&gt;addStringElement(writer, KSCrashField_Type, KSCrashMemType_Unknown); &#125; &#125; &#125; writer-&gt;endContainer(writer);&#125; writeObjCObject() Â∞ÜÂú∞ÂùÄËΩ¨Âåñ‰∏∫ÂØπË±°Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869static bool writeObjCObject(const KSCrashReportWriter* const writer, const uintptr_t address, int* limit)&#123;#if KSCRASH_HAS_OBJC const void* object = (const void*)address; switch(ksobjc_objectType(object)) &#123; case KSObjCTypeClass: writer-&gt;addStringElement(writer, KSCrashField_Type, KSCrashMemType_Class); writer-&gt;addStringElement(writer, KSCrashField_Class, ksobjc_className(object)); return true; case KSObjCTypeObject: &#123; writer-&gt;addStringElement(writer, KSCrashField_Type, KSCrashMemType_Object); const char* className = ksobjc_objectClassName(object); writer-&gt;addStringElement(writer, KSCrashField_Class, className); if(!isRestrictedClass(className)) &#123; switch(ksobjc_objectClassType(object)) &#123; case KSObjCClassTypeString: writeNSStringContents(writer, KSCrashField_Value, address, limit); return true; case KSObjCClassTypeURL: writeURLContents(writer, KSCrashField_Value, address, limit); return true; case KSObjCClassTypeDate: writeDateContents(writer, KSCrashField_Value, address, limit); return true; case KSObjCClassTypeArray: if(*limit &gt; 0) &#123; writeArrayContents(writer, KSCrashField_FirstObject, address, limit); &#125; return true; case KSObjCClassTypeNumber: writeNumberContents(writer, KSCrashField_Value, address, limit); return true; case KSObjCClassTypeDictionary: case KSObjCClassTypeException: // TODO: Implement these. if(*limit &gt; 0) &#123; writeUnknownObjectContents(writer, KSCrashField_Ivars, address, limit); &#125; return true; case KSObjCClassTypeUnknown: if(*limit &gt; 0) &#123; writeUnknownObjectContents(writer, KSCrashField_Ivars, address, limit); &#125; return true; &#125; &#125; break; &#125; case KSObjCTypeBlock: writer-&gt;addStringElement(writer, KSCrashField_Type, KSCrashMemType_Block); const char* className = ksobjc_objectClassName(object); writer-&gt;addStringElement(writer, KSCrashField_Class, className); return true; case KSObjCTypeUnknown: break; &#125;#endif return false;&#125; Ëøô‰∏ÄÊÆµ‰ª£Á†ÅÊúâÁÇπÈïøÔºåÂÖàÊää address Âº∫ËΩ¨‰∏∫‰∏Ä‰∏™ objectÔºåÁÑ∂ÂêéÂà§Êñ≠ object Âà∞Â∫ïÊòØ tagged pointer ËøòÊòØ block ËøòÊòØ OC Á±ªÂûãÔºåËøòÊòØËá™Âª∫ÁöÑ Class„ÄÇÊ†πÊçÆÁ±ªÂûãÂÜôÂÖ•Áõ∏Â∫îÁöÑ‰ø°ÊÅØ„ÄÇ ÈáéÊåáÈíàÁöÑÁõëÊéß‰∏äÈù¢ÁöÑËé∑ÂèñÂú∞ÂùÄÂØπË±°ÊñπÊ≥ï‰∏≠ÔºåÊàë‰ª¨Ë¶ÅÊ≥®ÊÑèÂà∞‰∏Ä‰∏™ÊñπÊ≥ï writeZombieIfPresent()„ÄÇËøôÊòØ KSCrash Êèê‰æõÁöÑ ZombieÔºåÁî®‰∫éÁõëÊéßÈáéÊåáÈíà„ÄÇÊàë‰ª¨Êù•Áúã‰∏Ä‰∏ãÂÆÉÁöÑÂÆûÁé∞Ôºö 1234567891011121314151617181920212223242526272829static void writeZombieIfPresent(const KSCrashReportWriter* const writer, const char* const key, const uintptr_t address)&#123;#if KSCRASH_HAS_OBJC const void* object = (const void*)address; const char* zombieClassName = kszombie_className(object); if(zombieClassName != NULL) &#123; writer-&gt;addStringElement(writer, key, zombieClassName); &#125;#endif&#125;const char* kszombie_className(const void* object)&#123; volatile Zombie* cache = g_zombieCache; if(cache == NULL || object == NULL) &#123; return NULL; &#125; Zombie* zombie = (Zombie*)cache + hashIndex(object); if(zombie-&gt;object == object) &#123; return zombie-&gt;className; &#125; return NULL;&#125; ÂÆÉÁöÑÊñπÊ≥ïÈùûÂ∏∏ÁÆÄÊ¥Å„ÄÇÂ∞±ÊòØÂà§Êñ≠ÂΩìÂâç address ‰∏äÁöÑ object ÊòØÂê¶ÊòØËÆ∞ÂΩïËøáÁöÑÂØπË±°„ÄÇËøôÊòØÊÄé‰πàÂÅöÂà∞ÁöÑÂë¢Ôºüg_zombieCache ÂèàÊòØ‰ªÄ‰πàÂë¢ÔºüËøôÂ∞±ÈúÄË¶ÅÂõûÂà∞ KSCrashMonitor_Zombie.c ‰∏≠Êü•Áúã„ÄÇ Ââç‰∏ÄÁØáÊàë‰ª¨ËØ¥Âà∞ÔºåÊØè‰∏Ä‰∏™ monitor ‰ºöË¢´Ë∞ÉÁî®ÂÖ∂ setEnabled() ÊñπÊ≥ïÂêØÂä®„ÄÇZombie ‰πü‰∏ç‰æãÂ§ñ„ÄÇÂÆÉÂú® setEnabled() ‰∏≠Ë∞ÉÁî®‰∫Ü install ÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536373839static void install()&#123; unsigned cacheSize = CACHE_SIZE; g_zombieHashMask = cacheSize - 1; g_zombieCache = calloc(cacheSize, sizeof(*g_zombieCache)); if(g_zombieCache == NULL) &#123; KSLOG_ERROR("Error: Could not allocate %u bytes of memory. KSZombie NOT installed!", cacheSize * sizeof(*g_zombieCache)); return; &#125; g_lastDeallocedException.class = objc_getClass("NSException"); g_lastDeallocedException.address = NULL; g_lastDeallocedException.name[0] = 0; g_lastDeallocedException.reason[0] = 0; installDealloc_NSObject(); installDealloc_NSProxy();&#125;CREATE_ZOMBIE_HANDLER_INSTALLER(NSObject)CREATE_ZOMBIE_HANDLER_INSTALLER(NSProxy) #define CREATE_ZOMBIE_HANDLER_INSTALLER(CLASS) \static IMP g_originalDealloc_ ## CLASS; \static void handleDealloc_ ## CLASS(id self, SEL _cmd) \&#123; \ handleDealloc(self); \ typedef void (*fn)(id,SEL); \ fn f = (fn)g_originalDealloc_ ## CLASS; \ f(self, _cmd); \&#125; \static void installDealloc_ ## CLASS() \&#123; \ Method method = class_getInstanceMethod(objc_getClass(#CLASS), sel_registerName("dealloc")); \ g_originalDealloc_ ## CLASS = method_getImplementation(method); \ method_setImplementation(method, (IMP)handleDealloc_ ## CLASS); \&#125; Ê†πÊçÆ‰ª£Á†ÅÔºåÊàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÔºåÂÆÉ hook ‰∫Ü NSObject ‰ª•Âèä NSProxy ÁöÑ dealloc ÊñπÊ≥ï„ÄÇÂÖàË∞ÉÁî®Ëá™Â∑±ÁöÑÂ§ÑÁêÜÊñπÊ≥ï handleDealloc() ÁÑ∂ÂêéÂÜçË∞ÉÁî®ÂéüÊù•ÁöÑ dealloc ÊñπÊ≥ï„ÄÇÊ≥®ÊÑèËøôÈáåË∞ÉÁî®ÂéüÊù• dealloc ÊñπÊ≥ïÁöÑÂÆûÁé∞ÔºåËøôÊ†∑ÂÅöÁöÑÂéüÂõ†ÊàëÂú® JSPatch ‰∏≠ÊúâÂàÜÊûêËøáÔºåËøôÈáå‰∏çÂÅöËµòËø∞‰∫ÜÔºö 123typedef void (*fn)(id,SEL); \fn f = (fn)g_originalDealloc_ ## CLASS; \f(self, _cmd); \ ÂÜçÊù•Áúã handleDealloc() ÊñπÊ≥ïÔºö 123456789101112131415161718192021static inline void handleDealloc(const void* self)&#123; volatile Zombie* cache = g_zombieCache; likely_if(cache != NULL) &#123; /// ÊääË¶ÅÈîÄÊØÅÁöÑÂØπË±°‰øùÂ≠òÂú® cache ‰∏≠„ÄÇ /// hashIndex Â∞±ÊòØÂØπË¶ÅÈîÄÊØÅÂØπË±°Ê±Ç hashÔºåÊâæÂà∞ÂÆÉÂú® cache ‰∏≠Â∫îËØ•Â≠òÂú®ÁöÑ‰ΩçÁΩÆ Zombie* zombie = (Zombie*)cache + hashIndex(self); zombie-&gt;object = self; Class class = object_getClass((id)self); zombie-&gt;className = class_getName(class); for(; class != nil; class = class_getSuperclass(class)) &#123; /// Â¶ÇÊûúË¶ÅÈîÄÊØÅÁöÑÊòØ NSExceptionÔºåÈÇ£‰πàÊääÂÆÉ‰øùÂ≠òËµ∑Êù• unlikely_if(class == g_lastDeallocedException.class) &#123; storeException(self); &#125; &#125; &#125;&#125; Âú® install ÁöÑÊó∂ÂÄôÁöÑÊó∂ÂÄôÂàõÂª∫‰∫Ü‰∏Ä‰∏™Á©∫ÁöÑ CacheÔºö 1g_zombieCache = calloc(cacheSize, sizeof(*g_zombieCache)); Âú®Â§ÑÁêÜ dealloc ÁöÑÊó∂ÂÄôÔºå‰ºöÊääÂØπË±°ÁöÑÂú∞ÂùÄÊîæÂà∞Ëøô‰∏™ Zombie ÁöÑ cache ‰∏≠„ÄÇËøôÊ†∑ÁöÑ‰ΩúÁî®Â∞±ÊòØÂØπ‰∫éÂ∑≤ÁªèÈîÄÊØÅÁöÑÂØπË±°ÔºåÊàë‰ª¨ËÆ∞ÂΩï‰∫Ü‰∏Ä‰ªΩÂÆÉ‰ª¨ÁöÑÂú∞ÂùÄ‰ø°ÊÅØÔºåËøôÊ†∑‰ª•ÂêéÂá∫Áé∞ÈáéÊåáÈíà crash ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÂèëÁé∞ÊòØ zombie ‰∏≠ÊåáÂêëÁöÑÂØπË±°ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ËØ¥ÊòéÂÆÉË¢´ÊèêÂâçÈáäÊîæ‰∫Ü„ÄÇÂΩìÁÑ∂ÔºåËøôÂπ∂‰∏çÊòØÈùûÂ∏∏ÂáÜÁ°ÆÁöÑÔºåÂõ†‰∏∫ hash Ëé∑Âèñ index ÁöÑÊñπÂºèÊÄªÊòØ‰ºö‰∫ßÁîü‰∏ÄÂÆöÁöÑÁ¢∞ÊíûÂØºËá¥ÂØπË±°Ë¢´Ë¶ÜÁõñ„ÄÇÂΩìÁÑ∂‰∏çÂèØÂê¶ËÆ§ËøôÊòØ‰∏ÄÁßçÁªèÊµéÊúâÊïàÁöÑÊµãËØïÈáéÊåáÈíàÁöÑÊñπÂºè„ÄÇ‰ΩúËÄÖËá™Â∑±ÈÉΩÂú®Ê≥®Èáä‰∏≠ËØ¥ÊòéËøôÊòØ‰∏ÄÁßç Poor man‚Äôs Zombie tracking XD 123456789101112/* Poor man's zombie tracking. * * Benefits: * - Very low CPU overhead. * - Low memory overhead. * * Limitations: * - Not guaranteed to catch all zombies. * - Can generate false positives or incorrect class names. * - KSZombie itself must be compiled with ARC disabled. You can enable ARC in * your app, but KSZombie must be compiled in a separate library if you do. */ ÊÄªÁªìÂà∞ËøôÈáåÔºåKSCrash ÁöÑ‰∏≠ÁØáÁªìÊùü‰∫Ü„ÄÇËøô‰∏ÄÁØáÂõ†‰∏∫Ê∂âÂèäÁöÑÊñπÊ≥ïÂíå API Â§™Â§öÔºåËÄå‰∏îÂæàÂ§öÈÉΩÊòØ‰πãÂâçÁ†îÁ©∂ fishhook ÁöÑÊó∂ÂÄôËß£ÈáäËøáÁöÑÔºåÊâÄ‰ª•ÊàëÂØπËøôÈÉ®ÂàÜÂÜÖÂÆπÁöÑËß£Èáä‰ºöÊòæÂæóÊØîËæÉÂ∞ë„ÄÇÂΩìÁÑ∂ÔºåÂØπ‰∫é‰∏ÄËà¨ÁöÑÂºÄÂèëËÄÖÊù•ËØ¥ÔºåÊéåÊè°ÂÖ∂‰∏≠ÁöÑÂü∫Êú¨ÂéüÁêÜÂ∞±Â∑≤ÁªèË∂≥Â§ü‰∫ÜÔºåÂØπ‰∫éÂÖ∂‰∏≠ÂæàÂ§ö c Áõ∏ÂÖ≥ÁöÑ API ‰ª•ÂèäÂÜôÊ≥ïÊ≤°ÊúâÂøÖË¶ÅÁ∫†ÁªìÂ§™Ê∑±„ÄÇ KSCrash ÂàÜÊûêÁöÑÈÉ®ÂàÜÂ∫îËØ•Â∞±ÊòØËøôÊ†∑‰∫Ü„ÄÇÂú® KSCrash ‰∏ã‰∏≠ÔºåÊàëÊâìÁÆóÂéª‰∫ÜËß£‰∏Ä‰∏ãËÖæËÆØÂºÄÊ∫êÁöÑ Matrix ‰∏≠ÂÜÖÂ≠òÈ¢ÑË≠¶Áõ∏ÂÖ≥ÁöÑÂéüÁêÜ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS Crash Êî∂ÈõÜÊ°ÜÊû∂ KSCrash Ê∫êÁ†ÅËß£Êûê(‰∏ä)]]></title>
    <url>%2F2019%2F10%2F25%2Fkscrash%2F</url>
    <content type="text"><![CDATA[KSCrash ÊòØ iOS ‰∏ä‰∏Ä‰∏™Áü•ÂêçÁöÑ crash Êî∂ÈõÜÊ°ÜÊû∂„ÄÇÂåÖÊã¨ËÖæËÆØÂàöÂºÄÊ∫êÁöÑ APM Ê°ÜÊû∂ MatrixÔºåÂÖ∂‰∏≠ crash Êî∂ÈõÜÈÉ®ÂàÜ‰πüÊòØÁõ¥Êé•‰ΩøÁî®ÁöÑ KSCrash„ÄÇÈÇ£‰πà KSCrash Âà∞Â∫ïÊòØÂ¶Ç‰ΩïËøõË°å crash Êî∂ÈõÜÁöÑÂë¢Ôºü ÊÄª‰ΩìÁªìÊûÑÊÄª‰ΩìÁªìÊûÑÂ¶Ç‰∏ãÂõæÔºö ÂèØ‰ª•ÁúãÂà∞ÊÄªÂÖ±ÂàÜ‰∏∫‰∏âÂ§ßÈÉ®ÂàÜÔºö Crash Recording Crash Reporting Installation ÂÖ∂‰∏≠ Installation Áî®Êù•ÂêØÂä® KSCrashÔºåÂπ∂‰∏îÊåáÂÆö‰∫Ü Crash Êî∂ÈõÜÁöÑÊñπÂºè„ÄÇCrash Êî∂ÈõÜÊñπÂºèÂèØ‰ª•ÂåÖÊã¨ÔºöÈÇÆ‰ª∂ÂèëÈÄÅÔºåÂêëÊåáÂÆöÊúçÂä°Âô®ÂèëÈÄÅÔºåÂêë‰∏ìÈó®ÁöÑ Crash Êî∂ÈõÜÊúçÂä°Âô®ÂèëÈÄÅÁ≠âÊñπÂºè„ÄÇÊØèÁßçÊñπÂºèÂØπÂ∫î‰∫é‰∏Ä‰∏™ÂÆûÁé∞Á±ªÔºö Crash Reporting ÂåÖÂê´‰∫Ü‰∏â‰∏™Â≠êÊñá‰ª∂Â§πÔºåÂàÜÂà´ÊòØ FilterÔºåSink Âíå ToolsÔºå‰∏ªË¶ÅÁî®Êù•‰∏äÊä• Crash„ÄÇÊú¨Êñá‰∏ç‰ºöÂØπÂÖ∂ÂÅöÂÖ∑‰ΩìÁöÑÁ†îÁ©∂„ÄÇ ÂÖ∂‰∏≠ Filter ÂåÖÂê´‰∫ÜÂ∞ÜÂ≠òÂÇ®Âú®ËÆæÂ§á‰∏äÁöÑ Crash ‰ø°ÊÅØÁöÑ NSData ËΩ¨‰∏∫ NSStringÔºåJSONÔºåGZip Á≠âÂá†ÁßçÊñπÂºèÁöÑÂÆûÁé∞Á±ª„ÄÇ Sink ÂàôÊòØ‰∏çÂêåÂèëÈÄÅÊñπÂºèÁöÑÁúüÊ≠£ÁöÑÂ§ÑÁêÜËÄÖÔºåÂíå Installation ‰∏≠ÁöÑÂá†ÁßçÊî∂ÈõÜÊñπÂºè‰∏Ä‰∏ÄÂØπÂ∫î„ÄÇ Tools ÊòØ‰∏Ä‰∫õÂ∑•ÂÖ∑Á±ªÔºå‰ª•ÂèäÂèëÈÄÅËØ∑Ê±ÇÁõ∏ÂÖ≥ÁöÑÁ±ªÁöÑÂêàÈõÜ„ÄÇ ÊúÄÊúÄÂÖ≥ÈîÆÁöÑËøòÊòØË¶ÅÊï∞ Crash RecordingÔºåÂÆÉÂåÖÂê´‰∫ÜÊçïÊçâÂêÑÁßçÁ±ªÂûã crash ÁöÑÊñπÂºèÔºåÂ∞Ü‰ºöÂú®‰∏ãÊñá‰∏≠ÂÅöËØ¶ÁªÜ‰ªãÁªç„ÄÇ Âü∫Êú¨‰ΩøÁî®‰ª•ÂÆòÊñπ Demo ‰∏≠ÁöÑ Simple-Example ‰∏∫‰æãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950@implementation AppDelegate- (BOOL) application:(__unused UIApplication *) applicationdidFinishLaunchingWithOptions:(__unused NSDictionary *) launchOptions &#123; [self installCrashHandler]; return YES;&#125;- (void) installCrashHandler &#123; /// üëáÊòØÂêÑÁßç crash Êî∂ÈõÜÊñπÂºèÔºåÈÄâÊã©‰∏ÄÁßç‰ΩøÁî®// KSCrashInstallation* installation = [self makeStandardInstallation]; KSCrashInstallation* installation = [self makeEmailInstallation];// KSCrashInstallation* installation = [self makeHockeyInstallation];// KSCrashInstallation* installation = [self makeQuincyInstallation];// KSCrashInstallation *installation = [self makeVictoryInstallation]; /// Ê≥®ÂÜå crash handler [installation install]; /// ÂèëÈÄÅÊâÄÊúâÁöÑ crash Êó•Âøó [installation sendAllReportsWithCompletion:^(NSArray* reports, BOOL completed, NSError* error) &#123; if(completed) &#123; NSLog(@"Sent %d reports", (int)[reports count]); &#125; else &#123; NSLog(@"Failed to send reports: %@", error); &#125; &#125;];&#125;- (KSCrashInstallation*) makeEmailInstallation &#123; NSString* emailAddress = @"your@email.here"; KSCrashInstallationEmail* email = [KSCrashInstallationEmail sharedInstance]; email.recipients = @[emailAddress]; email.subject = @"Crash Report" email.message = @"This is a crash report"; email.filenameFmt = @"crash-report-%d.txt.gz"; [email addConditionalAlertWithTitle:@"Crash Detected" message:@"The app crashed last time it was launched. Send a crash report?" yesAnswer:@"Sure!" noAnswer:@"No thanks"]; // Uncomment to send Apple style reports instead of JSON. [email setReportStyle:KSCrashEmailReportStyleApple useDefaultFilenameFormat:YES]; return email;&#125;@end Â¶Ç‰∏äÈù¢‰ª£Á†ÅÊâÄÁ§∫ÔºåÂú® AppDelegate ‰∏≠Ê≥®ÂÜå KSCrash„ÄÇÂú®Ê≥®ÂÜå handler ÊúüÈó¥ÔºåÈÄöËøáÂ∑•ÂéÇÊ®°ÂºèÈÄâÊã©‰∏Ä‰∏™‰∏ä‰º†ÊñπÂºèÁöÑ installation ËøõË°åÂÆû‰æãÂåñ„ÄÇ‰∏çÂêåÁöÑ installation ‰ºöÊúâ‰∏çÂêåÁöÑÂ§ÑÁêÜÔºåÊØîÂ¶Ç‰∏äÈù¢ÁöÑ email ‰∏ä‰º†ÊñπÂºèÔºåÈÇ£Â∞±ÈúÄË¶ÅÊèê‰æõÈÇÆÁÆ±Âú∞ÂùÄ„ÄÇ ‰∏çÂêåÁöÑ installation Êúâ‰∏çÂêåÁöÑ‰∏äÂ∫äÊó•ÂøóÁöÑÊñπÂºèÔºå‰ΩÜÊòØÂÆÉ‰ª¨Ê≥®ÂÜåÁõëÂê¨ÁöÑÊñπÂºèÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇÂÆÉ‰ª¨ÈÉΩÁªßÊâø‰∫éÂü∫Á±ª KSCrashInstallationÔºåÂú®Âü∫Á±ª‰∏≠ÊúâÁªü‰∏ÄÁöÑ install ÊñπÊ≥ï„ÄÇ ÂºÄÂêØ Crash ÁõëÊéßÂú® install ÁöÑËøáÁ®ã‰∏≠Ôºåinstallation ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Âçï‰æãÂØπË±° KSCrashÔºåÂπ∂‰∏îË∞ÉÁî®ÂÆÉÁöÑ install ÊñπÊ≥ïÔºö 12345678910// KSCrash.m/// ÂºÄÂêØÁõëÊéß- (BOOL) install &#123; _monitoring = kscrash_install(self.bundleName.UTF8String, self.basePath.UTF8String); if(self.monitoring == 0) &#123; return false; &#125; return true;&#125; ÂÆÉÂèàË∞ÉÁî®‰∫Ü c ÊñπÊ≥ï kscrash_installÔºåËøô‰∏™ÊñπÊ≥ïÂú® KSCrashC.c ‰∏≠Ôºö 12345678910111213/// ÁúüÊ≠£ÂºÄÂßãÁöÑÊñπÊ≥ï, ÂàõÂª∫‰∏Ä‰∏™ monitorKSCrashMonitorType kscrash_install(const char* appName, const char* const installPath) &#123; /// ÁúÅÁï•‰∫Ü‰∏Ä‰∫õÂü∫Êú¨ËÆæÁΩÆÔºåÂåÖÊã¨Ë∑ØÂæÑÂêçÔºåÊñá‰ª∂ÂêçÁ≠â ... /// ËÆæÁΩÆÁä∂ÊÄÅ‰∏∫Â∑≤ÂêØÂä® g_installed = 1; /// Áªô monitor ËÆæÁΩÆÂõûË∞É kscm_setEventCallback(onCrash); /// ËÆæÁΩÆ monitor KSCrashMonitorType monitors = kscrash_setMonitoring(g_monitoring); return monitors;&#125; ËÆæÁΩÆÂõûË∞ÉÂáΩÊï∞ onCrash ÁöÑÈÉ®ÂàÜÊàë‰ª¨‰πüÂêéÈù¢ÂÜçÁúã„ÄÇÂÖàÊù•ÁúãËÆæÁΩÆ monitor ÁöÑÈÉ®ÂàÜÔºö 12345678910111213/// ËÆæÁΩÆ monitorKSCrashMonitorType kscrash_setMonitoring(KSCrashMonitorType monitors)&#123; g_monitoring = monitors; if(g_installed) &#123; kscm_setActiveMonitors(monitors); return kscm_getActiveMonitors(); &#125; // Return what we will be monitoring in future. return g_monitoring;&#125; Áî±‰∫éÂâçÈù¢ËÆæÁΩÆ‰∫Ü g_installed ÔºåÂõ†Ê≠§ÔºåËøôÈáåÂ∞±‰ºöÈÄöËøá kscm_setActiveMonitors() Ëøô‰∏™ÊñπÊ≥ïÊøÄÊ¥ª monitor„ÄÇËøôÊòØÊï¥‰∏™ÊøÄÊ¥ªÊ≠•È™§ÁöÑÊ†∏ÂøÉÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445void kscm_setActiveMonitors(KSCrashMonitorType monitorTypes)&#123; /// ËøõÁ®ãÊòØÂê¶Âú®Ë∞ÉËØï‰∏≠ÔºåË∞ÉËØï‰∏≠ÁöÑÂ∫îÁî®Âè™ËÆ∞ÂΩï Mach Signal C++ OC ÁöÑ crash if(ksdebug_isBeingTraced() &amp;&amp; (monitorTypes &amp; KSCrashMonitorTypeDebuggerUnsafe)) &#123; static bool hasWarned = false; if(!hasWarned) &#123; hasWarned = true; KSLOGBASIC_WARN(" ************************ Crash Handler Notice ************************"); KSLOGBASIC_WARN(" * App is running in a debugger. Masking out unsafe monitors. *"); KSLOGBASIC_WARN(" * This means that most crashes WILL NOT BE RECORDED while debugging! *"); KSLOGBASIC_WARN(" **********************************************************************"); &#125; monitorTypes &amp;= KSCrashMonitorTypeDebuggerSafe; &#125; /// ÊòØÂê¶ÈúÄË¶ÅÁ∫øÁ®ãÂÆâÂÖ®ÔºåÂè™Êúâ Mach Âíå Signal ÂºÇÂ∏∏ÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ if(g_requiresAsyncSafety &amp;&amp; (monitorTypes &amp; KSCrashMonitorTypeAsyncUnsafe)) &#123; KSLOG_DEBUG("Async-safe environment detected. Masking out unsafe monitors."); monitorTypes &amp;= KSCrashMonitorTypeAsyncSafe; &#125; KSLOG_DEBUG("Changing active monitors from 0x%x tp 0x%x.", g_activeMonitors, monitorTypes); KSCrashMonitorType activeMonitors = KSCrashMonitorTypeNone; for(int i = 0; i &lt; g_monitorsCount; i++) &#123; Monitor* monitor = &amp;g_monitors[i]; bool isEnabled = monitor-&gt;monitorType &amp; monitorTypes; /// ÂºÄÂêØÁõ∏Â∫îÁöÑ monitor setMonitorEnabled(monitor, isEnabled); if(isMonitorEnabled(monitor)) &#123; activeMonitors |= monitor-&gt;monitorType; &#125; else &#123; activeMonitors &amp;= ~monitor-&gt;monitorType; &#125; &#125; KSLOG_DEBUG("Active monitors are now 0x%x.", activeMonitors); g_activeMonitors = activeMonitors;&#125; ÂÖàÊù•ÁúãÂÖ•ÂèÇÔºåÂ§ñÈÉ®‰º†ÂÖ•ÁöÑ g_monitoring ÈªòËÆ§ÂÄº‰∏∫ KSCrashMonitorTypeProductionSafeMinimalÔºåÂÆÉÁöÑÂÆö‰πâÂ¶Ç‰∏ãÔºö 12#define KSCrashMonitorTypeProductionSafe (KSCrashMonitorTypeAll &amp; (~KSCrashMonitorTypeExperimental))#define KSCrashMonitorTypeProductionSafeMinimal (KSCrashMonitorTypeProductionSafe &amp; (~KSCrashMonitorTypeOptional)) ÂÜçÊù•Áúã KSCrashMonitorTypeAll ÁöÑÂÆö‰πâÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344typedef enum&#123; /* Captures and reports Mach exceptions. */ KSCrashMonitorTypeMachException = 0x01, /* Captures and reports POSIX signals. */ KSCrashMonitorTypeSignal = 0x02, /* Captures and reports C++ exceptions. * Note: This will slightly slow down exception processing. */ KSCrashMonitorTypeCPPException = 0x04, /* Captures and reports NSExceptions. */ KSCrashMonitorTypeNSException = 0x08, /* Detects and reports a deadlock in the main thread. */ KSCrashMonitorTypeMainThreadDeadlock = 0x10, /* Accepts and reports user-generated exceptions. */ KSCrashMonitorTypeUserReported = 0x20, /* Keeps track of and injects system information. */ KSCrashMonitorTypeSystem = 0x40, /* Keeps track of and injects application state. */ KSCrashMonitorTypeApplicationState = 0x80, /* Keeps track of zombies, and injects the last zombie NSException. */ KSCrashMonitorTypeZombie = 0x100,&#125; KSCrashMonitorType;#define KSCrashMonitorTypeAll \( \ KSCrashMonitorTypeMachException | \ KSCrashMonitorTypeSignal | \ KSCrashMonitorTypeCPPException | \ KSCrashMonitorTypeNSException | \ KSCrashMonitorTypeMainThreadDeadlock | \ KSCrashMonitorTypeUserReported | \ KSCrashMonitorTypeSystem | \ KSCrashMonitorTypeApplicationState | \ KSCrashMonitorTypeZombie \) ÂèØ‰ª•ÁúãÂà∞Ôºåall ‰ª£Ë°®ÁöÑÂ∞±ÊòØÊâÄÊúâÂºÇÂ∏∏ÊñπÂºèÔºö Mach ÂºÇÂ∏∏ Signal ÂºÇÂ∏∏ C++ ÂºÇÂ∏∏ OC ÂºÇÂ∏∏ Ê≠ªÈîÅ Áî®Êà∑ÊäõÂá∫ÁöÑÂºÇÂ∏∏ ËÆæÁΩÆ monitor ÁöÑÊó∂ÂÄôÔºå‰ºöÂà§Êñ≠ÊòØÂê¶Âú®Ë¢´Ë∞ÉËØïÔºåËøôÊòØÈÄöËøá sysctl Ëé∑ÂèñËøõÁ®ãÁöÑ‰ø°ÊÅØÁöÑÊñπÂºèÊù•ËøõË°åÂà§Êñ≠ÁöÑÔºö 123456789101112131415161718/// ÊòØÂê¶Âú®Ë¢´Ë∞ÉËØïbool ksdebug_isBeingTraced(void)&#123; /// Êü•ËØ¢ËøõÁ®ã‰ø°ÊÅØÁªìÊûúÁöÑÁªìÊûÑ‰Ωì struct kinfo_proc procInfo; size_t structSize = sizeof(procInfo); int mib[] = &#123;CTL_KERN, KERN_PROC, KERN_PROC_PID, getpid()&#125;; /// ÈÄöËøá sysctl Ëé∑ÂèñËøõÁ®ã‰ø°ÊÅØ if(sysctl(mib, sizeof(mib)/sizeof(*mib), &amp;procInfo, &amp;structSize, NULL, 0) != 0) &#123; KSLOG_ERROR("sysctl: %s", strerror(errno)); return false; &#125; /// ÈÄöËøáËøõÁ®ã‰ø°ÊÅØÂà§Êñ≠ÊòØÂê¶Ë¢´Ë∞ÉËØï return (procInfo.kp_proc.p_flag &amp; P_TRACED) != 0;&#125; ÊúÄÁªàÈÄöËøá for Âæ™ÁéØÔºåÈÅçÂéÜÂêØÂä®ÊØè‰∏Ä‰∏™ monitor„ÄÇÂêØÂä®Êüê‰∏™ monitor ÁöÑÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 12345678910/// ÂêØÂä®Êüê‰∏™ monitorstatic inline void setMonitorEnabled(Monitor* monitor, bool isEnabled)&#123; KSCrashMonitorAPI* api = getAPI(monitor); /// Ë∞ÉÁî®ÂêÑ‰∏™ monitor ÁöÑ enable ÊñπÊ≥ïÔºåÂêØÂä® monitor if(api != NULL &amp;&amp; api-&gt;setEnabled != NULL) &#123; api-&gt;setEnabled(isEnabled); &#125;&#125; Monitor ÊòØ‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÔºåÂÆÉ‰øùÂ≠ò‰∫Ü Monitor ÁöÑÁ±ªÂûã‰ª•ÂèäÂêØÂä® monitor ÁöÑÊñπÊ≥ïÔºö 123456/// monitor ÁöÑÊï∞ÊçÆÁªìÊûÑtypedef struct&#123; KSCrashMonitorType monitorType; KSCrashMonitorAPI* (*getAPI)(void);&#125; Monitor; ‰πüÂ∞±ÊòØËØ¥ÔºåÊØè‰∏ÄÁßçÂºÇÂ∏∏ÈÉΩ‰ºöÊúâ‰∏Ä‰∏™Ëá™Â∑±ÁöÑ setEnabled() ÊñπÊ≥ïÔºåÁî®‰∫éÂêØÂä®Ëá™Ë∫´„ÄÇ Mach ÂºÇÂ∏∏ÂºÄÂêØÊçïËé∑Mach ÂºÇÂ∏∏Âú® KSCrashMonitor_MachException.c ‰∏≠Ë¢´Â§ÑÁêÜÂ§ñÈÉ®Ë∞ÉÁî® setEnabled() ÂºÄÂêØ Mach ÂºÇÂ∏∏ÁöÑÁõëÂê¨Ôºö 1234567891011121314151617181920static void setEnabled(bool isEnabled)&#123; if(isEnabled != g_isEnabled) &#123; g_isEnabled = isEnabled; if(isEnabled) &#123; ksid_generate(g_primaryEventID); ksid_generate(g_secondaryEventID); if(!installExceptionHandler()) &#123; return; &#125; &#125; else &#123; uninstallExceptionHandler(); &#125; &#125;&#125; ÂÖ∂‰∏≠ÂåÖÂê´‰∏§‰∏™ c ÂáΩÊï∞ÔºåinstallExceptionHandler() Âíå uninstallExceptionHandler() ÂàÜÂà´Áî®‰∫éÂºÄÂêØÂíåÂÖ≥Èó≠ÁõëÂê¨„ÄÇ Âú®ËØ¥Â¶Ç‰ΩïÊçïÊçâ Mach ÂºÇÂ∏∏ÂâçÔºåÂÖàËØ¥‰∏Ä‰∏ã‰ªÄ‰πàÊòØ Mach„ÄÇMach:[m åk]ÔºåÊòØ‰∏ÄÁßçÊìç‰ΩúÁ≥ªÁªüÂæÆÂÜÖÊ†∏ÔºåÊòØËÆ∏Â§öÊñ∞Êìç‰ΩúÁ≥ªÁªüÁöÑËÆæËÆ°Âü∫Á°Ä„ÄÇ MachÂæÆÂÜÖÊ†∏‰∏≠ÊúâÂá†‰∏™Âü∫Á°ÄÊ¶ÇÂøµÔºö TasksÔºåÊã•Êúâ‰∏ÄÁªÑÁ≥ªÁªüËµÑÊ∫êÁöÑÂØπË±°ÔºåÂÖÅËÆ∏‚Äùthread‚ÄùÂú®ÂÖ∂‰∏≠ÊâßË°å„ÄÇÊØè‰∏Ä‰∏™BSD ËøõÁ®ãÈÉΩÂú®Â∫ïÂ±ÇÂÖ≥ËÅî‰∫Ü‰∏Ä‰∏™Mach ‰ªªÂä°ÂØπË±°(BSD Â±ÇÂú® Mach ‰πã‰∏äÔºåÊèê‰æõ‰∫ÜÊõ¥È´òÂ±ÇÊ¨°ÁöÑÂäüËÉΩÔºåÊØîÂ¶Ç UNIX ËøõÁ®ãÊ®°ÂûãÔºåPOSIX Á∫øÁ®ãÊ®°ÂûãÁ≠â) ThreadsÔºåÊâßË°åÁöÑÂü∫Êú¨Âçï‰ΩçÔºåÊã•ÊúâtaskÁöÑ‰∏ä‰∏ãÊñáÔºåÂπ∂ÂÖ±‰∫´ÂÖ∂ËµÑÊ∫ê„ÄÇ PortsÔºåtask‰πãÈó¥ÈÄöËÆØÁöÑ‰∏ÄÁªÑÂèó‰øùÊä§ÁöÑÊ∂àÊÅØÈòüÂàóÔºõtaskÂèØÂØπ‰ªª‰ΩïportÂèëÈÄÅ/Êé•Êî∂Êï∞ÊçÆ„ÄÇ MessageÔºåÊúâÁ±ªÂûãÁöÑÊï∞ÊçÆÂØπË±°ÈõÜÂêàÔºåÂè™ÂèØ‰ª•ÂèëÈÄÅÂà∞port„ÄÇ ÂÖ≥‰∫é‰ªÄ‰πàÊòØÂæÆÂÜÖÊ†∏ÔºüÂæÆÂÜÖÊ†∏ÊääÁ≥ªÁªüÊúçÂä°ÔºåÊØîÂ¶ÇÊñá‰ª∂ÁÆ°ÁêÜ„ÄÅËôöÊãüÂÜÖÂ≠ò„ÄÅËÆæÂ§áI/OÔºåÂçïÁã¨ÂåÖË£Ö‰∏∫‰∏Ä‰∏™‰∏™Ê®°Âùó„ÄÇÂæÆÂÜÖÊ†∏‰Ωú‰∏∫Â∫ïÂ±Ç‰ΩøÁî®ËøõÁ®ãÈó¥ÈÄö‰ø°Êî∂ÂèëÊ∂àÊÅØ„ÄÇËøô‰∏ÄÊù•Â§ßÈáèÁöÑÂÜÖÊ†∏‰ª£Á†ÅÂèØ‰ª•ËΩ¨ÁßªÂà∞Áî®Êà∑Á©∫Èó¥Ôºå‰ΩøÂÜÖÊ†∏ÂèòÂæóÊõ¥Â∞è„ÄÇËøôÁßçÊñπÂºèÊãìÂ±ïÊÄßÂº∫Ôºå‰ΩÜÊòØÈÄö‰ø°ÊúâÊïàÁéáÊçüËÄó„ÄÇÂÆèÂÜÖÊ†∏Ê≠£Áõ∏ÂèçÔºåÊääÊâÄÊúâÁ≥ªÁªüÊúçÂä°ÊîæÂú®‰∏ÄËµ∑„ÄÇ UNIX ‰∏ãÔºåËß¶ÂèëÂà∞ÂÜÖÊ†∏ÊÄÅÈúÄË¶ÅÈÄöËøáÁ≥ªÁªüË∞ÉÁî®Ëß¶ÂèëÈô∑Èò±„ÄÇMach ÂèØ‰ª•ÈÄöËøáÁî≥ËØ∑ portÔºåÁÑ∂ÂêéÂà©Áî®IPCÊú∫Âà∂ÂêëËøô‰∏™portÂèëÈÄÅÊ∂àÊÅØ„ÄÇ Èô∑Èò±ÊòØËΩØ‰∏≠Êñ≠ÔºåÊòØ‰∏ªÂä®Ëß¶ÂèëÁöÑÔºåÁ´ãÂàªÂêåÊ≠•Â§ÑÁêÜ„ÄÇÂºÇÂ∏∏ÊòØÂΩìÂâçÊåá‰ª§ÊâßË°åÂá∫Áé∞ÈóÆÈ¢òÔºåÊòØË¢´Âä®ÁöÑÔºåÁ´ãÂàªÂêåÊ≠•Â§ÑÁêÜ„ÄÇ‰∏≠Êñ≠ÊòØÂ§ñÈÉ®Á°¨‰ª∂Ëß¶ÂèëÁöÑÔºåÊòØÂºÇÊ≠•ÁöÑ„ÄÇ ÂõûÂà∞ Mach ÂºÇÂ∏∏ÁöÑÊ≥®ÂÜåÊñπÊ≥ï‰∏≠ÔºåÊàë‰ª¨Ë¶ÅÁü•ÈÅìÔºåÂΩìÂºÇÂ∏∏ÂèëÁîüÊó∂ÔºåÂÜÖÊ†∏‰ºöÂêëÂΩìÂâç task ÁöÑÊüê‰∏™‰∏ìÈó®Â§ÑÁêÜÂºÇÂ∏∏ÁöÑ port ÂèëÊ∂àÊÅØÔºåËØ•Ê∂àÊÅØ‰ºö‰æùÊ¨°Ë¢´ËΩ¨‰∏∫ signalÔºåNSException ÊäõÂá∫„ÄÇÂ¶ÇÊûúÊàë‰ª¨Ë¶ÅÂú® Mach Â±ÇÊçïËé∑ÂºÇÂ∏∏ÔºåÂ∞±ÈúÄË¶ÅÊ≥®ÂÜåËá™Â∑±ÁöÑ portÔºåÊù•Êé•Êî∂Ëøô‰∏™ÂºÇÂ∏∏Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120/// ÂàõÂª∫ mach ÊçïÊçâËÄÖstatic bool installExceptionHandler()&#123; KSLOG_DEBUG("Installing mach exception handler."); bool attributes_created = false; pthread_attr_t attr; kern_return_t kr; int error; /// Ëé∑ÂèñÂΩìÂâçËøõÁ®ãÁöÑ task const task_t thisTask = mach_task_self(); exception_mask_t mask = EXC_MASK_BAD_ACCESS | EXC_MASK_BAD_INSTRUCTION | EXC_MASK_ARITHMETIC | EXC_MASK_SOFTWARE | EXC_MASK_BREAKPOINT; KSLOG_DEBUG("Backing up original exception ports."); /// ‰øùÂ≠ò‰πãÂâçÁöÑÂºÇÂ∏∏Â§ÑÁêÜÁ´ØÂè£Âà∞ g_previousExceptionPorts ‰∏≠ kr = task_get_exception_ports(thisTask, mask, g_previousExceptionPorts.masks, &amp;g_previousExceptionPorts.count, g_previousExceptionPorts.ports, g_previousExceptionPorts.behaviors, g_previousExceptionPorts.flavors); if(kr != KERN_SUCCESS) &#123; KSLOG_ERROR("task_get_exception_ports: %s", mach_error_string(kr)); goto failed; &#125; /// Â¶ÇÊûúËá™Â∑±ÁöÑÂºÇÂ∏∏Â§ÑÁêÜÁ´ØÂè£ g_exceptionPort ÊòØÁ©∫ÁöÑÔºåÈÇ£‰πàÂàõÂª∫ if(g_exceptionPort == MACH_PORT_NULL) &#123; KSLOG_DEBUG("Allocating new port with receive rights."); /// ÂàõÂª∫Êñ∞ÁöÑÂºÇÂ∏∏Â§ÑÁêÜÁ´ØÂè£ kr = mach_port_allocate(thisTask, MACH_PORT_RIGHT_RECEIVE, &amp;g_exceptionPort); if(kr != KERN_SUCCESS) &#123; KSLOG_ERROR("mach_port_allocate: %s", mach_error_string(kr)); goto failed; &#125; KSLOG_DEBUG("Adding send rights to port."); /// Áî≥ËØ∑Á´ØÂè£ÊùÉÈôê kr = mach_port_insert_right(thisTask, g_exceptionPort, g_exceptionPort, MACH_MSG_TYPE_MAKE_SEND); if(kr != KERN_SUCCESS) &#123; KSLOG_ERROR("mach_port_insert_right: %s", mach_error_string(kr)); goto failed; &#125; &#125; KSLOG_DEBUG("Installing port as exception handler."); /// ÊääÂºÇÂ∏∏ËÆæÁΩÆ‰∏∫Ëá™Â∑±ÁöÑ port kr = task_set_exception_ports(thisTask, mask, g_exceptionPort, (int)(EXCEPTION_DEFAULT | MACH_EXCEPTION_CODES), THREAD_STATE_NONE); if(kr != KERN_SUCCESS) &#123; KSLOG_ERROR("task_set_exception_ports: %s", mach_error_string(kr)); goto failed; &#125; KSLOG_DEBUG("Creating secondary exception thread (suspended)."); /// ‰ª•‰∏ãÊï¥‰∏™ÈÉ®ÂàÜÁî®Êù•ÂàõÂª∫ËØªÂèñÂºÇÂ∏∏Á´ØÂè£Êï∞ÊçÆÁöÑÁ∫øÁ®ã,ËÆæÁΩÆÂºÇÂ∏∏Á´ØÂè£ÁöÑÂ§ÑÁêÜÂáΩÊï∞ pthread_attr_init(&amp;attr); attributes_created = true; pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_DETACHED); /// ÂàõÂª∫Á¨¨‰∫åÊù°Â§ÑÁêÜcrashÁöÑÁ∫øÁ®ãÔºå‰ª•Èò≤‰∏ªzÂ§ÑÁêÜcrashÁöÑÁ∫øÁ®ãcrash‰∫Ü error = pthread_create(&amp;g_secondaryPThread, &amp;attr, &amp;handleExceptions, kThreadSecondary); if(error != 0) &#123; KSLOG_ERROR("pthread_create_suspended_np: %s", strerror(error)); goto failed; &#125; g_secondaryMachThread = pthread_mach_thread_np(g_secondaryPThread); ksmc_addReservedThread(g_secondaryMachThread); KSLOG_DEBUG("Creating primary exception thread."); /// ÂàõÂª∫‰∏ªÂ§ÑÁêÜcrashÁöÑÁ∫øÁ®ã error = pthread_create(&amp;g_primaryPThread, &amp;attr, &amp;handleExceptions, kThreadPrimary); if(error != 0) &#123; KSLOG_ERROR("pthread_create: %s", strerror(error)); goto failed; &#125; pthread_attr_destroy(&amp;attr); g_primaryMachThread = pthread_mach_thread_np(g_primaryPThread); ksmc_addReservedThread(g_primaryMachThread); KSLOG_DEBUG("Mach exception handler installed."); return true;failed: KSLOG_DEBUG("Failed to install mach exception handler."); if(attributes_created) &#123; pthread_attr_destroy(&amp;attr); &#125; uninstallExceptionHandler(); return false;&#125; ‰ª£Á†ÅÂæàÈïøÔºåÂÖ≥ÈîÆÂú∞ÊñπÂÅö‰∫ÜÊ≥®ÈáäÔºö ÈÄöËøá mach_task_self() Ëé∑ÂèñÂΩìÂâçËøõÁ®ãÂØπÂ∫îÁöÑ task„ÄÇ ÈÄöËøá task_get_exception_ports() Ëé∑ÂèñÂéüÊú¨Â§ÑÁêÜÂºÇÂ∏∏ÁöÑ portÔºåÂπ∂‰øùÂ≠òÂú® g_previousExceptionPorts ‰∏≠„ÄÇ ÈÄöËøá mach_port_allocate() ÂàõÂª∫Êñ∞ÁöÑÂºÇÂ∏∏Â§ÑÁêÜÁ´ØÂè£„ÄÇ ÈÄöËøá mach_port_insert_right() ÁªôËøô‰∏™Êñ∞ÂàõÂª∫ÁöÑÁ´ØÂè£Áî≥ËØ∑ÊùÉÈôê ÈÄöËøá task_set_exception_ports() ÊääÂºÇÂ∏∏Êé•Êî∂ÁöÑ port ËÆæÁΩÆ‰∏∫Ëá™Â∑±Êñ∞ÂàõÂª∫ÁöÑ port ÂàõÂª∫Â•Ω port ‰πãÂêéÔºåÂ∞±ÂèØ‰ª•ÂàõÂª∫Ëá™Â∑±ÁöÑÁ∫øÁ®ãÂéª‰∏ÄÁõ¥ËØªÂèñ port ‰∏äÁöÑÊ∂àÊÅØ‰∫Ü„ÄÇÈÄöËøá pthread_create() ÂàõÂª∫Ëá™Â∑±ÁöÑÁ∫øÁ®ãÔºå‰ª•ÂèäËÆæÁΩÆÂ•ΩÊâßË°åÁöÑÊñπÊ≥ï‰∏∫ handleExceptions„ÄÇ Â§ÑÁêÜÂºÇÂ∏∏Áé∞Âú®Â∞±ÊòØÂÖ≥ÈîÆÁöÑÂ§ÑÁêÜÊñπÊ≥ï handleExceptions() ‰∫Ü„ÄÇËøô‰πüÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÈïøÁöÑÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142/// Â§ÑÁêÜ Exceptionstatic void* handleExceptions(void* const userData)&#123; MachExceptionMessage exceptionMessage = &#123;&#123;0&#125;&#125;; MachReplyMessage replyMessage = &#123;&#123;0&#125;&#125;; char* eventID = g_primaryEventID; const char* threadName = (const char*) userData; pthread_setname_np(threadName); if(threadName == kThreadSecondary) &#123; KSLOG_DEBUG("This is the secondary thread. Suspending."); thread_suspend((thread_t)ksthread_self()); eventID = g_secondaryEventID; &#125; for(;;) &#123; KSLOG_DEBUG("Waiting for mach exception"); // Wait for a message. /// ‰∏çÊñ≠Ë∞ÉÁî® mach_msg Êé•Êî∂Ê∂àÊÅØÔºå‰ªéÂºÇÂ∏∏Á´ØÂè£‰∏≠ËØªÂèñ‰ø°ÊÅØÂà∞ exceptionMessage ‰∏≠ kern_return_t kr = mach_msg(&amp;exceptionMessage.header, MACH_RCV_MSG, 0, sizeof(exceptionMessage), g_exceptionPort, MACH_MSG_TIMEOUT_NONE, MACH_PORT_NULL); /// ‰∏äÈù¢‰∏ÄÁõ¥Âæ™ÁéØËØªÂèñÔºåÁõ¥Âà∞ËØªÂèñÊàêÂäü‰∫ÜÔºåËøõÂÖ•ÂêéÈù¢ÁöÑÂ§ÑÁêÜÂáΩÊï∞‰∏≠ if(kr == KERN_SUCCESS) &#123; break; &#125; // Loop and try again on failure. KSLOG_ERROR("mach_msg: %s", mach_error_string(kr)); &#125; KSLOG_DEBUG("Trapped mach exception code 0x%llx, subcode 0x%llx", exceptionMessage.code[0], exceptionMessage.code[1]); if(g_isEnabled) &#123; thread_act_array_t threads = NULL; mach_msg_type_number_t numThreads = 0; /// ÊöÇÂÅúÊâÄÊúâÈùûÂΩìÂâçÁ∫øÁ®ã‰ª•ÂèäÁôΩÂêçÂçïÁ∫øÁ®ãÁöÑÁ∫øÁ®ã ksmc_suspendEnvironment(&amp;threads, &amp;numThreads); g_isHandlingCrash = true; /// ÊçïÊçâÂà∞ÂºÇÂ∏∏‰πãÂêéÊ∏ÖÈô§ÊâÄÊúâÁöÑ monitor kscm_notifyFatalExceptionCaptured(true); KSLOG_DEBUG("Exception handler is installed. Continuing exception handling."); // Switch to the secondary thread if necessary, or uninstall the handler // to avoid a death loop. /// ÊçïÊçâÂà∞ exception ÂêéÔºåÊÅ¢Â§çÂéüÊù•ÁöÑ port if(ksthread_self() == g_primaryMachThread) &#123; KSLOG_DEBUG("This is the primary exception thread. Activating secondary thread.");// TODO: This was put here to avoid a freeze. Does secondary thread ever fire? restoreExceptionPorts(); if(thread_resume(g_secondaryMachThread) != KERN_SUCCESS) &#123; KSLOG_DEBUG("Could not activate secondary thread. Restoring original exception ports."); &#125; &#125; else &#123; KSLOG_DEBUG("This is the secondary exception thread.");// Restoring original exception ports.");// restoreExceptionPorts(); &#125; // Fill out crash information /// ËÆæÁΩÆ crash ‰ø°ÊÅØÁöÑ context KSLOG_DEBUG("Fetching machine state."); /// ÂàõÂª∫‰∏Ä‰∏™ machineContext Áî®Êù•‰øùÂ≠òÂºÇÂ∏∏‰ø°ÊÅØ KSMC_NEW_CONTEXT(machineContext); KSCrash_MonitorContext* crashContext = &amp;g_monitorContext; crashContext-&gt;offendingMachineContext = machineContext; /// ÂàõÂª∫‰∏Ä‰∏™ÈÅçÂéÜË∞ÉÁî®Ê†àÁöÑ cursor kssc_initCursor(&amp;g_stackCursor, NULL, NULL); /// ÊääÁ∫øÁ®ã‰ø°ÊÅØÈôÑÂä†Âà∞ machineContext ‰∏ä if(ksmc_getContextForThread(exceptionMessage.thread.name, machineContext, true)) &#123; kssc_initWithMachineContext(&amp;g_stackCursor, 100, machineContext); KSLOG_TRACE("Fault address %p, instruction address %p", kscpu_faultAddress(machineContext), kscpu_instructionAddress(machineContext)); if(exceptionMessage.exception == EXC_BAD_ACCESS) &#123; crashContext-&gt;faultAddress = kscpu_faultAddress(machineContext); &#125; else &#123; crashContext-&gt;faultAddress = kscpu_instructionAddress(machineContext); &#125; &#125; KSLOG_DEBUG("Filling out context."); crashContext-&gt;crashType = KSCrashMonitorTypeMachException; crashContext-&gt;eventID = eventID; crashContext-&gt;registersAreValid = true; crashContext-&gt;mach.type = exceptionMessage.exception; crashContext-&gt;mach.code = exceptionMessage.code[0] &amp; (int64_t)MACH_ERROR_CODE_MASK; crashContext-&gt;mach.subcode = exceptionMessage.code[1] &amp; (int64_t)MACH_ERROR_CODE_MASK; if(crashContext-&gt;mach.code == KERN_PROTECTION_FAILURE &amp;&amp; crashContext-&gt;isStackOverflow) &#123; // A stack overflow should return KERN_INVALID_ADDRESS, but // when a stack blasts through the guard pages at the top of the stack, // it generates KERN_PROTECTION_FAILURE. Correct for this. crashContext-&gt;mach.code = KERN_INVALID_ADDRESS; &#125; /// Â∞Ü mach ÂºÇÂ∏∏ËΩ¨‰∏∫ÂØπÂ∫îÁöÑ signal crashContext-&gt;signal.signum = signalForMachException(crashContext-&gt;mach.type, crashContext-&gt;mach.code); crashContext-&gt;stackCursor = &amp;g_stackCursor; /// context ‰∫§Áªô kscrashmonitor Â§ÑÁêÜ kscm_handleException(crashContext); KSLOG_DEBUG("Crash handling complete. Restoring original handlers."); g_isHandlingCrash = false; /// ÁªìÊùü‰∫ÜÊçïËé∑ÊÅ¢Â§çÊâÄÊúâÁ∫øÁ®ã ksmc_resumeEnvironment(threads, numThreads); &#125; KSLOG_DEBUG("Replying to mach exception message."); // Send a reply saying "I didn't handle this exception". replyMessage.header = exceptionMessage.header; replyMessage.NDR = exceptionMessage.NDR; replyMessage.returnCode = KERN_FAILURE; /// ÂèëÊ∂àÊÅØÂëäÁü•Ê≤°ÊúâÂ§ÑÁêÜËøô‰∏™ÂºÇÂ∏∏ mach_msg(&amp;replyMessage.header, MACH_SEND_MSG, sizeof(replyMessage), 0, MACH_PORT_NULL, MACH_MSG_TIMEOUT_NONE, MACH_PORT_NULL); return NULL;&#125; Êï¥‰ΩìÁöÑÂ§ÑÁêÜÊñπÂºèÂ¶Ç‰∏ãÔºö ‰∏çÂÅúÂæ™ÁéØÈÄöËøá mach_msg() ËØªÂèñ port ‰∏≠‰º†Êù•ÁöÑÊ∂àÊÅØ„ÄÇ ËØªÂèñÊàêÂäüÂêéÊåÇËµ∑ÊâÄÊúâÁ∫øÁ®ã„ÄÇ Ê∏ÖÈô§ÊâÄÊúâÁöÑ monitorÔºåÊÅ¢Â§çÂéüÊù•ÁöÑ port ÊäìÂèñÊâÄÊúâÁ∫øÁ®ãÁöÑ‰ø°ÊÅØ‰øùÂ≠òÂà∞ KSMachineContext ÁªìÊûÑ‰Ωì‰∏≠ Â∞ÜÂêÑÁßç‰ø°ÊÅØ‰∫§Áªô crashContext Êää crashContext ÊäõÂá∫ÁªôÂ§ñÈÉ®Â§ÑÁêÜÊñπÊ≥ï ÊÅ¢Â§çÊâÄÊúâÁöÑÁ∫øÁ®ã ÈÄöËøá mach_msg() ÂÜçÂèëÂá∫‰∏Ä‰∏™Ê∂àÊÅØÂëäÁü•Ê≤°ÊúâÂ§ÑÁêÜËøô‰∏™ÂºÇÂ∏∏ ÈÄöËøáÊñπÊ≥ï task_threads() Ëé∑ÂèñÂΩìÂâç task ÁöÑÊâÄÊúâÁ∫øÁ®ãÔºåÈÄöËøá thread_suspend() ÊñπÊ≥ïÊåÇËµ∑Êüê‰∏™Á∫øÁ®ãÔºö 123456789101112131415161718192021222324252627282930313233/// suspend ÂΩìÂâç task ÂÜÖÈùûÂ§ÑÁêÜ crash ÊàñËÄÖÁôΩÂêçÂçïÂÜÖÁöÑÁ∫øÁ®ã„ÄÇvoid ksmc_suspendEnvironment(thread_act_array_t *suspendedThreads, mach_msg_type_number_t *numSuspendedThreads)&#123;#if KSCRASH_HAS_THREADS_API KSLOG_DEBUG("Suspending environment."); kern_return_t kr; const task_t thisTask = mach_task_self(); const thread_t thisThread = (thread_t)ksthread_self(); /// Ëé∑ÂèñÂΩìÂâçtaskÁöÑÊâÄÊúâthread if((kr = task_threads(thisTask, suspendedThreads, numSuspendedThreads)) != KERN_SUCCESS) &#123; KSLOG_ERROR("task_threads: %s", mach_error_string(kr)); return; &#125; /// ÈÅçÂéÜÊâÄÊúâ threadÔºåÂ¶ÇÊûú‰∏çÊòØÂΩìÂâçÂ§ÑÁêÜ crash ÁöÑ threadÔºå‰ª•ÂèäË¶Å‰øùÁïôÁöÑ thread Â∞±Áõ¥Êé• suspend ÂÆÉ‰ª¨ for(mach_msg_type_number_t i = 0; i &lt; *numSuspendedThreads; i++) &#123; thread_t thread = (*suspendedThreads)[i]; if(thread != thisThread &amp;&amp; !isThreadInList(thread, g_reservedThreads, g_reservedThreadsCount)) &#123; if((kr = thread_suspend(thread)) != KERN_SUCCESS) &#123; // Record the error and keep going. KSLOG_ERROR("thread_suspend (%08x): %s", thread, mach_error_string(kr)); &#125; &#125; &#125; KSLOG_DEBUG("Suspend complete.");#endif&#125; ÈÄöËøá task_threads() ÊñπÊ≥ïËé∑ÂèñÊâÄÊúâÁöÑ threadÔºö 1234567891011121314151617181920212223242526272829303132333435363738/// Ëé∑ÂèñÂΩìÂâç task ÊâÄÊúâÁöÑ threadÔºåÊääÂÆÉ‰øùÂ≠òÂà∞ context ‰∏≠static inline bool getThreadList(KSMachineContext* context)&#123; const task_t thisTask = mach_task_self(); KSLOG_DEBUG("Getting thread list"); kern_return_t kr; thread_act_array_t threads; mach_msg_type_number_t actualThreadCount; /// task_thread Ëé∑ÂèñÊâÄÊúâÁöÑ thread if((kr = task_threads(thisTask, &amp;threads, &amp;actualThreadCount)) != KERN_SUCCESS) &#123; KSLOG_ERROR("task_threads: %s", mach_error_string(kr)); return false; &#125; KSLOG_TRACE("Got %d threads", context-&gt;threadCount); int threadCount = (int)actualThreadCount; int maxThreadCount = sizeof(context-&gt;allThreads) / sizeof(context-&gt;allThreads[0]); if(threadCount &gt; maxThreadCount) &#123; KSLOG_ERROR("Thread count %d is higher than maximum of %d", threadCount, maxThreadCount); threadCount = maxThreadCount; &#125; for(int i = 0; i &lt; threadCount; i++) &#123; /// Êää thread ‰øùÂ≠òÂà∞ context ‰∏≠ context-&gt;allThreads[i] = threads[i]; &#125; context-&gt;threadCount = threadCount; for(mach_msg_type_number_t i = 0; i &lt; actualThreadCount; i++) &#123; mach_port_deallocate(thisTask, context-&gt;allThreads[i]); &#125; vm_deallocate(thisTask, (vm_address_t)threads, sizeof(thread_t) * actualThreadCount); return true;&#125; ÊÅ¢Â§çÁ∫øÁ®ãÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®Áõ∏Â∫îÁöÑ thread_resume() ÊñπÊ≥ïÂç≥ÂèØÔºö 12345678910111213141516171819202122232425262728293031323334353637/// ÊÅ¢Â§çÊâÄÊúâÁ∫øÁ®ãvoid ksmc_resumeEnvironment(thread_act_array_t threads, mach_msg_type_number_t numThreads)&#123;#if KSCRASH_HAS_THREADS_API KSLOG_DEBUG("Resuming environment."); kern_return_t kr; const task_t thisTask = mach_task_self(); const thread_t thisThread = (thread_t)ksthread_self(); if(threads == NULL || numThreads == 0) &#123; KSLOG_ERROR("we should call ksmc_suspendEnvironment() first"); return; &#125; for(mach_msg_type_number_t i = 0; i &lt; numThreads; i++) &#123; thread_t thread = threads[i]; if(thread != thisThread &amp;&amp; !isThreadInList(thread, g_reservedThreads, g_reservedThreadsCount)) &#123; if((kr = thread_resume(thread)) != KERN_SUCCESS) &#123; // Record the error and keep going. KSLOG_ERROR("thread_resume (%08x): %s", thread, mach_error_string(kr)); &#125; &#125; &#125; for(mach_msg_type_number_t i = 0; i &lt; numThreads; i++) &#123; mach_port_deallocate(thisTask, threads[i]); &#125; vm_deallocate(thisTask, (vm_address_t)threads, sizeof(thread_t) * numThreads); KSLOG_DEBUG("Resume complete.");#endif&#125; ÊâÄÊúâ Mach ÂºÇÂ∏∏ÈÉΩÂú® BSD Â±ÇË¢´ ux_exception ËΩ¨Êç¢‰∏∫Áõ∏Â∫îÁöÑ Unix ‰ø°Âè∑ÔºåÂπ∂ÈÄöËøá threadsignal Â∞Ü‰ø°Âè∑ÊäïÈÄíÂà∞Âá∫ÈîôÁöÑÁ∫øÁ®ã„ÄÇÂú® Mach Â±ÇÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÈÄöËøá Mach ÂºÇÂ∏∏Êé®ÊµãÂá∫ Signal Á±ªÂûãÔºö 123456789101112131415161718192021222324252627282930313233// Â∞Ü mach ËΩ¨‰∏∫ signalstatic int signalForMachException(exception_type_t exception, mach_exception_code_t code)&#123; switch(exception) &#123; case EXC_ARITHMETIC: return SIGFPE; case EXC_BAD_ACCESS: return code == KERN_INVALID_ADDRESS ? SIGSEGV : SIGBUS; case EXC_BAD_INSTRUCTION: return SIGILL; case EXC_BREAKPOINT: return SIGTRAP; case EXC_EMULATION: return SIGEMT; case EXC_SOFTWARE: &#123; switch (code) &#123; case EXC_UNIX_BAD_SYSCALL: return SIGSYS; case EXC_UNIX_BAD_PIPE: return SIGPIPE; case EXC_UNIX_ABORT: return SIGABRT; case EXC_SOFT_SIGNAL: return SIGKILL; &#125; break; &#125; &#125; return 0;&#125; ÂèñÊ∂àÁõëÂê¨Âú®ÊçïËé∑Âà∞ÂºÇÂ∏∏ÂêéÂ∞±Ë¶ÅÂèñÊ∂àÂéüÊú¨ÁöÑÁõëÂê¨Ôºå‰∏ªË¶ÅÂàÜ‰∏∫‰∏§Ê≠•Ôºö Â∞ÜÂéüÊú¨Áî®‰ΩúÁõëÂê¨ÂºÇÂ∏∏ÁöÑ port ÊÅ¢Â§ç ÁªìÊùüËá™Â∑±ÂàõÂª∫ÁöÑÁî®‰∫éÂ§ÑÁêÜÂºÇÂ∏∏ÁöÑÁ∫øÁ®ã 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879static void uninstallExceptionHandler()&#123; KSLOG_DEBUG("Uninstalling mach exception handler."); // NOTE: Do not deallocate the exception port. If a secondary crash occurs // it will hang the process. /// ÊÅ¢Â§çÂéüÊú¨ÁöÑmachÂ§ÑÁêÜÁ´ØÂè£ restoreExceptionPorts(); thread_t thread_self = (thread_t)ksthread_self(); /// ÂΩìÂâç‰∏çÊòØ primary Â§ÑÁêÜ crash ÁöÑÁ∫øÁ®ãÔºåÈÇ£‰πàÁªàÊ≠¢Á∫øÁ®ã if(g_primaryPThread != 0 &amp;&amp; g_primaryMachThread != thread_self) &#123; KSLOG_DEBUG("Canceling primary exception thread."); if(g_isHandlingCrash) &#123; thread_terminate(g_primaryMachThread); &#125; else &#123; pthread_cancel(g_primaryPThread); &#125; g_primaryMachThread = 0; g_primaryPThread = 0; &#125; /// ÂΩìÂâç‰∏çÊòØÂ§áÁî®Â§ÑÁêÜ crash ÁöÑÁ∫øÁ®ãÔºåÈÇ£‰πàÁªàÊ≠¢Á∫øÁ®ã if(g_secondaryPThread != 0 &amp;&amp; g_secondaryMachThread != thread_self) &#123; KSLOG_DEBUG("Canceling secondary exception thread."); if(g_isHandlingCrash) &#123; thread_terminate(g_secondaryMachThread); &#125; else &#123; pthread_cancel(g_secondaryPThread); &#125; g_secondaryMachThread = 0; g_secondaryPThread = 0; &#125; g_exceptionPort = MACH_PORT_NULL; KSLOG_DEBUG("Mach exception handlers uninstalled.");&#125;/// ÊÅ¢Â§çÂéüÊú¨ÁöÑ mach Â§ÑÁêÜÁ´ØÂè£static void restoreExceptionPorts(void)&#123; KSLOG_DEBUG("Restoring original exception ports."); if(g_previousExceptionPorts.count == 0) &#123; KSLOG_DEBUG("Original exception ports were already restored."); return; &#125; const task_t thisTask = mach_task_self(); kern_return_t kr; // Reinstall old exception ports. for(mach_msg_type_number_t i = 0; i &lt; g_previousExceptionPorts.count; i++) &#123; KSLOG_TRACE("Restoring port index %d", i); /// Â∞Ü port ËÆæÁΩÆ‰∏∫ÂéüÊù•ÁöÑ kr = task_set_exception_ports(thisTask, g_previousExceptionPorts.masks[i], g_previousExceptionPorts.ports[i], g_previousExceptionPorts.behaviors[i], g_previousExceptionPorts.flavors[i]); if(kr != KERN_SUCCESS) &#123; KSLOG_ERROR("task_set_exception_ports: %s", mach_error_string(kr)); &#125; &#125; KSLOG_DEBUG("Exception ports restored."); g_previousExceptionPorts.count = 0;&#125; Signal ÂºÇÂ∏∏ÂâçÈù¢ËØ¥ËøáÔºåMach ÂºÇÂ∏∏‰ºöÂú® BSD Â±ÇËΩ¨Âåñ‰∏∫Áõ∏Â∫îÁöÑ UNIX ‰ø°Âè∑ÔºåÊäïÈÄíÂà∞Áõ∏Â∫îÁöÑÁ∫øÁ®ã‰∏≠„ÄÇÊàë‰ª¨ÂêåÊ†∑ÂèØ‰ª•ÊçïÊçâÁõ∏Â∫îÁöÑ Signal„ÄÇ ÂºÄÂêØÊçïËé∑ÂêåÊ†∑ÊòØË∞ÉÁî® setEnabled() ÊñπÊ≥ïÔºåÂÆÉ‰ºöÊâßË°åÂà∞ installSignalHandler() ÊñπÊ≥ï‰∏≠„ÄÇÁõ∏ÂÖ≥ÁöÑÂèÇÊï∞ËÆæÁΩÆÊØîËæÉÂ§öÔºåÂù¶ÁôΩÊù•ËØ¥Á°ÆÂÆû‰∏çÂ§™Â•ΩÁêÜËß£ÂÆÉ‰ª¨ÁöÑ‰ΩúÁî®Ôºå‰∏çËøáÂÖ∂ÂÆûÁ≤óÁï•ÁöÑÁúã‰∏ãÊù•‰πü‰∏çÂΩ±ÂìçÂØπ‰∫é‰∏ªÊµÅÁ®ãÁöÑÁêÜËß£„ÄÇÊÄªÁöÑÊù•ËØ¥Â∞±ÊòØÈÄöËøá sigaction() ÊñπÊ≥ïËÆ∞ÂΩï‰∏ãÊüê‰∏™ siganl ÂØπÂ∫îÁöÑÂ§ÑÁêÜÊñπÊ≥ïÔºåÂπ∂‰∏î‰øùÂ≠òÂÖàÂâçÁöÑÂ§ÑÁêÜÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172/// ÂàõÂª∫ signal ÁöÑÊçïÊçâËÄÖstatic bool installSignalHandler()&#123; KSLOG_DEBUG("Installing signal handler.");#if KSCRASH_HAS_SIGNAL_STACK if(g_signalStack.ss_size == 0) &#123; KSLOG_DEBUG("Allocating signal stack area."); g_signalStack.ss_size = SIGSTKSZ; g_signalStack.ss_sp = malloc(g_signalStack.ss_size); &#125; KSLOG_DEBUG("Setting signal stack area."); if(sigaltstack(&amp;g_signalStack, NULL) != 0) &#123; KSLOG_ERROR("signalstack: %s", strerror(errno)); goto failed; &#125;#endif /// ÈúÄË¶ÅÁõëÂê¨ÁöÑ signal Êï∞ÁªÑ const int* fatalSignals = kssignal_fatalSignals(); /// ÈúÄË¶ÅÁõëÂê¨ÁöÑ signal Êï∞ÁªÑÂ§ßÂ∞è int fatalSignalsCount = kssignal_numFatalSignals(); if(g_previousSignalHandlers == NULL) &#123; KSLOG_DEBUG("Allocating memory to store previous signal handlers."); g_previousSignalHandlers = malloc(sizeof(*g_previousSignalHandlers) * (unsigned)fatalSignalsCount); &#125; struct sigaction action = &#123;&#123;0&#125;&#125;; action.sa_flags = SA_SIGINFO | SA_ONSTACK;#if KSCRASH_HOST_APPLE &amp;&amp; defined(__LP64__) action.sa_flags |= SA_64REGSET;#endif sigemptyset(&amp;action.sa_mask); action.sa_sigaction = &amp;handleSignal; for(int i = 0; i &lt; fatalSignalsCount; i++) &#123; KSLOG_DEBUG("Assigning handler for signal %d", fatalSignals[i]); /// ËÆæÁΩÆËØ• signal ÂØπÂ∫îÁöÑÂ§ÑÁêÜÊñπÊ≥ïÔºåÂπ∂‰∏î‰øùÂ≠òÂéüÂßãÁöÑÂ§ÑÁêÜÊñπÊ≥ï if(sigaction(fatalSignals[i], &amp;action, &amp;g_previousSignalHandlers[i]) != 0) &#123; /// ËÆæÁΩÆÂ§±Ë¥•ÁöÑÊó∂ÂÄôËµ∞‰∏ãÈù¢ÁöÑÊñπÊ≥ï char sigNameBuff[30]; const char* sigName = kssignal_signalName(fatalSignals[i]); if(sigName == NULL) &#123; snprintf(sigNameBuff, sizeof(sigNameBuff), "%d", fatalSignals[i]); sigName = sigNameBuff; &#125; KSLOG_ERROR("sigaction (%s): %s", sigName, strerror(errno)); // Try to reverse the damage for(i--;i &gt;= 0; i--) &#123; sigaction(fatalSignals[i], &amp;g_previousSignalHandlers[i], NULL); &#125; goto failed; &#125; &#125; KSLOG_DEBUG("Signal handlers installed."); return true;failed: KSLOG_DEBUG("Failed to install signal handlers."); return false;&#125; fatal_signal ÂåÖÊã¨Â¶Ç‰∏ãÔºö 1234567891011static const int g_fatalSignals[] =&#123; SIGABRT, SIGBUS, SIGFPE, SIGILL, SIGPIPE, SIGSEGV, SIGSYS, SIGTRAP,&#125;; Â§ÑÁêÜÂºÇÂ∏∏Â§ÑÁêÜÂºÇÂ∏∏ÁöÑÂõûË∞ÉÊñπÊ≥ï‰∏≠‰ºöËøîÂõû signal ‰ø°ÊÅØÔºå‰ª•Âèä‰∏Ä‰∏™ contextÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243static void handleSignal(int sigNum, siginfo_t* signalInfo, void* userContext)&#123; KSLOG_DEBUG("Trapped signal %d", sigNum); if(g_isEnabled) &#123; thread_act_array_t threads = NULL; mach_msg_type_number_t numThreads = 0; /// ÊöÇÂÅúÁ∫øÁ®ã ksmc_suspendEnvironment(&amp;threads, &amp;numThreads); /// ÈÄöÁü•Â∑≤ÁªèÊçïËé∑Âà∞ÂºÇÂ∏∏‰∫Ü kscm_notifyFatalExceptionCaptured(false); KSLOG_DEBUG("Filling out context."); KSMC_NEW_CONTEXT(machineContext); /// ‰øùÂ≠ò context Âà∞ machineContext ‰∏≠ÔºåÂπ∂‰∏îËé∑Âèñ thread ‰ø°ÊÅØ ksmc_getContextForSignal(userContext, machineContext); /// Êää machineContext ÊîæÂà∞ g_stackCursor ‰∏≠ kssc_initWithMachineContext(&amp;g_stackCursor, 100, machineContext); /// ÁîüÊàêÁúüÊ≠£ÁöÑ context KSCrash_MonitorContext* crashContext = &amp;g_monitorContext; memset(crashContext, 0, sizeof(*crashContext)); crashContext-&gt;crashType = KSCrashMonitorTypeSignal; crashContext-&gt;eventID = g_eventID; crashContext-&gt;offendingMachineContext = machineContext; crashContext-&gt;registersAreValid = true; crashContext-&gt;faultAddress = (uintptr_t)signalInfo-&gt;si_addr; crashContext-&gt;signal.userContext = userContext; crashContext-&gt;signal.signum = signalInfo-&gt;si_signo; crashContext-&gt;signal.sigcode = signalInfo-&gt;si_code; crashContext-&gt;stackCursor = &amp;g_stackCursor; /// Êää context ‰º†ÁªôÂ§ñÈÉ®Â§ÑÁêÜÂáΩÊï∞ kscm_handleException(crashContext); /// ÊÅ¢Â§çÂéüÊù•ÁöÑÁéØÂ¢É ksmc_resumeEnvironment(threads, numThreads); &#125; KSLOG_DEBUG("Re-raising signal for regular handlers to catch."); // This is technically not allowed, but it works in OSX and iOS. /// ÈáçÊñ∞ÊäõÂá∫ signal raise(sigNum);&#125; Êï¥‰∏™ÊµÅÁ®ãÂíå Mach ÂºÇÂ∏∏ËøòÊòØÈùûÂ∏∏Á±ª‰ººÁöÑÔºåÂÖàÊöÇÂÅúÁ∫øÁ®ãÔºåÁÑ∂ÂêéËØªÂèñÁ∫øÁ®ã‰ø°ÊÅØÔºåÂÜçÊää signal ‰ø°ÊÅØÁ∫øÁ®ã‰ø°ÊÅØ‰øùÂ≠òÂà∞ context ‰∏≠Ôºå‰º†ÈÄíÁªôÂ§ñÈÉ®ÁöÑÂ§ÑÁêÜÂáΩÊï∞„ÄÇÊúÄÂêéÊÅ¢Â§çÂéüÊù•ÁöÑÁéØÂ¢É„ÄÇ ÂèñÊ∂àÁõëÂê¨12345678910111213141516171819/// ÂèñÊ∂àÊçïÊçâ signalstatic void uninstallSignalHandler(void)&#123; KSLOG_DEBUG("Uninstalling signal handlers."); const int* fatalSignals = kssignal_fatalSignals(); int fatalSignalsCount = kssignal_numFatalSignals(); for(int i = 0; i &lt; fatalSignalsCount; i++) &#123; KSLOG_DEBUG("Restoring original handler for signal %d", fatalSignals[i]); sigaction(fatalSignals[i], &amp;g_previousSignalHandlers[i], NULL); &#125; #if KSCRASH_HAS_SIGNAL_STACK g_signalStack = (stack_t)&#123;0&#125;;#endif KSLOG_DEBUG("Signal handlers uninstalled.");&#125; ÂèñÊ∂àÊçïÊçâÁöÑÊñπÂºèÂíåÂêØÂä®ÊçïÊçâÁ±ª‰ººÔºåÈÉΩÊòØÈÄöËøá sigaction() ÊñπÊ≥ïÔºå‰∏çÂêåÁöÑÊòØÔºåÁé∞Âú®Â∞ÜÂéüÊú¨ÁöÑÂ§ÑÁêÜÊñπÊ≥ï‰º†Âõû„ÄÇ C++ ÂºÇÂ∏∏ÂºÄÂêØÊçïËé∑ÈÄöËøá set_terminate() ÊñπÊ≥ïËÆæÁΩÆËá™Â∑±ÁöÑÊçïËé∑ÂáΩÊï∞Ôºö 123456789101112131415161718192021static void setEnabled(bool isEnabled)&#123; if(isEnabled != g_isEnabled) &#123; g_isEnabled = isEnabled; if(isEnabled) &#123; initialize(); ksid_generate(g_eventID); /// ‰øùÂ≠òÂéüÂßãÁöÑ c++ Â§ÑÁêÜ handlerÔºåËÆæÁΩÆËá™Â∑±ÁöÑÂ§ÑÁêÜ handler g_originalTerminateHandler = std::set_terminate(CPPExceptionTerminate); &#125; else &#123; /// ÊÅ¢Â§çÂéüÂßãÁöÑ c++ Â§ÑÁêÜ handler std::set_terminate(g_originalTerminateHandler); &#125; g_captureNextStackTrace = isEnabled; &#125;&#125; Â§ÑÁêÜÂºÇÂ∏∏1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889/// c++ Â§ÑÁêÜÂáΩÊï∞static void CPPExceptionTerminate(void)&#123; thread_act_array_t threads = NULL; mach_msg_type_number_t numThreads = 0; /// ÊåÇËµ∑ÈùûÂ§ÑÁêÜÁé∞Âú∫ÂíåÁôΩÂêçÂçïÁ∫øÁ®ãÁöÑÂÖ∂‰ªñÊâÄÊúâÁ∫øÁ®ã ksmc_suspendEnvironment(&amp;threads, &amp;numThreads); KSLOG_DEBUG("Trapped c++ exception"); const char* name = NULL; std::type_info* tinfo = __cxxabiv1::__cxa_current_exception_type(); if(tinfo != NULL) &#123; name = tinfo-&gt;name(); &#125; if(name == NULL || strcmp(name, "NSException") != 0) &#123; /// ÊçïÊçâÂà∞ crash ÂêéÔºåÊ∏ÖÁ©∫ KSCrash ÁöÑÊâÄÊúâ monitor kscm_notifyFatalExceptionCaptured(false); KSCrash_MonitorContext* crashContext = &amp;g_monitorContext; memset(crashContext, 0, sizeof(*crashContext)); char descriptionBuff[DESCRIPTION_BUFFER_LENGTH]; const char* description = descriptionBuff; descriptionBuff[0] = 0; KSLOG_DEBUG("Discovering what kind of exception was thrown."); g_captureNextStackTrace = false; try &#123; throw; &#125; catch(std::exception&amp; exc) &#123; strncpy(descriptionBuff, exc.what(), sizeof(descriptionBuff)); &#125;#define CATCH_VALUE(TYPE, PRINTFTYPE) \catch(TYPE value)\&#123; \ snprintf(descriptionBuff, sizeof(descriptionBuff), "%" #PRINTFTYPE, value); \&#125; CATCH_VALUE(char, d) CATCH_VALUE(short, d) CATCH_VALUE(int, d) CATCH_VALUE(long, ld) CATCH_VALUE(long long, lld) CATCH_VALUE(unsigned char, u) CATCH_VALUE(unsigned short, u) CATCH_VALUE(unsigned int, u) CATCH_VALUE(unsigned long, lu) CATCH_VALUE(unsigned long long, llu) CATCH_VALUE(float, f) CATCH_VALUE(double, f) CATCH_VALUE(long double, Lf) CATCH_VALUE(char*, s) catch(...) &#123; description = NULL; &#125; g_captureNextStackTrace = g_isEnabled; // TODO: Should this be done here? Maybe better in the exception handler? KSMC_NEW_CONTEXT(machineContext); ksmc_getContextForThread(ksthread_self(), machineContext, true); KSLOG_DEBUG("Filling out context."); crashContext-&gt;crashType = KSCrashMonitorTypeCPPException; crashContext-&gt;eventID = g_eventID; crashContext-&gt;registersAreValid = false; crashContext-&gt;stackCursor = &amp;g_stackCursor; crashContext-&gt;CPPException.name = name; crashContext-&gt;exceptionName = name; crashContext-&gt;crashReason = description; crashContext-&gt;offendingMachineContext = machineContext; /// Â§ÑÁêÜÂºÇÂ∏∏ kscm_handleException(crashContext); &#125; else &#123; KSLOG_DEBUG("Detected NSException. Letting the current NSException handler deal with it."); &#125; /// ÊÅ¢Â§çÁ∫øÁ®ã ksmc_resumeEnvironment(threads, numThreads); KSLOG_DEBUG("Calling original terminate handler."); /// Ëß¶ÂèëÂéüÊú¨ÁöÑ handler g_originalTerminateHandler();&#125; NSException ÂºÇÂ∏∏ÂºÄÂêØÊçïËé∑Âà∞‰∫Ü NSException ÈÉ®ÂàÜÔºåÂæàÂ§öÊñáÁ´†‰∏≠‰πüÈÉΩÊúâÊèêÂà∞ÔºåÂÖàÈÄöËøá NSGetUncaughtExceptionHandler() Ëé∑ÂèñÂéüÂÖàÁöÑÂºÇÂ∏∏Â§ÑÁêÜÂáΩÊï∞ÔºåÁÑ∂ÂêéÂÜçÈÄöËøá NSSetUncaughtExceptionHandler() ÊñπÊ≥ïËÆæÁΩÆËá™Â∑±ÁöÑÂ§ÑÁêÜÂáΩÊï∞„ÄÇ 12345678910111213141516171819202122232425static void setEnabled(bool isEnabled)&#123; if(isEnabled != g_isEnabled) &#123; g_isEnabled = isEnabled; if(isEnabled) &#123; KSLOG_DEBUG(@"Backing up original handler."); /// ÊãøÂà∞ÂéüÊù•ÁöÑ handler g_previousUncaughtExceptionHandler = NSGetUncaughtExceptionHandler(); KSLOG_DEBUG(@"Setting new handler."); /// ËÆæÁΩÆÊñ∞ÁöÑ handler NSSetUncaughtExceptionHandler(&amp;handleUncaughtException); KSCrash.sharedInstance.uncaughtExceptionHandler = &amp;handleUncaughtException; KSCrash.sharedInstance.currentSnapshotUserReportedExceptionHandler = &amp;handleCurrentSnapshotUserReportedException; &#125; else &#123; KSLOG_DEBUG(@"Restoring original handler."); /// ËÆæÁΩÆÂõûÂéüÊù•ÁöÑ handler NSSetUncaughtExceptionHandler(g_previousUncaughtExceptionHandler); &#125; &#125;&#125; Â§ÑÁêÜÂºÇÂ∏∏ÂÖ≥‰∫éË∞ÉÁî®Â†ÜÊ†àÁöÑËé∑ÂèñÈÉΩ‰∏çÈúÄË¶ÅÈÄöËøá task ‰∫ÜÔºåÁõ¥Êé•‰ªé NSException Â∞±ÂèØ‰ª•Ëé∑ÂèñÂà∞Ôºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455/// Â§ÑÁêÜÊñπÊ≥ïstatic void handleException(NSException* exception, BOOL currentSnapshotUserReported) &#123; KSLOG_DEBUG(@"Trapped exception %@", exception); if(g_isEnabled) &#123; thread_act_array_t threads = NULL; mach_msg_type_number_t numThreads = 0; ksmc_suspendEnvironment(&amp;threads, &amp;numThreads); kscm_notifyFatalExceptionCaptured(false); KSLOG_DEBUG(@"Filling out context."); /// Ë∞ÉÁî®Â†ÜÊ†àÁöÑÂú∞ÂùÄ NSArray* addresses = [exception callStackReturnAddresses]; NSUInteger numFrames = addresses.count; uintptr_t* callstack = malloc(numFrames * sizeof(*callstack)); /// ËΩ¨‰∏∫Â†ÜÊ†à for(NSUInteger i = 0; i &lt; numFrames; i++) &#123; callstack[i] = (uintptr_t)[addresses[i] unsignedLongLongValue]; &#125; char eventID[37]; ksid_generate(eventID); KSMC_NEW_CONTEXT(machineContext); ksmc_getContextForThread(ksthread_self(), machineContext, true); KSStackCursor cursor; kssc_initWithBacktrace(&amp;cursor, callstack, (int)numFrames, 0); KSCrash_MonitorContext* crashContext = &amp;g_monitorContext; memset(crashContext, 0, sizeof(*crashContext)); crashContext-&gt;crashType = KSCrashMonitorTypeNSException; crashContext-&gt;eventID = eventID; crashContext-&gt;offendingMachineContext = machineContext; crashContext-&gt;registersAreValid = false; crashContext-&gt;NSException.name = [[exception name] UTF8String]; crashContext-&gt;NSException.userInfo = [[NSString stringWithFormat:@"%@", exception.userInfo] UTF8String]; crashContext-&gt;exceptionName = crashContext-&gt;NSException.name; crashContext-&gt;crashReason = [[exception reason] UTF8String]; crashContext-&gt;stackCursor = &amp;cursor; crashContext-&gt;currentSnapshotUserReported = currentSnapshotUserReported; KSLOG_DEBUG(@"Calling main crash handler."); kscm_handleException(crashContext); free(callstack); if (currentSnapshotUserReported) &#123; ksmc_resumeEnvironment(threads, numThreads); &#125; if (g_previousUncaughtExceptionHandler != NULL) &#123; KSLOG_DEBUG(@"Calling original exception handler."); g_previousUncaughtExceptionHandler(exception); &#125; &#125;&#125; DeadLockÊ≠ªÈîÅÈÉ®ÂàÜÊàëÂ∞±‰∏çÁªÜËØ¥‰∫ÜÔºåÂéüÁêÜÂíåÂú®Ââç‰∏ÄÁØá ‚ÄúiOSÂºÄÂèëÈ´òÊâãËØæ‚Äù Á¨îËÆ∞‰∏≠ÊúâËØ¥ÊòéÔºåBeeHive ‰∏≠‰πüÊúâÁ±ª‰ººÁöÑÁöÑÂÆûÁé∞„ÄÇ‰∏ªË¶ÅÊòØÈÄöËøáÂ≠êÁ∫øÁ®ãÂæ™ÁéØÂæÄÂ§çÁöÑÂà§Êñ≠‰∏Ä‰∏™Ê†áÂøó‰ΩçÊòØÂê¶Âú®‰∏ªÁ∫øÁ®ã‰∏≠Ë¢´‰øÆÊîπËøá„ÄÇÊù•ËææÂà∞ÁõëÂê¨ÁöÑÊïàÊûú„ÄÇ ÊÄªÁªìËá≥Ê≠§ÔºåÊçïËé∑ÂºÇÂ∏∏Áõ∏ÂÖ≥ÁöÑÂá†‰∏™ÊñπÊ≥ïÈÉΩÂ∑≤ÁªèÂàÜÊûêÂÆå‰∫Ü„ÄÇÂÖ∂ÂÆûËøáÁ®ãËøòÊòØÈùûÂ∏∏Á±ª‰ººÁöÑÔºöÊõøÊç¢ÂéüÊù•ÁöÑÊçïËé∑Â§ÑÁêÜÔºåÊçïËé∑Âà∞ÂºÇÂ∏∏Âêé‰øùÂ≠ò context ‰ø°ÊÅØÔºåÊöÇÂÅúÊâÄÊúâÁ∫øÁ®ãËé∑ÂèñÊâÄÊúâÁ∫øÁ®ã‰ø°ÊÅØÔºåÊÅ¢Â§çÂéüÊú¨ÁöÑÊçïËé∑Â§ÑÁêÜÊñπÊ≥ïÔºåË∞ÉÁî®Áªü‰∏ÄÁöÑÂºÇÂ∏∏Â§ÑÁêÜÂáΩÊï∞„ÄÇ ‰∏ã‰∏ÄÁØáÂ∞Ü‰ªãÁªçÂºÇÂ∏∏ÊçïËé∑ÂêéÔºåÂ¶Ç‰ΩïÂàÜÊûê context ‰ª•ÂèäÁ∫øÁ®ã‰ø°ÊÅØ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[„ÄäiOSÂºÄÂèëÈ´òÊâãËØæÈòÖËØªÁ¨îËÆ∞„Äã]]></title>
    <url>%2F2019%2F09%2F09%2FiOS%E5%BC%80%E5%8F%91%E9%AB%98%E6%89%8B%E8%AF%BE%2F</url>
    <content type="text"><![CDATA[ÂæàÊó©Â∞±‰π∞‰∫ÜÊà¥Èì≠ËÄÅÂ∏àÁöÑ‰∏ìÊ†èÔºåÊØè‰∏ÄÁØáÈÉΩÊòØÂπ≤Ë¥ß„ÄÇ‰πüÊ≠£ÊòØÂõ†‰∏∫Âπ≤Ë¥ßÂ§™Â§öÔºåÊâÄ‰ª•‰∏çÂ§™ÊÑøÊÑèÈõ∂Á¢éÁöÑÂéªÂ≠¶ÔºåÊÄïÁü•ËØÜÁÇπÁúãËøáÂ∞±Âøò‰∫Ü„ÄÇÂõ†Ê≠§ÔºåËä±‰∫ÜÂá†‰∏™Êôö‰∏äÔºåÊääÊÑüÂÖ¥Ë∂£ÁöÑÈ´òÊâãËØæÂÅö‰∫ÜÊï¥ÁêÜ„ÄÇ App ÂêØÂä®ÈÄüÂ∫¶‰ºòÂåñ‰∏éÁõëÊéßÂÜ∑ÂêØÂä®‰∏éÁÉ≠ÂêØÂä® ÂÜ∑ÂêØÂä®ÊòØÊåáÔºå App ÁÇπÂáªÂêØÂä®ÂâçÔºåÂÆÉÁöÑËøõÁ®ã‰∏çÂú®Á≥ªÁªüÈáåÔºåÈúÄË¶ÅÁ≥ªÁªüÊñ∞ÂàõÂª∫‰∏Ä‰∏™ËøõÁ®ãÂàÜÈÖçÁªôÂÆÉÂêØÂä®ÁöÑÊÉÖÂÜµ„ÄÇËøôÊòØ‰∏ÄÊ¨°ÂÆåÊï¥ÁöÑÂêØÂä®ËøáÁ®ã„ÄÇ ÁÉ≠ÂêØÂä®ÊòØÊåá ÔºåApp Âú®ÂÜ∑ÂêØÂä®ÂêéÁî®Êà∑Â∞Ü App ÈÄÄÂêéÂè∞ÔºåÂú® App ÁöÑËøõÁ®ãËøòÂú®Á≥ªÁªüÈáåÁöÑÊÉÖÂÜµ‰∏ãÔºåÁî®Êà∑ÈáçÊñ∞ÂêØÂä®ËøõÂÖ• App ÁöÑËøáÁ®ãÔºåËøô‰∏™ËøáÁ®ãÂÅöÁöÑ‰∫ãÊÉÖÈùûÂ∏∏Â∞ë„ÄÇ App ÂêØÂä®‰∏â‰∏™Èò∂ÊÆµ main() ÂáΩÊï∞ÊâßË°åÂâçÔºõ main() ÂáΩÊï∞ÊâßË°åÂêéÔºõ È¶ñÂ±èÊ∏≤ÊüìÂÆåÊàêÂêé„ÄÇ main() ÂáΩÊï∞ÊâßË°åÂâçÂú® main() ÂáΩÊï∞ÊâßË°åÂâçÔºåÁ≥ªÁªü‰∏ªË¶Å‰ºöÂÅö‰∏ãÈù¢Âá†‰ª∂‰∫ãÊÉÖÔºö Âä†ËΩΩÂèØÊâßË°åÊñá‰ª∂ÔºàApp ÁöÑ.o Êñá‰ª∂ÁöÑÈõÜÂêàÔºâÔºõ Âä†ËΩΩÂä®ÊÄÅÈìæÊé•Â∫ìÔºåËøõË°å rebase ÊåáÈíàË∞ÉÊï¥Âíå bind Á¨¶Âè∑ÁªëÂÆöÔºõ Objc runtime ÁöÑÂàùÂßãÂ§ÑÁêÜÔºåÂåÖÊã¨ Objc Áõ∏ÂÖ≥Á±ªÁöÑÊ≥®ÂÜå„ÄÅcategory Ê≥®ÂÜå„ÄÅselector ÂîØ‰∏ÄÊÄßÊ£ÄÊü•Á≠âÔºõ ÂàùÂßãÂåñÔºåÂåÖÊã¨‰∫ÜÊâßË°å +load() ÊñπÊ≥ï„ÄÅattribute((constructor)) ‰øÆÈ•∞ÁöÑÂáΩÊï∞ÁöÑË∞ÉÁî®„ÄÅÂàõÂª∫ C++ ÈùôÊÄÅÂÖ®Â±ÄÂèòÈáè„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÁõ∏Â∫îÁöÑ‰∏Ä‰∏ãÂá†ÁßçÊñπÂºè‰ºòÂåñÔºö ÂáèÂ∞ëÂä®ÊÄÅÂ∫ì„ÄÇÂ∞ΩÈáèÂ∞ÜÂä®ÊÄÅÂ∫ìÂêàÂπ∂„ÄÇ ÂáèÂ∞ë‰∏çÁî®ÁöÑÁ±ªÊàñËÄÖÊñπÊ≥ï„ÄÇ +load() ÊñπÊ≥ïÈáåÁöÑÂÜÖÂÆπÂèØ‰ª•ÊîæÂà∞È¶ñÂ±èÊ∏≤ÊüìÂÆåÊàêÂêéÂÜçÊâßË°åÔºåÊàñ‰ΩøÁî® +initialize() ÊõøÊç¢„ÄÇ ÊéßÂà∂ C++ ÂÖ®Â±ÄÂèòÈáèÁöÑÊï∞Èáè main() ÂáΩÊï∞ÊâßË°åÂêémain()ÂáΩÊï∞ÊâßË°åÂêéÁöÑÈò∂ÊÆµÔºåÊåáÁöÑÊòØ‰ªémain()ÂáΩÊï∞ÊâßË°åÂºÄÂßãÔºåÂà∞appDelegateÁöÑdidFinishLaunchingWithOptionsÊñπÊ≥ïÈáåÈ¶ñÂ±èÊ∏≤ÊüìÁõ∏ÂÖ≥ÊñπÊ≥ïÊâßË°åÂÆåÊàê„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨Â∫îËØ•ËÄÉËôëÂì™‰∫õÂàùÂßãÂåñÊìç‰ΩúÊòØÈ¶ñÂ±èÊ∏≤ÊüìÂøÖÈ°ªÁöÑÔºåÂì™‰∫õÊòØÂØπÂ∫îÂäüËÉΩÂºÄÂßãÊó∂ÊâçÈúÄË¶ÅÂàùÂßãÂåñÁöÑ„ÄÇ È¶ñÂ±èÊ∏≤ÊüìÂÆåÊàêÂêéÈ¶ñÂ±èÊ∏≤ÊüìÂÆåÊàêÂêéÔºåÂ∞±Ë¶ÅËøõË°åÈùûÈ¶ñÂ±èÂÖ∂‰ªñ‰∏öÂä°Ê®°ÂùóÁöÑÂàùÂßãÂåñÔºåÁõëÂê¨ÁöÑÊ≥®ÂÜåÔºåÈÖçÁΩÆÊñá‰ª∂ÁöÑËØªÂèñÁ≠â„ÄÇËøô‰∏™Èò∂ÊÆµÂ∞±ÊòØ‰ªéÊ∏≤ÊüìÂÆåÊàêÂºÄÂßãÔºåÂà∞ didFinishLaunchingWithOptions ÊñπÊ≥ï‰ΩúÁî®ÂüüÁªìÊùü„ÄÇ ÁõëÊéßÊñπÊ≥ïÊó∂Èïø ÂÆöÊó∂ÊäìÂèñ‰∏ªÁ∫øÁ®ã‰∏äÊñπÊ≥ïË∞ÉÁî®Â†ÜÊ†àÔºåËÆ°ÁÆó‰∏ÄÊÆµÊó∂Èó¥ÈáåÂêÑ‰∏™ÊñπÊ≥ïÁöÑËÄóÊó∂„ÄÇ Xcode ‰∏≠ÁöÑ Time Profile Â∞±ÊòØËøô‰πàÂÅöÁöÑ„ÄÇÊó∂Èó¥Èó¥Èöî‰∏ÄËà¨ËÆæÁΩÆ‰∏∫ 0.01s„ÄÇÈó¥ÈöîÂ§™ÈïøÂÆπÊòìÁõëÂê¨‰∏çÂà∞ÊâÄÊúâÊñπÊ≥ïÁöÑÊâßË°å„ÄÇ ÂØπobjc_msgSend ÊñπÊ≥ïËøõË°å hook Êù•ÊéåÊè°ÊâÄÊúâÊñπÊ≥ïÁöÑÊâßË°åËÄóÊó∂„ÄÇhook objc_msgSend ÊñπÊ≥ïËÉΩÂ§üÁ≤æÁ°ÆËé∑Âèñ OC ÊñπÊ≥ïÊâßË°åÊó∂Èó¥„ÄÇÂØπ‰∫é c Âíå blockÔºåÂèØ‰ª•‰ΩøÁî® libffi ÁöÑ ffi_call ÂÆåÊàê hook„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá fishhook hook objc_msgSend„ÄÇfishhook ÁöÑÂéüÁêÜÂèØ‰ª•ÁúãÊàë‰πãÂâçÁöÑÂçöÂÆ¢„ÄÇ emmmm„ÄÇ‰∏ÄÂ§ßÊÆµ‰∏ÄÂ§ßÊÆµÁöÑÊ±áÁºñ‰ª£Á†ÅÊúâÁÇπÈöæÊáÇ„ÄÇ„ÄÇ„ÄÇÊöÇÊó∂ÂÖàÁü•ÈÅìÈÄöËøáËøôÁßçÊñπÂºèÂèØ‰ª•ÂÆûÁé∞ÊñπÊ≥ïË∞ÉÁî®Êó∂Èó¥Â∞±Ë°å‰∫Ü ÈìæÊé•Âô®‰∏∫‰ªÄ‰πàË¶ÅÊúâÈìæÊé•Âô®ÔºüÊ≤°ÊúâËøô‰∏™ÁªëÂÆöËøáÁ®ãÁöÑËØùÔºåÂçï‰∏™Êñá‰ª∂ÁîüÊàêÁöÑ Mach-O Êñá‰ª∂ÊòØÊó†Ê≥ïÊ≠£Â∏∏ËøêË°åËµ∑Êù•ÁöÑ„ÄÇÂõ†‰∏∫ÔºåÂ¶ÇÊûúËøêË°åÊó∂Á¢∞Âà∞Ë∞ÉÁî®Âú®ÂÖ∂‰ªñÊñá‰ª∂‰∏≠ÂÆûÁé∞ÁöÑÂáΩÊï∞ÁöÑÊÉÖÂÜµÊó∂ÔºåÂ∞±‰ºöÊâæ‰∏çÂà∞Ëøô‰∏™Ë∞ÉÁî®ÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºå‰ªéËÄåÊó†Ê≥ïÁªßÁª≠ÊâßË°å„ÄÇ ÈìæÊé•Âô®Âú®ÈìæÊé•Â§ö‰∏™ÁõÆÊ†áÊñá‰ª∂ÁöÑËøáÁ®ã‰∏≠Ôºå‰ºöÂàõÂª∫‰∏Ä‰∏™Á¨¶Âè∑Ë°®ÔºåÁî®‰∫éËÆ∞ÂΩïÊâÄÊúâÂ∑≤ÂÆö‰πâÁöÑÂíåÊâÄÊúâÊú™ÂÆö‰πâÁöÑÁ¨¶Âè∑„ÄÇÈìæÊé•Êó∂Â¶ÇÊûúÂá∫Áé∞Áõ∏ÂêåÁ¨¶Âè∑ÁöÑÊÉÖÂÜµÔºåÂ∞±‰ºöÂá∫Áé∞‚Äúld: dumplicate symbols‚ÄùÁöÑÈîôËØØ‰ø°ÊÅØÔºõÂ¶ÇÊûúÂú®ÂÖ∂‰ªñÁõÆÊ†áÊñá‰ª∂ÈáåÊ≤°ÊúâÊâæÂà∞Á¨¶Âè∑ÔºåÂ∞±‰ºöÊèêÁ§∫‚ÄúUndefined symbols‚ÄùÁöÑÈîôËØØ‰ø°ÊÅØ„ÄÇ ÈìæÊé•Âô®ÂÅö‰∫Ü‰ªÄ‰πàÔºü ÂéªÈ°πÁõÆÊñá‰ª∂ÈáåÊü•ÊâæÁõÆÊ†á‰ª£Á†ÅÊñá‰ª∂ÈáåÊ≤°ÊúâÂÆö‰πâÁöÑÂèòÈáè„ÄÇ Êâ´ÊèèÈ°πÁõÆ‰∏≠ÁöÑ‰∏çÂêåÊñá‰ª∂ÔºåÂ∞ÜÊâÄÊúâÁ¨¶Âè∑ÂÆö‰πâÂíåÂºïÁî®Âú∞ÂùÄÊî∂ÈõÜËµ∑Êù•ÔºåÂπ∂ÊîæÂà∞ÂÖ®Â±ÄÁ¨¶Âè∑Ë°®‰∏≠„ÄÇ ËÆ°ÁÆóÂêàÂπ∂ÂêéÈïøÂ∫¶Âèä‰ΩçÁΩÆÔºåÁîüÊàêÂêåÁ±ªÂûãÁöÑÊÆµËøõË°åÂêàÂπ∂ÔºåÂª∫Á´ãÁªëÂÆö„ÄÇ ÂØπÈ°πÁõÆ‰∏≠‰∏çÂêåÊñá‰ª∂ÈáåÁöÑÂèòÈáèËøõË°åÂú∞ÂùÄÈáçÂÆö‰Ωç„ÄÇ Âä®ÊÄÅÂ∫ìÈìæÊé•Mach-O Êñá‰ª∂ÊòØÁºñËØëÂêéÁöÑ‰∫ßÁâ©ÔºåËÄåÂä®ÊÄÅÂ∫ìÂú®ËøêË°åÊó∂Êâç‰ºöË¢´ÈìæÊé•ÔºåÂπ∂Ê≤°ÂèÇ‰∏é Mach-O Êñá‰ª∂ÁöÑÁºñËØëÂíåÈìæÊé•ÔºåÊâÄ‰ª• Mach-O Êñá‰ª∂‰∏≠Âπ∂Ê≤°ÊúâÂåÖÂê´Âä®ÊÄÅÂ∫ìÈáåÁöÑÁ¨¶Âè∑ÂÆö‰πâ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåËøô‰∫õÁ¨¶Âè∑‰ºöÊòæÁ§∫‰∏∫‚ÄúÊú™ÂÆö‰πâ‚ÄùÔºå‰ΩÜÂÆÉ‰ª¨ÁöÑÂêçÂ≠óÂíåÂØπÂ∫îÁöÑÂ∫ìÁöÑË∑ØÂæÑ‰ºöË¢´ËÆ∞ÂΩï‰∏ãÊù•„ÄÇËøêË°åÊó∂ÈÄöËøá dlopen Âíå dlsym ÂØºÂÖ•Âä®ÊÄÅÂ∫ìÊó∂ÔºåÂÖàÊ†πÊçÆËÆ∞ÂΩïÁöÑÂ∫ìË∑ØÂæÑÊâæÂà∞ÂØπÂ∫îÁöÑÂ∫ìÔºåÂÜçÈÄöËøáËÆ∞ÂΩïÁöÑÂêçÂ≠óÁ¨¶Âè∑ÊâæÂà∞ÁªëÂÆöÁöÑÂú∞ÂùÄ„ÄÇ dlopen ‰ºöÊääÂÖ±‰∫´Â∫ìËΩΩÂÖ•ËøêË°åËøõÁ®ãÁöÑÂú∞ÂùÄÁ©∫Èó¥ÔºåËΩΩÂÖ•ÁöÑÂÖ±‰∫´Â∫ì‰πü‰ºöÊúâÊú™ÂÆö‰πâÁöÑÁ¨¶Âè∑ÔºåËøôÊ†∑‰ºöËß¶ÂèëÊõ¥Â§öÁöÑÂÖ±‰∫´Â∫ìË¢´ËΩΩÂÖ•„ÄÇ Âä†ËΩΩËøáÁ®ãÂºÄÂßã‰ºö‰øÆÊ≠£Âú∞ÂùÄÂÅèÁßªÔºåiOS ‰ºöÁî® ASLR Êù•ÂÅöÂú∞ÂùÄÂÅèÁßªÈÅøÂÖçÊîªÂáªÔºåÁ°ÆÂÆö Non-Lazy Pointer Âú∞ÂùÄËøõË°åÁ¨¶Âè∑Âú∞ÂùÄÁªëÂÆöÔºåÂä†ËΩΩÊâÄÊúâÁ±ªÔºåÊúÄÂêéÊâßË°å load ÊñπÊ≥ïÂíå Clang Attribute ÁöÑ constructor ‰øÆÈ•∞ÂáΩÊï∞„ÄÇ dyld ÂÅö‰∫Ü‰ªÄ‰πàÔºü ÂÖàÊâßË°å Mach-O Êñá‰ª∂ÔºåÊ†πÊçÆ Mach-O Êñá‰ª∂Èáå undefined ÁöÑÁ¨¶Âè∑Âä†ËΩΩÂØπÂ∫îÁöÑÂä®ÊÄÅÂ∫ìÔºåÁ≥ªÁªü‰ºöËÆæÁΩÆ‰∏Ä‰∏™ÂÖ±‰∫´ÁºìÂ≠òÊù•Ëß£ÂÜ≥Âä†ËΩΩÁöÑÈÄíÂΩí‰æùËµñÈóÆÈ¢òÔºõ Âä†ËΩΩÂêéÔºåÂ∞Ü undefined ÁöÑÁ¨¶Âè∑ÁªëÂÆöÂà∞Âä®ÊÄÅÂ∫ìÈáåÂØπÂ∫îÁöÑÂú∞ÂùÄ‰∏äÔºõ ÊúÄÂêéÂÜçÂ§ÑÁêÜ +load ÊñπÊ≥ïÔºåmain ÂáΩÊï∞ËøîÂõûÂêéËøêË°å static terminator„ÄÇ CrashÂ∏∏ËßÅ Crash‰ø°Âè∑ÂèØÊçïËé∑Â¥©Ê∫ÉÔºö KVO NSNotification Êï∞ÁªÑË∂äÁïå ÈáéÊåáÈíà ‚Ä¶ ‰ø°Âè∑‰∏çÂèØÊçïËé∑Â¥©Ê∫É ÂêéÂè∞‰ªªÂä°Ë∂ÖÊó∂ ÂÜÖÂ≠òÊ∫¢Âá∫ ‰∏ªÁ∫øÁ®ãÂç°È°øË∂ÖÈòàÂÄº (ÂºÇÂ∏∏ÁºñÁ†Å 0x8badf00d) ‚Ä¶ ‰ø°Âè∑‰∏çÂèØÊçïËé∑ÁöÑÂ¥©Ê∫ÉÈÄöÂ∏∏ÈÉΩÊòØÁ≥ªÁªüÁ∫ßÁöÑÔºåÁ≥ªÁªüÊùÄÊéâ App Âêé‰ºöÂ∞ÜÊó•Âøó‰øùÂ≠òÂú®Á≥ªÁªüÁõÆÂΩï‰∏ã„ÄÇÂºÄÂèëËÄÖÊ≤°ÊúâÊùÉÈôêËé∑ÂèñÁ≥ªÁªüÁõÆÂΩïÊó•Âøó„ÄÇ Â¶Ç‰ΩïÊî∂ÈõÜÊçïËé∑ ‰∏çÂà∞ÁöÑÂ¥©Ê∫ÉÔºüBackground Task ÂèØ‰ª•ÈÄöËøá beginBackgroundTaskWithExpirat: Êù•Âª∂ÈïøÂêéÂè∞ÊâßË°åÊó∂Èó¥„ÄÇÂêéÂè∞ÊâßË°å‰ªªÂä°ÊúÄÂ§öÂèØ‰ª•ÊâßË°å3ÂàÜÈíüÔºåË∂ÖËøá3ÂàÜÈíüÂ∞±‰ºöË¢´Á≥ªÁªüÊåÇËµ∑„ÄÇ 12345- (void)applicationDidEnterBackground:(UIApplication *)application &#123; self.backgroundTaskIdentifier = [application beginBackgroundTaskWithExpirationHandler:^(void) &#123; [self yourTask]; &#125;];&#125; ÂØπ‰∫éÊ≠§Á±ªÂºÇÂ∏∏ÂèØ‰ª•ÂÖàËÆæÁΩÆ‰∏Ä‰∏™ÂÆöÊó∂Âô®ÔºåÂú®Êé•Ëøë3ÂàÜÈíüÊó∂Âà§Êñ≠ÂêéÂè∞Á®ãÂ∫èÊòØÂê¶ËøòÂú®ÊâßË°å„ÄÇÂ¶ÇÊûúËøòÂú®ÊâßË°åÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Âà§Êñ≠Á®ãÂ∫èÂç≥Â∞ÜÂ¥©Ê∫ÉÔºåËøõË°å‰∏äÊä•ÔºåËÆ∞ÂΩïÔºå‰ª•ËææÂà∞ÁõëÊéßÁöÑÊïàÊûú„ÄÇ ÁõëÊéßÂÜÖÂ≠òÊ∫¢Âá∫Âíå‰∏ªÁ∫øÁ®ãÂç°È°øË¢´ watchdog ÊùÄÊ≠ªÔºåÂêåÊ†∑ÈúÄË¶ÅÂÖàÊâæÂà∞‰∏Ä‰∏™ÈòàÂÄºÔºåÁÑ∂ÂêéÂú®‰∏¥ËøëÈòàÂÄºÊó∂ËøòÂú®ÊâßË°åÔºåÂà§Êñ≠‰∏∫Âç≥Â∞ÜÂ¥©Ê∫É„ÄÇÂÜÖÂ≠òÊ∫¢Âá∫ÂèØ‰ª•ÈÄöËøáÂÜÖÂ≠òÊò†Â∞Ñ(mmap)Êù•‰øùÂ≠òÁé∞Âú∫Ôºõ‰∏ªÁ∫øÁ®ãÂç°È°øË∂ÖËøáÈòàÂÄºÔºåÂèØ‰ª•ÊâãÊú∫ÂΩìÂâçÁ∫øÁ®ãÁöÑÂ†ÜÊ†à‰ø°ÊÅØ„ÄÇÂÖ∑‰ΩìÊé™ÊñΩÔºåÁúãÂêéÁª≠„ÄÇ Âç°È°øÁõëÊéßÂà©Áî® runloop ÁõëÊéßÂç°È°øÂç°È°øÁöÑÂèëÁîüÂèØ‰ª•ÈÄöËøá‰∏ÄÊ¨° runloop ‰ªéÂºÄÂßãÂà∞ÁªìÊùüÁöÑÊó∂Èó¥Èó¥ÈöîÊù•Èó¥Êé•Âà§Êñ≠„ÄÇ Ê≥®ÂÜå observer ËÆ∞ÂΩï runloop ÂºÄÂêØÁöÑÊó∂Èó¥ÔºåÂπ∂‰∏îÂú® runloop ÁªìÊùüÁöÑÊó∂ÂÄôÊ∏ÖÁ©∫ÔºåÁÑ∂ÂêéÂàõÂª∫‰∏Ä‰∏™Â≠êÁ∫øÁ®ãÔºåÊØèÈöî‰∏ÄÂÆöÊó∂Èó¥ÂéªÊ£ÄÊµãÂΩìÂâçÊó∂Èó¥Âíå runloop ÂºÄÂêØÊó∂ËÆ∞ÂΩïÁöÑÊó∂Èó¥ÊòØÂê¶Â§ß‰∫éÊüê‰∏Ä‰∏™ÈòàÂÄº„ÄÇ ÂΩìÂ§ß‰∫éÊüê‰∏™ÈòàÂÄºÁöÑÊó∂ÂÄôË°®Êòé‰∫ßÁîü‰∫ÜÂç°È°øÔºåËÆ∞ÂΩï‰∏ãÂç°È°øÊó∂ÂÄôÁöÑÂ†ÜÊ†à Âà©Áî® FPS ÂèòÂåñÁõëÊéßÂç°È°øËøô‰∏™ÂÆûÁé∞ÊñπÂºèÁ±ª‰ºº YYFPSLabelÔºåÈÄöËøáÂàõÂª∫‰∏Ä‰∏™ CADisplayLinkÔºåÁúãÁúã‰∏ÄÁßíÈíüÂõûË∞ÉËÉΩÊâßË°åÂ§öÂ∞ëÊ¨°„ÄÇ ËøôÊòØÊàëÁúã YYFPSLabel Ê∫êÁ†ÅÂ≠¶Âà∞ÁöÑ Â≠êÁ∫øÁ®ãÁõëÊéßÂç°È°øÈ¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™Â≠êÁ∫øÁ®ãÔºåÁÑ∂ÂêéÂú®Ëøô‰∏™Â≠êÁ∫øÁ®ã‰∏≠Â∞Ü‰∏ãÈù¢ÁöÑ‰∫ã‰ª∂Âæ™ÁéØÔºö ËÆæÁΩÆ‰∏Ä‰∏™Ê†áÂøó‰ΩçÔºåÈªòËÆ§ÂÖ∂Ë°®Á§∫‰∏ªÁ∫øÁ®ãÈòªÂ°ûÁä∂ÊÄÅ„ÄÇÁÑ∂ÂêéÈÄöËøá gcd Áªô‰∏ªÈòüÂàóÂ¢ûÂä†‰∏Ä‰∏™‰ªªÂä°„ÄÇËøô‰∏™‰ªªÂä°Áî®Êù•Ê∏ÖÈô§Ëøô‰∏™Ê†áÂøó‰ΩçÔºåÂ∞ÜÊ†áÂøó‰ΩçÁΩÆ‰∏∫ÈùûÈòªÂ°û„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂ¶ÇÊûú‰∏ªÁ∫øÁ®ãÊ≤°ÊúâÂ†µÂ°ûÔºåÈÇ£‰πàÂ∞±‰ºöÊâßË°åËøô‰∏™‰ªªÂä°Â∞ÜÊòØÂê¶ÈòªÂ°ûÁöÑÊ†áÂøó‰ΩçÁΩÆ‰∏∫ÈùûÈòªÂ°û„ÄÇ ÁÑ∂ÂêéÂ∞ÜÂ≠êÁ∫øÁ®ãÈòªÂ°û threshold ÁßíÔºåÂú®Á∫øÁ®ãÈÜíÊù•‰πãÂêéÂà§Êñ≠Ëøô‰∏™Ê†áÂøó‰ΩçÊòØÂê¶ÁΩÆ‰∏∫‰∫ÜÈùûÈòªÂ°ûÁä∂ÊÄÅ„ÄÇÂ¶ÇÊûúÁΩÆ‰∏∫‰∫ÜÈùûÈòªÂ°ûÁä∂ÊÄÅÂ∞±ËØ¥ÊòéÂú®Ëøô threshold Áßí‰πãÂÜÖÔºå‰∏ªÁ∫øÁ®ãÊâßË°å‰∫Ü‰ªªÂä°ÔºåÊ≤°ÊúâÂ†µÂ°û„ÄÇÂ¶ÇÊûúÊ†áÂøó‰ΩçËøòÊòØÈòªÂ°ûÁä∂ÊÄÅÔºåËØ¥Êòé‰∏ªÁ∫øÁ®ãË¢´ÈòªÂ°û‰∫ÜÔºåÊ≤°Êù•ÂæóÂèäÊâßË°åÊàë‰ª¨ÁöÑÊñπÊ≥ï„ÄÇ ËøôÊòØÊàëÁúã Beehive ‰∏≠ÂÖ≥‰∫é watchdog ÈÉ®ÂàÜÂ≠¶Âà∞ÁöÑ OOM ÁõëÊéßËé∑ÂèñÂÜÖÂ≠ò‰∏äÈôêJetsamEvent Êó•ÂøóÊü•Áúã JetsamEvent ÂºÄÂ§¥ÁöÑÊó•Âøó(ËÆæÁΩÆ-&gt;ÈöêÁßÅ-&gt;ÂàÜÊûê) ÈÄöËøáÊó•Âøó‰∏≠ÁöÑ pageSize Âíå rpages Â≠óÊÆµÁöÑ‰πòÁßØÂæóÂà∞ÂÜÖÂ≠ò‰∏äÈôê„ÄÇ XNU Ëé∑ÂèñÂú® XNU ‰∏≠ÔºåÊúâ‰∏ìÈó®Áî®‰∫éËé∑ÂèñÂÜÖÂ≠ò‰∏äÈôêÂÄºÁöÑÂáΩÊï∞ÂíåÂÆè„ÄÇÂèØ‰ª•ÈÄöËøá memorystatus_priority_entry Ëøô‰∏™ÁªìÊûÑ‰ΩìÔºåËé∑ËøõÁ®ã‰ºòÂÖàÁ∫ßÂíåÂÜÖÂ≠òÈôêÂà∂Ôºö 1234567typedef struct memorystatus_priority_entry &#123; pid_t pid; int32_t priority; uint64_t user_data; int32_t limit; uint32_t state;&#125; memorystatus_priority_entry_t; priority ÊòØ‰ºòÂÖàÁ∫ßÔºålimit ÊòØÂÜÖÂ≠òÈôêÂà∂ ÂÜÖÂ≠òË≠¶ÂëäËé∑ÂèñÈÄöËøáÁ≥ªÁªüÂõûË∞ÉÂáΩÊï∞ didReceiveMemoryWarning ÂõûË∞É‰Ωú‰∏∫ÂÖ•Âè£Ëé∑ÂèñÂÜÖÂ≠òÁä∂ÂÜµ„ÄÇ‰ª•‰∏ã‰ª£Á†ÅÈÄöËøá task_info ÂáΩÊï∞ËÉΩÂ§üÊãøÂà∞ÂΩìÂâçÂÜÖÂ≠òÂç†Áî®Ôºö 123456struct mach_task_basic_info info;mach_msg_type_number_t size = sizeof(info);kern_return_t kl = task_info(mach_task_self(), MACH_TASK_BASIC_INFO, (task_info_t)&amp;info, &amp;size);float used_mem = info.resident_size;NSLog(@" ‰ΩøÁî®‰∫Ü %f MB ÂÜÖÂ≠ò ", used_mem / 1024.0f / 1024.0f) Ëé∑ÂèñÂÜÖÂ≠ò‰ø°ÊÅØÈÄöËøá fishhook Hook malloc_logger ÂáΩÊï∞ libffiÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂä®ÊÄÅÈìæÊé•Âô®Êèê‰æõÁöÑapi dlsym() ‰º†ÂÖ•ÂáΩÊï∞ÂêçËé∑ÂæóÂáΩÊï∞ÊåáÈíà„ÄÇ ‰ΩÜÊòØ dlsym() Ëé∑ÂèñÁöÑÂáΩÊï∞ÊåáÈíàÈúÄË¶ÅË∞ÉÁî®ÂøÖÈ°ªË¶ÅÊèêÂâçÂ£∞ÊòéÂ•ΩÂèÇÊï∞‰∏™Êï∞ÂíåÁ±ªÂûã„ÄÇÊØîÂ¶Ç‰∏ãÊñπÔºå2 Â∞±ÊòØÈîôÁöÑ„ÄÇÂõ†‰∏∫ 1 Âú®ÁºñËØëÁöÑÊó∂ÂÄôÁºñËØëÂô®ËÉΩÁü•ÈÅìÊúâ‰∏§‰∏™ int Á±ªÂûãÁöÑÂèÇÊï∞ÔºåÂ∞±‰ºöÂú®Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÂ∞Ü‰∏§‰∏™ int ÂèÇÊï∞ÂÖ•Ê†à„ÄÇËÄå 2 Ê≤°ÊúâÂ£∞ÊòéÔºåÁºñËØëÂô®Â∞±‰∏ç‰ºöÁî≥ËØ∑Á©∫Èó¥‰∫Ü„ÄÇ ÂΩìÁÑ∂‰πüÂèØ‰ª•ÊääË¶ÅË∞ÉÁî®ÁöÑ c ÂáΩÊï∞ÈÉΩËÆæÁΩÆ‰∏∫ id Á±ªÂûãÔºåÁÑ∂ÂêéÁîüÊàê n ‰∏™‰∏çÂêåÂèÇÊï∞‰∏™Êï∞ÁöÑÂáΩÊï∞ÊåáÈíàÔºåÈÄöËøá switch Âà§Êñ≠ÂèÇÊï∞‰∏™Êï∞ÁöÑÊñπÂºèÂéªËµãÂÄº„ÄÇJSPatch ‰πüÊúâÈÄöËøáËøôÊÄªÊñπÂºèÂÆûÁé∞ÁöÑ„ÄÇ objc_msgSend ÈÄöËøáÁõ¥Êé•Áî®Ê±áÁºñ‰ª£Á†ÅÁöÑÊñπÂºèÂÆåÊàêÂáΩÊï∞‰ΩìÔºåËøôÊ†∑Â∞±‰∏çÈúÄË¶ÅÈÄöËøáÁºñËØëÂô®ÁîüÊàêÊ±áÁºñ‰ª£Á†Å‰∫Ü„ÄÇÈÄöËøáÁ∫¶ÂÆöÂ•ΩÁöÑÊñπÂºèÂéªÂèñÂèÇÊï∞ÊòØËÉΩÂ§üÂèñÂæóÂà∞ÁöÑ„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá libffi Âä®ÊÄÅË∞ÉÁî®‰ªªÊÑè c ÂáΩÊï∞Ôºå‰πüÊòØÈÄöËøáÊ±áÁºñÁõ¥Êé•ÂÆûÁé∞ÁöÑ. ÂÜÖÂ≠òÊ≥ÑÊºèÁõëÊéß Ê≠§‰∏∫ÊúÄËøëÈòÖËØªÁõ∏ÂÖ≥Ê∫êÁ†ÅÁöÑÊó∂ÂÄôÁöÑÊÄªÁªì„ÄÇÂõ†‰∏∫‰πüÊòØÁõëÊéßÁöÑ‰∏ÄÁßçÔºåÊïÖÊîæÂà∞ËøôÈáåÊù•‰∫Ü„ÄÇ ËøôÈáåÂàó‰∏æ‰∏§ÁßçÂÜÖÂ≠òÊ≥ÑÊºèÁõëÊéßÁöÑÊñπÂºè MLeaksFinderÂæÆ‰ø°ËØª‰π¶ÂÜÖÂ≠òÊ≥ÑÊºèÁöÑÊ£ÄÊµãÊñπÊ≥ï„ÄÇ hook NavigationController ÁöÑ push Âíå pop ÊñπÊ≥ïÔºåÂú® pop ÁöÑÊó∂ÂÄô‰øùÂ≠ò‰∏∫ ViewController ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ View ‰ª•ÂèäËá™Ë∫´Ê∑ªÂä†ÂÆöÊó∂Âô®Ôºå2ÂàÜÈíüÂêéÔºåÊâßË°åÂÜÖÂ≠òÊ≥ÑÊºèÊñπÊ≥ïÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÜÖÂ≠òÊ≥ÑÊºèÔºåÈÇ£‰πàËøô‰∏™ÂØπË±°‰∏∫ nilÔºåÂÜÖÂ≠òÊ≥ÑÊºèÁöÑÊñπÊ≥ïÊó†Ê≥ïÊâßË°å„ÄÇËøôÁßçÊñπÂºèÊòØÂú®ÈîÄÊØÅÁöÑÁîüÂëΩÂë®ÊúüÁöÑÊó∂ÂÄôËß¶ÂèëÂª∂Êó∂Ê£ÄÊü• PLeakSnifferËøôÊòØ MrPeak ÁöÑÊ£ÄÊµãÊñπÊ≥ï Êää ViewController ËÆæÁΩÆ‰∏∫ÂÖ∂ÂÆû‰æãÂØπË±°ÁöÑÂº±ÂºïÁî®„ÄÇÂ¶ÇÊûúÂÆû‰æãÂØπË±°Ê≤°ÊúâÈîÄÊØÅÔºå‰ΩÜÊòØ ViewController Â∑≤ÁªèÁΩÆ‰∏∫ nil ‰∫ÜÔºåÂ∞±ËØ¥ÊòéÂèØËÉΩ leak ‰∫Ü„ÄÇÂè™ÈúÄË¶ÅÂë®ÊúüÊÄßÁöÑÂèëÈÄÅÈÄöÁü•ÔºåÂêÑ‰∏™ÂÆû‰æãÂØπË±°Êé•Êî∂Âà∞ÈÄöÁü•ÁöÑÊó∂ÂÄôÊâßË°åÊñπÊ≥ïÔºåÊ£ÄÊü• ViewController ÊòØÂê¶‰∏∫ nil Âç≥ÂèØÁü•ÈÅìÊòØÂê¶ÊòØÂèØËÉΩÊ≥ÑÈú≤ÁöÑËøôÁßçÊñπÂºèÊòØÂú®ÂàõÂª∫ÁöÑÊó∂ÂÄôÊ≥®ÂÜåÈÄöÁü•ÔºåÂÆöÊó∂ËΩÆËØ¢ iOSÂÜÖÂ≠òÊ≥ÑÊºèËá™Âä®Ê£ÄÊµãÂ∑•ÂÖ∑PLeakSniffer]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Aspects Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2019%2F08%2F19%2Faspects%2F</url>
    <content type="text"><![CDATA[Aspects ÊòØ‰∏Ä‰∏™Êèê‰æõÂÅ•Â£Æ AOP ËÉΩÂäõÁöÑÂ∫ì„ÄÇÂÆÉÁöÑÂÆûÁé∞ÂéüÁêÜÂíå JSPatch Á±ª‰ºº„ÄÇ‰πüÁúüÊòØÂ¶ÇÊ≠§ÔºåÂÆÉÂíå JSPatch Ê∑∑Áî®Êó∂‰ºö‰∫ßÁîüÂÜ≤Á™Å„ÄÇ ‰ΩøÁî®Aspects Êèê‰æõ‰∫Ü‰∏§‰∏™ÊñπÊ≥ïÊù•ÂÆûÁé∞‰∏âÁßçÁ±ªÂûãÁöÑ hookÔºö 12345678910111213@interface NSObject (Aspects)+ (id&lt;AspectToken&gt;)aspect_hookSelector:(SEL)selector withOptions:(AspectOptions)options usingBlock:(id)block error:(NSError **)error;- (id&lt;AspectToken&gt;)aspect_hookSelector:(SEL)selector withOptions:(AspectOptions)options usingBlock:(id)block error:(NSError **)error;@end ÂÆÉËÉΩ hook ÁöÑÁ±ªÂûãÊúâÔºö ÊâÄÊúâÂÆû‰æãÂØπË±°ÁöÑÁâπÂÆöÊñπÊ≥ï ÁâπÂÆöÁ±ªÊñπÊ≥ï Êüê‰∏™ÁâπÂÆöÂÆû‰æãÂØπË±°ÁöÑÁâπÂÆöÊñπÊ≥ï ‰∏§‰∏™ÊñπÊ≥ï‰∏≠ÔºåÂâçËÄÖÂ§ÑÁêÜÁöÑÊòØÁ±ªÂûã 1Ôºå2ÔºõÂêéËÄÖÂ§ÑÁêÜÁöÑÊòØÁ±ªÂûã 3„ÄÇ ÈùûÂ∏∏ÊúâÊÑèÊÄùÔºåÂ¶ÇÊûú‰Ω†Ë¶Å hook 1ÔºåÊØîÂ¶Ç‰Ω†Êúâ‰∏Ä‰∏™Á±ª Test,‰Ω†Ë¶Å hook Test ÊâÄÊúâÂÆû‰æãÂØπË±°ÁöÑ -(void)test ÊñπÊ≥ïÔºå‰Ω†Ë¶ÅÈÄöËøá Test ÂéªË∞ÉÁî®„ÄÇ Â¶ÇÊûú‰Ω†Ë¶Å hook 2ÔºåÊØîÂ¶Ç‰Ω†Ë¶Å hook Test ÁöÑÁ±ªÊñπÊ≥ï +(void)test Ôºå‰Ω†Ë¶ÅÈÄöËøá object_getClass(Test) ÂéªË∞ÉÁî®„ÄÇ Ê∂âÂèäÁöÑÁ±ªAspects Âú®ÂÆûÁé∞ÁöÑËøáÁ®ã‰∏≠ÔºåÊ∂âÂèäÂà∞‰∏Ä‰∫õÁ±ªÁöÑ‰ΩøÁî®ÔºåÊèêÂâç‰∫ÜËß£ÂÆÉ‰ª¨ÊúâÂä©‰∫éÊàë‰ª¨‰πãÂêéÁöÑÊµÅÁ®ãÂàÜÊûê„ÄÇ AspectsInfo12345678@protocol AspectInfo &lt;NSObject&gt;/// ËøîÂõû hook ÁöÑÂØπË±°- (id)instance;/// ‰øùÂ≠ò hook ÁöÑÂéüÊñπÊ≥ïÁöÑ Invocation- (NSInvocation *)originalInvocation;/// Ë∞ÉÁî®ÊñπÊ≥ïÁöÑÊâÄÊúâÂèÇÊï∞- (NSArray *)arguments;@end ËøôÊòØ‰∏Ä‰∏™ÂçèËÆÆÔºåÂΩìÊàë‰ª¨Ë¶ÅÊâßË°å hook ÁöÑÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÈúÄË¶Å‰ªéÂÆûÁé∞Ëøô‰∏™ÂçèËÆÆÁöÑÂØπË±°‰∏≠ÊãøÂà∞ÊâßË°åÂøÖË¶ÅÁöÑ‰ø°ÊÅØ AspectIdentifier12345678910111213141516@interface AspectIdentifier : NSObject/// ÂàõÂª∫ AspectIdentifier ÂÆû‰æã+ (instancetype)identifierWithSelector:(SEL)selector object:(id)object options:(AspectOptions)options block:(id)block error:(NSError **)error;/// ÊâßË°å hook ÁöÑÊñπÊ≥ï- (BOOL)invokeWithInfo:(id&lt;AspectInfo&gt;)info;/// hook ÁöÑ SEL@property (nonatomic, assign) SEL selector;/// ÊõøÊç¢ÂéüÊñπÊ≥ïÁöÑ block@property (nonatomic, strong) id block;/// block ÁöÑÁ≠æÂêç@property (nonatomic, strong) NSMethodSignature *blockSignature;/// hook ÁöÑÂØπË±°@property (nonatomic, weak) id object;/// hook ÁöÑÊó∂Êú∫@property (nonatomic, assign) AspectOptions options;@end AspectIdentifer ÂåÖÂê´‰∫Ü hook ÈúÄË¶ÅÁöÑÁªùÂ§ßÂ§öÊï∞‰ø°ÊÅØÔºåÈÖçÂêà AspectsInfo Â∞±ÂèØ‰ª•ÂÆûÁé∞ hook„ÄÇ AspectsContainer1234567891011121314@interface AspectsContainer : NSObject/// ‰øùÂ≠ò hook ÁöÑ‰ø°ÊÅØ- (void)addAspect:(AspectIdentifier *)aspect withOptions:(AspectOptions)injectPosition;/// ÁßªÈô§ hook- (BOOL)removeAspect:(id)aspect;/// Âà§Êñ≠ÊòØÂê¶Â≠òÂú® hook- (BOOL)hasAspects;/// ‰øùÂ≠òÂú®ÊñπÊ≥ïÊâßË°åÂâçË¶ÅÊâßË°åÁöÑ hook@property (atomic, copy) NSArray *beforeAspects;/// ‰øùÂ≠òË¶ÅÊõøÊç¢ÂéüÊñπÊ≥ïÊâßË°åÁöÑ hook@property (atomic, copy) NSArray *insteadAspects;/// ‰øùÂ≠òÂú®ÊñπÊ≥ïÊâßË°åÂêéË¶ÅÊâßË°åÁöÑ hook@property (atomic, copy) NSArray *afterAspects;@end ÊØè‰∏Ä‰∏™Ë¢´ hook ÁöÑÊñπÊ≥ï‰ºöÂØπÂ∫î‰∏Ä‰∏™ AspectsContaienr„ÄÇAspectsContainer ‰øùÂ≠ò‰∫Ü‰∏çÂêåÊó∂Êú∫Ë¶ÅÊâßË°åÁöÑ hook ‰ø°ÊÅØ AspectsIdentifier ÂÆû‰æã„ÄÇ ‰πãÂêéÊâßË°åÁöÑÊñπÊ≥ïÂà§Êñ≠Ë¶ÅÊâßË°å hook ÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÊãøÂà∞ SEL ÂØπÂ∫îÁöÑ AspectContainer ÂÆû‰æãÔºå‰ªé‰∏≠ÊãøÂá∫‰∏Ä‰∏™‰∏™ AspectsIdentifierÔºåÂÜçÁªìÂêàÈÄöËøáÊñπÊ≥ïÊâßË°åÊó∂ÊãøÂà∞ÁöÑ NSInvocation ÂÆû‰æãÂàõÂª∫ÁöÑ AspectsInfo ÂÆû‰æãÔºåËææÂà∞ÊúÄÁªà hook ÊñπÊ≥ïÁöÑÁõÆÁöÑ„ÄÇ AspectTracker1234567891011121314151617181920@interface AspectTracker : NSObject/// ÂàùÂßãÂåñÊñπÊ≥ï- (id)initWithTrackedClass:(Class)trackedClass;/// ÂØπÂ∫îÁöÑ hook ÁöÑÁ±ª@property (nonatomic, strong) Class trackedClass;/// ÂØπÂ∫îÁöÑ hook ÁöÑÁ±ªÂêç@property (nonatomic, readonly) NSString *trackedClassName;/// Á±ª‰∏≠Ë¢´ hook ÁöÑÊñπÊ≥ïÂêç@property (nonatomic, strong) NSMutableSet *selectorNames;/// ‰øùÂ≠òÊüê‰∏™ÊñπÊ≥ï‰∏é hook ËØ•ÊñπÊ≥ïÁöÑÂ≠êÁ±ªÁöÑ AspectTracker@property (nonatomic, strong) NSMutableDictionary *selectorNamesToSubclassTrackers;/// Êää selectorName ÂíåÂ≠êÁ±ªÁöÑ sAspectTracker ‰øùÂ≠òÂú® selectorNamesToSubclassTrackers Â≠óÂÖ∏‰∏≠- (void)addSubclassTracker:(AspectTracker *)subclassTracker hookingSelectorName:(NSString *)selectorName;/// Êää selectorName ÂíåÂ≠êÁ±ªÁöÑ sAspectTracker ‰ªé selectorNamesToSubclassTrackers Â≠óÂÖ∏‰∏≠ÁßªÈô§- (void)removeSubclassTracker:(AspectTracker *)subclassTracker hookingSelectorName:(NSString *)selectorName;/// Âà§Êñ≠ËØ•Á±ªÁöÑÂ≠êÁ±ªÊòØÂê¶ hook ‰∫Ü selectorName- (BOOL)subclassHasHookedSelectorName:(NSString *)selectorName;/// ÊãøÂà∞ hook ËØ• selectorName ÁöÑÂ≠êÁ±ªÁöÑ AspectTracker ÁöÑÈõÜÂêà- (NSSet *)subclassTrackersHookingSelectorName:(NSString *)selectorName;@end AspectTracker ÁöÑÁõÆÁöÑÊòØË¶Å‰øùÂ≠òÁªßÊâøÈìæ‰∏äÂØπ‰∫éÊüê‰∏™ÊñπÊ≥ïÁöÑ hook ÁöÑÊÉÖÂÜµ„ÄÇËøôÊòØ‰∏∫‰∫ÜÂú® hook ÁöÑÊó∂ÂÄôÊ†°È™åÂπ∂‰øùËØÅÂêå‰∏Ä‰∏™ÁªßÊâøÈìæ‰∏äÂè™ËÉΩÊúâ‰∏Ä‰∏™Á±ªË¢´ hook„ÄÇËá≥‰∫éËøôÊ†∑ÁöÑÁõÆÁöÑÔºåÂêéÈù¢ÂÜçÁªÜËØ¥„ÄÇ ÂÖ∂ÂÆûËøô‰∏™ÂéüÂõ†ÊàëÁñëÊÉë‰∫ÜÂæà‰πÖÔºåÁúã‰∫ÜÂæàÂ§öÊñáÁ´†Ôºå‰ΩÜÊòØÂá†‰πéÊâÄÊúâÂØπ Aspects ÁöÑÊ∫êÁ†ÅËß£ÊûêÈÉΩÊ≤°ÊúâÂØπ AspectTracker ÁöÑÊÑè‰πâËøõË°åËß£Èáä„ÄÇÂè™ÊòØÁÖßÊú¨ÂÆ£ÁßëÁöÑËØ¥ÊòéÁªßÊâøÈìæ‰∏äÂè™ËÉΩÊúâ‰∏Ä‰∏™Á±ªË¢´ hookÔºåËÄåÊ≤°ÊúâËØ¥Êòé‰∏∫‰ªÄ‰πàË¶ÅËÆæËÆ°ÊàêËøôÊ†∑„ÄÇ ÊµÅÁ®ãËøõË°å hookhook ËøáÁ®ãÊ∂âÂèäÁöÑ‰∏§‰∏™ÊñπÊ≥ïÔºå‰∏Ä‰∏™Á±ªÊñπÊ≥ïÔºå‰∏Ä‰∏™ÂÆû‰æãÊñπÊ≥ïÈÉΩÊòØÁõ¥Êé•Ë∞ÉÁî® aspect_add() ÊñπÊ≥ïÔºö 12345678910111213141516171819202122/// Ê∑ªÂä† hookstatic id aspect_add(id self, SEL selector, AspectOptions options, id block, NSError **error) &#123; __block AspectIdentifier *identifier = nil; /// ‰ΩøÁî®Ëá™ÊóãÈîÅÂåÖË£πhookËøáÁ®ã aspect_performLocked(^&#123; // ÊòØÂê¶ÂèØ‰ª• hook ÊñπÊ≥ï if (aspect_isSelectorAllowedAndTrack(self, selector, options, error)) &#123; /// ÊØè‰∏™Ë¢´ hook ÁöÑÂØπË±°‰ºöÊúâ‰∏Ä‰∏™ AspectContainer ÂÆû‰æã„ÄÇÂèñÂá∫ÂΩìÂâçÂØπË±°ÁöÑÂÖ≥ËÅîÂØπË±° AspectsContainerÔºåÂ¶ÇÊûúÊ≤°ÊúâÂ∞±ÂàõÂª∫‰∏Ä‰∏™ËøîÂõû AspectsContainer *aspectContainer = aspect_getContainerForObject(self, selector); /// ÂàõÂª∫‰∏Ä‰∏™ AspectIdentifier identifier = [AspectIdentifier identifierWithSelector:selector object:self options:options block:block error:error]; if (identifier) &#123; /// Êää aspectIdentifier Ê∑ªÂä†Âà∞ AspectsContainer ‰∏≠ [aspectContainer addAspect:identifier withOptions:options]; /// hook Á±ªÂíåÊñπÊ≥ï aspect_prepareClassAndHookSelector(self, selector, error); &#125; &#125; &#125;); return identifier;&#125; Êï¥‰∏™ËøáÁ®ãÂàÜ‰∏∫Âá†Ê≠•Ôºö Âà§Êñ≠ÊòØÂê¶ÂèØ‰ª• hook ÂàõÂª∫ AspectsContainer ÂÆû‰æã ÂàõÂª∫ AspectsIdentifier ÂÆû‰æã ÂÆûÁé∞ hook ÊñπÊ≥ï Âà§Êñ≠ÊòØÂê¶ÂèØ‰ª• hookhook ÂâçË¶ÅÂà§Êñ≠ÊòØÂê¶ÂèØ‰ª• hook„ÄÇhook ÁöÑÂéüÂàôÊúâÂá†ÁÇπÔºö Â∑≤ÁªèË¢´ hook ÁöÑÊñπÊ≥ï‰∏ç‰ºöË¢´ÈáçÂ§ç hook ‰∏çËÉΩ hook ÂåÖÂê´ retainÔºåreleaseÔºåautoreleaseÔºåforwardInvocation ÁöÑÊñπÊ≥ï hook ÊñπÊ≥ïÂè™ËÉΩÂú® dealloc ÊñπÊ≥ïÂâçÊâßË°åÔºå‰∏çËÉΩÊõøÊç¢ dealloc ÊñπÊ≥ï ‰∏çËÉΩ hook ‰∏çÂ≠òÂú®ÁöÑ selector ‰∏çËÉΩ hook ÁªßÊâøÈìæ‰∏äÂ∑≤ÁªèË¢´ hook ËøáÁöÑÂêåÂêçÊñπÊ≥ï 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495/// Ê£ÄÈ™å aspect ÊòØÂê¶ÂèØ‰ª• hook ËØ•ÊñπÊ≥ï„ÄÇ‰∏ªË¶ÅËßÑÂàôÂØπ‰∫éÁ±ªÊñπÊ≥ïÔºå‰∏Ä‰∏™ÁªßÊâøÈìæ‰∏äÁöÑÂêåÂêçÊñπÊ≥ïÂè™ËÉΩË¢´ hook ‰∏ÄÊ¨°static BOOL aspect_isSelectorAllowedAndTrack(NSObject *self, SEL selector, AspectOptions options, NSError **error) &#123; static NSSet *disallowedSelectorList; static dispatch_once_t pred; dispatch_once(&amp;pred, ^&#123; disallowedSelectorList = [NSSet setWithObjects:@"retain", @"release", @"autorelease", @"forwardInvocation:", nil]; &#125;); // Check against the blacklist. NSString *selectorName = NSStringFromSelector(selector); /// 1.ÂØπ‰∫éÂåÖÂê´ retainÔºåreleaseÔºåautoreleaseÔºåforwardInvocation ÁöÑÊñπÊ≥ïÊòØ‰∏çËÉΩË¢´ hook ÁöÑ if ([disallowedSelectorList containsObject:selectorName]) &#123; NSString *errorDescription = [NSString stringWithFormat:@"Selector %@ is blacklisted.", selectorName]; AspectError(AspectErrorSelectorBlacklisted, errorDescription); return NO; &#125; // Additional checks. AspectOptions position = options&amp;AspectPositionFilter; /// 2.Ê†°È™å hook dealloc ÊñπÊ≥ïÂè™ËÉΩÂú®‰πãÂâçÊâßË°å if ([selectorName isEqualToString:@"dealloc"] &amp;&amp; position != AspectPositionBefore) &#123; NSString *errorDesc = @"AspectPositionBefore is the only valid position when hooking dealloc."; AspectError(AspectErrorSelectorDeallocPosition, errorDesc); return NO; &#125; /// 3.Â¶ÇÊûú‰∏çÂ≠òÂú®Ëøô‰∏™ selector ÈÇ£‰πàÁõ¥Êé•Êä•Èîô if (![self respondsToSelector:selector] &amp;&amp; ![self.class instancesRespondToSelector:selector]) &#123; NSString *errorDesc = [NSString stringWithFormat:@"Unable to find selector -[%@ %@].", NSStringFromClass(self.class), selectorName]; AspectError(AspectErrorDoesNotRespondToSelector, errorDesc); return NO; &#125; // Search for the current class and the class hierarchy IF we are modifying a class object /// Â¶ÇÊûúÊòØÁ±ªÁ±ªÂûã if (class_isMetaClass(object_getClass(self))) &#123; Class klass = [self class]; NSMutableDictionary *swizzledClassesDict = aspect_getSwizzledClassesDict(); Class currentClass = [self class]; AspectTracker *tracker = swizzledClassesDict[currentClass]; /// 4.Â≠êÁ±ªÊòØÂê¶Â∑≤Áªè hook ‰∫ÜËøô‰∏™ selector„ÄÇ‰∏Ä‰∏™ÊñπÊ≥ïÂ¶ÇÊûúË¢´Â≠êÁ±ª hook Ëøá‰∫ÜÔºåÁà∂Á±ªÂ∞±‰∏çËÉΩ hook ‰∫Ü„ÄÇ if ([tracker subclassHasHookedSelectorName:selectorName]) &#123; NSSet *subclassTracker = [tracker subclassTrackersHookingSelectorName:selectorName]; NSSet *subclassNames = [subclassTracker valueForKey:@"trackedClassName"]; NSString *errorDescription = [NSString stringWithFormat:@"Error: %@ already hooked subclasses: %@. A method can only be hooked once per class hierarchy.", selectorName, subclassNames]; AspectError(AspectErrorSelectorAlreadyHookedInClassHierarchy, errorDescription); return NO; &#125; /// 5.Âà∞Áà∂Á±ª‰∏≠ÊâæÔºåÂ¶ÇÊûú‰∏Ä‰∏™ÊñπÊ≥ïÂ∑≤ÁªèÂú®Áà∂Á±ª‰∏≠ hook Ëøá‰∫ÜÔºåÈÇ£‰πàÂ∞±‰∏çËÉΩÂú®Â≠êÁ±ª‰∏≠ hook ‰∫Ü do &#123; tracker = swizzledClassesDict[currentClass]; if ([tracker.selectorNames containsObject:selectorName]) &#123; if (klass == currentClass) &#123; // Already modified and topmost! return YES; &#125; NSString *errorDescription = [NSString stringWithFormat:@"Error: %@ already hooked in %@. A method can only be hooked once per class hierarchy.", selectorName, NSStringFromClass(currentClass)]; AspectError(AspectErrorSelectorAlreadyHookedInClassHierarchy, errorDescription); return NO; &#125; &#125; while ((currentClass = class_getSuperclass(currentClass))); // Add the selector as being modified. currentClass = klass; AspectTracker *subclassTracker = nil; /// Â¶ÇÊûúËÉΩ hookÔºåÈÇ£‰πàÊääÂΩìÂâçÁöÑ AspectsTracker ÂÆû‰æãÂä†ÂÖ•Âà∞Áà∂Á±ªÁöÑ AspectTracker ÁöÑ selectorNamesToSubclassTrackers Â≠óÂÖ∏ selectorName ÂØπÂ∫îÁöÑÈõÜÂêà‰∏≠„ÄÇ /// ËøôÊ†∑Âú®‰πãÂêé hook ÁöÑÊó∂ÂÄôÂ∞±ÂèØ‰ª•Êü•ÁúãÁªßÊâøÈìæ‰∏äÊòØÂê¶ÊúâË¢´ hook Ëøá‰∫Ü do &#123; /// Â¶ÇÊûú swizzledClassesDict ‰∏≠‰∏çÂ≠òÂú®Ëøô‰∏™ trackerÔºåÈÇ£‰πàÂàõÂª∫Ëøô‰∏™ AspectTrackerÔºåÁÑ∂ÂêéÊ∑ªÂä†ËøõÂéª tracker = swizzledClassesDict[currentClass]; /// ÈÄíÂΩí‰∏∫ÊØè‰∏Ä‰∏™ÂΩìÂâçÁ±ªÁöÑÁà∂Á±ªÂàõÂª∫‰∏Ä‰∏™ AspectTracker„ÄÇ if (!tracker) &#123; tracker = [[AspectTracker alloc] initWithTrackedClass:currentClass]; swizzledClassesDict[(id&lt;NSCopying&gt;)currentClass] = tracker; &#125; // ÈÄíÂΩíÊääÂΩìÂâçÁ±ªÁöÑ AspectTracker Ê∑ªÂä†Âà∞Áà∂Á±ªÁöÑ selectorNamesToSubclassTrackers ‰∏≠ if (subclassTracker) &#123; [tracker addSubclassTracker:subclassTracker hookingSelectorName:selectorName]; &#125; else &#123; [tracker.selectorNames addObject:selectorName]; &#125; // All superclasses get marked as having a subclass that is modified. subclassTracker = tracker; /// ÈÄíÂΩíËé∑ÂèñÂΩìÂâçÁ±ªÁöÑÁà∂Á±ª &#125;while ((currentClass = class_getSuperclass(currentClass))); &#125; else &#123; // ÂÆû‰æãÂØπË±°ÈªòËÆ§ÊòØ YES // ÂÆû‰æãÂØπË±° hook ÁöÑÊñπÊ≥ïÂè™ÈíàÂØπËØ•ÂÆû‰æãÔºåÂõ†Ê≠§Ê≤°ÊúâÂêå‰∏Ä‰∏™ÁªßÊâøÈìæ‰∏äÂè™ËÉΩ hook ‰∏ÄÊ¨°ÂêåÂêçÊñπÊ≥ïÁöÑÈôêÂà∂ return YES; &#125; return YES;&#125; ÂâçÂõõ‰∏™ËßÑÂàôÈÉΩÂÆπÊòìÁêÜËß£„ÄÇÈÇ£‰πà‰∏∫‰ªÄ‰πàË¶ÅÊúâÂêå‰∏Ä‰∏™ÁªßÊâøÈìæ‰∏äÂè™ËÉΩ hook ‰∏ÄÊ¨°ÂêåÂêçÊñπÊ≥ïÔºüÊàë‰ª¨Êù•ÁúãËøôÊ†∑‰∏Ä‰∏™‰æãÂ≠êÔºö 12345678910111213141516171819202122232425262728293031@interface A : NSObject- (void)foo;@end@implementation A- (void)foo &#123; NSLog(@"%s", __PRETTY_FUNCTION__);&#125;@end@interface B : A@end@implementation B- (void)foo &#123; NSLog(@"%s", __PRETTY_FUNCTION__); [super foo];&#125;@endint main(int argc, char *argv[]) &#123; [B aspect_hookSelector:@selector(foo) atPosition:AspectPositionBefore withBlock:^(id object, NSArray *arguments) &#123; NSLog(@"before -[B foo]"); &#125;]; [A aspect_hookSelector:@selector(foo) atPosition:AspectPositionBefore withBlock:^(id object, NSArray *arguments) &#123; NSLog(@"before -[A foo]"); &#125;]; B *b = [[B alloc] init]; [b foo];&#125; Âú∫ÊôØÂæàÁÆÄÂçïÔºåÁà∂Á±ª hook ‰∫ÜÊüê‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂ≠êÁ±ª‰∏≠Ë∞ÉÁî®Áà∂Á±ªÁöÑËØ•ÊñπÊ≥ï„ÄÇÁÜüÊÇâ runtime ÁöÑÈÉΩÁü•ÈÅìÔºåË∞ÉÁî®Áà∂Á±ªÊñπÊ≥ïÊó∂ÔºåË∞ÉÁî®ËÄÖÊòØÂ≠êÁ±ªÊú¨Ë∫´ÔºåÊñπÊ≥ïÂÆûÁé∞ÊòØÊâßË°åÁà∂Á±ªÁöÑ IMP„ÄÇËøô‰∏™Êó∂ÂÄôÁî±‰∫éÁà∂Á±ªËøõË°å‰∫Ü hookÔºåIMP ÊåáÂêë msg_forwardÔºåÂõ†Ê≠§‰ºöËøõË°åÊ∂àÊÅØËΩ¨Âèë„ÄÇÊ∂àÊÅØËΩ¨ÂèëÊó∂ÔºåNSInvocation Âè™Áü•ÈÅìË∞ÉÁî®ËÄÖÊòØÂ≠êÁ±ªÔºåÂπ∂‰∏çÁü•ÈÅìÂÖ∂ÂÆûË∞ÉÁî®ÁöÑÊòØÁà∂Á±ªÊñπÊ≥ï„ÄÇÂõ†Ê≠§ÔºåËøò‰ºöÊâßË°åÂ≠êÁ±ªÊñπÊ≥ï„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂèòÊàê‰∫ÜÂ≠êÁ±ª‰∏≠ËØ•ÊñπÊ≥ïÂèàË∞ÉÁî®‰∫ÜËá™Ë∫´ÔºåËøõËÄåÂΩ¢ÊàêÊó†ÈôêÂæ™ÁéØ„ÄÇ Âõ†Ê≠§ÔºåAspects ÁöÑ‰ΩúËÄÖÁ¶ÅÊ≠¢‰∫ÜÂêå‰∏Ä‰∏™ÁªßÊâøÈìæ‰∏äÁöÑÂ§öÊ¨° hook„ÄÇÂΩìÁÑ∂ËøôÊòØ‰∏∫‰∫ÜËß£ÂÜ≥ËøôÁßçÊó†ÈôêÂæ™ÁéØÁöÑÊó†Â•à‰πã‰∏æ„ÄÇÁ¶ÅÁî®Êüê‰∫õÊìç‰Ωú‰ª•ËææÂà∞ÂÆâÂÖ®ÊÄßÔºåÂΩìÁÑ∂Ëøô‰πüÈôêÂà∂‰∫Ü‰∏Ä‰∫õÂÆûÈôÖÈúÄÊ±ÇÁöÑÂÆûÁé∞„ÄÇ JSPatch Âú®ÊâßË°åÂà∞ super ÊñπÊ≥ïÁöÑÊó∂ÂÄô‰ºöÂà§Êñ≠ super ÊñπÊ≥ïÊòØÂê¶Ë¢´ÈáçÂÜôÔºåÂ¶ÇÊûúË¢´ÈáçÂÜô‰∫ÜÈÇ£‰πàÊâßË°åÈáçÂÜôÁöÑ JS ÊñπÊ≥ï„ÄÇËÄå‰∏çÊòØÂÉè Aspects ‰∏≠ÈùûÂ∏∏Ê≠¶Êñ≠ÁöÑÂè™ÊòØ‰∏çËÆ©‰∏Ä‰∏™ÁªßÊâøÈìæ hook ‰∏ÄÊ¨°„ÄÇ ÂàõÂª∫ AspectsContainer ÂÆû‰æãÂâçÈù¢ËØ¥Âà∞ÔºåÊØè‰∏Ä‰∏™Ë¢´ hook ÁöÑÂÆû‰æãÊàñËÄÖÂØπË±°ÁöÑÊØè‰∏Ä‰∏™ÊñπÊ≥ïÈÉΩ‰ºöÊúâ‰∏Ä‰∏™ AspectsContainer ‰ª•ÂÖ≥ËÅîÂØπË±°ÁöÑÊñπÂºèÂ≠òÂÇ®„ÄÇÂç≥ÊñπÊ≥ï aspect_getContainerForObject 123456789101112static AspectsContainer *aspect_getContainerForObject(NSObject *self, SEL selector) &#123; NSCParameterAssert(self); /// Áªô SEL Â¢ûÂä† aspects_ ÂâçÁºÄ SEL aliasSelector = aspect_aliasForSelector(selector); /// ‰ªéÂΩìÂâçÁ±ªÊàñËÄÖÂØπË±°‰∏≠ÈÄöËøáÂÖ≥ËÅîÂØπË±°ÂèñÂá∫ËØ• SEL ÂØπÂ∫îÁöÑ AspectsContainer AspectsContainer *aspectContainer = objc_getAssociatedObject(self, aliasSelector); if (!aspectContainer) &#123; aspectContainer = [AspectsContainer new]; objc_setAssociatedObject(self, aliasSelector, aspectContainer, OBJC_ASSOCIATION_RETAIN); &#125; return aspectContainer;&#125; ÊñπÊ≥ïÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÂÖàÊü•ÁúãËøô‰∏™ÂØπË±°‰∏äÊúâÊ≤°ÊúâÊñπÊ≥ïÂêçÂØπÂ∫îÁöÑÂÖ≥ËÅîÂØπË±°ÔºåÊúâÂ∞±ÂèñÂá∫ÔºåÊ≤°ÊúâÂ∞±ÂàõÂª∫„ÄÇ ËøôÂ∞±ËØ¥Êòé‰∫ÜÔºåÁ±ªÂØπË±°ÂíåÂÖÉÁ±ªÂØπË±°ÈÉΩÊòØÂèØ‰ª•ËÆæÁΩÆÂÖ≥ËÅîÂØπË±°ÁöÑ ÂàõÂª∫ AspectsIdentifier ÂÆû‰æãAspectsIdentifier Â∞Ü hook ÁöÑ‰ø°ÊÅØ‰øùÂ≠òËµ∑Êù•ÔºåÂÆÉ‰ºöÂÅö‰∏§‰ª∂‰∫ãÔºö Ëé∑Âèñ block ÁöÑÁ≠æÂêç ÊØîËæÉ block ÁöÑÁ≠æÂêçÂíå hook ÁöÑÊñπÊ≥ïÁ≠æÂêçÊòØÂê¶‰∏ÄËá¥ 1234567891011121314151617181920212223/// ÂàõÂª∫‰∏Ä‰∏™ AspectIdentifier+ (instancetype)identifierWithSelector:(SEL)selector object:(id)object options:(AspectOptions)options block:(id)block error:(NSError **)error &#123; NSCParameterAssert(block); NSCParameterAssert(selector); /// ÊãøÂà∞blockÁöÑsignature NSMethodSignature *blockSignature = aspect_blockMethodSignature(block, error); // TODO: check signature compatibility, etc. /// ÊØîËæÉ block signature Âíå method signature ÊòØÂê¶‰∏ÄËá¥ if (!aspect_isCompatibleBlockSignature(blockSignature, object, selector, error)) &#123; return nil; &#125; /// ÂàõÂª∫‰∏Ä‰∏™ AspectIndentifier ËÆæÁΩÆ selector block signature options object AspectIdentifier *identifier = nil; if (blockSignature) &#123; identifier = [AspectIdentifier new]; identifier.selector = selector; identifier.block = block; identifier.blockSignature = blockSignature; identifier.options = options; identifier.object = object; // weak &#125; return identifier;&#125; Ëé∑Âèñ block Á≠æÂêçËé∑Âèñ block Á≠æÂêçÁöÑÊñπÂºèÂú® jspatch ‰∏≠ÊúâÁ±ª‰ººÁöÑÊìç‰Ωú„ÄÇÈÄöËøá block ÁöÑÂú∞ÂùÄÔºåÂèÇËÄÉ block ÁªìÊûÑ‰ΩìÁöÑÂÜÖÂ≠òÂàÜÂ∏ÉÔºåÂ∞ÜÊåáÈíàÁßªÂä®Âà∞ signature ÁöÑ‰ΩçÁΩÆ„ÄÇÂå∫Âà´Âú®‰∫é JSPatch hook ÁöÑ block ÂÖ®ÈÉΩÊòØÂÖ®Â±Ä blockÔºåÂõ†Ê≠§ block ÁªìÊûÑ‰∏≠‰∏ç‰ºöÂ≠òÂú® copy Âíå dispose ‰∏§‰∏™ÊñπÊ≥ï„ÄÇËÄå Aspects ‰∏≠ÁöÑ block ÊúâÂèØËÉΩÊòØÂ†Ü block„ÄÇÂΩìÊòØÂ†Ü block ÁöÑÊó∂ÂÄôÔºåË¶ÅÁßªÂä®‰∏§‰∏™ÊñπÊ≥ïÊåáÈíàÁöÑÂ§ßÂ∞èÔºö 12345678910111213141516171819202122232425/// Ëé∑Âèñ block ÁöÑÁ≠æÂêçstatic NSMethodSignature *aspect_blockMethodSignature(id block, NSError **error) &#123; // Êää block ËΩ¨‰∏∫ AspectBlockRef Á±ªÂûã AspectBlockRef layout = (__bridge void *)block; // Ê≤°ÊúâÁ≠æÂêç if (!(layout-&gt;flags &amp; AspectBlockFlagsHasSignature)) &#123; NSString *description = [NSString stringWithFormat:@"The block %@ doesn't contain a type signature.", block]; AspectError(AspectErrorMissingBlockSignature, description); return nil; &#125; void *desc = layout-&gt;descriptor; // ÁßªÂä®‰∏§‰∏™ int ÁöÑ‰ΩçÁΩÆ„ÄÇ desc += 2 * sizeof(unsigned long int); // Êúâ copy Âíå dispose ÂáΩÊï∞„ÄÇÈÇ£‰πà Ë¶ÅÂÜçÁßªÂä®‰∏§‰∏™ÊåáÈíàÁöÑ‰ΩçÁΩÆ„ÄÇÂ†Ü block Êúâ copy Âíå dispose ‰∏§‰∏™ÂáΩÊï∞ if (layout-&gt;flags &amp; AspectBlockFlagsHasCopyDisposeHelpers) &#123; desc += 2 * sizeof(void *); &#125; if (!desc) &#123; NSString *description = [NSString stringWithFormat:@"The block %@ doesn't has a type signature.", block]; AspectError(AspectErrorMissingBlockSignature, description); return nil; &#125; const char *signature = (*(const char **)desc); return [NSMethodSignature signatureWithObjCTypes:signature];&#125; AspectBlockRef ÁöÑÁªìÊûÑÂ¶Ç‰∏ãÔºö 1234567891011121314151617typedef struct _AspectBlock &#123; __unused Class isa; AspectBlockFlags flags; __unused int reserved; void(__unused *invoke)(struct _AspectBlock *block, ...); struct &#123; unsigned long int reserved; unsigned long int size; // requires AspectBlockFlagsHasCopyDisposeHelpers void (*copy)(void *dst, const void *src); void (*dispose)(const void *); // requires AspectBlockFlagsHasSignature const char *signature; const char *layout; &#125; * descriptor; // imported variables&#125; * AspectBlockRef; ÊØîËæÉ block ÁöÑÁ≠æÂêçÂíå hook ÁöÑÊñπÊ≥ïÁ≠æÂêç12345678910111213141516171819202122232425262728293031323334353637383940/// ÊØîËæÉ block ÂèÇÊï∞Á±ªÂûãÂíåÊñπÊ≥ïÂèÇÊï∞Á±ªÂûãÊòØÂê¶‰∏ÄËá¥static BOOL aspect_isCompatibleBlockSignature(NSMethodSignature *blockSignature, id object, SEL selector, NSError **error) &#123; BOOL signaturesMatch = YES; // Ëé∑Âèñ selector ÁöÑÁ≠æÂêç NSMethodSignature *methodSignature = [[object class] instanceMethodSignatureForSelector:selector]; if (blockSignature.numberOfArguments &gt; methodSignature.numberOfArguments) &#123; // block ÂèÇÊï∞Êï∞ÈáèÂ§ß‰∫éÊñπÊ≥ïÁöÑÂèÇÊï∞Êï∞ÈáèÂ∞±ÊòØ‰∏çÂåπÈÖç signaturesMatch = NO; &#125;else &#123; if (blockSignature.numberOfArguments &gt; 1) &#123; // Aspects ËßÑÂÆöÔºåÂ¶ÇÊûúÊúâÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ÂøÖÈ°ªÊòØ AspectInfo const char *blockType = [blockSignature getArgumentTypeAtIndex:1]; if (blockType[0] != '@') &#123; signaturesMatch = NO; &#125; &#125; // Argument 0 is self/block, argument 1 is SEL or id&lt;AspectInfo&gt;. We start comparing at argument 2. // index ‰∏∫ 0 ÁöÑÂèÇÊï∞ÊòØ self ÊàñËÄÖ blockÔºåindex ‰∏∫ 1 ÁöÑÂèÇÊï∞ÔºåÊòØ SEL ÊàñËÄÖ Aspects ËßÑÂÆöÁöÑ AspectInfo Á±ªÂûãÔºåÂõ†Ê≠§‰ªé index ‰∏∫ 2 ÁöÑÂèÇÊï∞ÂºÄÂßãÊØîËæÉ // The block can have less arguments than the method, that's ok. // ‰∏Ä‰∏™‰∏Ä‰∏™ÂèÇÊï∞ÂØπÊØî if (signaturesMatch) &#123; for (NSUInteger idx = 2; idx &lt; blockSignature.numberOfArguments; idx++) &#123; const char *methodType = [methodSignature getArgumentTypeAtIndex:idx]; const char *blockType = [blockSignature getArgumentTypeAtIndex:idx]; // Only compare parameter, not the optional type data. if (!methodType || !blockType || methodType[0] != blockType[0]) &#123; signaturesMatch = NO; break; &#125; &#125; &#125; &#125; /// ‰∏çÂåπÈÖçÁõ¥Êé•Êä•Èîô if (!signaturesMatch) &#123; NSString *description = [NSString stringWithFormat:@"Block signature %@ doesn't match %@.", blockSignature, methodSignature]; AspectError(AspectErrorIncompatibleBlockSignature, description); return NO; &#125; return YES;&#125; ÊØîËæÉ‰∏§ËÄÖÁöÑÁ≠æÂêç‰∏ªË¶ÅÊòØÊØîËæÉÂÖ•ÂèÇÁöÑÁ±ªÂûãË¶Å‰∏ÄËá¥„ÄÇblock ÂíåÊôÆÈÄöÊñπÊ≥ïÁöÑ‰∏çÂêåÂú®‰∫é block ÁöÑÁ≠æÂêç‰∏≠‰∏çÂ≠òÂú® SEL„ÄÇÊôÆÈÄöÊñπÊ≥ïÁöÑÁ≠æÂêç index ‰∏∫ 0 ÁöÑÂèÇÊï∞ÊòØË∞ÉÁî®ËÄÖÔºåÂç≥ @Ôºåindex ‰∏∫ 1 ÁöÑÂèÇÊï∞ÊòØ SELÔºåÂç≥ :ÔºåËÄå block Áî±‰∫é‰∏çÂ≠òÂú® SELÔºåÂÖ∂ index ‰∏∫ 0 ÁöÑÂèÇÊï∞ËøòÊòØË∞ÉÁî®ËÄÖÔºåÂç≥ @ÔºåËÄå index ‰∏∫ 1 ÁöÑÂèÇÊï∞Â∞±ÊòØÁúüÊ≠£ÁöÑÂèÇÊï∞‰∫Ü„ÄÇAspects ‰∏∫‰∫ÜÂ∞Ü block Á≠æÂêçÂíåÊôÆÈÄöÊñπÊ≥ïÁ≠æÂêç‰∏ÄËá¥ÔºåÊâÄ‰ª•ÂÅö‰∫ÜÈôêÂà∂ÔºåÂè™Ë¶ÅÊúâÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™‰∏ÄÂÆöÊòØ‰∏Ä‰∏™Êó†ÂÖ≥ÁöÑ AspectInfo ÂÆû‰æã„ÄÇ Âú®ÂàõÂª∫Â•Ω AspectsIdentifier ÂêéÔºåÂ∞ÜÂÆû‰æãÂ≠òÊîæÂà∞ AspectContainer ‰∏≠„ÄÇ ÂÆûÁé∞ hook ÊñπÊ≥ïhook ÊñπÊ≥ïÁöÑÁúüÊ≠£Âú∞ÊñπÂú® aspect_prepareClassAndHookSelector ÊñπÊ≥ï‰∏≠„ÄÇÂàÜ‰∏∫‰∏§Ê≠•Ôºö ÊõøÊç¢Á±ªÁöÑ forwardInvocation ÊñπÊ≥ï‰∏∫Ëá™Â∑±ÁöÑÂÆûÁé∞ ÊõøÊç¢ÊñπÊ≥ïÁöÑÂÆûÁé∞‰∏∫ _objc_msgForward 123456789101112131415161718192021222324252627/// hook ÊñπÊ≥ïÁöÑÂú∞Êñπstatic void aspect_prepareClassAndHookSelector(NSObject *self, SEL selector, NSError **error) &#123; NSCParameterAssert(selector); /// ËøîÂõû hook ÂêéÁöÑÁ±ª /// ÂÆû‰æãÂØπË±°Â∞±ËøîÂõû‰∏Ä‰∏™Êñ∞Á±ªÔºåÁ±ªÂØπË±°ÊõøÊç¢ forwardInvocation ÂêéËøîÂõûËá™Ë∫´ Class klass = aspect_hookClass(self, error); /// Ëé∑ÂèñËØ•Á±ªË¶Å hook ÁöÑÊñπÊ≥ï Method targetMethod = class_getInstanceMethod(klass, selector); IMP targetMethodIMP = method_getImplementation(targetMethod); /// Â¶ÇÊûúËØ•ÊñπÊ≥ï‰∏çÊòØÊåáÂêë _objc_msgForwardÔºåËØ¥ÊòéÊ≤°ÊúâË¢´ hook ËøáÔºåË¶Å hook ‰∏Ä‰∏ã if (!aspect_isMsgForwardIMP(targetMethodIMP)) &#123; // Make a method alias for the existing method implementation, it not already copied. /// Ëé∑ÂèñÊñπÊ≥ïÁöÑÁ≠æÂêç const char *typeEncoding = method_getTypeEncoding(targetMethod); /// Ëé∑ÂèñÊ∑ªÂä†‰∫ÜÂâçÁºÄÁöÑÊñπÊ≥ïÂêç SEL aliasSelector = aspect_aliasForSelector(selector); /// Ê∑ªÂä†ÊñπÊ≥ïÁÑ∂Âêé replace if (![klass instancesRespondToSelector:aliasSelector]) &#123; __unused BOOL addedAlias = class_addMethod(klass, aliasSelector, method_getImplementation(targetMethod), typeEncoding); NSCAssert(addedAlias, @"Original implementation for %@ is already copied to %@ on %@", NSStringFromSelector(selector), NSStringFromSelector(aliasSelector), klass); &#125; // We use forwardInvocation to hook in. class_replaceMethod(klass, selector, aspect_getMsgForwardIMP(self, selector), typeEncoding); AspectLog(@"Aspects: Installed hook for -[%@ %@].", klass, NSStringFromSelector(selector)); &#125;&#125; ÊõøÊç¢Á±ªÁöÑ forwardInvocation ÂÆûÁé∞ÊõøÊç¢Âú® aspect_hookClass ‰∏≠ÂÆûÁé∞„ÄÇËøôÊòØ‰∏Ä‰∏™ÊØîËæÉÈáçË¶Å‰πüÊØîËæÉÊúâÊäÄÂ∑ßÊÄßÁöÑÊñπÊ≥ï„ÄÇÂ¶ÇÊ≥®Èáä‰∏äÂÜôÁöÑÔºåÂØπ‰∫é hook ÂØπË±°‰∏ªË¶ÅÂå∫ÂàÜ‰∏∫‰∏âÁßçÊÉÖÂÜµÔºö hook ÁöÑÊòØÁ±ªÂØπË±°(ÂåÖÊã¨ÂÖÉÁ±ªÂØπË±°Ôºå‰ª•‰∏ãÈÉΩÁÆÄÁß∞‰∏∫Á±ªÂØπË±°) hook ÁöÑÊòØ kvo ÂØπË±° hook ÁöÑÊòØÂÆû‰æãÂØπË±° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061/// hook ÂØπË±°/// Â¶ÇÊûú‰º†ÂÖ•ÁöÑÊòØÂÆû‰æãÂØπË±°ÔºåÈÇ£‰πàÂ∞±Êñ∞Âª∫‰∏Ä‰∏™Á±ªÔºåÂπ∂ÊääÂÆû‰æãÂØπË±°ÁöÑ isa ÊåáÈíàÊåáÂêëÂÆÉ/// Â¶ÇÊûú‰º†ÂÖ•ÁöÑÊòØÁ±ªÂØπË±°ÔºåÈÇ£‰πàÂ∞±Áõ¥Êé•ÊääÁ±ªÂØπË±°ÁöÑ forwardInvocation ÊõøÊç¢Êéâ/// Â¶ÇÊûúÊòØ KVO ÂÆû‰æãÂØπË±°Ôºå‰πüÊòØÁõ¥Êé•Êää KVO ÂÆû‰æãÂØπË±°ÁöÑ forwardInvocation ÊõøÊç¢Êéâstatic Class aspect_hookClass(NSObject *self, NSError **error) &#123; NSCParameterAssert(self); /// .class ÂΩì target ÊòØ Instance ÂàôËøîÂõû ClassÔºåÂΩì target ÊòØ Class ÂàôËøîÂõûËá™Ë∫´ /// object_getClass ËøîÂõû isa ÊåáÈíàÁöÑÊåáÂêë /// ÂØπ‰∫éÂÆû‰æãÂØπË±°Ôºå.class object_getClass ËøîÂõûÁöÑÂØπË±°ÊòØ‰∏ÄÊ†∑ÁöÑ /// ÂØπ‰∫éÁ±ªÂØπË±°Ôºå.class ËøîÂõûËá™Ë∫´Ôºåobject_getClass ËøîÂõû meta class /// ‰ΩÜÊòØÂÆû‰æãÂØπË±°‰∏≠Êúâ‰∏Ä‰∏™ÁâπÊÆäÊÉÖÂÜµÔºåÂØπ‰∫é KVO ÂØπË±°Ôºå.class ËøîÂõûÁöÑÂ¶ÇÊûúÊòØ ObjectClassÔºåÈÇ£‰πà object_getClass ËøîÂõûÁöÑÂ∞±ÊòØ NSKVONotifing_ObjectClass /// ËøôÊòØÂõ†‰∏∫ÔºåKVO ÊÇÑÊÇÑÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êñ∞Á±ªÔºåÂπ∂‰∏îÈáçÂÜô‰∫Ü .class ÊñπÊ≥ï Class statedClass = self.class; Class baseClass = object_getClass(self); NSString *className = NSStringFromClass(baseClass); // Already subclassed if ([className hasSuffix:AspectsSubclassSuffix]) &#123; /// Â¶ÇÊûúÊúâ _Aspects_ ÂâçÁºÄÔºåËØ¥ÊòéÂ∑≤Áªè hook Ëøá‰∫Ü,Áõ¥Êé•ËøîÂõû class return baseClass; // We swizzle a class object, not a single object. &#125;else if (class_isMetaClass(baseClass)) &#123; /// Â¶ÇÊûúÊòØÁ±ªÊñπÊ≥ï,ÊõøÊç¢Ëøô‰∏™Á±ªÁöÑ forwardInvocation ÊñπÊ≥ïÔºåÁÑ∂ÂêéËøîÂõûËØ•Á±ª return aspect_swizzleClassInPlace((Class)self); // Probably a KVO'ed class. Swizzle in place. Also swizzle meta classes in place. &#125;else if (statedClass != baseClass) &#123; /// KVO ÂØπË±°‰πüË¶ÅÊõøÊç¢ KVO Á±ªÁöÑ forwardInvocation ÊñπÊ≥ïÔºåÁÑ∂ÂêéËøîÂõû KVO ÁöÑÁ±ª /// KVO ÂØπË±°Ë¶Å hook NSKVONotifing_ObjectClass return aspect_swizzleClassInPlace(baseClass); &#125; // Default case. Create dynamic subclass. /// ‰∏äÈù¢Â∑≤ÁªèÊääÁ±ªÂØπË±°ËøáÊª§Êéâ‰∫ÜÔºå‰∏ãÈù¢ÁöÑÈÄªËæëÈÉΩÊòØÂÆû‰æãÂØπË±°ÁöÑ /// Âä®ÊÄÅÂàõÂª∫ÂΩìÂâçÁ±ªÁöÑÂ≠êÁ±ªÔºå_Aspects_xxx const char *subclassName = [className stringByAppendingString:AspectsSubclassSuffix].UTF8String; Class subclass = objc_getClass(subclassName); if (subclass == nil) &#123; subclass = objc_allocateClassPair(baseClass, subclassName, 0); if (subclass == nil) &#123; NSString *errrorDesc = [NSString stringWithFormat:@"objc_allocateClassPair failed to allocate class %s.", subclassName]; AspectError(AspectErrorFailedToAllocateClassPair, errrorDesc); return nil; &#125; /// ÊõøÊç¢Ëøô‰∏™Â≠êÁ±ªÁöÑ forwardInvocation ÂÆûÁé∞ aspect_swizzleForwardInvocation(subclass); /// ÊõøÊç¢Êñ∞ÂàõÂª∫ÁöÑÂ≠êÁ±ªÁöÑ class ÊñπÊ≥ïÂÆûÁé∞ÔºåËøîÂõûÂéüÁ±ªË¶ÅËøîÂõûÁöÑÁ±ª aspect_hookedGetClass(subclass, statedClass); aspect_hookedGetClass(object_getClass(subclass), statedClass); /// ÂàõÂª∫Ëøô‰∏™Á±ª objc_registerClassPair(subclass); &#125; /// ËÆæÁΩÆÂΩìÂâçÂÆû‰æãÁöÑ isa ÊåáÂêëÊñ∞ÂàõÂª∫ÁöÑ class object_setClass(self, subclass); return subclass;&#125; [xxx class] ÊñπÊ≥ïÂíå object_getClass(xxx) ÁöÑÂå∫Âà´ÊòØË¶Å‰∫ÜËß£ÁöÑÔºö [xxx class] ÂΩì xxx ÊòØÂÆû‰æãÂØπË±°ÁöÑÊó∂ÂÄôËøîÂõûÁöÑÊòØÁ±ªÂØπË±°ÔºåÂΩìÊòØÁ±ªÂØπË±°ÁöÑÊó∂ÂÄôÔºåËøîÂõûÁöÑÊòØËá™Ë∫´ object_getClass(xxx) ËøîÂõûÁöÑÊòØ isa ÊåáÂêëÁöÑÂØπË±°„ÄÇ ÊâÄ‰ª• class_isMetaClass(object_getClass(self)) Â¶ÇÊûúÊòØ trueÔºåÈÇ£Â∞±ËØ¥Êòé self ÊòØÁ±ªÂØπË±°„ÄÇÁõ¥Êé•ÈÄöËøá aspect_swizzleClassInPlace ÊñπÊ≥ïÊõøÊç¢ÂÖ∂ forwardInvocation ÂÆûÁé∞„ÄÇ ÂØπ‰∫éÁ±ªÂØπË±°Êù•ËØ¥Ôºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã [xxx class] Âíå object_getClass(xxx) ËøîÂõûÁöÑÁªìÊûúÊòØ‰∏ÄËá¥ÁöÑ„ÄÇ‰ΩÜÊúâ‰∏ÄÁßçÁâπÊÆäÊÉÖÂÜµÂ∞±ÊòØ KVO ÂØπË±°ÔºåKVO ‰ºöÂä®ÊÄÅÁîüÊàê‰∏Ä‰∏™Á±ªÂûãÔºå‰ΩÜÊòØ‰ºöÈáçÂÜô‰øÆÊîπ class ÊñπÊ≥ïËøîÂõûÁöÑÁªìÊûú„ÄÇÂõ†Ê≠§Ôºå[xxx class] !== object_getClass(xxx) ÁöÑÊó∂ÂÄôÂ∞±ËØ¥ÊòéÊòØ KVO ÁîüÊàêÁöÑÂØπË±°„ÄÇKVO ÂØπË±°Ë¶Å hook NSKVONotifing_xxx ÁöÑ forwardInvocation ÊñπÊ≥ï„ÄÇ ÂâçÈù¢ÊääÁ±ªÂØπË±°ÈÉΩÊéíÈô§‰∫ÜÔºåÂè™Ââ©‰∏ãÂÆû‰æãÂØπË±° hook Êüê‰∏™ÊñπÊ≥ïÁöÑÊÉÖÂÜµ„ÄÇÈÇ£‰πàÂ¶Ç‰ΩïÊó¢‰∏çÂΩ±ÂìçÂÖ∂‰ªñÂÆû‰æãÔºåÂèàËÉΩ hook ÂÆÉÁöÑ‰∏Ä‰∏™ÁöÑÊñπÊ≥ïÂë¢ÔºüÊàë‰ª¨ÂèØ‰ª•Êã∑Ë¥ùËøô‰∏™Á±ªÂàõÂª∫‰∏Ä‰∏™Êñ∞Á±ªÔºåÁÑ∂ÂêéÂè™‰øÆÊîπËøô‰∏™Êñ∞Á±ªÁöÑËøô‰∏™ÊñπÊ≥ïÁöÑÂÆûÁé∞ÔºåÂ∞±Âíå Linux ‰∏≠ÂàõÂª∫Êñ∞ËøõÁ®ã‰∏ÄÊ†∑Ôºå‰πüÊòØÂÆûÁé∞ KVO ÁöÑÂÅöÊ≥ï„ÄÇÂØπ‰∫éÊñ∞ÂàõÂª∫ÁöÑÁ±ªÔºåÊàë‰ª¨‰øÆÊîπÂÖ∂ forwardInvocation ÊñπÊ≥ïÁöÑÊåáÂêëÔºåÂπ∂ÈÄöËøá object_setClass Â∞ÜÂΩìÂâçÂÆû‰æãÁöÑ isa ÊåáÂêëÊñ∞ÂàõÂª∫ÁöÑ class„ÄÇ ÊõøÊç¢ÊñπÊ≥ïÁöÑÂÆûÁé∞‰∏∫ _objc_msgForwardËøô‰∏ÄÊÆµÁöÑËøáÁ®ãÂú®‰∏äÈù¢ÁöÑÊ≥®Èáä‰∏≠Â∑≤ÁªèÂæàÊ∏ÖÊ•ö‰∫Ü„ÄÇ‰∏ªË¶ÅÂ∞±ÊòØÊ∑ªÂä†‰∏Ä‰∏™ÊúâÂâçÁºÄÁöÑÊñπÊ≥ïÔºåÂ∞ÜÂéüÊù•ÁöÑ IMP ÊåáÂêëÂÆÉÔºåÁÑ∂ÂêéÂ∞Ü _objc_msgForward ÊåáÂêëÂéüÊù•ÁöÑ SEL „ÄÇ Ëá≥Ê≠§Ôºåhook ÊñπÊ≥ïÂÖ®ÈÉ®ÂÆåÊàê„ÄÇ ÊâßË°åÊñπÊ≥ïÊâßË°åÊó∂‰ºöÁõ¥Êé•ËøõÂÖ•Ê∂àÊÅØËΩ¨ÂèëÊµÅÁ®ã: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465// This is a macro so we get a cleaner stack trace.#define aspect_invoke(aspects, info) \for (AspectIdentifier *aspect in aspects) &#123;\ [aspect invokeWithInfo:info];\ if (aspect.options &amp; AspectOptionAutomaticRemoval) &#123; \ aspectsToRemove = [aspectsToRemove?:@[] arrayByAddingObject:aspect]; \ &#125; \&#125;// This is the swizzled forwardInvocation: method./// msgForward ÊâßË°åÁöÑÊñπÊ≥ïstatic void __ASPECTS_ARE_BEING_CALLED__(__unsafe_unretained NSObject *self, SEL selector, NSInvocation *invocation) &#123; NSCParameterAssert(self); NSCParameterAssert(invocation); SEL originalSelector = invocation.selector; SEL aliasSelector = aspect_aliasForSelector(invocation.selector); /// invocation ÁöÑ selector ËΩ¨‰∏∫ÂéüÊñπÊ≥ï invocation.selector = aliasSelector; /// Ëé∑ÂèñËøô‰∏™ÂØπË±°ÂØπÂ∫îÁöÑ AspectsContainer AspectsContainer *objectContainer = objc_getAssociatedObject(self, aliasSelector); /// Ëé∑ÂèñËøô‰∏™ÂØπË±°ÁöÑ isa ÂØπÂ∫îÁöÑ AspectContainerÔºåÂ¶ÇÊûúÊ≤°ÊúâÂ∞±‰∏ÄÁõ¥Âà∞Áà∂Á±ªÊâæ AspectsContainer *classContainer = aspect_getContainerForClass(object_getClass(self), aliasSelector); AspectInfo *info = [[AspectInfo alloc] initWithInstance:self invocation:invocation]; NSArray *aspectsToRemove = nil; // Before hooks. /// ÊâßË°å container Áõ∏Â∫îÁîüÂëΩÂë®ÊúüÁöÑÊâÄÊúâ aspect aspect_invoke(classContainer.beforeAspects, info); aspect_invoke(objectContainer.beforeAspects, info); // Instead hooks. BOOL respondsToAlias = YES; /// Â¶ÇÊûúÊõøÊç¢Êï∞ÁªÑÂ≠òÂú®ÔºåÈÇ£‰πàÊõøÊç¢ÔºåÂê¶ÂàôÊâßË°åÂéüÊñπÊ≥ï if (objectContainer.insteadAspects.count || classContainer.insteadAspects.count) &#123; aspect_invoke(classContainer.insteadAspects, info); aspect_invoke(objectContainer.insteadAspects, info); &#125;else &#123; Class klass = object_getClass(invocation.target); do &#123; if ((respondsToAlias = [klass instancesRespondToSelector:aliasSelector])) &#123; [invocation invoke]; break; &#125; &#125;while (!respondsToAlias &amp;&amp; (klass = class_getSuperclass(klass))); &#125; // After hooks. aspect_invoke(classContainer.afterAspects, info); aspect_invoke(objectContainer.afterAspects, info); // If no hooks are installed, call original implementation (usually to throw an exception) /// Ë∞ÉÁî®ÂéüÊñπÊ≥ï if (!respondsToAlias) &#123; invocation.selector = originalSelector; SEL originalForwardInvocationSEL = NSSelectorFromString(AspectsForwardInvocationSelectorName); if ([self respondsToSelector:originalForwardInvocationSEL]) &#123; ((void( *)(id, SEL, NSInvocation *))objc_msgSend)(self, originalForwardInvocationSEL, invocation); &#125;else &#123; [self doesNotRecognizeSelector:invocation.selector]; &#125; &#125; // Remove any hooks that are queued for deregistration. [aspectsToRemove makeObjectsPerformSelector:@selector(remove)];&#125; Êï¥‰∏™ËøáÁ®ãÂ∞±ÊòØ‰ªéÂÖ≥ËÅîÂØπË±°‰∏≠ÂèñÂá∫ AspectContainer ÂÆû‰æãÔºåÁÑ∂ÂêéÊâßË°åÂÖ∂‰∏≠ÂêÑ‰∏™Êó∂Èó¥ÁÇπÁöÑÂõûË∞É„ÄÇ‰Ω†ÂèØËÉΩ‰ºöÂæàÁñëÊÉëÂÆÉËé∑ÂèñÂÖ≥ËÅîÂØπË±°ÂíåÊâßË°åÁöÑËØ≠Âè•Ôºö 123456// Ëé∑ÂèñAspectsContainer *objectContainer = objc_getAssociatedObject(self, aliasSelector);AspectsContainer *classContainer = aspect_getContainerForClass(object_getClass(self), aliasSelector);// ÊâßË°åaspect_invoke(classContainer.afterAspects, info);aspect_invoke(objectContainer.afterAspects, info); ‰∏∫‰ªÄ‰πàÊó¢Êúâ‰ªéÂØπË±°‰∏≠Ëé∑ÂèñÂÖ≥ËÅîÂØπË±°ÔºåÂèàÊúâ‰ªéÂØπË±°ÁöÑ isa ÊåáÂêë‰∏≠Ëé∑ÂèñÂÖ≥ËÅîÂØπË±°ÁöÑÊÉÖÂÜµÂë¢ÔºüÂØπ‰∫é hook Á±ªÊù•ËØ¥ÔºåÂÆû‰æãÁöÑÊâßË°åÈÉΩÂ∫îËØ•ÊòØÈÄöËøáÂêéËÄÖÔºå‰ªéÁ±ª‰∏≠Ëé∑ÂèñÁöÑ„ÄÇ‰ΩÜÊòØÂØπ‰∫é hook ÂÆû‰æãÊù•ËØ¥Ôºå‰ªñ‰ª¨ÁöÑÂÖ≥ËÅîÂØπË±°ÊòØÂ≠òÂú®ÂÆû‰æã‰∏≠ÁöÑ„ÄÇÂ¶ÇÊûúÊó¢ hook ‰∫ÜÂÆû‰æãÁöÑÊüê‰∏™ÊñπÊ≥ïÔºåÂèà hook ‰∫ÜÂÆû‰æãÊâÄÂú®ÁöÑÁ±ªÁöÑÂêå‰∏Ä‰∏™ÊñπÊ≥ïÔºåÈÇ£‰πà‰∏§‰ªΩ hook ÈÉΩÂ∫îËØ•ÊâßË°å„ÄÇ Â¶ÇÊûú hook Êó∂ÂÄô‰º†ÂÖ•ÁöÑ options ‰∏∫ AspectOptionAutomaticRemovalÔºåÈÇ£‰πà‰ºöÂú®ÊâßË°åÂÆåÊØïÂêéË∞ÉÁî® AspectIdentifier ÂÆû‰æãÁöÑ remove ÊñπÊ≥ïÁßªÈô§ hook„ÄÇ ÊñπÊ≥ïÊâßË°åËøáÁ®ãÂú® invokeWithInfo ÊñπÊ≥ï‰∏≠Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647/// ÊâßË°åËøô‰∏™ NSInvocation- (BOOL)invokeWithInfo:(id&lt;AspectInfo&gt;)info &#123; /// ÂàõÂª∫‰∏Ä‰∏™ blockInvocation NSInvocation *blockInvocation = [NSInvocation invocationWithMethodSignature:self.blockSignature]; /// ÊãøÂá∫ÂéüÂßãÁöÑ Invocation NSInvocation *originalInvocation = info.originalInvocation; NSUInteger numberOfArguments = self.blockSignature.numberOfArguments; // Be extra paranoid. We already check that on hook registration. /// Âú®ÂàõÂª∫ÁöÑÊó∂ÂÄôÂ∑≤ÁªèÊ†°È™åËøá‰∫ÜÔºåËøôÈáåÂÜçÊ†°È™å‰∏ÄÊ¨° if (numberOfArguments &gt; originalInvocation.methodSignature.numberOfArguments) &#123; AspectLogError(@"Block has too many arguments. Not calling %@", info); return NO; &#125; /// ËÆæÁΩÆblock‰∏≠ÁöÑ‰∏ä‰∏ãÊñá if (numberOfArguments &gt; 1) &#123; /// block ÊØîËæÉÁâπÊÆäÔºåËÆæÁΩÆÂÆÉÁöÑ NSInvocation Êó∂Ôºå index ‰∏∫ 0 ÁöÑ argument ‰∏∫ self, index ‰ªé 1 ÂºÄÂßãÂ∞±ÊòØÊ≠£Â∏∏ÂÖ•ÂèÇ‰∫Ü /// ÊôÆÈÄöÁöÑ NSInvocationÔºåindex ‰∏∫ 0 ÁöÑ argument ÊòØ selfÔºåindex ‰∏∫ 1 ÁöÑ argument ÊòØ SEL /// Aspects ‰∏∫‰∫ÜËÆ© block ÁöÑÂèÇÊï∞‰πü‰ªé 2 ÂºÄÂßãÔºåÈªòËÆ§Â∞ÜÂèÇÊï∞ 1 ËÆæÁΩÆ‰∏∫ AspectInfo [blockInvocation setArgument:&amp;info atIndex:1]; &#125; void *argBuf = NULL; /// ‰æùÊ¨°‰ªéÂéüÂßãÁöÑ Invocation ‰∏≠Â∞ÜÂèÇÊï∞ÂèñÂá∫ËÆæÁΩÆÂà∞ blockInvocation ‰∏≠ for (NSUInteger idx = 2; idx &lt; numberOfArguments; idx++) &#123; const char *type = [originalInvocation.methodSignature getArgumentTypeAtIndex:idx]; NSUInteger argSize; NSGetSizeAndAlignment(type, &amp;argSize, NULL); if (!(argBuf = reallocf(argBuf, argSize))) &#123; AspectLogError(@"Failed to allocate memory for block invocation."); return NO; &#125; [originalInvocation getArgument:argBuf atIndex:idx]; [blockInvocation setArgument:argBuf atIndex:idx]; &#125; /// ÊâßË°åËøô‰∏™ block [blockInvocation invokeWithTarget:self.block]; if (argBuf != NULL) &#123; free(argBuf); &#125; return YES;&#125; Âíå‰πãÂâçËé∑ÂèñÂèÇÊï∞ÁöÑÊó∂ÂÄôÁ±ª‰ººÔºåËøôÈáåÊääÂèÇÊï∞‰∏Ä‰∏™‰∏™‰ªé NSInvocation ‰∏≠ËÆæÁΩÆËøõÂéª„ÄÇÊúÄÂêéÈÄöËøá invokeWithTarget ÊâßË°å block„ÄÇ ÊÄªÁªìAspects ÁöÑÊ†∏ÂøÉÂéüÁêÜÂíå JSPatch ÊòØ‰∏ÄËá¥ÁöÑ„ÄÇÂΩìÁÑ∂ÔºåÂÆÉÊØî JSPatch ËøòÊòØÁÆÄÂçï‰∫ÜËÆ∏Â§ö„ÄÇÂ¶ÇÊûú‰Ω†ÁêÜËß£‰∫Ü JSPatch ‰∏≠Ê∂àÊÅØËΩ¨ÂèëÁöÑËøáÁ®ãÔºåAspects ÁêÜËß£Ëµ∑Êù•Â∞±ÂæàÁÆÄÂçï‰∫Ü„ÄÇ ÊÄùËÄÉÈ¢ò Â¶Ç‰Ωï hook Á±ªÊñπÊ≥ïÔºü Â¶Ç‰Ωï hook ÂÆû‰æãÂØπË±°ÁöÑÊñπÊ≥ïÔºü block ÁöÑÊñπÊ≥ïÁ≠æÂêçÂíåÊôÆÈÄöÊñπÊ≥ïÁöÑÊñπÊ≥ïÁ≠æÂêçÊúâ‰ªÄ‰πà‰∏çÂêåÔºü Â¶Ç‰ΩïÊãøÂà∞ block ÁöÑÊñπÊ≥ïÁ≠æÂêçÔºü ‰∏∫‰ªÄ‰πà Aspects ‰∏≠‰∏Ä‰∏™ÊñπÊ≥ïÂêå‰∏Ä‰∏™ÁªßÊâøÈìæ‰∏äÂè™ËÉΩ hook ‰∏ÄÊ¨°ÔºüÂèØ‰ª•ÊÄé‰πàÊîπËøõÔºü ÊÄéÊ†∑Âà§Êñ≠‰∏Ä‰∏™ÂÆû‰æãÂØπË±°ÊòØÂê¶ËøõË°åËøá kvoÔºü aspect ‰∏≠ÊÄé‰πàÂà§Êñ≠‰∏Ä‰∏™ÂØπË±°ÁöÑ forwardInvocation ÊòØÂê¶Â∑≤ÁªèË¢´ hook ËøáÔºü Â¶Ç‰ΩïÂà§Êñ≠‰∏Ä‰∏™ÂØπË±°ÊòØÁ±ªÂØπË±°ËøòÊòØÂÆû‰æãÂØπË±°Ôºü [self class] Âíå object_getClass(self) ÁöÑÂå∫Âà´ÊòØ‰ªÄ‰πàÔºü ÂÖ≥ËÅîÂØπË±°ËÉΩÂê¶‰ΩúÁî®‰∫éÁ±ªÂíåÂÖÉÁ±ªÔºü ÂèÇËÄÉÈùô‰∏ãÂøÉÊù•ËØªÊ∫êÁ†Å‰πãAspects ‰ªé Aspects Ê∫êÁ†Å‰∏≠ÊàëÂ≠¶Âà∞‰∫Ü‰ªÄ‰πàÔºü(ÂÜôÁöÑÂ§™ÁÆÄÁï•‰∫Ü)]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSPatch Ê∫êÁ†ÅËß£Êûê(‰∏â)]]></title>
    <url>%2F2019%2F08%2F11%2Fjspatch3%2F</url>
    <content type="text"><![CDATA[ËøôÊòØ JSPatch Ê∫êÁ†ÅËß£ÊûêÁöÑÁ¨¨‰∏âÈÉ®ÂàÜÔºå‰∏ªË¶ÅÂØπ‰πãÂâçÈÅóÊºèÁöÑÊñπÊ≥ïÂÅö‰∏Ä‰∫õË°•ÂÖÖÔºå‰ª•ÂèäÊèê‰æõ‰∏Ä‰∫õÊÄùËÄÉÈóÆÈ¢ò Ë°•ÂÖÖjs ÊñπÊ≥ïË°•ÂÖÖÂ∞Ü OC ÂØπË±°ËΩ¨‰∏∫ js _formatOCToJSËøô‰∏™ÊñπÊ≥ïÁî®‰∫éÂ∞Ü js Á´ØÊé•Êî∂Âà∞ÁöÑ OC ÂØπË±°ËΩ¨Êç¢‰∏∫ js ÂØπË±°Ôºö 12345678910111213141516171819202122232425262728293031323334353637383940414243/// Êää oc ËΩ¨Âåñ‰∏∫ js ÂØπË±°var _formatOCToJS = function(obj) &#123; // Â¶ÇÊûú oc Á´ØËøîÂõûÁöÑÁõ¥Êé•ÊòØ undefined ÊàñËÄÖ nullÔºåÈÇ£‰πàÁõ¥Êé•ËøîÂõû false if (obj === undefined || obj === null) return false if (typeof obj == "object") &#123; // js ‰º†Áªô oc Êó∂‰ºöÊääËá™Â∑±ÂåÖË£πÂú® __obj ‰∏≠„ÄÇÂõ†Ê≠§ÔºåÂ≠òÂú® __obj Â∞±ÂèØ‰ª•Áõ¥Êé•ÊãøÂà∞ js ÂØπË±° if (obj.__obj) return obj // Â¶ÇÊûúÊòØÁ©∫ÔºåÈÇ£‰πàÁõ¥Êé•ËøîÂõû false„ÄÇÂõ†‰∏∫Â¶ÇÊûúËøîÂõû null ÁöÑËØùÔºåÂ∞±Êó†Ê≥ïË∞ÉÁî®ÊñπÊ≥ï‰∫Ü„ÄÇ if (obj.__isNil) return false if (obj instanceof Array) &#123; // Â¶ÇÊûúÊòØÊï∞ÁªÑÔºåË¶ÅÂØπÊØè‰∏Ä‰∏™ oc ËΩ¨ js ‰∏Ä‰∏ã var ret = [] obj.forEach(function(o) &#123; ret.push(_formatOCToJS(o)) &#125;) return ret &#125; if (obj instanceof Function) &#123; return function() &#123; var args = Array.prototype.slice.call(arguments) // Â¶ÇÊûú oc ‰º†Áªô js ÁöÑÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÔºåÈÇ£‰πà js Á´ØË∞ÉÁî®ÁöÑÊó∂ÂÄôÂ∞±ÈúÄË¶ÅÂÖàÊää js ÂèÇÊï∞ËΩ¨‰∏∫ oc ÂØπË±°ÔºåË∞ÉÁî®„ÄÇ var formatedArgs = _OC_formatJSToOC(args) for (var i = 0; i &lt; args.length; i++) &#123; if (args[i] === null || args[i] === undefined || args[i] === false) &#123; formatedArgs.splice(i, 1, undefined) &#125; else if (args[i] == nsnull) &#123; formatedArgs.splice(i, 1, null) &#125; &#125; // Âú®Ë∞ÉÁî®ÂÆå oc ÊñπÊ≥ïÂêéÔºåÂèàË¶Å oc ÂØπË±°ËΩ¨‰∏∫ js ÂØπË±°Âõû‰º†Áªô oc return _OC_formatOCToJS(obj.apply(obj, formatedArgs)) &#125; &#125; if (obj instanceof Object) &#123; // Â¶ÇÊûúÊòØ‰∏Ä‰∏™ object Âπ∂‰∏îÊ≤°Êúâ __objÔºåÈÇ£‰πàÊääÊâÄÊúâÁöÑ key ÈÉΩ format ‰∏ÄÈÅç var ret = &#123;&#125; for (var key in obj) &#123; ret[key] = _formatOCToJS(obj[key]) &#125; return ret &#125; return obj&#125; ÂÖ∑‰ΩìÁöÑËøáÁ®ãÂÅö‰∫ÜËØ¶Â∞ΩÁöÑÊ≥®Èáä„ÄÇËøôÈáåËøòË¶ÅÊèê‰∏ÄÁÇπÔºåÂÖ≥‰∫éÁ©∫ÂØπË±°ÁöÑÂà§Êñ≠„ÄÇÁî±‰∫é OC ÁöÑÂä®ÊÄÅÊÄßÔºåOC ‰∏≠ÁöÑ nil ÂèëÈÄÅÊ∂àÊÅØ‰ºö‰∏çÂìçÂ∫î‰ªª‰ΩïÊñπÊ≥ï„ÄÇËÄå js Á´ØÁöÑ undefined ÊàñËÄÖ null Ë∞ÉÁî®ÊñπÊ≥ïÊó∂Âàô‰ºöÁõ¥Êé•Êä•Èîô„ÄÇ Âõ†Ê≠§Ôºå‰∏∫‰∫ÜËÉΩËÆ© js Á´ØÂú®Êé•Êî∂Âà∞ oc Á´ØÁöÑ nil ÂØπË±°Êó∂‰πüËÉΩË∞ÉÁî®ÔºåËÄå‰∏çÊä•ÈîôÔºåÈíàÂØπ undefinedÔºå null ‰ª•ÂèäÊüê‰∫õ OC ÊñπÊ≥ïÂú®ËøîÂõûÁ©∫ÂØπË±°Êó∂ÊâãÂä®ËøîÂõûÁöÑ {__isNil: true}Ôºå Ëøô‰∏™ÊñπÊ≥ïÈÉΩ‰ºöÂ∞ÜÂÖ∂Ëß£Êûê‰∏∫ bollean ÂÄº false„ÄÇ js Á´ØÁ©∫ÂØπË±°ÁöÑË∞ÉÁî®Âú®‰∏çÊä•ÈîôÂêéÔºåËøòË¶ÅÈòªÊ≠¢ÂÖ∂ÈíàÂØπ bollean ÂÄº false ÁöÑÊ∂àÊÅØËΩ¨Âèë„ÄÇÂõ†Ê≠§Ôºå‰πãÂêéÂú®ÊâßË°å __c() Ë∞ÉÁî® oc ÊñπÊ≥ïÊó∂Â∞±‰ºöÊèêÂâçÂà§Êñ≠ÊòØÂê¶ÊòØ bollean Á±ªÂûã„ÄÇÂ¶ÇÊûúÊòØÂ∞±ËØ¥ÊòéÊòØÁ©∫ÂØπË±°ÔºåÁõ¥Êé•ËøîÂõû falseÔºåËÄå‰∏çËøõË°åÊ∂àÊÅØËΩ¨Âèë„ÄÇ ÂÆö‰πâ js ‰∏≠ÁöÑÁ±ª defineJSClassdefineClass ‰ºöÂú® oc ÁîüÊàêÂØπÂ∫îÁöÑÁ±ª„ÄÇËÄå‰∏Ä‰∫õ‰∏çÈúÄË¶ÅÁªßÊâø OCÔºåÂíå OC Ê≤°ÊúâËÅîÁ≥ªÔºåÂè™‰ºöÂú® JS ‰∏≠‰ΩøÁî®ÁöÑÁ±ªÔºåÊØîÂ¶ÇÊï∞ÊçÆÂ±ÇÁöÑ dataSource/managerÔºåÁõ¥Êé•‰ΩøÁî® JSÂéüÁîüÁ±ªÂ∞±ÂèØ‰ª•„ÄÇÂõ†Ê≠§Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™ defineJSClass ÊñπÊ≥ïÔºåÂèØ‰ª•ÂáèÂ∞ëËΩ¨Âåñ‰∏∫ OC Á±ªÊó∂ÁöÑÊÄßËÉΩÊçüËÄó„ÄÇ 12345678910111213141516171819202122232425262728global.defineJSClass = function(declaration, instMethods, clsMethods) &#123; var o = function() &#123;&#125;, a = declaration.split(':'), clsName = a[0].trim(), superClsName = a[1] ? a[1].trim() : null o.prototype = &#123; init: function() &#123; if (this.super()) this.super().init() return this; &#125;, super: function() &#123; return superClsName ? _jsCls[superClsName].prototype : null &#125; &#125; var cls = &#123; alloc: function() &#123; return new o; &#125; &#125; for (var methodName in instMethods) &#123; o.prototype[methodName] = instMethods[methodName]; &#125; for (var methodName in clsMethods) &#123; cls[methodName] = clsMethods[methodName]; &#125; global[clsName] = cls _jsCls[clsName] = o&#125; ‰ª£Á†ÅÂÆûÁé∞ÂæàÁÆÄÂçïÔºåËøòÊòØÂú®ÂÖ®Â±ÄÂüü‰∏ãÂàõÂª∫‰∏Ä‰∏™Áõ∏Â∫îÁ±ªÂêçÁöÑÂØπË±°„ÄÇÁÑ∂ÂêéÊääÊâÄÊúâÁ±ªÊñπÊ≥ïÂíåÂÆû‰æãÊñπÊ≥ïÊ∑ªÂä†Ëá≥ÂØπË±°‰∏≠„ÄÇÁî±‰∫éÊòØÈÄöËøáÂéüÂûãÂÆûÁé∞ÁöÑÔºå‰∏ç‰∫ÜËß£ js ÂéüÂûãÁöÑÂêåÂ≠¶ÂèØËÉΩÁ®çÈöæÁêÜËß£„ÄÇ Ëøô‰∏™ defineJSClass ÊñπÊ≥ïÂíå defineClass ÂàõÂª∫ÁöÑÁ±ªÂØπË±°Âü∫Êú¨‰∏ÄËá¥„ÄÇ‰ΩÜÊòØÊúâ‰∏§ÁÇπ‰∏çÂêåÔºö ‰∏çÁî® self ‰ª£Êõø this„ÄÇ Ê≤°Êúâ property Áî±‰∫éÊòØÁ∫Ø js ÂÆûÁé∞ÔºåÂõ†Ê≠§‰∏çÈúÄË¶ÅÁî® self ‰ª£Êõø thisÔºå‰πü‰∏çÈúÄË¶ÅÈÄöËøáÂÖ≥ËÅîÂ±ûÊÄßÂÆö‰πâ propertyÔºåÁõ¥Êé•ÊääÂ±ûÊÄßÊîæÂú® js Á´ØÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ OC ÊñπÊ≥ïË°•ÂÖÖÂ∞Ü js ÂØπË±°ËΩ¨‰∏∫ OC ÂØπË±° formatJSToOCÈíàÂØπÂá†ÁßçÁâπÊÆäÊÉÖÂÜµÂÅöÂ§ÑÁêÜÔºåÂåÖÊã¨Á±ªÂûã‰∏∫ JPBoxing Á±ªÂûãÔºåÂåÖÂê´ __obj,__clsName,__isBlock Â≠óÊÆµÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344static id formatJSToOC(JSValue *jsval)&#123; id obj = [jsval toObject]; if (!obj || [obj isKindOfClass:[NSNull class]]) return _nilObj; // Â¶ÇÊûúÊòØ JPBoxing Á±ªÂûãÁöÑÔºåÈÇ£‰πàËß£ÂåÖ if ([obj isKindOfClass:[JPBoxing class]]) return [obj unbox]; // Â¶ÇÊûúÊòØÊï∞ÁªÑÁ±ªÂûãÁöÑÔºåÈÇ£‰πàÊääÊï∞ÁªÑÈáåÁöÑÊâÄÊúâÈÉΩ format ‰∏ÄÈÅç if ([obj isKindOfClass:[NSArray class]]) &#123; NSMutableArray *newArr = [[NSMutableArray alloc] init]; for (int i = 0; i &lt; [(NSArray*)obj count]; i ++) &#123; [newArr addObject:formatJSToOC(jsval[i])]; &#125; return newArr; &#125; // Â¶ÇÊûúÊòØÂ≠óÂÖ∏Á±ªÂûãÁöÑ if ([obj isKindOfClass:[NSDictionary class]]) &#123; // Â¶ÇÊûúÂÜÖÈÉ®Êúâ __obj Â≠óÊÆµ if (obj[@"__obj"]) &#123; // ÊãøÂà∞ __obj ÂØπÂ∫îÁöÑÂØπË±° id ocObj = [obj objectForKey:@"__obj"]; if ([ocObj isKindOfClass:[JPBoxing class]]) return [ocObj unbox]; return ocObj; &#125; else if (obj[@"__clsName"]) &#123; // Â¶ÇÊûúÂ≠òÂú® __clsName ÂØπË±°ÔºåÈÇ£‰πàÊää clsName ÂØπÂ∫îÁöÑ Class ÊãøÂá∫ return NSClassFromString(obj[@"__clsName"]); &#125; // Â¶ÇÊûúÊòØ block if (obj[@"__isBlock"]) &#123; Class JPBlockClass = NSClassFromString(@"JPBlock"); if (JPBlockClass &amp;&amp; ![jsval[@"blockObj"] isUndefined]) &#123; return [JPBlockClass performSelector:@selector(blockWithBlockObj:) withObject:[jsval[@"blockObj"] toObject]]; &#125; else &#123; return genCallbackBlock(jsval); &#125; &#125; NSMutableDictionary *newDict = [[NSMutableDictionary alloc] init]; for (NSString *key in [obj allKeys]) &#123; [newDict setObject:formatJSToOC(jsval[key]) forKey:key]; &#125; return newDict; &#125; return obj;&#125; Â∞Ü OC ÂØπË±°ËΩ¨‰∏∫ js formatOCToJSÂ∞Ü OC ÂØπË±°ËΩ¨‰∏∫ JS ÂØπË±°Ôºå‰∏∫‰∫ÜÊñπ‰æø JS Ë∞ÉÁî®ÔºåÊèêÂâçÂ∞Ü OC ÂØπË±°ÁöÑÁ±ªÂèñÂá∫Ôºå‰ª• {__obj: xxx, __clsName: xxx} ÁöÑÂΩ¢ÂºèÂåÖË£πÔºö 12345678910111213141516171819202122// Êää oc ÂØπË±°ËΩ¨‰∏∫ js ÂØπË±° ÔºàÂ¢ûÂä†‰∫Ü __obj __clsName Á≠âÂ≠óÊÆµÔºâstatic NSDictionary *_wrapObj(id obj)&#123; if (!obj || obj == _nilObj) &#123; return @&#123;@"__isNil": @(YES)&#125;; &#125; return @&#123;@"__obj": obj, @"__clsName": NSStringFromClass([obj isKindOfClass:[JPBoxing class]] ? [[((JPBoxing *)obj) unbox] class]: [obj class])&#125;;&#125;static id formatOCToJS(id obj)&#123; if ([obj isKindOfClass:[NSString class]] || [obj isKindOfClass:[NSDictionary class]] || [obj isKindOfClass:[NSArray class]] || [obj isKindOfClass:[NSDate class]]) &#123; return _autoConvert ? obj: _wrapObj([JPBoxing boxObj:obj]); &#125; if ([obj isKindOfClass:[NSNumber class]]) &#123; return _convertOCNumberToString ? [(NSNumber*)obj stringValue] : obj; &#125; if ([obj isKindOfClass:NSClassFromString(@"NSBlock")] || [obj isKindOfClass:[JSValue class]]) &#123; return obj; &#125; return _wrapObj(obj);&#125; ËøôÈáåÈÄöËøá formatOCToJS ËΩ¨Êç¢ÂêéÊòØ‰∏Ä‰∏™ÂåÖË£πÂØπË±°Ôºå‰º†Âà∞ JS Á´ØÂêéËøòÈúÄË¶ÅÈÄöËøá _formatOCToJS ÊãøÂà∞ JS ÁúüÊ≠£ÊÉ≥Ë¶ÅÁöÑ‰∏úË•ø„ÄÇ Ëé∑Âèñ protocol ‰∏≠ÁöÑÊüê‰∏™ÊñπÊ≥ïÁöÑÁ≠æÂêç methodTypesInProtocolÂèØ‰ª•ËØ¥ÊòØ‰∏Ä‰∏™ÊñπÊ≥ïÊ®°Êùø‰∫ÜÔºåÊ≤°ÊúâÁâπÂà´ÁöÑÊäÄÂ∑ßÔºö 1234567891011121314151617181920// Ëé∑Âèñ protocol ‰∏≠Áõ∏Â∫îÊñπÊ≥ïÁöÑÂáΩÊï∞Á≠æÂêçstatic char *methodTypesInProtocol(NSString *protocolName, NSString *selectorName, BOOL isInstanceMethod, BOOL isRequired)&#123; // Ëé∑Âèñ protocol Protocol *protocol = objc_getProtocol([trim(protocolName) cStringUsingEncoding:NSUTF8StringEncoding]); unsigned int selCount = 0; // Â§çÂà∂ protocol ÁöÑÊñπÊ≥ïÂàóË°® struct objc_method_description *methods = protocol_copyMethodDescriptionList(protocol, isRequired, isInstanceMethod, &amp;selCount); // ÈÅçÂéÜ protocol ÁöÑÊñπÊ≥ïÂàóË°®ÔºåÊâæÂà∞ÂíåÁõÆÊ†áÊñπÊ≥ïÂêåÂêçÁöÑÊñπÊ≥ïÔºåÁÑ∂ÂêéÈÄöËøá c ÊñπÊ≥ïÂ§çÂà∂Âá∫Êù•ËøîÂõû„ÄÇÂê¶ÂàôËøîÂõû NULL for (int i = 0; i &lt; selCount; i ++) &#123; if ([selectorName isEqualToString:NSStringFromSelector(methods[i].name)]) &#123; char *types = malloc(strlen(methods[i].types) + 1); strcpy(types, methods[i].types); free(methods); return types; &#125; &#125; free(methods); return NULL;&#125; Êñ∞Âª∫ÂçèËÆÆÂú® JS Á´ØÂÆö‰πâÂçèËÆÆÈùûÂ∏∏ÁÆÄÂçïÔºåÂíåÂàõÂª∫Á±ªÂ∑Æ‰∏çÂ§öÔºå‰º†ÂÖ•Á±ªÂêçÔºåÁ±ªÊñπÊ≥ïÂíåÂÆû‰æãÊñπÊ≥ïÔºö 1234global.defineProtocol = function(declaration, instProtos , clsProtos) &#123; var ret = _OC_defineProtocol(declaration, instProtos,clsProtos); return ret&#125; Êù•Âà∞ OC ‰∏≠ÔºåË∞ÉÁî®ÁöÑÊòØ defineProtocol ÊñπÊ≥ï„ÄÇÂä®ÊÄÅÂàõÂª∫ protocolÔºåÂêëÂÖ∂‰∏≠Ê∑ªÂä†ÊñπÊ≥ï„ÄÇ 12345678910111213// Âä®ÊÄÅÂàõÂª∫‰∏Ä‰∏™ protocolstatic void defineProtocol(NSString *protocolDeclaration, JSValue *instProtocol, JSValue *clsProtocol)&#123; const char *protocolName = [protocolDeclaration UTF8String]; // runtime Âä®ÊÄÅÂàõÂª∫‰∏Ä‰∏™ protocol Protocol* newprotocol = objc_allocateProtocol(protocolName); if (newprotocol) &#123; // ‰∏∫ÂàõÂª∫Âá∫Êù•ÁöÑ protocol Ê∑ªÂä†ÊñπÊ≥ï addGroupMethodsToProtocol(newprotocol, instProtocol, YES); addGroupMethodsToProtocol(newprotocol, clsProtocol, NO); objc_registerProtocol(newprotocol); &#125;&#125; ‰ªé JS ‰∏≠‰º†Êù•ÁöÑ Protocol ÊòØ‰∏Ä‰∏™Â≠óÂÖ∏Á±ªÂûã„ÄÇÈîÆÊòØÊñπÊ≥ïÂêçÔºåÂÄºÊòØÂèÇÊï∞ËøîÂõûÂÄºÁöÑÁ±ªÂûãÔºåÂ¶Ç‰∏ãÔºö 1234567&#123; someFunctionName: &#123; paramsType: "param1,param2,param3", returnType: "returnType", typeEncode: "v@:" &#125;&#125; Ê∑ªÂä†ÊñπÊ≥ïËøô‰∏ÄÊ≠•ÊúÄÈáçË¶ÅÁöÑÂ∞±ÊòØË¶ÅËé∑ÂèñÊñπÊ≥ïÁöÑ typeEncodeÔºåÂ¶ÇÊûúÊ≥®ÂÜåËÄÖËÉΩÂ§üÂÜôÂá∫Ê≠£Á°ÆÁöÑ typeEncode ÈÇ£‰πàÂ∞±ÂèØ‰ª•Áõ¥Êé•Ê≥®ÂÜå‰∫Ü„ÄÇ‰ΩÜÊòØÁî±‰∫é typeEncode ÂæàÂ§öÂºÄÂèëËÄÖ‰∏çËÉΩÊ≠£Á°ÆÂÜôÂá∫ÔºåÂõ†Ê≠§ÔºåÂèàÊèê‰æõ‰∏ÄÂ•ó‰øùÂ∫ïÊñπÊ°àÔºåÈÄöËøá paramsType Âíå returnType Ëß£ÊûêÂá∫Á±ªÂûãÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101// ‰∏∫ protocol Ê∑ªÂä†ÊñπÊ≥ïstatic void addGroupMethodsToProtocol(Protocol* protocol,JSValue *groupMethods,BOOL isInstance)&#123; NSDictionary *groupDic = [groupMethods toDictionary]; for (NSString *jpSelector in groupDic.allKeys) &#123; // ÊãøÂà∞‰ª£Ë°®ÊØè‰∏Ä‰∏™ÊñπÊ≥ïÁöÑÂ≠óÂÖ∏ NSDictionary *methodDict = groupDic[jpSelector]; // ‰ªéÂ≠óÂÖ∏‰∏≠ÂèñÂá∫ÂèÇÊï∞ÂàóË°® NSString *paraString = methodDict[@"paramsType"]; // ÂèñÂá∫ËøîÂõûÁ±ªÂûãÔºåÂ¶ÇÊûúÊ≤°ÊúâÂ∞±ÊòØ void NSString *returnString = methodDict[@"returnType"] &amp;&amp; [methodDict[@"returnType"] length] &gt; 0 ? methodDict[@"returnType"] : @"void"; // ÂèñÂá∫ÊñπÊ≥ïÁöÑtypeEncode NSString *typeEncode = methodDict[@"typeEncode"]; // ÂàáÂâ≤ÂèÇÊï∞ÂàóË°®ÔºåÂèÇÊï∞ÂàóË°®‰ª• ÔºåÂàÜÂâ≤ÁöÑÂ≠óÁ¨¶‰∏≤ÁöÑÂΩ¢Âºè‰º†ÈÄí NSArray *argStrArr = [paraString componentsSeparatedByString:@","]; // Ëé∑ÂèñÁúüÊ≠£ÁöÑÊñπÊ≥ïÂêç NSString *selectorName = convertJPSelectorString(jpSelector); // ‰∏∫‰∫ÜjsÁ´ØÁöÑÂÜôÊ≥ïÂ•ΩÁúãÁÇπÔºåÊú´Â∞æÁöÑÂèÇÊï∞ÂèØ‰ª•‰∏çÁî®ÂÜô `_` if ([selectorName componentsSeparatedByString:@":"].count - 1 &lt; argStrArr.count) &#123; selectorName = [selectorName stringByAppendingString:@":"]; &#125; // Â¶ÇÊûúÊúâ typeEnableÔºåÈÇ£‰πàÁõ¥Êé•Ê∑ªÂä†ÊñπÊ≥ï if (typeEncode) &#123; addMethodToProtocol(protocol, selectorName, typeEncode, isInstance); &#125; else &#123; if (!_protocolTypeEncodeDict) &#123; _protocolTypeEncodeDict = [[NSMutableDictionary alloc] init]; // Âà©Áî® # ÂÆèÔºåÊù•Â∞Ü _type Â≠óÁ¨¶‰∏≤ÂåñÔºåÈîÆÊòØ typeÔºåÂÄºÊòØ type ÁöÑ encode #define JP_DEFINE_TYPE_ENCODE_CASE(_type) \ [_protocolTypeEncodeDict setObject:[NSString stringWithUTF8String:@encode(_type)] forKey:@#_type];\ JP_DEFINE_TYPE_ENCODE_CASE(id); JP_DEFINE_TYPE_ENCODE_CASE(BOOL); JP_DEFINE_TYPE_ENCODE_CASE(int); JP_DEFINE_TYPE_ENCODE_CASE(void); JP_DEFINE_TYPE_ENCODE_CASE(char); JP_DEFINE_TYPE_ENCODE_CASE(short); JP_DEFINE_TYPE_ENCODE_CASE(unsigned short); JP_DEFINE_TYPE_ENCODE_CASE(unsigned int); JP_DEFINE_TYPE_ENCODE_CASE(long); JP_DEFINE_TYPE_ENCODE_CASE(unsigned long); JP_DEFINE_TYPE_ENCODE_CASE(long long); JP_DEFINE_TYPE_ENCODE_CASE(float); JP_DEFINE_TYPE_ENCODE_CASE(double); JP_DEFINE_TYPE_ENCODE_CASE(CGFloat); JP_DEFINE_TYPE_ENCODE_CASE(CGSize); JP_DEFINE_TYPE_ENCODE_CASE(CGRect); JP_DEFINE_TYPE_ENCODE_CASE(CGPoint); JP_DEFINE_TYPE_ENCODE_CASE(CGVector); JP_DEFINE_TYPE_ENCODE_CASE(NSRange); JP_DEFINE_TYPE_ENCODE_CASE(NSInteger); JP_DEFINE_TYPE_ENCODE_CASE(Class); JP_DEFINE_TYPE_ENCODE_CASE(SEL); JP_DEFINE_TYPE_ENCODE_CASE(void*);#if TARGET_OS_IPHONE JP_DEFINE_TYPE_ENCODE_CASE(UIEdgeInsets);#else JP_DEFINE_TYPE_ENCODE_CASE(NSEdgeInsets);#endif [_protocolTypeEncodeDict setObject:@"@?" forKey:@"block"]; [_protocolTypeEncodeDict setObject:@"^@" forKey:@"id*"]; &#125; // ËÆæÁΩÆËøîÂõûÂÄºÁöÑ encode NSString *returnEncode = _protocolTypeEncodeDict[returnString]; // ÊãºÊé•‰∏äÊâÄÊúâÁöÑ encode Êàê‰∏∫Ëøô‰∏™ÊñπÊ≥ïÁöÑ encode if (returnEncode.length &gt; 0) &#123; NSMutableString *encode = [returnEncode mutableCopy]; [encode appendString:@"@:"]; for (NSInteger i = 0; i &lt; argStrArr.count; i++) &#123; NSString *argStr = trim([argStrArr objectAtIndex:i]); NSString *argEncode = _protocolTypeEncodeDict[argStr]; if (!argEncode) &#123; NSString *argClassName = trim([argStr stringByReplacingOccurrencesOfString:@"*" withString:@""]); if (NSClassFromString(argClassName) != NULL) &#123; argEncode = @"@"; &#125; else &#123; _exceptionBlock([NSString stringWithFormat:@"unreconized type %@", argStr]); return; &#125; &#125; [encode appendString:argEncode]; &#125; // ÊãºÊé•Â•ΩÊñπÊ≥ïÁ≠æÂêçÂêéÁªô protocol Â¢ûÂä†ÊñπÊ≥ï addMethodToProtocol(protocol, selectorName, encode, isInstance); &#125; &#125; &#125;&#125;// ÁúüÊ≠£ÁöÑÊ∑ªÂä† protocol ÊñπÊ≥ïÁöÑÂú∞Êñπstatic void addMethodToProtocol(Protocol* protocol, NSString *selectorName, NSString *typeencoding, BOOL isInstance)&#123; SEL sel = NSSelectorFromString(selectorName); const char* type = [typeencoding UTF8String]; protocol_addMethodDescription(protocol, sel, type, YES, isInstance);&#125; Ëá≥Ê≠§ÔºåÂçèËÆÆÂ∞±Ê∑ªÂä†ÂÆåÊàê‰∫Ü„ÄÇ‰πãÂêéÂ∞±ÂèØ‰ª•ÁªôÁ±ªÊ∑ªÂä†Ëøô‰∏™ÂçèËÆÆ‰∫Ü„ÄÇ ÊâßË°åblockblock Êú¨Ë∫´Â∞±ÊòØÂØπË±°ÔºåÊâßË°å block ‰πüÂ∞±ÊòØÊâßË°å block ‰∏ãÁöÑÂáΩÊï∞ÊåáÈíàÊåáÂêëÁöÑÊñπÊ≥ï„ÄÇÂõ†Ê≠§Ôºåblock ‰πüÊòØÂèØ‰ª•ËøõË°åÊ∂àÊÅØËΩ¨ÂèëÁöÑ„ÄÇÂèØ‰ª•ÈÄöËøáÊõøÊç¢ forwardInvocation: ÊñπÊ≥ïÊâßË°å js ÈÉ®ÂàÜÁöÑÊñπÊ≥ï„ÄÇ js Á´ØÂÆö‰πâ blockÂΩì OC Á´ØÈúÄË¶Å js Êèê‰æõ‰∏Ä‰∏™ÂõûË∞ÉÂáΩÊï∞ÁöÑÊó∂ÂÄô„ÄÇ‰∏çËÉΩÁÆÄÂçïÁöÑÂè™ÊòØÊèê‰æõ‰∏Ä‰∏™ function„ÄÇÂØπ‰∫é OC Êù•ËØ¥ÔºåÂÆÉ‰ª¨ÈúÄË¶ÅÁü•ÈÅìÂáΩÊï∞ÁöÑ typeEncode„ÄÇÂõ†Ê≠§ÔºåJSPatch Âú® JS Á´ØÊèê‰æõ‰∫Ü‰∏Ä‰∏™ block ÊñπÊ≥ïÁªô‰ΩøÁî®ËÄÖÔºå‰ΩøÁî®ËÄÖÈúÄË¶ÅÊèêÂâçÁªôÂá∫ÂèÇÊï∞ÁöÑÁ±ªÂûãÔºö 1234567// Obj-C@implementation JPObject+ (void)request:(void(^)(NSString *content, BOOL success))callback&#123; callback(@"I'm content", YES);&#125;@end 1234// JSrequire('JPObject').request(block("NSString *, BOOL", function(ctn, succ) &#123; if (succ) log(ctn) //output: I'm content&#125;)) block ÊñπÊ≥ïÁöÑÂÆö‰πâÊñπÂºèÂ¶Ç‰∏ãÔºö 123456789101112131415global.block = function(args, cb) &#123; var that = this var slf = global.self if (args instanceof Function) &#123; cb = args args = '' &#125; var callback = function() &#123; var args = Array.prototype.slice.call(arguments) global.self = slf return cb.apply(that, _formatOCToJS(args)) &#125; var ret = &#123;args: args, cb: callback, argCount: cb.length, __isBlock: 1&#125; return ret&#125; ÂÆÉÊúÄÁªàËøîÂõûÁöÑ‰ªªÁÑ∂ÊòØ‰∏Ä‰∏™ÂØπË±°„ÄÇÂπ∂‰∏îÂú®ÂØπË±°‰∏≠Êèê‰æõ‰∫Ü‰∏Ä‰∏™Ê†áËØÜ __isBlock „ÄÇËøô‰∏™Ê†áËØÜÂú®‰πãÂâçÁöÑÊ∫êÁ†ÅËß£Êûê‰∏≠ÈÉΩÊúâÊ∂âÂèäÔºåÂè™‰∏çËøáÂΩìÊó∂ÈÉΩÁï•Ëøá‰∫Ü„ÄÇ‰∏ãÈù¢Êù•ÁúãÁúãÂì™‰∫õÂú∞ÊñπÂØπËøô‰∏™Ê†áËØÜÂÅö‰∫ÜÂà§Êñ≠Ôºå‰∏îËøõË°å‰∫ÜÂ§ÑÁêÜ„ÄÇ OC ÂÆö‰πâ blockÂú®Â∞Ü js ÂØπË±°ËΩ¨‰∏∫ OC ÂØπË±°ÁöÑÊó∂ÂÄô‰ºöË∞ÉÁî® OC ÁöÑ formatJSToOC ÊñπÊ≥ïÔºåÂÖ∂‰∏≠‰ºöÂà§Êñ≠‰º†Êù•ÁöÑÊòØÂê¶ÊòØ js ÁöÑ block„ÄÇÂ¶ÇÊûúÊòØÔºåÂàôË¶ÅÁîüÊàêÂõûË∞É blockÔºö 1234567891011121314151617// js ËΩ¨‰∏∫ oc ÁöÑÂØπË±°static id formatJSToOC(JSValue *jsval)&#123; ... // Â¶ÇÊûúÊòØ block if (obj[@"__isBlock"]) &#123; Class JPBlockClass = NSClassFromString(@"JPBlock"); if (JPBlockClass &amp;&amp; ![jsval[@"blockObj"] isUndefined]) &#123; // Ê≠§Â§ÑÊòØ JPBlock ÊãìÂ±ï return [JPBlockClass performSelector:@selector(blockWithBlockObj:) withObject:[jsval[@"blockObj"] toObject]]; &#125; else &#123; // ÁîüÊàê block return genCallbackBlock(jsval); &#125; &#125; ...&#125; ÊôÆÈÄöÁöÑ block Ëµ∞ÁöÑÊòØ genCallbackBlock ÊñπÊ≥ï„ÄÇÂÆÉ‰∏ªË¶ÅÂÅö‰∫Ü‰∫î‰ª∂‰∫ãÔºö ÂàõÂª∫Á©∫ÁöÑ block ÂÆû‰æã Ê†πÊçÆÂèÇÊï∞Á±ªÂûãÔºåÁîüÊàê block ÂáΩÊï∞ÁöÑÁ≠æÂêçÔºåÂπ∂ËÆæÁΩÆÁªôÁ©∫ block ÈÄöËøáÂÖ≥ËÅîÂØπË±°Â∞ÜÂáΩÊï∞ÂÆûÁé∞‰øùÂ≠òÂà∞Á©∫ÁöÑ block ‰∏≠ ÊõøÊç¢ NSBlock ÁöÑÂáΩÊï∞ÊåáÈíà invoke ‰∏∫ msgForwardIMP ÊõøÊç¢ NSBlock ÁöÑÊ∂àÊÅØËΩ¨ÂèëÊñπÊ≥ï forwardInvocation: ÂíåËé∑ÂèñÁ≠æÂêçÊñπÊ≥ï methodSignatureForSelector: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103static id genCallbackBlock(JSValue *jsVal)&#123; // ÂàõÂª∫Á©∫ÁöÑ block ÂÆû‰æã void (^block)(void) = ^(void)&#123;&#125;; // Êãø p ÊåáÂêëÂàöÂàöÂàõÂª∫ÁöÑ block uint8_t *p = (uint8_t *)((__bridge void *)block); // Ê†πÊçÆ block ÁöÑÂÜÖÂ≠òÂàÜÂ∏ÉÔºåÂ¢ûÂä†‰∫Ü‰∏Ä‰∏™ void* Âíå 2‰∏™ int ‰πãÂêéÔºå p ÊåáÂêëÁöÑÊòØ invoke ÊñπÊ≥ï p += sizeof(void *) + sizeof(int32_t) *2; // Êñ∞Âª∫‰∏Ä‰∏™‰∫åÁ∫ßÊåáÈíà invoke ÊåáÂêë p ÁöÑÂΩìÂâç‰ΩçÁΩÆ void(**invoke)(void) = (void (**)(void))p; // p Âú®Â¢ûÂä†‰∏Ä‰∏™ void* Âíå‰∏§‰∏™ ptr ÁöÑÂ§ßÂ∞èÔºåpÊåáÂêëÁöÑÁöÑÊòØ signature // hook ÁöÑ block ‰∏ÄÂÆöÊòØ‰∏™‰∏ç‰ΩøÁî®Â§ñÈÉ®ÂèòÈáèÁöÑÂÖ®Â±Ä blockÔºåÊâÄ‰ª•Ê≤°Êúâ copy Âíå dispose ÂáΩÊï∞„ÄÇÂõ†Ê≠§Áõ¥Êé•Êª°Ë∂≥‰∏ãÈù¢ÁöÑÂÖ¨Âºè p += sizeof(void *) + sizeof(uintptr_t) * 2; // Êñ∞Âª∫‰∏Ä‰∏™‰∫åÁ∫ßÊåáÈíà signature ÊåáÂêë p ÁöÑÂΩìÂâç‰ΩçÁΩÆ const char **signature = (const char **)p; static NSMutableDictionary *typeSignatureDict; if (!typeSignatureDict) &#123; typeSignatureDict = [NSMutableDictionary new]; // ÊääÂêÑ‰∏™Á±ªÂûãÁöÑÁ≠æÂêçÈÉΩÂ≠òÊîæÂà∞ typeSignatureDict Â≠óÂÖ∏‰∏≠ #define JP_DEFINE_TYPE_SIGNATURE(_type) \ [typeSignatureDict setObject:@[[NSString stringWithUTF8String:@encode(_type)], @(sizeof(_type))] forKey:@#_type];\ JP_DEFINE_TYPE_SIGNATURE(id); JP_DEFINE_TYPE_SIGNATURE(BOOL); JP_DEFINE_TYPE_SIGNATURE(int); JP_DEFINE_TYPE_SIGNATURE(void); JP_DEFINE_TYPE_SIGNATURE(char); JP_DEFINE_TYPE_SIGNATURE(short); JP_DEFINE_TYPE_SIGNATURE(unsigned short); JP_DEFINE_TYPE_SIGNATURE(unsigned int); JP_DEFINE_TYPE_SIGNATURE(long); JP_DEFINE_TYPE_SIGNATURE(unsigned long); JP_DEFINE_TYPE_SIGNATURE(long long); JP_DEFINE_TYPE_SIGNATURE(unsigned long long); JP_DEFINE_TYPE_SIGNATURE(float); JP_DEFINE_TYPE_SIGNATURE(double); JP_DEFINE_TYPE_SIGNATURE(bool); JP_DEFINE_TYPE_SIGNATURE(size_t); JP_DEFINE_TYPE_SIGNATURE(CGFloat); JP_DEFINE_TYPE_SIGNATURE(CGSize); JP_DEFINE_TYPE_SIGNATURE(CGRect); JP_DEFINE_TYPE_SIGNATURE(CGPoint); JP_DEFINE_TYPE_SIGNATURE(CGVector); JP_DEFINE_TYPE_SIGNATURE(NSRange); JP_DEFINE_TYPE_SIGNATURE(NSInteger); JP_DEFINE_TYPE_SIGNATURE(Class); JP_DEFINE_TYPE_SIGNATURE(SEL); JP_DEFINE_TYPE_SIGNATURE(void*); JP_DEFINE_TYPE_SIGNATURE(void *); &#125; // ÊãøÂà∞ÂàõÂª∫ block Êó∂‰º†ËøáÊù•ÁöÑÂèÇÊï∞Êï∞ÁªÑ NSString *types = [jsVal[@"args"] toString]; // ‰º†ËøáÊù•ÁöÑÂèÇÊï∞Êï∞ÁªÑ‰ª• ÔºåÂàÜÂâ≤ NSArray *lt = [types componentsSeparatedByString:@","]; // block ÁöÑÂáΩÊï∞Á≠æÂêç‰∏çÊòØ @: ËÄåÊòØ @? NSString *funcSignature = @"@?0"; NSInteger size = sizeof(void *); // for Âæ™ÁéØÔºåÊää args ‰∏≠ÁöÑÁ±ªÂûãÂØπÂ∫îÁöÑÁ≠æÂêçÈÉΩÊãøÂà∞ÔºåÁÑ∂ÂêéËÆæÁΩÆÂà∞ funcSignature ‰∏≠„ÄÇ for (NSInteger i = 1; i &lt; lt.count;) &#123; NSString *t = trim(lt[i]); NSString *tpe = typeSignatureDict[typeSignatureDict[t] ? t : @"id"][0]; if (i == 0) &#123; funcSignature =[[NSString stringWithFormat:@"%@%@",tpe, [@(size) stringValue]] stringByAppendingString:funcSignature]; break; &#125; funcSignature = [funcSignature stringByAppendingString:[NSString stringWithFormat:@"%@%@", tpe, [@(size) stringValue]]]; size += [typeSignatureDict[typeSignatureDict[t] ? t : @"id"][1] integerValue]; i = (i != lt.count - 1) ? i + 1 : 0; &#125; IMP msgForwardIMP = _objc_msgForward; // Â∞ÜÂΩìÂâç block ÁöÑÊñπÊ≥ïÂÆûÁé∞ÊåáÈíàÊåáÂêë _objc_msgForward *invoke = (void *)msgForwardIMP; const char *fs = [funcSignature UTF8String]; char *s = malloc(strlen(fs)); strcpy(s, fs); // Â∞Ü block ÁöÑÁ≠æÂêçÊåáÂêëÊñ∞ÁîüÊàêÁöÑÁ≠æÂêç *signature = s; // Â∞Ü js Á´Ø‰º†Êù•ÁöÑÂáΩÊï∞ÂÆûÁé∞‰ª• _JSValue ÁöÑÂÖ≥ËÅîÂ±ûÊÄßÁöÑÊñπÂºè‰øùÂ≠òÂú® block ‰∏≠ objc_setAssociatedObject(block, "_JSValue", jsVal, OBJC_ASSOCIATION_RETAIN_NONATOMIC); static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; // Ëé∑Âèñ NSBlock ÁöÑ class Class cls = NSClassFromString(@"NSBlock"); // Ë¶Å hook block Â∞±Ë¶ÅÊõøÊç¢ NSBlock ÁöÑ forwardInvocation Âíå methodSignatureForSelector ÊñπÊ≥ï#define JP_HOOK_METHOD(selector, func) &#123;Method method = class_getInstanceMethod([NSObject class], selector); \BOOL success = class_addMethod(cls, selector, (IMP)func, method_getTypeEncoding(method)); \if (!success) &#123; class_replaceMethod(cls, selector, (IMP)func, method_getTypeEncoding(method));&#125;&#125; JP_HOOK_METHOD(@selector(methodSignatureForSelector:), block_methodSignatureForSelector); JP_HOOK_METHOD(@selector(forwardInvocation:), JPForwardInvocation); &#125;); return block;&#125; JSPatch ‰∏≠ÁöÑ block ÁöÑÂ§ÑÁêÜÂ∫îËØ•ÊòØÂèÇËÄÉ‰∫Ü Aspects ‰∏≠ÂØπ‰∫é block ÁöÑÂ§ÑÁêÜÊñπÂºè„ÄÇÂ∞Ü block ÁöÑ IMP ÊåáÂêë objc_msgForwardÔºåÂπ∂‰∏îÊõøÊç¢‰∫Ü NSBlock ÁöÑÊ∂àÊÅØËΩ¨ÂèëÊñπÊ≥ïÔºåÊâÄÊúâÁõ∏ÂÖ≥ block ÁöÑÊâßË°åÈÉΩ‰ºöËµ∞Âà∞ JPForwardInvocation ÊñπÊ≥ï‰∏≠: 12345678static void JPForwardInvocation(__unsafe_unretained id assignSlf, SEL selector, NSInvocation *invocation)&#123; ... JSValue *jsFunc = isBlock ? objc_getAssociatedObject(assignSlf, "_JSValue")[@"cb"] : getJSFunctionInObjectHierachy(slf, JPSelectorName); ...&#125; Âà§Êñ≠Â¶ÇÊûúÊòØ‰∏Ä‰∏™ blockÔºåÂ∞±‰ªéÂÖ≥ËÅîÂ±ûÊÄß‰∏≠ÊãøÂà∞ callbackÔºåÁÑ∂ÂêéÊâßË°å„ÄÇ ÂáΩÊï∞Á≠æÂêçÁöÑËé∑ÂèñÊñπÊ≥ï methodSignatureForSelector ‰πüË¢´ÊõøÊç¢‰∏∫‰ªé NSBlock ‰∏≠Áõ¥Êé•Ëé∑ÂèñÔºö 123456NSMethodSignature *block_methodSignatureForSelector(id self, SEL _cmd, SEL aSelector) &#123; uint8_t *p = (uint8_t *)((__bridge void *)self); p += sizeof(void *) * 2 + sizeof(int32_t) *2 + sizeof(uintptr_t) * 2; const char **signature = (const char **)p; return [NSMethodSignature signatureWithObjCTypes:*signature];&#125; Âõ†‰∏∫ JSPatch ‰∏≠ÁöÑ block ÈÉΩÊòØÊ≤°ÊúâÁî®Âà∞Â§ñÈÉ®ÂèòÈáèÁöÑÔºåÊâÄ‰ª•ÊòØÂÖ®Â±Ä blockÔºå‰∏ç‰ºöÂ≠òÂú® copy Âíå dispose ÂáΩÊï∞ÔºåËøôÂíå Aspects ‰∏≠ÁöÑ‰∏çÂêåÔºåAspects ‰∏≠ÁöÑ block Êó∂ÂèØËÉΩÂºïÁî®Â§ñÈÉ®ÂèòÈáèÁöÑÔºåÂõ†Ê≠§ÈúÄË¶ÅÂ§öÂÅö‰∏ÄÊ≠•Âà§Êñ≠ÔºåÈÄöËøá block ÁöÑ flag Âà§Êñ≠ block ÁöÑÁ±ªÂûã„ÄÇ ÊÄªÁªìÂÜçÊù•ÊÄªÁªì‰∏Ä‰∏ã JSPatch ÁöÑÊâßË°åÊµÅÁ®ã„ÄÇ ÂÆö‰πâÊñπÊ≥ï ÂàõÂª∫‰∏Ä‰∏™ JSContext Âπ∂ÊääÂêÑÁßçÊñπÊ≥ïÈÄöËøá JSContext Êèê‰æõÁªô js Â∞Ü js ÈáçÂÜôÁöÑÊñπÊ≥ïÊñπÊ≥ïÈÄöËøáÊ≠£ÂàôË°®ËææÂºèÊîπÂÜô‰∏∫ __c() ÁöÑÂΩ¢Âºè È¢ÑÂ§ÑÁêÜÊèê‰æõÁªô OC Ë∞ÉÁî®ÁöÑÂêÑ‰∏™ÊñπÊ≥ïÔºåhookÊØè‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂ∞ÜÊñπÊ≥ïÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÂèñÂá∫ÔºåÂπ∂ËµãÁªô global.self„ÄÇËøôÂ∞±ÊòØ OC Ë∞ÉÁî®Êèê‰æõÁöÑ‰∏ä‰∏ãÊñá„ÄÇOC Â∞Ü‰ºöÊääËøô‰∫õÊñπÊ≥ï‰øùÂ≠òÂú® _JSOverideMethods Â≠óÂÖ∏‰∏≠ È¢ÑÂ§ÑÁêÜÊèê‰æõÁªô OC Ë∞ÉÁî®ÁöÑÂêÑ‰∏™ÊñπÊ≥ïÔºåhookÊØè‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂ∞Ü this ËµãÁªô global.self „ÄÇËøôÂ∞±ÊòØ JS Ë∞ÉÁî®Êó∂ÁöÑ‰∏ä‰∏ãÊñá„ÄÇJS ‰ºöÊääËøô‰∫õÊñπÊ≥ï‰øùÂ≠òÂú® _ocCls ‰∏≠ OC Á´ØËß£Êûê js ‰º†Êù•ÁöÑÁ±ªÂíåÊñπÊ≥ïÔºåÂ∞ÜÊñπÊ≥ïÂÆûÁé∞ÊõøÊç¢‰∏∫ _objc_msgForwardÔºåÊõøÊç¢ÂÆö‰πâÁ±ªÁöÑÊ∂àÊÅØËΩ¨ÂèëÊñπÊ≥ï‰∏∫ JPForwardInvocation: ÊâßË°åÊñπÊ≥ïÂàÜ‰∏∫‰∏§ÁßçÊÉÖÂÜµÔºö js Ë∞ÉÁî® js ÈáçÂÜôÁöÑÊñπÊ≥ï„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂú® _ocCls Â≠óÂÖ∏‰∏≠ÊâæÂà∞Áõ∏Â∫îÁöÑÊñπÊ≥ïÁõ¥Êé•ÊâßË°å oc Ë∞ÉÁî® js ÈáçÂÜôÁöÑÊñπÊ≥ï„ÄÇÂàÜ‰∏∫‰∏§Ê≠•Ôºö oc Ë∞ÉÁî®ÊñπÊ≥ïÔºå‰∏ªË¶ÅÊòØÂàõÂª∫ NSInvocationÔºåÂπ∂Ê†πÊçÆ SEL ÁöÑÂáΩÊï∞ÂáΩÊï∞Á≠æÂêçÂ∞Ü js ‰º†Êù•ÁöÑÂèÇÊï∞Ê†πÊçÆÁ±ªÂûãËÆæÁΩÆÂà∞ NSInvocation ‰∏ä„ÄÇÁÑ∂ÂêéÊâßË°å Êù•Âà∞ JPForwardInvocation ÂÆûÈôÖÊâßË°åÊñπÊ≥ïÔºåÂú® _JSOverideMethods ‰∏≠ÊâæÂà∞ÂØπÂ∫îÁöÑ js ÂÆûÁé∞ÔºåÂ¶ÇÊûúÊ≤°ÊúâËµ∞ÂéüÂßãÁöÑÊ∂àÊÅØËΩ¨Âèë„ÄÇÂ∞ÜÁªìÊûúËÆæÁΩÆÂà∞ NSInvocation ÁöÑ returnValue ‰∏≠ ÊÄùËÄÉÈ¢ò require(xxx) ÂÅö‰∫Ü‰ªÄ‰πàÔºü JS ‰∏≠ÁöÑÈìæÂºèË∞ÉÁî®Êó∂Â¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü JS Á´ØÂíå OC Á´ØÂ¶Ç‰ΩïÈÄö‰ø°ÁöÑÔºü JS Á´ØÂ¶Ç‰ΩïË∞ÉÁî® OC ÁöÑÊüê‰∏™ÂØπË±°ÁöÑÂÆû‰æãÊñπÊ≥ïÔºü OC Á´ØÊãøÂà∞ JS ‰º†Êù•ÁöÑÂØπË±°ÊñπÊ≥ïÂêçÂèÇÊï∞‰πãÂêéË¶ÅÂ¶Ç‰ΩïË∞ÉÁî®Ôºü Â¶Ç‰ΩïÂÆûÁé∞ÊñπÊ≥ïÊõøÊç¢Ôºü ‰∏∫‰ªÄ‰πàJSÁ´ØÊñ∞Â¢ûÊñπÊ≥ïË¶ÅÂú® OC ‰∏≠ class_addMethod() ÂÜçËµ∞‰∏ÄÈÅçÂÆåÊï¥ËΩ¨ÂèëÊµÅÁ®ãÔºåËÄå‰∏çÊòØÁõ¥Êé•ÈÄöËøáÊ∂àÊÅØËΩ¨ÂèëÔºü Â¶Ç‰ΩïÁªôÁ±ªÊ∑ªÂä†Â±ûÊÄßÔºü self ÂÖ≥ÈîÆÂ≠óÂ¶Ç‰ΩïÂ§ÑÁêÜÔºü OC ‰∏≠Êó†Ê≥ïÂä®ÊÄÅËé∑Âèñ superÔºåÈÇ£‰πà super ÊñπÊ≥ïÂ¶Ç‰ΩïË∞ÉÁî®ÁöÑÔºü JSBoxing ÁöÑ‰ΩúÁî®ÊòØ‰ªÄ‰πàÔºü OC ‰∏≠ÁöÑ nil Âà∞ JS ‰∏≠Â∞±ÂèòÊàê‰∫Ü nullÔºåÂ∞±Êó†Ê≥ïÈìæÂºèË∞ÉÁî®ÔºåÈÇ£‰πàË¶ÅÊÄé‰πàËß£ÂÜ≥Ôºü JS Â¶Ç‰ΩïÊîØÊåÅËá™ÂÆö‰πâ struct ÁöÑÔºü ÂèØÂèòÂèÇÊï∞ÊñπÊ≥ïÂ¶Ç‰ΩïË∞ÉÁî®Ôºü dealloc hook ÁöÑÊó∂ÂÄôÂÅö‰∫ÜÂì™‰∫õÁâπÊÆäÂ§ÑÁêÜÔºü JS Á´ØÈáçÂÜôÁöÑÊñπÊ≥ïË∞ÉÁî®Âè¶‰∏Ä‰∏™ JS Á´ØÈáçÂÜôÁöÑÊñπÊ≥ïÔºåÂ¶Ç‰ΩïÂÅöÂà∞‰∏çÁî® JS -&gt; OC -&gt; JS ËøôÊ†∑Âë®ËΩ¨Ôºü defineJSClass ‰ΩúÁî®ÊòØ‰ªÄ‰πàÔºüÂÆûÁé∞ÂéüÁêÜÊòØÊÄé‰πàÊ†∑ÁöÑÔºü Â¶Ç‰Ωï hook Â∏¶Êúâ block ÁöÑ OC ÊñπÊ≥ïÔºü JS ÊñπÊ≥ï‰∏≠Â¶Ç‰ΩïË∞ÉÁî® C ÂáΩÊï∞Ôºü ÂèÇËÄÉÈìæÊé•iOS ÁÉ≠Êõ¥Êñ∞Ëß£ËØªÔºà‰∫åÔºâ‚Äî‚Äî JSPatch Ê∫êÁ†ÅËß£Êûê JSPatch ÂÆûÁé∞ÂéüÁêÜËØ¶Ëß£Á≥ªÂàó Êé¢Á©∂Block‰πãMethodSignature(ÊñáÁ´†‰∏≠ÂÖ≥‰∫é block ÊñπÊ≥ïÁ≠æÂêçÂ§ÑÊúâÁªìËÆ∫ÊÄßÁöÑÈîôËØØÔºåÂ†Ü block ‰∏≠Âê´Êúâ copy Âíå dispose ÊñπÊ≥ïÔºåËÄåÂÖ®Â±Ä block Ê≤°ÊúâËøô‰∏§‰∏™ÊñπÊ≥ïÔºåÂÆÉÁöÑÈ™åËØÅËØïÈ™åÁöÑÁªìËÆ∫‰πüÊòØÈîôÁöÑ„ÄÇ)]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSPatch Ê∫êÁ†ÅËß£Êûê(‰∫å)]]></title>
    <url>%2F2019%2F08%2F08%2Fjspatch2%2F</url>
    <content type="text"><![CDATA[ËøôÊòØ JSPatch Ê∫êÁ†ÅËß£ÊûêÁöÑÁ¨¨‰∫åÈÉ®ÂàÜ„ÄÇ‰∏ªË¶ÅËß£Èáä JS ‰∏é OC ÁöÑÁõ∏‰∫íË∞ÉÁî® ÊâßË°åÊµÅÁ®ãjs Á´ØË∞ÉÁî®ÂâçÈù¢ËØ¥ËøáÔºåÊâÄÊúâ js ‰∏≠ÂÆö‰πâÁöÑÊñπÊ≥ïË∞ÉÁî®ÈÉΩ‰ºöË¢´È¢ÑÂ§ÑÁêÜÊõøÊç¢‰∏∫ __c() ÁöÑÂΩ¢Âºè„ÄÇËøôÊòØÊñπÊ≥ïË∞ÉÁî®ÁöÑËµ∑ÁÇπ„ÄÇ‰∏ªË¶ÅÈÄªËæëÂ¶Ç‰∏ãÔºö Âà§Êñ≠Ë∞ÉÁî®ËÄÖÊòØÂê¶ÊòØ bool Á±ªÂûãÔºåÊòØÁöÑËØùÁõ¥Êé•ËøîÂõû false Â¶ÇÊûúË∞ÉÁî®ÁöÑÊñπÊ≥ïÊòØÈáçÂÜôÁöÑÊñπÊ≥ïÔºåÈÇ£‰πàÁªëÂÆö‰∏ä‰∏ãÊñá Â¶ÇÊûúË∞ÉÁî®ÁöÑÊòØÁà∂Á±ªÊñπÊ≥ïÔºåÈÇ£‰πàÂ∞Ü __clsName ËÆæÁΩÆ‰∏∫Áà∂Á±ªÊñπÊ≥ïÂêçÔºå‰ªé __ocCls Êï∞ÁªÑ‰∏≠ÂèñÂá∫Áà∂Á±ªÁöÑÊñπÊ≥ïË∞ÉÁî®„ÄÇ Â¶ÇÊûúË∞ÉÁî®ÁöÑÊñπÊ≥ï‰∏çÊòØ js ÂÆö‰πâÁöÑÊñπÊ≥ïÈÇ£‰πàËµ∞Âà∞ oc Ë∞ÉÁî® Á¨¨‰∏ÄÊ≠•Âà§Êñ≠ÊòØÂê¶ÊòØ bool Á±ªÂûãÁöÑÂéüÂõ†Âú®‰∏ãÈù¢ÁöÑÊ≥®Èáä‰∏≠ÊúâÁªÜËØ¥Ôºå‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜËÉΩËÆ© js ‰ª£Á†ÅÂú® oc ËøîÂõûÁöÑÂØπË±°ÊòØ nil ÁöÑÊÉÖÂÜµ‰∏ã‰πüËÉΩË∞ÉÁî®Ôºå‰∏çÊä•Èîô„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839/// Ë∞ÉÁî® native Áõ∏Â∫îÁöÑÊñπÊ≥ï__c: function(methodName) &#123; var slf = this // Â¶ÇÊûú oc ËøîÂõû‰∫Ü‰∏Ä‰∏™Á©∫ÂØπË±°ÔºåÂú® js Á´Ø‰ºö‰ª• false ÁöÑÂΩ¢ÂºèÊé•Âèó„ÄÇÂΩìËøô‰∏™Á©∫ÂØπË±°ÂÜçË∞ÉÁî®ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöËµ∞Âà∞Ëøô‰∏™ÂàÜÊîØ‰∏≠ÔºåÁõ¥Êé•ËøîÂõû falseÔºåËÄå‰∏ç‰ºöËµ∞ oc ÁöÑÊ∂àÊÅØËΩ¨Âèë if (slf instanceof Boolean) &#123; return function() &#123; return false &#125; &#125; if (slf[methodName]) &#123; return slf[methodName].bind(slf); &#125; if (!slf.__obj &amp;&amp; !slf.__clsName) &#123; throw new Error(slf + '.' + methodName + ' is undefined') &#125; /// Â¶ÇÊûúÂΩìÂâçË∞ÉÁî®ÁöÑÁà∂Á±ªÁöÑÊñπÊ≥ïÔºåÈÇ£‰πàÈÄöËøá OC ÊñπÊ≥ïËé∑ÂèñËØ• clsName ÁöÑÁà∂Á±ªÁöÑÂêçÂ≠ó if (slf.__isSuper &amp;&amp; slf.__clsName) &#123; slf.__clsName = _OC_superClsName(slf.__obj.__realClsName ? slf.__obj.__realClsName: slf.__clsName); &#125; var clsName = slf.__clsName if (clsName &amp;&amp; _ocCls[clsName]) &#123; /// Ê†πÊçÆ __obj Â≠óÊÆµÂà§Êñ≠ÊòØÂê¶ÊòØÂÆû‰æãÊñπÊ≥ïÊàñËÄÖÁ±ªÊñπÊ≥ï var methodType = slf.__obj ? 'instMethods': 'clsMethods' /// Â¶ÇÊûúÂΩìÂâçÊñπÊ≥ïÊòØÊèêÂâçÂÆö‰πâÁöÑÊñπÊ≥ïÔºåÈÇ£‰πàÁõ¥Êé•Ëµ∞ÂÆö‰πâÊñπÊ≥ïÁöÑË∞ÉÁî® if (_ocCls[clsName][methodType][methodName]) &#123; slf.__isSuper = 0; return _ocCls[clsName][methodType][methodName].bind(slf) &#125; &#125; /// ÂΩìÂâçÊñπÊ≥ï‰∏çÊòØÂú® js ‰∏≠ÂÆö‰πâÁöÑÔºåÈÇ£‰πàÁõ¥Êé•Ë∞ÉÁî® oc ÁöÑÊñπÊ≥ï return function()&#123; var args = Array.prototype.slice.call(arguments) return _methodFunc(slf.__obj, slf.__clsName, methodName, args, slf.__isSuper) &#125;&#125; __realClsName Âíå __clsName ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊòØÁõ∏Á≠âÁöÑÔºå‰ΩÜÊòØÂ¶ÇÊûúË¶ÅË∞ÉÁî®ÁöÑÊòØÁà∂Á±ªÁöÑÊñπÊ≥ïÔºåÈÇ£‰πà __clsName ‰ºöË¢´ÊõøÊç¢‰∏∫Áà∂Á±ªÂêçÔºåËÄåÂ≠êÁ±ªÂêç‰ªçÁÑ∂ÊòØ __realClsName Ë∞ÉÁî® oc ÊñπÊ≥ïÈÄöËøá _methodFunc ÊâßË°åÔºö 1234567891011121314151617181920/// ÊâßË°å js ÊñπÊ≥ï, ËøîÂõû js ÂØπË±°// ÊääË¶ÅË∞ÉÁî®ÁöÑÊñπÊ≥ïÂêçÁ±ªÂêçÔºåÂèÇÊï∞‰º†ÈÄíÁªô ocvar _methodFunc = function(instance, clsName, methodName, args, isSuper, isPerformSelector) &#123; var selectorName = methodName // js Á´ØÁöÑÊñπÊ≥ïÈÉΩÊòØ xxx_xxx ÁöÑÂΩ¢ÂºèÔºåËÄå oc Á´ØÁöÑÊñπÊ≥ïÂ∑≤ÁªèÂú® defineClass ÁöÑÊó∂ÂÄôËΩ¨‰∏∫‰∫Ü xxx:xxx: ÁöÑÂΩ¢Âºè„ÄÇÊâÄ‰ª•‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã js Ë∞ÉÁî® oc ÊñπÊ≥ïÁöÑÊó∂ÂÄôÈÉΩÈúÄË¶ÅÂÖàÊääÊñπÊ≥ïÂêçËΩ¨Êç¢‰∏Ä‰∏ã„ÄÇ‰πüÂ∞±ÊòØÂΩì isPerformSelector ‰∏∫ false ÁöÑÊÉÖÂÜµ„ÄÇ // ÈÇ£‰πà‰ªÄ‰πàÊó∂ÂÄôËøô‰∏™Â±ûÊÄß‰∏∫ true Âë¢ÔºüÂΩì js Á´ØË∞ÉÁî® performSelector Ëøô‰∏™ÁöÑÊñπÊ≥ïÁöÑÊó∂ÂÄô„ÄÇËøô‰∏™ÊñπÊ≥ïÈªòËÆ§ÈúÄË¶Å‰º†ÂÖ• xxx:xxx: ÂΩ¢ÂºèÁöÑ OC selector Âêç„ÄÇ // ‰∏ÄËà¨ performSelector Áî®‰∫é‰ªé oc Á´ØÂä®ÊÄÅ‰º†Êù• selectorName ÈúÄË¶Å js ÊâßË°åÁöÑÊó∂ÂÄô„ÄÇÊ≤°ÊúâÂ§™Â§öÁöÑ‰ΩøÁî®Âú∫ÊôØ if (!isPerformSelector) &#123; methodName = methodName.replace(/__/g, "-") selectorName = methodName.replace(/_/g, ":").replace(/-/g, "_") var marchArr = selectorName.match(/:/g) var numOfArgs = marchArr ? marchArr.length : 0 if (args.length &gt; numOfArgs) &#123; selectorName += ":" &#125; &#125; var ret = instance ? _OC_callI(instance, selectorName, args, isSuper): _OC_callC(clsName, selectorName, args) return _formatOCToJS(ret)&#125; Áî±‰∫é OC Á´ØÁöÑÂèÇÊï∞ÈÉΩÂú® defineClass ÁöÑÊó∂ÂÄôÂÅö‰∫ÜÂ§ÑÁêÜÔºå‰ªé xxx_xxx Âèò‰∏∫‰∫Ü xxx:xxx:Ôºåjs Á´ØÂàôÊ≤°ÊúâÂÅö‰ªª‰ΩïÂ§ÑÁêÜ‰ªçÁÑ∂ÊòØ xxx_xxx„ÄÇÂõ†Ê≠§ÔºåÂ∞±ÈúÄË¶ÅÂú®Ë∞ÉÁî®ÂâçÂ∞ÜÊñπÊ≥ïÂêçËøõË°å‰øÆÊîπ„ÄÇÊúÄÁªàÊ†πÊçÆÊòØÂê¶ÊòØÁ±ªÊñπÊ≥ïÊù•ÂÜ≥ÂÆöË∞ÉÁî® _OC_callI ËøòÊòØ _OC_callC„ÄÇ OC Á´ØÊâßË°åOC Á´ØÊâßË°åÊ∂âÂèäÂà∞ÁöÑÂá†‰∏™ÊñπÊ≥ïÊòØ JSPatch ÊúÄÈáçË¶ÅÁöÑÂá†‰∏™ÊñπÊ≥ï‰∫Ü„ÄÇÊ∂âÂèäÂà∞ÊñπÊ≥ïÁöÑË∞ÉÁî®ÔºåÊñπÊ≥ïÁ≠æÂêçÁöÑËé∑ÂèñÔºåÊñπÊ≥ïÁöÑÊ∂àÊÅØËΩ¨Âèë OC ÊâßË°åÊñπÊ≥ïjs Á´ØË∞ÉÁî® _OC_callI ÊàñËÄÖ _OC_callC ‰πãÂêéÈÉΩ‰ºöÊù•Âà∞ OC ÁöÑ callSelector() ÊñπÊ≥ï‰∏≠„ÄÇ ÁâπÊÆäÊÉÖÂÜµÂ§ÑÁêÜ Â§ÑÁêÜË∞ÉÁî®Áà∂Á±ªÊñπÊ≥ï ÂàõÂª∫ NSInvocation Â§ÑÁêÜÂèØÂèòÂèÇÊï∞ÊñπÊ≥ï ËÆæÁΩÆ NSInvocation ÂèÇÊï∞ ÊâßË°åÂπ∂ËøîÂõûÁªìÊûúÁªô js Â§ÑÁêÜÁâπÊÆäÊÉÖÂÜµËøô‰∏ÄÊ≠•‰∏ªË¶ÅÂåÖÂê´‰∏§ÁßçÁâπÊÆäÊÉÖÂÜµÔºö ÊâßË°åÊñπÊ≥ïÁöÑÊòØÂÆû‰æãÂØπË±°ËøòÊòØÁ±ªËøòÊòØÁ©∫ÂØπË±° ÊâßË°åÁöÑÊñπÊ≥ïÊòØ toJS ÊñπÊ≥ï Ë∞ÉÁî® formatJSToOC ÊñπÊ≥ïÔºåÊääË∞ÉÁî®ËÄÖÂíåÂèÇÊï∞ÈÉΩËΩ¨‰∏∫ OC ÁöÑÂØπË±°ÔºåËøô‰∏™ÊñπÊ≥ïËøûÂêåÂêéÈù¢Â∞ÜOCÁªìÊûúËΩ¨JSÁöÑÊñπÊ≥ï formatOCToJS ‰ºöÂú®ÂêéÈù¢ÂçïÁã¨ËØ¥„ÄÇ È¶ñÂÖàÂà§Êñ≠ JS ‰º†Êù•ÁöÑË∞ÉÁî®ËÄÖÁöÑÁ±ªÂûã„ÄÇÂ¶ÇÊûú class_isMetaClass ÂæóÂà∞ÁöÑÊòØ trueÔºåÂ∞±Ë°®Á§∫ÊòØ‰∏Ä‰∏™Á±ªÂØπË±°„ÄÇÂ¶ÇÊûúÊòØ Bool Á±ªÂûãÔºåÊàñËÄÖÊòØ _nilObj ÈÇ£‰πàÁõ¥Êé•ËøîÂõû {isNil: true} ËøôÊ†∑ÔºåJS Á´ØÂ∞±Áü•ÈÅìÊòØÁ©∫ÂØπË±°‰∫Ü„ÄÇ ‰πãÂêéÂà§Êñ≠Ë∞ÉÁî®ÊñπÊ≥ïÊòØÂê¶ÊòØ toJS„ÄÇËøô‰∏™ÊñπÊ≥ïÁî®Êù•Â∞Ü OC ÂØπË±°ËΩ¨‰∏∫ÂΩ¢Â¶Ç {__obj: xxx, clsName: xxx} ÁöÑ js ÂØπË±°ËøîÂõû„ÄÇ 1234567891011121314151617181920212223242526272829static id callSelector(NSString *className, NSString *selectorName, JSValue *arguments, JSValue *instance, BOOL isSuper)&#123; // realClsName ÊòØÁúüÊ≠£Ë¶ÅË∞ÉÁî®ÁöÑÁ±ªÔºåÂíå clsName ÁöÑÂå∫Âà´Âú®‰∫éÂ¶ÇÊûúË¶ÅË∞ÉÁî®ÁöÑÊñπÊ≥ïÊòØÁà∂Á±ªÊñπÊ≥ïÔºåÈÇ£‰πà clsName ‰ºöÂèò‰∏∫Áà∂Á±ªÂêçÔºåËÄå realClsName ‰ªçÁÑ∂ÊòØÂ≠êÁ±ªÂêç NSString *realClsName = [[instance valueForProperty:@"__realClsName"] toString]; // Ê†°È™åË∞ÉÁî®ÂØπË±°ÊòØÂê¶ÊòØÁ±ªÂêçÔºåÊòØÂê¶ÊòØÁ©∫ÂØπË±° if (instance) &#123; instance = formatJSToOC(instance); if (class_isMetaClass(object_getClass(instance))) &#123; className = NSStringFromClass((Class)instance); instance = nil; &#125; else if (!instance || instance == _nilObj || [instance isKindOfClass:[JPBoxing class]]) &#123; return @&#123;@"__isNil": @(YES)&#125;; &#125; &#125; // ÊääÂèÇÊï∞ÂàóË°®‰ªé JS ËΩ¨Âà∞ OC id argumentsObj = formatJSToOC(arguments); /** Â¶ÇÊûúË¶ÅÊâßË°åÁöÑÊñπÊ≥ïÊòØ"toJS"ÔºåÂç≥ËΩ¨Âåñ‰∏∫jsÁ±ªÂûã ÂØπ‰∫éNSString/NSNumber/NSData Á≠âÂèØ‰ª•Áõ¥Êé•ËΩ¨‰∏∫ js ÂØπË±°ÁöÑÁõ¥Êé•ËΩ¨‰∏∫ js ÈªòËÆ§ÂØπË±° ÂØπ‰∫éÊôÆÈÄö oc ÂØπË±°ÔºåËΩ¨‰∏∫ &#123;__obj: xxx, __clsName: xxx&#125; ÁöÑÂåÖË£πÂΩ¢Âºè **/ if (instance &amp;&amp; [selectorName isEqualToString:@"toJS"]) &#123; if ([instance isKindOfClass:[NSString class]] || [instance isKindOfClass:[NSDictionary class]] || [instance isKindOfClass:[NSArray class]] || [instance isKindOfClass:[NSDate class]]) &#123; return _unboxOCObjectToJS(instance); &#125; &#125; ...&#125; toJS ÊñπÊ≥ïÁöÑÂÆûÁé∞Ôºö 123456789101112131415161718192021222324252627282930313233// Êää oc ÂØπË±°ËΩ¨‰∏∫ js ÂØπË±° ÔºàÂ¢ûÂä†‰∫Ü __obj __clsName Á≠âÂ≠óÊÆµÔºâstatic NSDictionary *_wrapObj(id obj)&#123; if (!obj || obj == _nilObj) &#123; return @&#123;@"__isNil": @(YES)&#125;; &#125; return @&#123;@"__obj": obj, @"__clsName": NSStringFromClass([obj isKindOfClass:[JPBoxing class]] ? [[((JPBoxing *)obj) unbox] class]: [obj class])&#125;;&#125;// Â¶ÇÊûúÊòØ NSStringÔºåNSNumberÔºåNSDateÔºåNSBlock Áõ¥Êé•ËøîÂõûÔºå// Â¶ÇÊûúÊòØ NSArray ÊàñËÄÖ NSDictionary ÊääÂÜÖÈÉ®Ëß£ÂåÖ// Âê¶Âàô‰ª• &#123;__obj: xxx, __clsName: xxx&#125; ÁöÑÂΩ¢ÂºèÂåÖË£πÂØπË±°static id _unboxOCObjectToJS(id obj)&#123; if ([obj isKindOfClass:[NSArray class]]) &#123; NSMutableArray *newArr = [[NSMutableArray alloc] init]; for (int i = 0; i &lt; [(NSArray*)obj count]; i ++) &#123; [newArr addObject:_unboxOCObjectToJS(obj[i])]; &#125; return newArr; &#125; if ([obj isKindOfClass:[NSDictionary class]]) &#123; NSMutableDictionary *newDict = [[NSMutableDictionary alloc] init]; for (NSString *key in [obj allKeys]) &#123; [newDict setObject:_unboxOCObjectToJS(obj[key]) forKey:key]; &#125; return newDict; &#125; if ([obj isKindOfClass:[NSString class]] ||[obj isKindOfClass:[NSNumber class]] || [obj isKindOfClass:NSClassFromString(@"NSBlock")] || [obj isKindOfClass:[NSDate class]]) &#123; return obj; &#125; return _wrapObj(obj);&#125; Â§ÑÁêÜË∞ÉÁî®Áà∂Á±ªÊñπÊ≥ïÂ¶ÇÊûú js Á´ØË∞ÉÁî®ÁöÑÊòØÁà∂Á±ªÁöÑÊñπÊ≥ïÔºåÈÇ£‰πàÊ®°Êãü OC Ë∞ÉÁî®Áà∂Á±ªÁöÑËøáÁ®ã„ÄÇOC ‰∏≠Ë∞ÉÁî®Áà∂Á±ªÔºåË∞ÉÁî®ËÄÖËøòÊòØÂΩìÂâçÂ≠êÁ±ªÔºå‰ΩÜÊòØË∞ÉÁî®ÁöÑ IMP ÂàôÊòØÁà∂Á±ªÊñπÊ≥ïÁöÑ IMP„ÄÇÂõ†Ê≠§ÔºåË¶ÅÊ®°Êãü OC ‰∏≠ÁöÑÊñπÊ≥ïË∞ÉÁî®ÔºåÈúÄË¶ÅÁªô OC Ê∑ªÂä†ÂíåÁà∂Á±ª‰∏ÄÊ†∑ÁöÑ IMP ÂÆûÁé∞„ÄÇ‰ª• SUPER_XXX Ë°®Á§∫ SEL„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647static id callSelector(NSString *className, NSString *selectorName, JSValue *arguments, JSValue *instance, BOOL isSuper)&#123; ... // realClsName ÊòØÁúüÊ≠£Ë¶ÅË∞ÉÁî®ÁöÑÁ±ªÔºåÂíå clsName ÁöÑÂå∫Âà´Âú®‰∫éÂ¶ÇÊûúË¶ÅË∞ÉÁî®ÁöÑÊñπÊ≥ïÊòØÁà∂Á±ªÊñπÊ≥ïÔºåÈÇ£‰πà clsName ‰ºöÂèò‰∏∫Áà∂Á±ªÂêçÔºåËÄå realClsName ‰ªçÁÑ∂ÊòØÂ≠êÁ±ªÂêç NSString *realClsName = [[instance valueForProperty:@"__realClsName"] toString]; Class cls = instance ? [instance class] : NSClassFromString(className); SEL selector = NSSelectorFromString(selectorName); NSString *superClassName = nil; if (isSuper) &#123; // ÂàõÂª∫‰∏Ä‰∏™ SUPER_$&#123;selectorName&#125; ÁöÑ SEL NSString *superSelectorName = [NSString stringWithFormat:@"SUPER_%@", selectorName]; SEL superSelector = NSSelectorFromString(superSelectorName); // ÈÄöËøá js ‰º†Êù•ÁöÑ realClsName ÊãøÂà∞ superCls Class superCls; if (realClsName.length) &#123; Class defineClass = NSClassFromString(realClsName); // Â¶ÇÊûú realClsName ÁöÑÁà∂Á±ªËÉΩÊâæÂà∞Â∞±Áî® realClsName ÁöÑÁà∂Á±ªÔºåÂê¶ÂàôÂ∞±Áõ¥Êé•Áî®‰º†ËøáÊù•ÁöÑ className ËΩ¨ÁöÑ cls superCls = defineClass ? [defineClass superclass] : [cls superclass]; &#125; else &#123; superCls = [cls superclass]; &#125; // Ëé∑Âèñ superCls ÂØπÂ∫îÁöÑÂéüÂßãÊñπÊ≥ïÁöÑÂáΩÊï∞ÊåáÈíà Method superMethod = class_getInstanceMethod(superCls, selector); IMP superIMP = method_getImplementation(superMethod); // ÁªôÂΩìÂâçÁöÑ class Ê∑ªÂä†‰∏Ä‰∏™ superSelector, ÂΩ¢Âºè‰∏∫ SUPER_XXX ÁöÑÂΩ¢ÂºèÔºåËøô‰∏™ÊñπÊ≥ïÁöÑÊåáÈíàÊåáÂêëÁà∂Á±ªÊñπÊ≥ï // ‰πãÊâÄ‰ª•ÁªôÂ≠êÁ±ªÊ∑ªÂä†‰∏Ä‰∏™ÊåáÂêëÁà∂Á±ªÂÆûÁé∞ÁöÑÊñπÊ≥ïÊòØÂõ†‰∏∫ OC ‰∏≠Ë∞ÉÁî®Áà∂Á±ªÊñπÊ≥ïË∞ÉÁî®ËÄÖ‰πüÊòØÂ≠êÁ±ªÔºåÊòØÈÄöËøáËΩ¨ÂèëË∞ÉÁî®Âà∞Áà∂Á±ªÂÆûÁé∞ÁöÑ„ÄÇ // ËøôÈáåÂ∞±ÊòØÊ®°Êãü‰∫ÜËøô‰∏™ËøáÁ®ãÔºåÁõ¥Êé•ÁªôÂ≠êÁ±ªÊ∑ªÂä†Áà∂Á±ªÂÆûÁé∞ÁöÑÊñπÊ≥ï class_addMethod(cls, superSelector, superIMP, method_getTypeEncoding(superMethod)); // Âõ†‰∏∫ÊòØÁªôÂ≠êÁ±ªÂä®ÊÄÅÊ∑ªÂä†ÁöÑ $&#123;SUPER_XXX&#125; ÁöÑÊñπÊ≥ïÔºåÂÆÉÁöÑÂÆûÁé∞ÊòØÊåáÂêëÁà∂Á±ªÁõ∏Â∫îÁöÑÂéüÂßãÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÁà∂Á±ªÁöÑÊñπÊ≥ïË¢´ JS ÈáçÂÜô‰∫ÜÔºåÈÇ£‰πà $&#123;SUPER_XXX&#125; ‰πüÂ∫îËØ•Ë¢´ JS ÈáçÂÜô„ÄÇÊâÄ‰ª•ËøôÈáåË¶ÅÂØπ $&#123;SUPER_XXX&#125; ÁöÑÊñπÊ≥ïËøõË°å JS ÁöÑÊõøÊç¢ NSString *JPSelectorName = [NSString stringWithFormat:@"_JP%@", selectorName]; JSValue *overideFunction = _JSOverideMethods[superCls][JPSelectorName]; if (overideFunction) &#123; overrideMethod(cls, superSelectorName, overideFunction, NO, NULL); &#125; selector = superSelector; superClassName = NSStringFromClass(superCls); &#125; ...&#125; ÂàõÂª∫ NSInvocationËøô‰∏ÄÊÆµÊØîËæÉÁÆÄÂçïÔºåÂ∞±ÊòØÂàõÂª∫ NSInvocation ÔºåÂπ∂‰∏îËé∑ÂèñÊñπÊ≥ïÁ≠æÂêç„ÄÇÂÖ∂‰∏≠Â∞ÜÁºìÂ≠òÂ≠òÊîæÂú® _JSMethodSignatureCache Â≠óÂÖ∏‰∏≠ÁöÑÊìç‰ΩúÊàëËÆ§‰∏∫ÊÑè‰πâ‰∏çÂ§ß„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445static id callSelector(NSString *className, NSString *selectorName, JSValue *arguments, JSValue *instance, BOOL isSuper)&#123; ... // ÂàõÂª∫ NSInvocation NSInvocation *invocation; NSMethodSignature *methodSignature; // ÁºìÂ≠òÂÆû‰æãÁöÑÊñπÊ≥ïÁ≠æÂêç,ËôΩÁÑ∂ÊàëËßâÂæóÁî®Â§Ñ‰∏çÂ§ß if (!_JSMethodSignatureCache) &#123; _JSMethodSignatureCache = [[NSMutableDictionary alloc]init]; &#125; if (instance) &#123; [_JSMethodSignatureLock lock]; if (!_JSMethodSignatureCache[cls]) &#123; _JSMethodSignatureCache[(id&lt;NSCopying&gt;)cls] = [[NSMutableDictionary alloc]init]; &#125; methodSignature = _JSMethodSignatureCache[cls][selectorName]; if (!methodSignature) &#123; methodSignature = [cls instanceMethodSignatureForSelector:selector]; _JSMethodSignatureCache[cls][selectorName] = methodSignature; &#125; [_JSMethodSignatureLock unlock]; if (!methodSignature) &#123; _exceptionBlock([NSString stringWithFormat:@"unrecognized selector %@ for instance %@", selectorName, instance]); return nil; &#125; // ÂàõÂª∫ NSInvocation invocation = [NSInvocation invocationWithMethodSignature:methodSignature]; [invocation setTarget:instance]; &#125; else &#123; // Â¶ÇÊûúÊòØÁ±ªÊñπÊ≥ïÔºåÁõ¥Êé•Ëé∑ÂèñÂáΩÊï∞Á≠æÂêç methodSignature = [cls methodSignatureForSelector:selector]; if (!methodSignature) &#123; _exceptionBlock([NSString stringWithFormat:@"unrecognized selector %@ for class %@", selectorName, className]); return nil; &#125; invocation= [NSInvocation invocationWithMethodSignature:methodSignature]; [invocation setTarget:cls]; &#125; // ËÆæÁΩÆ NSInvocation ÁöÑ SEL [invocation setSelector:selector]; ...&#125; Â§ÑÁêÜÂèØÂèòÂèÇÊï∞ÊñπÊ≥ïÊñπÊ≥ïÁ≠æÂêçÁöÑÂèÇÊï∞‰∏™Êï∞Â∞è‰∫éÂÆûÈôÖ‰º†ÂÖ•ÁöÑÂèÇÊï∞Â∞±ÊòØÂèØÂèòÂèÇÊï∞ÊñπÊ≥ï„ÄÇÈáçÂÜôÂèØÂèòÂèÇÊï∞ÊñπÊ≥ïÂÆπÊòìÔºå‰ΩÜÊòØÁõ¥Êé•Ë∞ÉÁî®ÂèØÂèòÂèÇÊï∞ÊñπÊ≥ïÂç¥ÊØîËæÉÈöæ„ÄÇÂõ†‰∏∫ÔºåÈÄöËøá objc_msgSend ÈúÄË¶ÅÁ°ÆÂÆöË∞ÉÁî®Âõ∫ÂÆöÂèÇÊï∞ÁöÑ‰∏™Êï∞„ÄÇ Âõ†‰∏∫ÁºñËØëÁöÑÊó∂ÂÄôË¶ÅÊ†πÊçÆË∞ÉÁî®ÁöÑÂèÇÊï∞‰∏™Êï∞Á±ªÂûãÂàÜÈÖçÂèÇÊï∞ÂÖ•Ê†àÁ©∫Èó¥ÔºåÈíàÂØπ‰∏çÂêå CPU Êù•ÁîüÊàê‰∏çÂêåÁöÑÊ±áÁºñ‰ª£Á†Å„ÄÇÊâÄ‰ª•‰∏çËÉΩÂÜç‰∏çÁü•ÈÅìÂÖ•ÂèÇ‰∏™Êï∞ÂíåÁ±ªÂûãÁöÑÊÉÖÂÜµ‰∏ãÂä®ÊÄÅË∞ÉÁî®„ÄÇÂõ†Ê≠§ÔºåforwardInvocation ÁöÑÊó∂ÂÄôÊâçÂøÖÈ°ªË¶ÅÊúâÊñπÊ≥ïÁ≠æÂêç„ÄÇ c ÂáΩÊï∞ÁöÑÂä®ÊÄÅË∞ÉÁî®‰πüÊòØ‰∏ÄÊ†∑ÔºåÊó†Ê≥ïÁõ¥Êé•ÈÄöËøáËé∑ÂèñÂáΩÊï∞ÊåáÈíàË∞ÉÁî®„ÄÇÂõ†Ê≠§ÂèÇÊï∞ÁöÑÂ§ÑÁêÜËÇØÂÆöÊòØ‰∏ç‰∏ÄËá¥ÁöÑ„ÄÇÂ¶ÇÊûúÊÉ≥Ë¶ÅÂä®ÊÄÅË∞ÉÁî®ÔºåÂøÖÈ°ªÈÄöËøáÂÖ∂‰ªñÊâãÊÆµÊ∂àÈô§Ëøô‰∏™ÈóÆÈ¢ò„ÄÇÂèØ‰ª•‰ΩøÁî® libffi Â∫ì„ÄÇ Êó¢ÁÑ∂ objc_msgSend ÈúÄË¶ÅÊòéÁ°ÆÁü•ÈÅìÂõ∫ÂÆöÂèÇÊï∞ÁöÑ‰∏™Êï∞ÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÊääÂÆÉÁ°ÆÂÆöÂèÇÊï∞‰∏™Êï∞ÁöÑÊñπÊ≥ïÈÉΩÂÆûÁé∞‰∏ÄÈÅçÂ∞±Â•Ω‰∫Ü„ÄÇÊØîÂ¶ÇÔºö 1id (*new_msgSend1)(id, SEL, id,...) = (id (*)(id, SEL, id,...)) objc_msgSend; ‰∏äÈù¢Â∞±Â£∞Êòé‰∫Ü‰∏Ä‰∏™ new_msgSend1ÔºåÂÆûÁé∞‰∫ÜË∞ÉÁî®Âõ∫ÂÆöÂèÇÊï∞‰∏Ä‰∏™ÔºåÂêéÁª≠ÊòØÂèØÂèòÂèÇÊï∞ÁöÑÊñπÊ≥ï„ÄÇÂêåÊ†∑ÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•Â£∞Êòé‰∏§‰∏™Âõ∫ÂÆöÂèÇÊï∞Ôºå‰πÉËá≥ n ‰∏™Âõ∫ÂÆöÂèÇÊï∞ÁöÑÊñπÊ≥ï„ÄÇ‰ΩÜÊòØËøôÊ†∑Êúâ‰∏Ä‰∏™Áº∫Èô∑Â∞±ÊòØÂè™ËÉΩË∞ÉÁî®ÊâÄÊúâÂèÇÊï∞ÈÉΩÊòØ id Á±ªÂûãÁöÑÊñπÊ≥ïÔºåÂõ†‰∏∫Êó†Ê≥ïÊèêÂâçÁ°ÆÂÆöÂèÇÊï∞Á±ªÂûã„ÄÇ ÂêÑ‰∏™Âõ∫ÂÆöÂèÇÊï∞‰∏™Êï∞ÁöÑ objc_msgSend ÊñπÊ≥ïÂÆö‰πâÂ•ΩÂêéÔºåÂ∞±ÂèØ‰ª•Ê†πÊçÆ JS Á´Ø‰º†Êù•ÁöÑÂèÇÊï∞‰∏™Êï∞ÂíåÊñπÊ≥ïÁ≠æÂêçÁöÑÂÆûÈôÖÂèÇÊï∞‰∏™Êï∞Êù•ÂÜ≥ÂÆöË∞ÉÁî®Âì™‰∏™ objc_msgSend ‰∫Ü„ÄÇ 1234567891011121314151617static id callSelector(NSString *className, NSString *selectorName, JSValue *arguments, JSValue *instance, BOOL isSuper)&#123; ... // Â§ÑÁêÜÂèØÂèòÂèÇÊï∞ NSUInteger numberOfArguments = methodSignature.numberOfArguments; NSInteger inputArguments = [(NSArray *)argumentsObj count]; // ÈíàÂØπÂèØÂèòÂèÇÊï∞‰∏™Êï∞ÁöÑÊñπÊ≥ï„ÄÇÂèÇÊï∞‰∏™Êï∞‰ºöÂ§ß‰∫éÊñπÊ≥ïÁ≠æÂêçÁöÑÂèÇÊï∞ÁöÑ‰∏™Êï∞Â∞±ÊòØÂèØÂèòÂèÇÊï∞ÊñπÊ≥ï if (inputArguments &gt; numberOfArguments - 2) &#123; // Âè™ÊîØÊåÅÂèÇÊï∞oÈÉΩÊòØ id Á±ªÂûãÔºåÂπ∂‰∏îËøîÂõûÁ±ªÂûã‰πüÊòØ id Á±ªÂûã„ÄÇ id sender = instance != nil ? instance : cls; id result = invokeVariableParameterMethod(argumentsObj, methodSignature, sender, selector); return formatOCToJS(result); &#125; ...&#125; (invokeVariableParameterMethod() ÊñπÊ≥ïÂ∞±ÁúÅÁï•‰∫ÜÔºåÁî®‰∫ÜÂ§ßÈáèÁöÑÂÆèÊù•ÂÆö‰πâÂíå‰ª£Áî® objc_msgSendÔºåÊúâÂÖ¥Ë∂£ÂèØ‰ª•Ëá™Â∑±Êü•Áúã) ËÆæÁΩÆ NSInvocation ÂèÇÊï∞ËÆæÁΩÆ NSInvocation ÂèÇÊï∞‰πüÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÂÜóÈïøÁöÑÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïÁöÑËµ∑Âõ†ÊòØ JS Á´Ø‰º†Êù•ÁöÑ JSValue Á±ªÂûãÁöÑÂèÇÊï∞Âú®ÊúÄÂºÄÂßã formatJSToOC ÁöÑÊó∂ÂÄôÈÉΩÂèò‰∏∫‰∫ÜÁªü‰∏ÄÁ±ªÂûã id Á±ªÂûã„ÄÇËÆæÁΩÆ NSInvocation ÂèÇÊï∞ÁöÑÊó∂ÂÄôË¶ÅÊÅ¢Â§çÂÖ∂ÂéüÊù•ÁöÑÁ±ªÂûã„ÄÇ ‰ª•‰∏ãÊñπÊ≥ïÂÅö‰∫ÜËØ¶Â∞ΩÁöÑÊ≥®ÈáäÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147static id callSelector(NSString *className, NSString *selectorName, JSValue *arguments, JSValue *instance, BOOL isSuper)&#123; ... for (NSUInteger i = 2; i &lt; numberOfArguments; i++) &#123; const char *argumentType = [methodSignature getArgumentTypeAtIndex:i]; id valObj = argumentsObj[i-2]; // Ê†πÊçÆ argumentType Ë°®Á§∫ÁöÑÁ±ªÂûãÔºåËÆæÁΩÆ NSInvocation ÁöÑÂèÇÊï∞Á±ªÂûã switch (argumentType[0] == 'r' ? argumentType[1] : argumentType[0]) &#123; // Âà§Êñ≠ÊòØÂê¶ÊòØÂΩìÂâçÁöÑ typeÔºåÂ¶ÇÊûúÊòØÔºåÂ∞±ËÆæÁΩÆ invocation ÁöÑÁ¨¨ i ‰∏™ÂÖÉÁ¥†ËÆæÁΩÆ‰∏∫ËØ•Á±ªÂûãÔºåÂÄº‰∏∫ valObj #define JP_CALL_ARG_CASE(_typeString, _type, _selector) \ case _typeString: &#123; \ _type value = [valObj _selector]; \ [invocation setArgument:&amp;value atIndex:i];\ break; \ &#125; JP_CALL_ARG_CASE('c', char, charValue) JP_CALL_ARG_CASE('C', unsigned char, unsignedCharValue) JP_CALL_ARG_CASE('s', short, shortValue) JP_CALL_ARG_CASE('S', unsigned short, unsignedShortValue) JP_CALL_ARG_CASE('i', int, intValue) JP_CALL_ARG_CASE('I', unsigned int, unsignedIntValue) JP_CALL_ARG_CASE('l', long, longValue) JP_CALL_ARG_CASE('L', unsigned long, unsignedLongValue) JP_CALL_ARG_CASE('q', long long, longLongValue) JP_CALL_ARG_CASE('Q', unsigned long long, unsignedLongLongValue) JP_CALL_ARG_CASE('f', float, floatValue) JP_CALL_ARG_CASE('d', double, doubleValue) JP_CALL_ARG_CASE('B', BOOL, boolValue) // selectorÁ±ªÂûã case ':': &#123; SEL value = nil; if (valObj != _nilObj) &#123; value = NSSelectorFromString(valObj); &#125; [invocation setArgument:&amp;value atIndex:i]; break; &#125; // ÁªìÊûÑ‰ΩìÁ±ªÂûã case '&#123;': &#123; // Ëé∑ÂèñÁªìÊûÑ‰ΩìÂêç NSString *typeString = extractStructName([NSString stringWithUTF8String:argumentType]); // ÂéªÈô§ js ÁöÑÂèÇÊï∞ JSValue *val = arguments[i-2]; // Â¶ÇÊûúÁªìÊûÑ‰ΩìÊòØÁªôÂÆöÁöÑÁ±ªÂûãÔºåÈÇ£‰πàÂ∞±Êää js ÁöÑÂèÇÊï∞ËΩ¨Âåñ‰∏∫ËØ•Á±ªÂûãÁöÑÁªìÊûÑ‰ΩìËÆæÁΩÆÂà∞ invocation ‰∏≠Âéª #define JP_CALL_ARG_STRUCT(_type, _methodName) \ if ([typeString rangeOfString:@#_type].location != NSNotFound) &#123; \ _type value = [val _methodName]; \ [invocation setArgument:&amp;value atIndex:i]; \ break; \ &#125; // Ê†°È™åÊòØÂê¶ÊòØ RectÔºåPointÔºåSizeÔºåRange ÂõõÁßçÁªìÊûÑ‰Ωì JP_CALL_ARG_STRUCT(CGRect, toRect) JP_CALL_ARG_STRUCT(CGPoint, toPoint) JP_CALL_ARG_STRUCT(CGSize, toSize) JP_CALL_ARG_STRUCT(NSRange, toRange) @synchronized (_context) &#123; // Ê£ÄÊü•ÊòØÂê¶ÊòØÈÄöËøá defineStruct ÂÆö‰πâÁöÑÁªìÊûÑ‰Ωì // ÁªìÊûÑ‰ΩìÂåÖÂê´ÁöÑÈîÆ‰∏∫ types ÁªìÊûÑ‰ΩìÁöÑÁ±ªÂûãÔºåkeys ÁªìÊûÑ‰ΩìÁöÑuÈîÆ NSDictionary *structDefine = _registeredStruct[typeString]; if (structDefine) &#123; // ÊãøÂà∞ÁªìÊûÑ‰ΩìÁöÑÂ§ßÂ∞è size_t size = sizeOfStructTypes(structDefine[@"types"]); // ÂàõÂª∫Áõ∏Â∫îÂ§ßÂ∞èÁöÑÂÜÖÂ≠òÂú∞ÂùÄ void *ret = malloc(size); // Êää valObj ÈáåÁöÑÊï∞ÊçÆÂ§çÂà∂Âà∞ ret ‰∏ä getStructDataWithDict(ret, valObj, structDefine); // ËÆæÁΩÆ ret ‰∏∫ invocation ÁöÑÂèÇÊï∞ [invocation setArgument:ret atIndex:i]; // chuan free(ret); break; &#125; &#125; break; &#125; // ÊåáÈíàÁ±ªÂûã case '*': case '^': &#123; // Â¶ÇÊûúÊòØ JPBoxing Á±ªÂûãÔºåÈÇ£‰πàËß£ÂåÖ,Â¶ÇÊûú‰∏çÊòØ JPBoxing Á±ªÂûãÔºåÈÇ£‰πàÁªßÁª≠ÂæÄ‰∏ãËµ∞ if ([valObj isKindOfClass:[JPBoxing class]]) &#123; void *value = [((JPBoxing *)valObj) unboxPointer]; // ^@ Ë°®Á§∫‰∏Ä‰∏™ÊåáÂêëidÁ±ªÂûãÁöÑÊåáÈíà if (argumentType[1] == '@') &#123; if (!_TMPMemoryPool) &#123; _TMPMemoryPool = [[NSMutableDictionary alloc] init]; &#125; // Êää JPBoxing ÊîæÂà∞ markArray Êï∞ÁªÑ‰∏≠ if (!_markArray) &#123; _markArray = [[NSMutableArray alloc] init]; &#125; memset(value, 0, sizeof(id)); [_markArray addObject:valObj]; &#125; [invocation setArgument:&amp;value atIndex:i]; break; &#125; &#125; // class Á±ªÂûã case '#': &#123; // Â¶ÇÊûúÊòØ JPBoxing Á±ªÂûãÈÇ£‰πàËß£ÂåÖÔºåÂ¶ÇÊûú‰∏çÊòØÈÇ£‰πàÁªßÁª≠ÂæÄ‰∏ãËµ∞ if ([valObj isKindOfClass:[JPBoxing class]]) &#123; Class value = [((JPBoxing *)valObj) unboxClass]; [invocation setArgument:&amp;value atIndex:i]; break; &#125; &#125; default: &#123; // null Á±ªÂûã if (valObj == _nullObj) &#123; valObj = [NSNull null]; [invocation setArgument:&amp;valObj atIndex:i]; break; &#125; if (valObj == _nilObj || ([valObj isKindOfClass:[NSNumber class]] &amp;&amp; strcmp([valObj objCType], "c") == 0 &amp;&amp; ![valObj boolValue])) &#123; valObj = nil; [invocation setArgument:&amp;valObj atIndex:i]; break; &#125; // block Á±ªÂûã if ([(JSValue *)arguments[i-2] hasProperty:@"__isBlock"]) &#123; JSValue *blkJSVal = arguments[i-2]; Class JPBlockClass = NSClassFromString(@"JPBlock"); if (JPBlockClass &amp;&amp; ![blkJSVal[@"blockObj"] isUndefined]) &#123; __autoreleasing id cb = [JPBlockClass performSelector:@selector(blockWithBlockObj:) withObject:[blkJSVal[@"blockObj"] toObject]]; [invocation setArgument:&amp;cb atIndex:i]; Block_release((__bridge void *)cb); &#125; else &#123; __autoreleasing id cb = genCallbackBlock(arguments[i-2]); [invocation setArgument:&amp;cb atIndex:i]; &#125; &#125; else &#123; [invocation setArgument:&amp;valObj atIndex:i]; &#125; &#125; &#125; &#125; ...&#125; Ê≥®ÊÑèÔºåÂ¶ÇÊûúÊúüÂæÖÁöÑÂÖ•ÂèÇÁöÑ typeencoding ÊòØ ^@ÔºåÂç≥ÊñπÊ≥ïÈúÄË¶Å‰∏Ä‰∏™‰∫åÁ∫ßÊåáÈíà‰Ωú‰∏∫ÂèÇÊï∞ÁöÑÊó∂ÂÄô„ÄÇ‰ºöÂàõÂª∫‰∏Ä‰∏™ _TMPMemoryPool Â≠óÂÖ∏Ôºå‰ª•Âèä‰∏Ä‰∏™ _markArray Êï∞ÁªÑÔºåÂπ∂ÊääÂèÇÊï∞ push Âà∞Êï∞ÁªÑ‰∏≠„ÄÇËøô‰∏§‰∏™ÂØπË±°‰ºöÂú®ÊâßË°åÂÆåÊàêÊòØÁî®Âà∞Ôºå‰∏ãÈù¢ÂÜçËØ¥„ÄÇ ÊâßË°åÂπ∂ËøîÂõûÁªìÊûúÁªô jsÊâßË°åÁöÑÊó∂ÂÄô‰ºöÂà§Êñ≠ÊòØÂê¶ÊòØÁà∂Á±ªÊñπÊ≥ïÔºåÂ¶ÇÊûúÊâßË°åÁöÑÊòØÁà∂Á±ªÊñπÊ≥ïÔºåÈÇ£‰πà‰ºöÊääÂÆÉÈ¢ÑÂ≠òÂú® _currInvokeSuperClsName Â≠óÂÖ∏‰∏≠„ÄÇÂõ†‰∏∫ÂâçÈù¢Êàë‰ª¨Â§ÑÁêÜÁà∂Á±ªÊñπÊ≥ïÁöÑÊó∂ÂÄôÊòØÁªôÂ≠êÁ±ªÊ∑ªÂä† SUPER_XXX ÁöÑ SEL„ÄÇÂú®ÂêéÈù¢Ê∂àÊÅØËΩ¨ÂèëÊó∂ÔºåÂú® _JSOverideMethods Â≠óÂÖ∏‰∏≠‰øùÂ≠òÁöÑÂàôÊòØ XXX ÁöÑ SEL„ÄÇÂõ†Ê≠§Ôºå‰øùÂ≠òÂú® _currInvokeSuperClsName Â≠óÂÖ∏‰∏≠Â∞±ÊòØË¶ÅËØ¥ÊòéËøôÊòØË∞ÉÁî®ÁöÑÁà∂Á±ªÁöÑÊñπÊ≥ïÔºåË¶ÅÊää SUPER_ ÂâçÁºÄÂéªÊéâÔºåÂà∞Áà∂Á±ªÁöÑÈáçÂÜôÊñπÊ≥ï‰∏≠Êâæ„ÄÇ 12345678910111213static void overrideMethod(Class cls, NSString *selectorName, JSValue *function, BOOL isClassMethod, const char *typeDescription)&#123; ... // Â¶ÇÊûúÊâßË°åÁöÑÊòØÂ≠êÁ±ªÔºåÈÇ£‰πàÂú® _currInvokeSuperClsName ‰∏≠‰øùÂ≠ò if (superClassName) _currInvokeSuperClsName[selectorName] = superClassName; // ÊâßË°åÊñπÊ≥ï [invocation invoke]; // ÊâßË°åÂÆåÊñπÊ≥ïÂêé‰ªé _currInvokeSuperClsName ÁßªÈô§ if (superClassName) [_currInvokeSuperClsName removeObjectForKey:selectorName]; ...&#125; Âú®ÊñπÊ≥ïÊâßË°åÂÆåÊàêÂêéÔºå‰ºöÂØπ _TMPMemoryPool Âíå _markArray ËøõË°åÂ§ÑÁêÜ„ÄÇÂÖ∑‰ΩìÂú∫ÊôØÂÜçË°•ÂÖÖ‰∏≠ËØ¥ÔºåËøôÈáåÂè™ÊòØÊ∑ªÂä†Ê≥®ÈáäÔºö 1234567891011121314151617181920212223static void overrideMethod(Class cls, NSString *selectorName, JSValue *function, BOOL isClassMethod, const char *typeDescription)&#123; ... if ([_markArray count] &gt; 0) &#123; for (JPBoxing *box in _markArray) &#123; // pointer ÊòØ‰∏Ä‰∏™‰∫åÁ∫ßÊåáÈíà // ÊâßË°åÂÆåÊñπÊ≥ïÂêéÔºå‰∫åÁ∫ßÊåáÈíà‰ºöË¢´ÊåáÂêë‰∏Ä‰∏™ÊåáÈíà void *pointer = [box unboxPointer]; // ËÆ© obj ÊåáÂêë‰∫åÁ∫ßÊåáÈíàpointerÊåáÂêëÁöÑÊåáÈíàÊåáÂêëÁöÑÂÄº id obj = *((__unsafe_unretained id *)pointer); if (obj) &#123; @synchronized(_TMPMemoryPool) &#123; // Â¶ÇÊûú‰∫åÁ∫ßÊåáÈíàÊåáÂêëÁöÑÂú∞ÂùÄÁ°ÆÂÆûÂ≠òÂú®ÔºåÈÇ£‰πàÂ∞±Êää obj ÊöÇÊó∂‰øùÂ≠òËµ∑Êù•ÔºåÈò≤Ê≠¢Ë¢´ÂõûÊî∂‰∫Ü„ÄÇ // Âõ†‰∏∫‰∏äÈù¢ÁöÑ obj ÊòØ unsafe_unretained ÁöÑ [_TMPMemoryPool setObject:obj forKey:[NSNumber numberWithInteger:[(NSObject*)obj hash]]]; &#125; &#125; &#125; &#125; ...&#125; ÊúÄÂêéÂØπ OC ÊâßË°åËøîÂõûÁöÑÁªìÊûú JS Âåñ„ÄÇËøôÈáåÂ≠òÂú®‰∏Ä‰∏™ÂÜÖÂ≠òÊ≥ÑÊºèÁöÑÈóÆÈ¢ò„ÄÇÂç≥ÂΩìÂä®ÊÄÅË∞ÉÁî®ÁöÑÊñπÊ≥ïÊòØ allocÔºånewÔºåcopyÔºåmutableCopy Êó∂ÔºåARC ‰∏ç‰ºöÂú®Â∞æÈÉ®ÊèíÂÖ• release ËØ≠Âè•ÔºåÂç≥Â§ö‰∫Ü‰∏ÄÊ¨°ÂºïÁî®ËÆ°Êï∞ÔºåÈúÄË¶ÅÈÄöËøá (__bridge_transfer id) Â∞Ü c ÂØπË±°ËΩ¨‰∏∫ OC ÂØπË±°ÔºåÂπ∂Ëá™Âä®ÈáäÊîæ‰∏ÄÊ¨°ÂºïÁî®ËÆ°Êï∞Ôºå‰ª•Ê≠§Êù•ËææÂà∞ÂºïÁî®ËÆ°Êï∞ÁöÑÂπ≥Ë°°Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100 char returnType[255]; strcpy(returnType, [methodSignature methodReturnType]); id returnValue; // ‰∏çÊòØ void Á±ªÂûã if (strncmp(returnType, "v", 1) != 0) &#123; // ÊòØ id Á±ªÂûãÈúÄË¶ÅÂà§Êñ≠ÊòØ‰∏çÊòØÂàõÂª∫Êñ∞ÂØπË±° if (strncmp(returnType, "@", 1) == 0) &#123; void *result; // ÊãøÂà∞ËøîÂõûÂÄº [invocation getReturnValue:&amp;result]; //For performance, ignore the other methods prefix with alloc/new/copy/mutableCopy if ([selectorName isEqualToString:@"alloc"] || [selectorName isEqualToString:@"new"] || [selectorName isEqualToString:@"copy"] || [selectorName isEqualToString:@"mutableCopy"]) &#123; // ÈíàÂØπ alloc Á≠âÊñπÊ≥ïÔºåÈúÄË¶ÅÈÄöËøá __bridge_transfer ÂáèÂéªÂºïÁî®ËÆ°Êï∞ returnValue = (__bridge_transfer id)result; &#125; else &#123; returnValue = (__bridge id)result; &#125; // Â∞Ü OC ËΩ¨‰∏∫ JS ËøîÂõû return formatOCToJS(returnValue); &#125; else &#123; // ÂÖ∂‰ªñÁöÑÂêÑÁßçÁ±ªÂûã ËøîÂõû JSValue switch (returnType[0] == 'r' ? returnType[1] : returnType[0]) &#123; #define JP_CALL_RET_CASE(_typeString, _type) \ case _typeString: &#123; \ _type tempResultSet; \ [invocation getReturnValue:&amp;tempResultSet];\ returnValue = @(tempResultSet); \ break; \ &#125; JP_CALL_RET_CASE('c', char) JP_CALL_RET_CASE('C', unsigned char) JP_CALL_RET_CASE('s', short) JP_CALL_RET_CASE('S', unsigned short) JP_CALL_RET_CASE('i', int) JP_CALL_RET_CASE('I', unsigned int) JP_CALL_RET_CASE('l', long) JP_CALL_RET_CASE('L', unsigned long) JP_CALL_RET_CASE('q', long long) JP_CALL_RET_CASE('Q', unsigned long long) JP_CALL_RET_CASE('f', float) JP_CALL_RET_CASE('d', double) JP_CALL_RET_CASE('B', BOOL) case '&#123;': &#123; NSString *typeString = extractStructName([NSString stringWithUTF8String:returnType]); #define JP_CALL_RET_STRUCT(_type, _methodName) \ if ([typeString rangeOfString:@#_type].location != NSNotFound) &#123; \ _type result; \ [invocation getReturnValue:&amp;result]; \ return [JSValue _methodName:result inContext:_context]; \ &#125; JP_CALL_RET_STRUCT(CGRect, valueWithRect) JP_CALL_RET_STRUCT(CGPoint, valueWithPoint) JP_CALL_RET_STRUCT(CGSize, valueWithSize) JP_CALL_RET_STRUCT(NSRange, valueWithRange) @synchronized (_context) &#123; NSDictionary *structDefine = _registeredStruct[typeString]; if (structDefine) &#123; size_t size = sizeOfStructTypes(structDefine[@"types"]); void *ret = malloc(size); [invocation getReturnValue:ret]; NSDictionary *dict = getDictOfStruct(ret, structDefine); free(ret); return dict; &#125; &#125; break; &#125; case '*': case '^': &#123; void *result; [invocation getReturnValue:&amp;result]; returnValue = formatOCToJS([JPBoxing boxPointer:result]); if (strncmp(returnType, "^&#123;CG", 4) == 0) &#123; if (!_pointersToRelease) &#123; _pointersToRelease = [[NSMutableArray alloc] init]; &#125; [_pointersToRelease addObject:[NSValue valueWithPointer:result]]; CFRetain(result); &#125; break; &#125; case '#': &#123; Class result; [invocation getReturnValue:&amp;result]; returnValue = formatOCToJS([JPBoxing boxClass:result]); break; &#125; &#125; return returnValue; &#125; &#125; return nil;&#125; OC Ê∂àÊÅØËΩ¨Âèëjspatch ÊÉ≥Ë¶Å hook ‰ªªÊÑèÁöÑÊñπÊ≥ïÔºåÂ∞±ÈúÄË¶ÅËÆ©ÊâÄÊúâË¢´ hook ÁöÑÊñπÊ≥ïËµ∞‰∏Ä‰∏™Áªü‰∏ÄÁöÑÂÖ•Âè£„ÄÇËøô‰∏™Áªü‰∏ÄÁöÑÂÖ•Âè£ÈÄöËøáËÆ©ÊâÄÊúâË¢´ÊõøÊç¢ÁöÑÊñπÊ≥ïËµ∞Ê∂àÊÅØËΩ¨ÂèëÔºåÂπ∂‰∏î hook Ê∂àÊÅØËΩ¨ÂèëÁöÑ forwardInvocation() ÊñπÊ≥ïÂÆûÁé∞ÔºåÊó†ËÆ∫Ëøô‰∏™ÊñπÊ≥ïÊòØ JS Ë∞ÉÁî®ÁöÑËøòÊòØ OC Ë∞ÉÁî®ÁöÑ„ÄÇ ‰∏ªË¶ÅËøáÁ®ãÂ¶Ç‰∏ãÔºö Ëé∑ÂèñË¢´ÈáçÂÜôÁöÑÊñπÊ≥ïÁöÑ JS ÂÆûÁé∞ Â¶ÇÊûúÊ≤°ÊúâÈáçÂÜôÁöÑ JS ÊñπÊ≥ïÔºåÈÇ£‰πàÊâßË°åÂéüÊù•ÁöÑÊñπÊ≥ïÂÆûÁé∞ ÂáÜÂ§áÊèê‰æõÁªô JS ÁöÑÂèÇÊï∞ ÊâßË°å‰∏ä‰∏ãÊñáÔºåÊñπÊ≥ïÁöÑÂÆûÈôÖË∞ÉÁî®ËÄÖ self ÊñπÊ≥ïÁöÑÂÆûÈôÖÂèÇÊï∞ ÈíàÂØπË∞ÉÁî®Áà∂Á±ªÊñπÊ≥ïÁöÑÁâπÊÆäÂ§ÑÁêÜ ÊâßË°å JS ÈáçÂÜôÊñπÊ≥ïÔºåÂπ∂ÂØπÂ∞ÜËøîÂõûÁªìÊûúËÆæÂõû NSInvocation ÈíàÂØπ dealloc ÊñπÊ≥ïÁöÑÁâπÊÆäÂ§ÑÁêÜ Ëé∑ÂèñË¢´ÈáçÂÜôÊñπÊ≥ïÁöÑ JS ÂÆûÁé∞JPForwardInvocation ÊòØ‰∏Ä‰∏™ÈùôÊÄÅÊñπÊ≥ïÔºåÂÆÉÁöÑÂâç‰∏§‰∏™ÂèÇÊï∞ÂàÜÂà´ÊòØ self Âíå selector„ÄÇ‰∏ªË¶ÅÈÄöËøá getJSFunctionInObjectHierachy() ÊñπÊ≥ïËé∑Âèñ JS ÊõøÊç¢ÊñπÊ≥ïÁöÑÂÆûÁé∞ 123456789101112131415161718192021// Ëá™Â∑±ÁöÑÊõøÊç¢ÊñπÊ≥ï, ÂèØ‰ª•ÁúãÂà∞Ë∞ÉÁî®ÊñπÊ≥ïÂâç‰∏§‰∏™ÂèÇÊï∞‰∏Ä‰∏™ÊòØ selfÔºå‰∏Ä‰∏™ÊòØ selecterÔºå ÂØπÂ∫î‰∫éÊñπÊ≥ïÁ≠æÂêçÁöÑ @:static void JPForwardInvocation(__unsafe_unretained id assignSlf, SEL selector, NSInvocation *invocation)&#123; BOOL deallocFlag = NO; id slf = assignSlf; BOOL isBlock = [[assignSlf class] isSubclassOfClass : NSClassFromString(@"NSBlock")]; NSMethodSignature *methodSignature = [invocation methodSignature]; NSInteger numberOfArguments = [methodSignature numberOfArguments]; NSString *selectorName = isBlock ? @"" : NSStringFromSelector(invocation.selector); NSString *JPSelectorName = [NSString stringWithFormat:@"_JP%@", selectorName]; // Âà§Êñ≠ JSPSEL ÊòØÂê¶ÊúâÂØπÂ∫îÁöÑ js ÂáΩÊï∞ÁöÑÂÆûÁé∞ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂ∞±ÂéüÂßãÊñπÊ≥ïÁöÑÊ∂àÊÅØËΩ¨ÂèëÁöÑÊµÅÁ®ã // ÔºàË¢´ defineClass ËøáÁöÑÁ±ª‰ºöË¢´ÊõøÊç¢ forwardInvocation ÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÊúâÊñπÊ≥ïÊ≤°ÊúâË¢´ÂÆûÁé∞Ôºå‰∏îÊ≤°ÊúâË¢´ JSÈáçÂÜô„ÄÇÈÇ£‰πàÂ∞±‰ºöËµ∞ÂéüÂßãÁöÑ forwardInvocation Ë¶ÅÊâæÂà∞ÁöÑÊòØ ORIGforwardInvocation ÊñπÊ≥ïÔºâ JSValue *jsFunc = isBlock ? objc_getAssociatedObject(assignSlf, "_JSValue")[@"cb"] : getJSFunctionInObjectHierachy(slf, JPSelectorName); if (!jsFunc) &#123; JPExecuteORIGForwardInvocation(slf, selector, invocation); return; &#125; ...&#125; getJSFunctionInObjectHierachy() ÊñπÊ≥ïÊü•ÊâæÂΩìÂâçÁ±ªÊòØÂê¶Êúâ JS ÂÆûÁé∞ÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÂ∞±‰ªéÁà∂Á±ª‰∏≠Êü•Êâæ„ÄÇÂ¶ÇÊûúÁà∂Á±ª‰∏≠‰πüÈÉΩÊ≤°ÊúâÂÆûÁé∞ÔºåÈÇ£‰πàÂ∞±Ë¶ÅËµ∞ÂéüÊú¨ÁöÑÊ∂àÊÅØËΩ¨ÂèëÈÄªËæë‰∫Ü„ÄÇ 123456789101112131415161718192021// Âà§Êñ≠Ëøô‰∏™ÊñπÊ≥ïÊòØÂê¶Êúâ js ÊñπÊ≥ïÁöÑÂÆûÁé∞„ÄÇ ÂêéÁª≠ÈÄöËøáËøô‰∏™Âà§Êñ≠ÁªìÊûúËµ∞ÂéüÂßãËΩ¨ÂèëÊµÅÁ®ãËøòÊòØËµ∞ js ÊñπÊ≥ïÁöÑË∞ÉÁî®// ËøôÊòØ‰∏Ä‰∏™ÈÄíÂΩíÊñπÊ≥ïstatic JSValue *getJSFunctionInObjectHierachy(id slf, NSString *selectorName)&#123; Class cls = object_getClass(slf); // Â¶ÇÊûúÊòØÊ≠£Âú®Âú® js ‰∏≠Ë∞ÉÁî® oc ‰∏Ä‰∏™Á±ª‰∏≠ÁöÑ super ÁöÑÊñπÊ≥ïÔºåÈÇ£‰πàÂ∞±ÈÄöËøá _currInvokeSuperClsName ËÆ∞ÂΩï‰∏ãÊù•„ÄÇÂõ†‰∏∫Âú®Ë∞ÉÁî®ÁöÑËøáÁ®ã‰∏≠Áî±‰∫éÊòØ super ÊñπÊ≥ïÔºåselector ‰ºöÊúâ‰∏Ä‰∏™ SUPER_ ÁöÑÂâçÁºÄ„ÄÇÊ∂àÊÅØËΩ¨ÂèëÂà∞ËøôÈáåÁöÑÊó∂ÂÄôÈúÄË¶ÅÁü•ÈÅìÂΩìÂâçË∞ÉÁî®ÁöÑÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™ super ÁöÑÊñπÊ≥ïÔºåÈúÄË¶ÅÊää SUPER_ ÂéªÈô§„ÄÇ if (_currInvokeSuperClsName[selectorName]) &#123; cls = NSClassFromString(_currInvokeSuperClsName[selectorName]); selectorName = [selectorName stringByReplacingOccurrencesOfString:@"_JPSUPER_" withString:@"_JP"]; &#125; JSValue *func = _JSOverideMethods[cls][selectorName]; // ÈÅçÂéÜÁà∂Á±ªÊâæËøô‰∏™ÊñπÊ≥ï while (!func) &#123; cls = class_getSuperclass(cls); if (!cls) &#123; return nil; &#125; func = _JSOverideMethods[cls][selectorName]; &#125; return func;&#125; ÂéüÊú¨ÁöÑ forwardInvocation: ÊåáÂêë‰∫Ü SEL ORIDforwardInvocation:„ÄÇÊãøÂà∞ÂÆÉÂØπÂ∫îÁöÑÂáΩÊï∞ÊåáÈíàÔºåÂπ∂‰∏îÊâßË°åÔºö 12345678910111213141516171819202122232425262728// ÊñπÊ≥ïÁöÑÂéüÊú¨ÁöÑ forward ÊµÅÁ®ãstatic void JPExecuteORIGForwardInvocation(id slf, SEL selector, NSInvocation *invocation)&#123; // ÊãøÂà∞ÂéüÂßãÁöÑË¢´ÊõøÊç¢ÁöÑ forwardInvocationÔºö ORIDforwardInvocation, ÁÑ∂ÂêéË∞ÉÁî®ÂéüÂßãÁöÑËΩ¨ÂèëÊñπÊ≥ï SEL origForwardSelector = @selector(ORIGforwardInvocation:); if ([slf respondsToSelector:origForwardSelector]) &#123; NSMethodSignature *methodSignature = [slf methodSignatureForSelector:origForwardSelector]; if (!methodSignature) &#123; _exceptionBlock([NSString stringWithFormat:@"unrecognized selector -ORIGforwardInvocation: for instance %@", slf]); return; &#125; // Ë∞ÉÁî®ÂéüÂßãÁöÑËΩ¨Êç¢ÊñπÊ≥ï NSInvocation *forwardInv= [NSInvocation invocationWithMethodSignature:methodSignature]; [forwardInv setTarget:slf]; [forwardInv setSelector:origForwardSelector]; [forwardInv setArgument:&amp;invocation atIndex:2]; [forwardInv invoke]; &#125; else &#123; // Â¶ÇÊûú‰∏çÂ≠òÂú®ÂéüÂßãÁöÑËΩ¨ÂèëÊñπÊ≥ïÔºåÂ∞±Ë∞ÉÁî®Áà∂Á±ªÁöÑËΩ¨ÂèëÊñπÊ≥ï // ËøôÈáåÂ∫îËØ•ÊòØ‰øùÂ∫ïÈÄªËæëÔºå‰∏ÄËà¨Êù•ËØ¥Ôºå‰∏ç‰ºöÂá∫Áé∞Ë∞ÉÁî®Ê≤°Êúâ forwardInvocation ÊñπÊ≥ïÁöÑÊÉÖÂÜµ Class superCls = [[slf class] superclass]; Method superForwardMethod = class_getInstanceMethod(superCls, @selector(forwardInvocation:)); void (*superForwardIMP)(id, SEL, NSInvocation *); superForwardIMP = (void (*)(id, SEL, NSInvocation *))method_getImplementation(superForwardMethod); superForwardIMP(slf, @selector(forwardInvocation:), invocation); &#125;&#125; ÂáÜÂ§á‰º†Áªô JS ÁöÑÂèÇÊï∞ÂÖàË¶ÅÊää self ÂèñÂá∫Êù•ÔºåÊîæÂà∞ÂèÇÊï∞Êï∞ÁªÑ‰∏≠„ÄÇÁ±ªÂØπË±°Â∞±Áî®‰∏Ä‰∏™ÂåÖÂê´ __clsName ÁöÑÂØπË±°Ë°®Á§∫ÔºåÂÆû‰æãÂØπË±°ÂàôÁî® JPBoxing ÂåÖË£π„ÄÇÂè¶Â§ñÔºåÂØπ‰∫é dealloc ÊñπÊ≥ïË¶ÅÊ≥®ÊÑè‰∏çËÉΩ‰ΩøÁî® weak ‰øÆÈ•∞„ÄÇÂú® dealloc ÊúüÈó¥Ôºå‰∏çËÉΩ‰ΩøÁî® weakÔºö 1234567891011121314151617181920212223242526static void JPForwardInvocation(__unsafe_unretained id assignSlf, SEL selector, NSInvocation *invocation)&#123; ... // ‰ªéNSInvocation‰∏≠Ëé∑ÂèñË∞ÉÁî®ÁöÑÂèÇÊï∞ÔºåÊääself‰∏éÁõ∏Â∫îÁöÑÂèÇÊï∞ÈÉΩËΩ¨Êç¢ÊàêjsÂØπË±°Âπ∂Â∞ÅË£ÖÂà∞‰∏Ä‰∏™ÈõÜÂêà‰∏≠// jsÁ´ØÈáçÂÜôÁöÑÂáΩÊï∞Ôºå‰º†ÈÄíËøáÊù•ÊòØJSValueÁ±ªÂûãÔºåÁî®callWithArgument:Ë∞ÉÁî®jsÊñπÊ≥ïÔºåÂèÇÊï∞‰πüË¶ÅÊòØjsÂØπË±°. NSMutableArray *argList = [[NSMutableArray alloc] init]; if (!isBlock) &#123; if ([slf class] == slf) &#123; // Â¶ÇÊûúË∞ÉÁî®ÁöÑÊòØÁ±ªÊñπÊ≥ïÔºåÈÇ£‰πàÁªôÂÖ•ÂèÇÂàóË°®ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Â∞±ÊòØ‰∏Ä‰∏™ÂåÖÂê´ __clsName ÁöÑ object [argList addObject:[JSValue valueWithObject:@&#123;@"__clsName": NSStringFromClass([slf class])&#125; inContext:_context]]; &#125; else if ([selectorName isEqualToString:@"dealloc"]) &#123; // ÂØπ‰∫éË¢´ÈáäÊîæÁöÑÂØπË±°Ôºå‰ΩøÁî® assign Êù•‰øùÂ≠ò self ÁöÑÊåáÈíà // Âõ†‰∏∫Âú® dealloc ÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªü‰∏çËÆ©Â∞Ü self ËµãÂÄºÁªô‰∏Ä‰∏™ weak ÂØπË±°„ÄÇÔºàÂú® dealloc ÁöÑÊó∂ÂÄôÂ∫îËØ•‰ºöÊúâ‰∏Ä‰∫õÊìç‰Ωú weak Â≠óÂÖ∏ÁöÑÊ≠•È™§ÔºåÊâÄ‰ª•‰∏çËÉΩÂÜçËøô‰∏™Èò∂ÊÆµÂÜçÊìç‰Ωú weakÔºâ // assign Âíå weak ÁöÑÂå∫Âà´Âú®‰∫é assign Âú®ÊåáÂêëÁöÑÂØπË±°ÈîÄÊØÅÁöÑÊó∂ÂÄô‰∏ç‰ºöÊääÂΩìÂâçÊåáÈíàÁΩÆ‰∏∫ nil // ÊâÄ‰ª•ËøôÈáåÊúÄÁªàË¶ÅËá™Â∑±Á°Æ‰øù‰∏ç‰ºöÂú® dealloc ÂêéË∞ÉÁî® slf ÁöÑÊñπÊ≥ï [argList addObject:[JPBoxing boxAssignObj:slf]]; deallocFlag = YES; &#125; else &#123; // Âê¶ÂàôÁî® weak ÂåÖË£π [argList addObject:[JPBoxing boxWeakObj:slf]]; &#125; &#125; ...&#125; ‰πãÂêéÂ∞±ÊòØÂèñÂá∫ NSInvocation ‰∏≠ÁöÑÂêÑ‰∏™ÂèÇÊï∞‰∫Ü„ÄÇËøô‰∏™ËøáÁ®ãÊòØ callSelector ‰∏≠ËÆæÁΩÆ NSInvocation ÁöÑÈÄÜËøáÁ®ã„ÄÇÂü∫Êú¨‰∏ÄËá¥ÔºåÊâÄ‰ª•‰∏çÈáçÂ§çË¥¥‰ª£Á†Å‰∫Ü„ÄÇ Ë∞ÉÁî®Áà∂Á±ªÊñπÊ≥ïÁöÑÁâπÊÆäÂ§ÑÁêÜ12345678910111213141516171819202122static void JPForwardInvocation(__unsafe_unretained id assignSlf, SEL selector, NSInvocation *invocation)&#123; ... // Â¶ÇÊûúÂΩìÂâçË∞ÉÁî®ÁöÑÊñπÊ≥ïÊòØ js ÂºïËµ∑ÁöÑÔºåÂπ∂‰∏î js Ë∞ÉÁî®‰∫Ü‰∏Ä‰∏™ super ÁöÑÊñπÊ≥ï„ÄÇÈÇ£‰πà‰ºöÂú® _currInvokeSuperClsName ‰∏≠‰øùÂ≠ò‰∏Ä‰∏™Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÂêç„ÄÇËøô‰∏™ÊñπÊ≥ïÂêçË¢´Âä†‰∏ä‰∫ÜÂâçÁºÄ SUPER_„ÄÇ Âõ†Ê≠§ÁúüÊ≠£Ë∞ÉÁî®ÁöÑÊó∂ÂÄôË¶ÅÊääËøô‰∏™ÂâçÁºÄÊõøÊç¢‰∏∫ _JP„ÄÇËøôÊ†∑ÊâçËÉΩÊâæÂà∞‰øùÂ≠òÂú® JSOverrideMethods Â≠óÂÖ∏‰∏≠ÁöÑÁõ∏Â∫îÊñπÊ≥ï if (_currInvokeSuperClsName[selectorName]) &#123; Class cls = NSClassFromString(_currInvokeSuperClsName[selectorName]); NSString *tmpSelectorName = [[selectorName stringByReplacingOccurrencesOfString:@"_JPSUPER_" withString:@"_JP"] stringByReplacingOccurrencesOfString:@"SUPER_" withString:@"_JP"]; // Â¶ÇÊûúÁà∂Á±ªÊ≤°ÊúâÈáçÂÜôÁõ∏Â∫îÁöÑÊñπÊ≥ï if (!_JSOverideMethods[cls][tmpSelectorName]) &#123; NSString *ORIGSelectorName = [selectorName stringByReplacingOccurrencesOfString:@"SUPER_" withString:@"ORIG"]; [argList removeObjectAtIndex:0]; // Â¶ÇÊûúÁà∂Á±ªÊ≤°ÊúâÈáçÂÜôËøô‰∏™ÊñπÊ≥ïÈÇ£‰πàÂ∞±ÊòØË∞ÉÁî® oc ÁöÑÊñπÊ≥ïÔºåoc Áõ¥Êé•Ë∞ÉÁî®Áà∂Á±ªÁöÑÁõ∏Â∫îÊñπÊ≥ï id retObj = callSelector(_currInvokeSuperClsName[selectorName], ORIGSelectorName, [JSValue valueWithObject:argList inContext:_context], [JSValue valueWithObject:@&#123;@"__obj": slf, @"__realClsName": @""&#125; inContext:_context], NO); id __autoreleasing ret = formatJSToOC([JSValue valueWithObject:retObj inContext:_context]); [invocation setReturnValue:&amp;ret]; return; &#125; &#125; ...&#125; ÊâßË°å JS ÊñπÊ≥ïÔºåÂπ∂Â∞ÜÁªìÊûúËÆæÁΩÆÂà∞ NSInvocationÂáÜÂ§áÂ•ΩÂèÇÊï∞ÂêéÔºåÂè™Ë¶ÅË∞ÉÁî® callWithArguments Â∞±ÂèØ‰ª•ÂêåÊ≠•Ëé∑ÂèñÂà∞ÊâßË°åÁªìÊûú„ÄÇÁî±‰∫éÊòØÊ∂àÊÅØËΩ¨ÂèëÔºåÂõ†Ê≠§Ë¶ÅÂ∞ÜÂæóÂà∞ÁöÑÁªìÊûúËøòË¶ÅÈÄöËøá setReturnValue: ËÆæÁΩÆÁªô NSInvocation„ÄÇ 123456789101112131415161718192021static void JPForwardInvocation(__unsafe_unretained id assignSlf, SEL selector, NSInvocation *invocation)&#123; ... // ËΩ¨Âåñ‰∏∫ js ÁöÑÂèÇÊï∞ÂΩ¢ÂºèÔºåÂ∞ÜÂØπË±°ÂåÖË£π‰∏∫ &#123;__obj: obj, __clsName: xxx&#125; ÁöÑÂΩ¢Âºè NSArray *params = _formatOCToJSList(argList); char returnType[255]; // Ëé∑ÂèñÊñπÊ≥ïÁöÑËøîÂõûÂèÇÊï∞ÁöÑÁ≠æÂêç strcpy(returnType, [methodSignature methodReturnType]); // Âà§Êñ≠ returnType ÁöÑÁ¨¶Âè∑Á≠æÂêç switch (returnType[0] == 'r' ? returnType[1] : returnType[0]) &#123; // ÂÖàË∞ÉÁî® js ÈáçÂÜôÁöÑÊñπÊ≥ïÔºåÂæóÂà∞ ËøîÂõûÂÄº jsval // Â¶ÇÊûú jsval ‰∏çÊòØÁ©∫ÔºåÂπ∂‰∏îÈúÄË¶Å isPerformInOCÔºåÈÇ£‰πàËé∑ÂèñÂÖ∂ callback ÊñπÊ≥ïÔºå // ÊâßË°åÂÆåÂêéÊãøÂà∞Êï∞ÊçÆËΩ¨‰∏∫ js ÂêéË∞ÉÁî® callback ÊñπÊ≥ï // Â¶ÇÊûú jsval Ê≤°Êúâ isPerformInOCÔºåÈÇ£‰πàÂ∞±ÊòØÊâßË°åÂÆå js ÊñπÊ≥ïÂêéÁõ¥Êé•ÂæÄ‰∏ãËµ∞ ... (ÁúÅÁï•‰∫ÜÂêÑÁßçÁ±ªÂûãÂà§Êñ≠) &#125;&#125; ÈíàÂØπ dealloc ÊñπÊ≥ïÁöÑÁâπÊÆäÂ§ÑÁêÜÂ¶ÇÊûúÊòØ‰∏ÄËà¨ÁöÑÊñπÊ≥ïÔºåÁî® JS ÊõøÊç¢‰∫ÜÂéüÊñπÊ≥ïÊâßË°åÂ∞±ÂÆå‰∫ã‰∫Ü„ÄÇ‰ΩÜÊòØ dealloc ÊñπÊ≥ïÂàôÊúâÁÇπÁâπÊÆäÔºåÂÆÉÁöÑÂéüÂßãÊñπÊ≥ïÂøÖÈ°ªË¶ÅÊâßË°åÔºå‰∏çÁÑ∂ÊÄé‰πàÂÆåÊàêËµÑÊ∫êÂõûÊî∂„ÄÇÂõ†Ê≠§ÔºåÂú®ÊñπÊ≥ïÊâßË°åÁöÑÊúÄÂêé‰ºöÂà§Êñ≠ÂΩìÂâçÊâßË°åÁöÑÊòØ‰∏çÊòØ dealloc ÊñπÊ≥ïÔºåÂ¶ÇÊûúÊòØÔºåÈÇ£‰πàÈªòËÆ§Ë∞ÉÁî®ÂÆÉÁöÑÂÆûÁé∞Ôºö 123456789101112131415static void JPForwardInvocation(__unsafe_unretained id assignSlf, SEL selector, NSInvocation *invocation)&#123; ... // Â¶ÇÊûúËøô‰∏™ÊñπÊ≥ïÊòØ dealloc ÊñπÊ≥ï if (deallocFlag) &#123; slf = nil; Class instClass = object_getClass(assignSlf); // ÊãøÂà∞ dealloc ÊñπÊ≥ïÂÆûÁé∞ Method deallocMethod = class_getInstanceMethod(instClass, NSSelectorFromString(@"ORIGdealloc")); void (*originalDealloc)(__unsafe_unretained id, SEL) = (__typeof__(originalDealloc))method_getImplementation(deallocMethod); // Ë∞ÉÁî® originalDealloc(assignSlf, NSSelectorFromString(@"dealloc")); &#125;&#125; Ëá≥Ê≠§ÔºåOC Á´ØÁöÑÊ∂àÊÅØËΩ¨ÂèëËøáÁ®ãÁªìÊùü„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSPatch Ê∫êÁ†ÅËß£Êûê(‰∏Ä)]]></title>
    <url>%2F2019%2F08%2F01%2Fjspatch%2F</url>
    <content type="text"><![CDATA[JSPatch ËôΩÁÑ∂Ë¢´Á¶ÅÔºå‰ΩÜÊòØÂÆÉÁöÑÊ∫êÁ†ÅÊòØÈùûÂ∏∏ÂÄºÂæóÂ≠¶‰π†ÁöÑ„ÄÇÂèØ‰ª•ËØ¥ÔºåÊòØÊàëÁúãËøáÁöÑÂêÑ‰∏™Â∫ì‰∏≠ËÆæËÆ°ÁöÑÊúÄÂ∑ßÂ¶ô‰πüÊòØÁü•ËØÜÁÇπÊúÄÂ§öÁöÑÂºÄÊ∫êÂ∫ì„ÄÇÈùûÂ∏∏ÊúâÂ≠¶‰π†‰ª∑ÂÄº„ÄÇ ËøôÊòØËøô‰∏™Ê∫êÁ†ÅËß£ÊûêÁöÑÁ¨¨‰∏ÄÈÉ®ÂàÜ„ÄÇ‰∏ªË¶ÅÈÄöËøá‰∏Ä‰∏™ Demo ÊºîÁ§∫Â¶Ç‰ΩïÂÆö‰πâ JS ‰øÆÂ§çÊñá‰ª∂„ÄÇ Demo ÊºîÁ§∫JSPatch ÁöÑ‰∏ªË¶ÅÂäüËÉΩÊ∂µÁõñ‰∫é‰∏â‰∏™Êñá‰ª∂‰∏≠ÔºöJPEngine.hÔºåJPEngine.mÔºåJSPatch.js„ÄÇÁî±‰∫éËØ≠Ê≥ïËßÑÂàôÊØîËæÉÂ§öÔºåËøôÈáåÂ∞±‰∏çËøõË°åÁî®Ê≥ïÁöÑ‰ªãÁªç‰∫Ü„ÄÇ‰∏ãÈù¢Ë∑üÁùÄ JSPatch ÈôÑÂ∏¶ÁöÑ demo ‰∫ÜËß£ JSPatch ÁöÑ‰øÆÂ§çËøáÁ®ã„ÄÇ ‰øÆÂ§çÁöÑ js Êñá‰ª∂ÈÄöËøá js ËøõË°åÁÉ≠‰øÆÂ§çÔºådemo ‰∏≠ÂÆö‰πâ‰∫ÜË¶Å‰øÆÂ§çÁöÑÁ±ª‰∏∫ JPTableViewControllerÔºåÂÆÉÊòØ‰∏Ä‰∏™ UITableViewController„ÄÇÂú®Ëøô‰∏™ ‰øÆÂ§çÁ±ª‰∏≠ÔºåÂ¢ûÂä†‰∫Ü data Ëøô‰∏™ propertyÔºåÂπ∂‰∏îÊèê‰æõ‰∫ÜÂÆåÊï¥ÁöÑ UITableView ÊòæÁ§∫ÊâÄÈúÄË¶ÅÁöÑÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536defineClass('JPTableViewController : UITableViewController &lt;UIAlertViewDelegate&gt;', ['data'], &#123; dataSource: function() &#123; var data = self.data(); if (data) return data; var data = []; for (var i = 0; i &lt; 20; i ++) &#123; data.push("cell from js " + i); &#125; self.setData(data) return data; &#125;, numberOfSectionsInTableView: function(tableView) &#123; return 1; &#125;, tableView_numberOfRowsInSection: function(tableView, section) &#123; return self.dataSource().length; &#125;, tableView_cellForRowAtIndexPath: function(tableView, indexPath) &#123; var cell = tableView.dequeueReusableCellWithIdentifier("cell") if (!cell) &#123; cell = require('UITableViewCell').alloc().initWithStyle_reuseIdentifier(0, "cell") &#125; cell.textLabel().setText(self.dataSource()[indexPath.row()]) return cell &#125;, tableView_heightForRowAtIndexPath: function(tableView, indexPath) &#123; return 60 &#125;, tableView_didSelectRowAtIndexPath: function(tableView, indexPath) &#123; var alertView = require('UIAlertView').alloc().initWithTitle_message_delegate_cancelButtonTitle_otherButtonTitles("Alert",self.dataSource()[indexPath.row()], self, "OK", null); alertView.show() &#125;, alertView_willDismissWithButtonIndex: function(alertView, idx) &#123; console.log('click btn ' + alertView.buttonTitleAtIndex(idx).toJS()) &#125;&#125;) Âä†ËΩΩ‰øÆÂ§çÁöÑ js Êñá‰ª∂Âä†ËΩΩ‰øÆÂ§çÁöÑ js Êñá‰ª∂ÊòØÂú®Â∫îÁî®ÂêØÂä®ÂÆåÊØïÁöÑÂõûË∞É‰∏≠ÂÆåÊàêÁöÑÔºö 12345678910- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; // JSPatch ÂàùÂßãÂåñ [JPEngine startEngine]; NSString *sourcePath = [[NSBundle mainBundle] pathForResource:@"demo" ofType:@"js"]; NSString *script = [NSString stringWithContentsOfFile:sourcePath encoding:NSUTF8StringEncoding error:nil]; // ÊâßË°å‰øÆÂ§çËÑöÊú¨ [JPEngine evaluateScript:script]; ...&#125; ÂÖàË∞ÉÁî® startEngine ÂàùÂßãÂåñ JSPatchÔºåËøô‰∏ÄÊ≠•ÁöÑ‰ΩúÁî®‰∏ªË¶ÅÊòØÂàõÂª∫‰∏Ä‰∏™ JSContextÔºåÂπ∂Âú®ÂÖ∂‰∏≠Ê≥®ÂÖ•Êèê‰æõÁªô JS Ë∞ÉÁî®ÁöÑÊñπÊ≥ï„ÄÇÈöèÂêéÂä†ËΩΩÊèê‰æõ‰øÆÂ§çÁöÑ js Êñá‰ª∂„ÄÇÈÄöËøáÂàöÊâçÂàõÂª∫ÁöÑ JSContext ÊâßË°å„ÄÇ ÂΩìÊâßË°åÂà∞ JPTableViewController ÁöÑÊó∂ÂÄôÔºå‰øÆÂ§çÊñπÊ≥ïÊõøÊç¢‰∫ÜÂéüÊú¨ÁöÑÂêÑÁßç UITableView ÂõûË∞ÉÊâßË°å„ÄÇ ÊâßË°åÊµÅÁ®ãÂàùÂßãÂåñ JSContextÂàùÂßãÂåñ JSPatch ÈÄöËøá startEngine ÊñπÊ≥ïÂÆåÊàêÔºåËøô‰∏™ÊñπÊ≥ï‰∏∫ JSContext Ê≥®ÂÖ•‰∫ÜÂ§öÁßçÊñπÊ≥ïÔºåÂπ∂‰∏îÂàùÂßãÂåñ‰∫Ü OC Á´ØÁöÑÂêÑ‰∏™Â±ûÊÄß„ÄÇÊñπÊ≥ïÈùûÂ∏∏ÈïøÔºåÂõ†Ê≠§ÂÅö‰∫ÜÈùûÂ∏∏ËØ¶Â∞ΩÁöÑÊ≥®ÈáäÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171// SECTION ÂºÄÂßãJSPatch+ (void)startEngine&#123; // ÂàõÂª∫ JSContext ÂÆû‰æã JSContext *context = [[JSContext alloc] init]; #ifdef DEBUG // Â∞Ü lldb ‰∏≠ po ÊâìÂç∞Âá∫Êù•ÁöÑÂ≠óÁ¨¶‰∏≤‰º†ÈÄíÁªô js context[@"po"] = ^JSValue*(JSValue *obj) &#123; id ocObject = formatJSToOC(obj); return [JSValue valueWithObject:[ocObject description] inContext:_context]; &#125;; // js ‰∏≠ÊâìÂç∞Ë∞ÉÁî®Â†ÜÊ†àÔºåÁ±ª‰ºº‰∫é lldb ‰∏≠ÁöÑ bt context[@"bt"] = ^JSValue*() &#123; return [JSValue valueWithObject:_JSLastCallStack inContext:_context]; &#125;;#endif // Âú® OC ‰∏≠ÂÆö‰πâ ClassÔºå ËæìÂÖ•Á±ªÂêçÔºåÂÆû‰æãÊñπÊ≥ïÊï∞ÁªÑ Âíå Á±ªÊñπÊ≥ïÊï∞ÁªÑ context[@"_OC_defineClass"] = ^(NSString *classDeclaration, JSValue *instanceMethods, JSValue *classMethods) &#123; return defineClass(classDeclaration, instanceMethods, classMethods); &#125;; // Âú® OC ‰∏≠ÂÆö‰πâÂçèËÆÆÔºåËæìÂÖ•ÂçèËÆÆÂêç context[@"_OC_defineProtocol"] = ^(NSString *protocolDeclaration, JSValue *instProtocol, JSValue *clsProtocol) &#123; return defineProtocol(protocolDeclaration, instProtocol,clsProtocol); &#125;; // Ë∞ÉÁî® oc ÁöÑÂÆû‰æãÊñπÊ≥ï context[@"_OC_callI"] = ^id(JSValue *obj, NSString *selectorName, JSValue *arguments, BOOL isSuper) &#123; return callSelector(nil, selectorName, arguments, obj, isSuper); &#125;; // Ë∞ÉÁî® oc ÁöÑÁ±ªÊñπÊ≥ï context[@"_OC_callC"] = ^id(NSString *className, NSString *selectorName, JSValue *arguments) &#123; return callSelector(className, selectorName, arguments, nil, NO); &#125;; // Â∞Ü JS ÂØπË±°ËΩ¨‰∏∫ OC ÂØπË±° context[@"_OC_formatJSToOC"] = ^id(JSValue *obj) &#123; return formatJSToOC(obj); &#125;; // Â∞Ü OC ÂØπË±°ËΩ¨‰∏∫ JSÂØπË±° context[@"_OC_formatOCToJS"] = ^id(JSValue *obj) &#123; return formatOCToJS([obj toObject]); &#125;; // Ëé∑Âèñ js ÂÆö‰πâ class ÁöÑÊó∂ÂÄôÊ∑ªÂä†ÁöÑËá™ÂÆö‰πâÁöÑ props context[@"_OC_getCustomProps"] = ^id(JSValue *obj) &#123; id realObj = formatJSToOC(obj); return objc_getAssociatedObject(realObj, kPropAssociatedObjectKey); &#125;; // ËÆæÁΩÆ js ÂÆö‰πâ class Êó∂ÂÄôËá™ÂÆö‰πâÁöÑ props context[@"_OC_setCustomProps"] = ^(JSValue *obj, JSValue *val) &#123; id realObj = formatJSToOC(obj); objc_setAssociatedObject(realObj, kPropAssociatedObjectKey, val, OBJC_ASSOCIATION_RETAIN_NONATOMIC); &#125;; // js ÂØπË±°Âº±ÂºïÁî®, ‰∏ªË¶ÅÁî®‰∫é js ÂØπË±°‰ºö‰º†ÈÄíÁªô OC ÁöÑÊÉÖÂÜµ context[@"__weak"] = ^id(JSValue *jsval) &#123; id obj = formatJSToOC(jsval); return [[JSContext currentContext][@"_formatOCToJS"] callWithArguments:@[formatOCToJS([JPBoxing boxWeakObj:obj])]]; &#125;; // js ÂØπË±°Âº∫ÂºïÁî®ÔºåÂ∞Ü js Âº±ÂºïÁî®rÂØπË±°ËΩ¨‰∏∫Âº∫ÂºïÁî® context[@"__strong"] = ^id(JSValue *jsval) &#123; id obj = formatJSToOC(jsval); return [[JSContext currentContext][@"_formatOCToJS"] callWithArguments:@[formatOCToJS(obj)]]; &#125;; // Ëé∑Âèñ‰º†ÂÖ•Á±ªÁöÑÁà∂Á±ªÂêç context[@"_OC_superClsName"] = ^(NSString *clsName) &#123; Class cls = NSClassFromString(clsName); return NSStringFromClass([cls superclass]); &#125;; // ËÆæÁΩÆÊ†áËØÜ‰ΩçÔºåÂú® formatOCToJS ÁöÑÊó∂ÂÄôÊòØÂê¶Ëá™Âä®Â∞Ü NSString NSArray Á≠âÂØπË±°Ëá™Âä®ËΩ¨‰∏∫ js ‰∏≠ÁöÑ stringÔºåarray Á≠â„ÄÇ // Â¶ÇÊûúËÆæÁΩÆ‰∏∫ falseÔºåÂàô‰ºöÂΩìÊàê‰∏Ä‰∏™ÂØπË±°Ôºå‰ΩøÁî® JPBoxing ÂåÖË£π context[@"autoConvertOCType"] = ^(BOOL autoConvert) &#123; _autoConvert = autoConvert; &#125;; // ËÆæÁΩÆÊ†áËØÜ‰ΩçÔºåÂú® formatOCToJS ÁöÑÊó∂ÂÄôÊòØÂê¶Áõ¥Êé•Â∞Ü OC ÁöÑ NSNumber Á±ªÂûãËΩ¨‰∏∫ js ÁöÑ string Á±ªÂûã context[@"convertOCNumberToString"] = ^(BOOL convertOCNumberToString) &#123; _convertOCNumberToString = convertOCNumberToString; &#125;; // Âú® js ‰∏≠Ë∞ÉÁî® include ÊñπÊ≥ïÔºåÂèØ‰ª•Âú®‰∏Ä‰∏™ js Êñá‰ª∂‰∏≠Âä†ËΩΩÂÖ∂‰ªñ js Êñá‰ª∂ context[@"include"] = ^(NSString *filePath) &#123; NSString *absolutePath = [_scriptRootDir stringByAppendingPathComponent:filePath]; if (!_runnedScript) &#123; _runnedScript = [[NSMutableSet alloc] init]; &#125; if (absolutePath &amp;&amp; ![_runnedScript containsObject:absolutePath]) &#123; [JPEngine _evaluateScriptWithPath:absolutePath]; [_runnedScript addObject:absolutePath]; &#125; &#125;; // Êèê‰æõ‰∏Ä‰∏™Êñá‰ª∂ÂêçËøîÂõûÂÆåÊï¥ÁöÑÊñá‰ª∂Ë∑ØÂæÑ context[@"resourcePath"] = ^(NSString *filePath) &#123; return [_scriptRootDir stringByAppendingPathComponent:filePath]; &#125;; // Âª∂Êó∂Âú®‰∏ªÁ∫øÁ®ã‰∏≠ÊâßË°å„ÄÇ context[@"dispatch_after"] = ^(double time, JSValue *func) &#123; dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(time * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123; [func callWithArguments:nil]; &#125;); &#125;; // Âú®‰∏ªÁ∫øÁ®ã‰∏≠ÂºÇÊ≠•ÊâßË°å context[@"dispatch_async_main"] = ^(JSValue *func) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; [func callWithArguments:nil]; &#125;); &#125;; // Âú®‰∏ªÁ∫øÁ®ã‰∏≠ÂêåÊ≠•ÊâßË°å context[@"dispatch_sync_main"] = ^(JSValue *func) &#123; // ÂÖàÂà§Êñ≠ÊòØ‰∏çÊòØ‰∏ªÁ∫øÁ®ãÔºåÊòØÂ∞±Áõ¥Êé•ÊâßË°åÔºå‰∏çÊòØÂ∞±Áî® dispatch_sync if ([NSThread currentThread].isMainThread) &#123; [func callWithArguments:nil]; &#125; else &#123; dispatch_sync(dispatch_get_main_queue(), ^&#123; [func callWithArguments:nil]; &#125;); &#125; &#125;; // ÂºÇÊ≠•ÊâßË°å context[@"dispatch_async_global_queue"] = ^(JSValue *func) &#123; dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; [func callWithArguments:nil]; &#125;); &#125;; // ÈáäÊîæ‰∫åÁ∫ßÊåáÈíàÊåáÂêëÁöÑÂØπË±° context[@"releaseTmpObj"] = ^void(JSValue *jsVal) &#123; if ([[jsVal toObject] isKindOfClass:[NSDictionary class]]) &#123; void *pointer = [(JPBoxing *)([jsVal toObject][@"__obj"]) unboxPointer]; id obj = *((__unsafe_unretained id *)pointer); @synchronized(_TMPMemoryPool) &#123; [_TMPMemoryPool removeObjectForKey:[NSNumber numberWithInteger:[(NSObject*)obj hash]]]; &#125; &#125; &#125;; // js Ë∞ÉÁî® oc ÊñπÊ≥ïÔºåÊâìÂç∞ js ÂØπË±°Âà∞ oc ÊéßÂà∂Âè∞ context[@"_OC_log"] = ^() &#123; NSArray *args = [JSContext currentArguments]; for (JSValue *jsVal in args) &#123; id obj = formatJSToOC(jsVal); NSLog(@"JSPatch.log: %@", obj == _nilObj ? nil : (obj == _nullObj ? [NSNull null]: obj)); &#125; &#125;; // js ÊçïÊçâÂà∞ÁöÑ exception ÊâìÂç∞Âú® oc ‰∏≠ context[@"_OC_catch"] = ^(JSValue *msg, JSValue *stack) &#123; _exceptionBlock([NSString stringWithFormat:@"js exception, \nmsg: %@, \nstack: \n %@", [msg toObject], [stack toObject]]); &#125;; context.exceptionHandler = ^(JSContext *con, JSValue *exception) &#123; NSLog(@"%@", exception); _exceptionBlock([NSString stringWithFormat:@"js exception: %@", exception]); &#125;; // js ‰∏≠ÁöÑ nsnull Â∞±ÊòØ oc ‰∏≠ÁöÑ‰∏Ä‰∏™ÊôÆÈÄöÂØπË±° _nullObj = [[NSObject alloc] init]; context[@"_OC_null"] = formatOCToJS(_nullObj); _context = context; // ÂêÑÁßçÂàùÂßãÂåñ _nilObj = [[NSObject alloc] init]; _JSMethodSignatureLock = [[NSLock alloc] init]; _JSMethodForwardCallLock = [[NSRecursiveLock alloc] init]; _registeredStruct = [[NSMutableDictionary alloc] init]; _currInvokeSuperClsName = [[NSMutableDictionary alloc] init]; // ÊâæÂà∞ JSPatch.js ÁöÑË∑ØÂæÑ NSString *path = [[NSBundle bundleForClass:[self class]] pathForResource:@"JSPatch" ofType:@"js"]; if (!path) _exceptionBlock(@"can't find JSPatch.js"); // Âä†ËΩΩË∑ØÂæÑ‰∏äÁöÑÊñá‰ª∂ NSString *jsCore = [[NSString alloc] initWithData:[[NSFileManager defaultManager] contentsAtPath:path] encoding:NSUTF8StringEncoding]; // ÊâßË°å JSPatch.js if ([_context respondsToSelector:@selector(evaluateScript:withSourceURL:)]) &#123; [_context evaluateScript:jsCore withSourceURL:[NSURL URLWithString:@"JSPatch.js"]]; &#125; else &#123; [_context evaluateScript:jsCore]; &#125;&#125; Ê≥®ÂÖ• JSContext ÁöÑÊñπÊ≥ï‰ºöÂú®‰πãÂêéÁî®Âà∞ÁöÑÊó∂ÂÄôËØ¶ÁªÜËß£Èáä„ÄÇÂú®Ê≥®ÂÖ•ÊñπÊ≥ïÂÆåÊàêÂêéÔºåÊâßË°å‰∫Ü JSPatch js Á´ØÁöÑÂàùÂßãÂåñ‰ª£Á†Å„ÄÇ ÂàùÂßãÂåñ js ÈÉ®ÂàÜJSPatch ÁöÑ js Á´ØÂàùÂßãÂåñÈÉ®ÂàÜ‰∏ªË¶ÅÂÅö‰∫Ü‰∏§‰ª∂‰∫ãÔºö ‰∏∫ js ‰∏≠ÁöÑ Object ÂØπË±°Â¢ûÂä†ÊñπÊ≥ï ‰∏∫ JSContext ÁöÑÂÖ®Â±ÄÂØπË±°Â¢ûÂä†ÂêÑÁßçÂ±ûÊÄß‰∏éÊñπÊ≥ï 123456789101112131415161718// Object Â¢ûÂä†ÁöÑÂá†‰∏™ÊñπÊ≥ïÔºöfunction __c (methodName) &#123;...&#125;function super () &#123;...&#125;function performSelectorInOC () &#123;...&#125;function performSelector () &#123;...&#125;// JSContext ÂÖ®Â±ÄÂØπË±°Â¢ûÂä†ÁöÑÊñπÊ≥ïÔºöfunction _formatOCToJS (obj) &#123;...&#125;function require () &#123;...&#125;function defineClass (declaration, properties, instMethods, clsMethods) &#123;...&#125;function defineProtocol (declaration, instProtos, clsProtos) &#123;...&#125;function block (args, cb) &#123;...&#125;function defineJSClass (declaration, instMethods, clsMethods) &#123;...&#125;// JSContext ÂÖ®Â±ÄÂØπË±°Â¢ûÂä†ÁöÑÂ±ûÊÄßglobal.YES = 1global.NO = 0global.nsnull = _OC_null (JSContext ‰º†ÂÖ•Ôºå‰∏äÈù¢ÊúâÊèêÂèä) ÊîπÂÜô‰øÆÂ§çÊñá‰ª∂Áé∞Âú®ÂºÄÂßãÊâßË°å‰øÆÂ§çÊñá‰ª∂ÔºåÊãøÂà∞ js ‰ª£Á†ÅÂêéË∞ÉÁî®‰∫Ü[JPEngine evaluteScript:script]; ÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïÂÖúÂÖúËΩ¨ËΩ¨Êù•Âà∞‰∫Ü JPEngine ÁöÑ _evaluteScript:withSourceURL: ÊñπÊ≥ï‰∏≠„ÄÇÊñπÊ≥ïÂÆûÁé∞ÂæàÁÆÄÂçïÔºå‰ΩÜÊòØÂç¥ÊòØÂÆûÁé∞‰øÆÂ§çÁöÑÁ¨¨‰∏Ä‰∏™ÈáçÁÇπÔºö 123456789101112131415161718192021// ‰øÆÊîπ js ‰øÆÂ§çÊñá‰ª∂ÊñπÊ≥ïÁöÑË∞ÉÁî®ÊñπÂºè+ (JSValue *)_evaluateScript:(NSString *)script withSourceURL:(NSURL *)resourceURL&#123; if (!_regex) &#123; _regex = [NSRegularExpression regularExpressionWithPattern:_regexStr options:0 error:nil]; &#125; // ‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºèÊõøÊç¢ÊñπÊ≥ïË∞ÉÁî®ÊñπÂºèÔºåÂ∞Ü alloc() ËøôÊ†∑ÁöÑÂáΩÊï∞Ë∞ÉÁî®ÔºåÊõøÊç¢‰∏∫ __c("alloc")() ÂΩ¢Âºè NSString *formatedScript = [NSString stringWithFormat:@";(function()&#123;try&#123;\n%@\n&#125;catch(e)&#123;_OC_catch(e.message, e.stack)&#125;&#125;)();", [_regex stringByReplacingMatchesInString:script options:0 range:NSMakeRange(0, script.length) withTemplate:_replaceStr]]; // ÊâßË°åÂ§ÑÁêÜÂêéÁöÑ‰øÆÂ§çÊñπÊ≥ï @try &#123; if ([_context respondsToSelector:@selector(evaluateScript:withSourceURL:)]) &#123; return [_context evaluateScript:formatedScript withSourceURL:resourceURL]; &#125; else &#123; return [_context evaluateScript:formatedScript]; &#125; &#125; @catch (NSException *exception) &#123; _exceptionBlock([NSString stringWithFormat:@"%@", exception]); &#125; return nil;&#125; Âú® js ‰∏≠ÊâßË°åÂΩ¢Â¶Ç UIView.alloc().init() ËøôÊ†∑ÁöÑË∞ÉÁî®ÊñπÂºèÈúÄË¶ÅÈ¢ÑÂÖàÂ∞ÜË¶ÅÊâßË°åÁöÑÊñπÊ≥ïÂÆö‰πâÂú®ÂØπË±°‰∏≠ÔºåÂê¶Âàô‰∏ÄÂÆö‰ºöÊä•ÈîôÔºöUIView.alloc is not a function„ÄÇ‰ΩÜÊòØÈ¢ÑÂÖàÂÆö‰πâÁöÑÊñπÂºèÂ∑•‰ΩúÈáèÂ∑®Â§ß‰∏îÂàùÂßãÂåñÁöÑÊïàÁéáÂæà‰ΩéÔºå‰∏çÈÄÇÁî®‰∫éÊ∂âÂèäÂà∞Â§ßÈáèÁ±ªÁöÑ‰øÆÂ§ç„ÄÇ Êç¢‰∏ÄÁßçÊÄùË∑ØÔºåÁî±‰∫é OC Âä®ÊÄÅÊÄßÁöÑ‰æøÂà©Ôºå‰ΩøÂæóÊàë‰ª¨Âè™ÈúÄË¶Å‰ªé js Á´Ø‰º†ÈÄíË¶ÅÊâßË°åÁöÑÂØπË±°ÔºåÊñπÊ≥ïÂêçÂíåÂèÇÊï∞ÔºåÂ∞±ÂèØ‰ª•ÈÄöËøáÂä®ÊÄÅË∞ÉÁî®ÁöÑÊñπÂºèÊâßË°åÁõ∏Â∫îÊñπÊ≥ï„ÄÇËÄå‰º†ÈÄíËøô‰∏â‰∏™Ë¶ÅÁ¥†ÔºåÂè™Ë¶Å‰∏Ä‰∏™ÈÄöÁî®ÊñπÊ≥ïÂ∞±ÂèØ‰ª•ÂÆûÁé∞„ÄÇ JSPatch ‰ΩúËÄÖËÄÉËôëÂà∞ÂºÄÂèëËÄÖÁöÑ‰π†ÊÉØÔºå‰ªçÁÑ∂‰øùÁïô‰∫Ü UIView.alloc().init() ËøôÊ†∑ÁöÑÈìæÂºèÂÜôÊ≥ï„ÄÇ‰ΩÜÊòØÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÂØπÂÆûÁé∞ÂÜÖÂÆπ‰Ωú‰∫ÜÊ≠£ÂàôÊõøÊç¢ÔºåÂ∞ÜÂåπÈÖçÂà∞ÁöÑÊñπÊ≥ïÂêçÂèñÂá∫ÔºåÊîπ‰∏∫Ë∞ÉÁî®‰∏Ä‰∏™ÈÄöÁî®ÊñπÊ≥ï __c()ÔºåÂπ∂Â∞ÜÊñπÊ≥ïÂêç‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•„ÄÇÂõ†Ê≠§ÔºåÂÅö‰∫ÜÊ≠£ÂàôÊõøÊç¢ÂêéÁöÑÂÆûÁé∞Âèò‰∏∫ÔºöUIView.__c(&#39;alloc&#39;)().__c(&#39;init&#39;)()„ÄÇ ÂÆö‰πâË¶ÅÈáçÂÜôÁöÑÁ±ªÊñπÊ≥ï‰∏éÂÆû‰æãÊñπÊ≥ïjs Á´ØÂÆö‰πâÁ±ªË¶Å‰øÆÂ§çbugÈÇ£‰πàËÇØÂÆöË¶ÅÂÆö‰ΩçÂà∞Ë¶Å‰øÆÂ§çÁöÑÁ±ªÁöÑÊüê‰∏™ÊñπÊ≥ï„ÄÇjs ÂÖ®Â±ÄÂØπË±°‰∏ãÁöÑÊñπÊ≥ï defineClass Êèê‰æõ‰∫ÜËøô‰∏™ÂÖ•Âè£„ÄÇÊñπÊ≥ïÊØîËæÉÈïøÔºåÊÄªÂÖ±ÂÅö‰∫ÜÂá†‰ª∂‰∫ãÔºåÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö ËÆæÁΩÆÂÖ≥ËÅîÂ±ûÊÄß hook ÂÆö‰πâÁöÑÊñπÊ≥ïÔºåÂπ∂Â∞Ü‰øÆÊîπÂêéÁöÑÊñπÊ≥ï‰º†Áªô oc Â∞ÜËØ•Á±ªÁöÑÊñπÊ≥ïÂÆûÁé∞‰øùÂ≠òÂà∞ __ocCls ‰∏≠ ÂàõÂª∫ÂÖ®Â±ÄÁ±ªÂØπË±° Êé•‰∏ãÊù•Êàë‰ª¨‰∏Ä‰∏™‰∏Ä‰∏™Áúã„ÄÇ ËÆæÁΩÆÂÖ≥ËÅîÂ±ûÊÄß1234567891011121314151617181920global.defineClass = function(declaration, properties, instMethods, clsMethods) &#123; ... // Â¶ÇÊûúÂ≠òÂú® propertiesÔºåÂú®ÂÆû‰æãÊñπÊ≥ïÂàóË°®‰∏≠Â¢ûÂä†ÂêÑÁßç get set ÊñπÊ≥ï if (properties) &#123; properties.forEach(function(name)&#123; // ËÆæÁΩÆÂ±ûÊÄßÁöÑ get ÊñπÊ≥ï if (!instMethods[name]) &#123; // Â∞Ü get ÊñπÊ≥ïËÆæÁΩÆÂà∞ÂÆû‰æãÊñπÊ≥ï‰∏≠ instMethods[name] = _propertiesGetFun(name); &#125; // ËÆæÁΩÆÂ±ûÊÄßÁöÑ set ÊñπÊ≥ï var nameOfSet = "set"+ name.substr(0,1).toUpperCase() + name.substr(1); if (!instMethods[nameOfSet]) &#123; // Â∞Ü set ÊñπÊ≥ïËÆæÁΩÆÂà∞ÂÆû‰æãÊñπÊ≥ï‰∏≠ instMethods[nameOfSet] = _propertiesSetFun(name); &#125; &#125;); &#125; ...&#125; oc ÁöÑÂ±ûÊÄßÈÉΩÈúÄË¶ÅÊèê‰æõÂÖ∂ get set ÊñπÊ≥ï„ÄÇÂõ†Ê≠§ÔºåËøô‰∏ÄÊÆµ‰ª£Á†Å‰∏ªË¶ÅÂ∞±ÊòØÊü•ÁúãÂÆû‰æãÊñπÊ≥ï‰∏≠ÊúâÊ≤°ÊúâÁõ∏Â∫îÁöÑ get set ÊñπÊ≥ïÔºåÊ≤°ÊúâÁöÑËØùÂ∞±Ê∑ªÂä†„ÄÇÂÖ≥ËÅîÂ±ûÊÄßÁöÑ get set ÊñπÊ≥ïÈÄöËøá _propertiesGetFun Âíå _propertiesSetFun ÂÆåÊàêÔºö 123456789101112131415161718192021222324252627282930313233// ËøîÂõûÂ±ûÊÄßÁöÑ get ÊñπÊ≥ïvar _propertiesGetFun = function(name)&#123; return function()&#123; var slf = this; if (!slf.__ocProps) &#123; // Ëé∑Âèñ oc ÁöÑÂÖ≥ËÅîÂ±ûÊÄß var props = _OC_getCustomProps(slf.__obj) if (!props) &#123; props = &#123;&#125; _OC_setCustomProps(slf.__obj, props) &#125; // Â∞Ü oc ÁöÑÂÖ≥ËÅîÂ±ûÊÄßËµãÁªô js Á´ØÂØπË±°ÁöÑ __ocProps slf.__ocProps = props; &#125; return slf.__ocProps[name]; &#125;;&#125;// ËøîÂõûÂ±ûÊÄßÁöÑ set ÊñπÊ≥ïvar _propertiesSetFun = function(name)&#123; return function(jval)&#123; var slf = this; if (!slf.__ocProps) &#123; var props = _OC_getCustomProps(slf.__obj) if (!props) &#123; props = &#123;&#125; _OC_setCustomProps(slf.__obj, props) &#125; slf.__ocProps = props; &#125; slf.__ocProps[name] = jval; &#125;;&#125; oc Á´ØËÆæÁΩÆÂÖ≥ËÅîÂØπË±°ÁöÑÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 12345678context[@"_OC_getCustomProps"] = ^id(JSValue *obj) &#123; id realObj = formatJSToOC(obj); return objc_getAssociatedObject(realObj, kPropAssociatedObjectKey);&#125;;context[@"_OC_setCustomProps"] = ^(JSValue *obj, JSValue *val) &#123; id realObj = formatJSToOC(obj); objc_setAssociatedObject(realObj, kPropAssociatedObjectKey, val, OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;; ÂèØ‰ª•ÁúãÂà∞ÔºåÊó†ËÆ∫ js Á´ØËÆæÁΩÆ‰∫ÜÂ§öÂ∞ë propertyÔºåÂú® oc Á´ØÔºåÈÉΩ‰Ωú‰∏∫‰∏Ä‰∏™Â±ûÊÄß‰øùÂ≠òÂú® key ‰∏∫ kPropAssociatedObjectKey ÁöÑÂÖ≥ËÅîÂ±ûÊÄß‰∏≠„ÄÇoc Á´ØÊãøÂà∞‰∫ÜËøô‰∏™ÂÖ≥ËÅîÂ±ûÊÄßÂêéËøîÂõûÁªô js Á´ØÔºåjs Á´ØÁöÑÂØπË±°Âàô‰ª• _ocProps Â±ûÊÄßÊé•Êî∂„ÄÇ‰∏§ËÄÖÊåáÂêëÁöÑÂú∞ÂùÄÁõ∏ÂêåÔºåÂõ†Ê≠§Ôºå‰πãÂêéÂØπ‰∫é property ÁöÑÊîπÂèòÂè™ÈúÄÁõ¥Êé•‰øÆÊîπ js Á´ØÂØπË±°ÁöÑ _ocProps Â±ûÊÄßÂ∞±Ë°å„ÄÇ hook ÊñπÊ≥ïÂπ∂‰º†Áªô ococ ‰∏≠ÂÆûÁé∞ aop ÈùûÂ∏∏È∫ªÁÉ¶ÔºåËÄå js Á´ØÁõ¥Êé•Êìç‰ΩúÂáΩÊï∞ÊåáÈíàÂ∞±ÂèØ‰ª•ÂÆåÊàê„ÄÇ 1234567891011121314global.defineClass = function(declaration, properties, instMethods, clsMethods) &#123; ... // realClsName ÊòØ js ‰∏≠Áõ¥Êé•Êà™ÂèñÁöÑÁ±ªÂêç var realClsName = declaration.split(':')[0].trim() // È¢ÑÂ§ÑÁêÜË¶ÅÂÆö‰πâÁöÑÊñπÊ≥ïÔºåÂØπÊñπÊ≥ïËøõË°åÂàáÁâáÔºåÂ§ÑÁêÜÂèÇÊï∞ _formatDefineMethods(instMethods, newInstMethods, realClsName) _formatDefineMethods(clsMethods, newClsMethods, realClsName) // Âú® OC ‰∏≠ÂÆö‰πâËøô‰∏™Á±ªÔºåËøîÂõûÁöÑÂÄºÁ±ªÂûã‰∏∫ &#123;cls: xxx, superCls: xxx&#125; var ret = _OC_defineClass(declaration, newInstMethods, newClsMethods) // className ÊòØ‰ªé OC ‰∏≠Êà™ÂèñÁöÑ cls ÁöÑÂêçÂ≠ó„ÄÇÊú¨Ë¥®‰∏äÂíå realClsName ÊòØ‰∏ÄËá¥ÁöÑ var className = ret['cls'] var superCls = ret['superCls'] ...&#125; ‰∏ªË¶ÅËøáÁ®ãÂú® _formatDefineMethods ‰∏≠Ôºö 12345678910111213141516171819202122232425262728293031// ÂØπ js Á´ØÂÆö‰πâÁöÑ method ËøõË°åÈ¢ÑÂ§ÑÁêÜÔºåÂèñÂá∫ÊñπÊ≥ïÁöÑÂèÇÊï∞‰∏™Êï∞„ÄÇhook ÊñπÊ≥ïÔºåÈ¢ÑÂ§ÑÁêÜÊñπÊ≥ïÁöÑÂèÇÊï∞ÔºåÂ∞ÜÂÖ∂ËΩ¨‰∏∫ js ÂØπË±°„ÄÇvar _formatDefineMethods = function(methods, newMethods, realClsName) &#123; for (var methodName in methods) &#123; if (!(methods[methodName] instanceof Function)) return; (function()&#123; var originMethod = methods[methodName] // ÊääÂéüÊù•ÁöÑ method ÊãøÂá∫Êù•ÔºåÊñ∞ÁöÑ method ÂèòÊàê‰∫Ü‰∏Ä‰∏™Êï∞ÁªÑÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÂéüÊù•ÊñπÊ≥ïÁöÑË∞ÉÁî®ÂèÇÊï∞ÁöÑ‰∏™Êï∞ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØ // Âõ†‰∏∫runtime Ê∑ªÂä†ÊñπÊ≥ïÁöÑÊó∂ÂÄôÈúÄË¶ÅËÆæÁΩÆÂáΩÊï∞Á≠æÂêçÔºåÂõ†Ê≠§ÈúÄË¶ÅÁü•ÈÅìÊñπÊ≥ï‰∏≠ÂèÇÊï∞‰∏™Êï∞„ÄÇËøôÈáåÁõ¥Êé•Âú® js ‰∏≠Â∞ÜÂèÇÊï∞‰∏™Êï∞ÂèñÂá∫ newMethods[methodName] = [originMethod.length, function() &#123; try &#123; // js Á´ØÊâßË°åÁöÑÊñπÊ≥ïÔºåÈúÄË¶ÅÂÖàÊääÂèÇÊï∞ËΩ¨‰∏∫ js ÁöÑÁ±ªÂûã var args = _formatOCToJS(Array.prototype.slice.call(arguments)) // ÊöÇÂ≠ò‰πãÂâçÁöÑ self ÂØπË±° var lastSelf = global.self // oc Ë∞ÉÁî® js ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÈªòËÆ§Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØ self global.self = args[0] if (global.self) global.self.__realClsName = realClsName // oc Ë∞ÉÁî® js ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØ selfÔºåÂõ†Ê≠§Ë¶ÅÊääÂÆÉÂéªÊéâ„ÄÇ args.splice(0,1) // Ë∞ÉÁî® js ÊñπÊ≥ï var ret = originMethod.apply(originMethod, args) // ÊÅ¢Â§ç ÂéüÂßãÁöÑ self ÊåáÂêë global.self = lastSelf return ret &#125; catch(e) &#123; _OC_catch(e.message, e.stack) &#125; &#125;] &#125;)() &#125;&#125; ËøôÈáåÂ≠òÂú®‰∏â‰∏™Ë¶ÅÁÇπÔºö Ëøô‰∏™ÊñπÊ≥ïÊòØË¶ÅÊ∑ªÂä†Âà∞ oc Á´ØÁöÑÔºåoc Á´ØÈúÄË¶ÅÁü•ÈÅìÂèÇÊï∞‰∏™Êï∞Ôºå‰ΩÜÊòØ oc Á´ØÊó†Ê≥ïÁõ¥Êé•Ëé∑ÂèñÔºåÂè™ËÉΩÈÄöËøáËß£ÊûêÊñπÊ≥ïÂêç„ÄÇÂõ†Ê≠§Â∞±ÊääËß£ÊûêÂèÇÊï∞‰∏™Êï∞ÁöÑÂ∑•Á®ãÊîæÂú®‰∫Ü js ‰∏≠ËøõË°å„ÄÇjs Á´ØÂú®Â∞ÜÊñπÊ≥ï‰º†Áªô oc ÂâçÔºåÂÖàÊääÂèÇÊï∞‰∏™Êï∞ÊãøÂà∞ÔºåÁÑ∂Âêé‰ª•Êï∞ÁªÑÂΩ¢Âºè‰º†ÈÄí„ÄÇ oc Ë∞ÉÁî® js ÊñπÊ≥ïÊó∂‰º†ÈÄíÁöÑÂèÇÊï∞ÈúÄË¶ÅÈ¢ÑÂ§ÑÁêÜÔºåÊØîÂ¶ÇË∞ÉÁî®ÂØπË±°ÂéüÊú¨ÊòØ js ‰º†ÈÄíËøáÂéªÁöÑÔºåÂ∞±‰ºöË¢´ {__obj: xxx} ÂåÖË£πÔºåÂÜçÊØîÂ¶Ç oc ÁöÑÁ©∫ÂØπË±°ÁöÑÂ§ÑÁêÜ„ÄÇ oc ‰º†Êù•ÁöÑÂèÇÊï∞Á¨¨‰∏Ä‰∏™ÊòØÊñπÊ≥ïÁöÑË∞ÉÁî®‰∏ä‰∏ãÊñá„ÄÇÂõ†Ê≠§ÈúÄË¶ÅÊääË∞ÉÁî®‰∏ä‰∏ãÊñáËÆæÁΩÆÁªôÂÖ®Â±ÄÁöÑ selfÔºå‰ª•‰æøÂú®ÊñπÊ≥ï‰∏≠‰ΩøÁî®„ÄÇÂú®Ë∞ÉÁî®ÊñπÊ≥ïÂâçÔºåËøòÈúÄË¶ÅÊääËøô‰∏™‰∏ä‰∏ãÊñáÂíå Selector ‰ªéÂèÇÊï∞ÂàóË°®‰∏≠ÂèñÂá∫ÔºåÂõ†‰∏∫ js Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÊòØ‰∏çÈúÄË¶ÅËøô‰∏™ÂèÇÊï∞ÁöÑ„ÄÇ js ÊñπÊ≥ïÈ¢ÑÂ§ÑÁêÜÂÆåÊàêÂêéÔºåÂ∞±‰ºöË∞ÉÁî® _OC_defineClass ÊñπÊ≥ïÔºåÂú® OC ‰∏≠Ê∑ªÂä†Áõ∏Â∫îÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïÊòØ JSPatch ‰∏≠ÊúÄÈáçË¶ÅÁöÑÊñπÊ≥ï‰∫ÜÔºåÂú®ÂêéÈù¢‰ºöËß£ÈáäÔºåÂÖàË∑≥Ëøá„ÄÇ Â∞ÜËØ•Á±ªÁöÑÊñπÊ≥ïÂÆûÁé∞‰øùÂ≠òÂà∞ __ocCls ‰∏≠ÂØπ‰∫éÂÆö‰πâÂ•ΩÁöÑÊñπÊ≥ïÔºåjs Á´ØÈúÄË¶ÅÊääËøô‰∫õÊñπÊ≥ï‰øùÂ≠òËµ∑Êù•„ÄÇÊØïÁ´üÁúüÊ≠£ÁöÑÂÆûÁé∞ËøòÊòØÂú® js Á´ØËøõË°åÁöÑ„ÄÇÂõ†Ê≠§ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÊâÄÊúâÁ±ªÁöÑÊñπÊ≥ïÁöÑÊöÇÂ≠òÂú∞Ôºö__ocCls„ÄÇÊâÄÊúâÁöÑÁ±ªÁöÑÊâÄÊúâÊñπÊ≥ïÈÉΩ‰ºöË¢´‰øùÂ≠òÂú®Ëøô‰∏™ÂØπË±°‰∏≠„ÄÇ 123456789101112131415161718192021global.defineClass = function(declaration, properties, instMethods, clsMethods) &#123; ... // ÂàùÂßãÂåñËØ•Á±ªÁöÑÁ±ªÊñπÊ≥ïÂíåÂÆû‰æãÊñπÊ≥ïÂà∞ _ocCls ‰∏≠ _ocCls[className] = &#123; instMethods: &#123;&#125;, clsMethods: &#123;&#125;, &#125; // Â¶ÇÊûúÁà∂Á±ªË¢´ defineClass ËøáÔºåÈÇ£‰πàË¶ÅÊääÁà∂Á±ªÁöÑÊñπÊ≥ïÊâîÂà∞Â≠êÁ±ª‰∏≠Âéª„ÄÇÂ≠êÁ±ªË∞ÉÁî®Áà∂Á±ª‰∏≠ÂÆûÁé∞ÁöÑÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÁõ¥Êé•Ë∞ÉÁî® if (superCls.length &amp;&amp; _ocCls[superCls]) &#123; for (var funcName in _ocCls[superCls]['instMethods']) &#123; _ocCls[className]['instMethods'][funcName] = _ocCls[superCls]['instMethods'][funcName] &#125; for (var funcName in _ocCls[superCls]['clsMethods']) &#123; _ocCls[className]['clsMethods'][funcName] = _ocCls[superCls]['clsMethods'][funcName] &#125; &#125; // ÊääÊñπÊ≥ïÂ≠òÂà∞ _ocCls ÂØπÂ∫îÁöÑÁ±ª‰∏≠„ÄÇÂíå _formatDefineMethods ÁöÑÂ∑ÆÂà´Âú®‰∫éËøô‰∏™ÊñπÊ≥ï‰∏çÈúÄË¶ÅÊääÂèÇÊï∞‰∏™Êï∞ÊèêÂèñÂá∫Êù• _setupJSMethod(className, instMethods, 1, realClsName) _setupJSMethod(className, clsMethods, 0, realClsName) ...&#125; Â¶ÇÊûúÁà∂Á±ªÂÆûÁé∞‰∫ÜÊüê‰∫õÊñπÊ≥ïÔºåÈÇ£‰πàÂ≠êÁ±ª‰∏≠ÈúÄË¶ÅÂÖàÊääËøô‰∫õÊñπÊ≥ï‰øùÂ≠òËµ∑Êù•„ÄÇËøôÊ†∑Â¶ÇÊûúË∞ÉÁî®‰∫ÜÂ≠êÁ±ªÊ≤°ÊúâÂÆûÁé∞ÁöÑËøô‰∫õÊñπÊ≥ïÁöÑÊó∂ÂÄôÂ∞±ÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®Áà∂Á±ªÁõ∏Â∫îÁöÑÂÆûÁé∞„ÄÇ Ëøô‰∏™ÊÉ≥Ê≥ïÊòØÂØπÁöÑÔºå‰ΩÜÊòØÊàëËÆ§‰∏∫ÊúâÁÇπÈóÆÈ¢òÂú®‰∫éÔºåËøôÊ†∑ÁöÑËØùÂ∞±ÈúÄË¶ÅÂÖàÂØπÁà∂Á±ª defineClass ÊâçËÉΩÂÆö‰πâÂ≠êÁ±ªÔºåÂê¶ÂàôÂ≠êÁ±ªÂ∞±Ê≤°Ê≥ïÊãøÂà∞Áà∂Á±ªÂÆûÁé∞ÁöÑÊñπÊ≥ï‰∫Ü„ÄÇÂõ†Ê≠§ÔºåÂÆö‰πâÁ±ªÁöÑÊó∂ÂÄô‰∏ÄÂÆöË¶ÅÊ≥®ÊÑèÔºåÂÖàÂÆö‰πâÁà∂Á±ªÁöÑ classÔºåÂÜçÂÆö‰πâÂ≠êÁ±ªÁöÑ„ÄÇ _setupJSMethod ÂÖ∂ÂÆû‰πüÊòØ‰∏Ä‰∏™ÂæàÁÆÄÂçïÁöÑÊñπÊ≥ïÔºåÂÖ∂ÂÆûÂ∞±ÊòØÊää‰∏ä‰∏ãÊñáÂêç‰ªé this ÂàáÊç¢‰∏∫ selfÔºö 1234567891011121314151617181920// ÊõøÊç¢ this ‰∏∫ selfvar _wrapLocalMethod = function(methodName, func, realClsName) &#123; return function() &#123; var lastSelf = global.self global.self = this this.__realClsName = realClsName var ret = func.apply(this, arguments) global.self = lastSelf return ret &#125;&#125;// ‰øùÂ≠òÊñπÊ≥ïÂà∞ _ocCls ‰∏≠var _setupJSMethod = function(className, methods, isInst, realClsName) &#123; for (var name in methods) &#123; var key = isInst ? 'instMethods': 'clsMethods', func = methods[name] _ocCls[className][key][name] = _wrapLocalMethod(name, func, realClsName) &#125;&#125; OC ‰∏≠‰ºö‰øùÂ≠ò‰∏Ä‰ªΩÊñπÊ≥ïÂÆûÁé∞Âú® _JPOverideMethods Â≠óÂÖ∏‰∏≠„ÄÇËøò‰ºöÂú® js Á´Ø‰øùÂ≠òÂú® __ocCls ‰∏≠„ÄÇ‰øùÂ≠ò‰∏§‰ªΩÁöÑÁõÆÁöÑÊòØÂú® JS Á´ØÊâßË°åÂÆö‰πâÁöÑÊñπÊ≥ïÂπ∂‰∏îË∞ÉÁî®Âà∞ÂÖ∂‰ªñÂÆö‰πâÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•‰∏çÁî®ÈáçËµ∞‰∏ÄÈÅç OC ÁöÑÊ∂àÊÅØËΩ¨ÂèëÔºåËÄåÊòØÁõ¥Êé•Ë∞ÉÁî® js Á´ØÊñπÊ≥ï„ÄÇ ËøôÊ†∑ÁöÑÂ•ΩÂ§ÑÊúâ‰∏§ÁÇπÔºö ÊòØ‰∏çÁî®Ëµ∞Ê∂àÊÅØËΩ¨ÂèëÔºåÂä†Âø´ÊâßË°åÈÄüÂ∫¶„ÄÇ Âå∫ÂàÜ‰∫ÜË∞ÉÁî®Âú∫ÊôØÂêéÊõ¥ÂÆπÊòìËÆæÁΩÆË∞ÉÁî®‰∏ä‰∏ãÊñá„ÄÇÂØπ‰∫é OCÔºåË∞ÉÁî®ÁöÑ‰∏ä‰∏ãÊñáÊòØÈÄöËøáÂèÇÊï∞‰º†ÈÄíÁöÑÔºåÊãøÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Â∞ÜÂÖ∂ËµãÁªô global.self„ÄÇÂØπ‰∫é jsÔºåË∞ÉÁî®ÁöÑ‰∏ä‰∏ãÊñáÊó∂ thisÔºåÊääÂèëËµãÁªô global.self ÈÄöËøá require ÊñπÊ≥ïÂàõÂª∫ÂÖ®Â±ÄÁ±ªÂØπË±°defineClass ÁöÑÊúÄÁªàËøîÂõû‰∫Ü‰∏Ä‰∏™ require() ÊñπÊ≥ï‰∫ßÁîüÁöÑÂØπË±°Ôºö 1234global.defineClass = function(declaration, properties, instMethods, clsMethods) &#123; ... return require(className)&#125; Âú® require(xxx) Êüê‰∏Ä‰∏™Á±ªÂêéÔºå‰ºöÂú® js ÁöÑÂÖ®Â±ÄÂØπË±°‰∏äÂ¢ûÂä†ËØ•Á±ªÁöÑÂØπË±°ÔºåÊØîÂ¶ÇÔºö 123456789// js ‰∏≠ require ‰∏Ä‰∏™ UIViewControllerrequire('UIViewController')// ‰ºöÂú®ÂÖ®Â±Ä‰∏ãÂàõÂª∫‰∏Ä‰∏™ UIViewController ÂØπË±°global: &#123; UIViewController: &#123; __clsName: 'UIViewController' &#125;&#125; ÂÖ∑‰ΩìÁöÑÂÆûÁé∞Â¶Ç‰∏ãÔºö 12345678910111213141516171819var _require = function(clsName) &#123; if (!global[clsName]) &#123; global[clsName] = &#123; __clsName: clsName &#125; &#125; return global[clsName]&#125;// ÂÖ®Â±ÄÂàõÂª∫ÂØπË±°ÁöÑÊñπÊ≥ïÔºåÁõ¥Êé•‰∏∫ require ÁöÑÁ±ªÂàõÂª∫‰∏Ä‰∏™ÂÆÉÁöÑÂØπË±°global.require = function() &#123; var lastRequire for (var i = 0; i &lt; arguments.length; i ++) &#123; arguments[i].split(',').forEach(function(clsName) &#123; lastRequire = _require(clsName.trim()) &#125;) &#125; return lastRequire&#125; Ëá≥Ê≠§Ôºåjs ÊÆµÂÆö‰πâÁ±ªÁªìÊùü OC Á´ØÂÆö‰πâÁ±ªÂâçÈù¢ js È¢ÑÂ§ÑÁêÜËøáÂêéÂ∞±‰ºöÊù•Âà∞ OC ÁöÑ defineClass ÊñπÊ≥ï‰∏≠„ÄÇËøô‰∏™ÊñπÊ≥ï‰πüÊØîËæÉÈïøÔºå Â∞ÜÁ±ªÂêç„ÄÅÁà∂Á±ªÂêç„ÄÅÂçèËÆÆÂêçÂèñÂá∫ ÂàõÂª∫Á±ª‰ª•ÂèäÁªôÁ±ªÊ∑ªÂä†ÂçèËÆÆ Ê∑ªÂä†ÂíåÈáçÂÜôÊñπÊ≥ï ÂèñÂá∫Á±ªÂêçÂçèËÆÆÂêç1234567891011121314151617181920212223242526272829static NSDictionary *defineClass(NSString *classDeclaration, JSValue *instanceMethods, JSValue *classMethods)&#123; // Êâ´ÊèèÂ≠óÁ¨¶‰∏≤ÂÅöÂåπÈÖç NSScanner *scanner = [NSScanner scannerWithString:classDeclaration]; NSString *className; NSString *superClassName; NSString *protocolNames; // Êâ´ÊèèÂà∞ : ‰∫ÜÔºåÊää‰πãÂâçÁöÑÊîæÂà∞ className ‰∏≠ [scanner scanUpToString:@":" intoString:&amp;className]; // Â¶ÇÊûúÊ≤°ÊúâÊâ´ÊèèÂà∞Â∫ïÔºåÈÇ£‰πàÂ∞±ËØ¥ÊòéÊúâÁà∂Á±ªÊàñËÄÖÂçèËÆÆ if (!scanner.isAtEnd) &#123; scanner.scanLocation = scanner.scanLocation + 1; // Êâ´ÊèèÂá∫Êù•Áà∂Á±ª [scanner scanUpToString:@"&lt;" intoString:&amp;superClassName]; if (!scanner.isAtEnd) &#123; scanner.scanLocation = scanner.scanLocation + 1; // Êâ´ÊèèÂçèËÆÆÂêç [scanner scanUpToString:@"&gt;" intoString:&amp;protocolNames]; &#125; &#125; // Â¶ÇÊûú‰∏çÂ≠òÂú®Áà∂Á±ªÔºåÈÇ£‰πàÁà∂Á±ªÂ∞±ÊòØ NSObject if (!superClassName) superClassName = @"NSObject"; // ‰øÆÊîπ‰∏Ä‰∏ãÁ±ªÂêçÂíåÁà∂Á±ªÂêçÔºåÊääÂâçÂêéÁöÑÁ©∫ÁôΩÂ≠óÁ¨¶ÂéªÊéâ className = trim(className); superClassName = trim(superClassName); // Êää protocol ÂàáÂºÄÊãÜÂàÜÊàêÊï∞ÁªÑ NSArray *protocols = [protocolNames length] ? [protocolNames componentsSeparatedByString:@","] : nil; ...&#125; ÂÖ∂ÂÆûÂ∞±ÊòØËß£Êûê‰º†ËøõÊù•ÁöÑ NSString *classDeclaration Â≠óÁ¨¶‰∏≤„ÄÇÂÖ∂ÂÆûËøô‰∏™Áõ¥Êé•Âú® js Ëß£ÊûêÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇËøôÁßç js Ëß£Êûê‰∏ÄÈÅçÔºåOC ÂèàËß£Êûê‰∏ÄÈÅçÁöÑÂÅöÊ≥ïÊúâÁÇπÁ¥ØËµò„ÄÇ ÂàõÂª∫Á±ª‰ª•ÂèäÁªôÁ±ªÊ∑ªÂä†ÂçèËÆÆËß£ÊûêÂ•ΩÁ±ªÂêçÂíåÂçèËÆÆÂêç‰πãÂêéÂ∞±ÊòØÂàõÂª∫‰∫ÜÔºö 12345678910111213141516171819202122232425262728static NSDictionary *defineClass(NSString *classDeclaration, JSValue *instanceMethods, JSValue *classMethods)&#123; ... // ÂèçÂ∞Ñ‰∏∫Á±ªÂêç Class cls = NSClassFromString(className); if (!cls) &#123; // Â¶ÇÊûúÂ≠êÁ±ªÊ≤°ÊúâÂÆû‰æãÂåñÊàêÂäüÔºåÈÇ£‰πàÂÆû‰æãÂåñÁà∂Á±ª Class superCls = NSClassFromString(superClassName); // Â¶ÇÊûúÁà∂Á±ª‰πüÊ≤°ÊúâÂÆû‰æãÂåñÊàêÂäü if (!superCls) &#123; // Áõ¥Êé•Êä•Èîô _exceptionBlock([NSString stringWithFormat:@"can't find the super class %@", superClassName]); return @&#123;@"cls": className&#125;; &#125; // Â≠òÂú®Áà∂Á±ªÔºå‰∏çÂ≠òÂú®Â≠êÁ±ªÔºåÈÇ£‰πàÂàõÂª∫‰∏Ä‰∏™Â≠êÁ±ªÊó∂ cls = objc_allocateClassPair(superCls, className.UTF8String, 0); objc_registerClassPair(cls); &#125; // Â¶ÇÊûúÊúâÂçèËÆÆÔºåÈÇ£‰πàÊãøÂà∞ÊâÄÊúâÁöÑÂçèËÆÆÂêçÔºåÁªôÁ±ªÂ¢ûÂä†ÂçèËÆÆ if (protocols.count &gt; 0) &#123; for (NSString* protocolName in protocols) &#123; Protocol *protocol = objc_getProtocol([trim(protocolName) cStringUsingEncoding:NSUTF8StringEncoding]); class_addProtocol (cls, protocol); &#125; &#125; ...&#125; Ê∑ªÂä†ÂíåÈáçÂÜôÊñπÊ≥ï1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556static NSDictionary *defineClass(NSString *classDeclaration, JSValue *instanceMethods, JSValue *classMethods)&#123; ... // Â¢ûÂä†ÊñπÊ≥ï for (int i = 0; i &lt; 2; i ++) &#123; BOOL isInstance = i == 0; JSValue *jsMethods = isInstance ? instanceMethods: classMethods; // Â¶ÇÊûúÊòØÁ±ªÊñπÊ≥ïÈÇ£‰πàË¶ÅÂèñÂá∫ cls ÁöÑ metaClassÔºåÂê¶ÂàôÁõ¥Êé•ÊãøÂá∫ cls Class currCls = isInstance ? cls: objc_getMetaClass(className.UTF8String); // Êää JSValue ËΩ¨ÂåñÊàê Â≠óÂÖ∏ NSDictionary *methodDict = [jsMethods toDictionary]; for (NSString *jsMethodName in methodDict.allKeys) &#123; // ÈÄöËøá methodName ÊãøÂà∞ method ÂÆû‰æã // method ÂÆû‰æãÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Ë°®Á§∫ method ÊúâÂá†‰∏™ÂÖ•ÂèÇÔºåÁ¨¨‰∫å‰∏™cÂÖÉÁ¥†Ë°®Á§∫ÊñπÊ≥ïÂÆû‰æã JSValue *jsMethodArr = [jsMethods valueForProperty:jsMethodName]; int numberOfArg = [jsMethodArr[0] toInt32]; // ÊääÊñπÊ≥ï‰∏≠ÁöÑ _ ÈÉΩËΩ¨‰∏∫ : NSString *selectorName = convertJPSelectorString(jsMethodName); // Â¶ÇÊûúÂ∞æÈÉ®Ê≤°ÊúâÔºöÔºåÈÇ£‰πàÊ∑ªÂä†Ôºö if ([selectorName componentsSeparatedByString:@":"].count - 1 &lt; numberOfArg) &#123; selectorName = [selectorName stringByAppendingString:@":"]; &#125; JSValue *jsMethod = jsMethodArr[1]; if (class_respondsToSelector(currCls, NSSelectorFromString(selectorName))) &#123; // TODO: Â¶ÇÊûúÂΩìÂâçÁ±ªÂÆûÁé∞‰∫Ü selectorName ÁöÑÊñπÊ≥ïÔºåÈÇ£‰πàÁî®Áé∞Âú®ÁöÑÊñπÊ≥ï‰ª£ÊõøÂéüÊù•ÁöÑÊñπÊ≥ï overrideMethod(currCls, selectorName, jsMethod, !isInstance, NULL); &#125; else &#123; // Â¶ÇÊûúÂΩìÂâçÁ±ªÊ≤°ÊúâÂÆûÁé∞ selectorName ÊñπÊ≥ïÔºåÈÇ£‰πàÊ∑ªÂä†Ëøô‰∏™ÊñπÊ≥ï BOOL overrided = NO; for (NSString *protocolName in protocols) &#123; char *types = methodTypesInProtocol(protocolName, selectorName, isInstance, YES); if (!types) types = methodTypesInProtocol(protocolName, selectorName, isInstance, NO); if (types) &#123; overrideMethod(currCls, selectorName, jsMethod, !isInstance, types); free(types); overrided = YES; break; &#125; &#125; if (!overrided) &#123; if (![[jsMethodName substringToIndex:1] isEqualToString:@"_"]) &#123; NSMutableString *typeDescStr = [@"@@:" mutableCopy]; for (int i = 0; i &lt; numberOfArg; i ++) &#123; [typeDescStr appendString:@"@"]; &#125; overrideMethod(currCls, selectorName, jsMethod, !isInstance, [typeDescStr cStringUsingEncoding:NSUTF8StringEncoding]); &#125; &#125; &#125; &#125; &#125; ...&#125; È¶ñÂÖàÊòØÂØπÊñπÊ≥ïËøõË°åÈ¢ÑÂ§ÑÁêÜÔºåjs Á´ØÂÆö‰πâÁöÑÊñπÊ≥ïÈÉΩÊòØ‰ª•‰∏ãÂàíÁ∫ø‰∏∫ÂàÜÂâ≤ÁöÑÔºåÂΩ¢Â¶ÇÔºötableView_didSelectRowAtIndexPathÔºåÂú® OC ‰∏≠Ë¶ÅËΩ¨ÁöÑ tableView:didSelectRowAtIndexPath: ÁöÑÂΩ¢Âºè„ÄÇËøô‰∏™ËøáÁ®ãÂú® convertJSSelectorString() ÊñπÊ≥ï‰∏≠ÂÆåÊàêÔºö 123456789101112// Ëé∑ÂèñÁúüÊ≠£ÁöÑÊñπÊ≥ïÂêç// ÊÄªÁöÑÊù•ËØ¥Â∞±ÊòØÊñπÊ≥ï‰∏≠ÂèØËÉΩÂ≠òÂú®‰∏§ÁßçÊÉÖÂÜµÔºå‰∏ÄÁßçÊòØ __ ‰∏ÄÁßçÊòØ _// _ Êú¨Âú∞ËΩ¨‰∏∫‰∫Ü :Ôºå__ Ë¢´ËΩ¨‰∏∫‰∫Ü _static NSString *convertJPSelectorString(NSString *selectorString)&#123; // Áî® - ‰ª£Êõø __ NSString *tmpJSMethodName = [selectorString stringByReplacingOccurrencesOfString:@"__" withString:@"-"]; // Áî® Ôºö ‰ª£Êõø _ NSString *selectorName = [tmpJSMethodName stringByReplacingOccurrencesOfString:@"_" withString:@":"]; // Áî® _ ‰ª£Êõø - return [selectorName stringByReplacingOccurrencesOfString:@"-" withString:@"_"];&#125; Êé•‰∏ãÊù•Â∞±Ë¶ÅÁªôÁ±ªÊ∑ªÂä†ÊñπÊ≥ï‰∫ÜÔºåËßÑÂàôÊòØÔºö ÂØπ‰∫éÂ∑≤ÁªèÂ≠òÂú®ÁöÑÊñπÊ≥ïÔºöÁõ¥Êé•Ëé∑ÂèñÊñπÊ≥ïÁ≠æÂêçÔºåÁÑ∂Âêé‰º†ÂÖ• overrideMethodÔºå‰øÆÊîπÂéüÊù•ÁöÑÊñπÊ≥ïÂÆûÁé∞ÁöÑÂáΩÊï∞ÊåáÈíà„ÄÇ ÂØπ‰∫é‰∏çÂ≠òÂú®ÁöÑÁöÑÊñπÊ≥ïÔºö ÊòØÊüê‰∏™ÂçèËÆÆ‰∏≠ÁöÑÊñπÊ≥ïÔºöËé∑ÂèñÂçèËÆÆ‰∏≠ËØ•ÊñπÊ≥ïÁöÑÂáΩÊï∞Á≠æÂêçÔºåÂπ∂‰º†ÂÖ• overrideMethod ÂÆûÁé∞ÊñπÊ≥ï„ÄÇ ‰∏çÊòØÊüê‰∏™ÂçèËÆÆÁöÑÊñπÊ≥ïÔºöÂç≥ js Êñ∞Â¢ûÁöÑÊñπÊ≥ïÔºåËá™ÂÆö‰πâÊñπÊ≥ïÁ≠æÂêç‰∏∫ @@:{ÂèÇÊï∞‰∏™Êï∞‰∏™ @} ÁöÑÂΩ¢ÂºèÔºåË°®Á§∫ÊâÄÊúâÂÖ•ÂèÇÂíåËøîÂõûÂÄºÈÉΩÊòØ id Á±ªÂûã„ÄÇ‰º†ÂÖ• overrideMethodÔºåÂÆûÁé∞ÊñπÊ≥ï„ÄÇ Áî±Ê≠§ÂèØËßÅÔºåÊúÄÈáçË¶ÅÁöÑÊñπÊ≥ïÊòØ overrideMethod„ÄÇ ÈáçÂÜôÊñπÊ≥ï overrideMethodoverrideMethod ÂÆûÁé∞‰∫Ü js ÊñπÊ≥ïÂØπ oc ÊñπÊ≥ïÁöÑÂÆûÁé∞ÂíåÊõøÊç¢„ÄÇÂÆÉ‰∏ªË¶ÅÂÅö‰∫Ü‰∏â‰ª∂‰∫ãÔºö ÊõøÊç¢ÁõÆÊ†áÁ±ªÁöÑÊ∂àÊÅØËΩ¨ÂèëÊñπÊ≥ï forwardInvocation: ‰∏∫Ëá™ÂÆö‰πâÊñπÊ≥ï JPForwardInvocation: ÂêÑ‰∏™Á±ªÁöÑÊñπÊ≥ïÂëΩÂêç‰∏∫ _JP${ÊñπÊ≥ïÂêç} ‰øùÂ≠òÂà∞ _JSOverideMethods Â≠óÂÖ∏‰∏≠ÁöÑÂØπÂ∫îÁ±ª‰∏≠ ÊõøÊç¢ÂéüÊñπÊ≥ïÂÆûÁé∞‰∏∫ msgForwardÔºå ‰øùÂ≠òÂéüÊñπÊ≥ïÂÆûÁé∞‰∏∫ ORIG${ÂéüÊñπÊ≥ïÂêç} ÈÄöËøáÊõøÊç¢ÊñπÊ≥ïÂÆûÁé∞‰∏∫ mgsForward ÂÆûÁé∞Ê∂àÊÅØËΩ¨ÂèëÔºåÈÄöËøáÊõøÊç¢ forwardInvocation: ÂÆûÁé∞Âú®Ê∂àÊÅØËΩ¨ÂèëÊó∂Ë∞ÉÁî®Ëá™Â∑±ÁöÑÊñπÊ≥ïÔºåÂÆåÊàê hook„ÄÇ OC Á´ØÂÆö‰πâÁöÑÂ≠óÂÖ∏ _JSOverideMethods‰øùÂ≠òÂáΩÊï∞ÊåáÈíà„ÄÇÊ∂àÊÅØËΩ¨ÂèëÁöÑÊó∂ÂÄôÂèØ‰ª•ÊâæÂà∞ js Á´ØÊñπÊ≥ï 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// Â∞ÜÊñπÊ≥ïÊõøÊç¢‰∏∫ msgForwardIMPstatic void overrideMethod(Class cls, NSString *selectorName, JSValue *function, BOOL isClassMethod, const char *typeDescription)&#123; // ÈÄöËøáÂ≠óÁ¨¶‰∏≤Ëé∑ÂèñSEL SEL selector = NSSelectorFromString(selectorName); // Ê≤°ÊúâÁ±ªÂûãÁ≠æÂêçÁöÑÊó∂ÂÄôËé∑ÂèñÂéüÊù•ÁöÑÊñπÊ≥ïÁöÑÁ±ªÂûãÁ≠æÂêç if (!typeDescription) &#123; Method method = class_getInstanceMethod(cls, selector); typeDescription = (char *)method_getTypeEncoding(method); &#125; // Ëé∑ÂèñÂéüÊù•ÊñπÊ≥ïÁöÑ IMP IMP originalImp = class_respondsToSelector(cls, selector) ? class_getMethodImplementation(cls, selector) : NULL; // Ëé∑ÂèñÊ∂àÊÅØËΩ¨ÂèëÂ§ÑÁêÜÁöÑÁ≥ªÁªüÂáΩÊï∞ÂÆûÁé∞ IMP IMP msgForwardIMP = _objc_msgForward; // Â∞Ücls‰∏≠ÂéüÊù• forwardInvocaiton: ÁöÑÂÆûÁé∞ÊõøÊç¢Êàê JPForwardInvocation:ÂáΩÊï∞ÂÆûÁé∞. if (class_getMethodImplementation(cls, @selector(forwardInvocation:)) != (IMP)JPForwardInvocation) &#123; IMP originalForwardImp = class_replaceMethod(cls, @selector(forwardInvocation:), (IMP)JPForwardInvocation, "v@:@"); // ‰∏∫clsÊ∑ªÂä†Êñ∞ÁöÑSEL(ORIGforwardInvocation:)ÔºåÊåáÂêëÂéüÂßã forwardInvocation: ÁöÑÂÆûÁé∞IMP. if (originalForwardImp) &#123; class_addMethod(cls, @selector(ORIGforwardInvocation:), originalForwardImp, "v@:@"); &#125; &#125; // Ê∑ªÂä†‰∏Ä‰∏™Êñ∞ÁöÑÊñπÊ≥ï ORIG$&#123;ÂéüÊñπÊ≥ïÂêç&#125; if (class_respondsToSelector(cls, selector)) &#123; NSString *originalSelectorName = [NSString stringWithFormat:@"ORIG%@", selectorName]; SEL originalSelector = NSSelectorFromString(originalSelectorName); if(!class_respondsToSelector(cls, originalSelector)) &#123; class_addMethod(cls, originalSelector, originalImp, typeDescription); &#125; &#125; NSString *JPSelectorName = [NSString stringWithFormat:@"_JP%@", selectorName]; // ÂàùÂßãÂåñ _JSOverideMethods Â≠óÂÖ∏ _initJPOverideMethods(cls); // ËÆ∞ÂΩïÊñ∞SELÂØπÂ∫îjs‰º†ËøáÊù•ÁöÑÂæÖÊõøÊç¢ÁõÆÊ†áÊñπÊ≥ïÁöÑÂÆûÁé∞. _JSOverideMethods[cls][JPSelectorName] = function; // ÊääÂéüÊù•ÁöÑÊñπÊ≥ïÊõøÊç¢‰∏∫ msgForward ÁöÑÂÆûÁé∞ÔºåÂÆûÁé∞ÊñπÊ≥ïËΩ¨Âèë class_replaceMethod(cls, selector, msgForwardIMP, typeDescription);&#125; (Â§™Èïø‰∫ÜÔºåÁºñËæëÂô®Â§™Âç°‰∫ÜÔºåËΩ¨Ëá≥‰∏ã‰∏ÄÁØá„ÄÇ„ÄÇ„ÄÇ)]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Â∞èÁ®ãÂ∫è typescript ÂÆûË∑µ]]></title>
    <url>%2F2019%2F07%2F12%2Ftswithmp%2F</url>
    <content type="text"><![CDATA[Êñ∞ÁöÑÂ∞èÁ®ãÂ∫èÊâìÁÆóÁî® ts ÂÜôÔºåÊöÇÊó∂Ë∏©‰∫Ü‰∏Ä‰∫õÂùë ÂÆûË∑µÁºñËØëtsÁöÑÊó∂ÂÄôÂ∞èÁ®ãÂ∫èÊéßÂà∂Âè∞Êä•ÈîôÂàöÂºÄÂßãÂÆûË∑µÁöÑÊó∂ÂÄôÔºåÂ∞èÁ®ãÂ∫èÊéßÂà∂Âè∞‰∏ÄÁõ¥Êä•ÈîôÔºå‰ΩÜÊòØ‰πüÊ≤°ÊúâÂÖ∑‰ΩìÁöÑÊòæÁ§∫Ôºö ÈÅáÂà∞Ëøô‰∏™ÈîôËØØÈùûÂ∏∏Â§¥ÁñºÔºåËôΩÁÑ∂ÊòæÁ§∫Ê≤°ÊúâÈóÆÈ¢òÔºå‰ΩÜÊòØÊØèÊ¨°ÁºñËØëÈÉΩ‰ºöÊä•Ëøô‰∏™ÈîôËÆ©‰∫∫ÂæàÈöæÂèó„ÄÇ‰πãÂêéËøõËøá‰∏ÄÈòµÊë∏Á¥¢ÂêéÔºåÂèëÁé∞ÂØπ‰∫é ts ÁöÑÂ∞èÁ®ãÂ∫èÈ°πÁõÆÔºåÂú®ÁÇπÂáªÁºñËØëÂêé‰ºöÊâßË°å npm run tsc ËøõË°åÂ∞Ü ts Âà∞ js ÁöÑËΩ¨Êç¢Ôºö Âõ†Ê≠§ÔºåÊàëÂ∞ùËØïÊâãÂä®Âú®ÊéßÂà∂Âè∞‰∏≠ÊâßË°å npm run tscÔºåÁªà‰∫éÂæóÂà∞‰∫ÜÈîôËØØÁöÑÂÆö‰Ωç‰ø°ÊÅØ: Â∞èÁ®ãÂ∫èhot reloadjs ÁöÑÂ∞èÁ®ãÂ∫èÈ°πÁõÆ‰∏≠ js ÁöÑÂèòÊõ¥‰ºöÂºïËµ∑Â∞èÁ®ãÂ∫èÁöÑÁÉ≠ÈáçËΩΩÔºå‰ΩÜÊòØÂú® ts ÁöÑÈ°πÁõÆ‰∏≠Â∞±ÂøÖÈ°ªÊâãÂä®ÁÇπÂáªÁºñËØë„ÄÇËøôÊ†∑ÁöÑÊìç‰ΩúÈùûÂ∏∏‰∏çÂèãÂ•Ω„ÄÇÂõ†Ê≠§ÔºåÊàëÊÉ≥Ëá™Â∑±ÂÆûÁé∞ hot reload„ÄÇ hot reload ÁöÑ node Â∫ìÂèØ‰ª•‰ΩøÁî®Ôºöchokidar 1npm install --save-dev chokidar ÁÑ∂ÂêéÂú®Ê†πÁõÆÂΩïÂàõÂª∫ hotreload.js Êñá‰ª∂ÔºåÊñπÊ°àÊòØÁõëÂê¨Âà∞Êñá‰ª∂ÂèòÊõ¥ÂêéËß¶Âèë npm run tscÔºö 123456const chokidar = require('chokidar')const shell = require('shelljs')chokidar.watch('./miniprogram', &#123; cwd: '.' &#125;).on('change', (event, path) =&gt; &#123; shell.exec('npm run tsc') console.log('Âà∑Êñ∞')&#125;) ‰∏äÈù¢Â∞±ÊòØ watch ÁöÑ miniprogram ÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂ÁöÑÂèòÊõ¥„ÄÇ‰ΩÜÊòØËøôÊ†∑ËøòÊúâÈóÆÈ¢ò„ÄÇÂΩì ts ÂèòÊõ¥ÂêéËß¶Âèë npm run tscÔºåËÄå npm run tsc Êõ¥Êñ∞ js ÂêéÂèà‰ºöÈáçÊñ∞Ëß¶Âèë npm run tscÔºåÂèòÊàê‰∫ÜÊ≠ªÂæ™ÁéØ„ÄÇÂõ†Ê≠§ÔºåË¶ÅÊéíÈô§ js Êñá‰ª∂ÁöÑË∑üÊñ∞Ôºö 123456const chokidar = require('chokidar')const shell = require('shelljs')chokidar.watch('./miniprogram', &#123; cwd: '.', ignored: /.js$/ &#125;).on('change', (event, path) =&gt; &#123; shell.exec('npm run tsc') console.log('Âà∑Êñ∞')&#125;)]]></content>
      <categories>
        <category>MiniProgram</category>
      </categories>
      <tags>
        <tag>typescript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[fishhook Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2019%2F07%2F07%2Ffishhook%2F</url>
    <content type="text"><![CDATA[ÊèêËµ∑ iOS ‰∏≠ÁöÑ hook ÊâãÊÆµÔºåÊàë‰ª¨ÊúÄÂÖàÊÉ≥Âà∞ÁöÑÊòØ Method SwizzlingÔºåËøôÊòØ hook OC ÊñπÊ≥ïÊúÄÈáçË¶ÅÁöÑÊâãÊÆµ„ÄÇfishhook ÂàôÊèê‰æõ‰∫Ü hook Á≥ªÁªü c ÂáΩÊï∞ÁöÑÊâãÊÆµ„ÄÇ Âä®ÊÄÅÈìæÊé•‰∏∫‰ªÄ‰πàË¶ÅÊúâÂä®ÊÄÅÈìæÊé•‰∏∫‰∫ÜÂáèÂ∞ëÂ∫îÁî®ÁöÑ‰ΩìÁßØÔºåÂä†ÈÄüÂ∫îÁî®ÁöÑÂêØÂä®ÈÄüÂ∫¶„ÄÇËãπÊûúÁ≥ªÁªü‰ºöÂ∞ÜÂæàÂ§öÁ≥ªÁªüÂ∫ìËÆæËÆ°‰∏∫Âä®ÊÄÅÂ∫ì„ÄÇÂä®ÊÄÅÂ∫ìÁöÑÂÆûÈôÖÂú∞ÂùÄÂú®Â∫îÁî®ÁºñËØëÁöÑÊó∂ÂÄôÊòØÊú™Áü•ÁöÑ„ÄÇ‰∏Ä‰∫õÁ¨¶Âè∑‰ºöÂú®Â∫îÁî®ÂêØÂä®ÁöÑÊó∂ÂÄôÈìæÊé•„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúËøôÊ†∑ÁöÑÁ¨¶Âè∑ËøáÂ§öÂ∞±‰ºöÊãñÊÖ¢Â∫îÁî®ÁöÑÂêØÂä®ÈÄüÂ∫¶„ÄÇÂõ†Ê≠§Âè¶‰∏Ä‰∫õÈùûÂøÖË¶ÅÁ¨¶Âè∑‰ºöÂú®Á¨¨‰∏ÄÊ¨°‰ΩøÁî®ÁöÑÊó∂ÂÄôÁªëÂÆöÔºå‰πüÂ∞±ÊòØ Lazy Binding„ÄÇ ‰ªé‰æãÂ≠êÁúã lazy BindingÊàë‰ª¨Êù•ÈÄöËøá‰∏Ä‰∏™Á≥ªÁªüÊñπÊ≥ï NSLog Êù•È™åËØÅÂä®ÊÄÅÂ∫ìÁ¨¶Âè∑ÁöÑÁªëÂÆöËøáÁ®ã„ÄÇÊàë‰ª¨Âú® main.m ‰∏≠ËæìÂÖ•‰∏§‰∏™ÊâìÂç∞ËØ≠Âè•ÔºåÁÑ∂ÂêéÂä†‰∏äÊñ≠ÁÇπÔºö Êàë‰ª¨Êù•Áúã‰∏Ä‰∏ãÂÆÉÁöÑÊ±áÁºñÊâßË°åËøáÁ®ãÔºåÈúÄË¶ÅÂÖàËÆæÁΩÆÔºödebug -&gt; debug workflow -&gt; always show disassembly„ÄÇÊñ≠ÁÇπÊÉÖÂÜµ‰∏ãÁöÑÊ±áÁºñ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö Êàë‰ª¨ÁúãÂà∞Á¨¨14Ë°åÔºåbl 0x10470ebf0Ôºõ symbol stub for: NSLog Â∞±ÊòØÊâßË°åÊâìÂç∞ÁöÑÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïÂØπÂ∫î‰∫éÂèØÊâßË°åÊñá‰ª∂ÁöÑÂì™‰∏™ÊÆµÂë¢ÔºüÊàë‰ª¨ÈÄöËøá MachOView Êü•ÁúãÂÆÉÁöÑÂèØÊâßË°åÊñá‰ª∂Ôºö Âú® __Text,__stubs ‰∏≠Êúâ‰∏Ä‰∏™ÂØπÂ∫î‰∫é NSLog ÁöÑÊñπÊ≥ï„ÄÇÂÆÉÁöÑ offset ÊòØ 00006BF0„ÄÇ‰ΩÜÊòØÊàë‰ª¨ÂÆûÈôÖÁöÑÂú∞ÂùÄÊòØ 0x10 470ebf0ÔºåËøô‰∏§‰∏™Âú∞ÂùÄÊòæÁÑ∂ÊòØ‰∏çÂåπÈÖçÁöÑ„ÄÇËøôÊòØÂõ†‰∏∫ MachOView ‰∏≠ÁöÑ offset ÊòØÁõ∏ÂØπ‰∫é __Text ÊÆµÂºÄÂßãÁöÑ offset.(Header Âíå Load Commands ‰πüÊòØÂ±û‰∫é __Text ÊÆµÁöÑ )„ÄÇÂ¶ÇÊûúË¶ÅÊç¢ÁÆóÂà∞ÂÆûÈôÖÂú∞ÂùÄÔºåÂ∞±ÈúÄË¶ÅÂä†‰∏ä __Text ÊÆµÁöÑÂÆûÈôÖÂú∞ÂùÄ„ÄÇ‰ª•‰∏ãÊòØÂú∞ÂùÄÁöÑÊç¢ÁÆóÂÖ≥Á≥ªÔºö ËôöÊãüÂú∞ÂùÄ + ASLR = ÂÆûÈôÖÂú∞ÂùÄ __Text ÁöÑËôöÊãüÂú∞ÂùÄ + ASLR = __Text ÁöÑÂÆûÈôÖÂú∞ÂùÄ __Text ÁöÑËôöÊãüÂú∞ÂùÄ + ÂØπË±°ÁöÑ offset = ÂØπË±°ÁöÑËôöÊãüÂú∞ÂùÄ __Text ÁöÑÂÆûÈôÖÂú∞ÂùÄ + ÂØπË±°ÁöÑ offset = ÂØπË±°ÁöÑÂÆûÈôÖÂú∞ÂùÄ Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá lldb ‰∏≠ÊâßË°å image list Êü•Áúã __Text ÊÆµÁöÑÂÆûÈôÖÂú∞ÂùÄÔºö Â¶Ç‰∏äÂõæÊâÄÁ§∫Ôºåimage list ËÉΩÂàó‰∏æÂá∫ÂΩìÂâçÂ∫îÁî®Âä†ËΩΩÁöÑÊâÄÊúâÂä®ÊÄÅÂ∫ì„ÄÇÂÖ∂‰∏≠Á¨¨‰∏Ä‰∏™Â∞±ÊòØÂΩìÂâçÂ∫îÁî®ÁöÑÂú∞ÂùÄÔºå‰πüÂ∞±ÊòØ 0x0000000104708000„ÄÇÂç≥ 0x00006BF0 + 0x104708000 = 0x10470ebf0 Áî±‰∫é __Text ËôöÊãüÂú∞ÂùÄÈªòËÆ§ÊòØ 0x100000000ÔºåÂõ†Ê≠§ÔºåÊàë‰ª¨ËøòËÉΩËÆ°ÁÆóÂæóÂà∞ ASLR Âú∞ÂùÄ: 0x104708000 - 0x100000000 = 0x4708000 ÂΩìÁÑ∂ÔºåASLR Âú∞ÂùÄÂπ∂‰∏çÊòØÊàë‰ª¨ÂÖ≥Ê≥®ÁöÑÈáçÁÇπÔºåÂè™ÊòØÁï•Â∏¶ÊèêÂèä„ÄÇ Â¶ÇÊûúË¶ÅÁõ¥Êé•Ëé∑Âèñ ASLR Âú∞ÂùÄÔºåÂèØ‰ª•‰ΩøÁî® image list -o -f Êåá‰ª§ÔºåÂ∞±‰ºöÈªòËÆ§ÂáèÂéª __Text ÊÆµÁöÑËôöÊãüÂú∞ÂùÄ ÈÇ£‰πàËøô‰∏™Âú∞ÂùÄ‰∏äÁöÑÊñπÊ≥ïÊòØ‰ªÄ‰πàÂë¢ÔºüÂèØ‰ª•Âú® lldb ‰∏≠ÈÄöËøá dis ÂëΩ‰ª§ÂèçÊ±áÁºñËæìÂá∫Ôºö Âú® MachOView ‰∏≠Ëøô‰∏™Âú∞ÂùÄÁöÑÊï∞ÊçÆ‰∏∫ 1F2003D5F0A0005800021FD6 „ÄÇËøôÊòØ‰∏ÄÊÆµ16ËøõÂà∂ÁöÑÊú∫Âô®Á†Å„ÄÇÊàë‰ª¨ÂèØ‰ª•È™åËØÅ‰∏Ä‰∏ãÂÆÉÂíåÂèçÊ±áÁºñÁöÑÁªìÊûúÊòØÂê¶‰∏ÄËá¥„ÄÇÂ¶ÇÊûúÊàë‰ª¨Ëá™Â∑±Êü•Ë°®‰ºöÈùûÂ∏∏Ë¥π‰∫ãÔºåÊúâ‰∏Ä‰∏™ ARM to Hex ÁöÑÁΩëÁ´ôÔºåÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨Â∞ÜÊ±áÁºñ‰ª£Á†ÅËΩ¨Êç¢‰∏∫ Hex„ÄÇÊàë‰ª¨Âè™È™åËØÅÁ¨¨‰∫åÂè•Ê±áÁºñËØ≠Âè•ÁöÑÊ≠£Á°ÆÊÄßÔºö ÈÄöËøáÂØπÊØîÂèØ‰ª•ÂèëÁé∞ÔºåMachOView ‰∏≠Áõ∏Â∫î offset ÁöÑ Data ÂèçÊ±áÁºñÂêéÂ∞±ÊòØ dis ÁîüÊàêÁöÑÊ±áÁºñ‰ª£Á†Å„ÄÇ ÈáçÊñ∞Áúã‰∏Ä‰∏ãÂèçÊ±áÁºñÂêéÁöÑÁ¨¨‰∫å‰∏âÊù°Ê±áÁºñ‰ª£Á†Å„ÄÇ‰ªñ‰ª¨ÁöÑ‰ΩúÁî®ÊòØÂä†ËΩΩÁõ∏ÂØπ‰∫éÂΩìÂâçÂú∞ÂùÄÔºåÂÅèÁßªÈáè‰∏∫ 0x141c ÁöÑÂÜÖÂ≠òÂà∞ÂØÑÂ≠òÂô® x16 ‰∏≠ÔºåÁÑ∂ÂêéÊâßË°å„ÄÇÂÆûÈôÖÊâßË°åÁöÑÂú∞ÂùÄÁöÑËÆ°ÁÆóËøáÁ®ãÂ¶Ç‰∏ãÔºö 0x141c + 0x6BF4 = 0x8010 Á¨¨‰∏ÄÊù°Ê±áÁºñ‰ª£Á†Å offset ‰∏∫ 0x6BF0ÔºåÈÇ£‰πàÁ¨¨‰∫åÊù°Ê±áÁºñ‰ª£Á†Å offset Âç≥‰∏∫ 0x6BF4 Âú® MachOView ‰∏≠‰ΩìÁé∞‰∏∫ __DATA,__la_symbol_ptrÔºö Âú® 0x8010 ÁöÑÂú∞ÂùÄ‰∏äÁöÑ data ‰∏∫ 0x0000000100006C2C„ÄÇÂâçÈù¢ËØ¥Âà∞Ôºå __Text ËôöÊãüÂú∞ÂùÄÈªòËÆ§ÊòØ 0x100000000ÔºåËøôÂú® TEXT ÊÆµÁöÑ Load Commands ‰∏≠ÊúâÊâÄ‰ΩìÁé∞Ôºö ÊâÄ‰ª•ÂÆûÈôÖÁöÑÂÅèÁßªÂú∞ÂùÄ‰∏∫ 0x6C2C„ÄÇÂÆÉÁöÑÂú∞ÂùÄÂú® __Text,__stub_helper ‰∏≠Ôºö __Text,__stub_helper ‰ºöË∞ÉÁî® dyld_stu_binder ÊñπÊ≥ïËÆ°ÁÆóÂπ∂ÁªëÂÆö NSLog ÂáΩÊï∞ÁöÑÁúüÂÆûÂú∞ÂùÄ„ÄÇ ËÆ©Á®ãÂ∫èËµ∞ËøáËøô‰∏™ÊñπÊ≥ïÔºåÂÜçÊ¨°ÈÄöËøá dis Êü•ÁúãÊ±áÁºñ‰ª£Á†ÅÔºö Ê≠§Ê¨°ÊâßË°åÁöÑÊñπÊ≥ïÂú∞ÂùÄ‰∏çÂÜçÊòØ 0x10470ec2cÔºåËÄåÊòØ 0x2065176e6„ÄÇ‰πüÂ∞±ÊòØËØ¥ËøõËøá‰∫ÜÁªëÂÆö‰πãÂêéÔºå __Text,__stub ÁöÑÊñπÊ≥ïÊåáÂêëÂèëÁîü‰∫ÜÊîπÂèòÔºåÊåáÂêë‰∫ÜÁ≥ªÁªüÁöÑÂä®ÊÄÅÂ∫ìÁöÑÊñπÊ≥ï„ÄÇËá≥Ê≠§ÂÆåÊàê‰∫Ü lazy binding ÁöÑËøáÁ®ã„ÄÇ ‰ªé‰æãÂ≠êÁúãÈùû lazy bindingÈùû lazy binding ÁöÑÁ¨¶Âè∑‰ºöÂú®Â∫îÁî®ÂêØÂä®ÁöÑÊó∂ÂÄôÂ∞± binding ÂÆåÊàê„ÄÇÊàë‰ª¨ÁÆÄÂçïÈ™åËØÅ‰∏Ä‰∏ã„ÄÇÈ¶ñÂÖàÁúã __DATA,_nl_symbol_ptr ÊÆµÂú® MachOView ‰∏≠ÁöÑÁ¨¶Âè∑‰ø°ÊÅØÔºåÂú® MachOView ‰∏≠ÁöÑÈùû lazy binding Á¨¶Âè∑ÊåáÂêëÁöÑÂú∞ÂùÄÈÉΩÊòØ 0x0Ôºö ÂΩìÁ®ãÂ∫èËøêË°åÂπ∂Âä†ËΩΩÊàêÂäüÂêéÔºåÊàë‰ª¨ÂÜçÁúãÁõ∏Â∫î‰ΩçÁΩÆÁöÑ dataÔºö ÂèØ‰ª•ÁúãÂà∞Áõ∏Â∫î‰ΩçÁΩÆÂ∑≤Áªè‰∏çÂÜçÊòØ 0x0ÔºåËÄåÊòØÂÖ∑‰ΩìÁöÑÈìæÊé•ÂÆåÊàêÂêéÁöÑÂú∞ÂùÄ‰∫Ü„ÄÇ fishhookÈÄöËøá‰∏äÈù¢ÁöÑ‰∏§‰∏™‰æãÂ≠êÁöÑÂàÜÊûêÔºåÊàë‰ª¨ËÉΩÁü•ÈÅìÔºåÂä®ÊÄÅÈìæÊé•ÁöÑÁ¨¶Âè∑‰∏çÊòØ‰Ωç‰∫éÁ®ãÂ∫èÁöÑ __Text ÊÆµÁöÑÔºåËÄåÊòØÂ≠òÂú®‰∫é __DATA ÊÆµ‰∏≠„ÄÇ‰Ωç‰∫é __Text ÊÆµÁöÑÁ¨¶Âè∑ÊòØÂè™ËØªÁöÑÔºåËÄå‰Ωç‰∫é __DATA ÊÆµÁöÑÁ¨¶Âè∑ÊòØÂèØËØªÂèØÂÜôÁöÑ ËøôÁßçÊáíÁªëÂÆöÁöÑÊñπÂºèÂÖ∂ÂÆûÂè´ÂÅö PIC(Position Independent Code Âú∞ÂùÄÊó†ÂÖ≥‰ª£Á†Å)Ôºåfishhook ËÉΩÂ§üÂ∏ÆÂä©Êàë‰ª¨‰øÆÊîπËøôÈÉ®ÂàÜÁ¨¶Âè∑ÁöÑÂú∞ÂùÄ ‰ΩøÁî®fishhook ÁöÑ‰ΩøÁî®ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™ rebinding ÁªìÊûÑ‰ΩìÔºåÁªìÊûÑ‰Ωì‰∏≠ÈúÄË¶ÅÂåÖÂê´Ë¶Å hook ÁöÑÂáΩÊï∞ÁöÑÂêçÁß∞ÔºåË¶ÅÊõøÊç¢ÁöÑÊñπÊ≥ïÂÆûÁé∞ÔºåË¢´ hook ÁöÑÊñπÊ≥ïÁöÑÂÆπÂô®Ôºö 12345678910111213141516171819202122232425262728293031323334353637@implementation ViewController- (void)viewDidLoad &#123; [super viewDidLoad]; // ÂÆö‰πârebinding ÁªìÊûÑ‰Ωì struct rebinding rebind = &#123;&#125;; // ÈúÄË¶ÅhookÁöÑÂáΩÊï∞ÂêçÁß∞ rebind.name = "NSLog"; // Êñ∞ÂáΩÊï∞ÁöÑÂú∞ÂùÄ rebind.replacement = hookNSLog; // ÂéüÂßãÂáΩÊï∞Âú∞ÂùÄÁöÑÊåáÈíà rebind.replaced = (void *)&amp;sys_NSLog; //Â∞Ü‰∏äÈù¢ÁöÑÁªìÊûÑ‰Ωì ÊîæÂÖ• rebÁªìÊûÑ‰ΩìÊï∞ÁªÑ‰∏≠ struct rebinding rebindObj[] = &#123;rebind&#125;; /* * arg1 : ÁªìÊûÑ‰ΩìÊï∞ÊçÆÁªÑ * arg2 : Êï∞ÁªÑÁöÑÈïøÂ∫¶ */ rebind_symbols(rebindObj, 1);&#125;//ÂÆö‰πâ‰∏Ä‰∏™ÂáΩÊï∞ÊåáÈíà Áî®‰∫éÊåáÂêëÂéüÊù•ÁöÑNSLogÂáΩÊï∞static void (*sys_NSLog)(NSString *format, ...);void hookNSLog(NSString *format, ...)&#123; format = [format stringByAppendingString:@"Ë¢´Âãæ‰Ωè‰∫Ü"]; sys_NSLog(format);&#125;- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123; NSLog(@"ÂéüÊúâNSLogÂáΩÊï∞");&#125;@end Ê∫êÁ†ÅËß£Êûêrebind_symbols ÊñπÊ≥ïÂÖà‰ªéË∞ÉÁî®ÊñπÊ≥ï rebind_symbols ÊñπÊ≥ïÂÖ•ÊâãÔºö 12345678910111213141516171819202122232425262728293031struct rebindings_entry &#123; struct rebinding *rebindings; size_t rebindings_nel; struct rebindings_entry *next;&#125;;static struct rebindings_entry *_rebindings_head;int rebind_symbols(struct rebinding rebindings[], size_t rebindings_nel) &#123; // Áª¥Êä§‰∏Ä‰∏™ rebindings_entry ÁöÑÁªìÊûÑ // Â∞Ü rebinding ÁöÑÂ§ö‰∏™ÂÆû‰æãÁªÑÁªáÊàê‰∏Ä‰∏™ÈìæË°® int retval = prepend_rebindings(&amp;_rebindings_head, rebindings, rebindings_nel); // Âà§Êñ≠ÊòØÂê¶ malloc Â§±Ë¥•ÔºåÂ§±Ë¥•‰ºöËøîÂõû -1 if (retval &lt; 0) &#123; return retval; &#125; // _rebindings_head -&gt; next ÊòØÁ¨¨‰∏ÄÊ¨°Ë∞ÉÁî®ÁöÑÊ†áÂøóÁ¨¶ÔºåNULL Âàô‰ª£Ë°®Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî® if (!_rebindings_head-&gt;next) &#123; // Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî®ÔºåÂ∞Ü _rebind_symbols_for_image Ê≥®ÂÜå‰∏∫ÂõûË∞É _dyld_register_func_for_add_image(_rebind_symbols_for_image); &#125; else &#123; // ÂÖàËé∑Âèñ dyld ÈïúÂÉèÊï∞Èáè uint32_t c = _dyld_image_count(); for (uint32_t i = 0; i &lt; c; i++) &#123; // Ê†πÊçÆ‰∏ãÊ†á‰æùÊ¨°ËøõË°åÈáçÁªëÂÆöËøáÁ®ã _rebind_symbols_for_image(_dyld_get_image_header(i), _dyld_get_image_vmaddr_slide(i)); &#125; &#125; // ËøîÂõûÁä∂ÊÄÅÂÄº return retval;&#125; ÂÖàÁúã prepend_rebindings ÊñπÊ≥ïÔºåÂÆÉ‰ºöÊää‰º†ÂÖ•ÁöÑ rebindings Êï∞ÁªÑ‰∏≤Êàê‰∏Ä‰∏™ÈìæË°®ÔºåÈìæË°®ÁöÑÂ§¥ÈÉ®Áî® _rebindings_head ‰øùÂ≠òÔºö 123456789101112131415161718192021222324252627282930/** * prepend_rebindings Áî®‰∫é rebindings_entry ÁªìÊûÑÁöÑÁª¥Êä§ * struct rebindings_entry **rebindings_head - ÂØπÂ∫îÁöÑÊòØ static ÁöÑ _rebindings_head * struct rebinding rebindings[] - ‰º†ÂÖ•ÁöÑÊñπÊ≥ïÁ¨¶Âè∑Êï∞ÁªÑ * size_t nel - Êï∞ÁªÑÂØπÂ∫îÁöÑÂÖÉÁ¥†Êï∞Èáè */static int prepend_rebindings(struct rebindings_entry **rebindings_head, struct rebinding rebindings[], size_t nel) &#123; // Â£∞Êòé rebindings_entry ‰∏Ä‰∏™ÊåáÈíàÔºåÂπ∂‰∏∫ÂÖ∂ÂàÜÈÖçÁ©∫Èó¥ struct rebindings_entry *new_entry = (struct rebindings_entry *) malloc(sizeof(struct rebindings_entry)); if (!new_entry) &#123; return -1; &#125; // ‰∏∫ÈìæË°®‰∏≠ÂÖÉÁ¥†ÁöÑ rebindings ÂÆû‰æãÂàÜÈÖçÊåáÂÆöÁ©∫Èó¥ new_entry-&gt;rebindings = (struct rebinding *) malloc(sizeof(struct rebinding) * nel); if (!new_entry-&gt;rebindings) &#123; free(new_entry); return -1; &#125; // Â∞Ü rebindings Êï∞ÁªÑ‰∏≠ copy Âà∞ new_entry -&gt; rebingdings ÊàêÂëò‰∏≠ memcpy(new_entry-&gt;rebindings, rebindings, sizeof(struct rebinding) * nel); // ‰∏∫ new_entry -&gt; rebindings_nel ËµãÂÄº new_entry-&gt;rebindings_nel = nel; // ‰∏∫ new_entry -&gt; next ËµãÂÄºÔºåÁª¥Êä§ÈìæË°®ÁªìÊûÑ new_entry-&gt;next = *rebindings_head; // ÁßªÂä® head ÊåáÈíàÔºåÊåáÂêëË°®Â§¥ *rebindings_head = new_entry; return 0;&#125; Âú®ËøõË°åËøá‰∫ÜÂèØËÉΩÁöÑÂ§öÊ¨° prepend_rebindings ÊñπÊ≥ïÂêéÔºå‰ºöÂΩ¢ÊàêÂ¶Ç‰∏ãÈìæË°®Ôºö ÂΩìÁÑ∂Áî±‰∫éÊúÄÂºÄÂßã rebindgs_header ÊòØ nullÔºåÊâÄ‰ª• next_entry-&gt;next = *rebindings_headr Â∞±ÊòØ nullÔºå‰πüÂ∞±ÊòØËØ¥ *rebinding_head = new_entry ÂêéÔºå *rebinding_head-&gt;next ‰∏∫ null„ÄÇÂú® rebind_symbolds ÊñπÊ≥ï‰∏≠‰ºöÊâßË°å _dyld_register_func_for_add_image(_rebind_symbols_for_image); ÊñπÊ≥ï„ÄÇ _dyld_register_func_for_add_image ÊñπÊ≥ïÊòØ dyld Ê≥®ÂÜåÂõûË∞ÉÂáΩÊï∞ÁöÑÊñπÊ≥ïÔºåÂΩìÈïúÂÉèË¢´Âä†ËΩΩÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºö‰∏ªÂä®Ëß¶ÂèëÊ≥®ÂÜåÁöÑÂõûË∞ÉÊñπÊ≥ï„ÄÇ ‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂‰ºöÂä†ËΩΩÈùûÂ∏∏Â§öÁöÑÂä®ÊÄÅÂ∫ìÔºåÊØè‰∏™Âä®ÊÄÅÂ∫ìÁöÑÊàêÂäüÂä†ËΩΩÈÉΩ‰ºöËß¶ÂèëÊ≥®ÂÜåÁöÑÂõûË∞ÉÊñπÊ≥ï„ÄÇÊØè‰∏™Âä®ÊÄÅÂ∫ìÈïúÂÉèÈÉΩ‰ºöÊ†πÊçÆËÆæÁΩÆÈáçÁªëÂÆöÁ¨¶Âè∑ Ê≠§Â§ÑÊ≥®ÂÜå‰∫Ü _rebind_symbols_for_image ÊñπÊ≥ïÔºö 1234static void _rebind_symbols_for_image(const struct mach_header *header, intptr_t slide) &#123; rebind_symbols_for_image(_rebindings_head, header, slide);&#125; _rebind_symbols_for_image ÊñπÊ≥ïÈùûÂ∏∏ÁöÑÊú¥ÂÆûÔºåÂÆÉ‰ºöÂèóÂà∞ dyld Âä†ËΩΩÊàêÂäüÊó∂ÂÄô‰º†ÂÖ•ÁöÑ‰∏§‰∏™ÂèÇÊï∞ mach_header *header Âíå intptr_t slide„ÄÇËøô‰∏§‰∏™ÂèÇÊï∞ÂàÜÂà´ÊòØÂΩìÂâçÂèØÊâßË°åÊñá‰ª∂ÁöÑÂÜÖÂ≠òÂú∞ÂùÄÂíå ASLR ÂÅèÁßªÈáè„ÄÇ‰πüÂ∞±ÊòØËØ¥ mach_header *header Â∞±ÊòØÈÄöËøá image list Ëé∑ÂèñÂà∞ÁöÑÂú∞ÂùÄÔºåÂ¶Ç‰∏ãÂõæÔºö Âè¶Â§ñÂèØ‰ª•ÂèëÁé∞ mach_header *header Âíå intptr_t slide Áõ∏Â∑ÆÂ∞±ÊòØ 0x100000000Ôºå‰πü‰æßÈù¢Âç∞ËØÅ‰∫Ü mach_header *header Â∞±ÊòØ __Text ÊÆµÁöÑÂÆûÈôÖËµ∑ÂßãÂú∞ÂùÄ rebind_symbols_for_image ÊñπÊ≥ïËøõÂÖ• rebind_symbols_for_image ÊñπÊ≥ïÔºåËøôÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÈáçË¶ÅÁöÑÊñπÊ≥ïÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜÂÖ∂ÂàÜ‰∏∫Âá†‰∏™Èò∂ÊÆµÊù•Áúã„ÄÇ Ëé∑ÂèñÂä®ÊÄÅÈùôÊÄÅÁ¨¶Âè∑Ë°®‰ΩçÁΩÆ‰ª•Âèä linkedit_segment ÁöÑ load command ‰ΩçÁΩÆËøô‰∏ÄÈÉ®ÂàÜÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÈÄöËøáÈÅçÂéÜ load commands ÊâæÂà∞ symtab_command Âíå dysymtab_command ‰ª•Âèä linkedit_segment ÁöÑ‰ΩçÁΩÆÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243static void rebind_symbols_for_image(struct rebindings_entry *rebindings, const struct mach_header *header, intptr_t slide) &#123; ... // Â£∞ÊòéÂá†‰∏™Êü•ÊâæÈáè: // linkedit_segment, symtab_command, dysymtab_command segment_command_t *cur_seg_cmd; segment_command_t *linkedit_segment = NULL; struct symtab_command* symtab_cmd = NULL; struct dysymtab_command* dysymtab_cmd = NULL; // ÂàùÂßãÂåñÊ∏∏Ê†á // header = 0x100000000 + ASLR ÂÅèÁßª // sizeof(mach_header_t) = ÈªòËÆ§ 0x20 (Mach-O Â§¥ÈÉ®Â§ßÂ∞è) // È¶ñÂÖàÈúÄË¶ÅË∑≥Ëøá Mach-O Header uintptr_t cur = (uintptr_t)header + sizeof(mach_header_t); // ÈÅçÂéÜÊØè‰∏Ä‰∏™ Load CommandÔºåÊ∏∏Ê†áÊØè‰∏ÄÊ¨°ÂÅèÁßªÊØè‰∏™ÂëΩ‰ª§ÁöÑ Command Size Â§ßÂ∞è // header -&gt; ncmds: Load Command Âä†ËΩΩÂëΩ‰ª§Êï∞Èáè // cur_seg_cmd -&gt; cmdsize: Load Â§ßÂ∞è for (uint i = 0; i &lt; header-&gt;ncmds; i++, cur += cur_seg_cmd-&gt;cmdsize) &#123; // ÂèñÂá∫ÂΩìÂâçÁöÑ Load Command cur_seg_cmd = (segment_command_t *)cur; // Load Command ÁöÑÁ±ªÂûãÊòØ LC_SEGMENT if (cur_seg_cmd-&gt;cmd == LC_SEGMENT_ARCH_DEPENDENT) &#123; // ÊØîÂØπ‰∏Ä‰∏ã Load Command ÁöÑ name ÊòØÂê¶‰∏∫ __LINKEDIT if (strcmp(cur_seg_cmd-&gt;segname, SEG_LINKEDIT) == 0) &#123; // Ê£ÄÁ¥¢Âà∞ __LINKEDIT linkedit_segment = cur_seg_cmd; &#125; &#125; // Âà§Êñ≠ÂΩìÂâç Load Command ÊòØÂê¶ÊòØ LC_SYMTAB Á±ªÂûã // LC_SEGMENT - ‰ª£Ë°®ÂΩìÂâçÂå∫ÂüüÈìæÊé•Âô®‰ø°ÊÅØ else if (cur_seg_cmd-&gt;cmd == LC_SYMTAB) &#123; // Ê£ÄÁ¥¢Âà∞ LC_SYMTAB symtab_cmd = (struct symtab_command*)cur_seg_cmd; &#125; // Âà§Êñ≠ÂΩìÂâç Load Command ÊòØÂê¶ÊòØ LC_DYSYMTAB Á±ªÂûã // LC_DYSYMTAB - ‰ª£Ë°®Âä®ÊÄÅÈìæÊé•Âô®‰ø°ÊÅØÂå∫Âüü else if (cur_seg_cmd-&gt;cmd == LC_DYSYMTAB) &#123; // Ê£ÄÁ¥¢Âà∞ LC_DYSYMTAB dysymtab_cmd = (struct dysymtab_command*)cur_seg_cmd; &#125; &#125;&#125; ÂâçÈù¢ÊèêÂà∞ËøáÔºåÂú® Mach-O Âä†ËΩΩËøõÂÜÖÂ≠òÂêéÔºå__Text ÊÆµÁöÑËµ∑Âßã‰ΩçÁΩÆÊó∂ 0x100000000ÔºåÂπ∂‰∏îÊâÄÊúâ offset ÈÉΩÊòØ‰ª• __Text ÊÆµ‰∏∫Âü∫ÂáÜÁöÑ„ÄÇheader Âíå load commands ‰πüÊòØÂ±û‰∫é __Text ÊÆµÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ‰∏äÈù¢ÁöÑ‰ª£Á†ÅÊ≠£Âç∞ËØÅ‰∫ÜËøô‰∏™ËßÇÁÇπ„ÄÇ ËÆ°ÁÆóÈùôÊÄÅÁ¨¶Âè∑Ë°®ÂíåÂä®ÊÄÅÁ¨¶Âè∑Ë°®‰ª•ÂèäÂ≠óÁ¨¶‰∏≤Ë°®ÁöÑ‰ΩçÁΩÆÂâçÈù¢ÊãøÂà∞‰∫ÜÈùôÊÄÅÁ¨¶Âè∑Ë°®‰ª•ÂèäÂä®ÊÄÅÁ¨¶Âè∑Ë°®ÁöÑ load commandÔºåÁé∞Âú®Â∞±ÂèØ‰ª•Ê†πÊçÆ load command ‰∏≠ÁöÑ‰ø°ÊÅØËÆ°ÁÆóÂæóÂà∞ÈùôÊÄÅÁ¨¶Âè∑Ë°®,Âä®ÊÄÅÁ¨¶Âè∑Ë°®‰ª•ÂèäÂ≠óÁ¨¶‰∏≤Ë°®ÁöÑ‰ΩçÁΩÆ‰∫ÜÔºö 1234567891011121314151617static void rebind_symbols_for_image(struct rebindings_entry *rebindings, const struct mach_header *header, intptr_t slide) &#123; ... // slide: ASLR ÂÅèÁßªÈáè // vmaddr: SEG_LINKEDIT ÁöÑËôöÊãüÂú∞ÂùÄ // fileoff: SEG_LINKEDIT Âú∞ÂùÄÂÅèÁßª // Âºè‚ë†Ôºöbase = SEG_LINKEDITÁúüÂÆûÂú∞ÂùÄ - SEG_LINKEDITÂú∞ÂùÄÂÅèÁßª // Âºè‚ë°ÔºöSEG_LINKEDITÁúüÂÆûÂú∞ÂùÄ = SEG_LINKEDITËôöÊãüÂú∞ÂùÄ + ASLRÂÅèÁßªÈáè // Â∞Ü‚ë°‰ª£ÂÖ•‚ë†ÔºöBase = SEG_LINKEDITËôöÊãüÂú∞ÂùÄ + ASLRÂÅèÁßªÈáè - SEG_LINKEDITÂú∞ÂùÄÂÅèÁßª uintptr_t linkedit_base = (uintptr_t)slide + linkedit_segment-&gt;vmaddr - linkedit_segment-&gt;fileoff; // ÈÄöËøá base + symtab ÁöÑÂÅèÁßªÈáè ËÆ°ÁÆó symtab Ë°®ÁöÑÈ¶ñÂú∞ÂùÄÔºåÂπ∂Ëé∑Âèñ nlist_t ÁªìÊûÑ‰ΩìÂÆû‰æã nlist_t *symtab = (nlist_t *)(linkedit_base + symtab_cmd-&gt;symoff); // ÈÄöËøá base + stroff Â≠óÁ¨¶Ë°®ÂÅèÁßªÈáèËÆ°ÁÆóÂ≠óÁ¨¶Ë°®‰∏≠ÁöÑÈ¶ñÂú∞ÂùÄÔºåËé∑ÂèñÂ≠óÁ¨¶‰∏≤Ë°® char *strtab = (char *)(linkedit_base + symtab_cmd-&gt;stroff); // ÈÄöËøá base + indirectsymoff ÂÅèÁßªÈáèÊù•ËÆ°ÁÆóÂä®ÊÄÅÁ¨¶Âè∑Ë°®ÁöÑÈ¶ñÂú∞ÂùÄ uint32_t *indirect_symtab = (uint32_t *)(linkedit_base + dysymtab_cmd-&gt;indirectsymoff);&#125; ËøôÈáåÈÄöËøá linkedit ËÆ°ÁÆóÂü∫Âú∞ÂùÄÔºåÊâÄÊúâÁöÑÂÅèÁßªÈáèÈÉΩÊòØ‰ª•Âü∫Âú∞ÂùÄ‰∏∫ÂèÇÁÖßÁöÑ„ÄÇËÆ°ÁÆóÂÖ¨Âºè‰∏äÈù¢‰πüÊúâÂÜôÂà∞„ÄÇËé∑ÂèñÂà∞Âü∫Âú∞ÂùÄÂêéÔºåÂ∞±ÂèØ‰ª•ÈÄöËøáÂâçÈù¢Ëé∑ÂèñÂà∞ÁöÑÈùôÊÄÅÁ¨¶Âè∑Ë°®‰ª•ÂèäÂä®ÊÄÅÁ¨¶Âè∑Ë°®ÁöÑ load commands ‰∏≠‰øùÂ≠òÁöÑÂÅèÁßªÈáèËÆ°ÁÆóÂæóÂà∞Á¨¶Âè∑Ë°® symtabÔºåÂ≠óÁ¨¶‰∏≤Ë°® strtab ‰ª•ÂèäÂä®ÊÄÅÁ¨¶Âè∑Ë°® indirect_symtab ÁöÑ‰ΩçÁΩÆ‰∫Ü„ÄÇ Ë∑≥ËΩ¨ÈáçÁªëÂÆö‰πãÂêéÔºåÈáçÊñ∞ÈÅçÂéÜ load commandsÔºåËé∑Âèñ __DATA ÊÆµ‰∏≠ÁöÑ __nl_symbol_ptr Âíå __la_symbol_ptr ‰∏§‰∏™ section ÁöÑ‰ø°ÊÅØÔºåÁÑ∂ÂêéÊâßË°åÁúüÊ≠£ÁöÑÈáçÁªëÂÆöÊñπÊ≥ï perform_rebinding_with_sectionÔºö 12345678910111213141516171819202122232425262728293031323334static void rebind_symbols_for_image(struct rebindings_entry *rebindings, const struct mach_header *header, intptr_t slide) &#123; ... // ÂΩíÈõ∂Ê∏∏Ê†á cur = (uintptr_t)header + sizeof(mach_header_t); // ÂÜçÊ¨°ÈÅçÂéÜ Load Commands for (uint i = 0; i &lt; header-&gt;ncmds; i++, cur += cur_seg_cmd-&gt;cmdsize) &#123; cur_seg_cmd = (segment_command_t *)cur; // Load Command ÁöÑÁ±ªÂûãÊòØ LC_SEGMENT if (cur_seg_cmd-&gt;cmd == LC_SEGMENT_ARCH_DEPENDENT) &#123; // Êü•ËØ¢ Segment Name„ÄÇ‰∏çÊòØ __DATA ÊàñËÄÖ __DATA_CONST ÁöÑÁõ¥Êé• return if (strcmp(cur_seg_cmd-&gt;segname, SEG_DATA) != 0 &amp;&amp; strcmp(cur_seg_cmd-&gt;segname, SEG_DATA_CONST) != 0) &#123; continue; &#125; // ÈÅçÂéÜ Segment ‰∏≠ÁöÑ Section for (uint j = 0; j &lt; cur_seg_cmd-&gt;nsects; j++) &#123; // ÂèñÂá∫ Section section_t *sect = (section_t *)(cur + sizeof(segment_command_t)) + j; // flags &amp; SECTION_TYPE ÈÄöËøá SECTION_TYPE Êé©Á†ÅËé∑Âèñ flags ËÆ∞ÂΩïÁ±ªÂûãÁöÑ 8 bit // Â¶ÇÊûú section ÁöÑÁ±ªÂûã‰∏∫ S_LAZY_SYMBOL_POINTERS // Ëøô‰∏™Á±ªÂûã‰ª£Ë°® lazy symbol ÊåáÈíà Section if ((sect-&gt;flags &amp; SECTION_TYPE) == S_LAZY_SYMBOL_POINTERS) &#123; // ËøõË°å rebinding ÈáçÂÜôÊìç‰Ωú perform_rebinding_with_section(rebindings, sect, slide, symtab, strtab, indirect_symtab); &#125; // Ëøô‰∏™Á±ªÂûã‰ª£Ë°® non-lazy symbol ÊåáÈíà Section if ((sect-&gt;flags &amp; SECTION_TYPE) == S_NON_LAZY_SYMBOL_POINTERS) &#123; perform_rebinding_with_section(rebindings, sect, slide, symtab, strtab, indirect_symtab); &#125; &#125; &#125; &#125;&#125; ÈáçÁªëÂÆöËøôÊòØÊâßË°åÊñπÊ≥ïÊõøÊç¢ÁöÑÊúÄÂÖ≥ÈîÆÊñπÊ≥ïÔºåÊàë‰ª¨ÂÖàÁúã‰∏Ä‰∏ã‰ª£Á†ÅÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546static void perform_rebinding_with_section(struct rebindings_entry *rebindings, section_t *section, intptr_t slide, nlist_t *symtab, char *strtab, uint32_t *indirect_symtab) &#123; // Âú® Indirect Symbol table ‰∏≠Ê£ÄÁ¥¢Âà∞ __la_symbol_ptr ÊàñËÄÖ __nl_symbol_ptr Ëµ∑ÂßãÁöÑ‰ΩçÁΩÆ uint32_t *indirect_symbol_indices = indirect_symtab + section-&gt;reserved1; // Ëé∑Âèñ _DATA.__nl_symbol_ptr(Êàñ__la_symbol_ptr) Section // Â∑≤Áü•ÂÖ∂ value ÊòØ‰∏Ä‰∏™ÊåáÈíàÁ±ªÂûãÔºåÊï¥ÊÆµÂå∫ÂüüÁî®‰∫åÈò∂ÊåáÈíàÊù•Ëé∑Âèñ void **indirect_symbol_bindings = (void **)((uintptr_t)slide + section-&gt;addr); // Áî® size / ‰∏ÄÈò∂ÊåáÈíàÊù•ËÆ°ÁÆó _DATA.__nl_symbol_ptr(Êàñ__la_symbol_ptr) ‰∏≠Á¨¶Âè∑ÁöÑ‰∏™Êï∞ÔºåÈÅçÂéÜÊï¥‰∏™ Section for (uint i = 0; i &lt; section-&gt;size / sizeof(void *); i++) &#123; // ÈÄöËøá‰∏ãÊ†áÊù•Ëé∑ÂèñÊØè‰∏Ä‰∏™ Indirect Address ÁöÑ Value // Ëøô‰∏™ Value ‰πüÊòØÂ§ñÂ±ÇÂØªÂùÄÊó∂ÈúÄË¶ÅÁöÑ‰∏ãÊ†á uint32_t symtab_index = indirect_symbol_indices[i]; if (symtab_index == INDIRECT_SYMBOL_ABS || symtab_index == INDIRECT_SYMBOL_LOCAL || symtab_index == (INDIRECT_SYMBOL_LOCAL | INDIRECT_SYMBOL_ABS)) &#123; continue; &#125; // Ëé∑ÂèñÁ¨¶Âè∑ÂêçÂú®Â≠óÁ¨¶Ë°®‰∏≠ÁöÑÂÅèÁßªÂú∞ÂùÄ uint32_t strtab_offset = symtab[symtab_index].n_un.n_strx; // Ëé∑ÂèñÁ¨¶Âè∑Âêç char *symbol_name = strtab + strtab_offset; // ÂèñÂá∫ rebindings ÁªìÊûÑ‰ΩìÂÆû‰æãÊï∞ÁªÑÔºåÂºÄÂßãÈÅçÂéÜÈìæË°® struct rebindings_entry *cur = rebindings; while (cur) &#123; // ÂØπ‰∫éÈìæË°®‰∏≠ÊØè‰∏Ä‰∏™ rebindings Êï∞ÁªÑÁöÑÊØè‰∏Ä‰∏™ rebinding ÂÆû‰æã // ‰æùÊ¨°Âú® String Table ÂåπÈÖçÁ¨¶Âè∑Âêç for (uint j = 0; j &lt; cur-&gt;rebindings_nel; j++) &#123; // Á¨¶Âè∑Âêç‰∏éÊñπÊ≥ïÂêçÂåπÈÖç if (strcmp(&amp;symbol_name[1], cur-&gt;rebindings[j].name) == 0) &#123; // Â¶ÇÊûúÊòØÁ¨¨‰∏ÄÊ¨°ÂØπË∑≥ËΩ¨Âú∞ÂùÄËøõË°åÈáçÂÜô if (cur-&gt;rebindings[j].replaced != NULL &amp;&amp; indirect_symbol_bindings[i] != cur-&gt;rebindings[j].replacement) &#123; // ËÆ∞ÂΩïÂéüÂßãË∑≥ËΩ¨Âú∞ÂùÄ *(cur-&gt;rebindings[j].replaced) = indirect_symbol_bindings[i]; &#125; // ÈáçÂÜôË∑≥ËΩ¨Âú∞ÂùÄ indirect_symbol_bindings[i] = cur-&gt;rebindings[j].replacement; // ÂÆåÊàêÂêé‰∏çÂÜçÂØπÂΩìÂâç Indirect Symbol Â§ÑÁêÜ // ÁªßÁª≠Ëø≠‰ª£Âà∞‰∏ã‰∏Ä‰∏™ Indirect Symbol goto symbol_loop; &#125; &#125; // ÈìæË°®ÈÅçÂéÜ cur = cur-&gt;next; &#125; symbol_loop:; &#125;&#125; Ëé∑Âèñ __la_symbol_ptr ÊàñËÄÖ __nl_symbol_ptr ÁöÑÁ¨¶Âè∑Âú®Âä®ÊÄÅÁ¨¶Âè∑Ë°®ÁöÑ‰ΩçÁΩÆ1uint32_t *indirect_symbol_indices = indirect_symtab + section-&gt;reserved1; indirect_symtab ÊòØ Dynamic Symbol Table ÊÆµÔºö ÂÆÉÊ±áÈõÜ‰∫Ü __Text,__stubs ,__DATA,__nl_symbol_ptr,__DATA,__gotÔºå __DATA,__la_symbol_ptr ËøôÂá†‰∏™ÊÆµÁöÑÊâÄÊúâÂä®ÊÄÅÈìæÊé•Á¨¶Âè∑ÁöÑÊâÄÊúâ‰ø°ÊÅØ„ÄÇ section Â∞±ÊòØ‰∏äÈù¢Ëé∑ÂèñÂà∞ÁöÑÂú® Load CommandÊòØ‰∏≠ÁöÑ __la_symbol_ptr ‰ª•Âèä __nl_symbol_ptr ÊÆµÁöÑ‰ø°ÊÅØÔºåÂÆÉÁöÑ reserved1 Â∞±ÊòØËØ•ÊÆµÂú® Dynamic Symbol Table ‰∏≠ÁöÑ‰ΩçÁΩÆ„ÄÇÂú® MachOView ‰∏≠ÊòæÁ§∫‰∏∫ Indirect Sym Index: Áî±‰∫é indirect_symtab ÊòØ uint32 Á±ªÂûãÁöÑÊåáÈíàÔºåÊâÄ‰ª•‰∏Ä‰∏™ÊåáÈíàÂç†Áî®4‰∏™Â≠óËäÇ„ÄÇÂõ†Ê≠§ÂÅèÁßª reserved1Âç≥ÂÅèÁßª reserved1 * 4 ÁöÑÂú∞ÂùÄ„ÄÇ Ëé∑Âèñ __la_symbol_ptr ÊàñËÄÖ __nl_symbol_ptrÁöÑÂÆûÈôÖÂú∞ÂùÄ1void **indirect_symbol_bindings = (void **)((uintptr_t)slide + section-&gt;addr); ‰πãÂâçÊàë‰ª¨ËØ¥Ëøá‰∏Ä‰∏™ÂÖ¨ÂºèÔºö ASLRÂÅèÁßª + ÊÆµÁöÑËôöÊãüÂú∞ÂùÄ = ÊÆµÁöÑÂÆûÈôÖÂú∞ÂùÄ section-&gt;addr Â∞±ÊòØÊÆµÁöÑËôöÊãüÂú∞ÂùÄÔºåindirect_symbol_bindings Â∞±ÊòØÊåáÂêëÊÆµÁöÑÂÆûÈôÖÂú∞ÂùÄ„ÄÇÁî±‰∫é __la_symbol_ptr ÊàñËÄÖ __nl_symbol_ptr ÊÆµÂÜÖ‰øùÂ≠òÁöÑÊòØ‰∏Ä‰∏™‰∏™ÊåáÂêëÂÆûÈôÖÊñπÊ≥ïÁöÑÊåáÈíàÔºåÂõ†Ê≠§ indirect_symbol_bindings Â∞±Ë¢´Â£∞Êòé‰∏∫‰∏Ä‰∏™‰∫åÁ∫ßÊåáÈíà„ÄÇ ÈÅçÂéÜ __la_symbol_ptr ÊàñËÄÖ __nl_symbol_ptrÊõøÊç¢Á¨¶Âè∑ÂÆûÁé∞ÊñπÊ≥ï123456789101112131415161718192021for (uint i = 0; i &lt; section-&gt;size / sizeof(void *); i++) &#123; uint32_t symtab_index = indirect_symbol_indices[i]; uint32_t strtab_offset = symtab[symtab_index].n_un.n_strx; char *symbol_name = strtab + strtab_offset; struct rebindings_entry *cur = rebindings; while (cur) &#123; for (uint j = 0; j &lt; cur-&gt;rebindings_nel; j++) &#123; if (strcmp(&amp;symbol_name[1], cur-&gt;rebindings[j].name) == 0) &#123; if (cur-&gt;rebindings[j].replaced != NULL &amp;&amp; indirect_symbol_bindings[i] != cur-&gt;rebindings[j].replacement) &#123; *(cur-&gt;rebindings[j].replaced) = indirect_symbol_bindings[i]; &#125; indirect_symbol_bindings[i] = cur-&gt;rebindings[j].replacement; goto symbol_loop; &#125; &#125; cur = cur-&gt;next; &#125; symbol_loop:;&#125; ÈÅçÂéÜ __la_symbol_ptr ÊàñËÄÖ __nl_symbol_ptr ÊòØ‰∏∫‰∫ÜÂ∞ÜÊØè‰∏Ä‰∏™Âä®ÊÄÅÁ¨¶Âè∑ÂíåË¶ÅÊõøÊç¢ÁöÑÁ¨¶Âè∑ÊñπÊ≥ïÂåπÈÖçÔºåÈÇ£‰πàÈÄöËøá‰ªÄ‰πàÂåπÈÖçÁöÑÂë¢ÔºüÈÄöËøáÁ¨¶Âè∑Âêç„ÄÇ‰πüÂ∞±ÊòØÊØè‰∏™Âæ™ÁéØ‰∏≠ÁöÑÂÜÖÂÆπ„ÄÇ Ê†πÊçÆÁ¨¶Âè∑Âú® Dynamic Symbol Tabel ÁöÑ‰ΩçÁΩÆÔºåÊãøÂà∞ÂÆÉÂú® Symbol Tabel ÁöÑÁ¥¢Âºï‰ΩçÁΩÆ symtab_indexÔºåÁÑ∂ÂêéÂú® Symbol Tabel ÁöÑÁõ∏Â∫î‰ΩçÁΩÆÊãøÂà∞‰ªñÂú® String Tabel ÁöÑÂÅèÁßª strtab_offset„ÄÇËé∑ÂèñÂà∞ÂÅèÁßªÂêéÂ∞±Âä†‰∏ä string table ÁöÑÂü∫Âú∞ÂùÄÔºåÊãøÂà∞Á¨¶Âè∑ÁöÑ‰ΩçÁΩÆÔºå‰πüÂ∞±Ëé∑Âæó‰∫ÜÁ¨¶Âè∑Âêç symbol_name„ÄÇ Á¨¶Âè∑ÂêçÊãøÂà∞ÂêéÔºåÂ∞±ÂèØ‰ª•ÈÅçÂéÜËá™ÂÆö‰πâÁöÑË¶ÅÊõøÊç¢ÁöÑÁ¨¶Âè∑Êï∞ÁªÑ rebindingsÔºå‰∏Ä‰∏ÄÂåπÈÖçÁ¨¶Âè∑ÂêçÂíåË¶ÅÊõøÊç¢ÁöÑÁ¨¶Âè∑ÂêçÊòØÂê¶ÂåπÈÖç„ÄÇÂ¶ÇÊûúÂåπÈÖç‰∫ÜÔºåÂπ∂‰∏îÊ≤°ÊúâÊõøÊç¢Ëøá(ÊõøÊ≤°ÊõøÊç¢ËøáÂè™Ë¶ÅÂà§Êñ≠ rebindings ÁªìÊûÑ‰ΩìÁöÑ replaced ÊòØÂê¶‰∏∫Á©∫Âç≥ÂèØ)ÔºåÂ∞±ËÆ© indirect_symbol_bindings Áõ∏Â∫îÁöÑÁ¨¶Âè∑ÊåáÂêë rebindings Áõ∏Â∫îÁöÑ replacement ÊñπÊ≥ïÁöÑÂú∞ÂùÄ„ÄÇ Ëá≥Ê≠§Ôºåfishhook Êï¥‰∏™ÊõøÊç¢ÊµÅÁ®ãÂ∞±ÁªìÊùü‰∫Ü„ÄÇ ÊÄªÁªìÂà∞ËøôÈáå‰Ω†‰∏ÄÂÆöË¢´ÂêÑÁßçË∑≥ËΩ¨ÂíåÂêÑÁßçÂÅèÁßªÁªïÊôï‰∫Ü„ÄÇ‰∏ãÈù¢ÊàëÊù•Êï¥ÁêÜ‰∏Ä‰∏™ËøáÁ®ãÔºö lazy binding ËøáÁ®ã lazy binding ÁöÑÁ¨¶Âè∑ÊåáÂêë __TEXT,__stubs ÔºåË∞ÉÁî®ÁöÑÊó∂ÂÄô‰ºöÊâßË°å __TEXT,__stubs ÊåáÂêëÁöÑÊñπÊ≥ï„ÄÇÂÆÉ‰ºöË∞ÉÁî® __DATA,__la_symbol_ptr ÊåáÂêëÁöÑÂú∞ÂùÄ‰∏äÁöÑÊñπÊ≥ï„ÄÇ Êú™ÁªëÂÆöÊó∂Ôºå__DATA,__la_symbol_ptr ÊåáÂêëÁöÑÂú∞ÂùÄ‰∏∫ ___TEXT,stub_helperÔºåÂÆÉ‰ºöÊâßË°åÁ≥ªÁªüÂáΩÊï∞‰øÆÊîπ __DATA,__la_symbol_ptr ÁöÑÊåáÂêë„ÄÇ ÁªëÂÆöÂêéÔºå __DATA,__la_symbol_ptr ÊåáÂêëÂÆûÈôÖÁöÑÂáΩÊï∞ÁöÑÂú∞ÂùÄ fishhook ÊõøÊç¢ËøáÁ®ã ÈÄöËøáÊ≥®ÂÜåÁ≥ªÁªüÂõûË∞É _dyld_register_func_for_add_image Ëé∑Âèñ image ÁöÑËµ∑ÂßãÂú∞ÂùÄÂíå ASLR ÂÅèÁßª„ÄÇ ÈÄöËøá image ÁöÑËµ∑ÂßãÂú∞ÂùÄÔºåÂä†‰∏ä Header ÁöÑÂ§ßÂ∞è(Header Âõ∫ÂÆöÂ§ßÂ∞è‰∏∫ 0x20)ÔºåÂæóÂá∫ Load Commands ÁöÑËµ∑ÂßãÂú∞ÂùÄ ÈÅçÂéÜ Load Commands ÊãøÂà∞ __DATA,__nl_symbol_ptr Âíå __DATA,__la_symbol_ptr ÁöÑÂêÑÈ°π‰ø°ÊÅØÔºåÂåÖÊã¨ÊÆµÁöÑ‰ΩçÁΩÆÔºåÊÆµÁöÑÂ§ßÂ∞èÔºåÊÆµÂú® Dynamic Symbol Table ÁöÑËµ∑ÂßãÁ¥¢Âºï reserved1Ôºà‰πüÂ∞±ÊòØ MachOView ‰∏≠ÁöÑ Indirect Sym IndexÔºâ„ÄÇ ÂÜçÊ¨°ÈÅçÂéÜ Load Commands ÊãøÂà∞Á¨¶Âè∑Ë°®ÁöÑ LCÔºö LC_SYMTABÔºå‰ªé‰∏≠Ëé∑Âèñ Symbol Table Âíå String Table ÁöÑËµ∑Âßã‰ΩçÁΩÆÔºõÂêåÊó∂ÊãøÂà∞Âä®ÊÄÅÁ¨¶Âè∑Ë°®ÁöÑ LCÔºö LC_DYSYMTAB Ëé∑ÂèñÂä®ÊÄÅÁ¨¶Âè∑Ë°® DYSYMTABÁöÑËµ∑Âßã‰ΩçÁΩÆ; Ê†πÊçÆÁ¨¨ÂõõÊ≠•Ëé∑ÂèñÁöÑÂä®ÊÄÅÁ¨¶Âè∑Ë°®ÁöÑËµ∑Âßã‰ΩçÁΩÆÔºå‰ª•ÂèäÁ¨¨‰∏âÊ≠•Ëé∑ÂèñÁöÑËµ∑ÂßãÁ¥¢ÂºïÔºåÂú® DYSYMTAB ‰∏≠ÈÅçÂéÜ __DATA,__nl_symbol_ptr ÊàñËÄÖ __DATA,__la_symbol_ptr ÁöÑÂêÑ‰∏™Á¨¶Âè∑ÔºåÂÖ∂‰∏≠‰øùÂ≠ò‰∫ÜÂÆÉÂú® Symbol Table ‰∏≠ÁöÑÁöÑÁ¥¢Âºï„ÄÇ Ê†πÊçÆ‰ªéÂä®ÊÄÅÁ¨¶Âè∑Ë°®‰∏≠ÂæóÂà∞ÁöÑËøô‰∏™Á¥¢ÂºïÔºåËé∑ÂèñËØ•Á¨¶Âè∑Âú® SYMTABÁöÑ‰ø°ÊÅØÔºåÂèØ‰ª•ÊãøÂà∞ÂÆÉÂú® String Table ÁöÑ offset„ÄÇËøô‰∏™ offset ‰øùÂ≠òÁùÄÁ¨¶Âè∑ÁöÑÂêçÂ≠ó„ÄÇ ÊãøÂà∞Ëøô‰∏™Á¨¶Âè∑ÁöÑÂêçÂ≠óÂíåÊàë‰ª¨Ë¶ÅÊõøÊç¢ÁöÑÂêÑ‰∏™Á¨¶Âè∑ÂêçÂÅöÂØπÊØîÔºåÂ¶ÇÊûúÁõ∏ÂêåÔºåÈÇ£‰πàÊää __DATA,__nl_symbol_ptr ÊàñËÄÖ __DATA,__la_symbol_ptr Áõ∏Â∫î‰ΩçÁΩÆÁöÑÁ¨¶Âè∑ÊåáÂêëË¶ÅÊõøÊç¢ÁöÑÊñπÊ≥ïÁöÑÂú∞ÂùÄ„ÄÇËá≥Ê≠§Ôºåfishhook ÊõøÊç¢ÂÆåÊàê ÊÄùËÄÉÈ¢ò ‰∏∫‰ªÄ‰πàÈúÄË¶ÅÂä®ÊÄÅÈìæÊé•Ôºü ‰ªÄ‰πàÊòØ Lazy BindingÔºü ‰∏∫‰ªÄ‰πà fishhook ÂèØ‰ª•ÈáçÊñ∞ÁªëÂÆöÁ¨¶Âè∑ÔºüËøôÂíåÂä®ÊÄÅÈìæÊé•Êúâ‰ªÄ‰πàÂÖ≥Á≥ªÔºü ÊáíÁªëÂÆöÁöÑÁ¨¶Âè∑Â≠òÂú®Âì™‰∏™ÊÆµ‰∏≠Ôºü Á≥ªÁªüÁöÑ Lazy Binding ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü Â¶Ç‰ΩïÊãøÂà∞ Load Command ÁöÑÂÅèÁßªÔºü ÂèÇËÄÉÊ∑±ÂÖ•ÁêÜËß£fishhook Â∑ßÁî®Á¨¶Âè∑Ë°® - Êé¢Ê±Ç fishhook ÂéüÁêÜ iosÈÄÜÂêë - mach-oÊñá‰ª∂ÂàÜÊûê Ê∑±ÂÖ•ÁêÜËß£fishhook]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[„ÄäÁ®ãÂ∫èÂëòÁöÑËá™Êàë‰øÆÂÖª„ÄãËØª‰π¶Á¨îËÆ∞]]></title>
    <url>%2F2019%2F05%2F28%2F%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÂèàÈáçËØª‰∫Ü„ÄäÁ®ãÂ∫èÂëòÁöÑËá™Êàë‰øÆÂÖª„Äã‰∏Ä‰π¶„ÄÇÊúâ‰∫ÜËÆ∏Â§öÊñ∞ÁöÑÊÑüÂèó„ÄÇ‰π¶ÈúÄË¶ÅÈáçÂ§çÁöÑËØª„ÄÇÊúÄÂºÄÂßãÁöÑ‰∏ÄÈÅçÂæàÂ§öÈÉΩÁúã‰∏çÊáÇÔºå‰πüËßâÂæóÊ≤°ÂøÖË¶ÅÁü•ÈÅì„ÄÇÁé∞Âú®ÂæàÂ§öÁü•ËØÜÈÉΩÂ∑≤ÁªèÊúâ‰∫ÜÂç∞Ë±°ÔºåÁúã‰π¶ÁöÑËøáÁ®ãÊõ¥ÂÉèÊòØÊü•ÊºèË°•Áº∫ÁöÑËøáÁ®ã„ÄÇ‰ª•‰∏ãÊòØËøôÊú¨‰π¶ÁöÑÈÉ®ÂàÜÁ¨îËÆ∞„ÄÇ Ê∏©ÊïÖËÄåÁü•Êñ∞ÂÜÖÂ≠òËôöÊãüÂú∞ÂùÄÁâ©ÁêÜÂú∞ÂùÄÂØπÂ∫î‰∫éÁâ©ÁêÜÂÜÖÂ≠òÔºåÊòØÂÆûÈôÖÂ≠òÂú®ÁöÑ„ÄÇËôöÊãüÂú∞ÂùÄÊòØ‰∏çÂ≠òÂú®ÁöÑÂú∞ÂùÄÁ©∫Èó¥ÔºåÊØè‰∏™ËøõÁ®ãÊúâËá™Â∑±Áã¨Á´ãÁöÑËôöÊãüÁ©∫Èó¥ÔºåÁÑ∂ÂêéÈÄöËøáÊüê‰∫õÊò†Â∞ÑÊñπÂºèÔºåÂ∞ÜËôöÊãüÂú∞ÂùÄËΩ¨Âåñ‰∏∫ÂÆûÈôÖÁöÑÁâ©ÁêÜÂú∞ÂùÄ„ÄÇ ËôöÊãüÂú∞ÂùÄ‰∏ªË¶Å‰∏∫‰∫ÜËß£ÂÜ≥‰ΩøÁî®Áâ©ÁêÜÂú∞ÂùÄÊó∂ÔºåÂú∞ÂùÄÁ©∫Èó¥‰∏çÈöîÁ¶ªÔºåÂÜÖÂ≠ò‰ΩøÁî®ÊïàÁéá‰ΩéÔºåËøêË°åÂú∞ÂùÄ‰∏çÁ°ÆÂÆöÁ≠âÈóÆÈ¢ò„ÄÇÂØπ‰∫éÁ®ãÂ∫èÊù•ËØ¥ÔºåÂÆÉÊ∞∏Ëøú‰ªé 0x00000000 ÂºÄÂßãÁöÑËøûÁª≠Âú∞ÂùÄÔºå‰∏çÈúÄË¶ÅËÄÉËôëÈáçÂÆö‰Ωç„ÄÇ ÂàÜÊÆµÂ∞Ü‰∏Ä‰∏™ÂÆåÊï¥ÁöÑËôöÊãüÁ©∫Èó¥ÂàÜ‰∏∫Ëã•Âπ≤ÊÆµÔºåÊØèÊÆµÈÉΩ‰∏éÁâ©ÁêÜÂú∞ÂùÄ‰∏äÁöÑÊüê‰∏™Âå∫ÂüüÂØπÂ∫îÔºåÂè´ÂÅöÂàÜÊÆµ„ÄÇËôöÊãüÂú∞ÂùÄ‰∏≠ÁöÑÊØè‰∏™Â≠óËäÇÈÉΩÂØπÂ∫î‰∫éÁâ©ÁêÜÁ©∫Èó¥‰∏≠ÁöÑÊØè‰∏™Â≠óËäÇ„ÄÇ ÂàÜÊÆµÁöÑÊò†Â∞ÑËøáÁ®ãÁî±Êìç‰ΩúÁ≥ªÁªüÂÆåÊàêÔºåÂÆûÈôÖÁöÑÂú∞ÂùÄËΩ¨Êç¢Áî±Á°¨‰ª∂ÂÆåÊàê„ÄÇ ÂàÜÊÆµËß£ÂÜ≥‰∫ÜÂú∞ÂùÄÁ©∫Èó¥‰∏çÈöîÁ¶ªÔºåËøêË°åÂú∞ÂùÄ‰∏çÁ°ÆÂÆöÁöÑÈóÆÈ¢ò„ÄÇ ÂàÜÈ°µÂàÜÊÆµÊ≤°ÊúâËß£ÂÜ≥ÂÜÖÂ≠ò‰ΩøÁî®ÊïàÁéá‰ΩéÁöÑÈóÆÈ¢ò„ÄÇ‰ªéÁ£ÅÁõòÂà∞Áâ©ÁêÜÂÜÖÂ≠òÁöÑÊï∞ÊçÆÁΩÆÊç¢Â¶ÇÊûú‰ª•ÊÆµ‰∏∫Âçï‰ΩçÔºå‰ªçÂ∞ÜËøõË°åÂ§ßÈáèÁöÑÁΩÆÊç¢„ÄÇÂõ†Ê≠§Â∞ÜÊÆµÊõ¥ÁªÜÁöÑÊãÜÂàÜ‰∏∫È°µÔºå‰∏ÄËà¨‰∏∫ 4kb Â§ßÂ∞è„ÄÇ ËôöÊãüÂÜÖÂ≠òÂà∞Áâ©ÁêÜÂÜÖÂ≠òÁöÑÊò†Â∞ÑÂÖ≥Á≥ªÊòØ‰ª•È°µ‰∏∫Âçï‰ΩçÁöÑ„ÄÇ ÂèØ‰ª•ÁúãÂà∞‰∏çÂêåËøõÁ®ãÁöÑÈ°µÂèØËÉΩÊò†Â∞ÑÂà∞Áõ∏ÂêåÁöÑÁâ©ÁêÜÂÜÖÂ≠ò‰∏≠„ÄÇËøô‰ºöÈÄ†Êàê‰∏§ÁßçÊÉÖÂÜµÔºö ÈùûÊ¥ªË∑ÉËøõÁ®ãÊüêÈ°µÁöÑÁâ©ÁêÜÂú∞ÂùÄ‰∏äÁöÑÊï∞ÊçÆ‰ºöË¢´ÁΩÆÊç¢‰∏∫Ê¥ªË∑ÉËøõÁ®ãÁöÑÊüêÈ°µÁöÑÊï∞ÊçÆ„ÄÇ ‰∏§‰∏™ËøõÁ®ãÈÄöËøáÂÖ±‰∫´Ëøô‰∏ÄÁâ©ÁêÜÂú∞ÂùÄ‰∏äÁöÑÊï∞ÊçÆËøõË°å IPC (Â∫îÁî®ËøõÁ®ãÈó¥ÈÄö‰ø°) Á∫øÁ®ãÁ∫øÁ®ãÁöÑËÆøÈóÆÊùÉÈôêÁ∫øÁ®ãÂèØ‰ª•ËÆøÈóÆËøõÁ®ãÈáåÁöÑÊâÄÊúâÊï∞ÊçÆÔºåÁîöËá≥ÂåÖÊã¨ÂÖ∂‰ªñÁ∫øÁ®ãÁöÑÂ†ÜÊ†à(Â¶ÇÊûúÂÆÉÁü•ÈÅìÂÖ∂‰ªñÁ∫øÁ®ãÁöÑÂ†ÜÊ†àÂú∞ÂùÄ) Linux Â§öÁ∫øÁ®ãLinux ‰∏≠Âπ∂‰∏çÂ≠òÂú®ÁúüÊ≠£ÁöÑÁ∫øÁ®ã„ÄÇÂÆÉÁöÑÊâßË°åÂÆû‰Ωì(Êó†ËÆ∫Á∫øÁ®ãËøòÊòØËøõÁ®ã)ÈÉΩË¢´Áß∞‰∏∫‰ªªÂä°„ÄÇÊØè‰∏™‰ªªÂä°Áõ∏ÂΩì‰∫é‰∏Ä‰∏™ÂçïÁ∫øÁ®ãÁöÑËøõÁ®ã„ÄÇ ÂÆÉÊúâ‰∏âÁßçÊñπÂºèÂàõÂª∫‰ªªÂä°Ôºö fork exec clone ÂÖ∂‰∏≠Ôºåfork ‰∫ßÁîüÊñ∞‰ªªÂä°ÁöÑÈÄüÂ∫¶ÊúÄÂø´„ÄÇÂõ†‰∏∫ fork ‰∏ç‰ºöÁ´ãÂç≥Â§çÂà∂‰ªªÂä°ÁöÑÂÜÖÂ≠òÔºåËÄåÊòØÂÜôÊó∂Â§çÂà∂„ÄÇ Á∫øÁ®ãÂÆâÂÖ®Á∫øÁ®ãÂÆâÂÖ®Â∞±‰∏çÂæó‰∏çÊèêÈîÅ„ÄÇiOS ‰∏≠ÊúÄÂ∏∏ËßÅÁöÑÊúâ‰∏§ÁßçÈîÅÔºö NSLockÔºå@synchronizeÔºöÊú¨Ë¥®‰∏äÈÉΩÊòØ‰∫íÊñ•ÈîÅ dispatch_semaphone_tÔºö‰ø°Âè∑Èáè Â§öÂÖÉ‰ø°Âè∑Èáè‰∏é‰∫íÊñ•ÈîÅÁöÑÂ∑ÆÂà´Âú®‰∫éÔºöÂ§öÂÖÉ‰ø°Âè∑ÈáèÂèØ‰ª•ÂÆûÁé∞Âú®Â§ö‰∏™‰ªªÂä°ÂÆåÊàêÂêéÁöÑÂõûË∞ÉÔºå‰∫íÊñ•ÈîÅÊòæÁÑ∂ÊòØÊó†Ê≥ïÂÆåÊàêÁöÑ„ÄÇ ÈÇ£‰πà‰∫åÂÖÉ‰ø°Âè∑ÈáèÂíå‰∫íÊñ•ÈîÅÊúâ‰ªÄ‰πàÂå∫Âà´Âë¢Ôºü‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊàë‰ª¨ËÆ§‰∏∫‰∫åÂÖÉ‰ø°Âè∑ÈáèÂíå‰∫íÊñ•ÈîÅÁõ∏Âêå„ÄÇÂÖ∂ÂÆû‰ªñ‰ª¨ÁöÑÊú¨Ë¥®Âå∫Âà´ÊòØÔºöÂêå‰∏Ä‰∏™‰ø°Âè∑ÈáèÂèØ‰ª•Ë¢´Á≥ªÁªü‰∏≠ÁöÑ‰∏Ä‰∏™Á∫øÁ®ãËé∑ÂèñÔºåÁî±Âè¶‰∏Ä‰∏™Á∫øÁ®ãÈáäÊîæ„ÄÇËÄå‰∫íÊñ•ÈîÅÂàôË¶ÅÊ±ÇÂì™‰∏™Á∫øÁ®ãËé∑Âèñ‰∫Ü‰∫íÊñ•ÈîÅÔºåÂì™‰∏™Á∫øÁ®ãÂ∞±Ë¶ÅÈáäÊîæÔºåÂÖ∂‰ªñÁ∫øÁ®ãÊó†Ê≥ïË∂ä‰øé‰ª£Â∫ñÁöÑÂéªÈáäÊîæ„ÄÇÂ¶ÇÂõæÊâÄÁ§∫Ôºö Áî±‰∫éÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÈáäÊîæ‰∫åÂÖÉ‰ø°Âè∑ÔºåÂèØ‰ª•ÁúãÂà∞Á¨¨‰∫å‰∏™‰ªªÂä°Ê≤°ÊúâÁ≠âÁ¨¨‰∏Ä‰∏™ÁªìÊùüÂ∞±ÂºÄÂßãÊâßË°å‰∫Ü„ÄÇËÄåÂ¶ÇÊûú‰∏ªÁ∫øÁ®ãÊ≤°ÊúâÈáäÊîæ‰ø°Âè∑ÈáèÔºåÈÇ£‰πàÁ¨¨‰∫å‰∏™‰ªªÂä°ÊòØË¶ÅÁ≠âÁ¨¨‰∏Ä‰∏™‰ªªÂä°ÁªìÊùüÔºåÈáäÊîæ‰ø°Âè∑ÈáèÔºåÊâçËÉΩÊâßË°åÁöÑ„ÄÇËøôÂ∞±ÊòØ‰ø°Âè∑ÈáèÂíå‰∫íÊñ•ÈîÅÁöÑÂå∫Âà´ Â§öÁ∫øÁ®ãÂÜÖÈÉ®‰∏äÈù¢Êàë‰ª¨ÊâÄËØ¥ÁöÑÂ§öÁ∫øÁ®ãÊòØÊåáÁî±Êìç‰ΩúÁ≥ªÁªüË∞ÉÂ∫¶ÁöÑÂÜÖÊ†∏Á∫øÁ®ã„ÄÇËÄåÁî®Êà∑ÂÆûÈôÖ‰ΩøÁî®ÁöÑÁ∫øÁ®ãÂπ∂‰∏çÊòØÂÜÖÊ†∏Á∫øÁ®ãÔºåËÄåÊòØÂá∫‰∫éÁî®Êà∑ÊÄÅÁöÑÁî®Êà∑Á∫øÁ®ã„ÄÇÁî®Êà∑Á∫øÁ®ãÁöÑÊï∞Èáè‰∏ç‰∏ÄÂÆöÂØπÂ∫î‰∫éÂÜÖÊ†∏Á∫øÁ®ãÁöÑÊï∞Èáè„ÄÇ‰∏ÄËà¨Êúâ‰∏âÁßçÁ∫øÁ®ãÊ®°ÂûãÔºö ‰∏ÄÂØπ‰∏ÄÊ®°ÂûãÔºöÂç≥‰∏Ä‰∏™Áî®Êà∑Á∫øÁ®ãÂØπÂ∫î‰∏Ä‰∏™ÂÜÖÊ†∏Á∫øÁ®ã Â§öÂØπ‰∏ÄÊ®°ÂûãÔºöÂç≥Â§ö‰∏™Áî®Êà∑Á∫øÁ®ãÂØπÂ∫î‰∏Ä‰∏™ÂÜÖÊ†∏Á∫øÁ®ã Â§öÂØπÂ§öÊ®°ÂûãÔºöÂç≥Â§ö‰∏™Áî®Êà∑Á∫øÁ®ãÂØπÂ∫îÂ§ö‰∏™ÂÜÖÊ†∏Á∫øÁ®ã ÂØπ‰∫é‰∏ÄÂØπ‰∏ÄÊ®°ÂûãÔºåÁî®Êà∑ÁöÑÁ∫øÁ®ãÂàáÊç¢‰πüÂ∞±ÊòØÂÜÖÊ†∏Á∫øÁ®ãÁöÑÂàáÊç¢ÔºåÂ≠òÂú®Á∫øÁ®ãÂàáÊç¢‰∏ä‰∏ãÊñáÊó∂ÁöÑÂºÄÈîÄ„ÄÇÂØπ‰∫éÂ§öÂØπ‰∏ÄÊ®°ÂûãÔºåÁî®Êà∑ÁöÑÁ∫øÁ®ãÂàáÊç¢‰∏çÊòØÂÜÖÊ†∏Á∫øÁ®ãÁöÑÂàáÊç¢ÔºåÂõ†Ê≠§‰πüÂ∞±‰∏çÂ≠òÂú®ÂàáÊç¢‰∏ä‰∏ãÊñáÊó∂ÁöÑÂºÄÈîÄ„ÄÇ‰ΩÜÊòØÂØπ‰∫éÂ§öÂØπ‰∏ÄÊ®°ÂûãÔºåÂ¶ÇÊûú‰∏Ä‰∏™Áî®Êà∑Á∫øÁ®ãÈòªÂ°û‰∫ÜÔºåÈÇ£‰πàÂÜÖÊ†∏Á∫øÁ®ãÈòªÂ°ûÔºåÂÖ∂‰ªñÁî®Êà∑Á∫øÁ®ã‰πüÂ∞±Êó†Ê≥ïÁªßÁª≠ÊâßË°å‰∫Ü„ÄÇ Linux ‰∏≠ÁöÑÁ∫øÁ®ãÊ®°ÂûãÊòØ‰∏ÄÂØπ‰∏ÄÊ®°Âûã ÁºñËØëÂíåËøûÊé•Âü∫Êú¨ÊµÅÁ®ãÂΩìÊàë‰ª¨ Build ‰∏Ä‰∏™È°πÁõÆÁöÑÊó∂ÂÄôÔºå‰∏ÄËà¨ÂàÜ‰∏∫Âõõ‰∏™Ê≠•È™§ÔºöÈ¢ÑÂ§ÑÁêÜÔºåÁºñËØëÔºåÊ±áÁºñÔºåÈìæÊé• È¢ÑÂ§ÑÁêÜ‰∏ªË¶ÅÂ§ÑÁêÜ‰ª£Á†Å‰∏≠‰ª• # ÂºÄÂ§¥ÁöÑÈ¢ÑÁºñËØëÊåá‰ª§„ÄÇÁºñËØëÂ∞ÜÊñá‰ª∂ËΩ¨‰∏∫Ê±áÁºñ‰ª£Á†ÅÊñá‰ª∂„ÄÇÊ±áÁºñÂ∞ÜÊ±áÁºñ‰ª£Á†ÅÊõøÊç¢‰∏∫ÂØπÂ∫îÁöÑÊú∫Âô®Êåá‰ª§„ÄÇÈìæÊé•Â∞ÜÂêÑ‰∏™Ê±áÁºñÂêé‰∫ßÁîüÁöÑÊñá‰ª∂ÈìæÊé•„ÄÇ ÈùôÊÄÅÈìæÊé•ÈùôÊÄÅÈìæÊé•‰∏ªË¶ÅÂåÖÂê´Âú∞ÂùÄÁ©∫Èó¥ÂàÜÈÖçÔºåÁ¨¶Âè∑Ëß£ÊûêÔºåÈáçÂÆö‰ΩçÁ≠âÊ≠•È™§„ÄÇ ÈìæÊé•‰∏çÂè™ÊòØÊää‰ª£Á†ÅÂ†ÜÂè†Âà∞‰∏ÄËµ∑(‰ª£Á†ÅÂ†ÜÂè†ÂèØ‰ª•ÁêÜËß£‰∏∫Âú∞ÂùÄÁ©∫Èó¥ÂàÜÈÖç)„ÄÇÂú®ÁºñËØëÁöÑÊó∂ÂÄôÔºå‰ºöÊúâ‰∏Ä‰∏™Á¨¶Âè∑Ë°®ËÆ∞ÂΩïÂá∫Áé∞ÁöÑÊâÄÊúâÁ±ªÔºåÂÖ®Â±ÄÂèòÈáèÔºåÊñπÊ≥ïÁ≠âÁ¨¶Âè∑„ÄÇËøô‰∫õÁ¨¶Âè∑ÊâÄÊåáÂêëÁöÑÊòØÂΩìÂâçÊñá‰ª∂ÁöÑÂÅèÁßª‰ΩçÁΩÆÔºåËÄåÂú®ÈìæÊé•ÁöÑÊó∂ÂÄôÂ∞Ü‰ºöË¢´‰øÆÊîπ‰∏∫ÈìæÊé•ÂêéÂÆåÊï¥Êñá‰ª∂ÁöÑÂÅèÁßª„ÄÇÁºñËØëÁöÑÂêåÊó∂ÔºåÊúâ‰∏Ä‰∫õÂºïÁî®ÁöÑÁ±ªÔºåÊñπÊ≥ïÁ≠âÁöÑÂú∞ÂùÄÊòØÊú™Áü•ÁöÑÔºåËøô‰∫õÊú™Áü•ÁöÑÂú∞ÂùÄÂ∞±ÊòØ‰∏Ä‰∏™‰∏™Á©∫Ê¥û„ÄÇ Á¨¶Âè∑Ë°®‰∏≠ÁöÑÁ¨¶Âè∑‰ª•ÂèäËøô‰∫õ‰ΩçÁΩÆÁöÑÁ©∫Ê¥ûÈÉΩÊòØÈúÄË¶ÅÂú®ÈìæÊé•ÁöÑÊó∂ÂÄôËøõË°åÂú∞ÂùÄÂÅèÁßª‰øÆÊ≠£ÁöÑ„ÄÇÂõ†Ê≠§ÔºåÁºñËØëÁöÑÊó∂ÂÄôËøò‰ºöÁîüÊàê‰∏Ä‰∏™ÈáçÂÆö‰ΩçË°®ÈúÄË¶ÅÂú∞ÂùÄ‰øÆÊ≠£ÁöÑÂêÑ‰∏™Á¨¶Âè∑‰ª•ÂèäÈúÄË¶ÅÈìæÊé•ÁöÑÁ©∫Ê¥û„ÄÇ Á¨¶Âè∑Ëß£ÊûêÂ∞±ÊòØÂ∞ÜÊØè‰∏™Á¨¶Âè∑ÂºïÁî®ÂíåÂÖ∂ÂØπÂ∫îÁöÑÁ¨¶Âè∑ÂÆö‰πâËÅîÁ≥ªËµ∑Êù•„ÄÇ‰πüÂ∞±ÊòØ‰øÆÊ≠£Á¨¶Âè∑Ë°®‰∏≠Á¨¶Âè∑ÊâÄÊåáÂêëÁöÑÂÖ®Â±ÄÂèòÈáè„ÄÅÊñπÊ≥ïÁöÑÂú∞ÂùÄ„ÄÇ ÈáçÂÆö‰ΩçÂ∞±ÊòØÈìæÊé•Âô®ÊääÊØè‰∏™Á¨¶Âè∑ÂÆö‰πâ‰∏é‰∏Ä‰∏™ËôöÊãüÂú∞ÂùÄËÅîÁ≥ªËµ∑Êù•„ÄÇ‰πüÂ∞±ÊòØÂ∞Ü‰ª£Á†ÅÊÆµ‰∏≠ÂéüÊú¨Êú™ÈìæÊé•ÁöÑÁ¨¶Âè∑ÁöÑÂú∞ÂùÄ‰øÆÊîπ‰∏∫ÈìæÊé•Âêé‰øÆÊ≠£ÂÅèÁßªÂêéÁöÑÁ¨¶Âè∑ÁöÑÂú∞ÂùÄ„ÄÇ ÂÖ∂ÂÆûÂèØ‰ª•Êõ¥Êú¥Á¥†ÁöÑÁêÜËß£Ôºö ÈìæÊé•‰πãÂêéÊúâ‰∏§ÈÉ®ÂàÜÂú∞ÂùÄÂèëÁîüÂèòÂåñÔºå‰∏ÄÈÉ®ÂàÜÊòØÁ¨¶Âè∑ÊåáÂêëÁöÑÂÖ®Â±ÄÂèòÈáè„ÄÅÊñπÊ≥ïÁöÑÂú∞ÂùÄÁöÑÂÅèÁßªÔºåËøòÊúâ‰∏ÄÈÉ®ÂàÜÊòØÂêÑ‰∏™Êñá‰ª∂ÁöÑÁ¨¶Âè∑Ë°®‰∏≠Á¨¶Âè∑Êú¨Ë∫´ÁöÑÂú∞ÂùÄÂèëÁîüÂÅèÁßª„ÄÇ Âõ†Ê≠§Â∞±Ë¶ÅÊúâ‰∏§Ê≠•Êìç‰ΩúÔºåÁ¨¨‰∏ÄÊ≠•Á∫†Ê≠£ÂÖ®Â±ÄÁ¨¶Âè∑Ë°®‰∏≠Á¨¶Âè∑ÊåáÂêëÁöÑÂÖ®Â±ÄÂèòÈáèÊàñÊñπÊ≥ïÁöÑ‰ΩçÁΩÆÔºåÁ¨¨‰∫åÊ≠•Á∫†Ê≠£‰ª£Á†Å‰∏≠‰ΩøÁî®ÁöÑÊú™ÈìæÊé•Êó∂Áõ∏ÂØπ‰∫éÊú¨Êñá‰ª∂ÁöÑÁ¨¶Âè∑ÁöÑÂú∞ÂùÄÔºåÂ∞ÜÂÖ∂Êîπ‰∏∫ÂÖ®Â±ÄÁ¨¶Âè∑Ë°®‰∏≠‰øÆÊ≠£ËøáÁöÑÁ¨¶Âè∑ÁöÑÂú∞ÂùÄ„ÄÇ ÁõÆÊ†áÊñá‰ª∂ÂèØÊâßË°åÊñá‰ª∂‰∏≠ÁöÑÊÆµÁõÆÊ†áÊñá‰ª∂Âç≥Âú®Ê±áÁºñ‰πãÂêéÔºåÂú®ÈìæÊé•‰πãÂâçÁöÑÊñá‰ª∂„ÄÇÈô§‰∫ÜÂåÖÂê´ÁºñËØëÂêéÁöÑÊú∫Âô®Êåá‰ª§„ÄÅÊï∞ÊçÆÂ§ñÔºåËøòÂåÖÂê´Á¨¶Âè∑Ë°®ÔºåË∞ÉËØï‰ø°ÊÅØÁ≠â„ÄÇÁõÆÊ†áÊñá‰ª∂Â∞Ü‰∏çÂêåÂ±ûÊÄß‰øùÂ≠òÂú®‰∏çÂêåÁöÑÊÆµÔºàSectionÔºâ‰∏≠„ÄÇ Èô§‰∫Ü SectionÔºåÊàë‰ª¨ÂÜçÁúã Mach-o Êñá‰ª∂ÁöÑÊó∂ÂÄôÔºåÁªèÂ∏∏‰ºöÁ¢∞Âà∞ Segment„ÄÇËøô‰∏§ËÄÖÈÉΩÂèØ‰ª•Êàê‰∏∫ÊÆµ(ËôΩÁÑ∂ Segment ÁöÑÊÑèÊÄùÊâçÊòØÊÆµÔºåSection ÁöÑÊÑèÊÄùÊòØËäÇ)„ÄÇ Section Âíå Segment ÁöÑÂå∫Âà´Âú®‰∫éÔºöÁõÆÊ†áÊñá‰ª∂ÊòØ‰ª• Section ‰∏∫Âçï‰ΩçÂàÜÊÆµÁöÑÔºå‰ΩÜÊòØÂä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠ÊòØ‰ª• Segment ‰∏∫Âçï‰ΩçÂä†ËΩΩ„ÄÇ Êàë‰ª¨ÊâÄËØ¥ÁöÑ .text, .data, .bss ÊåáÁöÑÈÉΩÊòØ Section„ÄÇËÄå‰ª£Á†ÅÊÆµÔºåÊï∞ÊçÆÊÆµÊåáÁöÑÈÉΩÊòØ Segment„ÄÇ ÂèØÊâßË°åÊñá‰ª∂ÁöÑÊñá‰ª∂Â§¥ÂåÖÂê´‰∫ÜÊñá‰ª∂Â±ûÊÄßÔºåËøòÂåÖÂê´‰∏Ä‰∏™ÊÆµË°®ÔºàSection TableÔºâÔºåÊÆµË°®ÊòØ‰∏Ä‰∏™Áî®Êù•ÊèèËø∞Êñá‰ª∂‰∏≠ÂêÑ‰∏™ÊÆµÁöÑÊï∞ÁªÑÔºåÂåÖÂê´‰∫ÜÊñá‰ª∂‰∏≠ÂêÑ‰∏™ÊÆµÁöÑÂÅèÁßª‰ΩçÁΩÆÂèäÂ±ûÊÄß„ÄÇ ‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂‰∏ÄËà¨ÂåÖÂê´‰ª•‰∏ãÁöÑÊÆµÔºö .textÊÆµÔºöÂç≥‰ª£Á†ÅÊÆµÔºå‰øùÂ≠ò‰∫ÜÁºñËØëÂêéÁöÑÊâßË°åËØ≠Âè•„ÄÇ .dataÊÆµÔºöÂíå .bss ÊÆµÁªüÁß∞Êï∞ÊçÆÊÆµÔºå‰øùÂ≠ò‰∫ÜÂ∑≤ÂàùÂßãÂåñÁöÑÂÖ®Â±ÄÂèòÈáèÂíåÂ±ÄÈÉ®ÈùôÊÄÅÂèòÈáèÁöÑÂÄº„ÄÇ .bss ÊÆµÔºöÂ≠òÊîæÊú™ÂàùÂßãÂåñÁöÑÂÖ®Â±ÄÂèòÈáèÂíåÂ±ÄÈÉ®ÈùôÊÄÅÂèòÈáè„ÄÇÁî±‰∫éÊòØÊú™ÂàùÂßãÂåñÁöÑÂèòÈáèÔºåÊâÄ‰ª•ÂèØÊâßË°åÊñá‰ª∂‰∏≠‰∏ç‰ºöÂàÜÈÖçÁ©∫Èó¥Áªô bss ÊÆµÔºåÂè™‰ºöÂú®ÊÆµÂ§¥‰∏≠ËÆ∞ÂΩï bss ÊÆµÁöÑÂ§ßÂ∞è„ÄÇbss ÊÆµÁ©∫Èó¥Áî±Á≥ªÁªüÂàùÂßãÂåñ„ÄÇbss ÊÆµ ÁöÑÁõÆÁöÑÂ∞±ÊòØÂáèÂ∞ëÁ®ãÂ∫èÂ§ßÂ∞è„ÄÇ Èô§‰∫Ü‰∏äÈù¢ÊâÄËø∞ÁöÑ‰∏â‰∏™ÊÆµÔºåËøòÊúâÂæàÂ§öÂ∏∏ËßÅÁöÑÊÆµÂ¶Ç‰∏ãÂõæÔºö Ëá™ÂÆö‰πâÊÆµÂ§Ñ‰∫Ü‰∏äËø∞ÁöÑÊÆµÔºåÊàë‰ª¨ËøòÂèØ‰ª•Ëá™ÂÆö‰πâÊÆµÔºö__attribute__((section(&quot;name&quot;)))„ÄÇÂ¶ÇÔºö 1__attribut__((section("FOO"))) int global = 42; Â∞±ÊòØÂàõÂª∫‰∫Ü‰∏Ä‰∏™Âè´ FOO ÁöÑÊÆµÔºåÂπ∂‰∏îÊääÂÖ®Â±ÄÂèòÈáè global Êîæ‰∫ÜËøõÂéª„ÄÇ‰ΩøÁî®ÁöÑÊó∂ÂÄôÂÜçÈÄöËøáÁõ∏Â∫îÁöÑ c ÊñπÊ≥ïËé∑ÂèñÂç≥ÂèØ„ÄÇ ÈòøÈáåÁöÑÊ®°ÂùóÂåñÊ°ÜÊû∂ BeeHive Â∞±ÊòØÈÄöËøáËøôÁßçÊñπÂºèÂÖ®Â±ÄÊ≥®ÂÜåÊ®°Âùó‰ø°ÊÅØ„ÄÇËøôÊ†∑ÁöÑÂ•ΩÂ§ÑÊòØ‰∏çÈúÄË¶ÅÁª¥Êä§‰∏Ä‰∏™Êï∞ÁªÑÂèñ‰øùÂ≠òÔºå‰ΩøÁî®ÁöÑÊó∂ÂÄôÁõ¥Êé•ÊääËá™ÂÆö‰πâÊÆµ‰∏≠ÁöÑÊâÄÊúâÂèòÈáèÊãøÂà∞Âç≥ÂèØ„ÄÇËá™ÂÆö‰πâÊÆµÊú¨Ë∫´Â∞±Áõ∏ÂΩì‰∫éÊòØ‰∏Ä‰∏™Êï∞ÁªÑ„ÄÇ(ÂΩìÁÑ∂ÔºåÂÖ∂ÂÆûÂ∞±ÊääÊ®°Âùó‰ø°ÊÅØ‰øùÂ≠òÂú® .data ÊÆµ‰∏≠ÁöÑ‰∏Ä‰∏™Êï∞ÁªÑ‰∏≠ÂÖ∂ÂÆû‰πüÊ≤°‰ªÄ‰πàÈóÆÈ¢ò) ELF Êñá‰ª∂ÁªìÊûÑELF Êñá‰ª∂ÁªìÊûÑÂ¶Ç‰∏ãÔºö ELF Êñá‰ª∂Â§¥ELF Êñá‰ª∂Â§¥‰∏ªË¶ÅÂåÖÂê´ÂèØÊâßË°åÊñá‰ª∂ÁöÑÂü∫Êú¨‰ø°ÊÅØ„ÄÇÂåÖÂê´ ELF È≠îÊï∞ÔºåÁâàÊú¨ÔºåËøêË°åÂπ≥Âè∞ÔºåABI ÁâàÊú¨ÔºåÁ®ãÂ∫èÂ§¥ÂÖ•Âè£ÂíåÈïøÂ∫¶ÔºåÊÆµË°®ÁöÑ‰ΩçÁΩÆÂíåÈïøÂ∫¶ÔºåÊÆµÁöÑÊï∞ÈáèÁ≠â„ÄÇ ÂÖ≥‰∫é‰ªÄ‰πàÊòØ ABI„ÄÇABI Ê∂µÁõñ‰∫ÜÂêÑÁßçÁªÜËäÇÔºöÂ¶ÇÊï∞ÊçÆÁ±ªÂûã„ÄÅÂ§ßÂ∞èÂíåÂØπÈΩêÔºõË∞ÉÁî®Á∫¶ÂÆöÔºàÊéßÂà∂ÁùÄÂáΩÊï∞ÁöÑÂèÇÊï∞Â¶Ç‰Ωï‰º†ÈÄÅ‰ª•ÂèäÂ¶Ç‰ΩïÊé•ÂèóËøîÂõûÂÄºÔºâÔºõÁ≥ªÁªüË∞ÉÁî®ÁöÑÁºñÁ†ÅÂíå‰∏Ä‰∏™Â∫îÁî®Â¶Ç‰ΩïÂêëÊìç‰ΩúÁ≥ªÁªüËøõË°åÁ≥ªÁªüË∞ÉÁî®„ÄÇ ÂÖ≥‰∫é‰ªÄ‰πàÊòØÈ≠îÊï∞„ÄÇÈ≠îÊï∞Áî®Êù•Á°ÆÂÆöÊñá‰ª∂ÁöÑÁ±ªÂûãÔºåÊìç‰ΩúÁ≥ªÁªüÂú®Âä†ËΩΩÂèØÊâßË°åÊñá‰ª∂ÁöÑÊó∂ÂÄô‰ºöÁ°ÆÂÆöÊòØÂê¶Ê≠£Á°Æ„ÄÇ ÊÆµË°®ÊÆµË°®ÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÊèèËø∞‰∫ÜÊÆµÁöÑÊÆµÂêçÔºåÊÆµÁöÑÈïøÂ∫¶ÔºåÊñá‰ª∂‰∏≠ÁöÑÂÅèÁßªÔºåËØªÂÜôÊùÉÈôêÁ≠âÂ±ûÊÄß„ÄÇ ÈáçÂÆö‰ΩçË°®ÊØè‰∏™Êñá‰ª∂ÁöÑÈáçÂÆö‰ΩçË°®ÈÉΩËÆ∞ÂΩï‰∫ÜËØ•Êñá‰ª∂‰∏≠Âú®ÈìæÊé•Êó∂ÈúÄË¶ÅÈáçÂÆö‰ΩçÁöÑÁ¨¶Âè∑‰ª•ÂèäÂºïÁî®ÁöÑÂ§ñÈÉ®Á¨¶Âè∑ÁöÑ‰ø°ÊÅØÔºå‰ª•ÂèäÂÆÉ‰ª¨Âú®ÂΩìÂâçÊñá‰ª∂ÁöÑÂÅèÁßª‰ΩçÁΩÆ„ÄÇ Â≠óÁ¨¶‰∏≤Ë°®ÂèØÊâßË°åÊñá‰ª∂‰∏≠ÁöÑÂæàÂ§öÂ≠óÁ¨¶‰∏≤ÔºåÂ¶ÇÊÆµÂêçÔºåÂèòÈáèÂêç‰øùÂ≠òÂú®ËøôÈáå„ÄÇ‰ΩøÁî®Â≠óÁ¨¶‰∏≤Âú®Ë°®‰∏≠ÁöÑÂÅèÁßªÊù•ÂºïÁî®Â≠óÁ¨¶‰∏≤„ÄÇ Â¶ÇÂõæÊâÄÁ§∫ÔºåÂ∞±ÊòØÂ≠óÁ¨¶‰∏≤Ë°®ÁöÑ‰øùÂ≠òÊñπÂºèÔºåÊØè‰∏™Â≠óÁ¨¶‰∏≤‰ª• \0 ÁªìÂ∞æÔºåËøôÊ†∑Â∞±Âè™ÈúÄË¶ÅÁªôÂá∫‰∏Ä‰∏™Êï∞Â≠ó‰∏ãÊ†áÂ∞±ÂèØ‰ª•Ë°®Á§∫‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‰∫Ü„ÄÇ Á¨¶Âè∑‰ªÄ‰πàÊòØÁ¨¶Âè∑Ë°®ÈìæÊé•Â∞±ÊòØÊääÂèòÈáèÊàñÂáΩÊï∞ÁöÑÂú∞ÂùÄÂ°´Âà∞ÁºñËØëÂêéÁ©∫Ê¥ûÁöÑËøáÁ®ã„ÄÇÈìæÊé•‰∏≠ÁöÑÂèòÈáèÂíåÂáΩÊï∞ÁªüÁß∞‰∏∫Á¨¶Âè∑ ÊØè‰∏Ä‰∏™ÁõÆÊ†áÊñá‰ª∂ÈÉΩÊúâ‰∏Ä‰∏™Áõ∏Â∫îÁöÑÁ¨¶Âè∑Ë°®ÔºàSymbol TabelÔºâÔºåËÆ∞ÂΩï‰∫ÜÁî®Âà∞ÁöÑÊâÄÊúâÁöÑÁ¨¶Âè∑ÔºåÊØè‰∏™Á¨¶Âè∑Êúâ‰∏Ä‰∏™ÂØπÂ∫îÁöÑÂÄºÔºåÂè´ÂÅöÁ¨¶Âè∑ÂÄºÔºåÂØπ‰∫éÂèòÈáèÂíåÂáΩÊï∞Êù•ËØ¥ÔºåÁ¨¶Âè∑ÂÄºÂ∞±ÊòØÂÆÉ‰ª¨ÁöÑÂú∞ÂùÄ„ÄÇ ‰ª£Á†Å‰∏≠ÁöÑÂèòÈáèÊñπÊ≥ïÊúÄÁªàÁºñËØëÂêéÈÉΩÊõøÊç¢‰∏∫‰∫ÜÁ¨¶Âè∑Ë°®‰∏≠ÁöÑÂÅèÁßªÔºåÁÑ∂ÂêéÂú®ÊâæÂà∞ÂØπÂ∫îÁöÑÁ¨¶Âè∑ÂêéÔºåÂà∞Áõ∏Â∫îÁöÑ‰ΩçÁΩÆÂèñÂá∫ÂØπË±°ÔºàÂèØ‰ª•ÊòØ .data ÊÆµÔºåÂ≠óÁ¨¶‰∏≤Ë°®ÔºåÂ†ÜÊ†àÁ≠âÔºâ„ÄÇ Á¨¶Âè∑Ë°®ÁªìÊûÑÁ¨¶Âè∑Ë°®ÁªìÊûÑÂ¶Ç‰∏ãÔºö ÂÖ∂‰∏≠ st_info Áî®Êù•Ê†áËØÜÁ¨¶Âè∑ÊòØÂ±ÄÈÉ®Á¨¶Âè∑ÔºåÂÖ®Â±ÄÁ¨¶Âè∑ÔºåËøòÊòØÂº±Á¨¶Âè∑Ôºõ‰ª•ÂèäÁ¨¶Âè∑ÁöÑÁ±ªÂûãÔºåÊòØÂèòÈáèËøòÊòØÊï∞ÁªÑÔºåËøòÊòØÂáΩÊï∞„ÄÇ ‰∏ÄËà¨ÈÄöËøá st_shndx Âíå st_value ÂÆö‰ΩçÁ¨¶Âè∑ÁöÑÊâÄË°®Á§∫ÁöÑ‰ΩçÁΩÆ„ÄÇÁÑ∂ÂêéÈÄöËøá st_size ÊãøÂá∫Áõ∏Â∫îÂ§ßÂ∞èÁöÑÂÄº„ÄÇ Âº∫Á¨¶Âè∑ÂíåÂº±Á¨¶Âè∑ÁºñËØëÊúüËÆ§‰∏∫ÂáΩÊï∞ÂíåÂàùÂßãÂåñ‰∫ÜÁöÑÂÖ®Â±ÄÂèòÈáè‰∏∫Âº∫Á¨¶Âè∑ÔºåÊ≤°ÊúâÂàùÂßãÂåñÁöÑÂÖ®Â±ÄÂèòÈáè‰∏∫Âº±Á¨¶Âè∑„ÄÇ‰πüÂèØ‰ª•ÈÄöËøá __attribute__((weak)) Â£∞ÊòéÂº±Á¨¶Âè∑Ôºö 12345extern int ext;int weak;int strong = 1;__attribute ((weak)) weak2 = 2; ‰∏äÈù¢ weak Âíå weak2 ‰∏∫Âº±Á¨¶Âè∑Ôºåstrong ‰∏∫Âº∫Á¨¶Âè∑„ÄÇext Âç≥ÈùûÂº∫Á¨¶Âè∑‰πüÈùûÂº±Á¨¶Âè∑ÔºåÂÆÉÊòØ‰∏Ä‰∏™Â§ñÈÉ®ÂèòÈáèÁöÑÂºïÁî®„ÄÇ ÁºñËØëÊúüÈíàÂØπÂº∫Á¨¶Âè∑ÂíåÂº±Á¨¶Âè∑Âà∂ÂÆö‰∫Ü‰∏Ä‰∫õËßÑÂàôÔºö Âº∫Á¨¶Âè∑‰∏çÂèØ‰ª•ÂÆö‰πâÂ§öÊ¨°„ÄÇÂê¶ÂàôÊä•Èîô Â¶ÇÊûú‰∏Ä‰∏™Á¨¶Âè∑Âú®Êüê‰∏™ÁõÆÊ†áÊñá‰ª∂ÊòØÂº∫Á¨¶Âè∑ÔºåÂÖ∂‰ªñÊñá‰ª∂ÊòØÂº±Á¨¶Âè∑ÔºåÈÇ£‰πàÂÆÉÁöÑÁ±ªÂûã‰ª•Âº∫Á¨¶Âè∑‰∏∫ÂáÜ„ÄÇ Â¶ÇÊûú‰∏Ä‰∏™Á¨¶Âè∑Âú®ÊâÄÊúâÊñá‰ª∂‰∏≠ÈÉΩÊòØÂº±Á¨¶Âè∑ÔºåÈÇ£‰πàÈÄâÊã©Âç†Áî®Êéß‰ª∂ÊúÄÂ§ßÁöÑ‰∏Ä‰∏™Á¨¶Âè∑ÁöÑÁ±ªÂûã„ÄÇ Áî±‰∏äÂèØËßÅÔºåÁ¨¶Âè∑ÊòØ‰∏çÂ∏¶Á±ªÂûãÁöÑ„ÄÇ ÈùôÊÄÅÈìæÊé•ÈìæÊé•ËøáÁ®ãÂØπ‰∫éÂ§ö‰∏™ËæìÂÖ•ÁõÆÊ†áÊñá‰ª∂ÔºåÈìæÊé•Âô®Â¶Ç‰ΩïÂ∞ÜÂÆÉ‰ª¨ÂêàÂπ∂Âà∞‰∏Ä‰∏™ËæìÂá∫Êñá‰ª∂ÁöÑÔºü‰∏ÄËà¨ËÆ≤‰∏Ä‰∏™‰∏™Êñá‰ª∂ÁöÑÁõ∏‰ººÂ∫¶ÊÆµÂêàÂπ∂Ôºö ‰∏ÄËà¨‰ºöÁªèÂéÜ‰∏§Ê≠•Ôºö Á©∫Èó¥ÂíåÂú∞ÂùÄÂàÜÈÖç Á¨¶Âè∑Ëß£ÊûêÂíåÈáçÂÆö‰Ωç Á©∫Èó¥ÂíåÂú∞ÂùÄÂàÜÈÖçÈ¶ñÂÖàÊâ´ÊèèÊâÄÊúâÁöÑÁõÆÊ†áÊñá‰ª∂ÔºåËé∑ÂæóÊâÄÊúâÂêÑ‰∏™ÊÆµÁöÑÈïøÂ∫¶Â±ûÊÄßÂíå‰ΩçÁΩÆÔºåÁÑ∂ÂêéÂ∞ÜÁõÆÊ†áÊñá‰ª∂ÁöÑÊâÄÊúâÁ¨¶Âè∑ÂÆö‰πâÂíåÁ¨¶Âè∑ÂºïÁî®Êî∂ÈõÜËµ∑Êù•ÔºåÊîæÂà∞‰∏Ä‰∏™ÂÖ®Â±ÄÁ¨¶Âè∑Ë°®‰∏≠„ÄÇËøô‰∏ÄÊ≠•‰∏≠ÔºåÈìæÊé•Âô®ËÉΩËé∑ÂèñÊâÄÊúâÊÆµÁöÑÈïøÂ∫¶ÔºåÂπ∂Â∞ÜÂÆÉ‰ª¨ÂêàÂπ∂ÔºåËÆ°ÁÆóÂá∫ÂêàÂπ∂ÂêéÁöÑÂêÑ‰∏™ÊÆµÁöÑÈïøÂ∫¶Âíå‰ΩçÁΩÆÔºåÂπ∂Âª∫Á´ãÊò†Â∞ÑÂÖ≥Á≥ª„ÄÇ ËøôÂÖ∂ÂÆûÂ∞±ÊòØÁ∫†Ê≠£Á¨¶Âè∑ÊåáÂêëÁöÑÂèòÈáè„ÄÅÊñπÊ≥ïÁöÑ‰ΩçÁΩÆÂÅèÁßª Á¨¶Âè∑Ëß£ÊûêÂíåÈáçÂÆö‰ΩçELF Êñá‰ª∂‰∏≠Êúâ‰∏Ä‰∏™ÈáçÂÆö‰ΩçË°®‰∏ìÈó®Áî®Êù•‰øùÂ≠ò‰∫éÈáçÂÆö‰ΩçÁõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØ„ÄÇÈáçÂÆö‰ΩçË°®ÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÊï∞ÁªÑÁöÑÂÖÉÁ¥†ÈùûÂ∏∏ÁÆÄÂçïÔºö r_offset Ë°®Á§∫Á¨¶Âè∑Âú®ÂΩìÂâçÊñá‰ª∂ÁöÑÂÅèÁßªÈáèÔºår_info Ë°®Á§∫Ëøô‰∏™Á¨¶Âè∑ÁöÑ‰ø°ÊÅØ„ÄÇ Âú®ÈáçÂÆö‰ΩçÁöÑÊó∂ÂÄôÔºå‰ºöÊ†πÊçÆ r_info ÁöÑ‰ø°ÊÅØÔºåÂú®ÂÖ®Â±ÄÁ¨¶Âè∑Ë°®‰∏≠Êü•ÊâæÁõ∏Â∫îÁöÑÁ¨¶Âè∑„ÄÇÁÑ∂ÂêéÊääÁ¨¶Âè∑ÁöÑÂú∞ÂùÄÂÜôÂà∞ r_offset ÊâÄÊåáÂêëÁöÑÂÖ∂Âú®ÂΩìÂâçÊñá‰ª∂ÁöÑ‰ΩçÁΩÆÂÅèÁßª„ÄÇ ËøôÂÖ∂ÂÆûÂ∞±ÊòØÂ∞ÜÂçï‰∏™Êñá‰ª∂‰∏≠ÂéüÊú¨Áõ∏ÂØπ‰∫éÊú¨Êñá‰ª∂ÁöÑÂÅèÁßªÔºåËΩ¨Âåñ‰∏∫Áõ∏ÂØπ‰∫éÈìæÊé•ÂêéÊâÄÊúâÊñá‰ª∂ÁöÑ‰ΩçÁΩÆÁöÑÂÅèÁßª„ÄÇ ABIÊàë‰ª¨ÊääÁ¨¶Âè∑‰øÆÈ•∞Ê†áÂáÜÔºåÂèòÈáèÂÜÖÂ≠òÂ∏ÉÂ±ÄÔºåÂáΩÊï∞Ë∞ÉÁî®ÊñπÂºèÁ≠âË∑üÂèØÊâßË°å‰ª£Á†Å‰∫åËøõÂà∂ÂÖºÂÆπÊÄßÁõ∏ÂÖ≥ÁöÑÂÜÖÂÆπÁß∞‰∏∫ ABI„ÄÇ ABI ‰∏çÁ®≥ÂÆöÂ∞±ÊòØËØ¥ÂèòÈáèÁöÑÂÜÖÂ≠òÂ∏ÉÂ±ÄÔºåÂáΩÊï∞Ë∞ÉÁî®ÊñπÂºèÁ≠âÂèØËÉΩ‰ºöÂèòÔºå‰πüÂ∞±ÊòØÁºñËØëËßÑÂàôÂèØËÉΩ‰ºöÂèò„ÄÇ ABI Á®≥ÂÆöÂ∞±ÊòØÂú®‰∏çÂêåÁºñËØëÂô®‰∏ãÔºåÁºñËØëÂá∫Êù•ÁöÑÂèØÊâßË°åÊñá‰ª∂ËÉΩÂ§üË¢´Ê≠£Á°ÆÁöÑÈìæÊé•Âà∞‰∏ÄËµ∑„ÄÇ ÂΩ±Âìç ABI ÁöÑÂõ†Á¥†ÂæàÂ§öÔºåÊØîÂ¶ÇÔºö ÂÜÖÁΩÆÁ±ªÂûãÔºàÂ¶Ç int float Á≠âÔºâÁöÑÂ§ßÂ∞èÂíåÂú®Â≠òÂÇ®Âô®‰∏≠ÁöÑÊîæÁΩÆÊñπÂºè(Â§ßÁ´ØÔºåÂ∞èÁ´ØÔºåÂØπÂÖ∂ÊñπÂºè) ÁªÑÂêàÁ±ªÂûã(Â¶Ç structÔºå unionÔºåÊï∞ÁªÑÁ≠â)ÁöÑÂ≠òÂÇ®ÊñπÂºèÂíåÂÜÖÂ≠òÂ∏ÉÂ±Ä Â§ñÈÉ®Á¨¶Âè∑‰∏éÁî®Êà∑ÂÆö‰πâÁöÑÁ¨¶Âè∑‰πãÈó¥ÁöÑÂëΩÂêçÊñπÂºèÂíåËß£ÊûêÊñπÂºèÔºåÂ¶ÇÂáΩÊï∞Âêç func Âú® C ËØ≠Ë®ÄÁöÑÁõÆÊ†áÊñá‰ª∂‰∏≠ÊòØÂê¶Ë¢´Ëß£ÊûêÊàêÂ§ñÈÉ®Á¨¶Âè∑ _func ÂáΩÊï∞Ë∞ÉÁî®ÊñπÂºèÔºåÂ¶ÇÂèÇÊï∞ÂÖ•Ê†àÁÜüÊÇâÊÄíÔºåËøîÂõûÂÄºÂ¶Ç‰Ωï‰øùÊåÅ Â†ÜÊ†àÂàÜÂ∏ÉÊñπÂºèÔºåÂ¶ÇÂèÇÊï∞ÂíåÂ±ÄÈÉ®ÂèòÈáèÂú®Â†ÜÊ†à‰∏≠ÁöÑ‰ΩçÁΩÆÔºåÂèÇÊï∞‰º†ÈÄíÊñπÂºè ÂØÑÂ≠òÂô®‰ΩøÁî®Á∫¶ÂÆöÔºåÂáΩÊï∞Ë∞ÉÁî®Êó∂Âì™‰∫õÂØÑÂ≠òÂô®ÂèØ‰ª•‰øÆÊîπÂì™‰∫õÈúÄË¶Å‰øùÂ≠ò Áî±Ê≠§ÂèØËßÅ ABI ‰∏ªË¶ÅÂΩ±ÂìçÁùÄÁºñËØëÂíåÊ±áÁºñÁöÑËøáÁ®ãÔºö ÁºñËØë‰∏ªË¶ÅÂΩ±ÂìçÂáΩÊï∞Ë∞ÉÁî®Áõ∏ÂÖ≥ÁöÑÊ±áÁºñ‰ª£Á†ÅÁöÑÁîüÊàê ÈìæÊé•‰∏ªË¶ÅÂΩ±ÂìçÁîüÊàêÁöÑÂèØÊâßË°åÊñá‰ª∂ÁöÑÂÜÖÂ≠òÂàÜÂ∏É ÂèØÊâßË°åÊñá‰ª∂ÁöÑË£ÖËΩΩ‰∏éËøõÁ®ãËøõÁ®ãËôöÊãüÂú∞ÂùÄÁ©∫Èó¥Á®ãÂ∫èË¢´ËøêË°åËµ∑Êù•ÂêéÔºåÂ∞ÜÊã•ÊúâÁã¨Á´ãÁöÑËôöÊãüÂú∞ÂùÄÁ©∫Èó¥(Virtual Address)„ÄÇËøô‰∏™ËôöÊãüÂú∞ÂùÄÁ©∫Èó¥Â§ßÂ∞èÁî±ËÆ°ÁÆóÊú∫ÁöÑÁ°¨‰ª∂Âπ≥Âè∞ÂÜ≥ÂÆöÔºåÂÖ∑‰ΩìÂú∞ËØ¥ÊòØÁî± CPU ‰ΩçÊï∞ÂÜ≥ÂÆöÁöÑ„ÄÇÁ°¨‰ª∂ÂÜ≥ÂÆö‰∫ÜÂú∞ÂùÄÁ©∫Èó¥ÁöÑÊúÄÂ§ßÁêÜËÆ∫‰∏äÈôêÔºåÂç≥Á°¨‰ª∂ÂØªÂùÄÁ©∫Èó¥ÁöÑÂ§ßÂ∞è„ÄÇ‰∏Ä‰∏™32‰ΩçÂ§ÑÁêÜÂô®ÁöÑÊúÄÂ§ßÂØªÂùÄÁ©∫Èó¥ÊòØ 4GB„ÄÇ ÂØπ‰∫é‰∏Ä‰∏™ 32 ‰ΩçÁöÑÂ§ÑÁêÜÂô®Ôºå‰ªñÁöÑÊúÄÂ§ßÂØªÂùÄÁ©∫Èó¥ÊòØ 4GB„ÄÇ‰∏ÄËà¨Âú® Linux Á≥ªÁªü‰∏≠Â∞Ü‰ºöÊúâ 1 GBË¢´ÂàíÂàÜÁªôÊìç‰ΩúÁ≥ªÁªü„ÄÇÊàë‰ª¨ÁöÑËøõÁ®ãÊúÄÂ§ö‰ΩøÁî® 3GB ÁöÑËôöÊãüÁ©∫Èó¥„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÊï¥‰∏™ËøõÁ®ãÂú®ÊâßË°åÁöÑÊó∂ÂÄôÔºåÊâÄÊúâÁöÑ‰ª£Á†ÅÔºåÊï∞ÊçÆÂåÖÂåÖÊã¨ C ËØ≠Ë®Ä malloc() Á≠âÊñπÊ≥ïÁî≥ËØ∑ÁöÑËôöÊãüÁ©∫Èó¥‰πãÂíå‰∏çÂèØ‰ª•Ë∂ÖËøá 3GB„ÄÇ Ë£ÖËΩΩÊñπÂºèÂæàÂ§öÊó∂ÂÄôÔºåÊàë‰ª¨ÁöÑÁ®ãÂ∫èÂÆûÈôÖÈúÄË¶ÅÁöÑÂÜÖÂ≠òË¶ÅÂ§ß‰∫éÁâ©ÁêÜËÉΩÂ§üÂêåÊó∂Ë£ÖËΩΩÁöÑÂÜÖÂ≠ò„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÈúÄË¶ÅÊúâ‰∏ÄÁßçÂä®ÊÄÅË£ÖËΩΩÁöÑÊñπÂºèÂèØ‰ª•Â∞ÜÊúÄÂ∏∏Áî®ÁöÑÈÉ®ÂàÜÈ©ªÁïôÂÜÖÂ≠òÔºåËÄåÂ∞Ü‰∏çÂ∏∏Áî®ÁöÑÊï∞ÊçÆÂ≠òÊîæÂú®Á£ÅÁõò‰∏≠„ÄÇ È°µÊò†Â∞ÑÊòØÁé∞Âú®ÊúÄÂ∏∏Áî®ÁöÑÂä®ÊÄÅË£ÖËΩΩÊñπÊ≥ï„ÄÇÊÄùÊÉ≥Âè≤Á®ãÂ∫èÁî®Âà∞Âì™‰∏™Ê®°ÂùóÔºå‰πùÊ±üÂì™‰∏™Ê®°ÂùóË£ÖÂÖ•ÂÜÖÂ≠òÔºåÂ¶ÇÊûú‰∏çÁî®Â∞±ÊöÇ‰∏çË£ÖÂÖ•ÔºåÂ≠òÊîæÂú®Á£ÅÁõò‰∏≠„ÄÇ È°µÊò†Â∞ÑÂ∞ÜÂÜÖÂ≠òÂíåÁ£ÅÁõò‰∏≠ÁöÑÊâÄÊúâÊï∞ÊçÆÂíåÊåá‰ª§ÊåâÁÖßÈ°µ(page)‰∏∫Âçï‰ΩçÂàíÂàÜÊàêËã•Âπ≤‰∏™È°µÔºå‰ª•ÂêéÊâÄÊúâÁöÑË£ÖËΩΩÂíåÊìç‰ΩúÂçï‰ΩçÈÉΩÊòØÈ°µ„ÄÇ‰∏ÄËà¨‰ª• 4kb ‰Ωú‰∏∫‰∏Ä‰∏™È°µ„ÄÇ Êìç‰ΩúÁ≥ªÁªüËßíÂ∫¶ÁúãÂèØÊâßË°åÊñá‰ª∂ÁöÑË£ÖËΩΩÂàõÂª∫‰∏Ä‰∏™ËøõÁ®ãÔºåÊìç‰ΩúÁ≥ªÁªü‰∏ªË¶ÅÈúÄË¶ÅÂÅö‰ª•‰∏ã‰∏â‰ª∂‰∫ãÊÉÖÔºö ÂàõÂª∫Áã¨Á´ãÁöÑËôöÊãüÂú∞ÂùÄÁ©∫Èó¥„ÄÇÂàõÂª∫‰∏Ä‰∏™È°µÁõÆÂΩïÔºåÁî®‰∫éÁ°ÆÂÆöÁâ©ÁêÜÂÜÖÂ≠òÂíåËôöÊãüÁ©∫Èó¥ÁöÑÊò†Â∞ÑÂÖ≥Á≥ª„ÄÇ ËØªÂèñÂèØÊâßË°åÊñá‰ª∂Â§¥ÔºåÂª∫Á´ãËôöÊãüÁ©∫Èó¥ÂíåÂíåÊâßË°åÊñá‰ª∂ÁöÑÊò†Â∞ÑÂÖ≥Á≥ª„ÄÇ Â∞Ü CPU ÁöÑÊåá‰ª§ÂØÑÂ≠òÂô®ËÆæÁΩÆÊàêÂèØÊâßË°åÊñá‰ª∂ÁöÑÂÖ•Âè£Âú∞ÂùÄÔºåÂêØÂä®ËøêË°å ÂΩì CPU Â∞ÜË¶ÅÊâßË°åÊüê‰∏™Âú∞ÂùÄÁöÑÊåá‰ª§ÔºåÂπ∂‰∏îËØ•Âú∞ÂùÄÊòØ‰∏Ä‰∏™Á©∫È°µÁöÑÊó∂ÂÄôÔºàÂç≥È°µÊâÄÊåáÂêëÁöÑÁâ©ÁêÜÂú∞ÂùÄ‰∏äÂ≠òÊîæÁöÑ‰∏çÊòØËôöÊãüÁ©∫Èó¥ÊÉ≥Ë¶ÅÁöÑÊï∞ÊçÆÂíåÊåá‰ª§ÔºâÔºåÂ∞±Ë¢´ËÆ§‰∏∫ÊòØ‰∏Ä‰∏™È°µÈîôËØØÔºàPage FaultÔºâ„ÄÇCPU Â∞ÜÊéßÂà∂ÊùÉ‰∫§ÁªôÊìç‰ΩúÁ≥ªÁªü„ÄÇÊìç‰ΩúÁ≥ªÁªü‰ºöÂú®Áâ©ÁêÜÂÜÖÂ≠ò‰∏≠ÂàÜÈÖç‰∏Ä‰∏™Áâ©ÁêÜÈ°µÈù¢ÔºåÊàñËÄÖÊî∂Âõû‰∏Ä‰∏™Â∑≤‰ΩøÁî®ÁöÑÁâ©ÁêÜÈ°µÔºåÂ∞ÜËôöÊãüÈ°µÊâÄÈúÄÁöÑÊï∞ÊçÆÂíåÊåá‰ª§Âä†ËΩΩËøõÊù•ÔºåÁÑ∂ÂêéÂ∞ÜËøõÁ®ã‰∏≠ÁöÑËôöÊãüÈ°µÂíåÂàÜÈÖçÁöÑÁâ©ÁêÜÈ°µÂª∫Á´ãÊò†Â∞ÑÂÖ≥Á≥ªÔºåÊúÄÂêéÊääÊéßÂà∂ÊùÉ‰∫§ËøòÁªôËøõÁ®ãÔºåËøõÁ®ã‰ªéÂàöÊâçÈ°µÈîôËØØÁöÑ‰ΩçÁΩÆÈáçÊñ∞ÊâßË°å„ÄÇ ËøõÁ®ãËôöÊãüÊéß‰ª∂ÂàÜÂ∏Ésection Âíå segmentÂâçÊñáËØ¥ËøáÔºåÂèØÊâßË°åÊñá‰ª∂ÁöÑÂå∫ÂüüÊòØ‰ª• section ‰∏∫Âçï‰ΩçÂå∫ÂàÜÁöÑÔºåË£ÖËΩΩËøõÂÜÖÂ≠ò‰∏≠ÊòØ‰ª• segment ‰∏∫Âçï‰ΩçÂå∫ÂàÜÁöÑ„ÄÇsegment ‰∏≠ÂåÖÂê´‰∫ÜÂ§ö‰∏™ÊùÉÈôêÁõ∏ÂêåÁöÑ section„ÄÇ ËøôÊòØÂõ†‰∏∫ ELF Êñá‰ª∂Ë¢´Êò†Â∞ÑÊó∂ÔºåÊòØ‰ª•Á≥ªÁªüÁöÑÈ°µÈïøÂ∫¶‰∏∫Âçï‰ΩçÁöÑÔºåÊØè‰∏™ÊÆµÂú®Êò†Â∞ÑÊó∂ÁöÑÈïøÂ∫¶Â∫îËØ•ÊòØÁ≥ªÁªüÈ°µÈïøÂ∫¶ÁöÑÊï¥Êï∞ÂÄç„ÄÇÂ¶ÇÊûú‰∏çÊòØÔºåÈÇ£‰πàÂ§ö‰ΩôÈÉ®ÂàÜ‰πüË¶ÅÂç†Áî®‰∏Ä‰∏™È°µ„ÄÇ‰∏Ä‰∏™ ELF Êñá‰ª∂‰∏≠ÂæÄÂæÄÊúâÂçÅÂá†‰∏™ÊÆµÔºå‰ºöÈÄ†ÊàêÂÜÖÂ≠òÁ©∫Èó¥ÁöÑÊµ™Ë¥π„ÄÇÂõ†Ê≠§ÊääÁõ∏ÂêåÊùÉÈôêÁöÑ section ÂêàÂπ∂Âà∞‰∏ÄËµ∑ÂΩìÂÅö‰∏Ä‰∏™ segment ËøõË°åÊò†Â∞Ñ„ÄÇ Â¶ÇÂõæÊâÄÁ§∫ÔºåÂú®ËôöÊãüÂÜÖÂ≠ò‰∏≠Âç†Áî®‰∏â‰∏™È°µÁöÑ .textÊÆµÂíå .initÊÆµÔºå‰ºöË¢´ÂêàÂπ∂‰∏∫‰∏Ä‰∏™ segment ËΩΩÂÖ•„ÄÇÂú®Áâ©ÁêÜÂÜÖÂ≠ò‰∏≠Â∞±Âè™Âç†‰∏§‰∏™È°µÔºö Â†ÜÂíåÊ†àÂΩìÊàë‰ª¨‰ª• Segment ÂàíÂàÜÁöÑÊó∂ÂÄôÔºåËøõÁ®ãÂèØ‰ª•ÂàíÂàÜ‰∏∫‰ª•‰∏ãÂá†‰∏™Âå∫ÂüüÔºö ‰ª£Á†ÅÊÆµ Êï∞ÊçÆÊÆµ Â†ÜÊÆµ Ê†àÊÆµ Âä®ÊÄÅÈìæÊé•Âä®ÊÄÅÈìæÊé•ÁöÑÁõÆÁöÑÈùôÊÄÅÈìæÊé•Êµ™Ë¥πÂÜÖÂ≠òÂíåÁ£ÅÁõòÔºåÂä®ÊÄÅÈìæÊé•Âú®Á£ÅÁõòÂíåÂÜÖÂ≠ò‰∏≠Âè™‰ºö‰øùÂ≠ò‰∏Ä‰ªΩÔºåÂõ†Ê≠§ËäÇÁ∫¶‰∫ÜÂÜÖÂ≠ò„ÄÇÂä®ÊÄÅÈìæÊé•ÊääÈìæÊé•ÁöÑËøáÁ®ãÊé®ËøüÂà∞‰∫ÜËøêË°åÊó∂ÂÜçËøõË°å„ÄÇ Âú∞ÂùÄÊó†ÂÖ≥‰ª£Á†Å‰ªÄ‰πàÊòØÂú∞ÂùÄÊó†ÂÖ≥‰ª£Á†ÅÂú∞ÂùÄÊó†ÂÖ≥‰ª£Á†Å(PICÔºåPosition-independent Code)ÔºåÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØÊääÈúÄË¶ÅÁî®Âà∞ÁöÑÂ§ñÈÉ®Ê®°ÂùóÁöÑÂèòÈáèÂíåÊñπÊ≥ïÁöÑÂú∞ÂùÄÊäΩÁ¶ªÂá∫Êù•Ôºå‰Ωú‰∏∫ÂèòÈáèÂíåÂÖ∂‰ªñÊï∞ÊçÆÊîæÂú®‰∏ÄËµ∑„ÄÇËøôÊ†∑Êåá‰ª§ÈÉ®ÂàÜÂ∞±ÂíåÂÖ∑‰ΩìÁöÑÂú∞ÂùÄÊó†ÂÖ≥‰∫Ü„ÄÇ ÂØπ‰∫éÊ®°ÂùóÈó¥ÁöÑÂÖ®Â±ÄÂèòÈáèÂíåÊñπÊ≥ïÔºåELF Âú®Êï∞ÊçÆÊÆµ‰∏≠ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÊåáÂêëËøô‰∫õÂèòÈáèÁöÑÊåáÈíàÊï∞ÁªÑÔºå‰πüË¢´Áß∞‰∏∫ÂÖ®Â±ÄÂÅèÁßªË°®(Global Offset TableÔºåGOT)„ÄÇÂΩì‰ª£Á†ÅÈúÄË¶ÅÂºïÁî®ÂÖ®Â±ÄÂèòÈáèÊó∂ÔºåÂèØ‰ª•ÈÄöËøá GOT ‰∏≠Áõ∏Â∫îÁöÑÈ°πÈó¥Êé•ÂºïÁî®Ôºö ÂÖ±‰∫´Ê®°ÂùóÁöÑÂÖ®Â±ÄÂèòÈáèÂä®ÊÄÅÂ∫ìÂè™Êúâ‰∏Ä‰ªΩÔºåÈÇ£‰πàÂä®ÊÄÅÂ∫ì‰∏≠ÁöÑÂÖ®Â±ÄÂèòÈáè‰πüÊòØÂè™Êúâ‰∏Ä‰ªΩÂêóÔºü ‰∏ç‰ºö„ÄÇÂΩìÂÖ±‰∫´ÂØπË±°Âëó‰∏§‰∏™ËøõÁ®ãÂä†ËΩΩÊó∂Ôºå‰ªñÁöÑÊï∞ÊçÆÊÆµÈÉ®ÂàÜÂú®ÊØè‰∏™ËøõÁ®ã‰∏≠ÈÉΩÊúâÁã¨Á´ãÁöÑÂâØÊú¨„ÄÇ‰ªéËøô‰∏™ËßíÂ∫¶ÁúãÔºåÂÖ±‰∫´ÂØπË±°‰∏≠ÁöÑÂÖ®Â±ÄÂØπË±°ÂÆûÈôÖ‰∏äÂíåÂÆö‰πâÂú®Á®ãÂ∫èÂÜÖÈÉ®ÁöÑÂÖ®Â±ÄÂèòÈáèÊ≤°Êúâ‰ªÄ‰πàÂå∫Âà´„ÄÇ‰ªª‰Ωï‰∏Ä‰∏™ËøõÁ®ãËÆøÈóÆÁöÑÂè™ÊòØËá™Â∑±ÁöÑÈÇ£‰∏™ÂâØÊú¨Ôºå‰∏ç‰ºöÂΩ±ÂìçÂÖ∂‰ªñËøõÁ®ã„ÄÇ Âª∂ËøüÁªëÂÆöÂä®ÊÄÅÈìæÊé•Áõ∏ÂØπ‰∫éÈùôÊÄÅÈìæÊé•ÊÄßËÉΩÁï•Â∑ÆÔºå‰∏ªË¶ÅÂéüÂõ†Êúâ‰ª•‰∏ã‰∏§ÊñπÈù¢Ôºö Ê®°ÂùóÈó¥ÂØπ‰∫éÂÖ®Â±ÄÊï∞ÊçÆÁöÑËÆøÈóÆ‰ª•ÂèäÂáΩÊï∞Ë∞ÉÁî®ÔºåÈúÄË¶ÅËøõË°åÂ§çÊùÇÁöÑ GOT ÂÆö‰Ωç„ÄÇ Á®ãÂ∫èÂºÄÂßãÊâßË°åÊó∂ÔºåÂä®ÊÄÅÈìæÊé•Âô®‰ºöËøõË°åÈìæÊé•Â∑•‰Ωú„ÄÇÂä®ÊÄÅÈìæÊé•‰ºöË£ÖËΩΩÊâÄÈúÄÁöÑÊú™Ë£ÖËΩΩÁöÑÂÖ±‰∫´ÂØπË±°ÔºåÂπ∂ËøõË°åÁ¨¶Âè∑Êü•Êâæ‰ª•ÂèäÈáçÂÆö‰Ωç„ÄÇ ÈíàÂØπ‰∏äÈù¢ÁöÑÁ¨¨‰∫å‰∏™ÂéüÂõ†ÔºåÂèØ‰ª•‰ΩøÁî®Âª∂ËøüÁªëÂÆöÔºàLazy BindingÔºâÁöÑÊñπÂºèÔºåÂü∫Êú¨ÊÄùÊÉ≥ÊòØÂΩìÂáΩÊï∞Á¨¨‰∏ÄÊ¨°Ë¢´Áî®Âà∞Êó∂ÊâçËøõË°åÁªëÂÆöÔºàÁ¨¶Âè∑Êü•ÊâæÔºåÈáçÂÆö‰ΩçÁ≠âÔºâ„ÄÇ ELF ‰ΩøÁî® PLTÔºàProcedure Linkage TableÔºâÂÆûÁé∞„ÄÇ‰∏çÁõ¥Êé•‰ΩøÁî® GOT Ë∑≥ËΩ¨ÔºåËÄåÊòØÂÖàÈÄöËøá PLT„ÄÇ(ÂÖ∑‰Ωì‰ª£Á†Å‰∏äÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑ‰∏çÊé¢Á©∂‰∫Ü) ELF Â∞Ü GOT ÊãÜÂàÜÊàê‰∫Ü‰∏§‰∏™Ë°® .got Âíå .got.plt„ÄÇÂâçËÄÖÁî®Êù•‰øùÂ≠òÂÖ®Â±ÄÂèòÈáèÁöÑÂºïÁî®Âú∞ÂùÄÔºåÂêéËÄÖÁî®Êù•‰øùÂ≠òÂáΩÊï∞ÁöÑÂºïÁî®Âú∞ÂùÄ„ÄÇ Âä®ÊÄÅÈìæÊé•Áõ∏ÂÖ≥ÁªìÊûÑ.interp ÊÆµ.interp ÊÆµ‰∏≠‰øùÂ≠ò‰∫ÜÂèØÊâßË°åÊñá‰ª∂ÊâÄÈúÄÁöÑÂä®ÊÄÅÈìæÊé•Âô®ÁöÑË∑Ø .dynamic ÊÆµ‰øùÂ≠ò‰∫ÜÂä®ÊÄÅÈìæÊé•Âô®ÊâÄÈúÄÁöÑÂü∫Êú¨‰ø°ÊÅØ„ÄÇÂåÖÊã¨‰æùËµñ‰∫éÂì™‰∫õÂÖ±‰∫´ÂØπË±°ÔºåÂä®ÊÄÅÈìæÊé•Á¨¶Âè∑Ë°®ÁöÑ‰ΩçÁΩÆÔºåÂä®ÊÄÅÈìæÊé•Á¨¶Âè∑Ë°®ÁöÑ‰ΩçÁΩÆÔºåÂÖ±‰∫´ÂØπË±°ÂàùÂßãÂåñ‰ª£Á†ÅÁöÑÂú∞ÂùÄ„ÄÇ .dynsym ÊÆµÈùôÊÄÅÈìæÊé•‰∏≠Êúâ‰∏Ä‰∏™Á¨¶Âè∑Ë°® .symtab(Symbol Table)Ôºå‰øùÂ≠ò‰∫ÜÁõÆÊ†áÊñá‰ª∂ÁöÑÁ¨¶Âè∑ÂíåÂºïÁî®„ÄÇELF Êúâ‰∏Ä‰∏™‰∏ìÈó®ÁöÑÂä®ÊÄÅÁ¨¶Âè∑Ë°®ÔºàDynamic Symbol TableÔºâ„ÄÇÁî±‰∫éÂú®Âä®ÊÄÅÈìæÊé•‰∏ãÔºåÈúÄË¶ÅÂú®Á®ãÂ∫èËøêË°åÊó∂Êü•ÊâæÁ¨¶Âè∑Ôºå‰∏∫‰∫ÜÂä†Âø´Á¨¶Âè∑ÁöÑÊü•ÊâæËøáÁ®ãÔºåÂæÄÂæÄËøòÊúâËæÖÂä©ÁöÑÁ¨¶Âè∑ÂìàÂ∏åË°®Ôºà.hashÔºâ Âä®ÊÄÅÈìæÊé•Ê≠•È™§ Âä®ÊÄÅÈìæÊé•Âô®Ëá™‰∏æ Ë£ÖËΩΩÂÖ±‰∫´ÂØπË±° ÈáçÂÆö‰ΩçÂíåÂàùÂßãÂåñ Âä®ÊÄÅÈìæÊé•ÂÖ∑‰ΩìÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑ‰∏çÂÅöÊ∑±ÂÖ•Êé¢Á©∂„ÄÇ ÂÜÖÂ≠òÁ®ãÂ∫èÂÜÖÂ≠òÂ∏ÉÂ±ÄÁ®ãÂ∫èÁöÑÂÜÖÂ≠òÂ∏ÉÂ±ÄÂ¶Ç‰∏ãÔºö ÂÖ∂‰∏≠ dynamic libraries ‰∏∫Âä®ÊÄÅÈìæÊé•Â∫ìÊò†Â∞ÑÂå∫ÔºåËØ•Âå∫ÂüüÁî®‰∫éÊò†Â∞ÑË£ÖËΩΩÁöÑÂä®ÊÄÅÈìæÊé•Â∫ì„ÄÇLinux ‰∏ãÔºåÁ≥ªÁªüÈªòËÆ§‰ªé 0x40000000 ÂºÄÂßãÂàÜÈÖçÁõ∏Â∫îÁöÑÊéß‰ª∂ÔºåÁî®‰∫éÂÖ±‰∫´Â∫ìËΩΩÂÖ•Âà∞ÂÜÖÂ≠ò„ÄÇ Âõæ‰∏≠ÁöÑÁÆ≠Â§¥Ë°®Êòé‰∫ÜÂ†ÜÂíåÊ†àÁöÑÂ¢ûÈïøÊñπÂêëÔºåÂèØ‰ª•ÁúãÂà∞ÔºåÂ†ÜÂêëÈ´òÂú∞ÂùÄÂ¢ûÈïøÔºåÊ†àÂêë‰ΩéÂú∞ÂùÄÂ¢ûÈïøÔºåÁõ¥Âà∞È¢ÑÁïôÁöÑÊéß‰ª∂Áî®ÂÆå‰∏∫Ê≠¢„ÄÇ Ê†àÁöÑË∞ÉÁî®Ê†àÁõ∏ÂÖ≥ÁöÑ‰∫î‰∏™ÂØÑÂ≠òÂô®Ê†àÁöÑË∞ÉÁî®‰ºöÁî®Âà∞Âõõ‰∏™ CPU ÂØÑÂ≠òÂô®Ôºö BP(Base Pointer) ÔºöÂàÜÂâ≤ÂΩìÂâçË∞ÉÁî®ÁöÑÊñπÊ≥ïÂíå‰∏ä‰∏Ä‰∏™Ë∞ÉÁî®ÁöÑÊñπÊ≥ï SP(Stack Pointer)Ôºö‰øùÂ≠òÊ†àÈ°∂ÁöÑ‰ΩçÁΩÆ SS(Stack Segment )Ôºö‰øùÂ≠òÊ†àÊÆµÁöÑ‰ΩçÁΩÆ IP(Instruction Pointer)Ôºö‰øùÂ≠ò‰∏ã‰∏ÄÊù°Êåá‰ª§ÁöÑÂú∞ÂùÄ AXÔºö‰øùÂ≠òÂΩìÂâçÊñπÊ≥ïÁöÑËøîÂõûÂÄº ÊñπÊ≥ïË∞ÉÁî®‰∏éÊ†àÁöÑÂèòÂåñÂÖ≥Á≥ª‰∏Ä‰∏™ÊñπÊ≥ïË∞ÉÁî®ÊµÅÁ®ãÂ¶Ç‰∏ã Â∞ÜÊñπÊ≥ïÁöÑÂÖ•ÂèÇ‰ªéÂè≥Ëá≥Â∑¶‰æùÊ¨°ÂÖ•Ê†à Â∞ÜËØ•ÊñπÊ≥ïÊâßË°åÂÆåÂêéËøîÂõûÁöÑÂú∞ÂùÄÂÖ•Ê†à Â∞ÜÂΩìÂâç bp ÊåáÂêëÁöÑÂú∞ÂùÄÂÖ•Ê†àÔºåÂπ∂Â∞Ü bp ÊåáÂêëÂΩìÂâç sp ÊåáÂêëÁöÑ‰ΩçÁΩÆ Â∞ÜÊñπÊ≥ï‰∏≠ÂàõÂª∫ÁöÑÂ±ÄÈÉ®ÂèòÈáèÂéãÊ†à(ÂÆûÈôÖÊòØÁõ¥Êé•Áªô sp Â¢ûÂä†‰∏Ä‰∏™Âõ∫ÂÆöÁöÑÂÄºÔºåËÆ©Â±ÄÈÉ®ÂèòÈáè‰∏çÂê¨ÁöÑÂæÄÈáå pushÔºåËÄå‰∏çÊòØ push ‰∏Ä‰∏™Â±ÄÈÉ®ÂèòÈáèÔºåÂèò‰∏ÄÊ¨° sp ÁöÑÊåáÂêë) ÊñπÊ≥ïÊâßË°åÂÆåÊØïÔºåÂ∞ÜËøîÂõûÂÄºÁöÑÂú∞ÂùÄËµãÁªô ax ÂØÑÂ≠òÂô® Âá∫Ê†àÁõ¥Âà∞ sp Âíå bp ÊåáÂêëÂêå‰∏Ä‰∏™Âú∞ÂùÄ Êää‰øùÂ≠òÁöÑËøîÂõûÂú∞ÂùÄÂá∫Ê†àÔºåÂπ∂ËµãÁªô ip Âá∫Ê†àÁõ¥Âà∞Â∞ÜÊñπÊ≥ïÁöÑÂÖ•ÂèÇÈÉΩ pop ÂÆå Á≥ªÁªüË∞ÉÁî®Á≥ªÁªüË∞ÉÁî®ÂéüÁêÜÁâπÊùÉÁ∫ß‰∏é‰∏≠Êñ≠Âú®Êìç‰ΩúÁ≥ªÁªü‰∏≠ÈÄöÂ∏∏Êúâ‰∏§ÁßçÁâπÊùÉÁ∫ßÂà´Áî®Êà∑Ê®°ÂºèÔºàUser ModeÔºâÂíåÂÜÖÊ†∏Ê®°ÂºèÔºàKernel ModeÔºâÔºå‰πüË¢´Êàê‰∏∫Áî®Êà∑ÊÄÅÂíåÂÜÖÊ†∏ÊÄÅ„ÄÇ Á≥ªÁªüË∞ÉÁî®ËøêË°åÂú®ÂÜÖÊ†∏ÊÄÅÔºåÂ∫îÁî®Á®ãÂ∫èËøêË°åÂú®Áî®Êà∑ÊÄÅ„ÄÇÂÜÖÊ†∏ÊÄÅÂèØ‰ª•ËøêË°åÁî®Êà∑ÊÄÅÁöÑ‰ª£Á†Å„ÄÇ‰ΩÜÊòØÁî®Êà∑ÊÄÅÊÉ≥Ë¶ÅËøêË°åÂÜÖÊ†∏ÊÄÅÁöÑ‰ª£Á†ÅÂøÖÈ°ªÈÄöËøá‰∏≠Êñ≠ÔºàinterruptÔºâ„ÄÇ‰∏≠Êñ≠ÊòØ‰∏Ä‰∏™Á°¨‰ª∂ÊàñËΩØ‰ª∂ÂèëÂá∫ÁöÑËØ∑Ê±ÇÔºåË¶ÅÊ±ÇCPUÊöÇÂÅúÂΩìÂâçÁöÑÂ∑•‰ΩúËΩ¨ÊâãÂéªÂ§ÑÁêÜÊõ¥ÈáçË¶ÅÁöÑ‰∫ãÊÉÖ„ÄÇ ÊØîÂ¶ÇÊåâ‰∏ãÈîÆÁõòÔºåÈîÆÁõò‰∏äÁöÑËäØÁâáÂèëÈÄÅ‰∏Ä‰∏™‰ø°Âè∑Áªô CPUÔºåCPU Êî∂Âà∞‰ø°Âè∑ÂêéÁü•ÈÅìÈîÆÁõòÊåâ‰∏ã‰∫ÜÔºåÂÜçÂéªËØ¢ÈóÆÈîÆÁõòË¢´Êåâ‰∏ãÁöÑÈîÆ„ÄÇËøô‰∏™‰ø°Âè∑Â∞±ÊòØ‰∏Ä‰∏™‰∏≠Êñ≠„ÄÇ ‰∏≠Êñ≠‰∏ÄËà¨ÂÖ∑Êúâ‰∏§‰∏™Â±ûÊÄßÔºå‰∏Ä‰∏™ÊòØ‰∏≠Êñ≠Âè∑(‰ªé0ÂºÄÂßã)Ôºå‰∏Ä‰∏™ÊòØ‰∏≠Êñ≠Â§ÑÁêÜÁ®ãÂ∫è„ÄÇÂÜÖÊ†∏‰∏≠ÔºåÂ≠òÂú®‰∏Ä‰∏™Êï∞ÁªÑÂè´ÂÅö‰∏≠Êñ≠ÂêëÈáèË°®ÔºåËøô‰∏™Êï∞ÁªÑ‰øùÂ≠òÁùÄ‰∏≠Êñ≠Âè∑Âíå‰∏≠Êñ≠Â§ÑÁêÜÁ®ãÂ∫èÁöÑÊò†Â∞Ñ„ÄÇ Linux ‰ΩøÁî® int 0x80 Êù•Áî®Êà∑Ëß¶Âèë‰∏≠Êñ≠„ÄÇÁî®Êà∑Â∞Ü‰∏≠Êñ≠Âè∑ÊîæÂÖ• AX ÂØÑÂ≠òÂô®‰∏≠ÔºåÁÑ∂Âêé‰ΩøÁî® int 0x80 Ëß¶Âèë‰∏≠Êñ≠„ÄÇ‰∏≠Êñ≠ÊúçÂä°Á®ãÂ∫èÂ∞±ÂèØ‰ª•ÈÄöËøá AX Ëé∑Âèñ‰∏≠Êñ≠Âè∑ÔºåË∞ÉÁî®ÂØπÂ∫îÁöÑÂáΩÊï∞„ÄÇ ÂèØ‰ª•ÁúãÂà∞ 0x80 ÊòØ‰∏≠Êñ≠ÂêëÈáè‰∏≠ÁöÑ‰∏Ä‰∏™Ôºå‰ª£Ë°®ÁùÄÁî®Êà∑Ëß¶ÂèëÁöÑ‰∏≠Êñ≠ ÂàáÊç¢Â†ÜÊ†àLinux ‰∏≠Áî®Êà∑ÊÄÅÂíåÂÜÖÊ†∏ÊÄÅ‰ΩøÁî®‰∏çÂêåÁöÑÊ†àÔºåÂΩìÂ∫îÁî®Á®ãÂ∫èË∞ÉÁî® 0x80 Âè∑‰∏≠Êñ≠Êó∂ÔºåÁ®ãÂ∫èÁöÑÊâßË°åÊµÅÁ®ã‰ªéÁî®Êà∑ÊÄÅÂàáÊç¢Âà∞ÂÜÖÊ†∏ÊÄÅÔºåÁ®ãÂ∫èÁöÑÂΩìÂâçÊ†à‰πüÁõ∏Â∫îÁöÑ‰ªéÁî®Êà∑Ê†àÂàáÊç¢Âà∞ÂÜÖÊ†∏Ê†à„ÄÇ‰∏≠Êñ≠ÂÆåÊàêÂêéÔºåÁ®ãÂ∫èÁöÑÂΩìÂâçÊ†à‰ªéÂÜÖÊ†∏Ê†àÂàáÊç¢ÂõûÁî®Êà∑Ê†à„ÄÇ ÂΩì 0x80 Âè∑‰∏≠Êñ≠ÂèëÁîüÁöÑÊó∂ÂÄôÔºåËøáÁ®ãÂ¶Ç‰∏ãÔºö ‰øùÂ≠òÂΩìÂâçÁî®Êà∑Ê†àÁöÑ SP Âíå SS ÁöÑÂÄº ÊâæÂà∞ËøõÁ®ãÁöÑÂÜÖÊ†∏Ê†à(ÊØè‰∏Ä‰∏™ËøõÁ®ãÈÉΩÊúâËá™Â∑±ÁöÑÂÜÖÊ†∏Ê†à) Â∞Ü SP Âíå SS ËÆæÁΩÆ‰∏∫ÂÜÖÊ†∏Ê†àÁöÑÁõ∏Â∫îÂÄº Âú®ÂÜÖÊ†∏Ê†à‰∏≠‰æùÊ¨°‰∫öËåπÁî®Êà∑ÊÄÅÁöÑÂØÑÂ≠òÂô® SSÔºå SP Á≠â‰ª•‰æõÊÅ¢Â§çË∞ÉÁî® ‚à¥ÂàáÊç¢Â†ÜÊ†àÂ∞±ÊòØÂàáÊç¢ CPU ÁöÑÂØÑÂ≠òÂô®„ÄÇ Ë∂£Ë∞à Linux Á≥ªÁªü(ÊûÅÂÆ¢Êó∂Èó¥)Á≥ªÁªüÂàùÂßãÂåñCPU ÁöÑÁªÑÊàêCPU Áî±‰∏âÈÉ®ÂàÜÁªÑÊàê ËøêÁÆóÂçïÂÖÉÔºöÂè™ÁÆ°ÁÆóÔºåÂ¶ÇÂÅöÂä†Ê≥ïÊàñËÄÖ‰ΩçÁßª Êï∞ÊçÆÂçïÂÖÉÔºöCPU ÂÜÖÈÉ®ÁöÑÂØÑÂ≠òÂô®ÁªÑ ÊéßÂà∂ÂçïÂÖÉÔºöËØªÂèñÊâßË°åÊåá‰ª§ÔºåËøô‰∏™Êåá‰ª§‰ºöÊåáÂØºËøêÁÆóÂçïÂÖÉÂèñÂá∫Êï∞ÊçÆÂçïÂÖÉ‰∏≠Êï∞ÊçÆÔºåËÆ°ÁÆóÁªìÊûúÔºåÁÑ∂ÂêéÊîæÂà∞Êï∞ÊçÆÂçïÂÖÉÁöÑÊüê‰∏™Âú∞Êñπ x86 ÁöÑÁî±Êù•Êó©ÊúüÂêÑÂÆ∂ÁöÑ CPU Êû∂ÊûÑÂêÑ‰∏çÁõ∏Âêå„ÄÇÁõ¥Âà∞Ëã±ÁâπÂ∞îÁöÑ 8086 ËäØÁâáÂÅöÂà∞‰∫ÜÂºÄÊîæÁªü‰∏ÄÂíåÂÖºÂÆπ„ÄÇÂõ†Ê≠§Ë¢´Áß∞‰∏∫ x86 Êû∂ÊûÑ„ÄÇ BIOSËÆ°ÁÆóÊú∫‰∏ªÊùø‰∏äÊúâ‰∏Ä‰∏™ ROM(Âè™ËØªÂ≠òÂÇ®Âô®)ÔºåÂú®‰∏äÈù¢Âõ∫Âåñ‰∫ÜÂàùÂßãÂåñÁ®ãÂ∫èÔºå‰πüÂ∞±ÊòØ BIOS„ÄÇ ÂΩìÁîµËÑëÂàöÂä†ÁîµÁöÑÊó∂ÂÄôÔºå‰ºöÂÅö‰∏Ä‰∫õÈáçÁΩÆÁöÑÂ∑•‰ΩúÔºåÂ∞Ü CS ËÆæÁΩÆ‰∏∫ 0xFFFFÔºåÂ∞Ü IP ËÆæÁΩÆ‰∏∫ 0x0000ÔºåÊâÄ‰ª•Á¨¨‰∏ÄÊù°Êåá‰ª§Â∞±‰ºöÊåáÂêë 0xFFFF0ÔºåÊ≠£ÊòØÂú® ROM ÁöÑËåÉÂõ¥ÂÜÖ„ÄÇÂú®ËøôÈáåÔºåÊúâ‰∏Ä‰∏™ JMP ÂëΩ‰ª§‰ºöË∑≥Âà∞ ROM ‰∏≠ÂÅöÂàùÂßãÂåñÂ∑•‰ΩúÁöÑ‰ª£Á†ÅÔºå‰∫éÊòØÔºåBIOS ÂºÄÂßãËøõË°åÂàùÂßãÂåñÁöÑÂ∑•‰Ωú„ÄÇ]]></content>
      <categories>
        <category>ËÆ°ÁÆóÊú∫</category>
      </categories>
      <tags>
        <tag>ËØª‰π¶Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react.js ‰ΩøÁî®]]></title>
    <url>%2F2019%2F05%2F06%2Freact%2F</url>
    <content type="text"><![CDATA[ÂÜô‰∫Ü‰∏ÄÂπ¥Â§öÁöÑ RNÔºåreact ÂåÖÊã¨ redux ËøòÊòØÂæàÁÜüÁªÉÁöÑÔºå‰ΩÜÊòØÂÜôËµ∑ pc Á´ØÈ°øÊó∂ÊúâÁÇπÊáµÈÄº„ÄÇ styled-componentsÂΩìÊàë‰ª¨Âú®‰∏Ä‰∏™ js Êñá‰ª∂‰∏≠ÂºïÂÖ•‰∏Ä‰∏™ css Êñá‰ª∂ÁöÑÊó∂ÂÄôÔºåÂÆûÈôÖ‰∏äÊòØÂÖ®Â±ÄÂºïÁî®ÁöÑ„ÄÇËøôÊ†∑‰ºöÈÄ†ÊàêÊ†∑ÂºèÊ∑∑‰π±„ÄÇÈúÄË¶ÅÂºïÂÖ•Ê†∑ÂºèÊ®°Âùó„ÄÇÂõ†Ê≠§ÂèØ‰ª•‰ΩøÁî® styled-components ÂÆâË£Ö1npm install --save styled-components Áé∞Âú®Ê†∑Âºè‰∏çÂÜç‰ΩøÁî® css ÂÆö‰πâÔºåËÄåÊòØ‰ΩøÁî® js ÂÆö‰πâ Âü∫Êú¨‰ΩøÁî®Âú® style.js ‰∏≠ÂÆö‰πâÁªÑ‰ª∂ÔºåÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âè´ HeaderWrapper ÁöÑ div Ê†áÁ≠æÔºö 123456import styled from 'styled-components'export const HeaderWrapper = styled.div` height: 54px; background: red;` Áé∞Âú®ÂèØ‰ª•Êää HeaderWrapper ÂΩìÊàêÊôÆÈÄöÁªÑ‰ª∂‰∏ÄÊ†∑‰ΩøÁî®Ôºö 123456789101112import React, &#123; Component &#125; from 'react'import &#123; HeaderWrapper&#125; from './style'class Header extends Component &#123; render () &#123; return ( &lt;HeaderWrapper&gt;header&lt;/HeaderWrapper&gt; ) &#125;&#125; ËÆæÁΩÆÊ†∑ÂºèÂÖ®Â±ÄÊ†∑ÂºèÂàõÂª∫ style.js Êñá‰ª∂„ÄÇÂºïÂÖ•ÂÖ®Â±ÄÊ†∑ÂºèÊ®°Âùó injectGlobal: 123456789import &#123; injectGlobal &#125; from 'styled-components'injectGlobal` body &#123; margin: 0; padding: 0; background: green; &#125;` ÈÄöËøáÂèçÂºïÂè∑ÂåÖË£πÁöÑÂ∞±ÊòØÊ≥®ÂÖ•ÂÖ®Â±ÄÁöÑÊ†∑ÂºèÔºåÁÑ∂ÂêéÂú®Ê†πËßÜÂõæ‰∏≠ÂºïÂÖ•Ôºö 1import './style.js' Êüê‰∏Ä‰∏™ÁªÑ‰ª∂ÁöÑÁâπÂÆöÊ†∑ÂºèÊüê‰∏Ä‰∏™ÁªÑ‰ª∂ÂèØ‰ª•Ê†πÊçÆ‰º†ÂÖ•ÁöÑ className ËÆæÁΩÆ‰∏çÂêåÁöÑÊ†∑ÂºèÔºö 12345678910111213export const NavItem = styled.div` &amp;.left &#123; float: left; &#125; &amp;.right &#123; float: right; &#125; &amp;.active &#123; background: #fff; &#125; line-height: 56px; padding: 15px;` ‰ΩøÁî® &amp; Ë°®Á§∫ÂΩìÂâçÁªÑ‰ª∂ÁöÑ className„ÄÇ‰ΩøÁî®ÊñπÂºèÂ¶Ç‰∏ãÔºö 1234import &#123;NavItem&#125; from './style.js'&lt;NavItem className='left active'&gt;Â∑¶ËæπÊ†∑Âºè&lt;/NavItem&gt;&lt;NavItem className='right'&gt;Âè≥ËæπÊ†∑Âºè&lt;/NavItem&gt; Áà∂ÁªÑ‰ª∂‰∏≠ËÆæÁΩÆÂ≠êÁªÑ‰ª∂ÁöÑÊ†∑ÂºèÁà∂ÁªÑ‰ª∂‰∏≠ÂèØ‰ª•ÈÄöËøáÂ≠êÁªÑ‰ª∂ÁöÑ className ÂÆö‰ΩçÂ≠êÁªÑ‰ª∂„ÄÇÊØîÂ¶ÇÊúâ‰∏Ä‰∏™Â≠êÁªÑ‰ª∂ÁöÑ className ‰∏∫ iconfontÔºö 1234567export const Parent = styled.div` height: 100px; .iconfont &#123; position: absolute; right: 0; &#125;` Ê≥®ÊÑèÔºåÁªÑ‰ª∂ËÆæÁΩÆËá™Â∑±ÁöÑÊ†∑ÂºèÊòØÈÄöËøá &amp;.classnameÔºåËÄåËÆæÁΩÆÂ≠êÁªÑ‰ª∂ÁöÑÊ†∑ÂºèÊòØÈÄöËøá .classname ÂÆåÊàêÁöÑ„ÄÇ Áà∂ÁªÑ‰ª∂‰∏≠ËÆæÁΩÆÂ≠êÊ†áÁ≠æÁöÑÊ†∑ÂºèÂÖ∂ÂÆûÂ∞±Âíå less ‰∏ÄÊ†∑ÔºåÂèØ‰ª•Âú®Áà∂Ê†∑Âºè‰∏≠ËÆæÁΩÆÂ≠êÊ†∑ÂºèÔºö 12345export const Parent = styled.div` div &#123; height: 20px; &#125; ` ËÆæÁΩÆ Parent ÁªÑ‰ª∂ÂÜÖÈÉ®ÁöÑ div ÈªòËÆ§ÊòØ 20px ÂÖ∂‰ªñ‰ΩøÁî®ÂºïÂÖ•ËµÑÊ∫êÊØîÂ¶ÇÈúÄË¶ÅÂú®Ê†∑Âºè‰∏≠ËÆæÁΩÆËÉåÊôØÂõæÁâáÔºåÁõ¥Êé•‰ΩøÁî®Áõ∏ÂØπË∑ØÂæÑÊòØÊó†Áî®ÁöÑÔºåÈúÄË¶ÅÂºïÂÖ•ÈÖçÂêà webpack ‰ΩøÁî®Ôºö 12345import logoPic from '../../assets/logo.png'export const Logo = styled.a` background: url($&#123;logoPic&#125;)` ÈÄöËøá import ÂºïÂÖ•ÁöÑËµÑÊ∫êÊñá‰ª∂ÈúÄË¶ÅÈÄöËøá ${} ËøôÊ†∑ÁöÑÊ®°ÊùøËØ≠Ê≥ï‰ΩøÁî®„ÄÇ Ëé∑Âèñ js ‰∏≠ÁöÑ propsËøòÊòØ‰ΩøÁî® ${}ÔºåÂÆÉÈô§‰∫ÜÂèØ‰ª•‰º†ÂÖ•‰∏Ä‰∏™Ë∑ØÂæÑÔºåËøòÂèØ‰ª•Êé•Êî∂‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂÖ•ÂèÇÂ∞±ÊòØËØ•ÁªÑ‰ª∂ÁöÑ propsÔºö 123export const SomeItem = styled.div` background: url($&#123;(props) =&gt; props.imgUrl&#125;)` 1234567import &#123;SomeItem&#125; from 'style'class App extends Components &#123; render () &#123; &lt;SomeItem imgUrl='http://xxxxx' /&gt; &#125;&#125; Èô§styleÂ§ñÁöÑÈªòËÆ§Â±ûÊÄßÂÆö‰πâÁªÑ‰ª∂ÁöÑÊó∂ÂÄôÂèØ‰ª•ÁªôÁªÑ‰ª∂ËÆæÁΩÆÈªòËÆ§ÁöÑÂ±ûÊÄßÔºö 123456export const Navsearch = styled.input.attrs(&#123; placeholder: 'ÊêúÁ¥¢'&#125;)` width: 90px; height: 32px;` ËøôÊòØ‰∏Ä‰∏™ËæìÂÖ•Ê°ÜÁªÑ‰ª∂ÔºåÈÄöËøá attrs ËÆæÁΩÆÈªòËÆ§Âç†‰ΩçÁ¨¶Â±ûÊÄß„ÄÇ Ë∑ØÁî±ÂÆâË£Ö1npm install --save react-router-dom ‰ΩøÁî®1234567891011121314151617import &#123;BrowserRouter, Router&#125; from 'react-router-dom'import Home from './pages/home'class App extends Component &#123; render () &#123; return ( &lt;div&gt; &lt;BrowserRouter&gt; &lt;div&gt; &lt;Route exact path='/' render=&#123;Home&#125; /&gt; &lt;Route exact path='/detail' render=&#123;()=&gt;(&lt;div&gt;detail&lt;/div&gt;)&#125; /&gt; &lt;/div&gt; &lt;/BrowserRouter&gt; &lt;/div&gt; ) &#125;&#125; Ë∑≥ËΩ¨‰ΩøÁî® Link Ê†áÁ≠æÂåÖË£πÔºö 1234567891011import &#123;Link&#125; from 'react-router-dom'class Home extends Component &#123; render () &#123; return ( &lt;Link to='/detail'&gt; &lt;SomeImg /&gt; &lt;/Link&gt; ) &#125;&#125; Âíå Link Á±ª‰ººÁöÑÔºåËøòÊúâ Redirect Ê†áÁ≠æÔºåÁî®‰∫éÈáçÂÆöÂêëÔºö 1234567891011import &#123;Redirect&#125; from 'react-router-dom'class Home extends Component &#123; render () &#123; return ( &lt;Redirect to='/login'&gt; &lt;SomeView /&gt; &lt;/Redirect&gt; ) &#125;&#125; Ëá™Âä®ÈáçÂÆöÂêë‰∏äÈù¢ÊºîÁ§∫ÁöÑÊòØÈúÄË¶ÅÁÇπÂáªÁöÑË∑≥ËΩ¨ÂíåÈáçÂÆöÂêëÔºå‰ΩÜÊòØÊúâÊó∂ÂÄôÈúÄË¶ÅËá™Âä®ÁöÑÈáçÂÆöÂêëÊØîÂ¶ÇÊú™ÁôªÂΩïÁöÑÊó∂ÂÄôÁõ¥Êé•Ë∑≥ËΩ¨ÁôªÂΩïÈ°µ„ÄÇ ‰∏∫‰∫ÜËææÂà∞Ëøô‰∏™ÊïàÊûúÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∏™Ëá™Èó≠ÂêàÁöÑ Redirect Ê†áÁ≠æÔºö 12345678910111213141516import &#123;Redirect&#125; from 'react-router-dom'class Home extends Component &#123; render () &#123; return ( &#123; this.props.login ? ( &lt;HomeView /&gt; ) : ( &lt;Redirect to='/login' /&gt; ) &#125; ) &#125;&#125; Â∫îËØ•ÊòØ Redirect ‰ºöÂú®Ê∏≤ÊüìÁöÑÊó∂ÂÄôÂà§Êñ≠ÊòØÂê¶ÊúâÂ≠êÂÖÉÁ¥†Ôºå‰ª•Ê≠§‰Ωú‰∏∫‰æùÊçÆÊòØÂê¶Áõ¥Êé•ÈáçÂÆöÂêë„ÄÇ È°µÈù¢‰º†ÂèÇÈ°µÈù¢‰πãÈó¥‰º†ÂèÇÂèØ‰ª•Êúâ‰∏§ÁßçÊñπÂºèÔºå‰∏ÄÁßçÊòØÂä®ÊÄÅË∑ØÁî±Ôºå‰∏ÄÁßçÊòØÁõ¥Êé•‰º†ÂèÇ„ÄÇ Âä®ÊÄÅË∑ØÁî±Âä®ÊÄÅË∑ØÁî±Áî®‰∫é‰ªé‰∏ä‰∏™È°µÈù¢‰º†ÈÄíÂèÇÊï∞Áªô‰∏ã‰∏™È°µÈù¢„ÄÇËÆæÁΩÆÊÄªÂÖ±ÂàÜ‰∏∫‰∏âÊ≠•Ôºö Ë∑ØÁî±ËÆæÁΩÆÂä®ÊÄÅË∑ØÁî±1234567891011121314151617import &#123;BrowserRouter, Router&#125; from 'react-router-dom'import Home from './pages/home'class App extends Component &#123; render () &#123; return ( &lt;div&gt; &lt;BrowserRouter&gt; &lt;div&gt; &lt;Route exact path='/' render=&#123;Home&#125; /&gt; &lt;Route exact path='/detail/:id' render=&#123;()=&gt;(&lt;div&gt;detail&lt;/div&gt;)&#125; /&gt; &lt;/div&gt; &lt;/BrowserRouter&gt; &lt;/div&gt; ) &#125;&#125; ÂèØ‰ª•ÁúãÂà∞ÔºåÂíå‰∏äÈù¢‰ΩøÁî®ÂîØ‰∏ÄÁöÑ‰∏çÂêåÂú®‰∫é path=&#39;/detail/:id&#39;„ÄÇÂÖ∂‰∏≠ :id Ë°®Á§∫Êé•Êî∂Á´Ø‰ºöÊé•Êî∂Âà∞‰∏Ä‰∏™Âè´ id ÁöÑÂèÇÊï∞ Ë∑≥ËΩ¨ÂâçÈ°µÈù¢‰º†ÂèÇ1234567891011import &#123;Link&#125; from 'react-router-dom'class Home extends Component &#123; render () &#123; return ( &lt;Link to='/detail/2'&gt; &lt;SomeImg /&gt; &lt;/Link&gt; ) &#125;&#125; ÂèØ‰ª•ÁúãÂà∞ÔºåÂíåÁî® Link Ë∑≥ËΩ¨ÂîØ‰∏ÄÁöÑ‰∏çÂêåÂú®‰∫é to=&#39;/detail/2&#39;ÔºåË∑≥ËΩ¨È°µÈù¢Â§ö‰∫Ü‰∏Ä‰∏™ÂèÇÊï∞ÔºåËøô‰∏™ÂèÇÊï∞‰ºöÂú®Ë∑≥ËΩ¨ÂêéÁöÑÈ°µÈù¢ÈÄöËøá id ÂèñÂà∞„ÄÇ Ë∑≥ËΩ¨ÂêéÁöÑÈ°µÈù¢Ëé∑ÂèñÂèÇÊï∞12345class Detail extends Component &#123; componentDidMount () &#123; const id = this.props.match.params.id &#125;&#125; id Â∞±ÈÄöËøá prop Ëé∑ÂèñÂà∞„ÄÇ Áõ¥Êé•‰º†ÂèÇÁõ¥Êé•‰º†ÂèÇ‰∏çÈúÄË¶ÅÈÖçÁΩÆË∑ØÁî±ÔºåÁõ¥Êé•Âú®Ë∑≥ËΩ¨ÂâçÁöÑÈ°µÈù¢ÊãºÊé•Ë¶Å‰º†ÈÄíÁöÑÂèÇÊï∞Ôºö 1234567891011import &#123;Link&#125; from 'react-router-dom'class Home extends Component &#123; render () &#123; return ( &lt;Link to='/detail?id=2'&gt; &lt;SomeImg /&gt; &lt;/Link&gt; ) &#125;&#125; ÂèÇÊï∞ÈúÄË¶ÅËá™Â∑±ÊâãÂä®Ëß£ÊûêËé∑ÂèñÔºö 12345class Detail extends Component &#123; componentDidMount () &#123; const idString = this.props.location.search // ?id=2 &#125;&#125; ÂºÇÊ≠•ÁªÑ‰ª∂ÂçïÈ°µÂ∫îÁî®‰ºöÊääÊâÄÊúâÁöÑÈ°µÈù¢ÊâìÂåÖÂà∞‰∏Ä‰∏™ bundle ‰∏≠ÔºåËøôÂ∞±‰ºöÈÄ†Êàê bundle Â∫ûÂ§ßÁöÑÈóÆÈ¢òÔºåÈúÄË¶ÅÂ∞ÜÈ°µÈù¢ÊãÜÂàÜ‰∏∫ÂºÇÊ≠•ÁªÑ‰ª∂„ÄÇ 1npm install --save react-loadable 123456789101112// detail/loadable.jsimport React from 'react'import Loadable from 'react-loadable'const LoadableComponent = Loadable(&#123; loader: () =&gt; import('./index.js'), loading() &#123; return (&lt;div&gt;ÊàëÊ≠£Âú®Âä†ËΩΩÔºåËøôÊòØÂä†ËΩΩÊó∂ÂÄôÁöÑÊèêÁ§∫&lt;/div&gt;) &#125;&#125;)export default () =&gt; &lt;LoadableComponent /&gt; ‰πãÂêé‰ΩøÁî®Âà∞ËØ¶ÊÉÖÈ°µÁöÑÂú∞Êñπ‰∏çÂÜçÂºïÁî®ÂéüÊù•ÁöÑÁªÑ‰ª∂ÔºåËÄåÊòØÂºïÁî®Ëøô‰∏™ÂºÇÊ≠•ÁªÑ‰ª∂Ôºö 1234567891011121314151617import &#123;BrowserRouter, Router&#125; from 'react-router-dom'import Detail from './pages/detail/loadable'class App extends Component &#123; render () &#123; return ( &lt;div&gt; &lt;BrowserRouter&gt; &lt;div&gt; &lt;Route exact path='/detail' render=&#123;Detail&#125; /&gt; &lt;Route exact path='/' render=&#123;()=&gt;(&lt;div&gt;home&lt;/div&gt;)&#125; /&gt; &lt;/div&gt; &lt;/BrowserRouter&gt; &lt;/div&gt; ) &#125;&#125; withRouterwithRouter Âíå redux ‰∏≠ connect ÊñπÊ≥ïÂ∞Ü store ‰∏≠ÁöÑÁõ∏Â∫îÂ±ûÊÄßÂíåÊñπÊ≥ï‰º†ÈÄíÁªôËßÜÂõæÁöÑ‰ΩúÁî®‰∏ÄÊ†∑ÔºåÂΩì‰Ω†Âú®Ë∑ØÁî±ÁªÑ‰ª∂‰∏≠‰ΩøÁî®ÁöÑËßÜÂõæË¢´ÂÖ∂‰ªñËßÜÂõæÂµåÂ•óÁöÑÊó∂ÂÄôÔºåËÉΩÂ§üÂ∏ÆÂä©‰Ω†Áõ¥Êé•ËøáÂéªÂà∞Ë∑ØÁî±Áõ∏ÂÖ≥ÁöÑÂèÇÊï∞„ÄÇ ÊØîÂ¶Ç‰∏äÈù¢ÁöÑ DetailÔºåÂÆÉÊòØÊó†Ê≥ï‰ªéÂÆÉÁöÑ props ‰∏≠ÊãøÂà∞ loacation ÊàñËÄÖ match Â±ûÊÄßÁöÑÔºåÂõ†‰∏∫ÂÆÉË¢´‰∏ÄÈÉ®ÁªÑÂª∫ÂåÖË£π‰∫Ü„ÄÇ‰ΩøÁî® withRouter Â∞±ÂèØ‰ª•Â∞ÜË∑ØÁî±Áõ∏ÂÖ≥ÁöÑÂ±ûÊÄßÈÄöËøáËô´Ê¥ûÔºåÁõ¥Êé•‰∫§ÁªôËßÜÂõæÔºö 123456789import &#123;withRouter&#125; from 'react-router-dom'class Detail extends Component &#123; componentDidMount () &#123; const idString = this.props.location.search // ?id=2 &#125;&#125;export default withRouter(Detail) CSS ÊäÄÂ∑ßÂ±èÂπïÂ±Ö‰∏≠ÂÖàÊääÂ∑¶‰∏äËßíÁßªÂä®Âà∞Â±èÂπï‰∏≠Èó¥ÔºåÂÜçÊääËá™Ë∫´ÂêëÂ∑¶‰∏äËßíÁßªÂä®‰∏ÄÂçäÔºö 123456.center &#123; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);&#125; float ÁöÑ‰ΩøÁî®float Âíå absolute Á±ª‰ººÔºåÂèØ‰ª•Â∞ÜËßÜÂõæËÑ±Á¶ª‰∫éÈªòËÆ§ÁöÑÊéíÂ∏ÉÔºåÂè™‰∏çËøá absolute ÂèØ‰ª•ËÆæÁΩÆÁõ∏ÂØπÂÆö‰ΩçÁöÑÂÖÉÁ¥†Ôºå‰ª•Âèä‰∏ä‰∏ãÂ∑¶Âè≥ÁöÑ‰ΩçÁΩÆ„ÄÇËÄå float Âè™ËÉΩÊµÆÂä®Âà∞‰∏ä‰∏ãÂ∑¶Âè≥Âõõ‰∏™Ëæπ„ÄÇ ËÆæÁΩÆ‰∏Ä‰∏™ËßÜÂõæÁöÑÈ´òÂ∫¶‰∏∫Â±èÂπïÈ´òÂ∫¶ÂáèÂéª‰∏Ä‰∏™ÁâπÂÆöÈ´òÂ∫¶vh Âçï‰Ωç‰ºöÊääÂ±èÂπïÂàÜ‰∏∫ 100 Á≠âÂàÜ„ÄÇÊâÄ‰ª•Êï¥‰∏™Â±èÂπïÁöÑÈ´òÂ∫¶‰∏∫ 100vh „ÄÇÂáèÂéª‰∏Ä‰∏™ÁâπÂÆöÂÉèÁ¥†ÁöÑÈ´òÂ∫¶ÂêéÔºåË¶Å‰ΩøÁî® calc ÊñπÊ≥ïËÆ°ÁÆóÔºö 123.fullscreen &#123; height: calc(100vh - 80px)&#125; display ‰∏∫ block inline-block inline ÁöÑÂå∫Âà´1„ÄÅdisplayÔºöblockÂ∞ÜÂÖÉÁ¥†ÊòæÁ§∫‰∏∫ÂùóÁ∫ßÂÖÉÁ¥†Ôºå‰ªéËÄåÂèØ‰ª•Êõ¥Â•ΩÂú∞ÊìçÊéßÂÖÉÁ¥†ÁöÑÂÆΩÈ´òÔºå‰ª•ÂèäÂÜÖÂ§ñËæπË∑ùÔºåÊØè‰∏Ä‰∏™ÂùóÁ∫ßÂÖÉÁ¥†ÈÉΩÊòØ‰ªéÊñ∞ÁöÑ‰∏ÄË°åÂºÄÂßã„ÄÇ 2„ÄÅdisplay : inlineÂ∞ÜÂÖÉÁ¥†ÊòæÁ§∫‰∏∫Ë°åÂÜÖÂÖÉÁ¥†ÔºåÈ´òÂ∫¶ÔºåË°åÈ´ò‰ª•ÂèäÂ∫ïËæπË∑ù‰∏çÂèØÊîπÂèòÔºåÈ´òÂ∫¶Â∞±ÊòØÂÜÖÂÆπÊñáÂ≠óÊàñËÄÖÂõæÁâáÁöÑÂÆΩÂ∫¶Ôºå‰∏çÂèØ‰ª•ÊîπÂèò„ÄÇÂ§ö‰∏™Áõ∏ÈÇªÁöÑË°åÂÜÖÂÖÉÁ¥†ÊéíÂú®Âêå‰∏ÄË°åÈáåÔºåÁü•ÈÅìÈ°µÈù¢‰∏ÄË°åÊéíÂàó‰∏ç‰∏ãÔºåÊâç‰ºöÊç¢Êñ∞ÁöÑ‰∏ÄË°å„ÄÇ 3„ÄÅdisplayÔºöinline-blockÁúã‰∏äÂéªÂÄºÂêçinline-blockÊòØ‰∏Ä‰∏™Ê∑∑Âêà‰∫ßÁâ©ÔºåÂÆûÈôÖ‰∏äÁ°ÆÊòØÂ¶ÇÊ≠§ÔºåÂ∞ÜÂÖÉÁ¥†ÊòæÁ§∫‰∏∫Ë°åÂÜÖÂùóÁä∂ÂÖÉÁ¥†ÔºåËÆæÁΩÆËØ•Â±ûÊÄßÂêéÔºåÂÖ∂‰ªñÁöÑË°åÂÜÖÂùóÁ∫ßÂÖÉÁ¥†‰ºöÊéíÂàóÂú®Âêå‰∏ÄË°å„ÄÇÊØîÂ¶ÇÊàë‰ª¨liÂÖÉÁ¥†‰∏Ä‰∏™inline-blockÔºå‰ΩøÂÖ∂Êó¢ÊúâblockÁöÑÂÆΩÂ∫¶È´òÂ∫¶ÁâπÊÄßÔºåÂèàÊúâinlineÁöÑÂêåË°åÁâπÊÄßÔºåÂú®Âêå‰∏ÄË°åÂÜÖÊúâ‰∏çÂêåÈ´òÂ∫¶ÂÜÖÂÆπÁöÑÂÖÉÁ¥†Êó∂ÔºåÈÄöÂ∏∏Ë¶ÅËÆæÁΩÆÂØπÈΩêÊñπÂºèÂ¶Çvertical-align: top;Êù•‰ΩøÂÖÉÁ¥†È°∂ÈÉ®ÂØπÈΩê„ÄÇ ÊûÑÂª∫ÊäÄÂ∑ßdevDependencied Âíå dependencies Âå∫Âà´‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨‰ΩøÁî® npm install module-name -save Êù•ÊääÊ®°ÂùóÂíåÁâàÊú¨Âè∑Ê∑ªÂä†Âà∞ dependency ‰∏≠Ôºånpm install module-name -save-dev Êù•ÊääÊ®°ÂùóÂíåÁâàÊú¨Âè∑Ê∑ªÂä†Âà∞ devdependencies ‰∏≠„ÄÇ Ëøô‰∏§‰∏™‰æùËµñÁöÑÂå∫Âà´Âú®‰∫éÔºåÂú®Êú¨Âú∞ÊûÑÂª∫‰ª£Á†ÅÁöÑÊó∂ÂÄôÈúÄË¶ÅÁî®Âà∞ devDependencies ‰∏≠ÁöÑ‰ª£Á†Å„ÄÇÊØîÂ¶ÇÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî® babel,eslint,webpeck Êù•ÊûÑÂª∫‰ª£Á†ÅÔºåËøô‰∫õÂ∞±‰ºöÊîæÂú® devDependencies ‰∏≠„ÄÇËøô‰∫õ‰æùËµñ‰ª£Á†Å‰∏ç‰ºöÂ≠òÂú®‰∫éÊûÑÂª∫Â•ΩÁöÑÈ°πÁõÆ‰ª£Á†Å‰∏≠„ÄÇ devdependency ‰∏≠ÁöÑÊñá‰ª∂Â¶ÇÊûú‰ΩøÁî® npm publish ÂèëÂ∏É npm ÂåÖ‰πü‰∏ç‰ºöË¢´‰∏ä‰º† npx ÁöÑ‰ΩøÁî®‰∏ÄËà¨Êàë‰ª¨ÂÆâË£Ö‰∏Ä‰∫õ nodejs ÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÈúÄË¶ÅÂÖàÂÖ®Â±ÄÂÆâË£ÖÔºåÊØîÂ¶Ç‰ΩøÁî® create-react-app ËøôÁßçËÑöÊâãÊû∂Â∞±ÈúÄË¶ÅÂÖà: 12&gt; npm install create-react-app -g&gt; create-react-app my-app ‰∫ãÂÆû‰∏äÔºåÊàë‰ª¨Ê≤°ÊúâÂøÖË¶Å‰ΩøÁî®ÂÖ®Â±ÄÂÆâË£ÖÁöÑÊñπÂºèÂ∞±ÂèØ‰ª•Ëß£ÂÜ≥ÔºåÊääÂÆÉÂÆâË£ÖÂà∞Êüê‰∏Ä‰∏™È°πÁõÆ‰∏≠ÔºåÁÑ∂Âêé‰ΩøÁî® npx ÊâßË°åÔºö 12&gt; npm install --save-dev create-react-app&gt; npx create-react-app my-app ÂÖ∂ÂÆûÂ∞±Áõ∏ÂΩì‰∫éÊâßË°å‰∫Ü node-modules ‰∏ã bin ÁõÆÂΩï‰∏≠ÁöÑ‰∫åËøõÂà∂Êñá‰ª∂Ôºö 1&gt; node-modules/.bin/create-react-app my-app ÂÆûË∑µÊäÄÂ∑ßËØ∑Ê±ÇÊ∑ªÂä† cookieaxios ÈªòËÆ§ÁöÑËØ∑Ê±ÇÊòØ‰∏ç‰ºöÊ∑ªÂä† cookie ÁöÑÔºåÈúÄË¶ÅÂú®ËØ∑Ê±ÇÁöÑ option Â≠óÊÆµ‰∏≠Ê∑ªÂä† withCredentials: true Ëøô‰∏™ÈÄâÈ°πÊâçË°å„ÄÇ Ëøô‰∏™ÈÄâÈ°πË¶ÅÊ±ÇËØ∑Ê±Ç‰∏çËÉΩË∑®ÂüüÔºåÊàñËÄÖË∑®ÂüüÁöÑÂüüÂêçÂú®ÊúçÂä°Á´Ø access-control-allow-origin ÂÖÅËÆ∏ÁöÑÂüüÂêç‰∏≠„ÄÇ ËÆæÁΩÆ cookieË¶ÅÊÉ≥ÊúçÂä°Á´ØÈÄöËøá set-cookieËÉΩÂ§üÊàêÂäüËÆæÁΩÆ cookie ÁöÑÂâçÊèêÊòØËØ∑Ê±Ç‰∏çËÉΩË∑®ÂüüÂêç„ÄÇË∑®ÂüüÂêçÁöÑËØ∑Ê±ÇÊòØÊó†Ê≥ïËÆæÁΩÆ cookie ÁöÑ„ÄÇ ‰πãÊâÄ‰ª•ËØ¥ÊòØ‰∏çËÉΩË∑®ÂüüÂêçÊòØÂõ†‰∏∫ cookie ÊòØË∑®Á´ØÂè£ÂÖ±‰∫´ÁöÑÔºåÂç≥Â¶ÇÊûú‰Ω†ÁöÑ‰∏ªÁ´ôÊòØ localhost:3000 ËØ∑Ê±ÇÁöÑÁ´ØÂè£ÊòØ localhost:3001ÔºåÈÇ£‰πà set-cookie ËøòÊòØËÉΩÂ§üÊàêÂäüËÆæÁΩÆÁöÑ„ÄÇ ÁÆÄÂçïÊù•ËØ¥ÔºåË∑®ÂüüËØ∑Ê±ÇÊòØ‰∏çËÉΩËØªÂèñ cookie ÁöÑ„ÄÇ‰ΩÜÊòØË∑®Á´ØÂè£ËÆæÁΩÆ cookie ÊòØËÉΩÊàêÂäüÁöÑ„ÄÇ ÂçèËÆÆÔºåÂüüÂêçÔºåÁ´ØÂè£Êúâ‰∏Ä‰∏™‰∏çÂêåÂ∞±ÊòØË∑®Âüü Âè¶Â§ñË¶ÅËØ¥Êòé‰∏Ä‰∏ãÔºå ‰ΩøÁî® localhost ÂíåÊú¨Êú∫ ip ËøôÊòØ‰∏§‰∏™‰∏çÂêåÁöÑÂüüÂêçÔºå‰∏ÄÂÆöÊòØË∑®ÂüüÁöÑ„ÄÇÊâÄ‰ª•Ë¶ÅËÆæÁΩÆ cookie ÁöÑÊó∂ÂÄôÔºå‰∏çË¶Å‰∏ªÁ´ôÁî® localhostÔºåËØ∑Ê±ÇÁî® ipÔºåÊàñËÄÖ‰∏ªÁ´ôÁî® ipÔºåËØ∑Ê±ÇÁî® localhost„ÄÇ]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[KoaÁöÑÂü∫Êú¨‰ΩøÁî®]]></title>
    <url>%2F2019%2F04%2F23%2Fkoa%2F</url>
    <content type="text"><![CDATA[Êú¨ÁØáÊòØÂ≠¶‰π† node.js Âü∫Á°ÄÊ°ÜÊû∂ Koa ÁöÑÂ≠¶‰π†ÊÄªÁªì koa Âü∫Êú¨‰ΩøÁî®ÂÆâË£Ö 1npm install --save koa ÂàõÂª∫ app.js: 12345678910111213const Koa = require('koa')const app = Koa()// express ÁöÑËÄÅÂÜôÊ≥ï// app.use(function (req, res) &#123;// res.send('haha')// &#125;)app.use(async ctx =&gt; &#123; ctx.body = 'hahh'&#125;)app.listen(3000) Koa ‰∏≠Èó¥‰ª∂‰∏≠Èó¥‰ª∂Â∞±ÊòØÂåπÈÖçË∑ØÁî±ÂâçÂíåÂåπÈÖçË∑ØÁî±ÂêéÂÅöÁöÑ‰∏ÄÁ≥ªÂàóÊìç‰Ωú„ÄÇ‰∏≠Èó¥‰ª∂ÁöÑÂäüËÉΩÂåÖÊã¨Ôºö ‰øÆÊîπËØ∑Ê±ÇÂíåÂìçÂ∫îÂØπË±° ÁªàÊ≠¢ËØ∑Ê±ÇÂíåÂìçÂ∫îÂæ™ÁéØ Ë∞ÉÁî®Â†ÜÊ†à‰∏≠ÁöÑ‰∏ã‰∏Ä‰∏™‰∏≠Èó¥‰ª∂ ‰∏≠Èó¥‰ª∂ÊåâÁÖßÂäüËÉΩÂèØ‰ª•ÂàÜ‰∏∫Ôºö Â∫îÁî®Á∫ß‰∏≠Èó¥‰ª∂ Ë∑ØÁî±‰∏≠Èó¥‰ª∂ ÈîôËØØÂ§ÑÁêÜ‰∏≠Èó¥‰ª∂ Á¨¨‰∏âÊñπ‰∏≠Èó¥‰ª∂ Â∫îÁî®Á∫ß‰∏≠Èó¥‰ª∂Â∫îÁî®Á∫ß‰∏≠Èó¥‰ª∂ÔºåÊàëËßâÂæóÂèØ‰ª•Âè´ÂÅöÂÖ®Â±Ä‰∏≠Èó¥‰ª∂ÔºåÂ∞±ÊòØÊâÄÊúâËØ∑Ê±ÇÈÉΩË¶ÅÁªèËøáÁöÑ„ÄÇ‰∏æ‰æãÔºöÂØπ‰∫éÊØè‰∏Ä‰∏™ËØ∑Ê±ÇÔºåÊâìÂç∞ÂÆÉÁöÑËØ∑Ê±ÇÊó∂Èó¥Ôºö 1234567891011121314151617181920212223const Koa = require('koa')const Router = require('koa-router')const app = new Koa()const router = new Router()// Â∫îÁî®Á∫ß‰∏≠Èó¥‰ª∂app.use(async (ctx, next) =&gt; &#123; // ÊâìÂç∞Êó∂Èó¥ console.log(new Date()) // Á≠âÂæÖÂêéÁª≠‰∏≠Èó¥‰ª∂ÁöÑÊâßË°å await next()&#125;)router.get('/', async (ctx, next) &#123; ctx.body = 'hello koa' &#125;)// ÊÄªÁöÑË∑ØÁî±ÁöÑ‰∏≠Èó¥‰ª∂‰πüÊòØÂ∫îÁî®Á∫ß‰∏≠Èó¥‰ª∂app.use(router.routes()) .use(router.allowedMethods())app.listen(3000, () =&gt; &#123; console.log('starting at port 3000')&#125;) Á±ªÊØî redux ‰∏≠ÁöÑ‰∏≠Èó¥‰ª∂Ôºå‰∏≠Èó¥‰ª∂ÈÄöËøá use Ê≥®ÂÜåÔºåÂÜÖÈÉ®‰øùÂ≠òÂú®‰∏Ä‰∏™‰∏≠Èó¥‰ª∂ÁöÑÊï∞ÁªÑ‰∏≠„ÄÇÂèØ‰ª•ÈÄöËøáË∞ÉÁî® next() ÊñπÊ≥ïÊâßË°å‰∏ã‰∏Ä‰∏™‰∏≠Èó¥‰ª∂„ÄÇÂ¶ÇÊûú‰∏çË∞ÉÁî®ÔºåÈÇ£‰πàÂêéÈù¢ÁöÑ‰∏≠Èó¥‰ª∂ÈÉΩ‰∏ç‰ºöÁªßÁª≠ÊâßË°å„ÄÇ Ë∑ØÁî±Á∫ß‰∏≠Èó¥‰ª∂Ë∑ØÁî±Á∫ß‰∏≠Èó¥‰ª∂ÂèØ‰ª•‰Ωø‰∏Ä‰∏™ËØ∑Ê±ÇÂåπÈÖçÂ§ö‰∏™Ë∑ØÁî±: 12345678910111213141516171819202122const Koa = require('koa')const Router = require('koa-router')const app = new Koa()const router = new Router()router.get('/', async (ctx, next) &#123; console.log('Ë∞ÉÁî® next ÂåπÈÖç‰∏ã‰∏Ä‰∏™Ë∑ØÁî±') // ÊâßË°å next ÊñπÊ≥ïÔºåÂèØ‰ª•ÂåπÈÖç‰∏ã‰∏Ä‰∏™Ë∑ØÁî± await next()&#125;)router.get('/', async (ctx, next) &#123; ctx.body = 'hello koa again' &#125;)app.use(router.routes()) .use(router.allowedMethods())app.listen(3000, () =&gt; &#123; console.log('starting at port 3000')&#125;) ‰∏çÂêå‰∫éÂ∫îÁî®Á∫ß‰∏≠Èó¥‰ª∂ÔºåË∑ØÁî±Á∫ß‰∏≠Èó¥‰ª∂Âè™ÈíàÂØπË∑ØÁî±„ÄÇÂèØ‰ª•Â§ßÊ¶ÇÁåúÊµãÂá∫ÔºåÂ∫îÁî®Á∫ß‰∏≠Èó¥‰ª∂‰∏≠ÁöÑ next ÊòØ koa Êèê‰æõÁöÑÔºåËÄåË∑ØÁî±Á∫ß‰∏≠Èó¥‰ª∂ÁöÑ next ÊñπÊ≥ïÂ∫îËØ•ÊòØ koa-router Êèê‰æõÁöÑ„ÄÇ ÈîôËØØÂ§ÑÁêÜ‰∏≠Èó¥‰ª∂ÂÖ∂ÂÆûÂ∞±ÊòØ‰∏Ä‰∏™Â∫îÁî®Á∫ß‰∏≠Èó¥‰ª∂„ÄÇÈîôËØØÂ§ÑÁêÜÁî®Âú®Ê≤°ÊúâÂåπÈÖç‰ªª‰ΩïË∑ØÁî±ÔºåËøîÂõû‰∏Ä‰∏™ 404 È°µÈù¢Ôºö 1234567891011121314151617181920212223242526const Koa = require('koa')const Router = require('koa-router')const app = new Koa()const router = new Router()// ÂÖ®Â±Ä‰∏≠Èó¥‰ª∂„ÄÇËøô‰∏™Âú∞ÊñπÁî®Êù•Â§ÑÁêÜÈîôËØØapp.use(async (ctx, next)) &#123; // ÊâßË°åÊôÆÈÄöÁöÑË∑ØÁî±ÂåπÈÖç await next() // Ê≤°ÊúâÂåπÈÖç‰∏ä‰ªª‰ΩïË∑ØÁî±ÔºåÈÇ£‰πàÁä∂ÊÄÅÂ∞±ÊòØ404 if (ctx.status === 404) &#123; ctx.body = 'ËøôÊòØ‰∏Ä‰∏™404È°µÈù¢' &#125;&#125;router.get('/', async (ctx, next) &#123; ctx.body = 'hello koa again' &#125;)app.use(router.routes()) .use(router.allowedMethods())app.listen(3000, () =&gt; &#123; console.log('starting at port 3000')&#125;) Âà©Áî®ËøôÁßçÊñπÂºèÂèØ‰ª•ÂÅöÊ∂àÊÅØËΩ¨Âèë koa Ë∑ØÁî±‰∏≠Èó¥‰ª∂ÂÆâË£ÖÔºö 1npm install --save koa-router ÈùôÊÄÅË∑ØÁî±Á§∫‰æã12345678910111213141516const Koa = require('koa')const Router = require('koa-router')const app = new Koa()const router = new Router()// ÈÖçÁΩÆË∑ØÁî±router.get('/', async (ctx) =&gt; &#123; ctx.body = 'È¶ñÈ°µ' // Áõ∏ÂΩì‰∫éÂéüÁîüÈáåÁöÑ res.writeHedr() res.end()&#125;).get('/news', async (ctx) =&gt; &#123; ctx.body = 'ËøôÊòØ‰∏Ä‰∏™Êñ∞ÈóªÈ°µÈù¢'&#125;)// app.use(router.routes()) // ÂêØÂä®Ë∑ØÁî± .use(router.allowedMethods()) // ÂèØÈÖçÁΩÆÂèØ‰∏çÈÖçÁΩÆÔºåÂª∫ËÆÆÈÖçÁΩÆ„ÄÇ‰ºöÊ†πÊçÆ ctx.status ËÆæÁΩÆ response ÂìçÂ∫îÂ§¥app.listen(3000) Ëé∑Âèñ get ‰º†ÂÄº12345678router.get('/news', async (ctx) =&gt; &#123; // ‰ªé ctx ‰∏≠ËØªÂèñget‰º†ÂÄº,Ëé∑ÂèñÁöÑÊòØÂØπË±°ÔºõÁ≠âÂêå‰∫é ctx.request.query console.log(ctx.query) // Ëé∑Âèñ url; Á≠âÂêå‰∫é ctx.request.url console.log(ctx.url) // Ëé∑ÂèñÊï¥‰∏™request console.log(ctx.request)&#125;) Ëé∑Âèñ post ‰º†ÂÄºÂÆâË£Ö koa-bodyparser 1npm install --save koa-bodyparser 12345678910111213141516171819202122const Koa = require('koa')const Router = require('koa-router')const BodyParser = require('koa-bodyparser')const app = new Koa()const router = new Router()const bodyParser = new BodyParser()// ‰ΩøÁî® bodyParser ‰∏≠Èó¥‰ª∂app.use(bodyParser)router.post('/', async (ctx, next) // ÈÄöËøá ctx.request.body Ëé∑ÂèñË°®ÂçïÊèê‰∫§ÁöÑÊï∞ÊçÆ // Ëé∑ÂèñÁöÑ post ÁöÑ body Â∑≤ÁªèË¢´ËΩ¨‰∏∫ÂØπË±° console.log(ctx.request.body) &#125;)app.use(router.routes()) .use(router.allowedMethods())app.listen(3000, () =&gt; &#123; console.log('starting at port 3000')&#125;) get Âíå post ÈÉΩÊîØÊåÅÂ¶ÇÊûú‰∏Ä‰∏™ËØ∑Ê±ÇÔºåÊó¢Ë¶ÅÊîØÊåÅ get ÂèàË¶ÅÊîØÊåÅ post ‰πüÊòØÂèØ‰ª•ÁöÑÔºåÂèØ‰ª•‰ΩøÁî® .all ÊñπÊ≥ïÔºö 12345router.all('/:pid', async (ctx) =&gt; &#123; console.log(ctx.url) const buffer = await fse.readFile('./test.json') ctx.body = buffer.toString()&#125;) Âä®ÊÄÅË∑ØÁî±ÈùôÊÄÅË∑ØÁî±Ë¶ÅÊ±ÇË∑ØÂæÑÂÆåÂÖ®ÂåπÈÖçÔºåÂä®ÊÄÅË∑ØÁî±ÂèØ‰ª•ÂâçÈÉ®ÂåπÈÖçÔºåÂêéÈÉ®ÂèØ‰ª•Âä®ÊÄÅËé∑Âèñ„ÄÇkoa ‰∏≠ÈÄöËøá : ‰Ωú‰∏∫Âä®ÊÄÅË∑ØÁî±ÁöÑÊ†áËØÜÔºö 12345678// Âä®ÊÄÅË∑ØÁî±ÂåπÈÖç /news/xxxxrouter.get('/news/:aid', async (ctx) =&gt; &#123; // Âä®ÊÄÅË∑ØÁî±ÁöÑ‰º†ÂÄº console.log('‰ª•‰∏ãÊòØÂä®ÊÄÅË∑ØÁî±Ë∑ØÁî±:' + (ctx.params).toString())&#125;)// ÊØîÂ¶ÇËæìÂÖ• localhost:3000/news/haha// =&gt; ‰ª•‰∏ãÊòØÂä®ÊÄÅË∑ØÁî±ÁöÑË∑ØÁî±: &#123;aid: 'haha'&#125; Âä®ÊÄÅË∑ØÁî±ÂèØ‰ª•ÂåπÈÖçÂ§ö‰∏™ÂÄº„ÄÇÂ¶Ç /news/:aid/:cid ËÆæÁΩÆ Cookie Âíå SessionËÆæÁΩÆ cookieËÆæÁΩÆ cookie123456789101112router.get('/', async (ctx) =&gt; &#123; ctx.cookies.set('userInfo', 'zachary', &#123; // ËÆæÁΩÆËøáÊúüÊó∂Èó¥ maxAge: 60*1000*60, // ÈÖçÁΩÆÂèØ‰ª•ËÆøÈóÆÁöÑÈ°µÈù¢ path: '/news', // ÂΩìÊúâÂ§ö‰∏™Â≠êÂüüÂêçÁöÑÊó∂ÂÄô‰ΩøÁî®Ôºå‰πüÂèØ‰ª•‰∏çÂÜôÔºåÈªòËÆ§ÊòØËØ∑Ê±ÇÁöÑÂüüÂêç domain: '.baidu.com', // true Ë°®Á§∫Ëøô‰∏™ cookie Âè™ÊúâÊúçÂä°Âô®Á´ØÂèØ‰ª•Êñπ‰ΩçÔºåfalse Ë°®Á§∫ÂÆ¢Êà∑Á´Ø‰πüÂèØ‰ª•ËÆøÈóÆ httpOnly: true &#125;)&#125;) Ëé∑Âèñ cookie123router.get('/', async (ctx) =&gt; &#123; console.log(ctx.cookies.get('userInfo'))&#125;) Â¶ÇÊûúÂÆ¢Êà∑Á´ØÈúÄË¶ÅÊãøÂà∞ cookieÔºåÈÇ£‰πàÂøÖÈ°ªËÆæÁΩÆ httpOnly ‰∏∫ false ËÆæÁΩÆ Sessionsession ÊòØÂè¶‰∏ÄÁßçËÆ∞ÂΩïÂÆ¢Êà∑Áä∂ÊÄÅÁöÑÊú∫Âà∂Ôºå‰∏çÂêåÁöÑÊòØ Cookie ‰øùÂ≠òÂú®ÂÆ¢Êà∑Á´ØÊµèËßàÂô®‰∏≠ÔºåËÄåsession ‰øùÂ≠òÂú®ÊúçÂä°Âô®‰∏ä„ÄÇ Session ÁöÑÂ∑•‰ΩúÊµÅÁ®ãÂΩìÊµèËßàÂô®ËÆøÈóÆÊúçÂä°Âô®Âπ∂ÂèëÈÄÅÁ¨¨‰∏ÄÊ¨°ËØ∑Ê±ÇÊó∂ÔºåÊúçÂä°Âô®Á´Ø‰ºöÂàõÂª∫‰∏Ä‰∏™ session ÂØπË±°ÔºåÁîüÊàê‰∏Ä‰∏™Á±ª‰ºº‰∫é key,value ÁöÑÈîÆÂÄºÂØπÔºå ÁÑ∂ÂêéÂ∞Ü key(cookie)ËøîÂõûÂà∞ÊµèËßàÂô®(ÂÆ¢Êà∑)Á´ØÔºåÊµèËßàÂô®‰∏ãÊ¨°ÂÜçËÆøÈóÆÊó∂ÔºåÊê∫Â∏¶ key(cookie)ÔºåÊâæÂà∞ÂØπÂ∫îÁöÑ session(value)„ÄÇ ÂÆ¢Êà∑ÁöÑ‰ø°ÊÅØÈÉΩ‰øùÂ≠òÂú® session ‰∏≠„ÄÇ ËÆæÁΩÆ Session1npm install --save koa-session ‰ΩøÁî®Ôºö 123456789101112131415161718192021222324252627// ÂºïÂÖ•const session = require('koa-session')// ËÆæÁΩÆ‰∏≠Èó¥‰ª∂app.keys = ['some secret hurr']const CONFIG = &#123; key: 'koa:sess', //cookie key (default is koa:sess) maxAge: 86400000, // cookie ÁöÑËøáÊúüÊó∂Èó¥ maxAge in ms (default is 1 days) httpOnly: true, //cookie ÊòØÂê¶Âè™ÊúâÊúçÂä°Âô®Á´ØÂèØ‰ª•ËÆøÈóÆ httpOnly or not (default true) signed: true, //Á≠æÂêçÈªòËÆ§ true rolling: false, //Âú®ÊØèÊ¨°ËØ∑Ê±ÇÊó∂Âº∫Ë°åËÆæÁΩÆcookieÔºåËøôÂ∞ÜÈáçÁΩÆcookieËøáÊúüÊó∂Èó¥(ÈªòËÆ§:false) renew: true, // Âø´ËøáÊúüÁöÑÊó∂ÂÄôÈáçÊñ∞ËÆæÁΩÆ&#125;app.use(session(CONFIG, app))// ËÆæÁΩÆrouter.get('/login', async (ctx) =&gt; &#123; // ËÆæÁΩÆ session ctx.session.userInfo = 'zachary' ctx.body = 'ÁôªÂΩïÊàêÂäü'&#125;)// Ëé∑Âèñrouter.get('/', async (ctx) =&gt; &#123; console.log(ctx.session.userInfo)&#125;) koa-session ÁöÑÂéüÁêÜÂ∞±ÊòØÂú®ÂÜÖÂ≠ò‰∏≠ÁîüÊàê‰∏Ä‰∏™ session ÁöÑÊï£ÂàóË°®„ÄÇÊØèÊ¨°ÁîüÊàê‰∏Ä‰∏™ÈöèÊú∫ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂπ∂Â∞ÜÂÖ∂‰Ωú‰∏∫ cookie ‰∏ãÂèëÁªôÂÆ¢Êà∑Á´ØÔºåkey ÂØπÂ∫î‰∫é config ‰∏≠ÁöÑ key„ÄÇËÆæÁΩÆÁöÑ app.keys Â∫îËØ•Â∞±ÊòØÂä†ÂØÜÁî®ÁöÑÁßòÈí•„ÄÇ ÂΩì session ÈáèÊØîËæÉÂ§ßÁöÑÊó∂ÂÄôÔºåÂ∞±ÈúÄË¶ÅËÄÉËôëÈÄöËøá‰ΩøÁî®Â§ñÈÉ®Â≠òÂÇ®ÁöÑÊñπÂºèËøõË°åÂ≠òÂÇ®„ÄÇÊØîÊñπËØ¥ mysqlÔºåredis Á≠â Session Âíå Cookie ÁöÑÂå∫Âà´ cookie Êï∞ÊçÆÂ≠òÊîæÂú®ÂÆ¢Êà∑ÁöÑÊµèËßàÂô®‰∏äÔºåsession Êï∞ÊçÆÊîæÂú®ÊúçÂä°Âô®‰∏ä„ÄÇ cookie ‰ºöÊö¥Èú≤Áî®Êà∑ÁöÑ‰ø°ÊÅØÔºåÊâÄ‰ª•‰ΩøÁî® sessionÔºåÂè™Âú® cookie ‰∏≠‰øùÂ≠ò‰∏Ä‰∏™ idÔºåÊØèÊ¨°ËØ∑Ê±ÇÈÄöËøáËøô‰∏™ id ‰ªé session Êï£ÂàóË°®‰∏≠Ëé∑ÂèñÁõ∏Â∫îÁöÑ‰ø°ÊÅØ„ÄÇ Âçï‰∏™ cookie ‰øùÂ≠òÁöÑÊï∞ÊçÆ‰∏çËÉΩË∂ÖËøá 4KÔºåÂæàÂ§öÊµèËßàÂô®ÈÉΩÈôêÂà∂‰∏Ä‰∏™Á´ôÁÇπÊúÄÂ§ö‰øùÂ≠ò 20 ‰∏™ cookie„ÄÇ ËÆøÈóÆÈùôÊÄÅÊñá‰ª∂Â¶ÇÊûú‰∏çÊÉ≥‰ΩøÁî®Ê®°ÊùøÊ∏≤ÊüìÊàñËÄÖ nuxt.js ËøôÁßçÊúçÂä°Á´ØÊ∏≤ÊüìÊ°ÜÊû∂„ÄÇÂèØ‰ª•Â∞ùËØïÁõ¥Êé•ËÆøÈóÆ vue ÁîüÊàêÁöÑ dist Êñá‰ª∂„ÄÇ ÁîüÊàê Vue ÁöÑ dist ÁõÆÂΩïÈÄöËøá vue-cli ÁîüÊàê Vue È°πÁõÆÔºåÈÄöËøá npm run build ÁîüÊàê dist ÁõÆÂΩïÔºåÊää dist ÁõÆÂΩïÊï¥‰∏™Êã∑Ë¥ùÂà∞ koa ÊâÄÂú®ÁõÆÂΩï‰∏ãÔºö ËÆøÈóÆÈùôÊÄÅÊñá‰ª∂ËÆøÈóÆÈùôÊÄÅÊñá‰ª∂ÈúÄË¶Å‰ΩøÁî®Áõ∏ÂÖ≥‰∏≠Èó¥‰ª∂ koa-static: 1234567891011const Koa = require('koa')const app = new Koa()// ËÆøÈóÆÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑ dist ÁõÆÂΩï‰∏≠ÁöÑÊñá‰ª∂const static = require('koa-static')('./dist')// ÈÖçÁΩÆÈùôÊÄÅËµÑÊ∫êÊñá‰ª∂Ë∑ØÂæÑapp.use(static)app.listen(3000, () =&gt; &#123; console.log('Ê≠£Âú®ÁõëÂê¨3000Á´ØÂè£')&#125;) Ê≠§Êó∂ÂΩì‰Ω†ËÆøÈóÆ localhost:3000 ÁöÑÊó∂ÂÄôÔºåkoa Â∞±‰ºöÂ∞Ü dist/index.html ËøîÂõûÊòæÁ§∫„ÄÇ Â¶ÇÊûúÂêåÊó∂‰ΩøÁî®‰∫ÜË∑ØÁî±‰∏≠Èó¥‰ª∂ÔºåÈúÄË¶ÅÊääËµÑÊ∫êÊñá‰ª∂ÁöÑ‰∏≠Èó¥‰ª∂ÂÖà‰∫éË∑ØÁî±‰∏≠Èó¥‰ª∂Ê≥®ÂÜå„ÄÇÂê¶Âàô‰ºöË¢´Ë∑ØÁî±Êã¶Êà™ Ë∑ØÁî±Ê®°ÂùóÂåñÊääÊâÄÊúâË∑ØÁî±ÊîæÂú®‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÊòæÁÑ∂ÊòØ‰∏çÂ•ΩÁª¥Êä§ÁöÑÔºåÂõ†Ê≠§ÈúÄË¶ÅÈíàÂØπË∑ØÁî±ËøõË°åÂ≠êË∑ØÁî±ÊãÜÂàÜ„ÄÇ ÂÆûÁé∞ÂàõÂª∫Â≠êË∑ØÁî±È¶ñÂÖàÂàõÂª∫ routes Êñá‰ª∂Â§πÔºåÂàõÂª∫Â≠êË∑ØÁî±Êñá‰ª∂ÔºåÊØîÂ¶ÇÂëΩÂêç‰∏∫ admin.js„ÄÇÂú®ÂÖ∂‰∏≠Ê∑ªÂä†Â≠êË∑ØÁî±Ôºö 1234567891011121314// Âú® /routes/admin.js ÁõÆÂΩï‰∏ãconst Router = require('koa-router')const router = new Router()router.get('/', async (ctx) =&gt; &#123; ctx.body = 'admin È¶ñÈ°µ' &#125;) router.get('/user', async (ctx) =&gt; &#123; ctx.body = 'admin Áî®Êà∑È°µ' &#125;) module.exports = router.routes() ÂºïÂÖ•Â≠êË∑ØÁî±12345678910111213// app.jsconst router = require('koa-router')()const app = require('koa')()// ÂºïÂÖ•Â≠êË∑ØÁî±const admin = require('./routes/admin.js')// Áî®Â≠êË∑ØÁî±Êõø‰ª£‰∫ÜÂéüÊù•ÁöÑ async ÊñπÊ≥ï// Ê≥®ÊÑèÔºå‰∏ÄÂÆöÊòØ useÔºå‰∏çÊòØ get ÊàñËÄÖ postÔºåÊàëÂú®ËøôÈáåÂç°‰∫ÜÂæà‰πÖrouter.use('/admin', admin)app.use(router.routes()).use(router.allowedMethods()) ËøôÊ†∑‰ª•‰∏ãËØ∑Ê±ÇÂ∞±‰ºöÊò†Â∞ÑÂà∞Áõ∏Â∫îÂ≠êË∑ØÁî±‰∏≠Ôºö 12http://localhost:3000/adminhttp://localhost:3000/admin/user ÂÆûË∑µnode Ëá™Âä®ÈáçÂêØÂºÄÂèëÁöÑÊó∂ÂÄôÊØèÊ¨°‰øÆÊîπÈÉΩË¶ÅÊâãÂä®ÈáçÊñ∞ run ‰∏ÄÊ¨° node ‰ºöÈùûÂ∏∏ÁöÑÈ∫ªÁÉ¶„ÄÇÂõ†Ê≠§ÈúÄË¶Å‰∏Ä‰∏™ËÉΩËá™Âä®ÈáçÂêØÁöÑÂ∫ìÁöÑÂ∏ÆÂä©„ÄÇËøô‰∏™Â∫ìÂ∞±ÊòØ nodemon: 1npm install -g nodemon ÂÖ®Â±ÄÂÆâË£Ö nodemonÔºåÁÑ∂ÂêéÂêØÂä®ÁöÑÊó∂ÂÄô‰∏çË¶ÅÈÄöËøá node ‰∫ÜÔºåËÄåÊòØ nodemonÔºö 1nodemon app.js Êñá‰ª∂Êìç‰Ωú‰ΩøÁî® node Êèê‰æõÁöÑ fs Êìç‰ΩúÊñá‰ª∂ÊØîËæÉÂ§çÊùÇÔºåÂ∞§ÂÖ∂ÊòØ‰ΩøÁî® koa ÁöÑÊó∂ÂÄôÊú¨Áîü‰∏çÊîØÊåÅ promise ÂÜôÊ≥ï„ÄÇ fs-extra ÊòØ‰∏Ä‰∏™ÊØîËæÉÂÆåÂñÑÁöÑÊñá‰ª∂Êìç‰ΩúÂ∞ÅË£ÖÂ∫ìÔºö 1npm install --save fs-extra ‰ΩøÁî®Ëµ∑Êù•‰πüÂíå fs Êó†ÂºÇ„ÄÇ‰∏ãÈù¢‰æãÂ≠ê‰∏≠ËØªÂèñÊú¨Âú∞ÁöÑ json Êñá‰ª∂Âπ∂ËøîÂõûÔºö 123456const fse = require('fs-extra')router.get('/', async (ctx) =&gt; &#123; const buffer = await fse.readFile('./test.json') ctx.body = buffer.toString()&#125;) ÂèëÈÄÅËØ∑Ê±ÇÊàë‰ª¨‰ΩøÁî® koa Êé•Êî∂ÂÆ¢Êà∑Á´ØËØ∑Ê±Ç„ÄÇ‰ΩÜÊòØÂæàÂ§öÊó∂ÂÄôÔºåÊàë‰ª¨ÈúÄË¶ÅÂØπËØ∑Ê±ÇÂÅöËΩ¨Âèë„ÄÇÂõ†Ê≠§ÔºåÈúÄË¶Å‰ΩøÁî® nodejs ÂèëÈÄÅËØ∑Ê±Ç„ÄÇ ÂèëÈÄÅËØ∑Ê±ÇÂèØ‰ª•‰ΩøÁî®Â∫ì request-promise„ÄÇÂÆÉÊòØ request ÁöÑ promise ÁâàÊú¨Ôºö 123npm install --save request-promise# request ÊòØ request-promise ÁöÑ‰æùËµñÈ°πÔºåÈúÄË¶ÅËá™Â∑±ÊâãÂä®ÂÆâË£Önpm install --save request ËØ∑Ê±ÇÊñπÂºèÂæàÁÆÄÂçïÔºö 1234567891011121314151617app.use(async (ctx, next) =&gt; &#123; // ÂÖàËÆ©Ë∑ØÁî±ÂìçÂ∫î await next() // Â¶ÇÊûúÊ≤°Êúâ‰∏Ä‰∏™Ë∑ØÁî±Áõ∏Â∫î if (ctx.status === 404) &#123; const url = `https://colorlab.lian-shang.cn$&#123;ctx.url&#125;` try &#123; // Â∞ùËØïËØ∑Ê±ÇËΩ¨Âèë let obj = await request.get(url) ctx.body = obj &#125; catch (err) &#123; // ËΩ¨ÂèëËØ∑Ê±ÇÂèëÈÄÅÂ§±Ë¥• console.log('ÂèëÁîü‰∫Üerror') console.log(err.statusCode) &#125; &#125;&#125;) Ë¶ÅÊ≥®ÊÑèÔºå await ‰∏≠ÂèëÁîüÁöÑ error ÈúÄË¶ÅÈÄöËøá try‚Ä¶catch ÊçïËé∑„ÄÇ ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáènode ‰∏≠ÁöÑÁéØÂ¢ÉÂèòÈáèÂú® process.env ‰∏≠‰øùÂ≠òÔºå‰ΩøÁî®Â∫ì cross-env ÂèØ‰ª•Êñπ‰æøËÆæÁΩÆÂÖºÂÆπ windows ÁöÑÁéØÂ¢ÉÂèòÈáèÔºö 1npm install --save-dev cross-env package.json ‰∏≠ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÔºö 12345&#123; "scripts": &#123; "build": "cross-env NODE_ENV=production webpack --config build/webpack.config.js" &#125;&#125; NODE_ENV ÁéØÂ¢ÉÂèòÈáèÂ∞ÜÁî± cross-env ËÆæÁΩÆ„ÄÇÊâìÂç∞ process.env.NODE_ENV === &#39;production&#39; ‰∏∫ true ÂÖÅËÆ∏Ë∑®ÂüüË∑®ÂüüÁöÑËØ∑Ê±ÇÈúÄË¶ÅÂÄüÂä©Á¨¨‰∏âÊñπÁöÑÂ∫ì koa-cors ËøõË°åÂÖÅËÆ∏Ë∑®ÂüüËÆæÁΩÆÔºö 1npm install koa-cors ‰ΩøÁî®Ôºö 123456789101112app.use(cors(&#123; origin: function (ctx) &#123; if (ctx.url === '/cors') &#123; return '*' // ÂÖÅËÆ∏Êù•Ëá™ÊâÄÊúâÂüüÂêçËØ∑Ê±Ç &#125; return 'http://localhost:3000' &#125;, exposeHeaders: ['WWW-Authenticate', 'Server-Authorization'], credentials: true, allowMethods: ['GET', 'POST', 'DELETE'], // ËÆæÁΩÆÂÖÅËÆ∏ÁöÑHTTPËØ∑Ê±ÇÁ±ªÂûã allowHeaders: ['Content-Type', 'Authorization', 'Accept']&#125;)) ÂÖ∂‰∏≠ origin Â≠óÊÆµÂØπÂ∫î‰∫é access-control-allow-originÔºåÈÄöËøáÂÆÉËÆæÁΩÆÂì™‰∫õÁ´ôÁÇπÂèëËµ∑Âì™‰∫õËØ∑Ê±ÇÂèØ‰ª•ËøõË°åË∑®Âüü„ÄÇ‰∏äÈù¢üå∞Ë°®Á§∫ÔºåËØ∑Ê±ÇË∑ØÂæÑ‰∏∫ /cors ÁöÑËøô‰∏™ËØ∑Ê±ÇÂèØ‰ª•ËøõË°åË∑®ÂüüÔºå‰ΩÜÊòØ‰∏çËÉΩËé∑Âèñ cookie ‰ø°ÊÅØÔºåËÄå http://localhost:3000 Ëøô‰∏™ÂüüÂêç‰∏ãÁöÑÊâÄÊúâËØ∑Ê±ÇÈÉΩÂèØ‰ª•ËøõË°åË∑®ÂüüÔºå‰∏îÂèØ‰ª•Ëé∑Âèñ cookie ‰ø°ÊÅØÔºåÊòØÂèó‰ø°ÁöÑÁ´ôÁÇπ„ÄÇ Â¶ÇÊûúËÆæÁΩÆ‰∫Ü access-control-allow-origin ‰∏∫ *ÔºåÈÇ£‰πàÂ∞±ÊòØÂÖÅËÆ∏Ë∑®Âüü‰∫Ü„ÄÇ‰ΩÜÊòØË∑®ÂüüÁöÑÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÔºåÊó†Ê≥ïÊê∫Â∏¶ËØ•ÂüüÂêç‰∏ãÁöÑ cookie ‰ø°ÊÅØÁªôÊúçÂä°Á´Ø„ÄÇ ÂøÖÈ°ªËÆæÁΩÆ access-control-allow-origin ‰∏∫‰∏Ä‰∏™ÁâπÂÆöÁöÑÂüüÂêçÔºåËÄå‰∏çÊòØ *„ÄÇËøôÊ†∑ Access-Control-Allow-Credentials Êâç‰ºöË¢´ÈªòËÆ§ÁΩÆ‰Ωç trueÔºåÊâçÂèØ‰ª•Ë∑®Âüü‰ΩøÁî® cookie„ÄÇ ÊâÄ‰ª•ËøôÊòØ‰∏Ä‰∏™‰∏âÁ∫ß‰øùËØÅ„ÄÇÊ≤°Êúâ *ÔºåÈÇ£‰πàÊó†Ê≥ïÂèëÂá∫ËØ∑Ê±ÇÔºåÊ≤°ÊúâÁâπÂÆöÁöÑÂüüÂêçÔºåÊ≤°ÊúâÂèëÈÄÅÂ∏¶ cookie ÁöÑËØ∑Ê±Ç„ÄÇ ËøûÊé• MysqlNodejs ËøûÊé• Mysql ÈúÄË¶Å install Áõ∏ÂÖ≥ÁöÑÂ∫ìÔºö 1npm install --save mysql Âü∫Êú¨‰ΩøÁî®Ôºö 1234567891011121314151617181920212223242526const mysql = require('mysql')// ÂàõÂª∫ËøûÊé•ÂØπË±°const con = mysql.createConnection(&#123; host: 'localhost', user: 'root', password: '', port: '3306', database: 'your_database'&#125;)// ÂºÄÂßãËøûÊé•con.connect()// ÊâßË°åÁÆÄÂçïÁöÑsqlconst sql = 'select * from your_databse'con.query(sql, (err, result) =&gt; &#123; if (err) &#123; console.error(err) return &#125; console.log(result)&#125;)// ÂÖ≥Èó≠ËøûÊé•con.end() Èò≤Ê≠¢ sql Ê≥®ÂÖ•sql Â¶ÇÊûúÊòØÈÄöËøáÂ≠óÁ¨¶‰∏≤ÊãºÊé•ÁöÑÊñπÂºèÊ≥®ÂÖ•ÁöÑÂèÇÊï∞ÔºåÈÇ£‰πàÂÆπÊòìÂºïËµ∑ sql Ê≥®ÂÖ•„ÄÇNodejs ‰∏≠ÁöÑ mysql Â∫ìÂºïÂÖ•‰∫Ü escape ÊñπÊ≥ïÔºå‰ºöÂØπÂèÇÊï∞ËøõË°åËΩ¨‰πâÔºö 1select id from User where username = $&#123;escape(username)&#125; redisredis ÊòØ‰∏ÄÁßçÂÜÖÂ≠òÂ≠òÂÇ®ÔºåÂèØ‰ª•ÈÖçÂêà mysql ËøõË°åÈ¢ëÁπÅÊìç‰ΩúÁöÑÊï∞ÊçÆÁöÑÂ≠òÂÇ®„ÄÇ ÂÆâË£Ö redisÂÆâË£Ö1brew install redis ÂêØÂä® server1redis-server ÂêØÂä® client1redis-client Â≠òÂèñÂÄº 1234# ËÆæÁΩÆÈîÆÂÄºÂØπ&gt; set myname zachary# ÂèñÂÄº&gt; get myname ‰ΩøÁî® redisÂÆâË£Ö redis nodejs Ê®°Âùó1npm install redis --save node ‰∏≠‰ΩøÁî®123456789101112131415161718192021const redis = require('redis')// ÂàõÂª∫ÂÆ¢Êà∑Á´Ø// ÈªòËÆ§ÊòØ 6379 Á´ØÂè£const redisClient = redis.createClient(6379, '127.0.0.1')redisClient.on('error', err =&gt; &#123; console.log(err)&#125;)// ÊµãËØï‰ΩøÁî®redisClient.set('myname', 'zachary', redis.print)redisClient.get('myname', (err, val) =&gt; &#123; if (err) &#123; console.error(err) return &#125; console.log('val', val) // ÈÄÄÂá∫ redis redisClient.quit()&#125;) PM2 ËøõÁ®ãÂÆàÊä§ÔºåÁ≥ªÁªüÂ•îÊ∫ÉËá™Âä®ÈáçÂêØ ÂêØÂä®Â§öËøõÁ®ãÔºåÂÖÖÂàÜÂà©Áî® CPU ÂíåÂÜÖÂ≠ò Ëá™Â∏¶Êó•ÂøóËÆ∞ÂΩï ‰∏ãËΩΩ1npm install pm2 -g ÂêØÂä®ÂºÄÂèëÁéØÂ¢É‰∏ã‰ΩøÁî® nodemonÔºåÁ∫ø‰∏äÁéØÂ¢ÉÂèØ‰ª•‰ΩøÁî® pm2: 1pm2 start app.js Â∏∏Áî®ÂëΩ‰ª§1234567891011121314# Êü•ÁúãËøõÁ®ãÂàóË°®pm2 list# ÈáçÂêØËøõÁ®ãpm2 restart &lt;AppName&gt;/&lt;id&gt;# ÂÅúÊ≠¢ËøõÁ®ãpm2 stop &lt;AppName&gt;/&lt;id&gt;# Âà†Èô§ËøõÁ®ãpm2 delete &lt;AppName&gt;/&lt;id&gt;# Êü•ÁúãËøõÁ®ã‰ø°ÊÅØpm2 info &lt;AppName&gt;/&lt;id&gt;# Êü•ÁúãÊó•Âøó(console.log/error/warn)pm2 log &lt;AppName&gt;/&lt;id&gt;# ÁõëÊéßpm2 monit &lt;AppName&gt;/&lt;id&gt; ÂëΩ‰ª§Ë°ånode ÂÜôËÑöÊú¨ÈúÄË¶ÅÈÖçÂêà shell ËØ≠Ê≥ïÔºåshelljs ÊòØ‰∏Ä‰∏™Â∞ÅË£ÖÁöÑÂæàÊôö‰∏äÁöÑÂ∫ì]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IQKeyboardManager Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2019%2F04%2F20%2Fiqkeyboardmanager%2F</url>
    <content type="text"><![CDATA[IQKeyboardManager ÊòØ‰∏Ä‰∏™‰ºòÁßÄÁöÑÈõ∂Ë°å‰ª£Á†ÅËß£ÂÜ≥ÈîÆÁõòÈÅÆÊå°ÁöÑÁ¨¨‰∏âÊñπÂ∫ì„ÄÇÂú®Ê≤°ÊúâÁúãËøáÊ∫êÁ†ÅÁöÑÊó∂ÂÄôÊòØÊàëËÆ§‰∏∫ÁöÑÊúÄÊúâÈ≠îÂäõÁöÑÁ¨¨‰∏âÊñπÂ∫ì„ÄÇÁé∞Âú®Êàë‰ª¨Â∞±Ë¶ÅÊè≠ÂºÄÂÆÉÁöÑÈù¢Á∫±„ÄÇ ‰ΩøÁî®ÊñπÂºèIQTextViewIQTextView ÊòØ‰∏Ä‰∏™Êèê‰æõ‰∫Ü placeholder ÁöÑ UITextView„ÄÇÂèØ‰ª•ËÆæÁΩÆÂÆÉÊñáÂ≠óÂíåÈ¢úËâ≤Ôºö 12345#import "IQTextView.h"IQTextView *textView = [[IQTextView alloc] init];textView.placeholder = @"ËøôÊòØ‰∏Ä‰∏™placeholder";textView.placeholderTextColor = [UIColor redColor]; IQKeyboardReturnKeyHandlerËøô‰∏™Êñá‰ª∂ÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨Â∞ÜÈîÆÁõò‰∏äÁöÑ return ÈîÆÂèò‰∏∫ next ÈîÆÔºåÁÇπÂáªËøõÂÖ•‰∏ã‰∏Ä‰∏™ËæìÂÖ•Ê°Ü„ÄÇÂΩìÂà∞ÊúÄÂêé‰∏Ä‰∏™ËæìÂÖ•Ê°ÜÁöÑÊó∂ÂÄôÔºåÂèò‰∏∫ DoneÔºåÁÇπÂáªÊî∂Ëµ∑ÈîÆÁõò„ÄÇ 123456789#import "IQKeyboardReturnKeyHandler.h"@property (nonatomic, strong) IQKeyboardReturnKeyHandler *returnKeyHandler;- (void)viewDidLoad:(BOOL)animated&#123; [super viewDidLoad:animated]; self.returnKeyHander = [[IQKeyboardReturnKeyHandler alloc] initWithViewController:self]; self.returnKeyHander.delegate = self;&#125; ‰ΩøÁî®ÈùûÂ∏∏ÁÆÄÂçï„ÄÇÂè™Ë¶Å‰º†ÂÖ•ÂΩìÂâç textfield ÊâÄÂú®ÁöÑÊéßÂà∂Âô®Âç≥ÂèØ„ÄÇÂèØ‰ª•ÈÄöËøáËÆæÁΩÆ IQKeyboardReturnHandler ÁöÑ delegate ËÆæÁΩÆÊâÄÊúâ textfield ÁöÑ delegate„ÄÇ‰πüÂèØ‰ª•Ëá™Â∑±ËÆæÁΩÆÊØè‰∏™ textfield ÁöÑ delegate„ÄÇ IQKeyboardManagerÂú®Êüê‰∏™È°µÈù¢Á¶ÅÁî® IQKeyboardManager12345678910 - (void)viewWillAppear:(BOOL)animated&#123; [super viewWillAppear:animated]; //ÂÜôÂÖ•Ëøô‰∏™ÊñπÊ≥ïÂêé,Ëøô‰∏™È°µÈù¢Â∞ÜÊ≤°ÊúâËøôÁßçÊïàÊûú [IQKeyboardManager sharedManager].enable = NO;&#125;- (void)viewWillDisappear:(BOOL)animated&#123; [super viewWillDisappear:animated]; //ÊúÄÂêéËøòËÆæÁΩÆÂõûÊù•,‰∏çË¶ÅÂΩ±ÂìçÂÖ∂‰ªñÈ°µÈù¢ÁöÑÊïàÊûú [IQKeyboardManager sharedManager].enable = YES;&#125; Èô§‰∫Ü‰∏äÈù¢ÁöÑÁõ¥Êé•Á¶ÅÁî®ÂíåÂêØÁî®ÔºåIQKeyboardManager ‰πüÂèØ‰ª•ËÆæÁΩÆÂú®Á¶ÅÁî®ÁöÑÊó∂ÂÄôÂú®ÈÉ®ÂàÜ ViewController ‰∏äÂêØÁî®ÔºåÊàñËÄÖÂú®ÂêØÂä®ÁöÑÊó∂ÂÄôÂú®ÈÉ®ÂàÜ ViewController ‰∏äÁ¶ÅÁî®Ôºö 1234// Âú®Êï¥‰ΩìÁ¶ÅÁî®ÁöÑÊó∂ÂÄôÂèØ‰ª•ÂêØÂä® IQKeyboardManager ÁöÑÁ±ª[[IQKeyboardManager sharedManager].enabledDistanceHandlingClasses addObject: yourViewControllerClass];// Âú®Êï¥‰ΩìÂêØÂä®ÁöÑÊó∂ÂÄôÈúÄË¶ÅÁ¶ÅÁî® IQKeyboardManager ÁöÑÁ±ª[[IQKeyboardManager sharedManager].disabledDistanceHandlingClasses addObject: yourViewControllerClass]; ÁÇπÂáªÁ©∫ÁôΩÂ§ÑÂèØ‰ª•ÈöêËóèÈîÆÁõò1[IQKeyboardManager sharedManager].shouldResignOnTouchOutside = YES; ÈöêËóèÈîÆÁõò‰∏äÁöÑ toolbar1[IQKeyboardManager sharedManager].enableAutoToolbar = NO; Èô§‰∫ÜËøôÁßç‰∏ÄÂàÄÂàáÁöÑÈöêËóèÊàñËÄÖÊòæÁ§∫ toolbar ‰πãÂ§ñÔºåIQKeyboardManager ËøòÊèê‰æõ‰∫Ü‰∏§‰∏™Êï∞ÁªÑÂ±ûÊÄßÔºåÁî®‰∫éÊ†áËØÜÁâπ‰æã ViewControllerÔºö 12@property(nonatomic, strong, nonnull, readwrite) NSMutableSet&lt;Class&gt; *disabledToolbarClasses;@property(nonatomic, strong, nonnull, readwrite) NSMutableSet&lt;Class&gt; *enabledToolbarClasses; Ëøô‰∏§‰∏™Â±ûÊÄßÂàÜÂà´ÂèØ‰ª•ËÆæÁΩÆÂú® enableAutoToobar ‰∏∫ YES ÁöÑÊó∂ÂÄôÔºå‰∏çÊòæÁ§∫ toobar ÁöÑ ViewControllerÔºõenableAutoToobar ‰∏∫ NO ÁöÑÊó∂ÂÄôÔºåÊòæÁ§∫ toobar ÁöÑ ViewController„ÄÇ disableToolbarClasses ÈªòËÆ§‰∏∫Ôºö 1[UIAlertController, _UIAlertControllerTextFieldViewController] Ê∫êÁ†ÅËß£ÊûêIQTextViewIQTextView ‰∏ªË¶ÅÂ∞±ÊòØÂú® UITextView ÁöÑÂü∫Á°Ä‰∏äÊ∑ªÂä†‰∫Ü‰∏Ä‰∏™ UILabel„ÄÇÂÆûÁé∞Ëµ∑Êù•‰πüÈùûÂ∏∏ÁÆÄÂçï„ÄÇ placeholder ‰∏ªË¶ÅÂÖ≥Ê≥®‰∏§‰ª∂‰∫ãÔºå‰∏ÄÊòØ placeholder ÁöÑ‰ΩçÁΩÆÔºå‰∫åÊòØ placeholder ‰ΩïÊó∂ÈöêËóè„ÄÇ È¶ñÂÖàÁúã placeholder ÁöÑ‰ΩçÁΩÆÔºåÂÆÉÈÄöËøá sizeThatFits ÊñπÊ≥ïËé∑ÂèñÂà∞Âç†‰ΩçÁ¨¶ÁöÑÂ§ßÂ∞èÔºö 12345678910111213141516171819202122// Â∏ÉÂ±ÄÊñπÊ≥ï-(void)layoutSubviews&#123; [super layoutSubviews]; self.placeholderLabel.frame = [self placeholderExpectedFrame];&#125;// placeholder ÁöÑ inset-(UIEdgeInsets)placeholderInsets&#123; return UIEdgeInsetsMake(self.textContainerInset.top, self.textContainerInset.left + self.textContainer.lineFragmentPadding, self.textContainerInset.bottom, self.textContainerInset.right + self.textContainer.lineFragmentPadding);&#125;-(CGRect)placeholderExpectedFrame&#123; UIEdgeInsets placeholderInsets = [self placeholderInsets]; CGFloat maxWidth = CGRectGetWidth(self.frame)-placeholderInsets.left-placeholderInsets.right; CGSize expectedSize = [self.placeholderLabel sizeThatFits:CGSizeMake(maxWidth, CGRectGetHeight(self.frame)-placeholderInsets.top-placeholderInsets.bottom)]; return CGRectMake(placeholderInsets.left, placeholderInsets.top, maxWidth, expectedSize.height);&#125; ÂÜçÁúã placeholder ‰ΩïÊó∂ÈöêËóè„ÄÇ‰ΩïÊó∂ÈöêËóèÔºüÂè™Ë¶ÅÂΩìÂâç textView ÁöÑ text ‰∏ç‰∏∫Á©∫Â∞±Ë¶ÅÈöêËóè„ÄÇÈÇ£‰πàÊÄé‰πàÁü•ÈÅì‰∏ç‰∏∫Á©∫Âë¢ÔºüÊ≥®ÂÜåÁõëÂê¨ UITextViewTextDidChangeNotification ÁöÑÈÄöÁü• 1234567891011121314151617181920-(void)initialize&#123; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(refreshPlaceholder) name:UITextViewTextDidChangeNotification object:self];&#125;-(void)refreshPlaceholder&#123; /// Â¶ÇÊûúÊúâ text ÊàñËÄÖ attributedText ÈÇ£‰πàÂ∞±ÊòæÁ§∫Âê¶ÂàôÈöêËóè if([[self text] length] || [[self attributedText] length]) &#123; [_placeholderLabel setAlpha:0]; &#125; else &#123; [_placeholderLabel setAlpha:1]; &#125; [self setNeedsLayout]; [self layoutIfNeeded];&#125; ÂàÜÁ±ªÊñá‰ª∂Êï∞ÁªÑÂàÜÁ±ªÊï∞ÁªÑÂàÜÁ±ª‰∏≠ÂåÖÂê´ËØ•‰∏§‰∏™ÊñπÊ≥ïÔºåÈÄöËøá tag Â§ßÂ∞èÊàñËÄÖÈÄöËøá‰ΩçÁΩÆÂØπ UIView ÊéíÂ∫èÔºö 12- (NSArray&lt;UIView*&gt;*)sortedArrayByTag- (NSArray&lt;UIView*&gt;*)sortedArrayByPosition Ëøô‰∏™ÊñπÊ≥ï‰∏≠Êàë‰ª¨ÂèØ‰ª•Â≠¶‰π†‰∏Ä‰∏™ÊéíÂ∫èÁöÑÊñπÊ≥ïÔºö 123456789101112131415161718192021- (NSArray&lt;UIView*&gt;*)sortedArrayByPosition&#123; return [self sortedArrayUsingComparator:^NSComparisonResult(UIView *view1, UIView *view2) &#123; CGFloat x1 = CGRectGetMinX(view1.frame); CGFloat y1 = CGRectGetMinY(view1.frame); CGFloat x2 = CGRectGetMinX(view2.frame); CGFloat y2 = CGRectGetMinY(view2.frame); if (y1 &lt; y2) return NSOrderedAscending; else if (y1 &gt; y2) return NSOrderedDescending; //Else both y are same so checking for x positions else if (x1 &lt; x2) return NSOrderedAscending; else if (x1 &gt; x2) return NSOrderedDescending; else return NSOrderedSame; &#125;];&#125; ÈÄöËøá sortedArrayUsingComparator ‰º†ÂÖ•‰∏Ä‰∏™ÊØîËæÉÂ§ßÂ∞èÁöÑ block„ÄÇÂÖàÊ†πÊçÆ y ËΩ¥ÊØîËæÉÂ§ßÂ∞èÔºåy ËΩ¥Áõ∏Á≠âÁöÑÊó∂ÂÄôÂÜçÊØîËæÉ x ËΩ¥Â§ßÂ∞è„ÄÇËøôÊ†∑ÂæóÂà∞ÁöÑÂ∞±ÊòØ‰∏Ä‰∏™Ê†πÊçÆËØ•ÊñπÊ≥ïÊéíÂ∫èÁöÑÊï∞ÁªÑ„ÄÇ UIScrollView ÂàÜÁ±ªUIScrollView ÂàÜÁ±ª‰∏≠Ê∑ªÂä†‰∫Ü‰∏§‰∏™ÂàÜÁ±ªÂ±ûÊÄßÔºö 1234567// Ê†áËØÜËØ• UIScrollView ÊòØÂê¶ÂèØ‰ª•Ë∞ÉÊï¥ contentOffset Êù•ËææÂà∞Ë∞ÉÊï¥ textfield ‰ΩçÁΩÆÁöÑÁõÆÁöÑ„ÄÇ// ÈªòËÆ§ÊòØ NOÔºåË°®Á§∫ËØ• UIScrollView ÂèØ‰ª•Ë¢´Ë∞ÉÊï¥„ÄÇ// Â¶ÇÊûúËÆæÁΩÆ‰∏∫ YESÔºåË°®Á§∫ÂΩìÂâçËßÜÂõæ‰∏çËÉΩÁßªÂä®ÔºåÂ∞±‰ºöÊâæ‰∏äÁ∫ßËßÜÂõæÁßªÂä®@property(nonatomic, assign) BOOL shouldIgnoreScrollingAdjustment;// ÊòØÂê¶‰øùÂ≠òË∞ÉÊï¥‰ΩçÁΩÆÂâçÁöÑ UIScrollView ÁöÑ contentOffset ÁöÑÂÄº„ÄÇÂ¶ÇÊûú‰øùÂ≠òÔºåÈÇ£‰πàÊÅ¢Â§çÂêé UIScrollView Â∞ÜÊªöÂõûÂéüÊù•ÁöÑ‰ΩçÁΩÆ„ÄÇÈªòËÆ§ÊòØ NOÔºå‰∏ç‰øùÂ≠ò@property(nonatomic, assign) BOOL shouldRestoreScrollViewContentOffset; UITextField ÂàÜÁ±ªÂÖ∂ÂÆûÊòØÊ∑ªÂä†Âú® UIView ‰∏äÁöÑÂá†‰∏™Â±ûÊÄßÔºö 123456// ËÆæÁΩÆÈîÆÁõòÂºπÂá∫ÂêéÔºåtextfield Âà∞ÈîÆÁõòÁöÑË∑ùÁ¶ª@property(nonatomic, assign) CGFloat keyboardDistanceFromTextField;// Â¶ÇÊûúËÆæÁΩÆ‰∏∫ YESÔºåÈÇ£‰πà‰∏ä‰∏Ä‰∏™ textfield ÁÇπÂáª next ‰πãÂêéÔºåÂ∞±‰∏ç‰ºöË∑≥Âà∞Ëøô‰∏™ textfield ‰∏ä@property(nonatomic, assign) BOOL ignoreSwitchingByNextPrevious;// ÁÑ¶ÁÇπÂú®Ëøô‰∏™ textfield ‰∏äÊó∂ÔºåÊòØÂê¶ÂèØ‰ª•ÁÇπÂáªÂ§ñÈÉ®ÂèñÊ∂àÁÑ¶ÁÇπ@property(nonatomic, assign) IQEnableMode shouldResignOnTouchOutsideMode; UIView ÂàÜÁ±ªUIView ÁöÑÂàÜÁ±ª‰∏ãÁöÑÊñπÊ≥ïÂàÜ‰∏∫‰∏§Á±ªÔºå‰∏ÄÁ±ªÊòØËé∑Âèñ UIView ÊâÄÂú®ÁöÑ UIViewControllerÔºå‰∏ÄÁ±ªÊòØËé∑ÂèñÂΩìÂâçËßÜÂõæ‰∏ãÁöÑ UITextFieldÔºö 12345678// Ëé∑Âæó UIView ÁöÑÊéßÂà∂Âô®,ÈÄöËøáÂìçÂ∫îÈìæËé∑Âèñ@property (nullable, nonatomic, readonly, strong) UIViewController *viewContainingController;// Ëé∑ÂæóÊúÄ‰∏äÂ±ÇÁöÑËßÜÂõæÊéßÂà∂Âô®@property (nullable, nonatomic, readonly, strong) UIViewController *topMostController;// Ëé∑ÂèñÂΩìÂâçËßÜÂõæÁöÑÊâÄÊúâÂÖÑÂºü textfield@property (nonnull, nonatomic, readonly, copy) NSArray&lt;__kindof UIView*&gt; *responderSiblings;// ÊääÂΩìÂâçËßÜÂõæ‰∏ãÁöÑÊâÄÊúâÁöÑ textfield ÈÉΩÊî∂ÈõÜËµ∑Êù•ÔºåÂåÖÂê´ËßÜÂõæÁöÑÂ≠êËßÜÂõæ@property (nonnull, nonatomic, readonly, copy) NSArray&lt;__kindof UIView*&gt; *deepResponderViews; IQKeyboardReturnKeyHandlerIQKeyboardReturnKeyHandler ‰∏ªË¶ÅÁî®Êù•Ëß£ÂÜ≥Â§ö‰∏™ textfield ÁöÑÊó∂ÂÄôÁÇπÂáª return Ë∑≥Âà∞‰∏ã‰∏Ä‰∏™ textfield ÁöÑÈóÆÈ¢ò„ÄÇÊ≤°ÊúâÁúãËøáÊ∫êÁ†ÅÁöÑÊó∂ÂÄôËßâÂæóÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Á•ûÂ•áÁöÑÂäüËÉΩ„ÄÇÂÖ∂ÂÆûÂÆûÁé∞ÊñπÂºèÁÆÄÂçïÁÇπËØ¥Â∞±ÊòØËé∑ÂèñÂΩìÂâç UIViewController ÂÜÖÁöÑÊâÄÊúâ textfieldÔºåÁÑ∂ÂêéÂØπ‰ªñ‰ª¨ÊåâÁÖß‰ΩçÁΩÆÊéíÂ∫è„ÄÇÁÇπÂáª return Â∞±ËÆ©‰∏ã‰∏Ä‰∏™ textfield Ëé∑ÂèñÁÑ¶ÁÇπ„ÄÇ ÂàùÊ≠•Â§ÑÁêÜÂàùÊ≠•Â§ÑÁêÜÁöÑËøáÁ®ã‰∏≠Ôºå‰ºöÊää UIViewController ‰∏≠ÁöÑÊâÄÊúâ textfield ÂÖ®ÈÉΩÊãøÂá∫Êù•Ôºå‰øùÂ≠òÂü∫Êú¨‰ø°ÊÅØ„ÄÇÁõÆÁöÑÊòØÂΩì IQKeyboardReturnKeyHandler ÂÆû‰æãÈîÄÊØÅÁöÑÊó∂ÂÄôÔºåÂ∞ÜÊâÄÊúâ textfield ÊÅ¢Â§çÂ¶ÇÂàù„ÄÇ È¶ñÂÖàÁúãÂÖ•Âè£ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223// Êää controller ‰∏≠ÁöÑÊâÄÊúâ textfield Ê∑ªÂä†Âà∞Ëøô‰∏™Á±ª‰∏≠ÔºåÊâÄÊúâ‰ª£ÁêÜÁî±Ëøô‰∏™Á±ªÊâòÁÆ°„ÄÇ-(instancetype)initWithViewController:(nullable UIViewController*)controller &#123; self = [super init]; if (self) &#123; textFieldInfoCache = [[NSMutableSet alloc] init]; if (controller.view) &#123; [self addResponderFromView:controller.view]; &#125; &#125; return self;&#125;// Ëé∑ÂèñÂΩìÂâçËßÜÂõæÁöÑÊâÄÊúâÂ≠êËßÜÂõæ‰∏≠ÁöÑ textfield Âπ∂Ê∑ªÂä†Âà∞Êï∞ÁªÑ‰∏≠-(void)addResponderFromView:(UIView*)view &#123; NSArray&lt;UIView*&gt; *textFields = [view deepResponderViews]; for (UIView *textField in textFields) [self addTextFieldView:textField];&#125; ÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™ÁÜüÊÇâÁöÑÊñπÊ≥ï deepResponderViewsÔºå‰πüÂ∞±ÊòØËØ¥ÔºåÂàùÂßãÂåñÁöÑÊó∂ÂÄôÔºå‰ªé UIViewController ‰∏≠ÊâæÂà∞‰∫ÜÊâÄÊúâÁöÑ textfieldÔºåÂπ∂‰∏îÈÄöËøá addTextFieldView ÊñπÊ≥ïÊää‰ªñ‰ª¨‰øùÂ≠òËµ∑Êù•„ÄÇaddTextFieldView ÊñπÊ≥ïÊää textfield ÁöÑ originalReturnKeyType delegate ‰øùÂ≠ò‰∫ÜËµ∑Êù•ÔºåËΩ¨‰∏∫‰∫Ü‰∏Ä‰∏™ modalÔºåÂπ∂ÊääÂÆÉ‰ª¨ÁöÑ delegate ËÆæÁΩÆ‰∏∫‰∫ÜËá™Â∑±„ÄÇËøôÊ†∑ textfield ÁöÑÊâÄÊúâ‰∫ã‰ª∂ÈÉΩ‰ºöÁî± IQKeyboardReturnKeyHandler ÂÆû‰æãÊé•ÁÆ°„ÄÇ 123456789101112131415161718192021// Êää TextField ËΩ¨‰∏∫ Modal Ê∑ªÂä†Âà∞ cache ‰∏≠-(void)addTextFieldView:(UIView*)view &#123; IQTextFieldViewInfoModal *modal = [[IQTextFieldViewInfoModal alloc] initWithTextFieldView:view textFieldDelegate:nil textViewDelegate:nil originalReturnKey:UIReturnKeyDefault]; if ([view isKindOfClass:[UITextField class]]) &#123; UITextField *textField = (UITextField*)view; modal.originalReturnKeyType = textField.returnKeyType; modal.textFieldDelegate = textField.delegate; [textField setDelegate:self]; &#125; else if ([view isKindOfClass:[UITextView class]]) &#123; UITextView *textView = (UITextView*)view; modal.originalReturnKeyType = textView.returnKeyType; modal.textViewDelegate = textView.delegate; [textView setDelegate:self]; &#125; [textFieldInfoCache addObject:modal];&#125; Êé•ÁÆ° textfield ÁöÑ textfieldDidBeginEditing ÊñπÊ≥ïIQKeyboardReturnKeyHandler ÂÆû‰æãÊé•ÁÆ°‰∫Ü textfield ÁöÑÁõ∏ÂÖ≥ÊñπÊ≥ï„ÄÇÂú® textfieldDidBeginEditing ‰∏≠„ÄÇÂÆÉ‰ºöÂ∞ÜÈô§ÊúÄÂêé‰∏Ä‰∏™ textfield ‰πãÂ§ñÁöÑÊâÄÊúâ textfield ÁöÑ returnkeytype ËÆæÁΩÆ‰∏∫ nextÔºåÊúÄÂêé‰∏Ä‰∏™ËÆæÁΩÆ‰∏∫ return„ÄÇ ÂÖ∑‰ΩìÁúã‰ª£Á†ÅÔºö 123456- (void)textFieldDidBeginEditing:(UITextField *)textField&#123; [self updateReturnKeyTypeOnTextField:textField]; // ÁúÅÁï•‰∫ÜË∞ÉÁî®‰ª£ÁêÜÊñπÊ≥ïÁöÑ‰ª£Á†Å ...&#125; 1234567891011121314151617-(void)updateReturnKeyTypeOnTextField:(UIView*)textField &#123; // ÁúÅÁï•‰∫ÜÂÖ≥‰∫é UITableView Áõ∏ÂÖ≥ÁöÑÊêúÁ¥¢ÈÄªËæë ... textFields = [textField responderSiblings]; switch ([[IQKeyboardManager sharedManager] toolbarManageBehaviour]) &#123; case IQAutoToolbarByTag: textFields = [textFields sortedArrayByTag]; break; case IQAutoToolbarByPosition: textFields = [textFields sortedArrayByPosition]; break; default: break; [(UITextField*)textField setReturnKeyType:(([textFields lastObject] == textField) ? self.lastTextFieldReturnKeyType : UIReturnKeyNext)];&#125; updateReturnKeyTypeOnTextField ÊñπÊ≥ï‰∏≠Â∞ÜË¢´ÁºñËæëÁöÑ textfield ÁöÑÂÖÑÂºü textfield ÂÖ®ÈÉΩÊãøÂà∞ÔºåÁÑ∂ÂêéÊåâÁÖßÊâÄÂ§Ñ‰ΩçÁΩÆÊéíÂ∫èÔºåÂæóÂà∞‰∏Ä‰∏™ÊéíÂ∫èÂ•ΩÁöÑ textFields ÂÖÑÂºüÊï∞ÁªÑÔºåÊää‰ªñ‰ª¨ÊúÄÂêé‰∏Ä‰∏™ËÆæÁΩÆ‰∏∫ Return Á±ªÂûãÔºåÂÖ∂‰ªñÁöÑÈÉΩËÆæÁΩÆ‰∏∫ Next Á±ªÂûã„ÄÇ ÂÖ∂‰∏≠ÁúÅÁï•‰∫Ü‰∏ÄÈÉ®ÂàÜÂÖ≥‰∫é UITableView ÁöÑÂ§ÑÁêÜÈÄªËæë„ÄÇËÆæÊÉ≥‰∏Ä‰∏ãÔºåÂ¶ÇÊûú‰∏Ä‰∏™ textfield Â§Ñ‰∫é UITableView ÁöÑ‰∏Ä‰∏™ cell ‰∏≠ÔºåÈÇ£‰πàÂ∫îËØ•Ëøô‰∏™ UITableView ÁöÑÂÖ∂‰ªñ cell ‰πü‰ºöÊúâ textfield„ÄÇËøô‰∫õ textfield ËôΩÁÑ∂‰∏çÊòØÂú®‰∏Ä‰∏™ËßÜÂõæ‰∏≠Ôºå‰ΩÜÂ∫îËØ•‰πüÊòØÂêåÁ∫ßÁöÑÂÖÑÂºü textfield„ÄÇÂõ†Ê≠§ÔºåIQKeyboardManager ÈíàÂØπËøôÁßçÊÉÖÂÜµ‰ºöÂØπ UITableView ËøõË°åÊ∑±ÊêúÔºåÊãøÂà∞ÊâÄÊúâÁöÑ textfield„ÄÇ ËøôÈáåÁúÅÁï• UITableView Áõ∏ÂÖ≥ÈÄªËæëÊòØÂõ†‰∏∫Êàë‰ª¨Âè™ÈúÄË¶ÅÁü•ÈÅìËÆæÁΩÆ textfield ÁöÑ returnkeytype ÁöÑÂÖ≥ÈîÆÁÇπÂú®‰∫éÂú®ÂºÄÂßãÁºñËæëÁöÑÊó∂ÂÄôÊâæÂà∞ÊâÄÊúâ textfield ÁöÑÂÖÑÂºü textfield Âç≥ÂèØ„ÄÇUITableView Áõ∏ÂÖ≥ÈÄªËæëÂè™ÊòØÂØπËøô‰∏™ÁõÆÁöÑÁöÑË°•ÂÖÖ„ÄÇ Êé•ÁÆ° textfield ÁöÑ textFieldShouldReturn ÊñπÊ≥ïÂíå textfieldDidBeginEditing Áõ∏ÂØπÂ∫îÁöÑÔºåÂΩìÁÇπÂáª next ÈîÆÁöÑÊó∂ÂÄôÔºå‰ºöÂ∞ÜÁÑ¶ÁÇπÁΩÆ‰∫é‰∏ã‰∏Ä‰∏™ textfieldÔºö 1234567891011121314151617181920-(BOOL)textFieldShouldReturn:(UITextField *)textField&#123; id&lt;UITextFieldDelegate&gt; delegate = self.delegate; if ([delegate respondsToSelector:@selector(textFieldShouldReturn:)]) &#123; BOOL shouldReturn = [delegate textFieldShouldReturn:textField]; if (shouldReturn) &#123; shouldReturn = [self goToNextResponderOrResign:textField]; &#125; return shouldReturn; &#125; else &#123; return [self goToNextResponderOrResign:textField]; &#125;&#125; 12345678910111213141516171819202122232425262728-(BOOL)goToNextResponderOrResign:(UIView*)textField &#123; // ÁúÅÁï• UITableView Áõ∏ÂÖ≥ÈÄªËæë ... textFields = [textField responderSiblings]; switch ([[IQKeyboardManager sharedManager] toolbarManageBehaviour]) &#123; case IQAutoToolbarByTag: textFields = [textFields sortedArrayByTag]; break; case IQAutoToolbarByPosition: textFields = [textFields sortedArrayByPosition]; break; default: break; &#125; NSUInteger index = [textFields indexOfObject:textField]; if (index != NSNotFound &amp;&amp; index &lt; textFields.count-1) &#123; [textFields[index+1] becomeFirstResponder]; return NO; &#125; else &#123; [textField resignFirstResponder]; return YES; &#125;&#125; ÂÖ∂ÂÆûÁêÜËß£‰∫ÜËÆæÁΩÆ returnkeytype ÁöÑÈÄªËæëÔºåËøôÈáåËÆæÁΩÆ‰∏ã‰∏Ä‰∏™ÂìçÂ∫îËÄÖÁöÑÈÄªËæë‰πüÂ∞±Êòé‰∫Ü‰∫Ü„ÄÇËøòÊòØËé∑ÂæóÊéíÂ∫èÂêéÁöÑ textfield Êï∞ÁªÑÔºåÂè™Ë¶ÅÊää‰∏ã‰∏Ä‰∏™ textfield ËÆæÁΩÆ‰∏∫Á¨¨‰∏ÄÂìçÂ∫îËÄÖÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ IQKeyboardManagerÊ≥®ÂÜåIQKeyboardManager ÈÄöËøá +(void)load ÊñπÊ≥ïËá™Âä®ÂàõÂª∫Ëá™Ë∫´Ôºö 12345+(void)load&#123; //Enabling IQKeyboardManager. Loading asynchronous on main thread [self performSelectorOnMainThread:@selector(sharedManager) withObject:nil waitUntilDone:NO];&#125; Êàë‰ª¨Â∏∏ËØ¥‰∏çË¶ÅÂú® load ÊñπÊ≥ï‰∏≠ÂÅöÂ§™Â§öËÄóÊó∂Êìç‰ΩúÔºå‰ºöÂΩ±ÂìçÂ∫îÁî®ÁöÑÂêØÂä®ÈÄüÂ∫¶„ÄÇÊâÄ‰ª•ÔºåÊàë‰ª¨ÂèØ‰ª•ÊääË¶ÅÂÅöÁöÑÂàùÂßãÂåñÊìç‰ΩúÂºÇÊ≠•ÂéªÊâßË°å„ÄÇ‰∏ãÈù¢Êù•ÁúãÂàùÂßãÂåñÊñπÊ≥ï Ê≥®ÂÜåÈÄöÁü•Ê≥®ÂÜåÁöÑÈÄöÁü•‰∏ªË¶ÅÂåÖÂê´‰∏§ÈÉ®ÂàÜ„ÄÇ‰∏ÄÈÉ®ÂàÜÊòØÈîÆÁõòÁöÑÂºπÂá∫‰∏éÈöêËóèÔºåÂè¶‰∏ÄÈÉ®ÂàÜÊòØ UITextField Âíå UITextView ÁöÑÁºñËæëÁöÑÂõûË∞É„ÄÇÂÖ∑‰ΩìÈÄöÁü•ÁöÑÂ§ÑÁêÜÊñπÊ≥ïÂêéÊñáËß£Êûê„ÄÇ 123456789101112131415161718192021222324252627-(void)registerAllNotifications&#123; // Ê≥®ÂÜåÈîÆÁõòÁõ∏ÂÖ≥ÈÄöÁü• [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillShow:) name:UIKeyboardWillShowNotification object:nil]; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardDidShow:) name:UIKeyboardDidShowNotification object:nil]; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillHide:) name:UIKeyboardWillHideNotification object:nil]; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardDidHide:) name:UIKeyboardDidHideNotification object:nil]; // Ê≥®ÂÜå UITextField ÁöÑÁºñËæëÈÄöÁü• [self registerTextFieldViewClass:[UITextField class] didBeginEditingNotificationName:UITextFieldTextDidBeginEditingNotification didEndEditingNotificationName:UITextFieldTextDidEndEditingNotification]; // Ê≥®ÂÜå UITextView ÁöÑÁºñËæëÈÄöÁü• [self registerTextFieldViewClass:[UITextView class] didBeginEditingNotificationName:UITextViewTextDidBeginEditingNotification didEndEditingNotificationName:UITextViewTextDidEndEditingNotification];&#125;// Ê≥®ÂÜåÂºÄÂßãÁºñËæëÂíåÁªìÊùüÁºñËæëÁöÑÈÄöÁü•-(void)registerTextFieldViewClass:(nonnull Class)aClass didBeginEditingNotificationName:(nonnull NSString *)didBeginEditingNotificationName didEndEditingNotificationName:(nonnull NSString *)didEndEditingNotificationName&#123; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(textFieldViewDidBeginEditing:) name:didBeginEditingNotificationName object:nil]; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(textFieldViewDidEndEditing:) name:didEndEditingNotificationName object:nil];&#125; Ê≥®ÂÜå‰πãÂ§ñÁöÑÊâÄÊúâÈÄªËæëÈÉΩÂú®Ëøô‰∫õÈÄöÁü•ÊñπÊ≥ïÂÜÖ ÂàõÂª∫‰∏Ä‰∏™ UITapGestureRecognizerËøô‰∏™ÊâãÂäøÁî®Êù•Âú®ÁÇπÂáª UITextField ‰ª•Â§ñÁöÑÂå∫ÂüüÁöÑÊó∂ÂÄôÊî∂Ëµ∑ÈîÆÁõò 12345678910111213141516171819// ‰∏∫ÁÇπÂáªÂ±èÂπïÂèñÊ∂àÁ¨¨‰∏ÄÂìçÂ∫îËÄÖËøô‰∏™ÂäüËÉΩÂàõÂª∫‰∏Ä‰∏™ÊâãÂäøstrongSelf.resignFirstResponderGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapRecognized:)];// ËÆæÁΩÆËØ•ÊâãÂäø‰∏çÂèñÊ∂à‰∫ã‰ª∂‰º†ÈÄístrongSelf.resignFirstResponderGesture.cancelsTouchesInView = NO;// ËÆæÁΩÆÊâãÂäø‰ª£ÁêÜ‰∏∫Ëá™Ë∫´[strongSelf.resignFirstResponderGesture setDelegate:self];// Â∞ÜÊâãÂäøÈªòËÆ§ËÆæ‰∏∫‰∏çÂêØÁî®strongSelf.resignFirstResponderGesture.enabled = strongSelf.shouldResignOnTouchOutside;// ÁÇπÂáªÂ§ñÈÉ®Âå∫ÂüüÊòØÂê¶ÂèñÊ∂àÁ¨¨‰∏ÄÂìçÂ∫îËÄÖ[self setShouldResignOnTouchOutside:NO];- (void)tapRecognized:(UITapGestureRecognizer*)gesture // (Enhancement ID: #14)&#123; if (gesture.state == UIGestureRecognizerStateEnded) &#123; //Resigning currently responder textField. [self resignFirstResponder]; &#125;&#125; ÈÖçÁΩÆÈîÆÁõòÈÅÆÊå°Áõ∏ÂÖ≥ÁöÑ‰∏Ä‰∫õÁ±ª‰∏ãÈù¢ÁöÑËøô‰∫õÈÖçÁΩÆÁî®‰∫éËÆæÁΩÆ Textfield Âú®Âì™‰∫õÁ±ª‰∏≠ IQKeyboardManager ËÉΩÂ§üÂêØÁî®ÔºåÊàñËÄÖÂÖ≥Èó≠„ÄÇ‰∏ÄËà¨‰ΩøÁî®Âú∫ÊôØ‰∏çÂ§ö„ÄÇËßÅÂêçÊÄùÊÑè„ÄÇ 1234567891011strongSelf.disabledDistanceHandlingClasses = [[NSMutableSet alloc] initWithObjects:[UITableViewController class],[UIAlertController class], nil];strongSelf.enabledDistanceHandlingClasses = [[NSMutableSet alloc] init];strongSelf.disabledToolbarClasses = [[NSMutableSet alloc] initWithObjects:[UIAlertController class], nil];strongSelf.enabledToolbarClasses = [[NSMutableSet alloc] init];strongSelf.toolbarPreviousNextAllowedClasses = [[NSMutableSet alloc] initWithObjects:[UITableView class],[UICollectionView class],[IQPreviousNextView class], nil];strongSelf.disabledTouchResignedClasses = [[NSMutableSet alloc] initWithObjects:[UIAlertController class], nil];strongSelf.enabledTouchResignedClasses = [[NSMutableSet alloc] init];strongSelf.touchResignedGestureIgnoreClasses = [[NSMutableSet alloc] initWithObjects:[UIControl class],[UINavigationBar class], nil]; textFieldViewDidBeginEditingÂú®Ëøô‰∏™ÂºÄÂßãÁºñËæëÁöÑÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÂ∞±ÊòØÊ†πÊçÆÈúÄË¶ÅÊ∑ªÂä†ÊàñÁßªÈô§ toolbarÔºö Âà§Êñ≠ÊòØÂê¶ÂÖÅËÆ∏Ê∑ªÂä†È¶ñÂÖà‰ºöË∞ÉÁî® privateIsEnableAutoToobar ÊñπÊ≥ïÔºåÂà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅÊòæÁ§∫ toobar„ÄÇËøô‰∏™Âà§Êñ≠ÈÄªËæëÂ∞±ÊòØÊ†πÊçÆÂ§ñÈÉ®ËÆæÁΩÆÁöÑ enable ÂèòÈáèÁöÑÂÄºÔºåÁÑ∂ÂêéËøòÊúâÂâçÈù¢ÊèêÂà∞ÁöÑÂΩìÂâç textfield ÊâÄÂú®ÁöÑ ViewController ÊòØÂê¶ÊòØ enable ÁöÑÁâπ‰æã„ÄÇ‰º™‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011- (Bool) privateIsEnableAutoToobar &#123; if (ÂºÄÂêØIQKeyboardManager) &#123; if (textfield Âú®Á¶ÅÊ≠¢ÁöÑ ViewController ‰∏≠) &#123; return NO; &#125;&#125; else &#123; if (textfield Âú®ÂÖÅËÆ∏ÁöÑ ViewController ‰∏≠ÔºåÂπ∂‰∏î‰∏çÊòØ UIAlertController Âíå TextFieldViewController ) &#123; return YES; &#125; &#125;&#125; Âú® IQToolbar ‰∏äÊ∑ªÂä†ÊåâÈíÆÂ¶ÇÊûúÂÖÅËÆ∏Ê∑ªÂä†„ÄÇÈÇ£‰πàÂ∞±‰ºöË∞ÉÁî® addToolbarIfRequired ÊñπÊ≥ï„ÄÇ‰∏ªË¶ÅÊòØÂú® toolbar ‰∏≠Ê∑ªÂä†ÂêÑÁßç button„ÄÇ‰º™‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344- (void)addToolbarIfRequired &#123; if (textfield ËÉΩÂ§üÊ∑ªÂä† inputAccessoryView &amp;&amp; textfield ÁöÑ inputAccessoryView ‰∏∫ nil) &#123; if (ÊúâËá™ÂÆö‰πâÁöÑÂõæÁâá toolbarDoneBarButtonItemImage) &#123; Áî®Ëøô‰∏™ toolbarDoneBarButtonItemImage ÂàùÂßãÂåñ‰∏Ä‰∏™ toolbar Âè≥ËæπÁöÑ done ÊåâÈíÆ &#125; else if (ÊúâËá™ÂÆö‰πâÁöÑÊñáÂ≠ó toolbarDoneBarButtonItemText) &#123; Áî®Ëøô‰∏™ toolbarDoneBarButtonItemText ÂàùÂßãÂåñ‰∏Ä‰∏™ toobar Âè≥ËæπÁöÑ done ÊåâÈíÆ &#125; else &#123; ÂàùÂßãÂåñÈªòËÆ§ÁöÑÂè≥ËæπÁöÑ toolbar ÁöÑ done ÊåâÈíÆ &#125; if (ÂΩìÂâç textfield Ê≤°ÊúâÂÖÑÂºü textfield) &#123; // Âè™Êúâ‰∏Ä‰∏™Â∞±‰∏çÁî®Ê∑ªÂä†Â∑¶ËæπÁöÑÂâç‰∏Ä‰∏™Âêé‰∏Ä‰∏™ÁöÑÊåâÈíÆ‰∫ÜÔºåÂ∞±Áõ¥Êé•ËøîÂõû return &#125; else &#123; if (ÊúâËá™ÂÆö‰πâÁöÑÂõæÁâá) &#123; ÂàùÂßãÂåñÂ∏¶ÂõæÁâáÁöÑ prev ÁöÑÊåâÈíÆ‰ª•Âèä next ÊåâÈíÆ &#125; else if (ÊúâËá™ÂÆö‰πâÁöÑÊñáÂ≠ó) &#123; ÂàùÂßãÂåñÂ∏¶ÊñáÂ≠óÁöÑ prev ÊåâÈíÆ‰ª•Âèä next ÊåâÈíÆ &#125; else &#123; ÂàùÂßãÂåñÈªòËÆ§ÁöÑ prev ÊåâÈíÆ‰ª•Âèä next ÊåâÈíÆ &#125; &#125; if (textfield ÂÆûÁé∞‰∫Ü keyboardAppearance ÊñπÊ≥ï) &#123; Ê†πÊçÆ keyboard ÁöÑÊ®°ÂºèËÆæÁΩÆ toolbar ÁöÑÊ†∑Âºè &#125; if (shouldShowToolbarPlaceholder Â±ûÊÄß‰∏∫ YES) &#123; Â∞Ü textfield ÁöÑ placeholder ÁöÑÊ†∑ÂºèÂ§çÂà∂Áªô toolbar ÁöÑ titleBarButton &#125; else &#123; ÈöêËóè toolbar ÁöÑ titleBarButton &#125; if (ÂΩìÂâç textfield ÊòØÁ¨¨‰∏Ä‰∏™) &#123; ËÆæÁΩÆ prev ÊåâÈíÆ enabled ‰∏∫ NO &#125; else if (ÂΩìÂâç textfield ÊòØÊúÄÂêé‰∏Ä‰∏™) &#123; ËÆæÁΩÆ next ÊåâÈíÆ enabled ‰∏∫ NO &#125; else &#123; ËÆæÁΩÆ prev Âíå next ÊåâÈíÆ enabled ‰∏∫ YES &#125; // ÊúÄÂêéÈÄöËøáËÆæÁΩÆÂ•ΩÁöÑ prev Âíå next Âíå placeholder Âíå done ÂàõÂª∫ IQToolbar„ÄÇÂπ∂Â∞Ü toolbar ËÆæÁΩÆ‰∏∫ textfield ÁöÑ inputAccessview [textfield setInputAccessView: toolbar]; &#125;&#125; ‰ª£Á†ÅÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÂæàÁπÅÁêêÔºå‰º™‰ª£Á†ÅÈÉΩÂÜô‰∫ÜËøô‰πàÂ§ö„ÄÇÂèØ‰ª•ÁúãÂà∞ÔºåIQKeyboardManager Âæà‰∫∫ÊÄßÂåñÁöÑ‰∏∫ toobar ‰∏äÂ∑¶Âè≥ÁöÑÊåâÈíÆÈÉΩËÆæÁΩÆ‰∫ÜËá™ÂÆö‰πâÁöÑÂõæÁâáÂíåÊñáÂ≠ó(ËôΩÁÑ∂‰∏ÄËà¨‰∏ç‰ºöÊúâ‰∫∫ÂéªÊîπ) ÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂ÂÆåÊàêÊåâÈíÆÁöÑÁÇπÂáª‰∫ã‰ª∂ÂèØ‰ª•ÁêÜËß£‰∏∫Â∞±ÊòØÂèñÊ∂à textfield ÁöÑÁ¨¨‰∏ÄÂìçÂ∫îËÄÖ„ÄÇprev ÊåâÈíÆÂíå next ÊåâÈíÆÂÆûÁé∞‰∏äÁ®çÂæÆÂ§çÊùÇ‰∏ÄÁÇπÔºå‰ΩÜÊòØÊÄùÊÉ≥‰∏äÊòØÈùûÂ∏∏ÁÆÄÂçïÁöÑ„ÄÇ‰ª• prev ÊåâÈíÆ‰∏∫‰æãÔºö 123456-(void)previousAction:(IQBarButtonItem*)barButton &#123; if ([self canGoPrevious]) &#123; [self goPrevious]; &#125; ....ÁúÅÁï•‰ª•‰∏ÄÈÉ®ÂàÜ firstResponder ËΩ¨ÁßªÊàêÂäüÂêéËá™ÂÆö‰πâÁöÑÂ§ÑÁêÜÈÄªËæë(‰∏ÄËà¨‰∏ç‰ºö‰ΩøÁî®Â∞±ÁúÅÁï•‰∏çÁúã‰∫Ü)&#125; ÈÄªËæëÂ∞±ÊòØËÉΩË∑≥Âà∞ÂâçÈù¢‰∏Ä‰∏™Â∞±Ë∑≥Âà∞ÂâçÈù¢‰∏Ä‰∏™Ôºö 1234567891011121314151617181920212223242526272829303132-(BOOL)canGoPrevious &#123; // Ëé∑ÂèñÂΩìÂâçËßÜÂõæÁöÑÊâÄÊúâÂÖÑÂºü textfield NSArray&lt;UIView*&gt; *textFields = [self responderViews] // Ëé∑ÂèñÂΩìÂâç textfield Âú®Ëøô‰∫õ textfield ÁöÑ index NSUInteger index = [textFields indexOfObject:_textFieldView]; // Â¶ÇÊûú textfield ÁöÑ index ‰∏çÊòØÁ¨¨‰∏Ä‰∏™ if (index != NSNotFound &amp;&amp; index &gt; 0) &#123; return YES; &#125; else &#123; return NO; &#125;&#125;-(BOOL)goPrevious &#123; // Ëé∑ÂèñÂΩìÂâçËßÜÂõæÁöÑÊâÄÊúâÂÖÑÂºü textfield NSArray&lt;__kindof UIView*&gt; *textFields = [self responderViews]; // Ëé∑ÂèñÂΩìÂâç textfield Âú®Ëøô‰∫õ textfield ÁöÑ index NSUInteger index = [textFields indexOfObject:_textFieldView]; // Â¶ÇÊûú textfield ÁöÑ index ‰∏çÊòØÁ¨¨‰∏Ä‰∏™ if (index != NSNotFound &amp;&amp; index &gt; 0) &#123; UITextField *nextTextField = textFields[index-1]; UIView *textFieldRetain = _textFieldView; // ‰∏ä‰∏Ä‰∏™ textfield Ëé∑ÂèñÁÑ¶ÁÇπ BOOL isAcceptAsFirstResponder = [nextTextField becomeFirstResponder]; if (isAcceptAsFirstResponder == NO) &#123; [textFieldRetain becomeFirstResponder]; &#125; return isAcceptAsFirstResponder; &#125; else &#123; return NO; &#125;&#125; ÊúâÊ≤°ÊúâÂæàÁÜüÊÇâÔºüÂíåÂ§ÑÁêÜ return ÈîÆÁöÑÈÄªËæëÁ±ª‰ºº„ÄÇÊãøÂà∞ÊâÄÊúâÂÖÑÂºü textfieldÔºåÁÑ∂ÂêéÂà§Êñ≠ÂΩìÂâç textfield ÊòØÂê¶ÊòØÁ¨¨‰∏Ä‰∏™„ÄÇ‰∏çÊòØÁöÑËØùÂ∞±ËÆ©‰∏ä‰∏Ä‰∏™Ëé∑ÂèñÁÑ¶ÁÇπ„ÄÇ ÁßªÈô§ IQToolbarËØ¥ÂÆå‰∫ÜÊ∑ªÂä† IQToolbarÔºåÁé∞Âú®ÂÜçÊù•Âø´ÈÄüÁúã‰∏Ä‰∏ãÂ¶ÇÊûú privateIsEnableAutoToolbar ‰∏∫ NO ÊÉÖÂÜµ‰∏ãÁßªÈô§ toolbar 1234567891011-(void)removeToolbarIfRequired &#123; NSArray&lt;UIView*&gt; *siblings = [self responderViews]; for (UITextField *textField in siblings) &#123; UIView *toolbar = [textField inputAccessoryView]; if ([textField respondsToSelector:@selector(setInputAccessoryView:)] &amp;&amp; ([toolbar isKindOfClass:[IQToolbar class]] &amp;&amp; (toolbar.tag == kIQDoneButtonToolbarTag || toolbar.tag == kIQPreviousNextButtonToolbarTag))) &#123; textField.inputAccessoryView = nil; [textField reloadInputViews]; &#125; &#125;&#125; ÁßªÈô§ÁöÑÊñπÊ≥ïÊõ¥ÁÆÄÂçï„ÄÇÁõ¥Êé•ÊâæÂà∞ÊâÄÊúâÂÖÑÂºü textfieldÔºåÂ¶ÇÊûúÂÆÉ‰ª¨ÁöÑ inputAccessoryView ÊòØ IQToolbar Á±ªÂûãÔºåÈÇ£‰πàÂ∞±Ê∏ÖÁ©∫„ÄÇ keyboardWillShowÈîÆÁõòÂºπÂá∫ÁöÑÈÄöÁü•‰∏≠ÔºåÂ∞±Ë¶ÅË∞ÉÊï¥ËßÜÂõæÂÅèÁßª‰∫Ü„ÄÇËøô‰∏™ÊñπÊ≥ï‰∏≠‰øùËØÅ‰∫ÜÈîÆÁõòÂºπÂá∫ÂêéÔºåÊàë‰ª¨ÁöÑÈîÆÁõò‰∏ç‰ºöÈòªÊå° UITextField ÊãøÂà∞ÈîÆÁõòÂºπÂá∫ÁöÑÂêÑÁßçÂèÇÊï∞‰∏ªË¶ÅÊãøÂà∞ÈîÆÁõòÂºπÂá∫ÁöÑÂä®ÁîªÁ±ªÂûãÔºåÂä®ÁîªÊó∂Èó¥‰ª•ÂèäÈîÆÁõòÁöÑÂ§ßÂ∞è 12345678910111213141516171819-(void)keyboardWillShow:(NSNotification*)aNotification&#123; _kbShowNotification = aNotification; // Getting keyboard animation. NSInteger curve = [[aNotification userInfo][UIKeyboardAnimationCurveUserInfoKey] integerValue]; _animationCurve = curve&lt;&lt;16; // Getting keyboard animation duration CGFloat duration = [[aNotification userInfo][UIKeyboardAnimationDurationUserInfoKey] floatValue]; //Saving animation duration if (duration != 0.0) _animationDuration = duration; // Getting UIKeyboardSize. _kbSize = [[aNotification userInfo][UIKeyboardFrameEndUserInfoKey] CGRectValue]; ...&#125; ËøôÈáåÊàëÁ®çÂæÆ‰øÆ‰∫Ü‰∏ã‰ª£Á†Å‰∏≠ÁöÑÈÄªËæë„ÄÇÂõ†‰∏∫ÂéüÊù•ÁöÑÈÄªËæë‰∏≠ÈíàÂØπÂ§öÁßçÊÉÖÂÜµ‰ª•Âèä bug Â¢ûÂä†‰∫ÜÂæàÂ§öÂØπÊàë‰ª¨‰∫ÜËß£‰∏ªÊµÅÁ®ã‰∏çÂøÖË¶ÅÁöÑ‰ª£Á†Å„ÄÇ ‰øùÂ≠ò frame ÁöÑ‰ΩçÁΩÆÂú®ÈîÆÁõòÂºπÂá∫Ë∞ÉÊï¥‰ΩçÁΩÆÂâçÔºåÊää frame ÁöÑÂéüÂßã‰ΩçÁΩÆ‰øùÂ≠òËµ∑Êù•ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Âú®ÈîÆÁõòÊî∂Ëµ∑ÂêéÔºåÂ∞Ü frame ÁßªÂõûÂéüÊù•ÁöÑ‰ΩçÁΩÆÔºö 1_topViewBeginOrigin = rootController.view.frame.origin; Ë∞ÉÊï¥ËßÜÂõæÂÅèÁßªÈöèÂêéÊù•Âà∞Ë∞ÉÊï¥ÂÅèÁßªÁöÑÊñπÊ≥ï optimizedAdjustPosition ‰∏≠ÔºåÂÆÉÂú®‰∏ªÁ∫øÁ®ã‰∏≠Ë∞ÉÁî®„ÄÇÂõ†‰∏∫Â±äÊó∂Â∞Ü‰ºöÂØπ UI ËøõË°åË∞ÉÊï¥Ôºö 1234567-(void)optimizedAdjustPosition&#123; __weak typeof(self) weakSelf = self; // Ê∑ªÂä†Âà∞‰∏ªÁ∫øÁ®ã‰∏≠zÂºÇÊ≠•ÊâßË°å [[NSOperationQueue mainQueue] addOperationWithBlock:^&#123; [self adjustPosition]; &#125;];&#125; Êï¥‰∏™ adjustPosition ÁöÑÊñπÊ≥ïÈùûÂ∏∏ÈïøÔºåËøòÊòØ‰ª•‰º™‰ª£Á†ÅÁöÑÊñπÂºè‰∫ÜËß£‰∏Ä‰∏ãËøáÁ®ãÔºö 12345678910111213141516171819202122- (void)adjustPosition &#123; // ÂÆûÈôÖÁöÑÈîÆÁõòÂ§ßÂ∞è CGSize kbSize = keyboardWillShow ‰∏≠ÊãøÂà∞ÁöÑÈîÆÁõòÁöÑÂ§ßÂ∞è + textfield Ë∑ùÁ¶ªÈîÆÁõòÁöÑÈ´òÂ∫¶ // ÁßªÂä®ÁöÑË∑ùÁ¶ª CGFloat move = MIN(textfieldÁöÑy + textfieldÁöÑÈ´òÂ∫¶ + ÈîÆÁõòÁöÑÈ´òÂ∫¶ + Â∫ïÈÉ®Âõ†‰∏∫tabbarÊàñËÄÖ iphoneX Áïô‰∏ãÁöÑÈó¥Èöô - Â±èÂπïÁöÑÈ´òÂ∫¶, textfieldÁöÑy - È°∂ÈÉ®navigationBar ÁöÑÈ´òÂ∫¶ - statusBar ÁöÑÈ´òÂ∫¶) // ÊâæÂà∞ËÉΩÁõ¥Êé•ÊªöÂä®ÁöÑ UIScrollView UIScrollView *superView = (UIScrollView*)[textFieldView superviewOfClassType:[UIScrollView class]]; while (superView) &#123; superView ÂèØÊªöÂä®ÁªìÊùüÔºå‰∏çÂèØÊªöÂä®ÔºåÁªßÁª≠ÂæÄ‰∏äÊâæ &#125; // ÁúÅÁï• lastScrollView Áõ∏ÂÖ≥ÂÜÖÂÆπÔºåËØ•ÂÜÖÂÆπÁî®‰∫é‰øÆÂ§çÁõ∏ÂÖ≥ bug ... if (textfield Â≠òÂú®ÂèØ‰ª•ÊªöÂä®ÁöÑ scrollViewÔºåÂπ∂‰∏îËÉΩÂ§üÊªöÂä®ÁöÑË∑ùÁ¶ªË∂ÖËøáÈúÄË¶ÅÊªöÂä®ÁöÑË∑ùÁ¶ª) &#123; Âä®ÁîªÊñπÂºèËÆæÁΩÆ contentOffset &#125; if (textfield ‰∏çÂ≠òÂú®‰∫é scrollView ‰∏äÔºåÊàñËÄÖ‰∏çËÉΩÊªöÂä®) &#123; Âä®ÁîªËÆæÁΩÆ rootViewController ÁöÑ origin.y Âêë‰∏äÁßªÂä®„ÄÇÂç≥Êï¥‰∏™ rootViewController Âêë‰∏äÁßªÂä® &#125;&#125; move ÁöÑËÆ°ÁÆóÊúâËÆ≤Á©∂ÔºåÁßªÂä®ÁöÑËåÉÂõ¥Ë¶ÅÊó¢‰∏çËÉΩË¢´ keyboard Êå°‰ΩèÔºåÂèà‰∏çËÉΩË¢´È°∂Âá∫Â±èÂπïÊòæÁ§∫ÁöÑËåÉÂõ¥„ÄÇÊâÄ‰ª•Ë¶ÅÊØîËæÉÂ∫ï‰∏ãÈúÄË¶ÅÂæÄ‰∏äÈ°∂ÁöÑÈ´òÂ∫¶Ôºå‰ª•ÂèäÊúÄÈ´òËÉΩÂæÄ‰∏äÂ§öÂ∞ëÔºåÂèñÂÖ∂‰∏≠ËæÉÂ∞èÁöÑ„ÄÇ ÂÖ≥‰∫éËÆæÁΩÆ textfield ÊâÄÂú®ÁöÑ scrollView ÁöÑ contentOffset„ÄÇÂ¶ÇÊûú‰Ω†ÂÜôËøáÁ±ª‰ººÂæÆ‰ø°ÁöÑËÅäÂ§©ÁïåÈù¢ÂèØËÉΩÊúâÂá∫Áé∞Ëøá‰∏Ä‰∏™ÈóÆÈ¢òÂ∞±ÊòØÂΩìËæìÂÖ•ÂºπÂá∫ÈîÆÁõòÁöÑÊó∂ÂÄôÔºånavigationBar ‰πüÁßªÂä®‰∫Ü‰∏äÂéª„ÄÇËøôÊòØÂõ†‰∏∫‰Ω†Ë¶ÅËæìÂÖ•ÁöÑÁû¨Èó¥ÔºåÂ∫ïÈÉ®ÁöÑËæìÂÖ•Ê°ÜË¢´ IQKeyboardManager ËÆ§‰∏∫Ë¶ÅÂêë‰∏äÁßªÔºå‰ΩÜÊòØÂ∫ïÈÉ®ÁöÑËæìÂÖ•Ê°ÜÊ≤°ÊúâÂèØ‰ª•ÊªöÂä®ÁöÑ scrollViewÔºåÂõ†Ê≠§Â∞±Êää rootViewController ÁöÑ y Âêë‰∏äÁßªÂä®‰∫ÜÔºåÂú®Êàë‰ª¨ÁúãÊù•Â∞±ÊòØÊï¥‰∏™ÁïåÈù¢ÈÉΩÈ°∂‰∫Ü‰∏äÂéª„ÄÇ keyboardWillHideÂú® keyboardWillHide ÊñπÊ≥ï‰∏≠ËøõË°åÊâ´Â∞æÂ∑•‰ΩúÔºåÂåÖÊã¨Â∞Ü scrollView ÊªöÂõûÂà∞ÂéüÊù•ÁöÑ‰ΩçÁΩÆ„ÄÇ 12345678- (void)keyboardWillHide:(NSNotification*)aNotification &#123; if (Â≠òÂú®ÊªöÂä®ÁöÑ scrollView) &#123; Âä®ÁîªÊñπÂºèÂ∞Ü scrollView ÊªöÂõûÂéüÂ§Ñ &#125; Âä®ÁîªÊñπÂºèÂ∞Ü rootViewController ÊªöÂõûÂéüÂ§Ñ Â∞Ü show Êó∂ÂÄôËÆæÁΩÆÁöÑÂêÑÁßçÂèòÈáèËÆæÁΩÆÂõûÂéüÂßãÂÄº&#125; ÂÆûÈôÖ‰∏äÂú®ÁªìÊùüËæìÂÖ•ÁöÑÊó∂ÂÄôÔºåËøòÊúâÂÖ∂‰ªñÁöÑ‰∫ã‰ª∂ÈÄöÁü•Ëß¶ÂèëÔºåÂêåÊ†∑‰πüÊòØËøõË°å‰∏Ä‰∫õÊâ´Â∞æÂ∑•‰ΩúÔºåÂ∞±‰∏çÂÅöÊõ¥Â§öÁöÑ‰ªãÁªç‰∫Ü„ÄÇ Â∞èÊäÄÂ∑ßÂà∞ÊúÄÂêé‰∫ÜÊÄªÁªì‰∏Ä‰∏ãÁúã IQKeyboardManager Ê∫êÁ†ÅÂ≠¶Âà∞ÁöÑ‰∏Ä‰∫õÊäÄÂ∑ß„ÄÇ ÂØπ‰∏Ä‰∏™Êï∞ÁªÑÊéíÂ∫èÔºö123456789101112131415161718[SomeViewArray sortedArrayUsingComparator:^NSComparisonResult(UIView *view1, UIView *view2) &#123; CGFloat x1 = CGRectGetMinX(view1.frame); CGFloat y1 = CGRectGetMinY(view1.frame); CGFloat x2 = CGRectGetMinX(view2.frame); CGFloat y2 = CGRectGetMinY(view2.frame); if (y1 &lt; y2) return NSOrderedAscending; else if (y1 &gt; y2) return NSOrderedDescending; //Else both y are same so checking for x positions else if (x1 &lt; x2) return NSOrderedAscending; else if (x1 &gt; x2) return NSOrderedDescending; else return NSOrderedSame;&#125;]; ÈÄöËøáÂìçÂ∫îÈìæËé∑ÂæóÂΩìÂâçËßÜÂõæÁöÑ ViewController123456789101112131415-(UIViewController*)viewContainingController&#123; UIResponder *nextResponder = self; do &#123; nextResponder = [nextResponder nextResponder]; if ([nextResponder isKindOfClass:[UIViewController class]]) return (UIViewController*)nextResponder; &#125; while (nextResponder); return nil;&#125; Âú® load ÊñπÊ≥ï‰∏≠ÂºÇÊ≠•ÊâßË°åÂàùÂßãÂåñÊìç‰Ωú1234+(void)load&#123; [self performSelectorOnMainThread:@selector(sharedManager) withObject:nil waitUntilDone:NO];&#125; ËÆ°ÁÆóÊñπÊ≥ïÁöÑÊâßË°åÊó∂Èó¥ÊñπÊ≥ïÁöÑÊâßË°åÊó∂Èó¥ÂèØ‰ª•ÈÄöËøáÂàÜÂà´Ëé∑ÂèñÊñπÊ≥ïÂºÄÂßãÊâßË°åÂíåÊâßË°åÂÆåÊØïÁöÑÊó∂Èó¥ÔºåÁÑ∂ÂêéÁõ∏ÂáèÔºö 12CFTimeInterval startTime = CACurrentMediaTime();CFTimeInterval elapsedTime = CACurrentMediaTime() - startTime; iOS ÂèëÂá∫ËæìÂÖ•ÈîÆÁõòÁöÑÂ£∞Èü≥iOS Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ïÊèê‰æõÊí≠ÊîæÈîÆÁõòÂ£∞Èü≥Ôºö 1[[UIDevice currentDevice] playInputClick] ÊØîÂ¶ÇÈÄöËÆØÂΩïÈÄâÊã©‰∫ÜÈ¶ñÂ≠óÊØçÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™ÊñπÊ≥ïÊí≠ÊîæÂ£∞Èü≥„ÄÇ ËÆæÁΩÆÈöèÈîÆÁõòÂºπÂá∫ÁöÑËßÜÂõæÂú®Ê≤°Áúã‰ª£Á†ÅÂâçÔºå‰Ω†ÂèØËÉΩ‰ºöËÆ§‰∏∫ IQKeyboardManager ÊòØÈÄöËøáÂä®ÁîªÁöÑÊñπÂºèÂ∞Ü IQToolbar Â±ïÁ§∫Âú® keyboard ‰∏äÁöÑ„ÄÇÂÖ∂ÂÆû iOS Êèê‰æõ‰∫ÜÁõ∏ÂÖ≥ÁöÑÂ±ûÊÄß„ÄÇÂèØ‰ª•Áõ¥Êé•Â∞ÜËá™ÂÆö‰πâËßÜÂõæËÆæÁΩÆ‰∏∫ textfield ÁöÑ inputAccessoryView Â∞±ÂèØ‰ª•ÂÆûÁé∞ÊïàÊûúÔºö 1[textfield setInputAccessView: yourView]; ÊÄªÁªìÁúãÂÆå‰∫Ü IQKeyboardManager Ê∫êÁ†ÅÔºåËß£ÂÜ≥‰∫ÜÊàë‰∏ÄÁõ¥‰ª•Êù•ÁöÑÁñëÊÉë„ÄÇÂè¶Â§ñÔºåIQKeyboardManager ‰∏çÊÑß‰∏∫‰∏Ä‰∏™Áªè‰πÖ‰∏çË°∞ÁöÑÁ¨¨‰∏âÊñπÂ∫ì„ÄÇÂÖ∂‰∏≠‰∏∫‰∫ÜËß£ÂÜ≥ÁâπÂÆöÊÉÖÂÜµ‰∏ãÁöÑ bugÔºåÂ¢ûÂä†‰∫ÜÂæàÂ§öËß£ÂÜ≥ bug ÁöÑÈÄªËæëÂíåÂèòÈáèÔºå‰∏∫ÈòÖËØªÊ∫êÁ†ÅÂ¢ûÂä†‰∫ÜËÆ∏Â§öÈöæÂ∫¶„ÄÇ‰∏çËøáÔºåËøô‰∫õÈíàÂØπ bug ÁöÑÈÄªËæëÂÖ∂ÂÆû‰∏çÊòØÊé¢ÂØªÂéüÁêÜÁöÑÂøÖË¶Å‰πãË∑ØÔºåÊ≤°ÊúâÂøÖË¶ÅÊää‰∏ÄÊï¥‰∏™Â∑•Á®ãÁöÑ‰ª£Á†ÅÈÉΩÁêÜËß£ÈÄèÂΩªÔºåË∑≥ËøáÂÆÉ‰ª¨ÔºåÂèØ‰ª•Êõ¥Âø´ÈÄüÁöÑÂÆö‰ΩçÂà∞Â∫ìÁöÑÊ†∏ÂøÉ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[YYModel Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2019%2F04%2F09%2Fyymodel%2F</url>
    <content type="text"><![CDATA[YYModel ÊòØ‰∏Ä‰∏™È´òÊÄßËÉΩÁöÑ json model Ëß£ÊûêÂ∫ì„ÄÇ ‰ΩøÁî®Model ‰∏é JSON ËΩ¨Êç¢12345678910111213141516171819202122// JSON:&#123; "uid":123456, "name":"Harry", "created":"1965-07-31T00:00:00+0000"&#125;// Model:@interface User : NSObject@property UInt64 uid;@property NSString *name;@property NSDate *created;@end@implementation User@end // Â∞Ü JSON (NSData,NSString,NSDictionary) ËΩ¨Êç¢‰∏∫ Model:User *user = [User yy_modelWithJSON:json]; // Â∞Ü Model ËΩ¨Êç¢‰∏∫ JSON ÂØπË±°:NSDictionary *json = [user yy_modelToJSONObject]; Model Â±ûÊÄßÂêçÂíå JSON ‰∏≠ key ‰∏çÁõ∏Âêå model Â±ûÊÄßÂØπÂ∫î‰∫é JSON ‰∏≠ËæÉÊ∑±ÁöÑ keypath model Â±ûÊÄßÂØπÂ∫îÂ§ö‰∏™ JSON ‰∏≠ÁöÑ key ÂÆûÁé∞ JSON ËΩ¨ Model Êò†Â∞ÑÊñπÊ≥ï modelCustomPropertyMapper 1234567891011121314151617181920212223242526// JSON:&#123; "n":"Harry Pottery", "p": 256, "ext" : &#123; "desc" : "A book written by J.K.Rowing." &#125;, "ID" : 100010&#125;// Model:@interface Book : NSObject@property NSString *name;@property NSInteger page;@property NSString *desc;@property NSString *bookID;@end@implementation Book//ËøîÂõû‰∏Ä‰∏™ DictÔºåÂ∞Ü Model Â±ûÊÄßÂêçÂØπÊò†Â∞ÑÂà∞ JSON ÁöÑ Key„ÄÇ+ (NSDictionary *)modelCustomPropertyMapper &#123; return @&#123;@"name" : @"n", @"page" : @"p", @"desc" : @"ext.desc", @"bookID" : @[@"id",@"ID",@"book_id"]&#125;;&#125;@end Model ‰∏≠ÂåÖÂê´ÂÖ∂‰ªñ ModelÁõ¥Êé•‰ΩøÁî®Ëá™ÂÆö‰πâÁöÑÁ±ªÔºö 12345678910111213141516171819202122232425// JSON&#123; "author":&#123; "name":"J.K.Rowling", "birthday":"1965-07-31T00:00:00+0000" &#125;, "name":"Harry Potter", "pages":256&#125;// Model: ‰ªÄ‰πàÈÉΩ‰∏çÁî®ÂÅöÔºåËΩ¨Êç¢‰ºöËá™Âä®ÂÆåÊàê@interface Author : NSObject@property NSString *name;@property NSDate *birthday;@end@implementation Author@end @interface Book : NSObject@property NSString *name;@property NSUInteger pages;@property Author *author; //Book ÂåÖÂê´ Author Â±ûÊÄß@end@implementation Book@end ÂÆπÂô®Á±ªÂ±ûÊÄßÊï∞ÁªÑÂíåÂ≠óÂÖ∏‰∏≠Â≠òÊîæÁöÑÊï∞ÊçÆÂèØ‰ª•ÈÄöËøá modelContainerPropertyGenericClass ÊåáÂÆöÔºö 1234567891011121314151617@class Shadow, Border, Attachment;@interface Attributes@property NSString *name;@property NSArray *shadows; //Array&lt;Shadow&gt;@property NSSet *borders; //Set&lt;Border&gt;@property NSMutableDictionary *attachments; //Dict&lt;NSString,Attachment&gt;@end@implementation Attributes// ËøîÂõûÂÆπÂô®Á±ª‰∏≠ÁöÑÊâÄÈúÄË¶ÅÂ≠òÊîæÁöÑÊï∞ÊçÆÁ±ªÂûã (‰ª• Class Êàñ Class Name ÁöÑÂΩ¢Âºè)„ÄÇ+ (NSDictionary *)modelContainerPropertyGenericClass &#123; return @&#123;@"shadows" : [Shadow class], @"borders" : Border.class, @"attachments" : @"Attachment" &#125;;&#125;@end JSON ËΩ¨ Model ÂÆåÊàêÂêéÁöÑÊìç‰ΩúÂú® class ‰∏≠ÂÆûÁé∞Áõ∏Â∫îÊñπÊ≥ïÔºåÈÄöËøá dic ÂèØ‰ª•ÊãøÂà∞ JSON ÁöÑÂ≠óÂÖ∏Ôºåself Â∞±ÊòØËΩ¨Êç¢Â•ΩÁöÑ ModelÔºö 1234- (id)modelCustomTransformFromDictionary:(NSDictionary *)dic &#123; // Êìç‰Ωú self return self&#125; ÂÆòÊñπÊñáÊ°£‰∏äÊ≤°ÊúâÊèêÂèäËøô‰∏™ÊñπÊ≥ïÔºåÂè™ÊòØÂú®ÊàëÁúãÊ∫êÁ†ÅÁöÑÊó∂ÂÄôÂèëÁé∞ÁöÑ„ÄÇÊàëËßâÂæóËøô‰∏™ÊñπÊ≥ïËøòÊòØÊØîËæÉÊúâÁî®ÁöÑÔºåÁõ∏ÂΩì‰∫éÂú®Ëé∑ÂèñÊï∞ÊçÆÂêéÂú® Model ÂÜÖÊâßË°åÁ±ª‰ºº‰∫é watch ÊñπÊ≥ïÔºåÂèØ‰ª•Êää‰∏Ä‰∫õÁÆÄÂçïÁöÑÊï∞ÊçÆÂ§ÑÁêÜÊîæÂú® model Â±Ç„ÄÇ È¢ùÂ§ñÂäüËÉΩÔºöCoding/Copying/hash/equal/description ÊñπÊ≥ïÁöÑÂÆûÁé∞1234567891011121314@interface YYShadow :NSObject &lt;NSCoding, NSCopying&gt;@property (nonatomic, copy) NSString *name;@property (nonatomic, assign) CGSize size;@end@implementation YYShadow// Áõ¥Êé•Ê∑ªÂä†‰ª•‰∏ã‰ª£Á†ÅÂç≥ÂèØËá™Âä®ÂÆåÊàê- (void)encodeWithCoder:(NSCoder *)aCoder &#123; [self yy_modelEncodeWithCoder:aCoder]; &#125;- (id)initWithCoder:(NSCoder *)aDecoder &#123; self = [super init]; return [self yy_modelInitWithCoder:aDecoder]; &#125;- (id)copyWithZone:(NSZone *)zone &#123; return [self yy_modelCopy]; &#125;- (NSUInteger)hash &#123; return [self yy_modelHash]; &#125;- (BOOL)isEqual:(id)object &#123; return [self yy_modelIsEqual:object]; &#125;- (NSString *)description &#123; return [self yy_modelDescription]; &#125;@end Ê∫êÁ†ÅËß£ÊûêÊñá‰ª∂ÁªìÊûÑYYModel ÁöÑÊ†∏ÂøÉÊòØ‰ª•‰∏ã‰∏§‰∏™Êñá‰ª∂Ôºö YYClassInfo ‰∏ªË¶ÅÊòØÂØπ OC ‰∏≠ÊàêÂëòÂèòÈáè„ÄÅÂ±ûÊÄß„ÄÅÊñπÊ≥ïÂíåÁ±ªÁöÑ‰∏ÄÂ±ÇÂ∞ÅË£Ö„ÄÇÂ∞Ü‰∏Ä‰∫õÈúÄË¶ÅÈÄöËøá Runtime ÊñπÊ≥ïËé∑ÂèñÂà∞ÁöÑÂ±ûÊÄß‰øùÂ≠òÂú®ÂØπË±°‰∏≠ÔºåÊúâÂä©‰∫éÂáèÂ∞ëÁõ∏ÂÖ≥ÊñπÊ≥ïË∞ÉÁî®Ê≠§Êó∂ÔºåÊèêÈ´òÊïàÁéá„ÄÇ NSObject+YYModel Êèê‰æõ‰∫ÜÊñπÊ≥ïÂÆûÁé∞ model json ËΩ¨Êç¢„ÄÇ YYClassInfoYYClassInfo ‰∏≠ÂåÖÂê´Âõõ‰∏™Á±ªÔºåÂàÜÂà´ÊòØÂØπÁ±ªÂèäÁ±ª‰∏≠ÁöÑÊàêÂëòÊ†áÈáè„ÄÅÂ±ûÊÄßÂíåÊñπÊ≥ïÁöÑÂ∞ÅË£Ö„ÄÇ YYClassIvarInfoYYClassIvarInfo ÁöÑÂ±ûÊÄßÂèäÂàùÂßãÂåñÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031@interface YYClassIvarInfo : NSObject// ÊàêÂëòÂèòÈáè@property (nonatomic, assign, readonly) Ivar ivar;// ÂèòÈáèÂêçÁß∞@property (nonatomic, strong, readonly) NSString *name;// ÂèòÈáèÂÅèÁßªÈáè@property (nonatomic, assign, readonly) ptrdiff_t offset;// ÂèòÈáèÁ±ªÂûãÁºñÁ†Å@property (nonatomic, strong, readonly) NSString *typeEncoding;// Ê†πÊçÆÂèòÈáèÁ±ªÂûãÁºñÁ†ÅËß£ÊûêÂá∫Êù•ÁöÑÁõ∏ÂØπÂ∫î‰∫éËá™Â∑±ÁöÑÊûö‰∏æ@property (nonatomic, assign, readonly) YYEncodingType type;@end@implementation YYClassIvarInfo- (instancetype)initWithIvar:(Ivar)ivar &#123; if (!ivar) return nil; self = [super init]; _ivar = ivar; const char *name = ivar_getName(ivar); if (name) &#123; _name = [NSString stringWithUTF8String:name]; &#125; _offset = ivar_getOffset(ivar); const char *typeEncoding = ivar_getTypeEncoding(ivar); if (typeEncoding) &#123; _typeEncoding = [NSString stringWithUTF8String:typeEncoding]; _type = YYEncodingGetType(typeEncoding); &#125; return self;&#125;@end ÂèØ‰ª•ÁúãÂà∞ÂàùÂßãÂåñÊñπÊ≥ïÂ∞±ÊòØÊää ivar ÁöÑÂá†‰∏™ÊàêÂëòÂèòÈáèÈÄöËøá Runtime ÊñπÊ≥ïÂèñÂá∫Êù•ÔºåËµãÂÄºÁªô YYClassIvarInfo ÁöÑÁõ∏Â∫îÂ±ûÊÄß‰∏≠„ÄÇ YYClassMethodInfo123456789@interface YYClassMethodInfo : NSObject@property (nonatomic, assign, readonly) Method method;@property (nonatomic, strong, readonly) NSString *name;@property (nonatomic, assign, readonly) SEL sel;@property (nonatomic, assign, readonly) IMP imp;@property (nonatomic, strong, readonly) NSString *typeEncoding;@property (nonatomic, strong, readonly) NSString *returnTypeEncoding;@property (nullable, nonatomic, strong, readonly) NSArray&lt;NSString *&gt; *argumentTypeEncodings;@end ËøôÈáåÂ∞±‰∏çÂÜçÂàó‰∏æÂÆÉÁöÑÂàùÂßãÂåñÊñπÊ≥ï‰∫ÜÔºåÊÄª‰πãÂ∞±ÊòØÊääÊñπÊ≥ïÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØÊèêÂèñÂà∞ÂØπË±°‰∏≠„ÄÇ YYClassPropertyInfoÂ±ûÊÄß‰∏≠Â§ö‰∫ÜÂá†‰∏™Â≠óÊÆµÔºåÂåÖÂê´Â±ûÊÄßÁöÑÁ±ªÔºåÂ±ûÊÄßÁ±ªÈÅµÂÆàÁöÑÂçèËÆÆ‰ª•ÂèäÂ±ûÊÄßÁöÑ get set ÊñπÊ≥ï 12345678910@interface YYClassPropertyInfo : NSObject@property (nonatomic, assign, readonly) objc_property_t property;@property (nonatomic, strong, readonly) NSString *name;@property (nonatomic, assign, readonly) YYEncodingType type;@property (nonatomic, strong, readonly) NSString *typeEncoding;@property (nonatomic, strong, readonly) NSString *ivarName;@property (nullable, nonatomic, assign, readonly) Class cls;@property (nullable, nonatomic, strong, readonly) NSArray&lt;NSString *&gt; *protocols;@property (nonatomic, assign, readonly) SEL getter;@property (nonatomic, assign, readonly) SEL setter; YYClassInfo1234567891011@interface YYClassInfo : NSObject@property (nonatomic, assign, readonly) Class cls;@property (nullable, nonatomic, assign, readonly) Class superCls;@property (nullable, nonatomic, assign, readonly) Class metaCls;@property (nonatomic, readonly) BOOL isMeta;@property (nonatomic, strong, readonly) NSString *name;@property (nullable, nonatomic, strong, readonly) YYClassInfo *superClassInfo;@property (nullable, nonatomic, strong, readonly) NSDictionary&lt;NSString *, YYClassIvarInfo *&gt; *ivarInfos;@property (nullable, nonatomic, strong, readonly) NSDictionary&lt;NSString *, YYClassMethodInfo *&gt; *methodInfos;@property (nullable, nonatomic, strong, readonly) NSDictionary&lt;NSString *, YYClassPropertyInfo *&gt; *propertyInfos;@end Á±ªÂ∞ÅË£Ö‰∏≠Â±ûÊÄßÂ§ö‰∫Ü‰∏Ä‰∫õÔºåÂåÖÂê´‰∫ÜÁà∂Á±ªÁöÑ YYClassInfo ÂØπË±°Ôºå‰ª•ÂèäÂ±ûÊÄß„ÄÅÊñπÊ≥ïÂèäÊàêÂëòÂèòÈáèÁöÑÊï∞ÁªÑ„ÄÇ ÂΩìÁÑ∂ YYClassInfo ‰∏≠ËøòÊúâ‰∏Ä‰∫õÂÖ∂‰ªñÁöÑÁªÜËäÇÔºå‰∏çÊòØÂæàÈáçË¶ÅÂ∞±‰∏çÂú®ËøôÈáåËØ¶Ëø∞‰∫Ü„ÄÇÂè™Ë¶ÅÁü•ÈÅì‰ª•‰∏äÂõõ‰∏™Â∞ÅË£ÖÁ±ªÂç≥ÂèØ„ÄÇ NSObject+YYModelËøô‰∏™Êñá‰ª∂‰∏≠ÂÆûÁé∞‰∫Ü ModelÂíå JSON ÁöÑÁõ∏‰∫íËΩ¨Êç¢„ÄÇ‰∏çËøáËøôÈáåÂÖà‰∏çÁõ¥Êé•ÂºÄÂßãËΩ¨Êç¢ÊñπÊ≥ïÁöÑÂàÜÊûêÔºåËÄåÊòØÂÖà‰ªé‰∏éÂÖ∂Áõ∏ÂÖ≥ÁöÑ‰∏§‰∏™Á±ª _YYModelPropertyMeta ‰ª•Âèä _YYModelMeta ÂºÄÂßã„ÄÇ _YYModelPropertyMeta_YYModelPropertyMeta ÊòØ YYClassPropertyInfo ÁöÑÂÜç‰∏ä‰∏ÄÂ±ÇÁöÑÂ∞ÅË£Ö„ÄÇÂ¶ÇÊûúËØ¥ YYClassPropertyInfo Âè™ÊòØ property_t ÁöÑÁÆÄÂçïÂ∞ÅË£ÖÔºåÈÇ£‰πà _YYModelPropertyMeta Â∞±ÂåÖÂê´‰∫Ü JSON ËΩ¨ Model ÊâÄÈúÄÁöÑ‰∏Ä‰∫õËá™ÂÆö‰πâÈÖçÁΩÆ„ÄÇ 12345678910111213141516171819202122232425@interface _YYModelPropertyMeta : NSObject &#123; @package NSString *_name; YYEncodingType _type; YYEncodingNSType _nsType; YYClassPropertyInfo *_info; BOOL _isCNumber; Class _cls; SEL _getter; SEL _setter; BOOL _isKVCCompatible; BOOL _isStructAvailableForKeyedArchiver; // Â±ûÊÄßÊòØÂê¶ÊúâËá™ÂÆö‰πâÁöÑÁ±ªÂûã„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã‰∏ç‰ºöÂá∫Áé∞Ë¶ÅËá™ÂÆö‰πâÁ±ªÂûãÁöÑÊÉÖÂÜµÔºåÂõ†‰∏∫ËøôÊ†∑ÁöÑÊñπÂºèËá™ÂÆö‰πâÁ±ªÂûã‰∏çÂ¶ÇÁõ¥Êé•ÂàõÂª∫Êñ∞ÁöÑÁ±ªÂûãÁõ¥Êé•„ÄÇÊñáÊ°£‰∏ä‰πüÊ≤°ÊúâÁõ∏ÂÖ≥ËØ¥Êòé„ÄÇÂõ†Ê≠§ÂêéÈù¢ËøôÈÉ®ÂàÜÁõ∏ÂÖ≥ÁöÑ‰ª£Á†ÅÁõ¥Êé•Áï•Ëøá„ÄÇ BOOL _hasCustomClassFromDictionary; // ‰∏ÄËà¨Áî®‰∫éÂ≠óÂÖ∏Êï∞ÁªÑÁ≠âÂÆπÂô®Á±ª‰∏≠„ÄÇË°®Á§∫ÂÆπÂô®ÁöÑÊ≥õÂûãÁ±ªÂûã Class _genericCls; // ÂΩìÂâçÂ±ûÊÄßÂØπÂ∫î‰∫é JSON ‰∏≠ÁöÑ key ÊàñËÄÖ keyPath NSString *_mappedToKey; NSArray *_mappedToKeyPath; NSArray *_mappedToKeyArray; // Â¶ÇÊûú JSON ‰∏≠‰∏Ä‰∏™ key ÂØπÂ∫î‰∫é model Â§ö‰∏™ÈîÆÁöÑÊÉÖÂÜµ‰∏ãÔºåÈÄöËøáËøô‰∏™ÊåáÈíà‰øùÂ≠ò _YYModelPropertyMeta *_next;&#125;@end _YYModelMeta_YYModelMeta ÁöÑÂ±ûÊÄß_YYModelMeta ÊòØ YYClassInfo ÁöÑ‰∏äÂ±ÇÂ∞ÅË£Ö„ÄÇÂ±ûÊÄßÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021@interface _YYModelMeta : NSObject &#123; @package YYClassInfo *_classInfo; // ÈîÆÊòØÂ±ûÊÄßÂêçÔºåÂÄºÊòØÂ±ûÊÄßÁöÑ‰∏Ä‰∏™Â∞ÅË£Ö YYModelPropertyMeta NSDictionary *_mapper; // ÊâÄÊúâÁöÑ YYModelPropertyMeta ÁöÑÈõÜÂêà NSArray *_allPropertyMetas; // Â¶ÇÊûú class ÂÆûÁé∞‰∫Ü modelCustomPropertyMapper ÊñπÊ≥ïÔºåÂÖ∂‰∏≠Êúâ JSON ÁöÑ keypaths ÂØπÂ∫î‰∫é‰∏Ä‰∏™ model ÁöÑÈîÆÁöÑÊÉÖÂÜµÔºåÈÇ£‰πà‰ºöË¢´Âä†ÂÖ•Âà∞Ëøô‰∏™Êï∞ÁªÑ‰∏≠ NSArray *_keyPathPropertyMetas; // Â¶ÇÊûú class ÂÆûÁé∞‰∫Ü modelCustomPropertyMapper ÊñπÊ≥ïÔºåÂÖ∂‰∏≠ÂèØËÉΩ JSON ‰∏≠Â§ö‰∏™Â≠óÊÆµÂØπÂ∫î‰∫é‰∏Ä‰∏™ model ÁöÑÈîÆÁöÑÊÉÖÂÜµÔºåÈÇ£‰πàÂ∞±‰ºöÂä†ÂÖ•Âà∞Ëøô‰∏™Êï∞ÁªÑ‰∏≠ NSArray *_multiKeysPropertyMetas; NSUInteger _keyMappedCount; YYEncodingNSType _nsType; // Â¶ÇÊûúÂÆûÁé∞‰∫ÜÁõ∏Â∫îÁöÑÊñπÊ≥ïÔºåÂàôÂú® JSON ËΩ¨Êç¢ Model ÂêéÂèØ‰ª•ÂÅö‰∏Ä‰∫õËá™ÂÆö‰πâÁöÑÊìç‰Ωú BOOL _hasCustomWillTransformFromDictionary; BOOL _hasCustomTransformFromDictionary; BOOL _hasCustomTransformToDictionary; BOOL _hasCustomClassFromDictionary;&#125;@end Ëé∑Âèñ _YYModelMeta ÁöÑÊñπÊ≥ïÈÄöËøá‰∏ãÈù¢ÁöÑÊñπÊ≥ïËé∑Âèñ _YYModelMeta„ÄÇ_YYModelMeta ÊòØÁ±ªÁ∫ßÁöÑÂØπË±°Ôºå‰∏Ä‰∏™Á±ªÂûãÂèØ‰ª•ÂÖ±‰∫´‰∏Ä‰∏™ÂÆû‰æã„ÄÇÂõ†Ê≠§Ôºå_YYModelMeta ÂÆû‰æãË¢´‰øùÂ≠òÂú®‰∏Ä‰∏™Âçï‰æãÁöÑ cache Â≠óÂÖ∏‰∏≠ÔºåÂè™ÊúâËØ•Á±ªÂûãÊú™Ë¢´ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÊâç‰ºöÈÄöËøá initWithClass ÊñπÊ≥ïÂàõÂª∫Ôºö 12345678910111213141516171819202122232425+ (instancetype)metaWithClass:(Class)cls &#123; if (!cls) return nil; static CFMutableDictionaryRef cache; static dispatch_once_t onceToken; static dispatch_semaphore_t lock; dispatch_once(&amp;onceToken, ^&#123; // _YYModelMeta ÁöÑÁºìÂ≠òÂ≠óÂÖ∏ cache = CFDictionaryCreateMutable(CFAllocatorGetDefault(), 0, &amp;kCFTypeDictionaryKeyCallBacks, &amp;kCFTypeDictionaryValueCallBacks); lock = dispatch_semaphore_create(1); &#125;); dispatch_semaphore_wait(lock, DISPATCH_TIME_FOREVER); // ÈÄöËøáÂ§ñÈÉ®‰º†ËøõÊù•ÁöÑ class Êù•Ëé∑ÂèñÁõ∏Â∫îÁöÑ _YYModelMeta ÂÆû‰æã„ÄÇ _YYModelMeta *meta = CFDictionaryGetValue(cache, (__bridge const void *)(cls)); dispatch_semaphore_signal(lock); if (!meta || meta-&gt;_classInfo.needUpdate) &#123; // meta = [[_YYModelMeta alloc] initWithClass:cls]; if (meta) &#123; dispatch_semaphore_wait(lock, DISPATCH_TIME_FOREVER); CFDictionarySetValue(cache, (__bridge const void *)(cls), (__bridge const void *)(meta)); dispatch_semaphore_signal(lock); &#125; &#125; return meta;&#125; ÂàõÂª∫ _YYModelMeta_YYModelMeta ÁöÑÂàùÂßãÂåñÊñπÊ≥ïÊØîËæÉÈïøÔºåËøôÈáåÊà™Âèñ‰∏ÄÊÆµÊÆµ‰ª£Á†ÅÂàÜÂà´ÂàÜÊûê„ÄÇ ÂÆπÂô®Á±ªÂûãÁöÑËÆæÁΩÆ 1234567891011121314151617181920212223// Â∞Ü modelContainerPropertyGenericClass ÊñπÊ≥ïËøîÂõûÁöÑÊ≥õÂûãNSDictionary *genericMapper = nil;if ([cls respondsToSelector:@selector(modelContainerPropertyGenericClass)]) &#123; genericMapper = [(id&lt;YYModel&gt;)cls modelContainerPropertyGenericClass]; if (genericMapper) &#123; NSMutableDictionary *tmp = [NSMutableDictionary new]; [genericMapper enumerateKeysAndObjectsUsingBlock:^(id key, id obj, BOOL *stop) &#123; if (![key isKindOfClass:[NSString class]]) return; Class meta = object_getClass(obj); if (!meta) return; if (class_isMetaClass(meta)) &#123; tmp[key] = obj; &#125; else if ([obj isKindOfClass:[NSString class]]) &#123; // Â¶ÇÊûúÊòØÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºåÈÇ£‰πàËΩ¨‰∏∫ class Á±ªÂûã Class cls = NSClassFromString(obj); if (cls) &#123; tmp[key] = cls; &#125; &#125; &#125;]; genericMapper = tmp; &#125;&#125; Ëøô‰∏™ÊñπÊ≥ïÁî®Êù•Â§ÑÁêÜÂÆπÂô®Á±ªÂ±ûÊÄß„ÄÇÂΩì Model ÂÆûÁé∞‰∫Ü modelContainerPropertyGenericClass ÊñπÊ≥ïÁöÑÊó∂ÂÄô(Â¶ÇÊûú‰∏çÁü•ÈÅìÔºåÂèØ‰ª•Áúã‰∏äÈù¢ÁöÑ‰ΩøÁî®‰ªãÁªç)ÔºåÂ∞±Â∞ÜÁªìÊûúÊöÇÊó∂‰øùÂ≠òÂú® genericMapper ‰∏≠ÔºåÂæÖÂà∞ÂêéÈù¢ÂÆû‰æãÂåñ _YYModelPropertyMeta ÂØπË±°ÁöÑÊó∂ÂÄôËÆæÁΩÆÂà∞ class genericCls ‰∏≠„ÄÇ Model ÂØπÂ∫î JSON keyPaths ÁöÑËÆæÁΩÆ Áõ∏ÂÖ≥ÂÆûÁé∞ÊòØÈÄöËøáÂú® Model ‰∏≠ÂÆûÁé∞ modelCustomPropertyMapper ÂÆûÁé∞ÁöÑ„ÄÇÂ¶ÇÊûú modelCustomPropertyMapper ËøîÂõûÁöÑÂ≠óÂÖ∏‰∏≠ÂÄºÊòØ‰∏Ä‰∏™Â∏¶Êúâ . ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÈÇ£‰πàÂ∞±ËØ¥Êòé Model ÂØπÂ∫î JSON ‰∏≠ÁöÑ keyPathsÔºö 123456789101112131415161718192021222324252627282930313233343536373839// Âú® model ‰∏≠ÂÆûÁé∞‰∫Ü modelCustomPropertyMapper ÁöÑÊÉÖÂÜµif ([cls respondsToSelector:@selector(modelCustomPropertyMapper)]) &#123; NSDictionary *customMapper = [(id &lt;YYModel&gt;)cls modelCustomPropertyMapper]; [customMapper enumerateKeysAndObjectsUsingBlock:^(NSString *propertyName, NSString *mappedToKey, BOOL *stop) &#123; // ‰ªé allPropertyMetas ‰∏≠ÊâæÂà∞ÊñπÊ≥ïËøîÂõûÂÄºÁõ∏ÂÖ≥ÁöÑÂ±ûÊÄß _YYModelPropertyMeta *propertyMeta = allPropertyMetas[propertyName]; if (!propertyMeta) return; // Áî±‰∫éË¶ÅËá™ÂÆö‰πâËÆæÁΩÆÔºåÊâÄ‰ª•ÂÖàÂà†Èô§Ëøô‰∏™Â±ûÊÄßÁõ∏ÂÖ≥ÁöÑ _YYModelPropertyMeta ÂÆû‰æã [allPropertyMetas removeObjectForKey:propertyName]; // Â¶ÇÊûúÊòØÂ≠óÁ¨¶‰∏≤Â∞±Ë°®Á§∫ÊòØË¶ÅÂ∞Ü JSON ‰∏≠ÁöÑ keypath Êò†Â∞ÑÂà∞ Modal ‰∏≠ if ([mappedToKey isKindOfClass:[NSString class]]) &#123; if (mappedToKey.length == 0) return; propertyMeta-&gt;_mappedToKey = mappedToKey; // ‰ª• '.' ‰Ωú‰∏∫ÂàÜÂâ≤ÂèñÂá∫Êï∞ÁªÑ NSArray *keyPath = [mappedToKey componentsSeparatedByString:@"."]; for (NSString *onePath in keyPath) &#123; if (onePath.length == 0) &#123; NSMutableArray *tmp = keyPath.mutableCopy; [tmp removeObject:@""]; keyPath = tmp; break; &#125; &#125; if (keyPath.count &gt; 1) &#123; // Â∞Ü keyPath ËµãÂÄºÁªô _YYModelPropertyMeta ÁöÑ _mappedToKeyPath Â±ûÊÄß propertyMeta-&gt;_mappedToKeyPath = keyPath; [keyPathPropertyMetas addObject:propertyMeta]; &#125; // Â¶ÇÊûú mapper ‰∏≠Â∑≤ÁªèÂ≠òÂú®ËØ• mappedToKey Ëøô‰∏™ÈîÆÂÄºÂØπÔºåÈÇ£‰πàËØ¥Êòé mappedToKey Ëøô‰∏™ keypath Â∞ÜÂØπÂ∫îÂ§ö‰∏™ model ‰∏≠ÁöÑÈîÆ„ÄÇÈÄöËøá _next Ê†áËØÜ(ÂÜôÁöÑÊØîËæÉÊãóÂè£ÔºåÂ¶ÇÊûú‰∏çÊòéÁôΩ‰πüÊ≤°ÂÖ≥Á≥ªÔºåËøô‰∏™‰∏çÊòØÈáçÁÇπ) propertyMeta-&gt;_next = mapper[mappedToKey] ?: nil; mapper[mappedToKey] = propertyMeta; &#125; &#125;&#125;// ‰øùÂ≠òÂà∞ _YYModelMeta ÁöÑ _keyPathPropertyMetas ‰∏≠if (keyPathPropertyMetas) _keyPathPropertyMetas = keyPathPropertyMetas; Model ÂØπÂ∫î JSON ‰∏≠Â§ö‰∏™ÂèØËÉΩÁöÑÂ≠óÊÆµÁöÑËÆæÁΩÆ ËøòÊòØ modelCustomPropertyMapper ‰∏≠ÂÆûÁé∞ÁöÑ„ÄÇÂ¶ÇÊûúËøîÂõûÁöÑÂ≠óÂÖ∏‰∏≠ÁöÑÂÄºÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÈÇ£‰πàËØ¥Êòé Model ‰∏≠ÁöÑÂ±ûÊÄßÂèØËÉΩÂØπÂ∫î JSON ‰∏≠Â§ö‰∏™ÂèØËÉΩÁöÑÂ≠óÊÆµÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041if ([cls respondsToSelector:@selector(modelCustomPropertyMapper)]) &#123; NSDictionary *customMapper = [(id &lt;YYModel&gt;)cls modelCustomPropertyMapper]; [customMapper enumerateKeysAndObjectsUsingBlock:^(NSString *propertyName, NSString *mappedToKey, BOOL *stop) &#123; _YYModelPropertyMeta *propertyMeta = allPropertyMetas[propertyName]; if (!propertyMeta) return; [allPropertyMetas removeObjectForKey:propertyName]; // Âà§Êñ≠ modelCustomPropertyMapper ËøîÂõûÁöÑÂ≠óÂÖ∏‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂÄºÊòØ‰∏çÊòØ‰∏Ä‰∏™Êï∞ÁªÑ if ([mappedToKey isKindOfClass:[NSArray class]]) &#123; NSMutableArray *mappedToKeyArray = [NSMutableArray new]; // Â¶ÇÊûúÊòØÊï∞ÁªÑÔºåÈÅçÂéÜÊï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏ÄÈ°π for (NSString *oneKey in ((NSArray *)mappedToKey)) &#123; if (![oneKey isKindOfClass:[NSString class]]) continue; if (oneKey.length == 0) continue; // Â¶ÇÊûúÂÖ∂‰∏≠ÂåÖÂê´ '.'ÔºåÈÇ£‰πàÂíå‰πãÂâç‰∏ÄÊ†∑ÔºåË°®Êòé Model ‰∏≠ÁöÑËøô‰∏™ÈîÆÂØπÂ∫î‰∫é JSON ‰∏≠ÁöÑ keyPaths NSArray *keyPath = [oneKey componentsSeparatedByString:@"."]; if (keyPath.count &gt; 1) &#123; [mappedToKeyArray addObject:keyPath]; &#125; else &#123; [mappedToKeyArray addObject:oneKey]; &#125; if (!propertyMeta-&gt;_mappedToKey) &#123; propertyMeta-&gt;_mappedToKey = oneKey; propertyMeta-&gt;_mappedToKeyPath = keyPath.count &gt; 1 ? keyPath : nil; &#125; &#125; if (!propertyMeta-&gt;_mappedToKey) return; propertyMeta-&gt;_mappedToKeyArray = mappedToKeyArray; // NSArray ‰∏≠Ëß£ÊûêÂ•ΩÁöÑÊØè‰∏ÄÈ°πÊ∑ªÂä†Âà∞ mutiKeysPropertyMetas ‰∏≠ [multiKeysPropertyMetas addObject:propertyMeta]; propertyMeta-&gt;_next = mapper[mappedToKey] ?: nil; mapper[mappedToKey] = propertyMeta; &#125; &#125;];&#125;// ‰øùÂ≠òÂà∞ _YYModelMeta ‰∏≠ÁöÑ _multiKeysPropertyMetas ‰∏≠if (multiKeysPropertyMetas) _multiKeysPropertyMetas = multiKeysPropertyMetas; JSON ‚Üí Model ÁöÑÂÆûÁé∞Â§ñÈÉ®Ë∞ÉÁî®ÊñπÊ≥ï‰∏äÈù¢ÊääÁî®Âà∞ÁöÑÊï∞ÊçÆÁªìÊûÑÈÉΩ‰ªãÁªç‰∫Ü‰∏ÄÈÅçÔºåÁé∞Âú®ÂºÄÂßãÊ≠£ÁúüÁöÑ JSON ‚Üí Model ÁöÑËΩ¨Êç¢„ÄÇËøôÈáåÁúÅÁï•‰∫Ü JSON ‚Üí NSDictionary ÁöÑËΩ¨Êç¢(ÈÄöËøá NSJSONSerialization ÂÆûÁé∞)„ÄÇÁõ¥Êé•Áúã NSDictionary ‚Üí Model ÁöÑÂÆûÁé∞Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253+ (instancetype)yy_modelWithDictionary:(NSDictionary *)dictionary &#123; if (!dictionary || dictionary == (id)kCFNull) return nil; if (![dictionary isKindOfClass:[NSDictionary class]]) return nil; Class cls = [self class]; // ÂàõÂª∫‰∏Ä‰∏™ÂÆû‰æã oneÔºåÁÑ∂ÂêéÈÄöËøá yy_modelSetWithDictionary ÊñπÊ≥ïÁúüÊ≠£ÁöÑÂ∞ÜÂ≠óÂÖ∏‰∏≠ÁöÑÈîÆÂÄºÂØπÂ°´ÂÖÖÂà∞ÂØπË±°‰∏≠ NSObject *one = [cls new]; if ([one yy_modelSetWithDictionary:dictionary]) return one; return nil;&#125;- (BOOL)yy_modelSetWithDictionary:(NSDictionary *)dic &#123; ... _YYModelMeta *modelMeta = [_YYModelMeta metaWithClass:object_getClass(self)]; // ‰∏ä‰∏ãÊñáÂØπË±°ÔºåÂ∞Ü Model Âíå Dictionary ÈÉΩ‰øùÂ≠òÂú®Ëøô‰∏™ÂØπË±°‰∏≠ÔºåËøôÊ†∑Â§ÑÁêÜÊñπÊ≥ïÂ∞±ÂèØ‰ª•Áõ¥Êé•ÈÄöËøáËøô‰∏™ context ÊãøÂà∞ Model Âíå Dictionary ModelSetContext context = &#123;0&#125;; context.modelMeta = (__bridge void *)(modelMeta); context.model = (__bridge void *)(self); context.dictionary = (__bridge void *)(dic); // ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåModel ‰∏≠ÁöÑÂ±ûÊÄßÂíåÂ≠óÂÖ∏‰∏≠ÁöÑÂ≠óÊÆµÊòØ‰∏Ä‰∏ÄÂØπÂ∫îÁöÑÔºå‰ΩÜÊòØÂ¶ÇÊûú Model ‰∏≠ÁöÑÂ±ûÊÄßÂ§ö‰ΩôÂ≠óÂÖ∏‰∏≠ÁöÑÂ≠óÊÆµÔºåÈÇ£‰πàËØ¥Êòé Model ‰∏≠ÁöÑÂ±ûÊÄßÂèØËÉΩÊò†Â∞Ñ‰∫ÜÂ≠óÂÖ∏‰∏≠Êüê‰∏™ÂÄº‰∏≠ÁöÑÊüê‰∏™Â≠óÊÆµÔºåÂç≥ÂØπÂ∫îÁöÑÊòØ‰∏Ä‰∏™ keyPaths if (modelMeta-&gt;_keyMappedCount &gt;= CFDictionaryGetCount((CFDictionaryRef)dic)) &#123; // Dictionary ËΩ¨ Model„ÄÇCFDictionaryApplyFunction Â∞±ÊòØÂØπ Dictionary ‰∏≠ÁöÑÊØè‰∏™ÈîÆÈÉΩÊâßË°å‰º†ÂÖ•ÁöÑÊñπÊ≥ï CFDictionaryApplyFunction((CFDictionaryRef)dic, ModelSetWithDictionaryFunction, &amp;context); // Â¶ÇÊûú Model ÂèØËÉΩÂ≠òÂú® keypaths ÁöÑÊò†Â∞ÑÔºåÈÇ£‰πàÊâßË°åÔºåÂ∞Ü keypaths ÂØπÂ∫îÁöÑÂÄº if (modelMeta-&gt;_keyPathPropertyMetas) &#123; CFArrayApplyFunction((CFArrayRef)modelMeta-&gt;_keyPathPropertyMetas, CFRangeMake(0, CFArrayGetCount((CFArrayRef)modelMeta-&gt;_keyPathPropertyMetas)), ModelSetWithPropertyMetaArrayFunction, &amp;context); &#125; if (modelMeta-&gt;_multiKeysPropertyMetas) &#123; CFArrayApplyFunction((CFArrayRef)modelMeta-&gt;_multiKeysPropertyMetas, CFRangeMake(0, CFArrayGetCount((CFArrayRef)modelMeta-&gt;_multiKeysPropertyMetas)), ModelSetWithPropertyMetaArrayFunction, &amp;context); &#125; &#125; else &#123; CFArrayApplyFunction((CFArrayRef)modelMeta-&gt;_allPropertyMetas, CFRangeMake(0, modelMeta-&gt;_keyMappedCount), ModelSetWithPropertyMetaArrayFunction, &amp;context); &#125; /// JSON ËΩ¨ model ËΩ¨Êç¢ÂÆåÊàêÂêéÔºåËá™ÂÆö‰πâÁöÑËΩ¨Êç¢ÈÉ®ÂàÜ if (modelMeta-&gt;_hasCustomTransformFromDictionary) &#123; return [((id&lt;YYModel&gt;)self) modelCustomTransformFromDictionary:dic]; &#125; return YES;&#125; ÂèØ‰ª•ÁúãÂà∞Ôºå‰∏äÈù¢ÁöÑËÆæÁΩÆËøáÁ®ã‰∏ªË¶ÅÊ∂âÂèä‰∫Ü‰∏§‰∏™ÊñπÊ≥ï„ÄÇÂÖ∂‰∏≠Á¨¨‰∏Ä‰∏™ÊòØ JSON ËΩ¨ Modal ÁöÑÊ†∏ÂøÉÔºö ModelSetWithDictionaryFunction ModelSetWithPropertyMetaArrayFunction ModelSetWithDictionaryFunctionËøô‰∏™ÊñπÊ≥ï‰º†ÂÖ•ÁöÑ‰∏â‰∏™ÂèÇÊï∞ÂàÜÂà´‰∏∫ÔºåJSON ËΩ¨ÊàêÁöÑ Dictionary ÁöÑÊØè‰∏™ÈîÆÂÄºÂØπÂíå‰º†ÂÖ•ÁöÑ‰∏ä‰∏ãÊñá„ÄÇ 1234567891011121314151617static void ModelSetWithDictionaryFunction(const void *_key, const void *_value, void *_context) &#123; ModelSetContext *context = _context; // ÈÄöËøá‰∏ä‰∏ãÊñáÊãøÂà∞ Class ÁöÑÂ∞ÅË£Ö _YYModelMeta __unsafe_unretained _YYModelMeta *meta = (__bridge _YYModelMeta *)(context-&gt;modelMeta); // ‰ªé _YYModelMeta ‰∏≠ÂèñÂá∫ key ÂØπÂ∫îÁöÑ _YYModelPropertyMeta __unsafe_unretained _YYModelPropertyMeta *propertyMeta = [meta-&gt;_mapper objectForKey:(__bridge id)(_key)]; // ‰ªé‰∏ä‰∏ãÊñá‰∏≠ÊãøÂà∞ model ÂÆû‰æã __unsafe_unretained id model = (__bridge id)(context-&gt;model); /// ÁúãÁúã key ÂØπÂ∫îÁöÑÂ±ûÊÄßÊúâÊ≤°Êúâ setter ÊñπÊ≥ïÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÈÇ£‰πàÂ∞±ÈÄöËøá next Êâæ while (propertyMeta) &#123; if (propertyMeta-&gt;_setter) &#123; // Ê†∏ÂøÉÊñπÊ≥ïÔºåÂ∞Ü value ËÆæÁΩÆÂà∞ model ‰∏≠ ModelSetValueForProperty(model, (__bridge __unsafe_unretained id)_value, propertyMeta); &#125; propertyMeta = propertyMeta-&gt;_next; &#125;;&#125; ÊúÄÊ†∏ÂøÉÁöÑÊñπÊ≥ïÂ∞±ÊòØ ModelSetValueForPropertyÔºåÁúüÊ≠£Â∞ÜÂÄºËµãÂÄºÁªô model Â∞±ÊòØÂú®Ëøô‰∏™ÊñπÊ≥ï‰∏≠„ÄÇÂÆÉÁöÑÂ§ÑÁêÜ‰ª£Á†ÅÈùûÂ∏∏ÈïøÔºåÂõ†‰∏∫ÈíàÂØπ‰∏çÂêåÁ±ªÂûãÁöÑÂ±ûÊÄßË¶ÅÂÅö‰∏çÂêåÁöÑÂ§ÑÁêÜ„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÂèØ‰ª•Â∞ÜÂ§ÑÁêÜ‰ª£Á†ÅÂàÜ‰∏∫‰∏âÁ±ªÔºö c ‰∏≠ÁöÑÊï∞Â≠óÁ±ªÂûã„ÄÇÂ¶Ç int Á≠â oc ‰∏≠ÁöÑÂØπË±°Á±ªÂûã„ÄÇÂ¶Ç NSStringÔºåNSNumber Á≠â Èô§‰ª•‰∏ä‰∏§ÁßçÁöÑÂÖ∂‰ªñÁ±ªÂûã„ÄÇÂ¶Ç block Á±ªÂûãÔºåSEL Á±ªÂûã C Á±ªÂûãËÆæÁΩÆC Á±ªÂûãÂÄºËÆæÁΩÆÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 123456if (meta-&gt;_isCNumber) &#123; // Êää Value ËΩ¨‰∏∫ NSNumber Á±ªÂûã NSNumber *num = YYNSNumberCreateFromID(value); ModelSetNumberToProperty(model, num, meta); if (num != nil) [num class]; // hold the number&#125; ÂÖàÊää Value ËΩ¨‰∏∫ NSNumber Á±ªÂûãÔºåÁÑ∂ÂêéË∞ÉÁî® ModelSetNumberToProperty ÊñπÊ≥ï„ÄÇÊëòÂèñ‰∏ÄÈÉ®ÂàÜ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011static force_inline void ModelSetNumberToProperty(__unsafe_unretained id model, __unsafe_unretained NSNumber *num, __unsafe_unretained _YYModelPropertyMeta *meta) &#123; switch (meta-&gt;_type &amp; YYEncodingTypeMask) &#123; case YYEncodingTypeBool: &#123; ((void (*)(id, SEL, bool))(void *) objc_msgSend)((id)model, meta-&gt;_setter, num.boolValue); &#125; break; ... default: break; &#125;&#125; ÂèØ‰ª•ÁúãÂà∞ÔºåÊúÄÁªàÊòØÁõ¥Êé•Ë∞ÉÁî®‰∫Ü objc_msgSend ÊâßË°å model Áõ∏Â∫îÂ±ûÊÄßÁöÑ setter ÊñπÊ≥ï„ÄÇ OC Á±ªÂûãËÆæÁΩÆ12345678910111213141516171819202122232425262728293031323334353637383940if (meta-&gt;_nsType) &#123; if (value == (id)kCFNull) &#123; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)model, meta-&gt;_setter, (id)nil); &#125; else &#123; switch (meta-&gt;_nsType) &#123; case YYEncodingTypeNSString: case YYEncodingTypeNSMutableString: &#123; if ([value isKindOfClass:[NSString class]]) &#123; if (meta-&gt;_nsType == YYEncodingTypeNSString) &#123; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)model, meta-&gt;_setter, value); &#125; else &#123; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)model, meta-&gt;_setter, ((NSString *)value).mutableCopy); &#125; &#125; else if ([value isKindOfClass:[NSNumber class]]) &#123; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)model, meta-&gt;_setter, (meta-&gt;_nsType == YYEncodingTypeNSString) ? ((NSNumber *)value).stringValue : ((NSNumber *)value).stringValue.mutableCopy); &#125; else if ([value isKindOfClass:[NSData class]]) &#123; NSMutableString *string = [[NSMutableString alloc] initWithData:value encoding:NSUTF8StringEncoding]; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)model, meta-&gt;_setter, string); &#125; else if ([value isKindOfClass:[NSURL class]]) &#123; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)model, meta-&gt;_setter, (meta-&gt;_nsType == YYEncodingTypeNSString) ? ((NSURL *)value).absoluteString : ((NSURL *)value).absoluteString.mutableCopy); &#125; else if ([value isKindOfClass:[NSAttributedString class]]) &#123; ((void (*)(id, SEL, id))(void *) objc_msgSend)((id)model, meta-&gt;_setter, (meta-&gt;_nsType == YYEncodingTypeNSString) ? ((NSAttributedString *)value).string : ((NSAttributedString *)value).string.mutableCopy); &#125; &#125; break; ... &#125; &#125;&#125; ËøôÈáåÊà™ÂèñÁöÑ‰ª£Á†ÅÊúâÁÇπÈïø„ÄÇ‰∏çËøáÂ∑≤ÁªèÊòØÁ≤æÁÆÄ‰∫ÜÂæàÂ§öÁöÑÁä∂ÊÄÅ‰∫Ü„ÄÇÊÄª‰ΩìËÄåË®ÄËøòÊòØÂà§Êñ≠Â±ûÊÄßÁöÑÁ±ªÂûãÔºåÁÑ∂ÂêéË∞ÉÁî®Áõ∏Â∫îÁöÑ objc_msgSend ÊñπÊ≥ï„ÄÇ Model ‚Üí JSONObject ÁöÑÂÆûÁé∞Model Âà∞ JSONObject ÁöÑËΩ¨Êç¢‰πüÂ∞±ÊòØ Model Âà∞Êï∞ÁªÑÊàñËÄÖÂ≠óÂÖ∏ËøôÁßçÊ®°ÂûãÁöÑËΩ¨Êç¢ÔºåÊ†∏ÂøÉÊñπÊ≥ïÂú®ÈÄíÂΩíÊñπÊ≥ï ModelToJSONObjectRecursive „ÄÇ 12345678- (id)yy_modelToJSONObject &#123; // ÈÄíÂΩíËΩ¨Êç¢Ê®°ÂûãÂà∞ JSON id jsonObject = ModelToJSONObjectRecursive(self); if ([jsonObject isKindOfClass:[NSArray class]]) return jsonObject; if ([jsonObject isKindOfClass:[NSDictionary class]]) return jsonObject; return nil;&#125; ÂÖ∑‰ΩìÁöÑËΩ¨Êç¢‰ª£Á†ÅÈùûÂ∏∏Èïø„ÄÇÂÅö‰∫ÜÊ≥®ÈáäÂêéËøòÊòØË¥¥‰∏äÊù•‰∫ÜÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141// ÈÄíÂΩíËΩ¨Êç¢Ê®°ÂûãÂà∞ JSONÔºåÂ¶ÇÊûúËΩ¨Êç¢ÂºÇÂ∏∏ÂàôËøîÂõû nilstatic id ModelToJSONObjectRecursive(NSObject *model) &#123; // Âà§Á©∫ÊàñËÄÖÂèØ‰ª•Áõ¥Êé•ËøîÂõûÁöÑÂØπË±°ÔºåÂàôÁõ¥Êé•ËøîÂõû if (!model || model == (id)kCFNull) return model; if ([model isKindOfClass:[NSString class]]) return model; if ([model isKindOfClass:[NSNumber class]]) return model; // Â¶ÇÊûú model ‰ªéÂ±û‰∫é NSDictionary if ([model isKindOfClass:[NSDictionary class]]) &#123; // Â¶ÇÊûúÂèØ‰ª•Áõ¥Êé•ËΩ¨Êç¢‰∏∫ JSON Êï∞ÊçÆÔºåÂàôËøîÂõû if ([NSJSONSerialization isValidJSONObject:model]) return model; NSMutableDictionary *newDic = [NSMutableDictionary new]; // ÈÅçÂéÜ model ÁöÑ key Âíå value [((NSDictionary *)model) enumerateKeysAndObjectsUsingBlock:^(NSString *key, id obj, BOOL *stop) &#123; NSString *stringKey = [key isKindOfClass:[NSString class]] ? key : key.description; if (!stringKey) return; // ÈÄíÂΩíËß£Êûê value id jsonObj = ModelToJSONObjectRecursive(obj); if (!jsonObj) jsonObj = (id)kCFNull; newDic[stringKey] = jsonObj; &#125;]; return newDic; &#125; // Â¶ÇÊûú model ‰ªéÂ±û‰∫é NSSet if ([model isKindOfClass:[NSSet class]]) &#123; // Â¶ÇÊûúËÉΩÂ§üÁõ¥Êé•ËΩ¨Êç¢ JSON ÂØπË±°ÔºåÂàôÁõ¥Êé•ËøîÂõû // Âê¶ÂàôÈÅçÂéÜÔºåÊåâÈúÄË¶ÅÈÄíÂΩíËß£Êûê ... &#125; if ([model isKindOfClass:[NSArray class]]) &#123; // Â¶ÇÊûúËÉΩÂ§üÁõ¥Êé•ËΩ¨Êç¢ JSON ÂØπË±°ÔºåÂàôÁõ¥Êé•ËøîÂõû // Âê¶ÂàôÈÅçÂéÜÔºåÊåâÈúÄË¶ÅÈÄíÂΩíËß£Êûê ... &#125; // ÂØπ NSURL, NSAttributedString, NSDate, NSData ÂÅöÁõ∏Â∫îÂ§ÑÁêÜ if ([model isKindOfClass:[NSURL class]]) return ((NSURL *)model).absoluteString; if ([model isKindOfClass:[NSAttributedString class]]) return ((NSAttributedString *)model).string; if ([model isKindOfClass:[NSDate class]]) return [YYISODateFormatter() stringFromDate:(id)model]; if ([model isKindOfClass:[NSData class]]) return nil; // Áî® [model class] ÂàùÂßãÂåñ‰∏Ä‰∏™Ê®°ÂûãÂÖÉ _YYModelMeta *modelMeta = [_YYModelMeta metaWithClass:[model class]]; // Â¶ÇÊûúÊò†Â∞ÑË°®‰∏∫Á©∫ÔºåÂàô‰∏çÂÅöËß£ÊûêÁõ¥Êé•ËøîÂõû nil if (!modelMeta || modelMeta-&gt;_keyMappedCount == 0) return nil; // ÊÄßËÉΩ‰ºòÂåñÁªÜËäÇÔºå‰ΩøÁî® __unsafe_unretained Êù•ÈÅøÂÖçÂú®‰∏ãÈù¢ÈÅçÂéÜ block ‰∏≠Áõ¥Êé•‰ΩøÁî® result ÊåáÈíàÈÄ†ÊàêÁöÑ‰∏çÂøÖË¶Å retain ‰∏é release ÂºÄÈîÄ NSMutableDictionary *result = [[NSMutableDictionary alloc] initWithCapacity:64]; __unsafe_unretained NSMutableDictionary *dic = result; // ÈÅçÂéÜÊ®°ÂûãÂÖÉÂ±ûÊÄßÊò†Â∞ÑÂ≠óÂÖ∏ [modelMeta-&gt;_mapper enumerateKeysAndObjectsUsingBlock:^(NSString *propertyMappedKey, _YYModelPropertyMeta *propertyMeta, BOOL *stop) &#123; // Â¶ÇÊûúÈÅçÂéÜÂΩìÂâçÂ±ûÊÄßÂÖÉÊ≤°Êúâ getter ÊñπÊ≥ïÔºåË∑≥Ëøá if (!propertyMeta-&gt;_getter) return; id value = nil; // Â¶ÇÊûúÂ±ûÊÄßÂÖÉÂ±û‰∫é CNumberÔºåÂç≥ÂÖ∂ type ÊòØ int„ÄÅfloat„ÄÅdouble ‰πãÁ±ªÁöÑ if (propertyMeta-&gt;_isCNumber) &#123; // ‰ªéÂ±ûÊÄß‰∏≠Âà©Áî® getter ÊñπÊ≥ïÂæóÂà∞ÂØπÂ∫îÁöÑÂÄº value = ModelCreateNumberFromProperty(model, propertyMeta); &#125; else if (propertyMeta-&gt;_nsType) &#123; // Â±ûÊÄßÂÖÉÂ±û‰∫é nsTypeÔºåÂç≥ NSString ‰πãÁ±ª // Âà©Áî® getter ÊñπÊ≥ïÊãøÂà∞ value id v = ((id (*)(id, SEL))(void *) objc_msgSend)((id)model, propertyMeta-&gt;_getter); // ÂØπÊãøÂà∞ÁöÑ value ÈÄíÂΩíËß£Êûê value = ModelToJSONObjectRecursive(v); &#125; else &#123; // Ê†πÊçÆÂ±ûÊÄßÂÖÉÁöÑ type ÂÅöÁõ∏Â∫îÂ§ÑÁêÜ switch (propertyMeta-&gt;_type &amp; YYEncodingTypeMask) &#123; // idÔºåÈúÄË¶ÅÈÄíÂΩíËß£ÊûêÔºåÂ¶ÇÊûúËß£ÊûêÂ§±Ë¥•ÂàôËøîÂõû nil case YYEncodingTypeObject: &#123; id v = ((id (*)(id, SEL))(void *) objc_msgSend)((id)model, propertyMeta-&gt;_getter); value = ModelToJSONObjectRecursive(v); if (value == (id)kCFNull) value = nil; &#125; break; // ClassÔºåËΩ¨ NSStringÔºåËøîÂõû Class ÂêçÁß∞ case YYEncodingTypeClass: &#123; Class v = ((Class (*)(id, SEL))(void *) objc_msgSend)((id)model, propertyMeta-&gt;_getter); value = v ? NSStringFromClass(v) : nil; &#125; break; // SELÔºåËΩ¨ NSStringÔºåËøîÂõûÁªôÂÆö SEL ÁöÑÂ≠óÁ¨¶‰∏≤Ë°®Áé∞ÂΩ¢Âºè case YYEncodingTypeSEL: &#123; SEL v = ((SEL (*)(id, SEL))(void *) objc_msgSend)((id)model, propertyMeta-&gt;_getter); value = v ? NSStringFromSelector(v) : nil; &#125; break; default: break; &#125; &#125; // Â¶ÇÊûú value ËøòÊòØÊ≤°ËÉΩËß£ÊûêÔºåÂàôË∑≥Ëøá if (!value) return; // ÂΩìÂâçÂ±ûÊÄßÂÖÉÊòØ KeyPath Êò†Â∞ÑÔºåÂç≥ a.b.c ‰πãÁ±ª if (propertyMeta-&gt;_mappedToKeyPath) &#123; NSMutableDictionary *superDic = dic; NSMutableDictionary *subDic = nil; // _mappedToKeyPath ÊòØ a.b.c Ê†πÊçÆ '.' ÊãÜÂàÜÊàêÁöÑÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑÔºåÈÅçÂéÜ _mappedToKeyPath for (NSUInteger i = 0, max = propertyMeta-&gt;_mappedToKeyPath.count; i &lt; max; i++) &#123; NSString *key = propertyMeta-&gt;_mappedToKeyPath[i]; // ÈÅçÂéÜÂà∞ÁªìÂ∞æ if (i + 1 == max) &#123; // Â¶ÇÊûúÁªìÂ∞æÁöÑ key ‰∏∫ nilÔºåÂàô‰ΩøÁî® value ËµãÂÄº if (!superDic[key]) superDic[key] = value; break; &#125; // Áî® subDic ÊãøÂà∞ÂΩìÂâç key ÂØπÂ∫îÁöÑÂÄº subDic = superDic[key]; // Â¶ÇÊûú subDic Â≠òÂú® if (subDic) &#123; // Â¶ÇÊûú subDic ‰ªéÂ±û‰∫é NSDictionary if ([subDic isKindOfClass:[NSDictionary class]]) &#123; // Â∞Ü subDic ÁöÑ mutable ÁâàÊú¨ËµãÂÄºÁªô superDic[key] subDic = subDic.mutableCopy; superDic[key] = subDic; &#125; else &#123; break; &#125; &#125; else &#123; // Â∞Ü NSMutableDictionary ËµãÂÄºÁªô superDic[key] // Ê≥®ÊÑèËøôÈáå‰ΩøÁî® subDic Èó¥Êé•ËµãÂÄºÊòØÊúâÂéüÂõ†ÁöÑÔºåÂéüÂõ†Â∞±Âú®‰∏ãÈù¢ subDic = [NSMutableDictionary new]; superDic[key] = subDic; &#125; // superDic ÊåáÂêë subDicÔºåËøôÊ†∑Âú®ÈÅçÂéÜ _mappedToKeyPath Êó∂Âç≥ÂèØÈÄêÂ±ÇËß£Êûê // ËøôÂ∞±ÊòØ‰∏äÈù¢ÂÖàÊää subDic ËΩ¨‰∏∫ NSMutableDictionary ÁöÑÂéüÂõ† superDic = subDic; subDic = nil; &#125; &#125; else &#123; // Â¶ÇÊûú‰∏çÊòØ KeyPath ÂàôÊ£ÄÊµã dic[propertyMeta-&gt;_mappedToKey]ÔºåÂ¶ÇÊûú‰∏∫ nil ÂàôËµãÂÄº value if (!dic[propertyMeta-&gt;_mappedToKey]) &#123; dic[propertyMeta-&gt;_mappedToKey] = value; &#125; &#125; &#125;]; // ÂøΩÁï•ÔºåÂØπÂ∫î modelCustomTransformToDictionary Êé•Âè£ if (modelMeta-&gt;_hasCustomTransformToDictionary) &#123; // Áî®‰∫éÂú®ÈªòËÆ§ÁöÑ Model ËΩ¨ JSON ËøáÁ®ã‰∏çÈÄÇÂêàÂΩìÂâç Model Á±ªÂûãÊó∂Êèê‰æõËá™ÂÆö‰πâÈ¢ùÂ§ñËøáÁ®ã // ‰πüÂèØ‰ª•Áî®Ëøô‰∏™ÊñπÊ≥ïÊù•È™åËØÅËΩ¨Êç¢ÁªìÊûú BOOL suc = [((id&lt;YYModel&gt;)model) modelCustomTransformToDictionary:dic]; if (!suc) return nil; &#125; return result;&#125; ÊÄªÁöÑÊù•ËØ¥ÔºåËøòÊòØÂà§Êñ≠‰º†ÂÖ•ÁöÑ Model ÁöÑÁ±ªÂûãÔºåÂ¶ÇÊûúÊòØ NSString ËøôÁßçÂü∫Êú¨Á±ªÂûãÔºåÈÇ£‰πàÂ∞±Áõ¥Êé•ËøîÂõû‰∫Ü„ÄÇÂ¶ÇÊûúÊòØ class Á±ªÂûãÔºåÈÇ£‰πàÂ∞±ÁîüÊàê class ÂØπÂ∫îÁöÑ _YYModelMeta ÂØπË±°ÔºåÁÑ∂ÂêéÈÅçÂéÜÂÖ∂‰∏≠ÁöÑÊâÄÊúâÂ±ûÊÄßÔºåÂ∞ÜÂÖ∂ËµãÂÄºÁªô result Ëøô‰∏™Â≠óÂÖ∏‰∏≠„ÄÇ ‰∏Ä‰∫õÁÇπËÆæÂÄº‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÈÉΩ‰ºöËÆ§‰∏∫Â≠óÂÖ∏Ê®°ÂûãËΩ¨Êç¢ÈÉΩÊòØ‰ΩøÁî® KVC ÁöÑÊñπÂºè„ÄÇÁÑ∂ÈπÖ YYModel Âπ∂‰∏çÊòØ‰ΩøÁî® KVCÔºåËÄåÊòØÈÄöËøá objc_msgSend Ë∞ÉÁî® Model ‰∏≠ property ÁöÑ setter ÊñπÊ≥ï„ÄÇËøôÊ†∑ÈÄüÂ∫¶‰∏äÊõ¥Âø´„ÄÇ ÂÜÖÂ≠ò‰ºòÂåñ__unsafe_unretained Âú®‰ΩúÁî®‰∏äÂíå __weak Á±ª‰ººÔºå‰ΩÜÊòØ __unsafe_unretained ‰ºöÊõ¥ÊòìÈÄ†ÊàêÈáéÊåáÈíà„ÄÇ ËÆøÈóÆÂÖ∑Êúâ __weak Â±ûÊÄßÁöÑÂèòÈáèÊó∂ÔºåÂÆûÈôÖ‰∏ä‰ºöË∞ÉÁî® objc_loadWeak() Âíå objc_storeWeak() Êù•ÂÆåÊàêÔºåËøô‰πü‰ºöÂ∏¶Êù•ÂæàÂ§ßÁöÑÂºÄÈîÄÔºåÊâÄ‰ª•Â¶ÇÊûú‰Ω†ËÉΩÁ°ÆÂÆöÂú®ËØ•ÂèòÈáèÁöÑ‰ΩøÁî®ËøáÁ®ã‰∏≠Ôºå‰∏ç‰ºöË¢´ÂõûÊî∂ÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî® __unsafe_unretained Êõø‰ª£ __weak „ÄÇ ‰ΩøÁî® c ÂáΩÊï∞YYModel ‰∏≠‰ΩøÁî®‰∫ÜÂ§ßÈáèÁöÑ c ÂáΩÊï∞„ÄÇ‰ΩøÁî®Á∫Ø C ÂáΩÊï∞ÂèØ‰ª•ÈÅøÂÖç ObjC ÁöÑÊ∂àÊÅØÂèëÈÄÅÂ∏¶Êù•ÁöÑÂºÄÈîÄ„ÄÇ ‰ΩøÁî®ÂÜÖËÅîÂáΩÊï∞ÂÜÖËÅîÂáΩÊï∞Áî® inline Ê†áËÆ∞„ÄÇÁºñËØëÊó∂ÔºåÁ±ª‰ººÂÆèÊõøÊç¢Ôºå‰ΩøÁî®ÂáΩÊï∞‰ΩìÊõøÊç¢Ë∞ÉÁî®Â§ÑÁöÑÂáΩÊï∞Âêç„ÄÇ ‰ºòÂäøÊòØÂÜÖËÅîÂáèÂ∞ë‰∫ÜÂáΩÊï∞Ë∞ÉÁî®ÁöÑÂºÄÈîÄÔºåÂú®Ë∞ÉÁî®Êó∂‰∏çÂèëÁîüÊéßÂà∂ËΩ¨Áßª„ÄÇÂä£ÂäøÊòØÂ¶ÇÊûúË∞ÉÁî®Ê¨°Êï∞ÂæàÂ§öÊó∂Ôºå‰∏ÄËà¨‰ºöÂ¢ûÂä†‰∫Ü‰ª£Á†ÅÈáè„ÄÇ ÂÜÖËÅîÂáΩÊï∞ÂíåÂÆèÂÆö‰πâÁõ∏ÊØîÂ∑ÆÂà´Âú®‰∫éÔºö ÁºñËØëÈò∂ÊÆµÔºöÂÆèÂÆö‰πâ‰ΩøÁî®È¢ÑÂ§ÑÁêÜÂô®preprocessorÂÆûÁé∞ÔºåÂè™ÊòØÈ¢ÑÂ§ÑÁêÜÁ¨¶Âè∑Ë°®ÁöÑÁÆÄÂçïÊõøÊç¢„ÄÇÂÜÖËÅîÂáΩÊï∞ÂàôÂú®ÁºñËØëÈò∂ÊÆµËøõË°åÊõøÊç¢Ôºå‰ºöÊúâÁ±ªÂûãÊ£ÄÊü•ÂíåÂèÇÊï∞ÊúâÊïàÊÄßÁöÑÊ£ÄÊµã„ÄÇ ÂÆâÂÖ®ÊÄßÔºöÂÜÖËÅîÂáΩÊï∞ÂÖ∑ÊúâÁ±ªÂûãÊ£ÄÊü•‰∏éÂèÇÊï∞ÊúâÊïàÊÄßÁöÑÈ™åËØÅÔºåËÄåÂÆèÊ≤°ÊúâÔºõ ÊÄªÁªìÊÄªÁöÑÊù•ËØ¥ÔºåYYModel ‰∏∫‰∫ÜÊïàÁéá‰ΩøÁî®‰∫ÜÂæàÂ§ö c ÂáΩÊï∞ÔºåÂÖ∂ÂÆûÂú®Êó•Â∏∏ÁöÑÁºñÁ®ã‰∏≠ÊòØ‰∏çÂ§™ËÉΩÁî®Âà∞ÁöÑ(ÊàñËÄÖËØ¥Ôºå‰Ω†Ë¶ÅËøô‰πàÂÜôÊòØ‰ºöË¢´È™ÇÁöÑ)Ôºå‰ΩÜÊ≠£ÊòØËøô‰∫õÊõ¥Â∫ïÂ±Ç‰∏çÂ∏∏Áî®ÁöÑÂáΩÊï∞‰Ωø YYModel Êàê‰∏∫‰∫Ü‰∏Ä‰∏™È´òÊïàÁöÑ JSON Model ËΩ¨Êç¢Â∫ì„ÄÇ ÂèÇËÄÉÊè≠Áßò YYModel ÁöÑÈ≠îÊ≥ï Ëß£Á†ÅYYModelÔºà‰∏ÄÔºâÂü∫Á°Ä YYModel]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[YYAsyncLayer Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2019%2F02%2F15%2Fyyasynclayer%2F</url>
    <content type="text"><![CDATA[ËøôÁØáÊòØÁªß YYCache ÂêéÁöÑ YYKit Ê∫êÁ†ÅËß£Êûê„ÄÇYYAsyncLayer ÂèàÊòØ‰∏Ä‰∏™Áü≠Â∞èÂç¥Ë¥®ÈáèÂ•áÈ´òÁöÑËΩÆÂ≠ê„ÄÇÈùûÂ∏∏ÈÄÇÂêàÂ≠¶‰π†ÂíåÂÄüÈâ¥„ÄÇ ‰ΩøÁî®YYAsyncLayer ÂèØ‰ª•Êèê‰æõ‰∏Ä‰∏™ÁªòÂà∂Ëá™ÂÆö‰πâ CALayer ÁöÑËá™ÂÆö‰πâ UIView ÁªÑ‰ª∂„ÄÇ‰ΩøÁî®ÊñπÂºèÂú®ÂÖ∂ Github‰∏äÊúâÂÆåÊï¥ÁöÑ‰ΩìÁé∞Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768@interface YYLabel : UIView@property NSString *text;@property UIFont *font;@end@implementation YYLabel- (void)setText:(NSString *)text &#123; _text = text.copy; [[YYTransaction transactionWithTarget:self selector:@selector(contentsNeedUpdated)] commit];&#125;- (void)setFont:(UIFont *)font &#123; _font = font; [[YYTransaction transactionWithTarget:self selector:@selector(contentsNeedUpdated)] commit];&#125;- (void)layoutSubviews &#123; [super layoutSubviews]; [[YYTransaction transactionWithTarget:self selector:@selector(contentsNeedUpdated)] commit];&#125;- (void)contentsNeedUpdated &#123; // do update [self.layer setNeedsDisplay];&#125;#pragma mark - YYAsyncLayer+ (Class)layerClass &#123; return YYAsyncLayer.class;&#125;- (YYAsyncLayerDisplayTask *)newAsyncDisplayTask &#123; // capture current state to display task NSString *text = _text; UIFont *font = _font; YYAsyncLayerDisplayTask *task = [YYAsyncLayerDisplayTask new]; task.willDisplay = ^(CALayer *layer) &#123; //... &#125;; task.display = ^(CGContextRef context, CGSize size, BOOL(^isCancelled)(void)) &#123; if (isCancelled()) return; NSArray *lines = CreateCTLines(text, font, size.width); if (isCancelled()) return; for (int i = 0; i &lt; lines.count; i++) &#123; CTLineRef line = line[i]; CGContextSetTextPosition(context, 0, i * font.pointSize * 1.5); CTLineDraw(line, context); if (isCancelled()) return; &#125; &#125;; task.didDisplay = ^(CALayer *layer, BOOL finished) &#123; if (finished) &#123; // finished &#125; else &#123; // cancelled &#125; &#125;; return task;&#125;@end ÊÄªÁöÑÊù•ËØ¥ÈúÄË¶Å‰ª•‰∏ãÂá†ÁÇπÔºö Ëá™ÂÆö‰πâÁöÑ UIView ÂÆûÁé∞ YYAsyncLayerDelegate ÂçèËÆÆ„ÄÇ ÈáçÂÜôËá™ÂÆö‰πâ UIView ‰ºöÂºïËµ∑ËßÜÂõæÊõ¥Êñ∞ÁöÑÊñπÊ≥ïÔºåÂú®ÂÖ∂‰∏≠ÊâãÂä®Ë∞ÉÁî® YYTransaction ÁöÑÊñπÊ≥ïÔºåÊâãÂä®ËÆæÁΩÆ layer setNeedsDisplay„ÄÇ ÈáçÂÜô UIView ÁöÑ layerClass ÊñπÊ≥ïÔºåËøîÂõû YYAsyncLayer Á±ªÂûã„ÄÇ ÂÆûÁé∞ YYAsyncLayerDelegate ÂçèËÆÆ require ÁöÑÊñπÊ≥ï newAsyncDisplayTaskÔºåÂú®ÂÖ∂‰∏≠ÂàõÂª∫‰∏Ä‰∏™ YYAsyncLayerDisplayTask ÂÆû‰æã„ÄÇÊèê‰æõ‰∏â‰∏™ blockÔºöwillDisplayÔºådisplayÔºådidDisplay„ÄÇÂú® display ‰∏≠ÈÄöËøá Core Graphic ÁªòÂõæ„ÄÇ Â¶Ç‰ΩïÂÆûÁé∞ÁïåÈù¢ÊµÅÁïÖ‰∏∫‰Ωï‰∫ßÁîüÂç°È°øËÆ°ÁÆóÊú∫Á≥ªÁªü‰∏≠ CPU„ÄÅGPU„ÄÅÊòæÁ§∫Âô®ÊòØ‰ª•‰∏äÈù¢ËøôÁßçÊñπÂºèÂçèÂêåÂ∑•‰ΩúÁöÑ„ÄÇCPU ËÆ°ÁÆóÂ•ΩÊòæÁ§∫ÂÜÖÂÆπÊèê‰∫§Âà∞ GPUÔºåGPU Ê∏≤ÊüìÂÆåÊàêÂêéÂ∞ÜÊ∏≤ÊüìÁªìÊûúÊîæÂÖ•Â∏ßÁºìÂÜ≤Âå∫ÔºåÈöèÂêéËßÜÈ¢ëÊéßÂà∂Âô®‰ºöÊåâÁÖß VSync ‰ø°Âè∑ÈÄêË°åËØªÂèñÂ∏ßÁºìÂÜ≤Âå∫ÁöÑÊï∞ÊçÆÔºåÁªèËøáÂèØËÉΩÁöÑÊï∞Ê®°ËΩ¨Êç¢‰º†ÈÄíÁªôÊòæÁ§∫Âô®ÊòæÁ§∫„ÄÇ Âú® VSync ‰ø°Âè∑Âà∞Êù•ÂêéÔºåÁ≥ªÁªüÂõæÂΩ¢ÊúçÂä°‰ºöÈÄöËøá CADisplayLink Á≠âÊú∫Âà∂ÈÄöÁü• AppÔºåApp ‰∏ªÁ∫øÁ®ãÂºÄÂßãÂú® CPU ‰∏≠ËÆ°ÁÆóÊòæÁ§∫ÂÜÖÂÆπÔºåÊØîÂ¶ÇËßÜÂõæÁöÑÂàõÂª∫„ÄÅÂ∏ÉÂ±ÄËÆ°ÁÆó„ÄÅÂõæÁâáËß£Á†Å„ÄÅÊñáÊú¨ÁªòÂà∂Á≠â„ÄÇÈöèÂêé CPU ‰ºöÂ∞ÜËÆ°ÁÆóÂ•ΩÁöÑÂÜÖÂÆπÊèê‰∫§Âà∞ GPU ÂéªÔºåÁî± GPU ËøõË°åÂèòÊç¢„ÄÅÂêàÊàê„ÄÅÊ∏≤Êüì„ÄÇÈöèÂêé GPU ‰ºöÊääÊ∏≤ÊüìÁªìÊûúÊèê‰∫§Âà∞Â∏ßÁºìÂÜ≤Âå∫ÂéªÔºåÁ≠âÂæÖ‰∏ã‰∏ÄÊ¨° VSync ‰ø°Âè∑Âà∞Êù•Êó∂ÊòæÁ§∫Âà∞Â±èÂπï‰∏ä„ÄÇÁî±‰∫éÂûÇÁõ¥ÂêåÊ≠•ÁöÑÊú∫Âà∂ÔºåÂ¶ÇÊûúÂú®‰∏Ä‰∏™ VSync Êó∂Èó¥ÂÜÖÔºåCPU ÊàñËÄÖ GPU Ê≤°ÊúâÂÆåÊàêÂÜÖÂÆπÊèê‰∫§ÔºåÂàôÈÇ£‰∏ÄÂ∏ßÂ∞±‰ºöË¢´‰∏¢ÂºÉÔºåÁ≠âÂæÖ‰∏ã‰∏ÄÊ¨°Êú∫‰ºöÂÜçÊòæÁ§∫ÔºåËÄåËøôÊó∂ÊòæÁ§∫Â±è‰ºö‰øùÁïô‰πãÂâçÁöÑÂÜÖÂÆπ‰∏çÂèò„ÄÇËøôÂ∞±ÊòØÁïåÈù¢Âç°È°øÁöÑÂéüÂõ†„ÄÇ Âõ†Ê≠§ÔºåË¶ÅËß£ÂÜ≥Âç°È°øÈóÆÈ¢òÔºåÂ∞±Ë¶Å‰ªé CPU Âíå GPU ‰∏§‰∏™ËßíÂ∫¶ÂÆåÊàê„ÄÇ CPU ËµÑÊ∫êÊ∂àËÄóÂéüÂõ†ÂØπË±°ÁöÑÂàõÂª∫‰∏éÈîÄÊØÅÂØπË±°ÁöÑÂàõÂª∫‰∫éÈîÄÊØÅ‰ºöÊ∂àËÄó CPU ËµÑÊ∫ê„ÄÇÊàë‰ª¨ÂèØ‰ª•Ôºö Êé®ËøüÂàõÂª∫Ôºå‰ª•ÂèäÂºÇÊ≠•ÂàõÂª∫ÂíåÈîÄÊØÅÂØπË±° Â§çÁî®ÂØπË±° ‰ΩøÁî® CALayer ‰ª£Êõø UIView ÂÖ≥‰∫éÂØπË±°ÁöÑÂºÇÊ≠•ÈîÄÊØÅÔºåibireme Êèê‰æõ‰∫Ü‰∏ÄÁßçÊñπÂºèÔºåÊääÂØπË±°ÊçïËé∑Âà∞ block ‰∏≠ÔºåÁÑ∂ÂêéÊâîÂà∞ÂêéÂè∞ÈòüÂàóÂéªÈöè‰æøÂèëÈÄÅ‰∏™Ê∂àÊÅØ‰ª•ÈÅøÂÖçÁºñËØëÂô®Ë≠¶ÂëäÔºåÂ∞±ÂèØ‰ª•ËÆ©ÂØπË±°Âú®ÂêéÂè∞Á∫øÁ®ãÈîÄÊØÅÔºö 12345NSArray *tmp = self.array;self.array = nil;dispatch_async(queue, ^&#123; [tmp class];&#125;); Â∏ÉÂ±ÄËÆ°ÁÆó‰∏é AutoLayoutÈ¢ëÁπÅÁöÑÊâãÂä®Â∏ÉÂ±ÄËÆ°ÁÆó‰πü‰ºöÂç†Áî® CPU ÁöÑËµÑÊ∫ê„ÄÇÂõ†Ê≠§ÔºåÊØîÂ¶Ç tableviewÔºåÂ∞±ÈºìÂä±ÁºìÂ≠ò cell ÁöÑÈ´òÂ∫¶„ÄÇ AutoLayout Âú® iOS12 ÂâçÊïàÁéáÊØîËæÉ‰ΩéÔºå‰∏çËøáÂú® iOS 12ÂêéÂ∑≤ÁªèËøõË°å‰∫ÜÁÆóÊ≥ïÁöÑ‰ºòÂåñÔºåÂíåÁõ¥Êé•ËÆæÁΩÆ frame Â∑ÆË∑ù‰∏çÂ§ß„ÄÇ ÊñáÊú¨Ê∏≤ÊüìÂ∏∏Áî®Êéß‰ª∂ÁöÑÊñáÊú¨Ê∏≤ÊüìÈÉΩÊòØÈÄöËøá CoreText Âú®‰∏ªÁ∫øÁ®ãÁªòÂà∂ Bitmap ËøõË°åÁöÑ„ÄÇÂõ†Ê≠§Ôºå ÂèØ‰ª•ÈÄöËøáËá™ÂÆö‰πâÊéß‰ª∂Ôºå‰ΩøÁî® TextKit ÊàñËÄÖ CoreText ÂºÇÊ≠•Ê∏≤Êüì ÂõæÁâáËß£Á†ÅÂõæÁâáÂú®Êèê‰∫§Âà∞ GPU ‰πãÂâçÊâç‰ºöË¢´Ëß£Á†ÅÔºåÂπ∂‰∏îÊòØ‰∏ªÁ∫øÁ®ã‰∏≠„ÄÇÂõ†Ê≠§ÔºåÂèØ‰ª•ÂêéÂè∞Á∫øÁ®ãÊääÂõæÁâáÁªòÂà∂Âà∞ CGBitmapContext ‰∏≠ÔºåÁÑ∂ÂêéÈÄöËøá Bitmap ÂàõÂª∫ÂõæÁâá„ÄÇ ÂõæÂÉèÁöÑÁªòÂà∂Áî±‰∫é CoreGraphic ÊñπÊ≥ïÈÄöÂ∏∏ÈÉΩÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºåÊâÄ‰ª•ÂõæÂÉèÁöÑÁªòÂà∂ÂèØ‰ª•ÂæàÂÆπÊòìÁöÑÊîæÂà∞ÂêéÂè∞Á∫øÁ®ãËøõË°å„ÄÇ 1234567891011- (void)display &#123; dispatch_async(backgroundQueue, ^&#123; CGContextRef ctx = CGBitmapContextCreate(...); // draw in context... CGImageRef img = CGBitmapContextCreateImage(ctx); CFRelease(ctx); dispatch_async(mainQueue, ^&#123; layer.contents = img; &#125;); &#125;);&#125; Êúâ‰∏ÄÁØá „ÄäÂÜÖÂ≠òÊÅ∂È¨ºdrawRect„Äã ÁöÑÊñáÁ´†ÔºåËÆ≤Ëø∞‰∫Ü drawRect ‰ºöÂú®ÈáçÂ§çÂàõÂª∫ Bitmap Âπ∂‰∏îÊ≤°ÊúâÂèäÊó∂ÈáäÊîæÁöÑÊó∂ÂÄô‰ºöÊ∂àËÄóÂ§ßÈáèÁöÑÂÜÖÂ≠ò„ÄÇ ‰∏çËøáËøôÊòØÈíàÂØπÂ§ßËåÉÂõ¥ÁöÑÁªòÂõæÁöÑÊÉÖÂÜµÔºåÈÄöËøá CAShapLayer Áü¢ÈáèÂõæÁöÑÊñπÂºèËÄå‰∏çÊòØ Bitmap ÊúâÂä©‰∫éÁºìËß£ÂÜÖÂ≠òÂéãÂäõ GPU ËµÑÊ∫êÊ∂àËÄóÂéüÂõ†ËßÜÂõæÊ∑∑ÂêàÂ§ö‰∏™ËßÜÂõæÈáçÂè†Âú®‰∏ÄËµ∑ÁöÑÊó∂ÂÄôÈúÄË¶Å GPU Êää‰ªñ‰ª¨Ê∑∑ÂêàÂú®‰∏ÄËµ∑„ÄÇÂèØ‰ª•ÈÄÇÂΩìÂáèÂ∞ëËßÜÂõæÊï∞Èáè‰ª•ÂèäÂ±ÇÁ∫ß„ÄÇÂπ∂‰∏îÈÅøÂÖç‰ΩøÁî®Â≠òÂú®ÈÄèÊòéÂ∫¶ÁöÑËßÜÂõæ„ÄÇÂêåÊó∂ÂèØ‰ª•È¢ÑÂÖàÂ∞ÜÂ§ö‰∏™ËßÜÂõæÊ∏≤Êüì‰∏∫‰∏Ä‰∏™ÂõæÁâáÊòæÁ§∫„ÄÇ ÂõæÂÉèÁöÑÂêàÊàêÈÅøÂÖçÁ¶ªÂ±èÊ∏≤Êüì ÂÆûÁé∞ÁªìÊûÑYYAsyncLayer ÁöÑÁªìÊûÑÈùûÂ∏∏ÁÆÄÂçï„ÄÇÂè™Êúâ‰∏â‰∏™Á±ªÊñá‰ª∂Ôºö YYAsyncLayer YYSentinel YYTransaction YYAsyncLayer ÁªßÊâø‰∫é CALayerÔºåÂú®ÂÜÖÈÉ®ÈáçÂÜô‰∫Ü display ÊñπÊ≥ïÔºåÁî®Êù•ÂºÇÊ≠•ÁªòÂà∂„ÄÇ YYSentinel ÊòØ‰∏Ä‰∏™Ëá™Â¢ûÁöÑËÆ°Êï∞Á±ª„ÄÇÊØèÊ¨°Âç≥Â∞ÜÊ∏≤ÊüìÁöÑÊó∂ÂÄôÈÉΩ‰ºöÈÄíÂ¢ûÔºåÂπ∂ËÆ∞ÂΩï‰∏ãÊù•„ÄÇÂΩìÂºÄÂßãÂºÇÊ≠•Ê∏≤ÊüìÁöÑÊó∂ÂÄôÂà§Êñ≠ÊòØÂê¶ÂèòÂåñÔºåÊù•ÂÜ≥ÂÆöÊòØÂê¶ÂèñÊ∂à‰∏äÊ¨°ÁöÑÊ∏≤Êüì„ÄÇ YYTransaction Áªô‰∏ªÁ∫øÁ®ã runloop Ê∑ªÂä† observer ÂõûË∞É„ÄÇÁî®‰∫éÂú® runloop Á©∫Èó≤ÁöÑÊó∂ÂÄôËøõË°åÊ∏≤Êüì„ÄÇ YYTransactionÂàõÂª∫Êàë‰ª¨Êù•ÁúãÂÆÉÁöÑÂàõÂª∫ÊñπÊ≥ïÔºö 12345678/// ÂàõÂª∫ YYTransaction ÂÆû‰æãÔºåÈúÄË¶Å‰º†ÂÖ• target Âíå selector+ (YYTransaction *)transactionWithTarget:(id)target selector:(SEL)selector&#123; if (!target || !selector) return nil; YYTransaction *t = [YYTransaction new]; t.target = target; t.selector = selector; return t;&#125; ÂàõÂª∫ÊñπÊ≥ïÂæàÊôÆÈÄöÔºåÂú®ÁîüÊàêÁöÑ YYTransaction ÂÆû‰æã‰∏≠Â≠òÂÖ• target Âíå selectorÔºå‰πüÂ∞±ÊòØ‰πãÂêéË¶ÅÊâßË°åÁöÑÂØπË±°ÂíåÊñπÊ≥ï„ÄÇ Êèê‰∫§Êèê‰∫§ÊñπÊ≥ï‰∏≠Ê∑ªÂä†‰∫Ü‰∏ªÁ∫øÁ®ã runloop ÁöÑ kCFRunLoopBeforeWaiting | kCFRunLoopExit Êó∂ÂàªÁöÑÁõëÂê¨Ôºö 1234567891011121314151617181920212223242526272829303132333435363738- (void)commit &#123; if (!_target || !_selector) return; /// YYTransactionSetup(); /// Â∞Ü YYTransaction ÂÆû‰æã‰øùÂ≠òÂà∞ Set ‰∏≠ [transactionSet addObject:self];&#125;/// Âú®‰∏ªÁ∫øÁ®ã waiting ÊàñËÄÖ exit ÁöÑÊó∂ÂÄôÔºåÊâßË°å transactionSet ‰∏≠ÁöÑÊñπÊ≥ïstatic void YYRunLoopObserverCallBack(CFRunLoopObserverRef observer, CFRunLoopActivity activity, void *info) &#123; if (transactionSet.count == 0) return; NSSet *currentSet = transactionSet; transactionSet = [NSMutableSet new]; [currentSet enumerateObjectsUsingBlock:^(YYTransaction *transaction, BOOL *stop) &#123;#pragma clang diagnostic push#pragma clang diagnostic ignored "-Warc-performSelector-leaks" [transaction.target performSelector:transaction.selector];#pragma clang diagnostic pop &#125;];&#125;/// Ê∑ªÂä† observer ÁõëÂê¨‰∏ªÁ∫øÁ®ã runloop ËøõÂÖ• waiting Âíå exitstatic void YYTransactionSetup() &#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; transactionSet = [NSMutableSet new]; CFRunLoopRef runloop = CFRunLoopGetMain(); CFRunLoopObserverRef observer; observer = CFRunLoopObserverCreate(CFAllocatorGetDefault(), kCFRunLoopBeforeWaiting | kCFRunLoopExit, true, // repeat 0xFFFFFF, // after CATransaction(2000000) YYRunLoopObserverCallBack, NULL); CFRunLoopAddObserver(runloop, observer, kCFRunLoopCommonModes); CFRelease(observer); &#125;);&#125; ÂàõÂª∫‰∏Ä‰∏™ SetÔºå‰øùÂ≠òÊâÄÊúâË¶ÅÊâßË°åÁöÑÊñπÊ≥ïÔºåÁÑ∂ÂêéÂ∞Ü‰ªªÂä°Ê∑ªÂä†Âà∞‰∏ªÁ∫øÁ®ãÁöÑ runloop Á©∫Èó≤Êó∂ÂÄôÊâßË°å„ÄÇËøôÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Â•ΩÁöÑ‰ºòÂåñÊÄùÊÉ≥„ÄÇÈùûÂ∏∏ÂÄºÂæóÂ≠¶‰π†„ÄÇ YYSentinelËøôÊòØ‰∏Ä‰∏™Ëá™Â¢ûÁöÑËÆ°Êï∞Âô®„ÄÇÈÄöËøá OSAtomicIncrement32 ÊñπÊ≥ïÂÆûÁé∞ÈÄíÂ¢ûÔºö 1234567891011121314@implementation YYSentinel &#123; int32_t _value;&#125;- (int32_t)value &#123; return _value;&#125;/// Ëá™Âä®Á¥ØÂä†- (int32_t)increase &#123; return OSAtomicIncrement32(&amp;_value);&#125;@end OSAtomicIncrement32()ÊòØÂéüÂ≠êËá™Â¢ûÊñπÊ≥ïÔºåÁ∫øÁ®ãÂÆâÂÖ®„ÄÇÂú®Êó•Â∏∏ÂºÄÂèë‰∏≠ÔºåËã•ÈúÄË¶Å‰øùËØÅÊï¥ÂΩ¢Êï∞ÂÄºÂèòÈáèÁöÑÁ∫øÁ®ãÂÆâÂÖ®ÔºåÂèØ‰ª•‰ΩøÁî® OSAtomic Ê°ÜÊû∂‰∏ãÁöÑÊñπÊ≥ïÔºåÂÆÉÂæÄÂæÄÊÄßËÉΩÊØî‰ΩøÁî®ÂêÑÁßç‚ÄúÈîÅ‚ÄùÊõ¥‰∏∫‰ºòË∂äÔºåÂπ∂‰∏î‰ª£Á†Å‰ºòÈõÖ„ÄÇ YYAsyncLayerÂàùÂßãÂåñYYAsyncLayer ÁªßÊâø‰∫é CALayer„ÄÇÂâçÈù¢Âú®ËÆæÁΩÆ UIView Â≠êÁ±ªÁöÑÊó∂ÂÄôÈúÄË¶ÅËÆæÁΩÆ layerClass ÊñπÊ≥ïËøîÂõû YYAsyncLayer.class Â∞±ÊòØ‰∏∫‰∫ÜÂú®ÂàõÂª∫ UIView ÁöÑÊó∂ÂÄôÔºå‰ΩøÁî® YYAsyncLayer ‰Ωú‰∏∫ÂÖ∂ CALayer„ÄÇÂàõÂª∫ÁöÑÊó∂ÂÄô‰ºöË∞ÉÁî® YYAsyncLayer ÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºö 123456789101112131415- (instancetype)init &#123; self = [super init]; static CGFloat scale; //global static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; /// Áâ©ÁêÜÂÉèÁ¥† / ÈÄªËæëÂÉèÁ¥† scale = [UIScreen mainScreen].scale; &#125;); /// UIView Âíå UIImageView ÈªòËÆ§Â§ÑÁêÜ‰∫ÜÂÜÖÈÉ® CALayer ÁöÑ contentsScale„ÄÇÂ¶ÇÊûúÊòØÁõ¥Êé•‰ΩøÁî® CALayer ÂèäÂÖ∂Ë°çÁîüÁ±ªÔºåÂ∞±ÈúÄË¶ÅÊòæÁ§∫ÁöÑÈÖçÁΩÆ contentScale self.contentsScale = scale; _sentinel = [YYSentinel new]; /// ÂºÇÊ≠•Âä†ËΩΩÁöÑÊ†áËØÜ _displaysAsynchronously = YES; return self;&#125; ÂÆÉ‰ºöÊ†πÊçÆÂ±èÂπïÁöÑÂÉèÁ¥†ÊØîËÆæÁΩÆ contentsScale„ÄÇ Ê∏≤ÊüìÊñπÊ≥ïUIView ÊòØÊåÅÊúâ CALayerÔºåÂπ∂‰∏î‰Ωú‰∏∫ CALayer ÁöÑ delegate ÁöÑÂ≠òÂú®„ÄÇÂΩì UIView Âç≥Â∞ÜÊ∏≤ÊüìÁöÑÊó∂ÂÄôÔºå‰ºöË∞ÉÁî® CALayer ÁöÑ display ÊñπÊ≥ï„ÄÇ‰ª£Á†ÅÊØîËæÉÈïøÔºå‰∏çËøáÂ∑≤ÁªèÂÅö‰∫ÜËØ¶Â∞ΩÁöÑÊ≥®ÈáäÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138/// CALayer ÁöÑÊòæÁ§∫ÊñπÊ≥ï- (void)display &#123; super.contents = super.contents; [self _displayAsync:_displaysAsynchronously];&#125;#pragma mark - Private- (void)_displayAsync:(BOOL)async &#123; /// CALayer ÁöÑ delegate ‰∏ÄËà¨ÊòØ UIView ÂèäÂÖ∂Â≠êÁ±ª /// Ëá™Â∑±ÂàõÂª∫ÁöÑ UIView ÈúÄË¶ÅÂÆûÁé∞ YYAsyncLayerDelegate ÂçèËÆÆ __strong id&lt;YYAsyncLayerDelegate&gt; delegate = (id)self.delegate; /// Ëé∑ÂèñÁªòÂà∂‰ªªÂä°ÁÆ°ÁêÜÁ±ª„ÄÇËøô‰∏™ÁÆ°ÁêÜÁ±ªÁî± CALayer ÁöÑ delegate Êèê‰æõÔºåÈúÄË¶ÅËÆæÁΩÆ willDIsplayÔºådisplayÔºådidDisplay ËøôÂá†‰∏™ÂõûË∞É YYAsyncLayerDisplayTask *task = [delegate newAsyncDisplayTask]; /// Â¶ÇÊûúÊ≤°Êúâ display ÊñπÊ≥ïÔºåÈÇ£‰πàÊää contents ËÆæÁΩÆ‰∏∫ nil if (!task.display) &#123; if (task.willDisplay) task.willDisplay(self); self.contents = nil; if (task.didDisplay) task.didDisplay(self, YES); return; &#125; /// ÊòØÂê¶ÊòØÂºÇÊ≠•Ê∏≤Êüì if (async) &#123; if (task.willDisplay) task.willDisplay(self); YYSentinel *sentinel = _sentinel; int32_t value = sentinel.value; BOOL (^isCancelled)(void) = ^BOOL() &#123; return value != sentinel.value; &#125;; CGSize size = self.bounds.size; BOOL opaque = self.opaque; CGFloat scale = self.contentsScale; CGColorRef backgroundColor = (opaque &amp;&amp; self.backgroundColor) ? CGColorRetain(self.backgroundColor) : NULL; /// Â¶ÇÊûúÂÆΩÈ´òÁ≠â‰∫é0ÔºåÈÇ£‰πàÈáäÊîæ CALayer ÁöÑ contents if (size.width &lt; 1 || size.height &lt; 1) &#123; CGImageRef image = (__bridge_retained CGImageRef)(self.contents); self.contents = nil; if (image) &#123; dispatch_async(YYAsyncLayerGetReleaseQueue(), ^&#123; CFRelease(image); &#125;); &#125; if (task.didDisplay) task.didDisplay(self, YES); CGColorRelease(backgroundColor); return; &#125; /// ÂºÇÊ≠•ÊâßË°åÁªòÂà∂ÔºåÊ†πÊçÆÂΩìÂâçÁöÑËá™Â¢ûÂÄºÔºåËé∑Âèñ‰∏≤Ë°åÈòüÂàó dispatch_async(YYAsyncLayerGetDisplayQueue(), ^&#123; /// ÂºÇÊ≠•ÊâßË°åÁöÑÊó∂ÂÄôÔºå‰øùÂ≠ò‰∏Ä‰∏™Ëá™Â¢ûÁöÑÂÄº„ÄÇÂ¶ÇÊûúÂºÇÊ≠•ÊâßË°åÁöÑÊó∂ÂÄôÂèëÁé∞Ëá™Â¢ûÁöÑÂÄºÂèòÂåñ‰∫ÜÔºåÈÇ£‰πàÂ∞±ËØ¥Êòé‰πãÂâçÁöÑÊ∏≤ÊüìÂ∑≤ÁªèË¢´ÂèñÊ∂à‰∫Ü /// Ëøô‰∏™Êó∂ÂÄôÈáäÊîæ backgroundColor ËøîÂõû if (isCancelled()) &#123; CGColorRelease(backgroundColor); return; &#125; /// ÁªòÂà∂ UIGraphicsBeginImageContextWithOptions(size, opaque, scale); CGContextRef context = UIGraphicsGetCurrentContext(); // Â§ÑÁêÜÊúâÈÄèÊòéÂ∫¶ÁöÑÊÉÖÂÜµ if (opaque) &#123; CGContextSaveGState(context); &#123; if (!backgroundColor || CGColorGetAlpha(backgroundColor) &lt; 1) &#123; CGContextSetFillColorWithColor(context, [UIColor whiteColor].CGColor); CGContextAddRect(context, CGRectMake(0, 0, size.width * scale, size.height * scale)); CGContextFillPath(context); &#125; if (backgroundColor) &#123; CGContextSetFillColorWithColor(context, backgroundColor); CGContextAddRect(context, CGRectMake(0, 0, size.width * scale, size.height * scale)); CGContextFillPath(context); &#125; &#125; CGContextRestoreGState(context); CGColorRelease(backgroundColor); &#125; // ÊâßË°å UIView ‰∏≠Êèê‰æõÁöÑ block task.display(context, size, isCancelled); /// Â¶ÇÊûúÊ∏≤ÊüìÂÆåÊàêÂêéÂèëÁé∞ÂèñÊ∂à‰∫Ü„ÄÇÈÇ£‰πàÁõ¥Êé• return if (isCancelled()) &#123; UIGraphicsEndImageContext(); dispatch_async(dispatch_get_main_queue(), ^&#123; if (task.didDisplay) task.didDisplay(self, NO); &#125;); return; &#125; /// Ê∏≤ÊüìÂÆåÊàêÔºåÊãøÂá∫Ê∏≤ÊüìÁöÑËßÜÂõæ UIImage *image = UIGraphicsGetImageFromCurrentImageContext(); UIGraphicsEndImageContext(); /// Â¶ÇÊûúËé∑ÂèñÂÆå image ÂêéËøîÁé∞ÂèñÊ∂à‰∫ÜÔºåÈÇ£‰πàÁõ¥Êé• return if (isCancelled()) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; if (task.didDisplay) task.didDisplay(self, NO); &#125;); return; &#125; /// Âà∞‰∏ªÁ∫øÁ®ã‰∏≠ËÆæÁΩÆ contents dispatch_async(dispatch_get_main_queue(), ^&#123; /// ÂèëÁé∞Âà∞‰∏ªÁ∫øÁ®ã‰∏≠ÁöÑÊó∂ÂÄôÂèñÊ∂à‰∫ÜÔºåÈÇ£‰πàÁõ¥Êé• return if (isCancelled()) &#123; if (task.didDisplay) task.didDisplay(self, NO); &#125; else &#123; /// Ê≤°ÊúâÂèñÊ∂àËÆæÁΩÆ CALayer ÁöÑ contents self.contents = (__bridge id)(image.CGImage); if (task.didDisplay) task.didDisplay(self, YES); &#125; &#125;); &#125;); &#125; else &#123; /// ÂêåÊ≠•ÊâßË°åÁõ¥Êé•Ëá™Â¢û [_sentinel increase]; /// ‰πãÂêéÂ∞±ÊòØÊ≠£Â∏∏ÁöÑÊ∏≤ÊüìÈÄªËæë if (task.willDisplay) task.willDisplay(self); UIGraphicsBeginImageContextWithOptions(self.bounds.size, self.opaque, self.contentsScale); CGContextRef context = UIGraphicsGetCurrentContext(); if (self.opaque) &#123; CGSize size = self.bounds.size; size.width *= self.contentsScale; size.height *= self.contentsScale; CGContextSaveGState(context); &#123; if (!self.backgroundColor || CGColorGetAlpha(self.backgroundColor) &lt; 1) &#123; CGContextSetFillColorWithColor(context, [UIColor whiteColor].CGColor); CGContextAddRect(context, CGRectMake(0, 0, size.width, size.height)); CGContextFillPath(context); &#125; if (self.backgroundColor) &#123; CGContextSetFillColorWithColor(context, self.backgroundColor); CGContextAddRect(context, CGRectMake(0, 0, size.width, size.height)); CGContextFillPath(context); &#125; &#125; CGContextRestoreGState(context); &#125; task.display(context, self.bounds.size, ^&#123;return NO;&#125;); UIImage *image = UIGraphicsGetImageFromCurrentImageContext(); UIGraphicsEndImageContext(); self.contents = (__bridge id)(image.CGImage); if (task.didDisplay) task.didDisplay(self, YES); &#125;&#125; ‰∏ªË¶ÅÂÅö‰∫Ü‰ª•‰∏ãÂá†ÁÇπÔºö ÂèñÂá∫Ëá™ÂÆö‰πâ UIView ‰∏≠ÂÆûÁé∞ÁöÑ newAsyncDisplayTask ÊñπÊ≥ïËøîÂõûÁöÑÂÆû‰æã„ÄÇ‰ªé‰∏≠ÂèñÂá∫ display ‰ª•ÂèäÂâçÂêéÁöÑÂõûË∞É„ÄÇ Âà§Êñ≠Ë¶ÅÊ∏≤ÊüìÁöÑÂÆΩÊàñËÄÖÈ´ò‰∏∫ 0ÔºåÈÇ£‰πàÁõ¥Êé•Ê∏ÖÁ©∫ contents Â¶ÇÊûúÊòØÂºÇÊ≠•ÔºåÈÇ£‰πàÂàõÂª∫ÂºÇÊ≠•ÈòüÂàóÔºåÂπ∂ÈÄöËøá CoreGraphic Ê∏≤Êüì„ÄÇ Â¶ÇÊûúÊòØÂêåÊ≠•ÔºåÁõ¥Êé•ÂêåÊ≠•Ê∏≤Êüì„ÄÇ ÂèØ‰ª•ÁúãÂà∞ËøôÈáå‰ΩúËÄÖ‰ΩøÁî®‰∫ÜÂ§ßÈáèÁöÑ if (isCancelled()) {...} Âà§Êñ≠ÔºåÂè™Ë¶ÅÂ§±Ë¥•ÔºåÁ´ãÂàªËøîÂõû„ÄÇËøôÊ†∑ËÉΩÂ§üÂ∞ΩÂèØËÉΩÂ§öÁöÑËäÇÁúÅ CPU ËµÑÊ∫ê„ÄÇ Êù•Áúã‰∏Ä‰∏ã isCancelled Ëøô‰∏™ block ÁöÑÂÆûÁé∞ÊñπÂºèÔºö 123BOOL (^isCancelled)(void) = ^BOOL() &#123; return value != sentinel.value;&#125;; ÈÄöËøá block ÊçïËé∑ÂΩìÂâçÊ∏≤ÊüìÂë®ÊúüÂÜÖÁöÑÂèòÈáèÂÄº„ÄÇÂÖ∂‰ªñÁ∫øÁ®ãÊîπÂèò‰∫ÜÂÖ®Â±ÄÂèòÈáè_sentinelÁöÑÂÄº‰πü‰∏ç‰ºöÂΩ±ÂìçÂΩìÂâçÁöÑvalue„ÄÇËã•ÂΩìÂâçvalue‰∏çÁ≠â‰∫éÊúÄÊñ∞ÁöÑ_sentinel .valueÊó∂ÔºåËØ¥ÊòéÁªòÂà∂‰ªªÂä°Â∑≤ÁªèÊõ¥Êñ∞ÔºåÂΩìÂâçÁªòÂà∂‰ªªÂä°Â∑≤ÁªèË¢´ÊîæÂºÉÔºåÂ∞±ÈúÄË¶ÅÂèäÊó∂ÁöÑÂÅöËøîÂõûÈÄªËæë„ÄÇ ÈÇ£‰πà‰ªÄ‰πàÊó∂ÂÄôËøô‰∏™ËÆ°Êï∞‰ºöÊîπÂèòÂë¢ÔºüÂú®Êèê‰∫§ÈáçÁªòÁöÑÊó∂ÂÄô„ÄÇ 1234567- (void)setNeedsDisplay &#123; [self _cancelAsyncDisplay]; [super setNeedsDisplay];&#125;- (void)_cancelAsyncDisplay &#123; [_sentinel increase];&#125; ÂºÇÊ≠•Á∫øÁ®ãÁöÑÁÆ°ÁêÜÊØèÊ¨°ÂºÇÊ≠•Ê∏≤ÊüìËé∑ÂèñÁöÑÈòüÂàóÂπ∂‰∏çÊòØ‰∏Ä‰∏™Âπ∂Ë°åÈòüÂàó„ÄÇËÄåÊòØÂ§ö‰∏™‰∏≤Ë°åÈòüÂàóÔºö 12345678910111213141516171819202122232425262728293031323334static dispatch_queue_t YYAsyncLayerGetDisplayQueue() &#123;/// Â¶ÇÊûú‰ΩøÁî®‰∫Ü YYDispatchQueuePoolÔºåÁî® YYDispatchQueuePool#ifdef YYDispatchQueuePool_h return YYDispatchQueueGetForQOS(NSQualityOfServiceUserInitiated);#else#define MAX_QUEUE_COUNT 16 static int queueCount; static dispatch_queue_t queues[MAX_QUEUE_COUNT]; static dispatch_once_t onceToken; static int32_t counter = 0; dispatch_once(&amp;onceToken, ^&#123; /// ‰∏≤Ë°åÈòüÂàóÊï∞ÈáèÂíåÂ§ÑÁêÜÂô®Êï∞ÈáèÁõ∏Âêå queueCount = (int)[NSProcessInfo processInfo].activeProcessorCount; queueCount = queueCount &lt; 1 ? 1 : queueCount &gt; MAX_QUEUE_COUNT ? MAX_QUEUE_COUNT : queueCount; /// Âæ™ÁéØÂàõÂª∫‰∏≤Ë°åÈòüÂàóÔºåbingÂπ∂ËÆæÁΩÆ‰ºòÂÖàÁ∫ß if ([UIDevice currentDevice].systemVersion.floatValue &gt;= 8.0) &#123; for (NSUInteger i = 0; i &lt; queueCount; i++) &#123; dispatch_queue_attr_t attr = dispatch_queue_attr_make_with_qos_class(DISPATCH_QUEUE_SERIAL, QOS_CLASS_USER_INITIATED, 0); queues[i] = dispatch_queue_create("com.ibireme.yykit.render", attr); &#125; &#125; else &#123; for (NSUInteger i = 0; i &lt; queueCount; i++) &#123; queues[i] = dispatch_queue_create("com.ibireme.yykit.render", DISPATCH_QUEUE_SERIAL); dispatch_set_target_queue(queues[i], dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0)); &#125; &#125; &#125;); /// Ê†πÊçÆËá™Â¢ûÁöÑÂÄºËøîÂõûÊüê‰∏™‰∏≤Ë°åÈòüÂàó int32_t cur = OSAtomicIncrement32(&amp;counter); if (cur &lt; 0) cur = -cur; return queues[(cur) % queueCount];#undef MAX_QUEUE_COUNT#endif&#125; ‰∏∫‰ªÄ‰πà‰∏çÁî®Âπ∂Ë°åÈòüÂàóÂë¢ÔºüÂõ†‰∏∫Âπ∂Ë°åÂíåÂπ∂ÂèëÊòØÊúâÂå∫Âà´ÁöÑ„ÄÇÂú®ÂçïÊ†∏ËÆæÂ§á‰∏äÔºåCPUÈÄöËøáÈ¢ëÁπÅÁöÑÂàáÊç¢‰∏ä‰∏ãÊñáÊù•ËøêË°å‰∏çÂêåÁöÑÁ∫øÁ®ãÔºåÈÄüÂ∫¶Ë∂≥Â§üÂø´‰ª•Ëá≥‰∫éÊàë‰ª¨ÁúãËµ∑Êù•ÂÆÉÊòØ‚ÄòÂπ∂Ë°å‚ÄôÂ§ÑÁêÜÁöÑÔºåÁÑ∂ËÄåÊàë‰ª¨Âè™ËÉΩËØ¥ËøôÁßçÊÉÖÂÜµÊòØÂπ∂ÂèëËÄåÈùûÂπ∂Ë°å„ÄÇ Âπ∂Ë°åÈòüÂàóÂπ∂‰∏çËÉΩÂÆåÂÖ®‰ΩìÁé∞Âá∫Â§öÊ†∏Â§ÑÁêÜÂô®ÁöÑ‰ºòÂäø„ÄÇÂÆûÈôÖ‰∏ä‰∏Ä‰∏™ n Ê†∏ËÆæÂ§áÂêå‰∏ÄÊó∂ÂàªÊúÄÂ§öËÉΩ Âπ∂Ë°å ÊâßË°å n ‰∏™‰ªªÂä°Ôºå‰πüÂ∞±ÊòØÊúÄÂ§öÊúâ n ‰∏™Á∫øÁ®ãÊòØÁõ∏‰∫í‰∏çÁ´û‰∫â CPU ËµÑÊ∫êÁöÑ„ÄÇ ËÄå‰∏≤Ë°åÈòüÂàó‰∏≠Âè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãÔºåËØ•Ê°ÜÊû∂‰∏≠Ôºå‰ΩúËÄÖ‰ΩøÁî®ÂíåÂ§ÑÁêÜÂô®Ê†∏ÂøÉÁõ∏ÂêåÊï∞ÈáèÁöÑ‰∏≤Ë°åÈòüÂàóÊù•ËΩÆËØ¢Â§ÑÁêÜÂºÇÊ≠•‰ªªÂä°ÔºåÊúâÊïàÁöÑÂáèÂ∞ë‰∫ÜÁ∫øÁ®ãË∞ÉÂ∫¶Êìç‰Ωú„ÄÇ ASDKASDK ÁöÑÊ∏≤ÊüìÈÉ®ÂàÜ‰πüÊòØÈÄöËøáÂºÇÊ≠•ÁöÑÊñπÂºèËøõË°åÊ∏≤Êüì„ÄÇ‰∏çËøá ASDK ËøòÂú®ÂÖ∂‰ªñÊñπÈù¢ËøõË°å‰∫Ü‰ºòÂåñÔºåÂåÖÊã¨ÔºåLayoutÔºåRendering Âíå UIKit Objects„ÄÇ ÊÄªÁªìYYAsyncLayer ÁöÑ‰ª£Á†Å‰πüÂ∞±Âá†ÁôæË°åÔºåÈùûÂ∏∏ÁöÑÁ≤æÁÆÄÔºå‰ΩÜÊòØËï¥Âê´ÁùÄÁ≤æÂçéÔºö ÈÄöËøá Core Graphic ÂºÇÊ≠•È¢ÑÊ∏≤ÊüìËßÜÂõæÔºåÂú®‰∏ªÁ∫øÁ®ã‰∏≠ËÆæÁΩÆ layer ÁöÑ contents Â±ûÊÄß„ÄÇ Áªô runloop Â¢ûÂä† observerÔºåÂú® runloop Âç≥Â∞ÜÁªìÊùüÁöÑÊó∂ÂÄôËøêË°åËÄóÊó∂ÈÄªËæëÔºå‰ª•Èò≤Ê≠¢ÈòªÂ°û‰∏ªÁ∫øÁ®ã ÂàõÂª∫Â§ÑÁêÜÂô®Êï∞Èáè‰∏™‰∏≤Ë°åÈòüÂàó‰Ωú‰∏∫ GCD ÁöÑÊâßË°åÈòüÂàóÔºåÊúÄÂ§ßÁ®ãÂ∫¶‰∏äÂà©Áî®Â§öÊ†∏ CPU ÁöÑ‰ºòÂäø„ÄÇ ÊÄùËÄÉÈ¢ò ‰∏∫‰ªÄ‰πà‰ºö‰∫ßÁîüÂç°È°øÔºü CPU Âíå GPU ÁöÑËÅåË¥£ÊúâÂì™‰∫õÔºü CPU ÊñπÈù¢Â¶Ç‰Ωï‰ºòÂåñÔºü GPU Â¶Ç‰Ωï‰ºòÂåñÔºü YYAsyncLayer ‰∏∫‰ªÄ‰πàÂèØ‰ª•ÂºÇÊ≠•Ê∏≤ÊüìÔºü YYAsyncLayer Âú®‰ΩïÊó∂ÊâßË°åÊ∏≤ÊüìÔºü YYAsyncLayer Â¶Ç‰ΩïÈÄöËøá‰∏≤Ë°åÈòüÂàóÂÆûÁé∞ÂºÇÊ≠•ÁöÑÔºü ÂèÇËÄÉiOS ‰øùÊåÅÁïåÈù¢ÊµÅÁïÖÁöÑÊäÄÂ∑ßÂï•‰πü‰∏çËØ¥‰∫ÜÔºåÁªèÂÖ∏‰∏≠ÁöÑÁªèÂÖ∏ YYAsyncLayer Ê∫êÁ†ÅÂâñÊûêÔºöÂºÇÊ≠•ÁªòÂà∂ ‰ΩøÁî® ASDK ÊÄßËÉΩË∞É‰ºò - ÊèêÂçá iOS ÁïåÈù¢ÁöÑÊ∏≤ÊüìÊÄßËÉΩ ‰∏çÂæó‰∏çËØ¥Ôºåindulge_in Âíå Draveness ÊòØÊàëËßÅËøáÁöÑÂîØ‰∫åÊñáÁ´†ÂÜôÁöÑÊ∑±ÂàªÂèàÊòìÊáÇÁöÑ‰∫∫‰∫Ü„ÄÇ‰Ω©Êúç]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AFNetworking Ê∫êÁ†ÅËß£Êûê - ÁΩëÁªúÁä∂ÊÄÅ‰∏éÂÆâÂÖ®Á≠ñÁï•]]></title>
    <url>%2F2019%2F01%2F05%2FAFNetworking1%2F</url>
    <content type="text"><![CDATA[Âà∞‰∫Ü AFNetworking ÁöÑÊúÄÂêé‰∏ÄÁØá‰∫Ü„ÄÇÁΩëÁªúÁä∂ÊÄÅÂèòÊõ¥ÂíåÂÆâÂÖ®Á≠ñÁï•ÊòØÊØîËæÉÁã¨Á´ãÁöÑ‰∏§Âùó‰∏úË•ø„ÄÇÂõ†Ê≠§Êää‰ªñ‰ª¨ÊîæÂú®ÊúÄÂêéÁúãÂÆå„ÄÇ ÁΩëÁªúÁä∂ÊÄÅAFNetworkReachabilityManagerÁ±ªÊèê‰æõ‰∫ÜÂØπ‰∫éÁΩëÁªúÁä∂ÊÄÅÂèòÂåñÁöÑÁõëÂê¨„ÄÇAF È¢ÑÂÆö‰πâ‰∫ÜÂõõÁßçÁΩëÁªúÁä∂ÊÄÅÔºö 12345678910typedef NS_ENUM(NSInteger, AFNetworkReachabilityStatus) &#123; /// Êú™Áü• AFNetworkReachabilityStatusUnknown = -1, /// Êó†ÁΩëÁªú AFNetworkReachabilityStatusNotReachable = 0, /// WWAN ÊâãÊú∫Ëá™Â∏¶ÁΩëÁªú AFNetworkReachabilityStatusReachableViaWWAN = 1, /// Wifi AFNetworkReachabilityStatusReachableViaWiFi = 2,&#125;; ËÆæÁΩÆÁõëÂê¨ÁΩëÁªúÁä∂ÊÄÅÁöÑÁõëÂê¨ÊòØ‰∏Ä‰∏™ÈÄªËæëÂæàÊ∏ÖÊô∞ÁöÑËøáÁ®ã„ÄÇÂØπ‰∫éÁΩëÁªúÁä∂ÊÄÅÁöÑÊîπÂèòÔºåÊàë‰ª¨ÂøÖÈ°ªË¶ÅÈÄöËøáÁ≥ªÁªüÁöÑ API ËøõË°å„ÄÇÈÇ£‰πàÂú® AFNetworkReachabilityStatusForFlags ‰∏≠Â∞±Êèê‰æõ‰∫ÜËøôÊ†∑ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÂÆûÊñΩÁõëÂê¨Ôºö 1234567891011121314151617181920212223242526272829303132- (void)startMonitoring &#123; [self stopMonitoring]; /// Ê≤°ÊúâÂàõÂª∫ networkReachability ÂÆû‰æãÔºåÁõ¥Êé•ËøîÂõû if (!self.networkReachability) &#123; return; &#125; /// ÁΩëÁªúÁõëÂê¨ÁöÑÂõûË∞É __weak __typeof(self)weakSelf = self; AFNetworkReachabilityStatusBlock callback = ^(AFNetworkReachabilityStatus status) &#123; __strong __typeof(weakSelf)strongSelf = weakSelf; strongSelf.networkReachabilityStatus = status; if (strongSelf.networkReachabilityStatusBlock) &#123; strongSelf.networkReachabilityStatusBlock(status); &#125; &#125;; /// ÁΩëÁªúÁõëÂê¨‰∏ä‰∏ãÊñáÔºåÊ≥®ÂÜåÁΩëÁªúÊîπÂèòÁöÑÂõûË∞É SCNetworkReachabilityContext context = &#123;0, (__bridge void *)callback, AFNetworkReachabilityRetainCallback, AFNetworkReachabilityReleaseCallback, NULL&#125;; SCNetworkReachabilitySetCallback(self.networkReachability, AFNetworkReachabilityCallback, &amp;context); SCNetworkReachabilityScheduleWithRunLoop(self.networkReachability, CFRunLoopGetMain(), kCFRunLoopCommonModes); dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0),^&#123; SCNetworkReachabilityFlags flags; if (SCNetworkReachabilityGetFlags(self.networkReachability, &amp;flags)) &#123; AFPostReachabilityStatusChange(flags, callback); &#125; &#125;);&#125; ÂèØ‰ª•ÁúãÂà∞ÔºåÈÄöËøáÁ≥ªÁªü API ÂàõÂª∫‰∫Ü‰∏Ä‰∏™‰∏ä‰∏ãÊñá SCNetworkReachabilityContext ÂÆû‰æãÔºå‰∏Ä‰∏™ÁõëÂê¨ÂõûË∞ÉÁöÑ AFNetworkReachabilityStatusBlock ÂÆû‰æãÔºå‰ª•Âèä‰∏Ä‰∏™Âè•ÊüÑ networkReachability„ÄÇÊó¢ÁÑ∂ÊòØÂè•ÊüÑÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÈÄöËøáÂÆÉÊù•ÁªìÊùüÁõëÂê¨Ôºö 1234567- (void)stopMonitoring &#123; if (!self.networkReachability) &#123; return; &#125; SCNetworkReachabilityUnscheduleFromRunLoop(self.networkReachability, CFRunLoopGetMain(), kCFRunLoopCommonModes);&#125; networkReachability Âú®ÂàùÂßãÂåñÁõëÂê¨Á±ªÂØπË±°ÁöÑÊó∂ÂÄôÂàõÂª∫Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445+ (instancetype)sharedManager &#123; static AFNetworkReachabilityManager *_sharedManager = nil; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; _sharedManager = [self manager]; &#125;); return _sharedManager;&#125;+ (instancetype)managerForDomain:(NSString *)domain &#123; /// ÂàõÂª∫ SCNetworkReachabilityRef ÂØπË±° SCNetworkReachabilityRef reachability = SCNetworkReachabilityCreateWithName(kCFAllocatorDefault, [domain UTF8String]); AFNetworkReachabilityManager *manager = [[self alloc] initWithReachability:reachability]; CFRelease(reachability); return manager;&#125;+ (instancetype)managerForAddress:(const void *)address &#123; SCNetworkReachabilityRef reachability = SCNetworkReachabilityCreateWithAddress(kCFAllocatorDefault, (const struct sockaddr *)address); AFNetworkReachabilityManager *manager = [[self alloc] initWithReachability:reachability]; CFRelease(reachability); return manager;&#125;+ (instancetype)manager&#123;#if (defined(__IPHONE_OS_VERSION_MIN_REQUIRED) &amp;&amp; __IPHONE_OS_VERSION_MIN_REQUIRED &gt;= 90000) || (defined(__MAC_OS_X_VERSION_MIN_REQUIRED) &amp;&amp; __MAC_OS_X_VERSION_MIN_REQUIRED &gt;= 101100) struct sockaddr_in6 address; bzero(&amp;address, sizeof(address)); address.sin6_len = sizeof(address); address.sin6_family = AF_INET6;#else struct sockaddr_in address; bzero(&amp;address, sizeof(address)); address.sin_len = sizeof(address); address.sin_family = AF_INET;#endif return [self managerForAddress:&amp;address];&#125; ÂàùÂßãÂåñÊñπÊ≥ïÊØîËæÉÈïøÔºå‰∏ªË¶ÅÂàÜ‰∏∫‰∫Ü‰∏§ÁßçÊñπÂºèÁõëÂê¨Ôºå‰∏ÄÁßçÊòØÁõëÂê¨ÂüüÂêçÔºå‰∏ÄÁßçÊòØÁõëÂê¨ socket„ÄÇÂêåÊó∂ÈÄöËøáÁ≥ªÁªü API ÂàõÂª∫ networkReachability„ÄÇ ÁõëÂê¨ÂõûË∞ÉËÆæÁΩÆÂ•ΩÁõëÂê¨ÈÇ£‰πàÂ∞±ËÆæÁΩÆÁõëÂê¨ÂõûË∞É‰ª•Â§ÑÁêÜÁΩëÁªúÁä∂ÊÄÅÂèòÂåñ‰ø°ÊÅØÂíØ„ÄÇÊàë‰ª¨Êù•Êü•Áúã‰∏äÊñá‰∏≠Ê≥®ÂÜåÁöÑ AFNetworkReachabilityCallback ÂõûË∞ÉÊòØÊÄéÊ†∑ÁöÑÔºö 1234567891011121314151617static void AFNetworkReachabilityCallback(SCNetworkReachabilityRef __unused target, SCNetworkReachabilityFlags flags, void *info) &#123; AFPostReachabilityStatusChange(flags, (__bridge AFNetworkReachabilityStatusBlock)info);&#125;static void AFPostReachabilityStatusChange(SCNetworkReachabilityFlags flags, AFNetworkReachabilityStatusBlock block) &#123; AFNetworkReachabilityStatus status = AFNetworkReachabilityStatusForFlags(flags); dispatch_async(dispatch_get_main_queue(), ^&#123; /// ÊúâÂõûË∞ÉÂáΩÊï∞Ë∞ÉÁî®ÂõûË∞ÉÂáΩÊï∞ if (block) &#123; block(status); &#125; /// ÂèëÈÄÅÈÄöÁü• NSNotificationCenter *notificationCenter = [NSNotificationCenter defaultCenter]; NSDictionary *userInfo = @&#123; AFNetworkingReachabilityNotificationStatusItem: @(status) &#125;; [notificationCenter postNotificationName:AFNetworkingReachabilityDidChangeNotification object:nil userInfo:userInfo]; &#125;);&#125; ÂΩìÁΩëÁªúÁä∂ÊÄÅÂèòÊõ¥ÁöÑÊó∂ÂÄôÔºåÈÄöËøá AFNetworkReachabilityStatusForFlags() ÊñπÊ≥ïËøõË°åÂü∫Êú¨Áä∂ÂÜµÁöÑÂ§ÑÁêÜÔºö 1234567891011121314151617181920212223242526272829#pragma mark - Ê†πÊçÆSCNetworkReachabilityFlagsËøô‰∏™ÁΩëÁªúÊ†áËÆ∞Êù•ËΩ¨Êç¢ÊàêÊàë‰ª¨Âú®ÂºÄÂèë‰∏≠ÁªèÂ∏∏‰ΩøÁî®ÁöÑÁΩëÁªúÁä∂ÊÄÅstatic AFNetworkReachabilityStatus AFNetworkReachabilityStatusForFlags(SCNetworkReachabilityFlags flags) &#123; /// ËÉΩÂê¶Âà∞Ëææ BOOL isReachable = ((flags &amp; kSCNetworkReachabilityFlagsReachable) != 0); /// ËÅîÁΩë‰πãÂâçÈúÄË¶ÅÂª∫Á´ãËøûÊé• BOOL needsConnection = ((flags &amp; kSCNetworkReachabilityFlagsConnectionRequired) != 0); /// ÊòØÂê¶ÂèØ‰ª•Ëá™Âä®ËøûÊé• BOOL canConnectionAutomatically = (((flags &amp; kSCNetworkReachabilityFlagsConnectionOnDemand ) != 0) || ((flags &amp; kSCNetworkReachabilityFlagsConnectionOnTraffic) != 0)); /// ÊòØÂê¶ÂèØ‰ª•Âú®‰∏çÈúÄË¶ÅÁî®Êà∑ÊâãÂä®ËÆæÁΩÆÁöÑÂâçÊèê‰∏ãËøûÊé• BOOL canConnectWithoutUserInteraction = (canConnectionAutomatically &amp;&amp; (flags &amp; kSCNetworkReachabilityFlagsInterventionRequired) == 0); /// ÊòØÂê¶ÂèØ‰ª•ËÅîÁΩëÔºö1.ËÉΩÂ§üÂà∞Ëææ 2.‰∏çÈúÄË¶ÅÂª∫Á´ãËøûÊé•ÊàñËÄÖ‰∏çÈúÄË¶ÅÁî®Êà∑ÊâãÂä®ËÆæÁΩÆËøûÊé•Â∞±ËÉΩËøûÊé•Âà∞ÁΩëÁªú BOOL isNetworkReachable = (isReachable &amp;&amp; (!needsConnection || canConnectWithoutUserInteraction)); /// ËÆæÁΩÆÁΩëÁªúÁä∂ÊÄÅ AFNetworkReachabilityStatus status = AFNetworkReachabilityStatusUnknown; if (isNetworkReachable == NO) &#123; status = AFNetworkReachabilityStatusNotReachable; &#125;#if TARGET_OS_IPHONE else if ((flags &amp; kSCNetworkReachabilityFlagsIsWWAN) != 0) &#123; status = AFNetworkReachabilityStatusReachableViaWWAN; &#125;#endif else &#123; status = AFNetworkReachabilityStatusReachableViaWiFi; &#125; return status;&#125; Â§ÑÁêÜÂÆåÊàêÂêéÁöÑÁªìÊûúÔºåÂèØ‰ª•ÈÄöËøá‰∏§ÁßçÊñπÂºèÊãøÂà∞„ÄÇ‰∏ÄÁßçÊòØÈÄöËøáÂõûË∞ÉÂáΩÊï∞ÔºåËøô‰∏™ÂõûË∞ÉÂáΩÊï∞Â∞±ÊòØ‰∏äÊñá‰∏≠Âú® startMonitoring() ‰∏≠ÂàõÂª∫ SCNetworkReachabilityContext ‰º†ÂÖ•ÁöÑ callbackÔºåÂèØ‰ª•Ëá™Â∑±Â∞Ü block ËÆæÁΩÆÁªôÁõëÂê¨Á±ªÁöÑÂçï‰æãÂØπË±°„ÄÇËøòÊúâ‰∏ÄÁßçÂ∞±ÊòØÈÄöËøáÈÄöÁü•ÔºåÊèêÂâçÊ≥®ÂÜå‰ª•‰∏ã‰∏§ÁßçÈÄöÁü•ÔºåÂèØ‰ª•Ëé∑ÂèñÂà∞ÊîπÂèòÊó∂Èó¥‰ª•ÂèäÊîπÂèòÁöÑÊÉÖÂÜµÔºö 12345#pragma mark - ÈÄöÁü•ÁöÑÂ≠óÁ¨¶‰∏≤/// ÁΩëÁªúÁéØÂ¢ÉÊîπÂèòÊó∂ÂÄôÊé•Êî∂ÈÄöÁü•NSString * const AFNetworkingReachabilityDidChangeNotification = @"com.alamofire.networking.reachability.change";/// ÊîπÂèòÂêéÊé•Êî∂ÈÄöÁü•ÔºåÊê∫Â∏¶‰∏Ä‰∏™‰ø°ÊÅØNSString * const AFNetworkingReachabilityNotificationStatusItem = @"AFNetworkingReachabilityNotificationStatusItem"; ‰ª•‰∏äÂ∞±ÊòØÁΩëÁªúÁõëÂê¨Áõ∏ÂÖ≥ÁöÑÊñπÊ≥ï„ÄÇ ÂÆâÂÖ®Á≠ñÁï•AFSecurityPolicy Á±ªÊèê‰æõ‰∫ÜÂØπ‰∫é HTTPS ÈÄö‰ø°ËøáÁ®ã‰∏≠ËØÅ‰π¶ÁöÑÊ†°È™åÔºåÂèØ‰ª•ÊúâÊïàÈò≤Ê≠¢‰∏≠Èó¥‰∫∫ÊîªÂáª„ÄÇÂÆÉÁöÑÊ†°È™åÊ®°ÂºèÂàÜ‰∏Ä‰∏ã‰∏âÁßçÔºö 123456789#pragma mark - ÂÆâÂÖ®Á∫ßÂà´typedef NS_ENUM(NSUInteger, AFSSLPinningMode) &#123; /// ‰ø°‰ªªÊâÄÊúâËØÅ‰π¶ AFSSLPinningModeNone, /// Ê†°È™åËØÅ‰π¶ÁöÑÂÖ¨Èí• AFSSLPinningModePublicKey, /// Ê†°È™åÊï¥‰∏™ËØÅ‰π¶ AFSSLPinningModeCertificate,&#125;; ÂàõÂª∫ AFSecurityPolicyÂàùÂßãÂåñAFSecurityPolicy Âπ∂‰∏çÊòØ‰∏Ä‰∏™Âçï‰æãÂØπË±°ÔºåÊØè‰∏™ AFEscurityPolicy ÂÆû‰æãÈÉΩÂèØ‰ª•‰øùÂ≠òËá™Â∑±ÁöÑÈ™åËØÅÊ®°ÂºèÔºåÊ†°È™åËØÅ‰π¶ÈõÜÂêàÔºå‰ª•Âèä‰∏Ä‰∫õÈÖçÁΩÆÂ±ûÊÄß„ÄÇÂÆÉÁöÑÂàùÂßãÂåñÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223+ (instancetype)policyWithPinningMode:(AFSSLPinningMode)pinningMode &#123; return [self policyWithPinningMode:pinningMode withPinnedCertificates:[self defaultPinnedCertificates]];&#125;+ (instancetype)policyWithPinningMode:(AFSSLPinningMode)pinningMode withPinnedCertificates:(NSSet *)pinnedCertificates &#123; AFSecurityPolicy *securityPolicy = [[self alloc] init]; securityPolicy.SSLPinningMode = pinningMode; [securityPolicy setPinnedCertificates:pinnedCertificates]; return securityPolicy;&#125;- (instancetype)init &#123; self = [super init]; if (!self) &#123; return nil; &#125; self.validatesDomainName = YES; return self;&#125; ËÆæÁΩÆÊ†°È™åËØÅ‰π¶‰∏äÈù¢ÁöÑ‰ª£Á†Å‰∏≠ÔºåÈÄöËøá [self defaultPinnedCertificates] ÊãøÂà∞ËØÅ‰π¶ÂàóË°®ÔºåÂπ∂‰∏îÂÜç set Áªô AFSecurityPolicy ÁöÑËøáÁ®ãÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425#pragma mark - ÂèñÂá∫ bundler ‰∏≠ÁöÑËØÅ‰π¶+ (NSSet *)certificatesInBundle:(NSBundle *)bundle &#123; /// bundle ‰∏≠‰ª• .cer ÁªìÂ∞æÁöÑÊâÄÊúâË∑ØÂæÑ NSArray *paths = [bundle pathsForResourcesOfType:@"cer" inDirectory:@"."]; NSMutableSet *certificates = [NSMutableSet setWithCapacity:[paths count]]; for (NSString *path in paths) &#123; NSData *certificateData = [NSData dataWithContentsOfFile:path]; [certificates addObject:certificateData]; &#125; return [NSSet setWithSet:certificates];&#125;#pragma mark - Ëé∑ÂèñÂΩìÂâç bundle ‰∏ãÁöÑËØÅ‰π¶+ (NSSet *)defaultPinnedCertificates &#123; static NSSet *_defaultPinnedCertificates = nil; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; NSBundle *bundle = [NSBundle bundleForClass:[self class]]; _defaultPinnedCertificates = [self certificatesInBundle:bundle]; &#125;); return _defaultPinnedCertificates;&#125; Ëé∑ÂèñËØÅ‰π¶ÁöÑËøáÁ®ãÂ∞±ÊòØ‰ªé bundle ‰∏≠Âä†ËΩΩ .cer Êñá‰ª∂ÁöÑËøáÁ®ã„ÄÇËÆæÁΩÆËØÅ‰π¶ÁªôÂÆû‰æãÁöÑÊó∂ÂÄôÂÅö‰∫Ü‰∏Ä‰∏™Êìç‰ΩúÔºå‰ºöÂà∞ËØÅ‰π¶‰∏≠Ëé∑ÂèñÂà∞ÂÖ¨Èí•‰ø°ÊÅØÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#pragma mark - Âú®ËØÅ‰π¶‰∏≠Ëé∑ÂèñÂÖ¨Èí•static id AFPublicKeyForCertificate(NSData *certificate) &#123; id allowedPublicKey = nil; SecCertificateRef allowedCertificate; SecPolicyRef policy = nil; SecTrustRef allowedTrust = nil; SecTrustResultType result; /// Ê†πÊçÆ‰∫åËøõÂà∂ÁöÑcertificateÁîüÊàêSecCertificateRefÁ±ªÂûãÁöÑËØÅ‰π¶ allowedCertificate = SecCertificateCreateWithData(NULL, (__bridge CFDataRef)certificate); __Require_Quiet(allowedCertificate != NULL, _out); /// Êñ∞Âª∫ policy ‰∏∫ x.509 policy = SecPolicyCreateBasicX509(); /// ËÆæÁΩÆ‰ø°‰ªªÁöÑËØÅ‰π¶ __Require_noErr_Quiet(SecTrustCreateWithCertificates(allowedCertificate, policy, &amp;allowedTrust), _out); __Require_noErr_Quiet(SecTrustEvaluate(allowedTrust, &amp;result), _out); /// Âú®SecTrustRefÂØπË±°‰∏≠ÂèñÂá∫ÂÖ¨Èí• allowedPublicKey = (__bridge_transfer id)SecTrustCopyPublicKey(allowedTrust);_out: if (allowedTrust) &#123; CFRelease(allowedTrust); &#125; if (policy) &#123; CFRelease(policy); &#125; if (allowedCertificate) &#123; CFRelease(allowedCertificate); &#125; return allowedPublicKey;&#125;- (void)setPinnedCertificates:(NSSet *)pinnedCertificates &#123; _pinnedCertificates = pinnedCertificates; if (self.pinnedCertificates) &#123; NSMutableSet *mutablePinnedPublicKeys = [NSMutableSet setWithCapacity:[self.pinnedCertificates count]]; /// ‰ªéËØÅ‰π¶‰∏≠ÂèñÂá∫ÂÖ¨Èí• for (NSData *certificate in self.pinnedCertificates) &#123; id publicKey = AFPublicKeyForCertificate(certificate); if (!publicKey) &#123; continue; &#125; [mutablePinnedPublicKeys addObject:publicKey]; &#125; self.pinnedPublicKeys = [NSSet setWithSet:mutablePinnedPublicKeys]; &#125; else &#123; self.pinnedPublicKeys = nil; &#125;&#125; ÊâßË°åÊ†°È™å123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778- (BOOL)evaluateServerTrust:(SecTrustRef)serverTrust forDomain:(NSString *)domain&#123; /// Ëá™Á≠æÂêçËØÅ‰π¶ÈúÄË¶ÅÈÄöËøáÈ™åËØÅ if (domain &amp;&amp; self.allowInvalidCertificates &amp;&amp; self.validatesDomainName &amp;&amp; (self.SSLPinningMode == AFSSLPinningModeNone || [self.pinnedCertificates count] == 0)) &#123; NSLog(@"In order to validate a domain name for self signed certificates, you MUST use pinning."); return NO; &#125; NSMutableArray *policies = [NSMutableArray array]; if (self.validatesDomainName) &#123; [policies addObject:(__bridge_transfer id)SecPolicyCreateSSL(true, (__bridge CFStringRef)domain)]; &#125; else &#123; [policies addObject:(__bridge_transfer id)SecPolicyCreateBasicX509()]; &#125; /// ËÆæÁΩÆË¶ÅÊ†°È™åÁöÑÂüüÂêç SecTrustSetPolicies(serverTrust, (__bridge CFArrayRef)policies); /// Âú®ÂÆâÂÖ®Á∫ßÂà´‰∏∫‰∏çÊ†°È™åÁöÑÊÉÖÂÜµÔºåÂè™Ë¶ÅÈÄöËøá‰∫ÜCAÁöÑÊ†°È™åÊàñËÄÖÁî®Êà∑ÂÖÅËÆ∏Ëá™Á≠æÂêçËØÅ‰π¶ÔºåÈÇ£‰πàÂ∞±ÊòØÊàêÂäüÁöÑ if (self.SSLPinningMode == AFSSLPinningModeNone) &#123; return self.allowInvalidCertificates || AFServerTrustIsValid(serverTrust); /// Â¶ÇÊûúÂÆâÂÖ®Á∫ßÂà´ÊòØÊ†°È™åËØÅ‰π¶Âπ∂‰∏îÊ≤°ÊúâÈÄöËøáCAÁöÑÊ†°È™å‰∏î‰∏çÂÖÅËÆ∏Ëá™Á≠æÂêçËØÅ‰π¶ÔºåÈÇ£‰πàÁõ¥Êé•ËøîÂõû NO &#125; else if (!AFServerTrustIsValid(serverTrust) &amp;&amp; !self.allowInvalidCertificates) &#123; return NO; &#125; /// ÊúâÂÆâÂÖ®Ê†°È™åÔºå‰∏îËØÅ‰π¶‰πüÊòØÂêàÊ≥ïÁöÑÊÉÖÂÜµ‰∏ã switch (self.SSLPinningMode) &#123; case AFSSLPinningModeNone: default: return NO; /// Â¶ÇÊûúÊòØÊ†°È™åËØÅ‰π¶ÁöÑÁ∫ßÂà´ case AFSSLPinningModeCertificate: &#123; NSMutableArray *pinnedCertificates = [NSMutableArray array]; for (NSData *certificateData in self.pinnedCertificates) &#123; [pinnedCertificates addObject:(__bridge_transfer id)SecCertificateCreateWithData(NULL, (__bridge CFDataRef)certificateData)]; &#125; /// Â∞ÜÊú¨Âú∞ËØªÂèñÁöÑËØÅ‰π¶ËÆæÁΩÆ‰∏∫serverTrustÁöÑÈîöÁÇπËØÅ‰π¶ /// ÈîöÁÇπËØÅ‰π¶ÔºåÈÄöËøáSecTrustSetAnchorCertificatesËÆæÁΩÆ‰∫ÜÂèÇ‰∏éÊ†°È™åÈîöÁÇπËØÅ‰π¶‰πãÂêéÔºåÂÅáÂ¶ÇÈ™åËØÅÁöÑÊï∞Â≠óËØÅ‰π¶ÊòØËøô‰∏™ÈîöÁÇπËØÅ‰π¶ÁöÑÂ≠êËäÇÁÇπÔºåÂç≥È™åËØÅÁöÑÊï∞Â≠óËØÅ‰π¶ÊòØÁî±ÈîöÁÇπËØÅ‰π¶ÂØπÂ∫îCAÊàñÂ≠êCAÁ≠æÂèëÁöÑÔºåÊàñÊòØËØ•ËØÅ‰π¶Êú¨Ë∫´ÔºåÂàô‰ø°‰ªªËØ•ËØÅ‰π¶ÔºâÔºåÂÖ∑‰ΩìÂ∞±ÊòØË∞ÉÁî®SecTrustEvaluateÊù•È™åËØÅ„ÄÇ SecTrustSetAnchorCertificates(serverTrust, (__bridge CFArrayRef)pinnedCertificates); if (!AFServerTrustIsValid(serverTrust)) &#123; return NO; &#125; // obtain the chain after being validated, which *should* contain the pinned certificate in the last position (if it's the Root CA) /// È™åËØÅÊï¥‰∏™ËØÅ‰π¶Èìæ NSArray *serverCertificates = AFCertificateTrustChainForServerTrust(serverTrust); /// ÊØîËæÉÊúçÂä°Á´ØËØÅ‰π¶ÊòØÂê¶ÂåÖÂê´Âú®Êú¨Âú∞ËØÅ‰π¶ÂÜÖ for (NSData *trustChainCertificate in [serverCertificates reverseObjectEnumerator]) &#123; if ([self.pinnedCertificates containsObject:trustChainCertificate]) &#123; return YES; &#125; &#125; return NO; &#125; /// Â¶ÇÊûúÂè™Ê†°È™åÂÖ¨Èí•ÔºåÈÇ£‰πàÂè™ÈúÄË¶ÅÊØîËæÉÂÖ¨Èí•Âç≥ÂèØ„ÄÇ case AFSSLPinningModePublicKey: &#123; NSUInteger trustedPublicKeyCount = 0; NSArray *publicKeys = AFPublicKeyTrustChainForServerTrust(serverTrust); for (id trustChainPublicKey in publicKeys) &#123; for (id pinnedPublicKey in self.pinnedPublicKeys) &#123; if (AFSecKeyIsEqualToKey((__bridge SecKeyRef)trustChainPublicKey, (__bridge SecKeyRef)pinnedPublicKey)) &#123; trustedPublicKeyCount += 1; &#125; &#125; &#125; return trustedPublicKeyCount &gt; 0; &#125; &#125; return NO;&#125; ‰ª•‰∏äÊòØÊ†°È™åÁöÑÈÄªËæëÔºåÂÖ∂‰∏≠Ê∂âÂèäÂà∞Â•ΩÂá†‰∏™ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#pragma mark - ËøîÂõûÊúçÂä°Âô®ÊòØÂê¶ÂèØ‰ø°static BOOL AFServerTrustIsValid(SecTrustRef serverTrust) &#123; BOOL isValid = NO; SecTrustResultType result; /// Ê†°È™åÊòØÂê¶ÊòØÂèØ‰ø°ÁöÑËØÅ‰π¶ __Require_noErr_Quiet(SecTrustEvaluate(serverTrust, &amp;result), _out); // kSecTrustResultUnspecified ËØÅ‰π¶È™åËØÅÊàêÂäüÔºå‰ΩÜÊòØÁî®Êà∑Ê≤°ÊúâÊòéÁ°ÆÊåáÂá∫‰ø°‰ªªÊ≠§ËØÅ‰π¶„ÄÇËøôÊòØÊúÄÂ∏∏ËßÅÁöÑËøîÂõûÂÄº„ÄÇ // kSecTrustResultProceed Áî®Êà∑ÈÄâÊã©‰ø°‰ªªÊ≠§ËØÅ‰π¶„ÄÇ isValid = (result == kSecTrustResultUnspecified || result == kSecTrustResultProceed);_out: return isValid;&#125;#pragma mark - ÂèñÂá∫ÊúçÂä°Âô®ËØÅ‰π¶ÁöÑ‰ø°‰ªªÈìæstatic NSArray * AFCertificateTrustChainForServerTrust(SecTrustRef serverTrust) &#123; CFIndex certificateCount = SecTrustGetCertificateCount(serverTrust); NSMutableArray *trustChain = [NSMutableArray arrayWithCapacity:(NSUInteger)certificateCount]; for (CFIndex i = 0; i &lt; certificateCount; i++) &#123; SecCertificateRef certificate = SecTrustGetCertificateAtIndex(serverTrust, i); [trustChain addObject:(__bridge_transfer NSData *)SecCertificateCopyData(certificate)]; &#125; return [NSArray arrayWithArray:trustChain];&#125;#pragma mark - ÂèñÂá∫ÊúçÂä°Âô®ËøîÂõûËØÅ‰π¶ÁöÑ‰ø°‰ªªÈìæ‰∏äÁöÑÊâÄÊúâÂÖ¨Èí•ÊîæÂà∞Êï∞ÁªÑ‰∏≠static NSArray * AFPublicKeyTrustChainForServerTrust(SecTrustRef serverTrust) &#123; SecPolicyRef policy = SecPolicyCreateBasicX509(); CFIndex certificateCount = SecTrustGetCertificateCount(serverTrust); NSMutableArray *trustChain = [NSMutableArray arrayWithCapacity:(NSUInteger)certificateCount]; for (CFIndex i = 0; i &lt; certificateCount; i++) &#123; SecCertificateRef certificate = SecTrustGetCertificateAtIndex(serverTrust, i); SecCertificateRef someCertificates[] = &#123;certificate&#125;; CFArrayRef certificates = CFArrayCreate(NULL, (const void **)someCertificates, 1, NULL); SecTrustRef trust; __Require_noErr_Quiet(SecTrustCreateWithCertificates(certificates, policy, &amp;trust), _out); SecTrustResultType result; __Require_noErr_Quiet(SecTrustEvaluate(trust, &amp;result), _out); [trustChain addObject:(__bridge_transfer id)SecTrustCopyPublicKey(trust)]; _out: if (trust) &#123; CFRelease(trust); &#125; if (certificates) &#123; CFRelease(certificates); &#125; continue; &#125; CFRelease(policy); return [NSArray arrayWithArray:trustChain];&#125; ÊÄªÁöÑÊ¶ÇÊã¨‰∏Ä‰∏ãÂ∞±ÊòØÔºö Â¶ÇÊûúÂè™È™åËØÅËØÅ‰π¶ÁöÑÂêàÊ≥ïÊÄßÁöÑËØùÔºåÂ∞±Áõ¥Êé•ÈÄöËøáËãπÊûúÈ¢ÑÁΩÆÁöÑÊ†πËØÅ‰π¶Ê†°È™å„ÄÇ Â¶ÇÊûúË¶ÅÊ†°È™åËØÅ‰π¶ÊòØÂê¶ÊòØÁâπÂÆöÁöÑËØÅ‰π¶ÔºåÂ∞±Ë¶Å ÊääÊúçÂä°Á´ØËøîÂõûÁöÑËØÅ‰π¶ÁöÑÁ≠æÂèëËØÅ‰π¶ÊîæÂú® native ‰∏≠ Êää native ‰∏≠ÁöÑËØÅ‰π¶ËÆæÁΩÆ‰∏∫ÊúçÂä°Á´ØËøîÂõûËØÅ‰π¶ÁöÑÈîöÁÇπËØÅ‰π¶ ÂèñÂá∫ÊúçÂä°Á´ØÁöÑËØÅ‰π¶ÁöÑ‰ø°‰ªªÈìæ‰∏äÁöÑÊâÄÊúâËØÅ‰π¶Âπ∂Âíå native ‰∏≠ÁöÑËØÅ‰π¶ÂÅöÊØîËæÉ„ÄÇÂ¶ÇÊûúÁõ∏Á≠âÂ∞±ËØ¥ÊòéÂèØ‰ª•Áî® native ‰∏≠‰øùÂ≠òÁöÑËØÅ‰π¶ÂØπÊúçÂä°Á´ØÁöÑËØÅ‰π¶Ëß£ÂØÜÔºåÂç≥ÊòØË¶Å‰ø°‰ªªÁöÑËØÅ‰π¶„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÔºåÂ∞±ËØ¥ÊòéÊî∂Âà∞ÁöÑËØÅ‰π¶‰∏çÊòØÊúçÂä°Á´ØÁ≠æÂèëÁöÑÔºå‰∏çÂèØ‰ø° Â¶ÇÊûúË¶ÅÊ†°È™åËØÅ‰π¶‰∏≠ÁöÑÂÖ¨Èí•ÔºåÂàôÊòØÂú®‰∏ä‰∏ÄÊ≠•ÁöÑÂü∫Á°Ä‰∏äÔºåÂèñÂá∫ËØÅ‰π¶‰∏≠ÁöÑÂÖ¨Èí•‰ø°ÊÅØÔºåËøõË°åÊØîËæÉ„ÄÇ ‰∏∫‰ªÄ‰πàAF3.0‰∏çÈúÄË¶ÅÂ∏∏È©ªÂ≠êÁ∫øÁ®ã‰∫ÜÔºüÈ¶ñÂÖàÔºåËØ∑Ê±ÇÊúÄÂ•Ω‰∏çË¶ÅÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÂÅöÔºåÂõ†‰∏∫ËøôÊ†∑ÂèØËÉΩ‰ºöÂΩ±Âìç‰∏ªÁ∫øÁ®ãÊïàÁéá„ÄÇÂπ∂‰∏îÂ≠êÁ∫øÁ®ãÈúÄË¶Å‰øùÊ¥ªÔºå‰ΩøÂÖ∂ËÉΩÂ§üÂú®ÂêéÁª≠ÁöÑ NSURLConnection ÁöÑ delegate ‰∏≠Êé•Êî∂ÂõûË∞É„ÄÇÂõ†Ê≠§Ôºå AF2.0 ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™Â∏∏È©ªÂ≠êÁ∫øÁ®ãÔºåÂú®Â≠êÁ∫øÁ®ã‰∏≠ÊâßË°åÁΩëÁªúËØ∑Ê±ÇÂç≥ÂèØ„ÄÇ AF3.0 ‰ΩøÁî® NSURLSessionÔºå‰∏çÂÜçÈúÄË¶ÅÂú®ÂΩìÂâçÁ∫øÁ®ãËøõË°å delegate ÂõûË∞É]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AFNetworking Ê∫êÁ†ÅËß£Êûê - ÂìçÂ∫îÂ∫èÂàóÂåñ]]></title>
    <url>%2F2018%2F12%2F27%2FAFNetworking3%2F</url>
    <content type="text"><![CDATA[Êú¨ÁØáÊòØ AFNetworking Ê∫êÁ†ÅËß£ËØªÁöÑÁ¨¨‰∏âÁØá‰∫Ü„ÄÇ‰∏ªË¶ÅËÆ≤Ëß£Êé•Êî∂Âà∞ÂìçÂ∫îÂêéÁöÑÂ§ÑÁêÜ„ÄÇ AFURLResponseSerialization ÂçèËÆÆAFURLResponseSerialization ÂçèËÆÆÂè™Êúâ‰∏Ä‰∏™ÊñπÊ≥ïÈúÄË¶ÅÂÆûÁé∞Ôºö 123- (nullable id)responseObjectForResponse:(nullable NSURLResponse *)response data:(nullable NSData *)data error:(NSError * _Nullable __autoreleasing *)error NS_SWIFT_NOTHROW; Ëøô‰∏™ÂçèËÆÆ‰ºöÊãøÂà∞ÂìçÂ∫îÂØπË±° NSURLResponse ÔºåÂìçÂ∫îÊï∞ÊçÆ NSData„ÄÇÂèØ‰ª•Ê†πÊçÆ NSURLResponse ËøîÂõûÊï∞ÊçÆÁ±ªÂûãÊ†áËØÜ content-type ÈÄâÂèñÁõ∏Â∫îÁöÑËß£ÊûêÂô®ÔºåÊù•Ëß£Êûê data. AFHTTPResponseSerializer Âü∫Á±ª AFHTTPResponseSerializer ÊòØ‰∏Ä‰∏™Âü∫Á±ªÔºåÊèê‰æõÊúÄÂü∫Êú¨ÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ïÔºåÈíàÂØπ‰∏çÂêå content-type ÁöÑÂìçÂ∫îÊä•ÊñáÔºåÈúÄË¶ÅÂÆû‰æãÂåñ‰∏çÂêåÁöÑÂ≠êÁ±ªËøõË°åËß£Êûê„ÄÇ AFHTTPResponseSerializer Êúâ‰∏§‰∏™ÈáçË¶ÅÁöÑÂ±ûÊÄßÔºö 1234/// ËÆæÁΩÆÊé•Êî∂ÁöÑÁä∂ÊÄÅÁ†ÅÔºå‰∏çÂú®Ê≠§ÂÜÖÁöÑÁä∂ÊÄÅÁ†ÅËøîÂõûÈîôËØØ@property (nonatomic, copy, nullable) NSIndexSet *acceptableStatusCodes;/// ËÆæÁΩÆÊé•ÂèóÁöÑcontent-type@property (nonatomic, copy, nullable) NSSet &lt;NSString *&gt; *acceptableContentTypes; ÂÆÉ‰ª¨‰ºöÂú®ÂàùÂßãÂåñÊñπÊ≥ï‰∏≠ËµãÂÄºÔºö 12345678910111213- (instancetype)init &#123; self = [super init]; if (!self) &#123; return nil; &#125; /// ËÆæÁΩÆiÊé•ÂèóÁöÑËøîÂõûcode Êé•Êî∂ËåÉÂõ¥ÊòØ 200-299 self.acceptableStatusCodes = [NSIndexSet indexSetWithIndexesInRange:NSMakeRange(200, 100)]; /// ËÆæÁΩÆÊé•ÂèóÁöÑËøîÂõûcontent-type ‰∏∫‰ªª‰Ωï type self.acceptableContentTypes = nil; return self;&#125; Âõ†‰∏∫ AFHTTPResponseSerializer ‰∏çÂÅö‰ªª‰ΩïÁ±ªÂûãÊ†°È™åÔºåÂõ†Ê≠§ÂÖ∂ acceptableContentTypes ‰∏∫ nilÔºåË°®Á§∫ÊâÄÊúâÁ±ªÂûãÁöÜÂèØÔºåËøô‰∏™Â±ûÊÄß‰ºöÂú®‰∏çÂêåÂ≠êÁ±ª‰∏≠ËÆæÁΩÆ‰∏∫‰∏çÂêåÁ±ªÂûã„ÄÇ acceptableStatusCodes ÊòØ‰∏Ä‰∏™ NSIndexSet ÂÆû‰æãÔºåÊòØ‰∏Ä‰∏™ÊúâÂ∫èÁöÑÔºåÂîØ‰∏ÄÁöÑÔºåÊó†Á¨¶Âè∑Êï¥Êï∞ÁöÑÈõÜÂêà„ÄÇÊØîÂ¶ÇÔºö 123456NSMutableIndexSet *indexSetM = [NSMutableIndexSet indexSet];[indexSetM addIndex:6];[indexSetM addIndex:8];[indexSetM addIndexesInRange:NSMakeRange(20, 5)];=&gt; [6,8,20,21,22,23,24] addIndexesInRange: ÊñπÊ≥ïÂèØ‰ª•ËÆæÂÆö‰∏Ä‰∏™ËåÉÂõ¥„ÄÇÂõ†Ê≠§‰∏äÈù¢ÁöÑ‰ª£Á†Å‰∏≠ acceptableStatusCodes ‰ª£Ë°®ÁöÑÊòØÂè™Êé•Âèó 200-299 ÁöÑÁä∂ÊÄÅÁ†Å„ÄÇ Ê†πÊçÆ‰∏äÈù¢ÁöÑÊúâÊïàÁä∂ÊÄÅÁ†ÅÂíåÊúâÊïà content-typeÔºåÂü∫Á±ª‰∏≠ËøòÊúâ‰∏Ä‰∏™È™åËØÅÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÈ™åËØÅÊó†ÊïàÔºå‰ºöÊäõÂá∫ NSErrorÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455/// È™åËØÅÊúçÂä°Âô®ËøîÂõûÁöÑÊï∞ÊçÆÔºåÊòØÂê¶Á¨¶ÂêàÊé•Êî∂ÁöÑÁä∂ÊÄÅÁ†ÅÂíå content-type- (BOOL)validateResponse:(NSHTTPURLResponse *)response data:(NSData *)data error:(NSError * __autoreleasing *)error&#123; /// ÈªòËÆ§ÂìçÂ∫îÈÉΩÊòØÊúâÊïàÁöÑ BOOL responseIsValid = YES; NSError *validationError = nil; if (response &amp;&amp; [response isKindOfClass:[NSHTTPURLResponse class]]) &#123; /// Â¶ÇÊûúËÆæÁΩÆ‰∫ÜÊé•ÂèóÁöÑ content-type Âπ∂‰∏îÂìçÂ∫îÁöÑ content-type ‰∏çÂú®ÂÖ∂‰πãÂÜÖÔºåÂπ∂‰∏î response ÁöÑ MIMEType Âíå data ÈÉΩ‰∏ç‰∏∫Á©∫ if (self.acceptableContentTypes &amp;&amp; ![self.acceptableContentTypes containsObject:[response MIMEType]] &amp;&amp; !([response MIMEType] == nil &amp;&amp; [data length] == 0)) &#123; /// ÁîüÊàêÈîôËØØ‰ø°ÊÅØ if ([data length] &gt; 0 &amp;&amp; [response URL]) &#123; NSMutableDictionary *mutableUserInfo = [@&#123; NSLocalizedDescriptionKey: [NSString stringWithFormat:NSLocalizedStringFromTable(@"Request failed: unacceptable content-type: %@", @"AFNetworking", nil), [response MIMEType]], NSURLErrorFailingURLErrorKey:[response URL], AFNetworkingOperationFailingURLResponseErrorKey: response, &#125; mutableCopy]; if (data) &#123; mutableUserInfo[AFNetworkingOperationFailingURLResponseDataErrorKey] = data; &#125; validationError = AFErrorWithUnderlyingError([NSError errorWithDomain:AFURLResponseSerializationErrorDomain code:NSURLErrorCannotDecodeContentData userInfo:mutableUserInfo], validationError); &#125; responseIsValid = NO; &#125; /// Ê†°È™åÂìçÂ∫îÁä∂ÊÄÅÁ†Å if (self.acceptableStatusCodes &amp;&amp; ![self.acceptableStatusCodes containsIndex:(NSUInteger)response.statusCode] &amp;&amp; [response URL]) &#123; NSMutableDictionary *mutableUserInfo = [@&#123; NSLocalizedDescriptionKey: [NSString stringWithFormat:NSLocalizedStringFromTable(@"Request failed: %@ (%ld)", @"AFNetworking", nil), [NSHTTPURLResponse localizedStringForStatusCode:response.statusCode], (long)response.statusCode], NSURLErrorFailingURLErrorKey:[response URL], AFNetworkingOperationFailingURLResponseErrorKey: response, &#125; mutableCopy]; if (data) &#123; mutableUserInfo[AFNetworkingOperationFailingURLResponseDataErrorKey] = data; &#125; validationError = AFErrorWithUnderlyingError([NSError errorWithDomain:AFURLResponseSerializationErrorDomain code:NSURLErrorBadServerResponse userInfo:mutableUserInfo], validationError); responseIsValid = NO; &#125; &#125; if (error &amp;&amp; !responseIsValid) &#123; *error = validationError; &#125; return responseIsValid;&#125; AFJSONResponseSerializerËß£Êûê JSON ÁöÑÂ∫èÂàóÂåñÁ±ª„ÄÇÂÆÉÁöÑ content-type ‰∏∫ @&quot;application/json&quot;, @&quot;text/json&quot;, @&quot;text/javascript&quot; 1234567891011- (instancetype)init &#123; self = [super init]; if (!self) &#123; return nil; &#125; /// Êé•ÂèóÁöÑ content-type ‰∏∫ @"application/json", @"text/json", @"text/javascript" self.acceptableContentTypes = [NSSet setWithObjects:@"application/json", @"text/json", @"text/javascript", nil]; return self;&#125; Â∫èÂàóÂåñÊñπÊ≥ïÈÄöËøá NSJSONSerialization Â∞Ü NSData ËΩ¨‰∏∫ json ÂØπË±°Ôºå‰∏ÄËà¨ÊòØ‰∏Ä‰∏™Â≠óÂÖ∏ÊàñËÄÖÊï∞ÁªÑÔºö 1234567891011121314151617181920212223242526272829303132333435- (id)responseObjectForResponse:(NSURLResponse *)response data:(NSData *)data error:(NSError *__autoreleasing *)error&#123; /// È™åËØÅ response if (![self validateResponse:(NSHTTPURLResponse *)response data:data error:error]) &#123; if (!error || AFErrorOrUnderlyingErrorHasCodeInDomain(*error, NSURLErrorCannotDecodeContentData, AFURLResponseSerializationErrorDomain)) &#123; return nil; &#125; &#125; BOOL isSpace = [data isEqualToData:[NSData dataWithBytes:" " length:1]]; if (data.length == 0 || isSpace) &#123; return nil; &#125; NSError *serializationError = nil; id responseObject = [NSJSONSerialization JSONObjectWithData:data options:self.readingOptions error:&amp;serializationError]; if (!responseObject) &#123; if (error) &#123; *error = AFErrorWithUnderlyingError(serializationError, *error); &#125; return nil; &#125; /// ÁßªÈô§Á©∫ÁöÑ key if (self.removesKeysWithNullValues) &#123; return AFJSONObjectByRemovingKeysWithNullValues(responseObject, self.readingOptions); &#125; return responseObject;&#125; ÊúÄÂêéËøò‰ºöÂà†Èô§Êï∞ÊçÆ‰∏≠ÂÄº‰∏∫ NSNull ÁöÑ keyÔºö 123456789101112131415161718192021222324252627282930313233/// ÁßªÈô§Á©∫ÁöÑ keystatic id AFJSONObjectByRemovingKeysWithNullValues(id JSONObject, NSJSONReadingOptions readingOptions) &#123; /// Â¶ÇÊûúÊòØÊï∞ÁªÑ if ([JSONObject isKindOfClass:[NSArray class]]) &#123; NSMutableArray *mutableArray = [NSMutableArray arrayWithCapacity:[(NSArray *)JSONObject count]]; for (id value in (NSArray *)JSONObject) &#123; /// ÈÄíÂΩíË∞ÉÁî® [mutableArray addObject:AFJSONObjectByRemovingKeysWithNullValues(value, readingOptions)]; &#125; return (readingOptions &amp; NSJSONReadingMutableContainers) ? mutableArray : [NSArray arrayWithArray:mutableArray]; /// Â¶ÇÊûúÂ≠óÂÖ∏ &#125; else if ([JSONObject isKindOfClass:[NSDictionary class]]) &#123; NSMutableDictionary *mutableDictionary = [NSMutableDictionary dictionaryWithDictionary:JSONObject]; /// Âæ™ÁéØÂ≠óÂÖ∏‰∏≠ÊâÄÊúâÁöÑ key for (id &lt;NSCopying&gt; key in [(NSDictionary *)JSONObject allKeys]) &#123; id value = (NSDictionary *)JSONObject[key]; /// Â¶ÇÊûú value ÊòØ NSNull if (!value || [value isEqual:[NSNull null]]) &#123; /// removeObjectForKey [mutableDictionary removeObjectForKey:key]; /// Â¶ÇÊûú value ËøòÊòØÊï∞ÁªÑÊàñËÄÖÂ≠óÂÖ∏Á±ªÂûã &#125; else if ([value isKindOfClass:[NSArray class]] || [value isKindOfClass:[NSDictionary class]]) &#123; /// ÈÄíÂΩíË∞ÉÁî® mutableDictionary[key] = AFJSONObjectByRemovingKeysWithNullValues(value, readingOptions); &#125; &#125; return (readingOptions &amp; NSJSONReadingMutableContainers) ? mutableDictionary : [NSDictionary dictionaryWithDictionary:mutableDictionary]; &#125; return JSONObject;&#125; Ê≥®ÊÑèÔºåÊï∞ÁªÑ‰∏≠ÁöÑÁ©∫ÂØπË±°ÊòØ‰∏ç‰ºöË¢´Âà†Èô§ÁöÑÔºåÂè™‰ºöÂà†Èô§Â≠óÂÖ∏‰∏≠ÁöÑÂÄº‰∏∫ nil ÁöÑÈîÆ AFXMLParserResponseSerializerËß£Êûê xml ÁöÑÂ∫èÂàóÂåñÁ±ª„ÄÇÂÆÉÁöÑ content-type ‰∏∫ @&quot;application/xml&quot;, @&quot;text/xml&quot;: 12345678910- (instancetype)init &#123; self = [super init]; if (!self) &#123; return nil; &#125; self.acceptableContentTypes = [[NSSet alloc] initWithObjects:@"application/xml", @"text/xml", nil]; return self;&#125; ÈÄöËøáÁ≥ªÁªüÁ±ª NSXMLParser Ëß£ÊûêÔºö 123456789101112- (id)responseObjectForResponse:(NSHTTPURLResponse *)response data:(NSData *)data error:(NSError *__autoreleasing *)error&#123; if (![self validateResponse:(NSHTTPURLResponse *)response data:data error:error]) &#123; if (!error || AFErrorOrUnderlyingErrorHasCodeInDomain(*error, NSURLErrorCannotDecodeContentData, AFURLResponseSerializationErrorDomain)) &#123; return nil; &#125; &#125; return [[NSXMLParser alloc] initWithData:data];&#125; AFPropertyListResponseSerializerËß£Êûê plist ÁöÑÂ∫èÂàóÂåñÁ±ª„ÄÇÂÆÉÁöÑ content-type ‰∏∫ @&quot;application/x-plist&quot; 12345678910- (instancetype)init &#123; self = [super init]; if (!self) &#123; return nil; &#125; self.acceptableContentTypes = [[NSSet alloc] initWithObjects:@"application/x-plist", nil]; return self;&#125; ÈÄöËøá NSPropertyListSerialization Ëß£ÊûêÔºö 12345678910111213141516171819202122232425262728- (id)responseObjectForResponse:(NSURLResponse *)response data:(NSData *)data error:(NSError *__autoreleasing *)error&#123; if (![self validateResponse:(NSHTTPURLResponse *)response data:data error:error]) &#123; if (!error || AFErrorOrUnderlyingErrorHasCodeInDomain(*error, NSURLErrorCannotDecodeContentData, AFURLResponseSerializationErrorDomain)) &#123; return nil; &#125; &#125; if (!data) &#123; return nil; &#125; NSError *serializationError = nil; id responseObject = [NSPropertyListSerialization propertyListWithData:data options:self.readOptions format:NULL error:&amp;serializationError]; if (!responseObject) &#123; if (error) &#123; *error = AFErrorWithUnderlyingError(serializationError, *error); &#125; return nil; &#125; return responseObject;&#125; AFImageResponseSerializerËß£Êûê image ÁöÑÂ∫èÂàóÂåñÁ±ª„ÄÇÂÆÉÁöÑ content-type ‰∏∫ @&quot;image/tiff&quot;, @&quot;image/jpeg&quot;, @&quot;image/gif&quot;, @&quot;image/png&quot;, @&quot;image/ico&quot;, @&quot;image/x-icon&quot;, @&quot;image/bmp&quot;, @&quot;image/x-bmp&quot;, @&quot;image/x-xbitmap&quot;, @&quot;image/x-win-bitmap&quot;„ÄÇ ÂÆÉËøòÊúâ‰∏Ä‰∏™Â±ûÊÄß automaticallyInflatesResponseImage Áî®Êù•ËÆæÁΩÆÊòØÂê¶Ëá™Âä®Ëß£Á†ÅÔºö 12345678910111213- (instancetype)init &#123; self = [super init]; if (!self) &#123; return nil; &#125; self.acceptableContentTypes = [[NSSet alloc] initWithObjects:@"image/tiff", @"image/jpeg", @"image/gif", @"image/png", @"image/ico", @"image/x-icon", @"image/bmp", @"image/x-bmp", @"image/x-xbitmap", @"image/x-win-bitmap", nil]; self.imageScale = [[UIScreen mainScreen] scale]; self.automaticallyInflatesResponseImage = YES; return self;&#125; ÂÆÉÁöÑËß£ÊûêÊñπÂºèÂ¶Ç‰∏ãÔºö 1234567891011121314151617- (id)responseObjectForResponse:(NSURLResponse *)response data:(NSData *)data error:(NSError *__autoreleasing *)error&#123; if (![self validateResponse:(NSHTTPURLResponse *)response data:data error:error]) &#123; if (!error || AFErrorOrUnderlyingErrorHasCodeInDomain(*error, NSURLErrorCannotDecodeContentData, AFURLResponseSerializationErrorDomain)) &#123; return nil; &#125; &#125; if (self.automaticallyInflatesResponseImage) &#123; return AFInflatedImageFromResponseWithDataAtScale((NSHTTPURLResponse *)response, data, self.imageScale); &#125; else &#123; return AFImageWithDataAtScale(data, self.imageScale); &#125; return nil;&#125; ÂÖ∂‰∏≠Ê∂âÂèäÂà∞‰∏§‰∏™ÊñπÊ≥ï AFInflatedImageFromResponseWithDataAtScale Âíå AFImageWithDataAtScale„ÄÇÂÖàÊù•ÁúãÂêéËÄÖÔºåÂÆÉÈÄöËøá NSData ÂàõÂª∫ imageÔºö 12345678910111213141516171819202122232425/// ÂàõÂª∫ image+ (UIImage *)af_safeImageWithData:(NSData *)data &#123; UIImage* image = nil; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; imageLock = [[NSLock alloc] init]; &#125;); [imageLock lock]; image = [UIImage imageWithData:data]; [imageLock unlock]; return image;&#125;@end/// data scale ÂàõÂª∫ imagestatic UIImage * AFImageWithDataAtScale(NSData *data, CGFloat scale) &#123; UIImage *image = [UIImage af_safeImageWithData:data]; if (image.images) &#123; return image; &#125; return [[UIImage alloc] initWithCGImage:[image CGImage] scale:scale orientation:image.imageOrientation];&#125; ‰∏äÈù¢ÂàõÂª∫ÂõæÁâáÁöÑÊñπÂºèÊØîËæÉÊôÆÈÄöÔºå‰∏çÂ§™ËÉΩÁêÜËß£‰∏∫‰ªÄ‰πàË¶ÅÂä†ÈîÅ„ÄÇÁÑ∂ÂêéÊòØ AFInflatedImageFromResponseWithDataAtScale Ôºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394/// Â∞ÜpngÂíåjpegÂõæÁâáËß£Á†Åstatic UIImage * AFInflatedImageFromResponseWithDataAtScale(NSHTTPURLResponse *response, NSData *data, CGFloat scale) &#123; if (!data || [data length] == 0) &#123; return nil; &#125; CGImageRef imageRef = NULL; CGDataProviderRef dataProvider = CGDataProviderCreateWithCFData((__bridge CFDataRef)data); if ([response.MIMEType isEqualToString:@"image/png"]) &#123; imageRef = CGImageCreateWithPNGDataProvider(dataProvider, NULL, true, kCGRenderingIntentDefault); &#125; else if ([response.MIMEType isEqualToString:@"image/jpeg"]) &#123; imageRef = CGImageCreateWithJPEGDataProvider(dataProvider, NULL, true, kCGRenderingIntentDefault); if (imageRef) &#123; CGColorSpaceRef imageColorSpace = CGImageGetColorSpace(imageRef); CGColorSpaceModel imageColorSpaceModel = CGColorSpaceGetModel(imageColorSpace); // CGImageCreateWithJPEGDataProvider does not properly handle CMKY, so fall back to AFImageWithDataAtScale if (imageColorSpaceModel == kCGColorSpaceModelCMYK) &#123; CGImageRelease(imageRef); imageRef = NULL; &#125; &#125; &#125; CGDataProviderRelease(dataProvider); UIImage *image = AFImageWithDataAtScale(data, scale); if (!imageRef) &#123; if (image.images || !image) &#123; return image; &#125; imageRef = CGImageCreateCopy([image CGImage]); if (!imageRef) &#123; return nil; &#125; &#125; size_t width = CGImageGetWidth(imageRef); size_t height = CGImageGetHeight(imageRef); size_t bitsPerComponent = CGImageGetBitsPerComponent(imageRef); /// Â¶ÇÊûúÂõæÁâáÂ§™Â§ßÂ∞±‰∏çËß£Á†Å‰∫Ü„ÄÇÂõ†‰∏∫Ëß£Á†ÅÁöÑÂõæÁâáÂæàÂç†ÂÜÖÂ≠ò if (width * height &gt; 1024 * 1024 || bitsPerComponent &gt; 8) &#123; CGImageRelease(imageRef); return image; &#125; // CGImageGetBytesPerRow() calculates incorrectly in iOS 5.0, so defer to CGBitmapContextCreate /// Ëß£Á†ÅÁõ∏ÂÖ≥ÊñπÊ≥ï size_t bytesPerRow = 0; CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB(); CGColorSpaceModel colorSpaceModel = CGColorSpaceGetModel(colorSpace); CGBitmapInfo bitmapInfo = CGImageGetBitmapInfo(imageRef); if (colorSpaceModel == kCGColorSpaceModelRGB) &#123; uint32_t alpha = (bitmapInfo &amp; kCGBitmapAlphaInfoMask);#pragma clang diagnostic push#pragma clang diagnostic ignored "-Wassign-enum" if (alpha == kCGImageAlphaNone) &#123; bitmapInfo &amp;= ~kCGBitmapAlphaInfoMask; bitmapInfo |= kCGImageAlphaNoneSkipFirst; &#125; else if (!(alpha == kCGImageAlphaNoneSkipFirst || alpha == kCGImageAlphaNoneSkipLast)) &#123; bitmapInfo &amp;= ~kCGBitmapAlphaInfoMask; bitmapInfo |= kCGImageAlphaPremultipliedFirst; &#125;#pragma clang diagnostic pop &#125; CGContextRef context = CGBitmapContextCreate(NULL, width, height, bitsPerComponent, bytesPerRow, colorSpace, bitmapInfo); CGColorSpaceRelease(colorSpace); if (!context) &#123; CGImageRelease(imageRef); return image; &#125; CGContextDrawImage(context, CGRectMake(0.0f, 0.0f, width, height), imageRef); CGImageRef inflatedImageRef = CGBitmapContextCreateImage(context); CGContextRelease(context); UIImage *inflatedImage = [[UIImage alloc] initWithCGImage:inflatedImageRef scale:scale orientation:image.imageOrientation]; CGImageRelease(inflatedImageRef); CGImageRelease(imageRef); return inflatedImage;&#125; Ëøô‰∏™ÊñπÊ≥ïËÉΩËß£Êûê png Âíå jpeg ÂõæÁâáÔºå‰ºöÂ∞ÜÂõæÁâáËß£Á†ÅÔºåËøôÊ†∑ËÉΩÂä†ÈÄüÂõæÁâáÁöÑÊòæÁ§∫ÈÄüÂ∫¶„ÄÇ AFCompoundResponseSerializerÂ§çÂêàÁ±ªÂûãÁöÑÂ∫èÂàóÂåñÂô®„ÄÇÂú®ÂàõÂª∫ÁöÑÊó∂ÂÄôÈúÄË¶Å‰º†ÂÖ•‰∏äÈù¢ÁöÑÂêÑÁßçÂ∫èÂàóÂåñÊñπÂºèÁöÑÂÆû‰æãÔºö 123456+ (instancetype)compoundSerializerWithResponseSerializers:(NSArray *)responseSerializers &#123; AFCompoundResponseSerializer *serializer = [[self alloc] init]; serializer.responseSerializers = responseSerializers; return serializer;&#125; Âú®Ëé∑ÂèñÂà∞ÂìçÂ∫î‰ø°ÊÅØÁöÑÊó∂ÂÄô‰ºöË∞ÉÁî®ÂÜÖÈÉ®ÁöÑÂêÑÁßçÂ∫èÂàóÂåñÂô®Â∞ùËØïËΩ¨Êç¢Ôºö 12345678910111213141516171819202122- (id)responseObjectForResponse:(NSURLResponse *)response data:(NSData *)data error:(NSError *__autoreleasing *)error&#123; for (id &lt;AFURLResponseSerialization&gt; serializer in self.responseSerializers) &#123; if (![serializer isKindOfClass:[AFHTTPResponseSerializer class]]) &#123; continue; &#125; NSError *serializerError = nil; id responseObject = [serializer responseObjectForResponse:response data:data error:&amp;serializerError]; if (responseObject) &#123; if (error) &#123; *error = AFErrorWithUnderlyingError(serializerError, *error); &#125; return responseObject; &#125; &#125; return [super responseObjectForResponse:response data:data error:error];&#125; ÊÄªÁªìÊÄª‰ΩìÊù•ËØ¥ÔºåÂìçÂ∫îÁöÑÂ∫èÂàóÂåñÁ±ª‰∏çÂÉèËØ∑Ê±ÇÈÇ£Ê†∑Ê∂âÂèäÂà∞ËæìÂÖ•ÊµÅÔºåÂõ†Ê≠§ËøòÊòØÊØîËæÉÊ∏ÖÊô∞ÁÆÄÂçïÁöÑ„ÄÇÂè™Ë¶ÅÈíàÂØπ‰∏çÂêåÁöÑ content-type ÈÄâÂèñ‰∏çÂêåÁöÑÁ≥ªÁªüÁ±ªËøõË°åËß£ÊûêÂç≥ÂèØ„ÄÇ ÈíàÂØπÂõæÁâáÊ†ºÂºèÔºåAFNetworking ÂÅö‰∫Ü‰∏ÄÈÉ®ÂàÜÂõæÁâáËß£Á†ÅËΩ¨Êç¢ÁöÑÂäüËÉΩÔºå‰ΩÜÊòØÂíå SDWebImage Áõ∏ÊØîËøòÊòØÁÆÄÂçï‰∫ÜÂæàÂ§ö„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AFNetworking Ê∫êÁ†ÅËß£Êûê - ËØ∑Ê±ÇÂ∫èÂàóÂåñ]]></title>
    <url>%2F2018%2F12%2F25%2FAFNetworking2%2F</url>
    <content type="text"><![CDATA[Êú¨ÁØáÊòØ AFNetworking Ê∫êÁ†ÅËß£ÊûêÁöÑÁ¨¨‰∫åÊâπÔºå‰∏ªË¶ÅËÆ≤Ëß£Â¶Ç‰ΩïÁîüÊàêËØ∑Ê±Ç request„ÄÇËØ∑Ê±ÇÁöÑÂ∫èÂàóÂåñËøáÁ®ãÊòØÈùûÂ∏∏ÈáçË¶ÅÁöÑ‰∏Ä‰∏™ËøáÁ®ãÔºåÊ∂âÂèäÂà∞Â§öÁßçÂ§ÑÁêÜÂíåÊï∞ÊçÆÁªìÊûÑ„ÄÇËá™È°∂Âêë‰∏ãÂàÜÊûêÈöæÂ∫¶ËæÉÂ§ßÔºåÂõ†Ê≠§Êú¨ÁØáÂ∞ÜÂÖàÂàÜÊûêÊúÄÂ∫ïÂ±ÇÁöÑÁ±ª„ÄÇ Ê∂âÂèäÂà∞ÁöÑÁ±ªAFQueryStringPairËØ•Á±ªÁî®‰∫é‰øùÂ≠òËØ∑Ê±ÇË¶ÅÂèëÈÄÅÁöÑÂèÇÊï∞Ôºå‰ªé‰ªñÁöÑÂ§¥Êñá‰ª∂‰∏≠ÁöÑÂ±ûÊÄßÂèØ‰ª•ÁúãÂá∫Ôºö 1234@interface AFQueryStringPair : NSObject@property (readwrite, nonatomic, strong) id field;@property (readwrite, nonatomic, strong) id value;@end field Âíå value Â∞±‰ª£Ë°®ÁùÄËØ∑Ê±ÇÂèÇÊï∞ÁöÑÈîÆÂÄºÂØπ„ÄÇÂÆÉÊúâ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÁî®‰∫éÂ∞ÜÂèÇÊï∞ËΩ¨Âåñ‰∏∫ÂèëÈÄÅËØ∑Ê±ÇÊó∂ÁöÑÂ≠óÁ¨¶‰∏≤Ê†∑Âºè‰ª•Á≠âÂè∑ËøûÊé•„ÄÇÂÆÉÂèØ‰ª•Âú® get ËØ∑Ê±ÇÊó∂Ë¢´ÊãºÊé•Âà∞ url ‰∏≠‰πüÂèØ‰ª•Âú® post ËØ∑Ê±ÇÊó∂‰Ωú‰∏∫ËØ∑Ê±Ç‰ΩìÊîæÂà∞ body ‰∏≠Ôºö 12345678/// field value Áî® = ËøûÊé•- (NSString *)URLEncodedStringValue &#123; if (!self.value || [self.value isEqual:[NSNull null]]) &#123; return AFPercentEscapedStringFromString([self.field description]); &#125; else &#123; return [NSString stringWithFormat:@"%@=%@", AFPercentEscapedStringFromString([self.field description]), AFPercentEscapedStringFromString([self.value description])]; &#125;&#125; ÂÖ∂‰∏≠Ê∂âÂèäÂà∞‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ï AFPercentEscapedStringFromString()ÔºåÂÆÉË¢´Áî®Êù•Â∞ÜÂ≠óÁ¨¶‰∏≤ÁºñÁ†Å„ÄÇÂú® url ‰∏≠ÔºåÂè™ËÉΩÂ≠òÂú®Êï∞Â≠óÂ≠óÊØç‰ª•Âèä -_.~ Âõõ‰∏™ÁâπÊÆäÁ¨¶Âè∑ÔºåÂÖ∂‰ªñÁöÑÁ¨¶Âè∑ÈÉΩÈúÄË¶ÅÈÄöËøáÁôæÂàÜÂè∑ËΩ¨Á†ÅÔºåÊØîÂ¶Ç ! Ë¶ÅË¢´ËΩ¨Á†Å‰∏∫ %21Ôºå= Ë¶ÅË¢´ËΩ¨Á†Å‰∏∫ %3D„ÄÇ AFPercentEscapedStringFromString() ‰ºöÂ∞ÜÂ≠óÁ¨¶‰∏≤ÂàÜÂâ≤ÊàêÊï∞‰∏™Â∞èÁ´ØÔºåÊØè‰∏™Â∞èÁ´ØÂàÜÂà´ËøõË°åÁºñÁ†Å„ÄÇÁºñÁ†ÅÁöÑÂ∑•‰Ωú‰∏ªË¶Å‰ΩøÁî®ÁöÑÊòØ NSString ÁöÑ stringByAddingPercentEncodingWithAllowedCharacters: ÊñπÊ≥ï„ÄÇËøòÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂØπ‰∫é emoji Ë°®ÊÉÖÔºå‰∏Ä‰∏™ emoji Ë°®ÊÉÖÂ∞ÜÂç†Áî®‰∏§‰∏™Â≠óÁ¨¶ÁöÑÂ§ßÂ∞è„ÄÇÂõ†Ê≠§ÔºåÂú®ÂàÜÂâ≤Â≠óÁ¨¶‰∏≤ÁöÑÊó∂ÂÄôÔºåËøòÈúÄË¶ÅÂØπ emoji Âú®ËæπÁïåÁöÑÊÉÖÂÜµÂÅö‰∏Ä‰∏™Â§ÑÁêÜÔºåÈò≤Ê≠¢ÂäàÂºÄ emoji Ë°®ÊÉÖÔºö 123456789101112131415161718192021222324252627282930313233#pragma mark - Â∞ÜÂ≠óÁ¨¶‰∏≤ÁºñÁ†ÅNSString * AFPercentEscapedStringFromString(NSString *string) &#123; static NSString * const kAFCharactersGeneralDelimitersToEncode = @":#[]@"; // does not include "?" or "/" due to RFC 3986 - Section 3.4 static NSString * const kAFCharactersSubDelimitersToEncode = @"!$&amp;'()*+,;="; NSMutableCharacterSet * allowedCharacterSet = [[NSCharacterSet URLQueryAllowedCharacterSet] mutableCopy]; /// ‰ªéÂÖÅËÆ∏ÁöÑ‰∏çË¶ÅÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≠ÁßªÈô§üëÜÁöÑÈÇ£‰∫õÂ≠óÁ¨¶ [allowedCharacterSet removeCharactersInString:[kAFCharactersGeneralDelimitersToEncode stringByAppendingString:kAFCharactersSubDelimitersToEncode]]; static NSUInteger const batchSize = 50; NSUInteger index = 0; NSMutableString *escaped = @"".mutableCopy; /// Âæ™ÁéØÊØè50‰∏™Â≠óÁ¨¶ËøõË°å‰∏ÄÊ¨°ÁºñÁ†Å while (index &lt; string.length) &#123; NSUInteger length = MIN(string.length - index, batchSize); NSRange range = NSMakeRange(index, length); // To avoid breaking up character sequences such as üë¥üèªüëÆüèΩ /// ‰∏Ä‰∏™ emoji ‰ª£Ë°®Â§ö‰∏™Â≠óÁ¨¶ÔºåÂõ†Ê≠§Ë¶ÅÈÄöËøáËøô‰∏™ÊñπÊ≥ïÁ∫†Ê≠£ÔºåÈò≤Ê≠¢ÂäàÂºÄ emoji Ë°®ÊÉÖ range = [string rangeOfComposedCharacterSequencesForRange:range]; NSString *substring = [string substringWithRange:range]; /// Â∞ÜÂ≠óÁ¨¶‰∏≤ÁºñÁ†Å NSString *encoded = [substring stringByAddingPercentEncodingWithAllowedCharacters:allowedCharacterSet]; [escaped appendString:encoded]; index += range.length; &#125; return escaped;&#125; AFHTTPBodyPart‰∏ÄËà¨ËØ∑Ê±Ç‰∏ç‰ºöÁî®Âà∞Ëøô‰∏™Á±ªÔºåÂΩìËØ∑Ê±ÇÁ±ªÂûã‰∏∫ multipart/form-data ÁöÑÊó∂ÂÄôÔºå‰ºöÂàõÂª∫Â§ö‰∏™ AFHTTPBodyPart ÂØπË±°ÔºåÊØè‰∏Ä‰∏™ÂØπË±°‰ºöÊúâ‰∏Ä‰∏™ NSInputStream ËæìÂÖ•ÊµÅÔºåÂú®ÁîüÊàêËØ∑Ê±ÇÁöÑÊó∂ÂÄôÂØºÂÖ•Âà∞ request ‰∏≠„ÄÇ Â§¥Êñá‰ª∂AFHTTPBodyPart ‰øùÂ≠ò‰∫Ü HTTP bodyÁöÑÂÖ®ÈÉ®ÁöÑ‰ø°ÊÅØ„ÄÇÊù•ÁúãÂÆÉÁöÑÂ§¥ÈÉ®‰ø°ÊÅØÔºö 1234567891011121314151617181920212223@interface AFHTTPBodyPart : NSObject/// ÁºñÁ†ÅÊñπÂºè@property (nonatomic, assign) NSStringEncoding stringEncoding;/// Â§¥@property (nonatomic, strong) NSDictionary *headers;/// ËæπÁïåÂ≠óÁ¨¶‰∏≤@property (nonatomic, copy) NSString *boundary;/// ‰∏ª‰ΩìÂÜÖÂÆπ@property (nonatomic, strong) id body;/// ‰∏ª‰ΩìÂ§ßÂ∞è@property (nonatomic, assign) unsigned long long bodyContentLength;/// ËæìÂÖ•ÊµÅ@property (nonatomic, strong) NSInputStream *inputStream;/// ÊòØÂê¶ÊúâÂàùÂßãËæπÁïå@property (nonatomic, assign) BOOL hasInitialBoundary;@property (nonatomic, assign) BOOL hasFinalBoundary;/// ÊòØÂê¶ËøòËÉΩ‰ªéËæìÂÖ•ÊµÅ‰∏≠ËØªÂèñdata@property (readonly, nonatomic, assign, getter = hasBytesAvailable) BOOL bytesAvailable;/// ÊÄª‰ΩìÁöÑÈïøÂ∫¶@property (readonly, nonatomic, assign) unsigned long long contentLength;@end ÂÆÉÁöÑÁ±ªÊãìÂ±ï‰∏≠ËøòÊèê‰æõ‰∫ÜÂá†‰∏™Â±ûÊÄß‰ΩúÁî®‰∫éËØªÂèñÊï∞ÊçÆÈò∂ÊÆµÔºö 12345678@interface AFHTTPBodyPart () &lt;NSCopying&gt; &#123; /// body ‰∏≠ÂõõÂ§ßÈÉ®ÂàÜÁöÑÊûö‰∏æ AFHTTPBodyPartReadPhase _phase; /// ËæìÂÖ•ÊµÅ NSInputStream *_inputStream; /// ËØªÂèñÁöÑÂΩìÂâç‰ΩçÁΩÆ unsigned long long _phaseReadOffset;&#125; ÂÖ∂‰∏≠Êûö‰∏æÁ±ªÂûã‰∏∫„ÄÇÂ∞ÜÂú®‰∏ãÈù¢ËÆ≤Ëß£ÊñπÊ≥ïÁöÑÊó∂ÂÄôÁúãÂà∞Ôºö 12345678910typedef enum &#123; /// ÂâçËæπÁïåÈò∂ÊÆµ AFEncapsulationBoundaryPhase = 1, /// Â§¥ÈÉ®Èò∂ÊÆµ AFHeaderPhase = 2, /// bodyÈò∂ÊÆµ AFBodyPhase = 3, /// ÂêéËæπÁïåÈò∂ÊÆµ AFFinalBoundaryPhase = 4,&#125; AFHTTPBodyPartReadPhase; ÊñπÊ≥ïinputStreamÊé•ÁùÄ‰æùÊ¨°Áúã AFHTTPBodyPart ÁöÑÊñπÊ≥ï„ÄÇÈ¶ñÂÖàÊòØ inputStream ÁöÑ get ÊñπÊ≥ïÔºö 1234567891011121314151617/// inputStream ÁöÑ get ÊñπÊ≥ï- (NSInputStream *)inputStream &#123; if (!_inputStream) &#123; /// body Êúâ NSData NSURL NSInputStream ‰∏âÁßçÁ±ªÂûã if ([self.body isKindOfClass:[NSData class]]) &#123; _inputStream = [NSInputStream inputStreamWithData:self.body]; &#125; else if ([self.body isKindOfClass:[NSURL class]]) &#123; _inputStream = [NSInputStream inputStreamWithURL:self.body]; &#125; else if ([self.body isKindOfClass:[NSInputStream class]]) &#123; _inputStream = self.body; &#125; else &#123; _inputStream = [NSInputStream inputStreamWithData:[NSData data]]; &#125; &#125; return _inputStream;&#125; ÂÆÉ‰ºöÊää body ËΩ¨Âåñ‰∏∫ NSInputStream ÔºåÊó†ËÆ∫ body ÂéüÊú¨ÊòØ NSData Á±ªÂûãÔºåNSURL Á±ªÂûãËøòÊòØ NSInputStream Á±ªÂûã„ÄÇ stringForHeadersstringForHeaders ÊñπÊ≥ïÂ∞Ü headers Â≠óÂÖ∏ËΩ¨Âåñ‰∏∫Â≠óÁ¨¶‰∏≤Ôºö 123456789101112/// Ê†πÊçÆ self ÁöÑ header Â≠óÂÖ∏Â±ûÊÄßÊù•ÊãºÊé• header Â≠óÁ¨¶‰∏≤- (NSString *)stringForHeaders &#123; NSMutableString *headerString = [NSMutableString string]; for (NSString *field in [self.headers allKeys]) &#123; /// ÊØè‰∏™Â§¥ÈÉ®ÂèÇÊï∞ÁöÑÈîÆÂÄºÂØπÁªìÊùüÂêéÊèíÂÖ•Êç¢Ë°å CRLF [headerString appendString:[NSString stringWithFormat:@"%@: %@%@", field, [self.headers valueForKey:field], kAFMultipartFormCRLF]]; &#125; /// ÊâÄÊúâÂ§¥ÈÉ®ÂèÇÊï∞ÁªìÊùüÂêéÔºåÂÜçÊèíÂÖ•‰∏Ä‰∏™Êç¢Ë°åÁ¨¶ CRLF [headerString appendString:kAFMultipartFormCRLF]; return [NSString stringWithString:headerString];&#125; ËøôÈáåÁöÑ header ‰∏çÊòØ request headerÔºåËÄåÊòØ request body ‰∏≠ÁöÑ header„ÄÇ‰∏ãÈù¢‰ºöÊúâ‰∏æ‰æã contentLengthcontentLength Áî®‰∫éËÆ°ÁÆó HTTP body ÁöÑÊï¥‰ΩìÈïøÂ∫¶„ÄÇbody ÂåÖÂê´Âõõ‰∏™ÈÉ®ÂàÜÔºåÂàÜÂà´ÂØπÂ∫î‰∫é‰∏äÈù¢ÁöÑ AFHTTPBodyPartReadPhase Êûö‰∏æÔºö 12345678910111213141516171819202122/// ÊÄª‰ΩìÁöÑÈïøÂ∫¶- (unsigned long long)contentLength &#123; unsigned long long length = 0; /// ÂâçËæπÁïåËØªÂèñ /// Â¶ÇÊûúÊï∞ÊçÆ‰ΩìÊòØÁ¨¨‰∏Ä‰∏™Êï∞ÊçÆ‰ΩìÔºåÈÇ£‰πàÂàôÊèíÂÖ•È¶ñÂàÜÈöîÂ≠óÁ¨¶‰∏≤ÔºåÂê¶ÂàôÔºåÂ∞±ÊèíÂÖ•‰∏≠Èó¥ÂàÜÈöîÂ≠óÁ¨¶‰∏≤ÔºåÂêéËÄÖÊØîÂâçËÄÖÂ§ö‰∫Ü‰∏Ä‰∏™ÂõûËΩ¶Êç¢Ë°åÁ¨¶ \r\n NSData *encapsulationBoundaryData = [([self hasInitialBoundary] ? AFMultipartFormInitialBoundary(self.boundary) : AFMultipartFormEncapsulationBoundary(self.boundary)) dataUsingEncoding:self.stringEncoding]; length += [encapsulationBoundaryData length]; /// Â§¥ÈÉ®ËØªÂèñ NSData *headersData = [[self stringForHeaders] dataUsingEncoding:self.stringEncoding]; length += [headersData length]; /// Âä†‰∏ä body ÁöÑÈïøÂ∫¶ length += _bodyContentLength; /// Â∞æËæπÁïåËØªÂèñ NSData *closingBoundaryData = ([self hasFinalBoundary] ? [AFMultipartFormFinalBoundary(self.boundary) dataUsingEncoding:self.stringEncoding] : [NSData data]); length += [closingBoundaryData length]; return length;&#125; ËøôÈáåÊ∂âÂèäÂà∞‰ª•‰∏ãÂõõ‰∏™ÊñπÊ≥ïÔºö 12345678910111213141516171819202122/// ÁîüÊàêÈöèÊú∫ boundary Â≠óÁ¨¶‰∏≤static NSString * AFCreateMultipartFormBoundary() &#123; return [NSString stringWithFormat:@"Boundary+%08X%08X", arc4random(), arc4random()];&#125;/// ÂàÜË°åÁ¨¶static NSString * const kAFMultipartFormCRLF = @"\r\n";/// ÁîüÊàêÂàùÂßãËæπÁïåÂ≠óÁ¨¶‰∏≤static inline NSString * AFMultipartFormInitialBoundary(NSString *boundary) &#123; return [NSString stringWithFormat:@"--%@%@", boundary, kAFMultipartFormCRLF];&#125;/// ÁîüÊàê‰∏≠Èó¥ËæπÁïåÂ≠óÁ¨¶‰∏≤ ÂíåÂàùÂßãÂ≠óÁ¨¶‰∏≤Áõ∏ÊØîÂ§ö‰∫ÜÂâçÈÉ®ÁöÑ \r\nstatic inline NSString * AFMultipartFormEncapsulationBoundary(NSString *boundary) &#123; return [NSString stringWithFormat:@"%@--%@%@", kAFMultipartFormCRLF, boundary, kAFMultipartFormCRLF];&#125;/// ÁîüÊàêÁªìÊùüËæπÁïåÂ≠óÁ¨¶‰∏≤static inline NSString * AFMultipartFormFinalBoundary(NSString *boundary) &#123; return [NSString stringWithFormat:@"%@--%@--%@", kAFMultipartFormCRLF, boundary, kAFMultipartFormCRLF];&#125; Áî®Êù•ÁîüÊàê‰∏çÂêåÊÉÖÂÜµ‰∏ãÁöÑ boundary„ÄÇÂÖ∑‰Ωì‰ΩúÁî®Â∞ÜÂú® read:maxLength: ËÆ≤Ëß£„ÄÇ hasBytesAvailableAFHTTPBodyPart ‰∏≠Êúâ‰∏Ä‰∏™ËæìÂÖ•ÊµÅ NSInputStream ÂÆû‰æãÔºåËøô‰∏™ÊñπÊ≥ïÂ∞±ÊòØÁî®Êù•Êü•ÁúãËæìÂÖ•ÊµÅ‰∏≠ÊòØÂê¶ËøòÊúâÂèØÁî®Êï∞ÊçÆÁöÑ„ÄÇÊ†πÊçÆËæìÂÖ•ÊµÅÁöÑÁä∂ÊÄÅÂà§Êñ≠Ôºö 123456789101112131415161718192021/// ÊòØÂê¶ËøòÊúâÊï∞ÊçÆÂèØËØª- (BOOL)hasBytesAvailable &#123; // Allows `read:maxLength:` to be called again if `AFMultipartFormFinalBoundary` doesn't fit into the available buffer if (_phase == AFFinalBoundaryPhase) &#123; return YES; &#125; switch (self.inputStream.streamStatus) &#123; case NSStreamStatusNotOpen: case NSStreamStatusOpening: case NSStreamStatusOpen: case NSStreamStatusReading: case NSStreamStatusWriting: return YES; case NSStreamStatusAtEnd: case NSStreamStatusClosed: case NSStreamStatusError: default: return NO; &#125;&#125; transitionToNextPhaseËøôÈáåÁî®Âà∞‰∫Ü‰∏äÈù¢ÁöÑÊûö‰∏æÂØπË±°„ÄÇÊ†πÊçÆÂΩìÂâçÊâÄÂ§ÑÈò∂ÊÆµÔºåÂ∞ÜÈò∂ÊÆµËÆæÁΩÆ‰∏∫‰∏ã‰∏ÄÈò∂ÊÆµÔºö 1234567891011121314151617181920212223242526272829303132333435/// ËΩ¨ÁßªÂà∞‰∏ã‰∏ÄÈò∂ÊÆµ- (BOOL)transitionToNextPhase &#123; /// ‰øùËØÅ‰ª£Á†ÅÂú®‰∏ªÁ∫øÁ®ã if (![[NSThread currentThread] isMainThread]) &#123; dispatch_sync(dispatch_get_main_queue(), ^&#123; [self transitionToNextPhase]; &#125;); return YES; &#125; switch (_phase) &#123; case AFEncapsulationBoundaryPhase: _phase = AFHeaderPhase; break; case AFHeaderPhase: /// ÊâìÂºÄ‰∫Ü‰∏Ä‰∏™ËæìÂÖ•ÊµÅ [self.inputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes]; [self.inputStream open]; _phase = AFBodyPhase; break; case AFBodyPhase: /// Â∞ÜËæìÂÖ•ÊµÅÂÖ≥Èó≠ [self.inputStream close]; _phase = AFFinalBoundaryPhase; break; case AFFinalBoundaryPhase: default: _phase = AFEncapsulationBoundaryPhase; break; &#125; /// ÈáçÁΩÆ offset _phaseReadOffset = 0; return YES;&#125; read:maxLength:ËøôÊòØ AFHTTPBodyPart ÁöÑÊ†∏ÂøÉÊñπÊ≥ï„ÄÇAFHTTPBodyPart Â∞ÅË£Ö‰∫Ü multipart/form-data ÊÉÖÂÜµ‰∏ã body ‰∏≠ÁöÑÈÉ®ÂàÜÊï∞ÊçÆ„ÄÇÈÇ£‰πàÂú®ÂèëÈÄÅÁöÑÊó∂ÂÄô‰∏ÄÂÆöË¶ÅÊääÂÆÉËØªÂá∫Êù•Âêß„ÄÇread:maxLength: ÁöÑÁõÆÁöÑÂ∞±ÊòØÂ¶ÇÊ≠§ÔºåÂ∞ÜÊï∞ÊçÆÊîæÂÖ• buffer ‰∏≠Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465/// ËØªÂèñ buffer- (NSInteger)read:(uint8_t *)buffer maxLength:(NSUInteger)length&#123; /// Â∑≤ÁªèËØªÂèñÁöÑÂ≠óËäÇÊï∞ NSInteger totalNumberOfBytesRead = 0; /// ÂâçËæπÁïåËØªÂèñ /// Â¶ÇÊûúÊï∞ÊçÆ‰ΩìÊòØÁ¨¨‰∏Ä‰∏™Êï∞ÊçÆ‰ΩìÔºåÈÇ£‰πàÂàôÊèíÂÖ•È¶ñÂàÜÈöîÂ≠óÁ¨¶‰∏≤ÔºåÂê¶ÂàôÔºåÂ∞±ÊèíÂÖ•‰∏≠Èó¥ÂàÜÈöîÂ≠óÁ¨¶‰∏≤ÔºåÂêéËÄÖÊØîÂâçËÄÖÂ§ö‰∫Ü‰∏Ä‰∏™ÂõûËΩ¶Êç¢Ë°åÁ¨¶ \r\n if (_phase == AFEncapsulationBoundaryPhase) &#123; NSData *encapsulationBoundaryData = [([self hasInitialBoundary] ? AFMultipartFormInitialBoundary(self.boundary) : AFMultipartFormEncapsulationBoundary(self.boundary)) dataUsingEncoding:self.stringEncoding]; totalNumberOfBytesRead += [self readData:encapsulationBoundaryData intoBuffer:&amp;buffer[totalNumberOfBytesRead] maxLength:(length - (NSUInteger)totalNumberOfBytesRead)]; &#125; /// Â§¥ÈÉ®‰ø°ÊÅØËØªÂèñ if (_phase == AFHeaderPhase) &#123; NSData *headersData = [[self stringForHeaders] dataUsingEncoding:self.stringEncoding]; totalNumberOfBytesRead += [self readData:headersData intoBuffer:&amp;buffer[totalNumberOfBytesRead] maxLength:(length - (NSUInteger)totalNumberOfBytesRead)]; &#125; /// Êï∞ÊçÆ‰ΩìËØªÂèñ /// Ë∞ÉÁî®ËæìÂÖ•ÊµÅËøõË°åÊï∞ÊçÆËØªÂèñ if (_phase == AFBodyPhase) &#123; NSInteger numberOfBytesRead = 0; numberOfBytesRead = [self.inputStream read:&amp;buffer[totalNumberOfBytesRead] maxLength:(length - (NSUInteger)totalNumberOfBytesRead)]; if (numberOfBytesRead == -1) &#123; return -1; &#125; else &#123; totalNumberOfBytesRead += numberOfBytesRead; /// Â¶ÇÊûúËØªÂà∞‰∫ÜÊµÅÁöÑÊú´Â∞æÔºåÈÇ£‰πàËøõÂÖ•‰∏ã‰∏Ä‰∏™ËØªÂèñÈò∂ÊÆµ if ([self.inputStream streamStatus] &gt;= NSStreamStatusAtEnd) &#123; [self transitionToNextPhase]; &#125; &#125; &#125; /// ÂêéËæπÁïåËØªÂèñ /// Â¶ÇÊûúÊï∞ÊçÆ‰ΩìÊòØÊúÄÂêé‰∏Ä‰∏™Êï∞ÊçÆÔºåÈÇ£‰πàÊèíÂÖ•ÂêéËæπÁïåÂ≠óÁ¨¶‰∏≤ÔºåÂê¶ÂàôÔºåÊèíÂÖ•Á©∫ÂÄº if (_phase == AFFinalBoundaryPhase) &#123; NSData *closingBoundaryData = ([self hasFinalBoundary] ? [AFMultipartFormFinalBoundary(self.boundary) dataUsingEncoding:self.stringEncoding] : [NSData data]); totalNumberOfBytesRead += [self readData:closingBoundaryData intoBuffer:&amp;buffer[totalNumberOfBytesRead] maxLength:(length - (NSUInteger)totalNumberOfBytesRead)]; &#125; /// ÊúÄÂêéËøîÂõûËØªÂèñÂà∞ÁöÑÊâÄÊúâÊï∞ÊçÆÁöÑÂ≠óËäÇÊï∞ return totalNumberOfBytesRead;&#125;/// ËØªÂèñ data Âà∞ buffer ‰∏≠- (NSInteger)readData:(NSData *)data intoBuffer:(uint8_t *)buffer maxLength:(NSUInteger)length&#123; NSRange range = NSMakeRange((NSUInteger)_phaseReadOffset, MIN([data length] - ((NSUInteger)_phaseReadOffset), length)); [data getBytes:buffer range:range]; _phaseReadOffset += range.length; ///Â¶ÇÊûúÂÅèÁßªÈáèÂ§ß‰∫éÁ≠â‰∫éÊï∞ÊçÆÁöÑÈïøÂ∫¶ÔºåËØ¥ÊòéÊï∞ÊçÆËØªÂèñÂÆåÊØïÔºåÂèØ‰ª•ËøõÂÖ•‰∏ã‰∏Ä‰∏™Èò∂ÊÆµ if (((NSUInteger)_phaseReadOffset) &gt;= [data length]) &#123; [self transitionToNextPhase]; &#125; return (NSInteger)range.length;&#125; Ëøô‰∏™ÊñπÊ≥ï‰∏≠ÊúâÊ∂âÂèäÂà∞‰∫ÜËæπÁïåÁõ∏ÂÖ≥ÁöÑÂá†‰∏™ÊñπÊ≥ï„ÄÇÂΩì http ËØ∑Ê±Ç type ‰∏∫ multipart/form-data Êó∂ÔºåÂÆÉ‰ºöÂ∞ÜË°®Âçï‰∏≠ÁöÑÊï∞ÊçÆÂ§ÑÁêÜ‰∏∫‰∏ÄÊù°Ê∂àÊÅØÔºå‰ª•Ê†áÁ≠æ‰∏∫ÂçïÂÖÉÔºåÁî®ÂàÜÈöîÁ¨¶ÂàÜÂºÄ„ÄÇÊó¢ÂèØ‰ª•‰∏ä‰º†ÈîÆÂÄºÂØπÔºå‰πüÂèØ‰ª•‰∏ä‰º†Êñá‰ª∂„ÄÇÂΩì‰∏ä‰º†ÁöÑÂ≠óÊÆµÊòØÊñá‰ª∂Êó∂Ôºå‰ºöÊúâContent-TypeÊù•Ë°®ÂêçÊñá‰ª∂Á±ªÂûãÔºöcontent-dispositionÔºåÁî®Êù•ËØ¥ÊòéÂ≠óÊÆµÁöÑ‰∏Ä‰∫õ‰ø°ÊÅØ„ÄÇÂ¶ÇÔºö 1234567891011121314151617--boundary+004563210AB32145Content-Disposition: form-data; name="field1"value1--boundary+004563210AB32145Content-Disposition: form-data; name="field2"value2--boundary+004563210AB32145Content-Disposition: form-data; name="text"; filename="file.txt"data1--boundary+004563210AB32145Content-Disposition: form-data; name="pic"; filename="icon.png"data2--boundary+004563210AB32145-- ÊØè‰∏§‰∏™ boundary ‰πãÈó¥ÁöÑÊï∞ÊçÆÂ∞±ÊòØ‰∏Ä‰∏™ AFHTTPBodyPart ÂÆû‰æã„ÄÇ‰πüÂ∞±ÊòØ read:maxLength: ËØªÂèñÁîüÊàêÁöÑ buffer ÁöÑÊï∞ÊçÆ --boundary+004563210AB32145 Â∞±ÊòØÁî±‰∏äÈù¢ÁöÑÂõõ‰∏™ÊñπÊ≥ïÁîüÊàêÁöÑ„ÄÇÈíàÂØπ boundary ÊâÄÂ§ÑÁöÑ‰∏çÂêå‰ΩçÁΩÆÔºå‰ºöÊúâ‰∏çÂêåÁöÑÊ∑ªÂä†Êç¢Ë°åÁ¨¶ÁöÑËßÑÂàô„ÄÇ AFMultipartBodyStream‰πãÂâç AFHTTPBodyPart ÊòØ form-data ‰∏ã body ‰∏≠ÁöÑÂêÑ‰∏™ÈÉ®ÂàÜ„ÄÇÁé∞Âú®ÁöÑ AFMutipartBodyStream ÂàôÊòØ AFHTTPBodyPart ÁöÑÈõÜÂêà„ÄÇ Â§¥Êñá‰ª∂12345678910111213141516@interface AFMultipartBodyStream : NSInputStream &lt;NSStreamDelegate&gt;@property (nonatomic, assign) NSUInteger numberOfBytesInPacket;@property (nonatomic, assign) NSTimeInterval delay;@property (nonatomic, strong) NSInputStream *inputStream;@property (readonly, nonatomic, assign) unsigned long long contentLength;@property (readonly, nonatomic, assign, getter = isEmpty) BOOL empty;@end @interface AFMultipartBodyStream () &lt;NSCopying&gt;@property (readwrite, nonatomic, assign) NSStringEncoding stringEncoding;@property (readwrite, nonatomic, strong) NSMutableArray *HTTPBodyParts;@property (readwrite, nonatomic, strong) NSEnumerator *HTTPBodyPartEnumerator;@property (readwrite, nonatomic, strong) AFHTTPBodyPart *currentHTTPBodyPart;@property (readwrite, nonatomic, strong) NSOutputStream *outputStream;@property (readwrite, nonatomic, strong) NSMutableData *buffer;@end ÂèØ‰ª•ÂèëÁé∞ AFMutipartBodyStream ÊòØÁªßÊâø‰∫é NSInputStream ÁöÑ„ÄÇÊàë‰ª¨ÈúÄË¶ÅÊ∏ÖÊ•öÁöÑÊòØÔºåHTTPBodyParts ÊòØ‰ª•‰∏Ä‰∏™Êï∞ÁªÑÁöÑÂΩ¢ÂºèÂ≠òÂú®‰∫éÂÆÉÁöÑÂ±ûÊÄß‰∏≠„ÄÇ ÊñπÊ≥ïsetInitialAndFinalBoundariesÁî±‰∫éÂÆÉÂÜÖÂÜÖÂ≠òÂ≠òÂú®‰∏Ä‰∏™ AFHTTPBodyPart ÁöÑÊï∞ÁªÑÔºåËøô‰∏™ÊñπÊ≥ïÂ∞±ÊòØÂ∞ÜÊï∞ÁªÑ‰∏≠Á¨¨‰∏Ä‰∏™ËÆæÁΩÆ‰∏∫Â≠òÂú®ÂàùÂßãËæπÁïåÔºåÊúÄÂêé‰∏Ä‰∏™Â≠òÂú®Êú´Â∞æËæπÁïåÔºå‰∏≠Èó¥ÁöÑÂàôÊòØÊôÆÈÄöËæπÁïåÁöÑÊÉÖÂÜµÔºö 123456789101112/// ‰∏Ä‰∏™ AFMultipartBodyStream ‰∏≠ÊúâÂ§ö‰∏™ HTTPBodyPartsÔºåÊúÄÂâçÈù¢ÁöÑËÆæÁΩÆ initialBoundary ÊúÄÂêéÈù¢ÁöÑËÆæÁΩÆ finalBoundary- (void)setInitialAndFinalBoundaries &#123; if ([self.HTTPBodyParts count] &gt; 0) &#123; for (AFHTTPBodyPart *bodyPart in self.HTTPBodyParts) &#123; bodyPart.hasInitialBoundary = NO; bodyPart.hasFinalBoundary = NO; &#125; [[self.HTTPBodyParts firstObject] setHasInitialBoundary:YES]; [[self.HTTPBodyParts lastObject] setHasFinalBoundary:YES]; &#125;&#125; appendHTTPBodyPart:Êó¢ÁÑ∂Êúâ‰∏Ä‰∏™Êï∞ÁªÑÔºåÈÇ£‰πàÊï∞ÁªÑÂÖÉÁ¥†ÂΩìÁÑ∂Ë¶Å‰∏Ä‰∏™‰∏™Ê∑ªÂä†ËøõÊù•Âï¶„ÄÇËøô‰∏™ÊñπÊ≥ïÂ∞±ÊòØÁî®Êù•Ê∑ªÂä†ÂÖÉÁ¥†ÁöÑÔºö 1234/// Â¢ûÂä†HTTPBodyPartÂÆû‰æãÂà∞Êï∞ÁªÑ‰∏≠- (void)appendHTTPBodyPart:(AFHTTPBodyPart *)bodyPart &#123; [self.HTTPBodyParts addObject:bodyPart];&#125; read:maxLength:Ëøô‰∏™ÊñπÊ≥ïÂú® AFHTTPBodyPart ‰∏≠‰πüÊúâÔºåÂÖ∂ÂÆû‰ªñÊòØ NSInputStream ÁöÑÊñπÊ≥ïÔºåÂú® AFMultipartBodyStream ‰∏≠Ë¢´ÈáçÂÜô‰∫ÜÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041/// ËØªÂèñ HTTPBodyPart ‰∏≠ÁöÑÊï∞ÊçÆÂà∞ buffer ‰∏≠- (NSInteger)read:(uint8_t *)buffer maxLength:(NSUInteger)length&#123; if ([self streamStatus] == NSStreamStatusClosed) &#123; return 0; &#125; /// Â∑≤ËØªÊï∞ÊçÆ NSInteger totalNumberOfBytesRead = 0; /// ÈÅçÂéÜËØªÂèñÊï∞ÊçÆ while ((NSUInteger)totalNumberOfBytesRead &lt; MIN(length, self.numberOfBytesInPacket)) &#123; /// Â¶ÇÊûúÂΩìÂâçËØªÂèñÁöÑbody‰∏çÂ≠òÂú®ÊàñËÄÖbodyÊ≤°ÊúâÂèØËØªÂ≠óËäÇ if (!self.currentHTTPBodyPart || ![self.currentHTTPBodyPart hasBytesAvailable]) &#123; ///Êää‰∏ã‰∏Ä‰∏™bodyËµãÂÄºÁªôÂΩìÂâçÁöÑbody Â¶ÇÊûú‰∏ã‰∏Ä‰∏™‰∏∫nil Â∞±ÈÄÄÂá∫Âæ™ÁéØ if (!(self.currentHTTPBodyPart = [self.HTTPBodyPartEnumerator nextObject])) &#123; break; &#125; /// ÂΩìÂâçbodyÂ≠òÂú® &#125; else &#123; // Ââ©‰ΩôÂèØËØªÊñá‰ª∂ÁöÑÂ§ßÂ∞è NSUInteger maxLength = MIN(length, self.numberOfBytesInPacket) - (NSUInteger)totalNumberOfBytesRead; /// ÊääÂΩìÂâçÁöÑbodyÁöÑÊï∞ÊçÆËØªÂÖ•Âà∞buffer‰∏≠ NSInteger numberOfBytesRead = [self.currentHTTPBodyPart read:&amp;buffer[totalNumberOfBytesRead] maxLength:maxLength]; if (numberOfBytesRead == -1) &#123; self.streamError = self.currentHTTPBodyPart.inputStream.streamError; break; &#125; else &#123; /// ËØªÂÆå‰πãÂêéÂ¢ûÂä†Â∑≤ËØªÈïøÂ∫¶ totalNumberOfBytesRead += numberOfBytesRead; /// ËØªÂÆå‰πãÂêéÊòØÂê¶ÈúÄË¶ÅÊúâ delay if (self.delay &gt; 0.0f) &#123; [NSThread sleepForTimeInterval:self.delay]; &#125; &#125; &#125; &#125; return totalNumberOfBytesRead;&#125; ÁÆÄËÄåË®Ä‰πãÔºåÂ∞±ÊòØË∞ÉÁî®ÊØè‰∏Ä‰∏™ AFHTTPBodyPart ÂÆû‰æãÁöÑÁõ∏Â∫îÊñπÊ≥ïÔºåÊää‰ªñ‰ª¨ÁöÑÊâÄÊúâ buffer Ê±áÈõÜÂú®‰∏ÄËµ∑„ÄÇ buffer ËØªÂÆå‰πãÂêéÊúâ‰ªÄ‰πàÁî®ÔºåÂêéÈù¢ÂÜçËØ¥ contentLengthÂ∞ÜÊâÄÊúâ AFHTTPBodyPart ÁöÑÈïøÂ∫¶ÈÉΩÁ¥ØÂä†Ëµ∑Êù•Êàê‰∏∫ÊúÄÁªàÁöÑ content-length 12345678- (unsigned long long)contentLength &#123; unsigned long long length = 0; for (AFHTTPBodyPart *bodyPart in self.HTTPBodyParts) &#123; length += [bodyPart contentLength]; &#125; return length;&#125; ÂºÄÈó≠ NSInputStreamËøô‰πüÊòØ NSInputStream‰∏≠ÁöÑÊñπÊ≥ïÔºåÂú®ËØªÂèñ buffer ÂâçÂêéË¶ÅÂàÜÂà´ open ‰ª•Âèä close 123456789101112131415/// ÈáçÂÜô NSInputStream ÁöÑÊñπÊ≥ï- (void)open &#123; if (self.streamStatus == NSStreamStatusOpen) &#123; return; &#125; self.streamStatus = NSStreamStatusOpen; [self setInitialAndFinalBoundaries]; self.HTTPBodyPartEnumerator = [self.HTTPBodyParts objectEnumerator];&#125;- (void)close &#123; self.streamStatus = NSStreamStatusClosed;&#125; AFStreamingMultipartFormDataÂâçÈù¢ AFMultipartBodyStream ÂåÖÂê´‰∫ÜÂ§ö‰∏™ AFHTTPBodyPart ÂÆû‰æãÔºå‰∏îÂèØ‰ª•Ëé∑ÂèñÂà∞ÊâÄÊúâÁöÑ bufferÔºå‰ªñ‰ª¨ÂáÜÁ°ÆÁöÑËØ¥Â∞±ÊòØmodelÁ±ªÔºåÊ≤°ÊúâÊõ¥Â§öÁöÑÊìç‰Ωú„ÄÇËÄåÊ≠§Â§ÑÁöÑ AFStreamingMultipartFormData ÂàôÊõ¥ÂÉèÊòØ‰∏ÄÁßç managerÔºåÂèØ‰ª•ÁÆ°ÁêÜ AFMultipartBodyStream„ÄÇ Â§¥Êñá‰ª∂12345678@interface AFStreamingMultipartFormData ()/// NSMutableURLRequest@property (readwrite, nonatomic, copy) NSMutableURLRequest *request;@property (readwrite, nonatomic, assign) NSStringEncoding stringEncoding;@property (readwrite, nonatomic, copy) NSString *boundary;/// AFMultipartBodyStream ÂÆû‰æã@property (readwrite, nonatomic, strong) AFMultipartBodyStream *bodyStream;@end Â§¥Êñá‰ª∂‰∏≠‰∏ªÈúÄË¶ÅÂÖ≥Ê≥®‰∏§‰∏™Â±ûÊÄßÔºå‰∏Ä‰∏™ÊòØ NSMutableURLRequest ÂÆû‰æãÔºåËøòÊúâ‰∏Ä‰∏™ÊòØ SFMultipartBodyStream ÂÆû‰æã„ÄÇÂÆÉÂ∞ÜËØ∑Ê±ÇÂíåËæìÂÖ•ÊµÅÂ∞ÅË£Ö‰∫ÜËµ∑Êù•„ÄÇ ÊñπÊ≥ïÂàùÂßãÂåñÂàùÂßãÂåñÊñπÊ≥ïÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÂØπÂ§¥Êñá‰ª∂‰∏≠Â±ûÊÄßÁöÑËÆæÁΩÆ„ÄÇÂÆÉË¶Å‰º†ÂÖ•‰∏Ä‰∏™ NSMutableURLRequest ÂÆû‰æã„ÄÇ 123456789101112131415- (instancetype)initWithURLRequest:(NSMutableURLRequest *)urlRequest stringEncoding:(NSStringEncoding)encoding&#123; self = [super init]; if (!self) &#123; return nil; &#125; self.request = urlRequest; self.stringEncoding = encoding; self.boundary = AFCreateMultipartFormBoundary(); self.bodyStream = [[AFMultipartBodyStream alloc] initWithStringEncoding:encoding]; return self;&#125; ÈÄöËøáÊñá‰ª∂Ë∑ØÂæÑÂ¢ûÂä† AFHTTPBodyPartÂ¶ÇÊûúË¶Å‰∏ä‰º†‰∏Ä‰∏™Êú¨Âú∞Êñá‰ª∂ÔºåÈÇ£‰πàÂ∞±ÊääÊú¨Âú∞Êñá‰ª∂ÁöÑË∑ØÂæÑËÆæÁΩÆÁªôÊñ∞ÂàõÂª∫ÁöÑ SFHTTPBodyPart ÂÆû‰æã‰∏≠„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465- (BOOL)appendPartWithFileURL:(NSURL *)fileURL name:(NSString *)name error:(NSError * __autoreleasing *)error&#123; NSParameterAssert(fileURL); NSParameterAssert(name); NSString *fileName = [fileURL lastPathComponent]; NSString *mimeType = AFContentTypeForPathExtension([fileURL pathExtension]); return [self appendPartWithFileURL:fileURL name:name fileName:fileName mimeType:mimeType error:error];&#125;/// Â∞Ü fileURL ‰∏ãÁöÑÊñá‰ª∂ÂåÖË£Ö‰∏∫ AFHTTPBodyPart ÂÆû‰æãÔºå‰øùÂ≠ò‰∏ãÊù•- (BOOL)appendPartWithFileURL:(NSURL *)fileURL name:(NSString *)name fileName:(NSString *)fileName mimeType:(NSString *)mimeType error:(NSError * __autoreleasing *)error&#123; NSParameterAssert(fileURL); NSParameterAssert(name); NSParameterAssert(fileName); NSParameterAssert(mimeType); if (![fileURL isFileURL]) &#123; NSDictionary *userInfo = @&#123;NSLocalizedFailureReasonErrorKey: NSLocalizedStringFromTable(@"Expected URL to be a file URL", @"AFNetworking", nil)&#125;; if (error) &#123; *error = [[NSError alloc] initWithDomain:AFURLRequestSerializationErrorDomain code:NSURLErrorBadURL userInfo:userInfo]; &#125; return NO; /// Ê£ÄÊü• url ‰∏ãÁöÑÊñá‰ª∂ÊòØÂê¶Â≠òÂú® &#125; else if ([fileURL checkResourceIsReachableAndReturnError:error] == NO) &#123; NSDictionary *userInfo = @&#123;NSLocalizedFailureReasonErrorKey: NSLocalizedStringFromTable(@"File URL not reachable.", @"AFNetworking", nil)&#125;; if (error) &#123; *error = [[NSError alloc] initWithDomain:AFURLRequestSerializationErrorDomain code:NSURLErrorBadURL userInfo:userInfo]; &#125; return NO; &#125; /// ÈÄöËøá NSFileManager ÊèêÂèñ fileURL ÊâÄÁ§∫Êñá‰ª∂ÁöÑ‰ø°ÊÅØ NSDictionary *fileAttributes = [[NSFileManager defaultManager] attributesOfItemAtPath:[fileURL path] error:error]; if (!fileAttributes) &#123; return NO; &#125; NSMutableDictionary *mutableHeaders = [NSMutableDictionary dictionary]; /// ËÆæÁΩÆ header [mutableHeaders setValue:[NSString stringWithFormat:@"form-data; name=\"%@\"; filename=\"%@\"", name, fileName] forKey:@"Content-Disposition"]; [mutableHeaders setValue:mimeType forKey:@"Content-Type"]; AFHTTPBodyPart *bodyPart = [[AFHTTPBodyPart alloc] init]; bodyPart.stringEncoding = self.stringEncoding; bodyPart.headers = mutableHeaders; bodyPart.boundary = self.boundary; bodyPart.body = fileURL; /// Ëé∑ÂèñÊñá‰ª∂ÁöÑÂ§ßÂ∞è bodyPart.bodyContentLength = [fileAttributes[NSFileSize] unsignedLongLongValue]; /// ÊääÂàõÂª∫ÁöÑ AFHTTPBodyPart ÊîæÂà∞ AFMultipartBodyStream Â±ûÊÄß‰∏≠ [self.bodyStream appendHTTPBodyPart:bodyPart]; return YES;&#125; ÈÄöËøáËæìÂÖ•ÊµÅÂ¢ûÂä† AFHTTPBodyPartÊää‰º†ÂÖ•ÁöÑËæìÂÖ•ÊµÅ‰Ωú‰∏∫ AFHTTPBodyPart ÁöÑ body ‰øùÂ≠ò 12345678910111213141516171819202122232425/// Êää inputStream Â∞ÅË£Ö‰∏∫ AFHTTPBodyPartÔºå‰øùÂ≠ò- (void)appendPartWithInputStream:(NSInputStream *)inputStream name:(NSString *)name fileName:(NSString *)fileName length:(int64_t)length mimeType:(NSString *)mimeType&#123; NSParameterAssert(name); NSParameterAssert(fileName); NSParameterAssert(mimeType); NSMutableDictionary *mutableHeaders = [NSMutableDictionary dictionary]; [mutableHeaders setValue:[NSString stringWithFormat:@"form-data; name=\"%@\"; filename=\"%@\"", name, fileName] forKey:@"Content-Disposition"]; [mutableHeaders setValue:mimeType forKey:@"Content-Type"]; AFHTTPBodyPart *bodyPart = [[AFHTTPBodyPart alloc] init]; bodyPart.stringEncoding = self.stringEncoding; bodyPart.headers = mutableHeaders; bodyPart.boundary = self.boundary; bodyPart.body = inputStream; bodyPart.bodyContentLength = (unsigned long long)length; [self.bodyStream appendHTTPBodyPart:bodyPart];&#125; ÈÄöËøá NSData Â¢ûÂä† AFHTTPBodyPartÂ¶ÇÊûúÁõ¥Êé•‰º†ÂÖ•‰∫Ü NSDataÔºåÈÇ£‰πàÁõ¥Êé•Êää‰ªñ‰øùÂ≠òÂà∞ AFHTTPBodyPart ÁöÑ body ‰∏≠Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142- (void)appendPartWithFileData:(NSData *)data name:(NSString *)name fileName:(NSString *)fileName mimeType:(NSString *)mimeType&#123; NSParameterAssert(name); NSParameterAssert(fileName); NSParameterAssert(mimeType); NSMutableDictionary *mutableHeaders = [NSMutableDictionary dictionary]; [mutableHeaders setValue:[NSString stringWithFormat:@"form-data; name=\"%@\"; filename=\"%@\"", name, fileName] forKey:@"Content-Disposition"]; [mutableHeaders setValue:mimeType forKey:@"Content-Type"]; [self appendPartWithHeaders:mutableHeaders body:data];&#125;- (void)appendPartWithFormData:(NSData *)data name:(NSString *)name&#123; NSParameterAssert(name); NSMutableDictionary *mutableHeaders = [NSMutableDictionary dictionary]; [mutableHeaders setValue:[NSString stringWithFormat:@"form-data; name=\"%@\"", name] forKey:@"Content-Disposition"]; [self appendPartWithHeaders:mutableHeaders body:data];&#125;/// Êää NSData Â∞ÅË£Ö‰∏∫ AFHTTPBodyPart ‰øùÂ≠ò- (void)appendPartWithHeaders:(NSDictionary *)headers body:(NSData *)body&#123; NSParameterAssert(body); AFHTTPBodyPart *bodyPart = [[AFHTTPBodyPart alloc] init]; bodyPart.stringEncoding = self.stringEncoding; bodyPart.headers = headers; bodyPart.boundary = self.boundary; bodyPart.bodyContentLength = [body length]; bodyPart.body = body; [self.bodyStream appendHTTPBodyPart:bodyPart];&#125; ËøîÂõû NSMutableURLRequest ÂÆû‰æãÂâçÈù¢ÊèêÂà∞ËøáÔºåËØªÂèñÁöÑ buffer Êúâ‰ªÄ‰πàÁî®Âë¢ÔºüÁ≠îÊ°àÂ∞±Âú®Ëøô‰∏™ÊñπÊ≥ï‰∏≠Ôºö 12345678910111213141516- (NSMutableURLRequest *)requestByFinalizingMultipartFormData &#123; if ([self.bodyStream isEmpty]) &#123; return self.request; &#125; // Reset the initial and final boundaries to ensure correct Content-Length [self.bodyStream setInitialAndFinalBoundaries]; /// Êää bodyStream ËÆæÁΩÆÁªô request [self.request setHTTPBodyStream:self.bodyStream]; /// ËÆæÁΩÆ content-type Âíå content-length [self.request setValue:[NSString stringWithFormat:@"multipart/form-data; boundary=%@", self.boundary] forHTTPHeaderField:@"Content-Type"]; [self.request setValue:[NSString stringWithFormat:@"%llu", [self.bodyStream contentLength]] forHTTPHeaderField:@"Content-Length"]; return self.request;&#125; NSMutableURLRequest Êúâ‰∏Ä‰∏™Â±ûÊÄßÊòØ HTTPBodyStreamÔºåÂÆÉÊòØ NSInputStream Á±ªÂûãÔºåÂú®ÁîüÊàêËØ∑Ê±ÇÁöÑÊó∂ÂÄô‰ºöËá™Âä®Ë∞ÉÁî®ÂÖ∂ HTTPBodyStream ÂÆû‰æãÁöÑ read:maxLength: ÊñπÊ≥ï„ÄÇËé∑Âèñ buffer Êï∞ÊçÆÂÜôÂÖ•ËØ∑Ê±Ç‰Ωì‰∏≠„ÄÇ NSMutableURLRequest Êúâ‰∏§‰∏™Â±ûÊÄßÁî®Êù•ËÆæÁΩÆËØ∑Ê±Ç‰ΩìÔºö NSInputStream Á±ªÂûãÁöÑ HTTPBodyStream Ôºå‰πüÂ∞±ÊòØ‰∏äÈù¢ËØ¥ÁöÑÔºåÊòØ‰ª•Êï∞ÊçÆÊµÅÁöÑÂΩ¢ÂºèÁîüÊàêËØ∑Ê±Ç‰ΩìÔºåÈúÄË¶ÅÂÆûÁé∞ NSInputStream ÁöÑ read:maxLength: ÊñπÊ≥ïÔºåËøîÂõû buffer„ÄÇ‰∏ªË¶Å‰ΩøÁî®Âú® content-type ‰∏∫ multipart/form-data ÁöÑÊÉÖÂÜµ„ÄÇ NSData Á±ªÂûãÁöÑ HTTPBodyÔºåÁõ¥Êé•Â∞Ü NSData ÊîæÂÖ•ËØ∑Ê±Ç‰∏≠„ÄÇ‰∏ªË¶ÅÁî®Âú®Èùû multipart/form-data ÁöÑÊÉÖÂÜµÔºåÂåÖÊã¨ application/jsonÔºåapplication/x-www-form-urlencoded Á≠â AFHTTPRequestSerializerÂàùÂßãÂåñÂàùÂßãÂåñÊñπÊ≥ïÊØîËæÉÈïø„ÄÇÂÅö‰∫Ü‰ª•‰∏ãÂá†‰ª∂‰∫ãÔºö ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Âπ∂Ë°åÈòüÂàóÔºåÁî®‰∫éÂÆûÁé∞ËØªÂÜôÈîÅ ËÆæÁΩÆËØ∑Ê±ÇÂ§¥ÔºåÂåÖË£π UA Âíå Accept-Language ÁªôÈÉ®ÂàÜÂ±ûÊÄßÊ∑ªÂä† KVO 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051- (instancetype)init &#123; self = [super init]; if (!self) &#123; return nil; &#125; self.stringEncoding = NSUTF8StringEncoding; self.mutableHTTPRequestHeaders = [NSMutableDictionary dictionary]; /// ËØ∑Ê±ÇÂ§¥ËØªÂÜôÈòüÂàóÔºå‰ª•Ê≠§Âπ∂Ë°åÈòüÂàóÂÆûÁé∞ËØªÂÜôÈîÅ self.requestHeaderModificationQueue = dispatch_queue_create("requestHeaderModificationQueue", DISPATCH_QUEUE_CONCURRENT); // Accept-Language HTTP Header; see http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4 NSMutableArray *acceptLanguagesComponents = [NSMutableArray array]; /// ËÆæÁΩÆ Accept-Language [[NSLocale preferredLanguages] enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) &#123; float q = 1.0f - (idx * 0.1f); [acceptLanguagesComponents addObject:[NSString stringWithFormat:@"%@;q=%0.1g", obj, q]]; *stop = q &lt;= 0.5f; &#125;]; [self setValue:[acceptLanguagesComponents componentsJoinedByString:@", "] forHTTPHeaderField:@"Accept-Language"]; /// ËÆæÁΩÆ useragent NSString *userAgent = nil; // User-Agent Header; see http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.43 userAgent = [NSString stringWithFormat:@"%@/%@ (%@; iOS %@; Scale/%0.2f)", [[NSBundle mainBundle] infoDictionary][(__bridge NSString *)kCFBundleExecutableKey] ?: [[NSBundle mainBundle] infoDictionary][(__bridge NSString *)kCFBundleIdentifierKey], [[NSBundle mainBundle] infoDictionary][@"CFBundleShortVersionString"] ?: [[NSBundle mainBundle] infoDictionary][(__bridge NSString *)kCFBundleVersionKey], [[UIDevice currentDevice] model], [[UIDevice currentDevice] systemVersion], [[UIScreen mainScreen] scale]]; if (userAgent) &#123; if (![userAgent canBeConvertedToEncoding:NSASCIIStringEncoding]) &#123; NSMutableString *mutableUserAgent = [userAgent mutableCopy]; if (CFStringTransform((__bridge CFMutableStringRef)(mutableUserAgent), NULL, (__bridge CFStringRef)@"Any-Latin; Latin-ASCII; [:^ASCII:] Remove", false)) &#123; userAgent = mutableUserAgent; &#125; &#125; [self setValue:userAgent forHTTPHeaderField:@"User-Agent"]; &#125; // HTTP Method Definitions; see http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html /// ‰ª•‰∏ã‰∏âÁßçËØ∑Ê±Ç‰ºöÊää param ÊîæÂú® uri ‰∏≠ self.HTTPMethodsEncodingParametersInURI = [NSSet setWithObjects:@"GET", @"HEAD", @"DELETE", nil]; /// Áî®Êù•ËÆ∞ÂΩïÂì™‰∫õ keyPaths ÊîπÂèò‰∫Ü self.mutableObservedChangedKeyPaths = [NSMutableSet set]; /// Áªô AFHTTPRequestSerializerObservedKeyPaths ‰∏≠ÁöÑÂ±ûÊÄßÊ∑ªÂä† KVO for (NSString *keyPath in AFHTTPRequestSerializerObservedKeyPaths()) &#123; if ([self respondsToSelector:NSSelectorFromString(keyPath)]) &#123; [self addObserver:self forKeyPath:keyPath options:NSKeyValueObservingOptionNew context:AFHTTPRequestSerializerObserverContext]; &#125; &#125; return self;&#125; Ê∑ªÂä† KVOÊ∑ªÂä† KVO ÁöÑÂ±ûÊÄßÁî±‰ª•‰∏ãÊñπÊ≥ïÊèê‰æõÔºö 12345678910#pragma mark - AFHTTPRequestSeri ÈÄöËøáKVOÁõëÂê¨‰ª•‰∏ãÁöÑÂá†‰∏™Â±ûÊÄßstatic NSArray * AFHTTPRequestSerializerObservedKeyPaths() &#123; static NSArray *_AFHTTPRequestSerializerObservedKeyPaths = nil; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; _AFHTTPRequestSerializerObservedKeyPaths = @[NSStringFromSelector(@selector(allowsCellularAccess)), NSStringFromSelector(@selector(cachePolicy)), NSStringFromSelector(@selector(HTTPShouldHandleCookies)), NSStringFromSelector(@selector(HTTPShouldUsePipelining)), NSStringFromSelector(@selector(networkServiceType)), NSStringFromSelector(@selector(timeoutInterval))]; &#125;); return _AFHTTPRequestSerializerObservedKeyPaths;&#125; ÂåÖÊã¨ ÊòØÂê¶ÂÖÅËÆ∏‰ΩøÁî®ËúÇÁ™ùÁΩëÁªúÔºåÁºìÂ≠òÁ≠ñÁï•ÔºåÊòØÂê¶‰ΩøÁî® cookiesÔºåÊòØÂê¶‰ΩøÁî®ÁÆ°Á∫øËøûÊé•ÔºåÁΩëÁªúÊúçÂä°Á±ªÂûãÔºåË∂ÖÊó∂Êó∂Èó¥„ÄÇÂΩì‰ªñ‰ª¨Ë¢´ÈáçÊñ∞ËÆæÁΩÆÂêéÔºå‰ºöËß¶Âèë KVO ÊñπÊ≥ïÔºö 12345678910111213- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(__unused id)object change:(NSDictionary *)change context:(void *)context&#123; if (context == AFHTTPRequestSerializerObserverContext) &#123; if ([change[NSKeyValueChangeNewKey] isEqual:[NSNull null]]) &#123; [self.mutableObservedChangedKeyPaths removeObject:keyPath]; &#125; else &#123; [self.mutableObservedChangedKeyPaths addObject:keyPath]; &#125; &#125;&#125; ‰πüÂ∞±ÊòØËØ¥ÔºåÂ¶ÇÊûúÊîπÂèò‰∫ÜÂ∞±‰ºöË¢´Âä†ÂÖ•Âà∞ mutableObservedChangedKeyPaths Êï∞ÁªÑ‰∏≠„ÄÇËøôÊ†∑ÔºåÂú®ÂàõÂª∫ request ÁöÑÊó∂ÂÄôÂ∞±ÂèØ‰ª•ÈÄöËøáËøô‰∏™Êï∞ÁªÑËé∑ÂèñÂà∞ÂèòÂåñÁöÑ‰ø°ÊÅØ„ÄÇ ËÆæÁΩÆÂ§¥ÈÉ®‰ø°ÊÅØËÆæÁΩÆ header Êú¨Êù•Â∞±ÊòØÁÆÄÂçïÁöÑ‰∏§‰∏™ get set ÊñπÊ≥ïÔºå‰ΩÜÊòØËøòÊòØË¶ÅÊãøÂá∫Êù•ËØ¥‰∏Ä‰∏ãÊòØÂõ†‰∏∫ÂÆÉÈÄöËøá‰∏Ä‰∏™Âπ∂Ë°åÈòüÂàó‰ª•Âèä dispatch_barrier_async ÂÆûÁé∞‰∫Ü‰∏Ä‰∏™ËØªÂÜôÈîÅÔºö 123456789101112131415- (void)setValue:(NSString *)valueforHTTPHeaderField:(NSString *)field&#123; dispatch_barrier_async(self.requestHeaderModificationQueue, ^&#123; [self.mutableHTTPRequestHeaders setValue:value forKey:field]; &#125;);&#125;- (NSString *)valueForHTTPHeaderField:(NSString *)field &#123; NSString __block *value; dispatch_sync(self.requestHeaderModificationQueue, ^&#123; value = [self.mutableHTTPRequestHeaders valueForKey:field]; &#125;); return value;&#125; ÂêÑÁßçÂàõÂª∫ NSMutableURLRequest ÁöÑÊñπÂºèapplication/x-www-form-urlencodedapplication/x-www-form-urlencoded ÁöÑ request Â∞ÜÂèÇÊï∞ÊãºÊé•Âà∞ url ‰∏äÊàñËÄÖÊîæÂú® body ‰∏≠Ôºö 123456789101112131415161718192021222324252627282930/// ÁîüÊàêÊôÆÈÄö urlrequestÔºåparam ËÆæÁΩÆÂà∞bodyÊàñËÄÖuri‰∏ä- (NSMutableURLRequest *)requestWithMethod:(NSString *)method URLString:(NSString *)URLString parameters:(id)parameters error:(NSError *__autoreleasing *)error&#123; NSParameterAssert(method); NSParameterAssert(URLString); NSURL *url = [NSURL URLWithString:URLString]; NSParameterAssert(url); NSMutableURLRequest *mutableRequest = [[NSMutableURLRequest alloc] initWithURL:url]; mutableRequest.HTTPMethod = method; ///Â∞ÜrequestÁöÑÂêÑÁßçÂ±ûÊÄßÂæ™ÁéØÈÅçÂéÜ for (NSString *keyPath in AFHTTPRequestSerializerObservedKeyPaths()) &#123; /// Â¶ÇÊûúËßÇÂØüÂà∞ÁöÑÂ±ûÊÄßÊîπÂèò‰∫Ü if ([self.mutableObservedChangedKeyPaths containsObject:keyPath]) &#123; /// Â∞ÜÂ±ûÊÄßËÆæÁΩÆÁªô request [mutableRequest setValue:[self valueForKeyPath:keyPath] forKey:keyPath]; &#125; &#125; /// Â∞Ü param ÊãºÂà∞ uri ÊàñËÄÖÊîæÂà∞ body ‰∏≠ mutableRequest = [[self requestBySerializingRequest:mutableRequest withParameters:parameters error:error] mutableCopy]; return mutableRequest;&#125; Ë∞ÉÁî® requestBySerializingRequest:withparameters:error: Â§ÑÁêÜÂèÇÊï∞Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960/// Â∞Ü param ÊãºÂà∞ uri ÊàñÊîæÂú® body- (NSURLRequest *)requestBySerializingRequest:(NSURLRequest *)request withParameters:(id)parameters error:(NSError *__autoreleasing *)error&#123; NSParameterAssert(request); NSMutableURLRequest *mutableRequest = [request mutableCopy]; /// ËÆæÁΩÆheaderÁªô request [self.HTTPRequestHeaders enumerateKeysAndObjectsUsingBlock:^(id field, id value, BOOL * __unused stop) &#123; if (![request valueForHTTPHeaderField:field]) &#123; [mutableRequest setValue:value forHTTPHeaderField:field]; &#125; &#125;]; NSString *query = nil; if (parameters) &#123; /// Â¶ÇÊûúÊúâËá™ÂÆö‰πâÁöÑÂ∫èÂàóÂåñÊñπÊ≥ïÔºåÁõ¥Êé•Ë∞ÉÁî® if (self.queryStringSerialization) &#123; NSError *serializationError; query = self.queryStringSerialization(request, parameters, &amp;serializationError); if (serializationError) &#123; if (error) &#123; *error = serializationError; &#125; return nil; &#125; &#125; else &#123; /// Ê≤°ÊúâËá™ÂÆö‰πâÁöÑÂ∫èÂàóÂåñÊñπÊ≥ïË∞ÉÁî®ÈªòËÆ§Â∫èÂàóÂåñÊñπÊ≥ï switch (self.queryStringSerializationStyle) &#123; case AFHTTPRequestQueryStringDefaultStyle: query = AFQueryStringFromParameters(parameters); break; &#125; &#125; &#125; /// ÊòØÂê¶ÊòØ get delete header ‰∏âÁßçËØ∑Ê±Ç‰∏≠Á¨¨‰∏Ä‰∏™ if ([self.HTTPMethodsEncodingParametersInURI containsObject:[[request HTTPMethod] uppercaseString]]) &#123; if (query &amp;&amp; query.length &gt; 0) &#123; /// Â¶ÇÊûúÊòØÁöÑËØùÔºåÁõ¥Êé•Êää query‰ø°ÊÅØÊãºÂà∞ uri ÂêéÈù¢ mutableRequest.URL = [NSURL URLWithString:[[mutableRequest.URL absoluteString] stringByAppendingFormat:mutableRequest.URL.query ? @"&amp;%@" : @"?%@", query]]; &#125; &#125; else &#123; // #2864: an empty string is a valid x-www-form-urlencoded payload if (!query) &#123; query = @""; &#125; if (![mutableRequest valueForHTTPHeaderField:@"Content-Type"]) &#123; [mutableRequest setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"]; &#125; /// Â¶ÇÊûú‰∏çÊòØ‰∏äËø∞Âá†ÁßçÔºåÊää query ‰ø°ÊÅØÊîæÂà∞ http body Èáå [mutableRequest setHTTPBody:[query dataUsingEncoding:self.stringEncoding]]; &#125; return mutableRequest;&#125; Â¶ÇÊûúÊòØ getÔºådeleteÔºåheader ‰∏≠ÁöÑ‰∏Ä‰∏™ÔºåÈÇ£‰πàÂ∞±‰ºöÁõ¥Êé•Êää query ‰ø°ÊÅØÊãºÂà∞ uri ‰∏äÔºåÂÖ∂‰ªñÁöÑÈÉΩ‰ºöÂ°ûÂà∞ body ‰∏≠„ÄÇ Â¶ÇÊûúÊúâËá™ÂÆö‰πâÂ∫èÂàóÂåñÊñπÊ≥ï‰ºöË∞ÉÁî®Ëá™ÂÆö‰πâÁöÑÊñπÊ≥ïÂ∞Ü param Â∫èÂàóÂåñÊàêÂ≠óÁ¨¶‰∏≤„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊàë‰ª¨ÂèØËÉΩ‰∏çÈúÄË¶ÅËá™ÂÆö‰πâÁöÑÂ∫èÂàóÂåñÊñπÊ≥ïÔºå‰∏çËøáÊúâ‰∫õÊó∂ÂÄôÔºåÊØîÂ¶ÇËØ¥ÊÉ≥ÈÄöËøá get ËØ∑Ê±Ç‰º†ÈÄí‰∏Ä‰∏™Êï∞ÁªÑÔºåÊúçÂä°Á´ØÊúâËá™Â∑±ÁöÑËß£ÊûêÈÄªËæëÔºåÈÇ£‰πàÊï∞ÁªÑÂ¶Ç‰ΩïÂ±ïÂºÄÂ∞±Ë¶ÅÈÄöËøáËá™ÂÆö‰πâÁöÑÂ∫èÂàóÂåñÊñπÂºèËøõË°å‰∫ÜÔºö 123- (void)setQueryStringSerializationWithBlock:(NSString *(^)(NSURLRequest *, id, NSError *__autoreleasing *))block &#123; self.queryStringSerialization = block;&#125; Ê≤°ÊúâÂ∞±ÈÄöËøáÈªòËÆ§ÁöÑÊñπÂºèÔºåÂç≥ AFQueryStringFromParametors() ÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536/// Â∞Ü‰º†ÂÖ•ÁöÑ parameters Â≠óÂÖ∏ËΩ¨‰∏∫Êï∞ÁªÑÔºåÊï∞ÁªÑ‰∏≠ÁöÑ‰øùÂ≠òÁöÑÊòØÂåÖÂê´ key value ÁöÑ AFQueryStringPair ÂØπË±°„ÄÇ/// Ê≥®ÊÑèÂ¶ÇÊûúÂ≠óÂÖ∏‰∏≠ÂåÖÂê´Â≠óÂÖ∏ÔºåÈÇ£‰πà key ÁöÑÂΩ¢ÂºèÊòØ ‚Äúa[b]‚Äù ÁöÑÊñπÂºè‰øùÂ≠òÔºõÂ¶ÇÊûúÂ≠óÂÖ∏‰∏≠ÂåÖÂê´Êï∞ÁªÑÔºåÈÇ£‰πà key ÁöÑÂΩ¢ÂºèÊòØ ‚Äúa[]‚Äù ÁöÑÊñπÂºè‰øùÂ≠òNSArray * AFQueryStringPairsFromDictionary(NSDictionary *dictionary) &#123; return AFQueryStringPairsFromKeyAndValue(nil, dictionary);&#125;NSArray * AFQueryStringPairsFromKeyAndValue(NSString *key, id value) &#123; NSMutableArray *mutableQueryStringComponents = [NSMutableArray array]; NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"description" ascending:YES selector:@selector(compare:)]; if ([value isKindOfClass:[NSDictionary class]]) &#123; NSDictionary *dictionary = value; // Sort dictionary keys to ensure consistent ordering in query string, which is important when deserializing potentially ambiguous sequences, such as an array of dictionaries for (id nestedKey in [dictionary.allKeys sortedArrayUsingDescriptors:@[ sortDescriptor ]]) &#123; id nestedValue = dictionary[nestedKey]; if (nestedValue) &#123; [mutableQueryStringComponents addObjectsFromArray:AFQueryStringPairsFromKeyAndValue((key ? [NSString stringWithFormat:@"%@[%@]", key, nestedKey] : nestedKey), nestedValue)]; &#125; &#125; &#125; else if ([value isKindOfClass:[NSArray class]]) &#123; NSArray *array = value; for (id nestedValue in array) &#123; [mutableQueryStringComponents addObjectsFromArray:AFQueryStringPairsFromKeyAndValue([NSString stringWithFormat:@"%@[]", key], nestedValue)]; &#125; &#125; else if ([value isKindOfClass:[NSSet class]]) &#123; NSSet *set = value; for (id obj in [set sortedArrayUsingDescriptors:@[ sortDescriptor ]]) &#123; [mutableQueryStringComponents addObjectsFromArray:AFQueryStringPairsFromKeyAndValue(key, obj)]; &#125; &#125; else &#123; [mutableQueryStringComponents addObject:[[AFQueryStringPair alloc] initWithField:key value:value]]; &#125; return mutableQueryStringComponents;&#125; ËøôÁßçÂ∫èÂàóÂåñÊñπÂºèÊòØÊúÄÂ∏∏ËßÅÁöÑÊñπÂºèÊï∞ÁªÑ‰ª• a[]=xxx&amp;a[]=yyy&amp;a[]=zzz ÁöÑÂΩ¢ÂºèÊèê‰∫§ÔºåÂ≠óÂÖ∏‰ª•a[b]=xxx&amp;a[c]=yyy&amp;a[d]=zzz ÁöÑÊñπÂºèÊèê‰∫§„ÄÇ ‰∏çËøáËøôÁßç‰∏ÄËà¨‰ª• json ÁöÑÊñπÂºèÊèê‰∫§‰ºöÊõ¥Êñπ‰æø„ÄÇ multipart/form-dataËøôÁßçÁ±ªÂûãÁöÑËØ∑Ê±Ç‰∏äÈù¢Â∑≤ÁªèËÆ≤‰∫ÜÂæàÂ§ö‰∫ÜÔºåÈúÄË¶Å‰∏Ä‰∏™ NSInputStream: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455- (NSMutableURLRequest *)multipartFormRequestWithMethod:(NSString *)method URLString:(NSString *)URLString parameters:(NSDictionary *)parameters constructingBodyWithBlock:(void (^)(id &lt;AFMultipartFormData&gt; formData))block error:(NSError *__autoreleasing *)error&#123; NSParameterAssert(method); NSParameterAssert(![method isEqualToString:@"GET"] &amp;&amp; ![method isEqualToString:@"HEAD"]); /// ÁîüÊàêÊôÆÈÄöÁöÑ urlrequest NSMutableURLRequest *mutableRequest = [self requestWithMethod:method URLString:URLString parameters:nil error:error]; __block AFStreamingMultipartFormData *formData = [[AFStreamingMultipartFormData alloc] initWithURLRequest:mutableRequest stringEncoding:NSUTF8StringEncoding]; if (parameters) &#123; /// Âæ™ÁéØÊãøÂà∞ÂèÇÊï∞ÔºåÂà§Êñ≠ value ÊòØÂê¶ÊòØ NSDataÔºåÁÑ∂ÂêéÂàõÂª∫ AFHTTPBodyPart ÂÆû‰æãÔºåÊääNSDataËΩ¨‰∏∫NSInputStream for (AFQueryStringPair *pair in AFQueryStringPairsFromDictionary(parameters)) &#123; NSData *data = nil; if ([pair.value isKindOfClass:[NSData class]]) &#123; data = pair.value; &#125; else if ([pair.value isEqual:[NSNull null]]) &#123; data = [NSData data]; &#125; else &#123; data = [[pair.value description] dataUsingEncoding:self.stringEncoding]; &#125; if (data) &#123; [formData appendPartWithFormData:data name:[pair.field description]]; &#125; &#125; &#125; if (block) &#123; block(formData); &#125; return [formData requestByFinalizingMultipartFormData];&#125;- (NSMutableURLRequest *)requestByFinalizingMultipartFormData &#123; if ([self.bodyStream isEmpty]) &#123; return self.request; &#125; // Reset the initial and final boundaries to ensure correct Content-Length [self.bodyStream setInitialAndFinalBoundaries]; /// Êää bodyStream ËÆæÁΩÆÁªô request [self.request setHTTPBodyStream:self.bodyStream]; /// ËÆæÁΩÆ content-type Âíå content-length [self.request setValue:[NSString stringWithFormat:@"multipart/form-data; boundary=%@", self.boundary] forHTTPHeaderField:@"Content-Type"]; [self.request setValue:[NSString stringWithFormat:@"%llu", [self.bodyStream contentLength]] forHTTPHeaderField:@"Content-Length"]; return self.request;&#125; ÂÆÉ‰ºöÊääÊâÄÊúâÁöÑÂèÇÊï∞ÈÉΩËΩ¨‰∏∫ NSData ÁöÑÂΩ¢ÂºèÔºåÁÑ∂ÂêéËΩ¨‰∏∫ NSInputStreamÔºåËÆæÁΩÆÁªô request„ÄÇ ÁâπÊÆäÁöÑ request1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253- (NSMutableURLRequest *)requestWithMultipartFormRequest:(NSURLRequest *)request writingStreamContentsToFile:(NSURL *)fileURL completionHandler:(void (^)(NSError *error))handler&#123; NSParameterAssert(request.HTTPBodyStream); NSParameterAssert([fileURL isFileURL]); NSInputStream *inputStream = request.HTTPBodyStream; NSOutputStream *outputStream = [[NSOutputStream alloc] initWithURL:fileURL append:NO]; __block NSError *error = nil; dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; [inputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode]; [outputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode]; [inputStream open]; [outputStream open]; while ([inputStream hasBytesAvailable] &amp;&amp; [outputStream hasSpaceAvailable]) &#123; uint8_t buffer[1024]; NSInteger bytesRead = [inputStream read:buffer maxLength:1024]; if (inputStream.streamError || bytesRead &lt; 0) &#123; error = inputStream.streamError; break; &#125; NSInteger bytesWritten = [outputStream write:buffer maxLength:(NSUInteger)bytesRead]; if (outputStream.streamError || bytesWritten &lt; 0) &#123; error = outputStream.streamError; break; &#125; if (bytesRead == 0 &amp;&amp; bytesWritten == 0) &#123; break; &#125; &#125; [outputStream close]; [inputStream close]; if (handler) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; handler(error); &#125;); &#125; &#125;); NSMutableURLRequest *mutableRequest = [request mutableCopy]; mutableRequest.HTTPBodyStream = nil; return mutableRequest;&#125; Ëøô‰∏™ÊñπÊ≥ïÊúâÁÇπÁâπÊÆäÔºåÂÆÉÊää request ÁöÑËæìÂÖ•ÊµÅÁõ¥Êé•ËøûÂêë‰∫ÜÊú¨Âú∞ÁöÑËæìÂá∫ÊµÅ„ÄÇÂ∞ÜËæìÂÖ•ÊµÅÈáåÁöÑÊï∞ÊçÆÔºåÁõ¥Êé•ÂÜôÂà∞‰∫ÜÊú¨Âú∞ÁöÑ fileURL ‰∏≠„ÄÇ‰∏çÂ§™ÊòéÁôΩÂÖ∂‰∏≠ÁöÑÁî®ÊÑèÔºå‰ª•Âèä‰ΩøÁî®Âú∫ÊôØ„ÄÇ AFHTTPRequestSerializer ÁöÑ‰∏§‰∏™Â≠êÁ±ªAFJSONRequestSerializerËØ•Á±ªÁî®‰∫éÂèëÈÄÅ application/json ËØ∑Ê±Ç„ÄÇÂÆÉ‰ªÖÈáçÂÜô‰∫Ü AFHTTPRequestSerializer ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142- (NSURLRequest *)requestBySerializingRequest:(NSURLRequest *)request withParameters:(id)parameters error:(NSError *__autoreleasing *)error&#123; NSParameterAssert(request); if ([self.HTTPMethodsEncodingParametersInURI containsObject:[[request HTTPMethod] uppercaseString]]) &#123; return [super requestBySerializingRequest:request withParameters:parameters error:error]; &#125; NSMutableURLRequest *mutableRequest = [request mutableCopy]; [self.HTTPRequestHeaders enumerateKeysAndObjectsUsingBlock:^(id field, id value, BOOL * __unused stop) &#123; if (![request valueForHTTPHeaderField:field]) &#123; [mutableRequest setValue:value forHTTPHeaderField:field]; &#125; &#125;]; if (parameters) &#123; if (![mutableRequest valueForHTTPHeaderField:@"Content-Type"]) &#123; [mutableRequest setValue:@"application/json" forHTTPHeaderField:@"Content-Type"]; &#125; if (![NSJSONSerialization isValidJSONObject:parameters]) &#123; if (error) &#123; NSDictionary *userInfo = @&#123;NSLocalizedFailureReasonErrorKey: NSLocalizedStringFromTable(@"The `parameters` argument is not valid JSON.", @"AFNetworking", nil)&#125;; *error = [[NSError alloc] initWithDomain:AFURLRequestSerializationErrorDomain code:NSURLErrorCannotDecodeContentData userInfo:userInfo]; &#125; return nil; &#125; NSData *jsonData = [NSJSONSerialization dataWithJSONObject:parameters options:self.writingOptions error:error]; if (!jsonData) &#123; return nil; &#125; [mutableRequest setHTTPBody:jsonData]; &#125; return mutableRequest;&#125; Â∞Ü‰º†ÂÖ•ÁöÑÂèÇÊï∞ËΩ¨‰∏∫‰∫Ü JSON ÁöÑÂΩ¢ÂºèÔºåËÆæÁΩÆ‰∏∫ request ÁöÑ HTTPBody AFPropertyListRequestSerializerÂÆÉÂíå‰∏äÈù¢ÁöÑÁ±ª‰ººÔºå‰πüÊòØÈáçÂÜô‰∫ÜÂêåÊ†∑ÁöÑÊñπÊ≥ïÔºåÁî®‰∫éÂèëÈÄÅ application/x-plist ËØ∑Ê±ÇÔºö 12345678910111213141516171819202122232425262728293031323334- (NSURLRequest *)requestBySerializingRequest:(NSURLRequest *)request withParameters:(id)parameters error:(NSError *__autoreleasing *)error&#123; NSParameterAssert(request); if ([self.HTTPMethodsEncodingParametersInURI containsObject:[[request HTTPMethod] uppercaseString]]) &#123; return [super requestBySerializingRequest:request withParameters:parameters error:error]; &#125; NSMutableURLRequest *mutableRequest = [request mutableCopy]; [self.HTTPRequestHeaders enumerateKeysAndObjectsUsingBlock:^(id field, id value, BOOL * __unused stop) &#123; if (![request valueForHTTPHeaderField:field]) &#123; [mutableRequest setValue:value forHTTPHeaderField:field]; &#125; &#125;]; if (parameters) &#123; if (![mutableRequest valueForHTTPHeaderField:@"Content-Type"]) &#123; [mutableRequest setValue:@"application/x-plist" forHTTPHeaderField:@"Content-Type"]; &#125; NSData *plistData = [NSPropertyListSerialization dataWithPropertyList:parameters format:self.format options:self.writeOptions error:error]; if (!plistData) &#123; return nil; &#125; [mutableRequest setHTTPBody:plistData]; &#125; return mutableRequest;&#125; ÂÆÉÈÄöËøá NSPropertyListSerialization Â∞ÜÂèÇÊï∞ËΩ¨‰∏∫‰∫Ü plist ÁöÑÂΩ¢Âºè„ÄÇ ÊÄªÁªìÊú¨ÁØáËÆ≤‰∫ÜÂàõÂª∫ NSMutableURLRequest ÁöÑËøáÁ®ã„ÄÇrequest ÁöÑ content-type ÂàÜ‰∏∫ÂõõÁßçÂΩ¢ÂºèÔºö application/x-www-form-urlencoded application/json application/x-plist multipart/form-data Ââç‰∏âÁßçÈÉΩÊòØÂ∞ÜÂèÇÊï∞‰ª• NSData ÁöÑÂΩ¢ÂºèËÆæÁΩÆÁªô request ÁöÑ HTTPBodyÔºåÊúÄÂêé‰∏ÄÁßçÂàôÊòØÈÄöËøá NSInputStream ËÆæÁΩÆÁªô request ÁöÑ HTTPBodyStream „ÄÇ Á¨¨‰∏ÄÁßçÂ∞ÜÂèÇÊï∞‰ª• a=x&amp;b=y&amp;c=z ÁöÑÂΩ¢ÂºèËøûÊé•ÔºåÈúÄË¶ÅÂØπÁîüÊàêÁöÑÂ≠óÁ¨¶‰∏≤ËΩ¨Á†Å„ÄÇ Á¨¨‰∫åÁßçÂ∞ÜÂèÇÊï∞ËΩ¨‰∏∫ json ÂÜçËΩ¨‰∏∫ NSDataÔºåÁõ¥Êé•ËÆæÁΩÆÁªô request Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ Á¨¨‰∏âÁßçÂ∞ÜÂèÇÊï∞ÈÄöËøá NSPropertyListSerialization Áõ¥Êé•ËΩ¨‰∏∫ NSDataÔºåËÆæÁΩÆÁªô request Á¨¨ÂõõÁßçÂ∞ÜÂèÇÊï∞‰ª•Á¨¶ÂêàÁâπÂÆöËßÑÂàôÁöÑ boundary ÂàÜÂâ≤ÔºåÂèØ‰ª•‰º†ÈÄíÊñá‰ª∂„ÄÇÁî® AFHTTPBodyPart ‰Ωú‰∏∫ÊØè‰∏Ä‰∏™ÂèÇÊï∞ÁöÑÊ®°ÂûãÔºåAFMultipartBodyStream ‰Ωú‰∏∫ËæìÂÖ•ÊµÅÔºåÂåÖÂê´ÊâÄÊúâÂèÇÊï∞ÔºåÈáçÂÜô read:maxLength: ÊñπÊ≥ïÔºåÊèê‰æõ buffer Áªô request„ÄÇAFStreamingMultipartFormData ‰Ωú‰∏∫ AFMultipartBodyStream ÁöÑÁÆ°ÁêÜËÄÖÔºåÂ∞Ü AFHTTPBodyPart ËÆæÁΩÆÁªôÂÆÉÔºåÂπ∂‰∏îÊòØÂÆÉÂíå request ÁöÑÊ°•Ê¢Å„ÄÇ ÂÖ∂‰∏≠Âè™ÊúâÁ¨¨ÂõõÁßçÊñπÂºèÈúÄË¶ÅËá™Â∑±ÊâãÂä®ËÆ°ÁÆó content-LengthÔºåÂÖ∂‰ªñÈÉΩÁî±Ê°ÜÊû∂ÈÄöËøá NSData Ëá™Â∑±Ëé∑Âèñ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AFNetworking Ê∫êÁ†ÅËß£Êûê - ÂèëÈÄÅËØ∑Ê±Ç]]></title>
    <url>%2F2018%2F12%2F23%2FAFNetworking4%2F</url>
    <content type="text"><![CDATA[Êú¨ÁØáÊòØ AFNetworking Ê∫êÁ†ÅËß£ËØªÁöÑÁ¨¨‰∏ÄÁØá„ÄÇ‰∏ªË¶ÅÊù•‰∫ÜËß£Â¶Ç‰ΩïÈÄöËøá AFNetworking ÂèëÈÄÅÁΩëÁªúËØ∑Ê±Ç AFHTTPSessionManagerÊàë‰ª¨Âú®ÂÜôÈúÄÊ±ÇÁöÑÊó∂ÂÄôÂæàÂ∞ëÁ¢∞Âà∞Áõ¥Êé•‰ΩøÁî® NSURLSession ÁöÑÊÉÖÂÜµÔºåÈÉΩÊòØ‰ΩøÁî® AFHTTPSessionManager ÁöÑÂ∞ÅË£Ö(ËôΩÁÑ∂Êàë‰ª¨‰∏ÄËà¨ËøòË¶ÅÂÜçÂ∞ÅË£Ö‰∏ÄÂ±Ç)„ÄÇ AFHTTPSessionManager ÊòØ AFURLSessionManager ÁöÑÂ≠êÁ±ªÔºåÂ±û‰∫éÂØπÂ§ñË∞ÉÁî®ÁöÑÊé•Âè£ÔºåÊâøÊãÖ‰∫ÜÂ∞èÈÉ®ÂàÜÁöÑÂäüËÉΩÔºå‰∏ªË¶ÅÂÆûÁé∞ËøòÊòØÂú® AFURLSessionManager ‰∏≠ ÂàùÂßãÂåñAFHTTPSessionManager ÁöÑÂàùÂßãÂåñÊñπÊ≥ïÊúÄÁªàÊù•Âà∞ËøôÈáåÔºö 123456789101112131415161718192021- (instancetype)initWithBaseURL:(NSURL *)url sessionConfiguration:(NSURLSessionConfiguration *)configuration&#123; self = [super initWithSessionConfiguration:configuration]; if (!self) &#123; return nil; &#125; // Ensure terminal slash for baseURL path, so that NSURL +URLWithString:relativeToURL: works as expected if ([[url path] length] &gt; 0 &amp;&amp; ![[url absoluteString] hasSuffix:@"/"]) &#123; url = [url URLByAppendingPathComponent:@""]; &#125; self.baseURL = url; /// ËÆæÁΩÆËØ∑Ê±ÇÂíåËøîÂõûÁöÑÂ∫èÂàóÂåñÂØπË±° self.requestSerializer = [AFHTTPRequestSerializer serializer]; self.responseSerializer = [AFJSONResponseSerializer serializer]; return self;&#125; ÂèÇÊï∞Êé•Êî∂‰∏Ä‰∏™ NSURLSessionConfiguration ÂÆû‰æãÔºåÂÆÉÊòØÂàõÂª∫ NSURLSession ÈúÄË¶ÅÁöÑÈÖçÁΩÆÈ°π„ÄÇÂêåÊó∂ÂÆÉ‰øùÂ≠ò‰∫Ü baseURLÔºåÂπ∂‰∏îÂàõÂª∫‰∫ÜËØ∑Ê±ÇÂíåÂìçÂ∫îÂ∫èÂàóÂåñÂØπË±° requestSerializer Âíå responseSerializer„ÄÇ Âá†‰∏™ set ÊñπÊ≥ïÂàùÂßãÂåñÁöÑÊó∂ÂÄôÔºåÂàõÂª∫‰∫ÜÈªòËÆ§ÁöÑ AFHTTPRequestSerializer Âíå AFJSONResponseSerializer„ÄÇÂ¶ÇÊûúÊúâÁâπÊÆäÁöÑ content-type ÁöÑËØ∑Ê±ÇÊàñËÄÖÁõ∏Â∫îÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÂÆö‰πâÂ∫èÂàóÂåñÂØπË±°ÔºåÂõ†Ê≠§Êèê‰æõ‰∫Ü‰∏§‰∏™ set ÊñπÊ≥ïÔºåÂàÜÂà´ËÆæÁΩÆËØ∑Ê±ÇÂíåÂìçÂ∫îÂ∫èÂàóÂåñÂØπË±°„ÄÇ ËøòÊúâ‰∏Ä‰∏™ÂÖ≥‰∫éÂÆâÂÖ®Á≠ñÁï•ÁöÑ set ÊñπÊ≥ïÔºåÁî®Êù•ËÆæÁΩÆ HTTPS ‰∏ãÔºåËØÅ‰π¶ÁöÑÊ†°È™åÁ≠ñÁï•„ÄÇ 1234567891011121314151617181920212223242526272829303132#pragma mark - ËÆæÁΩÆËØ∑Ê±ÇËøîÂõûÂ∫èÂàóÂåñÂØπË±°- (void)setRequestSerializer:(AFHTTPRequestSerializer &lt;AFURLRequestSerialization&gt; *)requestSerializer &#123; NSParameterAssert(requestSerializer); _requestSerializer = requestSerializer;&#125;- (void)setResponseSerializer:(AFHTTPResponseSerializer &lt;AFURLResponseSerialization&gt; *)responseSerializer &#123; NSParameterAssert(responseSerializer); [super setResponseSerializer:responseSerializer];&#125;@dynamic securityPolicy;#pragma mark - ËÆæÁΩÆÂÆâÂÖ®Á≠ñÁï•- (void)setSecurityPolicy:(AFSecurityPolicy *)securityPolicy &#123; /// Â¶ÇÊûúSSLPinningModeÊòØÊúâÂÆâÂÖ®Á≠ñÁï•ÁöÑÔºå‰ΩÜÊòØËØ∑Ê±ÇÁöÑ scheme ‰∏çÊòØ https ÁöÑÔºåÈÇ£‰πàÂ∞±Ë¶ÅÊä•Èîô„ÄÇÂõ†‰∏∫ÂÆâÂÖ®Á≠ñÁï•ÂøÖÈ°ªË¶ÅÂú® https Ê®°Âºè‰∏ã if (securityPolicy.SSLPinningMode != AFSSLPinningModeNone &amp;&amp; ![self.baseURL.scheme isEqualToString:@"https"]) &#123; NSString *pinningMode = @"Unknown Pinning Mode"; switch (securityPolicy.SSLPinningMode) &#123; case AFSSLPinningModeNone: pinningMode = @"AFSSLPinningModeNone"; break; case AFSSLPinningModeCertificate: pinningMode = @"AFSSLPinningModeCertificate"; break; case AFSSLPinningModePublicKey: pinningMode = @"AFSSLPinningModePublicKey"; break; &#125; NSString *reason = [NSString stringWithFormat:@"A security policy configured with `%@` can only be applied on a manager with a secure base URL (i.e. https)", pinningMode]; @throw [NSException exceptionWithName:@"Invalid Security Policy" reason:reason userInfo:nil]; &#125; /// Áªô URL ËÆæÁΩÆÂÆâÂÖ®Á≠ñÁï• [super setSecurityPolicy:securityPolicy];&#125; ËØ≠‰πâÂåñËØ∑Ê±ÇÊñπÊ≥ïAFN Êèê‰æõ‰∫ÜËøõË°å‰∏çÂêåÊñπÂºèËØ∑Ê±ÇÁöÑÊñπÊ≥ïÂ∞ÅË£ÖÔºåËøôÈáåËøõÂàó‰∏æ get Âíå post ‰∏§‰∏™ÊñπÊ≥ïÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243/// get ÁöÑÊ≠£ÁúüÊñπÊ≥ïÂ∏¶Êúâ progress ÂèÇÊï∞- (NSURLSessionDataTask *)GET:(NSString *)URLString parameters:(id)parameters progress:(void (^)(NSProgress * _Nonnull))downloadProgress success:(void (^)(NSURLSessionDataTask * _Nonnull, id _Nullable))success failure:(void (^)(NSURLSessionDataTask * _Nullable, NSError * _Nonnull))failure&#123; /// ÂàõÂª∫ NSURLSessionDataTask NSURLSessionDataTask *dataTask = [self dataTaskWithHTTPMethod:@"GET" URLString:URLString parameters:parameters uploadProgress:nil downloadProgress:downloadProgress success:success failure:failure]; [dataTask resume]; return dataTask;&#125;- (NSURLSessionDataTask *)POST:(NSString *)URLString parameters:(id)parameters success:(void (^)(NSURLSessionDataTask *task, id responseObject))success failure:(void (^)(NSURLSessionDataTask *task, NSError *error))failure&#123; return [self POST:URLString parameters:parameters progress:nil success:success failure:failure];&#125;/// post ÊñπÊ≥ï Â∏¶ progress ÂèÇÊï∞ÁöÑ- (NSURLSessionDataTask *)POST:(NSString *)URLString parameters:(id)parameters progress:(void (^)(NSProgress * _Nonnull))uploadProgress success:(void (^)(NSURLSessionDataTask * _Nonnull, id _Nullable))success failure:(void (^)(NSURLSessionDataTask * _Nullable, NSError * _Nonnull))failure&#123; NSURLSessionDataTask *dataTask = [self dataTaskWithHTTPMethod:@"POST" URLString:URLString parameters:parameters uploadProgress:uploadProgress downloadProgress:nil success:success failure:failure]; [dataTask resume]; return dataTask;&#125; ‰ªñ‰ª¨Ë∞ÉÁî®‰∫ÜÂè¶‰∏Ä‰∏™ÊñπÊ≥ïÂêéÔºåÂ∞±ÁîüÊàê‰∫Ü‰∏Ä‰∏™ NSURLSessionDataTask ÂÆû‰æãÂØπË±°ÔºåÂπ∂‰∏îÈÄöËøá resume ÊñπÊ≥ïÂºÄÂêØÁΩëÁªúËØ∑Ê±Ç„ÄÇ ÈÇ£‰πàÂàõÂª∫ NSURLSessionDataTask ÁöÑÊñπÊ≥ïÂÅö‰∫Ü‰ªÄ‰πàÂë¢Ôºü 1234567891011121314151617181920212223242526272829303132333435363738394041/// ‰∏çÂ∏¶ constructingBodyWithBlock ÂàõÂª∫ NSURLSessionDataTask- (NSURLSessionDataTask *)dataTaskWithHTTPMethod:(NSString *)method URLString:(NSString *)URLString parameters:(id)parameters uploadProgress:(nullable void (^)(NSProgress *uploadProgress)) uploadProgress downloadProgress:(nullable void (^)(NSProgress *downloadProgress)) downloadProgress success:(void (^)(NSURLSessionDataTask *, id))success failure:(void (^)(NSURLSessionDataTask *, NSError *))failure&#123; NSError *serializationError = nil; /// ÈÄöËøá requestSerializer ÂàõÂª∫ NSMutableURLRequest NSMutableURLRequest *request = [self.requestSerializer requestWithMethod:method URLString:[[NSURL URLWithString:URLString relativeToURL:self.baseURL] absoluteString] parameters:parameters error:&amp;serializationError]; if (serializationError) &#123; if (failure) &#123; dispatch_async(self.completionQueue ?: dispatch_get_main_queue(), ^&#123; failure(nil, serializationError); &#125;); &#125; return nil; &#125; __block NSURLSessionDataTask *dataTask = nil; /// ÈÄöËøá request ÂàõÂª∫ dataTask. ËøôÊòØ AFURLSessionManager ‰∏≠ÁöÑÊñπÊ≥ï dataTask = [self dataTaskWithRequest:request uploadProgress:uploadProgress downloadProgress:downloadProgress completionHandler:^(NSURLResponse * __unused response, id responseObject, NSError *error) &#123; if (error) &#123; if (failure) &#123; failure(dataTask, error); &#125; &#125; else &#123; if (success) &#123; success(dataTask, responseObject); &#125; &#125; &#125;]; return dataTask;&#125; È¶ñÂÖàÈÄöËøáÂâçÈù¢ÁöÑËØ∑Ê±ÇÂ∫èÂàóÂåñÁ±ªÂàõÂª∫‰∏Ä‰∏™ NSMutableURLRequest ÁÑ∂Âêé‰ΩøÁî®ÂÆÉÂàõÂª∫ NSURLSessionDataTaskÔºå‰∏çËøáÂàõÂª∫ÊñπÊ≥ï‰∏çÂú®Êú¨Á±ª‰∏≠ÔºåËÄåÊòØÂú®ÂÆÉÁöÑÁà∂Á±ª‰∏≠„ÄÇËøô‰∏™Â∞ÜÁ®çÂêéÂÜçÁúã„ÄÇ ÂèØ‰ª•ÁúãÂà∞ÔºåÂú®ÁªèËøá‰∏ÄÁ≥ªÂàóÁöÑÂ∞ÅË£Ö‰πãÂêéÔºåÂèëÈÄÅ‰∏Ä‰∏™ÁΩëÁªúËØ∑Ê±ÇÈúÄË¶ÅÁöÑ NSMutableURLRequestÔºåNSURLSessionÔºåNSURLSessionDataTask ÈÉΩÈÄöËøá AFN ÂàõÂª∫‰∫ÜÔºåËÄåËá™Â∑±Âè™ÈúÄË¶ÅË¥üË¥£‰º†ÂÖ•ËØ∑Ê±ÇÔºåÂèÇÊï∞ÂíåÂõûË∞ÉÂç≥ÂèØ„ÄÇ ÂèëÈÄÅ form-data ËØ∑Ê±Ç‰∏äÈù¢ÁöÑ getÔºåpost ÊñπÊ≥ïÊó†Ê≥ïÂèëÈÄÅÊñá‰ª∂ÔºåÂõ†Ê≠§ÔºåAFN Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ïÁî®Êù•ÂèëÈÄÅ form-data Á±ªÂûãÁöÑËØ∑Ê±ÇÔºö 123456789101112131415161718192021222324252627282930313233343536373839/// post ÊñπÊ≥ïÂ∏¶ constructingBodyWithBlock ÁöÑ/// constructingBodyWithBlock ÂèÇÊï∞ formData ‰ºöË¢´Ê∑ªÂä†Âà∞ http body ‰∏≠- (NSURLSessionDataTask *)POST:(NSString *)URLString parameters:(id)parameters constructingBodyWithBlock:(void (^)(id &lt;AFMultipartFormData&gt; formData))block progress:(nullable void (^)(NSProgress * _Nonnull))uploadProgress success:(void (^)(NSURLSessionDataTask *task, id responseObject))success failure:(void (^)(NSURLSessionDataTask *task, NSError *error))failure&#123; NSError *serializationError = nil; /// ÂàùÂßãÂåñ‰∏Ä‰∏™ requestÔºåÂåÖÂê´‰∫ÜÂèÇÊï∞‰ª•ÂèäÁîüÊàê http body ‰∏≠ÁöÑ constructingBodyWithBlock NSMutableURLRequest *request = [self.requestSerializer multipartFormRequestWithMethod:@"POST" URLString:[[NSURL URLWithString:URLString relativeToURL:self.baseURL] absoluteString] parameters:parameters constructingBodyWithBlock:block error:&amp;serializationError]; /// Â∫èÂàóÂåñÈîôËØØ if (serializationError) &#123; if (failure) &#123; dispatch_async(self.completionQueue ?: dispatch_get_main_queue(), ^&#123; failure(nil, serializationError); &#125;); &#125; return nil; &#125; __block NSURLSessionDataTask *task = [self uploadTaskWithStreamedRequest:request progress:uploadProgress completionHandler:^(NSURLResponse * __unused response, id responseObject, NSError *error) &#123; if (error) &#123; if (failure) &#123; failure(task, error); &#125; &#125; else &#123; if (success) &#123; success(task, responseObject); &#125; &#125; &#125;]; [task resume]; return task;&#125; ËØ•ÊñπÊ≥ï‰ºöÂèëËµ∑‰∏Ä‰∏™ form-data Á±ªÂûãÁöÑËØ∑Ê±Ç„ÄÇ‰Ω†ÂèØ‰ª•Â∞Ü NSData ÊîæÂÖ• param ‰∏≠ÔºåÁî± AFN ËøõË°åÂ∫èÂàóÂåñ„ÄÇ‰πüÂèØ‰ª•ÊãøÂà∞ constructingBodyWithBlock ‰∏≠ÁöÑ blockÔºåÈÄöËøá AFMultipartFormData ÂçèËÆÆÁöÑÊñπÊ≥ïÔºåÂêëÂÖ∂‰∏≠Ê∑ªÂä† fileURLÔºåÊù•ÂëäËØâ AFN ÂéªÂ∫èÂàóÂåñËØ•Âú∞ÂùÄ‰∏ãÁöÑÊñá‰ª∂„ÄÇ AFURLSessionManagerAFURLSessionManager ÊòØ AFN ËØ∑Ê±ÇÁöÑÊ†∏ÂøÉ„ÄÇÂÆÉÈÅµÂæ™‰∫Ü‰∏ãÈù¢Âá†‰∏™ÂçèËÆÆÔºö NSURLSessionTaskDelegate NSURLSessionDataDelegate NSURLSessionDownloadDelegate NSURLSessionDelegate AFURLSessionManager ÁöÑÂ±ûÊÄßAFURLSessionManager ‰∏≠ÂåÖÂê´‰∫ÜÈùûÂ∏∏Â§öÁöÑÂÆûÁé∞ÂçèËÆÆÊó∂Ëá™ÂÆö‰πâÁöÑ blockÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142@interface AFURLSessionManager ()/// ÊâßË°åÂìçÂ∫îÁöÑÈòüÂàó@property (readwrite, nonatomic, strong) NSOperationQueue *operationQueue;/// task &lt;=&gt; ‰ª£ÁêÜ@property (readwrite, nonatomic, strong) NSMutableDictionary *mutableTaskDelegatesKeyedByTaskIdentifier;/// session ÁöÑ taskDescription ÈÉΩÊòØÁõ∏ÂêåÁöÑ@property (readonly, nonatomic, copy) NSString *taskDescriptionForSessionTasks;// NSURLSessionDelegate/// Áî±‰∫éÁ≥ªÁªüÂéüÂõ†ÂØºËá¥‰ºöËØùÂ§±ÊïàÊó∂ÁöÑÂõûË∞É@property (readwrite, nonatomic, copy) AFURLSessionDidBecomeInvalidBlock sessionDidBecomeInvalid;/// ËøûÊé•ÊúçÂä°Âô®ÔºåÊé•Êî∂Âà∞ËÆ§ËØÅËØ∑Ê±ÇÊó∂ÔºåÂèØ‰ª•ËøîÂõûÊåáÂÆöÁöÑËÆ§ËØÅÈÄâÈ°π@property (readwrite, nonatomic, copy) AFURLSessionDidReceiveAuthenticationChallengeBlock sessionDidReceiveAuthenticationChallenge;/// ÂΩìÂ∫îÁî®ËøõÂÖ•ÂêéÂè∞Êó∂ÂàõÂª∫ÁöÑÂêéÂè∞‰ºöËØùÁöÑÁõ∏ÂÖ≥‰ªªÂä°ÂùáÊâßË°åÂÆåÊØïÊó∂ÔºåËØ•ÂõûË∞ÉÂú®‰∏ªÈòüÂàó‰∏≠Ë¢´ÊâßË°å@property (readwrite, nonatomic, copy) AFURLSessionDidFinishEventsForBackgroundURLSessionBlock didFinishEventsForBackgroundURLSession;// NSURLSessionTaskDelegate/// Êé•Êî∂Âà∞ÈáçÂÆöÂêëÂèçÈ¶àÊó∂ÔºåËØ•‰ª£Á†ÅÂùóÂèØ‰ª•ÊåáÂÆöÈáçÂÆöÂêëÁöÑÈìæÊé•@property (readwrite, nonatomic, copy) AFURLSessionTaskWillPerformHTTPRedirectionBlock taskWillPerformHTTPRedirection;///ÂΩìÊï∞ÊçÆ‰ªªÂä°Ë¢´Ë¶ÅÊ±ÇËøõË°åËØÅ‰π¶Âä†ÂØÜÊó∂ÔºåËØ•‰ª£Á†ÅÂùóÂèØ‰ª•ÊåáÂÆöÁõ∏ÂÖ≥ÈÄâÊã©È°πÔºåÂ¶Ç‰ΩøÁî®ËØÅ‰π¶„ÄÅÈªòËÆ§Â§ÑÁêÜ„ÄÅÂèñÊ∂àËØ∑Ê±Ç@property (readwrite, nonatomic, copy) AFURLSessionTaskDidReceiveAuthenticationChallengeBlock taskDidReceiveAuthenticationChallenge;/// ‰ªªÂä°ÈúÄË¶ÅÊµÅ‰º†ÈÄíÊï∞ÊçÆÁªôÊúçÂä°Á´ØÊó∂ÔºåËØ•‰ª£Á†ÅÂùóÂèØ‰ª•ËøîÂõû‰∏Ä‰∏™ËæìÂÖ•ÊµÅ@property (readwrite, nonatomic, copy) AFURLSessionTaskNeedNewBodyStreamBlock taskNeedNewBodyStream;/// ÂΩìÊï∞ÊçÆ‰∏ä‰º†Êó∂ÔºåËØ•‰ª£Á†ÅÂõûË∞ÉÂèØ‰ª•Áî®Êù•Ëé∑ÂèñÊú¨Ê¨°‰∏ä‰º†ÁöÑÂ≠óËäÇÊï∞„ÄÅÂ∑≤Áªè‰∏ä‰º†ÁöÑÂ≠óËäÇÊï∞„ÄÅËØ•‰ªªÂä°ÈúÄË¶Å‰∏ä‰º†ÁöÑÊÄªÂ≠óËäÇÊï∞@property (readwrite, nonatomic, copy) AFURLSessionTaskDidSendBodyDataBlock taskDidSendBodyData;/// ÂΩì‰ªªÂä°ÁªìÊùüÊó∂ÔºåËØ•‰ª£Á†ÅÂõûË∞É‰ºöË¢´ÊâßË°åÔºåÂèØ‰ª•Ëé∑ÂèñÈîôËØØ‰ø°ÊÅØÔºåÂ¶ÇÊûúÊúâÁöÑËØù@property (readwrite, nonatomic, copy) AFURLSessionTaskDidCompleteBlock taskDidComplete;// NSURLSessionDataDelegate/// ÂΩìÊï∞ÊçÆ‰ªªÂä°Êé•Êî∂Âà∞ÊúçÂä°Âô®ÂìçÂ∫îÊó∂ÔºåËØ•ÂõûË∞ÉÂèØ‰ª•ÈÄâÊã©ÂèñÊ∂àÊàñÂÖÅËÆ∏Á≠âÈÄâÈ°π@property (readwrite, nonatomic, copy) AFURLSessionDataTaskDidReceiveResponseBlock dataTaskDidReceiveResponse;/// ÂΩìÊï∞ÊçÆ‰ªªÂä°Â∞ÜËΩ¨Âèò‰∏∫Êï∞ÊçÆ‰∏ãËΩΩ‰ªªÂä°Êó∂ÔºåËØ•ÂõûË∞ÉÂèØ‰ª•ËøõË°å‰∏Ä‰∫õÂ§ÑÁêÜÔºåÂõûË∞ÉÂèÇÊï∞‰∏≠ÂåÖÂê´‰∫ÜÂéü‰ªªÂä°ÔºåÂíåÂ∞ÜË¶ÅËΩ¨Âèò‰∏∫ÁöÑÁõÆÊ†á‰ªªÂä°@property (readwrite, nonatomic, copy) AFURLSessionDataTaskDidBecomeDownloadTaskBlock dataTaskDidBecomeDownloadTask;/// ÂΩìÊé•Êî∂Âà∞ÊúçÂä°Á´ØÊï∞ÊçÆÊó∂ÔºåËØ•ÂõûË∞ÉË¢´ÊâßË°å@property (readwrite, nonatomic, copy) AFURLSessionDataTaskDidReceiveDataBlock dataTaskDidReceiveData;/// Â∞ÜË¶ÅÁºìÂ≠òÂìçÂ∫îÊä•ÊñáÊó∂ÔºåÂèØ‰ª•ÂØπËøîÂõûÁöÑÂìçÂ∫îÊä•ÊñáËøõË°å‰∏Ä‰∫õÂ§ÑÁêÜÔºåÂõûË∞ÉÂèÇÊï∞‰∏≠ÂåÖÂê´‰∫Ü NSCachedURLResponse ÁöÑÂÆû‰æãÂØπË±°Ôºå‰πüÊòØÂç≥Â∞ÜËøîÂõûÁöÑÂÆû‰æã@property (readwrite, nonatomic, copy) AFURLSessionDataTaskWillCacheResponseBlock dataTaskWillCacheResponse;// NSURLSessionDownloadDelegate/// ÂΩì‰∏ãËΩΩ‰ªªÂä°ÁªìÊùüÊó∂ÔºåËØ•ÂõûË∞É‰ª£Á†ÅÂùóÂèØ‰ª•ÊåáÂÆö‰∏ãËΩΩÁöÑÁºìÂ≠òÊï∞ÊçÆÁßªÂä®Âà∞ÁöÑÁõÆÊ†áÂú∞ÂùÄ@property (readwrite, nonatomic, copy) AFURLSessionDownloadTaskDidFinishDownloadingBlock downloadTaskDidFinishDownloading;/// Âú®Êï∞ÊçÆ‰∏ãËΩΩÁöÑËøáÁ®ã‰∏≠ÔºåËØ•ÂõûË∞É‰ºöË¢´Ë∞ÉÁî®ÔºåÂÖ∂ÂèÇÊï∞ÂåÖÂê´ÊúâÊú¨Ê¨°‰∏ãËΩΩÁöÑÊï∞ÊçÆÂ≠óËäÇÊï∞„ÄÅÂ∑≤Áªè‰∏ãËΩΩÁöÑÂ≠óËäÇÊï∞„ÄÅËØ•‰ªªÂä°ÈúÄË¶Å‰∏ãËΩΩÁöÑÊÄªÂ≠óËäÇÊï∞@property (readwrite, nonatomic, copy) AFURLSessionDownloadTaskDidWriteDataBlock downloadTaskDidWriteData;/// ÂΩì‰∏ãËΩΩ‰ªªÂä°ÂÜçÊ¨°ÂêØÂä®Êó∂ÔºåËØ•ÂõûË∞ÉÊâßË°åÔºåÂõûË∞ÉÂèÇÊï∞ÂåÖÂê´ÊúâÊñá‰ª∂ÁöÑÂ≠óËäÇÂÅèÁßªÈáèÂíåÊï¥‰∏™Êñá‰ª∂ÁöÑÂ≠óËäÇÈïøÂ∫¶@property (readwrite, nonatomic, copy) AFURLSessionDownloadTaskDidResumeBlock downloadTaskDidResume;@end AFURLSessionManager ÁöÑÊñπÊ≥ïÂàùÂßãÂåñÊñπÊ≥ïÂàùÂßãÂåñÊñπÊ≥ï‰∏≠ÂàõÂª∫‰∫ÜËØ∑Ê±ÇÈúÄË¶Å‰ΩøÁî®ÁöÑÂêÑÁßçÂü∫Êú¨Â±ûÊÄßÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748#pragma mark - ÂàùÂßãÂåñÊñπÊ≥ï- (instancetype)initWithSessionConfiguration:(NSURLSessionConfiguration *)configuration &#123; self = [super init]; if (!self) &#123; return nil; &#125; if (!configuration) &#123; configuration = [NSURLSessionConfiguration defaultSessionConfiguration]; &#125; self.sessionConfiguration = configuration; self.operationQueue = [[NSOperationQueue alloc] init]; self.operationQueue.maxConcurrentOperationCount = 1; /// ÂàõÂª∫ NSURLSession self.session = [NSURLSession sessionWithConfiguration:self.sessionConfiguration delegate:self delegateQueue:self.operationQueue]; self.responseSerializer = [AFJSONResponseSerializer serializer]; self.securityPolicy = [AFSecurityPolicy defaultPolicy]; self.reachabilityManager = [AFNetworkReachabilityManager sharedManager]; self.mutableTaskDelegatesKeyedByTaskIdentifier = [[NSMutableDictionary alloc] init]; self.lock = [[NSLock alloc] init]; self.lock.name = AFURLSessionManagerLockName; /// ‰∏∫sessionÁöÑÊâÄÊúâtaskËÆæÁΩÆ delegate /// ÂÅöÊ∏ÖÁ©∫Â§ÑÁêÜÔºåÊúâ‰∏ÄÁßçÂêéÂè∞sessionÔºåÂΩì‰ªéÂêéÂè∞ÂõûÊù•ÁöÑÊó∂ÂÄôÔºåÊ†πÊçÆ configuration ‰∏≠ÁöÑ‰∏Ä‰∏™ IDÔºåÂ∞±ÂèØ‰ª•ÈáçÊñ∞ÊÅ¢Â§çËøô‰∏™sessionÔºåËøôÊó∂ÂÄôÂÖ∂‰∏≠Â∞±‰ºöÊúâ‰πãÂâçÊú™ÂÆåÊàêÁöÑtask‰∫Ü„ÄÇËøôÈáåËøô‰πàÂÅöÁöÑÁõÆÁöÑÂ∞±ÊòØÈò≤Ê≠¢‰∏Ä‰∫õ‰πãÂâçÁöÑÂêéÂè∞ËØ∑Ê±Ç‰ªªÂä°ÔºåÂØºËá¥Á®ãÂ∫èÁöÑcrash„ÄÇ [self.session getTasksWithCompletionHandler:^(NSArray *dataTasks, NSArray *uploadTasks, NSArray *downloadTasks) &#123; for (NSURLSessionDataTask *task in dataTasks) &#123; [self addDelegateForDataTask:task uploadProgress:nil downloadProgress:nil completionHandler:nil]; &#125; for (NSURLSessionUploadTask *uploadTask in uploadTasks) &#123; [self addDelegateForUploadTask:uploadTask progress:nil completionHandler:nil]; &#125; for (NSURLSessionDownloadTask *downloadTask in downloadTasks) &#123; [self addDelegateForDownloadTask:downloadTask progress:nil destination:nil completionHandler:nil]; &#125; &#125;]; return self;&#125; ÂàõÂª∫ TaskÂàõÂª∫ÁöÑ Task ÂàÜ‰∏∫‰∏âÁßçÔºåÊôÆÈÄöÁöÑ dataTaskÔºå‰∏ä‰º†ÁöÑ uploadTask Âíå‰∏ãËΩΩÁöÑ downloadTask„ÄÇ dataTaskÂú® AFHTTPSessionManager ‰∏≠Â∑≤ÁªèÂàõÂª∫Â•Ω‰∫Ü NSURLRequest ÂØπË±°ÔºåË∞ÉÁî®‰ª•‰∏ãÊñπÊ≥ïÂàõÂª∫ NSURLSessionDataTask ÂØπË±°ÂÆû‰æãÔºö 1234567891011121314151617181920212223- (NSURLSessionDataTask *)dataTaskWithRequest:(NSURLRequest *)request completionHandler:(void (^)(NSURLResponse *response, id responseObject, NSError *error))completionHandler&#123; return [self dataTaskWithRequest:request uploadProgress:nil downloadProgress:nil completionHandler:completionHandler];&#125;/// cÈÄöËøá request ÂàõÂª∫ dataTask- (NSURLSessionDataTask *)dataTaskWithRequest:(NSURLRequest *)request uploadProgress:(nullable void (^)(NSProgress *uploadProgress)) uploadProgressBlock downloadProgress:(nullable void (^)(NSProgress *downloadProgress)) downloadProgressBlock completionHandler:(nullable void (^)(NSURLResponse *response, id _Nullable responseObject, NSError * _Nullable error))completionHandler &#123; __block NSURLSessionDataTask *dataTask = nil; /// iOS8‰∏ãÂèØËÉΩ‰ºöÂàõÂª∫Â§ö‰∏™ task url_session_manager_create_task_safely(^&#123; dataTask = [self.session dataTaskWithRequest:request]; &#125;); /// Áªô dataTask ÂàõÂª∫ delegate [self addDelegateForDataTask:dataTask uploadProgress:uploadProgressBlock downloadProgress:downloadProgressBlock completionHandler:completionHandler]; return dataTask;&#125; Èô§‰∫ÜÁÆÄÂçïË∞ÉÁî® NSURLSession ÁöÑ API ÁîüÊàêÂÆû‰æãÂ§ñÔºåAFURLSessionManager ËøòÈúÄË¶ÅÁªôÁîüÊàêÁöÑ dataTask ÂàõÂª∫‰∏Ä‰∏™‰ª£ÁêÜÂØπË±°„ÄÇËøô‰∏™‰∏ãÈù¢Â∞±‰ºöËØ¥Âà∞„ÄÇ uploadTaskuploadTask Âú® AFHTTPSessionManager ‰∏≠Ê≤°Êúâ‰ΩøÁî®ÔºåAFHTTPSessionManger Êèê‰æõÁöÑÊñπÊ≥ï‰∏≠Ë¶ÅÊÉ≥ÂÆûÁé∞‰∏ä‰º†ÂäüËÉΩÔºåÈúÄË¶ÅËá™Â∑±ÊääÊñá‰ª∂ËΩ¨‰∏∫ NSData ÂêéÈÄöËøáÂèÇÊï∞‰∏ä‰º†„ÄÇËÄå uploadTask ÊòØËá™Â∑±ÈÄöËøáËæìÂÖ•ÊµÅÁöÑÊñπÂºèÂ∞ÜÊï∞ÊçÆÂÜôÂÖ•Âà∞‰∫Ü request ‰∏≠„ÄÇ‰ΩøÁî® uploadTask ÂàôËÉΩÊõ¥Âä†Êñπ‰æøÁöÑ‰∫§Áî± NSURLSession ÂÆåÊàêÁõ∏Â∫îÁöÑ‰ªªÂä°„ÄÇÂè™ÈúÄË¶Å‰º†ÂÖ•Êñá‰ª∂Ë∑ØÂæÑÔºådataÔºåÊàñËÄÖËæìÂÖ•ÊµÅÂç≥ÂèØÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647#pragma mark - ÁîüÊàê uploadTask/// ÈÄöËøáÊñá‰ª∂Ë∑ØÂæÑ‰∏ä‰º†- (NSURLSessionUploadTask *)uploadTaskWithRequest:(NSURLRequest *)request fromFile:(NSURL *)fileURL progress:(void (^)(NSProgress *uploadProgress)) uploadProgressBlock completionHandler:(void (^)(NSURLResponse *response, id responseObject, NSError *error))completionHandler&#123; __block NSURLSessionUploadTask *uploadTask = nil; url_session_manager_create_task_safely(^&#123; uploadTask = [self.session uploadTaskWithRequest:request fromFile:fileURL]; &#125;); [self addDelegateForUploadTask:uploadTask progress:uploadProgressBlock completionHandler:completionHandler]; return uploadTask;&#125;/// ÈÄöËøádata‰∏ä‰º†- (NSURLSessionUploadTask *)uploadTaskWithRequest:(NSURLRequest *)request fromData:(NSData *)bodyData progress:(void (^)(NSProgress *uploadProgress)) uploadProgressBlock completionHandler:(void (^)(NSURLResponse *response, id responseObject, NSError *error))completionHandler&#123; __block NSURLSessionUploadTask *uploadTask = nil; url_session_manager_create_task_safely(^&#123; uploadTask = [self.session uploadTaskWithRequest:request fromData:bodyData]; &#125;); [self addDelegateForUploadTask:uploadTask progress:uploadProgressBlock completionHandler:completionHandler]; return uploadTask;&#125;/// ÈÄöËøáÊµÅ‰∏ä‰º†- (NSURLSessionUploadTask *)uploadTaskWithStreamedRequest:(NSURLRequest *)request progress:(void (^)(NSProgress *uploadProgress)) uploadProgressBlock completionHandler:(void (^)(NSURLResponse *response, id responseObject, NSError *error))completionHandler&#123; __block NSURLSessionUploadTask *uploadTask = nil; url_session_manager_create_task_safely(^&#123; uploadTask = [self.session uploadTaskWithStreamedRequest:request]; &#125;); [self addDelegateForUploadTask:uploadTask progress:uploadProgressBlock completionHandler:completionHandler]; return uploadTask;&#125; ÂêåÊ†∑ÁöÑÔºåÊØè‰∏Ä‰∏™ dataTask ÈÉΩ‰ºöËÆæÁΩÆ‰∏Ä‰∏™ delegate„ÄÇ downloadTaskdownloadTask ÂàÜ‰∏∫‰∏§‰∏™ÈÉ®ÂàÜÔºå‰∏Ä‰∏™ÊòØÂàõÂª∫Ôºå‰∏Ä‰∏™ÊòØÊñ≠Á∫øÁª≠‰º†Ôºö 123456789101112131415161718192021222324252627282930313233#pragma mark - ÁîüÊàê downloadTask/// ÂàõÂª∫‰∏ãËΩΩ‰ªªÂä°- (NSURLSessionDownloadTask *)downloadTaskWithRequest:(NSURLRequest *)request progress:(void (^)(NSProgress *downloadProgress)) downloadProgressBlock destination:(NSURL * (^)(NSURL *targetPath, NSURLResponse *response))destination completionHandler:(void (^)(NSURLResponse *response, NSURL *filePath, NSError *error))completionHandler&#123; __block NSURLSessionDownloadTask *downloadTask = nil; url_session_manager_create_task_safely(^&#123; downloadTask = [self.session downloadTaskWithRequest:request]; &#125;); [self addDelegateForDownloadTask:downloadTask progress:downloadProgressBlock destination:destination completionHandler:completionHandler]; return downloadTask;&#125;/// ÁªßÁª≠‰∏ãËΩΩ- (NSURLSessionDownloadTask *)downloadTaskWithResumeData:(NSData *)resumeData progress:(void (^)(NSProgress *downloadProgress)) downloadProgressBlock destination:(NSURL * (^)(NSURL *targetPath, NSURLResponse *response))destination completionHandler:(void (^)(NSURLResponse *response, NSURL *filePath, NSError *error))completionHandler&#123; __block NSURLSessionDownloadTask *downloadTask = nil; url_session_manager_create_task_safely(^&#123; downloadTask = [self.session downloadTaskWithResumeData:resumeData]; &#125;); [self addDelegateForDownloadTask:downloadTask progress:downloadProgressBlock destination:destination completionHandler:completionHandler]; return downloadTask;&#125; Â¶ÇÊûú‰Ω†‰∏çÁÜüÊÇâ NSURLSessionDownloadTask ÈÇ£‰πà‰Ω†‰∏ÄÂÆö‰ºöÂæàÁñëÊÉë‰∏ãÈù¢Ëøô‰∏™ÁªßÁª≠‰∏ãËΩΩ‰∏∫‰ªÄ‰πàÂè™Ë¶Å‰º†‰∏Ä‰∏™ resumeData Â∞±ÂèØ‰ª•Áü•ÈÅì‰∏ãËΩΩÁöÑÊâÄÊúâ‰ø°ÊÅØÁöÑ„ÄÇÂÖ∂ÂÆûËøô‰∏™ resumeData Âπ∂‰∏çÊòØ‰∏ãËΩΩÁöÑÊï∞ÊçÆÔºåËÄåÊòØ‰∏ãËΩΩÊï∞ÊçÆÁöÑ‰ø°ÊÅØÁöÑ plist ÁîüÊàêÁöÑ NSDataÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∫Ü‰∏ãËΩΩÊâÄÈúÄË¶ÅÁöÑÂêÑÁßç‰ø°ÊÅØÔºåÂåÖÊã¨Êú¨Âú∞ÁºìÂ≠òÁöÑË∑ØÂæÑÂêçÔºå‰∏ãËΩΩÁöÑÂú∞ÂùÄÔºåÂΩìÂâç‰∏ãËΩΩ‰∫ÜÂ§öÂ∞ëÁ≠â„ÄÇ ‰∏∫ task ÂàõÂª∫‰ª£ÁêÜtask ËØ∑Ê±ÇËøáÁ®ã‰∏≠ÁöÑËØ∑Ê±Ç‰∏≠ËØ∑Ê±ÇÂÆåÊàêÁöÑÂõûË∞ÉÈÉΩÊòØÈÄöËøá delegate ÂÆåÊàêÁöÑ„ÄÇdelegate ÊòØ‰∏Ä‰∏™ AFURLSessionManagerTaskDelegate ÂÆû‰æã„ÄÇÊ∑ªÂä†‰ª£ÁêÜÁöÑËøáÁ®ãÂ∞±ÊòØÂàõÂª∫ÂÆû‰æãÂπ∂ËÆæÁΩÆÂõûË∞ÉÊñπÊ≥ïÁöÑËøáÁ®ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768/// ËÆæÁΩÆ task ÁöÑ‰ª£ÁêÜÔºõ ‰ª£ÁêÜÂåÖÂê´‰∫Ü task ÁöÑÂêÑÁßçÂõûË∞É„ÄÇ- (void)setDelegate:(AFURLSessionManagerTaskDelegate *)delegate forTask:(NSURLSessionTask *)task&#123; NSParameterAssert(task); NSParameterAssert(delegate); [self.lock lock]; self.mutableTaskDelegatesKeyedByTaskIdentifier[@(task.taskIdentifier)] = delegate; [self addNotificationObserverForTask:task]; [self.lock unlock];&#125;/// Áªô datatask Â¢ûÂä†‰ª£ÁêÜÂØπË±°- (void)addDelegateForDataTask:(NSURLSessionDataTask *)dataTask uploadProgress:(nullable void (^)(NSProgress *uploadProgress)) uploadProgressBlock downloadProgress:(nullable void (^)(NSProgress *downloadProgress)) downloadProgressBlock completionHandler:(void (^)(NSURLResponse *response, id responseObject, NSError *error))completionHandler&#123; /// ÂàõÂª∫‰∏Ä‰∏™ dataTask ÁöÑ‰ª£ÁêÜ AFURLSessionManagerTaskDelegate *delegate = [[AFURLSessionManagerTaskDelegate alloc] initWithTask:dataTask]; delegate.manager = self; delegate.completionHandler = completionHandler; /// ËÆæÁΩÆ taskDescription ÊúâÂä©‰∫éÂå∫Âà´ÊòØÂê¶ÊòØ AFN ÂàõÂª∫ÁöÑ task dataTask.taskDescription = self.taskDescriptionForSessionTasks; [self setDelegate:delegate forTask:dataTask]; delegate.uploadProgressBlock = uploadProgressBlock; delegate.downloadProgressBlock = downloadProgressBlock;&#125;- (void)addDelegateForUploadTask:(NSURLSessionUploadTask *)uploadTask progress:(void (^)(NSProgress *uploadProgress)) uploadProgressBlock completionHandler:(void (^)(NSURLResponse *response, id responseObject, NSError *error))completionHandler&#123; AFURLSessionManagerTaskDelegate *delegate = [[AFURLSessionManagerTaskDelegate alloc] initWithTask:uploadTask]; delegate.manager = self; delegate.completionHandler = completionHandler; uploadTask.taskDescription = self.taskDescriptionForSessionTasks; [self setDelegate:delegate forTask:uploadTask]; delegate.uploadProgressBlock = uploadProgressBlock;&#125;- (void)addDelegateForDownloadTask:(NSURLSessionDownloadTask *)downloadTask progress:(void (^)(NSProgress *downloadProgress)) downloadProgressBlock destination:(NSURL * (^)(NSURL *targetPath, NSURLResponse *response))destination completionHandler:(void (^)(NSURLResponse *response, NSURL *filePath, NSError *error))completionHandler&#123; AFURLSessionManagerTaskDelegate *delegate = [[AFURLSessionManagerTaskDelegate alloc] initWithTask:downloadTask]; delegate.manager = self; delegate.completionHandler = completionHandler; if (destination) &#123; delegate.downloadTaskDidFinishDownloading = ^NSURL * (NSURLSession * __unused session, NSURLSessionDownloadTask *task, NSURL *location) &#123; return destination(location, task.response); &#125;; &#125; downloadTask.taskDescription = self.taskDescriptionForSessionTasks; [self setDelegate:delegate forTask:downloadTask]; delegate.downloadProgressBlock = downloadProgressBlock;&#125; ÊØè‰∏Ä‰∏™ÁîüÊàêÁöÑ task ÂíåÂÆÉÁöÑ‰ª£ÁêÜÈÉΩ‰ºö‰øùÂ≠òÂú® manager ÁöÑ mutableTaskDelegatesKeyedByTaskIdentifier ‰∏≠„ÄÇÂΩìÁÑ∂ÂÖ∂ÂÆû‰πüÂèØ‰ª•ÈÄöËøáÁªô task Ê∑ªÂä†ÂÖ≥ËÅîÂØπË±°ÁöÑÊñπÂºè‰øùÂ≠ò delegate„ÄÇ ÂçèËÆÆÊñπÊ≥ï‰∏äÈù¢ËØ¥Âà∞‰∫Ü AFURLSessionManager ÂÆûÁé∞‰∫Ü NSURLSession Áõ∏ÂÖ≥ÁöÑÂõõ‰∏™‰ª£ÁêÜ„ÄÇ‰∏ãÈù¢Êù•ÂàÜÂà´ÁúãÁúãÔºö NSURLSessionDelegateÂ¶ÇÊûúÊúâÁõ∏ÂÖ≥ÁöÑ block ÈÇ£‰πàÂ∞±ÊâßË°åÁõ∏ÂÖ≥ÁöÑ blockÔºåÊ≤°Êúâ block ‰πüÂèØ‰ª•ÈÄöËøáÁõëÂê¨Áõ∏Â∫îÁöÑ notification Ôºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758/// Âõ†‰∏∫ÂºÇÂ∏∏ÁªàÊ≠¢ËØ∑Ê±Ç- (void)URLSession:(NSURLSession *)sessiondidBecomeInvalidWithError:(NSError *)error&#123; if (self.sessionDidBecomeInvalid) &#123; self.sessionDidBecomeInvalid(session, error); &#125; [[NSNotificationCenter defaultCenter] postNotificationName:AFURLSessionDidInvalidateNotification object:session];&#125;/// ËØÅ‰π¶Ê†°È™å- (void)URLSession:(NSURLSession *)sessiondidReceiveChallenge:(NSURLAuthenticationChallenge *)challenge completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition disposition, NSURLCredential *credential))completionHandler&#123; /// ÈªòËÆ§ÁöÑÂ§ÑÁêÜÊñπÂºè NSURLSessionAuthChallengeDisposition disposition = NSURLSessionAuthChallengePerformDefaultHandling; __block NSURLCredential *credential = nil; if (self.sessionDidReceiveAuthenticationChallenge) &#123; /// Ëá™Â∑±ÁöÑÂ§ÑÁêÜÊñπÂºè disposition = self.sessionDidReceiveAuthenticationChallenge(session, challenge, &amp;credential); &#125; else &#123; /// ÈúÄË¶ÅÈ™åËØÅËØÅ‰π¶ if ([challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust]) &#123; /// serverTrust ÊòØÊúçÂä°Á´ØÁöÑËØÅ‰π¶Èìæ if ([self.securityPolicy evaluateServerTrust:challenge.protectionSpace.serverTrust forDomain:challenge.protectionSpace.host]) &#123; /// È™åËØÅÈÄöËøá credential = [NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust]; if (credential) &#123; disposition = NSURLSessionAuthChallengeUseCredential; &#125; else &#123; disposition = NSURLSessionAuthChallengePerformDefaultHandling; &#125; &#125; else &#123; /// È™åËØÅ‰∏çÈÄöËøáÂèñÊ∂àËØ∑Ê±Ç disposition = NSURLSessionAuthChallengeCancelAuthenticationChallenge; &#125; &#125; else &#123; disposition = NSURLSessionAuthChallengePerformDefaultHandling; &#125; &#125; if (completionHandler) &#123; /// ËøîÂõûÈ™åËØÅËß£Êûú completionHandler(disposition, credential); &#125;&#125;/// ÂêéÂè∞‰ªªÂä°ÂÆåÊàêÂêéÁöÑÂõûË∞É- (void)URLSessionDidFinishEventsForBackgroundURLSession:(NSURLSession *)session &#123; if (self.didFinishEventsForBackgroundURLSession) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; self.didFinishEventsForBackgroundURLSession(session); &#125;); &#125;&#125; NSURLSessionTaskDelegate123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113/// ÈáçÂÆöÂêëÊìç‰Ωú- (void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)taskwillPerformHTTPRedirection:(NSHTTPURLResponse *)response newRequest:(NSURLRequest *)request completionHandler:(void (^)(NSURLRequest *))completionHandler&#123; NSURLRequest *redirectRequest = request; if (self.taskWillPerformHTTPRedirection) &#123; redirectRequest = self.taskWillPerformHTTPRedirection(session, task, response, request); &#125; if (completionHandler) &#123; completionHandler(redirectRequest); &#125;&#125;/// ‰ΩøÁî®ÊñπÊ≥ïÂíå session ÁöÑÈÇ£‰∏™‰∏ÄËá¥- (void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)taskdidReceiveChallenge:(NSURLAuthenticationChallenge *)challenge completionHandler:(void (^)(NSURLSessionAuthChallengeDisposition disposition, NSURLCredential *credential))completionHandler&#123; NSURLSessionAuthChallengeDisposition disposition = NSURLSessionAuthChallengePerformDefaultHandling; __block NSURLCredential *credential = nil; if (self.taskDidReceiveAuthenticationChallenge) &#123; disposition = self.taskDidReceiveAuthenticationChallenge(session, task, challenge, &amp;credential); &#125; else &#123; if ([challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust]) &#123; if ([self.securityPolicy evaluateServerTrust:challenge.protectionSpace.serverTrust forDomain:challenge.protectionSpace.host]) &#123; disposition = NSURLSessionAuthChallengeUseCredential; credential = [NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust]; &#125; else &#123; disposition = NSURLSessionAuthChallengeCancelAuthenticationChallenge; &#125; &#125; else &#123; disposition = NSURLSessionAuthChallengePerformDefaultHandling; &#125; &#125; if (completionHandler) &#123; completionHandler(disposition, credential); &#125;&#125;/// ËØ∑Ê±ÇÈúÄË¶Å‰∏Ä‰∏™ÂÖ®Êñ∞ÁöÑÔºåÊú™ÊâìÂºÄÁöÑÊï∞ÊçÆÊó∂Ë∞ÉÁî®„ÄÇÁâπÂà´ÊòØËØ∑Ê±Ç‰∏Ä‰∏™bodyÂ§±Ë¥•Êó∂ÔºåÂèØ‰ª•ÈÄöËøáËøô‰∏™ÊñπÊ≥ïÁªô‰∏Ä‰∏™Êñ∞ÁöÑbody- (void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)task needNewBodyStream:(void (^)(NSInputStream *bodyStream))completionHandler&#123; NSInputStream *inputStream = nil; if (self.taskNeedNewBodyStream) &#123; inputStream = self.taskNeedNewBodyStream(session, task); &#125; else if (task.originalRequest.HTTPBodyStream &amp;&amp; [task.originalRequest.HTTPBodyStream conformsToProtocol:@protocol(NSCopying)]) &#123; inputStream = [task.originalRequest.HTTPBodyStream copy]; &#125; if (completionHandler) &#123; completionHandler(inputStream); &#125;&#125;/// ‰∏ä‰º†Êï∞ÊçÆÈÇ£‰∏ÄÂàªË∞ÉÁî®- (void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)task didSendBodyData:(int64_t)bytesSent totalBytesSent:(int64_t)totalBytesSenttotalBytesExpectedToSend:(int64_t)totalBytesExpectedToSend&#123; /// Êï∞ÊçÆÁöÑÊÄªÈïøÂ∫¶ int64_t totalUnitCount = totalBytesExpectedToSend; if(totalUnitCount == NSURLSessionTransferSizeUnknown) &#123; NSString *contentLength = [task.originalRequest valueForHTTPHeaderField:@"Content-Length"]; if(contentLength) &#123; totalUnitCount = (int64_t) [contentLength longLongValue]; &#125; &#125; /// Ëé∑Âèñ task ÂØπÂ∫îÁöÑ delegate AFURLSessionManagerTaskDelegate *delegate = [self delegateForTask:task]; if (delegate) &#123; /// Ë∞ÉÁî® delegate ÁöÑÂõûË∞ÉÊñπÊ≥ïÔºåËÆæÁΩÆÂ∑≤Áªè‰∏ä‰º†‰∫ÜÁöÑÈïøÂ∫¶ÂíåÊÄªÂÖ±ÈúÄË¶Å‰∏ä‰º†ÁöÑÈïøÂ∫¶ [delegate URLSession:session task:task didSendBodyData:bytesSent totalBytesSent:totalBytesSent totalBytesExpectedToSend:totalBytesExpectedToSend]; &#125; if (self.taskDidSendBodyData) &#123; self.taskDidSendBodyData(session, task, bytesSent, totalBytesSent, totalUnitCount); &#125;&#125;/// ‰∏ä‰º†ÂÆåÊàêÊó∂- (void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)taskdidCompleteWithError:(NSError *)error&#123; AFURLSessionManagerTaskDelegate *delegate = [self delegateForTask:task]; // delegate may be nil when completing a task in the background if (delegate) &#123; [delegate URLSession:session task:task didCompleteWithError:error]; [self removeDelegateForTask:task]; &#125; if (self.taskDidComplete) &#123; self.taskDidComplete(session, task, error); &#125;&#125; Âú®ÂèëÈÄÅËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÂ∞ÜËØ∑Ê±ÇÁöÑÊÄªÊï∞ÊçÆÂíåÂ∑≤ÂèëÈÄÅÁöÑÊï∞ÊçÆÈÄöËøá delegate ÁöÑÁõ∏Â∫îÊñπÊ≥ï‰øùÂ≠ò‰∏ãÊù•Ôºö 123456789/// AFURLSessionManagerTaskDelegate ‰∏≠- (void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)task didSendBodyData:(int64_t)bytesSent totalBytesSent:(int64_t)totalBytesSenttotalBytesExpectedToSend:(int64_t)totalBytesExpectedToSend&#123; self.uploadProgress.totalUnitCount = task.countOfBytesExpectedToSend; self.uploadProgress.completedUnitCount = task.countOfBytesSent;&#125; Âú®ËØ∑Ê±ÇÂÆåÊàêÊó∂ÔºåÂèàË∞ÉÁî®‰∫Ü delegate ÁöÑÁõ∏Â∫îÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768/// AFURLSessionManagerTaskDelegate ‰∏≠- (void)URLSession:(__unused NSURLSession *)session task:(NSURLSessionTask *)taskdidCompleteWithError:(NSError *)error&#123; __strong AFURLSessionManager *manager = self.manager; __block id responseObject = nil; __block NSMutableDictionary *userInfo = [NSMutableDictionary dictionary]; userInfo[AFNetworkingTaskDidCompleteResponseSerializerKey] = manager.responseSerializer; //Performance Improvement from #2672 NSData *data = nil; if (self.mutableData) &#123; data = [self.mutableData copy]; //We no longer need the reference, so nil it out to gain back some memory. self.mutableData = nil; &#125; if (self.downloadFileURL) &#123; userInfo[AFNetworkingTaskDidCompleteAssetPathKey] = self.downloadFileURL; &#125; else if (data) &#123; userInfo[AFNetworkingTaskDidCompleteResponseDataKey] = data; &#125; if (error) &#123; userInfo[AFNetworkingTaskDidCompleteErrorKey] = error; dispatch_group_async(manager.completionGroup ?: url_session_manager_completion_group(), manager.completionQueue ?: dispatch_get_main_queue(), ^&#123; if (self.completionHandler) &#123; self.completionHandler(task.response, responseObject, error); &#125; dispatch_async(dispatch_get_main_queue(), ^&#123; [[NSNotificationCenter defaultCenter] postNotificationName:AFNetworkingTaskDidCompleteNotification object:task userInfo:userInfo]; &#125;); &#125;); &#125; else &#123; /// ËØ∑Ê±ÇÊàêÂäüÔºåÂºÇÊ≠•Â§ÑÁêÜËøîÂõûÁöÑÊï∞ÊçÆ dispatch_async(url_session_manager_processing_queue(), ^&#123; NSError *serializationError = nil; responseObject = [manager.responseSerializer responseObjectForResponse:task.response data:data error:&amp;serializationError]; if (self.downloadFileURL) &#123; responseObject = self.downloadFileURL; &#125; if (responseObject) &#123; userInfo[AFNetworkingTaskDidCompleteSerializedResponseKey] = responseObject; &#125; if (serializationError) &#123; userInfo[AFNetworkingTaskDidCompleteErrorKey] = serializationError; &#125; dispatch_group_async(manager.completionGroup ?: url_session_manager_completion_group(), manager.completionQueue ?: dispatch_get_main_queue(), ^&#123; if (self.completionHandler) &#123; self.completionHandler(task.response, responseObject, serializationError); &#125; dispatch_async(dispatch_get_main_queue(), ^&#123; [[NSNotificationCenter defaultCenter] postNotificationName:AFNetworkingTaskDidCompleteNotification object:task userInfo:userInfo]; &#125;); &#125;); &#125;); &#125;&#125; ËøôÈáå AFN Èô§‰∫ÜË∞ÉÁî®ÂõûË∞É‰ª•ÂèäÂèëÈÄÅÈÄöÁü•Â§ñÔºåÊàë‰ª¨ËøòÂèØ‰ª•ÂèëÁé∞‰ΩøÁî®‰∫Ü dispatch_group_async„ÄÇÂÆÉÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨ÂÅö‰∏Ä‰∫õÂ§ö‰∏™ËØ∑Ê±ÇÂêåÊ≠•ÁöÑÊìç‰Ωú„ÄÇurl_session_manager_completion_group() ÊñπÊ≥ïÊèê‰æõ‰∫Ü‰∏Ä‰∏™ groupÔºö 123456789static dispatch_group_t url_session_manager_completion_group() &#123; static dispatch_group_t af_url_session_manager_completion_group; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; af_url_session_manager_completion_group = dispatch_group_create(); &#125;); return af_url_session_manager_completion_group;&#125; Êàë‰ª¨ÂèØ‰ª•Âú®Â§ñÈÉ®ÈÄöËøá AFN ÂèëËµ∑Â§ö‰∏™ËØ∑Ê±ÇÔºåÁÑ∂ÂêéÈÄöËøá url_session_manager_completion_group() ÊñπÊ≥ïÊèê‰æõÁöÑ groupÔºåÂú®ËØ∑Ê±ÇÂÆåÊàêÂêéÁªü‰∏ÄÊâßË°å„ÄÇÂΩìÁÑ∂ÂÖ∂ÂÆûÊàë‰ª¨‰∫¶ÂèØ‰ª•Âú®ÂêÑ‰∏™ËØ∑Ê±ÇÁöÑÂÆåÊàêÂõûË∞É‰∏≠ÈÄöËøá‰ø°Âè∑ÈáèÁöÑÊñπÂºèÊâßË°å„ÄÇ‰∏çËøáÈÇ£Ê†∑Â∞±ÊúâÁÇπ‰∏çÊòØÈÇ£‰πà‰ºòÈõÖ‰∫Ü„ÄÇ NSURLSessionDataDelegate12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667#pragma mark - NSURLSessionDataDelegate/// Êî∂Âà∞ÂìçÂ∫îÊó∂Ë∞ÉÁî®ÔºåÂèØ‰ª•ÈÄâÊã©ÂèñÊ∂àÊàñËÄÖÂÖÅËÆ∏ÂìçÂ∫î- (void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)dataTaskdidReceiveResponse:(NSURLResponse *)response completionHandler:(void (^)(NSURLSessionResponseDisposition disposition))completionHandler&#123; NSURLSessionResponseDisposition disposition = NSURLSessionResponseAllow; if (self.dataTaskDidReceiveResponse) &#123; disposition = self.dataTaskDidReceiveResponse(session, dataTask, response); &#125; if (completionHandler) &#123; completionHandler(disposition); &#125;&#125;/// ÂΩìNSURLSessionDataTaskÂèò‰∏∫NSURLSessionDownloadTaskË∞ÉÁî®Ôºå‰πãÂêéNSURLSessionDataTaskÂ∞Ü‰∏çÂÜçÊé•ÂèóÊ∂àÊÅØ- (void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)dataTaskdidBecomeDownloadTask:(NSURLSessionDownloadTask *)downloadTask&#123; AFURLSessionManagerTaskDelegate *delegate = [self delegateForTask:dataTask]; if (delegate) &#123; /// ÁßªÈô§ dataTask [self removeDelegateForTask:dataTask]; /// ËÆæÁΩÆ downloadTask [self setDelegate:delegate forTask:downloadTask]; &#125; if (self.dataTaskDidBecomeDownloadTask) &#123; self.dataTaskDidBecomeDownloadTask(session, dataTask, downloadTask); &#125;&#125;/// Êî∂Âà∞Êï∞ÊçÆÂêéË∞ÉÁî®- (void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)dataTask didReceiveData:(NSData *)data&#123; AFURLSessionManagerTaskDelegate *delegate = [self delegateForTask:dataTask]; /// Ë∞ÉÁî® delegate Êää data Êî∂ÈõÜËµ∑Êù• [delegate URLSession:session dataTask:dataTask didReceiveData:data]; if (self.dataTaskDidReceiveData) &#123; self.dataTaskDidReceiveData(session, dataTask, data); &#125;&#125;/// ÁºìÂ≠òÊä•ÊñáÊó∂Ë∞ÉÁî®- (void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)dataTask willCacheResponse:(NSCachedURLResponse *)proposedResponse completionHandler:(void (^)(NSCachedURLResponse *cachedResponse))completionHandler&#123; NSCachedURLResponse *cachedResponse = proposedResponse; if (self.dataTaskWillCacheResponse) &#123; cachedResponse = self.dataTaskWillCacheResponse(session, dataTask, proposedResponse); &#125; if (completionHandler) &#123; completionHandler(cachedResponse); &#125;&#125; ‰∏ªË¶ÅÂÖ≥Á≥ªÂèóÂà∞Êï∞ÊçÆÂêéÁöÑÂõûË∞ÉÊñπÊ≥ïÔºåÂÆÉÊääÊé•Êî∂Âà∞ÁöÑ data ‰º†Áªô‰∫Ü delegateÔºö 12345678910/// AFURLSessionManagerTaskDelegate ‰∏≠- (void)URLSession:(__unused NSURLSession *)session dataTask:(__unused NSURLSessionDataTask *)dataTask didReceiveData:(NSData *)data&#123; self.downloadProgress.totalUnitCount = dataTask.countOfBytesExpectedToReceive; self.downloadProgress.completedUnitCount = dataTask.countOfBytesReceived; [self.mutableData appendData:data];&#125; ÂâçÈù¢ËØ∑Ê±ÇÂÆåÊàêÊó∂‰º†Áªô responseSerializer ÁöÑÂ∞±ÊòØËøôÈáå mutableData ÊãºÊé•Â•ΩÁöÑÊï∞ÊçÆ„ÄÇÂÆÉÊääÊØèÊ¨°Êî∂Âà∞ÁöÑÊï∞ÊçÆÈÉΩÊãºÊé•Ëµ∑Êù•ÔºåÁ≠âÂæÖËØ∑Ê±ÇÂÆåÊàê„ÄÇ NSURLSessionDownloadDelegate1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465#pragma mark - NSURLSessionDownloadDelegate/// ‰∏ãËΩΩÂÆåÊàêË∞ÉÁî®- (void)URLSession:(NSURLSession *)session downloadTask:(NSURLSessionDownloadTask *)downloadTaskdidFinishDownloadingToURL:(NSURL *)location&#123; AFURLSessionManagerTaskDelegate *delegate = [self delegateForTask:downloadTask]; if (self.downloadTaskDidFinishDownloading) &#123; /// Ëé∑Âèñ‰∏ãËΩΩÊï∞ÊçÆË¶Å‰øùÂ≠òÁöÑÂú∞ÂùÄ NSURL *fileURL = self.downloadTaskDidFinishDownloading(session, downloadTask, location); if (fileURL) &#123; delegate.downloadFileURL = fileURL; NSError *error = nil; /// ÁßªÂä®‰∏ãËΩΩÁöÑÊï∞ÊçÆÂà∞ÊåáÂÆöÂú∞ÂùÄ if (![[NSFileManager defaultManager] moveItemAtURL:location toURL:fileURL error:&amp;error]) &#123; [[NSNotificationCenter defaultCenter] postNotificationName:AFURLSessionDownloadTaskDidFailToMoveFileNotification object:downloadTask userInfo:error.userInfo]; &#125; return; &#125; &#125; if (delegate) &#123; [delegate URLSession:session downloadTask:downloadTask didFinishDownloadingToURL:location]; &#125;&#125;/// ‰∏ãËΩΩ‰∏≠Ë∞ÉÁî®- (void)URLSession:(NSURLSession *)session downloadTask:(NSURLSessionDownloadTask *)downloadTask didWriteData:(int64_t)bytesWritten totalBytesWritten:(int64_t)totalBytesWrittentotalBytesExpectedToWrite:(int64_t)totalBytesExpectedToWrite&#123; AFURLSessionManagerTaskDelegate *delegate = [self delegateForTask:downloadTask]; if (delegate) &#123; [delegate URLSession:session downloadTask:downloadTask didWriteData:bytesWritten totalBytesWritten:totalBytesWritten totalBytesExpectedToWrite:totalBytesExpectedToWrite]; &#125; if (self.downloadTaskDidWriteData) &#123; self.downloadTaskDidWriteData(session, downloadTask, bytesWritten, totalBytesWritten, totalBytesExpectedToWrite); &#125;&#125;/// ÊÅ¢Â§ç‰∏ãËΩΩË∞ÉÁî®- (void)URLSession:(NSURLSession *)session downloadTask:(NSURLSessionDownloadTask *)downloadTask didResumeAtOffset:(int64_t)fileOffsetexpectedTotalBytes:(int64_t)expectedTotalBytes&#123; AFURLSessionManagerTaskDelegate *delegate = [self delegateForTask:downloadTask]; if (delegate) &#123; [delegate URLSession:session downloadTask:downloadTask didResumeAtOffset:fileOffset expectedTotalBytes:expectedTotalBytes]; &#125; if (self.downloadTaskDidResume) &#123; self.downloadTaskDidResume(session, downloadTask, fileOffset, expectedTotalBytes); &#125;&#125; NSURLSession ‰∏≠ÁöÑ‰∏ãËΩΩÁî±Á≥ªÁªüËá™Âä®ÂÅö‰∫ÜËæπ‰∏ãËæπÂ≠òÁöÑËøáÁ®ã„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨Ë¶ÅÂú®‰∏ãËΩΩÂÆåÊàê‰πãÂêéÊääÁºìÂ≠òÁöÑË∑ØÂæÑ‰∏äÁöÑÊñá‰ª∂‰øùÂ≠òÂà∞ÂÆûÈôÖÁöÑË∑ØÂæÑ‰∏ä„ÄÇÊâÄ‰ª•‰∏ãËΩΩÁöÑÊó∂ÂÄôË¶ÅÁªô manager ‰º†ÂÖ•‰∏Ä‰∏™ downloadTaskDidFinishDownloading ÁöÑ blockÔºåÂëäÁü•‰∏ãËΩΩÂÆåÊàêÊó∂ÂÄôÂÆâÊîæÁöÑË∑ØÂæÑ„ÄÇ ÊÄªÁªìAFHTTPSessionManager Âíå AFURLSessionManager ÊòØÊàë‰ª¨‰ΩøÁî® AFN ÁöÑÂÖ•Âè£„ÄÇAFHTTPSessionManager ‰Ωú‰∏∫Â≠êÁ±ªÔºåÂ∞ÅË£Ö‰∫ÜÁÆÄÂçï dataTask ËØ∑Ê±Ç„ÄÇÂÆÉËøòË¥üË¥£Â∞ÜËØ∑Ê±ÇÂèÇÊï∞ÊãºÊé•‰ª•ÂèäËΩ¨Á†Å„ÄÇ ÂØπ‰∫é‰∏ä‰º†Êñá‰ª∂ÁöÑÊìç‰ΩúÔºå‰ªçÁÑ∂ÂèØ‰ª•‰ΩøÁî® AFHTTPSessionManager ÂàõÂª∫ content-type ‰∏∫ form-data ÁöÑËØ∑Ê±ÇÔºå‰ΩÜÊòØËøôÂ∞±ÈúÄË¶ÅËá™Â∑±ÊääÊñá‰ª∂ËΩ¨‰∏∫ NSData ÊàñËÄÖ NSInputStream Á±ªÂûãÔºåËÆæÁΩÆÁªô request„ÄÇÂ¶ÇÊûúÊÉ≥Ë¶ÅÊõ¥Êñπ‰æøÁöÑÊñπÂºèÂÆåÊàêÔºåÂèØ‰ª•‰ΩøÁî® AFURLSessionManager Êèê‰æõÁöÑ upload ÊñπÊ≥ïÂàõÂª∫ÁöÑ uploadTaskÔºåÂè™ÈúÄË¶ÅÁªôÂá∫ fileURL Âç≥ÂèØ„ÄÇ AFURLSessionManager Ë¥üË¥£ÂàõÂª∫ NSURLSessionÔºåÂπ∂ÊâøÊãÖ‰∫ÜÂèëÈÄÅËØ∑Ê±ÇÈúÄË¶ÅÂÆûÁé∞ÁöÑÊâÄÊúâÂçèËÆÆ„ÄÇÈíàÂØπÊØè‰∏Ä‰∏™ taskÔºå‰∏∫ÂÖ∂Â¢ûÂä†‰∏Ä‰∏™‰ª£ÁêÜÂØπË±°„ÄÇÂΩì AFURLSessionManager Êé•Êî∂Âà∞NSURLSessionDataDelegate ÁöÑÊé•Êî∂ data ÁöÑÂõûË∞ÉÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÊää data ‰∫§Áªô task ÂØπÂ∫îÁöÑ delegate ‰øùÂ≠ò„ÄÇÂΩìÊé•Êî∂Âà∞ NSURLSessionTaskDelegate ÁöÑÂÆåÊàêÂõûË∞ÉÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÂëäÁü• task ÂØπÂ∫î delegateÔºåËÆ©ÂÖ∂ÊâßË°åÂõûË∞ÉÊñπÊ≥ï„ÄÇ ÂêåÊó∂ AFURLSessionManager ÂÆûÁé∞ÁöÑ NSURLSessionDelegate ËøòÂåÖÂê´‰∫Ü HTTPS ËØÅ‰π¶Ê†°È™åÁöÑÁ≠ñÁï•ÔºåÈÄöËøáÂÆÉÈ™åËØÅËØÅ‰π¶‰ø°ÊÅØ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[YYCache Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2018%2F11%2F30%2Fyycache%2F</url>
    <content type="text"><![CDATA[YYCache ÁöÑÊ∫êÁ†ÅËß£Êûê Âü∫Êú¨‰ΩøÁî®ÂàõÂª∫ÂàõÂª∫ Cache ÂÆû‰æãÔºå‰πãÂêéÁöÑÊâÄÊúâÊìç‰ΩúÈÉΩÊòØÈÄöËøáÂÆÉ„ÄÇ 1YYCache *cache = [YYCache cacheWithName:@"cacheName"]; ‰ΩøÁî®ÊñπÊ≥ï‰∏ÄËßà‰πãÂâçÂàõÂª∫ÁöÑ YYCache *cache ÁöÑÂÆû‰æãÊñπÊ≥ï„ÄÇÂåÖÂê´‰∫ÜËØªÂèñ„ÄÅÂÜôÂÖ•ÔºåÁßªÈô§ÁöÑÊâÄÊúâÁõ∏ÂÖ≥ÊñπÊ≥ï 123456789101112131415161718192021222324252627//ÊòØÂê¶ÂåÖÂê´ÊüêÁºìÂ≠òÔºåÊó†ÂõûË∞É- (BOOL)containsObjectForKey:(NSString *)key;//ÊòØÂê¶ÂåÖÂê´ÊüêÁºìÂ≠òÔºåÊúâÂõûË∞É- (void)containsObjectForKey:(NSString *)key withBlock:(nullable void(^)(NSString *key, BOOL contains))block;c//Ëé∑ÂèñÁºìÂ≠òÂØπË±°ÔºåÊó†ÂõûË∞É- (nullable id&lt;NSCoding&gt;)objectForKey:(NSString *)key;//Ëé∑ÂèñÁºìÂ≠òÂØπË±°ÔºåÊúâÂõûË∞É- (void)objectForKey:(NSString *)key withBlock:(nullable void(^)(NSString *key, id&lt;NSCoding&gt; object))block;//ÂÜôÂÖ•ÁºìÂ≠òÂØπË±°ÔºåÊó†ÂõûË∞É- (void)setObject:(nullable id&lt;NSCoding&gt;)object forKey:(NSString *)key;//ÂÜôÂÖ•ÁºìÂ≠òÂØπË±°ÔºåÊúâÂõûË∞É- (void)setObject:(nullable id&lt;NSCoding&gt;)object forKey:(NSString *)key withBlock:(nullable void(^)(void))block;//ÁßªÈô§ÊüêÁºìÂ≠òÔºåÊó†ÂõûË∞É- (void)removeObjectForKey:(NSString *)key;//ÁßªÈô§ÊüêÁºìÂ≠òÔºåÊúâÂõûË∞É- (void)removeObjectForKey:(NSString *)key withBlock:(nullable void(^)(NSString *key))block;//ÁßªÈô§ÊâÄÊúâÁºìÂ≠òÔºåÊó†ÂõûË∞É- (void)removeAllObjects;//ÁßªÈô§ÊâÄÊúâÁºìÂ≠òÔºåÊúâÂõûË∞É- (void)removeAllObjectsWithBlock:(void(^)(void))block;//ÁßªÈô§ÊâÄÊúâÁºìÂ≠òÔºåÊúâËøõÂ∫¶ÂíåÂÆåÊàêÁöÑÂõûË∞É- (void)removeAllObjectsWithProgressBlock:(nullable void(^)(int removedCount, int totalCount))progress endBlock:(nullable void(^)(BOOL error))end; ÁªìÊûÑ YYCacheÔºöÊúÄÂ§ñÂ±ÇÊé•Âè£ÔºåË∞ÉÁî®‰∫ÜYYMemoryCache‰∏éYYDiskCacheÁöÑÁõ∏ÂÖ≥ÊñπÊ≥ï„ÄÇ YYMemoryCacheÔºöË¥üË¥£ÂÜÖÂ≠òÁºìÂ≠ò _YYLinkedMapÔºöÂÜÖÂ≠òÁºìÂ≠òËøõË°å LRU ÊâÄ‰ΩøÁî®ÁöÑÂèåÂêëÈìæË°®Á±ª _YYLinkedMapNodeÔºöÊòØ _YYLinkedMap ‰ΩøÁî®ÁöÑËäÇÁÇπÁ±ª„ÄÇ YYDiskCacheÔºöË¥üË¥£Á£ÅÁõòÁºìÂ≠ò YYKVStorageÔºöYYDiskCache ÁöÑÂÆûÁé∞Á±ªÔºåÁî®‰∫éÁÆ°ÁêÜÁ£ÅÁõòÁºìÂ≠ò„ÄÇ YYKVStorageItemÔºöYYKVStorage ÂÜÖÈÉ®Áî®‰∫éÂ∞ÅË£ÖÊüê‰∏™ÁºìÂ≠òÁöÑÁ±ª„ÄÇ Ê∫êÁ†ÅÂàÜÊûêYYCacheÂàùÂßãÂåñ123456789101112131415161718192021222324- (instancetype)initWithName:(NSString *)name &#123; if (name.length == 0) return nil; // Ê†πÊçÆ‰º†ÂÖ•ÁöÑ cache ÂêçÂ≠óÂàõÂª∫ÂØπÂ∫îË∑ØÂæÑ NSString *cacheFolder = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) firstObject]; NSString *path = [cacheFolder stringByAppendingPathComponent:name]; return [self initWithPath:path];&#125;- (instancetype)initWithPath:(NSString *)path &#123; if (path.length == 0) return nil; // Ê†πÊçÆË∑ØÂæÑÂàõÂª∫Á£ÅÁõòÁºìÂ≠ò YYDiskCache *diskCache = [[YYDiskCache alloc] initWithPath:path]; if (!diskCache) return nil; NSString *name = [path lastPathComponent]; // Êñ∞Âª∫‰∏Ä‰∏™ÂÜÖÂ≠òÁºìÂ≠ò YYMemoryCache *memoryCache = [YYMemoryCache new]; memoryCache.name = name; self = [super init]; _name = name; _diskCache = diskCache; _memoryCache = memoryCache; return self;&#125; ÊòØÂê¶Â≠òÂú®1234- (BOOL)containsObjectForKey:(NSString *)key &#123; // ÂÖàÂà§Êñ≠ÊòØÂê¶Âú®ÂÜÖÂ≠òÁºìÂ≠ò‰∏≠ÔºåÂ¶ÇÊûú‰∏çÂú®ÈÇ£‰πàÂà§Êñ≠ÊòØÂê¶Âú®Á£ÅÁõòÁºìÂ≠ò‰∏≠ return [_memoryCache containsObjectForKey:key] || [_diskCache containsObjectForKey:key];&#125; Ëé∑ÂèñÁºìÂ≠ò12345678910111213- (id&lt;NSCoding&gt;)objectForKey:(NSString *)key &#123; // ÂÖà‰ªéÂÜÖÂ≠òÁºìÂ≠òËé∑Âèñ id&lt;NSCoding&gt; object = [_memoryCache objectForKey:key]; if (!object) &#123; // ‰∏çÂú®ÂÜÖÂ≠òÁºìÂ≠ò‰∏≠ÔºåÈÇ£‰πà‰ªéÁ£ÅÁõòÁºìÂ≠ò‰∏≠Ëé∑Âèñ object = [_diskCache objectForKey:key]; if (object) &#123; // Â¶ÇÊûúÂ≠òÂú®‰∫éÁ£ÅÁõòÁºìÂ≠ò‰∏≠ÔºåÈÇ£‰πàÂ≠òÂÖ•ÂÜÖÂ≠òÁºìÂ≠ò‰∏≠ [_memoryCache setObject:object forKey:key]; &#125; &#125; return object;&#125; ËÆæÁΩÆÁºìÂ≠ò123456- (void)setObject:(id&lt;NSCoding&gt;)object forKey:(NSString *)key &#123; // Â≠òÂÖ•ÂÜÖÂ≠òÁºìÂ≠ò [_memoryCache setObject:object forKey:key]; // Â≠òÂÖ•Á£ÅÁõòÁºìÂ≠ò [_diskCache setObject:object forKey:key];&#125; ÁßªÈô§ÁºìÂ≠ò12345678910// ÂÖàÁßªÈô§ÂÜÖÂ≠òÁºìÂ≠òÔºåÂÜçÁßªÈô§Á£ÅÁõòÁºìÂ≠ò- (void)removeObjectForKey:(NSString *)key &#123; [_memoryCache removeObjectForKey:key]; [_diskCache removeObjectForKey:key];&#125;- (void)removeAllObjects &#123; [_memoryCache removeAllObjects]; [_diskCache removeAllObjects];&#125; YYMemoryCacheÊ¶ÇËßàÂàùÂßãÂåñ1234567891011121314151617181920212223242526272829303132@implementation YYMemoryCache &#123; // üîêÂÆû‰æã pthread_mutex_t _lock; // ÂÜÖÂ≠òÁºìÂ≠òÂ≠òÊîæÂ§Ñ _YYLinkedMap *_lru; // Ëá™Â∑±ÂàõÂª∫ÁöÑÈòüÂàó dispatch_queue_t _queue;&#125;- (instancetype)init &#123; self = super.init; // ÂàõÂª∫ÈîÅ pthread_mutex_init(&amp;_lock, NULL); // ÂàõÂª∫ÂèåÂêëÈìæË°®‰øùÂ≠òÂÜÖÂ≠òÁºìÂ≠òÊï∞ÊçÆ _lru = [_YYLinkedMap new]; // Ëá™Â∑±ÂàõÂª∫ÁöÑ‰∏≤Ë°åÈòüÂàóÔºå‰∏ªË¶ÅÁî®Âú® trim ÁöÑÊó∂ÂÄôÔºå‰øùËØÅÂú®ÂêéÂè∞ÁöÑÊìç‰ΩúÊåâÈ°∫Â∫èÊâßË°å _queue = dispatch_queue_create("com.ibireme.cache.memory", DISPATCH_QUEUE_SERIAL); ... (ÁúÅÁï•Ê∏ÖÈô§Êï∞ÊçÆÁöÑÁ≠ñÁï•ÈÖçÁΩÆ) // ÂºÄÂêØÂÆöÊó∂Ê∏ÖÁêÜ [self _trimRecursively]; return self;&#125;- (void)dealloc &#123; ... // Áî±‰∫éÂÜÖÈÉ®ÁºìÂ≠òÂÜÖÈÉ®ÊòØÂèåÂêëÈìæË°®ÔºåÊâÄ‰ª•ÈúÄË¶ÅÊâãÂä®Ê∏ÖÁ©∫Ôºå‰ª•Èò≤ÂÜÖÂ≠òÊ≥ÑÊºè [_lru removeAll]; // ÂõûÊî∂ÈîÅ pthread_mutex_destroy(&amp;_lock);&#125; ÊñπÊ≥ïYYMemoryCache ÂåÖÂê´‰∏§Á±ªÊñπÊ≥ïÔºå‰∏ÄÁ±ªÊòØÊìç‰ΩúÂÜÖÂ≠òÁºìÂ≠òÁöÑÊñπÊ≥ïÔºå‰∏ÄÁ±ªÊòØÁºìÂ≠òËá™Âä®Ê∏ÖÁêÜÁöÑÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930#pragma mark - Access Methods// =========== Êìç‰ΩúÁºìÂ≠òÊï∞ÊçÆÊé•Âè£ =========== //ÊòØÂê¶ÂåÖÂê´Êüê‰∏™ÁºìÂ≠ò- (BOOL)containsObjectForKey:(id)key;//Ëé∑ÂèñÁºìÂ≠òÂØπË±°- (nullable id)objectForKey:(id)key;//ÂÜôÂÖ•ÁºìÂ≠òÂØπË±°- (void)setObject:(nullable id)object forKey:(id)key;//ÂÜôÂÖ•ÁºìÂ≠òÂØπË±°ÔºåÂπ∂Ê∑ªÂä†ÂØπÂ∫îÁöÑÂºÄÈîÄ- (void)setObject:(nullable id)object forKey:(id)key withCost:(NSUInteger)cost;//ÁßªÈô§ÊüêÁºìÂ≠ò- (void)removeObjectForKey:(id)key;//ÁßªÈô§ÊâÄÊúâÁºìÂ≠ò- (void)removeAllObjects;#pragma mark - Trim// =========== ÁºìÂ≠òÊ∏ÖÁêÜÊé•Âè£ =========== //Ê∏ÖÁêÜÁºìÂ≠òÂà∞ÊåáÂÆö‰∏™Êï∞- (void)trimToCount:(NSUInteger)count;//Ê∏ÖÁêÜÁºìÂ≠òÂà∞ÊåáÂÆöÂºÄÈîÄ- (void)trimToCost:(NSUInteger)cost;//Ê∏ÖÁêÜÁºìÂ≠òÊó∂Èó¥Â∞è‰∫éÊåáÂÆöÊó∂Èó¥ÁöÑÁºìÂ≠ò- (void)trimToAge:(NSTimeInterval)age; _YYLinkedMapÊ¶ÇËßà_YYLinkedMap ÊòØ‰øùÂ≠òÂÜÖÂ≠òÁºìÂ≠òÁöÑÂÆû‰æã„ÄÇÂÜÖÁΩÆ‰∫Ü‰∏Ä‰∏™Â≠óÂÖ∏Âíå‰∏Ä‰∏™ÂèåÂêëÈìæË°®Áî®‰∫é‰øùÂ≠òÊï∞ÊçÆÔºå‰∏§ËÄÖÂàÜÂ∑•‰∏çÂêå„ÄÇÂ≠óÂÖ∏ÊòØÁî®Êù•Âø´ÈÄüÂ≠òÂèñËäÇÁÇπÁöÑÔºåÂèåÂêëÈìæË°®ÂàôÊòØÁî®Êù•ËøõË°åÁºìÂ≠òÊ∑òÊ±∞ÁöÑÔºåÂèåÂêëÈìæË°®ÊúâÂä©‰∫éÂø´ÈÄüÁßªÂä®ËäÇÁÇπ„ÄÇ 123456789101112131415161718192021222324252627@interface _YYLinkedMap : NSObject &#123; @package CFMutableDictionaryRef _dic; // Áî®‰∫éÂ≠òÊîæËäÇÁÇπ NSUInteger _totalCost; //ÊÄªÂºÄÈîÄ NSUInteger _totalCount; //ËäÇÁÇπÊÄªÊï∞ _YYLinkedMapNode *_head; // ÈìæË°®ÁöÑÂ§¥ÈÉ®ÁªìÁÇπ _YYLinkedMapNode *_tail; // ÈìæË°®ÁöÑÂ∞æÈÉ®ËäÇÁÇπ BOOL _releaseOnMainThread; //ÊòØÂê¶Âú®‰∏ªÁ∫øÁ®ãÈáäÊîæÔºåÈªòËÆ§‰∏∫NO BOOL _releaseAsynchronously; //ÊòØÂê¶Âú®Â≠êÁ∫øÁ®ãÈáäÊîæÔºåÈªòËÆ§‰∏∫YES&#125;//Âú®ÈìæË°®Â§¥ÈÉ®ÊèíÂÖ•ÊüêËäÇÁÇπ- (void)insertNodeAtHead:(_YYLinkedMapNode *)node;//Â∞ÜÈìæË°®ÂÜÖÈÉ®ÁöÑÊüê‰∏™ËäÇÁÇπÁßªÂà∞ÈìæË°®Â§¥ÈÉ®- (void)bringNodeToHead:(_YYLinkedMapNode *)node;//ÁßªÈô§Êüê‰∏™ËäÇÁÇπ- (void)removeNode:(_YYLinkedMapNode *)node;//ÁßªÈô§ÈìæË°®ÁöÑÂ∞æÈÉ®ËäÇÁÇπÂπ∂ËøîÂõûÂÆÉ- (_YYLinkedMapNode *)removeTailNode;//ÁßªÈô§ÊâÄÊúâËäÇÁÇπÔºàÈªòËÆ§Âú®Â≠êÁ∫øÁ®ãÊìç‰ΩúÔºâ- (void)removeAll;@end ÊñπÊ≥ïÂÆûÁé∞_YYLinkedMap ‰∏≠ÁöÑÊñπÊ≥ïÈÉΩÊòØÁî®Êù•Êìç‰ΩúËäÇÁÇπÁöÑÔºåÁ®çÂæÆÁÜüÊÇâÊï∞ÊçÆÁªìÊûÑÁöÑ‰∫∫ÈÉΩËÉΩÁúãÊáÇ„ÄÇËøôÈáå‰∏çËØ¶ÁªÜÂàÜÊûêÔºåÂè™‰∏æ‰∏§‰∏™‰æãÂ≠ê„ÄÇ ÊèíÂÖ•ËäÇÁÇπ ÊèíÂÖ•ËäÇÁÇπÈúÄË¶ÅÂÖàÊääÈîÆÂÄºÂØπÂ≠òÂà∞Â≠óÂÖ∏‰∏≠ÔºåÁÑ∂ÂêéÂ∞ÜËäÇÁÇπÊèíÂÖ•ÈìæË°®ÁöÑÂ§¥ÈÉ®ÔºåÊòØ‰∏Ä‰∏™Êìç‰ΩúÈìæË°®ÁöÑÂü∫Êú¨Êìç‰Ωú„ÄÇ 1234567891011121314- (void)insertNodeAtHead:(_YYLinkedMapNode *)node &#123; // ÊèíÂÖ•ËäÇÁÇπÈúÄË¶ÅÂÖàÊääÈîÆÂÄºÂØπ‰øùÂ≠òÂà∞Â≠óÂÖ∏‰∏≠ CFDictionarySetValue(_dic, (__bridge const void *)(node-&gt;_key), (__bridge const void *)(node)); //Â¢ûÂä†ÂºÄÈîÄÂíåÊÄªÁºìÂ≠òÊï∞Èáè _totalCost += node-&gt;_cost; _totalCount++; if (_head) &#123; node-&gt;_next = _head; _head-&gt;_prev = node; _head = node; &#125; else &#123; _head = _tail = node; &#125;&#125; ÁßªÈô§ËäÇÁÇπ ÁßªÈô§ËäÇÁÇπË¶ÅÂÖàÊää‰øùÂ≠òÁöÑÈîÆÂÄºÂØπÁßªÈô§ÔºåÁÑ∂ÂêéÂáèÂ∞ëÁºìÂ≠ò‰∏≠ÁöÑÊÄªÂºÄÈîÄ„ÄÇ 1234567891011- (void)removeNode:(_YYLinkedMapNode *)node &#123; // Â∞ÜËäÇÁÇπÁöÑÈîÆÂÄºÂØπÁßªÈô§ CFDictionaryRemoveValue(_dic, (__bridge const void *)(node-&gt;_key)); // ÂáèÂ∞ëÂºÄÈîÄ _totalCost -= node-&gt;_cost; _totalCount--; if (node-&gt;_next) node-&gt;_next-&gt;_prev = node-&gt;_prev; if (node-&gt;_prev) node-&gt;_prev-&gt;_next = node-&gt;_next; if (_head == node) _head = node-&gt;_next; if (_tail == node) _tail = node-&gt;_prev;&#125; ÁºìÂ≠òÁ≠ñÁï•YYMemoryCache ÁöÑÊìç‰ΩúÁ±ª‰ºº‰∫é NSCacheÔºåÂÆÉ‰ª¨ÁöÑ‰∏çÂêå‰πãÂ§ÑÂú®‰∫éÔºö YYMemoryCache ‰ΩøÁî® LRU(least-recently-used) ÁÆóÊ≥ïÊù•Ê∏ÖÁêÜ‰ΩøÁî®È¢ëÁéáËæÉ‰ΩéÁöÑÁºìÂ≠òÔºõNSCache ÁöÑÊ∑òÊ±∞ÊñπÂºè‰∏çÁ°ÆÂÆö YYMemoryCache ‰ΩøÁî®‰∏â‰∏™Áª¥Â∫¶ countÔºàÁºìÂ≠òÊï∞ÈáèÔºâÔºåcostÔºàÂºÄÈîÄÔºâÔºåageÔºàË∑ù‰∏ä‰∏ÄÊ¨°ÁöÑËÆøÈóÆÊó∂Èó¥ÔºâÊéßÂà∂ÁºìÂ≠òÊ∏ÖÈô§ÔºõNSCache ‰∏çÁ°ÆÂÆö YYMemoryCache ÂèØ‰ª•ÈÖçÁΩÆÊî∂Âà∞ÂÜÖÂ≠òË≠¶ÂëäÊàñËÄÖËøõÂÖ•ÂêéÂè∞Êó∂Ëá™Âä®Ê∏ÖÈô§ÁºìÂ≠ò„ÄÇ LRU ÁÆóÊ≥ïÁöÑÊÄùÊÉ≥Â∞±ÊòØ‰ºòÂÖà‰øùÂ≠òÊúÄËøëÁî®ËøáÁöÑÊï∞ÊçÆ„ÄÇÂ∞ÜÊúÄËøë‰ΩøÁî®ÁöÑËäÇÁÇπÊîæÂà∞ÈìæË°®ÁöÑÂ§¥ÈÉ®ÔºåÂπ∂‰∏î‰ºòÂÖàÊ∑òÊ±∞ÈìæË°®Â∞æÈÉ®ÁöÑÊï∞ÊçÆ„ÄÇ ÊñπÊ≥ïÂÆûÁé∞ÁºìÂ≠òÁõ∏ÂÖ≥ÊñπÊ≥ïÁºìÂ≠òÁõ∏ÂÖ≥ÊñπÊ≥ïÊØîËæÉÁ±ª‰ººÔºåÊàë‰ª¨ËøôÈáåÂè™‰∏æ‰∏§‰∏™‰æãÂ≠ê Ëé∑ÂèñÁºìÂ≠òÂØπË±° 123456789101112- (id)objectForKey:(id)key &#123; if (!key) return nil; pthread_mutex_lock(&amp;_lock); _YYLinkedMapNode *node = CFDictionaryGetValue(_lru-&gt;_dic, (__bridge const void *)(key)); // Ëé∑ÂèñÂà∞‰∫ÜÁºìÂ≠òÁöÑÂØπË±°Â∞±ÈúÄË¶ÅÊääËäÇÁÇπÁßªÂä®Âà∞ÊúÄÂâçÈù¢ÔºåÂπ∂‰∏îÊõ¥Êñ∞Êó∂Èó¥ if (node) &#123; node-&gt;_time = CACurrentMediaTime(); [_lru bringNodeToHead:node]; &#125; pthread_mutex_unlock(&amp;_lock); return node ? node-&gt;_value : nil;&#125; Ëé∑ÂèñÂØπË±°‰ª•ÂèäÂØπÈìæË°®ËøõË°åÊìç‰ΩúÁöÑÊó∂ÂÄôÊ≥®ÊÑèË¶ÅÂä†ÈîÅ ËÆæÁΩÆÁºìÂ≠òÂØπË±° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051- (void)setObject:(id)object forKey:(id)key withCost:(NSUInteger)cost &#123; if (!key) return; // Ê≤°Êúâ‰º† objectÔºåÂ∞±Áõ¥Êé•ÁßªÈô§ if (!object) &#123; [self removeObjectForKey:key]; return; &#125; // Âä†ÈîÅ pthread_mutex_lock(&amp;_lock); _YYLinkedMapNode *node = CFDictionaryGetValue(_lru-&gt;_dic, (__bridge const void *)(key)); NSTimeInterval now = CACurrentMediaTime(); if (node) &#123; // Â≠òÂú® node Â∞±Êõ¥Êñ∞ nodeÔºåÂπ∂‰∏îÊää node ÁßªÂà∞ÈìæË°®ÊúÄÂâçÈù¢ _lru-&gt;_totalCost -= node-&gt;_cost; _lru-&gt;_totalCost += cost; node-&gt;_cost = cost; node-&gt;_time = now; node-&gt;_value = object; [_lru bringNodeToHead:node]; &#125; else &#123; // ‰∏çÂ≠òÂú® node Â∞±Êñ∞Âª∫‰∏Ä‰∏™ nodeÔºåÁÑ∂ÂêéÂ≠òÂÇ® node = [_YYLinkedMapNode new]; node-&gt;_cost = cost; node-&gt;_time = now; node-&gt;_key = key; node-&gt;_value = object; [_lru insertNodeAtHead:node]; &#125; // Â¶ÇÊûúÁºìÂ≠òÊÄªÊ∂àËÄóË∂ÖËøá‰∫ÜÈôêÂà∂ÔºåÈÇ£‰πàÂºÇÊ≠•Ê∑òÊ±∞Êú´Á´ØÁºìÂ≠ò if (_lru-&gt;_totalCost &gt; _costLimit) &#123; dispatch_async(_queue, ^&#123; [self trimToCost:_costLimit]; &#125;); &#125; // Â¶ÇÊûúÁºìÂ≠òÊÄªÈáèË∂ÖËøá‰∫ÜÈôêÂà∂ÔºåÈÇ£‰πàÊ∏ÖÊ•öÊúÄÂêé‰∏Ä‰∏™ if (_lru-&gt;_totalCount &gt; _countLimit) &#123; _YYLinkedMapNode *node = [_lru removeTailNode]; // Âú®‰∏ªÁ∫øÁ®ãÊàñËÄÖÂ≠êÁ∫øÁ®ãÈáäÊîæ if (_lru-&gt;_releaseAsynchronously) &#123; dispatch_queue_t queue = _lru-&gt;_releaseOnMainThread ? dispatch_get_main_queue() : YYMemoryCacheGetReleaseQueue(); dispatch_async(queue, ^&#123; [node class]; //hold and release in queue &#125;); &#125; else if (_lru-&gt;_releaseOnMainThread &amp;&amp; !pthread_main_np()) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; [node class]; //hold and release in queue &#125;); &#125; &#125; pthread_mutex_unlock(&amp;_lock);&#125; ËøôÈáåÊúâ‰∏Ä‰∏™ÂÖ≥‰∫éÊ∑òÊ±∞ÁöÑÁºìÂ≠òÂÜçÂì™ÈáåÈáäÊîæÁöÑÊäÄÂ∑ßÔºåÂç≥ÊúÄÂêéÂú®Âì™‰∏™Á∫øÁ®ãË∞ÉÁî®ÔºåÂ∞±Âú®Âì™‰∏™Á∫øÁ®ãÈáäÊîæ„ÄÇ ÁºìÂ≠òÊ∏ÖÁêÜÁõ∏ÂÖ≥ÊñπÊ≥ïÁºìÂ≠òÊ∏ÖÁêÜÂåÖÂê´‰∏§ÁßçÊÉÖÂÜµ„ÄÇ‰∏ÄÁßçÊòØ‰∏ªÂä®Ê∑ªÂä†ÁºìÂ≠ò‰πãÂêéÁöÑ‰∏ªÂä®Ëß¶ÂèëÔºåËøòÊúâ‰∏ÄÁßçÊòØÂë®ÊúüÊÄßÁöÑÂêéÂè∞Ëß¶Âèë„ÄÇÂàõÂª∫ YYCache Êó∂Ë∞ÉÁî®ÁöÑ _trimRecursively ÊñπÊ≥ïÂ∞±‰ºöËß¶ÂèëÂë®ÊúüÊÄßÁöÑÂêéÂè∞Ëß¶ÂèëÔºö 12345678910111213141516171819202122232425262728293031//YYMemoryCache.m- (instancetype)init&#123; ... //ÂºÄÂßãÂÆöÊúüÊ∏ÖÁêÜ [self _trimRecursively]; ...&#125;//ÈÄíÂΩíÊ∏ÖÁêÜÔºåÁõ∏ÈöîÊó∂Èó¥‰∏∫_autoTrimIntervalÔºåÂú®ÂàùÂßãÂåñ‰πãÂêéÁ´ãÂç≥ÊâßË°å- (void)_trimRecursively &#123; __weak typeof(self) _self = self; dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(_autoTrimInterval * NSEC_PER_SEC)), dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), ^&#123; __strong typeof(_self) self = _self; if (!self) return; //Âú®ÂêéÂè∞ËøõË°åÊ∏ÖÁêÜÊìç‰Ωú [self _trimInBackground]; //Ë∞ÉÁî®Ëá™Â∑±ÔºåÈÄíÂΩíÊìç‰Ωú [self _trimRecursively]; &#125;);&#125;//Ê∏ÖÁêÜÊâÄÊúâ‰∏çÁ¨¶ÂêàÈôêÂà∂ÁöÑÁºìÂ≠òÔºåÈ°∫Â∫è‰∏∫ÔºöcostÔºåcountÔºåage- (void)_trimInBackground &#123; dispatch_async(_queue, ^&#123; [self _trimToCost:self-&gt;_costLimit]; [self _trimToCount:self-&gt;_countLimit]; [self _trimToAge:self-&gt;_ageLimit]; &#125;);&#125; ÁºìÂ≠òÊ∏ÖÁêÜÊúâ‰∏â‰∏™Áª¥Â∫¶ÂåÖÊã¨ age, count, cost„ÄÇÂÆÉ‰ª¨ÁöÑÂÆûÁé∞‰πüÈùûÂ∏∏Áõ∏‰ººÔºåËøôÈáåÂè™Âàó‰∏æÂÖ∂‰∏≠‰∏Ä‰∏™ËØ¥ÊòéÔºö cost Ê∏ÖÁêÜ 123456789101112131415161718192021222324252627282930313233343536- (void)_trimToCost:(NSUInteger)costLimit &#123; BOOL finish = NO; // Êó†ÈúÄÊ∏ÖÁêÜÁöÑÊó∂ÂÄô pthread_mutex_lock(&amp;_lock); if (costLimit == 0) &#123; [_lru removeAll]; finish = YES; &#125; else if (_lru-&gt;_totalCost &lt;= costLimit) &#123; finish = YES; &#125; pthread_mutex_unlock(&amp;_lock); if (finish) return; // ÊöÇÂ≠òÈúÄË¶ÅÊ∏ÖÈô§ÁöÑÁºìÂ≠òÂØπË±°Êï∞ÁªÑ NSMutableArray *holder = [NSMutableArray new]; while (!finish) &#123; // Â∞ùËØïÂä†ÈîÅÔºåÂ¶ÇÊûúÈîÅË¢´Âç†Áî®ÔºåÈÇ£‰πàÂ∞±Á©∫ËΩ¨ 10msÔºåËææÂà∞Ëá™ÊóãÈîÅÁöÑÊïàÊûú if (pthread_mutex_trylock(&amp;_lock) == 0) &#123; if (_lru-&gt;_totalCost &gt; costLimit) &#123; _YYLinkedMapNode *node = [_lru removeTailNode]; if (node) [holder addObject:node]; &#125; else &#123; finish = YES; &#125; pthread_mutex_unlock(&amp;_lock); &#125; else &#123; usleep(10 * 1000); //10 ms &#125; &#125; if (holder.count) &#123; dispatch_queue_t queue = _lru-&gt;_releaseOnMainThread ? dispatch_get_main_queue() : YYMemoryCacheGetReleaseQueue(); dispatch_async(queue, ^&#123; [holder count]; // release in queue &#125;); &#125;&#125; ‰ºò‰∫é OSSpinLock ÁöÑ‰ºòÂÖàÁ∫ßÂèçËΩ¨ÈóÆÈ¢òÔºå‰∏çÂª∫ËÆÆ‰ΩøÁî®„ÄÇÂõ†Ê≠§Ôºå‰ΩúËÄÖ‰ΩøÁî® tryLock ÁöÑÊñπÂºèÂ∞ùËØïËé∑ÂæóÈîÅ„ÄÇ YYDiscCacheYYDiscCache Âíå YYMemoryCache ÁöÑÊìç‰ΩúÈùûÂ∏∏Áõ∏‰ºº„ÄÇ‰∏çÂêå‰πãÂ§ÑÂú®‰∫éÔºåYYMemoryCache Â∞ÜÁªìÊûú‰øùÂ≠òÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂ≠óÂÖ∏‰∏≠ÔºåÁî®ÂèåÂêëÈìæË°®‰ΩìÁé∞Êìç‰ΩúÊó∂Èó¥ÁöÑËøúËøë„ÄÇËÄå YYDiscCache Â∞ÜÁªìÊûú‰øùÂ≠òÂú®Êï∞ÊçÆÂ∫ì‰∏≠ÔºåÈÄöËøáË°®‰∏≠ÊúÄËøëÊõ¥Êñ∞Êó∂Èó¥‰ΩìÁé∞Êìç‰ΩúÊó∂Èó¥ÁöÑËøúËøë„ÄÇ ÂàùÂßãÂåñ123456789101112131415161718192021222324252627282930313233343536373839404142- (instancetype)initWithPath:(NSString *)path &#123; // ÈªòËÆ§‰øùÂ≠òÂú®Êï∞ÊçÆÂ∫ì‰∏≠Êñá‰ª∂Â§ßÂ∞èÈòàÂÄº‰∏∫ 1024*20 return [self initWithPath:path inlineThreshold:1024 * 20]; // 20KB&#125;- (instancetype)initWithPath:(NSString *)path inlineThreshold:(NSUInteger)threshold &#123; self = [super init]; if (!self) return nil; // ‰øùÂ≠òÂà∞ÂÖ®Â±ÄÁöÑ DiscCache ‰∏≠ YYDiskCache *globalCache = _YYDiskCacheGetGlobal(path); if (globalCache) return globalCache; YYKVStorageType type; // Ê†πÊçÆÈòàÂÄºÊù•ËÆæÁΩÆÂ≠òÂÇ®ÁöÑÁ±ªÂûã if (threshold == 0) &#123; type = YYKVStorageTypeFile; &#125; else if (threshold == NSUIntegerMax) &#123; type = YYKVStorageTypeSQLite; &#125; else &#123; type = YYKVStorageTypeMixed; &#125; // Êìç‰ΩúÊï∞ÊçÆÂ∫ìÁöÑÂÆûÈôÖÂØπË±°ÂÆû‰æã YYKVStorage *kv = [[YYKVStorage alloc] initWithPath:path type:type]; if (!kv) return nil; _kv = kv // ÂàùÂßãÂåñ semaphore ÈîÅ _lock = dispatch_semaphore_create(1); // _queue = dispatch_queue_create("com.ibireme.cache.disk", DISPATCH_QUEUE_CONCURRENT); ... [self _trimRecursively]; _YYDiskCacheSetGlobal(self); ... return self;&#125; ÂàùÂßãÂåñÊñπÊ≥ï„ÄÇÊ†πÊçÆÈòàÂÄºÊù•ËÆæÁΩÆÂ≠òÂÇ®ÁöÑ type„ÄÇÂàÜ‰∏∫‰∏âÁßç typeÔºö YYKVStorageTypeFile: ÈòàÂÄº‰∏∫0ÁöÑÊó∂ÂÄôÔºåÁ∫ØÊñá‰ª∂ÂΩ¢ÂºèÁöÑÂ≠òÂÇ®„ÄÇ YYKVStorageTypeSQLite: ÈòàÂÄº‰∏∫Êó†Á©∑Â§ßÁöÑÊó∂ÂÄôÔºåÁ∫ØÊï∞ÊçÆÂ∫ìÁöÑÂ≠òÂÇ® YYKVStorageTypeMixed: ÈòàÂÄº‰∏∫ÁâπÂÆöÂÄºÁöÑÊó∂ÂÄôÔºåÊ∑∑ÂêàÂ≠òÂÇ®„ÄÇÂ§ß‰∫éÈòàÂÄºÁöÑÊó∂ÂÄôÁî®Êñá‰ª∂Â≠òÂÇ®ÔºåÂ∞è‰∫éÈòàÂÄºÁöÑÊó∂ÂÄô‰ΩøÁî®Êï∞ÊçÆÂ∫ìÂ≠òÂÇ®„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÈÉΩÊòØÊï∞ÊçÆÂ∫ìÂ≠òÂÇ®„ÄÇ ÂàùÂßãÂåñÁöÑËøáÁ®ã‰∏≠ÔºåÂú®ÂàùÂßãÂåñ YYKVStorage ÁöÑÊó∂ÂÄôÔºåÂºÄÂêØ‰∫ÜÊï∞ÊçÆÂ∫ì„ÄÇÂêåÊó∂ËøòÂàõÂª∫‰∫Ü dispatch_semaphore ÂΩ¢ÂºèÁöÑÈîÅÔºå‰ª•ÂèäÂÖ®Â±ÄÂ§ÑÁêÜÈòüÂàó„ÄÇ ÊñπÊ≥ïÁºìÂ≠òÁ≠ñÁï•ÂíåÂÜÖÂ≠òÁºìÂ≠òÁõ∏‰ºº„ÄÇÂêåÊ†∑ÁöÑÔºåÂêÑ‰∏™Á£ÅÁõòÁºìÂ≠òÁöÑÊñπÊ≥ï‰∏éÂÜÖÂ≠òÁºìÂ≠òÁöÑÊñπÊ≥ïÁ±ª‰ºº„ÄÇÊâÄ‰ª•ËøôÈáåËøòÊòØÂè™ÂàÜÊûê‰∏Ä‰∏™Â≠òÂÇ®ÁöÑÊñπÊ≥ï„ÄÇ YYDiskCache ‰∏≠ÁöÑÊñπÊ≥ïÔºåÂú®‰º†ÂÖ•Ë¶Å‰øùÂ≠òÁöÑÈîÆÂÄºÂØπÂêéÔºåÂÖàÂ∞ÜÂÄºÂΩíÊ°£‰∏∫ NSDataÔºåÁÑ∂ÂêéÂà§Êñ≠ÂÖ∂ÂíåÈòàÂÄºÁöÑÂ§ßÂ∞èÔºåÂ¶ÇÊûúË∂ÖËøá‰∫ÜÈòàÂÄºÂπ∂‰∏î type ‰∏çÊòØÂè™ËÉΩ‰ΩøÁî®Êï∞ÊçÆÂ∫ìÂ≠òÂÇ®ÔºåÈÇ£‰πàÁîüÊàê‰∏Ä‰∏™Êñá‰ª∂ÂêçÔºå‰πãÂêéÂ∞±‰ºö‰ª•Ëøô‰∏™Êñá‰ª∂ÂêçÂ≠òÂÇ®„ÄÇ 12345678910111213141516171819202122232425262728293031323334// YYDiskCache.m- (void)setObject:(id&lt;NSCoding&gt;)object forKey:(NSString *)key &#123; if (!key) return; if (!object) &#123; [self removeObjectForKey:key]; return; &#125; NSData *extendedData = [YYDiskCache getExtendedDataFromObject:object]; NSData *value = nil; if (_customArchiveBlock) &#123; value = _customArchiveBlock(object); &#125; else &#123; @try &#123; // ÈÄöËøáÂΩíÊ°£ÊñπÊ≥ïÔºåÂ∞ÜË¶Å‰øùÂ≠òÁöÑÂØπË±°ËΩ¨‰∏∫ NSData ÂØπË±° value = [NSKeyedArchiver archivedDataWithRootObject:object]; &#125; @catch (NSException *exception) &#123; // nothing to do... &#125; &#125; if (!value) return; NSString *filename = nil; if (_kv.type != YYKVStorageTypeSQLite) &#123; // Ë¶Å‰øùÂ≠òÁöÑ value Â§ß‰∫éÈòàÂÄºÁöÑ‰πãÂêéÔºåË¶ÅÂàõÂª∫‰∏Ä‰∏™ fileNameÔºåÂ¶ÇÊûúÊúâ fileNameÔºåÈÇ£‰πàÂ∞±Êñá‰ª∂‰øùÂ≠òÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÂ∞± sql ‰øùÂ≠ò if (value.length &gt; _inlineThreshold) &#123; filename = [self _filenameForKey:key]; &#125; &#125; Lock(); [_kv saveItemWithKey:key value:value filename:filename extendedData:extendedData]; Unlock();&#125; ÁîüÊàêÊñá‰ª∂ÂêçÁöÑÊñπÂºèÊòØÈÄöËøáÊää key ÈÄöËøá MD5 ËΩ¨‰∏∫ 16 ‰ΩçÁöÑ hash ÂÄº„ÄÇ 123456789101112131415161718192021- (NSString *)_filenameForKey:(NSString *)key &#123; NSString *filename = nil; if (_customFileNameBlock) filename = _customFileNameBlock(key); if (!filename) filename = _YYNSStringMD5(key); return filename;&#125;/// String's md5 hash.static NSString *_YYNSStringMD5(NSString *string) &#123; if (!string) return nil; NSData *data = [string dataUsingEncoding:NSUTF8StringEncoding]; unsigned char result[CC_MD5_DIGEST_LENGTH]; CC_MD5(data.bytes, (CC_LONG)data.length, result); return [NSString stringWithFormat: @"%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x", result[0], result[1], result[2], result[3], result[4], result[5], result[6], result[7], result[8], result[9], result[10], result[11], result[12], result[13], result[14], result[15] ];&#125; ÁúüÊ≠£Â≠òÂÇ®ÁöÑÊñπÊ≥ïÊòØÂú® YYStorage ‰∏≠„ÄÇÂ¶ÇÊûúÊúâÊñá‰ª∂ÂêçÔºåÈÇ£‰πà‰ºòÂÖàÂ≠òÊñá‰ª∂ÔºåÂ¶ÇÊûú‰∏çÊàêÂäüÂÜçÂ∞ùËØïÂ≠òÂÖ•Êï∞ÊçÆÂ∫ì„ÄÇ 1234567891011121314151617181920212223242526272829// YYStorage.m// ‰øùÂ≠òÈîÆÂÄºÂØπÂà∞Êï∞ÊçÆÂ∫ìÊàñËÄÖÊú¨Âú∞Êñá‰ª∂ÁöÑÂÆûÈôÖÊñπÊ≥ï- (BOOL)saveItemWithKey:(NSString *)key value:(NSData *)value filename:(NSString *)filename extendedData:(NSData *)extendedData &#123; if (key.length == 0 || value.length == 0) return NO; // Â¶ÇÊûú type ‰∏∫Êñá‰ª∂Â≠òÂÇ®Ôºå‰ΩÜÊòØÁ°ÆÊ≤°Êúâ filenameÔºåÈÇ£‰πàËøîÂõûÂ§±Ë¥• if (_type == YYKVStorageTypeFile &amp;&amp; filename.length == 0) &#123; return NO; &#125; if (filename.length) &#123; // Â¶ÇÊûúÊñá‰ª∂Âêç‰∏ç‰∏∫Á©∫ÔºåÈÇ£‰πàÊää data Â≠òÂÖ•Êñá‰ª∂‰∏≠ if (![self _fileWriteWithName:filename data:value]) &#123; return NO; &#125; if (![self _dbSaveWithKey:key value:value fileName:filename extendedData:extendedData]) &#123; [self _fileDeleteWithName:filename]; return NO; &#125; return YES; &#125; else &#123; if (_type != YYKVStorageTypeSQLite) &#123; NSString *filename = [self _dbGetFilenameWithKey:key]; if (filename) &#123; [self _fileDeleteWithName:filename]; &#125; &#125; return [self _dbSaveWithKey:key value:value fileName:nil extendedData:extendedData]; &#125;&#125; 12345// Â∞ÜdataÂÜôÂà∞Êñá‰ª∂- (BOOL)_fileWriteWithName:(NSString *)filename data:(NSData *)data &#123; NSString *path = [_dataPath stringByAppendingPathComponent:filename]; return [data writeToFile:path atomically:NO];&#125; Â≠òÂÖ•Êï∞ÊçÆÂ∫ì‰∏≠Ë∞ÉÁî®ÁöÑÊñπÊ≥ï‰∏≠ÔºåÂÖàÂú®ÁºìÂ≠ò‰∏≠Êü•Êâæ sqlite3_stmt„ÄÇÁÑ∂ÂêéÁªëÂÆöÂèÇÊï∞ÔºåÊâßË°å sql„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041- (BOOL)_dbSaveWithKey:(NSString *)key value:(NSData *)value fileName:(NSString *)fileName extendedData:(NSData *)extendedData &#123; NSString *sql = @"insert or replace into manifest (key, filename, size, inline_data, modification_time, last_access_time, extended_data) values (?1, ?2, ?3, ?4, ?5, ?6, ?7);"; sqlite3_stmt *stmt = [self _dbPrepareStmt:sql]; if (!stmt) return NO; int timestamp = (int)time(NULL); sqlite3_bind_text(stmt, 1, key.UTF8String, -1, NULL); sqlite3_bind_text(stmt, 2, fileName.UTF8String, -1, NULL); sqlite3_bind_int(stmt, 3, (int)value.length); if (fileName.length == 0) &#123; sqlite3_bind_blob(stmt, 4, value.bytes, (int)value.length, 0); &#125; else &#123; sqlite3_bind_blob(stmt, 4, NULL, 0, 0); &#125; sqlite3_bind_int(stmt, 5, timestamp); sqlite3_bind_int(stmt, 6, timestamp); sqlite3_bind_blob(stmt, 7, extendedData.bytes, (int)extendedData.length, 0); int result = sqlite3_step(stmt); if (result != SQLITE_DONE) &#123; if (_errorLogsEnabled) NSLog(@"%s line:%d sqlite insert error (%d): %s", __FUNCTION__, __LINE__, result, sqlite3_errmsg(_db)); return NO; &#125; return YES;&#125;- (sqlite3_stmt *)_dbPrepareStmt:(NSString *)sql &#123; if (![self _dbCheck] || sql.length == 0 || !_dbStmtCache) return NULL; sqlite3_stmt *stmt = (sqlite3_stmt *)CFDictionaryGetValue(_dbStmtCache, (__bridge const void *)(sql)); if (!stmt) &#123; int result = sqlite3_prepare_v2(_db, sql.UTF8String, -1, &amp;stmt, NULL); if (result != SQLITE_OK) &#123; if (_errorLogsEnabled) NSLog(@"%s line:%d sqlite stmt prepare error (%d): %s", __FUNCTION__, __LINE__, result, sqlite3_errmsg(_db)); return NULL; &#125; CFDictionarySetValue(_dbStmtCache, (__bridge const void *)(sql), stmt); &#125; else &#123; sqlite3_reset(stmt); &#125; return stmt;&#125; Âá†‰∏™ÈóÆÈ¢ò‰∏∫‰ªÄ‰πà YYMemoryCache ‰ΩøÁî®‰∫íÊñ•ÈîÅ pthread_mutexÔºåËÄå YYDiskCache ‰ΩøÁî®‰ø°Âè∑Èáè dispatch_semaphore‰ΩúËÄÖÈÄöËøá pthread_mutex ÁöÑ pthread_mutex_trylock() ÂíåÂøôÁ≠â usleep() Êù•Êõø‰ª£ OSSpinLockÔºåËøôÊòØÂõ†‰∏∫‰ΩøÁî®‰∫íÊñ•ÈîÅÔºåÊ≤°ÊúâÊãøÂà∞ÈîÅÁöÑÁ∫øÁ®ã‰ºöË¢´ÊåÇËµ∑„ÄÇÂΩìÈáäÊîæÈîÅÊøÄÊ¥ªÂÖ∂‰ªñÁ∫øÁ®ãÁöÑÊó∂ÂÄôÔºåÂ∞±Âî§ÈÜíÊåÇËµ∑ÁöÑÁ∫øÁ®ã„ÄÇÈúÄË¶Å‰∏ä‰∏ãÊñáÂàáÊç¢Ôºå‰ø°Âè∑ÂèëÈÄÅÁ≠âÂºÄÈîÄÔºåÊïàÁéá‰Ωé‰∫éËá™ÊóãÈîÅ„ÄÇÊâÄ‰ª•‰ΩøÁî®ËøôÁßçÊñπÂºèÊõø‰ª£Ëá™ÊóãÈîÅ„ÄÇ Âõ†‰∏∫ YYDiskCache Âú®ÂÜôÂÖ•ÊØîËæÉÂ§ßÁöÑÁºìÂ≠òÊó∂ÔºåÂèØËÉΩ‰ºöÊúâÊØîËæÉÈïøÁöÑÁ≠âÂæÖÊó∂Èó¥ÔºåËÄådispatch_semaphore Âú®Ëøô‰∏™Êó∂ÂÄôÊòØ‰∏çÊ∂àËÄóCPUËµÑÊ∫êÁöÑÔºåÊâÄ‰ª•ÊØîËæÉÈÄÇÂêà„ÄÇ ‰∏∫‰ªÄ‰πà YYMemoryCache ‰ΩøÁî®ÂèåÂêëÈìæË°®ÂèåÂêëÈìæË°®ÁöÑ‰ºòÂäøÂú®‰∫éÂú®Â§¥Â∞æÊèíÂÖ•ÊàñËÄÖÂà†Èô§ÁöÑÊó∂ÂÄôÊó∂Èó¥Â§çÊùÇÂ∫¶ÊúÄ‰Ωé„ÄÇËÄåÁºìÂ≠òÁöÑÂ≠òÂÖ•ÂíåÊ∏ÖÁêÜÈúÄË¶ÅÈ¢ëÁπÅÁöÑÂ§¥ÈÉ®ÊèíÂÖ•ÔºåÂ∞æÈÉ®Âà†Èô§„ÄÇÊâÄ‰ª•‰ΩøÁî®ÂèåÂêëÈìæË°®ÊúÄ‰∏∫ÂêàÈÄÇ„ÄÇ YYMemoryCache ÂÜÖÂÆπ‰ΩøÁî®‰ªÄ‰πàÊï∞ÊçÆÁªìÊûÑ‰øùÂ≠òÊï∞ÊçÆÁöÑÈÄöËøá‰∏Ä‰∏™ÂèåÂêëÈìæË°®Âíå‰∏Ä‰∏™Â≠óÂÖ∏‰øùÂ≠ò„ÄÇÂ≠óÂÖ∏ÁöÑ‰ΩúÁî®ÊòØ O(1) ÁöÑÊó∂Èó¥ÂÜÖÊâæÂà∞Êï∞ÊçÆÔºåÈìæË°®ÁöÑ‰ΩúÁî®ÊòØ‰∏∫‰∫ÜËøõË°å LRU ÁöÑÁºìÂ≠òÊ∏ÖÁêÜ„ÄÇ Â¶Ç‰ΩïÊâßË°åÂÆöÊó∂‰ªªÂä°Êù•ÂÆöÊó∂Ê∏ÖÁêÜÁºìÂ≠ò‰ΩúËÄÖ‰ΩøÁî®ÁöÑÊòØ dispatch_after ÁöÑÂª∂Êó∂ + ÈÄíÂΩíÁöÑÊñπÂºèËøõË°åÂÆöÊó∂ÊâßË°åÊìç‰ΩúÔºåËÄå‰∏çÊòØ‰ΩøÁî® NSTimer ÁöÑ repeat Â≠êÁ∫øÁ®ãÈáäÊîæ‰∏Ä‰∏™ÂØπË±°ÊúÄÂêéÂú®Âì™‰∏™Á∫øÁ®ã‰∏≠‰ΩøÁî®ÔºåÈÇ£‰πàÊúÄÁªàÂ∞±‰ºöÂú®Âì™‰∏™Á∫øÁ®ãÁöÑ runloop ‰∏≠ÈîÄÊØÅ„ÄÇ 1234567891011_YYLinkedMapNode *node = [_lru removeTailNode];if (_lru-&gt;_releaseAsynchronously) &#123; dispatch_queue_t queue = _lru-&gt;_releaseOnMainThread ? dispatch_get_main_queue() : YYMemoryCacheGetReleaseQueue(); dispatch_async(queue, ^&#123; [node class]; //hold and release in queue &#125;);&#125; else if (_lru-&gt;_releaseOnMainThread &amp;&amp; !pthread_main_np()) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; [node class]; //hold and release in queue &#125;);&#125; ÂØπË±°ÁöÑÈîÄÊØÅËôΩÁÑ∂Ê∂àËÄóËµÑÊ∫ê‰∏çÂ§öÔºå‰ΩÜÁ¥ØÁßØËµ∑Êù•‰πüÊòØ‰∏çÂÆπÂøΩËßÜÁöÑ„ÄÇÈÄöÂ∏∏ÂΩìÂÆπÂô®Á±ªÊåÅÊúâÂ§ßÈáèÂØπË±°Êó∂ÔºåÂÖ∂ÈîÄÊØÅÊó∂ÁöÑËµÑÊ∫êÊ∂àËÄóÂ∞±ÈùûÂ∏∏ÊòéÊòæ„ÄÇÂêåÊ†∑ÁöÑÔºåÂ¶ÇÊûúÂØπË±°ÂèØ‰ª•ÊîæÂà∞ÂêéÂè∞Á∫øÁ®ãÂéªÈáäÊîæÔºåÈÇ£Â∞±Êå™Âà∞ÂêéÂè∞Á∫øÁ®ãÂéª„ÄÇËøôÈáåÊúâ‰∏™Â∞è TipsÔºöÊääÂØπË±°ÊçïËé∑Âà∞ block ‰∏≠ÔºåÁÑ∂ÂêéÊâîÂà∞ÂêéÂè∞ÈòüÂàóÂéªÈöè‰æøÂèëÈÄÅ‰∏™Ê∂àÊÅØ‰ª•ÈÅøÂÖçÁºñËØëÂô®Ë≠¶ÂëäÔºåÂ∞±ÂèØ‰ª•ËÆ©ÂØπË±°Âú®ÂêéÂè∞Á∫øÁ®ãÈîÄÊØÅ‰∫Ü„ÄÇ ÊÄùËÄÉÈ¢ò YYMemoryCache ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºü YYMemoryCache ‰ªéÂì™‰∫õÁª¥Â∫¶Áª¥Êä§Ôºü YYMemoryCache Âíå NSCache Êúâ‰ªÄ‰πàÂå∫Âà´Ôºü Â¶Ç‰Ωï‰ΩøÁî®‰∫íÊñ•ÈîÅÂÆûÁé∞‰∏Ä‰∏™Ëá™ÊóãÈîÅÔºü ‰∏∫‰ªÄ‰πà Memory ‰ΩøÁî®Ëá™ÊóãÈîÅÔºåDisk ‰ΩøÁî®‰ø°Âè∑ÈáèÔºü Disk ÁöÑÁºìÂ≠òÁ≠ñÁï•ÊòØÊÄéÊ†∑ÁöÑÔºü]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[„ÄäiOS Â∫îÁî®ÈÄÜÂêë‰∏éÂÆâÂÖ®„ÄãÁ¨îËÆ∞]]></title>
    <url>%2F2018%2F10%2F31%2FiOS%E9%80%86%E5%90%91%2F</url>
    <content type="text"><![CDATA[ÂæàÊó©Â∞±‰π∞‰∫Ü„ÄäiOSÂ∫îÁî®ÈÄÜÂêë‰∏éÂÆâÂÖ®„ÄãËøôÊú¨‰π¶ÔºåÁé∞Âú®ÊääÂ≠¶Âà∞ÁöÑÂÜÖÂÆπÊÄªÁªì‰∏Ä‰∏ã„ÄÇ Ë∂äÁã±ËÆæÂ§áCydiaÊ∑ªÂä† Èõ∑ÈîãÊ∫êÔºàapt.abcdia.comÔºâ SSHcydia ‰∏≠ÊêúÁ¥¢Âπ∂ÂÆâË£Ö dropbear Êèê‰æõ SSH ÂäüËÉΩ„ÄÇËøûÊé•ÔºåÈªòËÆ§ÂØÜÁ†Å‰∏∫ alpine 1ssh root@192.168.2.202 ‰øÆÊîπÂØÜÁ†ÅËæìÂÖ•Â¶Ç‰∏ã‰øÆÊîπÂØÜÁ†ÅÔºö 1passwd ÂÖ¨Èí•ÁôªÂΩïÂú®ÁõÆÊ†áËÆæÂ§áÁöÑ $HOME/.ssh ÁõÆÂΩï‰∏ãÊâæ authorized_keys Êñá‰ª∂ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàôËá™Â∑±ÂàõÂª∫„ÄÇÂ∞ÜÊú¨Êú∫ÁöÑÂÖ¨Èí•Â§çÂà∂Âà∞ËØ•Êñá‰ª∂‰∏≠„ÄÇ iOSÁ≥ªÁªüÁªìÊûÑÊñá‰ª∂ÁõÆÂΩïË¶ÅËÆøÈóÆË∂äÁã±ËÆæÂ§áÁöÑÊñá‰ª∂Á≥ªÁªüÔºåË¶ÅÈÄöËøá Cydia ÂÆâË£Ö Apple File Conduit 2. Mac ‰∏äÂÆâË£Ö iFunBox Êñá‰ª∂ÊùÉÈôêÈÄöËøá ll ÂèØ‰ª•Êü•ÁúãÊñá‰ª∂ÁöÑÊùÉÈôêÔºå‰∏ÄËà¨ÊùÉÈôêÂåÖÊã¨‰∏âÁ±ªÔºö ÊâÄÊúâËÄÖÊùÉÈôêÔºöÊñá‰ª∂ÊâÄÊúâËÄÖËøõË°åÁöÑÊìç‰Ωú ÁªÑÊùÉÈôêÔºöÂ±û‰∫éËØ•ÁªÑÁöÑÊàêÂëòÂØπ‰ªñËÉΩËøõË°åÁöÑÊìç‰Ωú ÂÖ∂‰ªñ‰∫∫ÊùÉÈôêÔºöÂÖ∂‰ªñ‰∫∫ËÉΩËøõË°åÁöÑÊìç‰Ωú ÂèØ‰ª•ÈÄöËøá chmod ÊîπÂèòÊùÉÈôê Cydia SubstrateCydia Substrate ÊòØ‰∏Ä‰∏™Ê°ÜÊû∂ÔºåÂÖÅËÆ∏Á¨¨‰∏âÊñπÂºÄÂèëËÄÖÂú®Ë∂äÁã±Á≥ªÁªü‰∏äÊâì‰∏Ä‰∫õËøêË°åÊó∂ÁöÑË°•‰∏ÅÂíåÊãìÂ±ï‰∏Ä‰∫õÊñπÊ≥ïÔºåÊòØÂºÄÂèëË∂äÁã±Êèí‰ª∂ÁöÑÂü∫Áü≥„ÄÇCydia Ëá™Âä®ÂÆâË£Ö‰∫Ü Cydia SubstrateÔºåÂåÖÂê´‰∏â‰∏™Ê®°ÂùóÔºö MobileHookerÔºöÁî®‰∫éÊõøÊç¢Á≥ªÁªüÂíåÂ∫îÁî®ÁöÑÊñπÊ≥ï„ÄÇÊèê‰æõ MSHookMessageEx Âíå MSHookFunction hook OC Âíå C ÂáΩÊï∞Ôºå MobileLoaderÔºöÁî®‰∫éÂ∞ÜÁ¨¨‰∏âÊñπÂä®ÊÄÅÂ∫ìÂä†ËΩΩÂà∞ËøêË°åÁöÑÁõÆÊ†áÂ∫îÁî®ÈáåÔºàÊ≥®ÂÖ• Reaveal Â∞±ÊòØÈÄöËøáÂÆÉÔºâ„ÄÇÈ¶ñÂÖàÈÄöËøáÁéØÂ¢ÉÂèòÈáè DYLD_INSERT_LIBRARIES ÊääËá™Â∑±Âä†ËΩΩÂà∞ÁõÆÊ†áÂ∫îÁî®ÈáåÔºåÁÑ∂ÂêéÊü•Êâæ /Library/Mobile Substrate/DynamicLibraries/ ÁõÆÂΩï‰∏ãÊâÄÊúâÁöÑ plist Êñá‰ª∂ÔºåÂ¶ÇÊûú plist Êñá‰ª∂ÁöÑÈÖçÁΩÆ‰ø°ÊÅØÁ¨¶ÂêàÂΩìÂâçÁöÑÂ∫îÁî®ÔºåÂàôÈÄöËøá dlopen ÂáΩÊï∞ÊâìÂºÄÂØπÂ∫îÁöÑ dylib Êñá‰ª∂ Safe modeÔºöÂ¶ÇÊûúÊèí‰ª∂ÂØºËá¥ SpringBoard Â¥©Ê∫ÉÔºåÂ∞Ü‰ºöËÆ©ËÆæÂ§áËøõÂÖ•ÂÆâÂÖ®Ê®°ÂºèÔºåÁ¶ÅÁî®ÊâÄÊúâÁöÑ‰∏âÊñπÊèí‰ª∂ Ë∞ÉËØïÁïåÈù¢ÁöÑ Reveal Â∞±ÊòØÈÄöËøá MobileLoader Âä®ÊÄÅÂä†ËΩΩÁöÑ Ë∂äÁã±ÂøÖÂ§áÈÄöËøá Cydia ÂÆâË£Ö‰∏Ä‰∏ãÊèí‰ª∂Ôºö adv-cmdsÔºöÊèê‰æõÊåá‰ª§ ps -A Ëé∑ÂèñÂÖ®ÈÉ®ËøõÁ®ãÁöÑËøõÁ®ãIDÂíåÂèØÊâßË°åÊñá‰ª∂Ë∑ØÂæÑÔºàdumpdecrypted Á†∏Â£≥Êó∂ÂÄôÁî®Âà∞Ôºâ appsyncÔºö‰øÆÊîπÂ∫îÁî®ÁöÑÊñá‰ª∂‰ºöÂØºËá¥Á≠æÂêçÈ™åËØÅÈîôËØØÔºåËØ•Êèí‰ª∂‰ºöÁªïËøáÁ≥ªÁªüÁöÑÁ≠æÂêçÈ™åËØÅ ps -A Ëé∑ÂèñÂÆåÊï¥ÁöÑÂèØÊâßË°åÊñá‰ª∂Ë∑ØÂæÑ ÈÄÜÂêëÂ∑•ÂÖ∑ËØ¶Ëß£Â∫îÁî®Ëß£ÂØÜdumpdecrypteddumpdecrypted ‰ºöÊ≥®ÂÖ•ÂèØÊâßË°åÊñá‰ª∂ÔºåÁÑ∂ÂêéÂä®ÊÄÅÂú∞‰ªéÂÜÖÂ≠òÊÄª dump Âá∫Ëß£ÂØÜÂêéÁöÑÂÜÖÂÆπ github‰∏ä‰∏ãËΩΩÔºåÂåÖÂê´‰∏Ä‰∏™ makefile Âíå‰∏Ä‰∏™ .c Êñá‰ª∂ $make ÁºñËØëÁîüÊàê‰∏Ä‰∏™ dumpdecrypted.dylib Âä®ÊÄÅÂ∫ì ËøúÁ®ãÁôªÂΩïÂà∞ÊâãÊú∫ÔºåÂ∞ÜÁîüÊàêÁöÑÂä®ÊÄÅÂ∫ìÊîæÂà∞ /var/root ‰∏ã Âú® /var/root ÁõÆÂΩï‰∏ã‰ΩøÁî®ÁéØÂ¢ÉÂèòÈáè DYLD_INSERT_LIBRARIES Â∞Ü dylib Ê≥®ÂÖ•Âà∞Ë¶ÅËÑ±Â£≥ÁöÑÂèØÊâßË°åÊñá‰ª∂‰∏≠ ps -A ÊãøÂà∞Ê≠£Âú®ËøêË°åÁöÑË¶ÅÊ≥®ÂÖ•ÁöÑÂ∫îÁî®ÁöÑÂÆåÊï¥Ë∑ØÂæÑÔºà/var/mobile/Containers/‚Ä¶/{Â∫îÁî®ÁöÑÂêçÂ≠ó}Ôºâ ÁªàÁ´ØËæìÂÖ• $DYLD_INSERT_LIBRARIES=dumpdecrypted.dylib {ÂÆåÊï¥Ë∑ØÂæÑ} ËøõË°åÊ≥®ÂÖ• ÊúÄÁªàÂú® /var/root ÁõÆÂΩï‰∏ãÔºåÂæóÂà∞ÁöÑ {Â∫îÁî®Âêç}.decrypted Â∞±ÊòØËÑ±Â£≥ÂêéÁöÑ mach-o„ÄÇ ÂèØ‰ª•ÈÄâÊã©‰ΩøÁî®ÂëΩ‰ª§ $otool -l {ÂºïÁî®Âêç}.decrypted | grep crypt Êü•ÁúãÂä†ÂØÜÊ†áËØÜÔºåÂ¶ÇÊûúÊúâËæìÂá∫ cryptid 0 Ê†áËØÜËØ•Êû∂ÊûÑÂ∑≤ÁªèË¢´Ëß£ÂØÜ‰∫Ü otool ÂèØ‰ª•Áî®Êù•Êü•Áúã mach-o ÁöÑÊÆµ‰ø°ÊÅØÔºå‰∏ÄÊ†∑‰ΩúÁî®ÁöÑËøòÊúâ MachOViewÔºåÊòØ‰∏Ä‰∏™ÂõæÂΩ¢ÂåñÁöÑÁïåÈù¢„ÄÇ ClutchCluch ‰ºöÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑËøõÁ®ãÔºåÁÑ∂ÂêéÊöÇÂÅúËøõÁ®ãÔºådump ÂÜÖÂ≠ò github‰∏ä‰∏ãËΩΩÊ∫êÁ†Å ‰ΩøÁî® Xcode ÁºñËØëÔºå‰ºöÂú® build ÁõÆÂΩï‰∏ãÁîüÊàê‰∏Ä‰∏™‰∫åËøõÂà∂Êñá‰ª∂ Clutch ËøúÁ®ãÁôªÂΩïÂà∞ÊâãÊú∫ÔºåÂ∞Ü Clutch ÊîæÂà∞ /usr/bin ÁõÆÂΩï‰∏ãÔºåÂπ∂‰∏∫ÂÖ∂Ê∑ªÂä†ÊâßË°åÊùÉÈôê Clutch -i ÂàóÂá∫ÊâÄÊúâÂèØ‰ª•ËÑ±Â£≥ÁöÑÂ∫îÁî®Ôºå‰ª•ÂèäÂÖ∂ BundleId Clutch -b {BundleId} Á†∏Â£≥ Á†∏ÂÆåÂ£≥ÁöÑ ipa ÁöÑË∑ØÂæÑ‰ºöÂú®Â±èÂπï‰∏äËæìÂá∫ Clutch Á†∏Â£≥ÂæóÂà∞ÁöÑÊòØ‰∏Ä‰∏™ÂåÖÂê´ÂêÑÁßçËµÑÊ∫êÊñá‰ª∂ÁöÑÂÆåÊï¥ÁöÑ .app Clutch -i Ëé∑ÂèñÊâÄÊúâ BundleId class-dumpclas-dump ÂèØ‰ª•ÂØºÂá∫Â∑≤Á†∏Â£≥Â∫îÁî®ÁöÑÂ§¥Êñá‰ª∂„ÄÇÔºàÊú™Á†∏Â£≥Â∫îÁî®Ë¢´Âä†ÂØÜÊó†Ê≥ïËé∑ÂèñÔºåÈúÄË¶ÅÂÖàÁ†∏Â£≥Ôºâ ÂÆòÁΩë‰∏ãËΩΩ class-dumpÔºåÊää‰∏ãËΩΩÁöÑ‰∫åËøõÂà∂Êñá‰ª∂ÊîæÂà∞ /usr/bin ÁõÆÂΩï‰∏ã„ÄÇ1$class-dump -H &#123;‰∫åÁ∫ßÂà∂Êñá‰ª∂&#125; -o &#123;Êñá‰ª∂Ë∑ØÂæÑ&#125; class-dump ÂéüÁêÜclass-dump ‰∏ªË¶ÅÊòØÂàÜÊûê mach-o Êñá‰ª∂ÔºåËøõË°åÂä†ËΩΩÁ¨¶Âè∑ÔºåËß£ÊûêÂçèËÆÆÂàóË°®ÔºåËß£ÊûêÁ±ªÂàóË°®ÔºåËß£ÊûêÂàÜÁ±ªÂàóË°® Áé∞Âú®Êàë‰ª¨ÂàõÂª∫‰∏Ä‰∏™Á©∫ÁöÑÂ∑•Á®ãÔºåbuild ‰πãÂêéÈÄöËøá MachOView ÂØπÂÖ∂ËøõË°åÂàÜÊûê„ÄÇ Ëß£ÊûêÂçèËÆÆÈ¶ñÂÖàÈÄöËøá MachOView ÊâæÂà∞ data ÊÆµ‰∏≠ÁöÑ protolist„ÄÇÈô§‰∫ÜÂêÑÁßç name Âíå‰ª£Á†Å‰πãÂ§ñÔºåÂÖ∂‰ªñ‰ø°ÊÅØÈÉΩÊòØÂú® data ÊÆµ‰∏≠Ôºö ÂèØ‰ª•ÁúãÂà∞ _objc_protolist ÊÆµ‰∏≠ÂåÖÂê´‰∏§‰∏™ÂçèËÆÆ‰ø°ÊÅØ„ÄÇÂ≠óÊÆµ offset Ë°®Á§∫ÂèØÊâßË°åÊñá‰ª∂Âä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠ÂêéÁöÑÁõ∏ÂØπÂÅèÁßªÔºåËøô‰∏™ÂÅèÁßªÊòØÁõ∏ÂØπ‰∫é __Text ÊÆµÁöÑ„ÄÇ ÂÜçÁúãÂ≠óÊÆµ Data ÁöÑÂÜÖÂÆπÔºåÂÆÉË°®Á§∫Âä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠Êó∂ÂÄôÁöÑËôöÊãüÂú∞ÂùÄ„ÄÇÂÖàÁÆÄÂçïÁΩóÂàó‰∏Ä‰∏ãËôöÊãüÂú∞ÂùÄÔºåÂÆûÈôÖÂú∞ÂùÄÔºåoffset Ëøô‰∏âËÄÖÁöÑÂÖ≥Á≥ªÔºö ËôöÊãüÂú∞ÂùÄ + ALSR = ÂÆûÈôÖÂú∞ÂùÄ __Text ÁöÑËôöÊãüÂú∞ÂùÄ + ALSR = __Text ÁöÑÂÆûÈôÖÂú∞ÂùÄ __Text ÁöÑËôöÊãüÂú∞ÂùÄ + ÂØπË±°ÁöÑ offset = ÂØπË±°ÁöÑËôöÊãüÂú∞ÂùÄ __Text ÁöÑÂÆûÈôÖÂú∞ÂùÄ + ÂØπË±°ÁöÑ offset = ÂØπË±°ÁöÑÂÆûÈôÖÂú∞ÂùÄ Âõ†Ê≠§ÔºåÂ¶ÇÊûúÊàë‰ª¨Áü•ÈÅì __Text ÁöÑËôöÊãüÂú∞ÂùÄÔºåÂ∞±ËÉΩÁü•ÈÅì data ÊâÄË°®Á§∫ÁöÑ‰ΩçÁΩÆÁöÑ offset ‰∫Ü„ÄÇ__Text ÊÆµÁöÑËôöÊãüÂú∞ÂùÄÁöÑËµ∑Âßã‰ΩçÁΩÆÂú® __Text ÊÆµ‰∏≠ÂèØ‰ª•ÊâæÂà∞Ôºö Âõ†‰∏∫Âú® __Text ÊÆµ‰πãÂâçËøòÊúâ‰∏Ä‰∏™ _PAGEZERO ÊÆµÔºåÂÆÉÁöÑÂ§ßÂ∞èÂõ∫ÂÆö‰∏∫ 0x100000000 Âõ†Ê≠§ÂèØ‰ª•ËÆ°ÁÆóÂá∫ data ÁöÑÁõ∏ÂØπÂÅèÁßª‰∏∫ 8D30„ÄÇÊàë‰ª¨Êù•Âà∞‰∫Ü __data ÊÆµÔºö ÂìçÂ∫î‰ΩçÁΩÆÂ±ïÁ§∫‰∫Ü‰∏Ä‰∏™ÂçèËÆÆÂÆåÊï¥ÁöÑ‰ø°ÊÅØ„ÄÇ8D30 ‰øùÂ≠òÁöÑÊòØ ISA ÁöÑ‰ø°ÊÅØÔºåÂÅèÁßª8‰∏™Â≠óËäÇÁöÑ 8D38 ‰øùÂ≠òÁöÑÊòØÂçèËÆÆÂêçÁöÑ‰ø°ÊÅØÔºåÂÆÉÊåáÂêëÁöÑ‰ΩçÁΩÆÊòØ 76B4: Â¶ÇÊ≠§Â∞±ÂèØ‰ª•Âà∞‰ª£Á†ÅÊÆµ‰∏≠ÊâæÂà∞ÂçèËÆÆÂêçÁöÑ‰ø°ÊÅØ„ÄÇ Âú® __data ÊÆµ‰∏≠Êü•ÊâæÁöÑÊó∂ÂÄôÂèØ‰ª•ÁúãÂà∞ MachOView Â∑≤ÁªèÂàÜÊûêÂá∫‰∫ÜËØ•ÂçèËÆÆÁöÑÂêçËØç„ÄÇÊï¥‰∏™‰ªéÊÆµ‰ø°ÊÅØÂà∞ÂêçËØçÁöÑËøáÁ®ãÂ∞±ÊòØ‰∏äËø∞ÁöÑÂàÜÊûêËøáÁ®ã„ÄÇ Á±ªËß£ÊûêÁ±ªËß£ÊûêÂ∞±‰∏ç‰∏ÄÊ≠•Ê≠•ÂàÜÊûê‰∫ÜÔºåÁõ¥Êé•ÁúãÊà™ÂõæÔºö Reveal Mac Á´Ø‰∏ãËΩΩ Reveal ÊâìÂºÄÔºåÂú® help ÈáåÊâæÂà∞ Show Reveal Library in Finder -&gt; iOS Library ÔºåÊâìÂºÄË¶ÅÂµåÂÖ• iOS Â∫îÁî®ÁöÑ framework ÊâìÂºÄËØ•ÁõÆÂΩïÂêéÔºåÊúâ‰∏Ä‰∏™ RevealServer.frameworkÔºåÂ∞ÜÂÖ∂‰∏≠ÁöÑ mach-o Êñá‰ª∂ RevealServer ÈáçÂëΩÂêç‰∏∫ libReveal.dylib„ÄÇ Êñ∞Âª∫‰∏Ä‰∏™ libReveal.plist Êñá‰ª∂ÔºåÁî® vim ÂÜôÂÖ•Ë¶ÅÊ≥®ÂÖ•ÁöÑ App ÁöÑ BundleIdÔºåÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö 1234567&#123; Filter = &#123; Bundles = ( "tv.douyu.live" ); &#125;;&#125; Â∞Ü‰∏§‰∏™Êñá‰ª∂Â§çÂà∂Âà∞ÊâãÊú∫ÁöÑ /Library/MobileSubstrate/DynamicLibraries ÁõÆÂΩï‰∏ã„ÄÇ ÈáçÂêØÂ∫îÁî®ÔºåÂ∞±‰ºöÈÄöËøá Cydia ÁöÑ MobileLoader Âä†ËΩΩËØ•Â∫ì‰∫Ü„ÄÇ CycriptÂ¶Ç‰ΩïÁî® Cycript Ë∞ÉËØï‰∏Ä‰∏™ËøõÁ®ã $ps -A Ëé∑ÂèñÊâÄÊúâËøêË°åÁöÑËøõÁ®ãÔºà‰∏ÄËà¨Âú® /var/mobile/Containers Êñá‰ª∂Â§π‰∏ãÔºåÊâÄ‰ª•ÂèØ‰ª•‰ΩøÁî® $ps -A | grep /var/mobile/Containers Á≠õÈÄâÊõ¥ÂáÜÁ°ÆÔºâ cycript -p ËøõÁ®ãÂêç ËøõÂÖ•Ë∞ÉËØï cmd+R Ê∏ÖÂ±èÔºåctrl+D ÈÄÄÂá∫ Cycript ËØ≠Ê≥ï123456789101112131415// Ëé∑Âèñ UIApplicationcy# UIApp // Á≠â‰ª∑‰∫é [UIApplication sharedApplication]// ÂÆö‰πâ‰∏Ä‰∏™ÂèòÈáècy# var rootViewController = UIApp.keyWindow.rootViewControllercy# var myView = [[UIView alloc] init]// ÊâæÂà∞ÂÜÖÂ≠ò‰∏≠ÁöÑËØ•Á±ªÂûãÁöÑÂØπË±°cy# choose(UIViewController)// ÈÄöËøá #+ÂÜÖÂ≠òÂú∞ÂùÄ Ëé∑ÂèñÂØπË±°cy# #0x1234567.rootViewController// ÈÄöËøá *+ÂØπË±° Êü•ÁúãÊâÄÊúâÊàêÂëòÂèòÈáècy# *UIApp Cycript ‰∏ªË¶ÅÁî®‰∫éÊü•ÁúãÊéßÂà∂Âô®ÁöÑÂ±ÇÁ∫ß„ÄÅÂØπË±°ÁöÑÊàêÂëòÂèòÈáè‰ª•ÂèäÂä®ÊÄÅË∞ÉËØïÁïåÈù¢ ÁºñÂÜô Cycript Â∫ìÁºñÂÜô Cycript Â∫ìÊñá‰ª∂ test.cy:12345678910111213(function(exports) &#123; // ÈÄíÂΩíÊâìÂç∞ VC Â±ÇÁ∫ß ChildVcs = function(vc) &#123; if (![vc isKindOfClass:[UIViewController class]]) throw new Error(invalidParamStr); return [vc _printHierarchy].toString(); &#125;; // ÈÄíÂΩíÊâìÂç∞viewÁöÑÂ±ÇÁ∫ßÁªìÊûÑ Subviews = function(view) &#123; if (![view isKindOfClass:[UIView class]]) throw new Error(invalidParamStr); return view.recursiveDescription().toString(); &#125;;&#125;)(exports); ÁÑ∂ÂêéÂ∞ÜÊñá‰ª∂ÊîæÂÖ• usr/lib/cycript0.9 Êñá‰ª∂Â§π‰∏ã„ÄÇ12cy# @import testcy# ChildVcs(#0x12345678) TODOÔºö Â¢ûÂä†Ëé∑ÂèñÂ±ûÊÄßÂíåÊñπÊ≥ïÁöÑÁõ∏ÂÖ≥Â∫ìÊñπÊ≥ï Apple Configurator 2Ëé∑Âèñ ipa ÂåÖÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá Apple Configurator 2 Ëé∑ÂèñÂ∫îÁî®ÁöÑ ipa ÂåÖ„ÄÇ ÊâãÊú∫ËøûÊé•‰∏ä Mac ‰πãÂêéÔºåApple Configurator 2 ‰∏≠‰ºöÊòæÁ§∫Âá∫ÊâãÊú∫ÁöÑ‰ø°ÊÅØ„ÄÇËøô‰∏™Êó∂ÂÄôÁÇπÂáªÊ∑ªÂä†Â∫îÁî®ÔºåÂú® app store ‰∏≠ÊêúÁ¥¢‰Ω†ÊÉ≥Ë¶ÅËé∑ÂèñËµÑÊ∫êÁöÑÂºïÁî®Ôºö ÊêúÁ¥¢Âà∞‰πãÂêéÁÇπÂáª‰∏ãËΩΩ„ÄÇÂ¶ÇÊûúÊâãÊú∫‰∏≠Ê≤°ÊúâÁõÆÊ†áÂ∫îÁî®ÔºåÁ¨¨‰∏ÄÊ¨°Â∞±Áõ¥Êé•ÂÆâË£Ö‰∫ÜÔºåÂÆâË£ÖÊàêÂäüÂêéÂÜçÊ¨°ÊêúÁ¥¢ËØ•Â∫îÁî®‰∏ãËΩΩ„ÄÇËøô‰∏™Êó∂ÂÄôÂ∞±‰ºöÊèêÁ§∫Â∑≤ÁªèÊúâËØ•Â∫îÁî®‰∫ÜÔºåÊòØÂê¶Ë¶ÅÊõøÊç¢Ôºö Ëøô‰∏™Êó∂ÂÄô‰∏çË¶ÅÂÅö‰ªª‰ΩïÁöÑÁÇπÂáª„ÄÇÂú®ÁªàÁ´Ø‰∏≠ËøõÂÖ•Âà∞ Apple Configurator 2 ÁöÑÁºìÂ≠òÁõÆÂΩï‰∏ãÔºö~/Library/Group Containers/K36BKF7T3D.group.com.apple.configurator/Library/Caches/Assets/TemporaryItems/MobileApps/ ‰Ω†‰ºöÂèëÁé∞ÁõÆÊ†áÂ∫îÁî®ÁöÑ ipa ÂåÖ„ÄÇ ÂéüÂõ†Âú®‰∫éÔºåApple Configurator 2 ‰∏ãËΩΩÁöÑÊñá‰ª∂‰ºö‰∏¥Êó∂‰øùÂ≠òÂú®ËØ•‰∏¥Êó∂ÁõÆÂΩï‰∏ã„ÄÇÂ¶ÇÊûúÂÆâË£ÖÂÆåÊØïÔºåÂ∞±‰ºöÁ´ãÂàªÂà†Èô§ËØ• ipa ÂåÖ„ÄÇÁî±‰∫é‰πãÂâçÂ∑≤Áªè‰∏ãËΩΩ‰∫ÜËØ•Â∫îÁî®ÔºåApple Configurator 2 ÂºπÁ™óÊèêÁ§∫ÊòØÂê¶ÈúÄË¶ÅÊõøÊç¢ÔºåÊ≠§Êó∂ÁöÑ ipa ÂåÖËøòÊ≤°Êù•ÂæóÂèäÂà†Èô§ÔºåÂèØ‰ª•Â§çÂà∂Âá∫Êù•„ÄÇ Ëé∑Âèñ Assets.car ‰∏≠ÁöÑËµÑÊ∫êÊñá‰ª∂Êää ipa ÂåÖÂ§çÂà∂Âá∫Êù•ÂêéÔºå‰ΩøÁî®Ëß£ÂéãÂ∑•ÂÖ∑ÂØπÂÖ∂ËøõË°åËß£Âéã„ÄÇÂú® payload Êñá‰ª∂Â§π‰∏ãÊúâËµÑÊ∫êÂåÖ„ÄÇ Ëøô‰∏™ÂåÖÈáåÂ∑≤ÁªèÂèØ‰ª•ÁúãÂà∞ÂæàÂ§öËµÑÊ∫êÊñá‰ª∂‰∫ÜÔºå‰ΩÜÊòØÊàë‰ª¨ÈúÄË¶ÅÊâæÂà∞ÁöÑÊòØ Assets.car Ëøô‰∏™ÂéãÁº©Êñá‰ª∂ÔºåËøôÈáåÈù¢ÊâçÊòØÁúüÊ≠£ÁöÑÊàë‰ª¨ÈúÄË¶ÅÁöÑÂõæÁâáËµÑÊ∫ê„ÄÇËøô‰∏™Assets.carÊñá‰ª∂ÁöÑËß£ÂéãÈúÄË¶ÅÁî®Âà∞https://github.com/pcjbird/AssetsExtractor‰ΩøÁî®Ëµ∑Êù•ÈùûÂ∏∏Êñπ‰æø„ÄÇÊää Assets.car ÊãñËøõËØ•Â∑•ÂÖ∑ÔºåÊåáÂÆöËæìÂá∫ÁõÆÂΩïÂ∞±ÂèØ‰ª•ÂæóÂà∞ÊúÄÁªàÁöÑÂÖ®ÈÉ®ËµÑÊ∫êÊñá‰ª∂ ÂàÜÊûê‰∏éË∞ÉËØïÈùôÊÄÅÂàÜÊûêhopper ‰ΩøÁî®Mach-o ÂèØ‰ª•ÂèçÁºñËØë‰∏∫Ê±áÁºñ‰ª£Á†ÅÔºå‰ΩÜÊòØÊ±áÁºñ‰ª£Á†ÅÊó†Ê≥ïÂÆåÂÖ®ÂèçÁºñËØë‰∏∫ oc ‰ª£Á†Å„ÄÇÂõ†‰∏∫Ê±áÁºñÊìç‰ΩúÁöÑÊòØÂØÑÂ≠òÂô®Ôºå‰∏çÂêåÁöÑÁ±ªÂûã‰ª•Âèä‰∏çÂêåÁöÑÂèòÈáèÂêçÁöÑ oc ‰ª£Á†ÅÂèØËÉΩÂæóÂà∞Áõ∏ÂêåÁöÑÊ±áÁºñ‰ª£Á†Å„ÄÇ Hopper ÂíåÂèØ‰ª•Â∞Ü Mach-o ‰ª£Á†ÅÂèçÁºñËØë‰∏∫Ê±áÁºñ‰ª£Á†Å„ÄÅOCÊàñËÄÖSwift‰º™‰ª£Á†Å„ÄÇ‰∏ãËΩΩÂ•Ω‰πãÂêéÔºåÁõ¥Êé•Êää Mach-o Êñá‰ª∂ÊãñÂÖ• HopperÔºåÂç≥ÂèØÂºÄÂßãÂàÜÊûê„ÄÇ Âä®ÊÄÅË∞ÉËØïLLDB Ë∞ÉËØïLLDB ÈÄöËøá debugserver Âíå app ÈÄö‰ø°„ÄÇÂΩì Xcode Ë∞ÉËØïÊâãÊú∫Êó∂ÔºåXcode ‰ºöÂ∞Ü debugserver Êñá‰ª∂Â§çÂà∂Âà∞ÊâãÊú∫‰∏≠Ôºå‰ª•‰æøÂú®ÊâãÊú∫‰∏äÂêØÂä®‰∏Ä‰∏™ÊúçÂä°ÔºåÁ≠âÂæÖ Xcode ËøõË°åËøúÁ®ãË∞ÉËØï„ÄÇÂè™ÊúâËÆæÂ§áËøûÊé•Âà∞ËÆ°ÁÆóÊú∫ÁúüÊú∫Ë∞ÉËØïÊó∂Ôºådebugserver Êñá‰ª∂Êâç‰ºöÂÆâË£ÖÂà∞ËÆæÂ§áÁöÑ /Developer/user/bin ÁõÆÂΩï‰∏ã„ÄÇ ‰ΩÜÊòØÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå/Developer/usr/bin/debugserver Áº∫Â∞ëÊùÉÈôêÔºåÂè™ËÉΩ‰ΩøÁî® xcode Ë∞ÉËØï„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶ÅÂØπ debugserver ÈáçÁ≠æÂêçÔºåËé∑Âæó‰∏§‰∏™ÊùÉÈôêÔºö get-task-allow Âíå task_for_pid-allow Â¶Ç‰ΩïÁªô debugserver Ê∑ªÂä†ÊùÉÈôê: Â∞Ü debugserver ‰ªéÁõÆÂΩïÊã∑Ë¥ùÂà∞ mac„ÄÇÁõÆÂΩïÂ∞±ÊòØ‰∏äËø∞ÁöÑ /Developer/usr/bin/debugserver ‰ΩøÁî® ldid ÂØºÂá∫ debugserver ÁöÑÊùÉÈôêÂà∞ debugserver.entilements Êñá‰ª∂ ldid ÊòØÂ∏ÆÂä©‰øÆÊîπ iPhone ‰∏ä‰∫åËøõÂà∂ÊéàÊùÉÊñá‰ª∂ÁöÑÂ∑•ÂÖ∑„ÄÇÈÄöËøá homebrew ÂÆâË£ÖÔºö 1brew install ldid ÂÆâË£ÖÂÆåÂêéÔºåÂØºÂá∫ debugserver ÁöÑÊùÉÈôêÔºö 1$ldid -e debugserver &gt; debugserver.entilements debugserver.entilements Êñá‰ª∂ÊòØ‰∏™ÈÖçÁΩÆÊñá‰ª∂ÔºåÊâìÂºÄÂπ∂Ê∑ªÂä†Ëøô‰∏§‰∏™ÊùÉÈôêÔºö ‰ΩøÁî® ldid ÈáçÁ≠æÂêçÔºö1$ldid -S debugserver.entilements debugserver Ôºà‰∏äÈù¢ÁöÑ ldid ÁöÑÈáçÁ≠æÂêç‰πüÂèØ‰ª•‰ΩøÁî® codesign ‰ª£ÊõøÔºâ1234# Êü•Áúã ÔºàÂú®ÁªàÁ´Ø‰∏≠ÊòæÁ§∫ÔºåÂèØ‰ª•Â§çÂà∂‰øùÂ≠ò‰∏∫ debugserver.entitlementsÔºâ$codesign -d --entitlements -debugserver# Á≠æÂêç$codesign -f -s - --entitlements debugserver.entitlements debugserver Â∞ÜÈáçÁ≠æÂêçÂêéÁöÑ debugserver ÊãñÂà∞ÊâãÊú∫ device/usr/bin ÁõÆÂΩï‰∏ãÔºåËøôÊ†∑ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®ËØ•ÂëΩ‰ª§ ÊâãÊú∫Á´ØÂºÄÂêØ server„ÄÇÂºÄÂêØË∞ÉËØïÂêéÔºåËøõÁ®ã‰ºöËøõÂÖ•Êñ≠ÁîµÔºåË¢´ÊöÇÂÅúÔºö 1$debugserver *:&#123;‰ªªÊÑèÁ´ØÂè£ÔºåÂ¶Ç10010&#125; -a &#123;ËøõÁ®ãÂêç&#125; Mac Á´ØÂêØÂä® lldb 123456# ËøõÂÖ•lldb Ê®°Âºè$lldb# ËøûÊé•ÔºåËøûÊé•ÈúÄË¶Å‰∏ÄÊÆµÊó∂Èó¥(lldb) process connect connect://&#123;ÊâãÊú∫IP&#125;:&#123;ÂâçÈù¢ÂêØÂä®Êó∂ÁöÑÁ´ØÂè£Âè∑&#125;# ËøûÊé•ÊàêÂäüËá™Âä®ËøõÂÖ•Êñ≠ÁÇπÔºåÈúÄË¶ÅÁªßÁª≠ËøêË°åapp(lldb) c debug Ëé∑ÂèñËøõÁ®ãÂä†ËΩΩÂü∫Âú∞ÂùÄÁî±‰∫é ALSR ÁöÑÂéüÂõ†ÔºåËøõÁ®ãÁöÑËôöÊãüÂú∞ÂùÄ‰∏çÊòØ‰ªé 0x0 ÂºÄÂßãÁöÑÔºå‰ºöÊúâ‰∏Ä‰∏™ÈöèÊú∫ÂÅèÁßªÈáè„ÄÇÂõ†Ê≠§ÔºåÂΩìÊàë‰ª¨Ë¶ÅËØªÂèñËøêË°åÁöÑÁ®ãÂ∫èÁöÑÂÜÖÂ≠òÁöÑÊó∂ÂÄôÂ∞±ÈúÄË¶ÅÁü•ÈÅìËøô‰∏™ ALSR ÁöÑÂÅèÁßªÈáè„ÄÇ ÂèØ‰ª•Âú® lldb ‰∏≠ÈÄöËøá image list -o -f ÊãøÂà∞Ê≠£Âú® debug ÁöÑËøõÁ®ãÁöÑÊâÄÊúâÂä®ÊÄÅÂ∫ìÁöÑ‰ø°ÊÅØ„ÄÇÂÖ∂‰∏≠Á¨¨‰∏ÄÈ°πÁöÑÁ¨¨‰∏ÄÂàó‰∏ÄËà¨Â∞±ÊòØÂΩìÂâçËøõÁ®ãÁöÑÂü∫Âú∞ÂùÄÔºà‰∏çÊòØALSRÂú∞ÂùÄÔºâ„ÄÇ lldb ‰ΩøÁî® ÊâìÂç∞Áõ∏ÂÖ≥Ôºö p {Êåá‰ª§}ÔºöÊâßË°åÊåá‰ª§ btÔºöÊâìÂç∞Ë∞ÉÁî®Â†ÜÊ†à backtrace frame variableÔºöÊâìÂç∞ÂΩìÂâçÊ†àÂ∏ßÁöÑÂèòÈáè Ë∞ÉËØïÁõ∏ÂÖ≥Ôºö cÔºöÁªßÁª≠ÊâßË°å nÔºöÂçïÊ≠•ËøêË°å stepÔºöstep-in finishÔºöstep-over ‰ª£Á†ÅÊñ≠ÁÇπÁõ∏ÂÖ≥ breakpoint set -n {ÊñπÊ≥ïÂêç}Ôºö‰∏∫Êüê‰∏™ÊñπÊ≥ïËÆæÁΩÆÊñ≠ÁÇπ„ÄÇ 12# Êõ¥È´òÁ∫ßÁöÑÔºåËÆæÁΩÆÊüê‰∏Ä‰∏™Á±ªÁöÑÊüê‰∏Ä‰∏™ÊñπÊ≥ïÁöÑÊñ≠ÁÇπÔºåÈúÄË¶Å‰ΩøÁî®ÂºïÂè∑ÂåÖË£πbreakpoint set -n "-[ViewController touchesBegan:withEvent:]" breakpoint listÔºöÂàóÂá∫ÊâÄÊúâÊñ≠ÁÇπÔºåÂåÖÂê´ÁºñÂè∑ breakpoint enable/disable/delete {Êñ≠ÁÇπÁºñÂè∑}ÔºöÊñ≠ÁÇπÊìç‰Ωú ÂÜÖÂ≠òÊñ≠ÁÇπÁõ∏ÂÖ≥ watchpoint set variable {ÂèòÈáèÂêç}ÔºöÂèòÈáèÂÄºÂèòÂåñÁöÑÊó∂ÂÄôËß¶Âèë watchpoint listÔºöÂàóÂá∫ÊâÄÊúâÂÜÖÂ≠òÊñ≠ÁÇπ watchpoint enable/disable/delete {Êñ≠ÁÇπÁºñÂè∑}ÔºöÂÜÖÂ≠òÊñ≠ÁÇπÊìç‰Ωú 1watch set variable self-&gt;age theos‰∏ãËΩΩ theos ÂÆâË£ÖÁ≠æÂêçÂ∑•ÂÖ∑ brew install ldid ‰øÆÊîπ .zshrc 1234# ËøôÊ†∑ÂèØ‰ª•Áî® $THEOS ‰ª£Êõø ~/theosexport THEOS=~/theos# ‰øÆÊîπÁéØÂ¢ÉÂèòÈáè,ËøôÊ†∑Â∞±ÂèØ‰ª•Âú®‰ªªÊÑè‰ΩçÁΩÆÊâßË°å `~/theos/bin` Ë∑ØÂæÑ‰∏ãÂëΩ‰ª§‰∫Üexport PATH=~/theos/bin:$PATH ÊâßË°å source ~/.zshrc ÈáçÁΩÆ zshrc ÈÖçÁΩÆ„ÄÇ ÈÄíÂΩí‰∏ãËΩΩ theos git clone --recursive https://github.com/theos/theos.git $THEOS ‰ΩøÁî® theos ÂàõÂª∫ tweak ÊâßË°å‰∏ãËΩΩ‰∏ãÊù•ÁöÑÂëΩ‰ª§ $nic.pl Ê†πÊçÆÊèêÁ§∫ÈÄâÊã©Ë¶ÅÂàõÂª∫ iphone/tweakÔºåÁÑ∂ÂêéËÆæÁΩÆËá™Â∑±ÁöÑÈ°πÁõÆÂêçÔºåbundleIDÔºåËøòÊúâÁõÆÊ†áÂ∫îÁî®ÁöÑ bundle identifierÔºàÁî® cycript Ëé∑ÂèñÔºå[NSBundle mainBundle].bundleIdentifier)ÔºåÁîüÊàê‰∏ÄÁ≥ªÂàóÊñá‰ª∂„ÄÇ ÁºñËæëÁîüÊàêÁöÑ Makefile Êñá‰ª∂ÔºåÂú®Êñá‰ª∂ÊúÄ‰∏äÊñπÊ∑ªÂä†ÈÖçÁΩÆÔºö 123456# ËÆæÁΩÆIPÂíåÁ´ØÂè£Âè∑ÔºåË°®Á§∫Ë¶ÅÈÄöËøá SSH ÁöÑÊñπÂºèÂÆâË£ÖËøô‰∏™ theos# ÂàáËÆ∞‰∏ÄÂÆöË¶ÅÊîæÂú®ÊúÄ‰∏äÈù¢export THEOS_DEVICE_IP=&#123;‰Ω†ÁöÑÊâãÊú∫ÁöÑIP&#125;export THEOS_DEVICE_PORT=22# ... ÁúÅÁï•‰∫ÜËá™Âä®ÁîüÊàêÁöÑÈÖçÁΩÆÈÉ®ÂàÜ ÁºñÂÜô‰ª£Á†ÅÔºåÁºñËæë Tewak.xm Êñá‰ª∂Ôºö 123%hook &#123;Ë¶ÅhookÁöÑÁ±ªÂêç&#125;&#123;Ê†πÊçÆ class-dump ÊâæÂà∞ÊÑüÂÖ¥Ë∂£ÁöÑË¶ÅhookÁöÑÊñπÊ≥ï&#125;%end ÂëΩ‰ª§Ë°åÊâßË°åÔºö 123456# ÁºñËØë$make# ÊâìÂåÖ$make package# ÂÆâË£Ö ‰ºöÈáçÂêØ SpringBoard$make install Áõ∏ÂΩì‰∫éÁªôÂéüÊù•ÁöÑÂ∫îÁî®Ê≥®ÂÖ•‰∫Ü‰∏Ä‰∏™Âä®ÊÄÅÂ∫ì„ÄÇÂèØ‰ª•Âú® /Library/MobileSubstrate/DynamicLibraries ‰∏≠Êü•ÁúãÊñ∞ÂÆâË£ÖÁöÑ dylib Âíå plist Êñá‰ª∂„ÄÇ tweak ÂÆûÁé∞Ê≥®ÊÑèÁÇπ hook ÁöÑÊñπÊ≥ï‰∏≠ÁöÑÂèÇÊï∞‰ª•Âèä self ‰∏ÄËà¨ÈÉΩÊòØ id Á±ªÂûãÔºåÊâÄ‰ª•‰∏çËÉΩÁî®ÁÇπËØ≠Ê≥ïÔºåËÄåË¶Å‰ΩøÁî® get ÊñπÊ≥ïÔºö 123- (id)tableView:(id)tableView cellForRowAtIndexPath:(id)indexPath &#123; int num = [indexPath section];&#125; ÂèØ‰ª•‰ΩøÁî®ÂÆèÔºåÂú®Êñá‰ª∂È°∂ÈÉ®ÂÆö‰πâÔºö 1#define SomeMethod [NSUserDefaults standardUserDefaults] hook ÊñπÊ≥ïÈªòËÆ§ÊòØ hook Â∑≤ÊúâÊñπÊ≥ïÔºåÂ¶ÇÊûúÂ¢ûÂä†ÁöÑÊñπÊ≥ïÊòØÂéüÊù•Ê≤°ÊúâÁöÑÈúÄË¶ÅÂä†‰∏ä %new: 123%new -(void)someFunc:(UIButton *)button &#123; ...&#125; hook ÊñπÊ≥ïË¶ÅË∞ÉÁî®ÂéüÊù•ÁöÑÂÆûÁé∞ÊñπÊ≥ïÔºå‰ΩøÁî® %orig Êõø‰ª£Ôºö 123- (long long)numberOfSectionsInTableView:(id)tableView &#123; return %orig + 2&#125; ËµÑÊ∫êÊñá‰ª∂ÊîæÂú®Êñ∞Âª∫ÁöÑ tweak ÁîüÊàêÁöÑ layout Êñá‰ª∂Â§π‰∏ãÔºåËØ•ÁõÆÂΩïÂØπÂ∫îÁöÑÂ∞±ÊòØÊâãÊú∫ÁöÑÊ†πÁõÆÂΩïÔºåÂèØ‰ª•Ëá™Â∑±Âú® layout ‰∏ãÂàõÂª∫Êñá‰ª∂Â§πÂ±ÇÁ∫ßÔºå‰ª£Á†Å‰∏≠ÂºïÁî®Ôºö 1UIImage *myImage = [UIImage imageWithCOntentOfFile:@"/&#123;Ëá™Â∑±ÂàõÂª∫ÁöÑÊñá‰ª∂Â§πÂ±ÇÁ∫ß&#125;/&#123;Êñá‰ª∂Âêç&#125;"] ÊúâÊó∂ÂÄôË∞ÉÁî®ÂéüÊúâÊñπÊ≥ïÊàñËÄÖ %new ÁöÑÊñπÊ≥ïÔºåÊúâÊó∂‰ºöÊä• instance method not found ÁöÑÈîôËØØÔºåËøôÈúÄË¶ÅÊàë‰ª¨ÂÜçÂú®ÂÆûÁé∞ÁöÑ xm Êñá‰ª∂È°∂ÈÉ®Â£∞Êòé‰∏Ä‰∏ãËØ•ÊñπÊ≥ï„ÄÇÁ±ªÂêç‰ªªÊÑèÔºåÂè™Ë¶ÅË°®Á§∫ËØ•ÊñπÊ≥ïÂ£∞ÊòéËøáÂç≥ÂèØÔºö 123@interface &#123;‰ªªÊÑèÁ±ªÂêç&#125;-(id)&#123;‰Ω†ÁöÑÊñπÊ≥ïÂêç&#125;Ôºõ@end ÊúâÊó∂ÂÄô‰ΩøÁî®Êüê‰∏™Á±ªÁöÑÊó∂ÂÄôËøò‰ºöÊä•Á±ª‰∏çÂ≠òÂú®ÁöÑÈîôËØØ„ÄÇÂ¶ÇÊûúÊòØ‰ΩøÁî®Ëá™Â∑±ÂàõÂª∫ÁöÑÁ±ªÁõ¥Êé• #import &quot;{Á±ªÂêç}&quot; Âç≥ÂèØ„ÄÇÂ¶ÇÊûúÊòØË¢´ hook Êñá‰ª∂Â∑≤Áªè import ÁöÑÁ±ªÔºåÈúÄË¶Å‰ΩøÁî® @class ÊèêÂâçÂ£∞Êòé‰∏Ä‰∏ã„ÄÇ ÂèØ‰ª•ÈÄöËøáÂÖ≥ËÅîÂØπË±°ÁöÑÊñπÂºèÁªôÂÆû‰æãÊ∑ªÂä†Â±ûÊÄß Â¶ÇÊûúË¶ÅÂàÜÂ§ö‰∏™Êñá‰ª∂ÁºñÂÜôÔºåÈúÄË¶ÅÂú® makefile ‰∏≠ÈÖçÁΩÆÁõ∏Â∫îÊñá‰ª∂Ôºå‰ª•Á©∫Ê†ºÂàÜÈöî„ÄÇÈíàÂØπÊñá‰ª∂ÈáèËøáÂ§öÁöÑÊÉÖÂÜµÔºåÂèØ‰ª•‰ΩøÁî®ÈÄöÈÖçÁ¨¶Ë°®Á§∫‰∏Ä‰∏™Êñá‰ª∂Â§πÂÜÖÁöÑÊñá‰ª∂„ÄÇ‰ΩøÁî®ÁöÑÊó∂ÂÄôÁõ¥Êé•Áõ¥Êé• importÔºå‰ΩÜÊòØË¶ÅÊääË∑ØÂæÑÂÜôÂÆåÊï¥ÔºåË∑ØÂæÑ‰ª• Tweak.xm ‰∏∫Âü∫ÂáÜ„ÄÇ 12TWEAK_NAME = $&#123;your tweak name&#125;$&#123;your project name&#125;_FILES = $&#123;‰ª•ÂΩìÂâçÊñá‰ª∂Â§π‰∏∫Âü∫ÂáÜÁöÑÊñá‰ª∂Ë∑ØÂæÑ+Êñá‰ª∂Âêç&#125; $&#123;‰ª•ÂΩìÂâçÊñá‰ª∂Â§π‰∏∫Âü∫ÂáÜÁöÑÊñá‰ª∂Ë∑ØÂæÑ+Êñá‰ª∂Âêç&#125; $&#123;‰ª•ÂΩìÂâçÊñá‰ª∂Â§π‰∏∫Âü∫ÂáÜÁöÑÊñá‰ª∂Ë∑ØÂæÑ+Êñá‰ª∂Âêç&#125; Tweak ÂÆûÁé∞ÂéüÁêÜ ÁîüÊàêÁöÑÊèí‰ª∂‰ºöË¢´ÂÆâË£ÖÂú® /Library/MobileSubstrate/DynamicLibraries ‰∏≠„ÄÇÁîüÊàêÁöÑÊñá‰ª∂ÂåÖÊã¨ .dylib ÂåÖÂê´ÁºñËØëÂêéÁöÑ tweak ‰ª£Á†ÅÔºåÂíå .plist Â≠òÊîæÁùÄ hook ÁöÑÁõÆÊ†á APPID ÊâìÂºÄ App Êó∂ÔºåCydia Substrate ‰ºöÂéªÂä†ËΩΩÂØπÂ∫îÁöÑ dylibÔºå‰øÆÊîπÂÜÖÂ≠ò‰∏≠ÁöÑ‰ª£Á†ÅÈÄªËæëÔºå ÊâßË°å dylib ‰∏≠ÁöÑÂáΩÊï∞ tweak ‰∏ç‰ºö‰øÆÊîπÂèØÊâßË°åÊñá‰ª∂Ôºå‰ªÖ‰ªÖÂè™ÊòØ‰øÆÊîπ‰∫ÜÂÜÖÂ≠òÁöÑÈÄªËæë„ÄÇÊâÄ‰ª• tweak ÂèØ‰ª•ÂØπÊú™Á†∏Â£≥ App ‰øÆÊîπÔºå‰ΩÜÊòØÂøÖÈ°ªË¶Å‰ΩøÁî®Ë∂äÁã±ÊâãÊú∫„ÄÇ Logos ËØ≠Ê≥ï %hook %end hook‰∏Ä‰∏™Á±ªÁöÑÂºÄÂßãÂíåÁªìÊùü %log; ÊâìÂç∞ÊñπÊ≥ïË∞ÉÁî®ËØ¶ÊÉÖÔºåÂú® Xcode ÁöÑÊó•ÂøóËæìÂá∫‰∏≠Êü•Áúã %c({Á±ªÂêç}) Ëé∑ÂèñÁ±ªÂØπË±°ÔºåÁõ∏ÂΩì‰∫é [xxx class]ÔºåÁõ¥Êé•Ë∞ÉÁî®ÂèØËÉΩÊúâÈîô %orig ÂáΩÊï∞ÂéüÊù•ÁöÑ‰ª£Á†ÅÈÄªËæë %new Ê∑ªÂä†‰∏Ä‰∏™Êñ∞ÁöÑÊñπÊ≥ï logify.plÂèØ‰ª•Â∞ÜÂ§¥Êñá‰ª∂Âø´ÈÄüËΩ¨Êç¢ÊàêÂ∑≤ÁªèÂåÖÂê´ÊâìÂç∞‰ø°ÊÅØÁöÑ xm Êñá‰ª∂ÔºàËá™Âä®Ê∑ªÂä† %log ËØ≠Âè•ÔºâÔºö1$logify.pl xxx.h &gt; &#123;‰Ω†ÊÉ≥ÂèñÁöÑ‰ªªÊÑèÂêçÂ≠ó&#125;.xm ÈÄöËøá‰øÆÊîπ makefile ‰∏≠ÁöÑÈÖçÁΩÆÔºåÂ∞ÜÁîüÊàêÁöÑ .xm Êñá‰ª∂Âä†ÂÖ•Âà∞ÁºñËØëÊñá‰ª∂‰∏≠„ÄÇÁõ¥Êé•Ê∑ªÂä†Âà∞ÂéüÊù•ÁöÑ Tweak.xm ‰πãÂêéÂç≥ÂèØÔºö 1&#123;your project name&#125;_FILES = Tweak.xm &#123;‰Ω†ÂèñÁöÑÂêçÂ≠ó&#125;.xm ‰ΩÜÊòØÁªèÂ∏∏‰ºöÁºñËØë‰∏çËøáÔºåÈúÄË¶ÅÊâãÂä®‰øÆÊîπÔºö Êú™ÂÆö‰πâÂ§¥Êñá‰ª∂ÔºöÊä•Èîô unknown type name ‚ÄòXXX‚ÄôÔºåÂú®Â§¥ÈÉ®Â£∞Êòé @class XXX;,ÊàñËÄÖÂ∞Ü class Á±ªÂûãÊîπ‰∏∫ id Êú™Â£∞ÊòéÂçèËÆÆÔºöÊä•Èîôno type or protocol named &#39;XXX&#39;ÔºåÂú®Â§¥ÈÉ®Â£∞Êòé @protocol XXX ‰∏çËÉΩÂ≠òÂú® weakÔºöÊä•Èîô cannot create __weak referenceÔºåÊõøÊç¢ÊéâÊâÄÊúâÁöÑ __weak ‰∏∫Á©∫Â≠óÁ¨¶‰∏≤ ‰∏çËÉΩÂ≠òÂú®Èùû oc ÊñπÊ≥ïÔºöÊä•Èîô expected selector for Objective-C method ÔºåÂà†Èô§‰ª•ÁÇπÂºÄÂ§¥ÁöÑÈùû OC ÁöÑÊñπÊ≥ï Â∏¶ÂçèËÆÆÁöÑÂèÇÊï∞Êä•ÈîôÔºöÊä•Èîô cast from pointer to smaller type &#39;unsigned int&#39; loses information„ÄÇÂ¶ÇÊûúÊúâ‰∏Ä‰∏™ÂèÇÊï∞Á±ªÂûãÈÅµÂæ™Êüê‰∏™ÂçèËÆÆÔºåÈÇ£‰πà %log Â∞±Êó†Ê≥ïÈÄöËøáÔºåÈúÄË¶ÅÊääÂçèËÆÆÂà†Èô§„ÄÇ HBLogDebug Á±ªÂûãÈîôËØØÔºöÊä•Èîô cast from pointer to smaller type &#39;unsigned int&#39; loses informationÔºåHBLogDebug Êú¨Ë∫´ÊòØÁî®Êù•ÊâìÂç∞ÊñπÊ≥ïËøîÂõûÂÄºÁöÑÔºåÊúâ‰∏Ä‰∫õÂú∞ÊñπËøîÂõûÂÄº id Á±ªÂûãÔºå‰ºöË¢´ËΩ¨Âåñ‰∏∫ unsigned int Á±ªÂûãÔºåÂõ†Ê≠§Êä•Èîô„ÄÇÈúÄË¶ÅÊõøÊç¢Ôºö1234// ÂéüÂßãËØ≠Âè•HBLogDebug(@"=0x%x", (unsigned int)r);// ÊâπÈáèÊõøÊç¢‰∏∫HBLogDebug(@"=0x%@", r); MonkeyDevMonkeyDev ÁöÑÂÖ∑‰Ωì‰ΩøÁî®ÂèØ‰ª•Âà∞ MonkeyDev Wiki ‰∏≠Êü•Áúã ÈÄÜÂêëËøõÈò∂ASLRAddress space layout randomization Âú∞ÂùÄÁ©∫Èó¥Â∏ÉÂ±ÄÈöèÊú∫Âåñ ÂèØ‰ª•ÈÄöËøá lldb ÁöÑ image list -o -f Ëé∑ÂæóËøô‰∏™ÂÅèÁßªÂú∞ÂùÄ: image list -o -f ÊãøÂà∞ÁöÑÊòØÂáèÂéª __Text ÊÆµÂü∫Âú∞ÂùÄÁöÑÂÅèÁßªÔºåÂç≥ ASLR image list ÊãøÂà∞ÁöÑÂàôÊòØ __Text ÁöÑÂÆûÈôÖÂú∞ÂùÄÂÅèÁßªÔºåÂç≥Âü∫Âú∞ÂùÄ + ASLR Âú∞ÂùÄ Ëé∑Âæó‰∫ÜÂÅèÁßªÂú∞ÂùÄÂêéÔºåÂú®ÈÄöËøá hopper Ëé∑ÂæóÊú™‰ΩøÁî® ALSR ÁöÑÊñπÊ≥ïÁöÑÂú∞ÂùÄÔºå‰∏§ËÄÖÁõ∏Âä†ÔºåÂ∞±ÊòØËØ•ÊñπÊ≥ïÂÆûÈôÖÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂú∞ÂùÄ‰∫ÜÔºåÂèØ‰ª•‰∏∫ÂÖ∂ËÆæÁΩÆÊñ≠ÁÇπÔºö 1breakpoint set -o &#123;ÂáΩÊï∞Âú∞ÂùÄ&#125;+&#123;ÂÅèÁßªÂú∞ÂùÄ&#125; ÈÄöÁî®‰∫åËøõÂà∂Êñá‰ª∂ÂåÖÂê´‰∫ÜÂ§öÁßçÊû∂ÊûÑÁöÑ‰∫åËøõÂà∂Êñá‰ª∂Âè´ÂÅöÈÄöÁî®‰∫åËøõÂà∂Êñá‰ª∂ÔºåÂèàÂè´ fat binary ËÉñ‰∫åËøõÂà∂Êñá‰ª∂„ÄÇ123456789// Êü•Áúã‰ø°ÊÅØÔºö$file &#123;Êñá‰ª∂Âêç&#125;$lipo -info &#123;Êñá‰ª∂Âêç&#125;// Áò¶Ë∫´$lipo &#123;Êñá‰ª∂Âêç&#125; -thin armv7 -o &#123;ËæìÂá∫Êñá‰ª∂Âêç&#125;// ÂêàÂπ∂$lipo -create &#123;Êñá‰ª∂Âêç1&#125; &#123;Êñá‰ª∂Âêç2&#125; -o &#123;ËæìÂá∫Êñá‰ª∂Âêç&#125; Xcode ‰∏≠ÁîüÊàêÊû∂ÊûÑÈÖçÁΩÆÂ¶ÇÂõæÔºö ArchitectureÔºö Xcode ÊîØÊåÅÁöÑÊû∂ÊûÑÔºå‰∏çÂêå Xcode ÁâàÊú¨‰∏çÂêå Valid ArchitectureÔºö ÊÉ≥Ë¶ÅÁîüÊàêÁöÑÊû∂ÊûÑ ÊúÄÁªàÁîüÊàêÁöÑÊû∂ÊûÑÂ∞±ÊòØÊîØÊåÅÁöÑÂíåÊÉ≥Ë¶ÅÁöÑÁöÑ‰∫§ÈõÜ„ÄÇ Á®ãÂ∫èÂä†ËΩΩÂú®ÁºñÂÜô‰∏Ä‰∏™Á®ãÂ∫èÊó∂ÔºåÁúãÂà∞ÁöÑÂÖ•Âè£ÂáΩÊï∞ÈÉΩÊòØ main.m„ÄÇÂÆûÈôÖ‰∏äÂú® main ÂáΩÊï∞ÊâßË°åÂâçÂ∑≤ÁªèÊâßË°å‰∫Ü +load Âíå constructor ÊûÑÈÄ†ÂáΩÊï∞„ÄÇÁé∞Âú®Ë¶ÅÊé¢ËÆ®Âú® main ÂáΩÊï∞ÊâßË°åÂâçÂÅö‰∫Ü‰ªÄ‰πà dyld ÁÆÄ‰ªãÁ≥ªÁªüÂÜÖÊ†∏Âú®ÂÅöÂ•ΩÂêØÂä®Á®ãÂ∫èÁöÑÂáÜÂ§áÂ∑•‰Ωú‰πãÂêéÂ∞±‰ºö‰ªéÂÜÖÊ†∏ÊÄÅÂàáÊç¢Âà∞Áî®Êà∑ÊÄÅÔºåÂ∞ÜÂ∑•‰Ωú‰∫§Áªô dyld„ÄÇ Á≥ªÁªüÂä®ÊÄÅÂ∫ì‰ºöÈÄöËøáÂä®ÊÄÅÂ∫ìÂä†ËΩΩÂô® dyld Ë¢´Âä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠„ÄÇ‰∏∫‰∫Ü‰ºòÂåñÁ®ãÂ∫èÂêØÂä®ÈÄüÂ∫¶ÔºåiOS ÈááÁî®‰∫ÜÂÖ±‰∫´ÁºìÂ≠òÊäÄÊúØ„ÄÇÂú®Á≥ªÁªüÂêØÂä®ÂêéË¢´Âä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠„ÄÇÂΩìÊúâÊñ∞ÁöÑÁ®ãÂ∫èÂä†ËΩΩÊó∂‰ºöÂÖàÂà∞ÂÖ±‰∫´ÁºìÂ≠òÈáåÂØªÊâæ„ÄÇÊâæÂà∞Â∞±Áõ¥Êé•Â∞ÜÂÖ±‰∫´ÁºìÂ≠ò‰∏≠ÁöÑÂú∞ÂùÄÊò†Â∞ÑÂà∞ÁõÆÊ†áËøõÁ®ãÁöÑÂÜÖÂ≠òÁ©∫Èó¥„ÄÇ dyld Âä†ËΩΩÊµÅÁ®ãdyld ÁöÑÊó∂Èó¥Á∫øÔºö 1Load dylibs -&gt; Rebase -&gt; Bind -&gt; ObjCruntime -&gt; Initializers dyld ‰ªé‰∏ªÊâßË°åÊñá‰ª∂ÁöÑ header Ëé∑ÂèñÂà∞ÈúÄË¶ÅÂä†ËΩΩÁöÑÊâÄ‰æùËµñÂä®ÊÄÅÂ∫ìÂàóË°®ÔºåÂπ∂ÈÄíÂΩíÁöÑÂ∞Ü‰ªñ‰ª¨Âä†ËΩΩÔºå‰∏∫ÊØè‰∏Ä‰∏™Âä®ÊÄÅÂ∫ìÁîüÊàê‰∏Ä‰∏™ ImageLoader ÂØπË±° Ê£ÄÊü•ÂÖ±‰∫´ÁºìÂ≠òÊòØÂê¶Êò†Â∞ÑÂà∞‰∫ÜÂÖ±‰∫´Âå∫Âüü Âä†ËΩΩÊâÄÊúâÈÄöËøá DYLD_INSERT_LIBRARIES ÊèíÂÖ•ÁöÑÂ∫ì Âú®Âä†ËΩΩÊâÄÊúâÁöÑÂä®ÊÄÅÈìæÊé•Â∫ì‰πãÂêéÔºåÂÆÉ‰ª¨Âè™ÊòØÂ§ÑÂú®Áõ∏‰∫íÁã¨Á´ãÁöÑÁä∂ÊÄÅÔºåÈúÄË¶ÅÂ∞ÜÂÆÉ‰ª¨ÁªëÂÆöËµ∑Êù•ÔºåËøôÂ∞±ÊòØ Fix-ups RebasingÔºöÂú® imageLoader ÂÜÖÈÉ®Ë∞ÉÊï¥ÊåáÈíàÁöÑÊåáÂêëÔºåÂç≥‰øÆÊîπ ASLR Â∏¶Êù•ÁöÑÂÅèÂ∑Æ BindingÔºödylib ÈÄöËøáÊåáÈíàÁªëÂÆö‰ºö‰ΩøÁî®ÁöÑÂ§ñÈÉ®ÁöÑÂÆû‰æãÊñπÊ≥ïÁ≠âÁ¨¶Âè∑ÁöÑÂú∞ÂùÄ ObjC Runtime ÈúÄË¶ÅÁª¥Êä§‰∏ÄÂº†Êò†Â∞ÑÁ±ªÂêç‰∏éÁ±ªÁöÑÂÖ®Â±ÄË°®„ÄÇÂΩìÂä†ËΩΩ‰∏Ä‰∏™ dylib Êó∂ÔºåÂÖ∂ÂÆö‰πâÁöÑÊâÄÊúâÁöÑÁ±ªÈÉΩÈúÄË¶ÅË¢´Ê≥®ÂÜåÂà∞Ëøô‰∏™ÂÖ®Â±ÄË°®‰∏≠„ÄÇ ÊâßË°åÂàùÂßãÂåñÊñπÊ≥ïÔºå+load Âíå constructor Â∞±ÊòØÂú®ËøôÈáåÊâßË°åÁöÑ ÈÄöËøá Load Command ÊâæÂà∞ LC_MAIN Âç≥ main ÂáΩÊï∞‰ΩçÁΩÆÔºåÊâßË°å Mach-O Êñá‰ª∂MachO Êñá‰ª∂Âü∫Êú¨ÊûÑÊàêMach-O ÊòØËãπÊûúÁöÑÂèØÊâßË°åÊñá‰ª∂ÔºåÁªìÊûÑÁî±‰∏âÈÉ®ÂàÜÁªÑÊàêÔºö HeaderÔºöÊñá‰ª∂Á±ªÂûãÔºåÁõÆÊ†áÊû∂ÊûÑÁ±ªÂûã Load CommandsÔºöÊèèËø∞ËΩΩÂÖ•ÂÜÖÂ≠òÁöÑÊúâÂì™‰∫õÊÆµÔºåÊÆµÊúâÂ§öÂ§ßÔºå‰ªéÂì™ÈáåÂºÄÂßã DataÔºöÊÆµÁöÑÊï∞ÊçÆ ‰ΩøÁî® MachOView Êü•ÁúãÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÊúâÂêÑÁßçÂêÑÊ†∑ÁöÑÊÆµ„ÄÇclass-dump Â∞±ÊòØÈÄöËøáËøôÁßçÊñπÂºèËé∑ÂèñÂà∞Â§¥Êñá‰ª∂‰ø°ÊÅØÁöÑ„ÄÇ ÂÖ∑‰ΩìÁúã‰∏Ä‰∏ã Macho ÁöÑ Load CommandÔºåÂÆÉÂåÖÂê´‰∫Ü Macho ‰∏≠ÂêÑ‰∏™ÊÆµÁöÑÂü∫Êú¨‰ø°ÊÅØÔºö ‰∏ÄËà¨ÂèØÊâßË°åÊñá‰ª∂‰ºöÂàÜ‰∏∫ËÆ∏Â§ö‰∏™ sectionÔºåsection Âèà‰ºöÊ†πÊçÆÊùÉÈôêÁöÑ‰∏çÂêåÊï¥Âêà‰∏∫Â§ö‰∏™ fragment Ôºå‰∏ÄËà¨ÂàÜ‰∏∫Âõõ‰∏™ fragmentÔºö __PAGEZERO Á©∫ÊåáÈíàÈô∑Èò±ÊÆµÔºåÊò†Â∞ÑÂà∞ËôöÊãüÂÜÖÂ≠òÁ©∫Èó¥ÁöÑÁ¨¨‰∏ÄÈ°µÔºåÁî®‰∫éÊçïÊçâÂØπ NULL ÊåáÈíàÁöÑÂºïÁî® __TEXT ‰ª£Á†ÅÊÆµÔºåÂè™ËØªÔºåÂåÖÊã¨ÂáΩÊï∞ÔºåÂíåÂè™ËØªÁöÑÂ≠óÁ¨¶‰∏≤(Â¶Ç __TEXT,__text ‰øùÂ≠òÊâÄÊúâ‰ª£Á†ÅÔºåÂèàÂ¶Ç __TEXT.__objc_classname ‰øùÂ≠ò Objective-C Á±ªÂêçÁß∞)__ __DATA Êï∞ÊçÆÊÆµÔºåËØªÂÜôÔºåÂåÖÊã¨ÂèØËØªÂÜôÁöÑÂÖ®Â±ÄÂèòÈáèÁ≠â(Â¶Ç __DATA,__data ‰øùÂ≠òÂàùÂßãÂåñËøáÁöÑÂèØÂèòÊï∞ÊçÆÔºåÂèàÂ¶Ç __DATA.__objc_classlist ‰øùÂ≠òÊâÄÊúâÁ±ªÂÆû‰ΩìÁöÑÊåáÈíàÔºåÊåáÂêë __data ‰∏≠‰øùÂ≠òÁöÑ objc_class ÂÆû‰æãÔºâ __LINKEDITÂä®ÊÄÅÈìæÊé•Âô®ÈúÄË¶Å‰ΩøÁî®ÁöÑ‰ø°ÊÅØÔºåÂåÖÊã¨ÈáçÂÆö‰Ωç‰ø°ÊÅØÔºåÁªëÂÆö‰ø°ÊÅØÔºåÊáíÂä†ËΩΩ‰ø°ÊÅØÁ≠â„ÄÇ ‰ª£Á†ÅÊÆµÂíåÊï∞ÊçÆÊÆµÁöÑÂÖ∑‰ΩìÁªÑÊàê__TEXT ÂåÖÂê´‰ª•‰∏ã sectionÔºö __textÔºöÁ®ãÂ∫èÂèØÊâßË°å‰ª£Á†ÅÂå∫Âüü __stubsÔºöÁÆÄ‰ªãÁ¨¶Âè∑Â≠òÊ†πÔºåË∑≥ËΩ¨Âà∞ÊáíÂä†ËΩΩÊåáÈíàË°® __stub_helperÔºöÂ∏ÆÂä©Ëß£ÂÜ≥ÊáíÂä†ËΩΩÁ¨¶Âè∑Âä†ËΩΩÁöÑËæÖÂä©ÂáΩÊï∞ __objc_methnameÔºöÊñπÊ≥ïÂêç __objc_classnameÔºöÁ±ªÂêç __objc_methtypeÔºöÊñπÊ≥ïÁ≠æÂêç __cstringÔºöcÈ£éÊ†ºÂ≠óÁ¨¶‰∏≤ __DATA ÂåÖÂê´‰ª•‰∏ã sectionÔºö __nl_symbol_ptrÔºöÈùûÊáíÂä†ËΩΩÊåáÈíàË°®ÔºåÂú® dyld Âä†ËΩΩÊó∂‰ºöÁ´ãÂç≥ÁªëÂÆö __la_symbol_ptrÔºöÊáíÂä†ËΩΩÊåáÈíàË°®ÔºåÁ¨¨‰∏ÄÊ¨°Ë∞ÉÁî®ÊâçÁªëÂÆöÂÄº __gotÔºöÈùûÊáíÂä†ËΩΩÂÖ®Â±ÄÊåáÈíàË°® __mod_init_funcÔºöconstructor ÂáΩÊï∞ __mod_term_funcÔºö destructor ÂáΩÊï∞ __cfstringÔºöOC Â≠óÁ¨¶‰∏≤ __objc_classlistÔºöÁ®ãÂ∫è‰∏≠Á±ªÁöÑÂàóË°® __objc_nlclslistÔºöÁ®ãÂ∫è‰∏≠ÂÆûÁé∞‰∫Ü +load ÊñπÊ≥ïÁöÑÁ±ª __objc_protolistÔºöÂçèËÆÆÁöÑÂàóË°® __objc_classrefsÔºöË¢´Â∫îÁî®ÁöÑÁ±ªÂàóË°® ÊáíÂä†ËΩΩÂíåÈùûÊáíÂä†ËΩΩÂú®‰πãÂâçËØ¥ÁöÑdyldÊâßË°åÊµÅÁ®ã‰∏≠Êúâ‰∏ÄÁéØÂè´ÂÅö bindingÔºåÂç≥ÁªëÂÆöÁ¨¶Âè∑ÁöÑÂú∞ÂùÄ„ÄÇiOS Á≥ªÁªü‰∏∫‰∫ÜÂä†Âø´Á≥ªÁªüÂêØÂä®ÈÄüÂ∫¶ÔºåÂ∞ÜÁ¨¶Âè∑ÂàÜÊàê‰∫ÜÊáíÂä†ËΩΩÁ¨¶Âè∑ÂíåÈùûÊáíÂä†ËΩΩÁ¨¶Âè∑„ÄÇ ÈùûÊáíÂä†ËΩΩÁ¨¶Âè∑Âú® dyld Âä†ËΩΩÊó∂Â∞±‰ºöÁªëÂÆöÁúüÂÆûÁöÑÂÄº„ÄÇÊáíÂä†ËΩΩÁ¨¶Âè∑‰∏ç‰ºöÔºåÂè™ÊúâÁ¨¨‰∏ÄÊ¨°ÂéªË∞ÉÁî®ÂÆÉÊó∂Êâç‰ºöÁªëÂÆöÁúüÂÆûÁöÑÂú∞ÂùÄÔºåÁ¨¨‰∫åÊ¨°Ë∞ÉÁî®Áõ¥Êé•‰ΩøÁî®ÁúüÂÆûÂú∞ÂùÄ„ÄÇ Â¶ÇÁ≥ªÁªüÊñπÊ≥ï print ÁöÑÁªëÂÆöËøáÁ®ãÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ARM Ê±áÁºñARMÂØÑÂ≠òÂô®X0-X30 ÊòØ 31 ‰∏™ÈÄöÁî®ÂØÑÂ≠òÂô®Ôºå‰Ωé 32 ‰ΩçÁî® W0-W30 Ë°®Á§∫„ÄÇX30 ÊòØ‰∏Ä‰∏™ÁâπÊÆäÂØÑÂ≠òÂô®ÔºåÁî®‰∫é‰øùÂ≠òÂáΩÊï∞Ë∞ÉÁî®ÂÆåÊàêÊó∂ÁöÑËøîÂõûÂú∞ÂùÄ„ÄÇ SP ‰∏∫Â†ÜÊ†àÊåáÈíàÂØÑÂ≠òÂô®ÔºåÈÄöËøá X31 ÂØÑÂ≠òÂô®ËÆøÈóÆ PC ‰∏∫‰øùÂ≠òÂΩìÂâçÊåá‰ª§Âú∞ÂùÄÁöÑÁ®ãÂ∫èËÆ°Êï∞Âô® LR ÊåáÂêëËøîÂõûÂú∞ÂùÄÔºåÂØπÂ∫î‰∫é X30 FP ÊåáÂêëÊ†àÂ∏ßÁöÑÂ∫ïÈÉ®ÔºåÂØπÂ∫î‰∫é X29ÔºàÂç≥ Base PointerÔºâ Â∏∏ËßÅÊåá‰ª§ldr Xn, addr: ‰ªé addr ËØªÂèñÂÜÖÂÆπÂ≠òÂà∞ Xn ‰∏≠ str Xn, addr: Â∞Ü Xn ÂÜôÂÖ• addr ÊåáÂêëÁöÑÂÜÖÂ≠ò cbz Xn, label : Â¶ÇÊûú Xn ‰∏∫ 0ÔºåÂàôË∑≥ËΩ¨Âà∞ label cbnz Xn, label: Â¶ÇÊûú Xn ‰∏ç‰∏∫ 0ÔºåË∑≥ËΩ¨Âà∞ label bl label: Êó†Êù°‰ª∂Ë∑≥ËΩ¨Ôºå‰ºöÂ∞Ü‰∏ã‰∏ÄÊù°Êåá‰ª§Âú∞ÂùÄÂÜôÂà∞ X30 Â§Ñ Â†ÜÊ†àË∞ÉÁî®Â†ÜÊ†àË∞ÉÁî®ËøáÁ®ãÂ¶Ç‰∏ãÔºö ÂáΩÊï∞Ë∞ÉÁî®ÂâçÔºö ÂºÄËæüÂ†ÜÊ†àÊéß‰ª∂ ‰øùÂ≠ò FP Âíå LR ÂØÑÂ≠òÂô®Ôºå‰ª•‰æøÊâæÂà∞‰∏ä‰∏Ä‰∏™Ê†àÂ∏ßÂíåËøîÂõûÂú∞ÂùÄ ËÆæÁΩÆÊñ∞ÁöÑ FP ÂØÑÂ≠òÂô® ‰øùÂ≠òÂ≠êÂáΩÊï∞‰ºöÁî®Âà∞ÁöÑÂØÑÂ≠òÂô® ‰øùÂ≠òÂ±ÄÈÉ®ÂèòÈáèÊàñÂèÇÊï∞ ÂáΩÊï∞Ë∞ÉÁî®ÁªìÊùüÔºö ËøòÂéü FP Âíå LR ÂØÑÂ≠òÂô® ÈáäÊîæÊ†àÂ∏ßÁ©∫Èó¥ Ë∑≥Âà∞ LR ÁªßÁª≠ÊâßË°å ÂèÇÊï∞‰∏ÄËà¨ÈÄöËøá X0-X7‰º†ÈÄíÔºåÂΩìÂèÇÊï∞Â∞è‰∫é 8 ‰∏™Êó∂ÂÄôÔºåÈªòËÆ§ÊòØÁõ¥Êé•Â≠òÂà∞ÂØÑÂ≠òÂô®‰∏≠ÁöÑ„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúË∂ÖËøá 8 ‰∏™ÔºåÈÇ£‰πà‰ºöÂú®ÊñπÊ≥ïË∞ÉÁî®ÂâçÔºåÂ∞ÜÂ§öÂá∫ÁöÑÈÇ£‰∏™Â≠òÂÖ•Â†ÜÊ†à‰∏≠ÔºåÂ≠êÊñπÊ≥ïÈúÄË¶ÅÂà∞Â†ÜÊ†à‰∏≠ÂèñÂÄº„ÄÇ ËøîÂõûÁªìÊûú‰∏ÄËà¨ÈÄöËøá X0 ‰º†ÈÄí ‰∏Ä‰∏™ÊñπÊ≥ïÁöÑÊ±áÁºñÁöÑ‰æãÂ≠êÔºö 12345678910void fooFp() &#123; int a = 4; int b = 5; fooFp2();&#125;void fooFp2() &#123; int a = 2; int b = 3;&#125; 1234567891011121314ArmAssembly`fooFp: 0x100dbe76c &lt;+0&gt;: sub sp, sp, #0x20 ; Áî≥ËØ∑Ê†àÁ©∫Èó¥ 0x100dbe770 &lt;+4&gt;: stp x29, x30, [sp, #0x10] ; ‰øùÊä§ÂØÑÂ≠òÂô®ÁöÑÂÄº 0x100dbe774 &lt;+8&gt;: add x29, sp, #0x10 ; ÊîπÂèòfpÂØÑÂ≠òÂô®ÁöÑÂÄºÔºåÁî®‰∫éÊâßË°åÊ†àÂ∫ï 0x100dbe778 &lt;+12&gt;: mov w8, #0x5 0x100dbe77c &lt;+16&gt;: orr w9, wzr, #0x4 0x100dbe780 &lt;+20&gt;: stur w9, [x29, #-0x4] 0x100dbe784 &lt;+24&gt;: str w8, [sp, #0x8] 0x100dbe788 &lt;+28&gt;: bl 0x100dbe798 ; fooFp2 at ViewController.m:154 0x100dbe78c &lt;+32&gt;: ldp x29, x30, [sp, #0x10] ; ÊÅ¢Â§ç‰πãÂâç‰øùÂ≠òÁöÑfpÂíålrÁöÑÂÄº 0x100dbe790 &lt;+36&gt;: add sp, sp, #0x20 ; ÊÅ¢Â§çspÊåáÈíà 0x100dbe794 &lt;+40&gt;: ret hookfishhookËãπÊûú‰∏∫‰∫ÜËÉΩÂú® Mach-O Êñá‰ª∂‰∏≠ËÆøÈóÆÂ§ñÈÉ®ÂáΩÊï∞ÔºåÈááÁî®‰∫Ü‰∏Ä‰∏™ÊäÄÊúØÔºåÂè´ÂÅöPICÔºà‰ΩçÁΩÆ‰ª£Á†ÅÁã¨Á´ãÔºâÊäÄÊúØ„ÄÇÂΩì‰Ω†ÁöÑÂ∫îÁî®Á®ãÂ∫èÊÉ≥Ë¶ÅË∞ÉÁî® Mach-O Êñá‰ª∂Â§ñÈÉ®ÁöÑÂáΩÊï∞ÁöÑÊó∂ÂÄôÔºåÊàñËÄÖËØ¥Â¶ÇÊûú Mach-O ÂÜÖÈÉ®ÈúÄË¶ÅË∞ÉÁî®Á≥ªÁªüÁöÑÂ∫ìÂáΩÊï∞Êó∂ÔºåMach-O Êñá‰ª∂‰ºöÔºö ÂÖàÂú® Mach-O Êñá‰ª∂ÁöÑ _DATA ÊÆµ‰∏≠Âª∫Á´ã‰∏Ä‰∏™ÊåáÈíàptrÔºà8Â≠óËäÇÁöÑÊï∞ÊçÆÔºåÊîæÁöÑÂÖ®ÊòØ0ÔºâÔºåËøô‰∏™ÊåáÈíàÂèòÈáèÊåáÂêëÂ§ñÈÉ®ÂáΩÊï∞„ÄÇ DYLD ‰ºöÂä®ÊÄÅÁöÑËøõË°åÁªëÂÆöÔºÅÂ∞Ü Mach-O ‰∏≠ÁöÑ _DATA ÊÆµ‰∏≠ÁöÑÊåáÈíàÔºåÊåáÂêëÂ§ñÈÉ®ÂáΩÊï∞„ÄÇ ‰∏äÂõæ‰∏≠ÂèØ‰ª•ÁúãÂà∞ÔºåÂÖ∂‰ªñÈÉ®ÂàÜÈÉΩÊòØÂÆûÂÆûÂú®Âú®ÁöÑ‰ª£Á†Å‰ø°ÊÅØÔºåÊ≤°ÊúâÂ•ΩÁöÑ‰øÆÊîπÂäûÊ≥ï„ÄÇÂè™ÊúâÁ∫¢Ëâ≤Ê°ÜÊ°Ü‰∏≠ÁöÑ nl_symbol_ptr Âíå la_symbol_ptrÊòØÊåáÈíàÊÆµÔºåÁî±‰∫éÊåáÈíàÈÉΩÊòØÈïøÂ∫¶Âõ∫ÂÆöÁöÑÔºåÊâÄ‰ª•Êñπ‰æø‰øÆÊîπÊåáÈíàÂú∞ÂùÄÔºåËøõËÄåËææÂà∞ hook ÁöÑÁõÆÁöÑ„ÄÇ ÊâÄ‰ª•ËØ¥ÔºåCÁöÑÂ∫ïÂ±Ç‰πüÊúâÂä®ÊÄÅÁöÑË°®Áé∞„ÄÇCÂú®ÂÜÖÈÉ®ÂáΩÊï∞ÁöÑÊó∂ÂÄôÊòØÈùôÊÄÅÁöÑÔºåÂú®ÁºñËØëÂêéÔºåÂáΩÊï∞ÁöÑÂÜÖÂ≠òÂú∞ÂùÄÂ∞±Á°ÆÂÆö‰∫Ü„ÄÇ‰ΩÜÊòØÔºåÂ§ñÈÉ®ÁöÑÂáΩÊï∞ÊòØ‰∏çËÉΩÁ°ÆÂÆöÁöÑÔºå‰πüÂ∞±ÊòØËØ¥CÁöÑÂ∫ïÂ±Ç‰πüÊúâÂä®ÊÄÅÁöÑ„ÄÇfishhook ‰πãÊâÄ‰ª•ËÉΩ hook CÂáΩÊï∞ÔºåÊòØÂà©Áî®‰∫Ü Mach-O Êñá‰ª∂ÁöÑ PIC ÊäÄÊúØÁâπÁÇπ„ÄÇ‰πüÂ∞±ÈÄ†Â∞±‰∫ÜÈùôÊÄÅËØ≠Ë®ÄC‰πüÊúâÂä®ÊÄÅÁöÑÈÉ®ÂàÜÔºåÈÄöËøá DYLD ËøõË°åÂä®ÊÄÅÁªëÂÆöÁöÑÊó∂ÂÄôÂÅö‰∫ÜÊâãËÑö„ÄÇ Êàë‰ª¨ÁªèÂ∏∏ËØ¥Á¨¶Âè∑ÔºåÂÖ∂ÂÆû _DATA ÊÆµ‰∏≠Âª∫Á´ãÁöÑÊåáÈíàÂ∞±ÊòØÁ¨¶Âè∑„ÄÇfishhookÁöÑÂéüÁêÜÂÖ∂ÂÆûÂ∞±ÊòØÔºåÂ∞ÜÊåáÂêëÁ≥ªÁªüÊñπÊ≥ïÔºàÂ§ñÈÉ®ÂáΩÊï∞ÔºâÁöÑÁ¨¶Âè∑ÈáçÊñ∞ËøõË°åÁªëÂÆöÊåáÂêëÂÜÖÈÉ®ÁöÑÂáΩÊï∞„ÄÇËøôÊ†∑Â∞±ÊääÁ≥ªÁªüÊñπÊ≥ï‰∏éËá™Â∑±ÂÆö‰πâÁöÑÊñπÊ≥ïËøõË°å‰∫Ü‰∫§Êç¢„ÄÇËøô‰πüÂ∞±ÊòØ‰∏∫‰ªÄ‰πàCÁöÑÂÜÖÈÉ®ÂáΩÊï∞‰øÆÊîπ‰∏ç‰∫ÜÔºåËá™ÂÆö‰πâÁöÑÂáΩÊï∞‰øÆÊîπ‰∏ç‰∫ÜÔºåÂè™ËÉΩ‰øÆÊîπ Mach-O Â§ñÈÉ®ÁöÑÂáΩÊï∞„ÄÇ iOS Á≠æÂêçÁ≠æÂêçËøáÁ®ãÂ¶ÇÂõæÔºö ÂΩìÊàë‰ª¨‰øÆÊîπ‰∫ÜÂà´‰∫∫ÁöÑ APP ‰πãÂêéÔºåÊàë‰ª¨Â∞±ÈúÄË¶ÅÂ∞Ü‰øÆÊîπËøáÁöÑ ipa ÈáçÁ≠æÂêçÔºåÊâçËÉΩÂÆâË£ÖÂà∞ÊâãÊú∫‰∏ä„ÄÇÈáçÁ≠æÂêç‰∫ÜÁöÑÂ∫îÁî®ÂèØ‰ª•ÂÆâË£ÖÂà∞Êú™Ë∂äÁã±ÊâãÊú∫„ÄÇ IPAPatch ÂÖçË∂äÁã±Ë∞ÉËØï APPIPAPatch Â∞±ÊòØÈÄöËøá‰ªéÁ≠æÂêçËææÂà∞ÂÖçË∂äÁã±Ê≥®ÂÖ•‰ª£Á†ÅÁöÑÁõÆÁöÑ„ÄÇ‰ΩøÁî®Ëµ∑Êù•ÈùûÂ∏∏ÁÆÄÂçï„ÄÇ ‰ΩøÁî® PP Âä©Êâã‰∏ãËΩΩ‰∏Ä‰∏™Â∑≤Ë∂äÁã±ÁöÑÂ∫îÁî®ÁöÑ ipa ‰∏ãËΩΩ IPAPatch ÁöÑÂ∑•Á®ã ‰ΩøÁî®Â∑≤Ë∂äÁã±ÁöÑ ipa ÊõøÊç¢Â∑•Á®ã‰∏≠ Assets Êñá‰ª∂Â§π‰∏ãÁöÑ app.ipa Êñá‰ª∂„ÄÇÊ≥®ÊÑèÔºåÂêçÂ≠óË¶ÅÊîπ‰∏∫ app.ipa Â∞Ü RevealServer.framework ÊîæÁΩÆÂú® Assets/Frameworks/RevealServer.framework ‰øÆÊîπ bundleId Run Xcode ÂÆâË£ÖÂà∞ÊâãÊú∫ ÂÆâÂÖ®‰øùÊä§ÈùôÊÄÅÊ∑∑Ê∑ÜÂÆèÂÆö‰πâ‰ΩøÁî®ÂÆèÂ∞ÜÊñπÊ≥ïÂ±ûÊÄßÂêç‰øÆÊîπ‰∏∫ÂÖ∂‰ªñÊó†ÊÑè‰πâÁöÑÂ≠óÁ¨¶‰∏≤ Âä®ÊÄÅ‰øùÊä§ÂèçË∞ÉËØïptrace UNIX Êó©ÊúüÁâàÊú¨Êèê‰æõÁöÑ‰∏ÄÁßçÂØπËøêË°å‰∏≠ÁöÑËøõÁ®ãËøõË°åË∑üË∏™ÂíåÊéßÂà∂ÁöÑÊâãÊÆµÔºåÂ∞±ÊòØÁ≥ªÁªüË∞ÉÁî® ptrace„ÄÇÈÄöËøá ptrace ÂÆûÁé∞ÂØπÂè¶‰∏Ä‰∏™ËøõÁ®ãÁöÑË∞ÉËØïË∑üË∏™ ÂèØ‰ª•ÈÄöËøáÂèÇÊï∞ PT_DENY_ATTACH Á¶ÅÁî®Ë∞ÉËØï„ÄÇËøô‰∏™ÂèÇÊï∞ÂëäËØâÁ≥ªÁªüÈòªÊ≠¢Ë∞ÉËØïÂô®‰æùÈôÑ„ÄÇÊâÄ‰ª•ÔºåÊúÄÂ∏∏Áî®ÁöÑÂèçË∞ÉËØïÊñπÊ≥ïÂ∞±ÊòØÈÄöËøáË∞ÉÁî® ptrace Êù•ÂÆûÁé∞ÂèçË∞ÉËØï„ÄÇ sysctl ÂΩì‰∏Ä‰∏™ËøõÁ®ãË¢´Ë∞ÉËØïÊó∂ÔºåËØ•ËøõÁ®ã‰∏≠ÁöÑ‰∏Ä‰∏™Ê†áÂøó‰ΩçÁî®Êù•Ê†áËÆ∞Ê≠£Âú®Ë¢´Ë∞ÉËØï„ÄÇÂèØ‰ª•ÂÆöÊó∂ÈÄöËøá sysctl Êü•ÁúãËøô‰∏™Ê†áÂøó‰Ωç ÂèçÂèçË∞ÉËØïhookÂáΩÊï∞ -&gt; Âà§Êñ≠ÂèÇÊï∞ -&gt; ËøîÂõûÁªìÊûú Ë∂äÁã±ËÆæÂ§áÁõ¥Êé•ÂèØ‰ª•hook‰ª•‰∏äËØ¥Âà∞ÁöÑÂèçË∞ÉËØïÂáΩÊï∞„ÄÇÈùûË∂äÁã±ËÆæÂ§áÂèØ‰ª•ÈÄöËøá fishhookÔºåhook ÂèçË∞ÉËØïÂáΩÊï∞„ÄÇ ÂèçÊ≥®ÂÖ•ÂèØ‰ª•ÂÆöÊúüË∞ÉÁî® _dyld_get_image_name() ÊñπÊ≥ïÔºåËé∑ÂèñÊ≠£Âú®Âä†ËΩΩÁöÑÂä®ÊÄÅÂ∫ìÂêçÔºåÊØîËæÉÊòØÂê¶ÊòØÁôΩÂêçÂçïÂÜÖÁöÑÂä®ÊÄÅÂ∫ìÂêçÊù•ÂÆûÁé∞Ê≥®ÂÖ•Ê£ÄÊµã„ÄÇ hook Ê£ÄÊµãhook ÂåÖÊã¨ Method SwizzleÔºåÁ¨¶Âè∑Ë°®ÊõøÊç¢Ôºåinline hook Á≠â„ÄÇ‰∏çÂêåÁöÑ hook ÊñπÂºèÔºåÈúÄË¶ÅÂà∂ÂÆö‰∏çÂêåÁöÑÊ£ÄÊµãÊñπÊ°à Method Swizzle Method Swizzle ÁöÑÂéüÁêÜÊòØÊõøÊç¢ impÔºåÈÄöËøá dladdr ÂæóÂà∞ imp ÊâÄÂú®ÁöÑÊ®°ÂùóÔºåÂà§Êñ≠Ê®°ÂùóÊòØ‰∏çÊòØ‰∏ª‰∫åËøõÂà∂Ê®°ÂùóÔºåÂ¶ÇÊûú‰∏çÊòØÂ∞±ÊòØË¢´ hook ‰∫Ü„ÄÇ Á¨¶Âè∑Ë°®ÊõøÊç¢ fishhook ÊòØÂü∫‰∫éÊáíÂä†ËΩΩÁ¨¶Âè∑Ë°®ÂíåÈùûÊáíÂä†ËΩΩÁ¨¶Âè∑Ë°®ËøõË°åÊõøÊç¢ÁöÑÔºåÊâÄ‰ª•ÈÅçÂéÜÁ¨¶Âè∑Ë°®‰∏≠ÁöÑÊåáÈíàÂ∞±ËÉΩÂà§Êñ≠Á®ãÂ∫èÊòØÂê¶Ë¢´ÊÅ∂ÊÑè hook ‰∫Ü„ÄÇ ÈùûÊáíÂä†ËΩΩÁöÑÊåáÈíàÊåáÂêëÁúüÂÆûÂú∞ÂùÄÔºåÊáíÂä†ËΩΩÁöÑÊåáÈíàÂú®Ê≤°ÊúâËß£ÊûêÂà∞ÁúüÊ≠£ÁöÑÂú∞ÂùÄÈí±ÊåáÂêë __stub_helperÔºåÊâÄ‰ª•ÈÅçÂéÜÁ¨¶Âè∑Ë°®ÔºåÂà§Êñ≠ÊòØÂê¶ÊåáÂêë‰∫ÜÁ≥ªÁªüÊ®°ÂùóÊàñËÄÖ __stub_helper Âç≥ÂèØ„ÄÇ ÂÆåÊï¥ÊÄßÊ†°È™åÈÄÜÂêëËøáÁ®ãËÆæËÆ°Âà∞ÂØπÊñá‰ª∂ load command ÁöÑ‰øÆÊîπÔºåÂØπÊñá‰ª∂ËøõË°åÈáçÁ≠æÂêçÔºå‰øÆÊîπ BundleId„ÄÇÂèØ‰ª•‰ªé‰∏äËø∞Âá†‰∏™ÊñπÈù¢Ê†°È™å load command Áõ¥Êé•ËØªÂèñ Mach-O load command ‰∏≠ÁöÑ LC_LOAD_DYLIB ÔºåÂà§Êñ≠ÊòØÂê¶ÊúâÈùûÁôΩÂêçÂçïÂä®ÊÄÅÂ∫ì ‰ª£Á†ÅÊ†°È™å Ëé∑ÂèñÂÜÖÂ≠ò‰∏≠‰ª£Á†ÅÁöÑ MD5 ÂÄºÔºåÂ¶ÇÊûú‰ª£Á†Å‰øÆÊîπ‰∫ÜÔºåÂ∞±‰ºö‰∏ç‰∏ÄÊ†∑ ÈáçÁ≠æÂêçÊ†°È™å Âà§Êñ≠ bundle ID ÊòØÂê¶Ë¢´‰øÆÊîπ 8086ÁÆÄ‰ªã8086 ÊòØ x86Á≥ªÂàóÂ§ÑÁêÜÂô®ÁöÑÂºÄÁ´ØÔºåÊâÄ‰ª•ÂêéÈù¢Áî® x86 ‰ª£Êõø 32‰ΩçÂ§ÑÁêÜÂô®„ÄÇ CPU ÁöÑÁªÑÊàêCPU ÁöÑ‰∏âÂ§ßÁªÑÊàêÔºö ËøêÁÆóÂçïÂÖÉ Êï∞ÊçÆÂçïÂÖÉ ÊéßÂà∂ÂçïÂÖÉ ËøêÁÆóÂçïÂÖÉÂÅöÂä†Ê≥ïÊàñËÄÖ‰ΩçÁßªÁöÑÊìç‰Ωú„ÄÇ Êï∞ÊçÆÂçïÂÖÉÂåÖÂê´CPUÂÜÖÈÉ®ÁöÑÁºìÂ≠òÂíåÂØÑÂ≠òÂô®ÁªÑ„ÄÇ ÊéßÂà∂ÂçïÂÖÉÂèØ‰ª•Ëé∑Âæó‰∏ã‰∏ÄÊù°Êåá‰ª§ÔºåÁÑ∂ÂêéÊâßË°å„ÄÇËøô‰∏™Êåá‰ª§‰ºöÊåáÂØºËøêÁÆóÂçïÂÖÉÂèñÂá∫Êï∞ÊçÆÂçïÂÖÉ‰∏≠ÁöÑÊüêÂá†‰∏™Êï∞ÊçÆÔºåËÆ°ÁÆóÂá∫ÁªìÊûúÔºåÁÑ∂ÂêéÊîæÂà∞Êï∞ÊçÆÂçïÂÖÉÁöÑÊüê‰∏™Âú∞Êñπ„ÄÇ 8086 ÁöÑÂØªÂùÄÊñπÂºè8086 ÁöÑÊÄªÁ∫øÊòØÊúâ16Ê†πÔºå‰ΩÜÊòØÂèØ‰ª•ÂØªÂùÄÁöÑËåÉÂõ¥‰∏∫ 2^20 byte„ÄÇ 20‰ΩçÁöÑÁâ©ÁêÜÂú∞ÂùÄ = 16‰ΩçÁöÑÊÆµÂú∞ÂùÄ * 16 + 4‰ΩçÁöÑÂÅèÁßªÂú∞ÂùÄ CPU ‰∏≠ÁöÑÊï∞ÊçÆÂçïÂÖÉ8086 CPU ‰∏≠ÁöÑÊï∞ÊçÆÂçïÂÖÉÂ¶Ç‰∏ãÔºö ÂÖ∂‰∏≠Ôºö AXÔºåBXÔºåCXÔºåDX ‰∏∫Êï∞ÊçÆÂØÑÂ≠òÂô®ÔºåÂ≠òÊîæÊìç‰ΩúÁöÑÊï∞ÊçÆ CS ‰ª£Ë°®‰ª£Á†ÅÊÆµÁöÑËµ∑ÂßãÂú∞ÂùÄ„ÄÇIP Ë°®Á§∫ÂÅèÁßªÂú∞ÂùÄ„ÄÇÊØèËØªÂèñ‰∏ÄÊù°Êåá‰ª§ÔºåIP=IP + ÊâÄËØªÂèñÊåá‰ª§ÁöÑÈïøÂ∫¶„ÄÇ SS Ë°®Á§∫Ê†àÁöÑËµ∑Âßã‰ΩçÁΩÆ„ÄÇSP Ë°®Á§∫Ê†àÁöÑÂÅèÁßªÂú∞ÂùÄ„ÄÇBP ÊòØÂÖ•ÂèÇÂíå‰∏¥Êó∂ÂèòÈáèÁöÑÂàÜÁïåÔºåÈÄöËøá BP ÂèäÂÅèÁßªÈáèÊãøÂà∞ÂÖ•ÂèÇÂíå‰∏¥Êó∂ÂèòÈáè„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WKWebView ‰ΩøÁî®Ôºà‰∏âÔºâ‚Äî‚Äî WebViewJavaScriptBridge Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2018%2F10%2F01%2FWKWebView3%2F</url>
    <content type="text"><![CDATA[ËÆ∞ÂΩï‰∏Ä‰∏ã WKWebView Áõ∏ÂÖ≥‰ΩøÁî® WebViewJavaScriptBridge Ê∫êÁ†ÅËß£ÊûêÂü∫Êú¨Áî®Ê≥ï ÂØºÂÖ•Â§¥Êñá‰ª∂ÔºåÂ£∞Êòé‰∏Ä‰∏™ WebViewJavascriptBridge Â±ûÊÄßÔºö 123#import "WebViewJavascriptBridge.h"...@property WebViewJavascriptBridge* bridge; Â∞Ü wkwebview ËÆæÁΩÆÁªô bridge 1self.bridge = [WebViewJavascriptBridge bridgeForWebView:webView]; Âú® Objective-C ‰∏≠Ê≥®ÂÜå handler ÂíåË∞ÉÁî® JavaScript ‰∏≠ÁöÑ handlerÔºö 1234[self.bridge registerHandler:@"ObjC Echo" handler:^(id data, WVJBResponseCallback responseCallback) &#123; NSLog(@"ObjC Echo called with: %@", data); responseCallback(data);&#125;]; ËÆæÁΩÆ bridge ÁöÑ‰ª£ÁêÜ‰∏∫‰ªªÊÑè‰Ω†Êìç‰ΩúÁöÑÊéßÂà∂Âô®„ÄÇËøôÊ†∑ÔºåÊâÄÊúâ webView Áõ∏ÂÖ≥ÁöÑÊñπÊ≥ïÂú®ÁªèËøá bridge ÁöÑÈ¢ÑÂ§ÑÁêÜÂêéÔºåÈÉΩÂ∞ÜÊìç‰ΩúÊùÉËΩ¨ÁßªÁªô‰∫Ü‰ΩøÁî®ËÄÖÔºö 1[self.bridge setWebViewDelegate:self]; Â§çÂà∂‰∏ãÈù¢ÁöÑ setupWebViewJavascriptBridge ÂáΩÊï∞Âà∞‰Ω†ÁöÑ JavaScript ‰ª£Á†Å‰∏≠„ÄÇËØ•ÊñπÊ≥ïÁî®Êù•ÂàùÂßãÂåñ js Á´ØÁöÑ bridgeÔºö 12345678910function setupWebViewJavascriptBridge(callback) &#123; if (window.WebViewJavascriptBridge) &#123; return callback(WebViewJavascriptBridge); &#125; if (window.WVJBCallbacks) &#123; return window.WVJBCallbacks.push(callback); &#125; window.WVJBCallbacks = [callback]; var WVJBIframe = document.createElement('iframe'); WVJBIframe.style.display = 'none'; WVJBIframe.src = 'https://__bridge_loaded__'; document.documentElement.appendChild(WVJBIframe); setTimeout(function() &#123; document.documentElement.removeChild(WVJBIframe) &#125;, 0)&#125; Ë∞ÉÁî® loadRequestÔºåÂú®ÊâßË°å JS ‰ª£Á†ÅÁöÑÊó∂ÂÄô‰ºöË∞ÉÁî® setupWebViewJavascriptBridge ÂáΩÊï∞„ÄÇ‰ΩøÁî® bridge Êù•Ê≥®ÂÜå handler ÂíåË∞ÉÁî® Objective-C ‰∏≠ÁöÑ handlerÔºö 123456789setupWebViewJavascriptBridge(function(bridge) &#123; bridge.registerHandler('JS Echo', function(data, responseCallback) &#123; console.log("JS Echo called with:", data) responseCallback(data) &#125;) bridge.callHandler('ObjC Echo', &#123;'key':'value'&#125;, function responseCallback(responseData) &#123; console.log("JS received response:", responseData) &#125;)&#125;) Ëá≥Ê≠§Ôºånative Á´ØÂíå js Á´ØÈÉΩÊúâ‰∫Ü‰∏Ä‰∏™ bridgeÔºåÂèØ‰ª•Áõ∏‰∫íË∞ÉÁî®„ÄÇ JS Á´Ø‰∏ªÂä®Ë∞ÉÁî® Native: 123bridge.callHandler('ObjC Echo', &#123;'key':'value'&#125;, function responseCallback(responseData) &#123; console.log("JS received response:", responseData)&#125;) Native ‰∏ªÂä®Ë∞ÉÁî® JSÔºö 123[self.bridge callHandler:@"JS Echo" data:nil responseCallback:^(id responseData) &#123; NSLog(@"ObjC received response: %@", responseData);&#125;]; ÁªìÊûÑ‰ª£Á†ÅÂàÜ‰∏∫‰∏â‰∏™ÈÉ®ÂàÜÔºö Â§ñÂ±ÇË∞ÉÁî®Êé•Âè£ÔºöWebViewJavascriptBridge &amp;&amp; WKWebViewJavascriptBridge ÂÖ∑‰ΩìÂÆûÁé∞Ôºö WebViewJavascriptBridgeBase JS Â±ÇÔºö WebViewJavascriptBridge_JS ÂèØ‰ª•ÁúãÂæóÂá∫Êù•ÔºåÂØπ‰∫é‰∏Ä‰∏™ÁªôÂà´‰∫∫‰ΩøÁî®ÁöÑÁ±ªÂ∫ìÁöÑÂÆûÁé∞„ÄÇÁªôÂ§ñÈÉ®‰ΩøÁî®ÁöÑÔºåÂè™Ë¶ÅÊö¥Èú≤Âá∫ÂØ•ÂØ•Âá†‰∏™ÊñπÊ≥ïÂç≥ÂèØ„ÄÇËÄåÂÖ∑‰ΩìÁöÑÂÆûÁé∞Â∫îËØ•ÊîæÂà∞Âè¶Â§ñÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÁöÑÊñá‰ª∂‰∏≠ÂéªÔºå‰ª•Ê≠§Âå∫ÂàÜËÅåË¥£„ÄÇ Ê∫êÁ†ÅËß£ÊûêÂàùÂßãÂåñ12345678910111213141516171819202122232425262728293031// WKWebViewJavaScriptBridge.m+ (instancetype)bridgeForWebView:(WKWebView*)webView &#123; WKWebViewJavascriptBridge* bridge = [[self alloc] init]; [bridge _setupInstance:webView]; [bridge._base reset]; return bridge;&#125;- (void) _setupInstance:(WKWebView*)webView &#123; _webView = webView; _webView.navigationDelegate = self; _base = [[WebViewJavascriptBridgeBase alloc] init]; _base.delegate = self;&#125;// WebViewJavascriptBridgeBase.m- (id)init &#123; if (self = [super init]) &#123; self.messageHandlers = [NSMutableDictionary dictionary]; self.startupMessageQueue = [NSMutableArray array]; self.responseCallbacks = [NSMutableDictionary dictionary]; _uniqueId = 0; &#125; return self;&#125;- (void)reset &#123; self.startupMessageQueue = [NSMutableArray array]; self.responseCallbacks = [NSMutableDictionary dictionary]; _uniqueId = 0;&#125; ÂàùÂßãÂåñÂÅöÁöÑ‰∫ãÊÉÖ‰∏çÊòØÂæàÂ§öÔºå‰∏ªË¶ÅÂ∞±ÊòØÁîüÊàê‰∫Ü‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÂ§ÑÁêÜÈÄªËæëÁöÑÂÆû‰æã WebViewJavascriptBridgeBase ÔºåÁÑ∂Âêé WKWebViewJavascriptScriptBridge Â∞Ü WKWebView ÁöÑ‰ª£ÁêÜËÆæÁΩÆ‰∏∫‰∫ÜËá™Â∑±ÔºåËôΩÁÑ∂ÂêéÈù¢ËøòÊòØ‰ºöËΩ¨ÂèëÁªô _base ÁöÑÁõ∏Â∫îÂ§ÑÁêÜÊñπÊ≥ïÂ§ÑÁêÜ„ÄÇ messageHandlers,startupMessageQueue Âíå responseCallbacks ÂêéÈù¢‰ºöËÆ≤Âà∞„ÄÇ Ê≥®ÂÜå‰∏éÁßªÈô§Êèê‰æõÁªô JS ÁöÑ OC ÊñπÊ≥ï12345678910typedef void (^WVJBResponseCallback)(id responseData);typedef void (^WVJBHandler)(id data, WVJBResponseCallback responseCallback);- (void)registerHandler:(NSString *)handlerName handler:(WVJBHandler)handler &#123; _base.messageHandlers[handlerName] = [handler copy];&#125;- (void)removeHandler:(NSString *)handlerName &#123; [_base.messageHandlers removeObjectForKey:handlerName];&#125; ‰ª£Á†ÅÈùûÂ∏∏ÁÆÄÂçïÔºåÂÖ∂ÂÆûÂ∞±ÊòØÊääÊèê‰æõÁªô JS Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÁöÑÊñπÊ≥ïÂêçÂíåÂ§ÑÁêÜ block ‰øùÂ≠òÂú®‰∫Ü _base ‰∏≠ÁöÑ messageHandlers Â≠óÂÖ∏‰∏≠„ÄÇ Â§ÑÁêÜ block ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫ JS ‰º†ÈÄíÁªô OC ÁöÑÂèÇÊï∞ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞‰∏∫ OC Â§ÑÁêÜÂÆå JS ÁöÑË∞ÉÁî®ÂêéÂØπ JS ÁöÑÂõûË∞É„ÄÇ JS Ê≥®ÂÜåÊ≥®ÂÜåÂ•ΩÊèê‰æõÁªô JS ÁöÑÊñπÊ≥ïÂêéÔºåOC ‰ºöÊâßË°å loadRequest ÁúüÊ≠£ÁöÑÊâßË°å js ‰ª£Á†Å„ÄÇÊàë‰ª¨Âú® js ‰∏≠Ê≥®ÂÖ•ÁöÑÂàùÂßãÂåñÊñπÊ≥ï setupWebViewJavascriptBridge Â∞±‰ºöË¢´ÊâßË°å: 12345678910111213141516171819202122function setupWebViewJavascriptBridge (callback) &#123; // Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî®ÁöÑÊó∂ÂÄô window.WebViewJavascriptBridge Âíå WVJBCallbacks ËøòÊ≤°ÊúâÂàùÂßãÂåñÂ•ΩÔºåÊâÄ‰ª•‰∏ç‰ºöË∞ÉÁî® if (window.WebViewJavascriptBridge) &#123; return callback(WebViewJavascriptBridge) &#125; if (window.WVJBCallbacks) &#123; return window.WVJBCallbacks.push(callback) &#125; window.WVJBCallbacks = [callback] // ÂºÄÂêØ‰∏Ä‰∏™ iframeÔºåÂä†ËΩΩËøôÊÆµ URL 'wvjbscheme://__BRIDGE_LOADED__' // ÂÖ∂ÁõÆÁöÑÊòØ‰∏∫‰∫ÜËß¶Âèë WebViewJavascriptBridge_JS.m Êñá‰ª∂ÂÜÖÂÆπÁöÑÂä†ËΩΩ var WVJBIframe = document.createElement('iframe') WVJBIframe.style.display = 'none' WVJBIframe.src = 'https://__bridge_loaded__' document.documentElement.appendChild(WVJBIframe) setTimeout(function () &#123; document.documentElement.removeChild(WVJBIframe) &#125;, 0)&#125;setupWebViewJavascriptBridge(function (bridge) &#123; var uniqueId = 1 bridge.registerHandler('testJavascriptHandler', function (data, responseCallback) &#123; var responseData = &#123; 'Javascript Says': 'Right back atcha!' &#125; responseCallback(responseData) &#125;)&#125;) ËøôÈáå‰∏ªË¶ÅÂÅö‰∫Ü‰∏§‰ª∂‰∫ãÔºö Â∞Ü‰º†ËøõÊù•ÁöÑ js ÂàùÂßãÂåñÊàêÂäüÂêéÈúÄË¶ÅÊâßË°åÁöÑÊñπÊ≥ïÔºå‰øùÂ≠òÂà∞ window.WVJBCallbacks ‰∏≠ÔºåÁ≠âÂà∞ÂêéÈù¢ JS Á´ØÁöÑ bridge ÂàùÂßãÂåñÊàêÂäüÂêéÔºåÂÜçÂèñÂá∫Êù•Ë∞ÉÁî® ÈÄöËøáÊ∑ªÂä†‰∏Ä‰∏™ iframe Âä†ËΩΩÂàùÂßãÂåñÈìæÊé• https://__bridge_loaded__ÔºåË∞ÉËµ∑ÂéüÁîüÔºåÁÑ∂ÂêéÂÜçÁßªÈô§Ëøô‰∏™ iframe native Êã¶Êà™ iframe ÁöÑ requestjs Á´Ø‰∏∫‰∫ÜÂàùÂßãÂåñ bridgeÔºåÈÄöËøá iframe ÂèëËµ∑‰∫Ü‰∏Ä‰∏™ https://__bridge_loaded__ ÁöÑËØ∑Ê±Ç„ÄÇnative Á´Ø‰ºöÂèóÂà∞Áõ∏Â∫îÁöÑË∑≥ËΩ¨ÂõûË∞ÉÔºö 123456789101112131415161718192021222324- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandler &#123; if (webView != _webView) &#123; return; &#125; NSURL *url = navigationAction.request.URL; __strong typeof(_webViewDelegate) strongDelegate = _webViewDelegate; if ([_base isWebViewJavascriptBridgeURL:url]) &#123; if ([_base isBridgeLoadedURL:url]) &#123; // ÂàùÂßãÂåñ bridge [_base injectJavascriptFile]; &#125; else if ([_base isQueueMessageURL:url]) &#123; [self WKFlushMessageQueue]; &#125; else &#123; [_base logUnkownMessage:url]; &#125; decisionHandler(WKNavigationActionPolicyCancel); return; &#125; if (strongDelegate &amp;&amp; [strongDelegate respondsToSelector:@selector(webView:decidePolicyForNavigationAction:decisionHandler:)]) &#123; [_webViewDelegate webView:webView decidePolicyForNavigationAction:navigationAction decisionHandler:decisionHandler]; &#125; else &#123; decisionHandler(WKNavigationActionPolicyAllow); &#125;&#125; Âú®Ëøô‰∏™ÊñπÊ≥ï‰∏≠ÔºåÈÄöËøá [_base isBridgeLoadedURL: url] Âà§Êñ≠ÊòØÂê¶ÊòØÂà∂ÂÆöÁöÑÂä†ËΩΩ bridge ‰∏ìÁî®ÁöÑ URLÔºåÊù•ÂÜ≥ÂÆöÊòØÂê¶Ê≥®ÂÖ• JS ‰ª£Á†Å„ÄÇhttps://__bridge_loaded__ Ëøô‰∏™ URL Â∞±ÊòØÁî®Êù•Ê≥®ÂÖ• JS ÁöÑÔºå‰ºöÊâßË°å [_base injectJavascriptFile] ÊñπÊ≥ï„ÄÇ Ê≥®ÂÖ• JS Êñá‰ª∂ÔºåÂàùÂßãÂåñ JS Á´Ø bridgenative Ë∞ÉÁî® JS ÂàùÂßãÂåñ12345678910111213- (void)injectJavascriptFile &#123; NSString *js = WebViewJavascriptBridge_js(); // ÊâßË°åÂàùÂßãÂåñ JS Á´Ø bridge ÁöÑ js ‰ª£Á†Å [self _evaluateJavascript:js]; // Â¶ÇÊûúÂΩìÂâçÂ∑≤ÊúâÊ∂àÊÅØÈòüÂàóÂàôÈÅçÂéÜÂπ∂ÂàÜÂèëÊ∂àÊÅØÔºå‰πãÂêéÊ∏ÖÁ©∫Ê∂àÊÅØÈòüÂàó if (self.startupMessageQueue) &#123; NSArray* queue = self.startupMessageQueue; self.startupMessageQueue = nil; for (id queuedMessage in queue) &#123; [self _dispatchMessage:queuedMessage]; &#125; &#125;&#125; Ëøô‰∏™ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÂ∞±ÊòØÊâßË°å WebViewJavascriptBridge_js ‰∏≠ÂáÜÂ§áÂ•ΩÁöÑ JS„ÄÇ ÂàùÂßãÂåñ JSBridge ‰∏≠ÁöÑÂêÑ‰∏™ÂèòÈáèWebViewJavascriptBridge_js` ‰∏≠‰øùÂ≠ò‰∫ÜÂá†‰∏™ÂèòÈáèÔºö 123456789101112131415// Áî®Êù•ÂÉè native ÂèëÈÄÅËØ∑Ê±ÇÁöÑ iframe ÂÆû‰æãvar messagingIframe;// Ë¶ÅÂèëÈÄÅÁöÑÂêÑ‰∏™Ê∂àÊÅØÁöÑÊï∞ÁªÑÔºåÊØè‰∏™ÂØπË±°ÁöÑÁªìÊûÑ‰∏∫ &#123;handlerName: 'xxx', data: &#123;&#125;, responseId: 1&#125;var sendMessageQueue = [];// ‰øùÂ≠ò handlerName ‰ª•ÂèäÂØπÂ∫îÁöÑÂÆûÁé∞ÊñπÊ≥ïvar messageHandlers = &#123;&#125;;// native Âíå js Á´ØÁªü‰∏ÄÁöÑ‰∫ã‰ª∂ scheme Âíå hostvar CUSTOM_PROTOCOL_SCHEME = 'https';var QUEUE_HAS_MESSAGE = '__wvjb_queue_message__';// ‰øùÂ≠òÂÖ∑‰ΩìÁöÑ js Á´ØË∞ÉÁî® oc ‰πãÂêéÔºåÈúÄË¶ÅÁöÑÂõûË∞ÉÊñπÊ≥ïvar responseCallbacks = &#123;&#125;;// ÊØè‰∏™ÂõûË∞ÉÈÉΩÈúÄË¶ÅÁöÑÁã¨‰∏ÄÊó†‰∫åÁöÑ idvar uniqueId = 1; window.WebViewJavascriptBridgeWebViewJavascriptBridge_js Ëøò‰∏∫ window ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ WebViewJavascriptBridge ÂØπË±°„ÄÇÂÖ∂‰∏≠ÂåÖÂê´‰∫ÜÂá†‰∏™ÊñπÊ≥ïÔºö 1234567window.WebViewJavascriptBridge = &#123; registerHandler: registerHandler, callHandler: callHandler, disableJavscriptAlertBoxSafetyTimeout: disableJavscriptAlertBoxSafetyTimeout, _fetchQueue: _fetchQueue, _handleMessageFromObjC: _handleMessageFromObjC&#125;; registerHandlerregisterHandler(handlerName, handler) Áî®Êù•Êèê‰æõÁªô JS Ê≥®ÂÜå handerÔºå‰ª•‰æõ OC Ë∞ÉÁî®ÔºåÊ≥®ÂÜåÁöÑÊñπÊ≥ïÈÉΩ‰ºö‰øùÂ≠òÂú® messageHandlers Â≠óÂÖ∏‰∏≠Ôºö 123function registerHandler(handlerName, handler) &#123; messageHandlers[handlerName] = handler;&#125; callHandlercallHandler(handlerName, data, responseCallback)ÔºöJS ‰∏ªÂä®Ë∞ÉÁî® OC Êèê‰æõÁöÑ handler ÁöÑÊñπÊ≥ï„ÄÇ 12345678910111213function callHandler(handlerName, data, responseCallback) &#123; _doSend(&#123; handlerName:handlerName, data:data &#125;, responseCallback);&#125;function _doSend(message, responseCallback) &#123; if (responseCallback) &#123; var callbackId = 'cb_'+(uniqueId++)+'_'+new Date().getTime(); responseCallbacks[callbackId] = responseCallback; message['callbackId'] = callbackId; &#125; sendMessageQueue.push(message); messagingIframe.src = CUSTOM_PROTOCOL_SCHEME + '://' + QUEUE_HAS_MESSAGE;&#125; ÊääÊñπÊ≥ïÂêçÂíåÂèÇÊï∞ÁîüÊàê‰∏Ä‰∏™Ê∂àÊÅØÂØπË±°ÔºåÊîæÂà∞ sendMessageQueue Êï∞ÁªÑ‰∏≠ÔºåÂêåÊó∂Âä†ËΩΩ URL Ë∞ÉËµ∑ÂéüÁîü„ÄÇÂ¶ÇÊûúÊúâÂõûË∞ÉÁöÑ blockÔºåÈÇ£‰πàÈÄöËøá uniqueId ÁîüÊàê‰∏Ä‰∏™ callbackIdÔºå‰πü‰øùÂ≠òÂà∞Ê∂àÊÅØÂØπË±°‰∏≠„ÄÇ disableJavscriptAlertBoxSafetyTimeout123function disableJavscriptAlertBoxSafetyTimeout() &#123; dispatchMessagesWithTimeoutSafety = false;&#125; ÊòØÂê¶Á¶ÅÁî®ÂºÇÊ≠•Ë∞ÉÁî®„ÄÇÂ¶ÇÊûúËÆæÁΩÆ‰∏∫ false„ÄÇÈÇ£‰πànative Á´ØË∞ÉÁî® js ÁöÑËØùÂ∞ÜÊòØÂêåÊ≠•ÁöÑ„ÄÇÊàë‰ª¨ÂèØ‰ª•Âú®‰∏ãÈù¢ÁöÑ _handleMessageFromObjC ÊñπÊ≥ï‰∏≠ÁúãÂà∞Áõ∏ÂÖ≥ÈÄªËæë„ÄÇ _fetchQueueËé∑ÂèñÊâÄÊúâÁöÑÊ∂àÊÅØÈòüÂàóÔºåËΩ¨‰∏∫Â≠óÁ¨¶‰∏≤ËøîÂõûÔºåÁÑ∂ÂêéÊ∏ÖÁ©∫Ê∂àÊÅØÈòüÂàó 12345function _fetchQueue() &#123; var messageQueueString = JSON.stringify(sendMessageQueue); sendMessageQueue = []; return messageQueueString;&#125; _handleMessageFromObjCËøô‰∏™ÊñπÊ≥ï‰ºöË¢´ native Ë∞ÉÁî®ÔºåÁî®Êù•Â§ÑÁêÜ native ‰º†ÈÄíËøáÊù•ÁöÑ‰∫ã‰ª∂ 1234567891011121314151617181920212223242526272829303132333435363738394041function _handleMessageFromObjC(messageJSON) &#123; _dispatchMessageFromObjC(messageJSON);&#125;function _dispatchMessageFromObjC(messageJSON) &#123; // Âà§Êñ≠ÊòØÂê¶ÊòØÂºÇÊ≠•Ë∞ÉÁî®„ÄÇÂ¶ÇÊûúÊòØÂºÇÊ≠•Ë∞ÉÁî®ÂàôÈÄöËøá setTimeout Â∞ÜÊñπÊ≥ïÂª∂ÂêéË∞ÉÁî®„ÄÇÂê¶ÂàôÁõ¥Êé•ÊâßË°å„ÄÇÁî±‰∫é javascript ÊòØÂçïÁ∫øÁ®ãÁöÑÂéüÂõ†Ôºå‰ºöÈòªÂ°ûÂéüÊúâ js ‰ª£Á†ÅÁöÑÊâßË°å„ÄÇ if (dispatchMessagesWithTimeoutSafety) &#123; setTimeout(_doDispatchMessageFromObjC); &#125; else &#123; _doDispatchMessageFromObjC(); &#125; function _doDispatchMessageFromObjC() &#123; var message = JSON.parse(messageJSON); var messageHandler; var responseCallback; if (message.responseId) &#123; responseCallback = responseCallbacks[message.responseId]; if (!responseCallback) &#123; return; &#125; responseCallback(message.responseData); delete responseCallbacks[message.responseId]; &#125; else &#123; if (message.callbackId) &#123; var callbackResponseId = message.callbackId; responseCallback = function(responseData) &#123; _doSend(&#123; handlerName:message.handlerName, responseId:callbackResponseId, responseData:responseData &#125;); &#125;; &#125; var handler = messageHandlers[message.handlerName]; if (!handler) &#123; console.log("WebViewJavascriptBridge: WARNING: no handler for message from ObjC:", message); &#125; else &#123; handler(message.data, responseCallback); &#125; &#125; &#125;&#125; Ëß£Êûê‰ªé native ‰º†Êù•ÁöÑ messageJSONÔºåÂ¶ÇÊûúÂ≠òÂú® responseId Ëøô‰∏™Â≠óÊÆµÔºåËØ¥ÊòéÊòØ‰πãÂâç js Ë∞ÉÁî® native ÂêéÁöÑÂõûË∞ÉÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÂú®Ëá™Â∑±ÁöÑ responseCallbacks ÊâæÂØπÂ∫îÁöÑÂõûË∞ÉÊñπÊ≥ïÔºåÁÑ∂ÂêéÊâßË°å„ÄÇÊâßË°åÂÆåÊØïÂêéÈÄöËøá delete Âà†Èô§„ÄÇ Â¶ÇÊûúÂ≠òÂú® callbackId Â≠óÊÆµÔºåËØ¥Êòé JS Âú®Â§ÑÁêÜÂ•Ω native ÁöÑË∞ÉÁî®ÂêéÔºåËøòÈúÄË¶ÅÂõûË∞É native ÁöÑÊñπÊ≥ï„ÄÇÊâÄ‰ª•Â∞±ÂÖàÂàõÂª∫‰∏Ä‰∏™ callback ÁöÑÈó≠ÂåÖÔºåÊääÂøÖË¶ÅÁöÑ‰ø°ÊÅØÈÉΩÂ≠òÂà∞Ëøô‰∏™Èó≠ÂåÖ‰∏≠„ÄÇÁÑ∂ÂêéÂú® messageHandlers ‰∏≠ÊâæÂØπÂ∫îÁöÑÂ§ÑÁêÜÊñπÊ≥ïÔºåÊääË∞ÉÁî®ÁöÑÊï∞ÊçÆÂíåÂõûË∞ÉÈó≠ÂåÖ‰º†ÂÖ•ÊâßË°å„ÄÇ ÂàõÂª∫ÂèëÈÄÅÊ∂àÊÅØÁöÑ iframe12345// ÂàõÂª∫ iframeÔºåÁî®Êù•Âä†ËΩΩ URL ÂèëÈÄÅÊ∂àÊÅØÁªô NativemessagingIframe = document.createElement('iframe');messagingIframe.style.display = 'none';messagingIframe.src = CUSTOM_PROTOCOL_SCHEME + '://' + QUEUE_HAS_MESSAGE; // https://__wvjb_queue_message__document.documentElement.appendChild(messagingIframe); ÊâßË°å bridge ÂàõÂª∫ÂÆåÊàêÁöÑÂõûË∞ÉÂà∞Ëøô‰∏ÄÊ≠•Ôºåjs Á´ØÁöÑ bridge Âü∫Êú¨ÂàõÂª∫ÂÆåÊØï‰∫ÜÔºåÁé∞Âú®Â∞±ÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™ bridge Ê≥®ÂÜåÊèê‰æõÁªô oc ÁöÑÊñπÊ≥ï‰∫Ü„ÄÇÊâßË°å windows.WVJSCallbacks Êï∞ÁªÑ‰∏≠‰øùÂ≠òÁöÑÂêÑ‰∏™ÂõûË∞É„ÄÇ 12345678setTimeout(_callWVJBCallbacks, 0);function _callWVJBCallbacks() &#123; var callbacks = window.WVJBCallbacks; delete window.WVJBCallbacks; for (var i=0; i&lt;callbacks.length; i++) &#123; callbacks[i](WebViewJavascriptBridge); &#125;&#125; ËøôÈáåÂèØ‰ª•ÁúãÂà∞Ôºå‰∏öÂä°Á´ØË¶ÅÊâßË°åÁöÑÂõûË∞ÉÊñπÊ≥ï WVJSCallbacks Êó†Ê≥ïÁõ¥Êé•‰º†Áªô WebViewJavaScriptBridge_JS ÔºåÊâÄ‰ª•Â∞±ÈÄöËøáÊåÇËΩΩÂà∞ window ‰∏ãÁöÑÊñπÂºèÔºåËÆ©ÂêéËÄÖÂèñÂà∞„ÄÇ JS Ë∞ÉÁî®ÂéüÁîüJS Ë∞ÉÁî®ÂéüÁîüÁöÑÊñπÊ≥ï‰∏äÈù¢Â∑≤ÁªèÂàÜÊûêËøá‰∫ÜÔºåÂ∞±ÊòØ window.WebViewJavascriptBridgeÁöÑcallHandler ÊñπÊ≥ïÔºå‰ºöÊù•Âà∞ decidePolicyForNavigationAction ÊñπÊ≥ïÔºåÂπ∂‰∏îËøõÂÖ• WKFlushMessageQueue ÊñπÊ≥ï‰∏≠Ôºö 123456789101112131415161718- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandler &#123; if (webView != _webView) &#123; return; &#125; NSURL *url = navigationAction.request.URL; __strong typeof(_webViewDelegate) strongDelegate = _webViewDelegate; if ([_base isWebViewJavascriptBridgeURL:url]) &#123; if ([_base isBridgeLoadedURL:url]) &#123; [_base injectJavascriptFile]; &#125; else if ([_base isQueueMessageURL:url]) &#123; [self WKFlushMessageQueue]; &#125; else &#123; [_base logUnkownMessage:url]; &#125; decisionHandler(WKNavigationActionPolicyCancel); return; &#125; ...&#125; WKFlushMessageQueue ‰ºöÂÖàÂéª js Á´ØËé∑Âèñ js Á´ØË¶ÅÊâßË°åÁöÑ native ÁöÑÊâÄÊúâÊñπÊ≥ïÂêçÂíåÂèÇÊï∞ÔºåÁÑ∂ÂêéÊâßË°å _base ‰∏≠ÁöÑ flushMessageQueue ÊñπÊ≥ïÔºö 12345678- (void)WKFlushMessageQueue &#123; [_webView evaluateJavaScript:[_base webViewJavascriptFetchQueyCommand] completionHandler:^(NSString* result, NSError* error) &#123; if (error != nil) &#123; NSLog(@"WebViewJavascriptBridge: WARNING: Error when trying to fetch data from WKWebView: %@", error); &#125; [_base flushMessageQueue:result]; &#125;];&#125; flushMessageQueue ÊñπÊ≥ï‰ºöÂÖàÊää‰ªé JS Á´Ø‰º†Êù•ÁöÑÂ≠óÁ¨¶‰∏≤ËΩ¨‰∏∫ÂØπË±°Êï∞ÁªÑÔºåÁÑ∂ÂêéÂú®Ëá™Ë∫´Ê≥®ÂÜåÁöÑ messageHandlers ‰∏≠ÊâæÂØπÂ∫îÁöÑÂ§ÑÁêÜÊñπÊ≥ïÊâßË°å„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142- (void)flushMessageQueue:(NSString *)messageQueueString&#123; // Êää js Á´Ø‰º†Êù•ÁöÑ String ËΩ¨‰∏∫Êï∞ÁªÑÂØπË±° id messages = [self _deserializeMessageJSON:messageQueueString]; for (WVJBMessage* message in messages) &#123; ... NSString* responseId = message[@"responseId"]; if (responseId) &#123; // Â≠òÂú® responseIdÔºåË°®ÊòéÊòØÂéüÊú¨ OC Ë∞ÉÁî®ÈúÄË¶ÅÁöÑ callback„ÄÇÂú® oc ÁöÑ responseCallback WVJBResponseCallback responseCallback = _responseCallbacks[responseId]; responseCallback(message[@"responseData"]); [self.responseCallbacks removeObjectForKey:responseId]; &#125; else &#123; WVJBResponseCallback responseCallback = NULL; NSString* callbackId = message[@"callbackId"]; // Â¶ÇÊûúÊúâ callbackId ËØ¥Êòé js Á´ØÈúÄË¶ÅÂõûË∞É if (callbackId) &#123; // ÂàõÂª∫‰∏Ä‰∏™ callback ÁöÑ blockÔºå‰º†ÂÖ• responseDataÔºåÁÑ∂ÂêéÊâæÂà∞ JS Á´ØÂìçÂ∫îÁöÑÂ§ÑÁêÜÊñπÊ≥ï responseCallback = ^(id responseData) &#123; if (responseData == nil) &#123; responseData = [NSNull null]; &#125; // ÊääÈúÄË¶ÅÂõûË∞ÉÁöÑ callbackId ‰Ωú‰∏∫ responseId Â≠òÂÖ• WVJBMessage* msg = @&#123; @"responseId":callbackId, @"responseData":responseData &#125;; [self _queueMessage:msg]; &#125;; &#125; else &#123; responseCallback = ^(id ignoreResponseData) &#123; // Do nothing &#125;; &#125; WVJBHandler handler = self.messageHandlers[message[@"handlerName"]]; if (!handler) &#123; NSLog(@"WVJBNoHandlerException, No handler for message from JS: %@", message); continue; &#125; // ÊâßË°å handler ÊñπÊ≥ï handler(message[@"data"], responseCallback); &#125; &#125;&#125; _queueMessage ÊñπÊ≥ïÂ∞ÜÂú®‰∏ãÈù¢ÁöÑÂéüÁîüË∞ÉÁî® JS ‰∏≠ÂàÜÊûê ÂéüÁîüË∞ÉÁî® JSÂéüÁîüË∞ÉÁî® JSÔºåbridge ÂÖàË∞ÉÁî® _base ‰∏≠ÁöÑÁõ∏ÂÖ≥Â§ÑÁêÜÊñπÊ≥ï: 1234// WKWebViewJavascriptBridge.m- (void)callHandler:(NSString *)handlerName data:(id)data responseCallback:(WVJBResponseCallback)responseCallback &#123; [_base sendData:data responseCallback:responseCallback handlerName:handlerName];&#125; _base ‰∏≠Êää data callbackId handlerName ËøôÂá†‰∏™ÂèÇÊï∞Â∞ÅË£Ö‰∏∫Â≠óÂÖ∏ÔºåÂÜçËΩ¨‰∏∫ JSONÂ≠óÁ¨¶‰∏≤„ÄÇÈöèÂêéÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÈÄöËøá evaluteJavascript ‰º†ÈÄíÁªôJSÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051// ÂèÇÊï∞ËΩ¨‰∏∫Â≠óÂÖ∏- (void)sendData:(id)data responseCallback:(WVJBResponseCallback)responseCallback handlerName:(NSString*)handlerName &#123; NSMutableDictionary* message = [NSMutableDictionary dictionary]; if (data) &#123; message[@"data"] = data; &#125; if (responseCallback) &#123; NSString* callbackId = [NSString stringWithFormat:@"objc_cb_%ld", ++_uniqueId]; self.responseCallbacks[callbackId] = [responseCallback copy]; message[@"callbackId"] = callbackId; &#125; if (handlerName) &#123; message[@"handlerName"] = handlerName; &#125; [self _queueMessage:message];&#125;- (void)_queueMessage:(WVJBMessage*)message &#123; if (self.startupMessageQueue) &#123; [self.startupMessageQueue addObject:message]; &#125; else &#123; [self _dispatchMessage:message]; &#125;&#125;// Â≠óÂÖ∏ËΩ¨‰∏∫ JSON Âπ∂ÊâßË°å- (void)_dispatchMessage:(WVJBMessage*)message &#123; NSString *messageJSON = [self _serializeMessage:message pretty:NO]; [self _log:@"SEND" json:messageJSON]; messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@"\\" withString:@"\\\\"]; messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@"\"" withString:@"\\\""]; messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@"\'" withString:@"\\\'"]; messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@"\n" withString:@"\\n"]; messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@"\r" withString:@"\\r"]; messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@"\f" withString:@"\\f"]; messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@"\u2028" withString:@"\\u2028"]; messageJSON = [messageJSON stringByReplacingOccurrencesOfString:@"\u2029" withString:@"\\u2029"]; NSString* javascriptCommand = [NSString stringWithFormat:@"WebViewJavascriptBridge._handleMessageFromObjC('%@');", messageJSON]; if ([[NSThread currentThread] isMainThread]) &#123; [self _evaluateJavascript:javascriptCommand]; &#125; else &#123; dispatch_sync(dispatch_get_main_queue(), ^&#123; [self _evaluateJavascript:javascriptCommand]; &#125;); &#125;&#125; ÂèØ‰ª•ÂèëÁé∞ÔºåËΩ¨ÂåñÂêéÁöÑ JSON ‰Ωú‰∏∫ WebViewJavascriptBridge._handleMessageFromObjC(&#39;%@&#39;) ÁöÑÂèÇÊï∞‰º†ÂÖ• JS„ÄÇËá≥Ê≠§ÔºåÂéüÁîüË∞ÉÁî® JS ÁöÑËøáÁ®ã‰πüÁªìÊùü‰∫Ü„ÄÇ Âá†‰∏™ÈóÆÈ¢ò js Á´ØËøòÊ≤°ÊúâÂàùÂßãÂåñÂÆåÊàêÔºånative Â∞±ÂèëÈÄÅÁöÑÊ∂àÊÅØÂ¶Ç‰ΩïÂ§ÑÁêÜÔºü WebViewJavaScriptBridge Êèê‰æõ‰∫Ü‰∏Ä‰∏™ startupMessageQueue Áî®‰∫é‰øùÂ≠òÂú® JS ËøòÊ≤°ÊúâÂàùÂßãÂåñÂÆåÊàêÊó∂ÂÄôÁöÑ Native Ê∂àÊÅØÈòüÂàó„ÄÇÂú® JS ÂàùÂßãÂåñÁöÑ‰ª£Á†ÅÊâßË°åÂÆåÂêéÔºå‰ºöÁ´ãÂç≥ÊâßË°å startupMessageQueue ‰∏≠‰øùÂ≠òÁöÑÊ∂àÊÅØÔºåÁÑ∂ÂêéÊää startupMessageQueue ÈòüÂàóÁΩÆ‰Ωç nilÔºå‰πãÂêéÁöÑÊ∂àÊÅØÂ∞±‰∏ç‰ºö‰øùÂ≠òÂà∞ startupMessageQueue ‰∏≠‰∫Ü„ÄÇ js Âíå native Áõ∏‰∫íÈÄö‰ø°ÁöÑÊñπÂºèÊòØÊÄéÊ†∑Ôºü js Á´ØÂ≠òÂú®‰∏Ä‰∏™ sendMessageQueue ÈòüÂàóÔºåÁî®‰∫éÂ≠òÊîæ js ÈúÄË¶ÅÊâßË°åÁöÑÊ∂àÊÅØÈòüÂàóÔºåÁÑ∂ÂêéÈÄöÁü• native Âà∞Ëøô‰∏™Ê∂àÊÅØÈòüÂàó‰∏≠ÊãøÊ∂àÊÅØ„ÄÇnative Á´ØÈúÄË¶ÅÂèëÈÄÅÊ∂àÊÅØÁöÑÊó∂ÂÄôÔºåÂàôÊòØÁõ¥Êé•ÊâßË°å evaluateJavascript„ÄÇËøôÊòØÂõ†‰∏∫ÊâßË°å js Á´ØÁöÑÊ∂àÊÅØÊó∂ÂºÇÊ≠•ÁöÑÔºåÊâßË°åÊúüÈó¥ÂèØËÉΩÊúâÂÖ∂‰ªñÊ∂àÊÅØÂèëÁîüÔºåËÄå native ÁöÑ evalutejavascript ÊòØÂêåÊ≠•ÁöÑÔºåÂè™ÊúâÊâßË°åÂÆåËøô‰∏™ÊñπÊ≥ïÔºå native Êâç‰ºöÁªßÁª≠ÊâßË°å„ÄÇ ‰∏∫‰ªÄ‰πàWebViewJavascriptBridge ‰∏≠ JS Ë∞ÉÁî®ÂéüÁîüÊó∂ÔºåÊääË¶Å‰º†ÁªôÂéüÁîüÁöÑÊï∞ÊçÆÊîæÂà∞ messageQueue ‰∏≠ÔºåÂÜçËÆ©ÂéüÁîüË∞É JS ÂéªÂèñÔºåËÄå‰∏çÊòØÁõ¥Êé•ÊãºÂú® URL ÂêéÈù¢Ôºü URL Â§™Èïø‰ºö‰∏¢Êï∞ÊçÆ„ÄÇÂ∞§ÂÖ∂ÊòØÂØπÂèÇÊï∞ËøõË°å base64 ÁºñÁ†ÅÔºå‰ª•‰øùËØÅ url ‰∏≠‰∏ç‰ºöÂá∫Áé∞‰∏Ä‰∫õÈùûÊ≥ïÁöÑÂ≠óÁ¨¶ÁöÑÊó∂ÂÄô„ÄÇÂ¶ÇÊûúÂèÇÊï∞ÊòØ‰∏Ä‰∏™ÂæàÂ§çÊùÇÁöÑÂØπË±°ÔºåÈÇ£‰πàËøô‰∏™ url ÁöÑÁºñËß£Á†ÅÂ∞Ü‰ºöÂæàÂ§çÊùÇ„ÄÇ WebViewJavascriptBridge ‰∏≠Âä†ËΩΩ URL Ë∞ÉËµ∑ÂéüÁîüÊó∂Ôºå‰∏∫‰ªÄ‰πà‰∏çÊòØÁî® window.location=&quot;https://xxx&quot; ËøôÁßçÂΩ¢ÂºèÔºåËÄåÊòØÊñ∞Ê∑ªÂä†‰∏Ä‰∏™ iframe Êù•Âä†ËΩΩËøô‰∏™ URLÔºü Â¶ÇÊûúÊàë‰ª¨ËøûÁª≠ 2 ‰∏™ js Ë∞É nativeÔºåËøûÁª≠ 2 Ê¨°Êîπ window.location ÁöÑËØùÔºåÂú® native ÁöÑ delegate ÊñπÊ≥ï‰∏≠ÔºåÂè™ËÉΩÊà™Ëé∑ÂêéÈù¢ÈÇ£Ê¨°ËØ∑Ê±ÇÔºåÂâç‰∏ÄÊ¨°ËØ∑Ê±ÇÁî±‰∫éÂæàÂø´Ë¢´ÊõøÊç¢ÊéâÔºåÊâÄ‰ª•Ë¢´ÂøΩÁï•Êéâ‰∫Ü„ÄÇ Êää native Êèê‰æõÁªô js ÁöÑÊñπÊ≥ïÈÉΩÊ≥®ÂÜåÂà∞ handler ‰∏≠ÔºåÂΩìÊñπÊ≥ïÂ§öÁöÑÊó∂ÂÄôÔºå‰∏çÊòì‰∫é‰ª£Á†ÅÁÆ°ÁêÜ„ÄÇËØ•Â¶Ç‰ΩïË∞ÉÊï¥‰Ωø‰∏çÂêåÁ±ªÂûãÁöÑÊñπÊ≥ïÁöÑËÅåË¥£ÂàÜÂ∑•Êõ¥Âä†ÊòéÁ°ÆÔºü ‰∏çÁõ¥Êé•Ê≥®ÂÜåÊâÄÊúâÁöÑÊñπÊ≥ïÔºåËÄåÊòØÂè™Ê≥®ÂÜå‰∏Ä‰∏™ÊñπÊ≥ïÔºåÊâÄÊúâ js Ë∞ÉÁî®ÈÉΩÁªèËøáËøô‰∏™ËÄåÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïÂÜÖÈÉ®‰ΩøÁî® runtime Âä®ÊÄÅËΩ¨ÂèëÂÆûÁé∞„ÄÇÂõ†Ê≠§Ôºåjs Á´ØË∞ÉÁî® native ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÈúÄË¶Å‰º†ÈÄíÁ±ªÂêçÂíåÊñπÊ≥ïÂêç„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WKWebView ‰ΩøÁî®Ôºà‰∫åÔºâ‚Äî‚Äî Â∏∏ËßÅÈóÆÈ¢ò]]></title>
    <url>%2F2018%2F08%2F31%2FWKWebView2%2F</url>
    <content type="text"><![CDATA[ËÆ∞ÂΩï‰∏Ä‰∏ã WKWebView Áõ∏ÂÖ≥‰ΩøÁî® Cookie ÁÆ°ÁêÜloadRequest Êó† CookieWKWebView ‰∏ç‰ºöÂú®ËØ∑Ê±ÇÁöÑÊó∂ÂÄôËá™Âä®Âà∞ NSHTTPCookieStorage ‰∏≠Ëé∑Âèñ cookie(UIWebView ÂèØ‰ª•)„ÄÇÊâÄ‰ª•ÈúÄË¶ÅÊàë‰ª¨Âú® loadRequest ÂâçÔºåÊâãÂä®‰ªé NSHTTPCookieStorage ‰∏≠ÊãøÂà∞ CookieÔºåÂπ∂Â∞ÜÂ§ÑÁêÜÂ•ΩÁöÑ Cookie StringÂú® request header ‰∏≠ËÆæÁΩÆ Cookie, Ëß£ÂÜ≥È¶ñ‰∏™ËØ∑Ê±Ç Cookie Â∏¶‰∏ç‰∏äÁöÑÈóÆÈ¢òÔºö 1234567891011121314151617181920212223242526272829303132333435NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http://www.baidu.com"]];// Ê†πÊçÆ Request ÁöÑ URLÔºåËé∑ÂèñÁõ∏Â∫îÁöÑ cookieNSArray *availableCookie = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:request.URL];// ÈáçÊñ∞ÂàõÂª∫‰∏Ä‰∏™ÂèØÂèòÊï∞ÁªÑNSMutableArray *cookieMarr = [NSMutableArray arrayWithArray:availableCookie];//Âà†Èô§ËøáÊúüÁöÑcookiefor (int i = 0; i &lt; cookieMarr.count; i++) &#123; NSHTTPCookie *cookie = [cookieMarr objectAtIndex:i]; if (!cookie.expiresDate) &#123; continue; &#125; /// cookie Êúâ expiresDateÔºåË∂ÖËøáÁöÑÂ∞± remove Êéâ if ([cookie.expiresDate compare:self.currentTime]) &#123; [cookieMarr removeObject:cookie]; i--; &#125;&#125;// Êää cookie ÁöÑ array ËΩ¨‰∏∫ string Á±ªÂûãfor (NSHTTPCookie *cookie in cookieArr) &#123; if ([cookie.name rangeOfString:@"'"].location != NSNotFound) &#123; continue; &#125; if (![validDomain hasSuffix:cookie.domain] &amp;&amp; ![cookie.domain hasSuffix:validDomain]) &#123; continue; &#125; NSString *value = [NSString stringWithFormat:@"%@=%@", cookie.name, cookie.value]; [marr addObject:value];&#125;NSString *cookie = [marr componentsJoinedByString:@";"];// ËÆæÁΩÆ request ÁöÑ cookie[request setValue:cookie forHTTPHeaderField:@"Cookie"];[self.webView loadRequest:request]; ÈáçÂÆöÂêëÁõ∏ÂÖ≥Ôºö ÂΩìÊúçÂä°Âô®ÂèëÁîüÈáçÂÆöÂêëÁöÑÊó∂ÂÄôÔºåÊ≠§Êó∂Á¨¨‰∏ÄÊ¨°Âú® RequestHeader ‰∏≠ÂÜôÂÖ•ÁöÑ Cookie ‰ºö‰∏¢Â§±ÔºåËøòÈúÄË¶ÅÈáçÊñ∞ÂØπÈáçÂÆöÂêëÁöÑ NSURLRequest ËøõË°å RequestHeader ÁöÑ Cookie Â§ÑÁêÜ ÔºåÁÆÄÂçïÁöÑËØ¥Â∞±ÊòØÂú® webView:decidePolicyForNavigationAction:decisionHandler: ÁöÑÊó∂ÂÄôÔºåÂà§Êñ≠Ê≠§Êó∂ Request ÊòØÂê¶Êúâ‰Ω†Ë¶ÅÁöÑ Cookie Ê≤°ÊúâÂ∞±CancelÊéâÔºå‰øÆÊîπRequest ÈáçÊñ∞ÂèëËµ∑„ÄÇ iOS 11 ‰∏≠ÂåÖÂê´ WKHTTPCookieStore Áõ∏ÂÖ≥ÁöÑ APIÔºåÂèØ‰ª•Ëß£ÂÜ≥ WKWebView Cookie ÁöÑÈóÆÈ¢ò„ÄÇ JS Âú®ÊâßË°åÁöÑÊó∂ÂÄô‰ΩøÁî® document.cookie ËØªÂèñ‰∏çÂà∞ cookieÂΩìÁîüÊàê Request ÂêéÔºåÈ°µÈù¢Âä†ËΩΩ‰πãÂâçÔºåÁªô WKWebView Ê≥®ÂÖ•ËÑöÊú¨Ôºå‰Ωøjs Á´ØÁöÑ cookie Âíå NSHTTPCookieStorage ÂêåÊ≠•Ôºö 1234567891011121314151617181920212223242526272829-(void)syncClientCookieScripts:(NSMutableURLRequest *)request&#123; if (!request.URL) &#123; return; &#125; NSArray *availableCookie = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:request.URL]; NSMutableArray *filterCookie = [[NSMutableArray alloc]init]; for (NSHTTPCookie * cookie in availableCookie) &#123; if (self.syncCookieMode) &#123; //httponlyÈúÄÊ±Ç‰∏çÂæóÂÜôÂÖ•js cookie if (!cookie.HTTPOnly) &#123; [filterCookie addObject:cookie]; &#125; &#125; &#125; // ÊãºÊé• JS ‰ª£Á†Å ÂØπ Client Side Ê≥®ÂÖ•Cookie NSDictionary *reqheader = [NSHTTPCookie requestHeaderFieldsWithCookies:filterCookie]; NSString *cookieStr = [reqheader objectForKey:@"Cookie"]; if (filterCookie.count &gt; 0) &#123; for (NSHTTPCookie *cookie in filterCookie) &#123; NSTimeInterval expiretime = [cookie.expiresDate timeIntervalSince1970]; NSString *js = [NSString stringWithFormat:@"document.cookie ='%@=%@;expires=%f';",cookie.name,cookie.value,expiretime]; WKUserScript *jsscript = [[WKUserScript alloc]initWithSource:js injectionTime:WKUserScriptInjectionTimeAtDocumentStart forMainFrameOnly:NO]; [self.userContentController addUserScript:jsscript]; &#125; &#125; return;&#125; User-AgentËÆæÁΩÆ UA Êúâ‰∏§ÁßçÊñπÂºèÔºå‰∏ÄÁßçÊòØÂÖ®Â±ÄÁöÑËÆæÁΩÆ UAÔºåËøòÊúâ‰∏ÄÁßçÊòØËÆæÁΩÆÂ±ÄÈÉ®ÁöÑ UA„ÄÇ ÂÖ®Â±Ä UAËÆæÁΩÆÂÖ®Â±Ä UA ÊòØÈÄöËøáÊääÂåÖÂê´ UserAgent ÁöÑÂ≠óÂÖ∏Â≠òÂÖ• NSUserDefaults ‰∏≠ÂéªÔºö 12 NSDictionary *dictionary = [[NSDictionary alloc] initWithObjectsAndKeys:appUserAgent, @"UserAgent", nil];[[NSUserDefaults standardUserDefaults] registerDefaults:dictionary]; Ëá™ÂÆö‰πâ UAiOS 9 ‰ª•‰∏äÊèê‰æõ‰∫ÜËá™ÂÆö‰πâ UA ÁöÑÊñπÂºèÔºåÊõ¥Âä†ÁÆÄÂçïÔºåÁõ¥Êé•Êàê‰∏∫‰∫Ü WKWebView ÁöÑ‰∏Ä‰∏™Â±ûÊÄßÔºö 1self.webView.customUserAgent = @&quot;WebViewDemo/1.0.0&quot;; Ëé∑ÂèñÁ≥ªÁªüÈªòËÆ§ UAÊúâÊó∂ÂÄôÔºåÊàë‰ª¨ÈúÄË¶ÅËá™ÂÆö‰πâ UA ÁöÑÂêåÊó∂ËøòÊÉ≥Ë¶ÅÊúâÁ≥ªÁªüÁöÑ UAÔºåÂç≥Âú®Á≥ªÁªü UA ÂêéÊ∑ªÂä†Ëá™Â∑±ÁöÑ UA„ÄÇËøôÂ∞±ÈúÄË¶ÅËé∑ÂèñÂà∞Á≥ªÁªüÁöÑ UA ‰∫Ü„ÄÇÂèØ‰ª•ÈÄöËøá UIWebView Ëé∑Âèñ UA Â≠óÁ¨¶‰∏≤Ôºö 123UIWebView *webView = [[UIWebView alloc] init];NSString *originalUserAgent = [webView stringByEvaluatingJavaScriptFromString:@"navigator.userAgent"];NSString *appUserAgent = [NSString stringWithFormat:@"%@-%@", originalUserAgent, customUserAgent]; Ëé∑ÂèñÂà∞ UAÔºåÂÜçÈÄöËøá‰∏äÈù¢‰∏§ÁßçÊñπÂºèËÆæÁΩÆÂÖ®Â±ÄÊàñËÄÖËá™ÂÆö‰πâ UA Âç≥ÂèØ„ÄÇ NSURLProtocol‰ªãÁªç‰∏Ä‰∏ã NSURLProtocol ÁöÑ‰ΩøÁî®ÊñπÂºè„ÄÇ Ê≥®ÂÜå NSURLProtocolÈ¶ñÂÖàË¶ÅÂàõÂª∫‰∏Ä‰∏™ NSURLProtocol ÁöÑÂ≠êÁ±ªÔºö 12@interface MYProtocol : NSURLProtocol@end ÁÑ∂ÂêéÂú®‰ªªÊÑèÊó∂ÂÄôÊ≥®ÂÜåÔºö 123- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; [NSURLProtocol registerClass:[YXNSURLProtocol class]];&#125; ÈáçÂÜô NSURLProtocol ‰∏≠ÁöÑÂá†‰∏™ÊñπÊ≥ïËøôÈáåÊ®°Êãü‰∏Ä‰∏™ÁúüÂÆûÁöÑ‰∏öÂä°Âú∫ÊôØÔºåÂ∞±ÊòØ WKWebView Âú®È¶ñÊ¨°ÈÄöËøá loadRequest ÂèëËµ∑ post ÁöÑ body ‰∏¢Â§±„ÄÇÂÖ∑‰ΩìÂéüÂõ†ËßÅ‰∏ãÈù¢ÁöÑ‰∏Ä‰∫õÈóÆÈ¢ò Ëß£ÂÜ≥ÊñπÊ°àÂ∞±ÊòØÂ∞ÜËØ∑Ê±ÇÁöÑ scheme ËÆæÁΩÆ‰∏∫‰∏Ä‰∏™ÁâπÊÆäÁöÑÂçèËÆÆÂ≠óÊÆµÔºåÂ¶ÇÊú¨‰æã‰∏≠ÁöÑ postÔºåÁÑ∂ÂêéÈÄöËøá NSURLProtocol Êã¶Êà™„ÄÇ ÊòØÂê¶Êã¶Êà™ Request123456789101112+ (BOOL)canInitWithRequest:(NSURLRequest *)request&#123; /// Â¶ÇÊûú scheme ÊòØ post ÈÇ£‰πàÊã¶Êà™ if ([request.URL.scheme isEqualToString:@"post"]) &#123; return YES; &#125; /// Â¶ÇÊûúÊòØÂ∑≤ÁªèÊã¶Êà™ËøáÁöÑÂ∞±ÊîæË°å if ([NSURLProtocol propertyForKey:@"HasIntercepted" inRequest:request]) &#123; return NO; &#125; return NO;&#125; Êú™Ë¢´Êã¶Êà™ÁöÑ Request Áõ¥Êé•ÊîæË°åÔºåÊã¶Êà™ÁöÑ Request ËøõÂÖ•‰∏ã‰∏Ä‰∏™ÊñπÊ≥ï ÈáçËÆæ NSURLRequestË¢´Êã¶Êà™ÁöÑ post ÂçèËÆÆÊù•Âà∞‰∏ãÈù¢ÁöÑÊñπÊ≥ï‰∏≠„ÄÇËøôÈáå‰ªé request.allHTTPHeaderFieldsÔºåÂç≥ request ÁöÑÊâÄÊúâÂ§¥‰ø°ÊÅØ‰∏≠ÔºåÊãøÂà∞ÂéüÊú¨ÁöÑ scheme ‰ª•ÂèäÂéüÊú¨ÁöÑ bodyParam„ÄÇÁÑ∂ÂêéÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑ RequestÔºåÊää body Âíå cookie Â°ûËøõÂéªÔºåËøîÂõûËøô‰∏™ RequestÔºö 12345678910111213141516171819202122232425262728293031323334+ (NSURLRequest *)canonicalRequestForRequest:(NSURLRequest *)request &#123; /// Áî±‰∫é WKWebView ÈÄöËøá loadRequest ÂèëËµ∑ÁöÑ post ËØ∑Ê±Ç body ‰ºö‰∏¢Â§±ÔºåÊâÄ‰ª•ËøôÈáåÈÄöËøá NSURLProtocol Êã¶Êà™ÔºåÁÑ∂ÂêéËá™Â∑±ÂèëÂá∫ request if ([request.URL.scheme isEqualToString:@"post"]) &#123; //Ëé∑ÂèñoldScheme NSString *originScheme = request.allHTTPHeaderFields[@"oldScheme"]; NSMutableString *urlString = [NSMutableString stringWithString:request.URL.absoluteString]; NSRange schemeRange = [urlString rangeOfString:request.URL.scheme]; [urlString replaceCharactersInRange:schemeRange withString:originScheme]; //Ê†πÊçÆÊñ∞ÁöÑurlStringÁîüÊàêÊñ∞ÁöÑrequest NSMutableURLRequest *newRequest = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:urlString]]; //Ëé∑ÂèñbodyParam NSString *bodyParam = request.allHTTPHeaderFields[@"bodyParam"]; NSData *bodyData =[bodyParam dataUsingEncoding:NSUTF8StringEncoding]; newRequest.HTTPMethod = @"POST"; newRequest.HTTPBody = bodyData; //Ëé∑Âèñcookie NSString *cookie = request.allHTTPHeaderFields[@"Cookie"]; [newRequest addValue:cookie forHTTPHeaderField:@"Cookie"]; [NSURLProtocol setProperty:@YES forKey:@"HasIntercepted" inRequest:newRequest]; return newRequest; &#125; return request;&#125; ËøôÈáåËøòË¶ÅÊ≥®ÊÑè‰∏ÄÁÇπÔºåÊàë‰ª¨Â∞ÜÊñ∞ÁîüÊàêÁöÑ Request Ê∑ªÂä†‰∏Ä‰∏™ HasIntercepted ÁöÑÊ†áËÆ∞„ÄÇËøôÊ†∑ÂÜçÈáçÊñ∞ËøõÂÖ• canInitWithRequest ÁöÑÊó∂ÂÄôÂ∞±‰ºöË¢´Áõ¥Êé•ÊîæË°å‰∫ÜÔºåÈò≤Ê≠¢Êó†ÈôêÂæ™ÁéØ„ÄÇ Âä†ËΩΩ RequestÊù•Âà∞‰∫ÜÊúÄÂêé‰∏ÄÊ≠•ÔºåËá™Ë°åÂàõÂª∫‰∏Ä‰∏™ NSURLSession Êù•ÂÆûÁé∞ÁΩëÁªúËØ∑Ê±ÇÔºö 12345678910111213141516171819- (void)startLoading &#123; NSURLSession *session = [NSURLSession sharedSession]; NSURLSessionDataTask *task = [session dataTaskWithRequest:self.request completionHandler:^(NSData * _Nullable data, NSURLResponse * _Nullable response, NSError * _Nullable error) &#123; if (!error) &#123; // ËØ∑Ê±ÇÊàêÂäü‰∫ÜÔºåÊää response Âíå data ÈÉΩËøîÂõûÂõûÂéª [[self client] URLProtocol:self didReceiveResponse:response cacheStoragePolicy:NSURLCacheStorageAllowed]; [self.client URLProtocol:self didLoadData:data]; [[self client] URLProtocolDidFinishLoading:self]; &#125;else&#123; [self.client URLProtocol:self didFailWithError:error]; &#125; &#125;]; [task resume]; self.dataTask = task;&#125;- (void)stopLoading &#123; [self.dataTask cancel];&#125; self.client Â∞±ÊòØÊìç‰ΩúÊúÄÂêéÊã¶Êà™ÁªìÊûúÁöÑÂÆû‰æãÔºåself.request Â∞±ÊòØ‰∏äÈù¢ÂàõÂª∫ÁöÑÊñ∞ÁöÑ Request„ÄÇÊï¥‰∏™Êã¶Êà™ËøáÁ®ãÂ∞±ÂÆåÊàê‰∫Ü„ÄÇ Êã¶Êà™ WKWebView ÁöÑËØ∑Ê±ÇWKWebView ÈªòËÆ§ÊòØÊó†Ê≥ïË¢´ NSURLProtocol Êã¶Êà™ÁöÑÔºå‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÁßÅÊúâ Api ÂÆûÁé∞Ôºö 1234567891011//Ê≥®ÂÜå[NSURLProtocol registerClass:[MyCustomURLProtocol class]];//ÂÆûÁé∞Êã¶Êà™ÂäüËÉΩClass cls = NSClassFromString(@"WKBrowsingContextController");SEL sel = NSSelectorFromString(@"registerSchemeForCustomProtocol:");if ([(id)cls respondsToSelector:sel]) &#123;#pragma clang diagnostic push#pragma clang diagnostic ignored "-Warc-performSelector-leaks" [(id)cls performSelector:sel withObject:@"myapp"];#pragma clang diagnostic pop&#125; ‰∏äÈù¢ÊòØ‰∏∫ WKWebView Ê≥®ÂÜå‰∫Ü‰∏Ä‰∏™ scheme ‰∏∫ myapp ÁöÑ NSURLProtocolÔºåÂØπ‰∫éË¶ÅÊã¶Êà™ http ÊàñËÄÖ https ËØ∑Ê±ÇÔºåÊç¢ÊàêÁõ∏Â∫î scheme Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ ÈíàÂØπËøô‰∏™ÈóÆÈ¢òÔºåiOS11 Êé®Âá∫‰∫ÜÊñ∞ÁöÑ API WKURLSchemeHandlerÔºåËÉΩÂ§üÊèê‰æõÊã¶Êà™ WKWebView ÁöÑÂäüËÉΩ„ÄÇ NSURLProtocol ÁöÑÂ∫îÁî®Âú∫ÊôØÈÄöËøáËá™ÂÆö‰πâÁöÑNSURLProtocolÔºåÊàë‰ª¨ÊãøÂà∞Áî®Êà∑ËØ∑Ê±ÇÁöÑrequest‰πãÂêéÔºåÊàë‰ª¨ÂèØ‰ª•ÂÅöÂæàÂ§ö‰∫ãÊÉÖ„ÄÇÊØîÂ¶ÇÔºö Ëá™ÂÆö‰πâËØ∑Ê±ÇÂíåÂìçÂ∫î ÁΩëÁªúÁöÑÁºìÂ≠òÂ§ÑÁêÜÔºàH5Á¶ªÁ∫øÂåÖ Âíå ÁΩëÁªúÂõæÁâáÁºìÂ≠òÔºâ ÈáçÂÆöÂêëÁΩëÁªúËØ∑Ê±Ç ËøáÊª§Êéâ‰∏Ä‰∫õÈùûÊ≥ïËØ∑Ê±Ç Á≠âÁ≠â‚Ä¶ ‰∏Ä‰∫õÈóÆÈ¢òÁôΩÂ±èÈóÆÈ¢òÂΩìWKWebViewÂä†ËΩΩÁöÑÁΩëÈ°µÂç†Áî®ÂÜÖÂ≠òËøáÂ§ßÊó∂Ôºå‰ºöÂá∫Áé∞ÁôΩÂ±èÁé∞Ë±°„ÄÇËß£ÂÜ≥ÊñπÊ°àÔºö 1234// ÂΩì WKWebView ÊÄª‰ΩìÂÜÖÂ≠òÂç†Áî®ËøáÂ§ßÔºåÈ°µÈù¢Âç≥Â∞ÜÁôΩÂ±èÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªü‰ºöË∞ÉÁî®‰∏äÈù¢ÁöÑÂõûË∞ÉÂáΩÊï∞- (void)webViewWebContentProcessDidTerminate:(WKWebView *)webView &#123; [webView reload]; //Âà∑Êñ∞Â∞±Â•Ω‰∫Ü&#125; WKWebView ‰∏äÈÄöËøá loadRequest ÂèëËµ∑ÁöÑ post ËØ∑Ê±Ç body Êï∞ÊçÆ‰ºö‰∏¢Â§±ËøôÊòØÂõ†‰∏∫ WKWebView ÊúâËá™Â∑±ÂçïÁã¨ÁöÑ‰∏ÄÊù°ËøõÁ®ã„ÄÇloadRequest ÂÖ∂ÂÆûÊòØÂ∞ÜËØ∑Ê±Ç‰ø°ÊÅØ‰ªéÂ∫îÁî®ËøõÁ®ã‰º†ÈÄíÁªô WKWebView ÊâÄÂú®ËøõÁ®ãÔºå‰ΩøÂÖ∂Â±ïÁ§∫ÁöÑËøáÁ®ã„ÄÇÁÑ∂ËÄåÔºåËãπÊûúÂá∫‰∫éËøõÁ®ãÈó¥ÈÄö‰ø°Âä†Âø´ÈÄüÂ∫¶ÁöÑËÄÉËôëÔºå‰∏¢ÂºÉ‰∫Ü post ËØ∑Ê±ÇÁöÑ body ‰ø°ÊÅØ„ÄÇ Ëß£ÂÜ≥ÊñπÊ°àÊòØÈÄöËøá NSURLProtocol Êã¶Êà™ RequestÔºåËøôÊ†∑ WKWebView ÂèàÊää post ËØ∑Ê±ÇÂõû‰º†Áªô‰∫Ü native„ÄÇÂèëÈÄÅËØ∑Ê±ÇÂâçÔºåÊääÂéüÊú¨ body ‰∏≠ÁöÑ‰ø°ÊÅØÊîæÂà∞ header ‰∏≠„ÄÇÁÑ∂ÂêéÁî± NSURLProtocol Êã¶Êà™ÔºåÁîüÊàêÊñ∞ÁöÑËØ∑Ê±ÇÔºåÂÆåÊàêÊï∞ÊçÆÂä†ËΩΩÔºåÊúÄÂêéÂ∞ÜËØ∑Ê±ÇÂæóÂà∞ÁöÑÊï∞ÊçÆËøîÂõû„ÄÇ ËØ¶ËßÅ‰∏äÈù¢ÁöÑ NSURLProtocol ‰ΩøÁî®‰ªãÁªçÔºåÊúâËØ¶ÁªÜÊ≠•È™§ËÆ≤Ëß£ WKWebView NSURLProtocol ÁöÑ post ËØ∑Ê±ÇÁöÑ body ‰∏∫Á©∫‰∏äÈù¢ loadRequest ÊòØ‰ªé app Â∞Ü post ËØ∑Ê±Ç‰º†Áªô WKWebViewÔºåËÄåÊ≠§‰æãÊòØÁî±‰∫é NSURLProtocol Êã¶Êà™ÔºåÈúÄË¶ÅÊää WKWebView ÁöÑ post ËØ∑Ê±Ç‰º†ÈÄíÁªô app Â§ÑÁêÜ„ÄÇÂõ†Ê≠§Ôºåpost ËØ∑Ê±ÇÁöÑ body ËøòÊòØ‰ºö‰∏¢Â§±„ÄÇ ÊâÄ‰ª•ÔºåËß£ÂÜ≥ÊñπÂºèËøòÊòØÂêå‰∏äÈù¢ loadRequest ‰∏ÄÊ†∑„ÄÇ ÊÄßËÉΩ‰ºòÂåñ‰ºòÂåñ‰∏ªË¶ÅÈõÜ‰∏≠Âú®‰ºòÂåñ WebView ÂàùÂßãÂåñÂíåÂáèÂ∞ë‰∏çÂøÖË¶ÅÁöÑËØ∑Ê±Ç„ÄÇ ÂÖ®Â±Ä WebView ‰∏é WebViewPoolwebview ‰ªé‰∏çÂ≠òÂú®Âà∞Â≠òÂú®ÁöÑËøáÁ®ãÔºåÁ≥ªÁªüÈúÄË¶ÅËøõË°å‰∏ÄÁ≥ªÂàóÂàùÂßãÂåñ„ÄÇÊâÄÊúâÂêéÁª≠ËøáÁ®ãÂú®ËøôÊÆµÊó∂Èó¥ÂÆåÂÖ®ÈòªÂ°û„ÄÇ ÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ WebViewPool ÁöÑÂçï‰æãÂØπË±°ÔºåÂú® load ÊñπÊ≥ï‰∏≠ÁõëÂê¨Â∫îÁî®ÂêØÂä®ÊàêÂäüÁöÑÈÄöÁü•Ôºö UIApplicationDidFinishLaunchingNotificationÔºåÂàùÂßãÂåñ Pool ÂØπË±°ÔºåÂπ∂‰∏îÂàùÂßãÂåñ‰ªªÊÑè‰∏™‰æõÂ§çÁî®ÁöÑ WebView ÂÆû‰æãÔºå‰πãÂêéÁöÑÂ§çÁî®ÂæàÂÉè TableView Cell ÁöÑÂ§çÁî®„ÄÇ ‰πãÂêé‰∏öÂä°‰∏äÁöÑÊâÄÊúâÁöÑ WebView ÂÆû‰æãÈÉΩ‰ªé WebViewPool ‰∏≠Êãø„ÄÇWebView ÈúÄË¶ÅÂ¢ûÂä†‰∏Ä‰∏™ holder ÁöÑÂº±ÂºïÁî®Â±ûÊÄßÊåáÂêëÂΩìÂâç VC„ÄÇÊØèÊ¨°Ë¶Å‰ªé WebViewPool ‰∏≠ÂèñÊñ∞ÁöÑ WebView ÂÆû‰æãÁöÑÊó∂ÂÄôÔºåÂ∞±Ë¶ÅÊü•Áúã‰∏ÄÈÅçÂì™‰∫õ WebView ÁöÑ holder ‰∏∫ nilÔºåË°®Á§∫ WebView ÊâÄÂú®ÁöÑ VC Â∑≤ÁªèË¢´ÂõûÊî∂ÔºåÊ≠§Êó∂Â∞±Ë¶ÅÊää WebView Áä∂ÊÄÅÊ∏ÖÁ©∫ÔºåÁÑ∂ÂêéÊîæÂÖ•Â§çÁî®Ê±†‰∏≠„ÄÇ ÂΩì WebView ÈúÄË¶ÅÊîæÂõûÂ§çÁî®Ê±†ÁöÑÊó∂ÂÄôÈúÄË¶ÅÂÅö‰∏§‰ª∂‰∫ãÔºå‰ª•ËææÂà∞ÂíåÊµèËßàÂô®Áõ∏ÂêåÁöÑÊïàÊûú Ê∑ªÂä†‰∏Ä‰∏™Á©∫ÁôΩÁöÑÈ°µÈù¢ ÊääËØ•È°µÈù¢‰πãÂâçÁöÑÊµèËßàËÆ∞ÂΩïÊ∏ÖÁ©∫ 123456789101112131415161718// ÁªßÊâø‰∫é WKWebView ÁöÑÁ±ª‰∏≠//Ë¢´ÂõûÊî∂- (void)webViewEndReuse&#123; // Âä†ËΩΩÁ©∫ÁôΩÈ°µÈù¢ÔºåÁ©∫Â≠óÁ¨¶‰∏≤‰ºöËá™Âä®Âä†‰∏Ä‰∏™Á©∫ÁôΩÈ°µÈù¢ [self loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@""]]]; // ‰ΩøÁî®ÁöÑÁßÅÊúâAPIÔºåÊâÄ‰ª•ÈÄöËøáÂ≠óÁ¨¶‰∏≤ÊãºÊé•ÁöÑÊñπÂºèËé∑ÂèñÊñπÊ≥ïÂêç // Ëøô‰∏™ÊñπÊ≥ï‰ºöÊääÈô§‰∫ÜÊúÄ‰∏äÈù¢ÁöÑÈ°µÈù¢ÈÉΩÊ∏ÖÁ©∫Êéâ„ÄÇÂõ†Ê≠§Ôºå‰ºöÊ∏ÖÁ©∫Èô§‰∫ÜÂàöÊ∑ªÂä†ÁöÑÁ©∫ÁôΩÈ°µÈù¢ÁöÑ‰πãÂâçÊâÄÊúâÁöÑÈ°µÈù¢Ôºå‰ΩøÈ°µÈù¢ÊÅ¢Â§çÂà∞ÊúÄÂºÄÂßãÊâìÂºÄÊó∂ÂÄôÁöÑÊ®°Ê†∑„ÄÇ SEL sel = NSSelectorFromString([NSString stringWithFormat:@"%@%@%@%@", @"_re", @"moveA",@"llIte", @"ms"]); if([self.backForwardList respondsToSelector:sel])&#123;#pragma clang diagnostic push#pragma clang diagnostic ignored "-Warc-performSelector-leaks" [self.backForwardList performSelector:sel];#pragma clang diagnostic pop &#125; &#125; webView Êï∞ÊçÆÈ¢ÑËØ∑Ê±ÇÂú®ÂÆ¢Êà∑Á´ØÂàùÂßãÂåñWebViewÁöÑÂêåÊó∂ÔºåÁõ¥Êé•Áî±nativeÂºÄÂßãÁΩëÁªúËØ∑Ê±ÇÊï∞ÊçÆ„ÄÇÂΩìÈ°µÈù¢ÂàùÂßãÂåñÂÆåÊàêÂêéÔºåÂêënativeËé∑ÂèñÂÖ∂‰ª£ÁêÜËØ∑Ê±ÇÁöÑÊï∞ÊçÆ„ÄÇÂ¶ÇÊûúÊ≠§Êó∂ native ËøòÊ≤°ÊúâÊãøÂà∞Êï∞ÊçÆÔºåÈÇ£‰πà js Á´ØÂÅö‰∏Ä‰∏™Áü≠ÊöÇÁöÑËΩÆËØ¢„ÄÇ ÂáèÂ∞ë‰∏çÂøÖË¶ÅÁöÑËØ∑Ê±ÇÂàÜ‰∏∫ÂâçÁ´Ø‰ºòÂåñÂíåÂÆ¢Êà∑Á´Ø‰ºòÂåñ ÂâçÁ´Ø‰ºòÂåñ Èôç‰ΩéËØ∑Ê±ÇÈáèÔºöÂêàÂπ∂ËµÑÊ∫êÔºåÂáèÂ∞ë HTTP ËØ∑Ê±ÇÊï∞Ôºå‰ΩøÁî® lazyLoadÔºå‰ΩøÁî® gzip ÂéãÁº©Ôºå‰ΩøÁî® webP Ê†ºÂºè Âä†Âø´ËØ∑Ê±ÇÈÄüÂ∫¶ÔºöÈ¢ÑËß£Êûê DNSÔºåÂáèÂ∞ëÂüüÂêçÊï∞Ôºå‰ΩøÁî®‰∏é Native ‰∏ÄÊ†∑ÁöÑÂüüÂêç ÁºìÂ≠òÔºö‰ΩøÁî® localStorageÔºåËØ¢ÈóÆÊòØÂê¶Êõ¥Êñ∞ Ê∏≤ÊüìÔºöÊúçÂä°Á´ØÊ∏≤Êüì ÂÆ¢Êà∑Á´Ø‰ºòÂåñNSURLProtocol Êã¶Êà™ËµÑÊ∫êËØ∑Ê±Ç ÂØπ‰∫é‰∏Ä‰∫õÂõæÁâáËµÑÊ∫êÊñá‰ª∂ÔºåÂèØ‰ª•ÈÄöËøá NSURLProtocol Êã¶Êà™ËØ∑Ê±ÇÔºåÁÑ∂ÂêéÊü•Êâæ native ÊòØÂê¶Â≠òÂú®ÁºìÂ≠òÔºåÊúâÁöÑËØùÁõ¥Êé•ËøîÂõû NSDataÔºåÊ≤°ÊúâÁöÑËØùÔºåÈÄöËøá native ÂèëËµ∑‰∏Ä‰∏™ËØ∑Ê±ÇÔºåÁºìÂ≠òÂπ∂ËøîÂõû NSData Âü∫‰∫é LocalWebServer ÂÆûÁé∞ÁöÑÁ¶ªÁ∫øËµÑÊ∫êÂä†ËΩΩ ÈÄöËøá NSURLProtocol ÂèØ‰ª•ÂÆûÁé∞ËµÑÊ∫êÁöÑÊú¨Âú∞Êã¶Êà™Âä†ËΩΩ„ÄÇËøòÊúâ‰∏ÄÁßçÈÄöËøáÊú¨Âú∞Ëµ∑‰∏Ä‰∏™ localserver ÁöÑÊñπÂºèÔºåÁõ¥Êé•Âä†ËΩΩÊú¨Âú∞ÁöÑËµÑÊ∫ê„ÄÇ ÂèØ‰ª•ÈÄâÁî®Â¶Ç CocoaHttpServer ËøôÊ†∑ÁöÑÁ¨¨‰∏âÊñπÂ∫ìÔºåÂú®Á¶ªÁ∫øËµÑÊ∫êÊâÄÂú®ÁöÑÁõÆÂΩïÂêØÂä®Êú¨Âú∞ÊúçÂä°„ÄÇËøôÊ†∑ÔºåÁΩëÈ°µ‰∏≠ÁöÑËµÑÊ∫êÔºåÂèØ‰ª•Áõ¥Êé•ÈÄöËøá http://localhost:[Á´ØÂè£Âè∑]/someResource.js ÁöÑÊñπÂºèÂä†ËΩΩ„ÄÇ ‰ΩÜÊòØËøôÊ†∑‰ºöÂºïËµ∑ ATS Áõ∏ÂÖ≥ÈóÆÈ¢òÔºåÂç≥Âú® Safari Âèä Apple WebKit ‰∏≠ÔºöÂú®httpsÈ°µÈù¢ÂÜÖÔºå‰∏çÂÖÅËÆ∏httpËØ∑Ê±ÇÂ≠òÂú®ÔºåÂê¶Âàô‰∏ÄÊ¶Ç‰ºöË¢´block„ÄÇÂõ†Ê≠§ÔºåÈúÄË¶ÅËá™Á≠æÂêç localhostÔºå‰ΩøÂÖ∂ÊîØÊåÅ https://localhost:[Á´ØÂè£Âè∑]/someResource.js ÔºåÂÖ∑‰Ωì‰ΩøÁî®ÂèØÂú®ÈúÄË¶ÅÁöÑÊó∂ÂÄôÊêúÁ¥¢Âà∞„ÄÇ Á¶ªÁ∫øÂåÖ Á¶ªÁ∫øÂåÖÂèØ‰ª•È¢Ñ‰∏ãËΩΩÔºånative Ê†πÊçÆÈÖçÁΩÆÔºåÂú®Êüê‰∏™ ËäÇÁÇπ‰∏ãËΩΩÁ¶ªÁ∫øÂåÖ„ÄÇ‰∏ãËΩΩÂ•ΩÁöÑÁ¶ªÁ∫øÂåÖÂêéÔºåÂ∞±ÂèØ‰ª•Êã¶Êà™ÁΩëÁªúËØ∑Ê±ÇÔºåÂØπ‰∫éÁ¶ªÁ∫øÂåÖÂ∑≤ÁªèÊúâÁöÑÊñá‰ª∂ÔºåÁõ¥Êé•ËØªÂèñÁ¶ªÁ∫øÂåÖÊï∞ÊçÆËøîÂõûÔºåÂê¶ÂàôËµ∞ HTTP ÂçèËÆÆÁºìÂ≠òÈÄªËæë„ÄÇ 12345678910111213141516171819202122232425262728293031//‰∏ãËΩΩÁ¶ªÁ∫øÂåÖhtml+css- (void)requestOfflinePkg &#123; NSString *zipName = @"offline_pkg"; NSString *zipUrl = [NSString stringWithFormat:@"http://localhost:9090/source/%@.zip", zipName]; NSURL *url = [NSURL URLWithString:zipUrl]; NSString *md5 = [self md5:zipUrl]; NSArray *pathes = NSSearchPathForDirectoriesInDomains(NSCachesDirectory,NSUserDomainMask,YES); NSString *path = [pathes objectAtIndex:0]; NSString *zipPath = [NSString stringWithFormat:@"%@/zipDownload/%@",path,md5]; NSString *unzipPath = [NSString stringWithFormat:@"%@/%@.zip",path,md5]; NSURLSession *session = [NSURLSession sharedSession]; NSURLSessionDataTask *task = [session dataTaskWithURL:url completionHandler:^(NSData * _Nullable data, NSURLResponse * _Nullable response, NSError * _Nullable error) &#123; if(!error) &#123; [data writeToFile:unzipPath options:0 error:nil]; BOOL result = [SSZipArchive unzipFileAtPath:unzipPath toDestination:zipPath]; //Ëß£ÂéãÁº©ÊàêÂäü if (result) &#123; //Âà†Èô§zip NSFileManager *fileManager = [NSFileManager defaultManager]; [fileManager removeItemAtPath:unzipPath error:nil]; &#125; &#125; &#125;]; [task resume];&#125; ÂèÇËÄÉÁßªÂä® H5 È¶ñÂ±èÁßíÂºÄ‰ºòÂåñÊñπÊ°àÊé¢ËÆ® ‰ªéÈõ∂Êî∂Êãæ‰∏Ä‰∏™hybridÊ°ÜÊû∂Ôºà‰∫åÔºâ‚Äì WebViewÂÆπÂô®Âü∫Á°ÄÂäüËÉΩËÆæËÆ°ÊÄùË∑Ø WebViewÊÄßËÉΩ„ÄÅ‰ΩìÈ™åÂàÜÊûê‰∏é‰ºòÂåñ Âü∫‰∫é LocalWebServer ÂÆûÁé∞ WKWebView Á¶ªÁ∫øËµÑÊ∫êÂä†ËΩΩ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Â¶Ç‰ΩïÂàõÂª∫ÁßÅÊúânpm]]></title>
    <url>%2F2018%2F08%2F13%2F%E5%88%9B%E5%BB%BA%E7%A7%81%E6%9C%89npm%2F</url>
    <content type="text"><![CDATA[ÂΩìÈúÄË¶Å‰ΩøÁî®npmÁÆ°ÁêÜÂåÖÔºåÂπ∂‰∏îËøô‰∫õÂåÖ‰∏çÈÄÇÂêàÊîæÂà∞ÂÖ¨ÁΩë‰∏äÊó∂ÔºåÂ∞±ÈúÄË¶ÅÊê≠Âª∫ÁßÅÊúânpm‰∫Ü„ÄÇÊê≠Âª∫ÁßÅÊúânpmÁöÑÊñπÂºèÂæàÂ§ö„ÄÇ‰∏ÄËà¨Êù•ËØ¥ÔºåÊØîËæÉÊé®Ëçê‰ΩøÁî® verdaccio„ÄÇËøôÊòØsinopia ÁöÑ fork„ÄÇsinopia Â∑≤ÁªèÂæà‰πÖÊ≤°ÊúâÊõ¥Êñ∞‰∫Ü„ÄÇ ÂáÜÂ§áÂ∑•‰ΩúÂÆâË£Ö‰ΩøÁî®ÂëΩ‰ª§Ë°åÂÆâË£ÖÔºö 1sudo npm install -g verdaccio --unsafe-perm ÂÆâË£ÖÂÆåÊØïÂêéÔºå‰ºöÂú®Áî®Êà∑ÁõÆÂΩï‰∏ãÁöÑ .config ÁõÆÂΩï‰∏ãÁîüÊàê‰∏Ä‰∏™ verdaccio Êñá‰ª∂Â§πÔºåÈÖçÁΩÆÊñá‰ª∂ config.yaml Â∞±Âú®Ëøô‰∏™Êñá‰ª∂Â§πÂÜÖ„ÄÇ ÂêØÂä®Áõ¥Êé•Âú®ÂëΩ‰ª§Ë°åÈîÆÂÖ• verdaccio ÂêØÂä®„ÄÇÊéßÂà∂Âè∞‰ºöÁ≠îÂ∫îÂá†Ë°åwarnÔºö 1234warn --- config file - /Users/zachary/.config/verdaccio/config.yamlwarn --- Plugin successfully loaded: htpasswdwarn --- Plugin successfully loaded: auditwarn --- http address - http://localhost:4873/ - verdaccio/3.5.1 ËøôÂÖ∂ÂÆûÊòØÊèêÁ§∫‰ø°ÊÅØÔºåÂëäËØâ‰Ω† verdaccio Â∑≤ÁªèÂú® localhost:4873 Á´ØÂè£ÂêØÂä®„ÄÇ‰Ω†ÂèØ‰ª•ÊâìÂºÄÊü•ÁúãÔºö ip ËÆøÈóÆ‰∏äÈù¢ÂêØÂä®ÂêéÔºåÊàë‰ª¨‰ºöÂèëÁé∞ÂèØ‰ª•‰ΩøÁî® localhost:4873 ËÆøÈóÆÔºå‰ΩÜÊòØ‰∏çËÉΩ‰ΩøÁî®Êú¨Êú∫ ip ËÆøÈóÆ„ÄÇËøôÊ†∑ËÇØÂÆöÊòØ‰∏çË°åÁöÑ„ÄÇÊàë‰ª¨ÈúÄË¶ÅÈÖçÁΩÆ config.yaml„ÄÇ Âú® config.yaml Êñá‰ª∂ÂÜÖÊ∑ªÂä†ÁõëÂê¨Á´ØÂè£Ôºö 1listen: 0.0.0.0:4873 # listen on all addresses ËøôÊ†∑ÂÖ∂ÂÆÉÊú∫Âô®Â∞±ÂèØ‰ª•ÈÄöËøá ip ËÆøÈóÆ‰∫Ü„ÄÇ Ê∑ªÂä†Áî®Êà∑Âú® verdaccio ÂêØÂä®ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÈÄöËøá npm Ê≥®ÂÜåÁî®Êà∑Ôºö 1npm adduser --registry http://10.26.5.252:4873 npm adduser ÊòØ npm login ÁöÑÂà´Âêç ‰πãÂêé‰ºöËÆ©‰Ω†ËæìÂÖ•Áî®Êà∑ÂêçÂØÜÁ†Å‰ª•ÂèäÈÇÆÁÆ±„ÄÇÂÆåÊàêÊ≥®ÂÜåÔºö Ê∑ªÂä†Áî®Êà∑ÂêéÔºå‰ºöÂú® verdaccio Êñá‰ª∂Â§πÂÜÖÁîüÊàê‰∏Ä‰∏™ htpasswd Êñá‰ª∂ÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∫ÜÊâÄÊúâÊ≥®ÂÜåÁöÑÁî®Êà∑: Ê∑ªÂä†Áî®Êà∑‰πãÂêéÔºåÈªòËÆ§Â∞±‰ºöÂú® .npmrc ‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ tokenÔºåÂ¶ÇÊûúÂêéÈù¢Ë¶Å publish Â∞±ÂæóÈù†ÂÆÉÔºö ‰∏äÈù¢ registry= Ë°®Á§∫ÁöÑÊòØ‰∏ãËΩΩÊ∫êÔºõ ‰∏§‰∏™Ê≥®ÈáäÁöÑÂ∏¶Êúâ authToken ÁöÑË°®Á§∫ÁöÑÊòØÊ≥®ÂÜåÁî®Êà∑ÁöÑtoken„ÄÇ npm adducer ÊòØÁî®Êù•Ê≥®ÂÜåÁöÑÔºåÂ¶ÇÊûúÂ∑≤ÁªèÊ≥®ÂÜå‰∫ÜÁî®Êà∑Êó†Ê≥ïÂÜçÊ¨°Ê≥®ÂÜå„ÄÇÂèØ‰ª•Áõ¥Êé•Âú®ÁΩëÈ°µÁ´ØÁôªÂΩïÁîüÊàê tokenÔºåÁÑ∂ÂêéÊâãÂä®ËÆæÁΩÆÂà∞ .npmrc ‰∏≠„ÄÇ ÂàáÊç¢‰∏ãËΩΩÊ∫ê‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊàë‰ª¨ÂàáÊç¢npm‰∏ãËΩΩÊ∫êÁöÑÊñπÂºèÂ¶Ç‰∏ãÔºö 1npm set registry http://localhostÔºö4873 Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá nrm Êõ¥Âø´ÁöÑÊìç‰Ωú„ÄÇnrmÊòØ npm registry ÁÆ°ÁêÜÂ∑•ÂÖ∑, ËÉΩÂ§üÊü•ÁúãÂíåÂàáÊç¢ÂΩìÂâç‰ΩøÁî®ÁöÑregistry„ÄÇ‰∏çÂÆâË£Ö‰πüÂèØ‰ª•ÔºåÂÆâË£Ö‰ºöÊõ¥È´òÊïà„ÄÇ ÂÆâË£Ö nrm1npm install -g nrm Ê∑ªÂä†ÁßÅÊúçÂú∞ÂùÄÂà∞nrmÊàë‰ª¨ÈúÄË¶ÅÁªôÁßÅÊúçÊ∑ªÂä†Âà´Âêç mynpm ‰ª•‰æõÂàáÊç¢Ôºö 1nrm add mynpm http://localhost:4873 ÈÄöËøá nrm ls ÂèØ‰ª•Êü•ÁúãÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÁöÑÈïúÂÉèÊ∫êÔºåÂèØ‰ª•ÁúãÂà∞ mynpm Â∑≤ÁªèÊ∑ªÂä†ËøõÂéª‰∫ÜÔºö ÂàáÊç¢ÁßÅÊúçÂú∞ÂùÄÂ¶Ç‰∏ãÂëΩ‰ª§ÂàáÊç¢ÁßÅÊúçÔºö 1nrm use mynpm ÂàáÊç¢ÁöÑÂÖ∂ÂÆûÊòØ .npmrc ‰∏≠ÁöÑÈÖçÁΩÆ: ÂèëÂ∏ÉÂåÖÂàùÂßãÂåñ‰∏Ä‰∏™ÊµãËØïÂåÖÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂Â§πÔºåÂπ∂‰∏îÊñ∞Âª∫‰∏Ä‰∏™ index.js Êñá‰ª∂„ÄÇ‰ΩøÁî® npm init ÊñπÊ≥ïÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨Âø´ÈÄüÂàõÂª∫‰∏Ä‰∏™ package.json ÂèëÂ∏ÉÂåÖ‰ΩøÁî® npm publish ÂèëÂ∏ÉÂåÖ: 12npm publish #Â∑≤ÁªèÂàáÊç¢Âà∞Êàë‰ª¨ÁßÅÊúçÂú∞ÂùÄÁöÑÊÉÖÂÜµ‰∏ãnpm publish --registry http://localhost:4873 #Êú™ÂàáÊç¢Âà∞Êàë‰ª¨ÁöÑÁßÅÊúçÊó∂ÔºåÁõ¥Êé•Âä†ÂêéÁºÄÂèØ‰ª•ÂèëÂ∏ÉÂà∞ÁßÅÊúç‰∏ä„ÄÇ ÁôªÂΩïÂà∞‰πãÂâçÁöÑÁΩëÈ°µÂèØ‰ª•ÁúãÂà∞ÂèëÂ∏ÉÊàêÂäüÁöÑÂåÖÔºå‰πüÂèØ‰ª•Âú® .config/storage ÊâæÂà∞Áõ∏Â∫îÊñá‰ª∂Ôºö ‰∏ãËΩΩÂè™Ë¶ÅÂàáÊç¢‰∫Ü‰∏ãËΩΩÊ∫êÔºå‰∏ãËΩΩÂ∞±ÂíåÊôÆÈÄöÁöÑ npm ‰∏ÄÊ†∑,‰ΩøÁî® npm install xxx ÂÖ∂‰ªñ‰øÆÊîπÈÖçÁΩÆ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647listen: 0.0.0.0:4873 #ÁõëÂê¨ÊâÄÊúâÂú∞ÂùÄstorage: ./storage #npmÂåÖ‰øùÂ≠ò‰ΩçÁΩÆplugins: ./plugins #Êèí‰ª∂‰øùÂ≠ò‰ΩçÁΩÆ# ÁΩëÈ°µÁ´ØÁöÑÊ†∑Âºèweb: # WebUI is enabled as default, if you want disable it, just uncomment this line #enable: false title: Verdaccioauth: htpasswd: #Áî®Êà∑ÂàóË°®‰øùÂ≠òÁöÑ‰ΩçÁΩÆ file: ./htpasswd #ÂèØÊ≥®ÂÜåÁöÑÁî®Êà∑Êï∞ #max_users: 1000#ÈÖçÁΩÆ‰∏äÊ∏∏ÁöÑnpmÊúçÂä°Âô®Ôºå‰∏ªË¶ÅÁî®‰∫éËØ∑Ê±ÇÁöÑ‰ªìÂ∫ì‰∏çÂ≠òÂú®Êó∂Âà∞‰∏äÊ∏∏ÊúçÂä°Âô®ÂéªÊãâÂèñ„ÄÇuplinks: npmjs: url: https://registry.npmjs.org/ taobao: url: https://registry.npm.taobao.org/packages: '@*/*': #@/ Ë°®Á§∫Êüê‰∏ãÂ±ûÁöÑÊüêÈ°πÁõÆ #ÊâÄÊúâ‰∫∫ÈÉΩÂèØ‰ª•ÊãâÂèñÔºåÂè™ÊúâÊéàÊùÉÁöÑÁî®Êà∑ÂèØ‰ª•publishÔºå‰∏äÊ∏∏ÊúçÂä°Âô®‰∏∫uplinks‰∏≠ÁöÑÊ∑òÂÆù access: $all publish: $authenticated proxy: taobao '**': #ÂåπÈÖçÈ°πÁõÆÂêçÁß∞ access: $all publish: $authenticated proxy: taobao# To use `npm audit` uncomment the following sectionmiddlewares: audit: enabled: true# log settingslogs: - &#123;type: stdout, format: pretty, level: http&#125; #- &#123;type: file, path: verdaccio.log, level: info&#125; Ê∞∏‰πÖËøêË°åÂèØ‰ª•ÈÄöËøá forever Ëøô‰∏™Â∫ìÂ∞Ü verdaccio Ê∞∏‰πÖËøêË°å„ÄÇ 1234#ÂÖ®Â±ÄËøêË°åsudo npm install -g forever#‰ΩøÁî®foreverÂêØÂä®verdaccioforever start `which verdaccio` ‰∏çËøá‰ΩøÁî®ÁöÑÊó∂ÂÄôÊúÄÂ•ΩËøòÊòØÁúãÁúãÂÆòÊñπÊñáÊ°£ npm ÂêéÁª≠‰ΩøÁî®ÂàõÂª∫‰∏éËøêË°å npm scriptÈÄöËøá npm init ÂëΩ‰ª§ÂàõÂª∫ package.json„ÄÇ Âú® package.json ÁöÑ scripts Â≠óÊÆµ‰∏≠Êñ∞Â¢ûÂëΩ‰ª§ÔºåÂ¶Ç eslintÔºö 123456&#123; "scripts": &#123; "eslint": "eslint *.js", "test": "echo \"Error: no test specified\" &amp;&amp; exit 1" &#125;,&#125; ÂØπ‰∫é‰∏Ä‰∫õÂÜÖÁΩÆÁöÑ npm ÂëΩ‰ª§ÔºåÁõ¥Êé•ÊâßË°å npm+ËÑöÊú¨ÂêçÔºåÂ¶Ç‰∏äÈù¢ÁöÑ npm test ÊàñËÄÖ npm start„ÄÇËá™Â∑±ÂÆö‰πâÁöÑËÑöÊú¨ÈúÄË¶Å‰ΩøÁî® npm run +ËÑöÊú¨ÂêçÔºåÂ¶Ç npm run eslint„ÄÇ npm script Èí©Â≠ênpm script Âú®ÊâßË°å‰πãÂâç‰ºöÊ£ÄÊü•ÊòØÂê¶Êúâpre Âíå post ÁöÑÈí©Â≠êËÑöÊú¨„ÄÇÂç≥Â¶ÇÊûúËøêË°å npm run test ËÑöÊú¨„ÄÇ‰ºöÂÖàÊ£ÄÊü•ÊòØÂê¶Êúâ pretest ËÑöÊú¨ÔºåÂ¶ÇÊûúÊúâÂàôÊâßË°åÔºåÁÑ∂ÂêéÊâßË°å test ÊúÄÂêéÊâßË°å posttest: 1234567&#123; "scripts": &#123; "pretest": "npm run lint", "test": "mocha tests/", "posttest": "echo \"complete\"" &#125;,&#125; git hook ‰∏≠ÊâßË°å npm scriptÊàë‰ª¨‰ΩøÁî® npm Â∫ì husky„ÄÇ‰ΩøÁî® npm install husky --save-dev ‰øùÂ≠ò‰∏∫ dev-denpendancy ‰∏≠„ÄÇÁÑ∂ÂêéÊàë‰ª¨ÁöÑ‰ª£Á†Å‰ªìÂ∫ìÁöÑ .git/hooks ÁõÆÂΩïÔºå‰ºöÂèëÁé∞ÈáåÈù¢ÁöÑÈí©Â≠êÈÉΩË¢´ husky ÊõøÊç¢Êéâ‰∫Ü: ‚Äìsave-dev Ë°®Á§∫Âè™‰øùÂ≠ò‰∏∫ÂºÄÂèëÁéØÂ¢É‰∏ã‰ΩøÁî®ÁöÑÊ®°Âùó„ÄÇÂú®Áîü‰∫ßÂíåÂèëÂ∏ÉÁöÑËøáÁ®ã‰∏≠‰∏ç‰ºöÂ∞ÜËøôÈÉ®ÂàÜÊ®°ÂùóÊâìÂÖ•ÂåÖ‰∏≠„ÄÇ Êé•‰∏ãÊù•ÈúÄË¶ÅÂú® scripts ÂØπË±°‰∏≠Â¢ûÂä† husky ËÉΩËØÜÂà´ÁöÑ Git Hooks ËÑöÊú¨ precommit Âíå prepushÔºö 1234"scripts": &#123; "precommit": "npm run lint", "prepush": "npm run test",&#125; @scopeÊúâÊó∂ÂÄôÔºåÊàë‰ª¨ÁúãÂà´‰∫∫ÁöÑ package.json ÁöÑÊó∂ÂÄôÔºå‰ºöÁúãÂà∞ dependency ‰∏≠ÊúâÁ±ª‰ººËøôÊ†∑ÁöÑ‰∏úË•øÔºö 12345&#123; "dependencies": &#123; "@somescope/someprojectname": "^1.0.0", &#125;,&#125; ÊâÄÊúâÁöÑÁßÅÊúâÊ®°ÂùóÈÉΩÊòØ scoped package ÁöÑÔºåÊâÄ‰ª•‰∏äÈù¢Ë°®Á§∫ÁöÑÊòØ‰∏Ä‰∏™ÁßÅÊúâ‰ªìÂ∫ì„ÄÇÂè™ÊúâÂΩì‰Ω†Ëé∑ÂæóÁõ∏Â∫îÊùÉÈôêÁöÑÊó∂ÂÄôÊâçÂèØ‰ª•ÊãâÂèñ‰ΩøÁî®„ÄÇ]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>npm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WKWebView ‰ΩøÁî®Ôºà‰∏ÄÔºâ‚Äî‚Äî Âü∫Êú¨Áî®Ê≥ï]]></title>
    <url>%2F2018%2F07%2F31%2Fwkwebview%2F</url>
    <content type="text"><![CDATA[WKWebView ÁöÑÁÆÄÂçïÁî®Ê≥ï Âü∫Êú¨Áî®Ê≥ïÂàõÂª∫1- (instancetype)initWithFrame:(CGRect)frame configuration:(WKWebViewConfiguration *)configuration; ÊØîUIWebViewÂ§ö‰∫Ü‰∏™configurationÔºåËøô‰∏™ÈÖçÁΩÆÂèØ‰ª•ËÆæÁΩÆÂæàÂ§ö‰∏úË•ø„ÄÇÂÖ∑‰ΩìÊü•ÁúãWKWebViewConfiguration.hÔºåÂèØ‰ª•ÈÖçÁΩÆjsÊòØÂê¶ÊîØÊåÅÔºåÁîª‰∏≠ÁîªÊòØÂê¶ÂºÄÂêØÁ≠âÔºåËøôÈáå‰∏ªË¶ÅËÆ≤‰∏§‰∏™ÊØîËæÉÂ∏∏Áî®ÁöÑÂ±ûÊÄß: websiteDataStoreWKWebView Êã•ÊúâËá™Â∑±ÁöÑÁßÅÊúâÂ≠òÂÇ®ÔºåÂÆÉÁöÑ‰∏Ä‰∫õÁºìÂ≠òÁ≠âÊï∞ÊçÆÈÉΩÂ≠òÂú®websiteDataStore‰∏≠„ÄÇ 1@property (nonatomic, strong) WKWebsiteDataStore *websiteDataStore; ÂÖ∑‰ΩìÂ¢ûÂà†ÊîπÊü•Â∞±ÂèØ‰ª•ÈÄöËøáWKWebsiteDataStore.h‰∏≠Êèê‰æõÁöÑÊñπÊ≥ïÔºåËøôÈáå‰∏çÂ§öËØ¥Ôºå‰∏ÄËà¨Áî®ÁöÑÊó∂ÂÄôÊØîËæÉÂ∞ëÔºåÁúüÁöÑË¶ÅÊ∏ÖÈô§ÁºìÂ≠òÔºåÁÆÄÂçïÁ≤óÊö¥ÁöÑÊñπÊ≥ïÊòØÂà†Èô§Ê≤ôÁõíÁõÆÂΩï‰∏≠ÁöÑCacheÊñá‰ª∂Â§π„ÄÇ userContentControllerËøô‰∏™Â±ûÊÄßÂæàÈáçË¶ÅÔºåjs‰∏éoc‰∫§‰∫íÔºå‰ª•ÂèäÊ≥®ÂÖ•jsÈÉΩ‰ºöÁî®Âà∞„ÄÇ 1@property (nonatomic, strong) WKUserContentController *userContentController; Êü•ÁúãWKUserContentControllerÁöÑÂ§¥Êñá‰ª∂Ôºå‰Ω†‰ºöÂèëÁé∞ÂÆÉÊúâÂ¶Ç‰∏ãÂá†‰∏™ÊñπÊ≥ïÔºö 123456789101112@interface WKUserContentController : NSObject &lt;NSCoding&gt;//ËØªÂèñÊ∑ªÂä†ËøáÁöÑËÑöÊú¨@property (nonatomic, readonly, copy) NSArray&lt;WKUserScript *&gt; *userScripts;//Ê∑ªÂä†ËÑöÊú¨- (void)addUserScript:(WKUserScript *)userScript;//Âà†Èô§ÊâÄÊúâÊ∑ªÂä†ÁöÑËÑöÊú¨- (void)removeAllUserScripts;//ÈÄöËøáwindow.webkit.messageHandlers.&lt;name&gt;.postMessage(&lt;messageBody&gt;) Êù•ÂÆûÁé∞js-&gt;oc‰º†ÈÄíÊ∂àÊÅØÔºåÂπ∂Ê∑ªÂä†handler- (void)addScriptMessageHandler:(id &lt;WKScriptMessageHandler&gt;)scriptMessageHandler name:(NSString *)name;//Âà†Èô§handler- (void)removeScriptMessageHandlerForName:(NSString *)name;@end Âü∫Êú¨ÂàõÂª∫12345678910WKWebViewConfiguration *configuration = [[WKWebViewConfiguration alloc] init];WKUserContentController *controller = [[WKUserContentController alloc] init];configuration.userContentController = controller;self.webView = [[WKWebView alloc] initWithFrame:self.view.bounds configuration:configuration];self.webView.allowsBackForwardNavigationGestures = YES; //ÂÖÅËÆ∏Âè≥ÊªëËøîÂõû‰∏ä‰∏™ÈìæÊé•ÔºåÂ∑¶ÊªëÂâçËøõself.webView.allowsLinkPreview = YES; //ÂÖÅËÆ∏ÈìæÊé•3D Touchself.webView.customUserAgent = @"WebViewDemo/1.0.0"; //Ëá™ÂÆö‰πâUAÔºåUIWebViewÂ∞±Ê≤°ÊúâÊ≠§ÂäüËÉΩÔºåÂêéÈù¢‰ºöËÆ≤Âà∞ÈÄöËøáÂÖ∂‰ªñÊñπÂºèÂÆûÁé∞self.webView.UIDelegate = self;self.webView.navigationDelegate = self;[self.view addSubview:self.webView]; Âä®ÊÄÅÊ≥®ÂÖ•jsÈÄöËøáÁªôuserContentControllerÊ∑ªÂä†WKUserScriptÔºåÂèØ‰ª•ÂÆûÁé∞Âä®ÊÄÅÊ≥®ÂÖ•js„ÄÇÊØîÂ¶ÇÊàëÂÖàÊ≥®ÂÖ•‰∏Ä‰∏™ËÑöÊú¨ÔºåÁªôÊØè‰∏™È°µÈù¢Ê∑ªÂä†‰∏Ä‰∏™Cookie 123//Ê≥®ÂÖ•‰∏Ä‰∏™CookieWKUserScript *newCookieScript = [[WKUserScript alloc] initWithSource:@"document.cookie = 'DarkAngelCookie=DarkAngel;'" injectionTime:WKUserScriptInjectionTimeAtDocumentStart forMainFrameOnly:NO];[controller addUserScript:newCookieScript]; ÁÑ∂ÂêéÂÜçÊ≥®ÂÖ•‰∏Ä‰∏™ËÑöÊú¨ÔºåÊØèÂΩìÈ°µÈù¢Âä†ËΩΩÔºåÂ∞±‰ºöalertÂΩìÂâçÈ°µÈù¢cookie: 1234//ÂàõÂª∫ËÑöÊú¨WKUserScript *cookieScript = [[WKUserScript alloc] initWithSource:@"alert(document.cookie);" injectionTime:WKUserScriptInjectionTimeAtDocumentEnd forMainFrameOnly:NO];//Ê∑ªÂä†ËÑöÊú¨[controller addUserScript:script]; Ê≥®ÂÖ•ÁöÑjs sourceÂèØ‰ª•ÊòØ‰ªª‰ΩïjsÂ≠óÁ¨¶‰∏≤Ôºå‰πüÂèØ‰ª•jsÊñá‰ª∂„ÄÇÊØîÂ¶Ç‰Ω†Êú¨Âú∞ÂèØËÉΩÂ∞±‰ºöÊúâ‰∏Ä‰∏™native_functions.jsÔºå‰Ω†ÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÁöÑÊñπÂºèÊ∑ªÂä†Ôºö 1234NSString *jsSource = [NSString stringWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"native_functions" ofType:@"js"] encoding:NSUTF8StringEncoding error:nil];//Ê∑ªÂä†Ëá™ÂÆö‰πâÁöÑËÑöÊú¨WKUserScript *js = [[WKUserScript alloc] initWithSource:jsSource injectionTime:WKUserScriptInjectionTimeAtDocumentEnd forMainFrameOnly:NO];[self.configuration.userContentController addUserScript:js]; Âä†ËΩΩ123- (nullable WKNavigation *)loadRequest:(NSURLRequest *)request;- (nullable WKNavigation *)loadFileURL:(NSURL *)URL allowingReadAccessToURL:(NSURL *)readAccessURL - (nullable WKNavigation *)loadHTMLString:(NSString *)string baseURL:(nullable NSURL *)baseURL; ÊØîÂ¶ÇÂä†ËΩΩ‰∏ª bundle ‰∏≠ÁöÑ‰∏Ä‰∏™htmlÈúÄË¶Å‰ΩøÁî®loadRequest:ÊñπÊ≥ï„ÄÇloadReqest ËøôÁßçÊñπÂºè‰ºöÊääÂΩìÂâçloadÁöÑËøô‰∏™htmlÊñá‰ª∂ÁöÑË∑ØÂæÑ‰Ωú‰∏∫baseURLÔºå‰ª•Ê≠§ÂØªÊâæÂÖ∂‰ªñËµÑÊ∫ê„ÄÇ 1[self.webView loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"test" ofType:@"html"]]]]; loadHTMLString:baseURL: Áõ¥Êé•Âä†ËΩΩ html Â≠óÁ¨¶‰∏≤„ÄÇbaseURL ÊòØ html ‰∏≠ËµÑÊ∫êÁöÑË∑ØÂæÑÔºö 123NSString *html = @"....";// Âä†ËΩΩ mainBundle ‰∏ãÁöÑËµÑÊ∫ê `[[NSBundle mainBundle] resourcePath]` Ëé∑Âèñ mainBundle ÁöÑË∑ØÂæÑÂ≠óÁ¨¶‰∏≤[self.wkWebView loadHTMLString:html baseURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] resourcePath]]]; ‰ª£ÁêÜUIWebViewÁöÑ‰ª£ÁêÜÂçèËÆÆÊãÜÊàê‰∫Ü‰∏Ä‰∏™Ë∑≥ËΩ¨ÁöÑÂçèËÆÆÂíå‰∏Ä‰∏™ÂÖ≥‰∫éUIÁöÑÂçèËÆÆÔºö 12@protocol WKNavigationDelegate; //Á±ª‰ºº‰∫éUIWebViewÁöÑÂä†ËΩΩÊàêÂäü„ÄÅÂ§±Ë¥•„ÄÅÊòØÂê¶ÂÖÅËÆ∏Ë∑≥ËΩ¨Á≠â@protocol WKUIDelegate; //‰∏ªË¶ÅÊòØ‰∏Ä‰∫õalert„ÄÅÊâìÂºÄÊñ∞Á™óÂè£‰πãÁ±ªÁöÑ WKNavigationDelegateÂ∏∏Áî®ÊñπÊ≥ïÔºö 1234567891011121314//‰∏ãÈù¢Ëøô2‰∏™ÊñπÊ≥ïÂÖ±ÂêåÂØπÂ∫î‰∫ÜUIWebViewÁöÑ - (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType;//ÂèëÈÄÅËØ∑Ê±ÇÂâçÔºöÈíàÂØπ‰∏ÄÊ¨°actionÊù•ÂÜ≥ÂÆöÊòØÂê¶ÂÖÅËÆ∏Ë∑≥ËΩ¨Ôºåaction‰∏≠ÂèØ‰ª•Ëé∑ÂèñrequestÔºåÂÖÅËÆ∏‰∏éÂê¶ÈÉΩÈúÄË¶ÅË∞ÉÁî®decisionHandlerÔºåÊØîÂ¶ÇdecisionHandler(WKNavigationActionPolicyCancel);- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandlerÔºõ//Ëé∑ÂèñËøîÂõûÂêéÔºöÊ†πÊçÆresponseÊù•ÂÜ≥ÂÆöÔºåÊòØÂê¶ÂÖÅËÆ∏Ë∑≥ËΩ¨ÔºåÂÖÅËÆ∏‰∏éÂê¶ÈÉΩÈúÄË¶ÅË∞ÉÁî®decisionHandlerÔºåÂ¶ÇdecisionHandler(WKNavigationResponsePolicyAllow);- (void)webView:(WKWebView *)webView decidePolicyForNavigationResponse:(WKNavigationResponse *)navigationResponse decisionHandler:(void (^)(WKNavigationResponsePolicy))decisionHandler;//ÂºÄÂßãÂä†ËΩΩÔºåÂØπÂ∫îUIWebViewÁöÑ- (void)webViewDidStartLoad:(UIWebView *)webView;- (void)webView:(WKWebView *)webView didStartProvisionalNavigation:(null_unspecified WKNavigation *)navigation;//Âä†ËΩΩÊàêÂäüÔºåÂØπÂ∫îUIWebViewÁöÑ- (void)webViewDidFinishLoad:(UIWebView *)webView;- (void)webView:(WKWebView *)webView didFinishNavigation:(null_unspecified WKNavigation *)navigation;//Âä†ËΩΩÂ§±Ë¥•ÔºåÂØπÂ∫îUIWebViewÁöÑ- (void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error;- (void)webView:(WKWebView *)webView didFailNavigation:(null_unspecified WKNavigation *)navigation withError:(NSError *)error; Á§∫‰æãÔºöÊéßÂà∂Âì™‰∫õÁ´ôÁÇπÂèØ‰ª•Ë¢´ËÆøÈóÆ123456789func webView(_ webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -&gt; Void) &#123; if let host = navigationAction.request.url?.host &#123; if host == "www.apple.com" &#123; decisionHandler(.allow) return &#125; &#125; decisionHandler(.cancel)&#125; WKUIDelegateÂΩì JS ‰∏≠Ë∞ÉÁî® alert Á≠âÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºå‰ºöÊù•Âà∞ËøôÂá†‰∏™‰ª£ÁêÜÊñπÊ≥ï‰∏≠ÔºåËøõË°åËá™ÂÆö‰πâÊìç‰Ωú„ÄÇÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™ÊñπÂºèÊù•ËøõË°å JS Âêë Native ‰º†ÈÄíÂèÇÊï∞ÊâßË°åÊñπÊ≥ï„ÄÇ 123456789101112131415161718192021222324252627282930313233/* Ë≠¶Âëä */- (void)webView:(WKWebView *)webView runJavaScriptAlertPanelWithMessage:(NSString *)message initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(void))completionHandler &#123; UIAlertController *alert = [UIAlertController alertControllerWithTitle:nil message:message ? message : @"" preferredStyle:UIAlertControllerStyleAlert]; [alert addAction:[UIAlertAction actionWithTitle:@"Á°ÆÂÆö" style:UIAlertActionStyleDefault handler:^(UIAlertAction *action) &#123; completionHandler(); &#125;]]; [vc presentViewController:alert animated:YES completion:NULL];&#125;///** Á°ÆËÆ§Ê°Ü */- (void)webView:(WKWebView *)webView runJavaScriptConfirmPanelWithMessage:(NSString *)message initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(BOOL result))completionHandler&#123; UIAlertController *alert = [UIAlertController alertControllerWithTitle:nil message:message ? message : @"" preferredStyle:UIAlertControllerStyleAlert]; [alert addAction:[UIAlertAction actionWithTitle:@"Á°ÆÂÆö" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123; completionHandler(YES); &#125;]]; [alert addAction:[UIAlertAction actionWithTitle:@"ÂèñÊ∂à" style:UIAlertActionStyleCancel handler:^(UIAlertAction * _Nonnull action) &#123; completionHandler(NO); &#125;]]; [vc presentViewController:alert animated:YES completion:NULL];&#125;/** ËæìÂÖ•Ê°Ü */- (void)webView:(WKWebView *)webView runJavaScriptTextInputPanelWithPrompt:(NSString *)prompt defaultText:(nullable NSString *)defaultText initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(NSString * __nullable result))completionHandler&#123; [alert addTextFieldWithConfigurationHandler:^(UITextField * _Nonnull textField) &#123; textField.textColor = [UIColor blackColor]; textField.placeholder = defaultText ? defaultText : @""; &#125;]; [alert addAction:[UIAlertAction actionWithTitle:@"Á°ÆÂÆö" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123; completionHandler([[alert.textFields lastObject] text]); &#125;]]; [alert addAction:[UIAlertAction actionWithTitle:@"ÂèñÊ∂à" style:UIAlertActionStyleCancel handler:^(UIAlertAction * _Nonnull action) &#123; completionHandler(nil); &#125;]]; [vc presentViewController:alert animated:YES completion:NULL];&#125; Êñ∞Â±ûÊÄß123456@property (nullable, nonatomic, readonly, copy) NSString *title; //È°µÈù¢ÁöÑtitleÔºåÁªà‰∫éÂèØ‰ª•Áõ¥Êé•Ëé∑Âèñ‰∫Ü@property (nullable, nonatomic, readonly, copy) NSURL *URL; //ÂΩìÂâçwebViewÁöÑURL@property (nonatomic, readonly, getter=isLoading) BOOL loading; //ÊòØÂê¶Ê≠£Âú®Âä†ËΩΩ@property (nonatomic, readonly) double estimatedProgress; //Âä†ËΩΩÁöÑËøõÂ∫¶@property (nonatomic, readonly) BOOL canGoBack; //ÊòØÂê¶ÂèØ‰ª•ÂêéÈÄÄÔºåË∑üUIWebViewÁõ∏Âêå@property (nonatomic, readonly) BOOL canGoForward; //ÊòØÂê¶ÂèØ‰ª•ÂâçËøõÔºåË∑üUIWebViewÁõ∏Âêå Ëøô‰∫õÂ±ûÊÄßÈÉΩÂæàÊúâÁî®ÔºåËÄå‰∏îÊîØÊåÅKVOÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáKVOËßÇÂØüËøô‰∫õÂÄºÁöÑÂèòÂåñÔºå‰ª•‰æø‰∫éÊàë‰ª¨ÂÅöÂá∫ÊúÄÂèãÂ•ΩÁöÑ‰∫§‰∫í„ÄÇ OC JS ‰∫§‰∫íOC -&gt; JS12//ÊâßË°å‰∏ÄÊÆµjsÔºåÂπ∂Â∞ÜÁªìÊûúËøîÂõûÔºåÂ¶ÇÊûúÂá∫ÈîôÔºåerrorÂàô‰∏ç‰∏∫Á©∫- (void)evaluateJavaScript:(NSString *)javaScriptString completionHandler:(void (^ _Nullable)(_Nullable id result, NSError * _Nullable error))completionHandler; Á§∫‰æãÔºåÊØîÂ¶ÇÊàëÊÉ≥Ëé∑ÂèñÈ°µÈù¢‰∏≠ÁöÑtitleÔºåÈô§‰∫ÜÁõ¥Êé•self.webView.titleÂ§ñÔºåËøòÂèØ‰ª•ÈÄöËøáËøô‰∏™ÊñπÊ≥ïÔºö 123[self.webView evaluateJavaScript:@"document.title" completionHandler:^(id _Nullable title, NSError * _Nullable error) &#123; NSLog(@"Ë∞ÉÁî®evaluateJavaScriptÂºÇÊ≠•Ëé∑ÂèñtitleÔºö%@", title);&#125;]; JS -&gt; OCURL Êã¶Êà™ÈÄöËøáËá™ÂÆö‰πâSchemeÔºåÂú®ÈìæÊé•ÊøÄÊ¥ªÊó∂ÔºåÊã¶Êà™ËØ•URLÔºåÊãøÂà∞ÂèÇÊï∞ÔºåË∞ÉÁî®OCÊñπÊ≥ïÔºö 1234567891011121314151617181920212223// Âú®HTML‰∏≠ÂÜô‰∏äAÊ†áÁ≠æÁõ¥Êé•Â°´ÂÜôÂÅáËØ∑Ê±ÇÂú∞ÂùÄ&lt;a href="myScheme://login?username=12323123&amp;code=892845"&gt;Áü≠‰ø°È™åËØÅÁôªÂΩï&lt;/a&gt;// Âú®JS‰∏≠Áî®location.hrefË∑≥ËΩ¨location.href = 'wakaka://wahahalalala/action?param=paramobj'// Âú®JS‰∏≠ÂàõÂª∫‰∏Ä‰∏™iframeÔºåÁÑ∂ÂêéÊèíÂÖ•dom‰πã‰∏≠ËøõË°åË∑≥ËΩ¨$('body').append('&lt;iframe src="' + 'wakaka://wahahalalala/action?param=paramobj' + '" style="display:none"&gt;&lt;/iframe&gt;');- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandler &#123; //ÂèØ‰ª•ÈÄöËøánavigationAction.navigationTypeËé∑ÂèñË∑≥ËΩ¨Á±ªÂûãÔºåÂ¶ÇÊñ∞ÈìæÊé•„ÄÅÂêéÈÄÄÁ≠â NSURL *URL = navigationAction.request.URL; //Âà§Êñ≠URLÊòØÂê¶Á¨¶ÂêàËá™ÂÆö‰πâÁöÑURL Scheme if ([URL.scheme isEqualToString:@"myScheme"]) &#123; //Ê†πÊçÆ‰∏çÂêåÁöÑ‰∏öÂä°ÔºåÊù•ÊâßË°åÂØπÂ∫îÁöÑÊìç‰ΩúÔºå‰∏îËé∑ÂèñÂèÇÊï∞ if ([URL.host isEqualToString:@"login"]) &#123; NSString *param = URL.query; NSLog(@"Áü≠‰ø°È™åËØÅÁ†ÅÁôªÂΩï, ÂèÇÊï∞‰∏∫%@", param); decisionHandler(WKNavigationActionPolicyCancel); return; &#125; &#125; decisionHandler(WKNavigationActionPolicyAllow); NSLog(@"%@", NSStringFromSelector(_cmd));&#125; WKWebView Êã¶Êà™Ôºö12345678910111213- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandler &#123; //1 Ê†πÊçÆurlÔºåÂà§Êñ≠ÊòØÂê¶ÊòØÊâÄÈúÄË¶ÅÁöÑÊã¶Êà™ÁöÑË∞ÉÁî® Âà§Êñ≠ÂçèËÆÆ/ÂüüÂêç if (ÊòØ)&#123; //2 ÂèñÂá∫Ë∑ØÂæÑÔºåÁ°ÆËÆ§Ë¶ÅÂèëËµ∑ÁöÑnativeË∞ÉÁî®ÁöÑÊåá‰ª§ÊòØ‰ªÄ‰πà //3 ÂèñÂá∫ÂèÇÊï∞ÔºåÊãøÂà∞JS‰º†ËøáÊù•ÁöÑÊï∞ÊçÆ //4 Ê†πÊçÆÊåá‰ª§Ë∞ÉÁî®ÂØπÂ∫îÁöÑnativeÊñπÊ≥ïÔºå‰º†ÈÄíÊï∞ÊçÆ //Á°ÆËÆ§Êã¶Êà™ÔºåÊãíÁªùWebViewÁªßÁª≠ÂèëËµ∑ËØ∑Ê±Ç decisionHandler(WKNavigationActionPolicyCancel); &#125;else&#123; decisionHandler(WKNavigationActionPolicyAllow); &#125; return YES;&#125; ÂÅáË∑≥ËΩ¨ÁöÑÁº∫ÁÇπÔºö ‰∏¢Â§±Ê∂àÊÅØ„ÄÇÂú®Âêå‰∏Ä‰∏™ËøêË°åÈÄªËæëÂÜÖÂø´ÈÄüÁöÑËøûÁª≠ÂèëÈÄÅ‰∏§‰∏™ÈÄö‰ø°ËØ∑Ê±ÇÔºåÈÇ£‰πàÂêéÈù¢ÁöÑÊ∂àÊÅØÂ∞ÜÊî∂‰∏çÂà∞„ÄÇ URLÈïøÂ∫¶ÈôêÂà∂„ÄÇ scriptMessageHandlerÂú®OC‰∏≠Ê∑ªÂä†‰∏Ä‰∏™scriptMessageHandlerÔºåÂàô‰ºöÂú®all frames‰∏≠Ê∑ªÂä†‰∏Ä‰∏™jsÁöÑfunctionÔºö window.webkit.messageHandlers.&lt;name&gt;.postMessage(&lt;messageBody&gt;) „ÄÇÈÇ£‰πàÂΩìÊàëÂú®OC‰∏≠ÈÄöËøáÂ¶Ç‰∏ãÁöÑÊñπÊ≥ïÊ∑ªÂä†‰∫Ü‰∏Ä‰∏™handlerÔºåÂ¶Ç 12//ÈÖçÁΩÆÂØπË±°Ê≥®ÂÖ•[self.webView.configuration.userContentController addScriptMessageHandler:self name:@"nativeObject"]; ËøôÈáå‰∏çËÉΩÁõ¥Êé•‰º†ÂÖ• selfÔºå‰ºöË¢´ WKUserContentController Âº∫ÂºïÁî®ÔºåËÄå‰∏çËÉΩÈîÄÊØÅ„ÄÇÊâÄ‰ª•ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™‰ª£ÁêÜÁ±ªÂØπË±°ÔºåÁ±ª‰ºº‰∫éÂ§ÑÁêÜ NSTimer„ÄÇ ÂΩìÊàëÂú®js‰∏≠Ë∞ÉÁî®‰∏ãÈù¢ÁöÑÊñπÊ≥ïÊó∂: 12345678//ÂáÜÂ§áË¶Å‰º†ÁªônativeÁöÑÊï∞ÊçÆÔºåÂåÖÊã¨Êåá‰ª§ÔºåÊï∞ÊçÆÔºåÂõûË∞ÉÁ≠âvar data = &#123; action:'xxxx', params:'xxxx', callback:'xxxx',&#125;;//‰º†ÈÄíÁªôÂÆ¢Êà∑Á´Øwindow.webkit.messageHandlers.nativeObject.postMessage(data); Ê≥®ÊÑèÔºåpostMessage ÊñπÊ≥ïË¶ÅÊ±ÇÂøÖÈ°ªË¶ÅÊúâ‰∏Ä‰∏™ÂèÇÊï∞ÔºåÂç≥‰ΩøÊòØ‰∏Ä‰∏™Á©∫ÂØπË±°Ôºå‰πüË¶ÅÂÜôÊàê postMessage({})ÔºåÂê¶Âàô native Êó†Ê≥ïÊî∂Âà∞Ê∂àÊÅØ„ÄÇ Âú®OC‰∏≠Â∞Ü‰ºöÊî∂Âà∞WKScriptMessageHandlerÁöÑÂõûË∞É 1234567-(void)userContentController:(WKUserContentController *)userContentController didReceiveScriptMessage:(WKScriptMessage *)message&#123; //1 Ëß£ËØªJS‰º†ËøáÊù•ÁöÑJSValue dataÊï∞ÊçÆ NSDictionary *msgBody = message.body; //2 ÂèñÂá∫Êåá‰ª§ÂèÇÊï∞ÔºåÁ°ÆËÆ§Ë¶ÅÂèëËµ∑ÁöÑnativeË∞ÉÁî®ÁöÑÊåá‰ª§ÊòØ‰ªÄ‰πà //3 ÂèñÂá∫Êï∞ÊçÆÂèÇÊï∞ÔºåÊãøÂà∞JS‰º†ËøáÊù•ÁöÑÊï∞ÊçÆ //4 Ê†πÊçÆÊåá‰ª§Ë∞ÉÁî®ÂØπÂ∫îÁöÑnativeÊñπÊ≥ïÔºå‰º†ÈÄíÊï∞ÊçÆ&#125; Êàë‰ª¨ÂèØ‰ª•ÊääjsÁöÑfunctionËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤ÔºåÂÜç‰º†ÈÄíÁªôOC„ÄÇÂÜçËÆ© OC ÈÄöËøá evaluateJavaScript:completionHandler: Ë∞ÉÁî®ÔºåÂ∞ÜÁªìÊûú‰º†Âá∫„ÄÇÂ∞±ÂÆûÁé∞‰∫Ü js-&gt;oc-&gt;js-&gt;oc ÁöÑÂõûË∞É ËÆ∞ÂæóÂú®ÈÄÇÂΩìÁöÑÂú∞ÊñπË∞ÉÁî® removeScriptMessageHandler: 1234- (void)dealloc &#123; //ÁßªÈô§ÂØπË±°Ê≥®ÂÖ• [self.webView.configuration.userContentController removeScriptMessageHandlerForName:@"nativeObject"]; &#125; WKUIDelegateÂâçÈù¢ËØ¥Âà∞ÔºåWKUIDelegate ÂçèËÆÆ‰∏≠ÁöÑÂá†‰∏™ÂºπÁ™óÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞ JS2OC ÁöÑÈÄö‰ø°„ÄÇÂâçÈù¢Âá†Áßç JS2OC ÁöÑÈÄö‰ø°ÁöÑ callback ÈÉΩÈúÄË¶Å OCËá™Â∑±Ë∞ÉÁî® OC2JS ÁöÑÂºÇÊ≠•ÊñπÊ≥ïËøîÂõû„ÄÇËÄå‰ΩøÁî® WKUIDelegate ÂèØ‰ª•ÂêåÊ≠•ËøîÂõûÁªìÊûú„ÄÇ JS Á´ØË∞ÉÁî® 12345678var data = &#123; action:'xxxx', params:'xxxx', callback:'xxxx',&#125;;var jsonData = JSON.stringify([data]);//ÂèëËµ∑ÂºπÊ°Üprompt(jsonData); ÂÆ¢Êà∑Á´ØÊã¶Êà™Ôºö 12345678910111213- (void)webView:(WKWebView *)webView runJavaScriptTextInputPanelWithPrompt:(NSString *)prompt defaultText:(nullable NSString *)defaultText initiatedByFrame:(WKFrameInfo *)frame completionHandler:(void (^)(NSString * _Nullable result))completionHandler&#123; //1 Ê†πÊçÆ‰º†Êù•ÁöÑÂ≠óÁ¨¶‰∏≤ÂèçËß£Âá∫Êï∞ÊçÆÔºåÂà§Êñ≠ÊòØÂê¶ÊòØÊâÄÈúÄË¶ÅÁöÑÊã¶Êà™ËÄåÈùûÂ∏∏ËßÑH5ÂºπÊ°Ü if (ÊòØ)&#123; //2 ÂèñÂá∫Êåá‰ª§ÂèÇÊï∞ÔºåÁ°ÆËÆ§Ë¶ÅÂèëËµ∑ÁöÑnativeË∞ÉÁî®ÁöÑÊåá‰ª§ÊòØ‰ªÄ‰πà //3 ÂèñÂá∫Êï∞ÊçÆÂèÇÊï∞ÔºåÊãøÂà∞JS‰º†ËøáÊù•ÁöÑÊï∞ÊçÆ //4 Ê†πÊçÆÊåá‰ª§Ë∞ÉÁî®ÂØπÂ∫îÁöÑnativeÊñπÊ≥ïÔºå‰º†ÈÄíÊï∞ÊçÆ //Áõ¥Êé•ËøîÂõûJSÁ©∫Â≠óÁ¨¶‰∏≤ completionHandler(@""); &#125;else&#123; //Áõ¥Êé•ËøîÂõûJSÁ©∫Â≠óÁ¨¶‰∏≤ completionHandler(@""); &#125;&#125; ËøôÈáå prompt Âíå defaultText Â∞±ÊòØ JS Á´Ø‰º†Êù•ÁöÑÊï∞ÊçÆ„ÄÇÈÄöËøá completionHandler() Â∞±ÂèØ‰ª•ÂêåÊ≠•Â∞ÜÂÄºËøîÂõû‰∫Ü„ÄÇjs Á´ØË∞ÉÁî®Êé•Êî∂Ôºö 1let result = window.prompt(somePrompt, someDefaultText) JavaScriptCoreJavaScriptCoreÊòØËãπÊûúSafariÊµèËßàÂô®ÁöÑJavaScriptÂºïÊìé OC Ë∞ÉÁî® JSOC Ë∞ÉÁî® JS ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî® evaluteScript ÊñπÊ≥ïÔºö 1234567#import &lt;JavaScriptCore/JavaScriptCore.h&gt;int main() &#123; JSContext *context = [[JSContext alloc] init]; JSValue *value = [context evaluateScript:@"2 + 2"]; NSLog(@"2 + 2 = %d", [value toInt32]); return 0&#125; JSContext JSContext ÊòØJS‰ª£Á†ÅÁöÑÊâßË°åÁéØÂ¢É„ÄÇJSContext ‰∏∫JS‰ª£Á†ÅÁöÑÊâßË°åÊèê‰æõ‰∫Ü‰∏ä‰∏ãÊñáÁéØÂ¢ÉÔºåÈÄöËøájSCoreÊâßË°åÁöÑJS‰ª£Á†ÅÈÉΩÂæóÈÄöËøáJSContextÊù•ÊâßË°å„ÄÇ JSContextÂØπÂ∫î‰∫é‰∏Ä‰∏™ JS ‰∏≠ÁöÑÂÖ®Â±ÄÂØπË±°„ÄÇJSContextÂØπÂ∫îÁùÄ‰∏Ä‰∏™ÂÖ®Â±ÄÂØπË±°ÔºåÁõ∏ÂΩì‰∫éÊµèËßàÂô®‰∏≠ÁöÑwindowÂØπË±°ÔºåJSContext‰∏≠Êúâ‰∏Ä‰∏™GlobalObjectÂ±ûÊÄßÔºåÂÆûÈôÖ‰∏äJS‰ª£Á†ÅÈÉΩÊòØÂú®Ëøô‰∏™GlobalObject‰∏äÊâßË°åÁöÑÔºå‰ΩÜÊòØ‰∏∫‰∫ÜÂÆπÊòìÁêÜËß£ÔºåÂèØ‰ª•ÊääJSContextÁ≠â‰ª∑‰∫éÂÖ®Â±ÄÂØπË±°„ÄÇÊàë‰ª¨ÁîöËá≥ÂèØ‰ª•Áõ¥Êé•Âú® JSContext ‰∏äÊãø GlobalObject ÁöÑÂ±ûÊÄß„ÄÇ 123456789101112JSValue *value = [context evaluateScript:@"var a = 1+2*3;"];NSLog(@"a = %@", [context objectForKeyedSubscript:@"a"]);NSLog(@"a = %@", [context.globalObject objectForKeyedSubscript:@"a"]);NSLog(@"a = %@", context[@"a"]);/Output:a = 7a = 7a = 7 JSValue JSValue ÊòØÂØπ JS ÂÄºÁöÑÂåÖË£Ö„ÄÇJS‰∏≠ÁöÑÂÄºÊãøÂà∞OC‰∏≠ÊòØ‰∏çËÉΩÁõ¥Êé•Áî®ÁöÑÔºåÈúÄË¶ÅÂåÖË£Ö‰∏Ä‰∏ã JSValueÂ≠òÂú®‰∫éJSContext‰∏≠„ÄÇJSValueÊòØ‰∏çËÉΩÁã¨Á´ãÂ≠òÂú®ÁöÑÔºåÂÆÉÂøÖÈ°ªÂ≠òÂú®‰∫éÊüê‰∏Ä‰∏™JSContext‰∏≠„ÄÇ JSValueÂØπÂÖ∂ÂØπÂ∫îÁöÑJSÂÄºÂíåÂÖ∂ÊâÄÂ±ûÁöÑJSContextÂØπË±°ÈÉΩÊòØÂº∫ÂºïÁî®ÁöÑÂÖ≥Á≥ª„ÄÇÂõ†‰∏∫jSValueÈúÄË¶ÅËøô‰∏§‰∏™‰∏úË•øÊù•ÊâßË°åJS‰ª£Á†ÅÔºåÊâÄ‰ª•JSValue‰ºö‰∏ÄÁõ¥ÊåÅÊúâÁùÄÂÆÉ‰ª¨„ÄÇ Á§∫‰æãÔºö js ‰ª£Á†ÅÔºö 123456// ËÆ°ÁÆóÈò∂‰πòvar factorial = function (n) &#123; if (n &lt; 0) return if (n === 0) return 1 return n * factortial(n-1)&#125; oc Ë∞ÉÁî®Ôºö 123456NSString *factorialScript = [self loadJSFromBundle];JSContext *context = [[JSContext alloc] init];[context evaluteScript: factorialScript];JSValue *function = context[@"factorial"];JSValue *result = [function callWithArguments:@[@5]];NSLog(@"factorial(5) = %d", [result toInt32]); ‰ªé Bundle ‰∏≠ÊãøÂà∞ js ‰ª£Á†ÅÊâßË°åÔºå‰ªé context ‰∏≠ÊãøÂà∞ÊñπÊ≥ïÔºåÁÑ∂ÂêéÈÄöËøá callWithArguments ÊâßË°åÔºåÊâßË°åÂêéÂæóÂà∞ JSValue ÁöÑÂÄº„ÄÇ JS Ë∞ÉÁî® OC‰∏§ÁßçÊñπÂºèÂèØ‰ª•ËÆ© OC Êö¥Èú≤ÊñπÊ≥ïÁªô JSÔºö BlockÔºöÂèØ‰ª•Â∞Ü OC ‰∏≠ÁöÑÂçï‰∏™ÊñπÊ≥ïÊö¥Èú≤Áªô JS Ë∞ÉÁî®„ÄÇ JSExportÂçèËÆÆÔºöÂèØ‰ª•Â∞ÜOCÁöÑ‰∏≠Êüê‰∏™ÂØπË±°Áõ¥Êé•Êö¥Èú≤ÁªôJS‰ΩøÁî® BlockJSCore‰ºöËá™Âä®Â∞ÜËøô‰∏™BlockÂåÖË£ÖÊàê‰∏Ä‰∏™JSÊñπÊ≥ïÔºö 123456context[@"makeNSColor"] = ^(NSDictorary * colors)&#123; float r = [colors[@"red"] floatValue]; float g = [colors[@"green"] floatValue]; float b = [colors[@"blue"] floatValue]; return [NSColor colorWithRed:(r / 255.0) green:(g / 255.0) blue:(b / 255) alpha:1.0];&#125; js Á´ØÂ∞±ÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®Ëøô‰∏™ makeNSColor ÊñπÊ≥ï‰∫Ü„ÄÇËøêË°åÂæóÂà∞‰∏Ä‰∏™ NSColor ÂØπË±°ÔºåÂú® js ‰∏≠Ë°®Áé∞‰∏∫‰∏Ä‰∏™ object„ÄÇ Â¶ÇÊûúÊàë‰ª¨Âú® js Á´ØÂÜçÂØπËøô‰∏™ÊñπÊ≥ïÂ∞ÅË£Ö‰∏Ä‰∏ãÔºö 123var colorForWord = function (word) &#123; return makeNSColor(word)&#125; Âú® oc Á´ØË∞ÉÁî®ÁöÑÁ§∫ÊÑèÂõæÂ¶Ç‰∏ãÔºö OC CallerÂéªË∞ÉÁî®Ëøô‰∏™colorForWrodÂáΩÊï∞ÔºåÂõ†‰∏∫colorForWrodÂáΩÊï∞Êé•Êî∂ÁöÑÊòØ‰∏Ä‰∏™StringÁ±ªÂûãÈÇ£‰∏™ÂèÇÊï∞wordÔºåOC Caller‰º†ËøáÂéªÁöÑÊòØ‰∏Ä‰∏™NSStringÁ±ªÂûãÁöÑÂèÇÊï∞ÔºåJSCoreËΩ¨Êç¢ÊàêÂØπÂ∫îÁöÑStringÁ±ªÂûã„ÄÇÁÑ∂ÂêécolorForWrodÂáΩÊï∞ÁªßÁª≠Âêë‰∏ãË∞ÉÁî®ÔºåÂ∞±ÂÉè‰∏äÈù¢ËØ¥ÁöÑÔºåÁü•ÈÅìÂÖ∂ÊãøÂà∞ËøîÂõûÁöÑwrapper ObjectÔºåÂÆÉÂ∞Üwrapper ObjectËøîÂõûÁªôË∞ÉÁî®ÂÆÉÁöÑOC CallerÔºåJSCoreÂèà‰ºöÂú®ËøôÊó∂ÂÄôÊääwrapper ObjectËΩ¨ÊàêJSValueÁ±ªÂûãÔºåÊúÄÂêéÂÜçOC‰∏≠ÈÄöËøáÂØπJSValueË∞ÉÁî®ÂØπÂ∫îÁöÑËΩ¨Êç¢ÊñπÊ≥ïÔºåÂç≥ÂèØÊãøÂà∞ÈáåÈù¢ÂåÖË£ÖÁöÑÂÄºÔºåËøôÈáåÊàë‰ª¨Ë∞ÉÁî®- toObjectÊñπÊ≥ïÔºåÊúÄÂêé‰ºöÂæóÂà∞‰∏Ä‰∏™NSColorÂØπË±°ÔºåÂç≥‰ªéÊúÄÂºÄÂßãÈÇ£‰∏™Êö¥Èú≤ÁªôJSÁöÑBlock‰∏≠ËøîÂõûÁöÑÂØπË±°„ÄÇ Ê≥®ÊÑèÁÇπ ‰∏çË¶ÅÂú®Block‰∏≠Áõ¥Êé•‰ΩøÁî®JSValue„ÄÇ ‰∏çË¶ÅÂú®Block‰∏≠Áõ¥Êé•‰ΩøÁî®JSContext„ÄÇ Block‰ºöÂº∫ÂºïÁî®ÂÆÉÈáåÈù¢Áî®Âà∞ÁöÑÂ§ñÈÉ®ÂèòÈáèÔºåÂ¶ÇÊûúÁõ¥Êé•Âú®Block‰∏≠‰ΩøÁî®JSValueÁöÑËØùÔºåÈÇ£‰πàËøô‰∏™JSvalueÂ∞±‰ºöË¢´Ëøô‰∏™BlockÂº∫ÂºïÁî®ÔºåËÄåÊØè‰∏™JSValueÈÉΩÊòØÂº∫ÂºïÁî®ÁùÄÂÆÉÊâÄÂ±ûÁöÑÈÇ£‰∏™JSContextÁöÑÔºåËøôÊòØÂâçÈù¢ËØ¥ËøáÁöÑÔºåËÄåËøô‰∏™BlockÂèàÊòØÊ≥®ÂÖ•Âà∞Ëøô‰∏™Context‰∏≠ÔºåÊâÄ‰ª•Ëøô‰∏™Block‰ºöË¢´contextÂº∫ÂºïÁî®ÔºåËøôÊ†∑‰ºöÈÄ†ÊàêÂæ™ÁéØÂºïÁî®ÔºåÂØºËá¥ÂÜÖÂ≠òÊ≥ÑÈú≤„ÄÇ‰∏çËÉΩÁõ¥Êé•‰ΩøÁî®JSContextÁöÑÂéüÂõ†ÂêåÁêÜ„ÄÇÊâÄ‰ª•Âª∫ËÆÆÊääJSValueÂΩìÂÅöÂèÇÊï∞‰º†Âà∞Block‰∏≠ÔºåËÄå‰∏çÊòØÁõ¥Êé•Âú®BlockÂÜÖÈÉ®‰ΩøÁî®ÔºåËøôÊ†∑BlockÂ∞±‰∏ç‰ºöÂº∫ÂºïÁî®JSValue‰∫Ü„ÄÇ ÈíàÂØπÁ¨¨‰∫åÁÇπÔºåÂèØ‰ª•‰ΩøÁî®[JSContext currentContext]ÊñπÊ≥ïÊù•Ëé∑ÂèñÂΩìÂâçÁöÑContext„ÄÇ JSExport ÂçèËÆÆÈÄöËøáJSExport ÂçèËÆÆÂèØ‰ª•ÂæàÊñπ‰æøÁöÑÂ∞ÜOC‰∏≠ÁöÑÂØπË±°Êö¥Èú≤ÁªôJS‰ΩøÁî®Ôºå‰∏îÂú®JS‰∏≠Áî®Ëµ∑Êù•Â∞±ÂíåJSÂØπË±°‰∏ÄÊ†∑„ÄÇ Â£∞Êòé‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑÂçèËÆÆÂπ∂ÁªßÊâøËá™JSExportÂçèËÆÆ„ÄÇÁÑ∂ÂêéÂΩì‰Ω†ÊääÂÆûÁé∞Ëøô‰∏™Ëá™ÂÆö‰πâÂçèËÆÆÁöÑÂØπË±°Êö¥Èú≤ÁªôJSÊó∂ÔºåJSÂ∞±ËÉΩÂÉè‰ΩøÁî®ÂéüÁîüÂØπË±°‰∏ÄÊ†∑‰ΩøÁî®OCÂØπË±°‰∫ÜÔºö ÂèÇËÄÉWKWebView ÈÇ£‰∫õÂùë iOS‰∏≠UIWebView‰∏éWKWebView„ÄÅJavaScript‰∏éOC‰∫§‰∫í„ÄÅCookieÁÆ°ÁêÜÁúãÊàëÂ∞±Â§ü ‰ªéÈõ∂Êî∂Êãæ‰∏Ä‰∏™hybridÊ°ÜÊû∂Ôºà‰∫åÔºâ‚Äì WebViewÂÆπÂô®Âü∫Á°ÄÂäüËÉΩËÆæËÆ°ÊÄùË∑Ø Ëá™Â∑±Âä®ÊâãÊâìÈÄ†Âü∫‰∫é WKWebView ÁöÑÊ∑∑ÂêàÂºÄÂèëÊ°ÜÊû∂ WebViewJavascriptBridge Ê∫êÁ†Å‰∏≠ Get Âà∞ÁöÑ‚ÄúÊ°•Ê¢ÅÁæéÂ≠¶‚Äù]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Redux Âü∫Á°Ä]]></title>
    <url>%2F2018%2F06%2F05%2FRedux%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[ËÆ∞ÂΩï‰∏Ä‰∏ã redux ÊñáÊ°£ÁöÑ‰∏Ä‰∫õË¶ÅÁÇπ„ÄÇ‰ª•ÂèäÂ≠¶‰π† redux ‰∏≠ÁöÑ‰∏Ä‰∫õÁªèÈ™å„ÄÇ ‰ªãÁªçÂä®Êú∫Âõ†‰∏∫ÂçïÈ°µÂ∫îÁî®ÂèòÂæóÂ§çÊùÇÔºåJavaScript Ë¶ÅÁÆ°ÁêÜÊØî‰ªª‰ΩïÊó∂ÂÄôÈÉΩË¶ÅÂ§öÁöÑ state„ÄÇstate Âú®‰ªÄ‰πàÊó∂ÂÄôÔºåÁî±‰∫é‰ªÄ‰πàÂéüÂõ†ÔºåÂ¶Ç‰ΩïÂèòÂåñÂèòÂæó‰∏çÂèóÊéßÂà∂„ÄÇËøôÈáå‰∫ßÁîü‰∫ÜÁüõÁõæÔºöÁªÑ‰ª∂‰πãÈó¥ÈúÄË¶ÅÂÖ±‰∫´Êï∞ÊçÆÔºåÂíåÊï∞ÊçÆÂèØËÉΩË¢´‰ªªÊÑè‰øÆÊîπÂØºËá¥‰∏çÂèØÈ¢ÑÊñôÁöÑÁªìÊûú‰πãÈó¥ÁöÑÁüõÁõæ„ÄÇRedux ËØïÂõæËÆ© state ÁöÑÂèòÂåñÂèòÂæóÂèØÈ¢ÑÊµã„ÄÇ ‰∏âÂ§ßÂéüÂàôÂçï‰∏ÄÊï∞ÊçÆÊ∫êÊï¥‰∏™Â∫îÁî®ÁöÑ state Ë¢´Â≠òÂÇ®Âú®‰∏ÄÊ£µ object tree ‰∏≠ÔºåÂπ∂‰∏îËøô‰∏™ object tree Âè™Â≠òÂú®‰∫éÂîØ‰∏Ä‰∏Ä‰∏™ store ‰∏≠„ÄÇ State ÊòØÂè™ËØªÁöÑÂîØ‰∏ÄÊîπÂèò state ÁöÑÊñπÊ≥ïÂ∞±ÊòØËß¶Âèë actionÔºåaction ÊòØ‰∏Ä‰∏™Áî®‰∫éÊèèËø∞Â∑≤ÂèëÁîü‰∫ã‰ª∂ÁöÑÊôÆÈÄöÂØπË±°„ÄÇÁ°Æ‰øùËßÜÂõæÂíåÁΩëÁªúËØ∑Ê±Ç‰∏çËÉΩÁõ¥Êé•‰øÆÊîπ state„ÄÇ ‰ΩøÁî®Á∫ØÂáΩÊï∞Êù•ÊâßË°å‰øÆÊîπ‰∏∫ÊèèËø∞ action Â¶Ç‰ΩïÊîπÂèò state treeÔºåÈúÄË¶ÅÁºñÂÜô reducers„ÄÇReducer Âè™ÊòØ‰∏Ä‰∫õÁ∫ØÂáΩÊï∞ÔºåÂÆÉÊé•Êî∂ÂÖàÂâçÁöÑ state Âíå actionÔºåËøîÂõûÊñ∞ÁöÑ state„ÄÇ‰Ω†ÂèØ‰ª•Êää reducer ÊãÜÂàÜ‰∏∫Â§ö‰∏™Â∞èÁöÑ reducerÔºåÁã¨Á´ãÂú∞Êìç‰Ωú state tree ÁöÑ‰∏çÂêåÈÉ®ÂàÜ„ÄÇ Âü∫Á°ÄActionAction ÊòØÊääÊï∞ÊçÆ‰ªéÂ∫îÁî®‰º†Âà∞ store ÁöÑÊúâÊïàËΩΩËç∑„ÄÇ‰∏ÄËà¨‰Ω†‰ºöÈÄöËøá store.dispatch() Â∞Ü action ‰º†Âà∞ store„ÄÇ Action Êú¨Ë¥®‰∏äÊòØ JS ÊôÆÈÄöÂØπË±°„ÄÇÁ∫¶ÂÆö actionÂÜÖÂøÖÈ°ª‰ΩøÁî®‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Á±ªÂûãÁöÑ type Â≠óÊÆµÊù•Ë°®Á§∫Â∞ÜË¶ÅÊâßË°åÁöÑÂä®‰Ωú„ÄÇ ÊúÄÁÆÄÂçïÁöÑ Action Â¶ÇÔºö 12345const ADD_TODO = 'ADD_TODO'&#123; type: ADD_TODO, text: 'build my first redux app'&#125; Action ÂàõÂª∫ÂáΩÊï∞Âú® Redux ‰∏≠ÁöÑ action ÂàõÂª∫ÂáΩÊï∞Âè™ÊòØÁÆÄÂçïÁöÑËøîÂõû‰∏Ä‰∏™ action„ÄÇËøôÊ†∑ÂÅöÂ∞Ü‰Ωø action ÂàõÂª∫ÂáΩÊï∞Êõ¥ÂÆπÊòìË¢´ÁßªÊ§çÂíåÊµãËØïÔºåÂ¶ÇÔºö 123456function addTodo (text) &#123; return &#123; type: ADD_TODO, text &#125;&#125; Action ÂàõÂª∫ÂáΩÊï∞‰πüÂèØ‰ª•ÊòØÂºÇÊ≠•ÈùûÁ∫ØÂáΩÊï∞„ÄÇÂêéÈù¢‰ºöËÆ®ËÆ∫Âà∞„ÄÇ ReducerAction Âè™ÊòØÊèèËø∞‰∫ÜÊúâ‰∫ãÊÉÖÂèëÁîü‰∫ÜËøô‰∏Ä‰∫ãÂÆûÔºåÂπ∂Ê≤°ÊúâÊåáÊòéÂ∫îÁî®Â¶Ç‰ΩïÊõ¥Êñ∞ state„ÄÇReducer ÂàôÊòØÁî®Êù•Êõ¥Êñ∞ state Action ÁöÑÂ§ÑÁêÜreducer Â∞±ÊòØ‰∏Ä‰∏™Á∫ØÂáΩÊï∞ÔºåÊé•ÂèóÊóßÁöÑ state Âíå actionÔºåËøîÂõûÊñ∞ÁöÑ stateÔºö 1(previousState, action) =&gt; newState Ê∞∏Ëøú‰∏çË¶ÅÂÜç reducer ‰∏≠ÊâßË°åËøô‰∫õÊìç‰ΩúÔºö ‰øÆÊîπ‰º†ÂÖ•ÁöÑÂèÇÊï∞ ÊâßË°åÊúâÂâØ‰ΩúÁî®ÁöÑÊìç‰ΩúÔºåÂ¶Ç API ËØ∑Ê±ÇÊàñË∑ØÁî±Ë∑≥ËΩ¨ Ë∞ÉÁî®ÈùûÁ∫ØÂáΩÊï∞ÔºåÂ¶Ç Date.now() reducer ‰∏ÄÂÆöË¶Å‰øùÊåÅÁ∫ØÂáÄ„ÄÇÂè™Ë¶Å‰º†ÂÖ•ÂèÇÊï∞Áõ∏ÂêåÔºåËøîÂõûËÆ°ÁÆóÂæóÂà∞ÁöÑ‰∏ã‰∏Ä‰∏™ state Â∞±‰∏ÄÂÆöÁõ∏Âêå„ÄÇ 12345678910function todoApp(state = initialState, action) &#123; switch (action.type) &#123; case SET_VISIBILITY_FILTER: return Object.assign(&#123;&#125;, state, &#123; visibilityFilter: action.filter &#125;) default: return state &#125;&#125; ÈúÄË¶ÅÊ≥®ÊÑèÔºö Âº∫ÁÉà‰∏çÊé®ËçêÁõ¥Êé•‰øÆÊîπ state„ÄÇÊâÄ‰ª•ËøôÈáåÁî® Object.assign() Êñ∞Âª∫‰∫Ü‰∏Ä‰∏™ÂâØÊú¨(Object.assign() ‰ºöÊääÂêéÈù¢ÁöÑ set Âà∞Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÈáåÔºåÊâÄ‰ª•ËøôÈáåË¶ÅÊîæ‰∏Ä‰∏™Á©∫ÂØπË±°)„ÄÇ default ÁöÑÊÉÖÂÜµ‰∏ãÔºåËøîÂõûÊóßÁöÑ state„ÄÇÈÅáÂà∞Êú™Áü•ÁöÑ action Êó∂Ôºå‰πüË¶ÅËøîÂõûÊóßÁöÑ state„ÄÇ ÊãÜÂàÜ ReducerReducer ÂêàÊàêÊòØ Redux Â∫îÁî®ÊúÄÂü∫Á°ÄÁöÑÊ®°ÂºèÔºåÂèØ‰ª•Êää‰∏Ä‰∏™Â§çÊùÇÁöÑ reducer ÈÄªËæëÊãÜÂàÜÂà∞‰∏Ä‰∏™‰∏™ÂçïÁã¨ÁöÑÂáΩÊï∞Èáå„ÄÇÊØè‰∏™ reducer Âè™Ë¥üË¥£ÁÆ°ÁêÜÂÖ®Â±Ä state ‰∏≠ÂÆÉË¥üË¥£ÁöÑÈÇ£‰∏ÄÈÉ®ÂàÜ„ÄÇÊØè‰∏™ reducer ÁöÑ state ÂèÇÊï∞ÈÉΩ‰∏çÂêåÔºåÂàÜÂà´ÂØπÂ∫îÂÆÉÁÆ°ÁêÜÁöÑÈÇ£ÈÉ®ÂàÜ state Êï∞ÊçÆ„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÊú¨Êù•ÊúâÂæàÂ§ö switch‚Ä¶caseÔºåÂà§Êñ≠‰∏çÂêåÁöÑ action.type Êù•ÂØπ state ÁöÑÊüê‰∏™ÈÉ®ÂàÜÂÅö‰∏çÂêåÁöÑÊìç‰Ωú„ÄÇÊØè‰∏™ state ÁöÑÈÉ®ÂàÜÔºåÂèØËÉΩ‰ºöÂú®Â§ö‰∏™ action.type ‰∏≠ÈÉΩ‰ºöË¢´‰øÆÊîπ„ÄÇ Áé∞Âú®Â∞±ÊääÂ§ÑÁêÜÁõ∏ÂêåÁöÑ state ÁöÑÈÉ®ÂàÜÁöÑÊìç‰ΩúÈÉΩÊãøÂá∫Êù•ÔºåÂçïÁã¨‰Ωú‰∏∫‰∏Ä‰∏™ reducer„ÄÇÊâÄÊúâ‰ºöÊìç‰ΩúËøô‰∏™ state ÈÉ®ÂàÜÁöÑ action.type ÈÉΩ‰ºöË∞ÉÁî®Ëøô‰∏™ reducer„ÄÇÁÑ∂ÂêéÂú®Ëøô‰∏™Â∞èÁöÑ reducer ‰∏≠Âà§Êñ≠Âà∞Â∫ïÊòØÈÇ£‰∏™ action.type ÂØπÂ∫îÊÄé‰πàÂ§ÑÁêÜËøôÈÉ®ÂàÜ state„ÄÇ Redux Êèê‰æõ‰∫Ü combineReducers() Â∑•ÂÖ∑Á±ªÊù•ÂÆåÊàêÂêÑ‰∏™Â∞è reducer ÁöÑË∞ÉÁî®ÔºåÈúÄË¶Å‰º†ÂÖ•ÂêÑ‰∏™Â≠ê reducer ÊâÄÁªÑÊàêÁöÑÂØπË±°„ÄÇ 1234567891011121314151617181920212223import &#123; combineReducers &#125; from 'redux'// Ê≥®ÊÑèÔºåÊãÜÂàÜÂá∫Êù•ÁöÑ reducer ‰∏≠ÁöÑ state ‰∏çÊòØÂÆåÊï¥ÁöÑ stateÔºåËÄåÊòØ state ‰∏≠ÁöÑÂ±ûÊÄßÔºåÂíåÊñπÊ≥ïÂêçÁõ∏ÂêåÔºåÊ≠§Â§ÑÂ∞±ÊòØ visibilityFilter„ÄÇËøîÂõûÁöÑ‰πü‰∏çÊòØÂÆåÊï¥ÁöÑ stateÔºåËÄåÂè™ÊòØ visibilityFilterfunction visibilityFilter(state = '', action) &#123; switch (action.type) &#123; case VISIBILITY_FILTER: return action.filter default: return state &#125;&#125;const todoApp = combineReducers(&#123; visibilityFilter, // visibilityFilter ÊòØ state ‰∏≠ÁöÑ‰∏Ä‰∏™Â±ûÊÄß todos // todos ÊòØ state ‰∏≠ÁöÑ‰∏Ä‰∏™Â±ûÊÄß&#125;)export default todoApp// Ë∞ÉÁî®todoApp(state = initialState, action) &#123; ...&#125; combineReducers() ÊâÄÂÅöÁöÑÂè™ÊòØÁîüÊàê‰∏Ä‰∏™ÂáΩÊï∞ÔºåËøô‰∏™ÂáΩÊï∞Êù•Ë∞ÉÁî®‰Ω†ÁöÑ‰∏ÄÁ≥ªÂàóÁöÑ reducer„ÄÇÊØè‰∏™ reducer ‰ºöÊ†πÊçÆÂÆÉ‰ª¨ÁöÑ keyÔºàreducer ÂêçÔºâ Êù•Á≠õÈÄâÂá∫ state ‰∏≠ÁöÑ‰∏ÄÈÉ®ÂàÜÊï∞ÊçÆÂπ∂Â§ÑÁêÜ„ÄÇÁÑ∂ÂêéËøô‰∏™ÁîüÊàêÁöÑÂáΩÊï∞ÂÜçÂ∞ÜÊâÄÊúâÁöÑ reducer ÁöÑÁªìÊûúÂêàÂπ∂‰∏∫‰∏Ä‰∏™Â§ßÁöÑÂØπË±°„ÄÇ(ÊØè‰∏™Â∞è reducer ÊãøÂà∞ÁöÑ‰∏çÊòØÊï¥‰∏™ÁöÑ stateÔºåËÄåÊòØËøô‰∏™ reducer ÂØπÂ∫îÁöÑ state ‰∏≠ÁöÑÈÉ®ÂàÜÂ±ûÊÄß„ÄÇ‰∏Ä‰∏™ action ÁöÑ type ÂèØ‰ª•ÂΩ±ÂìçÂ§ö‰∏™ reducerÔºåÊúÄÂêéÊØè‰∏™ reducer ÁîüÊàêÁöÑ state ‰∏≠ÁöÑÂ±ûÊÄß‰ºöË¢´ÂêàÂπ∂Âà∞ state ‰∏≠„ÄÇ) Ê≤°ÊúâÊãÜÂàÜÂâçÊòØÊ®™ÂêëÁöÑÔºå‰ª• action.type ‰∏∫Âü∫ÂáÜÁöÑ„ÄÇ‰∏ÄÊ¨° reducer Â§ÑÁêÜ‰∏≠ÔºåËÉΩÂ§ÑÁêÜÂ§ö‰∏™ state ‰∏≠ÁöÑÂ±ûÊÄß„ÄÇ ÊãÜÂàÜ‰πãÂêéÊòØÁ∫µÂêëÁöÑÔºåÊòØ‰ª• state ‰∏≠Â±ûÊÄß‰∏∫Âü∫ÂáÜÁöÑ„ÄÇ‰∏ÄÊ¨° reducer Â§ÑÁêÜÂè™ËÉΩÂ§ÑÁêÜ state ‰∏≠ÁöÑ‰∏Ä‰∏™Â±ûÊÄß„ÄÇÂ§öÊ¨°Â§ÑÁêÜÂêéÔºåÂêàÊàê‰∏Ä‰∏™ÂÆåÊï¥ÁöÑ state„ÄÇ StoreStore ÊòØÊää action Âíå reducer ËÅîÁ≥ªÂà∞‰∏ÄËµ∑ÁöÑÂØπË±°„ÄÇStore Êúâ‰ª•‰∏ãËÅåË¥£Ôºö Áª¥ÊåÅÂ∫îÁî®ÁöÑ stateÔºõ Êèê‰æõ getState() ÊñπÊ≥ïËé∑Âèñ stateÔºõ Êèê‰æõ dispatch(action) ÊñπÊ≥ïÊõ¥Êñ∞ stateÔºõ Êèê‰æõ subscribe(listener) Ê≥®ÂÜåÁõëÂê¨Âô®Ôºõ Êèê‰æõ subscribe(listener) ËøîÂõûÁöÑÂáΩÊï∞Ê≥®ÈîÄÁõëÂê¨Âô®Ôºõ ÂàáËÆ∞Ôºåredux Â∫îÁî®Âè™Êúâ‰∏Ä‰∏™Âçï‰∏ÄÁöÑ store„ÄÇÂΩìÈúÄË¶ÅÊãÜÂàÜÊï∞ÊçÆÂ§ÑÁêÜÈÄªËæëÁöÑÊó∂ÂÄôÔºåÂ∫îËØ•‰ΩøÁî® reducer ÁªÑÂêàËÄå‰∏çÊòØÂàõÂª∫Â§ö‰∏™ store„ÄÇ ÂâçÈù¢‰ΩøÁî® combineReducers() Â∞ÜÂ§ö‰∏™ reducer ÂêàÂπ∂Êàê‰∏Ä‰∏™„ÄÇÁé∞Âú®Ë¶ÅÂ∞ÜÂÖ∂‰º†ÈÄíÁªô createStore() Âç≥ÂèØÂÆåÊàê Store ÁöÑÂàõÂª∫„ÄÇcreateStore() ÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÂèØÈÄâÁöÑÔºåÁî®‰∫éËÆæÁΩÆ state ÁöÑÂàùÂßãÁä∂ÊÄÅ„ÄÇ Êï∞ÊçÆÊµÅ‰∏•Ê†ºÁöÑÂçïÈ°πÊï∞ÊçÆÊµÅÊòØ redux Êû∂ÊûÑÁöÑËÆæËÆ°Ê†∏ÂøÉ„ÄÇËøôÊÑèÂë≥ÁùÄÂ∫îÁî®‰∏≠ÊâÄÊúâÁöÑÊï∞ÊçÆÈÉΩÈÅµÂæ™Áõ∏ÂêåÁöÑÁîüÂëΩÂë®ÊúüÔºåÂèØ‰ª•ËÆ©Â∫îÁî®ÂèòÂæóÂèØ‰ª•È¢ÑÊµãÂíåÂÆπÊòìÁêÜËß£„ÄÇ redux ÁöÑÁîüÂëΩÂë®ÊúüÈÅµÂæ™‰∏ãÈù¢ÂõõÊ≠•Ôºö Ë∞ÉÁî® store.dispatch(action) Redux store Ë∞ÉÁî®‰º†ÂÖ•ÁöÑ reducer ÂáΩÊï∞„ÄÇÂ∞ÜÂΩìÂâçÁöÑ state Ê†ëÂíå action ‰º†ÂÖ• reducer„ÄÇ Ê†π reducer Â∫îËØ•ÊääÂ§ö‰∏™Â≠ê reducer ËæìÂá∫ÂêàÂπ∂Êàê‰∏Ä‰∏™Âçï‰∏ÄÁöÑ state Ê†ë„ÄÇ Redux store ‰øùÂ≠ò‰∫ÜÊ†π reducer ËøîÂõûÁöÑÂÆåÊï¥ state Ê†ë„ÄÇ Êê≠ÈÖç reactÈÄöËøá react-redux Â∞Ü react Âíå redux ËûçÂêà„ÄÇÁªÑ‰ª∂Â∞ÜË¢´ÂàÜ‰∏∫Â±ïÁ§∫ÁªÑ‰ª∂ÂíåÂÆπÂô®ÁªÑ‰ª∂„ÄÇÂ±ïÁ§∫ÁªÑ‰ª∂‰ªÖ‰ªÖÊòØÁî®Êù•Â±ïÁ§∫ÔºåÂÆÉÁöÑÊâÄÊúâÊï∞ÊçÆÈÉΩÊòØ‰ªé props ‰∏≠Ëé∑Âæó„ÄÇËÄåÂÆπÂô®ÁªÑ‰ª∂ÂàôÊòØÂ±ïÁ§∫ÁªÑ‰ª∂ÁöÑÂ§ñÂ±ÇÂ∞ÅË£ÖÔºåÁî®Êù•Âíå redux Êâì‰∫§ÈÅìÔºåÊää state ‰º†ÂÖ•Â±ïÁ§∫ÁªÑ‰ª∂„ÄÇ Â±ïÁ§∫ÁªÑ‰ª∂Â±ïÁ§∫ÁªÑ‰ª∂ÂÄºÂÆö‰πâÂ§ñËßÇÂπ∂‰∏çÊ∂âÂèäÊï∞ÊçÆ‰ªéÂì™ÈáåÊù•ÔºåÂ¶Ç‰ΩïÊîπÂèòÂÆÉ„ÄÇ‰º†ÂÖ•‰ªÄ‰πàÂ∞±Ê∏≤Êüì‰ªÄ‰πà„ÄÇÂ¶ÇÊûúÊää‰ª£Á†Å‰ªé redux ËøÅÁßªÂà∞ÂÖ∂‰ªñÊû∂ÊûÑÔºåËøô‰∫õÁªÑ‰ª∂ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®„ÄÇ‰ªñ‰ª¨Âπ∂‰∏ç‰æùËµñ‰∫é redux„ÄÇ ÂÆπÂô®ÁªÑ‰ª∂ÂÆπÂô®ÁªÑ‰ª∂Â∞ÜÂ±ïÁ§∫ÁªÑ‰ª∂ËøûÊé•Âà∞ reduxÔºàÁõ∏ÂΩì‰∫é‰∏Ä‰∏™ÈÄÇÈÖçÂô®Ôºâ„ÄÇ‰æãÂ¶ÇÔºåÂ±ïÁ§∫ÂûãÁöÑ TodoList ÁªÑ‰ª∂ÈúÄË¶Å‰∏Ä‰∏™Á±ª‰ºº VisibleTodoList ÁöÑÂÆπÂô®ÁªÑ‰ª∂Êù•ÁõëÂê¨ Redux store ÂèòÂåñÂπ∂Â§ÑÁêÜÂ¶Ç‰ΩïËøáÊª§Âá∫Ë¶ÅÊòæÁ§∫ÁöÑÊï∞ÊçÆ„ÄÇ ÊäÄÊúØ‰∏äËÆ≤ÔºåÂÆπÂô®ÁªÑ‰ª∂Â∞±ÊòØ‰ΩøÁî® store.subscribe() ‰ªé Redux state Ê†ë‰∏≠ËØªÂèñÈÉ®ÂàÜÊï∞ÊçÆÔºåÂπ∂ÈÄöËøá props Êù•ÊääËøô‰∫õÊï∞ÊçÆÊèê‰æõÁªôË¶ÅÊ∏≤ÊüìÁöÑÁªÑ‰ª∂„ÄÇÂèØ‰ª•ÊâãÂ∑•ÂºÄÂèëÂÆπÂô®ÁªÑ‰ª∂Ôºå‰ΩÜÊòØÂª∫ËÆÆ‰ΩøÁî® React Redux Â∫ìÁöÑ connect() ÊñπÊ≥ïÊù•ÁîüÊàêÔºåËøô‰∏™ÊñπÊ≥ïÂÅö‰∫ÜÊÄßËÉΩ‰ºòÂåñÊù•ÈÅøÂÖçËÆ∏Â§ö‰∏çÂøÖË¶ÅÁöÑÈáçÂ§çÊ∏≤ÊüìÔºàËøôÊ†∑Â∞±‰∏çÁî®ÊâãÂä®ÂÆûÁé∞ React ÊÄßËÉΩ‰ºòÂåñÂª∫ËÆÆ‰∏≠ÁöÑ shouldComponentUpdate ÊñπÊ≥ï‰∫ÜÔºâ„ÄÇ Âõ†‰∏∫ÂÆπÂô®ÁªÑ‰ª∂ÊòØ state ÂíåÂ±ïÁ§∫ÁªÑ‰ª∂ÁöÑ‰∏≠Èó¥‰ª∂ÔºåÊâÄ‰ª•ÂèØ‰ª•Âú®ËøôÈáåÊåâÈúÄÂÖàÂ§ÑÁêÜ‰∏Ä‰∏ã stateÔºåÁÑ∂ÂêéÂÜçÊääÂ§ÑÁêÜËøáÁöÑ state ‰º†ÁªôÂ±ïÁ§∫ÁªÑ‰ª∂„ÄÇÊâÄ‰ª•ÂèØ‰ª•ÂÆö‰πâ mapStateToProps ÂáΩÊï∞Êù•ÊåáÂÆöÂ¶Ç‰ΩïÊääÂΩìÂâç Redux store state Êò†Â∞ÑÂà∞Â±ïÁ§∫ÁªÑ‰ª∂‰∏≠ÁöÑ props ‰∏≠„ÄÇ ‰æãÂ¶ÇÔºåVisibleTodiList ÈúÄË¶ÅËÆ°ÁÆó‰º†Âà∞ Todolist ‰∏≠ÁöÑ todos ÔºåÊâÄ‰ª•ÂÆö‰πâ‰∫ÜÊ†πÊçÆ state.visibilityFilter Êù•ËøáÊª§ state.todos ÁöÑÊñπÊ≥ïÔºåÂπ∂Âú® mapStateToProps ‰∏≠‰ΩøÁî®Ôºö 12345678910111213141516const getVisibleTodos = (todos, filter) =&gt; &#123; switch (filter) &#123; case 'SHOW_ALL': return todos case 'SHOW_COMPLETED': return todos.filter(t =&gt; t.completed) case 'SHOW_ACTIVE': return todos.filter(t =&gt; !t.completed) &#125;&#125;const mapStateToProps = (state) =&gt; &#123; return &#123; todos: getVisibleTodos(state.todos,state.visibilityFilter) &#125;&#125; Ëøô‰∏™Âú® return ‰∏≠ÁöÑ todos Â∞±Áõ¥Êé•Êàê‰∏∫‰∫ÜËØ•ÊòæÁ§∫ÁªÑ‰ª∂ÁöÑ this.props ÁöÑ‰∏ÄÂëòÔºåÂèØ‰ª•Áõ¥Êé•ÈÄöËøá const {todos} = this.props Ëé∑Âèñ„ÄÇ Èô§‰∫ÜÊòæÁ§∫ÁöÑÊï∞ÊçÆ‰Ωú‰∏∫ props ‰º†ÂÖ•ÔºåÊòæÁ§∫ÁªÑ‰ª∂ËøòÈúÄË¶ÅÂ§ñÈÉ®ÂÆπÂô®ÁªÑ‰ª∂‰º†ÂÖ•‰∏Ä‰∫õ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ï„ÄÇÁ±ª‰ººÁöÑÔºåÂèØ‰ª•ÂÆö‰πâ mapDispatchToProps() ÊñπÊ≥ïÊé•Êî∂ dispatch ÊñπÊ≥ïÂπ∂ËøîÂõûÂ∏åÊúõË¢´Ê≥®ÂÖ•Âà∞Â±ïÁ§∫ÁªÑ‰ª∂ÁöÑ props ‰∏≠ÁöÑÂõûË∞ÉÊñπÊ≥ï„ÄÇ‰æãÂ¶ÇÔºåÊàë‰ª¨Â∏åÊúõ VisibleTodoList Âêë TodoList ÁªÑ‰ª∂‰∏≠Ê≥®ÂÖ•‰∏Ä‰∏™Âè´ onTodoClick ÁöÑÊñπÊ≥ïÂà∞ props ‰∏≠ÔºåËøô‰∏™ onTodoClick ËÉΩ dispatch ‰∏Ä‰∏™ action: 1234567const mapDispathToProps = (dispatch) =&gt; &#123; return &#123; onTodoClick: (id) =&gt; &#123; dispatch(toggleTodo(id)) &#125; &#125;&#125; ‰πüÂ∞±ÊòØËØ¥Ôºå‰∏ç‰ªÖÂèØ‰ª•Êää state ‰øÆÊîπÂ•Ω‰∫Ü‰º†ËøõÂéªÔºå‰πüÂèØ‰ª•ÊääÂìçÂ∫î‰∫ã‰ª∂ËÆæÁΩÆÂ•ΩÔºåÂÜç‰º†ËøõÂéª„ÄÇÂêåÊ†∑ÔºåÂèØ‰ª•Áõ¥Êé•ÈÄöËøá const {onTodoClick} = this.props Ëé∑ÂèñËøô‰∏™ÂìçÂ∫î‰∫ã‰ª∂„ÄÇ ÊúÄÂêéÔºå‰ΩøÁî® connect() ÂàõÂª∫ VisibleTodoList,Â∞Ü‰∏§‰∏™ÂèÇÊï∞‰º†ÂÖ•Ôºö 12345678import &#123; connect &#125; from 'react-redux'const VisibleTodoList = connect( mapStateToProps, mapDispatchToProps)(TodoList)export default VisibleTodoList ÁÑ∂ÂêéÂ§ñÈÉ®Â∞±ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî® VisibileTodoList ÁªÑ‰ª∂‰∫Ü„ÄÇ ÂÆπÂô®ÁªÑ‰ª∂ÂÆû‰æãÔºö ‰º†ÂÖ• StoreÊâÄÊúâÂÆπÂô®ÁªÑ‰ª∂ÈÉΩÂèØ‰ª•ËÆøÈóÆ Redux StoreÔºåÂèØ‰ª•ÊâãÂä®ÁõëÂê¨ storeÔºàËôΩÁÑ∂Áõ¥Êé•ËÆøÈóÆ‰ºöÂ§öÂæàÂ§öÈáçÂ§ç‰ª£Á†ÅÔºâÔºå‰ΩÜÊòØÊé®Ëçê‰ΩøÁî® React Redux ÁªÑ‰ª∂ &lt;Provider&gt; Êù•ËÆ©ÊâÄÊúâÂÆπÂô®ÁªÑ‰ª∂ÈÉΩÂèØ‰ª•ËÆøÈóÆ storeÔºåËÄå‰∏çÂøÖÊòæÁ§∫ÁöÑ‰º†ÈÄíÂÆÉ„ÄÇÂè™ÈúÄË¶ÅÂú®Ê∏≤ÊüìÊ†πÁªÑ‰ª∂Êó∂‰ΩøÁî®Âç≥ÂèØ„ÄÇ 1234567891011121314import React from 'react'import &#123; render &#125; from 'react-dom'import &#123; Provider &#125; from 'react-redux'import &#123; createStore &#125; from 'redux'import todoApp from './reducers'import App from './components/App'let store = createStore(todoApp)render( &lt;Provider store=&#123;store&#125;&gt; &lt;APP /&gt; &lt;/Provider&gt;) ÂÖ≥‰∫é react-reduxreact ‰∏≠ÁöÑÊØè‰∏™Â±ûÊÄßÈÉΩË¶ÅÈÄöËøá props ‰∏ÄÂ±ÇÂ±Ç‰º†ÈÄí„ÄÇÂ¶ÇÊûúÂ±ÇÁ∫ßÂæàÂ§öÔºå‰ºöÊØîËæÉÈ∫ªÁÉ¶„ÄÇÊâÄ‰ª• react ÂºïÂÖ•‰∫Ü context„ÄÇÊüê‰∏™ÁªÑ‰ª∂Âè™Ë¶ÅÂæÄËá™Â∑±ÁöÑ context ÈáåÈù¢Êîæ‰∫ÜÊüê‰∫õÁä∂ÊÄÅÔºåËøô‰∏™ÁªÑ‰ª∂‰πã‰∏ãÁöÑÊâÄÊúâÂ≠êÁªÑ‰ª∂ÈÉΩÁõ¥Êé•ËÆøÈóÆËøô‰∏™Áä∂ÊÄÅËÄå‰∏çÈúÄË¶ÅÈÄöËøá‰∏≠Èó¥ÁªÑ‰ª∂ÁöÑ‰º†ÈÄí„ÄÇ ‰πüÂ∞±ÊòØËØ¥Áà∂ÁªÑ‰ª∂‰∏≠ËÆæÁΩÆ‰∫Ü contextÔºåÂ≠êÁªÑ‰ª∂Â∞±ÂèØ‰ª•ÈÄöËøá this.context.xxx ÊãøÂà∞Áõ∏Â∫îÂ±ûÊÄß‰ΩøÁî®Âπ∂‰øÆÊîπ„ÄÇËøôÂ∞±ÂØºËá¥‰∫ÜÁ¨¨‰∏Ä‰∏™ÈóÆÈ¢òÔºå‰ΩøÁî® context ÊòØÈùûÂ∏∏Âç±Èô©ÁöÑÔºåÂ≠êÁªÑ‰ª∂ÂèØ‰ª•ÈöèÊÑè‰øÆÊîπ„ÄÇËøòÊúâÂè¶‰∏Ä‰∏™ÈóÆÈ¢òÊòØÔºåÂ¶ÇÊûúÊØè‰∏™Â≠êÁªÑ‰ª∂ÈÉΩÊòØÁî® contextÔºåÈÇ£‰πàÁªÑ‰ª∂Â§çÁî®Â∞ÜÂèòÂæóÈùûÂ∏∏Âõ∞Èöæ„ÄÇ ÈíàÂØπÈóÆÈ¢ò‰∏ÄÔºå context Âíå store ÁªìÂêàÁöÑÂ∞±ÈùûÂ∏∏ÁöÑÂÆåÁæé„ÄÇcontext ‰ºöÊãÖÂøÉÂÖ∂‰∏≠Êï∞ÊçÆË¢´ÈöèÊÑè‰øÆÊîπ„ÄÇËÄå store ‰∏≠ÁöÑÊï∞ÊçÆÂè™ËÉΩÈÄöËøá dispatch ‰øÆÊîπ„ÄÇÊâÄ‰ª•ÂèØ‰ª•Êää store ÊñπÂà∞ context ‰∏≠Âéª„ÄÇ ÈíàÂØπÈóÆÈ¢ò‰∫åÔºå‰æøÊúâ‰∫Ü‰∏äÈù¢ÁöÑ connect ÊñπÊ≥ïÔºåÈÄöËøáÊòæÁ§∫ÁªÑ‰ª∂ÁîüÊàêÂÆπÂô®ÁªÑ‰ª∂ÁöÑËøáÁ®ã„ÄÇÊòæÁ§∫ÁªÑ‰ª∂Âè™Ë¥üË¥£Ê†πÊçÆ‰º†ÂÖ•ÁöÑ props ÊòæÁ§∫ÔºåÂíåÁ∫ØÂáΩÊï∞‰∏ÄÊ†∑Ôºå‰æø‰∫éÂ§çÁî®„ÄÇconnect ÊñπÊ≥ïÁîüÊàêÁöÑÂÆπÂô®ÁªÑ‰ª∂Ë¶ÅÂÅöÁöÑÂ∞±ÊòØËé∑Âèñ this.context ‰∏≠ÁöÑ store ËøõËÄå store.getState() ,Êää map ËøáÁöÑ state ‰º†ÁªôÊòæÁ§∫ÁªÑ‰ª∂„ÄÇ ËøôÊ†∑Â±ïÁ§∫ÁªÑ‰ª∂‰∏≠Ëé∑Âèñ context ÈÉΩÁöÑÊìç‰ΩúÈÉΩÊ∂àÂ§±‰∫Ü„ÄÇ‰ΩÜÊòØÂú®ÊúÄÂ§ñÂ±ÇÁªÑ‰ª∂ÈáåËøòÊúâËÆæÁΩÆ context ÁöÑÊìç‰Ωú„ÄÇ‰∏∫‰∫ÜÂ∞ÜËøôÈÉ®ÂàÜËÑè‰ª£Á†ÅÊ∂àÈô§„ÄÇÂ∞± react-redux Êèê‰æõ‰∫Ü‰∏Ä‰∏™ Provider ÁªÑ‰ª∂„ÄÇ‰Ω†Âè™Ë¶Å‰º†ÂÖ•‰∏Ä‰∏™ storeÔºåÂÆÉÂ∞±‰ºöÊääÂÆÉÊîæÂà∞ context ‰∏≠Âéª„ÄÇ È´òÁ∫ßÂºÇÊ≠• ActionÂ¶Ç‰ΩïÊää‰πãÂâçÂÆö‰πâÁöÑÂêåÊ≠• action ÂàõÂª∫ÂáΩÊï∞ÂíåÁΩëÁªúËØ∑Ê±ÇÁªìÂêàËµ∑Êù•ÔºüÊ†áÂáÜÂÅöÊ≥ïÊòØ‰ΩøÁî® Redux Thunk middleware„ÄÇË¶ÅÂºïÂÖ• redux-thunk Ëøô‰∏™‰∏ìÈó®ÁöÑÂ∫ìÊâçËÉΩ‰ΩøÁî®„ÄÇ ÈÄöËøá‰ΩøÁî®ÊåáÂÆöÁöÑ middlewareÔºåaction ÂàõÂª∫ÂáΩÊï∞Èô§‰∫ÜËøîÂõû action ÂØπË±°Â§ñÔºåËøòÂèØ‰ª•ËøîÂõûÂáΩÊï∞„ÄÇËøôÊó∂ÔºåËøô‰∏™ action ÂàõÂª∫ÂáΩÊï∞Â∞±Êàê‰∏∫‰∫Ü thunk„ÄÇ ÂΩì action ÂàõÂª∫ÂáΩÊï∞ËøîÂõûÂáΩÊï∞Êó∂ÔºåËøô‰∏™ÂáΩÊï∞‰ºöË¢´ Redux Thunk middleware ÊâßË°å„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÊú¨Êù•Ë¶Å dispatch ‰∏Ä‰∏™ js ÂØπË±°ÁöÑ action ÁöÑÔºåÁé∞Âú® dispatch ‰∏Ä‰∏™ÂáΩÊï∞ÔºåËøô‰∏™ÂáΩÊï∞Áî®Êù•Ëé∑ÂèñÁΩëÁªúÊï∞ÊçÆÔºåÁÑ∂ÂêéÂú®Ëøô‰∏™ÂáΩÊï∞Èáå dispatch ËØ∑Ê±ÇÂæóÂà∞ÁöÑÊï∞ÊçÆ„ÄÇÊúÄÂºÄÂßãË∞ÉÁî®ÁöÑ dispatch Âú®Âà§Êñ≠ÂØπË±°ÊòØÂáΩÊï∞ÂêéÔºåÂ∞±Ê≤°ÊúâÂÖ∂‰ªñ‰ΩúÁî®‰∫Ü„ÄÇ ‰∏≠Èó¥‰ª∂Â∞±ÊòØÂú®‰º†ÂÖ• action ÂêéÂíåÂú®ÁúüÊ≠£ dispatch ÂâçÊèíÂÖ•‰∏Ä‰∫õÈÄªËæë„ÄÇthunk ‰∏≠Èó¥‰ª∂Â∞±ÊòØÊèíÂÖ•‰∫ÜÂà§Êñ≠ dispatch ‰º†ÂÖ•ÁöÑÊòØ‰∏çÊòØÂáΩÊï∞ÁöÑÈÄªËæëÔºåÊòØÂáΩÊï∞Â∞±Ë∞ÉÁî®Ôºå‰∏çÊòØÂáΩÊï∞ÔºåÂ∞±ÂíåÊôÆÈÄöÊñπÂºè‰∏ÄÊ†∑Áõ¥Êé• dispatch Êàë‰ª¨Ë¶ÅÂ¶Ç‰ΩïÂú® dispatch Êú∫Âà∂‰∏≠ÂºïÂÖ• Redux Thunk middleware Âë¢Ôºü‰ΩøÁî® applyMiddleware: 123456789impoort thunkMiddleware from 'redux-thunk'const store = createStore( rootReducer, applyMiddleware( thunkMiddleware ))store.dispatch(fetchPosts('reactjs')).then(() =&gt; console.log(store.getState())) // fetchPosts ÂáΩÊï∞ÊòØ‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑÂáΩÊï∞ÔºåÂú®ÈáåÈù¢‰ºöËøõË°åÁΩëÁªúËØ∑Ê±Ç Âπ∂‰∏çÊòØËØ¥ thunk ÊòØÂîØ‰∏ÄËß£ÂÜ≥ÊñπÂºèÔºåËøòÂèØ‰ª•‰ΩøÁî® redux-promiseÔºåredux-promise-middleware„ÄÇ ÈúÄË¶Å‰∫ÜËß£ÁöÑÊòØËøôÁßçÂ§ÑÁêÜÂºÇÊ≠•ÁöÑÊñπÂºè„ÄÇ MiddlewareÊàë‰ª¨Áü•ÈÅìÔºåÊàë‰ª¨ store.dispatch(action) ÂêéÔºådispatch ÊñπÊ≥ï‰∏≠‰ºöË∞ÉÁî® reducer „ÄÇ‰ΩÜÊòØÊàë‰ª¨ÂæàÂ§öÊó∂ÂÄôÂ∏åÊúõÂú®ÊâßË°å reducer ‰πãÂâçÊàñËÄÖ‰πãÂêéÂÅö‰∏Ä‰∫õÂÖ∂‰ªñÁöÑÊìç‰ΩúÔºåÊØîÂ¶ÇËÆ∞ÂΩïÊó•ÂøóÁ≠âÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÈúÄË¶Å‰ΩøÁî® middleware„ÄÇ middleware ÊâÄÂÅöÁöÑÂ∞±ÊòØÊõøÊç¢ redux Êèê‰æõÁöÑ dispatch ÊñπÊ≥ï: 1234567let next = store.dispatchstore.dispatch = function dispatchAndLog(action) &#123; console.log(action) let result = next(action) console.log(store.getState()) return result&#125; ÂèØ‰ª•ÁúãÂà∞ÔºåÁé∞Âú® store.dispatch ‰∏Ä‰∏™ action ÁöÑÂâçÂêéÈÉΩ‰ºöÊâßË°å log„ÄÇÂπ∂‰∏îÁé∞Âú®ÁöÑ dispatch Ëøò‰ºöËøîÂõûÂéüÊú¨ÁöÑ dispatch ÁöÑËøîÂõûÂÄº(ËôΩÁÑ∂ËøôÈáåÂéüÊú¨ÁöÑ dispatch ÊòØ redux ÁöÑ dispatch Ôºå‰∏çÂèçÂõû‰ªª‰ΩïÔºå‰ΩÜÊòØÂ¶ÇÊûú middleware ‰øÆÊîπËøáÁöÑ dispatch ÂèØËÉΩ‰ºöËøîÂõû resultÔºåÊâÄ‰ª•ËøòÊòØÈúÄË¶Å return ÁöÑ) Áé∞Âú®Êàë‰ª¨ËÄÉËôëÊúâÂ§ö‰∏™ middleware ÈúÄË¶ÅÂ∫îÁî®„ÄÇÊàë‰ª¨ÈúÄË¶ÅÊää‰∏ä‰∏Ä‰∏™ middleware ‰øÆÊîπËøáÁöÑ dispatch ‰º†ÂÖ• ‰∏ã‰∏Ä‰∏™ middleware„ÄÇÈÇ£‰πàËÄÉËôëËøô‰∏™‰∏≠Èó¥‰ª∂ÊñπÊ≥ïÈúÄË¶ÅÂá†‰∏™ÂèÇÊï∞ÔºöstoreÔºå‰∏ä‰∏Ä‰∏™‰∏≠Èó¥‰ª∂‰øÆÊîπËøáÁöÑ dispatchÔºåaction„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈááÁî®ÂáΩÊï∞ÂºèÔºö 123456789101112const logger = store =&gt; next =&gt; action =&gt; &#123; console.log(action) let result = next(action) console.log(store.getState()) return result&#125;const thunk = store =&gt; next =&gt; action =&gt; &#123; typeof action === 'function' ? action(store.dispatch, store.getState) : next(action)&#125; ËøôÊ†∑ÔºåÂú® createStore() ÁöÑÊó∂ÂÄôÔºå‰∏çÂè™ÊòØ‰º†ÂÖ•‰∏Ä‰∏™ reducerÔºåËøòÂåÖÊã¨‰∏Ä‰∏™‰∏≠Èó¥‰ª∂ÂèÇÊï∞Ôºö 1234567let store = createStore( todoApp, applyMiddleware( logger, thunk, )) applyMiddleware Â∫îËØ•ÂÅöÁöÑÊòØËøôÊ†∑‰∏Ä‰∏™Êìç‰ΩúÔºö 123store.dispatch = middlewares.reduce((middleware, preDispatch) =&gt; &#123; return middleware(store)(preDispatch)&#125;, store.dispatch) ÊâÄ‰ª•ÊúÄÁªàÁöÑ dispatch ‰ºöÊòØ‰∏Ä‰∏™Â§öÂ±Ç middleware ÂµåÂ•óÁöÑÁªìÊûÑÔºåÊØè‰∏Ä‰∏™ middleware ‰∏≠ÁöÑ next(action) ÈÉΩÊòØÊâßË°åÊåáÂêë‰∏ã‰∏Ä‰∏™ middlewareÔºåËÄåÊâßË°å store.dispatch(action) Â∞±ÊòØÈáçÊñ∞ÊâßË°å‰∏ÄÈÅç middleware Èìæ„ÄÇÂ¶ÇÂõæÔºö ÁªÑÁªá reducerÂØπ‰∫éÂçï‰∏™ÁöÑ reducerÔºåÈ°πÁõÆÂ§çÊùÇÂêéÔºåreducer ÂèØËÉΩ‰ºöÂèòÂæóÈùûÂ∏∏ÁöÑÈïøÔºö 1234567891011121314151617181920function appReducer(state = &#123;&#125;, action) &#123; switch(action.type) &#123; case 'ADD_TODO' : &#123; return Object.assign(&#123;&#125;, state, &#123; todos: state.todos + action.add &#125;) &#125; case 'TOGGLE_TODO' : &#123; return Object.assgin(&#123;&#125;, state, &#123; todos: state.todos + action.toggle &#125;) &#125; case 'SET_VISIBILITY_FILTER' : &#123; return Object.assign(&#123;&#125;, state, &#123; visibilityFilter: action.filter &#125;) &#125; ... &#125;&#125; ÂèØ‰ª•ÁúãÂà∞ÔºåËøôÊ†∑ÁöÑ‰ª£Á†ÅÂê´Êúâ‰∏§‰∏™ÈóÆÈ¢òÔºö Â§ö‰∏™Â≠óÊÆµÁöÑÂ§ÑÁêÜÈÄªËæëÈÉΩÊîæÂú®‰∏Ä‰∏™ÊñπÊ≥ïÈáåÔºå‰∏çÂ§üÊ∏ÖÊô∞ ‰ºöÂåÖÂê´ÈùûÂ∏∏Â§öÁöÑ switch‚Ä¶case‚Ä¶ ÊñπÊ≥ïÔºåÂæàÂ§öÂÜó‰Ωô‰ª£Á†Å ÂàÜÁ¶ªÂ≠óÊÆµÈíàÂØπÁ¨¨‰∏Ä‰∏™ÈóÆÈ¢òÊàë‰ª¨ÂèØ‰ª•‰∏∫ÊØè‰∏™Â≠óÊÆµÈÉΩÂÆûÁé∞‰∏Ä‰∏™Â≠ê reducerÔºåÁÑ∂ÂêéÊääÂêÑÈÉ®ÂàÜËøîÂõûÁöÑÁªìÊûúÁªÑÂêàÔºö 123456789101112131415161718192021222324252627282930313233function setVisibilityFilter(visibilityState, action) &#123; return action.filter&#125;function addTodo(todoState, action) &#123; return todoState + action.add&#125;function toggleTodo(todoState, action) &#123; return todoState + action.toggle&#125;function visibilityReducer(visibilityState = 'SHOW_ALL', action) &#123; switch(action.type) &#123; case 'SET_VISIBILITY_FILTER' : return setVisibilityFilter(visibilityState, action) default : return visibilityState &#125;&#125;function todosReducer(todoState, action) &#123; switch(action.type) &#123; case 'ADD_TODO' : return addTodo(todoState, action) case 'TOGGLE_TODO': return toggleTodo(todoState, action) default : return todosState &#125;&#125;function appReducer (state = &#123;&#125;, action) &#123; return &#123; todos: todosReducer(state.todos, action) visibilityFilter: visibilityReducer(state.visibilityFilter, action) &#125;&#125; ËøôÊ†∑ÁöÑÂÜôÊ≥ïÊääÂêÑ‰∏™Â≠óÊÆµÂàÜÂà´Â§ÑÁêÜÔºåÈÄªËæëÂ∞±Ê∏ÖÊô∞‰∫ÜÂæàÂ§ö„ÄÇcombineReducers ÂÖ∂ÂÆûÂÅöÁöÑÂ∞±ÊòØÂêåÊ†∑ÁöÑ‰∫ã„ÄÇ ÂáèÂ∞ëÊ†∑Êùø‰ª£Á†ÅÈíàÂØπÈóÆÈ¢ò‰∫åÊèêÂà∞ÁöÑ switch...case‚Ä¶ ‰∫ßÁîüÁöÑÊ†∑Êùø‰ª£Á†ÅÔºåjs ÁöÑËØ≠Ë®ÄÁâπÊÄßÂèØ‰ª•ÂæàÂ•ΩÂú∞Ê∂àÈô§Ôºö 123456789101112131415161718192021222324252627282930function addTodo(todoState, action) &#123; return todoState + action.add&#125;function toggleTodo(todoState, action) &#123; return todoState + action.toggle&#125;// Ê∂àÈô§Ê†∑Êùø‰ª£Á†ÅÁöÑ‰∏ªË¶ÅÊñπÊ≥ïfunction createReducer(initialState, handlers) &#123; return function reducer(state = initialState, action) &#123; if (handlers.hasOwnProperty(action.type)) &#123; return handlers[action.type](state, action) &#125; else &#123; return state &#125; &#125;&#125;const todoReducer = createReducer(&#123;&#125;, &#123; addTodo, toggleTodo,&#125;)function appReducer (state = &#123;&#125;, action) &#123; return &#123; todos: todosReducer(state.todos, action) visibilityFilter: visibilityReducer(state.visibilityFilter, action) &#125;&#125; Áî®ÊñπÊ≥ïÂêçÊù•Êõø‰ª£ caseÔºå‰πüÂ∞±ÊòØÊõø‰ª£ action.type„ÄÇÁÑ∂ÂêéÊääËøô‰∫õÊñπÊ≥ïÂêàÂú®‰∏ÄËµ∑ÁîüÊàê‰∏Ä‰∏™ reducer„ÄÇËøôÁßçÊñπÂºèÂ∞±ÊòØÁ±ª‰ºº redux-actions ‰∏≠ handleActions ÁöÑÂÆûÁé∞ÊñπÂºè„ÄÇ Ëøô‰∏ÄÂ∞èËäÇÂÖ∂ÂÆûÊòØÈùûÂ∏∏ÈáçË¶ÅÁöÑ„ÄÇ‰ªãÁªç‰∫Ü‰∏§‰∏™ reducer ÁöÑÂ§ÑÁêÜÊñπÂºè Â∞Ü‰∏Ä‰∏™ reducer ÊãÜÂàÜÊàêÂ§ö‰∏™Â∞è reducerÔºåÊØè‰∏Ä‰∏™ reducer Âè™Ë¥üË¥£ state ‰∏≠Áõ∏ÂØπÂ∫îÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇËøôÊ†∑ÁöÑÊãÜÂàÜÂèØ‰ª•ÊòØÂ§öÂ±ÇÁ∫ßÁöÑÔºåÂç≥Â∞è reducer ÂèØ‰ª•ÊãÜÂàÜÊàêÂæàÂ§öÂæàÂ§öÂ∞èÂ∞è reducer„ÄÇÂÖ∑‰ΩìËßÅ‰∏ãÂõæ Âú®ÊØè‰∏Ä‰∏™ÊúÄÂ∞èÁ≤íÂ∫¶ÁöÑ reducer ‰∏≠ÔºåÂèàÊ†πÊçÆ‰∏çÂêåÁöÑ action.type ÊãÜÂàÜÂá∫ËÆ∏Â§ö‰∏é‰πãÂØπÂ∫îÁöÑÊñπÊ≥ï„ÄÇËøô‰∫õÊñπÊ≥ïÁªÑÂêàÊàê reducer„ÄÇredux ‰ºöÈÅçÂéÜÊâÄÊúâÁöÑ reducer ÊâæÂá∫ÂØπÂ∫î action.type ÁöÑÂ§ÑÁêÜÊñπÊ≥ïÔºåÊâÄ‰ª•‰∏çÂêåÊ®°Âùó‰∏ÄËà¨Ë¶ÅÂú®Ëøô‰∫õÊñπÊ≥ïÂâçÂä†‰∏ä namespace ÁöÑÂâçÁºÄÔºåÂê¶ÂàôÂÆπÊòì‰∏Ä‰∏™ action Ëß¶ÂèëÂ§ö‰∏™ÂêåÂêç(action.type Áõ∏Âêå)ÊñπÊ≥ï„ÄÇ Â∏∏ËßÅÈóÆÈ¢òRedux Âè™ËÉΩÊê≠ÈÖç ReactÔºüRedux ÂèØ‰ª•‰Ωú‰∏∫‰ªª‰Ωï UI Â±ÇÁöÑ store„ÄÇ‰ΩÜÊòØ‰∏ÄËà¨Âú®ÁªìÂêà UI Èöè state ÂèòÂåñÊó∂ÔºåRedux ËÉΩÂèëÊå•ÊúÄÂ§ßÁöÑ‰ΩúÁî®„ÄÇ ReducerÂ¶Ç‰ΩïÂú® reducer Èó¥ÂÖ±‰∫´ stateÔºücombineReducers ÊòØÂøÖÈ°ªÁöÑÂêóÔºüredux store Êé®ËçêÁªìÊûÑÊòØÂ∞Ü state ÂàÜÊàê‚ÄùÂ±Ç‚ÄùÔºåÂπ∂Êèê‰æõÁã¨Á´ãÁöÑ reducer ÊñπÊ≥ïÁÆ°ÁêÜÂêÑËá™ÁöÑÊï∞ÊçÆÂ±Ç„ÄÇ ËÆ∏Â§öÁî®Êà∑ÊÉ≥Ë¶ÅÂú® reducer ‰πãÈó¥ÂÖ±‰∫´Êï∞ÊçÆÔºå‰ΩÜÊòØ combineReducers‰∏çÂÖÅËÆ∏Ê≠§ÁßçË°å‰∏∫„ÄÇÂ¶ÇÊûú‰∏ÄÂÆöË¶ÅËøôÊ†∑ÂÅöÔºå‰Ω†ÈúÄË¶ÅÔºö ÈáçÊûÑ state Â±ÇÔºåËÆ©ÂçïÁã¨ÁöÑ reducer Â§ÑÁêÜÊõ¥Â§öÁöÑÊï∞ÊçÆ„ÄÇ Ëá™ÂÆö‰πâÊñπÊ≥ïÂ§ÑÁêÜËøô‰∫õ actionÔºåÁî®Ëá™ÂÆö‰πâÁöÑÈ°∂Â±Ç reducer ÊñπÊ≥ïÊõøÊç¢ combineReducers „ÄÇ‰ΩøÁî® combineReducers Â§ÑÁêÜÂ∞ΩÂèØËÉΩÂ§öÁöÑ actionÔºåÂêåÊó∂‰∏∫Â≠òÂú® state ‰∫§ÂèâÈÉ®ÂàÜÁöÑ action ÊâßË°åÊõ¥‰∏ìÁî®ÁöÑ reducer„ÄÇ Á±ª‰ºº‰∫é redux-thunk ÁöÑÂºÇÊ≠• action ÂàõÂª∫ÂáΩÊï∞ÂèØ‰ª•ÈÄöËøá getState() ÊñπÊ≥ïËé∑ÂèñÊâÄÊúâÁöÑ state„ÄÇaction ÂàõÂª∫ÂáΩÊï∞ËÉΩ‰ªé state ‰∏≠Ê£ÄÁ¥¢Âà∞È¢ùÂ§ñÁöÑÊï∞ÊçÆÂπ∂‰º†ÂÖ• action„ÄÇÊâÄ‰ª• reducer ÊúâË∂≥Â§üÁöÑ‰ø°ÊÅØÂéªÊõ¥Êñ∞ state Â±Ç„ÄÇ Â§ÑÁêÜ action ÂøÖÈ°ª‰ΩøÁî® switch ËØ≠Âè•ÂòõÔºü‰∏çÂøÖË¶ÅÔºå‰ΩÜÊòØ switch ÊòØÊúÄÂ∏∏Áî®ÁöÑÊñπÂºè„ÄÇ‰πüÂèØ‰ª•Áî® if ÊàñËÄÖ‰∏äÈù¢ÁªÑÁªá reducer ‰∏≠‰ΩøÁî®ÁöÑÊñπÂºè„ÄÇ StateÊòØÂê¶ÊâÄÊúâ state ÈÉΩÁª¥Êä§Âú® redux ‰∏≠Ôºü‰∏ÄËà¨Êù•ËØ¥‰∏öÂä°Êï∞ÊçÆÊîæÂú® redux ‰∏≠ÔºåÈ°µÈù¢Êï∞ÊçÆÂàô‰∏çÂøÖË¶Å„ÄÇ StoreÂèØ‰ª•ÂàõÂª∫Â§ö‰∏™ store ÂòõÔºüÊúÄÂ•Ω‰∏çË¶ÅÂàõÂª∫Â§ö‰∏™ storeÔºåËÄåÊòØÂ∞ùËØïÁªÑÂêà reducer„ÄÇ ËÉΩÂú®ÁªÑÂª∫ÈáåÁõ¥Êé•‰ΩøÁî® store Âπ∂‰ΩøÁî®ÂêóÔºüÊúÄÂ•Ω‰∏çË¶ÅÁõ¥Êé•Ëé∑Âèñ store ÂÆû‰æã„ÄÇÂÄüÂä© react-reduxÔºåÁî± connect() Â∞Ü &lt;Provider store={store}&gt; ‰º†ÂÖ•ÁöÑ store ÈÄöËøá mapStateToProps ‰º†ÂÖ•Â≠êÁªÑ‰ª∂„ÄÇ ÊÄßËÉΩÊØè‰∏™ action ÈÉΩË∞ÉÁî®ÊâÄÊúâÁöÑ reducer ‰ºö‰∏ç‰ºöÂæàÊÖ¢Ôºü‰∏ç‰ºö reducer ‰∏≠ÂøÖÈ°ªÂØπ state ËøõË°åÊ∑±Êã∑Ë¥ù‰πàÔºü‰Ω†ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™ state ÁöÑÂâØÊú¨Ôºå‰ΩÜÊòØ state ‰∏≠ÁöÑÊ≤°ÊúâÂèòÂåñÁöÑÊï∞ÊçÆÔºåËøòÊòØ‰ΩøÁî®ÊµÖÊã∑Ë¥ùÔºåÂèòÂåñÁöÑÊâç‰ºöÂàõÂª∫Êñ∞ÁöÑÂºïÁî®„ÄÇ react redux‰∏∫‰ΩïÁªÑ‰ª∂Ê≤°ÊúâË¢´ÈáçÊñ∞Ê∏≤ÊüìÔºåÊàñËÄÖ mapStateToProps Ê≤°ÊúâËøêË°åÔºüaction ÂàÜÂèëÂêéÊ≤°ÊúâÈáçÊñ∞Ê∏≤ÊüìÔºåÊúÄ‰∏ªË¶ÅÁöÑÂéüÂõ†ÊòØÂØπ state ËøõË°å‰∫ÜÁõ¥Êé•‰øÆÊîπ„ÄÇReact Redux ‰ºöÂú® shouldComponentUpdate ‰∏≠ÂØπÊñ∞ÁöÑ props ËøõË°åÊµÖÂ±ÇÁöÑÂà§Á≠âÊ£ÄÊü•„ÄÇÂ¶ÇÊûúÊâÄÊúâÁöÑÂºïÁî®ÈÉΩÊòØÁõ∏ÂêåÁöÑÔºåÈÇ£‰πàËøîÂõû false ‰ªéËÄåË∑≥ËøáÊ≠§Ê¨°ÁªÑ‰ª∑‰Ω†ÁöÑÊõ¥Êñ∞„ÄÇ ÊâÄ‰ª•ÔºåË¶ÅÊ≥®ÊÑèÔºå‰∏çÁÆ°‰ΩïÊó∂Êõ¥Êñ∞‰∫Ü‰∏Ä‰∏™ÂµåÂ•óÂÄºÔºåÈÉΩÂøÖÈ°ªËøîÂõû‰∏äÂ±ÇÁöÑÊï∞ÊçÆÁöÑÂâØÊú¨Áªô state Ê†ë„ÄÇÂç≥Â¶ÇÊûúÊï∞ÊçÆÊòØ state.a.b.c.d ‰∏≠ÁöÑ d ÂèòÂåñÔºå‰Ω†‰πüÂøÖÈ°ªËøîÂõû c,b,a,state ÁöÑÊã∑Ë¥ù„ÄÇ ‰∏∫‰ΩïÁªÑ‰ª∂È¢ëÁπÅÈáçÊñ∞Ê∏≤ÊüìÔºüreact redux ÂÅö‰∫Ü‰ºòÂåñÔºå‰ºöÂØπ mapStateToProps ‰º†ÂÖ•ÁöÑ props Âà§Á≠â„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÊØèÊ¨° mapStateToProps ÈÉΩÁîüÊàêÊñ∞ÁöÑÂØπË±°ÂÆû‰æãÁöÑËØùÔºåËøôÁßçÂà§Á≠âÂ∞±Ê≤°ÊúâÁî®Â§Ñ‰∫Ü„ÄÇÊØîÂ¶ÇÔºö 12345const mapStateToProps = (state) =&gt; &#123; return &#123; objects: state.objectIds.map(id =&gt; state.objects[id]) &#125;&#125; ÈÄöËøá map ‰ºöÁîüÊàêÊñ∞ÁöÑÂÆû‰æã„ÄÇÊâÄ‰ª•Âà§Á≠â‰πüÂ∞±‰∏çÂèØËÉΩÊàêÂäü‰∫Ü„ÄÇ ËøôÁßçÂèØ‰ª•‰ΩøÁî® ReselectÔºåÂú® mapStateToProps ÂâçÂ∞±ËøõË°åÂà§Êñ≠ÊòØÂê¶ÈúÄË¶Å map state„ÄÇ redux Â∫îËØ•Âè™ËøûÊé•Âà∞È°∂Â±ÇÁªÑ‰ª∂ÂòõÔºüÂπ∂‰∏çÊòØ„ÄÇÂΩì‰Ω†ÊÑüËßâÂà∞‰Ω†ÊòØÂú®Áà∂ÁªÑ‰ª∂ÈáåÈÄöËøáÂ§çÂà∂‰ª£Á†Å‰∏∫Êüê‰∫õÂ≠êÁªÑ‰ª∂Êèê‰æõÊï∞ÊçÆÊó∂ÔºåÂ∞±ÂèØ‰ª•ÊäΩÂá∫‰∏Ä‰∏™ÂÆπÂô®ÁªÑ‰ª∂‰∫Ü„ÄÇÂè™Ë¶Å‰Ω†ËÆ§‰∏∫Áà∂ÁªÑ‰ª∂ËøáÂ§ö‰∫ÜËß£Â≠êÁªÑ‰ª∂ÁöÑÊï∞ÊçÆÊàñËÄÖ actionÔºåÂ∞±ÂèØ‰ª•ÊäΩÂèñÂÆπÂô®„ÄÇ Genji4rnGenji4rn.js ÊòØ‰∏Ä‰∏™ÂÄüÈâ¥‰∫Ü Dva.js ÁöÑÊ°ÜÊû∂„ÄÇÈõÜÊàê‰∫Ü router ‰ª•Âèä redux„ÄÇËøôÈáå‰∏ªË¶ÅËÆ®ËÆ∫ redux Áõ∏ÂÖ≥ÈÉ®ÂàÜÁöÑ RN ‰∏≠ÁöÑÂÆûÁé∞„ÄÇ ÈúÄÊ±ÇÂàÜÊûêÂú®ÂàÜÊûê‰∏Ä‰∏™Ê°ÜÊû∂ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÈúÄË¶ÅÊÄùËÄÉÔºåËøô‰∏™Ê°ÜÊû∂ÈúÄË¶ÅÂ∏ÆÂä©‰ΩøÁî®ËÄÖÂÆåÊàêÈÇ£‰∫õÊ≠•È™§Ôºå‰ª•ÂèäÈúÄË¶Å‰ΩøÁî®ËÄÖÊèê‰æõÂì™‰∫õ‰∏úË•ø„ÄÇ ÈÄöËøáÂâçÈù¢ redux ÁöÑÂ≠¶‰π†ÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞ÔºåÁî®Êà∑Ê≤°ÊúâÂøÖË¶ÅÁü•ÈÅì Store ÊòØÂ¶Ç‰ΩïÂàõÂª∫ÁöÑÔºàcreateStoreÔºâÔºåÊ≤°ÊúâÂøÖË¶ÅÁü•ÈÅì reducer ÊòØÂ¶Ç‰ΩïÂêàÊàêÁöÑ(combineReducer)ÔºåÊ≤°ÊúâÂøÖË¶ÅÁü•ÈÅì redux ÂàÜÂèë‰∫ã‰ª∂ dispatch,Ê≤°ÊúâÂøÖË¶ÅÁü•ÈÅìÊ†πËßÜÂõæ ProviderÔºåÊ≤°ÊúâÂøÖË¶ÅÁü•ÈÅì state Ê†ëÂ¶Ç‰ΩïÂΩ¢ÊàêÁöÑÔºåÊ≤°ÊúâÂøÖË¶ÅÁü•ÈÅì reducer Âíå state ‰∏≠Â±ûÊÄß‰∏Ä‰∏ÄÂØπÂ∫îÔºåÊ≤°ÊúâÂøÖË¶ÅÁü•ÈÅì mapStateToProps ‰ª•Âèä mapDispatchToPropsÔºåÊ≤°ÂøÖË¶ÅÁü•ÈÅì applyMiddlewareÔºåÊ≤°ÂøÖË¶ÅÁü•ÈÅì action.type Âà§Êñ≠ÁöÑ switch‚Ä¶case‚Ä¶„ÄÇ ÈúÄË¶Å‰ΩøÁî®ËÄÖÊèê‰æõÁöÑÊòØÔºåÂì™‰∫õÊñπÊ≥ï‰ª•ÂèäÂì™‰∫õÂ±ûÊÄßÊòØÈúÄË¶Å‰Ωú‰∏∫ props ‰º†ÂÖ•Ê®°ÂùóÁöÑÔºå props ‰∏≠ÁöÑÊñπÊ≥ïÈúÄË¶ÅÊâßË°å‰ªÄ‰πàÂºÇÊ≠•Êìç‰Ωú(action)Ôºå‰ª•ÂèäÂ¶Ç‰ΩïÂΩ±Âìç props ‰∏≠ÁöÑÂ±ûÊÄßÁöÑ(state)„ÄÇ Â∏¶ÁùÄ‰∏äÈù¢ÁöÑÊÉ≥Ê≥ïÔºåÊàë‰ª¨ÂèØ‰ª•Â§ßÊ¶ÇÊé®Êµã‰∏Ä‰∏ã Genji4rn ÂÅö‰∫Ü‰ªÄ‰πà„ÄÇ ‰∏∫ÊØè‰∏Ä‰∏™Ê®°ÂùóËÆæÁΩÆ‰∏Ä‰∏™ reducer„ÄÇËøô‰∏™ reducer Â∫îËØ•Âíå state ‰∏≠Áõ∏Â∫îÂ±ûÊÄßÂêåÂêç„ÄÇÊØè‰∏™ reducer ‰∏≠Â∫îËØ•ÂåÖÂê´ÂæàÂ§öÁöÑÊñπÊ≥ïÔºåËøô‰∫õÊñπÊ≥ï‰ª£Ë°®ÁùÄ‰∏çÂêåÁöÑ action.type ÁöÑÂ§ÑÁêÜÊñπÊ≥ï„ÄÇ‰∏∫‰∫ÜÂíåÂÖ∂‰ªñÊ®°ÂùóÁöÑ action.type ÁöÑÂ§ÑÁêÜÊñπÊ≥ï‰∏çÈáçÂêçÔºåËøòÈúÄË¶Å‰∏∫Ëøô‰∫õÊñπÊ≥ïÊ∑ªÂä†Ê®°ÂùóÁâπÊúâÁöÑÂâçÁºÄ„ÄÇÂú® dispatch(action) ÁöÑÊó∂ÂÄôÔºåtype Â∞±Ë¶ÅÊòØÂåÖÂê´ÂâçÁºÄÁöÑÊñπÊ≥ïÂêç„ÄÇ ÈöêËóè‰ªª‰ΩïÂÖ≥‰∫é redux ÁöÑ‰∏úË•ø„ÄÇstate ‰∏çÈúÄË¶Å‰ªé store ‰∏≠Âèñ„ÄÇËÆæÁΩÆ state ÁöÑÊó∂ÂÄôÔºå‰πü‰∏çË¶ÅÂá∫Áé∞ dispatch ÊñπÊ≥ï„ÄÇ ‰ΩøÁî®È¶ñÂÖàÂú® RN ÁöÑÂÖ•Âè£ index.ios.js ‰∏≠Ôºö 1234567891011121314151617181920import Genji4rn from 'Genji4rnjs/mobile'import React, &#123; Component &#125; from 'react'const App = new Genji4rn()App.registerModule(require('./modules/properties'))App.registerModule(require('./modules/todoApp'))const AppComponent = App.start()class CRM extends Component &#123; constructor(props) &#123; super(props); &#125; render() &#123; return &lt;AppComponent /&gt; &#125;&#125; React.AppRegistry.registerComponent('reactNativeCrm', () =&gt; CRM); ÈÄöËøá Genji4rn ÂÆû‰æãÁöÑ registerModule ÊñπÊ≥ïÂèØ‰ª•Ê≥®ÂÜåÊ®°Âùó„ÄÇÊ®°ÂùóÁ§∫‰æãÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122import &#123; connect &#125; from 'Genji4rnjs'import model from './model'module.exports = &#123; models: model, views: &#123; TodoApp: connect((state) =&gt; &#123; return &#123; ...state.todoApp, todos: state.todoApp.todos.filter(todo =&gt; &#123; if (state.todoApp.filter === VisibilityFilters.ALL) &#123; return true; &#125; else if (state.todoApp.filter === VisibilityFilters.COMPLETED) &#123; return todo.completed; &#125; else if (state.todoApp.filter === VisibilityFilters.INCOMPLETE) &#123; return !todo.completed; &#125; &#125;) &#125; &#125;, model)(require('./views/index.js')) &#125;&#125; ÂºïÂÖ•‰∫ÜÂíåÊñπÊ≥ïÁõ∏ÂÖ≥ÁöÑ model ‰ª•ÂèäÂíåËßÜÂõæÁõ∏ÂÖ≥ÁöÑ view„ÄÇÂØºÂá∫ models ‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÂØºÂá∫Ê®°ÂùóÁöÑ state ‰ª•Âèä reducerÔºå‰ª•Ê≠§ÂàõÂª∫ store„ÄÇÂØºÂá∫ view ÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®‰∫Ü Genji4rn Êèê‰æõÁöÑ connect Êää‰∏§ËÄÖÁªÑÂêàÔºåÂÖ∂ÂÆûÂ∞±ÊòØÁõ∏ÂΩì‰∫éËÆæÁΩÆÈáå mapStateToProps Âíå mapDispatchToProps„ÄÇ ‰∏Ä‰∏™Ê†áÂáÜÁöÑ model ÂÜôÊ≥ïÂ¶Ç‰∏ãÔºö 1234567891011module.exports = &#123; namespace: '', state: &#123; &#125;, handlers: [ ], publicHandlers: [ ], reducers: &#123; &#125;,&#125; ÂÖ∂‰∏≠Ôºånamespace Â∞±ÊòØÂΩìÂâçÊ®°ÂùóÂêçÔºåÂØπ‰∫éÂ§öÂ±ÇÁ∫ßÁöÑ namespaceÔºåGenji4rn ‰ºöÂ∞ÜÂÖ∂ËΩ¨‰∏∫Â§öÂ±ÇÁ∫ßÁöÑÂØπË±°ÁªìÊûÑ„ÄÇnamespace ‰ºöË¢´‰Ωú‰∏∫ÂΩìÂâçÊ®°ÂùóÁöÑÂú®ÂÖ®Â±ÄÁöÑ state Ê†ëÁöÑÂêçÂ≠óÔºå‰ª•ÂèäÁõ∏ÂØπÂ∫îÁöÑ reducer ÁöÑÂêçÂ≠ó„ÄÇ state ‰∏∫ÂΩìÂâçÊ®°ÂùóÁöÑÂàùÂßãÁä∂ÊÄÅÔºå‰πüÂ∞±ÊòØÂú® state Ê†ë‰∏≠Â±ûÊÄßÁöÑÂÖ∑‰ΩìÂÄº„ÄÇ handlers ‰∏∫ÂΩìÂâçÊ®°ÂùóËÉΩË∞ÉÁî®ÁöÑÊñπÊ≥ïÔºå‰ºö‰ª• mapDispatchToProps ÁöÑÂΩ¢Âºè‰º†ÂÖ• view„ÄÇpublicHandlers ‰∏∫ÂÖ®Â±ÄÈÉΩËÉΩË∞ÉÁî®ÁöÑÊñπÊ≥ïÔºåÊâÄ‰ª•‰ºöÂä†ÂÖ•Âà∞ÊØè‰∏Ä‰∏™Ê®°ÂùóÁöÑ mapDispatchToProps ‰∏≠Âéª„ÄÇ reducers ‰ºöË¢´ Genji4rn ÂÅöËøõ‰∏ÄÊ≠•Â§ÑÁêÜ„ÄÇÂÖàÂ∞ÜÊï∞ÁªÑ‰∏≠ÁöÑÂêÑ‰∏™ÊñπÊ≥ïÁªÑÂêàÊàêËØ•Ê®°ÂùóÁöÑ reducerÔºåÁÑ∂ÂêéÂ∞ÜËøô‰∫õ reducer combineReducer ‰∏∫‰∏Ä‰∏™Â§ßÁöÑ reducer„ÄÇËøôÈáå reducers ÈáåÁöÑÂêÑ‰∏™ÊñπÊ≥ïÂàÜÂà´ÂØπÂ∫î action ÁöÑ‰∏çÂêå type„ÄÇ Ê≥®ÂÜåÂÆåÊ®°ÂùóÔºåÈÄöËøá Genji4rn ÂÆû‰æãÁöÑ start ÊñπÊ≥ïÔºåËøîÂõû‰∏Ä‰∏™ËßÜÂõæÔºå‰Ωú‰∏∫ RN ÁöÑÊ†πËßÜÂõæ„ÄÇ Âè¶Â§ñËøòÊúâ‰∏ÄÂùóÂÖ≥‰∫é middlerware ÁöÑÊñπÈù¢„ÄÇ‰ΩøÁî® Genji4rn ÂÆû‰æãÁöÑ use ÊñπÊ≥ïÊ≥®ÂÜå‰∏≠Èó¥‰ª∂Ôºö ÂéüÁêÜÊ≥®ÂÜåÁõ∏ÂÖ≥Ôºà‰∏ªË¶ÅÊòØËÆæÁΩÆ reducerÔºâÈÄöËøá Genji4rn Êèê‰æõÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºåÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´ÊâÄÊúâ‰ø°ÊÅØÁöÑÂÆû‰æãÔºåÁõ∏ÂΩì‰∫éÊòØ‰πãÂêéÊâÄÊúâËßÜÂõæ‰ª•ÂèäÈÄªËæëÁöÑÊ†πÔºö 123456789101112131415161718192021const app = &#123; // properties _models: [], _reducers: &#123;&#125;, _views: &#123;&#125;, _router: null, _routerProps: &#123;&#125;, _routes: null, _store: null, _history: null, _isomorphic: hooks.isomorphic || false, // server-render options // methods use, // add redux-middlewares, extra-reducers, etc registerModule, // register a module router, // config router start, // start Genji4rn instance getStore, // get redux store getRoutes, // get router config getModule, // get the register module&#125;; ÈöèÂêéÊàë‰ª¨‰ºöË∞ÉÁî® registerModule ÊñπÊ≥ïÊ≥®ÂÜåÊ®°Âùó„ÄÇÊ≥®ÂÜåÊ®°ÂùóÁöÑ‰∏ªË¶ÅÈÄªËæëÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536if (isPlainObject(module.models)) &#123; let Actions = &#123;&#125; let namespace = module.models.namespace.replace(/\/$/g, ''); // events should be have the namespace prefix Object.keys(module.models.reducers).map((key) =&gt; &#123; if (key.startsWith('/')) &#123; // starts with '/' means global events // Â¶ÇÊûúreducer ‰ª• '/' ÂºÄÂ§¥ÔºåÈÇ£‰πàÂ∞±‰∏ç‰ºöÊ∑ªÂä†ÂëΩÂêçÁ©∫Èó¥ÔºåË°®Á§∫Áî®Êà∑ÊòéÁ°ÆÁü•ÈÅìÈúÄË¶ÅÂì™‰∏™ type Ëß¶Âèë„ÄÇ Actions[key.substr(1)] = module.models.reducers[key]; &#125; else &#123; Actions[namespace + '/' + key] = module.models.reducers[key]; &#125; &#125;) let _temp = handleActions(Actions, module.models.state) let _arr = namespace.split('/') _mergeReducers(this._reducers, _arr, _temp)&#125;if (module.publicHandlers &amp;&amp; Array.isArray(module.publicHandlers)) &#123; module.publicHandlers.map((item) =&gt; &#123; GlobalContext.registerHandler(namespace.replace(/\//g, '.') + '.' + item.name, item.action) &#125;)&#125;/** * private method * merge reducers by hierachy * user/login, user/info -&gt; user:&#123; login, info &#125; */function _mergeReducers(obj, arr, res) &#123; if(arr.length &gt; 1) &#123; let hierachy = arr.splice(0,1)[0] obj[hierachy] = obj[hierachy] || &#123;&#125; _mergeReducers(obj[hierachy], arr, res) &#125; else &#123; obj[arr[0]] = res || &#123;&#125; &#125;&#125; ÂâçÈù¢ËØ¥Ëøá reducers Êï∞ÁªÑ‰∏≠ÁöÑÊñπÊ≥ïÂØπÂ∫îÁöÑÊòØ‰∏çÂêåÁöÑ action.type„ÄÇ‰∏∫‰∫ÜÂå∫ÂàÜ‰∏çÂêåÊ®°ÂùóÁöÑ action.typeÔºåÈúÄË¶Å‰∏∫ÂÖ∂‰∏≠ÁöÑÊØè‰∏™ÊñπÊ≥ïÈÉΩÊ∑ªÂä†‰∏ä namespace„ÄÇ‰ΩÜÊòØËøòÊúâ‰∏Ä‰∫õÊñπÊ≥ïÂ∞±‰∏çÈúÄË¶ÅÊ∑ªÂä† namespaceÔºåÂõ†‰∏∫Ëøô‰∫õÊñπÊ≥ïË°®Á§∫ÁöÑ action.type ÊòØ‰∏∫‰∫ÜÂìçÂ∫îÂÖ∂‰ªñÊ®°ÂùóÂèëÂá∫ÁöÑ dispatch ËÄåÂàõÂª∫ÁöÑ„ÄÇÂ¶Ç‰∏ãÂõæÔºö ÈöèÂêéÂ∞ÜÂ§ÑÁêÜÂ•ΩÁöÑ reducers ÈÄöËøá redux-actions ÁöÑ handleActions ÊñπÊ≥ïÔºåÂ∞ÜÂÖ∂ËΩ¨Âåñ‰∏∫‰∏Ä‰∏™ reducer„ÄÇÁõ∏ÂΩì‰∫éÊää‰∏Ä‰∏™‰∏™Áã¨Á´ãÁöÑÊñπÊ≥ïËΩ¨Âåñ‰∏∫ switch‚Ä¶case‚Ä¶ ‰∫Ü„ÄÇ ÂàõÂª∫ reducer ÁöÑÊó∂ÂÄôÔºåÂÖ∂ÂÆûÂ∞±Â∑≤ÁªèÊää defaultState ‰º†ËøõÂéª‰∫Ü„ÄÇÊâÄ‰ª•ÂêéÈù¢ÂàõÂª∫ store ÁöÑÊó∂ÂÄôÂ∞±‰∏çÈúÄË¶ÅÊÄªÁöÑ initialState ‰∫Ü ‰πãÂêéÈÄöËøá _mergeReducers ÊñπÊ≥ïÊää‰∏äÈù¢ÁîüÊàêÁöÑÂêÑ‰∏™ reducer ÊîæÂà∞ Genji4rn ÂÆû‰æãÁöÑ _reducers ÁöÑÂêÑ‰∏™ÂëΩÂêçÁ©∫Èó¥‰∏ã„ÄÇÊØîÂ¶Ç namespace ‰∏∫ order/newOrder ÁöÑÊ®°ÂùóÔºåÂÆÉÁöÑ reducer Â∞±ÊîæÂú® Genji4rn ÂÆû‰æãÂØπË±°ÁöÑ _reducers.order.newOrder ‰∏ãÔºåÁ≠âÂæÖÊúÄÂêéÁöÑ combineReducer„ÄÇ ÊúÄÂêéÔºåÊää publicHandlers ‰∏≠ÁöÑÊâÄÊúâÊñπÊ≥ï‰øùÂ≠òÂà∞ GlobalContext ‰∏≠Âéª„ÄÇpublicHandlers ‰∏≠ÁöÑÊñπÊ≥ïÊâÄÊúâÊ®°ÂùóÈÉΩËÉΩÈÄöËøá GlobalContext Ëé∑ÂèñÂπ∂‰ΩøÁî®Ôºö ËøôÈáåÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÈáçË¶ÅÁöÑÊ≥®ÈáäÔºåÁî®Êù•Êé¢ËÆ® publicHandlers ÂíåÂÖ®Â±ÄÁöÑ reducer ÁöÑÈÄÇÁî®Âú∫ÊôØ publicHandlers ÁöÑÈÄÇÁî®Âú∫ÊôØÊòØÔºåÂÖ∂‰ªñ‰∫∫ÁöÑÂèòÂä®Ë¶ÅÈÄöÁü•ÊàëÂÅöÂá∫Áõ∏Â∫îÂèòÂä®ÁöÑÊÉÖÂÜµ„ÄÇÂç≥Â§öÂØπ‰∏Ä„ÄÇ ÂÖ®Â±Ä reducer ÁöÑÈÄÇÁî®Âú∫ÊôØÊòØÔºåÊàëÁöÑÂèòÂä®Ë¶ÅÈÄöÁü•ÂÖ∂‰ªñ‰∫∫ÁöÑÂèòÂä®ÁöÑÊÉÖÂÜµ„ÄÇÂç≥‰∏ÄÂØπÂ§ö„ÄÇ Ê≥®ÂÜåÊ®°ÂùóÁöÑÈÄªËæëÂ∞±ÊòØËøôÊ†∑„ÄÇÁé∞Âú®ÈúÄË¶ÅÊääÂêÑ‰∏™ÈÉ®ÂàÜÁ≥ÖÂêàÂà∞‰∏ÄËµ∑„ÄÇGenji4rn Êèê‰æõ‰∫Ü start ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829/** * start the whole Genji4rn instance * return React.Component */function start(container) &#123; const me = this const AppNavigator = me._router; // react-navigation let store = getStore.call(me) const isomorphic = me._isomorphic const App = (&#123; dispatch, nav &#125;) =&gt; ( &lt;AppNavigator navigation=&#123;addNavigationHelpers(&#123; dispatch, state: nav &#125;)&#125; /&gt; ); const mapStateToProps = state =&gt; (&#123; nav: state.nav, &#125;); const AppWithNavigationState = connect(mapStateToProps)(App); return class extends Component &#123; render() &#123; isomorphic ? store = getStore.call(me) : null return ( &lt;Provider store=&#123;store&#125;&gt; &lt;AppWithNavigationState /&gt; &lt;/Provider&gt; ) &#125; &#125; &#125; start Êï¥Âêà‰∫Ü redux-react ÁöÑÂäüËÉΩ„ÄÇ‰∏ªË¶ÅÂàõÂª∫‰∫Ü store ‰ª•ÂèäÊèê‰æõ‰∫Ü Provider„ÄÇ ËøôÈáåÊúâ‰∏ÄÈÉ®ÂàÜ navigation Áõ∏ÂÖ≥ÂäüËÉΩ„ÄÇApp ÊòØ‰∏Ä‰∏™ÊòæÁ§∫ÁªÑ‰ª∂ÔºåËá≥‰∫éËøôÁßçÂÜôÊ≥ïÔºåÂÖ∂ÂÆûÂ∞±Áõ∏ÂΩì‰∫érouter ÁªÑ‰ª∂ÈúÄË¶Å store ÁöÑ dispatch ÊñπÊ≥ï‰ª•Âèä state ÁöÑ nav Â±ûÊÄß‰Ωú‰∏∫ props ‰º†ÂÖ•„ÄÇÁÑ∂ÂêéÁöÑ connect ÊñπÊ≥ï‰πüÁ°ÆÂÆûÊòØËøôÊ†∑ÂÅöÁöÑ„ÄÇconnect ÊñπÊ≥ïÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂÆπÂô®ÁªÑ‰ª∂ AppWithNavigationState ÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂‰Ωú‰∏∫ Provider ÁöÑÂ≠êÁªÑ‰ª∂„ÄÇ ÂÜçÂõûÂà∞ÂàõÂª∫ store ÁöÑËøáÁ®ãÔºö 12345678910111213141516171819202122/** * create the redux-store */function getStore() &#123; let middlewares = plugin.get('onAction'); let enhancer = applyMiddleware(...middlewares) if (typeof __DEV__ !== 'undefined' &amp;&amp; __DEV__) &#123; // dev mode const devTools = plugin.get('dev') || ((noop) =&gt; noop) if(devTools.apply) &#123; enhancer = compose( applyMiddleware(...middlewares), devTools ) &#125; &#125; const createAppStore = enhancer(createStore); this._store = Object.assign(this._store || &#123;&#125;, createAppStore(getReducer.call(this), initialState)); return this._store&#125; ÂèØ‰ª•ÁúãÂà∞ÔºåÂÖàÁî® applyMiddleware ÁîüÊàê‰∫Ü‰∏≠Èó¥‰ª∂Ôºå‰∏≠Èó¥‰ª∂ÂèØ‰ª•ÈÄöËøá Genji4rn ÁöÑ use ÊñπÊ≥ïÊ≥®ÂÜåÔºå‰∏ÄËà¨‰ºöÊ≥®ÂÜåÁöÑ‰∏≠Èó¥‰ª∂ÊúâÔºö redux-thunkÔºöÁî®Êù•Â§ÑÁêÜÂºÇÊ≠• action redux-promise-middlewareÔºö‰∏∫ÂºÇÊ≠•ËØ∑Ê±ÇÁöÑ action.type Âä†‰∏äÂêéÁºÄ„ÄÇ‰æãÂ¶ÇÔºöLoading,Success,Error Á≠â„ÄÇ ËøôÈáå initialState ÈúÄË¶ÅÂú®ÂàõÂª∫ Genji4rn ÂÆû‰æãÁöÑÊó∂ÂÄô‰º†ÂÖ•Ôºå‰∏ÄËà¨ÊòØ {}„ÄÇÂâçÈù¢Â∑≤ÁªèËØ¥‰∫ÜÔºåÂàõÂª∫ reducer ÁöÑÊó∂ÂÄôÔºåÂ∞±Â∑≤ÁªèÊääÈªòËÆ§ÂÄº‰º†ÁªôÊØè‰∏™ reducer ‰∫Ü„ÄÇËøôÈáåÂ∞±‰∏çÈúÄË¶ÅÂÜç‰∏∫ initialState ÂàõÂª∫ÂÄº‰∫Ü„ÄÇ ‰∏çËøáËøôÊÆµÁöÑÈáçÁÇπÂ∫îËØ•ÊòØ getReducer ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829function getReducer() &#123; // extra reducers const extraReducers = plugin.get('extraReducers'); const mergeReducers = deepmerge.all([this._reducers, extraReducers]) for(let k in mergeReducers) &#123; if(typeof mergeReducers[k] === 'object') &#123; mergeReducers[k] = combineReducers(mergeReducers[k]) &#125; &#125; const navInitialState = this._router.router.getStateForAction( this._router.router.getActionForPathAndParams(this._router.initialRouteName) ); const navReducer = (state = navInitialState, action) =&gt; &#123; const nextState = this._router.router.getStateForAction(action, state); // Simply return the original `state` if `nextState` is null or undefined. return nextState || state; &#125;; const appReducer = combineReducers(&#123; nav: navReducer, ...initialReducer, ...mergeReducers, &#125;); return appReducer&#125; ÊúÄÁªàËøîÂõûÁöÑ appReducer ‰∏≠ÔºåÂåÖÂê´‰∫Ü router ÁöÑ reducer navReducer ËøòÊúâÁî®Êà∑ÁöÑ mergeReducers „ÄÇ ËøôÈáå mergeReducers ÁöÑÁîüÊàêÈùûÂ∏∏ÊúâÊÑèÊÄù„ÄÇ‰πãÂâçÊàë‰ª¨‰øùÂ≠òÂú® Genji4rn ÂÆû‰æãÁöÑ _reducerÈáåÁöÑ reducer ÁªìÊûÑÊòØ‰∏§Â±ÇÁöÑÔºö_reducers.order.newOrder. ‰ΩÜÊòØ combineReducer Âè™ËÉΩÊää‰∏ÄÂ±ÇÁöÑ reducer ËΩ¨Âåñ‰∏∫‰∏Ä‰∏™Â§ßÁöÑ reducer„ÄÇÂõ†Ê≠§ÔºåËøôÈáå‰ΩøÁî®‰∫Ü‰∏§Ê¨° combineReducer„ÄÇÊØîÂ¶ÇÂàöÊâçÁöÑ‰æãÂ≠êÔºåÁ¨¨‰∏ÄÊ¨°Â∞Ü order ‰∏ãÁöÑÂêÑ‰∏™ reducer combineReducer ÂêéÂæóÂà∞‰∏Ä‰∏™ order ÁöÑ mergeReducers[&#39;order&#39;]„ÄÇÁÑ∂ÂêéÂÜçÊää order Âêå‰∏ÄÂ±ÇÁ∫ßÁöÑ reducer combineReducer Âà∞ appReducer ‰∏ã„ÄÇ ËøôÊ†∑ reducer ÁöÑÂ±ÇÊ¨°ÁªìÊûÑÂ∞±Âíå state ‰∏ÄËá¥‰∫Ü„ÄÇ Â§öÂ±ÇÁ∫ßÁöÑ stateÔºåÂèØ‰ª•Â§öÊ¨°‰ΩøÁî® combineReducer Êù•ËææÂà∞Â∞ÜÂ§öÂ±ÇÁ∫ß reducer ÂêàÂπ∂ÁöÑÁõÆÁöÑ„ÄÇ connect Áõ∏ÂÖ≥(‰∏ªË¶ÅÊòØËÆæÁΩÆ action)ÂâçÈù¢Â∑≤ÁªèÊàêÂäüÈöêËóè‰∫Ü createStore,combineReducer,Provider,applymiddleware Á≠âÊñπÊ≥ïÔºå‰∏çËøáËøôËøò‰∏çÂ§ü„ÄÇÂØπ‰∫éÁî®Êà∑Êù•ËØ¥Ôºådispatch(action) ‰πüÊ≤°ÊúâÂøÖË¶ÅËÆ©Áî®Êà∑Áü•ÈÅì„ÄÇ‰ΩøÁî®ËÄÖÂ∫îËØ•Âè™ÈúÄË¶ÅÊèê‰æõ‰∏Ä‰∏™ÊñπÊ≥ïÔºåËøîÂõûÊï∞ÊçÆ action.payload Â∞±Ë°å‰∫ÜÔºåËøû action.type ÊòØ‰ªÄ‰πàÁî®Êà∑ÈÉΩÂèØ‰ª•‰∏çÂøÖÁü•ÈÅìÔºåÁî±Ê°ÜÊû∂ÈÄöËøáËé∑ÂèñÊñπÊ≥ïÂêçÊé®Êñ≠ÂæóÂà∞„ÄÇ ÊâÄ‰ª•ÈúÄË¶Å‰ΩøÁî® Genji4rn Êèê‰æõÁöÑ connect ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738module.exports.connect = function(state, model) &#123; const actionCreators = &#123;&#125; let _handlers = [] if(model) &#123; if(model.handlers &amp;&amp; Array.isArray(model.handlers)) &#123; _handlers = _handlers.concat(model.handlers) &#125; if(model.publicHandlers &amp;&amp; Array.isArray(model.publicHandlers)) &#123; _handlers = _handlers.concat(model.publicHandlers) &#125; &#125; if(_handlers.length &gt; 0) &#123; _handlers.map((key) =&gt; &#123; if(key.action) &#123; if(key.validate) &#123; actionCreators[key.name] = createAction(model.namespace + '/' + key.name, key.action, key.validate) &#125; else &#123; actionCreators[key.name] = createAction(model.namespace + '/' + key.name, key.action) &#125; &#125; else if(key.handler) &#123; let globalHandler = GlobalContext.getHandler(key.handler) if(globalHandler) &#123; if(key.validate) &#123; actionCreators[key.name] = createAction(model.namespace + '/' + key.name, globalHandler, key.validate) &#125; else &#123; actionCreators[key.name] = createAction(model.namespace + '/' + key.name, globalHandler) &#125; &#125; &#125; else &#123; actionCreators[key] = createAction(model.namespace + '/' + key) &#125; &#125;) const mapDispatchToProps = (dispatch) =&gt; bindActionCreators(actionCreators, dispatch) return connect(state, mapDispatchToProps) &#125; else &#123; return connect(state) &#125;&#125; ÂÖ≥‰∫é mapStateToProps ÁöÑÈÉ®ÂàÜÊàëÂ∞±‰∏çËØ¥‰∫ÜÔºå‰∏ªË¶ÅÁúãÁúã handler Â¶Ç‰ΩïÂèò‰∏∫ mapDispatchToProps ÁöÑËøáÁ®ã„ÄÇ hanlder Êúâ‰∏âÁßçÁî®Ê≥ïÔºö 12345handlers: [ 'justAString', &#123; name: 'handlerName', action: 'handlerActionFromActionJS' &#125;, &#123; name: 'handlerName2', handler: 'handlerFromAnotherModule' &#125;] Á¨¨‰∏ÄÁßçÂØπÂ∫î‰∏äÈù¢ÁöÑ else: 1actionCreators[key] = createAction(model.namespace + '/' + key) ÈÄöËøá redux-action ÁöÑ createAction ÁîüÊàê‰∏Ä‰∏™ action ÂàõÂª∫ÊñπÊ≥ï createActionÔºåÁõ¥Êé•Âú®ÊñπÊ≥ïÂêçÂâçÂä†‰∏ä namespace ‰Ωú‰∏∫ action.type ‰º†ÂÖ•„ÄÇËøôÊ†∑ action.type Â∞±ÂíåÂâçÈù¢Â§ÑÁêÜ reducers Êó∂Ê∑ªÂä† namespace ÁöÑÂÅöÊ≥ï‰∏ÄËá¥‰∫Ü„ÄÇË∞ÉÁî®Ëøô‰∏™ action ÂàõÂª∫ÊñπÊ≥ïÁöÑËØùÂè™ÈúÄË¶Å‰º†ÂÖ•‰∏Ä‰∏™ payload Â∞±ÂèØ‰ª•ÁîüÊàê‰∏Ä‰∏™ actionÔºö 1let action = createAction(model.namspace + '/someaction')('payload') Á¨¨‰∫åÁßçÂØπÂ∫î if(key.action) ÁöÑÊÉÖÂÜµÔºö 1actionCreators[key.name] = createAction(model.namespace + '/' + key.name, key.action) ËøòÊòØÈÄöËøá createActionÔºå‰∏çËøáËøôÈáåÊ≠§Êó∂ÁîüÊàêÁöÑ createAction ÊñπÊ≥ï‰ºöÂú®ÊâßË°åÁöÑÊó∂ÂÄôÊé•ÂèóÂèÇÊï∞ÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂‰Ωú‰∏∫ÂÖ•ÂèÇÁ´ãÂàªÊâßË°å action ÊñπÊ≥ïÔºåÂπ∂Â∞Ü action ÊñπÊ≥ïÁöÑËøîÂõûÂÄº‰Ωú‰∏∫ payload ‰øùÂ≠ò„ÄÇ ËôΩÁÑ∂‰πãÂâçËØ¥‰∫ÜÂÖ≥‰∫é redux-thunk ÁöÑ action ‰∏∫ function ÁöÑÊÉÖÂÜµ„ÄÇ‰ΩÜÊòØÂÖ∂ÂÆûÈÄöËøá redux-actions ÂàõÂª∫ÁöÑ action ÂÖ∂ÂÆû‰∏ç‰ºöÊòØ‰∏Ä‰∏™ action„ÄÇËøôÊó∂ÂÄôÂ∞±Ë¶ÅÈÖçÂêà redux-promise-middleware ‰∫Ü redux-promise-middleware Â∞±ÂÅö‰∫ÜËøôÊ†∑‰∏Ä‰∏™‰∫ãÊÉÖ„ÄÇÂÆÉ‰ºöÊ£ÄÊü• action.payload Ë∞ÉÁî®ÂêéËøîÂõûÁöÑÊòØ‰∏çÊòØ‰∏Ä‰∏™ promise„ÄÇÂ¶ÇÊûúÊòØ‰∏Ä‰∏™ promiseÔºåÂÆÉ‰ºöÂú® .then() ÊñπÊ≥ï‰∏≠ÔºåÊõø‰ª£‰ΩøÁî®ËÄÖÊâßË°å dispatch ÊñπÊ≥ï„ÄÇÂÆÉËøòËÉΩÊ£ÄÊü•ÁΩëÁªúËØ∑Ê±ÇÊòØÊàêÂäüËøòÊòØÂ§±Ë¥•Ôºå‰∏∫ÂéüÊú¨ÁöÑ action.type Ê∑ªÂä†Áõ∏Â∫îÁöÑÊàêÂäüÊàñËÄÖÂ§±Ë¥•ÁöÑÂêéÁºÄ„ÄÇ Á¨¨‰∏âÁßçÂØπÂ∫î else if(key.handler) ÁöÑÊÉÖÂÜµÔºö 12let globalHandler = GlobalContext.getHandler(key.handler)actionCreators[key.name] = createAction(model.namespace + '/' + key.name, globalHandler) ÂÖ∂ÂÆûÂíåÁ¨¨‰∫åÁßçÂ∑Æ‰∏çÂ§öÔºåÂè™ÊòØÂÆÉ‰∏çÊòØ‰ªéÊ®°ÂùóÁöÑ action ‰∏≠Ëé∑ÂèñÊñπÊ≥ïÔºåËÄåÊòØ‰ªé globalHandler ‰∏≠ÊâæÂà∞ÂØπÂ∫îÁöÑÊñπÊ≥ï„ÄÇ ÈÄöËøá‰ª•‰∏äÊñπÊ≥ïÂæóÂà∞ actionCreators ‰πãÂêéÔºåÂ∞±Ë¶ÅÂàõÂª∫ mapDispatchToProps ‰∫Ü„ÄÇÁî±‰∫é‰ΩøÁî®ËÄÖ‰∏çÈúÄË¶ÅÁü•ÈÅì dispatchÔºåÊâÄ‰ª•ËøôÈáå‰ΩøÁî® redux Êèê‰æõÁöÑ bindActionCreators ÊñπÊ≥ïÔºåÂÖ∂ÂÆû‰πüÊ≤°‰ªÄ‰πàÈ≠îÊ≥ïÔºåÂ∞±ÊòØÁîüÊàê‰∏Ä‰∏™Ë∞ÉÁî® dispatch ÊñπÊ≥ïÁöÑÊñπÊ≥ïÔºö 123function bindActionCreator(actionCreator, dispatch) &#123; return (...args) =&gt; dispatch(actionCreator(...args)) &#125; Vuex ‰ΩøÁî®Vue Êèê‰æõ‰∫Ü Vuex ‰Ωú‰∏∫ redux ÁöÑËß£ÂÜ≥ÊñπÂºè„ÄÇÊù•Áúã‰∏Ä‰∏ãÂÆÉÁöÑ‰ΩøÁî®ÊñπÂºè„ÄÇ Âü∫Êú¨‰ΩøÁî®store123456789101112131415161718192021222324252627282930import Vue from 'vue'import Vuex from 'vuex'Vue.use(Vuex)export default store = new Vuex.Store(&#123; state: &#123; count: 0, todos: [ &#123; id: 1, text: '...', done: true &#125;, &#123; id: 2, text: '...', done: false &#125; ] &#125;, mutations: &#123; increment (state) &#123; state.count++ &#125; &#125;, actions: &#123; increment (context) &#123; context.commit('increment') &#125; &#125; getter: &#123; doneTodos: state =&gt; &#123; return state.todos.filter(todo =&gt; todo.done) &#125; &#125;,&#125;) ÈúÄË¶Å‰ΩøÁî® Vue.use(Vuex) ÂÉè Vue Ê≥®ÂÜåÊèí‰ª∂ Vuex„ÄÇÂú® Vue ‰∏≠ÔºåÁî±‰∫éÊ≤°Êúâ react-redux Â∞ÜÂ±ûÊÄß‰º†ÂÖ•Â±ïÁ§∫ÁªÑ‰ª∂ÔºåÊâÄ‰ª•Ë¶ÅÂú®ÈúÄË¶Å‰ΩøÁî®ÁöÑÂú∞Êñπ import Ëøô‰∏™ store„ÄÇ stateÈÄöËøá store Ëé∑Âèñ state Ôºö 1store.state.count // -&gt; 0 ‰∏ÄËà¨Â∞Ü state Áî®Âú®ËÆ°ÁÆóÂ±ûÊÄß‰∏äÔºö 123456789// ÂàõÂª∫‰∏Ä‰∏™ Counter ÁªÑ‰ª∂const Counter = &#123; template: `&lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;`, computed: &#123; count () &#123; return store.state.count &#125; &#125;&#125; gettergetter Áî®‰∫éÁÆÄÂåñ store ‰∏≠ state ÁöÑËÆ°ÁÆóÔºö 12345getters: &#123; doneTodos: state =&gt; &#123; return state.todos.filter(todo =&gt; todo.done) &#125;&#125; ÂèØ‰ª•ÈÄöËøá store.getters.xxx Ëé∑ÂèñÁõ∏ÂÖ≥Â±ûÊÄßÂÄº„ÄÇÊØîÂ¶ÇÔºö 1store.getters.doneTodos // -&gt; [&#123; id: 1, text: '...', done: true &#125;] mutationÊ†πÊçÆ redux ÊâÄÂÄ°ÂØºÁöÑÔºåÊîπÂèò store ÁöÑÂîØ‰∏ÄÊñπÂºèËøòÊòØÈÄöËøá dispatch ‰∏Ä‰∏™ actionÔºåËÄå‰∏çÊòØÁõ¥Êé•‰øÆÊîπ store„ÄÇRedux ‰∏≠Ôºåreducer ÊòØ‰∏Ä‰∏™Á∫ØÂáΩÊï∞ÔºåÁî®‰∫é‰øÆÊîπ state„ÄÇVuex ‰πüÊèê‰æõ‰∫ÜÁõ∏Â∫îÊñπÂºè mutation „ÄÇ mutation ÁöÑÂÜôÊ≥ïÈùûÂ∏∏Á±ª‰ºº Genji4rn ‰∏≠ reducers ÁöÑÂÜôÊ≥ï„ÄÇmutation ‰∏≠ÂåÖÂê´‰∫ÜÂæàÂ§öÁöÑÊñπÊ≥ï„ÄÇÊñπÊ≥ïÊé•Êî∂ initialState Âíå‰∏Ä‰∏™ÂÄºÔºåÂç≥ action.payload„ÄÇ‰∏∫‰ªÄ‰πà‰∏çÈúÄË¶Å action.type ‰∫ÜÂë¢ÔºüÂõ†‰∏∫ÊñπÊ≥ïÂêçÂ∞±ÊòØ type„ÄÇÊØîÂ¶Ç‰∏ãÈù¢ÁöÑ increment ÊñπÊ≥ïÔºåÂ∞±‰ª£Ë°®ÁùÄËøô‰∏™ reducer ÁöÑ action.type 12345mutations: &#123; increment (state, n) &#123; state.count += n &#125;&#125; ‰∏çÂêåÁöÑÊòØÔºåGenji4rn ‰∏≠ÊØè‰∏™ÊñπÊ≥ï‰∏çËÉΩÁõ¥Êé•‰øÆÊîπ state ÂÄºÔºåË¶ÅËøîÂõû‰∏Ä‰∏™Êñ∞ÁöÑ state„ÄÇËÄå mutation ÁöÑÊñπÊ≥ï‰∏≠Áõ¥Êé•‰øÆÊîπ state„ÄÇËøôÁßçÂ∑ÆÂºÇÊòØÁî±‰∫é react Âíå vue ÂìçÂ∫îÂºèÊú∫Âà∂ÁöÑ‰∏çÂêåËÄå‰∫ßÁîüÁöÑ„ÄÇreact Ë¶ÅÈÄöËøáÊØîËæÉ state ÂèòÂåñÂâçÂêéÁöÑ‰∏çÂêåÔºåÊù•ÊâæÂá∫ÈúÄË¶ÅÈáçÊñ∞Ê∏≤ÊüìÁöÑÁªÑ‰ª∂„ÄÇVue ÂàôÊòØ state ÁöÑ set ÊñπÊ≥ïÈÄöÁü•È°µÈù¢‰∏≠ËÆ°ÁÆóÂ±ûÊÄßÁöÑÊîπÂèò„ÄÇ Ëß¶ÂèëÊñπÂºè‰∏äÔºåRedux ‰∏≠ÈÄöËøá store.dispatch(action) ‰æùÊ¨°Ëß¶ÂèëÊâÄÊúâ reducer„ÄÇVuex ‰∏≠ÈÄöËøá commit ÊñπÊ≥ï‰æùÊ¨°Ëß¶ÂèëÊâÄÊúâÊ®°ÂùóÁöÑ mutationÔºåÁõ∏ÂΩì‰∫éÊää action ÊãÜÊàê‰∫Ü action.type Âíå action.payload ÂàÜÂà´‰º†ÂÖ•Ôºö 1store.commit('increment', 10) ËøôÈáå‰∏é Genji4rn ‰∏çÂêåÁöÑÊòØÔºåGenji4rn Êää‰∏é commit Áõ∏ÂØπÂ∫îÁöÑ dispatch Â∞ÅË£ÖÂú® handler ‰∏≠ÁöÑÁõ∏ÂÖ≥ÊñπÊ≥ïÈáå„ÄÇËÄå Vuex ËøòÈúÄË¶ÅËá™Â∑±Ë∞ÉÁî®„ÄÇÂ¶ÇÊûúÊ®°ÂùóÂ≠òÂú®ÂëΩÂêçÁ©∫Èó¥ÔºåÈÇ£‰πàÂÜôËµ∑Êù•‰ºöÊØîËæÉÂÜóÈïøÔºåËÄå Genji4rn ‰ºöËá™Âä®‰∏∫ÊñπÊ≥ïÊ∑ªÂä†ÂëΩÂêçÁ©∫Èó¥ÁöÑÂâçÁºÄÔºö 1store.commit('order/newOrder/increment', 10) actionÂÖ≥‰∫éÂºÇÊ≠•Êìç‰Ωú„ÄÇVuex Êèê‰æõ‰∫Üaction„ÄÇ 1234567actions: &#123; incrementAsync (context, product) &#123; setTimeout(() =&gt; &#123; context.commit('increment', product.amount) &#125;, 1000) &#125;&#125; ÂÖ∂ÂÆûËøòÊòØÁõ∏ÂΩì‰∫éÊòØÂú®ÂºÇÊ≠•Êìç‰ΩúÂÆå‰∫Ü‰πãÂêéÔºåËß¶Âèë‰∏Ä‰∏™ mutation„ÄÇËøôÈáåÁöÑ context Áõ∏ÂΩì‰∫éÂΩìÂâçÊ®°ÂùóÁöÑ store„ÄÇÂç≥,Âè™ËÉΩÊãøÂà∞ÂΩìÂâçÊ®°ÂùóÁöÑ commit ÊñπÊ≥ïÂíå state„ÄÇ action ÁöÑËß¶Âèë‰ΩøÁî® dispatch ÊñπÊ≥ï„ÄÇÂêåÊ†∑ÁöÑÔºå‰πüÊòØÊää action.type ÂçïÁã¨Êãø‰∫ÜÂá∫Êù•Ôºö 123store.dispatch('incrementAsync', &#123; amount: 10&#125;) vue ÈáåÈÄöËøá dispatch Âíå commit ÊâãÂä®Êõø‰ª£‰∫Ü redux-thunk ÁöÑÂäüËÉΩ„ÄÇ Ê®°ÂùóÂåñÂü∫Êú¨‰ΩøÁî®ÂΩìÂ∑•Á®ãÂèòÂ§ßÂêéÔºåÊâÄÊúâÁä∂ÊÄÅÂíåÊñπÊ≥ïÈÉΩÂÜôÂú® store ‰∏≠ÊòØ‰∏çÊòéÊô∫ÁöÑ„ÄÇÊâÄ‰ª• react ‰∏≠ÊâçÊúâ‰∫Ü Genji4rn ‰πãÁ±ªÁöÑÊ°ÜÊû∂„ÄÇVuex Êèê‰æõ‰∫Ü‰∏ìÈó®ÁöÑÊ®°ÂùóÂåñÊñπÂºèÔºö 12345678910111213141516171819202122const moduleA = &#123; state: &#123; ... &#125;, mutations: &#123; ... &#125;, actions: &#123; ... &#125;, getters: &#123; ... &#125;&#125;const moduleB = &#123; state: &#123; ... &#125;, mutations: &#123; ... &#125;, actions: &#123; ... &#125;&#125;const store = new Vuex.Store(&#123; modules: &#123; a: moduleA, b: moduleB &#125;&#125;)store.state.a // -&gt; moduleA ÁöÑÁä∂ÊÄÅstore.state.b // -&gt; moduleB ÁöÑÁä∂ÊÄÅ Âè™ÂàõÂª∫‰∏Ä‰∏™ StoreÔºåÊää‰∏çÂêåÁöÑÊ®°Âùó‰ª• module ÁöÑÂΩ¢Âºè‰º†ÂÖ•„ÄÇÈÄöËøá store.state ÊãøÂà∞ÂéªÂÖ®Â±ÄÁöÑ stateÔºåstore.state.a ÊãøÂà∞Áõ∏Â∫îÊ®°ÂùóÁöÑ state„ÄÇ Ê®°ÂùóÁöÑÂ±ÄÈÉ®Áä∂ÊÄÅÊ®°ÂùóÂåñÂêéÊ®°ÂùóÂÜÖÈÉ®ÁöÑ mutation Âíå getter„ÄÇÊé•Êî∂ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÊ®°ÂùóÁöÑÂ±ÄÈÉ®Áä∂ÊÄÅÂØπË±°Ôºö 123456789101112131415const moduleA = &#123; state: &#123; count: 0 &#125;, mutations: &#123; increment (state) &#123; // ËøôÈáåÁöÑ `state` ÂØπË±°ÊòØÊ®°ÂùóÁöÑÂ±ÄÈÉ®Áä∂ÊÄÅ state.count++ &#125; &#125;, getters: &#123; doubleCount (state) &#123; return state.count * 2 &#125; &#125;&#125; ÂØπ‰∫éÊ®°ÂùóÂÜÖÈÉ®ÁöÑ actionÔºåÂ±ÄÈÉ®Áä∂ÊÄÅÈÄöËøá context.state Êö¥Èú≤ÔºåÊ†πËäÇÁÇπÁä∂ÊÄÅ‰∏∫ context.rootState: 12345678910const moduleA = &#123; // ... actions: &#123; incrementIfOddOnRootSum (&#123; state, commit, rootState &#125;) &#123; if ((state.count + rootState.count) % 2 === 1) &#123; commit('increment') &#125; &#125; &#125;&#125; ÂëΩÂêçÁ©∫Èó¥ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÊ®°ÂùóÂÜÖÈÉ®ÁöÑ action„ÄÅmutation Âíå getter ÊòØÊ≥®ÂÜåÂú®ÂÖ®Â±ÄÂëΩÂêçÁ©∫Èó¥ÁöÑ‚Äî‚ÄîËøôÊ†∑‰ΩøÂæóÂ§ö‰∏™Ê®°ÂùóËÉΩÂ§üÂØπÂêå‰∏Ä mutation Êàñ action ‰ΩúÂá∫ÂìçÂ∫î„ÄÇ ÂèØ‰ª•ÈÄöËøáÊ∑ªÂä† namespaced: true ÁöÑÊñπÂºè‰ΩøÂÖ∂Êàê‰∏∫Â∏¶ÂëΩÂêçÁ©∫Èó¥ÁöÑÊ®°Âùó„ÄÇÂΩìÊ®°ÂùóË¢´Ê≥®ÂÜåÂêéÔºåÂÆÉÁöÑÊâÄÊúâ getter„ÄÅaction Âèä mutation ÈÉΩ‰ºöËá™Âä®Ê†πÊçÆÊ®°ÂùóÊ≥®ÂÜåÁöÑË∑ØÂæÑË∞ÉÊï¥ÂëΩÂêç„ÄÇ‰æãÂ¶ÇÔºö 12345678910111213141516171819const store = new Vuex.Store(&#123; modules: &#123; account: &#123; namespaced: true, // Ê®°ÂùóÂÜÖÂÆπÔºàmodule assetsÔºâ state: &#123; ... &#125;, // Ê®°ÂùóÂÜÖÁöÑÁä∂ÊÄÅÂ∑≤ÁªèÊòØÂµåÂ•óÁöÑ‰∫ÜÔºå‰ΩøÁî® `namespaced` Â±ûÊÄß‰∏ç‰ºöÂØπÂÖ∂‰∫ßÁîüÂΩ±Âìç getters: &#123; isAdmin () &#123; ... &#125; // -&gt; getters['account/isAdmin'] &#125;, actions: &#123; login () &#123; ... &#125; // -&gt; dispatch('account/login') &#125;, mutations: &#123; login () &#123; ... &#125; // -&gt; commit('account/login') &#125;, &#125; &#125;&#125;) ÊÄªÁªìVuex Âú® reducer ÈÉ®ÂàÜÁöÑÂ§ÑÁêÜÂíå Genji4rn ÈùûÂ∏∏Áõ∏‰ººÔºåÈÉΩÊòØÂ∞Ü action.type ËΩ¨Âåñ‰∏∫‰∏Ä‰∏™‰∏™ÊñπÊ≥ïÔºåÈÉΩÂèØ‰ª•‰∏∫ÊØè‰∏Ä‰∏™ action.type ÁöÑÊñπÊ≥ïÊ∑ªÂä†ÂëΩÂêçÁ©∫Èó¥„ÄÇÈÉΩÂèØ‰ª•Âú®ÊØè‰∏Ä‰∏™Ê®°ÂùóÁöÑ reducer ‰∏≠Ëé∑ÂèñÂà∞ÂΩìÂâçÊ®°ÂùóÁöÑ state„ÄÇ ‰ΩÜÊòØÂú® dispatch ÊñπÊ≥ïÁöÑÂá†‰πéÊ≤°ÊúâÂÅöÂ§™Â§öÁöÑÂ§ÑÁêÜÔºåËøòÊòØÈúÄË¶Å‰ΩøÁî®ËÄÖÊ†πÊçÆÂÆûÈôÖÊÉÖÂÜµÔºåÂéªËé∑Âèñ store Ë∞ÉÁî® store.dispatch ÊàñËÄÖ store.commit ÊñπÊ≥ïÔºåÂèØ‰ª•ÂÅöËøõ‰∏ÄÊ≠•ÁöÑÂ∞ÅË£ÖÔºåÂ∞§ÂÖ∂ÊòØ‰ΩøÁî®ÂëΩÂêçÁ©∫Èó¥ÁöÑÊÉÖÂÜµ‰∏ã„ÄÇ]]></content>
      <categories>
        <category>React-Native</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Â∞èÁ®ãÂ∫èÊäÄÂ∑ß]]></title>
    <url>%2F2018%2F05%2F30%2F%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[Â•Ω‰πÖÊ≤°ÊúâÂÜôÊñ∞ÁöÑÂçöÂÆ¢‰∫Ü„ÄÇÊúÄËøëÂú®ËÅîÁ≥ªÂ∞èÁ®ãÂ∫è„ÄÇÊâÄ‰ª•ËÆ∞ÂΩï‰∏Ä‰∏ãÂ∞èÁ®ãÂ∫èÁöÑÂùë‰∏éÊäÄÂ∑ß„ÄÇÁî±‰∫éÁî® mpvue ÂíåÂéüÁîüÈÉΩÊí∏ËøáÂ∞èÁ®ãÂ∫èÔºåÊâÄ‰ª•ËÆ∞ÂΩï‰∏Ä‰∫õÈÉΩ‰ºöÈù¢‰∏¥ÁöÑÊÉÖÂÜµ„ÄÇ È°µÈù¢Áõ∏ÂÖ≥ÊúÄÂ§ñÂ±ÇÂç†Áî®Êï¥‰∏™Â±èÂπï1234567.container &#123; position: fixed; height: 100%; width: 100%; display:flex; flex-direction:column;&#125; scroll-view Âç†Êª°Êï¥‰∏™Â±èÂπï Ê≠§ÊñπÊ≥ïÂú® 6s Á≠âÊú∫Âûã‰∏äÂ≠òÂú®‰∏çËÉΩÊªëÂä®ÁöÑÈóÆÈ¢òÔºåÂøÖÈ°ªË¶ÅÊâãÂä®ËÆæÁΩÆ scroll-view ÁöÑÈ´òÂ∫¶ÊâçÂèØ‰ª•Ëß£ÂÜ≥„ÄÇÊâÄ‰ª•ÈúÄË¶ÅÂú® scroll-view Â§ñÂÜçÂåÖË£π‰∏Ä‰∏™ viewÔºåÁÑ∂ÂêéÈÄöËøá wx.createSelectorQuery() ÊãøÂà∞ view ÁöÑÈ´òÂ∫¶ÔºåÂÜçËÆæÁΩÆÁªô scroll-view„ÄÇÊ≥®ÊÑèÊãøÂà∞ÁöÑÈ´òÂ∫¶ÊòØ px ‰∏çÊòØ rpx scroll-view Â¶ÇÊûúËÆæÁΩÆ flex: 1 ÂèØ‰ª•ËÆ© scroll-view ÊíëÊª°Â±èÂπï„ÄÇ‰ΩÜÊòØ‰Ω†‰ºöÂèëÁé∞Ôºåscroll-view Êó†Ê≥ïÊªöÂä®‰∫Ü„ÄÇÊàë‰ª¨ÂèØ‰ª•ÂÜçËÆæÁΩÆ‰∏Ä‰∏™Ê†∑ÂºèÔºö 1234.scroll-view &#123; flex: 1; overflow: hidden;&#125; ËÆæÁΩÆË∂ÖÂá∫ÈÉ®ÂàÜÈöêËóè„ÄÇËøôÊ†∑Êéß‰ª∂Â∞±Ëá™Âä®Êã•Êúâ scroll-view ÁöÑÊªöÂä®ÂäüËÉΩ‰∫Ü„ÄÇ wxs ‰ΩøÁî®ÁöÑÂùëËôΩÁÑ∂ÊàëÂæàÊäóÊãí wxsÔºå‰ΩÜÊòØÁî±‰∫éÂ∞èÁ®ãÂ∫è‰∏çÊîØÊåÅ computedÔºåÁî±‰∫é‰ª£Á†ÅÁöÑÁæéËßÇÔºåÂ∞ëÂú® data ‰∏≠ÊîæÂá†‰∏™Â≠óÊÆµÔºåÂ∞±ÈúÄË¶ÅÂÄüÂä© wxs Âú® wxml ‰∏≠ÁîüÊàêËÆ°ÁÆóÂêéÁöÑÊï∞ÊçÆ„ÄÇ ‰ΩÜÊòØÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™ÂùëÂ∞±ÊòØÔºåÂÆö‰πâÂèòÈáèÁöÑÊó∂ÂÄôÔºå‰∏çËÉΩ‰ΩøÁî® es6 ÁöÑ let Âíå const Âè™ËÉΩ‰ΩøÁî® varÔºåÂê¶Âàô‰πü‰∏çÊä•ÈîôÔºå‰ΩÜÂ∞±ÊòØÊó†Ê≥ïÊòæÁ§∫„ÄÇ ÁªùÂØπÂÆö‰ΩçÁöÑÂ±Ö‰∏≠ÁªùÂØπÂÆö‰ΩçÁöÑÂ∑¶Âè≥‰∏§ËæπÊ≤°ÊúâÂç†‰ΩçÔºåÊâÄ‰ª• align-items ÊòØÊó†ÊïàÁöÑ align-self ÂèØËÉΩÊó†Êïà„ÄÇËøôÁßçÂ±Ö‰∏≠ÂàÜ‰∏∫‰∏§ÁßçÊÉÖÂÜµÔºö ËÆæÁΩÆ‰∫ÜÊéß‰ª∂ÂÆΩÂ∫¶ ‰∏çËÆæÁΩÆÊéß‰ª∂ÂÆΩÂ∫¶ ËÆæÁΩÆ‰∫Ü width ÁöÑÊÉÖÂÜµ‰∏ã„ÄÇÊàë‰ª¨Âè™Ë¶Å‰ΩøÁî® left ËÆæÁΩÆÊéß‰ª∂ÁöÑ‰ΩçÁΩÆÂç≥ÂèØ„ÄÇËÆæÁΩÆ left: 50% ÂèØ‰ª•ËÆ©Êéß‰ª∂ÂêëÂè≥ÁßªÂä®Áà∂ËßÜÂõæÁöÑ 50% ÂÆΩÂ∫¶„ÄÇËøôÊ†∑‰ºöÁßªÂä®ËøáÂ§¥ÔºåËøòÈúÄË¶ÅËÆæÁΩÆ margin-left: -{50%ÁöÑÊéß‰ª∂ÂÆΩÂ∫¶} ‰øÆÊ≠£Êéß‰ª∂ÁöÑ‰ΩçÁΩÆ„ÄÇ Â¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆ width ÁöÑÊÉÖÂÜµ‰∏ã„ÄÇÂèØ‰ª•ÂêåÊó∂ËÆæÁΩÆ leftÂíå rightÔºåËÆ©ËßÜÂõæÊíëÊª°Ââ©‰ΩôÁöÑÁ©∫Èó¥„ÄÇ Âú®Â§ñÈÉ®‰øÆÊîπÁªÑ‰ª∂Â∫ìÁöÑÊ†∑ÂºèÈ°πÁõÆ‰∏≠ÂºïÂÖ•‰∫ÜÊúâËµûÁöÑÁªÑ‰ª∂Â∫ì„ÄÇ‰ΩÜÊòØ‰ΩøÁî®ÁöÑÊó∂ÂÄôÊúâ‰∫õÊ†∑Âºè‰∏çÂ§™Á¨¶ÂêàË¶ÅÊ±Ç„ÄÇËøô‰∏™Êó∂ÂÄô‰∏çË¶ÅÊîæÂºÉ‰ΩøÁî®ÔºåÊàë‰ª¨ÂèØ‰ª•Âú®Â§ñÈÉ®‰øÆÊîπÂÜÖÈÉ®ÁöÑÊ†∑Âºè„ÄÇ ÈÄöËøáË∞ÉËØïÂ∑•ÂÖ∑ÔºåÊâæÂà∞‰∏çÁ¨¶ÂêàË¶ÅÊ±ÇÁöÑËßÜÂõæÁöÑÊ†∑ÂºèÔºåÂú®Â§ñÈÉ®Áõ¥Êé•‰øÆÊîπÂÖ∂Ê†∑ÂºèÔºö 123.van-popup--bottom &#123; background: transparent !important;&#125; ËøôÈáåÊàë‰ª¨‰øÆÊîπ‰∫Ü van-popup--bottom ÁöÑËÉåÊôØÈ¢úËâ≤„ÄÇÂêåÊó∂Âú®ÂêéÈù¢Âä†‰∏ä‰∫Ü !importantÔºåËøôÊ†∑ÊòØ‰∏∫‰∫ÜÂ∞ÜÊàë‰ª¨ÁöÑÊ†∑ÂºèÁöÑÊùÉÈáçÊèêÂçáÔºåÂ∞±‰∏ç‰ºöË¢´ÁªÑ‰ª∂ÂÜÖÈÉ®ÁöÑÊ†∑ÂºèË¶ÜÁõñ‰∫Ü„ÄÇ wx:key ÂèñÂÄºÊàë‰ª¨Áü•ÈÅìÔºåÊó†ËÆ∫ÊòØ react ËøòÊòØ vueÔºåÂú®Á±ªË°®Ê∏≤ÊüìÁöÑÊó∂ÂÄôÈÉΩÊèê‰æõ‰∫Ü key Ëøô‰∏™ÂÖ≥ÈîÆÂ≠ó„ÄÇkey Áõ∏Á≠âÁöÑÊó∂ÂÄôÁî®Êù•ÁßªÂä®ÂíåÊîπÂèòÁä∂ÊÄÅÔºåkey ‰∏çÁ≠âÁöÑÂàô‰ºöËøõË°åÈîÄÊØÅÂíåÈáçÊñ∞ÂàõÂª∫„ÄÇ React: 12345const listItems = numbers.map((number) =&gt; &lt;li key=&#123;number.toString()&#125;&gt; &#123;number&#125; &lt;/li&gt;); vue: 1&lt;my-component v-for=&quot;item in items&quot; :key=&quot;item.id&quot;&gt;&lt;/my-component&gt; ÂèØ‰ª•ÁúãÂà∞ÔºåËøô‰∏§ÁßçÈÉΩÊòØÊãøÂà∞ itemÔºåÁÑ∂ÂêéËÆæÁΩÆ item ÁöÑÂ±ûÊÄß‰∏∫ key„ÄÇ Â∞èÁ®ãÂ∫èÂàôÈªòËÆ§keyÂ∞±ÊòØ item ‰∏≠ÁöÑÂ±ûÊÄß‰∫ÜÔºö 1&lt;block wx:for="&#123;&#123;itemList&#125;&#125;" wx:key="id"/&gt; ËøôÊ†∑Â∞±ÊòØÁõ¥Êé•ËÆæÁΩÆ item ‰∏≠ÁöÑ id ‰∏∫ key„ÄÇËøôÊ†∑Âíå React Âíå Vue ‰∏çÁªü‰∏ÄÁöÑÂÜôÊ≥ïÔºåËÆ©ÊàëÊúâÁÇπÈöæÂèó„ÄÇ scroll-view Ê®™ÂêëÊéíÂ∏ÉÊéíÂ∏Éscroll-view Ê®™ÂêëÊéíÂ∏ÉÊúâ‰∏Ä‰∫õÂùëÔºåÂ¶ÇÊûúÊåâÁÖßÂ∏∏ËßÑÁöÑÊñπÂºèÔºå‰Ω†‰ºöÂèëÁé∞ scroll-view ‰∏≠ÁöÑËßÜÂõæËøòÊòØÁ∫µÂêëÊéíÂ∏ÉÁöÑ„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂÅö‰∏Ä‰∫õËÆæÁΩÆÔºö 123456789.scroll-view &#123; white-space: nowrap; display: flex; flex-direction: row;&#125;.scroll-item &#123; display: inline-block;&#125; Â§ñÈÉ®ÁöÑ scroll-view Ë¶ÅËÆæÁΩÆ white-spaceÔºåÂê¶Âàô‰ºöÊç¢Ë°å„ÄÇÂÜÖÈÉ®ÁöÑ item Ë¶ÅÊääÊòæÁ§∫ËÆæÁΩÆ‰∏∫ inline-blockÔºåÂê¶ÂàôËøòÊòØÁ∫µÂêëÊéíÂ∏É‰∫Ü„ÄÇ Â¶Ç‰ΩïÂè™ÊòæÁ§∫3Ë°åÔºåË∂ÖÂá∫ÊòæÁ§∫ÁúÅÁï•Âè∑Ë¶ÅÂØπ text ËÆæÁΩÆÊ†∑ÂºèÔºå‰∏Ä‰∏™‰πü‰∏çËÉΩÂ∞ëÔºö 123456789.text &#123; line-height: 36rpx; text-overflow: ellipsis; overflow: hidden; -webkit-line-clamp: 3; height: 108rpx; -webkit-box-orient: vertical; display: -webkit-box;&#125; Ë¶ÅÊ≥®ÊÑè‰∏ÄÂÆöË¶ÅËÆæÁΩÆ line-height Âíå height ÔºåÂπ∂‰∏îË¶ÅÊòæÁ§∫Âá†Ë°å height Â∞±ÊòØ line-height ÁöÑÂá†ÂÄç„ÄÇ Â¶ÇÊûúÊòØÂçïË°åÁöÑÁúÅÁï•Âè∑Êîπ‰∏∫Ôºö 123456.text &#123; text-overflow: ellipsis; overflow: hidden; width: 123rpx; white-space: nowrap;&#125; Ê≥®ÊÑèÔºåÂÆΩÂ∫¶‰∏ÄÂÆöË¶ÅÊúâ„ÄÇ ÊªöÂä®ÁõëÂê¨Â∞èÁ®ãÂ∫è‰∏≠ÊªöÂä®Êúâ‰∏§ÁßçÊñπÂºè„ÄÇ‰∏ÄÁßçÊòØÁõ¥Êé•ËßÜÂõæÁöÑÂπ≥Èì∫ÔºåËøòÊúâ‰∏ÄÁßçÈÖçÂêà scroll-view„ÄÇ Ëé∑ÂèñËßÜÂõæÂπ≥Èì∫Êó∂ÁöÑÊªöÂä® offsetÂú®Âπ≥Èì∫Êó∂ÂÄôÁöÑÊªöÂä®ÂõûË∞É‰∏≠ÊØèÊ¨°ÈÉΩÈÄöËøá selectViewport().scrollOffset() ÊãøÂà∞ 1234567onPageScroll: function () &#123; let query = wx.createSelectorQuery() query.selectViewport().scrollOffset(function (res) &#123; console.log(res.scrollTop) // Á´ñÁõ¥ÁöÑÊªöÂä®‰ΩçÁΩÆ &#125;) query.exec()&#125; Ëé∑Âèñ scrollView ÁöÑ offset1234567// scroll-view ‰∏≠ÁªëÂÆöÊñπÊ≥ï&lt;scroll-view bindscroll="onScroll"/&gt; // js ‰∏≠ÊªöÂä®ÊñπÊ≥ïonScroll (e) &#123; console.log(e.detail.scrollTop) &#125; Âπ≥Èì∫ÊªöÂä®Âà∞Êüê‰∏Ä‰∏™‰ΩçÁΩÆ1wx.pageScrollTo(&#123;scrollTop: ‰∏Ä‰∏™offset&#125;) scroll-view ÊªöÂä®Âà∞Êüê‰∏Ä‰∏™ view ÊàñËÄÖÊüê‰∏Ä‰∏™‰ΩçÁΩÆ12345678910// wxml ‰∏≠&lt;scroll-view scroll-top="&#123;&#123;offset&#125;&#125;" scroll-into-view="&#123;&#123;id&#125;&#125;"/&gt; // js ‰∏≠this.setData(&#123; offset: 1000,&#125;)this.setData(&#123; id: '‰∏Ä‰∏™viewÁöÑid'&#125;) Ëé∑ÂèñÂπ≥Èì∫ÊàñËÄÖ scroll-view ‰∏≠Ë∑ùÁ¶ªÈ°∂ÈÉ®ÁöÑ offset1234567let query = wx.createSelectorQuery()query.select('#select').boundingClientRect(res =&gt; &#123; this.setData(&#123; top: res.top &#125;)&#125;)query.exec() #select Ë°®Á§∫ÂΩìÂâçËßÜÂõæÁöÑ id &lt;view id=&quot;select /&gt;&quot; ÁªùÂØπÂÆö‰ΩçËÆæÁΩÆ padding-right ‰∏çÁ¨¶ÂêàÈ¢ÑÊúüpadding ÁöÑÂÆΩÂ∫¶‰∏çÂú® width ÁöÑËåÉÂõ¥ÂÜÖ„ÄÇÊâÄ‰ª•Â¶ÇÊûú‰Ω†ÁªùÂØπÂÆö‰ΩçËÆæÁΩÆÂÆΩÂ∫¶‰∏∫ 100% Êó∂ÔºåÂ¶ÇÊûúËÆæÁΩÆ‰∫Ü padding-left ÔºåÈÇ£‰πàËßÜÂõæÊï¥‰Ωì‰ºöÂêëÂè≥ÁßªÔºåÂç≥ÂÆûÈôÖÂÆΩÂ∫¶Â§ß‰∫é 720rpx„ÄÇ ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂè™ËÉΩÊääËßÜÂõæÁöÑÂÆΩÂ∫¶ËÆæÁΩÆ‰∏∫ 720-2*padding ÂÄºÔºåÊâçËÉΩËÆ©ËßÜÂõæÊ≠£Â∏∏ÊòæÁ§∫„ÄÇ CSS ‰∏≠ËÆæÁΩÆÈ´òÂ∫¶‰∏∫Â±èÂπïÂ§ßÂ∞èÊúâÊó∂ÂÄôÊàë‰ª¨Ë¶ÅËÆæÁΩÆÈ´òÂ∫¶ÊàñËÄÖÂÆΩÂ∫¶‰∏∫Â±èÂπïÂ§ßÂ∞èÔºå‰ΩÜÊòØ‰ΩøÁî® 100% ‰∏çÂ•ΩÁî®„ÄÇËøô‰∏™Êó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® vh Âíå vw ËøôÊòØ CSS3 Ê∂åÂÖ•ÁöÑÂ±ûÊÄßÔºåÂàÜÂà´Ë°®Á§∫È´òÂ∫¶/ÂÆΩÂ∫¶Âü∫‰∫éÁ™óÂè£ÁöÑÂ§ßÂ∞è,vh = view height,vw = view width: 1234.window &#123; height: 100vh; width: 100vw;&#125; ËÆæÁΩÆÂ§öË°åÂ≠êÂÖÉÁ¥†‰∏∫‰∫ÜËÆ©Â≠êÂÖÉÁ¥†ËÉΩÂ§üËá™Âä®Êç¢Ë°åÔºåÂèØ‰ª•‰ΩøÁî®Ê†∑Âºè flex-wrap: wrap„ÄÇÂΩìÁÑ∂ËøôÊòØÁ¨¨‰∏ÄÊ≠•ÔºåËøô‰πàÂÅöÂêé‰Ω†‰ºöÂèëÁé∞ÔºåÊç¢Ë°åÂêéÁöÑÂ≠êÂÖÉÁ¥†Ë¥¥Âú®‰∫Ü‰∏ÄËµ∑„ÄÇÂ¶ÇÂõæÊâÄÁ§∫Ôºö ‰Ω†ÈúÄË¶ÅËÆæÁΩÆÂÖÉÁ¥†Èó¥Èó¥Èöî„ÄÇ‰Ω†‰ºöËÆæÁΩÆÂÖÉÁ¥†ÁöÑ margin-bottom: 20rpx„ÄÇ ‰ΩÜÊòØËøôÊ†∑ÁöÑËØùÁà∂ÂÖÉÁ¥†ÁöÑ bottom ‰πü‰ºöÂêë‰∏ãÁßªÂä® 20rpx„ÄÇÊâÄ‰ª•Ôºå‰Ω†ÂèØ‰ª•ÊääÁà∂ÂÖÉÁ¥†ÁöÑ margin-bottom: -20rpx„ÄÇ ËøôÊ†∑ÔºåÊ≠£Ë¥üÊäµÊ∂àÔºåÂ∞±ÊòØÁêÜÊÉ≥ÁöÑÈó¥Èöî‰∫Ü„ÄÇ Â∞èÁ®ãÂ∫èÁöÑbuttonÁöÑËæπÊ°ÜÂ∞èÁ®ãÂ∫èÈªòËÆ§ÁöÑbuttonÊòØÊúâ‰∏Ä‰∏™ËæπÊ°ÜÁöÑÔºåÈúÄË¶ÅËÆæÁΩÆ‰∏Ä‰∏™Ê†∑ÂºèÔºö 123button::after &#123; border: none;&#125; ËøôÊ†∑ÔºåÊâÄÊúâÁöÑ button Ê†áÁ≠æÈÉΩÊ≤°Êúâ border‰∫Ü Â∞èÁ®ãÂ∫èÊçïÊçâ‰∫ã‰ª∂Â∞èÁ®ãÂ∫èÈªòËÆ§ÁöÑ‰∫ã‰ª∂ÊòØÂÜíÊ≥°ÁöÑÔºå‰πüÂ∞±ÊòØËØ¥ÁÇπÂáª‰∫ÜÂ≠êÊéß‰ª∂Ëß¶ÂèëÊñπÊ≥ïÂêéÔºåÁà∂Êéß‰ª∂ÁöÑÁÇπÂáª‰∫ã‰ª∂ËøòÊòØ‰ºöËß¶ÂèëÁöÑÔºåÂ¶ÇÊûúË¶ÅÈòªÊ≠¢‰∫ã‰ª∂ÂÜíÊ≥°ÔºåÂèØ‰ª•ÊääÂ≠êÊéß‰ª∂ÁöÑ bind:tap Êîπ‰∏∫ catch:tap ÁªÑ‰ª∂‰∏≠ÁöÑ class ÈÄâÊã©ÂæàÂ§öÊó∂ÂÄôÊàë‰ª¨ÈúÄË¶ÅÊ†πÊçÆÁªÑ‰ª∂‰º†ÂÖ•ÁöÑÂÄºÔºåÊù•ËÆæÁΩÆÁªÑ‰ª∂‰ΩøÁî®‰∏çÂêåÁöÑ class„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÊàñÊàñËÄÖ‰∏âÂÖÉÈÄâÊã©Á¨¶Ôºå‰ΩÜÊòØÈúÄË¶Å‰ΩøÁî®ÂèåÊã¨Âè∑ÂåÖË£πÔºåÂè™Ë¶ÅËøîÂõû‰∏Ä‰∏™ class ÁöÑÂêçÂ≠óÂç≥ÂèØÔºö 123&lt;button class="someclass &#123;&#123; item.disabled || item.loading ? 'some-class-disabled' : '' &#125;&#125; &#123;&#123; item.className || '' &#125;&#125;"&gt; ÁªÑ‰ª∂‰∏≠ÁöÑ styleÂæàÂ§öÊó∂ÂÄôÔºåÊàë‰ª¨ÈúÄË¶Å‰º†ÂÖ•ÂÄºÊù•ÊéßÂà∂ styleÔºå‰º†ÂÖ•ÁöÑÂÄºÈúÄË¶Å‰ΩøÁî®ÂèåÊã¨Âè∑ÂåÖË£πÔºö 1style="width: 100%; height: &#123;&#123; itemHeight * visibleItemCount + 'px' &#125;&#125;" ÂºïÂÖ• iconfontÈ¶ñÂÖàÊää iconfont ‰∏ãËΩΩ‰∏ãÊù•ÔºåÊâìÂºÄÂÖ∂‰∏≠ÁöÑ iconfont.css Êñá‰ª∂ÔºåÂ∫îËØ•ÊòØ‰∏ãÈù¢ÁöÑÊ†∑Â≠êÔºåÊääÂÆÉÂ§çÂà∂Âà∞ app.wxss ‰∏≠‰Ωú‰∏∫ÂÖ®Â±ÄÊ†∑Âºè„ÄÇ 123456789101112131415@font-face &#123;font-family: "ChameIconfont"; ... ÁúÅÁï•‰∫ÜÂÖ∂‰∏≠ÂæàÂ§öÁöÑ src Âíå url&#125;.ChameIconfont &#123; font-family:"ChameIconfont" !important; font-size:16px; font-style:normal; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;&#125;.icon-ickehu:before &#123; content: "\e60a"; &#125;.icon-icshouye:before &#123; content: "\e610"; &#125; Áî±‰∫éÂ∞èÁ®ãÂ∫è‰∏ç‰ºöÊää ttf Êñá‰ª∂ÊâìÂåÖÔºåÊâÄ‰ª•ÈúÄË¶Å‰øÆÊîπ @font-face ‰∏≠ÁöÑ src Âíå url ‰∏∫ÁΩëÁªúË∑ØÂæÑ„ÄÇÊàë‰ª¨ËøòÊòØÂà∞ iconfont ÁöÑÁΩëÁ´ô‰∏äÔºåÁîüÊàê‰∏Ä‰∏™Á∫ø‰∏äÁöÑÊñá‰ª∂Âú∞ÂùÄÔºåÁî®ÂÆÉÊõøÊç¢‰∏äÈù¢ÁöÑ @font-face ËøôÊ†∑È°πÁõÆ‰∏≠Â∞±ÂèØ‰ª•‰ΩøÁî®‰∫ÜÔºö 1&lt;view class='ChameIconfont icon-ickehu'/&gt; ÂèëÂ∏É npm ÂåÖÂ∞èÁ®ãÂ∫èÁî® npm ÂåÖÈúÄË¶ÅÊää‰ª£Á†ÅÊîæÂú®‰∏Ä‰∏™Êñá‰ª∂Â§π‰∏ãÔºåÁÑ∂ÂêéÂú® package.json ‰∏≠Â¢ûÂä†‰∏Ä‰∏™ miniprogram Â≠óÊÆµÔºåÊ†áËØÜ‰ª£Á†ÅÊâÄÂú®ÁõÆÂΩïÔºö 123&#123; "miniprogram": "dist"&#125; ÂΩìÂ∞èÁ®ãÂ∫èÂºÄÂèëÂ∑•ÂÖ∑ Â∑•ÂÖ∑-&gt;ÊûÑÂª∫npm ÁöÑÊó∂ÂÄôÔºåÂ∞ÜËØ•ÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂‰ªé node_modules ÁßªÂä®Âà∞‰∏ªÁõÆÂΩï‰∏ã„ÄÇ Âú® Â∑•ÂÖ∑-&gt;ÊûÑÂª∫npm ÂêéÔºåÈ°πÁõÆÊúÄÂ§ñÂ±ÇÁõÆÂΩïÁîüÊàê miniprogram_npm Êñá‰ª∂Â§πÔºåÊñá‰ª∂Â§πÂÜÖÂåÖÂê´ÊâÄÊúâ node_modules ‰∏≠ÁöÑÊ®°Âùó„ÄÇ Âú® app.json ‰∏≠Ê≥®ÂÜåË¶Å‰ΩøÁî®ÁöÑÁªÑ‰ª∂Ôºö12345&#123; "usingComponents": &#123; "van-button": "/miniprogram_npm/vant-weapp/button/index" &#125;&#125; ÊàñËÄÖÁõ¥Êé• import ÈöêËóè scroll-view ÊªöÂä®Êù°Áõ¥Êé•Âú®Áõ∏Â∫îÁöÑ wxss ‰∏≠ÂÜôÂÖ•Ê†∑ÂºèÔºö 12345::-webkit-scrollbar &#123; width: 0; height: 0; color: transparent;&#125; ÁªÑ‰ª∂Áõ∏ÂÖ≥Â§ñÈÉ®ÂÖ®Â±ÄÊ†∑ÂºèÂΩ±ÂìçÁªÑ‰ª∂ÂÜÖÊ†∑ÂºèÂú®Ê≥®ÂÜåÁªÑÂª∫ÁöÑÊó∂ÂÄôÊ∑ªÂä†‰∏Ä‰∏™ÈÄâÈ°πÔºåaddGlobalClass ‰∏∫ trueÔºö 12345Component(&#123; options: &#123; addGlobalClass: true, &#125;&#125;) ÁõëÂê¨ÁªÑ‰ª∂ÂÜÖÊï∞ÊçÆÊîπÂèòÁ±ª‰ºº‰∫é watchÔºåÁªÑ‰ª∂ÂÜÖÈÄöËøá observers Â≠óÊÆµÂÆö‰πâÔºö 12345678910111213141516Component(&#123; attached: function() &#123; this.setData(&#123; numberA: 1, numberB: 2, &#125;) &#125;, observers: &#123; 'numberA, numberB': function(numberA, numberB) &#123; // Âú® numberA ÊàñËÄÖ numberB Ë¢´ËÆæÁΩÆÊó∂ÔºåÊâßË°åËøô‰∏™ÂáΩÊï∞ this.setData(&#123; sum: numberA + numberB &#125;) &#125; &#125;&#125;) Áà∂Â≠êÁªÑ‰ª∂ÁöÑÈÄö‰ø°Â∞èÁ®ãÂ∫èÁöÑÁà∂Â≠êÁªÑ‰ª∂Êèê‰æõ‰∫ÜÂèåÂêëÈÄö‰ø°ÁöÑÊñπÂºè„ÄÇÂ≠êÁªÑ‰ª∂ÂèØ‰ª•ÈÄöËøá link ÁöÑÂõûË∞ÉÔºå‰ª•Âèä getRelationNodes ‰∏§ÁßçÊñπÂºèËé∑ÂèñÁà∂ÁªÑ‰ª∂„ÄÇÁà∂ÁªÑ‰ª∂ÂèØ‰ª•ÈÄöËøá link ÂõûË∞ÉËé∑ÂèñÂ≠êÁªÑ‰ª∂„ÄÇ 123456789101112131415161718192021222324// Â≠êÁªÑ‰ª∂ path/to/custom-li.jsComponent(&#123; relations: &#123; '&#123;Áõ∏ÂØπË∑ØÂæÑ&#125;/custom-ul-component': &#123; type: 'parent', // ÂÖ≥ËÅîÁöÑÁõÆÊ†áËäÇÁÇπÂ∫î‰∏∫Áà∂ËäÇÁÇπ linked: function(target) &#123; // ‰øùÂ≠òÁà∂ËäÇÁÇπ this.parent = target &#125;, unlinked: function(target) &#123; // ÁßªÈô§Â≠êËäÇÁÇπ this.parent = null &#125; &#125; &#125;, methods: &#123; someFunc: function () &#123; // Ëé∑ÂèñÈ°µÈù¢‰∏ä‰∏éÂ≠êÁªÑ‰ª∂Áõ∏ÂÖ≥ÁöÑÁªÑ‰ª∂ÁöÑËäÇÁÇπÊï∞ÁªÑÔºåÂèñÂÖ∂‰∏≠Á¨¨‰∏Ä‰∏™ËäÇÁÇπÔºåÂ∞±ÊòØÂÆÉÁöÑÁà∂ËäÇÁÇπ let group = this.getRelationNodes('&#123;Áõ∏ÂØπË∑ØÂæÑ&#125;/custom-ul-component')[0] // Ë∞ÉÁî®Áà∂ËäÇÁÇπÊñπÊ≥ï group.doSomeFunc() &#125; &#125;&#125;) 123456789101112131415161718192021222324// Áà∂ÁªÑ‰ª∂Component(&#123; relations: &#123; '&#123;Áõ∏ÂØπË∑ØÂæÑ&#125;/custom-ul': &#123; type: 'child', // ÂÖ≥ËÅîÁöÑÁõÆÊ†áËäÇÁÇπÂ∫î‰∏∫Â≠êËäÇÁÇπ linked: function(target) &#123; // ‰øùÂ≠òÂ≠êËäÇÁÇπ this.childs.push(target) &#125;, unlinked: function(target) &#123; // ÁßªÈô§Â≠êËäÇÁÇπ this.childs = this.childs.filter(function(item) &#123; return item !== target &#125;) &#125; &#125; &#125;, methods: &#123; someFunc: function () &#123; // Ë∞ÉÁî®Â≠êËäÇÁÇπÊñπÊ≥ï this.childs.doSomeFunc() &#125; &#125;&#125;) È°µÈù¢‰∏éÁªÑ‰ª∂ÁöÑÈÄö‰ø°ÁªÑ‰ª∂Ë∞ÉÁî®È°µÈù¢Êèê‰æõÁöÑÊñπÊ≥ï È°µÈù¢Â∞ÜÊñπÊ≥ïÁªëÂÆöÁªôÁªÑ‰ª∂Ôºö 1234567&lt;component-tag-name bind:myevent="onMyEvent" /&gt; Page(&#123; onMyEvent: function(e)&#123; e.detail // Ëá™ÂÆö‰πâÁªÑ‰ª∂Ëß¶Âèë‰∫ã‰ª∂Êó∂Êèê‰æõÁöÑdetailÂØπË±° &#125;&#125;) ÁªÑ‰ª∂ÂÜÖÈÉ®Ëß¶Âèë‰∫ã‰ª∂Ôºö 123456789101112&lt;!-- Âú®Ëá™ÂÆö‰πâÁªÑ‰ª∂‰∏≠ --&gt;&lt;button bindtap="onTap"&gt;ÁÇπÂáªËøô‰∏™ÊåâÈíÆÂ∞ÜËß¶Âèë‚Äúmyevent‚Äù‰∫ã‰ª∂&lt;/button&gt;Component(&#123; properties: &#123;&#125;, methods: &#123; onTap: function()&#123; var param = &#123;&#125; // Êèê‰æõÁªôÈ°µÈù¢ÁöÑ e.detail ÁöÑÂèÇÊï∞ this.triggerEvent('myevent', param) &#125; &#125;&#125;) È°µÈù¢Ë∞ÉÁî®ÁªÑ‰ª∂Êèê‰æõÁöÑÊñπÊ≥ïÈ°µÈù¢Ë∞ÉÁî®ÁªÑ‰ª∂ÊñπÊ≥ïÈúÄË¶ÅËé∑ÂèñÁªÑ‰ª∂ÂÆû‰æãÔºåÂèØ‰ª•ÈÄöËøá page ÁöÑ selectComponent ÊñπÊ≥ïËé∑ÂèñÔºö 123456789&lt;some-component id="custom-selector" /&gt; const pages = getCurrentPages()const currentPage = pages[pages.length - 1]let component = currentPage.selectComponent('custom-selector')// Ë∞ÉÁî®ÁªÑ‰ª∂ÊñπÊ≥ïcomponent.customFunction()]]></content>
      <categories>
        <category>MiniProgram</category>
      </categories>
      <tags>
        <tag>ÊåÅÁª≠Êõ¥Êñ∞</tag>
        <tag>ÊäÄÂ∑ß</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Masonry Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2018%2F04%2F19%2FMasonry%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Masonry ÊòØ iOS ‰∏≠ÁöÑ‰∏ÄÂ•óÂ∏ÉÂ±ÄÊ°ÜÊû∂ÔºåÂÖàÂç†‰∏™ÂùëÂ≠¶‰π†‰∏ãÊ∫êÁ†Å„ÄÇ ‰ΩøÁî®Ê∑ªÂä†Á∫¶Êùü1234567UIEdgeInsets padding = UIEdgeInsetsMake(10, 10, 10, 10);[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.top.equalTo(superview.mas_top).with.offset(padding.top); //with is an optional semantic filler make.left.equalTo(superview.mas_left).with.offset(padding.left); make.bottom.equalTo(superview.mas_bottom).with.offset(-padding.bottom); make.right.equalTo(superview.mas_right).with.offset(-padding.right);&#125;]; Ê∑ªÂä†Á∫¶ÊùüÂøÖÈ°ªÂÖàÊääËßÜÂõæÊ∑ªÂä†Âà∞Áà∂ËßÜÂõæ‰∏äÔºåÂê¶Âàô‰ºöcrash Á∫¶ÊùüÊ∑ªÂä†Âá†ÂÄç‰∫é1make.width.equalTo(superview.mas_width).multiplieBy(0.5); Á∫¶Êùü‰∏çË∂ÖËøáÊàñËÄÖ‰∏çÂ∞è‰∫é1234// ‰∏çÂ∞è‰∫émake.left.greaterThanOrEqualTo(label.mas_left);// ‰∏çÂ§ß‰∫émake.left.lessThanOrEqualTo(label.mas_left); ‰ºòÂÖàÁ∫ßÂèØ‰ª•ËÆæÁΩÆ‰∏âÁßç‰ºòÂÖàÁ∫ß .priorityHighÔºå.priorityMediumÔºå.priorityLow„ÄÇ‰πüÂèØ‰ª•Ëá™Â∑±ËÆæÁΩÆ‰ºòÂÖàÁ∫ßÁöÑÂ§ßÂ∞è„ÄÇÈªòËÆ§ÁöÑ‰ºòÂÖàÁ∫ß‰∏∫ 1000 12make.left.greaterThanOrEqualTo(label.mas_left).with.priorityLow();make.top.equalTo(label.mas_top).with.priority(600); ËÆæÁΩÆËæπË∑ùÂ§ßÂ∞èÂíå‰∏≠ÂøÉÁÇπedgs123456// make top, left, bottom, right equal view2make.edges.equalTo(view2);// make top = superview.top + 5, left = superview.left + 10,// bottom = superview.bottom - 15, right = superview.right - 20make.edges.equalTo(superview).insets(UIEdgeInsetsMake(5, 10, 15, 20)) size12345// make width and height greater than or equal to titleLabelmake.size.greaterThanOrEqualTo(titleLabel)// make width = superview.width + 100, height = superview.height - 50make.size.equalTo(superview).sizeOffset(CGSizeMake(100, -50)) center12345// make centerX and centerY = button1make.center.equalTo(button1)// make centerX = superview.centerX - 5, centerY = superview.centerY + 10make.center.equalTo(superview).centerOffset(CGPointMake(-5, 10)) Êõ¥Êñ∞Á∫¶Êùü‰ΩøÁî® mas_updateConstraints Êõ¥Êñ∞Á∫¶Êùü 1234567[self.growingButton mas_updateConstraints:^(MASConstraintMaker *make) &#123; make.center.equalTo(self); make.width.equalTo(@(self.buttonSize.width)).priorityLow(); make.height.equalTo(@(self.buttonSize.height)).priorityLow(); make.width.lessThanOrEqualTo(self); make.height.lessThanOrEqualTo(self);&#125;]; ÈáçÊñ∞ËÆæÁΩÆÁ∫¶Êùü‰ΩøÁî® mas_remakeConstraints ÈáçÊñ∞ËÆæÁΩÆÁ∫¶Êùü 123456789[self.button mas_remakeConstraints:^(MASConstraintMaker *make) &#123; make.size.equalTo(self.buttonSize); if (topLeft) &#123; make.top.and.left.offset(10); &#125; else &#123; make.bottom.and.right.offset(-10); &#125;&#125;]; Â§ö‰∏™Êéß‰ª∂Á≠âË∑ù„ÄÅÁ≠âÂÆΩÊéíÂàóMasonry Êèê‰æõ‰∫Ü‰∏§‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Êèê‰æõÁ≠âË∑ùÊéíÂàóÊàñËÄÖÁ≠âÂÆΩÊéíÂàóÔºö 12345678910111213141516171819/** * Á≠âË∑ùÊéíÂàó * * @param axisType Ê®™ÊéíËøòÊòØÁ´ñÊéí * @param fixedSpacing ‰∏§‰∏™Êéß‰ª∂Èó¥Èöî * @param leadSpacing Á¨¨‰∏Ä‰∏™Êéß‰ª∂‰∏éËæπÁºòÁöÑÈó¥Èöî * @param tailSpacing ÊúÄÂêé‰∏Ä‰∏™Êéß‰ª∂‰∏éËæπÁºòÁöÑÈó¥Èöî */- (void)mas_distributeViewsAlongAxis:(MASAxisType)axisType withFixedSpacing:(CGFloat)fixedSpacing leadSpacing:(CGFloat)leadSpacing tailSpacing:(CGFloat)tailSpacing;/** * Á≠âÂÆΩÊéíÂàó * * @param axisType Ê®™ÊéíËøòÊòØÁ´ñÊéí * @param fixedItemLength Êéß‰ª∂ÁöÑÂÆΩÊàñÈ´ò * @param leadSpacing Á¨¨‰∏Ä‰∏™Êéß‰ª∂‰∏éËæπÁºòÁöÑÈó¥Èöî * @param tailSpacing ÊúÄÂêé‰∏Ä‰∏™Êéß‰ª∂‰∏éËæπÁºòÁöÑÈó¥Èöî */- (void)mas_distributeViewsAlongAxis:(MASAxisType)axisType withFixedItemLength:(CGFloat)fixedItemLength leadSpacing:(CGFloat)leadSpacing tailSpacing:(CGFloat)tailSpacing; Ë¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂ¶ÇÊûúÊòØÊ®™ÊéíÔºåÈÇ£‰πàËøòÊòØÈúÄË¶ÅËá™Â∑±ËÆæÁΩÆÈ´òÂ∫¶Á∫¶ÊùüÔºõÂ¶ÇÊûúÊòØÁ´ñÊéíÔºåËøòÊòØÈúÄË¶ÅËÆæÁΩÆÂÆΩÂ∫¶Á∫¶Êùü„ÄÇ‰æãÔºö 12345678910111213141516171819202122232425262728// ÂØºÂÖ• NSArray ÁöÑÂàÜÁ±ª#import "NSArray+MASAdditions.h"// ÊääËßÜÂõæÊ∑ªÂä†Âà∞Êï∞ÁªÑ‰∏≠- (NSMutableArray *)masonryViewArray &#123; if (!_masonryViewArray) &#123; _masonryViewArray = [NSMutableArray array]; for (int i = 0; i &lt; 4; i ++) &#123; UIView *view = [[UIView alloc] init]; view.backgroundColor = [UIColor redColor]; [self.view addSubview:view]; [_masonryViewArray addObject:view]; &#125; &#125; return _masonryViewArray;&#125;// ËÆæÁΩÆÁ∫¶Êùü- (void)test_masonry_horizontal_fixSpace &#123; // ÂÆûÁé∞masonryÊ∞¥Âπ≥Âõ∫ÂÆöÈó¥ÈöîÊñπÊ≥ï [self.masonryViewArray mas_distributeViewsAlongAxis:MASAxisTypeHorizontal withFixedSpacing:30 leadSpacing:10 tailSpacing:10]; // ËÆæÁΩÆarrayÁöÑÂûÇÁõ¥ÊñπÂêëÁöÑÁ∫¶Êùü [self.masonryViewArray mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.top.equalTo(150); make.height.equalTo(80); &#125;];&#125; Ëøô‰∏™ÊñπÊ≥ïÂú®ÂÆòÊñπÁöÑ README ‰∏≠Ê≤°ÊúâÁúãÂà∞ÔºåÂè™ÊòØÂú®ÈòÖËØªÊ∫êÁ†ÅÁöÑÊó∂ÂÄôÊâçÊ≥®ÊÑèÂà∞ Ê∫êÁ†ÅËß£ÊûêÊñá‰ª∂ÁªìÊûÑ ‰ΩøÁî® Masonry ËÆæÁΩÆÁ∫¶ÊùüÁöÑÊó∂ÂÄôÔºå‰∏ªË¶ÅÁöÑÂá†‰∏™Á±ªÂ¶Ç‰∏äÂõæÊâÄÁ§∫„ÄÇÊúÄ‰∏äÈù¢ÁöÑ‰∏â‰∏™ÊòØË∞ÉÁî®ËÄÖÔºåÂàÜÂà´Âú® UIViewÔºåUIViewController Âíå NSArray ‰∏≠Ê∑ªÂä†ÂàÜÁ±ªÊñπÊ≥ï„ÄÇ‰∏ãÈù¢ÁöÑ MASConstraintMaker ÊòØÁ∫¶ÊùüÁöÑÂàõÂª∫ËÄÖÔºåÊàë‰ª¨Âú® block ‰∏≠‰ΩøÁî®ÁöÑ make Â∞±ÊòØËøô‰∏™Á±ªÁöÑÂÆû‰æã„ÄÇÂêéÈù¢ÁöÑ MASContraint Âíå MASViewAdditions ‰∏çÂØπ‰ΩøÁî®ËÄÖÊö¥Èú≤ÔºåÂâçËÄÖÊòØÁ∫¶ÊùüÂÆû‰æãÁöÑÂ∞ÅË£ÖÔºåÂêéËÄÖÊòØÊâÄÁ∫¶ÊùüÂØπË±°ÁöÑÂ∞ÅË£Ö„ÄÇ Êàë‰ª¨‰ΩøÁî®ÁöÑÊó∂ÂÄô‰∏ªË¶ÅË∞ÉÁî® View+MASAdditions‰∏≠ÁöÑÊñπÊ≥ïÔºåÁõ¥Êé•Âú®Êüê‰∏™ View ‰∏äÊ∑ªÂä†Á∫¶Êùü„ÄÇ NSArray+MASAdditions ÂèØ‰ª•Â∞ÜÂ§ö‰∏™ËßÜÂõæÊîæÂú®‰∏Ä‰∏™Êï∞ÁªÑ‰∏≠ÔºåÁÑ∂ÂêéÂØπÂÖ∂‰∏≠ÁöÑÊØè‰∏Ä‰∏™ËßÜÂõæÂä†‰∏äÁ∫¶ÊùüÔºåÁî®ÁöÑÂæàÂ∞ë„ÄÇViewController+MASAdditions ‰∏ªË¶ÅÊìç‰ΩúÁöÑÊòØtopLayoutGuide Âíå bottomLayoutGuide„ÄÇËøô‰∏§‰∏™ View ÁöÑÂ±ûÊÄßÂú® iOS11 ‰∏≠Â∑≤ÁªèË¢´Â∫üÂºÉÔºåÂª∫ËÆÆ‰ΩøÁî® View ‰∏≠ÁöÑ mas_safeAreaLayoutGuide Êõø‰ª£„ÄÇÂõ†Ê≠§ÔºåÂá†‰πé‰∏ç‰ΩøÁî® View+MASAdditionsËøô‰∏™ UIView ÁöÑÂàÜÁ±ªÊèê‰æõ‰∫Ü‰∏â‰∏™ÊñπÊ≥ïÂàÜÂà´Áî®Êù•ÂàõÂª∫„ÄÅÊõ¥Êñ∞„ÄÅÈáçËÆæÁ∫¶Êùü„ÄÇÂÖàÊù•ÁúãÂàõÂª∫Á∫¶ÊùüÁöÑÊñπÊ≥ïÔºö 123456- (NSArray *)mas_makeConstraints:(void(^)(MASConstraintMaker *))block &#123; self.translatesAutoresizingMaskIntoConstraints = NO; MASConstraintMaker *constraintMaker = [[MASConstraintMaker alloc] initWithView:self]; block(constraintMaker); return [constraintMaker install];&#125; Ëøô‰∏™ÊñπÊ≥ï‰∏≠È¶ñÂÖàÊää translatesAutoresizingMaskIntoConstraints ËÆæÁΩÆ‰∏∫ NOÔºåË°®Á§∫Ë¶ÅËá™Â∑±Ê∑ªÂä†Á∫¶Êùü„ÄÇÁÑ∂ÂêéÂàùÂßãÂåñ MASConstraintMaker„ÄÇÊé•ÁùÄÊää MASConstraintMaker ‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ• block ÊâßË°åÔºåÈÖçÁΩÆÁ∫¶Êùü„ÄÇÊúÄÂêéË∞ÉÁî®install ÊñπÊ≥ïÔºåÊääÈÖçÁΩÆÂ•ΩÁöÑË∂äÊòØÊ∑ªÂä†Âà∞ËßÜÂõæ‰∏ä„ÄÇ ËøôÈáåÂ§ñÈÉ®‰º†Êù•ÁöÑ block ‰∏ç‰ºöË¢´‰øùÂ≠òÔºåËÄåÊòØÁõ¥Êé•ÊâßË°å„ÄÇËøôÂ∞±‰øùËØÅ‰∫Ü block ‰∏≠Áõ¥Êé•Âº∫ÂºïÁî® self ‰πü‰∏ç‰ºö‰∫ßÁîüÂæ™ÁéØÂºïÁî®„ÄÇ ÂÜçÁúãÊõ¥Êñ∞ÂíåÈáçËÆæÊñπÊ≥ïÔºö 123456789101112131415- (NSArray *)mas_updateConstraints:(void(^)(MASConstraintMaker *))block &#123; self.translatesAutoresizingMaskIntoConstraints = NO; MASConstraintMaker *constraintMaker = [[MASConstraintMaker alloc] initWithView:self]; constraintMaker.updateExisting = YES; block(constraintMaker); return [constraintMaker install];&#125;- (NSArray *)mas_remakeConstraints:(void(^)(MASConstraintMaker *make))block &#123; self.translatesAutoresizingMaskIntoConstraints = NO; MASConstraintMaker *constraintMaker = [[MASConstraintMaker alloc] initWithView:self]; constraintMaker.removeExisting = YES; block(constraintMaker); return [constraintMaker install];&#125; ÂíåÂàõÂª∫ÊñπÊ≥ïÁ±ª‰ººÔºåÂè™ÊòØÂ§öÂä†‰∫Ü‰∏§‰∏™Ê†áËÆ∞ updateExistingÔºåremoveExistingÔºåÁî®Êù•ÂíåÂàõÂª∫Âå∫Âà´ÂºÄ„ÄÇ MASConstraintMakerÊàë‰ª¨Âú®ËÆæÁΩÆÁ∫¶ÊùüÁöÑÊó∂ÂÄô‰∏ÄËà¨ÊòØËøô‰πàÂÜôÁöÑÔºö 123[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.top.equalTo(superview.mas_top).with.offset(20); //with is an optional semantic filler&#125;]; Êàë‰ª¨Êù•ÁúãÁúãËøô‰∏™ top ÊñπÊ≥ïÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºö 123456789101112131415161718- (MASConstraint *)top &#123; return [self addConstraintWithLayoutAttribute:NSLayoutAttributeTop];&#125;- (MASConstraint *)addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute &#123; return [self constraint:nil addConstraintWithLayoutAttribute:layoutAttribute];&#125;- (MASConstraint *)constraint:(MASConstraint *)constraint addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute &#123; MASViewAttribute *viewAttribute = [[MASViewAttribute alloc] initWithView:self.view layoutAttribute:layoutAttribute]; MASViewConstraint *newConstraint = [[MASViewConstraint alloc] initWithFirstViewAttribute:viewAttribute]; ... if (!constraint) &#123; newConstraint.delegate = self; [self.constraints addObject:newConstraint]; &#125; return newConstraint;&#125; ‰∏≠Èó¥ÁúÅÁï•‰∫Ü‰∏Ä‰∫õÊöÇÊó∂‰∏çÊ∂âÂèäÁöÑ‰ª£Á†Å„ÄÇËøôÈáåÂÖàÊòØÂàùÂßãÂåñ‰∫Ü MASViewAttribute ÂØπË±°„ÄÇÁî±‰∫é MASViewAttribute Âè™ÊòØÁÆÄÂçïÁöÑÁ∫¶Êùü‰ΩúÁî®ÁöÑËßÜÂõæ‰ª•Âèä‰∏Ä‰∏™Êûö‰∏æÂ±ûÊÄß NSLayoutAttribute (NSLayoutAttribut Â∞±ÊòØÂú®ÂàõÂª∫Á∫¶ÊùüÁöÑÊó∂ÂÄôÊ†áËØÜÁ∫¶ÊùüÁöÑÁ±ªÂûãÁöÑÔºåÊØîÂ¶ÇÂÆΩÂ∫¶ÔºåÈ´òÂ∫¶Ôºå‰∏ä‰∏ãÂ∑¶Âè≥Á≠â)ÁöÑÂ∞ÅË£ÖÔºåÊØîËæÉÁÆÄÂçïÔºåËøôÈáåÂ∞±Áõ¥Êé•Áúã‰∏Ä‰∫õÂÆÉÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºö 123456789101112131415- (id)initWithView:(MAS_VIEW *)view layoutAttribute:(NSLayoutAttribute)layoutAttribute &#123; self = [self initWithView:view item:view layoutAttribute:layoutAttribute]; return self;&#125;- (id)initWithView:(MAS_VIEW *)view item:(id)item layoutAttribute:(NSLayoutAttribute)layoutAttribute &#123; self = [super init]; if (!self) return nil; _view = view; _item = item; _layoutAttribute = layoutAttribute; return self;&#125; Èô§‰∫Ü‰øùÂ≠ò NSLayoutAttribute Â∞±ÊòØÂØπ view ÂÅö‰∫Ü‰∏Ä‰∏™Âº±ÂºïÁî®ÁöÑ‰øùÂ≠ò„ÄÇÂèØ‰ª•ÁúãÂà∞ÔºåÈô§‰∫Ü view Â§ñÔºåËøòÊúâ‰∏Ä‰∏™ÊàêÂëòÂèòÈáè item„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåview Âíå item ÊòØÂêå‰∏Ä‰∏™‰∏úË•ø„ÄÇÂè™ÊúâÂΩìÊ∑ªÂä†ÁöÑÁ∫¶ÊùüÊòØ ViewController ÁöÑ topLayoutGuide Âíå bottomLayoutGuide Êó∂Êâç‰ºö‰∏çÂêåÔºö 123- (MASViewAttribute *)mas_topLayoutGuide &#123; return [[MASViewAttribute alloc] initWithView:self.view item:self.topLayoutGuide layoutAttribute:NSLayoutAttributeBottom];&#125; MASViewAttribute ÁöÑÂàùÂßãÂåñÊñπÊ≥ï‰πãÂêéÔºåÂèàÂàùÂßãÂåñ‰∫Ü MASViewConstraint ÂØπË±°ÔºåÂπ∂ÊääÂÆÉÂä†ÂÖ•Âà∞ MASConstraintMaker ÁöÑ constraints Á∫¶ÊùüÊï∞ÁªÑ‰∏≠ÔºåÂπ∂ÊúÄÁªàËøîÂõû„ÄÇ MASViewConstraint1make.top.equalTo(superview.mas_top).with.offset(20); make.top ËøîÂõûÁöÑÊòØ MASViewConstraint ÂØπË±°ÂÆû‰æãÔºåÊâÄ‰ª•ÂêéÈù¢ÁöÑ equalTo ÊñπÊ≥ïÂ∞±ÊòØ MASViewConstraint ÁöÑÊñπÊ≥ï„ÄÇ ÂÖàÊù•ÁúãÂÆÉÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºö 12345678910- (id)initWithFirstViewAttribute:(MASViewAttribute *)firstViewAttribute &#123; self = [super init]; if (!self) return nil; _firstViewAttribute = firstViewAttribute; self.layoutPriority = MASLayoutPriorityRequired; self.layoutMultiplier = 1; return self;&#125; ‰ªéÂêçÂ≠óÂ∞±ÂèØ‰ª•ÁúãÂá∫ÔºåÂàùÂßãÂåñÁöÑÊó∂ÂÄôÂøÖÈ°ª‰º†ÂÖ•‰∏Ä‰∏™ MASViewAttribute ÂÆû‰æã„ÄÇ‰ªéÂêçÂ≠ó‰πüÂèØ‰ª•ÁúãÂæóÂá∫Êù•ÔºåËøô‰∏™Â±ûÊÄßÊòØ‰Ωú‰∏∫Á∫¶Êùü‰∏≠ÁöÑ FirstView ÁöÑ„ÄÇ ÂÜçÊù•ÁúãÁúã equalTo ÁöÑÂÆûÁé∞ÔºåËøô‰πüÂ∞±ÊòØËøô‰∏™Â∫ìÁöÑÁ≤æÈ´ìÊâÄÂú®: 12345678910111213- (MASConstraint * (^)(id))equalTo &#123; return ^id(id attribute) &#123; return self.equalToWithRelation(attribute, NSLayoutRelationEqual); &#125;;&#125;- (MASConstraint * (^)(id, NSLayoutRelation))equalToWithRelation &#123; return ^id(id attribute, NSLayoutRelation relation) &#123; self.layoutRelation = relation; self.secondViewAttribute = attribute; return self; &#125;;&#125; ÈìæÂºèÁºñÁ®ãÁöÑÊ†∏ÂøÉÂú®‰∫éÊØèÊ¨°Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÈÉΩËøîÂõûËá™Ë∫´„ÄÇOC ÁöÑÁÇπËØ≠Ê≥ïÁõ∏ÂΩì‰∫éË∞ÉÁî®Â±ûÊÄßÁöÑ get ÊñπÊ≥ïÔºåÂõ†Ê≠§ÊòØÊó†Ê≥ï‰º†ÂèÇÁöÑ„ÄÇmake.top.equalTo(superview.mas_top) Áõ∏ÂΩì‰∫éÈÄöËøá equalTo ÁöÑ get ÊñπÊ≥ïÔºåËøîÂõû‰∫Ü‰∏Ä‰∏™ block ÂÆû‰æãÔºåÁÑ∂ÂêéÂÜçÊâßË°åËøô‰∏™ blockÔºåËøîÂõûËá™Ë∫´ÁöÑÂÆû‰æã„ÄÇ ÈìæÂºèÁºñÁ®ãÁöÑ‰∏ÄËà¨‰ΩøÁî®Âú∫ÊôØÂú®‰∫éËÆæÁΩÆ‰∏Ä‰∏™ÂØπË±°ÁöÑÂ§ö‰∏™Â±ûÊÄß„ÄÇ ÊØîÂ¶Ç‰Ω†Ë¶ÅËÆæÁΩÆ‰∏Ä‰∏™ buttonÔºå‰Ω†Ë¶ÅËÆæÁΩÆÂÆÉÁöÑÂ§ö‰∏™Â±ûÊÄßÂ∞±ÈúÄË¶ÅÂú®Â§öË°åÈáåÂàÜÂà´ËÆæÁΩÆ„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú button ÁöÑÊØè‰∏™Â±ûÊÄßÁöÑËÆæÁΩÆÈÉΩËøîÂõû button Ëá™Ë∫´ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Âú®‰∏ÄË°å‰∏≠ÈìæÂºèÁöÑË∞ÉÁî®„ÄÇ ÂêåÊ†∑ÁöÑÔºåoffset ÊñπÊ≥ï‰πüÊòØ‰∏ÄÊ†∑ÁöÑÈÅìÁêÜ„ÄÇ ËÆæÁΩÆÁ∫¶Êùü‰∏ÄÊù°ÈìæÂºèË∞ÉÁî®‰ºöÂàõÂª∫‰∏Ä‰∏™ MASViewConstraint ÂØπË±°„ÄÇÊØè‰∏Ä‰∏™Á∫¶ÊùüÈÉΩ‰ºö‰øùÂ≠òÂà∞ MASConstraintMaker ÁöÑÊï∞ÁªÑ‰∏≠„ÄÇÂú®ËÆæÁΩÆÂÆåÁ∫¶ÊùüÂêéÔºåÂ∞±Êù•Âà∞‰∫Ü [constraintMaker install] Ê∑ªÂä†Á∫¶ÊùüÔºö 12345678910111213141516// MASConstraintMaker- (NSArray *)install &#123; if (self.removeExisting) &#123; NSArray *installedConstraints = [MASViewConstraint installedConstraintsForView:self.view]; for (MASConstraint *constraint in installedConstraints) &#123; [constraint uninstall]; &#125; &#125; NSArray *constraints = self.constraints.copy; for (MASConstraint *constraint in constraints) &#123; constraint.updateExisting = self.updateExisting; [constraint install]; &#125; [self.constraints removeAllObjects]; return constraints;&#125; ËøôÈáå‰πãÂâçÁöÑ‰∏§‰∏™Ê†áËÆ∞Â∞±Ê¥æ‰∏äÁî®Âú∫‰∫ÜÔºåÂ¶ÇÊûúË¶ÅÈáçËÆæÂ∞±‰ºöÂÖàÁßªÈô§Á∫¶ÊùüÂÜçÈáçÊñ∞Ê∑ªÂä†ÔºåËÄåÂ¶ÇÊûúÊòØÊõ¥Êñ∞ÔºåÂ∞±‰ºöÊääÊ†áËÆ∞‰º†ÂÖ•ÊØè‰∏Ä‰∏™Á∫¶Êùü‰∏≠„ÄÇMASViewConstraint ‰∏≠Ê∑ªÂä†Á∫¶ÊùüÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475// MASViewConstraint- (void)install &#123; /// Â¶ÇÊûúËØ•Á∫¶ÊùüÂ∑≤ÁªèË¢´ install ËøáÔºåÈÇ£‰πàÁõ¥Êé• return„ÄÇ if (self.hasBeenInstalled) &#123; return; &#125; if ([self supportsActiveProperty] &amp;&amp; self.layoutConstraint) &#123; self.layoutConstraint.active = YES; /// ÊääÁ∫¶Êùü‰øùÂ≠òÂà∞ view ‰∏äÔºåËøôÊ†∑ÂÜç uninstall ÁöÑÊó∂ÂÄôÂ∞±ÂèØ‰ª•ÊâæÂà∞Âπ∂ÁßªÈô§‰∫Ü„ÄÇ [self.firstViewAttribute.view.mas_installedConstraints addObject:self]; return; &#125; /// ÊãøÂà∞ÊñΩÂä†Á∫¶ÊùüÁöÑÁ¨¨‰∏Ä‰∏™ËßÜÂõæ MAS_VIEW *firstLayoutItem = self.firstViewAttribute.item; NSLayoutAttribute firstLayoutAttribute = self.firstViewAttribute.layoutAttribute; /// ÊãøÂà∞ÊñΩÂä†Á∫¶ÊùüÁöÑÁ¨¨‰∫å‰∏™ËßÜÂõæ MAS_VIEW *secondLayoutItem = self.secondViewAttribute.item; NSLayoutAttribute secondLayoutAttribute = self.secondViewAttribute.layoutAttribute; /// ‰∏çÂ≠òÂú®Á¨¨‰∫å‰∏™AttributeÁöÑÊó∂ÂÄôËÆæÁΩÆ‰∏∫Á¨¨‰∏Ä‰∏™Â±ûÊÄßÁöÑÁà∂Á∫ßÂÖÉÁ¥† if (!self.firstViewAttribute.isSizeAttribute &amp;&amp; !self.secondViewAttribute) &#123; secondLayoutItem = self.firstViewAttribute.view.superview; secondLayoutAttribute = firstLayoutAttribute; &#125; /// ÂàõÂª∫ÁúüÊ≠£ÁöÑÁ∫¶ÊùüÂØπË±°Ôºå‰ªñÊòØ NSLayoutConstraint ÁöÑÂ≠êÁ±ª MASLayoutConstraint *layoutConstraint = [MASLayoutConstraint constraintWithItem:firstLayoutItem attribute:firstLayoutAttribute relatedBy:self.layoutRelation toItem:secondLayoutItem attribute:secondLayoutAttribute multiplier:self.layoutMultiplier constant:self.layoutConstant]; layoutConstraint.priority = self.layoutPriority; layoutConstraint.mas_key = self.mas_key; if (self.secondViewAttribute.view) &#123; /// Â¶ÇÊûúÂ≠òÂú®Á¨¨‰∫å‰∏™ ViewÔºåÈÇ£‰πàÁ∫¶ÊùüË¶ÅÂä†Âú®Ëøô‰∏§‰∏™ View ÁöÑÂÖ¨ÂÖ±Á•ñÂÖàËßÜÂõæ‰∏ä„ÄÇÂõ†Ê≠§Ë¶ÅÊü•ÊâæÂÖ¨ÂÖ±Á•ñÂÖà MAS_VIEW *closestCommonSuperview = [self.firstViewAttribute.view mas_closestCommonSuperview:self.secondViewAttribute.view]; NSAssert(closestCommonSuperview, @"couldn't find a common superview for %@ and %@", self.firstViewAttribute.view, self.secondViewAttribute.view); /// installedViË°®Á§∫Á∫¶ÊùüË¶ÅÊ∑ªÂä†Âà∞ÁöÑËßÜÂõæ self.installedView = closestCommonSuperview; &#125; else if (self.firstViewAttribute.isSizeAttribute) &#123; /// Â¶ÇÊûúÊ≤°ÊúâÁ¨¨‰∫å‰∏™ËßÜÂõæÔºåÂπ∂‰∏îÊòØÊìç‰ΩúÁ¨¨‰∏Ä‰∏™ËßÜÂõæÁöÑ sizeÔºåÈÇ£‰πàÂ∞±Áõ¥Êé•ÊääÁ∫¶ÊùüÂä†Âú®Ëøô‰∏™ËßÜÂõæ‰∏ä self.installedView = self.firstViewAttribute.view; &#125; else &#123; /// Â¶ÇÊûúÊ≤°ÊúâÁ¨¨‰∫å‰∏™ËßÜÂõæÔºåÂπ∂‰∏î‰∏çÊòØÊìç‰ΩúÁ¨¨‰∏Ä‰∏™ËßÜÂõæÁöÑ sizeÔºåÈÇ£‰πàÂ∞±Ë°®Á§∫Ê∑ªÂä†ÁöÑÁ∫¶ÊùüÊòØÁ¨¨‰∏Ä‰∏™ËßÜÂõæÁöÑ‰ΩçÁΩÆÁöÑÔºåÈÇ£‰πàÈúÄË¶ÅÊääÁ∫¶ÊùüÂä†Âú®Á¨¨‰∏Ä‰∏™ËßÜÂõæÁöÑÁà∂ËßÜÂõæ‰∏ä self.installedView = self.firstViewAttribute.view.superview; &#125; MASLayoutConstraint *existingConstraint = nil; /// Â¶ÇÊûúÂ§ñÈÉ®Ê†áËØÜÊòØË¶ÅÊõ¥Êñ∞Á∫¶Êùü if (self.updateExisting) &#123; /// Âà§Êñ≠Ëøô‰∏™Á∫¶ÊùüÊòØÂê¶Â≠òÂú®ÔºåÂà§Êñ≠ÊñπÂºèÊòØÊãøËøô‰∏™Á∫¶ÊùüÁöÑÊØè‰∏Ä‰∏™Â±ûÊÄßÂíå view ‰øùÂ≠òÁöÑÊâÄÊúâÁ∫¶ÊùüÁöÑÊØè‰∏Ä‰∏™Â±ûÊÄßÂØπÊØîÔºåÂ¶ÇÊûúÂÆåÂÖ®Áõ∏Á≠âÂ∞±Ë°®Á§∫Â≠òÂú® existingConstraint = [self layoutConstraintSimilarTo:layoutConstraint]; &#125; if (existingConstraint) &#123; /// Â¶ÇÊûúËøô‰∏™Á∫¶ÊùüÂ≠òÂú® Êõ¥Êñ∞Á∫¶Êùü existingConstraint.constant = layoutConstraint.constant; self.layoutConstraint = existingConstraint; &#125; else &#123; /// Â¶ÇÊûúÁ∫¶Êùü‰∏çÂ≠òÂú®ÔºåÁªôËßÜÂõæÂ¢ûÂä†Á∫¶Êùü [self.installedView addConstraint:layoutConstraint]; self.layoutConstraint = layoutConstraint; [firstLayoutItem.mas_installedConstraints addObject:self]; &#125;&#125; Ê∫êÁ†ÅÊØîËæÉÈïøÔºå‰ΩÜÊòØÊÄùÊÉ≥ËøòÊòØÂæàÊòéÁ°ÆÁöÑÔºåÂ∞±ÊòØË∞ÉÁî® iOS Êèê‰æõÁöÑ NSLayoutConstraint ÊñπÊ≥ïÁîüÊàêÁ∫¶ÊùüÔºåÁÑ∂ÂêéÊâæÂà∞‰∏§‰∏™ËßÜÂõæÁöÑÂÖ¨ÂÖ±Áà∂ËäÇÁÇπÔºåÂ∞ÜÁ∫¶ÊùüÊ∑ªÂä†Âà∞ÂÖ¨ÂÖ±Áà∂ËäÇÁÇπ‰∏ä„ÄÇ MASCompositeConstraintÊúÄÂêéÔºåÊù•Áûß‰∏Ä‰∏ã MASViewConstraint ÁöÑÂ≠êÁ±ª MASCompositeConstraint„ÄÇ‰πãÂâçÊàë‰ª¨ÁúÅÁï•ÁöÑ‰ª£Á†ÅÈÉΩÊòØÈíàÂØπÂÆÉÁöÑ„ÄÇÁÆÄÂçïÁöÑËØ¥ÔºåMASCompositeConstraint Â∞±ÊòØ MASViewConstraint ÁöÑÈõÜÂêà„ÄÇ Êàë‰ª¨Áúã‰∏Ä‰∏ãËøôÊ†∑ËÆæÁΩÆÁ∫¶ÊùüÁöÑÂú∫ÊôØÔºö 1make.height.and.width.equaltTo(@20) Êàë‰ª¨Âú® make.height ÁöÑÊó∂ÂÄôÔºåÂ∑≤ÁªèÂàõÂª∫‰∫Ü‰∏Ä‰∏™ MASViewConstraint ÂÆû‰æã„ÄÇÊâÄ‰ª•ÊâßË°åÂà∞ .width ÁöÑÊó∂ÂÄôÔºåË∞ÉÁî®ÁöÑÊòØ MASViewConstraint ÁöÑ width ÊñπÊ≥ï„ÄÇÊàë‰ª¨Êù•ÂØπÊØî‰∏Ä‰∏ã‰∏§ËÄÖÁöÑ‰∏çÂêåÔºö 123456789// MASConstraintMaker- (MASConstraint *)addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute &#123; return [self constraint:nil addConstraintWithLayoutAttribute:layoutAttribute];&#125;// MASViewConstraint- (MASConstraint *)addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute &#123; return [self.delegate constraint:self addConstraintWithLayoutAttribute:layoutAttribute];&#125; ‰∏§ËÄÖÁöÑ‰∏çÂêåÂú®‰∫éÔºåÁî® MASConstraintMaker ÂàõÂª∫ÁöÑÁ∫¶Êùü‰º†ÂÖ•ÁöÑÊòØ nilÔºåËÄåÈÄöËøá MASViewConstraint ÂàõÂª∫ÁöÑÁ∫¶Êùü‰º†ÂÖ•ÁöÑÊòØËá™Ë∫´„ÄÇÊé•ÁùÄÊù•Áúã‰∏ãÈù¢ÁöÑÂ§ÑÁêÜÊñπÊ≥ïÔºö 12345678910111213- (MASConstraint *)constraint:(MASConstraint *)constraint addConstraintWithLayoutAttribute:(NSLayoutAttribute)layoutAttribute &#123; MASViewAttribute *viewAttribute = [[MASViewAttribute alloc] initWithView:self.view layoutAttribute:layoutAttribute]; MASViewConstraint *newConstraint = [[MASViewConstraint alloc] initWithFirstViewAttribute:viewAttribute]; if ([constraint isKindOfClass:MASViewConstraint.class]) &#123; //replace with composite constraint NSArray *children = @[constraint, newConstraint]; MASCompositeConstraint *compositeConstraint = [[MASCompositeConstraint alloc] initWithChildren:children]; compositeConstraint.delegate = self; [self constraint:constraint shouldBeReplacedWithConstraint:compositeConstraint]; return compositeConstraint; &#125; ....&#125; ÂΩì constraint ‰∏ç‰∏∫ nil ÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÊääÂéüÊù•ÁöÑÁ∫¶ÊùüÂíåÁé∞Âú®ÁöÑÁ∫¶Êùü‰Ωú‰∏∫‰∏Ä‰∏™Êï∞ÁªÑÔºåÂàõÂª∫‰∏Ä‰∏™ MASCompositeConstraint ÂÆû‰æã„ÄÇÈöèÂêéÊõøÊç¢ MASConstraintMaker ‰∏≠Áõ∏Â∫îÁöÑÂÄº„ÄÇ Áõ∏Â∫îÁöÑÔºåinstall ÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÂØπ MASCompositeConstraint ‰∏≠ÁöÑÊâÄÊúâÁ∫¶ÊùüË∞ÉÁî® install ÊñπÊ≥ïÔºö 1234567// MASCompositeConstraint- (void)install &#123; for (MASConstraint *constraint in self.childConstraints) &#123; constraint.updateExisting = self.updateExisting; [constraint install]; &#125;&#125; ÊÄªÁªìÁ∫¶ÊùüÁöÑÂàõÂª∫Êú¨Ë∫´Ê∂âÂèäÂà∞ÂæàÂ§öÁöÑÂ±ûÊÄßËÆæÁΩÆÔºåMasonry ‰ΩøÁî®ÈìæÂºèËØ≠Ê≥ïÁöÑÊñπÂºèÁ≤æÁÆÄ‰∫ÜÂ§ßÈáèÁöÑ‰ª£Á†Å„ÄÇÊï¥‰ΩìËÄåË®ÄÔºåMasonry Âπ∂‰∏çÊòØ‰∏Ä‰∏™Â§™ÈöæÁêÜËß£ÁöÑÂ∫ì„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack ÁÆÄÂçï‰ΩøÁî®]]></title>
    <url>%2F2018%2F03%2F29%2Fwebpack%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[Âä™ÂäõÊàê‰∏∫‰∏ÄÂêçwebpackÈÖçÁΩÆÂ∑•Á®ãÂ∏à~~~ ÂÆâË£Ö‰ΩøÁî® npm ÂÆâË£ÖÔºå‰∏ÄËà¨ÂÆâË£Ö‰∏∫ devdependencyÔºö 1npm install webpack --save-dev ÁÑ∂ÂêéÂÜç package.json ‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ script Ôºö 1234567"scripts": &#123; "build": "webpack --mode production"&#125;,"devDependencies": &#123; "webpack": "^4.1.1", "webpack-cli": "^2.0.12", &#125; ÊâßË°å‰∫Ü npm run bulid ÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÂú®ÁõÆÂΩï‰∏ãÂØªÊâæ webpack.config.js ÈÖçÁΩÆÊñá‰ª∂Âπ∂ÊâßË°å„ÄÇ ÂÖ•Âè£ÂÖ•Âè£Ë°®Á§∫ÊâìÂåÖÁöÑ‰æùËµñÁöÑÂºÄÂßã„ÄÇ‰ΩøÁî® entry Â≠óÊÆµË°®Á§∫Ôºö 123456789101112131415161718// ÊàñËÄÖÈÖçÁΩÆÂ§ö‰∏™ÂÖ•Âè£module.exports = &#123; entry: &#123; foo: './src/page-foo.js', bar: './src/page-bar.js', // ... &#125;&#125;// ‰ΩøÁî®Êï∞ÁªÑÊù•ÂØπÂ§ö‰∏™Êñá‰ª∂ËøõË°åÊâìÂåÖmodule.exports = &#123; entry: &#123; main: [ './src/foo.js', './src/bar.js' ] &#125;&#125; loaderloader ÊòØ‰∏ÄÁßçËΩ¨Êç¢Âô®ÔºåÂ∞ÜÊüêÁßçÁ±ªÂûãÁöÑÊñá‰ª∂Ê†ºÂºèËΩ¨‰∏∫ webpack ÂèØ‰ª•ÊîØÊåÅÁöÑÊâìÂåÖÁöÑÊ®°Âùó„ÄÇÊØîÂ¶ÇÂèØ‰ª•ÈÄöËøá vue-loader Ëß£Êûê .vue Êñá‰ª∂ÔºåÂ∞ÜÂÖ∂ËΩ¨Êç¢‰∏∫ js ‰ª£Á†Å„ÄÇ ‰ΩøÁî® module.rules Ë°®Á§∫Ôºö 123456789101112module: &#123; // ... rules: [ &#123; test: /\.jsx?/, // ÂåπÈÖçÊñá‰ª∂Ë∑ØÂæÑÁöÑÊ≠£ÂàôË°®ËææÂºèÔºåÈÄöÂ∏∏Êàë‰ª¨ÈÉΩÊòØÂåπÈÖçÊñá‰ª∂Á±ªÂûãÂêéÁºÄ include: [ path.resolve(__dirname, 'src') // ÊåáÂÆöÂì™‰∫õË∑ØÂæÑ‰∏ãÁöÑÊñá‰ª∂ÈúÄË¶ÅÁªèËøá loader Â§ÑÁêÜ ], use: 'babel-loader', // ÊåáÂÆö‰ΩøÁî®ÁöÑ loader &#125;, ],&#125; pluginÊ®°Âùó‰ª£Á†ÅËΩ¨Êç¢ÁöÑÂ∑•‰ΩúÁî± loader Êù•Â§ÑÁêÜÔºåÈô§Ê≠§‰πãÂ§ñÁöÑÂÖ∂‰ªñ‰ªª‰ΩïÂ∑•‰ΩúÈÉΩÂèØ‰ª•‰∫§Áî± plugin Êù•ÂÆåÊàê„ÄÇ ÊØîÂ¶Ç‰ΩøÁî® uglifyjs-webpack-plugin ÂéãÁº© JS ‰ª£Á†Å 1234567const UglifyPlugin = require('uglifyjs-webpack-plugin')module.exports = &#123; plugins: [ new UglifyPlugin() ],&#125; DefinePlugin ÊòØ webpack ÂÜÖÁΩÆÁöÑÊèí‰ª∂ÔºåÂèØ‰ª•‰ΩøÁî® webpack.DefinePlugin Áõ¥Êé•Ëé∑Âèñ„ÄÇËøô‰∏™Êèí‰ª∂Áî®‰∫éÂàõÂª∫‰∏Ä‰∫õÂú®ÁºñËØëÊó∂ÂèØ‰ª•ÈÖçÁΩÆÁöÑÂÖ®Â±ÄÂ∏∏ÈáèÔºö 1234567891011121314module.exports = &#123; // ... plugins: [ new webpack.DefinePlugin(&#123; PRODUCTION: JSON.stringify(true), // const PRODUCTION = true VERSION: JSON.stringify('5fa3b9'), // const VERSION = '5fa3b9' BROWSER_SUPPORTS_HTML5: true, // const BROWSER_SUPPORTS_HTML5 = 'true' TWO: '1+1', // const TWO = 1 + 1, CONSTANTS: &#123; APP_VERSION: JSON.stringify('1.1.2') // const CONSTANTS = &#123; APP_VERSION: '1.1.2' &#125; &#125; &#125;), ],&#125; Êúâ‰∫Ü‰∏äÈù¢ÁöÑÈÖçÁΩÆÔºåÂ∞±ÂèØ‰ª•Âú®Â∫îÁî®‰ª£Á†ÅÊñá‰ª∂‰∏≠ÔºåËÆøÈóÆÈÖçÁΩÆÂ•ΩÁöÑÂèòÈáè‰∫ÜÔºåÂ¶Ç: 1console.log("Running App version " + VERSION); copy-webpack-plugin Áî®Êù•ÊääËµÑÊ∫êÊñá‰ª∂ÁßªÂä®Âà∞ÊåáÂÆöÁõÆÂΩï‰∏ãÔºö 123456789101112const CopyWebpackPlugin = require('copy-webpack-plugin')module.exports = &#123; // ... plugins: [ new CopyWebpackPlugin([ &#123; from: 'src/file.txt', to: 'build/file.txt', &#125;, // È°æÂêçÊÄù‰πâÔºåfrom ÈÖçÁΩÆÊù•Ê∫êÔºåto ÈÖçÁΩÆÁõÆÊ†áË∑ØÂæÑ &#123; from: 'src/*.ico', to: 'build/*.ico' &#125;, // ÈÖçÁΩÆÈ°πÂèØ‰ª•‰ΩøÁî® glob // ÂèØ‰ª•ÈÖçÁΩÆÂæàÂ§öÈ°πÂ§çÂà∂ËßÑÂàô ]), ],&#125; ËæìÂá∫ËæìÂá∫Âç≥Êåá webpack ÊúÄÁªàÊûÑÂª∫Âá∫Êù•ÁöÑÈùôÊÄÅÊñá‰ª∂Ôºå‰ΩøÁî® output Â≠óÊÆµÔºö 12345678910111213141516171819module.exports = &#123; // ... output: &#123; path: path.resolve(__dirname, 'dist'), filename: 'bundle.js', &#125;,&#125;// ÊàñËÄÖÂ§ö‰∏™ÂÖ•Âè£ÁîüÊàê‰∏çÂêåÊñá‰ª∂module.exports = &#123; entry: &#123; foo: './src/foo.js', bar: './src/bar.js', &#125;, output: &#123; filename: '[name].js', path: __dirname + '/dist', &#125;,&#125; Ëß£Êûêresolve Ë°®Á§∫Â¶Ç‰ΩïËß£Êûê„ÄÇ ‰ΩøÁî® resolve.alias Êù•ÂàõÂª∫Âà´ÂêçÔºö 123456789module.exports = &#123; //... resolve: &#123; alias: &#123; Utilities: path.resolve(__dirname, 'src/utilities/'), Templates: path.resolve(__dirname, 'src/templates/') &#125; &#125;&#125;; Â¶ÇÊûúÂéüÊù•‰ΩøÁî®Áõ∏ÂØπË∑ØÂæÑÔºö 1import Utility from '../../utilities/utility'; Áé∞Âú®Â∞±ÂèØ‰ª•‰ΩøÁî®ÁªùÂØπË∑ØÂæÑ‰∫ÜÔºö 1import Utility from 'Utilities/utility'; ‰ΩøÁî® resolve.extensions Ëß£ÊûêÁõ∏Â∫îÁ±ªÂûãÔºö 123456module.exports = &#123; //... resolve: &#123; extensions: ['.js', '.vue', '.json'], &#125;&#125;; ‰ΩøÁî® resolve.modules ÈÖçÁΩÆÊ®°ÂùóÁöÑÊêúÁ¥¢Ë∑ØÂæÑÔºö 123resolve: &#123; modules: ['node_modules'],&#125;,]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SDWebImage Ê∫êÁ†ÅËß£Êûê‚ÄîËß£Á†ÅÁ≠ñÁï•]]></title>
    <url>%2F2018%2F03%2F07%2Fsdwebimage4%2F</url>
    <content type="text"><![CDATA[‰∏ä‰∏ÄÁØáËÆ≤Âà∞‰∫ÜÂ¶Ç‰Ωï‰∏ãËΩΩ„ÄÇËøôÁØáÂ∞ÜÊé¢Á©∂‰∏ãËΩΩÂêéÊòØÂ¶Ç‰ΩïËß£Á†ÅÁöÑ„ÄÇ Â§ñÈÉ®Ë∞ÉÂä®Â§ñÈÉ®‰ºöÂú® disk ‰∏≠Ëé∑ÂèñÂà∞ÁºìÂ≠ò data ÂêéË∞ÉÁî®Ëß£Á†ÅÊñπÊ≥ïÔºå‰πü‰ºöÂú® download Âà∞ data ÂêéË∞ÉÁî®Ëß£Á†ÅÊñπÊ≥ï„ÄÇ‰∏§ËÄÖÁöÑËß£Á†ÅÊìç‰ΩúÂü∫Êú¨‰∏ÄËá¥Ôºå‰ΩÜÊòØÂâçËÄÖË∞ÉÁî®ÁöÑ SDImageCacheDefine.m ‰∏≠ÁöÑÊñπÊ≥ïÔºåËÄåÂêéËÄÖË∞ÉÁî®ÁöÑÊòØ SDImageLoader.m ‰∏≠ÁöÑÊñπÊ≥ï Cache ‰∏≠ÁöÑËß£Á†ÅÂú®‰ªé disk ‰∏≠ÊãøÂà∞ NSData ‰πãÂêéÔºåÂ∞±‰ºöË∞ÉÁî® SDImageCacheDefine.m ‰∏≠ÁöÑ SDImageCacheDecodeImageData() ÊñπÊ≥ïÔºåËøõË°åËß£Á†ÅÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162UIImage * _Nullable SDImageCacheDecodeImageData(NSData * _Nonnull imageData, NSString * _Nonnull cacheKey, SDWebImageOptions options, SDWebImageContext * _Nullable context) &#123; UIImage *image; /// Âà§Êñ≠ÊòØÂê¶Âè™Ë¶ÅËß£Á†ÅÁ¨¨‰∏ÄÂ∏ß BOOL decodeFirstFrame = SD_OPTIONS_CONTAINS(options, SDWebImageDecodeFirstFrameOnly); NSNumber *scaleValue = context[SDWebImageContextImageScaleFactor]; /// Ëé∑ÂèñËß£Á†ÅÁöÑ scale CGFloat scale = scaleValue.doubleValue &gt;= 1 ? scaleValue.doubleValue : SDImageScaleFactorForKey(cacheKey); SDImageCoderOptions *coderOptions = @&#123;SDImageCoderDecodeFirstFrameOnly : @(decodeFirstFrame), SDImageCoderDecodeScaleFactor : @(scale)&#125;; if (context) &#123; SDImageCoderMutableOptions *mutableCoderOptions = [coderOptions mutableCopy]; [mutableCoderOptions setValue:context forKey:SDImageCoderWebImageContext]; coderOptions = [mutableCoderOptions copy]; &#125; /// Â¶ÇÊûú‰∏ç‰ªÖ‰ªÖËß£Á†ÅÁ¨¨‰∏ÄÂ∏ßÔºåÂàô‰ªé context ‰∏≠ÂèñÂá∫ AnimatedImageClassÔºåÈªòËÆ§‰ΩøÁî®ÁöÑÊòØ SDAnimatedImageÔºåÁÑ∂ÂêéËøõË°åÂõæÁâáÊï∞ÊçÆÁöÑËß£Á†ÅÔºåÊ†πÊçÆÈúÄË¶ÅËøòÂèØ‰ª•È¢ÑËß£Á†ÅÊâÄÊúâÂ∏ß if (!decodeFirstFrame) &#123; Class animatedImageClass = context[SDWebImageContextAnimatedImageClass]; // check whether we should use `SDAnimatedImage` if ([animatedImageClass isSubclassOfClass:[UIImage class]] &amp;&amp; [animatedImageClass conformsToProtocol:@protocol(SDAnimatedImage)]) &#123; image = [[animatedImageClass alloc] initWithData:imageData scale:scale options:coderOptions]; if (image) &#123; // Preload frames if supported if (options &amp; SDWebImagePreloadAllFrames &amp;&amp; [image respondsToSelector:@selector(preloadAllFrames)]) &#123; [((id&lt;SDAnimatedImage&gt;)image) preloadAllFrames]; &#125; &#125; else &#123; // Check image class matching if (options &amp; SDWebImageMatchAnimatedImageClass) &#123; return nil; &#125; &#125; &#125; &#125; if (!image) &#123; /// ‰ªé data ËΩ¨‰∏∫ image image = [[SDImageCodersManager sharedManager] decodedImageWithData:imageData options:coderOptions]; &#125; if (image) &#123; /// Êü•ÁúãÊòØÂê¶ÈúÄË¶ÅËß£Á†Å BOOL shouldDecode = !SD_OPTIONS_CONTAINS(options, SDWebImageAvoidDecodeImage); if ([image.class conformsToProtocol:@protocol(SDAnimatedImage)]) &#123; // `SDAnimatedImage` do not decode /// Âä®Âõæ‰∏çÈúÄË¶ÅËß£Á†Å shouldDecode = NO; &#125; else if (image.sd_isAnimated) &#123; // animated image do not decode shouldDecode = NO; &#125; /// ÈúÄË¶ÅËß£Á†ÅÂ∞±ÂºÄÂßãËß£Á†ÅÔºåÊää image Âä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠ if (shouldDecode) &#123; /// ÊòØÂê¶ÈúÄË¶ÅÁº©Êîæ BOOL shouldScaleDown = SD_OPTIONS_CONTAINS(options, SDWebImageScaleDownLargeImages); if (shouldScaleDown) &#123; image = [SDImageCoderHelper decodedAndScaledDownImageWithImage:image limitBytes:0]; &#125; else &#123; image = [SDImageCoderHelper decodedImageWithImage:image]; &#125; &#125; &#125; return image;&#125; Â¶ÇÊûúÊòØ‰∏Ä‰∏™Âä®ÂõæÔºåÂπ∂‰∏î‰∏çÂè™Ëß£Á†ÅÁ¨¨‰∏ÄÂ∏ßÔºåÈÇ£‰πàÂ∞±‰ºöË∞ÉÁî® SDAnimatedImage ÁöÑÂàùÂßãÂåñÊñπÊ≥ïÊääÊâÄÊúâÂ∏ßÈÉΩËß£Á†ÅÂá∫Êù•„ÄÇ Â¶ÇÊûú‰∏çÊòØÂä®ÂõæÔºåÈÇ£‰πàÂ∞±‰ºöÈÄöËøá SDImageCodersManager ÂÖàÁî® NSData ÂàõÂª∫ UIImageÔºåÂÜçÂØπ UIImage Ëß£Á†Å„ÄÇÊï¥‰∏™ËøáÁ®ã‰ºöÂú®‰∏ãÊñáËØ¶Ëß£„ÄÇ Download ‰∏≠ÁöÑËß£Á†Ådownload ÊñπÂºè‰∏ãÁöÑËß£Á†ÅÊñπÊ≥ïÂú® SDImageLoader.m ‰∏≠„ÄÇÊúâ‰∏§‰∏™ÊñπÊ≥ï SDImageLoaderDecodeImageData() Âíå SDImageLoaderDecodeProgressiveImageData()„ÄÇ ÂâçËÄÖÂíå Cache ‰∏≠ÁöÑÊñπÊ≥ïÊòØ‰∏ÄÊ†∑ÁöÑÔºåÈÉΩÊòØÂ∞Ü‰∏ãËΩΩÊàñËÄÖÂÜÖÂ≠òÂä†ËΩΩÁöÑ NSData ËΩ¨‰∏∫ UIImageÔºåÂÜçËß£Á†Å„ÄÇÂêéËÄÖÂàôÊèê‰æõ‰∫Ü‰∏ÄÁßçÊ∏êËøõÂºèÂä†ËΩΩÂõæÁâáÁöÑÊñπÂºèÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980UIImage * _Nullable SDImageLoaderDecodeProgressiveImageData(NSData * _Nonnull imageData, NSURL * _Nonnull imageURL, BOOL finished, id&lt;SDWebImageOperation&gt; _Nonnull operation, SDWebImageOptions options, SDWebImageContext * _Nullable context) &#123; NSCParameterAssert(imageData); NSCParameterAssert(imageURL); NSCParameterAssert(operation); UIImage *image; id&lt;SDWebImageCacheKeyFilter&gt; cacheKeyFilter = context[SDWebImageContextCacheKeyFilter]; NSString *cacheKey; if (cacheKeyFilter) &#123; cacheKey = [cacheKeyFilter cacheKeyForURL:imageURL]; &#125; else &#123; cacheKey = imageURL.absoluteString; &#125; BOOL decodeFirstFrame = SD_OPTIONS_CONTAINS(options, SDWebImageDecodeFirstFrameOnly); NSNumber *scaleValue = context[SDWebImageContextImageScaleFactor]; CGFloat scale = scaleValue.doubleValue &gt;= 1 ? scaleValue.doubleValue : SDImageScaleFactorForKey(cacheKey); SDImageCoderOptions *coderOptions = @&#123;SDImageCoderDecodeFirstFrameOnly : @(decodeFirstFrame), SDImageCoderDecodeScaleFactor : @(scale)&#125;; if (context) &#123; SDImageCoderMutableOptions *mutableCoderOptions = [coderOptions mutableCopy]; [mutableCoderOptions setValue:context forKey:SDImageCoderWebImageContext]; coderOptions = [mutableCoderOptions copy]; &#125; id&lt;SDProgressiveImageCoder&gt; progressiveCoder = objc_getAssociatedObject(operation, SDImageLoaderProgressiveCoderKey); if (!progressiveCoder) &#123; /// ‰ªé SDImageCodersManager ‰∏≠ÊâæËÉΩËß£Á†ÅËØ•ÂõæÁâáÁöÑÂπ∂ÊääÂÆÉ‰øùÂ≠òÂú® operation ‰∏≠ for (id&lt;SDImageCoder&gt;coder in [SDImageCodersManager sharedManager].coders.reverseObjectEnumerator) &#123; if ([coder conformsToProtocol:@protocol(SDProgressiveImageCoder)] &amp;&amp; [((id&lt;SDProgressiveImageCoder&gt;)coder) canIncrementalDecodeFromData:imageData]) &#123; progressiveCoder = [[[coder class] alloc] initIncrementalWithOptions:coderOptions]; break; &#125; &#125; objc_setAssociatedObject(operation, SDImageLoaderProgressiveCoderKey, progressiveCoder, OBJC_ASSOCIATION_RETAIN_NONATOMIC); &#125; /// Ê≤°ÊúâËÉΩËß£Á†ÅËØ•ÂõæÁâáÁöÑÔºåÁõ¥Êé•ËøîÂõûnil if (!progressiveCoder) &#123; return nil; &#125; /// Ê∏êËøõÂºèÂä†ËΩΩ data [progressiveCoder updateIncrementalData:imageData finished:finished]; /// ‰∏çÊòØÂè™decodeÁ¨¨‰∏ÄÂ∏ß if (!decodeFirstFrame) &#123; // check whether we should use `SDAnimatedImage` Class animatedImageClass = context[SDWebImageContextAnimatedImageClass]; if ([animatedImageClass isSubclassOfClass:[UIImage class]] &amp;&amp; [animatedImageClass conformsToProtocol:@protocol(SDAnimatedImage)] &amp;&amp; [progressiveCoder conformsToProtocol:@protocol(SDAnimatedImageCoder)]) &#123; image = [[animatedImageClass alloc] initWithAnimatedCoder:(id&lt;SDAnimatedImageCoder&gt;)progressiveCoder scale:scale]; if (image) &#123; // Progressive decoding does not preload frames &#125; else &#123; // Check image class matching if (options &amp; SDWebImageMatchAnimatedImageClass) &#123; return nil; &#125; &#125; &#125; &#125; /// ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÁîüÊàê image if (!image) &#123; image = [progressiveCoder incrementalDecodedImageWithOptions:coderOptions]; &#125; if (image) &#123; BOOL shouldDecode = !SD_OPTIONS_CONTAINS(options, SDWebImageAvoidDecodeImage); if ([image.class conformsToProtocol:@protocol(SDAnimatedImage)]) &#123; // `SDAnimatedImage` do not decode shouldDecode = NO; &#125; else if (image.sd_isAnimated) &#123; // animated image do not decode shouldDecode = NO; &#125; if (shouldDecode) &#123; image = [SDImageCoderHelper decodedImageWithImage:image]; &#125; // mark the image as progressive (completionBlock one are not mark as progressive) image.sd_isIncremental = YES; &#125; return image;&#125; Âíå cache ‰∏≠ÂÅöÊ≥ïÁõ∏ÂêåÁöÑ SDImageLoaderDecodeImageData() ÊñπÊ≥ï‰ºöÂú®‰∏ãËΩΩÂõæÁâáÂÆåÊàêÂõûË∞ÉÊó∂ËøõË°åÔºõËÄåÊ∏êËøõÂºèËß£Á†Å SDImageLoaderDecodeProgressiveImageData() ÊñπÊ≥ïÂàô‰ºöÂú®‰∏ãËΩΩËøáÁ®ã‰∏≠Êé•Êî∂Âà∞‰∏ÄËæπÊé•Êî∂Êï∞ÊçÆ‰∏ÄËæπËøõË°å„ÄÇ ÁºñËß£Á†ÅSDImageCodersManagerÔºöËß£Á†ÅÂô®ÁöÑÁÆ°ÁêÜËÄÖSDImageCodersManager ÊòØ‰∏Ä‰∏™Âçï‰æãÁ±ªÔºåÂÜÖÈÉ®Âú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÂ¢ûÂä†‰∫ÜÂ§ö‰∏™ÂÆûÈôÖÁöÑÁºñËß£Á†ÅÁ±ªÔºåÁî®‰∫éÂ∞Ü NSData ËΩ¨Âåñ‰∏∫ UIImage„ÄÇÊØèÊ¨°Âú®‰ΩøÁî®Âà∞ÁöÑÊó∂ÂÄôÈÉΩ‰ºöÂæ™ÁéØÊØè‰∏Ä‰∏™ÂÆûÈôÖÁöÑÁºñËß£Á†ÅÁ±ªÔºåÊù•ÂØπÂõæÁâáËøõË°å data ‚Üí image ÁöÑËΩ¨Êç¢ ‰Ω†ÂèØËÉΩ‰ºöÊúâÁñëÈóÆÔºåNDData Âà∞ UIImage ‰∏çÊòØÁ≥ªÁªüÂÜÖÁΩÆÁöÑÊñπÊ≥ïÂ∞±ÂèØ‰ª•Ëß£ÂÜ≥ÂòõÔºü‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊòØÁöÑÔºåÂØπ‰∫é pngÔºå jpeg Á≠âÊ†ºÂºèÔºåÁ≥ªÁªüËá™Â∏¶‰∫ÜËΩ¨Êç¢ÊñπÊ≥ï„ÄÇ‰ΩÜÊòØÂØπ‰∫éËãπÊûú‰∏çÊòØÈªòËÆ§ÊîØÊåÅÁöÑÊ†ºÂºèÔºåÊØîÂ¶Ç webpÔºåÂ∞±ÈúÄË¶ÅËá™Â∑±ÈÄöËøáËß£Á†ÅÂô®Â∞Ü NSData ‚Üí UIImage„ÄÇ Áî±Ê≠§ÂèØËßÅÔºåNSData ‚Üí UIImage ÁöÑËøáÁ®ã‰πüÊòØ‰∏Ä‰∏™Ëß£Á†ÅÁöÑËøáÁ®ã ÂàùÂßãÂåñÊñπÊ≥ïÂàùÂßãÂåñÊñπÊ≥ïÂ¶Ç‰∏ãÊâÄÁ§∫„ÄÇÂú®Âçï‰æãÁöÑÂàùÂßãÂåñËøáÁ®ã‰∏≠ÔºåÈªòËÆ§Â¢ûÂä†‰∫Ü SDImageIOCodeÔºåSDImageGIFCoderÂíå SDImageAPNGCoder ‰∏â‰∏™ÂÆûÈôÖÁöÑÁºñËß£Á†ÅÁ±ª„ÄÇ 1234567891011121314151617+ (nonnull instancetype)sharedManager &#123; static dispatch_once_t once; static id instance; dispatch_once(&amp;once, ^&#123; instance = [self new]; &#125;); return instance;&#125;- (instancetype)init &#123; if (self = [super init]) &#123; // initialize with default coders _imageCoders = [NSMutableArray arrayWithArray:@[[SDImageIOCoder sharedCoder], [SDImageGIFCoder sharedCoder], [SDImageAPNGCoder sharedCoder]]]; _codersLock = dispatch_semaphore_create(1); &#125; return self;&#125; Èô§‰∫ÜËøô‰∏â‰∏™ÂÜÖÁΩÆÁöÑÁºñËß£Á†ÅÁ±ªÔºåÊàë‰ª¨ËøòÂèØ‰ª•ÈÄöËøáÂÆÉÊèê‰æõÁöÑÊñπÊ≥ïÂä®ÊÄÅÁöÑÊ∑ªÂä†ÂíåÁßªÈô§ÁºñËß£Á†ÅÂô®Áõ∏ÂÖ≥ÁöÑÁ±ª„ÄÇ ËÉΩÂê¶ÊîØÊåÅÁºñËß£Á†ÅËß£Á†ÅË¶ÅÈÄöËøá NSData ËøõË°åËß£Á†Å„ÄÇÁºñÁ†ÅÂàôÊòØÊää UIImage Ê†πÊçÆ SDImageFormat Ë°®Á§∫ÁöÑÂõæÁâáÁ±ªÂûãËΩ¨Âèò‰∏∫ NSData„ÄÇÂíå‰∏äÈù¢ÊâÄËØ¥ÁöÑ‰∏ÄÊ†∑ÔºåSDImageCodersManager ‰ºöË∞ÉÁî®ÂÜÖÈÉ®ÁöÑÊâÄÊúâÁºñËß£Á†ÅÁ±ªÂàÜÂà´Âà§Êñ≠Ôºö 123456789101112131415161718192021/// ÈÅçÂéÜÊâÄÊúâ coder ÁúãÊòØÂê¶ËÉΩËß£Á†Å- (BOOL)canDecodeFromData:(NSData *)data &#123; NSArray&lt;id&lt;SDImageCoder&gt;&gt; *coders = self.coders; for (id&lt;SDImageCoder&gt; coder in coders.reverseObjectEnumerator) &#123; if ([coder canDecodeFromData:data]) &#123; return YES; &#125; &#125; return NO;&#125;/// ÈÅçÂéÜÊâÄÊúâ coder ÁúãÊòØÂê¶ËÉΩÁºñÁ†Å- (BOOL)canEncodeToFormat:(SDImageFormat)format &#123; NSArray&lt;id&lt;SDImageCoder&gt;&gt; *coders = self.coders; for (id&lt;SDImageCoder&gt; coder in coders.reverseObjectEnumerator) &#123; if ([coder canEncodeToFormat:format]) &#123; return YES; &#125; &#125; return NO;&#125; Ëß£Á†ÅÔºö‰ªé NSData ‚Üí UIImageÂú®Âà§Êñ≠ËÉΩÂê¶ËøõË°åÁºñËß£Á†Å‰πãÂêéÔºåÂ∞±‰ºöË∞ÉÁî®ÂÆûÈôÖÁöÑÁºñËß£Á†ÅÁöÑÁ±ªÁöÑÁõ∏ÂÖ≥ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829#pragma mark - ÈÄöËøáÂÜÖÈÉ® coder ÁºñËß£Á†Å- (UIImage *)decodedImageWithData:(NSData *)data options:(nullable SDImageCoderOptions *)options &#123; if (!data) &#123; return nil; &#125; UIImage *image; NSArray&lt;id&lt;SDImageCoder&gt;&gt; *coders = self.coders; for (id&lt;SDImageCoder&gt; coder in coders.reverseObjectEnumerator) &#123; if ([coder canDecodeFromData:data]) &#123; image = [coder decodedImageWithData:data options:options]; break; &#125; &#125; return image;&#125;- (NSData *)encodedDataWithImage:(UIImage *)image format:(SDImageFormat)format options:(nullable SDImageCoderOptions *)options &#123; if (!image) &#123; return nil; &#125; NSArray&lt;id&lt;SDImageCoder&gt;&gt; *coders = self.coders; for (id&lt;SDImageCoder&gt; coder in coders.reverseObjectEnumerator) &#123; if ([coder canEncodeToFormat:format]) &#123; return [coder encodedDataWithImage:image format:format options:options]; &#125; &#125; return nil;&#125; ‰ª•‰∏äÂ∞±ÊòØ SDImageCodersManager ÁöÑÂÖ®ÈÉ®ÂÜÖÂÆπ‰∫Ü„ÄÇÊú¨Áîü‰Ωú‰∏∫‰∏Ä‰∏™ ManagerÔºåÂπ∂Ê≤°ÊúâÂ§™Â§öÁöÑ‰ªªÂä°ÔºåÊâÄÊúâÁöÑÊìç‰ΩúÈÉΩÊòØÈÅçÂéÜÂÜÖÈÉ®ÁöÑÁºñËß£Á†ÅÁ±ªÁöÑÂàóË°®ÔºåËÆ©ÂÆÉ‰ª¨Êù•ÂÆåÊàêÁöÑ„ÄÇ SDImageCoderHelperÔºöUIImage Âà∞ bitmap ÁöÑËΩ¨Êç¢ËÄÖ‰∏äÈù¢ manager ‰∏≠ÁÆ°ÁêÜÁöÑÊòØ‰ªé data Âà∞ image ÁöÑËß£Á†ÅÔºåËøô‰∏™ helper ÂàôÊòØË¶ÅÊää UIImage ÊèêÂâçËΩ¨Âåñ‰∏∫ bitmap ‰ª•Ë¥°ÊòæÁ§∫„ÄÇ SDImageFrame Âíå UIImage ÁöÑ‰∫íÁõ∏ËΩ¨ÂåñSDImageFrame ÊòØ GIF ÊàñËÄÖ APNG ÁöÑÊØè‰∏ÄÂ∏ßÁöÑÊ®°ÂûãÂåñ„ÄÇÊØè‰∏Ä‰∏™ SDImageFrame ÂÆû‰æãÂåÖÊã¨‰∏Ä‰∏™ UIImage ÂÆû‰æãÂíå‰∏Ä‰∏™Êó∂Èó¥Èó¥Èöî duration: 12345678@interface SDImageFrame : NSObject@property (nonatomic, strong, readonly, nonnull) UIImage *image;@property (nonatomic, readonly, assign) NSTimeInterval duration;+ (instancetype _Nonnull)frameWithImage:(UIImage * _Nonnull)image duration:(NSTimeInterval)duration;@end GIF Âíå APNG ‰∏çËÉΩÁõ¥Êé•ËΩ¨‰∏∫ UIImage ÁöÑ animatedImages ÁöÑÂéüÂõ†ÊòØÂêéËÄÖÁöÑ‰∏§Â∏ß‰πãÈó¥ÁöÑÊó∂Èó¥Èó¥ÈöîÊòØÂõ∫ÂÆöÁöÑÔºåËÄåÂâçËÄÖÂàôÊòØ‰∏çÂêåÁöÑ„ÄÇÂõ†Ê≠§‰∏§ËÄÖÁõ∏‰∫íËΩ¨ÂåñÁöÑÊó∂ÂÄôÂ∞±Ë¶ÅÊâæÂà∞ GIF Âíå APNG ‰∏§Â∏ß‰πãÈó¥Êó∂Èó¥ÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞Ôºå‰ª•Ê≠§‰Ωú‰∏∫ UIImage ÁöÑÊó∂Èó¥Èó¥Èöî„ÄÇÂ¶ÇÊûú GIF Âíå APNG ÁöÑÈó¥ÈöîËæÉÈïøÂàôÈúÄË¶ÅÂæÄÂÖ∂‰∏≠ÊèíÂ∏ß„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586#pragma mark - ‰ªé SDImageFrame ËΩ¨‰∏∫ UIImage+ (UIImage *)animatedImageWithFrames:(NSArray&lt;SDImageFrame *&gt; *)frames &#123; NSUInteger frameCount = frames.count; if (frameCount == 0) &#123; return nil; &#125; UIImage *animatedImage; /// ÊØè‰∏ÄÂ∏ßÁöÑÊåÅÁª≠Êó∂Èó¥ÈÉΩ‰øùÂ≠òÂú® durations ‰∏≠ NSUInteger durations[frameCount]; for (size_t i = 0; i &lt; frameCount; i++) &#123; durations[i] = frames[i].duration * 1000; &#125; /// Ëé∑ÂèñÂêÑÂ∏ßÈó¥ÈöîÊó∂Èó¥ÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞‰Ωú‰∏∫ duration„ÄÇÈó¥ÈöîÈïøÁöÑÂä†Â∏ß NSUInteger const gcd = gcdArray(frameCount, durations); __block NSUInteger totalDuration = 0; NSMutableArray&lt;UIImage *&gt; *animatedImages = [NSMutableArray arrayWithCapacity:frameCount]; [frames enumerateObjectsUsingBlock:^(SDImageFrame * _Nonnull frame, NSUInteger idx, BOOL * _Nonnull stop) &#123; UIImage *image = frame.image; NSUInteger duration = frame.duration * 1000; totalDuration += duration; NSUInteger repeatCount; if (gcd) &#123; /// Ë¶ÅÈáçÂ§ç repeatCount Ê¨° repeatCount = duration / gcd; &#125; else &#123; repeatCount = 1; &#125; for (size_t i = 0; i &lt; repeatCount; ++i) &#123; [animatedImages addObject:image]; &#125; &#125;]; animatedImage = [UIImage animatedImageWithImages:animatedImages duration:totalDuration / 1000.f]; return animatedImage;&#125;#pragma mark - UIImage ËΩ¨ SDImageFrame+ (NSArray&lt;SDImageFrame *&gt; *)framesFromAnimatedImage:(UIImage *)animatedImage &#123; if (!animatedImage) &#123; return nil; &#125; NSMutableArray&lt;SDImageFrame *&gt; *frames = [NSMutableArray array]; NSUInteger frameCount = 0; NSArray&lt;UIImage *&gt; *animatedImages = animatedImage.images; frameCount = animatedImages.count; if (frameCount == 0) &#123; return nil; &#125; NSTimeInterval avgDuration = animatedImage.duration / frameCount; if (avgDuration == 0) &#123; avgDuration = 0.1; // if it's a animated image but no duration, set it to default 100ms (this do not have that 10ms limit like GIF or WebP to allow custom coder provide the limit) &#125; __block NSUInteger index = 0; __block NSUInteger repeatCount = 1; __block UIImage *previousImage = animatedImages.firstObject; [animatedImages enumerateObjectsUsingBlock:^(UIImage * _Nonnull image, NSUInteger idx, BOOL * _Nonnull stop) &#123; // ignore first if (idx == 0) &#123; return; &#125; if ([image isEqual:previousImage]) &#123; /// Â¶ÇÊûúÊòØÈáçÂ§çÁöÑÂ∏ßÔºåÂè™‰øùÂ≠ò‰∏ÄÊ¨° SDImageFrameÔºåÂä†Èó¥Èöî repeatCount++; &#125; else &#123; SDImageFrame *frame = [SDImageFrame frameWithImage:previousImage duration:avgDuration * repeatCount]; [frames addObject:frame]; repeatCount = 1; index++; &#125; previousImage = image; // last one if (idx == frameCount - 1) &#123; SDImageFrame *frame = [SDImageFrame frameWithImage:previousImage duration:avgDuration * repeatCount]; [frames addObject:frame]; &#125; &#125;]; return frames;&#125; Ëé∑ÂèñÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ÁöÑËøáÁ®ãÈÄöËøáËæóËΩ¨Áõ∏Èô§ÁöÑÊñπÂºèÂÆåÊàêÔºö 123456789101112131415161718192021static NSUInteger gcd(NSUInteger a, NSUInteger b) &#123; NSUInteger c; while (a != 0) &#123; c = a; a = b % a; b = c; &#125; return b;&#125;/// Ëé∑ÂèñÂêÑÂ∏ßÊó∂Èó¥Èó¥ÈöîÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞static NSUInteger gcdArray(size_t const count, NSUInteger const * const values) &#123; if (count == 0) &#123; return 0; &#125; NSUInteger result = values[0]; for (size_t i = 1; i &lt; count; ++i) &#123; result = gcd(values[i], result); &#125; return result;&#125; Ëé∑ÂèñËÆæÂ§áÁöÑ rgbÁ©∫Èó¥Ëøô‰∏™ÊñπÊ≥ïÊ≤°‰ªÄ‰πàÁâπÂà´ÁöÑÂú∞ÊñπÔºåÂ∞±ÊòØ Core Graphic apiÁöÑË∞ÉÁî®„ÄÇÂÆÉ‰ºöÂú®ÂàõÂª∫ Bitmap ÁöÑÊó∂ÂÄô‰ΩøÁî® 12345678910111213#pragma mark - Ëé∑ÂèñËÆæÂ§áÁöÑrgbÈ¢úËâ≤Á©∫Èó¥ÔºåÂàõÂª∫bitmapÊó∂ÂÄôÈúÄË¶Å+ (CGColorSpaceRef)colorSpaceGetDeviceRGB &#123; static CGColorSpaceRef colorSpace; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; if (@available(iOS 9.0, tvOS 9.0, *)) &#123; colorSpace = CGColorSpaceCreateWithName(kCGColorSpaceSRGB); &#125; else &#123; colorSpace = CGColorSpaceCreateDeviceRGB(); &#125; &#125;); return colorSpace;&#125; ÊòØÂê¶ÂÖ∑ÊúâalphaÈÄöÈÅìÂà§Êñ≠ÊòØÂê¶Âê´Êúâ alpha ÈÄöÈÅìÔºåÂú®ÂàõÂª∫Áà±‰Ω† bitmap ÁöÑÊó∂ÂÄôÈúÄË¶Å‰º†ÂÖ•ÁöÑÂ±ûÊÄßÔºö 1234567891011#pragma mark - ÊòØÂê¶Âê´Êúâ alpha ÈÄöÈÅì+ (BOOL)CGImageContainsAlpha:(CGImageRef)cgImage &#123; if (!cgImage) &#123; return NO; &#125; CGImageAlphaInfo alphaInfo = CGImageGetAlphaInfo(cgImage); BOOL hasAlpha = !(alphaInfo == kCGImageAlphaNone || alphaInfo == kCGImageAlphaNoneSkipFirst || alphaInfo == kCGImageAlphaNoneSkipLast); return hasAlpha;&#125; Âú®UIÊ∏≤ÊüìÁöÑÊó∂ÂÄôÔºåÂÆûÈôÖ‰∏äÊòØÊääÂ§ö‰∏™ÂõæÂ±ÇÊåâÂÉèÁ¥†Âè†Âä†ËÆ°ÁÆóÁöÑËøáÁ®ãÔºåÈúÄË¶ÅÂØπÊØè‰∏Ä‰∏™ÂÉèÁ¥†ËøõË°å RGBA ÁöÑÂè†Âä†ËÆ°ÁÆó„ÄÇÂΩìÊüê‰∏™ layer ÁöÑÊòØ‰∏çÈÄèÊòéÁöÑÔºå‰πüÂ∞±ÊòØ opaque ‰∏∫ YES Êó∂ÔºåGPU ÂèØ‰ª•Áõ¥Êé•ÂøΩÁï•ÊéâÂÖ∂‰∏ãÊñπÁöÑÂõæÂ±ÇÔºåËøôÂ∞±ÂáèÂ∞ë‰∫ÜÂæàÂ§öÂ∑•‰ΩúÈáè„ÄÇËøô‰πüÊòØË∞ÉÁî® CGBitmapContextCreate Êó∂ bitmapInfo ÂèÇÊï∞ËÆæÁΩÆ‰∏∫ÂøΩÁï•Êéâ alpha ÈÄöÈÅìÁöÑÂéüÂõ†„ÄÇ Ëß£Á†ÅÔºö‰ªé image Âà∞ bitmapimage Ë¶ÅÊòæÁ§∫Âú®Â±èÂπï‰∏äÈúÄË¶ÅËΩ¨Âåñ‰∏∫ bitmapÔºåËøô‰∏™Êìç‰ΩúÂæÄÂæÄÊòØÊòæÁ§∫ÁöÑÊó∂ÂÄôÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÂÅöÁöÑ„ÄÇ‰∏∫‰∫ÜÊèêÈ´òÊïàÁéáÔºåÂèØ‰ª•ÈÄöËøá decodedImageWithImage ÊñπÊ≥ïÊää image ÊèêÂâçËΩ¨Âåñ‰∏∫ bitmapÔºåËøôÊ†∑ËøôÂº†Êñ∞ÂõæÁâáÂ∞±‰∏çÂÜçÈúÄË¶ÅÈáçÂ§çÊ∏≤Êüì‰∫ÜÔºåÊèêÈ´ò‰∫ÜÊ∏≤ÊüìÊïàÁéáÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071+ (UIImage *)decodedImageWithImage:(UIImage *)image &#123; if (![self shouldDecodeImage:image]) &#123; return image; &#125; /// Êñ∞Âª∫‰∏Ä‰∏™ imageRef CGImageRef imageRef = [self CGImageCreateDecoded:image.CGImage]; if (!imageRef) &#123; return image; &#125; /// ÈáçÊñ∞ÁîüÊàê‰∏Ä‰∏™ image UIImage *decodedImage = [[UIImage alloc] initWithCGImage:imageRef scale:image.scale orientation:image.imageOrientation]; CGImageRelease(imageRef); decodedImage.sd_isDecoded = YES; decodedImage.sd_imageFormat = image.sd_imageFormat; return decodedImage;&#125;#pragma mark - Áõ∏ÂΩì‰∫éÂ§çÂà∂‰∏Ä‰∏™ CGImageRef+ (CGImageRef)CGImageCreateDecoded:(CGImageRef)cgImage &#123; return [self CGImageCreateDecoded:cgImage orientation:kCGImagePropertyOrientationUp];&#125;#pragma mark - Êää CGImageRef ËΩ¨‰∏™Âêë+ (CGImageRef)CGImageCreateDecoded:(CGImageRef)cgImage orientation:(CGImagePropertyOrientation)orientation &#123; if (!cgImage) &#123; return NULL; &#125; size_t width = CGImageGetWidth(cgImage); size_t height = CGImageGetHeight(cgImage); if (width == 0 || height == 0) return NULL; size_t newWidth; size_t newHeight; switch (orientation) &#123; case kCGImagePropertyOrientationLeft: case kCGImagePropertyOrientationLeftMirrored: case kCGImagePropertyOrientationRight: case kCGImagePropertyOrientationRightMirrored: &#123; // These orientation should swap width &amp; height newWidth = height; newHeight = width; &#125; break; default: &#123; newWidth = width; newHeight = height; &#125; break; &#125; BOOL hasAlpha = [self CGImageContainsAlpha:cgImage]; // iOS prefer BGRA8888 (premultiplied) or BGRX8888 bitmapInfo for screen rendering, which is same as `UIGraphicsBeginImageContext()` or `- [CALayer drawInContext:]` // Though you can use any supported bitmapInfo (see: https://developer.apple.com/library/content/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-BCIBHHBB ) and let Core Graphics reorder it when you call `CGContextDrawImage` // But since our build-in coders use this bitmapInfo, this can have a little performance benefit CGBitmapInfo bitmapInfo = kCGBitmapByteOrder32Host; /// Âú®UIÊ∏≤ÊüìÁöÑÊó∂ÂÄôÔºåÂÆûÈôÖ‰∏äÊòØÊääÂ§ö‰∏™ÂõæÂ±ÇÊåâÂÉèÁ¥†Âè†Âä†ËÆ°ÁÆóÁöÑËøáÁ®ãÔºåÈúÄË¶ÅÂØπÊØè‰∏Ä‰∏™ÂÉèÁ¥†ËøõË°å RGBA ÁöÑÂè†Âä†ËÆ°ÁÆó„ÄÇÂΩìÊüê‰∏™ layer ÁöÑÊòØ‰∏çÈÄèÊòéÁöÑÔºå‰πüÂ∞±ÊòØ opaque ‰∏∫ YES Êó∂ÔºåGPU ÂèØ‰ª•Áõ¥Êé•ÂøΩÁï•ÊéâÂÖ∂‰∏ãÊñπÁöÑÂõæÂ±ÇÔºåËøôÂ∞±ÂáèÂ∞ë‰∫ÜÂæàÂ§öÂ∑•‰ΩúÈáè„ÄÇËøô‰πüÊòØË∞ÉÁî® CGBitmapContextCreate Êó∂ bitmapInfo ÂèÇÊï∞ËÆæÁΩÆ‰∏∫ÂøΩÁï•Êéâ alpha ÈÄöÈÅìÁöÑÂéüÂõ†„ÄÇ bitmapInfo |= hasAlpha ? kCGImageAlphaPremultipliedFirst : kCGImageAlphaNoneSkipFirst; /// ÂàõÂª∫ CGContextRef CGContextRef context = CGBitmapContextCreate(NULL, newWidth, newHeight, 8, 0, [self colorSpaceGetDeviceRGB], bitmapInfo); if (!context) &#123; return NULL; &#125; // Apply transform CGAffineTransform transform = SDCGContextTransformFromOrientation(orientation, CGSizeMake(newWidth, newHeight)); CGContextConcatCTM(context, transform); CGContextDrawImage(context, CGRectMake(0, 0, width, height), cgImage); // The rect is bounding box of CGImage, don't swap width &amp; height CGImageRef newImageRef = CGBitmapContextCreateImage(context); CGContextRelease(context); return newImageRef;&#125; Â∞Ü UIImage ÊåâÊØî‰æãÂáèÂ∞èÂà∞ bytes ÂÜÖÊØè‰∏Ä‰∏™ÂÉèÁ¥†ÁÇπÁî±‰∫éÊúâ RGBA Âõõ‰∏™ÈÄöÈÅìÔºåÊØè‰∏™ÈÄöÈÅìÂç†Áî® 1 ‰∏™Â≠óËäÇÔºåÊï¥‰∏™ÂÉèÁ¥†ÁÇπÈúÄË¶ÅÂç†Áî® 4 ‰∏™Â≠óËäÇ„ÄÇÂØπ‰∫é‰∏Ä‰∏™È´òÂàÜËæ®ÁéáÁöÑÂõæÁâáÊù•ËØ¥Ôºå‰ºöÂç†Áî®Â§ßÈáèÂÜÖÂ≠òËµÑÊ∫êÔºåÁîöËá≥‰∫ßÁîü OOM„ÄÇ SDWebImage ÁöÑÂÅöÊ≥ïÊòØÔºå‰ΩøÁî®ÂàÜÂùóÁªòÂà∂ÁöÑÊñπÂºèÔºåËØªÂèñ‰∏ÄÈÉ®ÂàÜÂõæÁâáÁöÑdataÁªòÂà∂ÊàêÂõæÔºåÂÜçÊääÂõæÁªòÂà∂Âà∞Áº©ÊîæËøáÁöÑ context ‰∏≠ÔºåÁÑ∂ÂêéÈáäÊîæÊéâ‰πãÂâçËØªÂèñÁöÑ data„ÄÇÂæ™ÁéØÂæÄÂ§çÔºåÂ∞ÜÊï¥Âº†ÂõæÈÉΩÁªòÂà∂Âá∫Êù•„ÄÇËøôÊ†∑ËÉΩÂ§üËß£ÂÜ≥ÂÜÖÂ≠òÁàÜÁÇ∏ÈóÆÈ¢ò„ÄÇ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177#pragma mark - Â∞Ü UIImage ÊåâÊØî‰æãÁº©Â∞èÂà∞ bytes ÂÜÖ/// Âä†ËΩΩÂ§ßÂõæÂèØËÉΩ‰ºöÂá∫Áé∞ OOMÔºå‰ΩøÁî®ÂàÜÂùóÁªòÂà∂ÁöÑÊñπÂºèÔºåËØªÂèñ‰∏ÄÈÉ®ÂàÜÂõæÁâáÁöÑdataÔºåÁÑ∂ÂêéÁªòÂà∂Âà∞Áº©ÊîæËøáÁöÑ context ‰∏≠ÔºåÁÑ∂ÂêéÈáäÊîæÊéâ‰πãÂâçËØªÂèñÁöÑ data„ÄÇËøôÊ†∑ËÉΩÂ§üËß£ÂÜ≥ÂÜÖÂ≠òÁàÜÁÇ∏ÈóÆÈ¢ò„ÄÇ+ (UIImage *)decodedAndScaledDownImageWithImage:(UIImage *)image limitBytes:(NSUInteger)bytes &#123; if (![self shouldDecodeImage:image]) &#123; return image; &#125; /// Â¶ÇÊûú‰∏çÈúÄË¶ÅÊåâÊØî‰æãÁº©Â∞èÔºåÈÇ£‰πàÁõ¥Êé•Ëß£Á†Å if (![self shouldScaleDownImage:image limitBytes:bytes]) &#123; return [self decodedImageWithImage:image]; &#125; CGFloat destTotalPixels; CGFloat tileTotalPixels; if (bytes &gt; 0) &#123; destTotalPixels = bytes / kBytesPerPixel; /// ËøôÈáå 3 ÂèØ‰ª•ÊòØ‰ªªÊÑèÁöÑÂÄºÔºåÂè™ÊòØÊÉ≥Ëé∑Âèñ‰∏Ä‰∏™ËæÉÂ∞èÁöÑÂàÜÂùóÂÉèÁ¥†ÊÄªÈáè tileTotalPixels = destTotalPixels / 3; &#125; else &#123; destTotalPixels = kDestTotalPixels; tileTotalPixels = kTileTotalPixels; &#125; CGContextRef destContext; @autoreleasepool &#123; CGImageRef sourceImageRef = image.CGImage; CGSize sourceResolution = CGSizeZero; sourceResolution.width = CGImageGetWidth(sourceImageRef); sourceResolution.height = CGImageGetHeight(sourceImageRef); CGFloat sourceTotalPixels = sourceResolution.width * sourceResolution.height; // Determine the scale ratio to apply to the input image // that results in an output image of the defined size. // see kDestImageSizeMB, and how it relates to destTotalPixels. /// Èù¢ÁßØ‰πãÊØîÂºÄÂπ≥ÊñπÔºåÂ∞±ÊòØËæπÈïø‰πãÊØî CGFloat imageScale = sqrt(destTotalPixels / sourceTotalPixels); CGSize destResolution = CGSizeZero; /// ÁõÆÊ†áÂõæÂÉèÁöÑÂÆΩÈ´ò destResolution.width = (int)(sourceResolution.width * imageScale); destResolution.height = (int)(sourceResolution.height * imageScale); // device color space CGColorSpaceRef colorspaceRef = [self colorSpaceGetDeviceRGB]; BOOL hasAlpha = [self CGImageContainsAlpha:sourceImageRef]; // iOS display alpha info (BGRA8888/BGRX8888) CGBitmapInfo bitmapInfo = kCGBitmapByteOrder32Host; bitmapInfo |= hasAlpha ? kCGImageAlphaPremultipliedFirst : kCGImageAlphaNoneSkipFirst; /// ÂàõÂª∫‰∏Ä‰∏™ÁõÆÊ†áÂ§ßÂ∞èÁöÑ context destContext = CGBitmapContextCreate(NULL, destResolution.width, destResolution.height, kBitsPerComponent, 0, colorspaceRef, bitmapInfo); if (destContext == NULL) &#123; return image; &#125; /// ËÆæÁΩÆÊèíÂÄºË¥®Èáè‰∏∫È´òË¥®Èáè CGContextSetInterpolationQuality(destContext, kCGInterpolationHigh); // Now define the size of the rectangle to be used for the // incremental blits from the input image to the output image. // we use a source tile width equal to the width of the source // image due to the way that iOS retrieves image data from disk. // iOS must decode an image from disk in full width 'bands', even // if current graphics context is clipped to a subrect within that // band. Therefore we fully utilize all of the pixel data that results // from a decoding opertion by achnoring our tile size to the full // width of the input image. CGRect sourceTile = CGRectZero; /// sourcetile ÁöÑÂÆΩÂ∫¶ÊòØÂéüÂõæÁâáÁöÑÂÆΩÂ∫¶ sourceTile.size.width = sourceResolution.width; // The source tile height is dynamic. Since we specified the size // of the source tile in MB, see how many rows of pixels high it // can be given the input image width. /// sourceTile ÁöÑÂÆΩÈ´ò‰πòÁßØÊòØ tileTotalPixels sourceTile.size.height = (int)(tileTotalPixels / sourceTile.size.width ); sourceTile.origin.x = 0.0f; // The output tile is the same proportions as the input tile, but // scaled to image scale. CGRect destTile; destTile.size.width = destResolution.width; /// sourceTile ÁöÑÈ´òÂ∫¶ * Áº©ÊîæÊØî‰æãÂ∞±ÊòØ destTile ÁöÑÈ´òÂ∫¶ destTile.size.height = sourceTile.size.height * imageScale; destTile.origin.x = 0.0f; // The source seem overlap is proportionate to the destination seem overlap. // this is the amount of pixels to overlap each tile as we assemble the ouput image. /// ÁõÆÊ†átile Êúâ 2ÂÉèÁ¥†ÁöÑ overlap„ÄÇÊç¢ÁÆó‰∏∫ sourceTile ÁöÑoverlap float sourceSeemOverlap = (int)((kDestSeemOverlap/destResolution.height)*sourceResolution.height); CGImageRef sourceTileImageRef; // calculate the number of read/write operations required to assemble the // output image. /// Ë¶ÅËø≠‰ª£ÁöÑzÊ¨°Êï∞Á≠â‰∫éÊ∫êÂõæÁâáÈ´òÂ∫¶/ÂéütileÁöÑÈ´òÂ∫¶ int iterations = (int)( sourceResolution.height / sourceTile.size.height ); // If tile height doesn't divide the image height evenly, add another iteration // to account for the remaining pixels. /// Â¶ÇÊûú‰∏çËÉΩÊï¥Èô§ÔºåÈÇ£‰πàËø≠‰ª£Ê¨°Êï∞Ë¶Å+1 int remainder = (int)sourceResolution.height % (int)sourceTile.size.height; if(remainder) &#123; iterations++; &#125; // Add seem overlaps to the tiles, but save the original tile height for y coordinate calculations. float sourceTileHeightMinusOverlap = sourceTile.size.height; sourceTile.size.height += sourceSeemOverlap; destTile.size.height += kDestSeemOverlap; /// ÂàÜÂùóÁªòÂà∂ for( int y = 0; y &lt; iterations; ++y ) &#123; @autoreleasepool &#123; sourceTile.origin.y = y * sourceTileHeightMinusOverlap + sourceSeemOverlap; destTile.origin.y = destResolution.height - (( y + 1 ) * sourceTileHeightMinusOverlap * imageScale + kDestSeemOverlap); sourceTileImageRef = CGImageCreateWithImageInRect( sourceImageRef, sourceTile ); if( y == iterations - 1 &amp;&amp; remainder ) &#123; float dify = destTile.size.height; destTile.size.height = CGImageGetHeight( sourceTileImageRef ) * imageScale; dify -= destTile.size.height; destTile.origin.y += dify; &#125; CGContextDrawImage( destContext, destTile, sourceTileImageRef ); CGImageRelease( sourceTileImageRef ); &#125; &#125; /// ÈÄöËøá destContext ÂàõÂª∫ CGImageRef CGImageRef destImageRef = CGBitmapContextCreateImage(destContext); CGContextRelease(destContext); if (destImageRef == NULL) &#123; return image; &#125; /// ÈÄöËøádestImageRefÂàõÂª∫image UIImage *destImage = [[UIImage alloc] initWithCGImage:destImageRef scale:image.scale orientation:image.imageOrientation]; CGImageRelease(destImageRef); if (destImage == nil) &#123; return image; &#125; destImage.sd_isDecoded = YES; destImage.sd_imageFormat = image.sd_imageFormat; return destImage; &#125;&#125;#pragma mark - ÊòØÂê¶ÈúÄË¶ÅÊåâÊØî‰æãÁº©Â∞è+ (BOOL)shouldScaleDownImage:(nonnull UIImage *)image limitBytes:(NSUInteger)bytes &#123; BOOL shouldScaleDown = YES; CGImageRef sourceImageRef = image.CGImage; CGSize sourceResolution = CGSizeZero; sourceResolution.width = CGImageGetWidth(sourceImageRef); sourceResolution.height = CGImageGetHeight(sourceImageRef); float sourceTotalPixels = sourceResolution.width * sourceResolution.height; if (sourceTotalPixels &lt;= 0) &#123; return NO; &#125; CGFloat destTotalPixels; if (bytes &gt; 0) &#123; /// bytes / ÊØè‰∏Ä‰∏™ÂÉèÁ¥†Âá†‰∏™ bytes = ÂÉèÁ¥†Êï∞ destTotalPixels = bytes / kBytesPerPixel; &#125; else &#123; destTotalPixels = kDestTotalPixels; &#125; /// Â∞è‰∫é1M‰∏çÈúÄË¶ÅÊåâÊØî‰æãÁº©Â∞è if (destTotalPixels &lt;= kPixelsPerMB) &#123; // Too small to scale down return NO; &#125; /// ÊØî‰æã = ÁõÆÊ†áÂÉèÁ¥†/Áé∞Âú®ÁöÑimageÁöÑÂÉèÁ¥† float imageScale = destTotalPixels / sourceTotalPixels; if (imageScale &lt; 1) &#123; shouldScaleDown = YES; &#125; else &#123; shouldScaleDown = NO; &#125; return shouldScaleDown;&#125; SDImageIOCoderÔºöÂÜÖÁΩÆÂõæÁâáÁ±ªÂûãÁöÑËß£Á†ÅÂô®SDImageIOCoder ÊîØÊåÅ pngÔºåjpeg Ôºå‰ª•ÂèäÈÉ®ÂàÜÊú∫ÂûãÊîØÊåÅ HEIC HEIF ÁöÑËß£Á†Å‰ª•ÂèäÊ∏êËøõÂºèÂä†ËΩΩ„ÄÇ ËÉΩÂê¶Ëß£Á†Å123456789101112131415- (BOOL)canDecodeFromData:(nullable NSData *)data &#123; switch ([NSData sd_imageFormatForImageData:data]) &#123; case SDImageFormatWebP: // Do not support WebP decoding return NO; case SDImageFormatHEIC: // Check HEIC decoding compatibility return [[self class] canDecodeFromHEICFormat]; case SDImageFormatHEIF: // Check HEIF decoding compatibility return [[self class] canDecodeFromHEIFFormat]; default: return YES; &#125;&#125; ËÉΩÂê¶Ëß£Á†Å‰∏ªË¶Å‰æùÊçÆ‰∏éÂõæÁâáÁöÑÁ±ªÂûãÊòØÂê¶ÊòØÊîØÊåÅÁöÑÁ±ªÂûã„ÄÇËé∑ÂèñÂõæÁâáÊï∞ÊçÆÊ†ºÂºèÁöÑÊñπÂºèÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748+ (SDImageFormat)sd_imageFormatForImageData:(nullable NSData *)data &#123; if (!data) &#123; return SDImageFormatUndefined; &#125; // File signatures table: http://www.garykessler.net/library/file_sigs.html uint8_t c; [data getBytes:&amp;c length:1]; switch (c) &#123; case 0xFF: return SDImageFormatJPEG; case 0x89: return SDImageFormatPNG; case 0x47: return SDImageFormatGIF; case 0x49: case 0x4D: return SDImageFormatTIFF; case 0x52: &#123; if (data.length &gt;= 12) &#123; //RIFF....WEBP NSString *testString = [[NSString alloc] initWithData:[data subdataWithRange:NSMakeRange(0, 12)] encoding:NSASCIIStringEncoding]; if ([testString hasPrefix:@"RIFF"] &amp;&amp; [testString hasSuffix:@"WEBP"]) &#123; return SDImageFormatWebP; &#125; &#125; break; &#125; case 0x00: &#123; if (data.length &gt;= 12) &#123; //....ftypheic ....ftypheix ....ftyphevc ....ftyphevx NSString *testString = [[NSString alloc] initWithData:[data subdataWithRange:NSMakeRange(4, 8)] encoding:NSASCIIStringEncoding]; if ([testString isEqualToString:@"ftypheic"] || [testString isEqualToString:@"ftypheix"] || [testString isEqualToString:@"ftyphevc"] || [testString isEqualToString:@"ftyphevx"]) &#123; return SDImageFormatHEIC; &#125; //....ftypmif1 ....ftypmsf1 if ([testString isEqualToString:@"ftypmif1"] || [testString isEqualToString:@"ftypmsf1"]) &#123; return SDImageFormatHEIF; &#125; &#125; break; &#125; &#125; return SDImageFormatUndefined;&#125; ÈÄöËøáËØªÂèñ data ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óËäÇÂ∞±ËÉΩÁü•ÈÅìÂõæÁâáÁöÑÁ±ªÂûã„ÄÇ Âà§Êñ≠Âà§Êñ≠ÊòØÂê¶ÊîØÊåÅÊüê‰∏Ä‰∏™Ê†ºÂºèÁöÑÁºñÁ†ÅÔºåÈÄöËøáÁúãÊòØÂê¶ËÉΩÁîüÊàê CGImageDestination Êù•Âà§Êñ≠Ôºö 123456789101112131415+ (BOOL)canEncodeToFormat:(SDImageFormat)format &#123; // Âà§Êñ≠ÊòØÂê¶ÊîØÊåÅÊüê‰∏Ä‰∏™Ê†ºÂºèÁöÑÁºñÁ†ÅÔºåÈÄöËøáÁúãÊòØÂê¶ËÉΩÁîüÊàê CGImageDestination Êù•Âà§Êñ≠ NSMutableData *imageData = [NSMutableData data]; CFStringRef imageUTType = [NSData sd_UTTypeFromImageFormat:format]; // Create an image destination. CGImageDestinationRef imageDestination = CGImageDestinationCreateWithData((__bridge CFMutableDataRef)imageData, imageUTType, 1, NULL); if (!imageDestination) &#123; // Can't encode to HEIC return NO; &#125; else &#123; // Can encode to HEIC CFRelease(imageDestination); return YES; &#125;&#125; Áõ¥Êé•Ëß£Á†ÅÔºöÂÆåÊï¥ÁöÑ NSData ‚Üí UIImageÁõ¥Êé•Ëß£Á†ÅÁöÑÊñπÂºèÈùûÂ∏∏ÁÆÄÂçïÁ≤óÊö¥ÔºåÁõ¥Êé•ÈÄöËøá UIImage ÁöÑÊñπÊ≥ïÔºö 1234567891011121314- (UIImage *)decodedImageWithData:(NSData *)data options:(nullable SDImageCoderOptions *)options &#123; if (!data) &#123; return nil; &#125; CGFloat scale = 1; NSNumber *scaleFactor = options[SDImageCoderDecodeScaleFactor]; if (scaleFactor != nil) &#123; scale = MAX([scaleFactor doubleValue], 1) ; &#125; UIImage *image = [[UIImage alloc] initWithData:data scale:scale]; image.sd_imageFormat = [NSData sd_imageFormatForImageData:data]; return image;&#125; Ê∏êËøõÂºèËß£Á†ÅÔºöÈÉ®ÂàÜ NSData ‚Üí UIImageÊ∏êËøõÂºèËß£Á†ÅÊèê‰æõ‰∫ÜËæπ‰∏ãËΩΩËæπËß£Á†ÅÁöÑÂäüËÉΩ„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#pragma mark - Ê∏êËøõÂºèÊõ¥Êñ∞- (void)updateIncrementalData:(NSData *)data finished:(BOOL)finished &#123; if (_finished) &#123; return; &#125; _finished = finished; /// Ë¶ÅÊääÂàöËé∑ÂæóÁöÑ data Âä†ÂÖ•Âà∞ imageSource ‰∏≠ CGImageSourceUpdateData(_imageSource, (__bridge CFDataRef)data, finished); if (_width + _height == 0) &#123; CFDictionaryRef properties = CGImageSourceCopyPropertiesAtIndex(_imageSource, 0, NULL); if (properties) &#123; NSInteger orientationValue = 1; CFTypeRef val = CFDictionaryGetValue(properties, kCGImagePropertyPixelHeight); if (val) CFNumberGetValue(val, kCFNumberLongType, &amp;_height); val = CFDictionaryGetValue(properties, kCGImagePropertyPixelWidth); if (val) CFNumberGetValue(val, kCFNumberLongType, &amp;_width); val = CFDictionaryGetValue(properties, kCGImagePropertyOrientation); if (val) CFNumberGetValue(val, kCFNumberNSIntegerType, &amp;orientationValue); CFRelease(properties); // When we draw to Core Graphics, we lose orientation information, // which means the image below born of initWithCGIImage will be // oriented incorrectly sometimes. (Unlike the image born of initWithData // in didCompleteWithError.) So save it here and pass it on later. _orientation = (CGImagePropertyOrientation)orientationValue; &#125; &#125;&#125;#pragma mark - Ê∏êËøõÂºèÊõ¥Êñ∞ÂêéÁîüÊàêimage- (UIImage *)incrementalDecodedImageWithOptions:(SDImageCoderOptions *)options &#123; UIImage *image; if (_width + _height &gt; 0) &#123; // Create the image CGImageRef partialImageRef = CGImageSourceCreateImageAtIndex(_imageSource, 0, NULL); if (partialImageRef) &#123; CGFloat scale = _scale; NSNumber *scaleFactor = options[SDImageCoderDecodeScaleFactor]; if (scaleFactor != nil) &#123; scale = MAX([scaleFactor doubleValue], 1); &#125; UIImageOrientation imageOrientation = [SDImageCoderHelper imageOrientationFromEXIFOrientation:_orientation]; image = [[UIImage alloc] initWithCGImage:partialImageRef scale:scale orientation:imageOrientation]; CGImageRelease(partialImageRef); CFStringRef uttype = CGImageSourceGetType(_imageSource); image.sd_imageFormat = [NSData sd_imageFormatFromUTType:uttype]; &#125; &#125; return image;&#125; ‰∏ªË¶ÅËøòÊòØ‰ΩøÁî® Core Graphic ÁöÑ API„ÄÇÂâç‰∏Ä‰∏™ÊñπÊ≥ïÈÄöËøá CGImageSourceUpdateData() ÂæÄ CGImageSourceRef ‰∏≠Â¢ûÂä† dataÔºåÂêé‰∏Ä‰∏™ÊñπÊ≥ïÊää CGImageSourceRef ÁîüÊàê‰∏∫ UIImage ÁºñÁ†ÅÁºñÁ†ÅÊòØ‰ªé UIImage Âà∞ NSData ÁöÑËΩ¨Êç¢Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647- (NSData *)encodedDataWithImage:(UIImage *)image format:(SDImageFormat)format options:(nullable SDImageCoderOptions *)options &#123; if (!image) &#123; return nil; &#125; if (format == SDImageFormatUndefined) &#123; BOOL hasAlpha = [SDImageCoderHelper CGImageContainsAlpha:image.CGImage]; /// Âê´Êúâ alpha ÈÄöÈÅìÂ∞±ÊòØ PNG Ê≤°ÊúâÂ∞±ÊòØ JPEG if (hasAlpha) &#123; format = SDImageFormatPNG; &#125; else &#123; format = SDImageFormatJPEG; &#125; &#125; NSMutableData *imageData = [NSMutableData data]; CFStringRef imageUTType = [NSData sd_UTTypeFromImageFormat:format]; // Create an image destination. CGImageDestinationRef imageDestination = CGImageDestinationCreateWithData((__bridge CFMutableDataRef)imageData, imageUTType, 1, NULL); if (!imageDestination) &#123; // Handle failure. return nil; &#125; NSMutableDictionary *properties = [NSMutableDictionary dictionary]; CGImagePropertyOrientation exifOrientation = [SDImageCoderHelper exifOrientationFromImageOrientation:image.imageOrientation]; properties[(__bridge NSString *)kCGImagePropertyOrientation] = @(exifOrientation); double compressionQuality = 1; if (options[SDImageCoderEncodeCompressionQuality]) &#123; compressionQuality = [options[SDImageCoderEncodeCompressionQuality] doubleValue]; &#125; properties[(__bridge NSString *)kCGImageDestinationLossyCompressionQuality] = @(compressionQuality); // Add your image to the destination. CGImageDestinationAddImage(imageDestination, image.CGImage, (__bridge CFDictionaryRef)properties); // Finalize the destination. if (CGImageDestinationFinalize(imageDestination) == NO) &#123; // Handle failure. imageData = nil; &#125; CFRelease(imageDestination); return [imageData copy];&#125; UIImageJPEGRepresentation() Á±ª‰ººÁöÑ API ‰πüÂèØ‰ª•Â∞Ü UIImage ËΩ¨‰∏∫ NSDataÔºå‰ΩÜÊòØ‰∏äÈù¢ËøôÁßçÈÄöËøá imageIO api ÁöÑÊñπÂºèÁîüÊàêÁöÑ NSData Êó†ËÆ∫ÊòØ‰ªéÂÜÖÂ≠ò‰ΩøÁî®ËøòÊòØÁâ©ÁêÜÂÜÖÂ≠òÁöÑÂç†Áî®‰∏äÈÉΩÊúâÊõ¥Â•ΩÁöÑË°®Áé∞„ÄÇ ÊÄªÁªì‰ªéÊú¨ÁØáÁöÑËß£Á†ÅËøáÁ®ã‰∏≠Êàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÔºå‰∏çËÆ∫ÊòØ‰ªé cache ËøòÊòØ downloadÔºåÈÉΩÈúÄË¶ÅÈÄöËøá data ËΩ¨Âåñ‰∏∫ÈÄöËøá bitmap Â±ïÁ§∫ÁöÑ image„ÄÇÂÖ∂‰∏≠Ëß£Á†ÅËøáÁ®ã‰ºöÂàÜ‰∏∫‰∏§Ê≠•Ôºö ‰ªé data ‚Üí image ‰ªé image ‚Üí bitmap ÂΩ¢ÂºèÁöÑ image Á¨¨‰∏ÄÊ≠•Áî± SDImageCodersManager ÁÆ°ÁêÜÔºåÂÆÉÈÄöËøáÂÜÖÁΩÆÁöÑÂ§ö‰∏™ÁºñËß£Á†ÅÂô®ÂÆåÊàêÔºõÁ¨¨‰∫åÈÉ®Áî± SDImageCoderHelper ÂÆåÊàêÔºåÂÆÉ‰ºöÂàõÂª∫‰∏Ä‰∏™ bitmapÔºåÂπ∂ÊääÂâçÈù¢ÁöÑ image ÁîªÂà∞‰∏äÈù¢ÂéªÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑ image„ÄÇ Âú®ÁºñËß£Á†ÅÈò∂ÊÆµÊàë‰ª¨ËÉΩËé∑ÂèñÂà∞ÁöÑÁü•ËØÜÁÇπÊúâÂ¶Ç‰∏ãÔºö Ëé∑ÂèñÂõæÁâáÁöÑÁ±ªÂûãÂèØ‰ª•ËØªÂèñÂÖ∂ data ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óËäÇÂà§Êñ≠ GIF ÁöÑ duration ÊòØ‰∏çÂõ∫ÂÆöÁöÑÔºåËΩ¨‰∏∫ iOS ‰∏≠ÊòæÁ§∫Êó∂Ë¶ÅÊèíÂ∏ß Â¶ÇÊûúÂõæÁâáÊ≤°Êúâ alpha ÈÄöÈÅìÔºåÂàõÂª∫ bitmap ÁöÑÊó∂ÂÄôÂ∞±‰∏çË¶ÅÂàõÂª∫Êúâ alpha ÈÄöÈÅìÁöÑ„ÄÇÊ≤°Êúâ alpha ÈÄöÈÅìËÉΩÂ¢ûÂø´Ê∏≤ÊüìÊïàÁéá UIImage Âè™ÊúâÂú®ÊòæÁ§∫ÁöÑÊó∂ÂÄôÊâç‰ºöÂú®‰∏ªÁ∫øÁ®ã‰∏≠Ëß£Á†ÅÔºåÊµ™Ë¥πÊó∂Èó¥„ÄÇÂèØ‰ª•ÈÄöËøáÂú®Â≠êÁ∫øÁ®ã‰∏≠ÂàõÂª∫ bitmap ÁöÑÊñπÂºèÊèêÂâçÂ∞ÜÂõæÁâáÂä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠„ÄÇ ÂØπ‰∫éË∂ÖÂ§ßÁöÑ UIImageÔºå‰∏∫‰∫ÜÈôç‰ΩéÂÜÖÂ≠òÊ∂àËÄóÔºåÂèØ‰ª•ÊåâÊØî‰æãÁº©Êîæ„ÄÇÁîüÊàêÁº©ÊîæÂõæÁâáÁöÑÊó∂ÂÄôÂèØ‰ª•ÈÄöËøáÂàÜÁâáÊ∏≤ÊüìÁöÑÊñπÂºèÔºåÊØèÂä†ËΩΩ‰∏ÄÈÉ®ÂàÜÔºåÊ∏≤Êüì‰∏ÄÈÉ®ÂàÜÂà∞Áº©ÊîæÂõæÁâá‰∏ä„ÄÇ Ê∏êËøõÂºèËß£Á†Å‰∏ªË¶Å‰ΩøÁî® Core Graphic APIÔºåËé∑Âèñ‰∏ÄÈÉ®ÂàÜÊï∞ÊçÆÂ∞±ÂæÄ CGImageSourceRef ‰∏≠‰∏¢‰∏ÄÈÉ®ÂàÜÔºåÁÑ∂ÂêéÁîüÊàê UIImage ‰ΩøÁî® UIImageJPEGRepresentation() Á±ª‰ºº API Â∞Ü UIImage ‚Üí NSData ‰∏çÂ¶Ç‰ΩøÁî® ImageIO ÁöÑ API ÊïàÁéáÈ´òÔºåÂç†Áî®ÂÜÖÂ≠òÂ∞è„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SDWebImage Ê∫êÁ†ÅËß£Êûê‚Äî‰∏ãËΩΩÁ≠ñÁï•]]></title>
    <url>%2F2018%2F03%2F05%2FSDWebImage3%2F</url>
    <content type="text"><![CDATA[‰∏ä‰∏ÄÁØáÁöÑÁºìÂ≠òÁ≠ñÁï•‰∏ªË¶ÅËØ¥Âà∞‰∫åÁ∫ßÁºìÂ≠ò„ÄÇËøô‰∏ÄÈÉ®ÂàÜÂ∞ÜË∞àÂèä‰∏ãËΩΩ„ÄÇ SDWebImageManager Ë∞ÉÁî®È¶ñÂÖàÁúã SDWebImageManager ‰∏≠ÁöÑÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586#pragma mark - ‰∏ãËΩΩÂõæÁâá- (void)callDownloadProcessForOperation:(nonnull SDWebImageCombinedOperation *)operation url:(nonnull NSURL *)url options:(SDWebImageOptions)options context:(SDWebImageContext *)context cachedImage:(nullable UIImage *)cachedImage cachedData:(nullable NSData *)cachedData cacheType:(SDImageCacheType)cacheType progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nullable SDInternalCompletionBlock)completedBlock &#123; // Check whether we should download image from network /// ËÉΩÂê¶‰∏ãËΩΩ /// options ‰∏çÊòØÂè™ËÉΩ‰ªé cache ‰∏≠Âä†ËΩΩ BOOL shouldDownload = !SD_OPTIONS_CONTAINS(options, SDWebImageFromCacheOnly); /// Âπ∂‰∏î‰∏çÂ≠òÂú®ÁºìÂ≠òÁöÑ image ÊàñËÄÖ options ÂøÖÈ°ªË¶ÅÂà∑Êñ∞ÁºìÂ≠òÁöÑ image shouldDownload &amp;= (!cachedImage || options &amp; SDWebImageRefreshCached); /// Âπ∂‰∏î delegate Ê≤°Êúâ imageManager:shouldDownloadImageForURL: ÊñπÊ≥ïÊàñËÄÖËøîÂõûÁöÑÊòØ true shouldDownload &amp;= (![self.delegate respondsToSelector:@selector(imageManager:shouldDownloadImageForURL:)] || [self.delegate imageManager:self shouldDownloadImageForURL:url]); /// SDWebImageDownloader ‰∏≠ÂÆûÁé∞ÔºåÂØπÊâÄÊúâË¥πÊéß url ÈÉΩÊòØ true shouldDownload &amp;= [self.imageLoader canRequestImageForURL:url]; /// Â¶ÇÊûúÂøÖÈ°ªË¶Å‰∏ãËΩΩ if (shouldDownload) &#123; /// Â¶ÇÊûú option ÁöÑÁõÆÁöÑÊòØ refreshCached„ÄÇÈÇ£‰πàË¶ÅÈáçÊñ∞‰ªéÊúçÂä°Âô®‰∏ãËΩΩÔºåËÆ© NSURLCache ËÆ∞ÂΩï‰∏ãÊñ∞ÁöÑÁºìÂ≠ò if (cachedImage &amp;&amp; options &amp; SDWebImageRefreshCached) &#123; [self callCompletionBlockForOperation:operation completion:completedBlock image:cachedImage data:cachedData error:nil cacheType:cacheType finished:YES url:url]; // Pass the cached image to the image loader. The image loader should check whether the remote image is equal to the cached image. SDWebImageMutableContext *mutableContext; if (context) &#123; mutableContext = [context mutableCopy]; &#125; else &#123; mutableContext = [NSMutableDictionary dictionary]; &#125; mutableContext[SDWebImageContextLoaderCachedImage] = cachedImage; context = [mutableContext copy]; &#125; // `SDWebImageCombinedOperation` -&gt; `SDWebImageDownloadToken` -&gt; `downloadOperationCancelToken`, which is a `SDCallbacksDictionary` and retain the completed block below, so we need weak-strong again to avoid retain cycle @weakify(operation); /// ‰∏ãËΩΩÁöÑ operation operation.loaderOperation = [self.imageLoader requestImageWithURL:url options:options context:context progress:progressBlock completed:^(UIImage *downloadedImage, NSData *downloadedData, NSError *error, BOOL finished) &#123; @strongify(operation); if (!operation || operation.isCancelled) &#123; /// Â¶ÇÊûú operation Â∑≤ÁªèÈîÄÊØÅÊàñËÄÖÂ∑≤ÁªèÂèñÊ∂à,ÊäõÂá∫error [self callCompletionBlockForOperation:operation completion:completedBlock error:[NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorCancelled userInfo:nil] url:url]; &#125; else if (cachedImage &amp;&amp; options &amp; SDWebImageRefreshCached &amp;&amp; [error.domain isEqualToString:SDWebImageErrorDomain] &amp;&amp; error.code == SDWebImageErrorCacheNotModified) &#123; /// Â¶ÇÊûú‰∏ãËΩΩÁöÑÁõÆÁöÑÊòØÂà∑Êñ∞ÁºìÂ≠òÔºå‰ΩÜÊòØÁºìÂ≠òÊ≤°ÊúâÂèòÂåñÔºåÈÇ£‰πà‰ªÄ‰πà‰πü‰∏çÂÅö &#125; else if ([error.domain isEqualToString:SDWebImageErrorDomain] &amp;&amp; error.code == SDWebImageErrorCancelled) &#123; /// ËøáÊó©ÁöÑË¢´ÂèñÊ∂à [self callCompletionBlockForOperation:operation completion:completedBlock error:error url:url]; &#125; else if (error) &#123; /// ÂêÑÁßçÂÖ∂‰ªñÈîôËØØ [self callCompletionBlockForOperation:operation completion:completedBlock error:error url:url]; /// Âà§Êñ≠ÊòØÂê¶Ë¶Å block ÈîôËØØÁöÑ url BOOL shouldBlockFailedURL = [self shouldBlockFailedURLWithURL:url error:error]; if (shouldBlockFailedURL) &#123; SD_LOCK(self.failedURLsLock); [self.failedURLs addObject:url]; SD_UNLOCK(self.failedURLsLock); &#125; &#125; else &#123; /// ÂÖ∂‰ªñÊàêÂäüÁöÑÊÉÖÂÜµ if ((options &amp; SDWebImageRetryFailed)) &#123; SD_LOCK(self.failedURLsLock); [self.failedURLs removeObject:url]; SD_UNLOCK(self.failedURLsLock); &#125; /// ËøõË°åÂõæÁâáÂ≠òÂÇ® [self callStoreCacheProcessForOperation:operation url:url options:options context:context downloadedImage:downloadedImage downloadedData:downloadedData finished:finished progress:progressBlock completed:completedBlock]; &#125; if (finished) &#123; [self safelyRemoveOperationFromRunning:operation]; &#125; &#125;]; /// Â¶ÇÊûú‰∏çËÆ©‰∏ãËΩΩÔºå‰ΩÜÊòØÊúâÁºìÂ≠òÁöÑÂõæÁâáÔºåbÊääÁºìÂ≠òÂõæÁâátËøîÂõû &#125; else if (cachedImage) &#123; [self callCompletionBlockForOperation:operation completion:completedBlock image:cachedImage data:cachedData error:nil cacheType:cacheType finished:YES url:url]; [self safelyRemoveOperationFromRunning:operation]; /// Ê≤°ÊúâÁºìÂ≠òÁöÑÂõæÁâáÂπ∂‰∏î‰πü‰∏çËÉΩ‰∏ãËΩΩÔºåÁõ¥Êé•Ë∞ÉÁî®complete ÂõûË∞ÉÊääÁ©∫ËøîÂõû &#125; else &#123; // Image not in cache and download disallowed by delegate [self callCompletionBlockForOperation:operation completion:completedBlock image:nil data:nil error:nil cacheType:SDImageCacheTypeNone finished:YES url:url]; [self safelyRemoveOperationFromRunning:operation]; &#125;&#125; ÂÆÉ‰ºöÈÄöËøáÂÖ∂Â±ûÊÄß imageLoader ÂéªÂàõÂª∫‰∏Ä‰∏™‰∏ãËΩΩÁî®ÁöÑ operation„ÄÇËøô‰∏™ imageLoader Â±ûÊÄßÁöÑÂÆö‰πâÂ¶Ç‰∏ãÔºåÂÆÉ‰ºöÊª°Ë∂≥ SDImageLoader ÂçèËÆÆÔºö 1@property (strong, nonatomic, readonly, nonnull) id&lt;SDImageLoader&gt; imageLoader; Âú®ÂàùÂßãÂåñ SDWebImageManager ÁöÑÊó∂ÂÄôÂØπÂÖ∂ËøõË°å‰∫ÜËÆæÁΩÆÔºåÂÆÉÈªòËÆ§ÊòØ SDWebImageDownloader ÁöÑÂÆû‰æã„ÄÇ SDWebImageDownloaderÂàùÂßãÂåñÊñπÊ≥ïSDWebImageDownloader ‰πüÊòØ‰∏Ä‰∏™Âçï‰æãÂØπË±°ÔºåÂÆÉÁöÑÂàùÂßãÂåñÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849- (instancetype)initWithConfig:(SDWebImageDownloaderConfig *)config &#123; self = [super init]; if (self) &#123; if (!config) &#123; config = SDWebImageDownloaderConfig.defaultDownloaderConfig; &#125; _config = [config copy]; /// ÁõëÂê¨ config ‰∏≠ËÆæÁΩÆÁöÑÊúÄÂ§ßÂπ∂ÂèëÊï∞ [_config addObserver:self forKeyPath:NSStringFromSelector(@selector(maxConcurrentDownloads)) options:0 context:SDWebImageDownloaderContext]; /// ÂàõÂª∫‰∏Ä‰∏™Áî®‰∫é‰∏ãËΩΩÁöÑ NSOperationQueue _downloadQueue = [NSOperationQueue new]; /// NSOperationQueue ÁöÑÊúÄÂ§ßÂπ∂ÂèëÊï∞ _downloadQueue.maxConcurrentOperationCount = _config.maxConcurrentDownloads; _downloadQueue.name = @"com.hackemist.SDWebImageDownloader"; _URLOperations = [NSMutableDictionary new]; NSMutableDictionary&lt;NSString *, NSString *&gt; *headerDictionary = [NSMutableDictionary dictionary]; NSString *userAgent = nil; // User-Agent Header; see http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.43 /// ËÆæÁΩÆ UA userAgent = [NSString stringWithFormat:@"%@/%@ (%@; iOS %@; Scale/%0.2f)", [[NSBundle mainBundle] infoDictionary][(__bridge NSString *)kCFBundleExecutableKey] ?: [[NSBundle mainBundle] infoDictionary][(__bridge NSString *)kCFBundleIdentifierKey], [[NSBundle mainBundle] infoDictionary][@"CFBundleShortVersionString"] ?: [[NSBundle mainBundle] infoDictionary][(__bridge NSString *)kCFBundleVersionKey], [[UIDevice currentDevice] model], [[UIDevice currentDevice] systemVersion], [[UIScreen mainScreen] scale]]; if (userAgent) &#123; if (![userAgent canBeConvertedToEncoding:NSASCIIStringEncoding]) &#123; NSMutableString *mutableUserAgent = [userAgent mutableCopy]; if (CFStringTransform((__bridge CFMutableStringRef)(mutableUserAgent), NULL, (__bridge CFStringRef)@"Any-Latin; Latin-ASCII; [:^ASCII:] Remove", false)) &#123; userAgent = mutableUserAgent; &#125; &#125; headerDictionary[@"User-Agent"] = userAgent; &#125; headerDictionary[@"Accept"] = @"image/*,*/*;q=0.8"; _HTTPHeaders = headerDictionary; _HTTPHeadersLock = dispatch_semaphore_create(1); _operationsLock = dispatch_semaphore_create(1); NSURLSessionConfiguration *sessionConfiguration = _config.sessionConfiguration; if (!sessionConfiguration) &#123; sessionConfiguration = [NSURLSessionConfiguration defaultSessionConfiguration]; &#125; /** * Create the session for this task * We send nil as delegate queue so that the session creates a serial operation queue for performing all delegate * method calls and completion handler calls. */ /// ÂàõÂª∫ NSURLSession _session = [NSURLSession sessionWithConfiguration:sessionConfiguration delegate:self delegateQueue:nil]; &#125; return self;&#125; ÂàùÂßãÂåñ‰∫Ü‰∏Ä‰∏™ NSURLSessionÔºåÂπ∂‰∏îËÆæÁΩÆ‰∫ÜÈÉ®ÂàÜ header„ÄÇ Â§ñÈÉ®Ë∞ÉÁî®ÊñπÊ≥ïÂ§ñÈÉ®Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÂ¶Ç‰∏ãÔºåÂÆÉÂÖàÂØπ options ÂÅö‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂ§ÑÁêÜÔºö 1234567891011121314151617181920212223242526272829303132333435363738#pragma mark - Â§ñÈÉ®Ë∞ÉÁî®- (id&lt;SDWebImageOperation&gt;)requestImageWithURL:(NSURL *)url options:(SDWebImageOptions)options context:(SDWebImageContext *)context progress:(SDImageLoaderProgressBlock)progressBlock completed:(SDImageLoaderCompletedBlock)completedBlock &#123; UIImage *cachedImage = context[SDWebImageContextLoaderCachedImage]; SDWebImageDownloaderOptions downloaderOptions = 0; /// ‰Ωé‰ºòÂÖàÁ∫ß if (options &amp; SDWebImageLowPriority) downloaderOptions |= SDWebImageDownloaderLowPriority; /// image ‰ºö‰∏ÄÁÇπ‰∏ÄÁÇπÂä†ËΩΩÂá∫Êù• if (options &amp; SDWebImageProgressiveLoad) downloaderOptions |= SDWebImageDownloaderProgressiveLoad; /// ‰ΩøÁî® NSURLCache ÁºìÂ≠ò if (options &amp; SDWebImageRefreshCached) downloaderOptions |= SDWebImageDownloaderUseNSURLCache; /// ÂÖÅËÆ∏ÂêéÂè∞‰∏ãËΩΩ if (options &amp; SDWebImageContinueInBackground) downloaderOptions |= SDWebImageDownloaderContinueInBackground; /// cookies Áõ∏ÂÖ≥ if (options &amp; SDWebImageHandleCookies) downloaderOptions |= SDWebImageDownloaderHandleCookies; /// ÂÖÅËÆ∏ÈùûÊ≥ï SSL if (options &amp; SDWebImageAllowInvalidSSLCertificates) downloaderOptions |= SDWebImageDownloaderAllowInvalidSSLCertificates; /// È´ò‰ºòÂÖàÁ∫ß if (options &amp; SDWebImageHighPriority) downloaderOptions |= SDWebImageDownloaderHighPriority; /// Èôç‰ΩéÂõæÁâáÁöÑ scale if (options &amp; SDWebImageScaleDownLargeImages) downloaderOptions |= SDWebImageDownloaderScaleDownLargeImages; /// Á¶ÅÊ≠¢Ëß£Á†ÅÂõæÁâá if (options &amp; SDWebImageAvoidDecodeImage) downloaderOptions |= SDWebImageDownloaderAvoidDecodeImage; /// ÂÄºËß£Á†ÅÁ¨¨‰∏ÄÂ∏ß if (options &amp; SDWebImageDecodeFirstFrameOnly) downloaderOptions |= SDWebImageDownloaderDecodeFirstFrameOnly; /// È¢ÑÂä†ËΩΩÊâÄÊúâÂ∏ß if (options &amp; SDWebImagePreloadAllFrames) downloaderOptions |= SDWebImageDownloaderPreloadAllFrames; /// ÊúâÂõæ‰ΩÜÊòØË¶ÅÂà∑Êñ∞ÁºìÂ≠ò if (cachedImage &amp;&amp; options &amp; SDWebImageRefreshCached) &#123; // force progressive off if image already cached but forced refreshing downloaderOptions &amp;= ~SDWebImageDownloaderProgressiveLoad; // ignore image read from NSURLCache if image if cached but force refreshing downloaderOptions |= SDWebImageDownloaderIgnoreCachedResponse; &#125; return [self downloadImageWithURL:url options:downloaderOptions context:context progress:progressBlock completed:completedBlock];&#125; ÂàõÂª∫ SDWebImageDownloadToken SDWebImageDownloadToken Á±ªÂûãÁöÑÂÆû‰æãÂ∞±ÊòØ‰øùÂ≠òÂú® SDWebImageCombinedOperation ‰∏≠ÁöÑ loaderOperation„ÄÇÂÖàÁúã‰∏Ä‰∏ãÂÆÉÁöÑÂÆû‰æãÂØπË±°Ôºö 1234567891011@interface SDWebImageDownloadToken ()@property (nonatomic, strong, nullable, readwrite) NSURL *url;@property (nonatomic, strong, nullable, readwrite) NSURLRequest *request;@property (nonatomic, strong, nullable, readwrite) NSURLResponse *response;@property (nonatomic, strong, nullable, readwrite) id downloadOperationCancelToken;@property (nonatomic, weak, nullable) NSOperation&lt;SDWebImageDownloaderOperation&gt; *downloadOperation;@property (nonatomic, weak, nullable) SDWebImageDownloader *downloader;@property (nonatomic, assign, getter=isCancelled) BOOL cancelled;@end ÂèØ‰ª•ÁúãÂà∞ÂÆÉÁöÑÂÜÖÈÉ®ÂåÖÂê´‰∏Ä‰∏™ NSOperation Âíå cancelled ÂÆû‰æã„ÄÇÂèØ‰ª•ÁúãÂá∫Ôºå‰ªñÊòØ NSOperation ÁöÑÂåÖË£ÖÁ±ª„ÄÇÊù•Áúã‰∏Ä‰∏ãÂÆÉÁöÑÂàõÂª∫ËøáÁ®ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677- (nullable SDWebImageDownloadToken *)downloadImageWithURL:(nullable NSURL *)url options:(SDWebImageDownloaderOptions)options context:(nullable SDWebImageContext *)context progress:(nullable SDWebImageDownloaderProgressBlock)progressBlock completed:(nullable SDWebImageDownloaderCompletedBlock)completedBlock &#123; if (url == nil) &#123; if (completedBlock) &#123; NSError *error = [NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorInvalidURL userInfo:@&#123;NSLocalizedDescriptionKey : @"Image url is nil"&#125;]; completedBlock(nil, nil, error, YES); &#125; return nil; &#125; SD_LOCK(self.operationsLock); id downloadOperationCancelToken; /// ‰ªéÂçï‰æãÁöÑ URLOperations Ê±†‰∏≠ÂèñÂá∫ËØ• url ÂØπÂ∫îÁöÑ operation NSOperation&lt;SDWebImageDownloaderOperation&gt; *operation = [self.URLOperations objectForKey:url]; if (!operation || operation.isFinished || operation.isCancelled) &#123; /// Â¶ÇÊûú opertion ‰∏çÂ≠òÂú®ÊàñËÄÖÂ∑≤ÁªèÁªìÊùü‰∫ÜÔºåÈÇ£‰πàÂ∞±ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑ operation operation = [self createDownloaderOperationWithUrl:url options:options context:context]; /// Ê≤°ÂàõÂª∫ÊàêÂäüÂ∞±Êä•Èîô if (!operation) &#123; SD_UNLOCK(self.operationsLock); if (completedBlock) &#123; NSError *error = [NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorInvalidDownloadOperation userInfo:@&#123;NSLocalizedDescriptionKey : @"Downloader operation is nil"&#125;]; completedBlock(nil, nil, error, YES); &#125; return nil; &#125; @weakify(self); /// opeartion ÂÆåÊàê‰πãÂêéË¶ÅÁßªÈô§Âçï‰æã‰∏≠ÂØπÂ∫îÁöÑ operation operation.completionBlock = ^&#123; @strongify(self); if (!self) &#123; return; &#125; SD_LOCK(self.operationsLock); [self.URLOperations removeObjectForKey:url]; SD_UNLOCK(self.operationsLock); &#125;; /// ÊääÂàõÂª∫ÁöÑ operation Âä†ÂÖ•Âà∞Âçï‰æãÁöÑÂ≠óÂÖ∏‰∏≠ self.URLOperations[url] = operation; // Add operation to operation queue only after all configuration done according to Apple's doc. // `addOperation:` does not synchronously execute the `operation.completionBlock` so this will not cause deadlock. /// ÂºÄÂêØÂºÇÊ≠•‰ªªÂä° [self.downloadQueue addOperation:operation]; /// Êää progressBlock Âíå completedBlock ÊîæÂà∞ Operation ÁöÑÊï∞ÁªÑ‰∏≠„ÄÇ downloadOperationCancelToken = [operation addHandlersForProgress:progressBlock completed:completedBlock]; &#125; else &#123; /// Â¶ÇÊûúÂçï‰æã‰∏≠Â∑≤ÁªèÂ≠òÂú®‰∫ÜËøô‰∏™ opeartionÔºåÈÇ£‰πàËØ¥ÊòéÂØπ‰∫éËøô‰∏™‰∏ãËΩΩ‰ªªÂä°‰ºöÊúâÂ§ö‰∏™ÁõëÂê¨„ÄÇÂõ†Ê≠§ÈÄöËøá addHandlersForProgress Â∞ÜÂÆåÊàêÂõûË∞ÉÂä†ÂÖ• operation ÁöÑÊï∞ÁªÑ‰∏≠ @synchronized (operation) &#123; downloadOperationCancelToken = [operation addHandlersForProgress:progressBlock completed:completedBlock]; &#125; /// Â≠òÂú® operation Âπ∂‰∏î‰∏çÊòØÂú®ÊâßË°å‰∏≠ if (!operation.isExecuting) &#123; /// Ê†πÊçÆ options ËÆæÁΩÆ‰ºòÂÖàÁ∫ß if (options &amp; SDWebImageDownloaderHighPriority) &#123; operation.queuePriority = NSOperationQueuePriorityHigh; &#125; else if (options &amp; SDWebImageDownloaderLowPriority) &#123; operation.queuePriority = NSOperationQueuePriorityLow; &#125; else &#123; operation.queuePriority = NSOperationQueuePriorityNormal; &#125; &#125; &#125; SD_UNLOCK(self.operationsLock); /// SDWebImageDownloadToken ÊòØ operation ÁöÑÂåÖË£ÖÁ±ª SDWebImageDownloadToken *token = [[SDWebImageDownloadToken alloc] initWithDownloadOperation:operation]; token.url = url; token.request = operation.request; /// ÈÄöËøádownloadOperationCancelToken‰Ωú‰∏∫Ê†áËØÜÂèØ‰ª•ÂèñÊ∂àÊüê‰∏Ä‰∏™opeartionÁöÑÂõûË∞É token.downloadOperationCancelToken = downloadOperationCancelToken; token.downloader = self; return token;&#125; SDWebImageDownloader ÊòØ‰∏Ä‰∏™Âçï‰æãÂØπË±°ÔºåÂÆÉÁöÑÂÜÖÈÉ®ÂåÖÂê´‰∫Ü‰∏Ä‰∏™ URLOpeartion ÁöÑÂ≠óÂÖ∏Ôºå‰øùÂ≠òÁùÄ url ‚Üí NSOpeartion ÁöÑÊò†Â∞Ñ„ÄÇÂΩìÈáçÂ§çËØ∑Ê±ÇÂêå‰∏Ä‰∏™Ê≠£Âú®ËØ∑Ê±ÇÁöÑ url ÁöÑÊó∂ÂÄôÔºåÂ∞±ÂèØ‰ª•Â∞ÜÂõûË∞ÉÊñπÊ≥ï‰øùÂ≠òÂú® NSOperation ÁöÑÁâπÂÆöÊï∞ÁªÑ‰∏≠ÔºåÂèØ‰ª•ÈÄöËøáÂàõÂª∫ÁöÑ downloadOperationCancelToken ÊâæÂà∞ÂÆÉÔºåÂú®ÁâπÂÆöÁöÑÊó∂ÂÄôÈîÄÊØÅÊàñÂèñÊ∂à„ÄÇ ÂÖà‰∏çË∞à NSOperation ÊòØÂ¶Ç‰ΩïÂàõÂª∫ÁöÑÔºåÂΩìÂÆÉË¢´ÂàõÂª∫‰πãÂêéÔºå‰ºöË¢´ÂåÖË£πÂú® SDWebImageDownloadToken ÂÆû‰æã‰∏≠ÔºåÂêåÊ†∑ËøòÂåÖÊã¨ downloadOperationCancelToken„ÄÇÈÄöËøá downloadOperationCancelToken ÂèØ‰ª•ÂèñÊ∂àÊüê‰∏Ä‰∏™ÂõûË∞É„ÄÇ SDWebImageDownloaderOperationSDWebImageDownloaderOperation ÊòØ NSOperation ÁöÑÂ≠êÁ±ªÔºåË¥üË¥£ÂºÇÊ≠•‰∏ãËΩΩ„ÄÇ ÂàõÂª∫ NSOperation123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081#pragma mark - ÂàõÂª∫‰∏ãËΩΩ Operation- (nullable NSOperation&lt;SDWebImageDownloaderOperation&gt; *)createDownloaderOperationWithUrl:(nonnull NSURL *)url options:(SDWebImageDownloaderOptions)options context:(nullable SDWebImageContext *)context &#123; /// ËØ∑Ê±ÇË∂ÖÊó∂Êó∂Èó¥ NSTimeInterval timeoutInterval = self.config.downloadTimeout; if (timeoutInterval == 0.0) &#123; timeoutInterval = 15.0; &#125; // In order to prevent from potential duplicate caching (NSURLCache + SDImageCache) we disable the cache for image requests if told otherwise /// ÊòØÂê¶‰ΩøÁî® NSURLCache NSURLRequestCachePolicy cachePolicy = options &amp; SDWebImageDownloaderUseNSURLCache ? NSURLRequestUseProtocolCachePolicy : NSURLRequestReloadIgnoringLocalCacheData; /// ÂàõÂª∫‰∏Ä‰∏™ request NSMutableURLRequest *mutableRequest = [[NSMutableURLRequest alloc] initWithURL:url cachePolicy:cachePolicy timeoutInterval:timeoutInterval]; mutableRequest.HTTPShouldHandleCookies = SD_OPTIONS_CONTAINS(options, SDWebImageDownloaderHandleCookies); mutableRequest.HTTPShouldUsePipelining = YES; SD_LOCK(self.HTTPHeadersLock); /// ËÆæÁΩÆ request ÁöÑ http Â§¥ mutableRequest.allHTTPHeaderFields = self.HTTPHeaders; SD_UNLOCK(self.HTTPHeadersLock); /// Ëá™ÂÆö‰πâÂØπ‰∫éËØ∑Ê±ÇÂÅö‰∏Ä‰∫õ‰øÆÊîπ id&lt;SDWebImageDownloaderRequestModifier&gt; requestModifier; if ([context valueForKey:SDWebImageContextDownloadRequestModifier]) &#123; requestModifier = [context valueForKey:SDWebImageContextDownloadRequestModifier]; &#125; else &#123; requestModifier = self.requestModifier; &#125; NSURLRequest *request; if (requestModifier) &#123; NSURLRequest *modifiedRequest = [requestModifier modifiedRequestWithRequest:[mutableRequest copy]]; // If modified request is nil, early return if (!modifiedRequest) &#123; return nil; &#125; else &#123; request = [modifiedRequest copy]; &#125; &#125; else &#123; request = [mutableRequest copy]; &#125; /// ÊúâËá™ÂÆö‰πâ operationClass Áî® operationClassÔºåÊ≤°ÊúâÂ∞±Áî®ÈªòËÆ§ÁöÑ SDWebImageDownloaderOperation Class operationClass = self.config.operationClass; if (operationClass &amp;&amp; [operationClass isSubclassOfClass:[NSOperation class]] &amp;&amp; [operationClass conformsToProtocol:@protocol(SDWebImageDownloaderOperation)]) &#123; // Custom operation class &#125; else &#123; operationClass = [SDWebImageDownloaderOperation class]; &#125; NSOperation&lt;SDWebImageDownloaderOperation&gt; *operation = [[operationClass alloc] initWithRequest:request inSession:self.session options:options context:context]; /// ÊúâÈâ¥ÊùÉÊâßË°åÈâ¥ÊùÉ if ([operation respondsToSelector:@selector(setCredential:)]) &#123; if (self.config.urlCredential) &#123; operation.credential = self.config.urlCredential; &#125; else if (self.config.username &amp;&amp; self.config.password) &#123; operation.credential = [NSURLCredential credentialWithUser:self.config.username password:self.config.password persistence:NSURLCredentialPersistenceForSession]; &#125; &#125; /// ÊúÄÂ∞èÂõûË∞ÉËøõÂ∫¶ if ([operation respondsToSelector:@selector(setMinimumProgressInterval:)]) &#123; operation.minimumProgressInterval = MIN(MAX(self.config.minimumProgressInterval, 0), 1); &#125; /// ‰∏ãËΩΩ‰ºòÂÖàÁ∫ß if (options &amp; SDWebImageDownloaderHighPriority) &#123; operation.queuePriority = NSOperationQueuePriorityHigh; &#125; else if (options &amp; SDWebImageDownloaderLowPriority) &#123; operation.queuePriority = NSOperationQueuePriorityLow; &#125; /// Â¶ÇÊûúÊòØÂêéËøõÂÖàÂá∫ÁöÑÔºåÈÇ£‰πàÈÄöËøádependencyÁ°ÆÂÆöÊâßË°åÈ°∫Â∫è if (self.config.executionOrder == SDWebImageDownloaderLIFOExecutionOrder) &#123; // Emulate LIFO execution order by systematically adding new operations as last operation's dependency [self.lastAddedOperation addDependency:operation]; self.lastAddedOperation = operation; &#125; return operation;&#125; SDWebImage ‰∏≠ÂÖÖÂàÜÂà©Áî®‰∫ÜÂçèËÆÆ‰ª£ÊõøÁªßÊâø„ÄÇËøôÈáåÈúÄË¶ÅÂàõÂª∫ÁöÑÊòØ‰∏Ä‰∏™ÂÆûÁé∞‰∫Ü SDWebImageDownloaderOperation ÂçèËÆÆÁöÑ NSOperation: 12345678910111213141516171819202122232425262728@protocol SDWebImageDownloaderOperation &lt;NSURLSessionTaskDelegate, NSURLSessionDataDelegate&gt;@required/// ÂàùÂßãÂåñÊñπÊ≥ïÔºå‰øùÂ≠ò NSURLRequest Âíå NSURLSession ÂÆû‰æãÂØπË±°- (nonnull instancetype)initWithRequest:(nullable NSURLRequest *)request inSession:(nullable NSURLSession *)session options:(SDWebImageDownloaderOptions)options;- (nonnull instancetype)initWithRequest:(nullable NSURLRequest *)request inSession:(nullable NSURLSession *)session options:(SDWebImageDownloaderOptions)options context:(nullable SDWebImageContext *)context;/// ‰øùÂ≠òËøõÂ∫¶ÂõûË∞É‰ª•ÂèäÂÆåÊàêÂõûË∞É- (nullable id)addHandlersForProgress:(nullable SDWebImageDownloaderProgressBlock)progressBlock completed:(nullable SDWebImageDownloaderCompletedBlock)completedBlock;/// Ê†πÊçÆ token ÂèñÊ∂à NSOperation ‰∏≠ÁöÑÊüê‰∏™ËøõÂ∫¶ÂèäÂÆåÊàêÂõûË∞É- (BOOL)cancel:(nullable id)token;@property (strong, nonatomic, readonly, nullable) NSURLRequest *request;@property (strong, nonatomic, readonly, nullable) NSURLResponse *response;@optional@property (strong, nonatomic, readonly, nullable) NSURLSessionTask *dataTask;@property (strong, nonatomic, nullable) NSURLCredential *credential;@property (assign, nonatomic) double minimumProgressInterval;@end Âú® SDWebImage ‰∏≠ÔºåÈªòËÆ§ÁöÑÂÆûÁé∞Á±ªÊòØ SDWebImageDownloaderOperation„ÄÇ ÂºÄÂßãÊâßË°åÂΩì NSOperation ÈÄöËøá addOpeartion Ë¢´Ê∑ªÂä†Âà∞ NSOperationQueue ÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöËß¶Âèë NSOperation ÁöÑ start ÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687#pragma mark - ÂºÄÂêØ‰∏ãËΩΩ/// ÈÄöËøá addOperation ÂºÄÂßãÁöÑ- (void)start &#123; @synchronized (self) &#123; /// Â¶ÇÊûúÂ∑≤ÁªèË¢´ÂèñÊ∂à‰∫Ü if (self.isCancelled) &#123; self.finished = YES; // Operation cancelled by user before sending the request [self callCompletionBlocksWithError:[NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorCancelled userInfo:nil]]; [self reset]; return; &#125; Class UIApplicationClass = NSClassFromString(@"UIApplication"); BOOL hasApplication = UIApplicationClass &amp;&amp; [UIApplicationClass respondsToSelector:@selector(sharedApplication)]; /// Â¶ÇÊûú options Ë¶ÅÊ±ÇÂú®ÂêéÂè∞‰ªçÈúÄË¶ÅÊâßË°å‰ªªÂä°ÁöÑËØù if (hasApplication &amp;&amp; [self shouldContinueWhenAppEntersBackground]) &#123; __weak typeof(self) wself = self; UIApplication * app = [UIApplicationClass performSelector:@selector(sharedApplication)]; self.backgroundTaskId = [app beginBackgroundTaskWithExpirationHandler:^&#123; /// ÂèñÊ∂àÊâÄÊúâÁöÑ‰∏ãËΩΩ‰ªªÂä° [wself cancel]; &#125;]; &#125; NSURLSession *session = self.unownedSession; if (!session) &#123; NSURLSessionConfiguration *sessionConfig = [NSURLSessionConfiguration defaultSessionConfiguration]; sessionConfig.timeoutIntervalForRequest = 15; /** * Create the session for this task * We send nil as delegate queue so that the session creates a serial operation queue for performing all delegate * method calls and completion handler calls. */ /// Â¶ÇÊûú‰∏çÂ≠òÂú® session ÈÇ£‰πàÂàõÂª∫‰∏Ä‰∏™ session session = [NSURLSession sessionWithConfiguration:sessionConfig delegate:self delegateQueue:nil]; self.ownedSession = session; &#125; /// Â¶ÇÊûúË¶ÅÊó†ËßÜ NSURLCache ÁöÑÁºìÂ≠ò if (self.options &amp; SDWebImageDownloaderIgnoreCachedResponse) &#123; // Grab the cached data for later check NSURLCache *URLCache = session.configuration.URLCache; if (!URLCache) &#123; URLCache = [NSURLCache sharedURLCache]; &#125; NSCachedURLResponse *cachedResponse; // NSURLCache's `cachedResponseForRequest:` is not thread-safe, see https://developer.apple.com/documentation/foundation/nsurlcache#2317483 @synchronized (URLCache) &#123; cachedResponse = [URLCache cachedResponseForRequest:self.request]; &#125; if (cachedResponse) &#123; self.cachedData = cachedResponse.data; &#125; &#125; /// ÈÄöËøá session ÂàõÂª∫ dataTask self.dataTask = [session dataTaskWithRequest:self.request]; self.executing = YES; &#125; /// Â¶ÇÊûúÂàõÂª∫‰∫Ü dataTask if (self.dataTask) &#123; /// Ê†πÊçÆ options ËÆæÁΩÆ‰ºòÂÖàÁ∫ß if (self.options &amp; SDWebImageDownloaderHighPriority) &#123; self.dataTask.priority = NSURLSessionTaskPriorityHigh; &#125; else if (self.options &amp; SDWebImageDownloaderLowPriority) &#123; self.dataTask.priority = NSURLSessionTaskPriorityLow; &#125; /// ÂºÄÂêØ dataTask [self.dataTask resume]; /// ÊâßË°å progressBlock for (SDWebImageDownloaderProgressBlock progressBlock in [self callbacksForKey:kProgressCallbackKey]) &#123; progressBlock(0, NSURLResponseUnknownLength, self.request.URL); &#125; __block typeof(self) strongSelf = self; dispatch_async(dispatch_get_main_queue(), ^&#123; [[NSNotificationCenter defaultCenter] postNotificationName:SDWebImageDownloadStartNotification object:strongSelf]; &#125;); &#125; else &#123; /// Ê≤°ÊúâÂàõÂª∫Áé©Êä•Èîô [self callCompletionBlocksWithError:[NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorInvalidDownloadOperation userInfo:@&#123;NSLocalizedDescriptionKey : @"Task can't be initialized"&#125;]]; [self done]; &#125;&#125; Âú® start ÊñπÊ≥ï‰∏≠ÔºåÂàõÂª∫Âπ∂‰øùÂ≠ò‰∫Ü NSURLSession ÂÆû‰æãÔºåÁÑ∂ÂêéÈÄöËøáÂÆÉÂàõÂª∫Âπ∂ÂºÄÂêØ‰∫Ü NSURLSessionTask„ÄÇ beginBackgroundTaskWithExpirationHandler ‰∏çÊòØÊÑèÂë≥ÁùÄÁ´ãÂç≥ÊâßË°åÂêéÂè∞‰ªªÂä°ÔºåÂÆÉÁõ∏ÂΩì‰∫éÊ≥®ÂÜå‰∫Ü‰∏Ä‰∏™ÂêéÂè∞‰ªªÂä°ÔºåËÄå‰πãÂêéÁöÑ handler Ë°®Á§∫ App Âú®Áõ¥Âà∞ÂêéÂè∞ËøêË°åÁöÑÊó∂Êú∫Âà∞Êù•ÂêéÂú®ËøêË°åÂÖ∂‰∏≠ÁöÑ block ‰ª£Á†ÅÈÄªËæë„ÄÇ NSURLSessionDataDelegateSDWebImageDownloaderOperation ÊòØ NSURLSession ÁöÑ NSURLSessionDataDelegate„ÄÇÈ¶ñÂÖàÁúãÁ¨¨‰∏ÄÊ¨°Êî∂Âà∞Êï∞ÊçÆÂêéÁöÑÂõûË∞ÉÊñπÊ≥ïÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243/// Êî∂Âà∞Êï∞ÊçÆÂêéÁ¨¨‰∏ÄÊ¨°ÂõûË∞É- (void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)dataTaskdidReceiveResponse:(NSURLResponse *)response completionHandler:(void (^)(NSURLSessionResponseDisposition disposition))completionHandler &#123; NSURLSessionResponseDisposition disposition = NSURLSessionResponseAllow; /// ÊãøÂà∞È¢ÑËÆ°ÁöÑÂõæÁâáÁöÑÂ§ßÂ∞è NSInteger expected = (NSInteger)response.expectedContentLength; expected = expected &gt; 0 ? expected : 0; self.expectedSize = expected; self.response = response; /// ÊãøÂà∞ËøîÂõûÁöÑÁä∂ÊÄÅÁ†Å NSInteger statusCode = [response respondsToSelector:@selector(statusCode)] ? ((NSHTTPURLResponse *)response).statusCode : 200; /// 200 - 400 ‰πãÈó¥ÁöÑÊòØÊúâÊïàÁöÑ BOOL valid = statusCode &gt;= 200 &amp;&amp; statusCode &lt; 400; /// Êó†ÊïàÁöÑÁä∂ÊÄÅÁ†ÅÁõ¥Êé•Êä•Èîô if (!valid) &#123; self.responseError = [NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorInvalidDownloadStatusCode userInfo:@&#123;SDWebImageErrorDownloadStatusCodeKey : @(statusCode)&#125;]; &#125; //'304 Not Modified' is an exceptional one //URLSession current behavior will return 200 status code when the server respond 304 and URLCache hit. But this is not a standard behavior and we just add a check if (statusCode == 304 &amp;&amp; !self.cachedData) &#123; valid = NO; self.responseError = [NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorCacheNotModified userInfo:nil]; &#125; if (valid) &#123; for (SDWebImageDownloaderProgressBlock progressBlock in [self callbacksForKey:kProgressCallbackKey]) &#123; progressBlock(0, expected, self.request.URL); &#125; &#125; else &#123; /// Â¶ÇÊûúÊòØ invalid ÔºåÈÇ£‰πàÂèñÊ∂àËøôÊ¨°ËØ∑Ê±Ç disposition = NSURLSessionResponseCancel; &#125; __block typeof(self) strongSelf = self; dispatch_async(dispatch_get_main_queue(), ^&#123; [[NSNotificationCenter defaultCenter] postNotificationName:SDWebImageDownloadReceiveResponseNotification object:strongSelf]; &#125;); if (completionHandler) &#123; completionHandler(disposition); &#125;&#125; È¶ñÂÖàÊòØËé∑ÂèñÊúüÊúõÁöÑÊï∞ÊçÆÂ§ßÂ∞è expectedContentLengthÔºåÈöèÂêéÈÄöËøá statusCode Âà§Êñ≠ÊòØÂê¶ÂèØ‰ª•Êé•Êî∂ data„ÄÇË∞ÉÁî®‰∫Ü completionHander ‰πãÂêéÔºåËøõÂÖ•‰∏ã‰∏Ä‰∏™‰ª£Á†ÅÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051/// Êî∂Âà∞Êï∞ÊçÆ- (void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)dataTask didReceiveData:(NSData *)data &#123; if (!self.imageData) &#123; /// ÂàõÂª∫‰∏Ä‰∏™ expectedSize Â§ßÂ∞èÁöÑ NSMutableData self.imageData = [[NSMutableData alloc] initWithCapacity:self.expectedSize]; &#125; /// Êää data append Âà∞ imageData ‰∏≠ [self.imageData appendData:data]; /// ËÆ°ÁÆóÂ∑≤Êé•Êî∂Êï∞ÊçÆÂ§ßÂ∞è self.receivedSize = self.imageData.length; if (self.expectedSize == 0) &#123; // Unknown expectedSize, immediately call progressBlock and return for (SDWebImageDownloaderProgressBlock progressBlock in [self callbacksForKey:kProgressCallbackKey]) &#123; /// ÂõûË∞É progressBlock progressBlock(self.receivedSize, self.expectedSize, self.request.URL); &#125; return; &#125; /// Â¶ÇÊûúÊî∂Âà∞ÁöÑ data Â§ß‰∫éÊúüÊúõÁöÑ dataÔºåÈÇ£‰πàÁõ¥Êé•Ë°®Á§∫ÂÆåÊàê BOOL finished = (self.receivedSize &gt;= self.expectedSize); double currentProgress = (double)self.receivedSize / (double)self.expectedSize; double previousProgress = self.previousProgress; double progressInterval = currentProgress - previousProgress; /// Êú¨Ê¨°Êé•Êî∂Âà∞ÁöÑÊï∞ÊçÆÁöÑÂ§ßÂ∞èÂ∞è‰∫éÊúÄÂ∞èÁöÑÂõûË∞ÉÈó¥ÈöîÔºåÈÇ£‰πàÂèñÊ∂àÂõûË∞É if (!finished &amp;&amp; (progressInterval &lt; self.minimumProgressInterval)) &#123; return; &#125; self.previousProgress = currentProgress; /// Â¶ÇÊûúÊòØÊ∏êËøõÂºèÁöÑÂä†ËΩΩÊñπÂºè if (self.options &amp; SDWebImageDownloaderProgressiveLoad) &#123; NSData *imageData = [self.imageData copy]; /// Âú® coderQueue ÈòüÂàó‰∏≠ÔºåÊ∏êËøõÂºèÁöÑ decode dispatch_async(self.coderQueue, ^&#123; @autoreleasepool &#123; UIImage *image = SDImageLoaderDecodeProgressiveImageData(imageData, self.request.URL, finished, self, [[self class] imageOptionsFromDownloaderOptions:self.options], self.context); if (image) &#123; // We do not keep the progressive decoding image even when `finished`=YES. Because they are for view rendering but not take full function from downloader options. And some coders implementation may not keep consistent between progressive decoding and normal decoding. [self callCompletionBlocksWithImage:image imageData:nil error:nil finished:NO]; &#125; &#125; &#125;); &#125; for (SDWebImageDownloaderProgressBlock progressBlock in [self callbacksForKey:kProgressCallbackKey]) &#123; progressBlock(self.receivedSize, self.expectedSize, self.request.URL); &#125;&#125; ‰∏çÊñ≠ÁöÑÊé•Êî∂ dataÔºåÂπ∂‰∏îÂ∞Ü data append Âà∞ imageData ‰πãÂêé„ÄÇÂ¶ÇÊûúÊòØÊ∏êËøõÂºèÁöÑÂä†ËΩΩÊñπÂºèÔºåËøòÈúÄË¶ÅÂèò‰∏ãËΩΩËæπËß£Á†Å„ÄÇ ‰∏ãËΩΩÂ•Ω‰πãÂêéÔºå‰ºöÊúâ‰∏Ä‰∏™ÂõûË∞ÉÂà§Êñ≠ÊòØÂê¶Ë¶ÅÈÄöËøá NSURLCache ÁºìÂ≠òÊï∞ÊçÆÔºö 12345678910111213141516/// Âà§Êñ≠ÊòØÂê¶ÂèØ‰ª•ÁºìÂ≠ò response ÁöÑÂõûË∞É- (void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)dataTask willCacheResponse:(NSCachedURLResponse *)proposedResponse completionHandler:(void (^)(NSCachedURLResponse *cachedResponse))completionHandler &#123; NSCachedURLResponse *cachedResponse = proposedResponse; if (!(self.options &amp; SDWebImageDownloaderUseNSURLCache)) &#123; // Prevents caching of responses cachedResponse = nil; &#125; if (completionHandler) &#123; completionHandler(cachedResponse); &#125;&#125; NSURLSessionTaskDelegateÂú®‰∏ãËΩΩÂÆåÊàêÂêé‰ºöÂõûË∞É NSURLSessionTaskDelegate ÁöÑÂÆåÊàêÊñπÊ≥ï„ÄÇÂú®ËøôÈáåÂèØ‰ª•Â∞ÜËé∑ÂèñÁöÑ data ÈÄöËøáÂõûË∞ÉÂáΩÊï∞Âõû‰º†Áªô ManagerÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960/// ÂÆåÊàêÂõûË∞É- (void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)task didCompleteWithError:(NSError *)error &#123; // If we already cancel the operation or anything mark the operation finished, don't callback twice if (self.isFinished) return; @synchronized(self) &#123; self.dataTask = nil; __block typeof(self) strongSelf = self; dispatch_async(dispatch_get_main_queue(), ^&#123; [[NSNotificationCenter defaultCenter] postNotificationName:SDWebImageDownloadStopNotification object:strongSelf]; if (!error) &#123; [[NSNotificationCenter defaultCenter] postNotificationName:SDWebImageDownloadFinishNotification object:strongSelf]; &#125; &#125;); &#125; if (error) &#123; /// Â≠òÂú® error ÂõûË∞ÉÊäõÂá∫ÂºÇÂ∏∏ if (self.responseError) &#123; error = self.responseError; &#125; [self callCompletionBlocksWithError:error]; [self done]; &#125; else &#123; /// Ë∞ÉÁî®ÊàêÂäüÂõûË∞É if ([self callbacksForKey:kCompletedCallbackKey].count &gt; 0) &#123; NSData *imageData = [self.imageData copy]; self.imageData = nil; if (imageData) &#123; /// Â¶ÇÊûú options ÊòØÊó†ËßÜÁºìÂ≠òÁöÑ response ÁöÑÔºåÂπ∂‰∏î‰∏ãËΩΩ‰∏ãÊù•ÁöÑ image Âíå URLCache ‰∏ÄËá¥ if (self.options &amp; SDWebImageDownloaderIgnoreCachedResponse &amp;&amp; [self.cachedData isEqualToData:imageData]) &#123; /// ÊäõÂá∫ÂºÇÂ∏∏ÔºåË°®Á§∫Ê≤°ÊúâÊîπÂèòÊàñ self.responseError = [NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorCacheNotModified userInfo:nil]; // call completion block with not modified error [self callCompletionBlocksWithError:self.responseError]; [self done]; &#125; else &#123; dispatch_async(self.coderQueue, ^&#123; @autoreleasepool &#123; /// Âú® coderQueue ‰∏≠Ëß£Á†Å UIImage *image = SDImageLoaderDecodeImageData(imageData, self.request.URL, [[self class] imageOptionsFromDownloaderOptions:self.options], self.context); CGSize imageSize = image.size; if (imageSize.width == 0 || imageSize.height == 0) &#123; [self callCompletionBlocksWithError:[NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorBadImageData userInfo:@&#123;NSLocalizedDescriptionKey : @"Downloaded image has 0 pixels"&#125;]]; &#125; else &#123; [self callCompletionBlocksWithImage:image imageData:imageData error:nil finished:YES]; &#125; [self done]; &#125; &#125;); &#125; &#125; else &#123; [self callCompletionBlocksWithError:[NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorBadImageData userInfo:@&#123;NSLocalizedDescriptionKey : @"Image data is nil"&#125;]]; [self done]; &#125; &#125; else &#123; [self done]; &#125; &#125;&#125; Ëá≥Ê≠§Ôºå‰∏ãËΩΩÈÉ®ÂàÜÂ∞±ÁªìÊùü‰∫Ü ÊÄªÁªìÊÄªÁöÑÊù•ËØ¥Â∞±ÊòØÈÄöËøá SDWebImageDownloader Ëøô‰∏™Âçï‰æãÂØπË±°‰∏∫ÊØè‰∏™ËØ∑Ê±ÇÂàõÂª∫‰∏Ä‰∏™ SDWebImageDownloadToken ÂÆû‰æãÊù•ÁÆ°ÁêÜ‰∏ãËΩΩ„ÄÇÂêåÊó∂ SDWebImageDownloader ‰πü‰ºö‰øùÂ≠òÊØè‰∏Ä‰∏™‰∏ãËΩΩ‰ªªÂä°‰ª•‰æõÂèñÊ∂à„ÄÇSDWebImageDownloadToken ‰∏≠ÂèàÂåÖÂê´ SWDweImageDownloaderOperation Ëøô‰∏™ NSOperation ÁöÑÂ≠êÁ±ªÔºåÁî®‰∫éÁúüÊ≠£ÁöÑ‰∏ãËΩΩ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SDWebImage Ê∫êÁ†ÅËß£Êûê‚ÄîÁºìÂ≠òÁ≠ñÁï•]]></title>
    <url>%2F2018%2F03%2F03%2FSDWebImage2%2F</url>
    <content type="text"><![CDATA[‰∏ä‰∏ÄÁØáËØ¥‰∫ÜÊï¥‰ΩìÁöÑ Manager ÊâÄÂÅöÁöÑ‰∫ãÊÉÖ„ÄÇÁé∞Âú®Êù•ÊúâÈíàÂØπÊÄßÁöÑÁúãÁúãÁºìÂ≠òÁ≠ñÁï•ÊòØÊÄéÊ†∑ÁöÑ SDImageCacheËØ¥Âà∞ÁºìÂ≠òÔºå‰∏ÄËà¨ÈÉΩ‰ºöÊÉ≥Âà∞‰∏§Á∫ßÁºìÂ≠òÔºöÂÜÖÂ≠òÁºìÂ≠òÂíåÁ£ÅÁõòÁºìÂ≠ò„ÄÇSDWebImage ‰πü‰∏ç‰æãÂ§ñÔºåÊàë‰ª¨ÂÖàÂºÄÁúã‰∏Ä‰∏ãÂàùÂßãÂåñÊñπÊ≥ïÔºö ÂàùÂßãÂåñÊñπÊ≥ïSDImageCache ÊòØ‰∏Ä‰∏™Âçï‰æãÂØπË±°„ÄÇÂÆÉÁöÑÂàùÂßãÂåñÊñπÊ≥ï‰∏≠‰ºöÂàõÂª∫Á£ÅÁõòÁºìÂ≠òÂØπË±° _diskCacheÔºåÂíåÂÜÖÂ≠òÁºìÂ≠òÂØπË±° _memoryCacheÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758+ (nonnull instancetype)sharedImageCache &#123; static dispatch_once_t once; static id instance; dispatch_once(&amp;once, ^&#123; instance = [self new]; &#125;); return instance;&#125;- (nonnull instancetype)initWithNamespace:(nonnull NSString *)ns diskCacheDirectory:(nullable NSString *)directory config:(nullable SDImageCacheConfig *)config &#123; if ((self = [super init])) &#123; NSAssert(ns, @"Cache namespace should not be nil"); // Create IO serial queue _ioQueue = dispatch_queue_create("com.hackemist.SDImageCache", DISPATCH_QUEUE_SERIAL); if (!config) &#123; config = SDImageCacheConfig.defaultCacheConfig; &#125; _config = [config copy]; // Init the memory cache NSAssert([config.memoryCacheClass conformsToProtocol:@protocol(SDMemoryCache)], @"Custom memory cache class must conform to `SDMemoryCache` protocol"); /// ÂàõÂª∫ memoryCache _memoryCache = [[config.memoryCacheClass alloc] initWithConfig:_config]; // Init the disk cache /// ËÆæÁΩÆÁºìÂ≠òÁõÆÂΩï if (directory != nil) &#123; _diskCachePath = [directory stringByAppendingPathComponent:ns]; &#125; else &#123; NSString *path = [[[self userCacheDirectory] stringByAppendingPathComponent:@"com.hackemist.SDImageCache"] stringByAppendingPathComponent:ns]; _diskCachePath = path; &#125; NSAssert([config.diskCacheClass conformsToProtocol:@protocol(SDDiskCache)], @"Custom disk cache class must conform to `SDDiskCache` protocol"); /// ÂàõÂª∫ diskCache ÂÆû‰æã _diskCache = [[config.diskCacheClass alloc] initWithCachePath:_diskCachePath config:_config]; // Check and migrate disk cache directory if need [self migrateDiskCacheDirectory]; // Subscribe to app events [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(applicationWillTerminate:) name:UIApplicationWillTerminateNotification object:nil]; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(applicationDidEnterBackground:) name:UIApplicationDidEnterBackgroundNotification object:nil]; &#125; return self;&#125; ÂèØ‰ª•ÁúãÂà∞Ôºå‰∏§‰∏™ÁºìÂ≠òÁöÑÁ±ªÂûãÈÉΩÊòØÈÄöËøá config Ëé∑ÂèñÁöÑ„ÄÇconfig ÈªòËÆ§ÁöÑÁ±ªÂûã‰∏∫ SDMemoryCache Âíå SDDiskCache„ÄÇ SDMemoryCache ÂàùÂßãÂåñSDMemoryCache ÂàùÂßãÂåñÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920- (void)commonInit &#123; SDImageCacheConfig *config = self.config; /// ÁºìÂ≠òÂÜÖÂ≠òÁºìÂ≠òÁöÑÊúÄÂ§ßÂÄº self.totalCostLimit = config.maxMemoryCost; /// ÂÜÖÂ≠òÁºìÂ≠òÊï∞Èáè‰∏äÁöÑÊúÄÂ§ßÂÄº self.countLimit = config.maxMemoryCount; /// ÂØπ config ÁöÑ maxMemoryCost Âíå maxMenoryCount ÂÅöÁõëÂê¨Â¶ÇÊûúÂèòÂåñ‰∫ÜÔºåÁ´ãÂàªÂèòÂåñÂÜÖÂ≠òÁºìÂ≠òÁöÑÁõ∏Â∫îÂÄº [config addObserver:self forKeyPath:NSStringFromSelector(@selector(maxMemoryCost)) options:0 context:SDMemoryCacheContext]; [config addObserver:self forKeyPath:NSStringFromSelector(@selector(maxMemoryCount)) options:0 context:SDMemoryCacheContext]; /// Êñ∞Âª∫‰∏Ä‰∏™Âº±ÂºïÁî®Â≠óÂÖ∏ self.weakCache = [[NSMapTable alloc] initWithKeyOptions:NSPointerFunctionsStrongMemory valueOptions:NSPointerFunctionsWeakMemory capacity:0]; self.weakCacheLock = dispatch_semaphore_create(1); [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(didReceiveMemoryWarning:) name:UIApplicationDidReceiveMemoryWarningNotification object:nil];&#125; ‰∏ªË¶ÅËÆæÁΩÆ‰∫ÜÁºìÂ≠òÁöÑÊúÄÂ§ßÂÄºÂíåÊúÄÂ§ßÊï∞Èáè„ÄÇÂè¶Â§ñ weakCache ÊòØ‰∏Ä‰∏™‰ª§‰∫∫Ê≥®ÊÑèÁöÑÂú∞Êñπ„ÄÇÂÆÉÊòØ‰∏Ä‰∏™ NSMapTableÔºåÂÆÉÁöÑ‰ΩúÁî®‰ºöÂú®ÂêéÁª≠‰ΩøÁî®ÁöÑÊó∂ÂÄôÊè≠Êôì„ÄÇ Âè¶Â§ñÔºåtotalCostLimit Âíå countLimit ÊòØ NSCache ÁöÑ‰∏§‰∏™Â±ûÊÄß„ÄÇSDMemoryCache ÊòØ NSCache ÁöÑÂ≠êÁ±ª„ÄÇ SDDiskCache ÂàùÂßãÂåñSDDiskCache ÁöÑÂàùÂßãÂåñÊñπÊ≥ïÂ∞±ÁÆÄÂçï‰∫ÜÂæàÂ§ö„ÄÇÂ∞±ÊòØËé∑Âèñ‰∏Ä‰∏™ NSFileManager 1234567- (void)commonInit &#123; if (self.config.fileManager) &#123; self.fileManager = self.config.fileManager; &#125; else &#123; self.fileManager = [NSFileManager new]; &#125;&#125; ÂÖ•Âè£ÊñπÊ≥ïÂâçÁØáËØ¥Âà∞ÔºåManager ‰ºöÈÄöËøá SDImageCache ÂÆû‰æãÔºåÂàõÂª∫‰∏Ä‰∏™ÁºìÂ≠òÁöÑ operationÔºö 12345678910111213/// ËøõË°åÁºìÂ≠òÁõ∏ÂÖ≥Êìç‰ΩúÔºåÊääËøîÂõûÁöÑ Operation ËÆæÁΩÆÁªô CacheOperationoperation.cacheOperation = [self.imageCache queryImageForKey:key options:options context:context completion:^(UIImage * _Nullable cachedImage, NSData * _Nullable cachedData, SDImageCacheType cacheType) &#123; @strongify(operation); /// Â¶ÇÊûúÊâßË°åËøáÁ®ã‰∏≠Êìç‰ΩúÂèñÊ∂àÔºåÂÆâÂÖ®ÁßªÈô§Êìç‰Ωú if (!operation || operation.isCancelled) &#123; // Image combined operation cancelled by user [self callCompletionBlockForOperation:operation completion:completedBlock error:[NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorCancelled userInfo:nil] url:url]; [self safelyRemoveOperationFromRunning:operation]; return; &#125; /// ÂâçÈù¢ÊãøÂ•Ω‰∫ÜÁºìÂ≠òÔºåÁé∞Âú®Â∞±Ë¶ÅÂºÄÂßã‰∏ãËΩΩ [self callDownloadProcessForOperation:operation url:url options:options context:context cachedImage:cachedImage cachedData:cachedData cacheType:cacheType progress:progressBlock completed:completedBlock];&#125;]; Áé∞Âú®Êù•Âà∞ÂÖ∑‰ΩìÊñπÊ≥ï‰∏≠Ôºö 12345678910111213141516171819- (id&lt;SDWebImageOperation&gt;)queryImageForKey:(NSString *)key options:(SDWebImageOptions)options context:(nullable SDWebImageContext *)context completion:(nullable SDImageCacheQueryCompletionBlock)completionBlock &#123; SDImageCacheOptions cacheOptions = 0; /// ËÆæÁΩÆ options ÈÄâÈ°π if (options &amp; SDWebImageQueryMemoryData) cacheOptions |= SDImageCacheQueryMemoryData; /// ‰ªéÂÜÖÂ≠ò‰∏≠ÂêåÊ≠•Êü•Êâæ if (options &amp; SDWebImageQueryMemoryDataSync) cacheOptions |= SDImageCacheQueryMemoryDataSync; /// ÂÜÖÂ≠ò‰∏çÂ≠òÂú®Êó∂Ôºå‰ªéÁ£ÅÁõòÂêåÊ≠•Êü•Êâæ if (options &amp; SDWebImageQueryDiskDataSync) cacheOptions |= SDImageCacheQueryDiskDataSync; /// Â∞ÜÂ§ßÂõæÂéãÁº©Âà∞ÈÄÇÂΩìÂ§ßÂ∞è if (options &amp; SDWebImageScaleDownLargeImages) cacheOptions |= SDImageCacheScaleDownLargeImages; /// Á¶ÅÊ≠¢‰∏ãËΩΩÂÆåÂ∞±Â∞ÜÂõæÁâáËß£Á†ÅÔºàÁ´ãÂç≥Ëß£Á†ÅÂèØËÉΩ‰ºöÂØºËá¥ÂÜÖÂ≠ò‰ΩøÁî®ÂèòÂ§ßÔºâ if (options &amp; SDWebImageAvoidDecodeImage) cacheOptions |= SDImageCacheAvoidDecodeImage; /// Âä®ÂõæÂè™Ëß£Á†ÅÁ¨¨‰∏ÄÂ∏ßÔºàÂê¶Âàô‰ºöÂÖ®ÈÉ®Ëß£Á†ÅÔºâ if (options &amp; SDWebImageDecodeFirstFrameOnly) cacheOptions |= SDImageCacheDecodeFirstFrameOnly; /// Âä®ÂõæÊèêÂâçÂáÜÂ§áÂ•ΩÊâÄÊúâÂ∏ßÔºàÈôç‰ΩéÂ§öÂ§Ñ‰ΩøÁî®Âêå‰∏ÄÂä®ÂõæÁöÑ CPU Âä†ËΩΩÊ∂àËÄóÔºâ if (options &amp; SDWebImagePreloadAllFrames) cacheOptions |= SDImageCachePreloadAllFrames; return [self queryCacheOperationForKey:key options:cacheOptions context:context done:completionBlock];&#125; ËøôÈáåÂØπ‰∫éÂ§ñÈÉ®‰º†Êù•ÁöÑ options ÂÅö‰∫Ü‰∏Ä‰∫õÂ§ÑÁêÜ„ÄÇÁÑ∂Âêé‰º†ÂÖ•ÂÜÖÈÉ®ÁöÑÂ§ÑÁêÜÊñπÊ≥ï„ÄÇ ÂÜÖÈÉ®ÊñπÊ≥ïÂÜÖÈÉ®ÊñπÊ≥ïÂàÜ‰∏∫‰∏§ÈÉ®ÂàÜÔºå‰ªé Memory ‰∏≠Êü•ÊâæÁºìÂ≠ò‰ª•Âèä‰ªé Disk ‰∏≠Êü•ÊâæÁºìÂ≠ò„ÄÇÊñπÊ≥ïÂæàÈïøÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104- (nullable NSOperation *)queryCacheOperationForKey:(nullable NSString *)key options:(SDImageCacheOptions)options context:(nullable SDWebImageContext *)context done:(nullable SDImageCacheQueryCompletionBlock)doneBlock &#123; if (!key) &#123; if (doneBlock) &#123; doneBlock(nil, nil, SDImageCacheTypeNone); &#125; return nil; &#125; /// Ëé∑ÂèñËá™ÂÆö‰πâÁöÑ transformer id&lt;SDImageTransformer&gt; transformer = context[SDWebImageContextImageTransformer]; if (transformer) &#123; /// Â∞ÜËá™ÂÆö‰πâÁöÑ transformer ÁöÑ key ÊãºÊé•Âà∞ÂéüÊù•ÁöÑ key ‰∏ä NSString *transformerKey = [transformer transformerKey]; key = SDTransformedKeyForKey(key, transformerKey); &#125; // First check the in-memory cache... /// ‰ªéÂÜÖÂ≠òËé∑Âèñimage UIImage *image = [self imageFromMemoryCacheForKey:key]; if (image) &#123; /// Âè™Ëß£Á†ÅÁ¨¨‰∏ÄÂ∏ß if (options &amp; SDImageCacheDecodeFirstFrameOnly) &#123; // Ensure static image Class animatedImageClass = image.class; if (image.sd_isAnimated || ([animatedImageClass isSubclassOfClass:[UIImage class]] &amp;&amp; [animatedImageClass conformsToProtocol:@protocol(SDAnimatedImage)])) &#123; image = [[UIImage alloc] initWithCGImage:image.CGImage scale:image.scale orientation:image.imageOrientation]; &#125; &#125; else if (options &amp; SDImageCacheMatchAnimatedImageClass) &#123; // Check image class matching Class animatedImageClass = image.class; Class desiredImageClass = context[SDWebImageContextAnimatedImageClass]; if (desiredImageClass &amp;&amp; ![animatedImageClass isSubclassOfClass:desiredImageClass]) &#123; image = nil; &#125; &#125; &#125; /// Âè™ËÉΩ‰ªé Memory ‰∏≠ËØªÂèñ BOOL shouldQueryMemoryOnly = (image &amp;&amp; !(options &amp; SDImageCacheQueryMemoryData)); if (shouldQueryMemoryOnly) &#123; if (doneBlock) &#123; doneBlock(image, nil, SDImageCacheTypeMemory); &#125; return nil; &#125; NSOperation *operation = [NSOperation new]; /// Â¶ÇÊûúÂÜÖÂ≠ò‰∏≠Â≠òÂú®ÂõæÁâáÔºåÂπ∂‰∏îÈúÄË¶ÅÂêåÊ≠•Ëé∑ÂèñÔºåÊàñËÄÖÂÜÖÂ≠ò‰∏≠‰∏çÂ≠òÂú®ÂõæÁâáÔºåÂπ∂‰∏îÈúÄË¶ÅÂêåÊ≠•‰ªéÁ£ÅÁõòËé∑Âèñ BOOL shouldQueryDiskSync = ((image &amp;&amp; options &amp; SDImageCacheQueryMemoryDataSync) || (!image &amp;&amp; options &amp; SDImageCacheQueryDiskDataSync)); /// Êü•ÊâæÁºìÂ≠òÁöÑ block void(^queryDiskBlock)(void) = ^&#123; /// Â¶ÇÊûúÊòØÂ∑≤ÁªèÂèñÊ∂à‰∫ÜÔºåÈÇ£‰πàÁõ¥Êé•ÊâßË°åÂÆåÊàêÂõûË∞É if (operation.isCancelled) &#123; if (doneBlock) &#123; doneBlock(nil, nil, SDImageCacheTypeNone); &#125; return; &#125; @autoreleasepool &#123; /// ‰ªéÁ£ÅÁõòËØªÂèñdata NSData *diskData = [self diskImageDataBySearchingAllPathsForKey:key]; UIImage *diskImage; SDImageCacheType cacheType = SDImageCacheTypeNone; if (image) &#123; /// Â¶ÇÊûúÊúâ imageÔºåËØ¥Êòé‰ªé Memory ‰∏≠qËØªÂèñÁöÑ„ÄÇËÆæÁΩÆÂÆÉÁöÑÁ±ªÂûã diskImage = image; cacheType = SDImageCacheTypeMemory; &#125; else if (diskData) &#123; /// Â¶ÇÊûúÊúâ diskDataÔºåËØ¥ÊòéÊòØ‰ªé disk ‰∏≠ËØªÂèñÁöÑ„ÄÇËÆæÁΩÆÂÆÉÁöÑÁ±ªÂûã‰∏∫Á£ÅÁõòÁ±ªÂûã cacheType = SDImageCacheTypeDisk; /// ËøòÈúÄË¶ÅÂ∞ÜdataËΩ¨‰∏∫image diskImage = [self diskImageForKey:key data:diskData options:options context:context]; /// Â¶ÇÊûúÈÖçÁΩÆ‰∏∫ÈúÄË¶ÅÁºìÂ≠òÂà∞ÂÜÖÂ≠ò‰∏≠„ÄÇÈÇ£‰πàÂ∞±Â∞ÜÁ£ÅÁõò‰∏≠ËØªÂèñÁöÑ Image Â≠òÂà∞ÂÜÖÂ≠ò‰∏≠ if (diskImage &amp;&amp; self.config.shouldCacheImagesInMemory) &#123; NSUInteger cost = diskImage.sd_memoryCost; [self.memoryCache setObject:diskImage forKey:key cost:cost]; &#125; &#125; if (doneBlock) &#123; /// ÊòØÂê¶ÊòØÂêåÊ≠•ÊñπÊ≥ï if (shouldQueryDiskSync) &#123; doneBlock(diskImage, diskData, cacheType); &#125; else &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; doneBlock(diskImage, diskData, cacheType); &#125;); &#125; &#125; &#125; &#125;; /// isQueue ÊòØ‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàó„ÄÇÊ†πÊçÆ shouldQueryDiskSync Âà§Êñ≠ÊòØÂê¶ÂêåÊ≠•ÊâßË°å if (shouldQueryDiskSync) &#123; dispatch_sync(self.ioQueue, queryDiskBlock); &#125; else &#123; dispatch_async(self.ioQueue, queryDiskBlock); &#125; return operation;&#125; ÂÜÖÂ≠òÊü•Êâæ imageÂÜÖÂ≠òÊü•ÊâæÊñπÊ≥ïÁõ¥Êé•‰ªéÂâçÈù¢ÂàõÂª∫ÁöÑ SDMemoryCache ÂØπË±° memoryCache ÂØπË±°‰∏≠Ëé∑ÂèñÔºö 123- (nullable UIImage *)imageFromMemoryCacheForKey:(nullable NSString *)key &#123; return [self.memoryCache objectForKey:key];&#125; SDMemoryCache Êú¨Ë∫´ÁªßÊâø‰∫é NSCacheÔºåÂÆÉÊúâ‰∏ÄÂ•óÁ≥ªÁªüÁöÑÁºìÂ≠òÊñπÂºèÔºå‰ºöËá™Âä®Âú®Êüê‰∏™Êó∂ÂàªËøõË°åÂÜÖÂ≠òÁöÑÈáäÊîæ„ÄÇ‰∏çËøá SDWebImage ÈáçÂÜô‰∫Ü objectForKey ÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627- (id)objectForKey:(id)key &#123; /// NSCache ÁöÑ objectforkey ÊñπÊ≥ï id obj = [super objectForKey:key]; /// Â¶ÇÊûú config ËÆæÁΩÆ‰∏çËÉΩËá™Â∑±ÁºìÂ≠òÂàôÁõ¥Êé•ËøîÂõû NSCache ÁöÑÁºìÂ≠òÂØπË±° if (!self.config.shouldUseWeakMemoryCache) &#123; return obj; &#125; /// Â¶ÇÊûú NSCache ‰∏≠Ê≤°ÊúâÊâæÂà∞ÁºìÂ≠ò if (key &amp;&amp; !obj) &#123; // Check weak cache SD_LOCK(self.weakCacheLock); /// ‰ªéËá™Â∑±ÁöÑNSMapTable ‰∏≠ÊêúÁ¥¢ obj = [self.weakCache objectForKey:key]; SD_UNLOCK(self.weakCacheLock); /// Â¶ÇÊûú‰ªé NSMapTable ‰∏≠ÊâæÂà∞‰∫Ü if (obj) &#123; /// ËÆæÁΩÆÁºìÂ≠òÂ§ßÂ∞è NSUInteger cost = 0; if ([obj isKindOfClass:[UIImage class]]) &#123; cost = [(UIImage *)obj sd_memoryCost]; &#125; /// Êää‰ªé NSMapTable ‰∏≠ÊâæÂà∞ÁöÑÂØπË±°ÂÜçËÆæÁΩÆÂõû NSCache [super setObject:obj forKey:key cost:cost]; &#125; &#125; return obj;&#125; ËøôÈáåÂ∞±Áî®Âà∞‰∫Ü‰∏äÈù¢ SDMemoryCache ÂàùÂßãÂåñÁöÑ NSMapTable ‰∫Ü„ÄÇÈÇ£‰πàÂÆÉÁöÑ‰ΩúÁî®ÊòØ‰ªÄ‰πàÂë¢ÔºüÁî±‰∫é NSCache ÊòØÁ≥ªÁªüÁª¥Êä§ÂõûÊî∂Áä∂ÊÄÅÁöÑÁºìÂ≠òÔºåÂèØËÉΩÂú®‰ªª‰ΩïÊó∂ÂÄôÂõûÊî∂„ÄÇÈÇ£‰πàÂ∞±ÂèØËÉΩÂá∫Áé∞ image ËøòÂ≠òÂú®Ôºå‰ΩÜÊòØÂ∑≤ÁªèË¢´ NSCache ÂõûÊî∂ÁöÑÊÉÖÂÜµÔºåÂÆπÊòì‰∫ßÁîüÂõ†‰∏∫ÂÜÖÂ≠òÁ¥ßÂº†È¢ëÁπÅÈáäÊîæÂÜÖÂ≠òÂØºËá¥È¢ëÁπÅ‰ªéÁ£ÅÁõòÂä†ËΩΩÂõæÁâáÁöÑÊÉÖÂÜµ„ÄÇ Âõ†Ê≠§ÔºåÂú® NSCache Êú¨Ë∫´ÁöÑÁºìÂ≠òÂõûÊî∂Êú∫Âà∂‰∏ãÔºåÂÜçËÆæÁΩÆ‰∏Ä‰∏™Âº±ÂºïÁî®ÁöÑÂ≠óÂÖ∏„ÄÇÂÆÉÂπ∂‰∏çÂΩ±ÂìçÁºìÂ≠òÁöÑÂºïÁî®ËÆ°Êï∞„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú image Ê≤°ÊúâË¢´ÂõûÊî∂ÔºåÈÇ£‰πà‰πü‰∏ç‰ºöÂÉè NSCache ‰∏ÄÊ†∑ÂèØËÉΩË¢´ÂõûÊî∂„ÄÇ Á±ª‰ººÁöÑÔºåÂú®Êää image ‰∏¢Âà∞ SDMemoryCache ‰∏≠ÁöÑÊó∂ÂÄôÈúÄË¶ÅËÆæÁΩÆÂà∞ NSMapTable ‰∏≠Ôºö 12345678910111213- (void)setObject:(id)obj forKey:(id)key cost:(NSUInteger)g &#123; [super setObject:obj forKey:key cost:g]; if (!self.config.shouldUseWeakMemoryCache) &#123; return; &#125; /// ‰∏§Â•óÊñπÊ°àÔºå‰∏ÄÂ•ó NSCache ÁöÑÁºìÂ≠òÔºåyÂÜçÈÄöËøáÂº±ÂºïÁî®‰∏ÄÂ•ó„ÄÇ if (key &amp;&amp; obj) &#123; // Store weak cache SD_LOCK(self.weakCacheLock); [self.weakCache setObject:obj forKey:key]; SD_UNLOCK(self.weakCacheLock); &#125;&#125; Disk ‰∏≠Êü•Êâæ image123456789101112131415161718192021- (nullable NSData *)diskImageDataBySearchingAllPathsForKey:(nullable NSString *)key &#123; if (!key) &#123; return nil; &#125; /// ‰ªéÁ£ÅÁõò‰∏≠ËØªÂèñ Data NSData *data = [self.diskCache dataForKey:key]; if (data) &#123; return data; &#125; /// ‰ªéËá™ÂÆö‰πâÁöÑ key ‚Üí path block ‰∏≠Ëé∑ÂèñÊñá‰ª∂Ë∑ØÂæÑËØªÂèñË∑ØÂæÑ if (self.additionalCachePathBlock) &#123; NSString *filePath = self.additionalCachePathBlock(key); if (filePath) &#123; data = [NSData dataWithContentsOfFile:filePath options:self.config.diskCacheReadingOptions error:nil]; &#125; &#125; return data;&#125; SDDiskCache ‰∏≠ÁöÑÊü•ÊâæÊñπÊ≥ï„ÄÇËøôÊòØ‰∏Ä‰∏™ÊØîËæÉÁÆÄÂçïÊòéÁ°ÆÁöÑÊñπÊ≥ïÔºö 123456789101112131415161718- (NSData *)dataForKey:(NSString *)key &#123; NSParameterAssert(key); /// ÊãøÂà∞ disk ÁºìÂ≠òÁöÑË∑ØÂæÑ NSString *filePath = [self cachePathForKey:key]; /// Âà∞Ëøô‰∏™Ë∑ØÂæÑ‰∏äÊâæÁõ∏Â∫îÁöÑ data NSData *data = [NSData dataWithContentsOfFile:filePath options:self.config.diskCacheReadingOptions error:nil]; /// Ëé∑ÂèñÂà∞‰∫Ü data ËØ¥ÊòéÂ≠òÊâç cacheÔºåÁõ¥Êé•ËøîÂõû if (data) &#123; return data; &#125; data = [NSData dataWithContentsOfFile:filePath.stringByDeletingPathExtension options:self.config.diskCacheReadingOptions error:nil]; if (data) &#123; return data; &#125; return nil;&#125; Disk ‰∏≠ÁöÑ NSData ËΩ¨ UIImage‰ªé Disk ‰∏≠ÊãøÂà∞ÁöÑÊòØ NSData ÂØπË±°„ÄÇÊàë‰ª¨ÈúÄË¶ÅÊääÂÆÉËΩ¨‰∏∫ UIImageÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071- (nullable UIImage *)diskImageForKey:(nullable NSString *)key data:(nullable NSData *)data options:(SDImageCacheOptions)options context:(SDWebImageContext *)context &#123; if (data) &#123; /// NSData ËΩ¨ UIImage UIImage *image = SDImageCacheDecodeImageData(data, key, [[self class] imageOptionsFromCacheOptions:options], context); return image; &#125; else &#123; return nil; &#125;&#125;UIImage * _Nullable SDImageCacheDecodeImageData(NSData * _Nonnull imageData, NSString * _Nonnull cacheKey, SDWebImageOptions options, SDWebImageContext * _Nullable context) &#123; UIImage *image; /// Âà§Êñ≠ÊòØÂê¶Âè™Ë¶ÅËß£Á†ÅÁ¨¨‰∏ÄÂ∏ß BOOL decodeFirstFrame = SD_OPTIONS_CONTAINS(options, SDWebImageDecodeFirstFrameOnly); NSNumber *scaleValue = context[SDWebImageContextImageScaleFactor]; /// Ëé∑ÂèñËß£Á†ÅÁöÑ scale CGFloat scale = scaleValue.doubleValue &gt;= 1 ? scaleValue.doubleValue : SDImageScaleFactorForKey(cacheKey); SDImageCoderOptions *coderOptions = @&#123;SDImageCoderDecodeFirstFrameOnly : @(decodeFirstFrame), SDImageCoderDecodeScaleFactor : @(scale)&#125;; if (context) &#123; SDImageCoderMutableOptions *mutableCoderOptions = [coderOptions mutableCopy]; [mutableCoderOptions setValue:context forKey:SDImageCoderWebImageContext]; coderOptions = [mutableCoderOptions copy]; &#125; /// Â¶ÇÊûú‰∏ç‰ªÖ‰ªÖËß£Á†ÅÁ¨¨‰∏ÄÂ∏ßÔºåÂàô‰ªé context ‰∏≠ÂèñÂá∫ AnimatedImageClassÔºåÈªòËÆ§‰ΩøÁî®ÁöÑÊòØ SDAnimatedImageÔºåÁÑ∂ÂêéËøõË°åÂõæÁâáÊï∞ÊçÆÁöÑËß£Á†ÅÔºåÊ†πÊçÆÈúÄË¶ÅËøòÂèØ‰ª•È¢ÑËß£Á†ÅÊâÄÊúâÂ∏ß if (!decodeFirstFrame) &#123; Class animatedImageClass = context[SDWebImageContextAnimatedImageClass]; // check whether we should use `SDAnimatedImage` if ([animatedImageClass isSubclassOfClass:[UIImage class]] &amp;&amp; [animatedImageClass conformsToProtocol:@protocol(SDAnimatedImage)]) &#123; image = [[animatedImageClass alloc] initWithData:imageData scale:scale options:coderOptions]; if (image) &#123; // Preload frames if supported if (options &amp; SDWebImagePreloadAllFrames &amp;&amp; [image respondsToSelector:@selector(preloadAllFrames)]) &#123; [((id&lt;SDAnimatedImage&gt;)image) preloadAllFrames]; &#125; &#125; else &#123; // Check image class matching if (options &amp; SDWebImageMatchAnimatedImageClass) &#123; return nil; &#125; &#125; &#125; &#125; if (!image) &#123; /// Ëß£Á†ÅÂá∫ UIImage image = [[SDImageCodersManager sharedManager] decodedImageWithData:imageData options:coderOptions]; &#125; if (image) &#123; /// Êü•ÁúãÊòØÂê¶ÈúÄË¶ÅËß£Á†Å BOOL shouldDecode = !SD_OPTIONS_CONTAINS(options, SDWebImageAvoidDecodeImage); if ([image.class conformsToProtocol:@protocol(SDAnimatedImage)]) &#123; // `SDAnimatedImage` do not decode /// Âä®Âõæ‰∏çÈúÄË¶ÅËß£Á†Å shouldDecode = NO; &#125; else if (image.sd_isAnimated) &#123; // animated image do not decode shouldDecode = NO; &#125; /// ÈúÄË¶ÅËß£Á†ÅÂ∞±ÂºÄÂßãËß£Á†Å if (shouldDecode) &#123; BOOL shouldScaleDown = SD_OPTIONS_CONTAINS(options, SDWebImageScaleDownLargeImages); if (shouldScaleDown) &#123; image = [SDImageCoderHelper decodedAndScaledDownImageWithImage:image limitBytes:0]; &#125; else &#123; image = [SDImageCoderHelper decodedImageWithImage:image]; &#125; &#125; &#125; return image;&#125; ÂÖ∑‰ΩìËß£Á†ÅÁõ∏ÂÖ≥ÈîÆÂêéÁª≠ÊñáÁ´†„ÄÇ ËøîÂõû NSOperationÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÂÜÖÈÉ®ÊñπÊ≥ï‰∏≠ÈÄöËøá NSOperation *operation = [NSOperation new]; ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ NSOperation ÂÆû‰æãÔºåÁÑ∂ÂêéÂ∞±Áõ¥Êé•ËøîÂõû‰∫Ü„ÄÇÊ≤°ÊúâÂØπËøô‰∏™ NSOperation ÂÅö‰ªª‰ΩïÂÖ∂‰ªñÁöÑÂ§ÑÁêÜ„ÄÇÂîØ‰∏Ä‰ΩøÁî®Âà∞ÁöÑÂú∞ÊñπÂ∞±ÊòØÂú® Disk Êü•ËØ¢ÁöÑÊó∂ÂÄôÂà§Êñ≠ÊòØÂê¶Â∑≤ÁªèÂèñÊ∂à„ÄÇÈÇ£‰πà‰∏∫‰ªÄ‰πàË¶ÅËøôÊ†∑ÂÅöÂë¢Ôºü Âõ†‰∏∫Ëé∑ÂèñÁºìÂ≠òÁöÑÊñπÊ≥ï‰∏≠Ë¶ÅÊ†πÊçÆ config ÁöÑ‰∏çÂêåÔºåÂØπÁºìÂ≠òËøõË°åÂêåÊ≠•ÔºåÊàñËÄÖÂºÇÊ≠•ÁöÑËØªÂèñ„ÄÇÂç≥Ë¶ÅËøõË°å dispatch_sync Âíå dispatch_async ÁöÑÂàáÊç¢„ÄÇËøôÁî®‰∏Ä‰∏™ NSOperation ‰∏çÊñπ‰æøÂÆåÊàê„ÄÇ‰ΩÜÊòØÂØπ‰∫éÂ§ñÈÉ®Êù•ËØ¥ÔºåÂ§ñÈÉ®Â∏åÊúõÊúâ‰∏Ä‰∏™Âíå download Áªü‰∏ÄÁöÑËé∑ÂèñÁºìÂ≠òÁöÑ NSOperation ÂÆû‰æãÁî®‰∫éÂèñÊ∂à„ÄÇÂõ†Ê≠§ÔºåÂ∞±Âú®ÂÜÖÈÉ®ÁöÑ GCD ‰∏≠Âä†ÂÖ•‰∫Ü NSOperation ÁöÑ cancelÔºåÊù•Âä®ÊÄÅÂèñÊ∂àÊâßË°å„ÄÇ ‰øùÂ≠òÁõ∏ÂÖ≥ÊñπÊ≥ïÊåâÁêÜËØ¥Ôºå‰øùÂ≠òÂ∫îËØ•ÊîæÂú®‰∏ãËΩΩÊ®°ÂùóÔºå‰∏çËøá SDWebImage ‰∏≠Â∞Ü‰øùÂ≠òÊîæÂú®‰∫Ü Cache Ê®°Âùó‰∏≠„ÄÇÂõ†Ê≠§Ôºå‰πü‰∏ÄËµ∑ËØ¥ÂÆå„ÄÇ Â§ñÈÉ®Ë∞ÉÁî®ÊñπÊ≥ï‰∏ãÈù¢Â∞±ÊòØ Manager ‰∏≠‰ºöË∞ÉÁî®ÁöÑÁºìÂ≠òÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778#pragma mark - ÂõæÁâáÂ≠òÂÇ®- (void)callStoreCacheProcessForOperation:(nonnull SDWebImageCombinedOperation *)operation url:(nonnull NSURL *)url options:(SDWebImageOptions)options context:(SDWebImageContext *)context downloadedImage:(nullable UIImage *)downloadedImage downloadedData:(nullable NSData *)downloadedData finished:(BOOL)finished progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nullable SDInternalCompletionBlock)completedBlock &#123; /// Ëé∑ÂèñÂ≠òÂÇ®Á±ªÂûã,ÈªòËÆ§ÊòØÊó¢Â≠òÂú® Memory ‰∏≠ÂèàÂ≠òÂú® disk ‰∏≠ SDImageCacheType storeCacheType = SDImageCacheTypeAll; if (context[SDWebImageContextStoreCacheType]) &#123; storeCacheType = [context[SDWebImageContextStoreCacheType] integerValue]; &#125; /// Â¶ÇÊûúÂõæÁâáË¢´ transform Ëøá‰∫ÜÔºåÈÇ£‰πàËøô‰∏™ËÆæÁΩÆÊó∂Áî®Êù•ÈíàÂØπÂéüÂßãÂõæÂÉèÁöÑ SDImageCacheType originalStoreCacheType = SDImageCacheTypeNone; if (context[SDWebImageContextOriginalStoreCacheType]) &#123; originalStoreCacheType = [context[SDWebImageContextOriginalStoreCacheType] integerValue]; &#125; /// Ëé∑ÂèñËá™ÂÆö‰πâÁöÑ url ‚Üí string ÁöÑËΩ¨Êç¢Âô® id&lt;SDWebImageCacheKeyFilter&gt; cacheKeyFilter = context[SDWebImageContextCacheKeyFilter]; NSString *key = [self cacheKeyForURL:url cacheKeyFilter:cacheKeyFilter]; /// Ëé∑ÂèñËá™ÂÆö‰πâÁöÑ transformer id&lt;SDImageTransformer&gt; transformer = context[SDWebImageContextImageTransformer]; id&lt;SDWebImageCacheSerializer&gt; cacheSerializer = context[SDWebImageContextCacheSerializer]; /// ÊòØÂê¶Ë¶ÅËΩ¨Êç¢ image ÂèñÂÜ≥‰∫é 1. ÊòØÂê¶‰∏ãËΩΩÂ•Ω‰∫ÜÂõæÁâá 2. ÊòØÂê¶ÊúâËΩ¨ÂåñÂô® 3. Âä®ÂõæÈªòËÆ§‰∏ç‰ºö transformÔºå‰ΩÜÊòØÂ¶ÇÊûúËÆæÁΩÆ‰∫Ü SDWebImageTransformAnimatedImage Ê†áËØÜ‰ΩçÔºåÈÇ£‰πàÂ∞±‰ºöËΩ¨Êç¢ BOOL shouldTransformImage = downloadedImage &amp;&amp; (!downloadedImage.sd_isAnimated || (options &amp; SDWebImageTransformAnimatedImage)) &amp;&amp; transformer; /// ÊòØÂê¶ÈúÄË¶ÅÁºìÂ≠òÂéüÂõæ BOOL shouldCacheOriginal = downloadedImage &amp;&amp; finished; /// Â¶ÇÊûúÈúÄË¶ÅÁºìÂ≠òÂéüÂõæ if (shouldCacheOriginal) &#123; /// Ëé∑ÂèñËΩ¨Êç¢ÂéüÂõæÁöÑ type SDImageCacheType targetStoreCacheType = shouldTransformImage ? originalStoreCacheType : storeCacheType; /// Â¶ÇÊûúÊúâËá™ÂÆö‰πâÁöÑNSDataÂ∫èÂàóÂåñÊñπÂºè if (cacheSerializer &amp;&amp; (targetStoreCacheType == SDImageCacheTypeDisk || targetStoreCacheType == SDImageCacheTypeAll)) &#123; dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^&#123; @autoreleasepool &#123; NSData *cacheData = [cacheSerializer cacheDataWithImage:downloadedImage originalData:downloadedData imageURL:url]; /// ÂÖ∑‰ΩìÁöÑÁºìÂ≠òÊñπÂºè [self.imageCache storeImage:downloadedImage imageData:cacheData forKey:key cacheType:targetStoreCacheType completion:nil]; &#125; &#125;); /// Ê≤°ÊúâËá™ÂÆö‰πâÁöÑÂ∫èÂàóÂåñÊñπÊ≥ïÔºåÁõ¥Êé•Â≠òÂÇ®ÂõæÁâá &#125; else &#123; [self.imageCache storeImage:downloadedImage imageData:downloadedData forKey:key cacheType:targetStoreCacheType completion:nil]; &#125; &#125; /// Â¶ÇÊûúÈúÄË¶ÅÂØπÂéüÂõæËøõË°å transform if (shouldTransformImage) &#123; dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^&#123; @autoreleasepool &#123; /// transform ÂéüÂõæ UIImage *transformedImage = [transformer transformedImageWithImage:downloadedImage forKey:key]; if (transformedImage &amp;&amp; finished) &#123; NSString *transformerKey = [transformer transformerKey]; NSString *cacheKey = SDTransformedKeyForKey(key, transformerKey); BOOL imageWasTransformed = ![transformedImage isEqual:downloadedImage]; NSData *cacheData; // pass nil if the image was transformed, so we can recalculate the data from the image if (cacheSerializer &amp;&amp; (storeCacheType == SDImageCacheTypeDisk || storeCacheType == SDImageCacheTypeAll)) &#123; cacheData = [cacheSerializer cacheDataWithImage:transformedImage originalData:(imageWasTransformed ? nil : downloadedData) imageURL:url]; &#125; else &#123; cacheData = (imageWasTransformed ? nil : downloadedData); &#125; /// ÂÖ∑‰ΩìÁöÑÁºìÂ≠òÊñπÂºè [self.imageCache storeImage:transformedImage imageData:cacheData forKey:cacheKey cacheType:storeCacheType completion:nil]; &#125; [self callCompletionBlockForOperation:operation completion:completedBlock image:transformedImage data:downloadedData error:nil cacheType:SDImageCacheTypeNone finished:finished url:url]; &#125; &#125;); &#125; else &#123; [self callCompletionBlockForOperation:operation completion:completedBlock image:downloadedImage data:downloadedData error:nil cacheType:SDImageCacheTypeNone finished:finished url:url]; &#125;&#125; ‰ª£Á†ÅÊúâÁÇπÈïøÔºå‰∏çËøáÊ≥®ÈáäÂæàÊ∏ÖÊ•ö„ÄÇËøôÈáåÁöÑÈÄªËæë‰∏ªË¶ÅÁî®‰∫éÂ§ÑÁêÜÊòØÂê¶ÈúÄË¶ÅÁºìÂ≠òÂéüÂõæ‰ª•ÂèäÊòØÂê¶ÈúÄË¶ÅÂØπÂéüÂõæËøõË°å transform ‰∏ä„ÄÇ ÂÜÖÈÉ®Â≠òÂÇ®ÊñπÊ≥ïÂÜÖÈÉ®Â≠òÂÇ®ÊñπÊ≥ïÂú® SDImageCache ‰∏≠Ôºö 1234567891011121314151617181920212223242526- (void)storeImage:(UIImage *)image imageData:(NSData *)imageData forKey:(nullable NSString *)key cacheType:(SDImageCacheType)cacheType completion:(nullable SDWebImageNoParamsBlock)completionBlock &#123; switch (cacheType) &#123; case SDImageCacheTypeNone: &#123; [self storeImage:image imageData:imageData forKey:key toMemory:NO toDisk:NO completion:completionBlock]; &#125; break; case SDImageCacheTypeMemory: &#123; [self storeImage:image imageData:imageData forKey:key toMemory:YES toDisk:NO completion:completionBlock]; &#125; break; case SDImageCacheTypeDisk: &#123; [self storeImage:image imageData:imageData forKey:key toMemory:NO toDisk:YES completion:completionBlock]; &#125; break; case SDImageCacheTypeAll: &#123; [self storeImage:image imageData:imageData forKey:key toMemory:YES toDisk:YES completion:completionBlock]; &#125; break; default: &#123; if (completionBlock) &#123; completionBlock(); &#125; &#125; break; &#125;&#125; Manager ‰ºöÊää‰∏ãËΩΩ‰∏ãÊù•ÁöÑ image ÊàñËÄÖ data ‰º†ÂÖ•„ÄÇÁÑ∂ÂêéÊ†πÊçÆÁºìÂ≠òÁ≠ñÁï•ËøõË°åÂÜÖÂ≠òÊàñËÄÖÁ£ÅÁõòÁºìÂ≠òÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849- (void)storeImage:(nullable UIImage *)image imageData:(nullable NSData *)imageData forKey:(nullable NSString *)key toMemory:(BOOL)toMemory toDisk:(BOOL)toDisk completion:(nullable SDWebImageNoParamsBlock)completionBlock &#123; if (!image || !key) &#123; if (completionBlock) &#123; completionBlock(); &#125; return; &#125; // if memory cache is enabled /// ÂèØ‰ª•‰øùÂ≠òÂ∞±‰øùÂ≠òÂà∞ memory ‰∏≠ if (toMemory &amp;&amp; self.config.shouldCacheImagesInMemory) &#123; NSUInteger cost = image.sd_memoryCost; [self.memoryCache setObject:image forKey:key cost:cost]; &#125; /// Â¶ÇÊûúÂèØ‰ª•‰øùÂ≠òÂà∞ disk ‰∏≠ if (toDisk) &#123; dispatch_async(self.ioQueue, ^&#123; @autoreleasepool &#123; NSData *data = imageData; if (!data &amp;&amp; image) &#123; // If we do not have any data to detect image format, check whether it contains alpha channel to use PNG or JPEG format SDImageFormat format; if ([SDImageCoderHelper CGImageContainsAlpha:image.CGImage]) &#123; format = SDImageFormatPNG; &#125; else &#123; format = SDImageFormatJPEG; &#125; data = [[SDImageCodersManager sharedManager] encodedDataWithImage:image format:format options:nil]; &#125; [self _storeImageDataToDisk:data forKey:key]; &#125; if (completionBlock) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; completionBlock(); &#125;); &#125; &#125;); &#125; else &#123; if (completionBlock) &#123; completionBlock(); &#125; &#125;&#125; ÂÜôÂÖ•Á£ÅÁõòÁöÑÊó∂ÂÄô‰∏ÄÁõ¥‰ΩøÁî®ÁöÑÊòØ‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàó ÔºåËøôÊ†∑Èò≤Ê≠¢‰∫ÜÂ§öÁ∫øÁ®ãÊÉÖÂÜµ‰∏ãÂèØËÉΩ‰ºö‰∫ßÁîüÁöÑ crashÔºö 1_ioQueue = dispatch_queue_create("com.hackemist.SDImageCache", DISPATCH_QUEUE_SERIAL); ÊÄªÁªìÊÄªÁöÑÊù•ËØ¥ÔºåÂ∞±ÊòØÈÄöËøá SDImageCache ÂéªÁÆ°ÁêÜÂÜÖÂ≠òÁºìÂ≠ò SDMemoryCache ÂíåÁ£ÅÁõòÁºìÂ≠ò SDDiskCache ÁºìÂ≠òÈÉ®ÂàÜÂà∞Ê≠§‰∏∫Ê≠¢„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SDWebImage Ê∫êÁ†ÅËß£Êûê--ÊÄªËßà]]></title>
    <url>%2F2018%2F03%2F01%2Fsdwebimage1%2F</url>
    <content type="text"><![CDATA[SDWebImage ÊòØÊàë‰ª¨ÊúÄÂ∏∏Áî®ÁöÑÊ°ÜÊû∂‰πã‰∏Ä„ÄÇÂÆÉÊòØ‰∏Ä‰∏™ÊØîËæÉÂ∫ûÂ§ßÁöÑÂ∫ìÔºå‰ΩÜÊòØÊï¥‰ΩìÈÄªËæëÂç¥ÈùûÂ∏∏Ê∏ÖÊô∞„ÄÇÂ•óÁî®ÂÆòÊñπ github ‰∏≠ÁöÑ‰∏ÄÂº†Êï¥‰ΩìÁöÑÊµÅÁ®ãÂõæÂèØ‰ª•ÁúãÂà∞Ôºö ‰ªéÂõæ‰∏≠ÂèØ‰ª•ÁúãÂá∫Êàë‰ª¨ÈÄöËøá UIImageView+WebCache ÂàÜÁ±ªÊèê‰æõÁöÑÊñπÊ≥ïË∞ÉÁî®‰∫Ü UIView+WebCache ‰∏≠ÁöÑÊñπÊ≥ïÔºåËøõËÄå SDWebImageManager Êé•ÁÆ°‰∫ÜÂä†ËΩΩÁöÑÊï¥‰∏™ÊµÅÁ®ã„ÄÇÊ†πÊçÆ‰∏çÂêåÁöÑÁ≠ñÁï•ÂÜ≥ÂÆöÊòØÂê¶‰ªé Cache ‰∏≠Êü•ÊâæÔºå‰ª•ÂèäÊòØ‰ªé Memory Cache ‰∏≠Êü•ÊâæËøòÊòØ‰ªé Disk Cache ‰∏≠Êü•Êâæ„ÄÇÊúÄÁªàËµ∞Âà∞ SDWebImageDownloader ‰∏≠‰∏ãËΩΩÂõæÁâá„ÄÇ‰∏ãËΩΩÂÆåÊàêËøòÈúÄË¶ÅÂØπÂõæÁâáËøõË°åÁºìÂ≠ò„ÄÇËøôÁØáÊàë‰ª¨ÂÖàÁÆÄÂçïÁúã‰∏Ä‰∏ã SDWebImageManager ‰πãÂâçÁöÑË∞ÉÁî®ËøáÁ®ã„ÄÇ UIView+WebCacheUIImageView+WebCache ÁöÑÂÖ•Âè£ÊñπÊ≥ïUIImageView+WebCache ÊòØÊàë‰ª¨ÊúÄÂ∏∏‰ΩøÁî®ÁöÑÂàÜÁ±ªÔºåÂÆÉÊèê‰æõ‰∫Ü SDWebImage ‰ΩøÁî®ÁöÑÂÖ•Âè£ÊñπÊ≥ï„ÄÇ‰∏ÄËà¨Êàë‰ª¨‰ºö‰ΩøÁî®Ëøô‰∏™ÊñπÊ≥ïÔºö 123- (void)sd_setImageWithURL:(nullable NSURL *)url placeholderImage:(nullable UIImage *)placeholder &#123; [self sd_setImageWithURL:url placeholderImage:placeholder options:0 progress:nil completed:nil];&#125; Ëøô‰∏™ÊñπÊ≥ïÁúÅÁï•‰∫ÜÈÖçÁΩÆÂèÇÊï∞‰ª•ÂèäËøõÂ∫¶ÂíåÂÆåÊàêÂõûË∞É„ÄÇÂÆÉ‰ºöË∞ÉÁî® UIView+WebCache ÁöÑÁõ∏Â∫îÊñπÊ≥ïÔºö 123456789101112131415161718- (void)sd_setImageWithURL:(nullable NSURL *)url placeholderImage:(nullable UIImage *)placeholder options:(SDWebImageOptions)options context:(nullable SDWebImageContext *)context progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nullable SDExternalCompletionBlock)completedBlock &#123; [self sd_internalSetImageWithURL:url placeholderImage:placeholder options:options context:context setImageBlock:nil progress:progressBlock completed:^(UIImage * _Nullable image, NSData * _Nullable data, NSError * _Nullable error, SDImageCacheType cacheType, BOOL finished, NSURL * _Nullable imageURL) &#123; if (completedBlock) &#123; completedBlock(image, error, cacheType, imageURL); &#125; &#125;];&#125; UIView+WebCache ÂÖ•Âè£ÊñπÊ≥ïËøô‰∏ÄÊÆµ‰ª£Á†ÅÊúâÁÇπÈïøÔºåÂÆÉ‰ºöÂàõÂª∫‰∏Ä‰∏™ SDWebImageManager ÂÆû‰æãÔºåÁî®Êù•ÊâßË°å‰∏ãËΩΩÂíåÁºìÂ≠òÊìç‰Ωú„ÄÇ‰ª£Á†Å‰∏≠ÊúâËØ¶Â∞ΩÁöÑÊ≥®ÈáäÔºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143- (void)sd_internalSetImageWithURL:(nullable NSURL *)url placeholderImage:(nullable UIImage *)placeholder options:(SDWebImageOptions)options context:(nullable SDWebImageContext *)context setImageBlock:(nullable SDSetImageBlock)setImageBlock progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nullable SDInternalCompletionBlock)completedBlock &#123; /// context ÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™Â≠óÂÖ∏ context = [context copy]; // copy to avoid mutable object /// Ëé∑Âèñ Operation ÂØπÂ∫îÁöÑ key NSString *validOperationKey = context[SDWebImageContextSetImageOperationKey]; if (!validOperationKey) &#123; /// Â¶ÇÊûú context ‰∏≠Ê≤°ÊúâÊåáÂÆö Operation ÂØπÂ∫îÁöÑ keyÔºåÈÇ£‰πàÂ∞±ÊåáÂÆö‰∏∫ÂΩìÂâçÁöÑÁ±ªÂêç validOperationKey = NSStringFromClass([self class]); &#125; /// ËÆ∞ÂΩï‰∏ãÊúÄËøëÁöÑ Opeartion ÁöÑ key„ÄÇ‰∏∫‰∫ÜÊñπ‰æøÂèñÊ∂àÊúÄËøë‰∏ÄÊ¨°ÁöÑ Operation self.sd_latestOperationKey = validOperationKey; /// ÂèñÊ∂à‰πãÂâç validOperationKey ÁöÑ‰∏ãËΩΩÈòüÂàó [self sd_cancelImageLoadOperationWithKey:validOperationKey]; self.sd_imageURL = url; /// Â¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆÂª∂ËøüÂä†ËΩΩÂç†‰ΩçÂõæÔºåÂ∞±‰ºöÂÖàÂä†ËΩΩÂç†‰ΩçÂõæ if (!(options &amp; SDWebImageDelayPlaceholder)) &#123; dispatch_main_async_safe(^&#123; /// Áõ¥Êé•ËÆæÁΩÆÂ±ï‰ΩçÂõæ [self sd_setImage:placeholder imageData:nil basedOnClassOrViaCustomSetImageBlock:setImageBlock cacheType:SDImageCacheTypeNone imageURL:url]; &#125;); &#125; if (url) &#123; // reset the progress NSProgress *imageProgress = objc_getAssociatedObject(self, @selector(sd_imageProgress)); if (imageProgress) &#123; imageProgress.totalUnitCount = 0; imageProgress.completedUnitCount = 0; &#125; /// ÂºÄÂêØÂä†ËΩΩÊåáÁ§∫Âô® [self sd_startImageIndicator]; id&lt;SDWebImageIndicator&gt; imageIndicator = self.sd_imageIndicator; /// ‰∏ãËΩΩÂíåÁºìÂ≠òÁöÑÁúüÊ≠£ÊâßË°åËÄÖ SDWebImageManager *manager = context[SDWebImageContextCustomManager]; if (!manager) &#123; manager = [SDWebImageManager sharedManager]; &#125; /// Êõ¥Êñ∞ËøõÂ∫¶Êù°ÁöÑÂõûË∞É block SDImageLoaderProgressBlock combinedProgressBlock = ^(NSInteger receivedSize, NSInteger expectedSize, NSURL * _Nullable targetURL) &#123; if (imageProgress) &#123; imageProgress.totalUnitCount = expectedSize; imageProgress.completedUnitCount = receivedSize; &#125;#if SD_UIKIT || SD_MAC if ([imageIndicator respondsToSelector:@selector(updateIndicatorProgress:)]) &#123; double progress = 0; if (expectedSize != 0) &#123; progress = (double)receivedSize / expectedSize; &#125; progress = MAX(MIN(progress, 1), 0); // 0.0 - 1.0 dispatch_async(dispatch_get_main_queue(), ^&#123; [imageIndicator updateIndicatorProgress:progress]; &#125;); &#125;#endif if (progressBlock) &#123; progressBlock(receivedSize, expectedSize, targetURL); &#125; &#125;; @weakify(self); /// manager ÊâßË°å‰∏ãËΩΩÂíåÁºìÂ≠ò id &lt;SDWebImageOperation&gt; operation = [manager loadImageWithURL:url options:options context:context progress:combinedProgressBlock completed:^(UIImage *image, NSData *data, NSError *error, SDImageCacheType cacheType, BOOL finished, NSURL *imageURL) &#123; @strongify(self); /// operation ÊâßË°åÂÆåÊàêÁöÑÂõûË∞É if (!self) &#123; return; &#125; /// Âä†ËΩΩÂÆåÊàêÂÅúÊ≠¢Âä†ËΩΩÊåáÁ§∫ if (finished) &#123; [self sd_stopImageIndicator]; &#125;/// Â¶ÇÊûúÂÆåÊàê‰∫ÜÔºåÊàñËÄÖ options ‰∏çÂÖÅËÆ∏Ëá™Âä®Â∞Ü‰∏ãËΩΩÂ•ΩÁöÑÂõæÁâáËÆæÁΩÆËøõÂéªÔºàÈúÄË¶ÅÊâãÂä®ËÆæÁΩÆÔºâÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅË∞ÉÁî®Â§ñÈÉ®‰º†ËøõÊù•ÁöÑ completeBlock BOOL shouldCallCompletedBlock = finished || (options &amp; SDWebImageAvoidAutoSetImage); /// Êúâ imageÔºå‰ΩÜÊòØ‰∏çËÆ©Ëá™Âä®ËÆæÁΩÆÔºåÊàñËÄÖÊ≤°Êúâ image Âπ∂‰∏îÂ∑≤ÁªèÂä†ËΩΩËøáÂç†‰ΩçÂõæ‰∫Ü BOOL shouldNotSetImage = ((image &amp;&amp; (options &amp; SDWebImageAvoidAutoSetImage)) || (!image &amp;&amp; !(options &amp; SDWebImageDelayPlaceholder))); SDWebImageNoParamsBlock callCompletedBlockClojure = ^&#123; if (!self) &#123; return; &#125; /// ÂèØ‰ª•ËÆæÁΩÆÂõæÁâáÁöÑÊó∂ÂÄô if (!shouldNotSetImage) &#123; [self sd_setNeedsLayout]; &#125; /// ËÉΩÂ§üË∞ÉÁî®ÂÆåÊàêÂõûË∞É if (completedBlock &amp;&amp; shouldCallCompletedBlock) &#123; completedBlock(image, data, error, cacheType, finished, url); &#125; &#125;; /// Êó†Ê≥ïËÆæÁΩÆÂõæÁâáÔºåÁõ¥Êé•Ë∞ÉÁî®ÂÆåÊàêÂõûË∞É if (shouldNotSetImage) &#123; dispatch_main_async_safe(callCompletedBlockClojure); return; &#125; UIImage *targetImage = nil; NSData *targetData = nil; /// Âä†ËΩΩÂÆå‰∫ÜÔºåÊúâÂõæÁâáÊòæÁ§∫ÂõæÁâáÔºåÊ≤°ÂõæÁâáÁúãÁúãÊòØÂê¶ÊòØ SDWebImageDelayPlaceholder„ÄÇÊòØÂ∞±Ë°®Á§∫‰πãÂâçÊ≤°ÊúâÊòæÁ§∫Âç†‰ΩçÂõæÔºåÈÇ£‰πàÁé∞Âú®ÊòæÁ§∫Â±ï‰ΩçÂõæ if (image) &#123; // case 2a: we got an image and the SDWebImageAvoidAutoSetImage is not set targetImage = image; targetData = data; &#125; else if (options &amp; SDWebImageDelayPlaceholder) &#123; // case 2b: we got no image and the SDWebImageDelayPlaceholder flag is set targetImage = placeholder; targetData = nil; &#125;#if SD_UIKIT || SD_MAC // check whether we should use the image transition SDWebImageTransition *transition = nil; if (finished &amp;&amp; (options &amp; SDWebImageForceTransition || cacheType == SDImageCacheTypeNone)) &#123; transition = self.sd_imageTransition; &#125;#endif dispatch_main_async_safe(^&#123;#if SD_UIKIT || SD_MAC [self sd_setImage:targetImage imageData:targetData basedOnClassOrViaCustomSetImageBlock:setImageBlock transition:transition cacheType:cacheType imageURL:imageURL];#endif callCompletedBlockClojure(); &#125;); &#125;]; /// ËÆæÁΩÆ key ÂØπÂ∫îÁöÑ operation [self sd_setImageLoadOperation:operation forKey:validOperationKey]; &#125; else &#123; /// URL‰∏∫Á©∫ÔºåÈÇ£‰πàÁõ¥Êé•Êä•Èîô [self sd_stopImageIndicator]; dispatch_main_async_safe(^&#123; if (completedBlock) &#123; NSError *error = [NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorInvalidURL userInfo:@&#123;NSLocalizedDescriptionKey : @"Image url is nil"&#125;]; completedBlock(nil, nil, error, SDImageCacheTypeNone, YES, url); &#125; &#125;); &#125;&#125; ‰ª£Á†ÅÊ≥®ÈáäÈùûÂ∏∏ËØ¶Â∞ΩÔºå‰∏ªË¶ÅÂÅö‰∫Ü‰ª•‰∏ãÂá†‰ª∂‰∫ãÔºö ÂáÜÂ§áÂä†ËΩΩ‰∏≠‰∏éÂä†ËΩΩÂÆåÊàêÁöÑÂõûË∞É block ÂàõÂª∫ SDWebImageManager ÂÆû‰æãÔºåÂπ∂ÈÄöËøáÂÆÉÂàõÂª∫Êª°Ë∂≥ SDWebImageOperation ÂçèËÆÆÁöÑ operation Â∞Ü‰∏ä‰∏ÄÊ≠•ÂàõÂª∫ÁöÑ operation ‰Ωú‰∏∫ÂÄºÔºåÈªòËÆ§ÊòØÂΩìÂâçÁ±ªÂêçÔºåÂèØÈÄöËøá options Ëá™ÂÆö‰πâÁöÑÂ≠óÁ¨¶‰∏≤‰Ωú‰∏∫ keyÔºå‰øùÂ≠òÂà∞ SDOperationsDictionary Â≠óÂÖ∏‰∏≠„ÄÇ Áé∞Âú®ËøòË¶ÅË°•ÂÖÖ‰ª•‰∏ãÂá†ÁÇπÔºö SDOperationsDictionary ÁöÑ‰ΩúÁî®1typedef NSMapTable&lt;NSString *, id&lt;SDWebImageOperation&gt;&gt; SDOperationsDictionary; Êàë‰ª¨ÁúãÂà∞‰∏äÈù¢ÁöÑÊñπÊ≥ï‰ºöÁîüÊàê‰∏Ä‰∏™ validOperationKeyÔºåÂπ∂‰∏î‰ºöÂ∞Ü Manager ÁîüÊàêÁöÑ Operation ÊîæÂÖ•ÈÄöËøáÂÖ≥ËÅîÂØπË±°‰øùÂ≠òÂú®ÊØè‰∏™ËßÜÂõæÂØπË±°‰∏≠ÁöÑ SDOperationsDictionary Â≠óÂÖ∏‰∏≠„ÄÇÈÇ£‰πàËøô‰∏™Â≠óÂÖ∏Â≠òÂú®ÁöÑÊÑè‰πâÊòØ‰ªÄ‰πàÂë¢Ôºü ÁªùÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨‰∏çÈúÄË¶ÅËøô‰∏™Â≠óÂÖ∏„ÄÇÂõ†‰∏∫‰∏Ä‰∏™ UIView Âè™‰ºö‰∏ãËΩΩÂπ∂Â±ïÁ§∫‰∏ÄÂº†Âõæ„ÄÇ‰ΩÜÊòØËøòÊòØÊúâÁâπÊÆäÊÉÖÂÜµÔºåÊØîÂ¶Ç UIButtonÔºåÂèØ‰ª•ËÆæÁΩÆ‰∏çÂêåÁä∂ÊÄÅ‰∏ãÁöÑÂõæÁâá„ÄÇÈÇ£‰πàÊàë‰ª¨Â∞±ÈúÄË¶Å‰∏Ä‰∏™Â≠óÂÖ∏‰øùÂ≠ò‰∏çÂêåÁä∂ÊÄÅÁöÑ Operation ‰∫Ü„ÄÇ SDWebImageContext ÁöÑ‰ΩúÁî®1typedef NSDictionary&lt;SDWebImageContextOption, id&gt; SDWebImageContext; ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨‰∏ç‰ºöÂØπ SDWebImageContext ÂÅö‰ªª‰ΩïÊìç‰ΩúÔºåÁõ¥Êé•‰º†ÂÖ• nil„ÄÇÂú®‰∏äÈù¢ÁöÑÊñπÊ≥ï‰∏≠Ôºö 123456/// Ëé∑Âèñ Operation ÂØπÂ∫îÁöÑ keyNSString *validOperationKey = context[SDWebImageContextSetImageOperationKey];if (!validOperationKey) &#123; /// Â¶ÇÊûú context ‰∏≠Ê≤°ÊúâÊåáÂÆö Operation ÂØπÂ∫îÁöÑ keyÔºåÈÇ£‰πàÂ∞±ÊåáÂÆö‰∏∫ÂΩìÂâçÁöÑÁ±ªÂêç validOperationKey = NSStringFromClass([self class]);&#125; ÊãøÂà∞Â≠óÂÖ∏‰∏≠ÁöÑ SDWebImageContextSetImageOperationKey ÂØπÂ∫îÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰Ωú‰∏∫ SDOperationsDictionary ‰∏≠ Operation ÁöÑÈîÆ„ÄÇÁî®Êù•ÈíàÂØπÂêå‰∏Ä UIView ÂÜÖÁöÑÂ§ö‰∏™ÂõæÁâá‰∏ãËΩΩÁöÑ Operation ÂÅöÂå∫ÂàÜ„ÄÇ ËÆæÁΩÆÂõæÁâáÁöÑÊìç‰ΩúÂú®ËÆæÁΩÆÂõæÁâáÂâçÊàë‰ª¨Áúã‰∏ã‰∏§‰∏™Áä∂ÊÄÅÈáèÁöÑËÆæÁΩÆÔºö 12345/// Â¶ÇÊûúÂÆåÊàê‰∫ÜÔºåÊàñËÄÖ options ‰∏çÂÖÅËÆ∏Ëá™Âä®Â∞Ü‰∏ãËΩΩÂ•ΩÁöÑÂõæÁâáËÆæÁΩÆËøõÂéªÔºàÈúÄË¶ÅÊâãÂä®ËÆæÁΩÆÔºâÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅË∞ÉÁî®Â§ñÈÉ®‰º†ËøõÊù•ÁöÑ completeBlockBOOL shouldCallCompletedBlock = finished || (options &amp; SDWebImageAvoidAutoSetImage);/// Êúâ imageÔºå‰ΩÜÊòØ‰∏çËÆ©Ëá™Âä®ËÆæÁΩÆÔºåÊàñËÄÖÊ≤°Êúâ image Âπ∂‰∏îÂ∑≤ÁªèÂä†ËΩΩËøáÂç†‰ΩçÂõæ‰∫ÜBOOL shouldNotSetImage = ((image &amp;&amp; (options &amp; SDWebImageAvoidAutoSetImage)) || (!image &amp;&amp; !(options &amp; SDWebImageDelayPlaceholder))); Áúã‰∫ÜÊ≥®Èáä‰Ω†ÂèØËÉΩËøòÊòØÂæàÊáµ„ÄÇËøôÊòØÂú® Operation ÊâßË°åÂÆåÊàêÁöÑÂõûË∞É‰∏≠ËøõË°åÁöÑ„ÄÇÂÖ∂‰∏≠ finished Âíå image ÈÉΩÊòØ Operation ÁöÑÂõûË∞ÉËøîÂõûÁöÑ„ÄÇ shouldCallCompletedBlock ÈÄöËøáÂà§Êñ≠ÊòØÂê¶ÊòØ finished ‰πãÂêéÔºåÊàñËÄÖ‰º†ÂÖ•ÁöÑ SDWebImageOptions ÊòØÂê¶ÊòØÁ¶ÅÊ≠¢Ëá™Âä®ËÆæÁΩÆÂõæÁâá„ÄÇÂ¶ÇÊûúÊòØÔºåÈÇ£‰πàÂ∞±‰ºöË∞ÉÁî®‰ΩøÁî®ËÄÖ‰º†ÂÖ•ÁöÑÂÆåÊàêÂõûË∞É„ÄÇ shouldNotSetImage ÂàÜ‰∏∫‰∏§ÁßçÊÉÖÂÜµÔºå‰∏ÄÁßçÊòØ‰∏ãËΩΩÂ•Ω‰∫ÜÂõæÁâáÔºå‰ΩÜÊòØ SDWebImageOptions ‰∏çËÆ©Ëá™Âä®ËÆæÁΩÆÂõæÁâá SDWebImageAvoidAutoSetImageÔºõÊàñËÄÖÊ≤°ÊúâÊääÂõæÁâá‰∏ãËΩΩ‰∏ãÊù•ÔºåÂπ∂‰∏î SDWebImageOptions ËÆæÁΩÆ‰∏∫ÈúÄË¶ÅÂª∂ËøüÂä†ËΩΩÂç†‰ΩçÂõæ SDWebImageDelayPlaceholder„ÄÇËøô‰∏§ÁßçÊÉÖÂÜµ‰ºöÁõ¥Êé•Ë∞ÉÁî®ÂÆåÊàêÂõûË∞ÉÔºåÂπ∂‰∏îÁõ¥Êé•Â∞±ËøîÂõû‰∫Ü„ÄÇ Â¶ÇÊûúÊ≤°ÊúâÈóÆÈ¢òÔºåÈÇ£‰πàÂ∞±Ëµ∞Âà∞‰∫ÜËÆæÁΩÆÂõæÁâáÁöÑÊñπÊ≥ï‰∏≠Ôºö 12345678910111213141516171819202122232425262728293031323334353637383940414243- (void)sd_setImage:(UIImage *)image imageData:(NSData *)imageData basedOnClassOrViaCustomSetImageBlock:(SDSetImageBlock)setImageBlock transition:(SDWebImageTransition *)transition cacheType:(SDImageCacheType)cacheType imageURL:(NSURL *)imageURL &#123; UIView *view = self; SDSetImageBlock finalSetImageBlock; if (setImageBlock) &#123; /// Â¶ÇÊûúÊúâËá™Â∑±ÁöÑËÆæÁΩÆÂõæÁâáÁöÑ block finalSetImageBlock = setImageBlock; &#125; else if ([view isKindOfClass:[UIImageView class]]) &#123; /// ÈíàÂØπ UIImageView ÁöÑËÆæÁΩÆÂõæÁâáÁöÑ block UIImageView *imageView = (UIImageView *)view; finalSetImageBlock = ^(UIImage *setImage, NSData *setImageData, SDImageCacheType setCacheType, NSURL *setImageURL) &#123; imageView.image = setImage; &#125;; &#125; else if ([view isKindOfClass:[UIButton class]]) &#123; /// ÈíàÂØπ UIButton ÁöÑËÆæÁΩÆÂõæÁâáÁöÑ block UIButton *button = (UIButton *)view; finalSetImageBlock = ^(UIImage *setImage, NSData *setImageData, SDImageCacheType setCacheType, NSURL *setImageURL) &#123; [button setImage:setImage forState:UIControlStateNormal]; &#125;; &#125; /// Â¶ÇÊûúÊúâËá™ÂÆö‰πâÁöÑÂ±ïÁ§∫Âä®Áîª if (transition) &#123; [UIView transitionWithView:view duration:0 options:0 animations:^&#123; // 0 duration to let UIKit render placeholder and prepares block if (transition.prepares) &#123; transition.prepares(view, image, imageData, cacheType, imageURL); &#125; &#125; completion:^(BOOL finished) &#123; [UIView transitionWithView:view duration:transition.duration options:transition.animationOptions animations:^&#123; if (finalSetImageBlock &amp;&amp; !transition.avoidAutoSetImage) &#123; finalSetImageBlock(image, imageData, cacheType, imageURL); &#125; if (transition.animations) &#123; transition.animations(view, image); &#125; &#125; completion:transition.completion]; &#125;]; &#125; else &#123; if (finalSetImageBlock) &#123; finalSetImageBlock(image, imageData, cacheType, imageURL); &#125; &#125;&#125; SDWebImageManagerÂÖ•Âè£ÊñπÊ≥ïSDWebImageManager ÊòØ‰∏Ä‰∏™Âçï‰æãÁöÑÂØπË±°„ÄÇÂ§ñÈÉ®Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647- (SDWebImageCombinedOperation *)loadImageWithURL:(nullable NSURL *)url options:(SDWebImageOptions)options context:(nullable SDWebImageContext *)context progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nonnull SDInternalCompletionBlock)completedBlock &#123; if ([url isKindOfClass:NSString.class]) &#123; url = [NSURL URLWithString:(NSString *)url]; &#125; // Prevents app crashing on argument type error like sending NSNull instead of NSURL if (![url isKindOfClass:NSURL.class]) &#123; url = nil; &#125; /// ÂàõÂª∫‰∏Ä‰∏™ Operation ÂØπË±°ÔºåÁî®Êù•‰øùÂ≠ò Cache Operation Âíå Download Operation SDWebImageCombinedOperation *operation = [SDWebImageCombinedOperation new]; operation.manager = self; /// ÊòØÂê¶ÊòØÂ∑≤Áü•ÁöÑÂ§±Ë¥•ÁöÑURL BOOL isFailedUrl = NO; if (url) &#123; SD_LOCK(self.failedURLsLock); isFailedUrl = [self.failedURLs containsObject:url]; SD_UNLOCK(self.failedURLsLock); &#125; /// Ê≤°ÊúâurlÔºåÊàñËÄÖÂ§±Ë¥•‰∫ÜÂπ∂‰∏îÊ≤°ÊúâËÆ©ÈáçÊñ∞‰∏ãËΩΩÁöÑÊÉÖÂÜµÔºåÁõ¥Êé•ÊäõÂá∫ÈîôËØØ if (url.absoluteString.length == 0 || (!(options &amp; SDWebImageRetryFailed) &amp;&amp; isFailedUrl)) &#123; [self callCompletionBlockForOperation:operation completion:completedBlock error:[NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorInvalidURL userInfo:@&#123;NSLocalizedDescriptionKey : @"Image url is nil"&#125;] url:url]; return operation; &#125; SD_LOCK(self.runningOperationsLock); /// ÊääÂΩìÂâç‰∏ãËΩΩÁöÑ operation Âä†ÂÖ•Âà∞ runingOperations ‰∏≠ [self.runningOperations addObject:operation]; SD_UNLOCK(self.runningOperationsLock); // Preprocess the options and context arg to decide the final the result for manager /// Â≠òÊîæ options Âíå context ÁöÑÂÆû‰æã„ÄÇËøôÈáåÂèØ‰ª•‰º†ÂÖ•Ëá™Â∑±ÁöÑÂ§ÑÁêÜÂØπË±°ÔºåÊù•Ëá™ÂÆö‰πâ options SDWebImageOptionsResult *result = [self processedResultForURL:url options:options context:context]; /// Ë∞ÉÁî®ÁºìÂ≠òÊñπÊ≥ï [self callCacheProcessForOperation:operation url:url options:result.options context:result.context progress:progressBlock completed:completedBlock]; return operation;&#125; ÂÖ•Âè£ÊñπÊ≥ïÂèØËØ¥ÁöÑ‰∏çÂ§ö„ÄÇ‰∏ªË¶ÅÂ∞±ÊòØÂà§Êñ≠‰∏Ä‰∏ãÊòØ‰∏çÊòØÂ§±Ë¥•ÁöÑ urlÔºåÂ¶ÇÊûú‰∏çÊòØÂ∞±Ëµ∞ÁºìÂ≠òÊñπÊ≥ï„ÄÇ SDWebImageCombinedOperation‰ªéÂëΩÂêç‰∏ä‰πüÂèØ‰ª•ÁúãÂá∫Êù•ÔºåËøôÊòØ‰∏Ä‰∏™Â§çÂêàÁöÑ Operation„ÄÇÂåÖÂê´‰∫Ü‰∏Ä‰∏™ÁºìÂ≠òÁî®ÁöÑ cacheOperation Âíå‰∏Ä‰∏™‰∏ãËΩΩÁî®ÁöÑ loaderOperationÔºö 123456789101112131415161718@interface SDWebImageCombinedOperation : NSObject &lt;SDWebImageOperation&gt;/** Cancel the current operation, including cache and loader process */- (void)cancel;/** The cache operation from the image cache query */@property (strong, nonatomic, nullable, readonly) id&lt;SDWebImageOperation&gt; cacheOperation;/** The loader operation from the image loader (such as download operation) */@property (strong, nonatomic, nullable, readonly) id&lt;SDWebImageOperation&gt; loaderOperation;@end ÂÆÉÁöÑ cancel ÊñπÊ≥ï‰ºöÂèñÊ∂àÂÜÖÈÉ®ÁöÑ‰∏§Áßç OperationÔºö 1234567891011121314151617- (void)cancel &#123; @synchronized(self) &#123; if (self.isCancelled) &#123; return; &#125; self.cancelled = YES; if (self.cacheOperation) &#123; [self.cacheOperation cancel]; self.cacheOperation = nil; &#125; if (self.loaderOperation) &#123; [self.loaderOperation cancel]; self.loaderOperation = nil; &#125; [self.manager safelyRemoveOperationFromRunning:self]; &#125;&#125; ÂâçÈù¢ÁöÑ‰ª£Á†Å‰∏≠Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÊúÄÁªàÊñπÊ≥ïËøîÂõûÁöÑÂ∞±ÊòØ SDWebImageCombinedOperation ÁöÑÂÆû‰æã„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂâçÈù¢ÂêÑ‰∏™ËßÜÂõæÂÆû‰æã‰∏≠ÈÄöËøáÂÖ≥ËÅîÂØπË±°ÊñπÂºè‰øùÂ≠òÁöÑ SDOpeartionsDictionary Â≠óÂÖ∏‰∏≠‰øùÂ≠òÁöÑÂ∞±ÊòØ SDWebImageCombinedOperation ÂÆû‰æãÂØπË±°„ÄÇ ‰∏ç‰ªÖÂ¶ÇÊ≠§ÔºåSDWebImageCombinedOperation ÂÆû‰æãÔºåËøòË¢´‰øùÂ≠òÂú®‰∫Ü SDWebImageManager ÁöÑ runningOperations Â±ûÊÄß‰∏≠„ÄÇÂÆÉ‰ºöÂº∫ÂºïÁî® operation ÂÆû‰æã„ÄÇÂΩì cancel Êó∂Ôºå‰ªé runningOperations Êï∞ÁªÑ‰∏≠ÁßªÈô§ÁöÑÊó∂ÂÄôÔºåÁî±‰∫é SDOpeartionsDictionary ÊòØÂº±ÂºïÁî®ÁöÑÊñπÂºè‰øùÂ≠òÁöÑ operationÔºåÂÆÉÂ∞±‰ºöË¢´Ëá™Âä®ÁßªÈô§„ÄÇ ‰πüÂ∞±ÊòØËØ¥ÔºåUIView ÂÆû‰æãÂíå Manager ÈÉΩ‰ºöÂ∞Ü Operation ‰øùÂ≠òËµ∑Êù•„ÄÇUIView ÂÆû‰æãÊòØÂº±ÂºïÁî®ÔºåÂú® Manager ‰∏≠ÁßªÈô§ÁöÑÊó∂ÂÄô‰ºöËá™Âä®Ê∏ÖÁ©∫ÂÖ∂ÂØπÂ∫î Operation SDWebImageOptionsResultSDWebImageOptionResult Â∞Ü options Âíå context ËøõË°å‰∫ÜÊï¥ÂêàÁªü‰∏Ä„ÄÇ‰πãÂêéÁöÑ‰ΩøÁî®ËøáÁ®ã‰∏≠Â∞±‰∏ç‰ºöÂá∫Áé∞ options Âíå context ‰∫ÜÔºåËÄåÊòØ‰ΩøÁî® SDWebImageOptionResult ÂÆû‰æãÔºö 123456789101112@implementation SDWebImageOptionsResult- (instancetype)initWithOptions:(SDWebImageOptions)options context:(SDWebImageContext *)context &#123; self = [super init]; if (self) &#123; self.options = options; self.context = context; &#125; return self;&#125;@end ÊâßË°åÁºìÂ≠òÊñπÊ≥ï1234567891011121314151617181920212223242526272829303132- (void)callCacheProcessForOperation:(nonnull SDWebImageCombinedOperation *)operation url:(nonnull NSURL *)url options:(SDWebImageOptions)options context:(nullable SDWebImageContext *)context progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nullable SDInternalCompletionBlock)completedBlock &#123; /// Ê†°È™åÊòØÂê¶ÊØèÊ¨°Âè™ËÉΩÈáçÊñ∞‰∏ãËΩΩÔºå‰∏ç‰ΩøÁî®ÁºìÂ≠ò BOOL shouldQueryCache = !SD_OPTIONS_CONTAINS(options, SDWebImageFromLoaderOnly); if (shouldQueryCache) &#123; /// ÂèñÂá∫Ëá™ÂÆö‰πâÁöÑÁºìÂ≠òËøáÊª§Âô®ÔºåÁî®Êù•ÈÄöËøá url ÊâæÂà∞ url ÂØπÂ∫îÁöÑ key Â≠óÁ¨¶‰∏≤ id&lt;SDWebImageCacheKeyFilter&gt; cacheKeyFilter = context[SDWebImageContextCacheKeyFilter]; /// ÈÄöËøáÁºìÂ≠òËøáÊª§Âô®ÔºåÊ†πÊçÆ url ËøîÂõûÊú¨Âú∞Áî®Êù•ÁºìÂ≠òÁöÑ key„ÄÇÂ¶ÇÊûúÊ≤°Êúâ‰º†ÂÖ•ÁºìÂ≠òËøáÊª§Âô®ÔºåÈÇ£‰πàÈªòËÆ§‰∏∫ url ÁöÑ absoluteString NSString *key = [self cacheKeyForURL:url cacheKeyFilter:cacheKeyFilter]; @weakify(operation); /// ËøõË°åÁºìÂ≠òÁõ∏ÂÖ≥Êìç‰ΩúÔºåÊääËøîÂõûÁöÑ Operation ËÆæÁΩÆÁªô CacheOperation operation.cacheOperation = [self.imageCache queryImageForKey:key options:options context:context completion:^(UIImage * _Nullable cachedImage, NSData * _Nullable cachedData, SDImageCacheType cacheType) &#123; @strongify(operation); /// Â¶ÇÊûúÊâßË°åËøáÁ®ã‰∏≠Êìç‰ΩúÂèñÊ∂àÔºåÂÆâÂÖ®ÁßªÈô§Êìç‰Ωú if (!operation || operation.isCancelled) &#123; // Image combined operation cancelled by user [self callCompletionBlockForOperation:operation completion:completedBlock error:[NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorCancelled userInfo:nil] url:url]; [self safelyRemoveOperationFromRunning:operation]; return; &#125; /// ÂâçÈù¢ÊãøÂ•Ω‰∫ÜÁºìÂ≠òÔºåÁé∞Âú®Â∞±Ë¶ÅÂºÄÂßã‰∏ãËΩΩ [self callDownloadProcessForOperation:operation url:url options:options context:context cachedImage:cachedImage cachedData:cachedData cacheType:cacheType progress:progressBlock completed:completedBlock]; &#125;]; &#125; else &#123; /// ‰∏çÂÖÅËÆ∏ÁºìÂ≠òÁõ¥Êé•‰∏ãËΩΩ [self callDownloadProcessForOperation:operation url:url options:options context:context cachedImage:nil cachedData:nil cacheType:SDImageCacheTypeNone progress:progressBlock completed:completedBlock]; &#125;&#125; ÈÄèËøáÂêçÂ≠óÊàë‰ª¨Â∞±ËÉΩÁü•ÈÅìÂÆÉÊòØÊâßË°åÁºìÂ≠òÁöÑÊñπÊ≥ï„ÄÇËÉΩËµ∞ÁºìÂ≠òËµ∞ÁºìÂ≠òÔºå‰∏çËÉΩËµ∞ÁºìÂ≠òÁõ¥Êé•Ëµ∞‰∏ãËΩΩ„ÄÇÂÖ≥‰∫éÁºìÂ≠òÁöÑÂÖ∑‰ΩìÂÆûÁé∞ËØ∑ÁúãÂêéÁØá„ÄÇ ÊâßË°å‰∏ãËΩΩÊñπÊ≥ï12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879- (void)callDownloadProcessForOperation:(nonnull SDWebImageCombinedOperation *)operation url:(nonnull NSURL *)url options:(SDWebImageOptions)options context:(SDWebImageContext *)context cachedImage:(nullable UIImage *)cachedImage cachedData:(nullable NSData *)cachedData cacheType:(SDImageCacheType)cacheType progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nullable SDInternalCompletionBlock)completedBlock &#123; // Check whether we should download image from network /// ËÉΩÂê¶‰∏ãËΩΩ BOOL shouldDownload = !SD_OPTIONS_CONTAINS(options, SDWebImageFromCacheOnly); shouldDownload &amp;= (!cachedImage || options &amp; SDWebImageRefreshCached); shouldDownload &amp;= (![self.delegate respondsToSelector:@selector(imageManager:shouldDownloadImageForURL:)] || [self.delegate imageManager:self shouldDownloadImageForURL:url]); shouldDownload &amp;= [self.imageLoader canRequestImageForURL:url]; /// Â¶ÇÊûúÂøÖÈ°ªË¶Å‰∏ãËΩΩ if (shouldDownload) &#123; /// Â¶ÇÊûú option ÁöÑÁõÆÁöÑÊòØ refreshCached„ÄÇÈÇ£‰πàË¶ÅÈáçÊñ∞‰ªéÊúçÂä°Âô®‰∏ãËΩΩÔºåËÆ© NSURLCache ËÆ∞ÂΩï‰∏ãÊñ∞ÁöÑÁºìÂ≠ò if (cachedImage &amp;&amp; options &amp; SDWebImageRefreshCached) &#123; [self callCompletionBlockForOperation:operation completion:completedBlock image:cachedImage data:cachedData error:nil cacheType:cacheType finished:YES url:url]; // Pass the cached image to the image loader. The image loader should check whether the remote image is equal to the cached image. SDWebImageMutableContext *mutableContext; if (context) &#123; mutableContext = [context mutableCopy]; &#125; else &#123; mutableContext = [NSMutableDictionary dictionary]; &#125; mutableContext[SDWebImageContextLoaderCachedImage] = cachedImage; context = [mutableContext copy]; &#125; // `SDWebImageCombinedOperation` -&gt; `SDWebImageDownloadToken` -&gt; `downloadOperationCancelToken`, which is a `SDCallbacksDictionary` and retain the completed block below, so we need weak-strong again to avoid retain cycle @weakify(operation); /// ‰∏ãËΩΩÁöÑ operation operation.loaderOperation = [self.imageLoader requestImageWithURL:url options:options context:context progress:progressBlock completed:^(UIImage *downloadedImage, NSData *downloadedData, NSError *error, BOOL finished) &#123; @strongify(operation); if (!operation || operation.isCancelled) &#123; // Image combined operation cancelled by user [self callCompletionBlockForOperation:operation completion:completedBlock error:[NSError errorWithDomain:SDWebImageErrorDomain code:SDWebImageErrorCancelled userInfo:nil] url:url]; &#125; else if (cachedImage &amp;&amp; options &amp; SDWebImageRefreshCached &amp;&amp; [error.domain isEqualToString:SDWebImageErrorDomain] &amp;&amp; error.code == SDWebImageErrorCacheNotModified) &#123; /// Â¶ÇÊûúÂè™ÊòØË¶ÅÂà∑Êñ∞ÁºìÂ≠òÔºåÈÇ£‰πà‰∏çË∞ÉÁî®ÂõûË∞ÉÊñπÊ≥ï„ÄÇ‰∏ãËΩΩ‰πãÂêéÂ∞±‰ºöÂà∑Êñ∞ NSURLCache ‰∫Ü &#125; else if ([error.domain isEqualToString:SDWebImageErrorDomain] &amp;&amp; error.code == SDWebImageErrorCancelled) &#123; // Download operation cancelled by user before sending the request, don't block failed URL [self callCompletionBlockForOperation:operation completion:completedBlock error:error url:url]; &#125; else if (error) &#123; [self callCompletionBlockForOperation:operation completion:completedBlock error:error url:url]; BOOL shouldBlockFailedURL = [self shouldBlockFailedURLWithURL:url error:error]; if (shouldBlockFailedURL) &#123; SD_LOCK(self.failedURLsLock); [self.failedURLs addObject:url]; SD_UNLOCK(self.failedURLsLock); &#125; &#125; else &#123; if ((options &amp; SDWebImageRetryFailed)) &#123; SD_LOCK(self.failedURLsLock); [self.failedURLs removeObject:url]; SD_UNLOCK(self.failedURLsLock); &#125; /// ËøõË°åÂõæÁâáÂ≠òÂÇ® [self callStoreCacheProcessForOperation:operation url:url options:options context:context downloadedImage:downloadedImage downloadedData:downloadedData finished:finished progress:progressBlock completed:completedBlock]; &#125; if (finished) &#123; [self safelyRemoveOperationFromRunning:operation]; &#125; &#125;]; /// Â¶ÇÊûúÊúâÁºìÂ≠òÁöÑÂõæÁâá &#125; else if (cachedImage) &#123; [self callCompletionBlockForOperation:operation completion:completedBlock image:cachedImage data:cachedData error:nil cacheType:cacheType finished:YES url:url]; [self safelyRemoveOperationFromRunning:operation]; /// Ê≤°ÊúâÁºìÂ≠òÁöÑÂõæÁâáÂπ∂‰∏î‰πü‰∏çËÉΩ‰∏ãËΩΩÔºåÁõ¥Êé•Ë∞ÉÁî®complete ÂõûË∞É &#125; else &#123; // Image not in cache and download disallowed by delegate [self callCompletionBlockForOperation:operation completion:completedBlock image:nil data:nil error:nil cacheType:SDImageCacheTypeNone finished:YES url:url]; [self safelyRemoveOperationFromRunning:operation]; &#125;&#125; ‰ªéÊñπÊ≥ïÂêç‰∏≠‰πüËÉΩÁõ¥ËßÇÁêÜËß£‰ªñÊòØ‰∏ãËΩΩÁõ∏ÂÖ≥ÊñπÊ≥ï„ÄÇÂú®‰∏ãËΩΩÊàêÂäüÁöÑÂõûË∞É‰∏≠Ôºå‰ºöËøõË°åÂõæÁâáÁöÑÂ≠òÂÇ®„ÄÇ ÊâßË°åÂ≠òÂÇ®ÊñπÊ≥ï1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677- (void)callStoreCacheProcessForOperation:(nonnull SDWebImageCombinedOperation *)operation url:(nonnull NSURL *)url options:(SDWebImageOptions)options context:(SDWebImageContext *)context downloadedImage:(nullable UIImage *)downloadedImage downloadedData:(nullable NSData *)downloadedData finished:(BOOL)finished progress:(nullable SDImageLoaderProgressBlock)progressBlock completed:(nullable SDInternalCompletionBlock)completedBlock &#123; /// Ëé∑ÂèñÂ≠òÂÇ®Á±ªÂûã,ÈªòËÆ§ÊòØÊó¢Â≠òÂú® Memory ‰∏≠ÂèàÂ≠òÂú® disk ‰∏≠ SDImageCacheType storeCacheType = SDImageCacheTypeAll; if (context[SDWebImageContextStoreCacheType]) &#123; storeCacheType = [context[SDWebImageContextStoreCacheType] integerValue]; &#125; /// Â¶ÇÊûúÂõæÁâáË¢´ transform Ëøá‰∫ÜÔºåÈÇ£‰πàËøô‰∏™ËÆæÁΩÆÊó∂Áî®Êù•ÈíàÂØπÂéüÂßãÂõæÂÉèÁöÑ SDImageCacheType originalStoreCacheType = SDImageCacheTypeNone; if (context[SDWebImageContextOriginalStoreCacheType]) &#123; originalStoreCacheType = [context[SDWebImageContextOriginalStoreCacheType] integerValue]; &#125; /// Ëé∑ÂèñËá™ÂÆö‰πâÁöÑ url ‚Üí string ÁöÑËΩ¨Êç¢Âô® id&lt;SDWebImageCacheKeyFilter&gt; cacheKeyFilter = context[SDWebImageContextCacheKeyFilter]; NSString *key = [self cacheKeyForURL:url cacheKeyFilter:cacheKeyFilter]; /// Ëé∑ÂèñËá™ÂÆö‰πâÁöÑ transformer id&lt;SDImageTransformer&gt; transformer = context[SDWebImageContextImageTransformer]; id&lt;SDWebImageCacheSerializer&gt; cacheSerializer = context[SDWebImageContextCacheSerializer]; /// ÊòØÂê¶Ë¶ÅËΩ¨Êç¢ image ÂèñÂÜ≥‰∫é 1. ÊòØÂê¶‰∏ãËΩΩÂ•Ω‰∫ÜÂõæÁâá 2. ÊòØÂê¶ÊúâËΩ¨ÂåñÂô® 3. Âä®ÂõæÈªòËÆ§‰∏ç‰ºö transformÔºå‰ΩÜÊòØÂ¶ÇÊûúËÆæÁΩÆ‰∫Ü SDWebImageTransformAnimatedImage Ê†áËØÜ‰ΩçÔºåÈÇ£‰πàÂ∞±‰ºöËΩ¨Êç¢ BOOL shouldTransformImage = downloadedImage &amp;&amp; (!downloadedImage.sd_isAnimated || (options &amp; SDWebImageTransformAnimatedImage)) &amp;&amp; transformer; /// ÊòØÂê¶ÈúÄË¶ÅÁºìÂ≠òÂéüÂõæ BOOL shouldCacheOriginal = downloadedImage &amp;&amp; finished; /// Â¶ÇÊûúÈúÄË¶ÅÁºìÂ≠òÂéüÂõæ if (shouldCacheOriginal) &#123; /// Ëé∑ÂèñËΩ¨Êç¢ÂéüÂõæÁöÑ type SDImageCacheType targetStoreCacheType = shouldTransformImage ? originalStoreCacheType : storeCacheType; /// Â¶ÇÊûúÊúâËá™ÂÆö‰πâÁöÑNSDataÂ∫èÂàóÂåñÊñπÂºè if (cacheSerializer &amp;&amp; (targetStoreCacheType == SDImageCacheTypeDisk || targetStoreCacheType == SDImageCacheTypeAll)) &#123; dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^&#123; @autoreleasepool &#123; NSData *cacheData = [cacheSerializer cacheDataWithImage:downloadedImage originalData:downloadedData imageURL:url]; /// ÂÖ∑‰ΩìÁöÑÁºìÂ≠òÊñπÂºè [self.imageCache storeImage:downloadedImage imageData:cacheData forKey:key cacheType:targetStoreCacheType completion:nil]; &#125; &#125;); /// Ê≤°ÊúâËá™ÂÆö‰πâÁöÑÂ∫èÂàóÂåñÊñπÊ≥ïÔºåÁõ¥Êé•Â≠òÂÇ®ÂõæÁâá &#125; else &#123; [self.imageCache storeImage:downloadedImage imageData:downloadedData forKey:key cacheType:targetStoreCacheType completion:nil]; &#125; &#125; /// Â¶ÇÊûúÈúÄË¶ÅÂØπÂéüÂõæËøõË°å transform if (shouldTransformImage) &#123; dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^&#123; @autoreleasepool &#123; /// transform ÂéüÂõæ UIImage *transformedImage = [transformer transformedImageWithImage:downloadedImage forKey:key]; if (transformedImage &amp;&amp; finished) &#123; NSString *transformerKey = [transformer transformerKey]; NSString *cacheKey = SDTransformedKeyForKey(key, transformerKey); BOOL imageWasTransformed = ![transformedImage isEqual:downloadedImage]; NSData *cacheData; // pass nil if the image was transformed, so we can recalculate the data from the image if (cacheSerializer &amp;&amp; (storeCacheType == SDImageCacheTypeDisk || storeCacheType == SDImageCacheTypeAll)) &#123; cacheData = [cacheSerializer cacheDataWithImage:transformedImage originalData:(imageWasTransformed ? nil : downloadedData) imageURL:url]; &#125; else &#123; cacheData = (imageWasTransformed ? nil : downloadedData); &#125; /// ÂÖ∑‰ΩìÁöÑÁºìÂ≠òÊñπÂºè [self.imageCache storeImage:transformedImage imageData:cacheData forKey:cacheKey cacheType:storeCacheType completion:nil]; &#125; [self callCompletionBlockForOperation:operation completion:completedBlock image:transformedImage data:downloadedData error:nil cacheType:SDImageCacheTypeNone finished:finished url:url]; &#125; &#125;); &#125; else &#123; [self callCompletionBlockForOperation:operation completion:completedBlock image:downloadedImage data:downloadedData error:nil cacheType:SDImageCacheTypeNone finished:finished url:url]; &#125;&#125; Â≠òÂÇ®ÁöÑÊñπÊ≥ï‰∏ªË¶ÅÂõ¥ÁªïÁùÄÊòØÂê¶Ë¶ÅÂØπÂõæÁâáËøõË°å transform Â±ïÂºÄÁöÑ„ÄÇÂú®‰∏ãËΩΩÂ•ΩÂõæÁâá‰πãÂêéÔºåÂèØ‰ª•Ëá™ÂÆö‰πâÁöÑÂ∞ÜÂõæÁâáËøõË°å‰∏Ä‰∫õËΩ¨ÂåñÔºåÊØîÂ¶ÇÊàë‰ª¨‰∏ãËΩΩÁöÑÂ§¥ÂÉèÊï∞ÊçÆÔºåÂèØËÉΩ‰ºöÁõ¥Êé•ÂàáÊàêÂúÜËßíÂ≠òÂÇ®„ÄÇÈÅøÂÖç‰ª•ÂêéÊØèÊ¨°‰ΩøÁî®ÂõæÁâáÈÉΩË¶ÅËÆæÁΩÆÂ∏¶Êù•ÁöÑÂõ∞Êâ∞„ÄÇÂÆÉÊòØÈÄöËøá SDImageTransformer ÂÆûÁé∞ÁöÑ„ÄÇSDImageTransformer Êú¨Ë∫´ÊòØ‰∏Ä‰∏™ÂçèËÆÆ„ÄÇSDWebImage Êú¨Ë∫´ÂÆûÁé∞‰∫Ü‰∏Ä‰∫õÔºåÂèØ‰ª•ÈÄöËøá context ‰º†ÂÖ•„ÄÇÊØîÂ¶Ç SDImagePipelineTransformerÔºåSDImageRoundTransformer Á≠â„ÄÇË¶ÅÊ≥®ÊÑèÔºåtransform ‰πãÂêéÁöÑÂõæÁâáÂπ∂‰∏çÊòØ‰ª•ÂéüÂëΩÂêç‰øùÂ≠òÁöÑÔºå‰ºöÂä†‰∏ä transformer Êèê‰æõÁöÑÂêéÁºÄÔºåÂú®Ëé∑ÂèñÁºìÂ≠òÁöÑÊó∂ÂÄô‰πü‰ºöÂú®ÊúâËá™ÂÆö‰πâ transformer ÁöÑÊó∂ÂÄôÂú® key ‰∏äÂä†‰∏ä transformer Êèê‰æõÁöÑÂêéÁºÄÊü•ËØ¢„ÄÇtransformer ÁöÑÁßçÁ±ªÂ¶Ç‰∏ãÔºåÂÆûÈôÖÂÆûÁî®ËøáÁ®ã‰∏≠ÊòØÂæàÂÆûÁî®ÁöÑÔºö SDImageTransformerÁ±ªÂûã ‰ΩúÁî® SDImagePipelineTransformer ÂèØ‰ª•‰º†ÂÖ•‰∏Ä‰∏™NSArrayÊåâÈ°∫Â∫èÂÅöËΩ¨Êç¢ SDImageRoundCornerTransformer Ê∑ªÂä†ÂúÜËßí SDImageResizingTransformer Ë∞ÉÊï¥Â§ßÂ∞è SDImageCroppingTransformer Ââ™Ë£Å SDImageFlippingTransformer ÁøªËΩ¨ SDImageRotationTransformer ÊóãËΩ¨ SDImageTintTransformer Ê∑ªÂä†Ëâ≤ÂΩ© SDImageBlurTransformer Ê∑ªÂä†Ê®°Á≥ä SDImageFilterTransformer Ê∑ªÂä†Êª§Èïú Ëá≥Ê≠§ÔºåSDWebImageManager ÁöÑ manager ÈÉ®ÂàÜÂ∞±ÂàÜÊûêÂÆå‰∫Ü„ÄÇÂêéÁª≠‰ºöÊúâÁºìÂ≠òÔºå‰∏ãËΩΩÂíåËß£Á†ÅÈÉ®ÂàÜ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÁªÑ‰ª∂ÂåñÁöÑÁÆÄÁü≠ÊÄªÁªìÂèä BeeHive Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2018%2F02%2F12%2F%E7%BB%84%E4%BB%B6%E5%8C%96%2F</url>
    <content type="text"><![CDATA[iOS Ê®°ÂùóÂåñÁªÑ‰ª∂ÂåñÊòØÂâç‰∏§Âπ¥ÊØîËæÉÊµÅË°åÁöÑËØùÈ¢ò„ÄÇÂΩìÊó∂ÊáíÂæóÂÜôÁõ∏ÂÖ≥ÁöÑ‰∏úË•ø„ÄÇÁé∞Âú®Ë∂ÅÊØîËæÉÊúâÁ©∫„ÄÇÂØπÂá†ÁßçÊñπÂºèÂÅö‰∏Ä‰∏™ÊúÄÊúÄÁÆÄÂçïÁöÑÊÄªÁªì„ÄÇ ÂÖ∂ÂÆûÂú®Ë∞àÂèäÁªÑ‰ª∂Âåñ‰πãÂâçÂ∫îËØ•ÂÖàÊêûÊ∏ÖÊ•ö‰∏Ä‰∏™Ê¶ÇÂøµ„ÄÇ‰ªÄ‰πàÊòØÁªÑ‰ª∂ÔºüÊàëËÆ§‰∏∫ÁªÑ‰ª∂Â∫îËØ•ÂèØ‰ª•Âç≥ÊèíÂç≥ÊãîÁöÑÂêåÁ±ªÂäüËÉΩÈõÜÂêà„ÄÇÂÆÉÂèØ‰ª•Âú®ÂêÑ‰∏™È°πÁõÆ‰∏≠‰ΩøÁî®ÔºåÂπ∂‰∏îÂíå‰∏öÂä°ÊòØ‰∏çÁõ∏ÂÖ≥ÊàñËÄÖËã•Áõ∏ÂÖ≥ÁöÑ„ÄÇÊØîÂ¶ÇÁΩëÁªúÂ∫ì„ÄÅÊú¨Âú∞Â≠òÂÇ®„ÄÅÂü∫Êú¨Êéß‰ª∂ÔºåËøô‰∫õÈÉΩÂèØ‰ª•Âè´ÂÅöÁªÑ‰ª∂„ÄÇÁõ∏ÂØπÁöÑÔºåÂíå‰∏öÂä°Âº∫Áõ∏ÂÖ≥ÁöÑÂäüËÉΩÂêàÈõÜÔºåËæÉÈöæÂú®ÂêÑ‰∏™È°πÁõÆ‰∏≠Â§çÁî®ÁöÑÔºåÊàëÊõ¥ÊÑøÊÑèÂ∞ÜÂÖ∂ÂΩíÁ±ª‰∏∫Ê®°Âùó„ÄÇ Âõ†Ê≠§ÔºåÂØπ‰∫éÊàë‰ª¨‰∏ÄËà¨ÊâÄËØ¥ÁöÑÁªÑ‰ª∂ÂåñÔºåÂÖ∂ÂÆûÊõ¥Â∫îËØ•Âè´Ê®°ÂùóÂåñ„ÄÇ ÁªÑ‰ª∂ÂåñÊñπÂºè‰∏ÄËà¨Êù•ËØ¥ÔºåÁªÑ‰ª∂ÂåñÁöÑÊñπÂºèÊúâ‰∏âÁßçÔºö key-block protocol-class target-action key-blockkey-block ÊòØÊúÄÁÆÄÂçïÊúÄÂÆπÊòìÊÉ≥Âà∞ÁöÑÁªÑ‰ª∂ÂåñÊñπÂºè„ÄÇÂú®Ê®°ÂùóÂä†ËΩΩÁöÑÊó∂ÂÄô‰ª•ÈîÆÂÄºÂØπÁöÑÂΩ¢ÂºèÂ∞Ü key Âíå block Ê≥®ÂÜåÂú®‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑÊ≥®ÂÜåË°®‰∏≠„ÄÇÂÖ∂‰∏≠ key ÈÄöÂ∏∏ÊòØ‰∏Ä‰∏™ URLÔºö 123456789101112// Ê≥®ÂÜå+ (void)load &#123; [[Mediator sharedInstance] registerUrl:@"myapp://gotoregister" withHandler:^(NSDictionary *dic) &#123; RegisterViewController *registerVC = [[RegisterViewController alloc] initWithSomeParam:dic["someParam"]]; [[UIApplication sharedApplication].keyWindow.rootViewController.navigationController pushViewController:registerVC animated:YES]; &#125;];&#125; // Ë∞ÉÁî®+ (void)gotoRegister &#123; [[Mediator sharedInstance] openUrl:@"myapp://gotoregister" withparam:@&#123;@"someParam": 123&#125;];&#125; ‰∏ªË¶ÅÂ≠òÂú®‰∏â‰∏™ÈóÆÈ¢òÔºö Ê≥®ÂÜåÁöÑ key ÂíåË∞ÉÁî®ÁöÑ key ÈúÄË¶ÅËæìÂÖ•Â§öÈÅçÔºåÂèØËÉΩÂá∫Áé∞ËæìÂÖ•ÈîôËØØÊàñËÄÖ‰øÆÊîπÈîôËØØÔºåÂú®ÁºñËØëÁöÑÊó∂ÂÄô‰∏çÊòìÂØüËßâ„ÄÇÂèØ‰ª•‰ΩøÁî® define ÂÆö‰πâÂ≠óÁ¨¶‰∏≤„ÄÇ‰∏çËøáËøôÊ†∑ËôΩÁÑ∂ÂèØ‰ª•ÂáèÂ∞ëÂÜôÈîôÁöÑÈ£éÈô©Ôºå‰ΩÜËøòÊòØ‰ºö‰∫ßÁîüÁ°¨ÁºñÁ†Å„ÄÇ ÊØè‰∏Ä‰∏™Ê®°ÂùóÈó¥Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÈÉΩ‰ºö‰øùÂ≠ò‰∏Ä‰∏™ block ÂÆû‰æã„ÄÇÂΩìÊ®°ÂùóÂæàÂ§öÔºåÊàñËÄÖÊ®°Âùó‰∏≠Êèê‰æõÁöÑË∞ÉÁî®ÊñπÊ≥ïÂæàÂ§öÁöÑÊó∂ÂÄôÔºå‰ºö‰øùÂ≠òÂ§ßÈáè block ÂØπË±°ÂÆû‰æã„ÄÇ Ë∞ÉÁî®Ê≥®ÂÜåÊñπÊ≥ïÁöÑÊó∂ÂÄô‰ΩøÁî®ÁöÑÊòØ NSDictionaryÔºåÂèÇÊï∞ÂèäÂÖ∂Á±ªÂûãÂØπ‰∫éË∞ÉÁî®ËÄÖÊù•ËØ¥ÊòØÊú™Áü•ÁöÑ„ÄÇÈúÄË¶Å‰∏ÄÂ•óÊñáÊ°£ËÆ∞ÂΩïÊØè‰∏™ÊñπÊ≥ïÁöÑÂèÇÊï∞ÂíåÁ±ªÂûã„ÄÇ protocol-classprotocol-class ÁöÑÊñπÂºèÂèØ‰ª•ËØ¥ÊòØ‰∏äÈù¢ key-block ÁöÑÊîπËøõÔºå‰ª£Ë°®Ê°ÜÊû∂ÊúâÈòøÈáåÂá∫ÂìÅÁöÑ BeeHive„ÄÇ ÈíàÂØπ‰∏äÈù¢ÁöÑÈóÆÈ¢ò1ÁºñËØëÁöÑÊó∂ÂÄôÊó†Ê≥ïÊ†°È™å key ÊòØÂê¶ÂÜôÈîôÁöÑÈóÆÈ¢òÔºåÂèØ‰ª•ÈÄöËøáÊ†°È™å protocol ÊòØÂê¶Â≠òÂú®ÔºåÂú®ÁºñËØëÊúüÊäõÂá∫ÈóÆÈ¢òÔºõÈíàÂØπ‰∏äÈù¢ÁöÑÈóÆÈ¢ò2Ôºå‰øùÂ≠òÂ§ßÈáè block ÂÆû‰æãÁöÑÈóÆÈ¢òÔºå‰ΩøÁî®‰øùÂ≠ò class ÁöÑÁöÑÂΩ¢Âºè‰ª£ÊõøÔºåÂèØ‰ª•ÂáèÂ∞ëÂ§ßÈáè block ÂÆû‰æãÁöÑ‰øùÂ≠òÔºõÈíàÂØπ‰∏äÈù¢ÁöÑÈóÆÈ¢ò3ÔºåË∞ÉÁî®ËÄÖ‰∏çÁü•ÈÅìË∞ÉÁî®ÂèÇÊï∞ÂíåÁ±ªÂûãÁöÑÈóÆÈ¢òÔºåÂèØ‰ª•Âú® protocol ‰∏≠ÂÆö‰πâÊñπÊ≥ïÔºåËÆ© class ÂÆûÁé∞ÔºåË∞ÉÁî®ËÄÖÁü•ÈÅì protocol Â∞±ÂèØ‰ª•Ëé∑ÂèñÊ®°ÂùóÈó¥ÈÄö‰ø°ÁöÑÊñπÊ≥ïÔºåËøõËÄåÁü•ÈÅìË∞ÉÁî®ÁöÑÂèÇÊï∞ÂíåÁ±ªÂûã„ÄÇ 1234567891011121314151617181920212223// ÂçèËÆÆ@protocol RegisterProtocol+ (void)navigateToRegisterVCWithString:(NSString *)str;@end // ÂÆûÁé∞Á±ª@interface RegisterViewController : UIViewController&lt;RegisterProtocl&gt;@end @implementation RegisterViewController+ (void)navigateToRegisterVC &#123; ...ÂÖ∑‰ΩìÁöÑÂÆûÁé∞ &#125;@end// Ê≥®ÂÜå+ (void)load &#123; [[Mediator sharedInstance] registerProtocol:@protocol(RegisterProocol) forInstance:[[self alloc] init]];&#125;// Ë∞ÉÁî®id&lt;RegisterProtocol&gt; registerVC = [[Mediator sharedInstance] instanceForProtocol:@protocol(RegisterProtocol)];[registerVC navigateToRegisterVCWithString:@"someParam"]; ËøôÂú® key-block ÁöÑÂü∫Á°Ä‰∏äÂ∑≤ÁªèÂÅö‰∫ÜÂæàÂ§ßÁöÑÊîπËøõ„ÄÇ‰ΩÜÊòØ‰ªçÊúâÊîπËøõÁöÑÁ©∫Èó¥Ôºö ÊØîÂ¶ÇË∞ÉÁî®ËÄÖÁõ¥Êé•ÈÄöËøá Mediator ÊãøÂà∞ Class ÁöÑÂÆû‰æãÔºåÂÜçÈÄöËøáÂÆû‰æãË∞ÉÁî®ÊñπÊ≥ï„ÄÇËøôÊ†∑Áõ∏ÂΩì‰∫éË∞ÉÁî®ËÄÖÂíåË¢´Ë∞ÉÁî®ËÄÖÁõ¥Êé•Êé•Ëß¶ÔºåÊ≤°ÊúâÂäûÊ≥ïÂÅöÁªü‰∏ÄÂ§ÑÁêÜÔºåÊØîÂ¶ÇÁªÑ‰ª∂‰∏çÂ≠òÂú®Êó∂ÁöÑÁªü‰∏ÄÂ§ÑÁêÜ„ÄÇ ‰ªçÁÑ∂ÈúÄË¶ÅÊèêÂâçÊ≥®ÂÜå ÈíàÂØπÈóÆÈ¢ò1ÔºåÂèØ‰ª•Â∞ùËØïÁî®‰∏Ä‰∏™ wrapper Êää class ÂÜçÂåÖË£π‰∏ÄÂ±ÇÂÅöÁªü‰∏ÄÂ§ÑÁêÜ„ÄÇ‰∏çËøáËøôÊ†∑Â∞±Êõ¥È∫ªÁÉ¶‰∫Ü„ÄÇÊ≤°ÊúâÂ§™Â§ßÂøÖË¶Å„ÄÇ target -actiontarget-action ÈÄöËøá runtime Ë∞ÉÁî®Ë¢´Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÔºåËøôÊ†∑ÂèØ‰ª•ÂÖçÂéªÊèêÂâçÊ≥®ÂÜåÁöÑÈóÆÈ¢òÔºõÂêåÊó∂ÔºåÂ∞ÜË∞ÉÁî®ÁöÑÁªü‰∏ÄÂ§ÑÁêÜÈÄªËæëÊîæÂú®‰∫Ü Mediator ‰∏≠ÔºåËøôÊ†∑ÂèØ‰ª•Ëß£ÂÜ≥Ê≤°Ê≥ïÁªü‰∏ÄÂ§ÑÁêÜÁöÑÈóÆÈ¢ò„ÄÇ ‰ΩÜÊòØÊâÄÊúâÁöÑÂ§ÑÁêÜÊñπÊ≥ïÈÉΩÂÜôÂú® Mediator ‰∏≠ÈÇ£ Mediator Â∞±‰ºöÊòæÂæóÂ§™ËáÉËÇø‰∫Ü„ÄÇÂõ†Ê≠§ÔºåÂèØ‰ª•Â∞Ü‰∏çÂêåÊ®°ÂùóÁöÑÊñπÊ≥ïÂÜôÂú® Mediator ‰∏çÂêåÁöÑÂàÜÁ±ª‰∏≠„ÄÇ 12345678// Mediator@implementation Mediator (RegisterModule)- (void)navigateToRegisterVCWithId:(NSString *)id &#123; Class cls = NSClassFromString(@"RegisterViewController"); UIViewController *registerVC = [cls performSelector:NSSelectorFromString(@"createVCWithId:") withObject:@&#123;@"id":id&#125;]; [self.navigationController pushViewController:registerVC];&#125;@end ËøôÊ†∑Ë∞ÉÁî®ËÄÖÂè™ÈúÄË¶ÅÂºïÂÖ• Mediator+RegisterModule.h Âπ∂‰∏îÊâßË°å [Mediator sharedInstance] navigateToRegisterVCWithId:@&quot;xxx&quot;] Âç≥ÂèØÂÆåÊàêË∞ÉÁî®„ÄÇÂØπ‰∫éË∞ÉÁî®ËÄÖÊù•ËØ¥ÔºåÂºïÂÖ•‰∫ÜÊñπÊ≥ïÂ§¥Êñá‰ª∂ÂêéÔºåÂêåÊ†∑‰∏çÈúÄË¶ÅÂÖ≥Ê≥®ÂèÇÊï∞ÂíåÁ±ªÂûãÔºå‰πü‰∏çÈúÄË¶ÅÊèêÂâçÊ≥®ÂÜå„ÄÇÂêåÊó∂ËøòÂèØ‰ª•ÈÄöËøá Mediator ËøõË°åÁªü‰∏ÄÂ§ÑÁêÜ„ÄÇ ‰ΩÜÊòØÂÆÉÂú®Ë∞ÉÁî®Ë¢´Ë∞ÉÁî®ËÄÖÁöÑÊó∂ÂÄô‰ªçÁÑ∂‰ºö‰∫ßÁîüÁ°¨ÁºñÁ†Å„ÄÇ‰∏çËøáÁî±‰∫éËØ•Ê®°ÂùóÁöÑ Mediator ÂàÜÁ±ªÊòØÁî±Ë¢´Ë∞ÉÁî®ËÄÖÁª¥Êä§ÁöÑ„ÄÇÂõ†Ê≠§ÔºåÂú®Ë¢´Ë∞ÉÁî®ÊñπÊ≥ïÂèòÂåñÊó∂ÔºåË¢´Ë∞ÉÁî®ËÄÖÈúÄË¶ÅÁª¥Êä§ Mediator ÂàÜÁ±ª„ÄÇ BeeHive Ê∫êÁ†ÅËß£ÊûêBeehive ÊòØÈòøÈáåÂºÄÊ∫êÁöÑ‰∏ÄÊ¨æÂü∫‰∫é protocol-class ÊñπÂºèÁöÑÁªÑ‰ª∂ÂåñÊñπÊ°à„ÄÇÂÆÉÂÖ∑‰ΩìÁöÑÊÄùÊÉ≥Â∑≤ÁªèÂú®‰∏äÈù¢ËØ¥Êòé‰∫ÜÔºåËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÂØπÂÆÉËøõË°åÁÆÄÂçïÁöÑËß£Êûê„ÄÇ BeeHive ÂàÜ‰∏∫‰∏§ÈÉ®ÂàÜÔºö ModuleÔºöË¥üË¥£Ê®°ÂùóÁöÑÊ≥®ÂÜå‰ª•Âèä‰∫ã‰ª∂ÂàÜÂèë ServiceÔºöË¥üË¥£Ê®°ÂùóÈó¥ÁöÑÈÄö‰ø°‰ª•ÂèäË∞ÉÁî® Ê®°ÂùóÊ≥®ÂÜåBeehive ‰∏≠ÁöÑÊ®°ÂùóÊòØ‰∏Ä‰∏™ÂÆûÁé∞‰∫Ü BHModuleProtocol ÂçèËÆÆÁöÑÁ±ªÔºåÁî®‰∫éÁÆ°ÁêÜÊ®°ÂùóÁöÑÂêÑ‰∏™ÁîüÂëΩÂë®Êúü‰∫ã‰ª∂Â§ÑÁêÜ„ÄÇBeehive ‰∏≠Ê®°ÂùóÊ≥®ÂÜåÊúâ‰∏âÁßçÊñπÂºèÔºö Âä†ËΩΩ plist ‰∏≠ÈÖçÁΩÆÈùôÊÄÅÊ≥®ÂÜå +load ÊñπÊ≥ï‰∏≠Âä®ÊÄÅÊ≥®ÂÜå ‰ΩøÁî®Ê≥®Ëß£Âä®ÊÄÅÊ≥®ÂÜå plist ÈùôÊÄÅÊ≥®ÂÜåplist Ê≥®ÂÜåÂú® AppDelegate ÁöÑ application:didFinishLaunchingWithOptions: ÊñπÊ≥ï‰∏≠ËøõË°å„ÄÇÊ®°ÂùóÁöÑÊ≥®ÂÜåÈÄöËøá BHModuleManager ÂÆåÊàê„ÄÇ plist ‰∏≠ module ÁöÑÂΩ¢ÂºèÂ¶Ç‰∏ãÔºåÂåÖÂê´‰∫Ü ModuleClassÔºåModuleLevel,ModulePriorityÔºö BHModuleManager ‰ºöÂ∞Ü plist ‰∏≠ÁöÑÂêÑ‰∏™ ModuleClass ËØªÂèñ‰øùÂ≠òÂà∞ ModuleInfos Êï∞ÁªÑ‰∏≠ÔºåÂπ∂Âú®ÂÖ∂‰∏≠ÊåâÁÖß level Âíå priority ÊéíÂ∫è„ÄÇÈöèÂêéÂÆû‰æãÂåñÊØè‰∏Ä‰∏™ moduleÔºåÊ∑ªÂä†Âà∞ BHModules Ê®°ÂùóÁ§∫‰æãÊï∞ÁªÑ‰∏≠Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162/// Âä†ËΩΩÊú¨Âú∞ÁöÑ Modules ÂàóË°®- (void)loadLocalModules&#123; NSString *plistPath = [[NSBundle mainBundle] pathForResource:[BHContext shareInstance].moduleConfigName ofType:@"plist"]; if (![[NSFileManager defaultManager] fileExistsAtPath:plistPath]) &#123; return; &#125; NSDictionary *moduleList = [[NSDictionary alloc] initWithContentsOfFile:plistPath]; NSArray&lt;NSDictionary *&gt; *modulesArray = [moduleList objectForKey:kModuleArrayKey]; NSMutableDictionary&lt;NSString *, NSNumber *&gt; *moduleInfoByClass = @&#123;&#125;.mutableCopy; [self.BHModuleInfos enumerateObjectsUsingBlock:^(NSDictionary * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123; [moduleInfoByClass setObject:@1 forKey:[obj objectForKey:kModuleInfoNameKey]]; &#125;]; [modulesArray enumerateObjectsUsingBlock:^(NSDictionary * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123; if (!moduleInfoByClass[[obj objectForKey:kModuleInfoNameKey]]) &#123; [self.BHModuleInfos addObject:obj]; &#125; &#125;];&#125;// ÂÆû‰æãÂåñÊ®°ÂùóÂπ∂Ê∑ªÂä†Âà∞ BHModules Êï∞ÁªÑ‰∏≠- (void)registedAllModules&#123; /// ÊåâÁÖß‰ºòÂÖàÁ∫ßÂØπÊ®°ÂùóÂàóË°®‰∏≠ÁöÑÊ®°ÂùóÊéíÂ∫è [self.BHModuleInfos sortUsingComparator:^NSComparisonResult(NSDictionary *module1, NSDictionary *module2) &#123; NSNumber *module1Level = (NSNumber *)[module1 objectForKey:kModuleInfoLevelKey]; NSNumber *module2Level = (NSNumber *)[module2 objectForKey:kModuleInfoLevelKey]; if (module1Level.integerValue != module2Level.integerValue) &#123; return module1Level.integerValue &gt; module2Level.integerValue; &#125; else &#123; NSNumber *module1Priority = (NSNumber *)[module1 objectForKey:kModuleInfoPriorityKey]; NSNumber *module2Priority = (NSNumber *)[module2 objectForKey:kModuleInfoPriorityKey]; return module1Priority.integerValue &lt; module2Priority.integerValue; &#125; &#125;]; NSMutableArray *tmpArray = [NSMutableArray array]; //module init [self.BHModuleInfos enumerateObjectsUsingBlock:^(NSDictionary *module, NSUInteger idx, BOOL * _Nonnull stop) &#123; NSString *classStr = [module objectForKey:kModuleInfoNameKey]; Class moduleClass = NSClassFromString(classStr); BOOL hasInstantiated = ((NSNumber *)[module objectForKey:kModuleInfoHasInstantiatedKey]).boolValue; if (NSStringFromClass(moduleClass) &amp;&amp; !hasInstantiated) &#123; id&lt;BHModuleProtocol&gt; moduleInstance = [[moduleClass alloc] init]; [tmpArray addObject:moduleInstance]; &#125; &#125;]; [self.BHModules removeAllObjects]; /// ÊääclassÊ∑ªÂä†Âà∞ BHModules ‰∏≠ [self.BHModules addObjectsFromArray:tmpArray]; [self registerAllSystemEvents];&#125; +load ÊñπÊ≥ïÊ≥®ÂÜåBeehive ‰∏∫ +load ÊñπÊ≥ïÊ≥®ÂÜåÊ∑ªÂä†‰∫Ü‰∏Ä‰∏™ÂÆèÂÆö‰πâ„ÄÇÂè™ÈúÄË¶ÅÊääËøô‰∏™ÂÆèÂÆö‰πâÊèíÂÖ•Âà∞ÂÆûÁé∞Êñá‰ª∂‰∏≠ÁöÑ‰ªªÊÑè‰ΩçÁΩÆÂç≥ÂèØÔºö 123#define BH_EXPORT_MODULE(isAsync) \+ (void)load &#123; [BeeHive registerDynamicModule:[self class]]; &#125; \-(BOOL)async &#123; return [[NSString stringWithUTF8String:#isAsync] boolValue];&#125; ÂÖà‰∏çÁî®ÁÆ°Ëøô‰∏™ÂºÇÊ≠•ÁöÑÂÆö‰πâÊñπÊ≥ï„ÄÇÂú® +load ÊñπÊ≥ï‰∏≠Áõ¥Êé•Ë∞ÉÁî®‰∫Ü registerDynamicModule: ÊñπÊ≥ïÊ≥®ÂÜåËá™Â∑±ÔºåÂÖúÂÖúËΩ¨ËΩ¨Êù•Âà∞‰∫Ü‰∏ãÈù¢ÁöÑÊñπÊ≥ï„ÄÇ‰ª£Á†ÅËøòÊòØÈùûÂ∏∏Áõ¥Êé•ÊòìÊáÇÁöÑÔºåÂíå plist ‰∏ÄÊ†∑ÊòØ‰∏Ä‰∏™ÂÆû‰æãÂåñÁöÑËøáÁ®ãÔºåÂπ∂‰∏îÊ∑ªÂä†Âà∞ BHModules Êï∞ÁªÑ‰∏≠ÔºåÂÜçÊåâÁÖß‰ºòÂÖàÁ∫ßÂíå level ÊéíÂ∫èÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162- (void)addModuleFromObject:(id)object shouldTriggerInitEvent:(BOOL)shouldTriggerInitEvent&#123; Class class; NSString *moduleName = nil; if (object) &#123; class = object; moduleName = NSStringFromClass(class); &#125; else &#123; return ; &#125; ... if ([class conformsToProtocol:@protocol(BHModuleProtocol)]) &#123; NSMutableDictionary *moduleInfo = [NSMutableDictionary dictionary]; BOOL responseBasicLevel = [class instancesRespondToSelector:@selector(basicModuleLevel)]; int levelInt = 1; if (responseBasicLevel) &#123; levelInt = 0; &#125; [moduleInfo setObject:@(levelInt) forKey:kModuleInfoLevelKey]; if (moduleName) &#123; [moduleInfo setObject:moduleName forKey:kModuleInfoNameKey]; &#125; [self.BHModuleInfos addObject:moduleInfo]; id&lt;BHModuleProtocol&gt; moduleInstance = [[class alloc] init]; [self.BHModules addObject:moduleInstance]; [moduleInfo setObject:@(YES) forKey:kModuleInfoHasInstantiatedKey]; [self.BHModules sortUsingComparator:^NSComparisonResult(id&lt;BHModuleProtocol&gt; moduleInstance1, id&lt;BHModuleProtocol&gt; moduleInstance2) &#123; NSNumber *module1Level = @(BHModuleNormal); NSNumber *module2Level = @(BHModuleNormal); if ([moduleInstance1 respondsToSelector:@selector(basicModuleLevel)]) &#123; module1Level = @(BHModuleBasic); &#125; if ([moduleInstance2 respondsToSelector:@selector(basicModuleLevel)]) &#123; module2Level = @(BHModuleBasic); &#125; if (module1Level.integerValue != module2Level.integerValue) &#123; return module1Level.integerValue &gt; module2Level.integerValue; &#125; else &#123; NSInteger module1Priority = 0; NSInteger module2Priority = 0; if ([moduleInstance1 respondsToSelector:@selector(modulePriority)]) &#123; module1Priority = [moduleInstance1 modulePriority]; &#125; if ([moduleInstance2 respondsToSelector:@selector(modulePriority)]) &#123; module2Priority = [moduleInstance2 modulePriority]; &#125; return module1Priority &lt; module2Priority; &#125; &#125;]; ... &#125;&#125; Ê≥®Ëß£Ê≥®ÂÜåÊ≥®Ëß£Ê≥®ÂÜåÊòØ‰∏Ä‰∏™ÊØîËæÉÊñ∞Â•áÁöÑ‰∏úË•ø„ÄÇÂÆÉÁöÑ‰ΩøÁî®ÊñπÂºèÂ¶Ç‰∏ãÔºåÂú®Á±ªÊãìÂ±ïÂâçÈÄöËøá @BeehiveMod() ËøõË°åÊ≥®ÂÜåÔºö 123@BeeHiveMod(ShopModule)@interface ShopModule() &lt;BHModuleProtocol&gt;@end ÈÇ£‰πàÂÆÉÊòØÂ¶Ç‰ΩïËøõË°åÁöÑÂë¢ÔºüÁúãÂÆè‰ª£Á†ÅÔºö 1234#define BeeHiveDATA(sectname) __attribute((used, section("__DATA,"#sectname" ")))#define BeeHiveMod(name) \class BeeHive; char * k##name##_mod BeeHiveDATA(BeehiveMods) = ""#name""; ÂèØ‰ª•ÂèëÁé∞Ôºå‰∏äÈù¢ÁöÑ @BeeHiveMod(ShopModule) Â±ïÂºÄÂêéÂ∞±‰ºöÂèò‰∏∫Ôºö 1@class BeeHive; char * kShopModule_mod __attribute((used, section("__DATA,"BeehiveMods"))) = ""ShopModule"" ÂÖ∂‰∏≠ @class ÁöÑÊèêÂâçÂ£∞Êòé BeeHive ÂÖ∂ÂÆûÊ≤°‰ªÄ‰πàÁî®Â§ÑÔºåÂ∫îËØ•Âè™ÊòØ‰∏∫‰∫ÜÂÜôËµ∑Êù•Êõ¥ÂÉèÊ≥®Ëß£ÊâçËøô‰πàÂÅöÁöÑ„ÄÇÂÆèÁöÑ‰∏ªË¶Å‰ΩúÁî®ÊòØÂ£∞Êòé‰∫Ü‰∏Ä‰∏™ÂÖ®Â±ÄÂèòÈáè kShopModule_modÔºåÂπ∂‰∏îÊääËøô‰∏™ÂÖ®Â±ÄÂèòÈáèÂ≠òÂà∞‰∫Ü Mach-o ÁöÑËá™Â∑±ÂàõÂª∫ÁöÑ BeehiveMods ÊÆµ‰∏≠„ÄÇ ‰∏∫‰ªÄ‰πàË¶ÅÂ≠òÂà∞ÁâπÂÆöÁöÑÊÆµÂë¢ÔºüÂõ†‰∏∫Â≠òÂà∞ÁâπÂÆöÁöÑÊÆµ‰∏≠Â∞±ËÉΩÂú®Á®ãÂ∫èÂä†ËΩΩÁöÑÊó∂ÂÄôÊâæÂà∞Ëøô‰∏™ÊÆµÔºåÁÑ∂ÂêéËá™Ë°åÂä†ËΩΩÊ≥®ÂÜå„ÄÇÂÖ∑‰ΩìÈÄªËæëÂú® BHAnnotation ‰∏≠Ôºö 12345/// dyld Âä†ËΩΩ lib ÂêéÁöÑÂõûË∞É__attribute__((constructor))void initProphet() &#123; _dyld_register_func_for_add_image(dyld_callback);&#125; ‰∏äÈù¢‰ª£Á†ÅÁªô dyld Ê∑ªÂä†ÂõûË∞ÉÔºåÂú®Âä†ËΩΩÂÆåÈïúÂÉèÂêé‰ºöÊâßË°å dyld_callback ÊñπÊ≥ï„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738394041static void dyld_callback(const struct mach_header *mhp, intptr_t vmaddr_slide)&#123; /// ÊãøÂà∞ÊâÄÊúâÁöÑ BeehiveMods ‰∏≠ÁöÑ module Âêç NSArray *mods = BHReadConfiguration(BeehiveModSectName, mhp); /// Â∞Ü module ÂêçÊ≥®ÂÜå for (NSString *modName in mods) &#123; Class cls; if (modName) &#123; cls = NSClassFromString(modName); if (cls) &#123; [[BHModuleManager sharedManager] registerDynamicModule:cls]; &#125; &#125; &#125; ... &#125;NSArray&lt;NSString *&gt;* BHReadConfiguration(char *sectionName,const struct mach_header *mhp)&#123; NSMutableArray *configs = [NSMutableArray array]; unsigned long size = 0;#ifndef __LP64__ uintptr_t *memory = (uintptr_t*)getsectiondata(mhp, SEG_DATA, sectionName, &amp;size);#else const struct mach_header_64 *mhp64 = (const struct mach_header_64 *)mhp; uintptr_t *memory = (uintptr_t*)getsectiondata(mhp64, SEG_DATA, sectionName, &amp;size);#endif unsigned long counter = size/sizeof(void*); for(int idx = 0; idx &lt; counter; ++idx)&#123; char *string = (char*)memory[idx]; NSString *str = [NSString stringWithUTF8String:string]; if(!str)continue; BHLog(@"config = %@", str); if(str) [configs addObject:str]; &#125; return configs;&#125; dyld ÁöÑÂõûË∞É‰ºöÊääÊÆµ‰ø°ÊÅØ‰º†ÂÖ•ÔºåÂ∞±ÂèØ‰ª•Âú®ÂõûË∞ÉÂáΩÊï∞‰∏≠Ëß£ÊûêÂæóÂà∞ÊâÄÊúâÁöÑÊ®°Âùó‰ø°ÊÅØÔºåÂπ∂‰∏îÂä®ÊÄÅÊ≥®ÂÜå‰∫Ü„ÄÇ Ê≥®ÂÜå‰∫ã‰ª∂ÂØπ‰∫é protocol-class Êù•ËØ¥ÔºåÊúÄÈáçË¶ÅÁöÑÊòØ protocol Âíå class ÁöÑÊò†Â∞ÑÔºå‰πüÂ∞±ÊòØ Beehive ‰∏≠ service ÁöÑÈÉ®ÂàÜ„ÄÇÈÇ£‰πà‰∏∫‰ªÄ‰πàËøòË¶Å‰∏ìÈó®ÂºÑÂá∫Êù•‰∏Ä‰∏™ Module Á±ªÂë¢Ôºü‰∏∫‰∫ÜËÆ©Ê®°ÂùóÊõ¥ÊäΩË±°ÔºåÂèØ‰ª•ÁõëÂê¨Âà∞Â§ñÈÉ®‰º†Êù•ÁöÑ‰∫ã‰ª∂ÂÅöÁõ∏Â∫îÁöÑÂ§ÑÁêÜ„ÄÇ Âõ†Ê≠§ÔºåÂú®ÊØè‰∏™Ê®°ÂùóÊ≥®ÂÜåÊàêÂäüÁöÑÊó∂ÂÄôËøò‰ºö‰∏∫ÊØè‰∏™Ê®°ÂùóÊ≥®ÂÜå‰∫ã‰ª∂ÈÄöÁü•„ÄÇÂÆÉÁöÑÂÆûÁé∞ÊñπÂºèÂÖ∂ÂÆûÂ∞±ÊòØ‰∏Ä‰∏™ËßÇÂØüËÄÖÊ®°Âºè„ÄÇÈ¢ÑÂÖàËÆæÂÆö‰∫ÜÂêÑÁßçÂèØËÉΩËß¶ÂèëÁöÑ event„ÄÇÂú®Ê≥®ÂÜåÊ®°ÂùóÁöÑÊó∂ÂÄôÔºå‰ºöÈÅçÂéÜÊâÄÊúâÁöÑ eventÔºåÂú®Ê®°Âùó‰∏≠ÊâæÊòØÂê¶ÂÆûÁé∞‰∫ÜËØ• event ÁöÑÊñπÊ≥ï„ÄÇÂØπ‰∫éÊúâ module ÂÆûÁé∞ÁöÑ selÔºå‰ºöÊää sel Â≠òÂà∞ BHSelectorByEvent ‰∏≠Âéª„ÄÇÂÜçÊää module Â≠òÂà∞ BHModuleByEvent Â≠óÂÖ∏‰∏≠ sel ÂØπÂ∫îÁöÑÊï∞ÁªÑ‰∏≠ÔºåÂπ∂Êää modules ÊåâÁÖß‰ºòÂÖàÁ∫ßÊéíÂ∫è„ÄÇ ËøôÊ†∑ÔºåÂ∞±ÂèØ‰ª•Âú®‰ªªÊÑèÂú∞ÊñπË∞ÉÁî®ÊñπÊ≥ï [[BHModuleManager sharedManager] triggerEvent:xxxEvent];ÔºåËß¶Âèë event„ÄÇ ÁªôÊØè‰∏™Ê®°ÂùóÊ≥®ÂÜå‰∫ã‰ª∂ÔºåÂèØ‰ª•ÂæàÂ•ΩÂú∞ÂáèÂ∞ë AppDelegate ‰∏≠ÁöÑ‰ª£Á†ÅÈáèÔºåAppDelegate ‰∏≠ÁöÑ‰ª£Á†ÅË¢´ÂàÜÊï£Âà∞‰∫ÜÂêÑ‰∏™Ê®°Âùó‰∏≠„ÄÇ ‰∏∫‰ªÄ‰πàË¶ÅÊúâ‰ºòÂÖàÁ∫ßÂë¢ÔºüÂõ†‰∏∫ÂèØËÉΩÂ≠òÂú®Ê®°Âùó AÔºåBÔºåA ‰æùËµñ‰∫é BÔºå‰ΩÜÊòØÂ¶ÇÊûú A ÂÖàÂàùÂßãÂåñÔºåÈÇ£‰πàÂ∞±‰ºö‰∫ßÁîüÈóÆÈ¢ò„ÄÇ Service Ê≥®ÂÜå‰∏é‰ΩøÁî®Service Ë¥üË¥£Ê®°Âùó‰πãÈó¥ÁöÑÈÄö‰ø°„ÄÇService ÂøÖÈ°ªË¶ÅÊª°Ë∂≥ BHServiceProtocol ÂçèËÆÆ„ÄÇ‰∏ÄËà¨Êàë‰ª¨‰ºöÂ∞Ü ViewController Ê≥®ÂÜå‰∏∫ ServiceÔºåÂΩìÁÑ∂‰ΩøÁî®‰∏ìÈó®ÁöÑ‰∏Ä‰∏™ Service Á±ª‰πüÊòØÂèØ‰ª•ÁöÑ„ÄÇ Service ÁöÑÊ≥®ÂÜåÂíå Module ÁöÑÊ≥®ÂÜåÊòØÁ±ª‰ººÁöÑ„ÄÇÈÉΩÂèØ‰ª•ÈÄöËøá plist ÈùôÊÄÅÊ≥®ÂÜåÔºåÂä®ÊÄÅÊ≥®ÂÜåÔºå‰ª•ÂèäÊ≥®Ëß£Ê≥®ÂÜå„ÄÇËøôÈáåÂ∞±‰∏çËØ¶ÁªÜËØ¥Êòé‰∫Ü„ÄÇ ‰ΩøÁî®ÊñπÂºèÂ¶Ç‰∏ãÔºö 1id&lt;HomeServiceProtocol&gt; homeVc = [[BeeHive shareInstance] createService:@protocol(HomeServiceProtocol)]; ÈÄöËøá createService: ‰º†ÂÖ• protocol Â∞±ÂèØ‰ª•ÊãøÂà∞ service ÁöÑÂÆû‰æã„ÄÇË∞ÉÁî® HomeServiceProtocol ‰∏≠Â£∞ÊòéÁöÑÊñπÊ≥ï‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS ‰∏≠ va_list ÁöÑ‰ΩøÁî®]]></title>
    <url>%2F2017%2F12%2F22%2Fva_list%2F</url>
    <content type="text"><![CDATA[Áúã FMDB Ê∫êÁ†ÅÁöÑÊó∂ÂÄôÁúãÂà∞‰∫Ü va_list ÁöÑ‰ΩøÁî®„ÄÇËøô‰∏™‰∏úË•øÁöÑ‰∏ªË¶ÅÁî®ÈÄîÂ∞±ÊòØ‰∏çÁ°ÆÂÆö‰∏™Êï∞ÁöÑÂÖ•ÂèÇ„ÄÇ‰∏ÄËà¨Êàë‰ª¨ÁöÑÂÖ•ÂèÇ‰∏çÁ°ÆÂÆöÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨‰ºö‰ΩøÁî®‰∏Ä‰∏™ dic Êù•‰øùÂ≠òÊï∞ÊçÆÔºåÂΩìÁÑ∂ÁÆÄÂçïÁöÑÊñπÂºèÂ∞±ÊòØ‰ΩøÁî®Êú¨ÁØáË¶ÅËØ¥ÁöÑËøô‰∏™„ÄÇFMDB Êèê‰æõ‰∫Ü‰∏çÁ°ÆÂÆöÂèÇÊï∞‰∏™Êï∞ÁöÑ sql ËØ≠Âè•ÁöÑË∞ÉÁî®ÊñπÊ≥ï„ÄÇËøô‰∏™ÂäüËÉΩÂÖ∂ÂÆûÂæàÁ±ª‰ºº‰∫éÁ≥ªÁªüÁöÑ NSLog„ÄÇ ‰ΩøÁî®ÊñπÂºèÂÖàÊù•Áúã‰∏Ä‰∏ã FMDB ÁöÑ‰ΩøÁî®Âú∫ÊôØ(Áï•Êúâ‰øÆÊîπ)Ôºö 123456789101112131415161718- (BOOL)executeUpdate:(NSString*)sql, ... &#123; va_list args; va_start(args, sql); ... [self getStringWithVAList:(va_list)args]; ... va_end(args); return result;&#125;- (void)getStringWithVAList:(va_list)args &#123; while (index &lt; queryCount) &#123; queryString = va_arg(args, NSString*); index+=1; &#125;&#125; Ëß£ÈáäÁÆÄËÄåË®Ä‰πãÔºåva_list ÁöÑÂéüÁêÜÂ∞±ÊòØÔºöÂáΩÊï∞ÁöÑÂèÇÊï∞ÊòØÂ≠òÂÇ®Âú®Ê†à‰∏≠ÁöÑÔºåÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰∏çÂÅúÁöÑÁßªÂä®ÊåáÈíàÔºåÊù•Ëé∑ÂèñÊ†à‰∏≠ÁöÑÊâÄÊúâÂÖÉÁ¥†„ÄÇ ‰∏äÈù¢ÊòØ FMDB Êõ¥Êñ∞ sql ÁöÑÊâßË°åÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïÂÖàÊé•Âèó‰∏Ä‰∏™ sql Â≠óÁ¨¶‰∏≤Ôºå‰πãÂêéÊòØÂèØÂèòÁöÑÂèÇÊï∞„ÄÇÂèØÂèòÂèÇÊï∞‰ºöÂú®ÊñπÊ≥ï‰∏≠Â°´ÂÖ• sql Èáå„ÄÇ va_list args ÂÖ∂ÂÆûÁõ∏ÂΩì‰∫éÂ£∞Êòé‰∫Ü‰∏Ä‰∏™Á±ªÂûã‰∏∫ va_list Âêç‰∏∫ args ÁöÑÂèòÈáè„ÄÇ va_start(args, sql) Ë°®Á§∫ÁöÑÊòØÂèñÂà∞ sql Âêé‰∏Ä‰∏™ÂèÇÊï∞ÁöÑÂú∞ÂùÄ‰∫§Áªô args„ÄÇÈÄöËøáËøô‰∏ÄÊ≠•ÂêéÔºå‰Ω†Â∞±ÂèØ‰ª•Â∞ÜÊää args ÂΩìÂÅö‰∏Ä‰∏™ÂèòÈáè‰ªªÊÑè‰º†ÈÄí‰∫Ü„ÄÇ va_arg(args, NSString*) ÂèØ‰ª•Ëé∑ÂæóÂΩìÂâçÊåáÂêëÁöÑÂèÇÊï∞ÔºåÂπ∂‰∏îÂ∞ÜÊåáÈíàÁßªÂä®Âà∞Âêé‰∏Ä‰∏™ÂèÇÊï∞„ÄÇÊåáÈíàÂπ∂‰∏çÁü•ÈÅìË¶ÅÁßªÂä®Â§öÂ∞ë‰∏™Â≠óËäÇÔºåÊâÄ‰ª•Á¨¨‰∫å‰∏™ÂèÇÊï∞‰º†ÂÖ•‰∏Ä‰∏™Á±ªÂûãÔºå‰∫§‰ª£ÊåáÈíàÁöÑÂÅèÁßªÈáè„ÄÇÊâÄ‰ª•ËøôÈáåË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºå‰∏çÂêåÁöÑÁ±ªÂûãÂÅèÁßªÈáèÊòØ‰∏çÂêåÁöÑÔºåÊâÄ‰ª•‰Ω†ÂøÖÈ°ª‰∫ãÂÖàÁü•ÈÅìÊØè‰∏Ä‰∏™ÂèØÂèòÂèÇÊï∞ÁöÑÁ±ªÂûãÔºåÁÑ∂Âêé‰∏∫‰∏çÂêåÁ±ªÂûãËÆæÁΩÆ‰∏çÂêåÂÅèÁßª„ÄÇÊØîÂ¶ÇËØ¥ FMDBÔºåÁîöËá≥ NSLogÔºåÈÉΩÈúÄË¶ÅÂú®Á¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏≠‰∏∫‰∏çÂêåÁ±ªÂûãËÆæÁΩÆ‰∏çÂêåÁöÑÂç†‰ΩçÁ¨¶ÔºåÂ¶Ç %d,%@„ÄÇÂú®Â§ÑÁêÜÁöÑÊó∂ÂÄôÂ∞±‰ºö‰ªéÂâçÂæÄÂêéÊâ´ÊèèÂ≠óÁ¨¶‰∏≤ÔºåËß£ÊûêËøô‰∫õÂç†‰ΩçÁ¨¶Ôºå‰ª•Ê≠§Ëé∑ÂæóÂèØÂèòÂèÇÊï∞ÁöÑÁ±ªÂûã„ÄÇËøòË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÊàë‰ª¨ÈúÄË¶ÅËá™Â∑±Á≤æÁ°ÆÊéßÂà∂Âæ™ÁéØÊ¨°Êï∞ÔºåÊó†ÈôêÂà∂ÁöÑ va_arg() ÁöÑË∞ÉÁî®‰ºö‰∫ßÁîüË∂äÁïå„ÄÇÊâÄ‰ª•Áªº‰∏äÔºåva_list ‰∏ç‰ºöÁü•ÈÅìÊàë‰ª¨ÂèÇÊï∞ÁöÑÊï∞ÊçÆÁ±ªÂûãÂíå‰∏™Êï∞ÔºåËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πàÊàë‰ª¨ÈúÄË¶ÅÂç†‰ΩçÁ¨¶ÁöÑÂéüÂõ†„ÄÇ va_end(args) Ë°®Á§∫Ê∏ÖÁ©∫ args„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[FMDB ÂèäÂÖ∂Â∞ÅË£ÖÊ°ÜÊû∂ÁöÑÂÆûÁé∞ËøáÁ®ã]]></title>
    <url>%2F2017%2F11%2F30%2FFMDB%2F</url>
    <content type="text"><![CDATA[iOS ‰∏äÁöÑÊï∞ÊçÆÂ∫ìÁî®ÁöÑ‰∏çÂ§öÔºåÁúã‰∏ÄÁúã‰∏ªÊµÅÁöÑ FMDB ‰ª•ÂèäÂÖ∂Â∞ÅË£ÖÊ°ÜÊû∂ÊòØÊÄé‰πàÂÆûÁé∞ÁöÑ„ÄÇ ÁÆÄÂçïSQLÊ£ÄÁ¥¢Ê£ÄÁ¥¢Êï∞ÊçÆÊ£ÄÁ¥¢Âçï‰∏™Âàó1select prod_name from products; Ê£ÄÁ¥¢Â§ö‰∏™Âàó1select prod_id, prod_name, prod_price from products; Ê£ÄÁ¥¢ÊâÄÊúâÂàó1select * from produces Ê£ÄÁ¥¢ÁöÑÂàóÂéªÈáç1select distinct prod_name from products; ÈôêÂà∂Â±ïÁ§∫‰∏™Êï∞1select prod_name from products limit 5; ÊéíÂ∫èÊ£ÄÁ¥¢ÁÆÄÂçïÊéíÂ∫è1select prod_name from products order by prod_name; Â§öÂàóÊéíÂ∫è1select prod_id, prod_name, prod_price from products order by prod_name, prod_id; ÊåáÂÆöÊéíÂ∫èÊñπÂêë1select prod_id, prod_name, prod_price from products order by prod_name desc, prod_id limit 6; ËøáÊª§ËøáÊª§Êï∞ÊçÆwhere ËøáÊª§1select prod_name from products where prod_price = 123; ËåÉÂõ¥ÂÄº1select prod_name from products where prod_id between 1 and 100; Á©∫ÂÄº123select price_id from products where prod_name is null;// ÈùûÁ©∫ÂÄºselect price_id from products where prod_name is not null; and or Êìç‰ΩúÁ¨¶1select prod_price from products where (vend_id = 1003 or vend_id = 1004) and prod_price &gt;= 100; ÊåáÂÆöËåÉÂõ¥1select prod_name from products where vend_id in (1003, 1004); Ê≠£ÂàôËøáÊª§Â≠óÁ¨¶ÂåÖÂê´ÂåπÈÖç1select prod_name from products where prod_name regexp '1000'; .ÂåπÈÖç‰ªªÊÑè‰∏Ä‰∏™Â≠óÁ¨¶Ôºö 1select prod_name from products where prod_name regexp '.000'; OR ÂåπÈÖç‰ªªÊÑè‰∏Ä‰∏™Êù°‰ª∂1select prod_name from products where prod_name regexp '1000|2000|3000'; ÂåπÈÖçÂá†‰∏™Â≠óÁ¨¶‰∏≤‰πã‰∏Ä1select prod_name from products where prod_name regexp '[123] Ton'; 1select prod_name from products where prod_name regexp '[1-5a-z] Ton'; ^ Ë°®Á§∫Âê¶ÂÆöÔºö 1select prod_name from products where prod_name regexp '[^123] Ton'; ÂåπÈÖçÂ§ö‰∏™ÂÆû‰æã ÂÖÉÂ≠óÁ¨¶ ËØ¥Êòé + 1‰∏™ÊàñÂ§ö‰∏™ ? 0‰∏™Êàñ‰∏Ä‰∏™ * 0‰∏™ÊàñÂ§ö‰∏™ {n} ÊåáÂÆöÊï∞ÁõÆÂåπÈÖç {n,} ‰∏çÂ∞ë‰∫éÊåáÂÆöÊï∞ÁõÆÂåπÈÖç {n,m} ÂåπÈÖçÊï∞ÁõÆËåÉÂõ¥ Áõ¥Êé•Ë∑üÂú®Ë¶ÅÂåπÈÖçÁöÑÂ≠óÁ¨¶ÂêéÈù¢ÔºåÂ¶ÇÊûúË¶ÅÂåπÈÖçÁöÑÊòØÂ≠óÁ¨¶‰∏≤ÔºåÈúÄË¶ÅÁªôÂ≠óÁ¨¶‰∏≤Âä†‰∏äÊã¨Âè∑ ÂÆö‰ΩçÁ¨¶ ÂÖÉÂ≠óÁ¨¶ ËØ¥Êòé ^ ÊñáÊú¨ÂºÄÂßã $ ÊñáÊú¨ÁªìÊùü ÂáΩÊï∞Êï∞ÊçÆËÅöÂêàÂØπ‰∏Ä‰∏™ÂàóÁöÑÊâÄÊúâË°åËøõË°åÊìç‰ΩúÔºåËøîÂõû‰∏Ä‰∏™ËÅöÂêàÁöÑÂÄº sum() Ê±ÇÂíåavg() Ê±ÇÂπ≥ÂùáÂÄº12select sum(prod_price) as sum_price from products;select avg(prod_price) as avg_price from products; count() Ê±ÇÊï∞Èáè1234 // ÊéíÈô§ prod_price ‰∏∫ null ÁöÑselect count(prod_price) as num_price from products;// count(*) Ë°®Á§∫ÊâÄÊúâË°åÊï∞select count(*) as all_row from products; min() max()Ê±ÇÊúÄÂ∞èÊúÄÂ§ß12select min(prod_price) as min_price from products;select max(prod_price) as max_price from products; ÂàÜÁªÑÂàÜÁªÑÁöÑ‰ΩúÁî®ÊòØÂØπÊâßË°åÂàÜÁªÑÔºåÂπ∂ÂØπÁªìÊûúËøõË°åËÅöÂêà ÂàõÂª∫ÂàÜÁªÑËé∑Âèñ‰∏çÂêåÂÄºÁöÑ vend_id Âπ∂Â∞ÜÊØè‰∏™ÂÄºÁöÑÊï∞Èáè‰ª• num_prods Â≠óÊÆµÂ±ïÁ§∫ 1select vend_id, count(*) as num_prods from products group by vend_id; ËøáÊª§ÂàÜÁªÑhaving Âú®Êï∞ÊçÆÂàÜÁªÑÂêéËøõË°åËøáÊª§Ôºåwhere Âú®Êï∞ÊçÆÂàÜÁªÑÂâçËøõË°åËøáÊª§ 1select vend_id, count(*) as num_prods from products where prod_price &gt;= 10 group by vend_id having count(*) &gt;= 2; ÂàÜÁªÑÂíåÊéíÂ∫èÂú®‰∏äÈù¢ÁöÑÂü∫Á°Ä‰∏äÂÜçÂØπÊüê‰∏ÄÂàóÊéíÂ∫èÔºö 1select vend_id, count(*) as num_prods from products where prod_price &gt;= 10 group by vend_id having count(*) &gt;= 2 order by num_prods; ËÅîÁªìË°®ËÅîÁªìÂÆö‰πâÊ£ÄÁ¥¢Êï∞ÊçÆÁöÑÊó∂ÂÄôÂØπÂ§öÂº†Ë°®ËøõË°åÊìç‰Ωú„ÄÇ Ë≠¨Â¶Ç‰∏Ä‰∏™ÂïÜÂìÅË°®ÔºåË¶ÅËÆ∞ÂΩïËøô‰∏™ÂïÜÂìÅÁöÑ‰æõÂ∫îÂïÜÁöÑ‰ø°ÊÅØ„ÄÇÂ¶ÇÊûú‰æõÂ∫îÂïÜÁöÑ‰ø°ÊÅØÂ≠òÂú®Ëøô‰∏™ÂïÜÂìÅË°®‰∏≠ÔºåÂ∞±‰ºöÂ≠òÂú®ËØ∏Â§öÈáçÂ§çÊï∞ÊçÆ„ÄÇÂõ†Ê≠§ÔºåÂ∫îËØ•ËÆ≤‰æõÂ∫îÂïÜ‰ø°ÊÅØ‰πüÂçïÁã¨ÂàõÂª∫‰∏Ä‰∏™Ë°®„ÄÇ‰æõÂ∫îÂïÜÁöÑ ID ‰∏∫‰æõÂ∫îÂïÜË°®ÁöÑ‰∏ªÈîÆ„ÄÇÂïÜÂìÅË°®Âè™‰øùÂ≠òËøô‰∏™‰æõÂ∫îÂïÜÁöÑ IDÔºåËøô‰∏™‰æõÂ∫îÂïÜÁöÑ ID Âè´ÂÅöÂïÜÂìÅË°®ÁöÑÂ§ñÈîÆÔºå‰æõÂ∫îÂïÜË°®ÂíåÂïÜÂìÅË°®ÈÄöËøáËøô‰∏™Â§ñÈîÆËøõË°åÁöÑÂÖ≥ËÅî„ÄÇ ÂàõÂª∫ËÅîÁªì1select vend_name, prod_name, prod_price from vendors, products where vendors.vend_id = products.vend_id order by vend_name, prod_name; ‰∏äÈù¢‰ªé‰æõÂ∫îÂïÜ(vendors) ÂíåÂïÜÂìÅ(products)‰∏§Âº†Ë°®‰∏≠Âèñ vend_name,prod_name,prod_price Ëøô‰∏âÂàóÁöÑÊï∞ÊçÆ„ÄÇÈÄöËøá vend_id ËøõË°åÂÖ≥ËÅî„ÄÇ Áõ∏ÂΩì‰∫éÂú®ËøêË°åÊó∂Êää‰∏§Âº†Ë°®ÈÄöËøá‰∏ªÈîÆÂíåÂ§ñÈîÆÂÖ≥ËÅîÔºåÁªìÂêàÊàê‰∫Ü‰∏ÄÂº†Ë°®„ÄÇ Â§ñËøûÊé•Ë¶ÅÊü•ËØ¢Ë°®A‰∏≠ÊâÄÊúâÊª°Ë∂≥Êù°‰ª∂ÁöÑË°åÔºåÂπ∂È°∫‰æøÊääË°®B‰∏≠ÁöÑÁõ∏Â∫îË°åÂèñÂá∫Êù•Ôºö 1SELECT * FROM player LEFT JOIN team on player.team_id = team.team_id where player.age &lt; 30 ‰ªé player Ë°®‰∏≠ÊääÂπ¥Á∫™Â∞è‰∫é 30 ÁöÑÈÉΩÂèñÂá∫Êù•ÔºåÂπ∂‰∏îÊää player ÂØπÂ∫îÁöÑ team ÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ‰ªé team Ë°®‰∏≠ÂèñÂá∫„ÄÇ on ÂÖ≥ÈîÆÂ≠óÁî®‰∫éÈÖçÂêà left joinÔºåÊâæÂà∞ player Áõ∏ÂÖ≥ÁöÑ team Â¢ûÂà†ÊîπÊèíÂÖ•ÊèíÂÖ•‰∏ÄË°å123456789insert into customers( cust_name, cust_city, cust_address) values ( 'zachary', 'shanghai', 'minhang'); ÊèíÂÖ•Â§ö‰∏™Ë°å12345678910111213insert into customers( cust_name, cust_city, cust_address) values ( 'zachary', 'shanghai', 'minhang'), ( 'zachary2', 'shanghai2', 'minhang2'); ÊèíÂÖ•Ê£ÄÁ¥¢ÁöÑÊï∞ÊçÆ123456789insert into customers( cust_name, cust_city, cust_address) select cust_name, cust_city, cust_address from custnew; Êää‰ªé custnew Ë°®‰∏≠Ê£ÄÁ¥¢Âá∫ÁöÑËøôÂá†ÂàóÊèíÂÖ•Âà∞ customers ‰∏≠ Êõ¥Êñ∞Êï∞ÊçÆ1234update customersset cust_name = 'zhang', cust_address = NULLwhere cust_id = 10004; Âà†Èô§Êï∞ÊçÆ12delete from customerswhere cust_id = 1004; Êìç‰ΩúË°®ÂàõÂª∫Ë°®1234567create table customer ( cust_id int not null auto_increment, cust_name char(50) not null, cust_address char(50) default 'shanghai', cust_email char(50), primary key (cust_id)) engine=innodb; ÂàõÂª∫Ë°®ÁöÑÊó∂ÂÄôË¶ÅÊåáÂÆöÂ≠óÊÆµÔºåÁ±ªÂûãÔºõ ÈùûÁ©∫ÁöÑÂ≠óÊÆµË¶ÅÊâãÂä®ÈÄöËøá not null Ê†áËØÜÔºõ ÂèØ‰ª•ÈÄöËøá default ÊåáÂÆöÈªòËÆ§ÂÄºÔºõ Ë°®ÁöÑ‰∏ªÈîÆÈÄöËøáÂàõÂª∫Ë°®ÁöÑÊó∂ÂÄôÁî® primary key ÊåáÂÆöÔºåÂπ∂‰∏î‰∏ªÈîÆÊòØÂøÖÈ°ªÂîØ‰∏ÄÁöÑÔºåÊâÄ‰ª•ÂèØ‰ª•ÈÄöËøá auto_increment Ê†áËØÜÂÖ∂Ëá™Â¢û„ÄÇ ÊúÄÂêé engine=innodb ÊåáÂÆöÂºïÊìé„ÄÇ Êõ¥Êñ∞Ë°®ÁªìÊûÑÊ∑ªÂä†ÂàóÂíåÂà†Èô§ÂàóÂàÜÂà´‰ΩøÁî® add Âíå drop 123alter table vendorsadd vend_phone char(20),drop column vend_num; Âà†Èô§Ë°®1drop table customer2; Êï∞ÊçÆÂ∫ìÂü∫Á°Ä‰∫ãÂä°‰ªÄ‰πàÊòØ‰∫ãÂä°Ôºü‰∫ãÂä°Â∞±ÊúâÂõõÂ§ßÁâπÊÄßÔºöACID AÔºöÂéüÂ≠êÊÄß CÔºö‰∏ÄËá¥ÊÄß IÔºöÈöîÁ¶ªÊÄß DÔºöÊåÅ‰πÖÊÄß Âπ∂ÂèëÂ≠òÂú®ÂºÇÂ∏∏ ËÑèËØªÔºöËØªÂà∞‰∫ÜÂÖ∂‰ªñ‰∫ãÂä°ËøòÊ≤°ÊúâÊèê‰∫§ÁöÑÊï∞ÊçÆ„ÄÇ ‰∏çÂèØÈáçÂ§çËØªÔºöÂØπÊüêÊï∞ÊçÆËøõË°åËØªÂèñÔºåÂèëÁé∞‰∏§Ê¨°ËØªÂèñÁöÑÁªìÊûú‰∏çÂêåÔºå‰πüÂ∞±ÊòØËØ¥Ê≤°ÊúâËØªÂà∞Áõ∏ÂêåÁöÑÂÜÖÂÆπ„ÄÇËøôÊòØÂõ†‰∏∫ÊúâÂÖ∂‰ªñ‰∫ãÂä°ÂØπËøô‰∏™Êï∞ÊçÆÂêåÊó∂ËøõË°å‰∫Ü‰øÆÊîπÊàñÂà†Èô§„ÄÇ ÂπªËØªÔºö‰∫ãÂä°AÊ†πÊçÆÊù°‰ª∂Êü•ËØ¢ÂæóÂà∞‰∫ÜNÊù°Êï∞ÊçÆÔºå‰ΩÜÊ≠§Êó∂‰∫ãÂä°BÊõ¥ÊîπÊàñËÄÖÂ¢ûÂä†‰∫ÜMÊù°Á¨¶Âêà‰∫ãÂä°AÊü•ËØ¢Êù°‰ª∂ÁöÑÊï∞ÊçÆÔºåËøôÊ†∑ÂΩì‰∫ãÂä°AÂÜçÊ¨°ËøõË°åÊü•ËØ¢ÁöÑÊó∂ÂÄôÂèëÁé∞‰ºöÊúâN+MÊù°Êï∞ÊçÆÔºå‰∫ßÁîü‰∫ÜÂπªËØª„ÄÇ Êï∞ÊçÆÂ∫ìËÆæËÆ°ËåÉÂºèËÆæËÆ°Êï∞ÊçÆÂ∫ìÊ®°ÂûãÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÂØπÂÜÖÈÉ®Â±ûÊÄß‰πãÈó¥ÁöÑËÅîÁ≥ªÁöÑÂêàÁêÜÂåñÁ®ãÂ∫¶ËøõË°åÂÆö‰πâ„ÄÇËøôÁßçËßÑËåÉÂè´ÂÅöËåÉÂºè(NF)„ÄÇ 1NF ÊåáÁöÑÊòØÊï∞ÊçÆÂ∫ìË°®‰∏≠ÁöÑ‰ªª‰ΩïÂ±ûÊÄßÈÉΩÊòØÂéüÂ≠êÊÄßÁöÑÔºå‰∏çÂèØÂÜçÂàÜ„ÄÇ 2NF ÊåáÁöÑÊï∞ÊçÆË°®ÈáåÁöÑÈùû‰∏ªÂ±ûÊÄßÈÉΩË¶ÅÂíåËøô‰∏™Êï∞ÊçÆË°®ÁöÑÂÄôÈÄâÈîÆÊúâÂÆåÂÖ®‰æùËµñÂÖ≥Á≥ª„ÄÇÊØîÂ¶Ç: 123456‰∏ÄÂº†Ë°®‰∏≠ÁöÑÂ≠óÊÆµÂ¶Ç‰∏ã(ÁêÉÂëòÁºñÂè∑, ÊØîËµõÁºñÂè∑) ‚Üí (ÂßìÂêç, Âπ¥ÈæÑ, ÊØîËµõÊó∂Èó¥, ÊØîËµõÂú∫Âú∞ÔºåÂæóÂàÜ)ÈúÄË¶ÅÊãÜÂàÜ‰∏∫‰∏§Ë°åË°®=&gt;(ÁêÉÂëòÁºñÂè∑) ‚Üí (ÂßìÂêçÔºåÂπ¥ÈæÑ)(ÊØîËµõÁºñÂè∑) ‚Üí (ÊØîËµõÊó∂Èó¥, ÊØîËµõÂú∫Âú∞) 3NF Âú®Êª°Ë∂≥ 2NF ÁöÑÂêåÊó∂ÔºåÂØπ‰ªª‰ΩïÈùû‰∏ªÂ±ûÊÄßÈÉΩ‰∏ç‰º†ÈÄí‰æùËµñ‰∫éÂÄôÈÄâÈîÆ„ÄÇÊØîÂ¶ÇÔºö 1234(ÁêÉÂëòÁºñÂè∑) ‚Üí (ÂßìÂêçÔºåÂπ¥ÈæÑÔºåÁêÉÈòüÂêçÁß∞ÔºåÁêÉÈòüÊïôÁªÉ)=&gt;(ÁêÉÂëòÁºñÂè∑) ‚Üí (ÂßìÂêçÔºåÂπ¥ÈæÑ)(ÁêÉÈòüÂêçÁß∞) ‚Üí (ÁêÉÈòüÊïôÁªÉ) Ë∂ÖÈîÆÔºöËÉΩÂîØ‰∏ÄÊ†áËØÜÂÖÉÁªÑÁöÑÂ±ûÊÄßÈõÜÂè´ÂÅöË∂ÖÈîÆ„ÄÇ ÂÄôÈÄâÈîÆÔºöÂ¶ÇÊûúË∂ÖÈîÆ‰∏çÂåÖÊã¨Â§ö‰ΩôÁöÑÂ±ûÊÄßÔºåÈÇ£‰πàËøô‰∏™Ë∂ÖÈîÆÂ∞±ÊòØÂÄôÈÄâÈîÆ„ÄÇ FMDBÂü∫Êú¨ÁªìÊûÑFMDB ÊòØ sqlite ÁöÑÁÆÄÂçïÂ∞ÅË£ÖÔºå‰∏ªË¶ÅÁî®Êù•ÊâßË°å sql ËØ≠Âè•ÔºåÂπ∂ÂèñÂá∫Êï∞ÊçÆ„ÄÇ‰∏ªË¶ÅÊúâ‰∏â‰∏™Á±ªÔºö FMDatabase : FMDB ÊúÄÈáçË¶ÅÁöÑÁ±ªÔºåÁî®Êù•‰øùÂ≠ò database ÁöÑÂÆû‰æãÔºåÂπ∂ÂØπËøô‰∏™ db ÊâßË°å sql ËØ≠Âè•„ÄÇ FMResultSetÔºö‰øùÂ≠ò‰∫Ü sql ËØ≠Âè•ÁöÑÊâßË°åÁªìÊûú„ÄÇ FMDatabaseQueueÔºöÂú®Â§öÁ∫øÁ®ãÁéØÂ¢É‰∏ãÊâßË°å sql„ÄÇ Âü∫Êú¨‰ΩøÁî®Âª∫Á´ãÂºÄÂêØÊï∞ÊçÆÂ∫ìÂíåÂÖ≥Èó≠12345678910111213// ÂàõÂª∫Êï∞ÊçÆÂ∫ìNSString* dir = [NSSearchPathForDirectoriesInDomains( NSLibraryDirectory, NSUserDomainMask, YES) lastObject];NSString* dbPath = [dir stringByAppendingPathComponent:@"student.sqlite"];FMDatabase* db = [FMDatabase databaseWithPath:dbPath];//2.Ëé∑ÂèñÊï∞ÊçÆÂ∫ìif ([db open]) &#123; NSLog(@"ÊâìÂºÄÊï∞ÊçÆÂ∫ìÊàêÂäü");&#125; else &#123; NSLog(@"ÊâìÂºÄÊï∞ÊçÆÂ∫ìÂ§±Ë¥•");&#125; ÂΩìÊñá‰ª∂‰∏çÂ≠òÂú®Êó∂Ôºåfmdb ‰ºöËá™Â∑±ÂàõÂª∫‰∏Ä‰∏™„ÄÇ 12// ÂÖ≥Èó≠Êï∞ÊçÆÂ∫ì[db close]; ÂàõÂª∫Âà†Èô§Ë°®123456789101112//3.ÂàõÂª∫Ë°®BOOL result = [db executeUpdate:@"CREATE TABLE IF NOT EXISTS t_student ( id integer PRIMARY KEY AUTOINCREMENT, name text NOT NULL, age integer NOT NULL, sex text NOT NULL);"];if (result) &#123; NSLog(@"ÂàõÂª∫Ë°®ÊàêÂäü");&#125; else &#123; NSLog(@"ÂàõÂª∫Ë°®Â§±Ë¥•");&#125; 1234567// Â¶ÇÊûúË°®Ê†ºÂ≠òÂú® ÂàôÈîÄÊØÅBOOL result = [_db executeUpdate:@"drop table if exists t_student"];if (result) &#123; NSLog(@"Âà†Èô§Ë°®ÊàêÂäü");&#125; else &#123; NSLog(@"Âà†Èô§Ë°®Â§±Ë¥•");&#125; Â¢ûÂà†ÊîπÊü•Â¢û123456789101112131415161718for (int i = 0; i &lt; 4; i++) &#123; //ÊèíÂÖ•Êï∞ÊçÆ NSString * name = [NSString stringWithFormat: @ "ÊµãËØïÂêçÂ≠ó%@", @(mark_student)]; int age = mark_student; NSString * sex = @ "Áî∑"; mark_student++; //1.executeUpdate:‰∏çÁ°ÆÂÆöÁöÑÂèÇÊï∞Áî®ÔºüÊù•Âç†‰ΩçÔºàÂêéÈù¢ÂèÇÊï∞ÂøÖÈ°ªÊòØocÂØπË±°ÔºåÔºõ‰ª£Ë°®ËØ≠Âè•ÁªìÊùüÔºâ BOOL result = [db executeUpdate: @ "INSERT INTO t_student (name, age, sex) VALUES (?,?,?)", name, @(age), sex]; //2.executeUpdateWithForamatÔºö‰∏çÁ°ÆÂÆöÁöÑÂèÇÊï∞Áî®%@Ôºå%dÁ≠âÊù•Âç†‰Ωç ÔºàÂèÇÊï∞‰∏∫ÂéüÂßãÊï∞ÊçÆÁ±ªÂûãÔºåÊâßË°åËØ≠Âè•‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºâ // BOOL result = [_db executeUpdateWithFormat:@"insert into t_student (name,age, sex) values (%@,%i,%@)",name,age,sex]; //3.ÂèÇÊï∞ÊòØÊï∞ÁªÑÁöÑ‰ΩøÁî®ÊñπÂºè // BOOL result = [_db executeUpdate:@"INSERT INTO t_student(name,age,sex) VALUES (?,?,?);" withArgumentsInArray:@[name,@(age),sex]]; if (result) &#123; NSLog(@ "ÊèíÂÖ•ÊàêÂäü"); &#125; else &#123; NSLog(@ "ÊèíÂÖ•Â§±Ë¥•"); &#125;&#125; ÈÄöËøá executeUpdate Êù•ÊâßË°åÈùû select ÁöÑÂ¢ûÂà†ÊîπËØ≠Âè•„ÄÇÂè¶Â§ñÔºåÊúâ‰∏âÁßçÊñπÂºèÁªô sql ‰º†ÂèÇÔºö ‰ΩøÁî® ? ÂÅöÂç†‰ΩçÁ¨¶ÔºåÈÇ£‰πà‰º†ÂèÇÂ∞±ÂøÖÈ°ªÊòØ oc ÂØπË±°„ÄÇ ‰ΩøÁî® %@ Á≠âÂÅöÂç†‰ΩçÁ¨¶Ôºå‰º†ÂèÇÂèØ‰ª•ÊòØ‰ªªÊÑèÁõ∏‰æùÁ±ªÂûã„ÄÇ ‰ΩøÁî®Êï∞ÁªÑ‰º†ÂèÇÔºåÂç†‰ΩçÁ¨¶ËøòÊòØ‰ΩøÁî® ?ÔºåÊï∞ÁªÑ‰∏≠‰øùÂ≠òÁöÑ‰πüÊòØ oc ÂØπË±°„ÄÇ Âà†ÊîπËøô‰∏§‰∏™ÂíåÂ¢ûÂä†Êï∞ÊçÆÊ≤°‰ªÄ‰πà‰∏çÂêåÔºåÂõ†Ê≠§Â∞±ÊîæÂú®‰∏ÄËµ∑‰∫ÜÔºö 12345678910//1.‰∏çÁ°ÆÂÆöÁöÑÂèÇÊï∞Áî®ÔºüÊù•Âç†‰Ωç ÔºàÂêéÈù¢ÂèÇÊï∞ÂøÖÈ°ªÊòØocÂØπË±°,ÈúÄË¶ÅÂ∞ÜintÂåÖË£ÖÊàêOCÂØπË±°Ôºâint idNum = 11;BOOL result1 = [_db executeUpdate: @ "delete from t_student where id = ?", @(idNum)];//2.‰∏çÁ°ÆÂÆöÁöÑÂèÇÊï∞Áî®%@Ôºå%dÁ≠âÊù•Âç†‰Ωç//BOOL result = [_db executeUpdateWithFormat:@"delete from t_student where name = %@",@"ÁéãÂ≠êÊ∂µ"];if (result1) &#123; NSLog(@ "Âà†Èô§ÊàêÂäü");&#125; else &#123; NSLog(@ "Âà†Èô§Â§±Ë¥•");&#125; 123456789//‰øÆÊîπÂ≠¶ÁîüÁöÑÂêçÂ≠óNSString * newName = @ "Êñ∞ÂêçÂ≠ó";NSString * oldName = @ "ÊµãËØïÂêçÂ≠ó2";BOOL result2 = [_db executeUpdate: @ "update t_student set name = ? where name = ?", newName, oldName];if (result2) &#123; NSLog(@ "‰øÆÊîπÊàêÂäü");&#125; else &#123; NSLog(@ "‰øÆÊîπÂ§±Ë¥•");&#125; Êü•Ë°®ÁöÑÊü•ËØ¢Ë¶ÅÈÄöËøá executeQuery ÊâßË°åÔºö 123456789101112//Êü•ËØ¢Êï¥‰∏™Ë°®FMResultSet * resultSet = [_db executeQuery: @ "select * from t_student"];//Ê†πÊçÆÊù°‰ª∂Êü•ËØ¢//FMResultSet * resultSet = [_db executeQuery:@"select * from t_student where id &lt; ?", @(4)];//ÈÅçÂéÜÁªìÊûúÈõÜÂêàwhile ([resultSet next]) &#123; int idNum = [resultSet intForColumn: @ "id"]; NSString * name = [resultSet objectForColumn: @ "name"]; int age = [resultSet intForColumn: @ "age"]; NSString * sex = [resultSet objectForColumn: @ "sex"]; NSLog(@ "Â≠¶Âè∑Ôºö%@ ÂßìÂêçÔºö%@ Âπ¥ÈæÑÔºö%@ ÊÄßÂà´Ôºö%@", @(idNum), name, @(age), sex);&#125; Êü•ËØ¢ÁªìÊûú‰ºö‰øùÂ≠òÂú® FMResultSet Á±ªÁöÑÂÆû‰æã‰∏≠„ÄÇÂç≥‰ΩøÊìç‰ΩúÁªìÊûúÂè™Êúâ‰∏ÄË°åÔºå‰πüÈúÄË¶ÅÂÖàË∞ÉÁî® FMResultSet ÁöÑnext ÊñπÊ≥ï„ÄÇ FMDB Êèê‰æõÂ¶Ç‰∏ãÂ§ö‰∏™ÊñπÊ≥ïÊù•Ëé∑Âèñ‰∏çÂêåÁ±ªÂûãÁöÑÊï∞ÊçÆÔºö 12345678intForColumn:longForColumn:longLongIntForColumn:boolForColumn:doubleForColumn:stringForColumn:dateForColumn:dataForColumn: ÂΩìÁÑ∂Ôºå‰∏Ä‰∏™‰∏Ä‰∏™Ëá™Â∑±Ëé∑ÂèñÂàóÂêç‰πüÂ§™È∫ªÁÉ¶‰∫ÜÔºåÂèØ‰ª•‰ΩøÁî® FMResultSet Êèê‰æõÁöÑ resultDictionary ÊñπÊ≥ïÔºåËé∑ÂèñÊï¥‰∏™Â≠óÂÖ∏Ôºö 123while ([resultSet next]) &#123; NSDictionary *result = [resultSet resultDictionary];&#125; Âú®‰ΩøÁî® while Âæ™ÁéØÁöÑÊó∂ÂÄôÔºå‰∏çÈúÄË¶ÅÊâãÂä®ÂÖ≥Èó≠ FMResultSetÔºåÂõ†‰∏∫ [FMResultSet next] ÈÅçÂéÜÂà∞ÊúÄÂêé‰ºöË∞ÉÁî® [FMResultSet close] Á∫øÁ®ãÂÆâÂÖ®FMDatabase Êú¨Ë∫´‰∏çÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºåÊâÄ‰ª•‰∏çË¶ÅÂú®Â§öÁ∫øÁ®ã‰∏≠‰ΩøÁî®„ÄÇÈúÄË¶Å‰ΩøÁî® FMDatabaseQueue Êù•Â∏ÆÂä©‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®Ôºö 123456789101112// ÂàõÂª∫ÔºåÊúÄÂ•ΩÊîæÂú®‰∏Ä‰∏™Âçï‰æãÁöÑÁ±ª‰∏≠FMDatabaseQueue *queue = [FMDatabaseQueue databaseQueueWithPath:aPath];// ‰ΩøÁî®[queue inDatabase:^(FMDatabase *db) &#123; [db executeUpdate:@"INSERT INTO myTable VALUES (?)", [NSNumber numberWithInt:1]]; [db executeUpdate:@"INSERT INTO myTable VALUES (?)", [NSNumber numberWithInt:2]]; [db executeUpdate:@"INSERT INTO myTable VALUES (?)", [NSNumber numberWithInt:3]]; FMResultSet *rs = [db executeQuery:@"select * from foo"]; while ([rs next]) &#123; // ‚Ä¶ &#125;&#125;]; ‰∫ãÂä°Âú®Êï∞ÊçÆÂ∫ì‰∏≠Ôºå‰∫ãÂä°ÂèØ‰ª•‰øùËØÅÊï∞ÊçÆÊìç‰ΩúÁöÑÂÆåÊï¥ÊÄßÔºö 123456789101112131415[_dataBaseQueue inDatabase:^(FMDatabase * _Nonnull db) &#123; [db open]; // ÂºÄÂêØ‰∫ãÁâ© [db beginTransaction]; BOOL isDeleteGroupSuccess = [db executeUpdate:@"DELETE FROM grouptable WHERE gcid = ?", groupID]; BOOL isDeleteMembershipSuccess = [db executeUpdate:@"DELETE FROM groupshiptable WHERE gcid = ?", groupID]; if (!isDeleteGroupSuccess || !isDeleteMembershipSuccess) &#123; // ÂΩìÂØπ‰∏§‰∏™Ë°®ÁöÑÊìç‰Ωú‰∏≠ÔºåÂÖ∂‰∏≠‰∏Ä‰∏™Â§±Ë¥•ÔºåÊï∞ÊçÆÂõûÊªö [db rollback]; return; &#125; // Êèê‰∫§‰∫ãÁâ© [db commit]; [db close];&#125;]; ÈÄöËøábeginTransaction ÂºÄÂêØ‰∏Ä‰∏™‰∫ãÂä°„ÄÇ‰ªªÊÑèÊÉÖÂÜµ‰∏ãÂèëÁîüÈîôËØØÁöÑÊó∂ÂÄôÂèØ‰ª•ÈÄöËøá rollback ÂõûÈÄÄÔºåÂê¶ÂàôÈÄöËøá commit Êèê‰∫§‰∫ãÂä°„ÄÇ Êú¨Âú∞Ë∞ÉËØïÊú¨Âú∞Ë∞ÉËØïÂèØ‰ª•‰ΩøÁî®ÂÖçË¥πÁöÑÊï∞ÊçÆÂ∫ìÊü•ÁúãÂ∑•ÂÖ∑ ÔºåÊØîÂ¶ÇÔºö Ê∫êÁ†ÅËß£ÊûêÂàùÂßãÂåñ FMDatabaseÂàùÂßãÂåñ‰ΩøÁî®ÁöÑÊòØ + [FMDatabase databaseWithPath:@&quot;path&quot;] ÊñπÊ≥ïÔºåÂÆÉ‰ºöÂú®ÂÜÖÈÉ®Ë∞ÉÁî® initWithPath: ÊñπÊ≥ï„ÄÇÂÆÉÂÖ∂ÂÆûÂ∞±ÊòØÂàõÂª∫‰∫Ü‰∏Ä‰∏™ FMDatabase ÁöÑÂÆû‰æã„ÄÇ 12345678910- (instancetype)initWithPath:(NSString*)aPath &#123; ... self = [super init]; if (self) &#123; _databasePath = [aPath copy]; _openResultSets = [[NSMutableSet alloc] init]; _db = nil; &#125; return self;&#125; Ë¶ÅÊ±ÇËæìÂÖ•‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÁöÑË∑ØÂæÑÔºåÂπ∂‰øùÂ≠òÂú® _databasePath ‰∏≠„ÄÇËøô‰∏ÄÊ≠•ÈáåËøòÊ≤°ÊúâÊâìÂºÄ dbÔºåÊâÄ‰ª• _db ËøòÊòØ nil„ÄÇ ÊâìÂºÄ db- [FMDatabase open] ÊñπÊ≥ïÊâìÂºÄ‰∫Ü db„ÄÇ 12345678910- (BOOL)open &#123; ... int err = sqlite3_open([self sqlitePath], (sqlite3**)&amp;_db ); if(err != SQLITE_OK) &#123; NSLog(@"error opening!: %d", err); return NO; &#125; ... return YES;&#125; Â¶ÇÊûúÂ∑≤ÁªèÊâìÂºÄ‰∫ÜÂ∞±Áõ¥Êé•ËøîÂõû„ÄÇÂê¶ÂàôË∞ÉÁî® sqlite Êèê‰æõÁöÑÁöÑ sqlite3_open() ÊñπÊ≥ïÔºåÊâìÂºÄÁöÑÊï∞ÊçÆÂ∫ì„ÄÇ ÂàõÂª∫ select sqlËøô‰∏ÄËäÇ‰∏ªË¶ÅËÆ≤Â¶Ç‰ΩïÂàõÂª∫ select ÁöÑ sqlÔºåselect ‰ºö‰ªéÊï∞ÊçÆÂ∫ì‰∏≠Ëé∑ÂèñÊï∞ÊçÆÔºåÊâÄ‰ª•ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™‰∏ìÈó®ÁöÑÁ±ªÁî®Êù•ÊãøÊï∞ÊçÆÔºå‰πüÂ∞±ÊòØ‰∏ãÈù¢ÁöÑÁöÑ FMResultSet ÂàõÂª∫ sqlite3_stmtÊâÄÊúâ sql ËØ≠Âè•ÈÉΩ‰ºöË¢´ËΩ¨Âåñ‰∏∫ sqlite3_stmt Á±ªÂûã„ÄÇÁî±‰∫éËøô‰∏ÄËøáÁ®ãÊØîËæÉËÄóÊó∂ÔºåÊâÄ‰ª•‰∏ÄËà¨Â∞ÜËΩ¨ÂåñÂ•ΩÁöÑ sqlite3_stmt ‰øùÂ≠òÂà∞ _cachedStatements Â≠óÂÖ∏‰∏≠Ôºå‰ª•‰æøÁõ∏Âêå sql ÂèçÂ§ç‰ΩøÁî®Ôºö 12345678910111213141516- (FMResultSet *)executeQuery:(NSString *)sql withArgumentsInArray:(NSArray*)arrayArgs orDictionary:(NSDictionary *)dictionaryArgs orVAList:(va_list)args &#123; ... int rc = 0x00; sqlite3_stmt *pStmt = 0x00; FMStatement *statement = 0x00; FMResultSet *rs = 0x00; if (_shouldCacheStatements) &#123; statement = [self cachedStatementForQuery:sql]; pStmt = statement ? [statement statement] : 0x00; [statement reset]; &#125; ...&#125; cachedStatementForQuery: Â∞±ÊòØÂú®Â≠óÂÖ∏‰∏≠Êü•Êâæ sql ÂØπÂ∫îÁöÑ sqlite3_stmt ÁöÑÊñπÊ≥ïÔºåÂÆÉËøîÂõûÁöÑ FMStatement ÊòØ sqlite3_stmt ÁöÑÂ∞ÅË£Ö„ÄÇ ÁªëÂÆöÂèÇÊï∞ÂèÇÊï∞ÈöèÁùÄÊñπÊ≥ï‰∏ÄËµ∑‰º†‰∫ÜËøõÊù•Ôºå‰∏ÄËà¨ÂèÇÊï∞Êúâ‰∏§ÁßçÔºå‰∏ÄÁßçÊòØÂ≠óÂÖ∏Á±ªÂûãÁöÑÔºåÊ†πÊçÆ sql ‰∏≠ÁöÑÂèÇÊï∞ÂêçÊèíÂÖ•ÔºåËøòÊúâ‰∏ÄÁßçÊòØÊï∞ÁªÑÂûãÁöÑÔºå‰æùÊ¨°ÊõøÊç¢ sql ‰∏≠ÁöÑÂç†‰ΩçÁ¨¶„ÄÇ(‰ª£Á†ÅÂæàÈïøÔºåÂ∞±‰∏çË¥¥‰∫Ü) È¶ñÂÖàÈÄöËøá sqlite3_bind_parameter_count() Ëé∑Âæó sql ÁöÑÂèÇÊï∞‰∏™Êï∞„ÄÇÁÑ∂ÂêéÊ£ÄÊü•‰º†ÂÖ•ÁöÑÊòØÂ≠óÂÖ∏ËøòÊòØÊï∞ÁªÑ„ÄÇÂ¶ÇÊûúÊòØÂ≠óÂÖ∏ÔºåÈÅçÂéÜÂ≠óÂÖ∏ÔºåÈÄöËøá sqlite3_bind_parameter_index() ÊãøÂà∞ÈîÆÂØπÂ∫îÁöÑÂèÇÊï∞Á¥¢ÂºïÔºåÁÑ∂ÂêéÁªëÂÆöÔºõÂ¶ÇÊûúÊòØÊï∞ÁªÑÂ∞±‰æùÊ¨°ÁªëÂÆöÂà∞ÂØπÂ∫îÁöÑÂàó‰∏≠„ÄÇÁªëÂÆö‰πüÊòØ‰ΩøÁî®ÁöÑ sqlite Êèê‰æõÁöÑÈíàÂØπ‰∏çÂêåÁ±ªÂûãÁöÑ‰∏ÄÁ≥ªÂàóÁªëÂÆöÊñπÊ≥ï„ÄÇ ÁªëÂÆöÂÆå‰∫ÜÂêéÔºåÂ∞ÜËøô‰∏™ sqlite3_stmt ÊöÇÂ≠ò„ÄÇÁî±‰∫éÊòØÂ∑≤ÁªèÁªëÂÆö‰∫ÜÂèÇÊï∞ÔºåÊâÄ‰ª•ÂèØËßÅÂâçÈù¢ sqlite3_reset() ÂÅöÁöÑÂ∞±ÊòØÂ∞ÜÂèÇÊï∞Ê∏ÖÁ©∫„ÄÇ SQLite ÊîØÊåÅ‰ΩøÁî®Âç†‰ΩçÁ¨¶ ?ÔºåÂπ∂‰∏îÂú®ÂøÖË¶ÅÁöÑÊó∂ÂÄôÁªëÂÆöÂèÇÊï∞„ÄÇÊâÄ‰ª•‰Ω†‰∏çÈúÄË¶ÅÊääÂÆûÈôÖÁöÑÂÄºÊîæÂÖ•Â≠óÁ¨¶‰∏≤‰∏≠Âéª„ÄÇËøôÊòØ‰∏Ä‰∏™ÂÆâÂÖ®‰∏äÁöÑËÄÉÈáèÔºåÂÆÉÂèØ‰ª•ÂÆàÊä§Á®ãÂ∫èÈÅøÂÖç SQL Ê≥®ÂÖ•„ÄÇÂÆÉ‰πüÂèØ‰ª•Â∏ÆÂä©‰Ω†ÂáèÂ∞ëÂøÖÈ°ª escape ÂÄºÔºàsql Êèê‰æõÁöÑËΩ¨‰πâÁî®ÁöÑÂëΩ‰ª§ÔºâËøôÊ†∑ÁöÑ‰∏çÂøÖË¶ÅÁöÑÈ∫ªÁÉ¶„ÄÇ ÂàõÂª∫ FMResultSet ‰øùÂ≠òÁªìÊûúÁé∞Âú® sql Â∑≤ÁªèÂàõÂª∫ÂÆåÊàêÔºåÂè™Ê¨†ÊâßË°å‰∫Ü„ÄÇFMDB Âπ∂Ê≤°ÊúâÁ´ãÂç≥ÊâßË°åÔºåËÄåÊòØÂàõÂª∫‰∫Ü‰∏Ä‰∏™ FMResultSet ÂØπË±°ÔºåÁî®Êù•‰øùÂ≠òÊØèÊ¨° sql ÁöÑÁªìÊûú„ÄÇÂõ†‰∏∫‰∏Ä‰∏™ db ÂèØ‰ª•ÊâßË°åÂ§ö‰∏™ sqlÔºåÊâÄ‰ª•Â∞±Ë¶ÅÂàõÂª∫Â§ö‰∏™ FMResultSet „ÄÇÊâÄ‰ª•Âú®ÂàõÂª∫ sql ÁöÑÊúÄÂêéÔºåËøòË¶ÅÂàõÂª∫‰∏Ä‰∏™ FMResultSet: 123456789- (FMResultSet *)executeQuery:(NSString *)sql withArgumentsInArray:(NSArray*)arrayArgs orDictionary:(NSDictionary *)dictionaryArgs orVAList:(va_list)args &#123; ... // the statement gets closed in rs's dealloc or [rs close]; rs = [FMResultSet resultSetWithStatement:statement usingParentDatabase:self]; [rs setQuery:sql]; ...&#125; ÊâßË°å sqlÊâßË°å sql Âú® FMResultSet ‰∏≠ËøõË°åÔºö 12345- (BOOL)nextWithError:(NSError **)outErr &#123; int rc = sqlite3_step([_statement statement]); ... return (rc == SQLITE_ROW);&#125; ÂÖ∂ÂÆû‰∏äÈù¢ÁöÑÂÖ≥ÈîÆÂ∞±ÊòØË∞ÉÁî® sqlite ÁöÑ sqlite3_step() ÊñπÊ≥ï„ÄÇ Ëé∑ÂèñÊï∞ÊçÆÂâçÈù¢ÊâßË°åÂÆå sql ‰πãÂêéÔºå‰Ω†Â∞±ÂèØ‰ª•ÊãøÂà∞Êï∞ÊçÆ‰∫ÜÔºåFMResultSet ‰∏≠Êèê‰æõ‰∫ÜÊñπÊ≥ïÂ∞ÜÂΩìÂâçË°åËΩ¨Âåñ‰∏∫‰∏Ä‰∏™Â≠óÂÖ∏Ôºö 12345678910111213141516171819202122232425- (NSDictionary*)resultDictionary &#123; NSUInteger num_cols = (NSUInteger)sqlite3_data_count([_statement statement]); if (num_cols &gt; 0) &#123; NSMutableDictionary *dict = [NSMutableDictionary dictionaryWithCapacity:num_cols]; int columnCount = sqlite3_column_count([_statement statement]); int columnIdx = 0; for (columnIdx = 0; columnIdx &lt; columnCount; columnIdx++) &#123; NSString *columnName = [NSString stringWithUTF8String:sqlite3_column_name([_statement statement], columnIdx)]; id objectValue = [self objectForColumnIndex:columnIdx]; [dict setObject:objectValue forKey:columnName]; &#125; return dict; &#125; else &#123; NSLog(@"Warning: There seem to be no columns in this set."); &#125; return nil;&#125; ËøáÁ®ãÂ∞±ÊòØÈÄöËøáÂæ™ÁéØÔºåÊãøÂá∫ÊØè‰∏ÄÂàóÁöÑÊï∞ÊçÆÔºåÂä†ÂÖ•Âà∞Â≠óÂÖ∏‰∏≠„ÄÇÂΩìÁÑ∂Êàë‰ª¨‰πüÂèØ‰ª•Ëá™Â∑±Ëé∑ÂèñÂàóÊï∞ÊçÆÂèäÂàóÂêç„ÄÇ ÂàõÂª∫ update sqlselect sql ÈúÄË¶ÅÈÖçÂêà FMResultSetÔºåÊõ¥Êñ∞Êï∞ÊçÆÂ∫ìÂÜÖÂÆπÂàôÊØîËæÉÁÆÄÂçï„ÄÇÁõ¥Êé•‰ΩøÁî® FMDatabase Êõ¥Êñ∞Âç≥ÂèØ„ÄÇupdate sql ÁöÑ‰ª£Á†ÅÂá†‰πéÂíå select sql ‰∏ÄÊ®°‰∏ÄÊ†∑Ôºå‰∏çÂêåÁöÑÊòØÔºåÊõ¥Êñ∞Êìç‰ΩúÂú®ÂàõÂª∫Â•Ω sql ÂêéÔºåÁõ¥Êé•ÊâßË°å sqlite3_step()ÔºåÊâßË°åÂÆåÂêéÊ†πÊçÆÊòØÂê¶Ë¶ÅÁºìÂ≠òÈÄâÊã©ÊÄßÊâßË°åÈáçÁΩÆ sqlite3_reset() ÊàñËÄÖÂÖ≥Èó≠ sqlite3_finalize()„ÄÇ‰ª£Á†ÅÂ§™Èïø‰∏îÈáçÂ§çÔºåÂ∞±‰∏çË¥¥‰∫Ü„ÄÇ Âä†Ëß£ÂØÜFMDB Â∞ÅË£Ö‰∫Ü‰∏∫ db Âä†Ëß£ÂØÜÁöÑÊñπÊ≥ï„ÄÇËß£ÂØÜ‰ΩøÁî®Â¶Ç‰∏ãÊñπÊ≥ïÔºåÂú®ÊâìÂºÄ db Ââç‰ΩøÁî®ÔºåÂê¶ÂàôÊä•ÈîôÔºö 1234567891011121314151617181920- (BOOL)setKey:(NSString*)key &#123; NSData *keyData = [NSData dataWithBytes:[key UTF8String] length:(NSUInteger)strlen([key UTF8String])]; return [self setKeyWithData:keyData];&#125;- (BOOL)setKeyWithData:(NSData *)keyData &#123;#ifdef SQLITE_HAS_CODEC if (!keyData) &#123; return NO; &#125; int rc = sqlite3_key(_db, [keyData bytes], (int)[keyData length]); return (rc == SQLITE_OK);#else#pragma unused(keyData) return NO;#endif&#125; ÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÁÆÄÂçïÁöÑÂ∞ÅË£ÖÔºåÂ∞±ÊòØÂ∞Ü String ËΩ¨Âåñ‰∏∫ DataÔºåÁÑ∂Âêé‰ΩøÁî® sqlite3_key ËøõË°åËß£ÂØÜ„ÄÇ ÊúâËß£ÂØÜÂøÖÁÑ∂ÊòØË¶ÅÁé∞ÊúâÂä†ÂØÜÁöÑÔºå‰ΩøÁî® sqlite3_rekey() ÊñπÊ≥ïÔºåÂèØ‰ª•ÂÆåÊàêÊ≤°ÊúâÂØÜÁ†ÅÁöÑÊó∂ÂÄôÂàõÂª∫ÂØÜÁ†ÅÔºåÊúâÂØÜÁ†ÅÁöÑÊó∂ÂÄô‰øÆÊîπÂØÜÁ†ÅÊàñËÄÖÊ∏ÖÈô§ÂØÜÁ†ÅÁöÑÊìç‰Ωú„ÄÇ‰ª£Á†ÅÂíåËß£ÂØÜÁ±ª‰ººÔºå‰πü‰∏çË¥¥‰∫Ü„ÄÇ ÂÖ≥Èó≠Êï∞ÊçÆÂ∫ìÂÖ≥Èó≠Êï∞ÊçÆÂ∫ìÔºåÈúÄË¶ÅÂÅö‰∏§ÊñπÈù¢Â§ÑÁêÜÔºå‰∏ÄÊñπÈù¢ÊòØÊ∏ÖÈô§ fmdb ÂàõÂª∫ÁöÑÁºìÂ≠òÔºå‰∏ÄÊñπÈù¢ÊòØÈáäÊîæ sqlite ËµÑÊ∫êÔºö 123456789101112131415161718192021222324252627282930313233343536- (BOOL)close &#123; [self clearCachedStatements]; [self closeOpenResultSets]; if (!_db) &#123; return YES; &#125; int rc; BOOL retry; BOOL triedFinalizingOpenStatements = NO; do &#123; retry = NO; rc = sqlite3_close(_db); if (SQLITE_BUSY == rc || SQLITE_LOCKED == rc) &#123; if (!triedFinalizingOpenStatements) &#123; triedFinalizingOpenStatements = YES; sqlite3_stmt *pStmt; while ((pStmt = sqlite3_next_stmt(_db, nil)) !=0) &#123; NSLog(@"Closing leaked statement"); sqlite3_finalize(pStmt); retry = YES; &#125; &#125; &#125; else if (SQLITE_OK != rc) &#123; NSLog(@"error closing!: %d", rc); &#125; &#125; while (retry); _db = nil; return YES;&#125; ËøôÈáåÂÖàÂ∞ùËØïÁî® sqlite3_close() ÂÖ≥Èó≠ÔºåÂ¶ÇÊûú‰∏çË°åÔºåÈÇ£‰πàÂÜç sqlite3_next_stmt() Êù•Ëé∑ÂèñÊØè‰∏™ stmtÔºåÁÑ∂ÂêéÂ∞Ü‰ªñ‰ª¨ sqlite3_finalize()„ÄÇÊï¥‰∏™ËøáÁ®ãÂú®‰∏Ä‰∏™Â§ßÁöÑ while Âæ™ÁéØ‰∏≠ÔºåÁõ¥Âà∞Êï∞ÊçÆÂ∫ìÂÖ≥Èó≠‰∏∫Ê≠¢„ÄÇ Â§öÁ∫øÁ®ãÊúâ‰∫õË¥πÊó∂ÁöÑÊõ¥Êñ∞Êìç‰ΩúÊàë‰ª¨‰∏çÂ∏åÊúõÂú®‰∏ªÁ∫øÁ®ã‰∏≠ËøõË°å„ÄÇFMDB Êèê‰æõ‰∫Ü FMDatabaseQueue Ëøô‰∏™Á±ªÂ∏ÆÂä©Êàë‰ª¨ÂàõÂª∫‰∫ÜÂêéÂè∞Á∫øÁ®ã„ÄÇÂÖ∂ÂÆûÂ∞±ÊòØÂ∞ÅË£Ö‰∫ÜÂ≠êÁ∫øÁ®ãÁöÑÊìç‰ΩúÔºåÂÖ∂ÂÆû‰Ω†‰πüÂèØ‰ª•Ëá™Â∑±ÂàõÂª∫Â≠êÁ∫øÁ®ãÔºåÁÑ∂ÂêéËøõË°å sqlÔºå‰∏§ËÄÖÊ≤°‰ªÄ‰πàÂå∫Âà´„ÄÇ ÂàùÂßãÂåñÂàõÂª∫ÈòüÂàóÂàõÂª∫ÈòüÂàóÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122static const void * const kDispatchQueueSpecificKey = &amp;kDispatchQueueSpecificKey;- (instancetype)initWithPath:(NSString*)aPath flags:(int)openFlags vfs:(NSString *)vfsName &#123; self = [super init]; if (self != nil) &#123; _db = [[[self class] databaseClass] databaseWithPath:aPath]; FMDBRetain(_db); ... _path = FMDBReturnRetained(aPath); _queue = dispatch_queue_create([[NSString stringWithFormat:@"fmdb.%@", self] UTF8String], NULL); dispatch_queue_set_specific(_queue, kDispatchQueueSpecificKey, (__bridge void *)self, NULL); _openFlags = openFlags; &#125; return self;&#125; ‰∏ªË¶ÅÂàÜ‰∏∫‰∏§Ê≠•ÔºåÁ¨¨‰∏ÄÊ≠•ÊòØÂàõÂª∫ db„ÄÇÁ¨¨‰∫åÊ≠•ÊòØÂàõÂª∫ÈòüÂàó„ÄÇ‰πãÂêéËøòÁî® dispatch_queue_set_specific ÁªëÂÆö‰∫Ü FMDatabaseQueue ÂØπË±°‰ª•Âèä queueÔºåËøô‰∏™ÁöÑÁî®Â§Ñ‰∏ãÈù¢ÂÜçËØ¥„ÄÇ ÊâßË°å sqlFMDB ‰∏∫ FMDatabaseQueue Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ïÊâπÈáèÂ§ÑÁêÜÊüê‰∏Ä‰∏™ db ÁöÑ sql„ÄÇÂÆÉÊé•Êî∂‰∏Ä‰∏™ sql ÁöÑ blockÔºö 123456789101112131415161718- (void)inDatabase:(void (^)(FMDatabase *db))block &#123; /* Get the currently executing queue (which should probably be nil, but in theory could be another DB queue * and then check it against self to make sure we're not about to deadlock. */ FMDatabaseQueue *currentSyncQueue = (__bridge id)dispatch_get_specific(kDispatchQueueSpecificKey); assert(currentSyncQueue != self &amp;&amp; "inDatabase: was called reentrantly on the same queue, which would lead to a deadlock"); FMDBRetain(self); dispatch_sync(_queue, ^() &#123; FMDatabase *db = [self database]; block(db); ... &#125;); FMDBRelease(self);&#125; ÂèØ‰ª•ÁúãÂà∞Ôºå‰∏ªË¶ÅÂ∞±ÊòØÂú®‰πãÂâçÂàõÂª∫ÁöÑ queue ‰∏≠ÂêåÊ≠•ÊâßË°å sql„ÄÇÈÇ£‰πà dispatch_get_specific Êúâ‰ΩïÁî®ÊÑèÂë¢ÔºüÁÆÄÂçïÁöÑËØ¥Â∞±ÊòØÂ¶ÇÊûúÂΩìÂâçÈòüÂàó‰∏∫ _queueÔºå‰∏ãÈù¢ÁöÑÂêåÊ≠•Êìç‰ΩúÂ∞±‰ºö‰∫ßÁîüÊ≠ªÈîÅ„ÄÇÊâÄ‰ª•ËøôÈáå dispatch_get_specific Â∞±ÊòØ‰∏∫‰∫ÜÈ™åËØÅ‰∏Ä‰∏ãÔºåÁé∞Âú®ÊòØ‰∏çÊòØÂú® _queue ÈòüÂàó‰∏≠„ÄÇÂ¶ÇÊûúÊòØÔºåÈÇ£‰πà currentSyncQueue Â∞±‰∏ç‰∏∫Á©∫ÔºåÈÇ£‰πàÁõ¥Êé•ÈÄöËøáÊñ≠Ë®ÄËß¶ÂèëÂºÇÂ∏∏„ÄÇ ÂÖ∂ÂÆûËøô‰∏™Âà§Êñ≠ÔºåÂ∞±ÊòØË¶ÅÊ±Ç‰ΩøÁî®ËÄÖ‰∏çË¶ÅÁî®Âú®ÂàöÂàöÂàõÂª∫ÁöÑ _queue ‰∏≠Ë∞ÉÁî®ÊâßË°å sql ÁöÑÊñπÊ≥ïÔºåËÄåÊòØÁõ¥Êé•Âú®‰∏ªÈòüÂàó‰∏≠Ë∞ÉÁî®ÔºåÊñπÊ≥ïÊâßË°åÁöÑÊó∂ÂÄô‰ºöËá™Âä®Â∞Ü sql ÊâßË°åÂú® _queue ‰∏≠„ÄÇ ‰∫ãÂä°Â§ÑÁêÜ‰∫ãÂä°Â§ÑÁêÜÁöÑÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768- (void)inTransaction:(void (^)(FMDatabase *db, BOOL *rollback))block &#123; [self beginTransaction:NO withBlock:block];&#125;- (void)beginTransaction:(BOOL)useDeferred withBlock:(void (^)(FMDatabase *db, BOOL *rollback))block &#123; FMDBRetain(self); dispatch_sync(_queue, ^() &#123; BOOL shouldRollback = NO; if (useDeferred) &#123; [[self database] beginDeferredTransaction]; &#125; else &#123; [[self database] beginTransaction]; &#125; block([self database], &amp;shouldRollback); if (shouldRollback) &#123; [[self database] rollback]; &#125;else &#123; [[self database] commit]; &#125; &#125;); FMDBRelease(self);&#125;- (BOOL)rollback &#123; BOOL b = [self executeUpdate:@"rollback transaction"]; if (b) &#123; _inTransaction = NO; &#125; return b;&#125;- (BOOL)commit &#123; BOOL b = [self executeUpdate:@"commit transaction"]; if (b) &#123; _inTransaction = NO; &#125; return b;&#125;- (BOOL)beginDeferredTransaction &#123; BOOL b = [self executeUpdate:@"begin deferred transaction"]; if (b) &#123; _inTransaction = YES; &#125; return b;&#125;- (BOOL)beginTransaction &#123; BOOL b = [self executeUpdate:@"begin exclusive transaction"]; if (b) &#123; _inTransaction = YES; &#125; return b;&#125; ‰∫ãÂä°Â§ÑÁêÜ‰∏ªË¶ÅËøòÊòØË∞ÉÁî®‰∫ãÂä°ÁöÑÁõ∏ÂÖ≥ sql ËØ≠Âè•Ôºå‰ΩøÁî®ËÄÖÂèØ‰ª•ÈÄöËøá sql ÊòØÂê¶ÊâßË°åÊàêÂäüÔºåÊù•ÂÜ≥ÂÆöÊòØÂê¶ÈúÄË¶ÅÂõûÊªö„ÄÇ ËøôÈáå block ÁöÑÂÖ•ÂèÇ‰ΩøÁî®ÁöÑÊòØ BOOL *roolbackÔºåÁÑ∂Âêé‰º†ÂÖ•‰∏Ä‰∏™ BOOL ÁöÑÂú∞ÂùÄ &amp;shouldRoolBackÔºåÂèØ‰ª•ÂÆûÁé∞‰∏çÁî®ËøîÂõûÂÄº‰º†ÈÄíÊï∞ÊçÆ„ÄÇÊ≥®ÊÑèÔºåËøôÁßçÂèñÂú∞ÂùÄÁöÑÂÜôÊ≥ïÂú®‰ΩøÁî®ÁöÑÊó∂ÂÄôË¶ÅÁî® *shouldRoolBack Êù•ÂèñÂú∞ÂùÄ‰∏äÁöÑÂÄºÔºåÂõ†‰∏∫ÊòØÂü∫Êú¨Á±ªÂûãÁöÑÊåáÈíàÔºö 1234BOOL roolback = YES;BOOL *r = &amp;roolback;*r = NO;NSLog(@"%dÔºåroolback ‰ªé1Âèò‰∏∫‰∫Ü0",roolback); ÈùûÂü∫Êú¨Á±ªÂûãÁöÑÊåáÈíàÁöÑËµãÂÄºÁõ¥Êé•Â∞±ÊòØ p = Person() ËøôÁßçÂú∞ÂùÄÁöÑËµãÂÄºÂ∞±Ë°å‰∫ÜÔºå‰∏çÂ≠òÂú® *p ÁöÑÊÉÖÂÜµ„ÄÇÂü∫Êú¨Á±ªÂûãÁöÑÊåáÈíàÂøÖÈ°ªÈÄöËøá *r ÊãøÂà∞Â†Ü‰∏äÁöÑÂÄº *r = No ÊÄªÁªìFMDB ÁöÑÊï¥‰∏™ËøáÁ®ãÁõ∏ÂØπÁÆÄÂçïÔºåÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØÂÖàÂàùÂßãÂåñÊéßÂà∂Á±ª FMDatabaseÔºåÁÑ∂ÂêéÈÄöËøáËøô‰∏™Á±ªÊâìÂºÄ dbÔºåÊâßË°å sqlÔºåÂÖ≥Èó≠Êï∞ÊçÆÂ∫ìÁ≠âÊìç‰Ωú„ÄÇÊâßË°åÁöÑ sql ÈúÄË¶ÅËΩ¨Âåñ‰∏∫ sqlite ‰ΩøÁî®ÁöÑ sqlite3_stmt Á±ªÂûãÔºåÂπ∂ÁºìÂ≠ò„ÄÇÂØπ‰∫éÊúâÁªìÊûúÁöÑ sqlÔºåÊàñÂàõÂª∫‰∏Ä‰∏™ FMResultSet Êù•‰øùÂ≠ò sql Â∑≤ÁªèÂÖ∂Áõ∏Â∫îÁªìÊûú„ÄÇÂ§öÁ∫øÁ®ãÈÄöËøá FMDatabaseQueue ÂÆûÁé∞ÔºåÂÆÉÂèØ‰ª•‰∏∫ sql ÂºÄÂêØÂêéÂè∞Á∫øÁ®ãÊâßË°åÔºåÂπ∂‰∏îÂ∞ÅË£Ö‰∫Ü sqlite ÁöÑÂéüÂ≠êÊÄßÊìç‰ΩúÁöÑËØ≠Âè•Êù•ÂÆûÁé∞‰∫ãÂä°„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RxSwift ÁöÑ‰∏Ä‰∫õÂéüÁêÜËß£Êûê]]></title>
    <url>%2F2017%2F11%2F14%2FRxSwift%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[ÂâçÈù¢‰∏§ÁØáËÆ≤‰∫Ü RxSwift ‰ª•Âèä RxCocoa ÁöÑ‰ΩøÁî®ÔºåËøôÁØáÊé¢Á©∂‰∏ã RxSwift ÁöÑÂÆûÁé∞ÂéüÁêÜ„ÄÇ ËøôÁØáÂ∞Ü‰ªéÂõõ‰∏™ÊñπÈù¢Êé¢Á©∂ RxSwift ÁöÑÂÆûÁé∞ÂéüÁêÜ„ÄÇÂåÖÊã¨ Ôºö rx ÁöÑÂëΩÂêçÁ©∫Èó¥Â¶Ç‰Ωï‰∫ßÁîüÁöÑ Â¶Ç‰ΩïÂàõÂª∫ Observable ‰ª•ÂèäËÆ¢ÈòÖ Subject ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑ Â¶Ç‰ΩïÂÆûÁé∞Ë∞ÉÁî® delegate ÊñπÊ≥ïÁöÑ rx ÁöÑÂëΩÂêçÁ©∫Èó¥Â¶Ç‰Ωï‰∫ßÁîüÊàë‰ª¨ÈÉΩÁü•ÈÅìÔºåRxCocoa ‰∏∫Êàë‰ª¨ÁöÑÂü∫Êú¨Êéß‰ª∂Ê∑ªÂä†‰∫Ü rx ÁöÑÂëΩÂêçÁ©∫Èó¥ÔºåÁÑ∂ÂêéÂÆö‰πâ‰∫Ü rx Áõ∏ÂÖ≥ÁöÑÂ±ûÊÄß„ÄÇÈÇ£‰πàËøôÊòØÊÄé‰πàÂÅöÂà∞ÁöÑÂë¢Ôºü Êàë‰ª¨ÁÇπËøõ rx ÁöÑÂÆö‰πâÔºö 1234567891011/// A type that has reactive extensions.public protocol ReactiveCompatible &#123; /// Extended type associatedtype CompatibleType /// Reactive extensions. static var rx: Reactive&lt;CompatibleType&gt;.Type &#123; get set &#125; /// Reactive extensions. var rx: Reactive&lt;CompatibleType&gt; &#123; get set &#125;&#125; ÂèØ‰ª•ÁúãÂà∞Ôºårx ÊòØÂÆö‰πâÂú®Ëøô‰∏™Âè´ ReactiveCompatible ÁöÑÂçèËÆÆ‰∏≠ÁöÑ„ÄÇrx ÊòØ Reactive Á±ªÂûã„ÄÇÂú®ÂçèËÆÆÊãìÂ±ï‰∏≠ÔºåÂÆûÁé∞‰∫ÜËøô‰∏™ÂçèËÆÆÁöÑÈªòËÆ§ÂÆûÁé∞ÔºåÂç≥ËøîÂõû Reactive Á±ªÂûãÔºåÊàñËÄÖËøîÂõûËØ•Á±ªÂûãÂÆû‰æã„ÄÇÂÖ∂‰∏≠ÔºåÂÆÉÂ∞Ü‰∏äÈù¢ÁöÑÂÖ≥ËÅîÁ±ªÂûã associatedtypeÔºåËÆæÁΩÆ‰∏∫Ë∞ÉÁî®ËÄÖËá™Ë∫´Ôºö 123456789101112131415161718192021extension ReactiveCompatible &#123; /// Reactive extensions. public static var rx: Reactive&lt;Self&gt;.Type &#123; get &#123; return Reactive&lt;Self&gt;.self &#125; set &#123; // this enables using Reactive to "mutate" base type &#125; &#125; /// Reactive extensions. public var rx: Reactive&lt;Self&gt; &#123; get &#123; return Reactive(self) &#125; set &#123; // this enables using Reactive to "mutate" base object &#125; &#125;&#125; Êé•ÁùÄÁúã Reactive ÁöÑÂÆö‰πâÔºåÂÆÉÊòØ‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÔºåÊé•Âèó‰∏Ä‰∏™Ê≥õÂûãÂèÇÊï∞„ÄÇËøô‰∏™ÁªìÊûÑ‰ΩìÂæàÁÆÄÂçïÔºåÂè™Êúâ‰∏Ä‰∏™Ê≥õÂûãÁ±ªÂûãÁöÑÂ±ûÊÄß base„ÄÇ‰∏äÈù¢ÊñπÊ≥ïÂú®ÂàõÂª∫ Reactive ÂÆû‰æãÁöÑÊó∂ÂÄôÔºåÂ∞ÜË∞ÉÁî®ËÄÖËÆæÁΩÆ‰∏∫ÂÖ∂ base Â±ûÊÄßÔºåÊØîÂ¶ÇË∞ÉÁî® button.rxÔºåÈÇ£‰πàÂ∞±‰ºöÂ∞Ü button ÂÆû‰æãËÆæÁΩÆ‰∏∫ÂÖ∂ baseÔºö 1234567891011public struct Reactive&lt;Base&gt; &#123; /// Base object to extend. public let base: Base /// Creates extensions with base object. /// /// - parameter base: Base object. public init(_ base: Base) &#123; self.base = base &#125;&#125; Âõ†‰∏∫ÊâÄÊúâÁöÑÊéß‰ª∂ÈÉΩÊòØÁªßÊâø‰∫é NSObjectÔºåÊâÄ‰ª•Ë¶ÅËÆ©ÊâÄÊúâÊéß‰ª∂ÈÉΩÊã•Êúâ rx Ëøô‰∏™Â±ûÊÄßÔºåÂè™ÈúÄË¶ÅËÆ© NSObject ÂÆûÁé∞ ReactiveCompatible Âç≥ÂèØÔºö 12/// Extend NSObject with `rx` proxy.extension NSObject: ReactiveCompatible &#123; &#125; ËøôÊ†∑Ôºårx Â∞±ÂíåÂü∫Êú¨Êéß‰ª∂ÂÖ≥ËÅî‰∫ÜËµ∑Êù•„ÄÇ‰ΩÜÊòØ Reactive Ëøô‰∏™ÁªìÊûÑ‰ΩìËøô‰πàÁÆÄÂçïÔºåÂÆÉÊòØÊÄé‰πàÊãìÂ±ïÂá∫Ëøô‰πàÂ§ö rx Â±ûÊÄßÁöÑÂë¢ÔºüÊàë‰ª¨‰ª• UIButton ‰∏∫‰æã„ÄÇÊâìÂºÄ RxCocoa ‰∏≠ÁöÑ UIButton+Rx.swiftÔºåËøôÊòØ‰∏Ä‰∏™ÂØπ‰∫é button ÁöÑ rx ÊãìÂ±ïÔºö 1234567extension Reactive where Base: UIButton &#123; /// Reactive wrapper for `TouchUpInside` control event. public var tap: ControlEvent&lt;Void&gt; &#123; return controlEvent(.touchUpInside) &#125;&#125; ËøôÈáåÈÄöËøáÊ®°ÂºèÂåπÈÖç where Â∞ÜÊ≥õÂûã Base ÈôêÂà∂‰∏∫ UIButtonÔºå‰∏∫ UIButton Ê∑ªÂä†ÁâπÂÆöÁöÑÂ±ûÊÄß„ÄÇËøôÈáåÂè™Âàó‰∏æ‰∏Ä‰∏™ tap Â±ûÊÄßÔºåÂÖ∂ÂÆûËøòÊúâ‰∏Ä‰∏™ title ÊñπÊ≥ï„ÄÇÊàë‰ª¨ÂÖà‰∏çÁÆ°Ëøô‰∏™ ControlEvent ÊòØÂï•ÔºåËøô‰∏™ÂêéÈù¢‰ºöËÆ≤„ÄÇËá≥Ê≠§ÔºåÊéß‰ª∂Â∞±Ëé∑Âæó‰∫Ü rx Áõ∏ÂÖ≥ÁöÑÂ±ûÊÄß‰∫Ü„ÄÇ ÊÄª‰πãÔºåÊï¥‰∏™ËøáÁ®ãÂ∞±ÊòØÔºåÈÄöËøáËÆ© NSObject ÂÆûÁé∞‰∏Ä‰∏™ÂçèËÆÆÔºå‰ΩøÊéß‰ª∂Ëé∑Âæó rx Â±ûÊÄßÔºåÁÑ∂ÂêéÂú® rx Á±ªÂûãÁöÑ extension ‰∏≠Ôºå‰ª•Ê®°ÂºèÂåπÈÖçÁöÑÊñπÂºè‰∏∫‰∏çÂêåÊéß‰ª∂ÁöÑ rx Ê∑ªÂä†Áõ∏Â∫îÁöÑÂ±ûÊÄß„ÄÇËøáÁ®ãÂ¶ÇÂõæÊâÄÁ§∫Ôºö Â¶Ç‰ΩïÂàõÂª∫ Observable ‰ª•ÂèäËÆ¢ÈòÖÊ¶ÇËø∞Êàë‰ª¨Áü•ÈÅìÈÄöËøá createÔºåjustÔºåof Á≠âÊñπÊ≥ïÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ Observable„ÄÇÈÇ£‰πàËøôÊòØÂ¶Ç‰ΩïÂÅöÂà∞ÁöÑÂë¢ÔºüÊàë‰ª¨‰ª• create ÂàõÂª∫ÁöÑËÆ¢ÈòÖ‰∏∫‰æã„ÄÇËøô‰∏ÄÂàõÂª∫ÂèäËÆ¢ÈòÖËøáÁ®ãËøòÊòØÊØîËæÉÂ§çÊùÇÁöÑÔºåÊ∂âÂèäÁöÑÁ±ª‰ª•ÂèäÁõ∏‰∫íÂÖ≥Á≥ªÂæàÂ§ö„ÄÇÊâÄ‰ª•ÊàëÂÖàÊääÊâÄÊúâÁõ∏ÂÖ≥Á±ªÁöÑÂÖ≥Á≥ªÂõæÂ±ïÁ§∫Âá∫Êù•Ôºö Êï¥‰∏™ËøáÁ®ãÊ∂âÂèäÂõõ‰∏™ÈÉ®ÂàÜÔºöObservableÔºåObserverÔºåSinkÔºåDisposer„ÄÇ Observable ‰∏ªË¶ÅÂ∞±ÊòØ‰øùÂ≠ò‰∫Ü‰∫ã‰ª∂ÈòüÂàóÔºõObserver ‰∏ªË¶Å‰øùÂ≠ò‰∫Ü‰∫ã‰ª∂ÈòüÂàóÁöÑÂ§ÑÁêÜÊñπÊ≥ïÔºõSink ËøûÊé•Ââç‰∏§ËÄÖÔºåÁî±ÂÆÉÊù•ËÆ© Observer ÂìçÂ∫î Observable ÁöÑ‰∫ã‰ª∂ÔºõDisposer ‰øùÂ≠ò‰∫Ü Sink ÁöÑÂÆû‰æãÔºå‰ª•‰æøÂõûÊî∂„ÄÇ ÂàõÂª∫È¶ñÂÖàÊàë‰ª¨Êù•Áúã step 1ÔºåË∞ÉÁî®ÁöÑ create ÊñπÊ≥ïÂ≠òÂú®‰∫é Observable ÁöÑ‰∏Ä‰∏™ÊãìÂ±ï‰∏≠ÔºåÂåÖÂê´‰∫ÜÂêÑÁßç Observable ÁöÑÂàõÂª∫ÊñπÊ≥ï„ÄÇcreate ÊñπÊ≥ïÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂåøÂêçÁöÑ Observable AnonymousObservableÔºåÂπ∂Â∞ÜÂåÖÂê´ÂêÑÁßç‰∫ã‰ª∂ÁöÑÈó≠ÂåÖ‰º†ÂÖ•Ôºö 12345extension Observable &#123; public static func create(_ subscribe: @escaping (AnyObserver&lt;E&gt;) -&gt; Disposable) -&gt; Observable&lt;E&gt; &#123; return AnonymousObservable(subscribe) &#125;&#125; Êù•Âà∞ step 2Ôºå AnonymousObservable ÂàùÂßãÂåñÁöÑËøáÁ®ãÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÂ∞Ü‰º†ÂÖ•ÁöÑÂåÖÂê´‰∫ã‰ª∂ÁöÑÈó≠ÂåÖ‰øùÂ≠òËµ∑Êù•„ÄÇÂè¶Â§ñËØ•Á±ªËøòÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÈáçÂÜôÁöÑ run ÊñπÊ≥ïÔºö 123456789101112131415final class AnonymousObservable&lt;Element&gt; : Producer&lt;Element&gt; &#123; typealias SubscribeHandler = (AnyObserver&lt;Element&gt;) -&gt; Disposable let _subscribeHandler: SubscribeHandler init(_ subscribeHandler: @escaping SubscribeHandler) &#123; _subscribeHandler = subscribeHandler &#125; override func run&lt;O : ObserverType&gt;(_ observer: O, cancel: Cancelable) -&gt; (sink: Disposable, subscription: Disposable) where O.E == Element &#123; let sink = AnonymousObservableSink(observer: observer, cancel: cancel) let subscription = sink.run(self) return (sink: sink, subscription: subscription) &#125;&#125; Âà∞ËøôÈáåÔºåÂàõÂª∫ Observable ÁöÑËøáÁ®ãÂ∞±ÁªìÊùü‰∫Ü„ÄÇÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØÂÜÖÈÉ®ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂåøÂêçÁöÑ ObservableÔºåÁÑ∂ÂêéÂ∞Ü‰∫ã‰ª∂Èó≠ÂåÖ‰øùÂ≠ò„ÄÇ‰∏ãÈù¢ÊòØËÆ¢ÈòÖËøáÁ®ã„ÄÇ ËÆ¢ÈòÖÊù•Âà∞ step 3ÔºåËÆ¢ÈòÖÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Ë∞ÉÁî®ÁöÑÊòØ ObservableType Êèê‰æõÁöÑËÆ¢ÈòÖÊñπÊ≥ï„ÄÇObservableType ÊòØ‰∏Ä‰∏™ÂçèËÆÆÔºåÁî± Observable ÂÆûÁé∞„ÄÇËøô‰∏™ÊñπÊ≥ï‰∏≠ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂåøÂêçÁöÑ Observer AnonymousObserverÔºå‰πüÂ∞±ÊòØ step 4ÔºåÊää‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÁöÑÈó≠ÂåÖ‰º†ÂÖ•„ÄÇÁÑ∂ÂêéÂ∞±ÊòØËßÇÂØüËÄÖËÆ¢ÈòÖ‰∫ã‰ª∂ÈòüÂàóÔºåÂç≥ step 5Ôºö 12345678910111213extension ObservableType &#123; public func subscribe(_ on: @escaping (Event&lt;E&gt;) -&gt; Void) -&gt; Disposable &#123; let observer = AnonymousObserver &#123; e in on(e) &#125; return self.subscribeSafe(observer) &#125; fileprivate func subscribeSafe&lt;O: ObserverType&gt;(_ observer: O) -&gt; Disposable where O.E == E &#123; return self.asObservable().subscribe(observer) &#125;&#125; step 5 ÁöÑÊñπÊ≥ï‰∏≠ÔºåË∞ÉÁî®ÁöÑÊòØÂÖ•ÂèÇ‰∏∫ Observer ÁöÑ subscribe ÊñπÊ≥ï„ÄÇÂú® Observable Á±ª‰∏≠ÂÆö‰πâ‰∫ÜËØ•ÊñπÊ≥ï„ÄÇ‰∏çËøáËøô‰∏™ÊñπÊ≥ïÂπ∂Ê≤°ÊúâÂÖ∑‰ΩìÂÆûÁé∞ÔºåÂÆÉË¶ÅÊ±ÇÂÖ∂Â≠êÁ±ªÂÆûÁé∞„ÄÇÂê¶ÂàôÂ∞±‰ºöÊäõÂá∫ÂºÇÂ∏∏Ôºö 1234567891011public class Observable&lt;Element&gt; : ObservableType &#123; /// Type of elements in sequence. public typealias E = Element ... public func subscribe&lt;O: ObserverType&gt;(_ observer: O) -&gt; Disposable where O.E == E &#123; abstractMethod() &#125; ... &#125; Observable Âú®Êú¨‰æãÁöÑÂ≠êÁ±ªÊòØ AnonymousObservableÔºå‰∏çËøá‰∏çÊòØÁõ¥Êé•Â≠êÁ±ªÔºåËøô‰∏§‰∏™Á±ª‰∏≠ËøòÂ§πÁùÄ‰∏Ä‰∏™ Producer Á±ª„ÄÇÊâÄ‰ª•ËÆ¢ÈòÖÁöÑËøáÁ®ã step 6 Âú® Producer ‰∏≠Ôºö 12345678910111213141516171819202122232425class Producer&lt;Element&gt; : Observable&lt;Element&gt; &#123; override func subscribe&lt;O : ObserverType&gt;(_ observer: O) -&gt; Disposable where O.E == Element &#123; if !CurrentThreadScheduler.isScheduleRequired &#123; // The returned disposable needs to release all references once it was disposed. let disposer = SinkDisposer() let sinkAndSubscription = run(observer, cancel: disposer) disposer.setSinkAndSubscription(sink: sinkAndSubscription.sink, subscription: sinkAndSubscription.subscription) return disposer &#125; else &#123; return CurrentThreadScheduler.instance.schedule(()) &#123; _ in let disposer = SinkDisposer() let sinkAndSubscription = self.run(observer, cancel: disposer) disposer.setSinkAndSubscription(sink: sinkAndSubscription.sink, subscription: sinkAndSubscription.subscription) return disposer &#125; &#125; &#125; func run&lt;O : ObserverType&gt;(_ observer: O, cancel: Cancelable) -&gt; (sink: Disposable, subscription: Disposable) where O.E == Element &#123; abstractMethod() &#125;&#125; step 6 ÁöÑÊñπÊ≥ïÂÖàÂàõÂª∫‰∫Ü‰∏Ä‰∏™ SinkDisposerÔºåÂç≥ step 7„ÄÇË¶ÅÁïôÊÑèËøô‰∏™ SinkDisposerÔºåÂõ†‰∏∫ÊúÄÂêéÊàë‰ª¨Âä†ÂÖ• disposebag ÁöÑÔºåÂ∞±ÊòØËøô‰∏™ disposer ÂÆû‰æã„ÄÇ ‰∏ã‰∏ÄÊ≠•Ë∞ÉÁî® run ÊñπÊ≥ï„ÄÇÊàë‰ª¨ÁúãÂà∞‰∏äÈù¢ÁöÑ‰ª£Á†Å‰∏≠Ôºårun ÊñπÊ≥ï‰πüÊòØ‰∏Ä‰∏™Á±ª‰ººÁöÑÊäΩË±°ÊñπÊ≥ï„ÄÇÈÇ£‰πà step 8 ‰∏≠ÔºåÊàë‰ª¨Â∞±Ë¶ÅÂà∞ÂÆÉÁöÑÂ≠êÁ±ª AnonymousObservable ‰∏≠ÊâæÔºåËøô‰∏™‰∏äÈù¢‰πüÊèêÂà∞Ëøá„ÄÇ ÊâßË°åÊù•Áúã‰∏Ä‰∏ãËøô‰∏™ run ÊñπÊ≥ïÁöÑÂÆûÁé∞„ÄÇÂÆÉÊé•ÂèóÂàöÊâçÂàõÂª∫ÁöÑÂåøÂêç Observer AnonymousObserverÔºå‰ª•Âèä SinkDisposerÔºö 12345678final class AnonymousObservable&lt;Element&gt; : Producer&lt;Element&gt; &#123; ... override func run&lt;O : ObserverType&gt;(_ observer: O, cancel: Cancelable) -&gt; (sink: Disposable, subscription: Disposable) where O.E == Element &#123; let sink = AnonymousObservableSink(observer: observer, cancel: cancel) let subscription = sink.run(self) return (sink: sink, subscription: subscription) &#125;&#125; Á¨¨‰∏ÄÊ≠• step 9ÔºåÂàõÂª∫‰∫Ü‰∏Ä‰∏™ AnonymousObservableSink ÂÆû‰æã„ÄÇËøô‰∏™ AnonymousObservableSink Âç≥ÂÆûÁé∞‰∫Ü ObserverType ÂçèËÆÆÔºåÂèàÂÆûÁé∞‰∫Ü Disposable ÂçèËÆÆÔºåÊâÄ‰ª•ÂÆÉÊó¢ÊòØ‰∏Ä‰∏™ ObserverÔºåÂèàÊòØ‰∏Ä‰∏™ Disposer„ÄÇÂú®ÂÆÉÁöÑÂàùÂßãÂåñÊñπÊ≥ï‰∏≠ÔºåË∞ÉÁî®‰∫ÜÁà∂Á±ª Sink ÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºå‰πüÂ∞±ÊòØ step 10Ôºö 1234567891011class Sink&lt;O : ObserverType&gt; : Disposable &#123; fileprivate let _observer: O fileprivate let _cancel: Cancelable fileprivate var _disposed: Bool init(observer: O, cancel: Cancelable) &#123; _observer = observer _cancel = cancel _disposed = false &#125;&#125; Êó†ÂÖ≥‰ª£Á†ÅÂà†Èô§ÂêéÔºåÂèØ‰ª•ÁúãÂà∞ÔºåSink ‰∏≠ÂåÖÂê´‰∫Ü ObserverÔºå‰πüÂåÖÂê´‰∫ÜÊúÄÁªàÁöÑ Disposer ÂÆû‰æã„ÄÇ ÂõûÂà∞ step 8ÔºåÂú®ÂàõÂª∫ÂÆå AnonymousSink ÂêéÔºåË∞ÉÁî®ÂÖ∂ run ÊñπÊ≥ïÔºåÂπ∂Â∞ÜËøîÂõûÂÄºËµãÁªô subscription„ÄÇÊàë‰ª¨Êù•Áúã‰∏Ä‰∏ã step 11ÔºåËøô‰∏™ run ÊñπÊ≥ïÂÅö‰∫Ü‰ªÄ‰πàÔºö 1234567891011121314151617181920212223final class AnonymousObservableSink&lt;O: ObserverType&gt; : Sink&lt;O&gt;, ObserverType &#123; typealias E = O.E typealias Parent = AnonymousObservable&lt;E&gt; func on(_ event: Event&lt;E&gt;) &#123; switch event &#123; case .next: if _isStopped == 1 &#123; return &#125; forwardOn(event) case .error, .completed: if AtomicCompareAndSwap(0, 1, &amp;_isStopped) &#123; forwardOn(event) dispose() &#125; &#125; &#125; func run(_ parent: Parent) -&gt; Disposable &#123; return parent._subscribeHandler(AnyObserver(self)) &#125;&#125; Ëøô‰∏™ÊñπÊ≥ï‰∏≠ÊÄªÁÆóÊâßË°å‰∫Ü‰πãÂâç‰øùÂ≠òÂú® AnonymousObservable ÂØπË±°‰∏≠ÁöÑ‰∫ã‰ª∂Èó≠ÂåÖ„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ºöÂ•áÊÄ™‰∏∫‰ªÄ‰πàÂÆÉË¶ÅÁî® AnyObserver(self) Êù•‰ª£Êõø‰πãÂâçÂàõÂª∫ÁöÑ AnonymousObserverÔºåËøôÊòØ‰∏∫‰∫ÜÊì¶Èô§Á±ªÂûãÔºåÂèçÊ≠£Áé∞Âú®ÈúÄË¶ÅÁöÑÂ∞±ÊòØ‰∏Ä‰∏™Êúâ‰∫ã‰ª∂ÂìçÂ∫îÊñπÊ≥ïÁöÑ Observer„ÄÇ ÊâßË°å‰∫ã‰ª∂Èó≠ÂåÖÂèëÂá∫‰∫ã‰ª∂Ôºå‰πüÂ∞±ÊòØË∞ÉÁî® Observer Áõ∏Â∫îÁöÑÂìçÂ∫îÊñπÊ≥ï„ÄÇAnyObserver Á®çÂæÆÂÅö‰∫Ü‰∏™ËΩ¨Êç¢ÔºåÂìçÂ∫îÊñπÊ≥ïË∞ÉÁî®ÁöÑÊòØ‰∏äÈù¢ AnonymousObservableSink ÁöÑ on ÊñπÊ≥ï„ÄÇËøô‰∏ÄÊ≠•ÊòØ step 12„ÄÇ Âú® on ÊñπÊ≥ï‰∏≠ÔºåÂ∞Ü‰∫ã‰ª∂ËøõË°åËΩ¨ÂèëÔºåÊù•Âà∞ step 13Ôºå sink ‰∏≠ÁöÑ forwardOn ‰∏≠Ôºö 123456789class Sink&lt;O : ObserverType&gt; : Disposable &#123; ... final func forwardOn(_ event: Event&lt;O.E&gt;) &#123; if _disposed &#123; return &#125; _observer.on(event) &#125;&#125; ËøôÈáåÁöÑ _observer Â∫îËØ•ÂæàÁÜüÊÇâÔºåÂ∞±ÊòØÂàöÊâç‰øùÂ≠òÁöÑ AnonymousObserver„ÄÇ‰∏çËøá AnonymousObserver Ëøô‰∏™Á±ªÂæàÁÆÄÈôãÔºåÂπ∂Ê≤°Êúâ on ÊñπÊ≥ïÂïäÔºö 123456789101112131415161718192021222324final class AnonymousObserver&lt;ElementType&gt; : ObserverBase&lt;ElementType&gt; &#123; typealias Element = ElementType typealias EventHandler = (Event&lt;Element&gt;) -&gt; Void private let _eventHandler : EventHandler init(_ eventHandler: @escaping EventHandler) &#123;#if TRACE_RESOURCES let _ = Resources.incrementTotal()#endif _eventHandler = eventHandler &#125; override func onCore(_ event: Event&lt;Element&gt;) &#123; return _eventHandler(event) &#125; #if TRACE_RESOURCES deinit &#123; let _ = Resources.decrementTotal() &#125;#endif&#125; Âà∞Áà∂Á±ª ObserverBase ‰∏≠Êü•ÁúãÔºö 12345678910111213141516171819202122232425class ObserverBase&lt;ElementType&gt; : Disposable, ObserverType &#123; typealias E = ElementType private var _isStopped: AtomicInt = 0 func on(_ event: Event&lt;E&gt;) &#123; switch event &#123; case .next: if _isStopped == 0 &#123; onCore(event) &#125; case .error, .completed: if !AtomicCompareAndSwap(0, 1, &amp;_isStopped) &#123; return &#125; onCore(event) &#125; &#125; func onCore(_ event: Event&lt;E&gt;) &#123; abstractMethod() &#125;&#125; ObserverBase ÁöÑ on ‰∏≠ÔºåÊúÄÁªàËøòÊòØËµ∞‰∫ÜÂ≠êÁ±ªÁöÑ onCore„ÄÇÊàëÁöÑÂ§©ÔºåËøô‰∏ÄÈÄöÊäòËÖæ„ÄÇÂ§ÑÁêÜÂÆå‰∫ã‰ª∂ÔºåÊúÄÁªàËøîÂõûÁªôÂâçÈù¢ÁöÑ subscription ÁöÑÂ∞±ÊòØÂú®‰∫ã‰ª∂ÈòüÂàó‰∏≠ÂàõÂª∫ÁöÑ Disposer„ÄÇ ÂõûÊî∂Áé∞Âú®‰∫ã‰ª∂ÈÉΩÂ∑≤ÁªèÂ§ÑÁêÜÂÆå‰∫ÜÔºåÂõûÂà∞ step 6ÔºåÁªßÁª≠ÂæÄ‰∏ãËµ∞ÔºåÊâßË°å step 16Ôºö 12345678910111213141516171819202122fileprivate final class SinkDisposer: Cancelable &#123; private var _state: AtomicInt = 0 private var _sink: Disposable? = nil private var _subscription: Disposable? = nil func setSinkAndSubscription(sink: Disposable, subscription: Disposable) &#123; _sink = sink _subscription = subscription let previousState = AtomicOr(DisposeState.sinkAndSubscriptionSet.rawValue, &amp;_state) if (previousState &amp; DisposeStateInt32.sinkAndSubscriptionSet.rawValue) != 0 &#123; rxFatalError("Sink and subscription were already set") &#125; if (previousState &amp; DisposeStateInt32.disposed.rawValue) != 0 &#123; sink.dispose() subscription.dispose() _sink = nil _subscription = nil &#125; &#125;&#125; ÂÆÉÊää AnonymousObservableSink ‰ª•Âèä subscription ‰øùÂ≠ò‰∫ÜËµ∑Êù•„ÄÇ‰πüÂ∞±ÊòØËØ¥ÊúÄÁªàËøîÂõûÁöÑ SinkDisposer ‰∏≠‰ºöÂåÖÂê´‰∏§‰∏™ Disposer„ÄÇÂ¶ÇÊûúÊâßË°å‰∫Ü dispose()ÔºåÈÇ£‰πàËøô‰∏§‰∏™ Disposer ÈÉΩ‰ºöÊâßË°åÂêÑËá™ÁöÑ dispose()ÔºåÂπ∂‰∏îÈáäÊîæ„ÄÇËøôÊ†∑Â∞±ÊòØ‰∏∫‰ªÄ‰πàÊàë‰ª¨Âú® subscribeHandle ‰∏≠Èöè‰æøÂàõÂª∫ÁöÑ‰∏Ä‰∏™ DisposerÔºå‰πüËÉΩËµ∑‰ΩúÁî®ÁöÑÂéüÂõ†„ÄÇ SinkDisposer ÂºïÁî®‰∫Ü AnonymousObservableSink ‰ª•Âèä subscription„ÄÇAnonymousObservableSink ÂºïÁî®‰∫Ü SinkDisposer ‰ª•Âèä AnonymousObserver„ÄÇËøôÊòØ‰∏Ä‰∏™ÂºïÁî®Âæ™ÁéØÔºå‰∏∫ÁöÑÊòØÂêÑËá™Ë∞ÉÁî®ÂêÑËá™ÁöÑ dispose() ÁöÑÊó∂ÂÄôÔºåÈÉΩËÉΩËß¶ÂèëÂØπÊñπÁöÑ dispose() ÔºåÂ∞ÜÂØπÊñπ‰πüÂõûÊî∂„ÄÇ ÂÖ∂ÂÆûÂú®Ê≤°ÁúãÊ∫êÁ†ÅÂâçÂ§ßÊ¶ÇÁöÑÊÉ≥Ê≥ï‰πüÊòØÔºåÂú® Observable ÂÜÖÈÉ®ÂàõÂª∫‰øùÂ≠ò‰∏Ä‰∏™‰∏çË¢´Â§ñÁïåÁü•ÈÅìÁöÑ ObserverÔºåËøõË°å‰∫ã‰ª∂Â§ÑÁêÜ„ÄÇÂÆûÈôÖ‰∏äÂë¢ÊòØÊ∑ªÂä†‰∫Ü‰∏Ä‰∏™ Sink Á±ªËΩ¨Ê¢¶Áî®Êù•‰øùÂ≠ò ObserverÔºåÂπ∂‰∏îËøõË°åÂ§ÑÁêÜ„ÄÇ ÊòéÁôΩ‰∫Ü Disposer ÁöÑÂºïÁî®ÂÖ≥Á≥ªÔºå‰πüÂ∞±ÊòéÁôΩ‰∫ÜÂ¶Ç‰ΩïÂ∞ÜËÆ¢ÈòÖÂõûÊî∂ÁöÑ‰∫Ü„ÄÇÂè¶Â§ñÔºåÂ∞Ü Sink ËÆæËÆ°Êàê Disposable ‰πü‰ΩøÂæóÂõûÊî∂Êõ¥Âä†Êñπ‰æø Subject ÁöÑÂàõÂª∫‰∏éËÆ¢ÈòÖSubject ÊòØ hot observableÔºåÂíå‰∏äÈù¢ÁöÑÂå∫Âà´Âú®‰∫éÔºåÂèØ‰ª•Ëá™Â∑±ÂÆö‰πâ‰∫ã‰ª∂Ëß¶ÂèëÁöÑÊó∂Êú∫„ÄÇÈÇ£‰πàËøô‰∏™‰∏çÂêåÊòØÂ¶Ç‰Ωï‰ΩìÁé∞Âá∫Êù•ÁöÑÂë¢Ôºü‰∏ãÈù¢Êù•ÁûßÁûß Variable ÁöÑÂéüÁêÜ„ÄÇ VariableVariable ÊòØ BehaviorSubject ÁöÑÂ∞ÅË£Ö„ÄÇÊù•Áúã‰∏Ä‰∏ã Variable ‰∏≠ÁöÑÂ±ûÊÄßÔºö 12345678910111213public final class Variable&lt;Element&gt; &#123; public typealias E = Element private let _subject: BehaviorSubject&lt;Element&gt; private var _lock = SpinLock() // state private var _value: E ...&#125; ÂèØ‰ª•ÁúãÂà∞ÔºåÂæàÁÆÄÂçïÔºå‰∏Ä‰∏™ BehaviorSubjectÔºå‰∏Ä‰∏™ÂêåÊ≠•ÈîÅÔºå‰ª•Âèä‰∏Ä‰∏™ value Â±ûÊÄß„ÄÇVariable Âíå BehaviorSubject Áõ∏ÊØîÔºåÂîØ‰∏ÄÁöÑ‰∏çÂêåÂ∞±ÊòØ Variable Êúâ‰∏Ä‰∏™ value Â±ûÊÄßÔºå Âπ∂Âú®ÂÖ∂ set ÊñπÊ≥ï‰∏≠ÔºåËá™Âä®Ëß¶Âèë‰∫Ü next ‰∫ã‰ª∂„ÄÇ Áé∞Âú®Áúã‰∏Ä‰∏ãÂàùÂßãÂåñÊñπÊ≥ïÔºå‰ª•Âèä value ÁöÑ get set ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132public final class Variable&lt;Element&gt; &#123; ... /// Gets or sets current value of variable. /// /// Whenever a new value is set, all the observers are notified of the change. /// /// Even if the newly set value is same as the old value, observers are still notified for change. public var value: E &#123; get &#123; _lock.lock(); defer &#123; _lock.unlock() &#125; return _value &#125; set(newValue) &#123; _lock.lock() _value = newValue _lock.unlock() _subject.on(.next(newValue)) &#125; &#125; /// Initializes variable with initial value. /// /// - parameter value: Initial variable value. public init(_ value: Element) &#123; _value = value _subject = BehaviorSubject(value: value) &#125; ...&#125; init ÊñπÊ≥ïÂ∞±ÊòØÂàùÂßãÂåñ‰∫Ü‰∏Ä‰∏™ BehaviorSubject ‰ª•ÂèäËÆæÁΩÆ‰∫Ü value ÁöÑÂàùÂßãÂÄº„ÄÇvalue ÁöÑ setter ÊñπÊ≥ïÂ∞±ÊòØÊõ¥Êñ∞‰∫Ü value ÂÄºÔºåÁÑ∂ÂêéËß¶Âèë‰∫Ü BehaviorSubject ÁöÑ‰∫ã‰ª∂„ÄÇ ËøôÈáåÂ≠¶‰π†‰∏Ä‰∏™Âä†ÈîÅËß£ÈîÅÁöÑÊñπÊ≥ïÔºåÂú® getter ÊñπÊ≥ï‰∏≠ÈÄöËøá defer Âú® return ‰πãÂêéÊâßË°åËß£ÈîÅÊìç‰Ωú„ÄÇ Â•Ω‰∫ÜËøôÂ∞±ÊòØ Variable ÁöÑÂÖ®ÈÉ®‰∫Ü„ÄÇÁî±‰∫é Variable Âπ∂‰∏çÊòØÁªßÊâø‰∫é ObservableÔºåÊâÄ‰ª•‰Ω†ÁîöËá≥ÈÉΩ‰∏çËÉΩËÆ¢ÈòÖÔºåÂè™ËÉΩÈÄöËøá asObservable ÊñπÊ≥ïÔºåËøîÂõûÂÖ∂‰∏≠ÁöÑ BehaviorSubject Â±ûÊÄß„ÄÇ‰∏ãÈù¢Êù•Áúã‰∏ã BehaviorSubject ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑ„ÄÇ BehaviorSubjectÊàë‰ª¨‰ΩøÁî® BehaviorSubject ËøõË°åËÆ¢ÈòÖÁöÑÊó∂ÂÄôÔºå‰∏ÄÂºÄÂßãÁöÑÊ≠•È™§ËøòÊòØ‰∏ÄÊ†∑ÁöÑÔºöObservable ÂÖàÂàõÂª∫‰∏Ä‰∏™ AnonymousObserverÔºåÂ∞Ü‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïËÆæÁΩÆÁªôÂÆÉÁöÑ eventHandler Â±ûÊÄß„ÄÇÊâÄÊúâÁöÑ Observable ËÆ¢ÈòÖÔºåÈÉΩ‰ºöËøõË°åËøôÊ†∑ÁöÑÊñπÊ≥ïÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜËøôÈÉ®ÂàÜÊàê‰∏∫ËÆ¢ÈòÖÁöÑÂÖ¨ÂÖ±ÈÉ®ÂàÜ„ÄÇ ÁÑ∂ÂêéÂà∞‰∏äÈù¢ÁöÑ step 5 ÂºÄÂßãÊúâÂå∫Âà´‰∫Ü„ÄÇÂú® create ‰∏≠ÔºåÁî±‰∫éÁªßÊâøÂÖ≥Á≥ªË∞ÉÁî®ÁöÑÊòØ Producer ÁöÑ subscribeÔºõËÄå BehaviorSubject ‰∏≠‰πüÂÆûÁé∞‰∫ÜËá™Â∑±ÁöÑ subscribe ÊñπÊ≥ïÔºåÊàë‰ª¨ÂèØ‰ª•Áß∞ËøôÈÉ®ÂàÜ‰∏∫ËÆ¢ÈòÖÁöÑÁßÅÊúâÈÉ®ÂàÜ(Ëøô‰∏§‰∏™ÂêçÂ≠óÈÉΩÊòØÊàëÈöè‰æøËµ∑ÁöÑ)„ÄÇ Âú® Producer ÁöÑËÆ¢ÈòÖÁßÅÊúâÈÉ®ÂàÜÔºåËøõË°åÁöÑÊòØ step7 ‰ª•Âèä step 8Ôºå‰πüÂ∞±ÊòØÂàõÂª∫‰∏Ä‰∏™ SinkDisposer ÂíåÊâßË°å run ÊñπÊ≥ï(ÊâßË°å‰∫ã‰ª∂Èó≠ÂåÖ‰∏≠ÁöÑ‰∫ã‰ª∂)ÔºåËøô‰πüÂ∞±ÊòØ create ËÉΩÂ§üËá™Â∑±ÂèëÂá∫‰∫ã‰ª∂ÁöÑÂéüÂõ†„ÄÇBehaviorSubject ÁöÑËÆ¢ÈòÖÁßÅÊúâÈÉ®ÂàÜÂÅöÁöÑÊòØÂ∞ÜÂàöÂàõÂª∫ÁöÑ AnonymousObserver ‰øùÂ≠òËµ∑Êù•ÔºåÁÑ∂Âêé‰ª•ÂΩìÂâç value ÂÄº‰Ωú‰∏∫‰∫ã‰ª∂ÂÄºÔºåÂèëÂá∫‰∏Ä‰∏™‰∫ã‰ª∂ÔºåËøôÂ∞±ÊòØ BehaviorSubject ËÆ¢ÈòÖÂ∞±‰ºöËß¶Âèë‰∫ã‰ª∂ÁöÑÂéüÂõ†„ÄÇ ‰∏ãÈù¢Êù•Áúã‰ª£Á†ÅÔºåÈ¶ñÂÖàÁúãÁúã BehaviorSubject ÁöÑÂ±ûÊÄß: 123456789101112131415161718192021222324252627282930public final class BehaviorSubject&lt;Element&gt; : Observable&lt;Element&gt; , SubjectType , ObserverType , SynchronizedUnsubscribeType , Disposable &#123; public typealias SubjectObserverType = BehaviorSubject&lt;Element&gt; typealias DisposeKey = Bag&lt;AnyObserver&lt;Element&gt;&gt;.KeyType /// Indicates whether the subject has any observers public var hasObservers: Bool &#123; _lock.lock() let value = _observers.count &gt; 0 _lock.unlock() return value &#125; let _lock = RecursiveLock() // state private var _isDisposed = false private var _value: Element private var _observers = Bag&lt;(Event&lt;Element&gt;) -&gt; ()&gt;() private var _stoppedEvent: Event&lt;Element&gt;? /// Indicates whether the subject has been disposed. public var isDisposed: Bool &#123; return _isDisposed &#125;&#125; BehaviorSubject ÁöÑÂ±ûÊÄßÂ∞±Ëøô‰πàÂ§öÔºåÂü∫Êú¨‰∏äÁúãÂà∞ÈÉΩÊòØËÉΩ‰∏ÄÁúºÁúãÊòéÁôΩÁöÑ„ÄÇ_observers Â∞±ÊòØÂàõÂª∫ÁöÑ AnonymousObserverÔºåÂÆÉÁöÑÁ±ªÂûã Bag ÊòØ‰∏Ä‰∏™Â≠óÂÖ∏ÁöÑÂ∞ÅË£ÖÔºåÂÆÉÂèØ‰ª•‰∏∫‰∏çÂêåÁöÑ AnonymousObserver Êèê‰æõ‰∏çÂêåÁöÑÈîÆÔºåËøôÊ†∑ËÉΩÂú®ÂèñÊ∂àËÆ¢ÈòÖÁöÑÊó∂ÂÄô‰æø‰∫éÂõûÊî∂ÂìçÂ∫î AnonymousObserver„ÄÇÂè¶Â§ñÔºå_stoppedEvent ‰πüÊòØÈúÄË¶ÅËß£Èáä‰∏Ä‰∏ãÁöÑÔºåÂ∞±ÊòØÂú® completed ‰ª•Âèä error ‰∫ã‰ª∂ÂèëÁîüÂêéÔºå‰øùÂ≠òËøô‰∏™ eventÔºå‰ª•ÂêéÂΩìÊúâÂÖ∂‰ªñ‰∫ã‰ª∂Ëß¶ÂèëÁöÑÊó∂ÂÄôÔºåÂèëÂá∫ÁöÑÊòØËøô‰∏™ event ÁöÑ‰∫ã‰ª∂„ÄÇ Êé•‰∏ãÊù•Áúã‰∏Ä‰∏ãËÆ¢ÈòÖÁöÑÁßÅÊúâÈÉ®ÂàÜÁöÑÁõ∏ÂÖ≥‰ª£Á†ÅÔºö 123456789101112131415161718192021222324252627/// Subscribes an observer to the subject.////// - parameter observer: Observer to subscribe to the subject./// - returns: Disposable object that can be used to unsubscribe the observer from the subject.public override func subscribe&lt;O : ObserverType&gt;(_ observer: O) -&gt; Disposable where O.E == Element &#123; _lock.lock() let subscription = _synchronized_subscribe(observer) _lock.unlock() return subscription&#125;func _synchronized_subscribe&lt;O : ObserverType&gt;(_ observer: O) -&gt; Disposable where O.E == E &#123; if _isDisposed &#123; observer.on(.error(RxError.disposed(object: self))) return Disposables.create() &#125; if let stoppedEvent = _stoppedEvent &#123; observer.on(stoppedEvent) return Disposables.create() &#125; let key = _observers.insert(observer.on) observer.on(.next(_value)) return SubscriptionDisposable(owner: self, key: key)&#125; ÈúÄË¶ÅÊääËøôÈÉ®ÂàÜÂä†‰∏äÈîÅÔºåÈò≤Ê≠¢Âú®Â∞Ü Observer Âä†ÂÖ•Â≠óÂÖ∏ÁöÑÊó∂ÂÄôÔºå‰∫ßÁîüÈîôËØØ„ÄÇÁÑ∂ÂêéÂ∞±ÂÉè‰∏äÈù¢ËÆ≤ÁöÑ‰∏ÄÊ†∑ÔºåÂÖàÁúãÁúãÊúâÊ≤°Êúâ stoppedEventÔºåÊúâÁöÑËØùÊâßË°åËØ• eventÔºåÊ≤°ÊúâÁöÑËØùÔºåÂ∞Ü Observer Âä†ÂÖ•Â≠óÂÖ∏ÔºåÁÑ∂ÂêéËß¶ÂèëËøô‰∏™ Observer ÁöÑ‰∫ã‰ª∂„ÄÇ ÊúÄÂêéÔºåËøîÂõû‰∫Ü‰∏Ä‰∏™ SubscriptionDisposableÔºåÂÆÉÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÁÆÄÂçïÁöÑÁªìÊûÑ‰Ωì„ÄÇ‰øùÂ≠ò‰∫Ü selfÔºåÈò≤Ê≠¢ BehaviorSubject ÂõûÊî∂Ôºå‰øùÂ≠ò‰∫ÜkeyÔºåÁî®‰∫éÂõûÊî∂ÂØπÂ∫îÁöÑ Observer„ÄÇ on ÊñπÊ≥ïÊòØÂõ†‰∏∫ BehaviorSubject ‰πüÂÆûÁé∞‰∫Ü ObserverType ÂçèËÆÆÔºåÂÜçÁúã‰∏Ä‰∏ã on ÂÅö‰∫Ü‰ªÄ‰πàÔºö 1234567891011121314151617181920212223/// Notifies all subscribed observers about next event.////// - parameter event: Event to send to the observers.public func on(_ event: Event&lt;E&gt;) &#123; _lock.lock() dispatch(_synchronized_on(event), event) _lock.unlock()&#125;func _synchronized_on(_ event: Event&lt;E&gt;) -&gt; Bag&lt;(Event&lt;Element&gt;) -&gt; ()&gt; &#123; if _stoppedEvent != nil || _isDisposed &#123; return Bag() &#125; switch event &#123; case .next(let value): _value = value case .error, .completed: _stoppedEvent = event &#125; return _observers&#125; ÂêåÊ†∑ÁöÑ‰πüÊòØÂ∞ÜËøô‰∏™ËøáÁ®ãÈîÅ‰∏äÔºåÈÅøÂÖçÂú®ÊâßË°åÁöÑÊó∂ÂÄôÔºåÊñ∞ÁöÑ Observer Ë¢´Âä†ÂÖ•Â≠óÂÖ∏‰∏≠ÔºåÂØºËá¥Êñ∞ÁöÑ Observer ‰πüÂìçÂ∫î‰∫ã‰ª∂„ÄÇËøôÈáåÁöÑ dispatch ÊñπÊ≥ï‰∏ªË¶ÅÂ∞±ÊòØÈÄöËøá‰∏Ä‰∏™ for Âæ™ÁéØÔºåÂ∞Ü _observers ‰∏≠ÁöÑÊØè‰∏™ Observer ÈÉΩËß¶Âèë event ‰∫ã‰ª∂„ÄÇ‰∏ãÈù¢ÂêåÊ≠•ÁöÑ on ÊñπÊ≥ï‰πüÂ∞±‰∏çÂ§öËß£Èáä‰∫Ü„ÄÇ ËøôÂ∞±ÊòØ BehaviorSubject ÁöÑÂ§ßËá¥ÂÆûÁé∞ËøáÁ®ã„ÄÇ ÂÖ∂ÂÆû Subject Â∞±ÊòØÂÖ∏ÂûãÁöÑËßÇÂØüËÄÖÊ®°Âºè„ÄÇcreate ÊääÁ±ªÂ§ßÊ¶ÇÂàÜÊàê‰∫ÜÂõõ‰∏™ÈÉ®ÂàÜ„ÄÇSubject ÂàôÁªìÂêà‰∫Ü Observable Âíå Sink ÂÅöÁöÑ‰∫ãÊÉÖ„ÄÇÂÆÉÂú®ÂÜÖÈÉ®‰∏∫ÊØè‰∏™ËßÇÂØüËÄÖÂàõÂª∫‰∫ÜÂåøÂêçÁöÑ Observer Âπ∂‰øùÂ≠òÔºåÁÑ∂ÂêéÂèØ‰ª•Ëá™Ë°åË∞ÉÁî® onNext Ë∞ÉÁî®Ëøô‰∫õ Observer ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ï„ÄÇÂ∞ÜÂàõÂª∫‰∫ã‰ª∂ÈòüÂàóÂíåÊâßË°å‰∫ã‰ª∂ÈòüÂàóÊîæÂú®‰∫Ü‰∏ÄËµ∑„ÄÇ ‰ª£ÁêÜËΩ¨ÂèëÂâçÈù¢ÁöÑÊñáÁ´†ËØ¥Âà∞Ôºå‰ºöËØ¶ÁªÜÂèôËø∞‰∏Ä‰∏ã‰ª£ÁêÜËΩ¨ÂèëÁöÑÊµÅÁ®ãÔºåÈÇ£‰πàÁé∞Âú®Êù•Áúã‰∏ÄÁúãËøôÊñπÈù¢ÁöÑÊ∫êÁ†Å„ÄÇÊàë‰ª¨Âú® RxCocoa ‰∏≠Êâæ‰∏Ä‰∏™ÈúÄË¶ÅÂÆûÁé∞‰ª£ÁêÜÁöÑÊéß‰ª∂Á±ªÔºåÁúã‰∏Ä‰∏ãÂÆÉÁöÑËß£ÂÜ≥ÊñπÂºè„ÄÇÊØîÂ¶Ç UITabBarController„ÄÇ Êéß‰ª∂ÁöÑ rx ÊãìÂ±ïÂÖ≥‰∫é‰ª£ÁêÜËΩ¨ÂèëÈúÄË¶ÅÊàë‰ª¨ÂàõÂª∫ÁöÑÂè™Êúâ‰∏§‰∏™Á±ªÔºå‰∏Ä‰∏™ÊòØ UITabBarController ÁöÑ rx ÊãìÂ±ïÁ±ªÔºå‰∏Ä‰∏™ÊòØ UITabBarControllerDelegate ÁöÑÂÆûÁé∞Á±ª DelegateProxy„ÄÇÂÖàÊù•Áúã‰∏Ä‰∏ã UITabBarController ÁöÑ rx ÊãìÂ±ïÁ±ªÔºö 123456789101112131415161718extension Reactive where Base: UITabBarController &#123; /// Reactive wrapper for `delegate`. /// /// For more information take a look at `DelegateProxyType` protocol documentation. public var delegate: DelegateProxy &#123; return RxTabBarControllerDelegateProxy.proxyForObject(base) &#125; /// Reactive wrapper for `delegate` message `tabBarController:didSelect:`. public var didSelect: ControlEvent&lt;UIViewController&gt; &#123; let source = delegate.methodInvoked(#selector(UITabBarControllerDelegate.tabBarController(_:didSelect:))) .map &#123; a in return try castOrThrow(UIViewController.self, a[1]) &#125; return ControlEvent(events: source) &#125;&#125; Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåËøô‰∏™Á±ª‰∏≠ÂÖàÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ DelegateProxy Á±ªÂûãÁöÑ delegateÔºåËøôÂ∞±ÊòØ‰∏äÈù¢ÊâÄËØ¥ÁöÑ UITabBarControllerDelegate ÁöÑÂÆûÁé∞Á±ª„ÄÇÂè¶Â§ñÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ didSelect Â±ûÊÄßÔºåÂÆÉÁöÑÁ±ªÂûãÊòØ ControlEventÔºåÂÖ∂ÂÆûÂ∞±ÊòØ‰∏Ä‰∏™ Observable„ÄÇÊàë‰ª¨Áü•ÈÅì UITabBarControllerDelegate ‰∏≠Êúâ‰∏Ä‰∏™‰ª£ÁêÜÊñπÊ≥ïÂ∞±ÊòØ didSelectÔºåÊâÄ‰ª•ËøôÈáåÂÆö‰πâÁöÑ Observable ÂÖ∂ÂÆûÂ∞±ÊòØÁî®Êù•Êõø‰ª£‰º†ÁªüÁöÑ‰ª£ÁêÜÊñπÊ≥ïÁöÑ„ÄÇ delegate ÊòØ‰∏Ä‰∏™Âè™ËØªÂ±ûÊÄßÔºåÂÆÉÂè™ÊòØË∞ÉÁî®‰∫Ü DelegateProxy ÁöÑ proxyForObject ÊñπÊ≥ï„ÄÇDelegateProxy ÁöÑÁªßÊâøÂÖ≥Á≥ªÊØîËæÉÂ§çÊùÇÔºåÊàë‰ª¨ÂÖàÁúã‰∏Ä‰∏ãÂÖ≥Á≥ªÂõæÔºö Âº∫Ë∞É‰∏Ä‰∏ãÔºådelegate ÊòØ rx ÂëΩÂêçÁ©∫Èó¥‰∏ãÁöÑÔºå‰∏ç‰ºöÂΩ±ÂìçÂà∞Êéß‰ª∂Êú¨ÁîüÁöÑ delegate Â±ûÊÄß„ÄÇ ÊõøÊç¢‰ª£ÁêÜÁ±ªÂèØ‰ª•ÁúãÂà∞ proxyForObject ÊòØ DelegateProxyType ÂçèËÆÆ‰∏≠ÁöÑÊñπÊ≥ïÔºåÂÆÉÂú®ÂçèËÆÆÁöÑÊãìÂ±ï‰∏≠Êèê‰æõ‰∫ÜÈªòËÆ§ÁöÑÂÆûÁé∞Ôºö 123456789101112131415161718192021222324252627public static func proxyForObject(_ object: AnyObject) -&gt; Self &#123; MainScheduler.ensureExecutingOnScheduler() let maybeProxy = Self.assignedProxyFor(object) as? Self let proxy: Self if let existingProxy = maybeProxy &#123; proxy = existingProxy &#125; else &#123; proxy = Self.createProxyForObject(object) as! Self Self.assignProxy(proxy, toObject: object) assert(Self.assignedProxyFor(object) === proxy) &#125; let currentDelegate: AnyObject? = Self.currentDelegateFor(object) if currentDelegate !== proxy &#123; proxy.setForwardToDelegate(currentDelegate, retainDelegate: false) assert(proxy.forwardToDelegate() === currentDelegate) Self.setCurrentDelegate(proxy, toObject: object) assert(Self.currentDelegateFor(object) === proxy) assert(proxy.forwardToDelegate() === currentDelegate) &#125; return proxy&#125; ÂàõÂª∫ proxyÈ¶ñÂÖàÈÄöËøá assignedPorxyFor Ëøô‰∏™Á±ªÊñπÊ≥ïÊñπÊ≥ïÔºåËé∑ÂèñÊåáÂÆöÊéß‰ª∂(object)ÁöÑ DelegateProxy ÁöÑÂÆû‰æã„ÄÇËøô‰∏™ÊñπÊ≥ïÂú® DelegateProxyType ÂçèËÆÆ‰∏≠ÂÆö‰πâÔºåÂú® DelegateType ‰∏≠ÂÆûÁé∞Ôºö 1234open class func assignedProxyFor(_ object: AnyObject) -&gt; AnyObject? &#123; let maybeDelegate = objc_getAssociatedObject(object, self.delegateAssociatedObjectTag()) return castOptionalOrFatalError(maybeDelegate.map &#123; $0 as AnyObject &#125;)&#125; ÂÆÉÈÄöËøáÂÖ≥ËÅîÂØπË±°ÁöÑÊñπÂºèÔºå‰ªéÊåáÂÆöÊéß‰ª∂‰∏≠ÂèñÂá∫„ÄÇÂ¶ÇÊûúËøô‰∏™ proxy Â≠òÂú®ÔºåÂ∞±ËØ¥Êòé‰πãÂâçÂ∑≤ÁªèËÆæÁΩÆËøá‰∫ÜÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÈÇ£‰πàÈÄöËøá createProxyForObject ÊñπÊ≥ïÂàõÂª∫„ÄÇËøô‰∏™ÂàõÂª∫ÊñπÊ≥ïÂêåÊ†∑ÊòØÂú® DelegateProxyType ‰∏≠ÂÆö‰πâÔºåÂú® DelegateProxy ‰∏≠ÂÆûÁé∞„ÄÇÂÆÉÂÅöÁöÑÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÂÆû‰æãÂåñËá™Ë∫´Ôºö 123open class func createProxyForObject(_ object: AnyObject) -&gt; AnyObject &#123; return self.init(parentObject: object)&#125; ÁÑ∂ÂêéÂ∞±ÊòØÂ∞ÜËá™Ë∫´‰∏éÊéß‰ª∂ÂÖ≥ËÅî„ÄÇÊÄªÁöÑÊù•ËØ¥Ôºå‰∏äÈù¢Â∞±ÊòØË¶ÅÂàõÂª∫‰∏Ä‰∏™ DelegateProxyÔºåÁÑ∂Âêé‰øùÂ≠ò‰∏∫Áõ∏Â∫îÊéß‰ª∂ÁöÑÂ±ûÊÄßÁöÑ‰∏Ä‰∏™Â±ûÊÄß„ÄÇ Ëé∑ÂèñÂΩìÂâç‰ª£ÁêÜÂØπË±°Êé•‰∏ãÊù•ÈÄöËøá currentDelegateFor Ëé∑ÂèñÂΩìÂâçÊéß‰ª∂ÁöÑÂÆûÈôÖ‰ª£ÁêÜÁ±ª„ÄÇËøô‰∏™ÊñπÊ≥ïÊòØÈúÄË¶ÅËá™Â∑±Âú® DelegtateProxy Â≠êÁ±ª‰∏≠ÂÆûÁé∞ÁöÑÔºåÂõ†‰∏∫ËôΩÁÑ∂Áî®ÂÅö‰ª£ÁêÜÔºå‰ΩÜÊòØÂèØËÉΩÂè´Ê≥ï‰∏çÂêåÔºåÊØîÂ¶Ç tableView ÁöÑÊï∞ÊçÆÊ∫ê‰ª£ÁêÜÂ∞±Âè´ÂÅö dataSource„ÄÇTabBarController ÁöÑ DelegateProxy ‰∏≠‰ªÖÊúâÁöÑ‰∏§‰∏™ÊñπÊ≥ïÂ∞±ÊòØÂèñÂá∫ÂíåËÆæÁΩÆËá™Ë∫´ÁöÑ‰ª£ÁêÜÔºö 1234567891011121314151617public class RxTabBarControllerDelegateProxy : DelegateProxy , UITabBarControllerDelegate , DelegateProxyType &#123; /// For more information take a look at `DelegateProxyType`. public class func currentDelegateFor(_ object: AnyObject) -&gt; AnyObject? &#123; let tabBarController: UITabBarController = castOrFatalError(object) return tabBarController.delegate &#125; /// For more information take a look at `DelegateProxyType`. public class func setCurrentDelegate(_ delegate: AnyObject?, toObject object: AnyObject) &#123; let tabBarController: UITabBarController = castOrFatalError(object) tabBarController.delegate = castOptionalOrFatalError(delegate) &#125;&#125; Â∞±ÊòØËØ¥Ôºå‰∏äÈù¢‰ª£Á†Å‰∏≠ÁöÑ delegate Âú®‰∏Ä‰∫õÊÉÖÂÜµ‰∏ãÔºåÂèØËÉΩ‰∏çÂè´ delegateÔºåÊâÄ‰ª•Ê≤°Ê≥ïÂÜôÊàê‰∏Ä‰∏™ÂÖ¨ÂÖ±ÁöÑÊñπÊ≥ïÔºåÂøÖÈ°ªË¶ÅÊØè‰∏™ DelegateProxy ÈÉΩËá™Â∑±Ê†πÊçÆÊÉÖÂÜµÂÆûÁé∞„ÄÇ Áî® proxy ÊõøÊç¢‰ª£ÁêÜÂØπË±°ÊãøÂà∞ÂΩìÂâçÁöÑ‰ª£ÁêÜÂØπË±°ÂêéÔºåÈÄöËøá‰∏Ä‰∏™ if Âà§Êñ≠ÂΩìÂâç‰ª£ÁêÜÂØπË±°ÊòØÂê¶ÊòØ‰∏äÈù¢ÂæóÂà∞ÁöÑ proxy„ÄÇÂ¶ÇÊûúÊòØÔºåËØ¥Êòé‰πãÂâçÂ∑≤ÁªèËÆæÁΩÆËøá‰∫ÜÔºåÁõ¥Êé•Â∞Ü proxy ËøîÂõûÂç≥ÂèØÔºõÂ¶ÇÊûú‰∏çÊòØÔºåÈÇ£Â∞±Ë¶ÅÁî® proxy Â∞Ü‰ª£ÁêÜÂØπË±°ÊõøÊç¢Êéâ„ÄÇËøô‰∏™ËøáÁ®ãÁî± setForwardToDelegate ÊñπÊ≥ïÂÆåÊàêÔºåÂÆûÁé∞ËøòÊòØÂú® DelegateProxy ‰∏≠Ôºö 123open func setForwardToDelegate(_ delegate: AnyObject?, retainDelegate: Bool) &#123; self._setForward(toDelegate: delegate, retainDelegate: retainDelegate)&#125; ÁúãÂà∞Ëøô‰∏™Â∏¶‰∏ãÂàíÁ∫øÁöÑÊñπÊ≥ïÔºåÂ∫îËØ•ËÉΩÁåúÂà∞ÔºåËøôÂ∞±ÊòØË∞ÉÁî®ÁöÑ OC ÁöÑÊñπÊ≥ï‰∫Ü„ÄÇÂú® _RXDelegateProxy Ëøô‰∏™ OC Á±ª‰∏≠ÔºåÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ __forwardToDelegate Â±ûÊÄß„ÄÇËøô‰∏™Â±ûÊÄßÊòØÂº±ÂºïÁî®ÁöÑÔºåÂÆÉÁî®Êù•‰øùÂ≠òÊ≠£ÁúüÁöÑ‰ª£ÁêÜÂØπË±°Ôºö 123456789-(void)_setForwardToDelegate:(id __nullable)forwardToDelegate retainDelegate:(BOOL)retainDelegate &#123; __forwardToDelegate = forwardToDelegate; if (retainDelegate) &#123; self.strongForwardDelegate = forwardToDelegate; &#125; else &#123; self.strongForwardDelegate = nil; &#125;&#125; Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Êúâ‰∏Ä‰∏™ Bool Á±ªÂûãÁöÑ retainDelegate ÂÖ•ÂèÇ„ÄÇÂÆÉÊù•ÂÜ≥ÂÆöÊòØÂê¶Â∞ÜÂº±ÂºïÁî®ÂèòÊàêÂº∫ÂºïÁî®Ôºå‰∏çËøá‰∏ÄËà¨ÊÉÖÂÜµÔºåÊàë‰ª¨Âπ∂‰∏çÈúÄË¶ÅÂº∫ÂºïÁî®„ÄÇÊÄª‰πãÔºåÂ∞ÜÂéüÊú¨ÁöÑ‰ª£ÁêÜÂØπË±°ÂÆâÈ°øÂ•Ω‰∫Ü‰πãÂêéÔºåÂ∞±ÈÄöËøá setCurrentDelegate Â∞Ü proxy ËÆæÁΩÆ‰∏∫‰ª£ÁêÜÂØπË±°ÔºåÂπ∂‰∏îËøîÂõû‰∫Ü„ÄÇ Ëé∑ÂèñÊñπÊ≥ïÁöÑ ObservableÂõûÂà∞Êàë‰ª¨ÁúãËøáÁöÑÊéß‰ª∂ÁöÑ rx ÊãìÂ±ï‰∏≠ÔºåÂâçÈù¢ËØ¥Âà∞ didSelect Ëøô‰∏™ËÆ°ÁÆóÂ±ûÊÄßÔºåËøîÂõû‰∏Ä‰∏™ ObservableÔºåÊã¶Êà™‰ª£ÁêÜÊñπÊ≥ïÁöÑÂ∑•‰Ωú‰πüÊòØÁî±ÂÆÉËá™Â∑±ÂÆåÊàêÁöÑÔºö 12345678public var didSelect: ControlEvent&lt;UIViewController&gt; &#123; let source = delegate.methodInvoked(#selector(UITabBarControllerDelegate.tabBarController(_:didSelect:))) .map &#123; a in return try castOrThrow(UIViewController.self, a[1]) &#125; return ControlEvent(events: source)&#125; ËøôÈáåÁöÑ‰∏ªË¶ÅÊñπÊ≥ïÂ∞±ÊòØËøô‰∏™ methodInvokedÔºåÂÆÉÂú® DelegateProxy ‰∏≠„ÄÇÔºàÂè¶Â§ñÊèí‰∏ÄÂè•ÔºåËøôÈáåÁöÑ a ‰ª£Ë°®ÁöÑÊòØ‰ª£ÁêÜÊñπÊ≥ïÁöÑÂêÑ‰∏™ÂÖ•ÂèÇÔºåa[0] Ë°®Á§∫ËØ• tabBarControllerÔºåa[1] Ë°®Á§∫ÁöÑÂ∞±ÊòØ didSelect: ÂØπÂ∫îÁöÑÂÖ•ÂèÇ„ÄÇÔºâÊàë‰ª¨ÁªßÁª≠Áúã‰∏ãÂéªÔºö 1234567891011121314open func methodInvoked(_ selector: Selector) -&gt; Observable&lt;[Any]&gt; &#123; checkSelectorIsObservable(selector) let subject = methodInvokedForSelector[selector] if let subject = subject &#123; return subject &#125; else &#123; let subject = PublishSubject&lt;[Any]&gt;() methodInvokedForSelector[selector] = subject return subject &#125;&#125; È¶ñÂÖàÈÄöËøá checkSelectorIsObservable Ê£ÄÊü•ÊñπÊ≥ïÊòØÂê¶Â∑≤ÈÄöËøáÈùû rx ÁöÑ‰ª£ÁêÜÊñπÂºèÂÆûÁé∞‰∫Ü„ÄÇËøô‰∏™ÊñπÊ≥ï‰∏çÊòØÂ§™ÈáçË¶Å„ÄÇ‰πãÂêé‰ªé methodInvokedForSelector ‰∏≠ÂèñÂá∫ selector ÂØπÂ∫îÁöÑ subject ÂØπË±°„ÄÇËøô‰∏™Â±ûÊÄßÊòØ‰∏Ä‰∏™Â≠óÂÖ∏Ôºå‰ª• selector ‰∏∫ÈîÆÔºå‰ª• subject ‰∏∫ÂÄº„ÄÇÂ¶ÇÊûúÂ≠òÂú® subject Â∞±ËØ¥ÊòéÔºåÂ∑≤ÁªèÂàõÂª∫‰∫Ü selector ÂØπÂ∫îÁöÑ Observable ÂØπË±°‰∫ÜÔºåÁõ¥Êé•ËøîÂõûÂç≥ÂèØÔºõÂ¶ÇÊûúÊ≤°ÊúâÔºåÈÇ£‰πàÂ∞±ÂàõÂª∫‰∏Ä‰∏™ PublishSubjectÔºåÂπ∂‰∏îÂ∞ÜÂÖ∂Â≠òÂÖ• methodInvokedForSelecotr Â≠óÂÖ∏‰∏≠ÂéªÔºåÊúÄÂêéËøîÂõûËøô‰∏™ subject„ÄÇÊàë‰ª¨Â∞±ÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™ subject Êù•ËøõË°åËÆ¢ÈòÖ‰∫Ü„ÄÇ ÊâÄ‰ª•Ëé∑ÂèñÊñπÊ≥ïÁöÑ Observable ÁöÑËøáÁ®ãÂ∞±ÊòØ‰ªé‰∏Ä‰∏™Â≠óÂÖ∏‰∏≠ÂèñÂá∫ÊñπÊ≥ïÂØπÂ∫î Observable ÁöÑËøáÁ®ã„ÄÇ Êã¶Êà™ÊñπÊ≥ïÈÇ£‰πàË∞ÉÁî®‰ª£ÁêÜÊñπÊ≥ïÁöÑËøáÁ®ãÊòØÂ¶Ç‰ΩïËΩ¨Âèò‰∏∫Ëß¶Âèë‰∫ã‰ª∂ÁöÑÂë¢ÔºüËøôÈáåÂ∞±Ë¶ÅÁî®Âà∞ OC runtime ‰∏≠ÁöÑÊ∂àÊÅØËΩ¨Âèë„ÄÇÂú® _RXDelegateProxy ‰∏≠ÂÆûÁé∞‰∫ÜÊ∂àÊÅØËΩ¨ÂèëÁöÑÊñπÊ≥ï forwardInvocation„ÄÇÊàë‰ª¨Â∞Ü DelegateProxy ËÆæÁΩÆ‰∏∫‰ª£ÁêÜÁ±ªÔºå‰ΩÜÊòØÊàë‰ª¨‰∏ÄÁõ¥Ê≤°ÊúâÂÆûÁé∞‰ª£ÁêÜÊñπÊ≥ï„ÄÇÊâÄ‰ª•Á≥ªÁªü‰ºÅÂõæË∞ÉÁî®‰ª£ÁêÜÊñπÊ≥ïÁöÑÊó∂ÂÄôÂèëÁé∞Ê≤°Êúâ‰ª£ÁêÜÊñπÊ≥ïÔºåÂ∞±ÊâßË°åÊ∂àÊÅØËΩ¨ÂèëÁöÑÊñπÊ≥ïÔºö 12345678910111213141516-(void)forwardInvocation:(NSInvocation *)anInvocation &#123; BOOL isVoid = RX_is_method_signature_void(anInvocation.methodSignature); NSArray *arguments = nil; if (isVoid) &#123; arguments = RX_extract_arguments(anInvocation); [self _sentMessage:anInvocation.selector withArguments:arguments]; &#125; if (self._forwardToDelegate &amp;&amp; [self._forwardToDelegate respondsToSelector:anInvocation.selector]) &#123; [anInvocation invokeWithTarget:self._forwardToDelegate]; &#125; if (isVoid) &#123; [self _methodInvoked:anInvocation.selector withArguments:arguments]; &#125;&#125; È¶ñÂÖàÊ£ÄÊü•‰∏Ä‰∏ã‰ª£ÁêÜÊñπÊ≥ïÊòØ‰∏çÊòØÊúâËøîÂõûÂÄº„ÄÇ‰∏∫‰ªÄ‰πàË¶ÅÊ£ÄÊü•Ëøô‰∏™Âë¢ÔºüÂõ†‰∏∫Êàë‰ª¨ËÆ¢ÈòÖ Observable ÁöÑÂ§ÑÁêÜÊñπÊ≥ïÊòØ‰∏ç‰ºöÊúâËøîÂõûÂÄºÁöÑÔºå‰ΩÜÊòØ‰∏ÄËà¨ÁöÑ‰ª£ÁêÜÊñπÊ≥ï‰∏çÂêåÔºå‰ª£ÁêÜÊñπÊ≥ïÊúâ‰∏Ä‰∫õÊòØË¶ÅËøîÂõûÂ§ÑÁêÜÂÆåÁöÑÊï∞ÊçÆÁöÑ„ÄÇÂØπ‰∫éÊúâËøîÂõûÂÄºÁöÑ‰ª£ÁêÜÊñπÊ≥ïÔºåÊàë‰ª¨ÊòØÊó†Ê≥ï‰ª• Observable ÁöÑÊñπÂºèËÆ¢ÈòÖÁöÑÔºåÂè™ËÉΩËÄÅËÄÅÂÆûÂÆûÁöÑÂÜôÂõûË∞ÉÊñπÊ≥ï„ÄÇ ‰∏ãÈù¢ÊòØ‰∏â‰∏™ if Âà§Êñ≠„ÄÇ‰∏≠Èó¥ÁöÑ if Êàë‰ª¨ÁúãÂà∞‰∫ÜÁÜüÊÇâÁöÑ _forwardToDelegate Â±ûÊÄß„ÄÇÊàë‰ª¨‰πüËØ¥Ëøá‰∫ÜÔºåËøô‰∏™Â±ûÊÄßÊòØÁî®Êù•‰∏¥Êó∂‰øùÂ≠òÂéüÊú¨Ê≠£ÁúüÁöÑ‰ª£ÁêÜÂØπË±°ÁöÑ„ÄÇËøô‰∏™ if ÁöÑ‰ΩúÁî®Â∞±ÊòØÔºåÊ£ÄÊü•‰∏Ä‰∏ãÊ≠£ÁúüÁöÑ‰ª£ÁêÜÂØπË±°ÊúâÊ≤°ÊúâÂÆûÁé∞Ëøô‰∏™ selectorÔºåÂ¶ÇÊûúÊúâÔºåÈÇ£‰πàÊâßË°å„ÄÇËøôÊ†∑ÁöÑÂ•ΩÂ§ÑÂ∞±ÊòØÊó¢‰∏çÂΩ±ÂìçÂéüÊú¨‰ª£ÁêÜÊñπÊ≥ïÁöÑÊâßË°åÔºåÂèàËÉΩÁªôÊàë‰ª¨Êèê‰æõÁî® Observable Â§ÑÁêÜÁöÑ‰ΩôÂú∞„ÄÇ ‰∏ä‰∏ã‰∏§‰∏™ if Âà§Êñ≠Â∞±ÈÉΩÊòØÁî®Êù•Ëß¶Âèë‰∫ã‰ª∂ÁöÑ„ÄÇ‰∏Ä‰∏ä‰∏Ä‰∏ãÂàÜÂà´Âú®Ê≠£ÁúüÁöÑ‰ª£ÁêÜÊñπÊ≥ïÊâßË°åÂâçÂêéËß¶Âèë„ÄÇÂâçÊñá‰∏≠ÔºåÊàë‰ª¨ÊúâÈÄöËøá methodInvoked ÊñπÊ≥ïËé∑Âèñ selector ÂØπÂ∫îÁöÑ ObservableÔºåÂÖ∂ÂÆûËøòÊúâ‰∏Ä‰∏™ sendMessage ÊñπÊ≥ï‰πüËµ∑ÁùÄ‰∏ÄÊ†∑ÁöÑ‰ΩúÁî®ÔºåÂéüÁêÜ‰πüÊòØÁõ∏ÂêåÁöÑ„ÄÇÊòØ‰∏çÊòØÂæàÂÉè AOP„ÄÇ _methodInvoked ÊñπÊ≥ïÂ∞Ü‰ª£ÁêÜÊñπÊ≥ïÁöÑÂèÇÊï∞‰Ωú‰∏∫‰∫ã‰ª∂ÂÄºËß¶Âèë‰∫ã‰ª∂Ôºö 123open override func _methodInvoked(_ selector: Selector, withArguments arguments: [Any]) &#123; methodInvokedForSelector[selector]?.on(.next(arguments))&#125; Â¶Ç‰ΩïËé∑ÂæóËß¶Âèë‰∫ã‰ª∂ÁöÑÂÖ•Âè£ÔºüÁ≠îÊ°àÂ∞±ÊòØÈÄöËøáÊ∂àÊÅØËΩ¨Âèë„ÄÇÊâÄÊúâÊ≤°ÊúâÂÆûÁé∞ÁöÑ‰ª£ÁêÜÊñπÊ≥ïËµ∞Ê∂àÊÅØËΩ¨ÂèëÔºåËææÂà∞Áªü‰∏ÄËß¶Âèë‰∫ã‰ª∂ÁöÑÁõÆÁöÑ„ÄÇ Âè¶‰∏ÄÁßçÊõøÊç¢‰ª£ÁêÜÁ±ªÁöÑÊñπÂºèÂâçÈù¢ÊõøÊç¢‰ª£ÁêÜÁ±ªÁöÑÊñπÂºèÊòØ proxyForObjectÊñπÊ≥ïÔºåÂÆÉ‰ºöÊääËØ• Object ÁöÑ delegate ÊõøÊç¢‰∏∫ DelegateProxyÔºåÊääÂéüÊú¨ÁöÑ delegate ÂØπË±°ËÆæÁΩÆ‰∏∫ DelegateProxy ÁöÑ forwardDelegate Â±ûÊÄß„ÄÇ Èô§Ê≠§‰πãÂ§ñÔºåËøòÊúâ‰∏Ä‰∏™ÊõøÊç¢‰ª£ÁêÜÁöÑÊñπÊ≥ïÔºö 123456789101112131415161718192021222324252627282930public static func installForwardDelegate(_ forwardDelegate: AnyObject, retainDelegate: Bool, onProxyForObject object: AnyObject) -&gt; Disposable &#123; weak var weakForwardDelegate: AnyObject? = forwardDelegate let proxy = Self.proxyForObject(object) assert(proxy.forwardToDelegate() === nil, "This is a feature to warn you that there is already a delegate (or data source) set somewhere previously. The action you are trying to perform will clear that delegate (data source) and that means that some of your features that depend on that delegate (data source) being set will likely stop working.\n" + "If you are ok with this, try to set delegate (data source) to `nil` in front of this operation.\n" + " This is the source object value: \(object)\n" + " This this the original delegate (data source) value: \(proxy.forwardToDelegate()!)\n" + "Hint: Maybe delegate was already set in xib or storyboard and now it's being overwritten in code.\n") proxy.setForwardToDelegate(forwardDelegate, retainDelegate: retainDelegate) // refresh properties after delegate is set // some views like UITableView cache `respondsToSelector` Self.setCurrentDelegate(nil, toObject: object) Self.setCurrentDelegate(proxy, toObject: object) assert(proxy.forwardToDelegate() === forwardDelegate, "Setting of delegate failed:\ncurrent:\n\(String(describing: proxy.forwardToDelegate()))\nexpected:\n\(forwardDelegate)") return Disposables.create &#123; MainScheduler.ensureExecutingOnScheduler() let delegate: AnyObject? = weakForwardDelegate assert(delegate == nil || proxy.forwardToDelegate() === delegate, "Delegate was changed from time it was first set. Current \(String(describing: proxy.forwardToDelegate())), and it should have been \(proxy)") proxy.setForwardToDelegate(nil, retainDelegate: retainDelegate) &#125;&#125; Ëøô‰∏™ÊñπÊ≥ï‰ºöÁõ¥Êé•ËÆ©‰Ω†‰º†ÂÖ• forwardDelegateÔºåÂπ∂‰∏î‰Ω†Ë¶ÅÊòØ‰πãÂâçËÆæÁΩÆËøá delegateÔºåÂÆÉËøò‰∏çÈ´òÂÖ¥‰∫Ü„ÄÇÊâÄ‰ª•Ëøô‰∏™ÊñπÊ≥ïÊúÄÂ•ΩÂú®‰Ω†Ê≤°ÊúâËÆæÁΩÆ‰ª£ÁêÜÁöÑÊó∂ÂÄôÁî®„ÄÇËØ•ÊñπÊ≥ï‰∏≠‰πüË∞ÉÁî®‰∫Ü proxyForObject„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåËøô‰∏™ÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™ DisposerÔºåÂπ∂Âú® dispose ÁöÑÊó∂ÂÄôÔºåÂ∞Ü forwardDelegate Ê≠£ÂºèËÆæÁΩÆ‰∏∫ delegate„ÄÇÂõ†Ê≠§ÔºåÁî®ËøôÁßçÊñπÂºèÁöÑËØùÔºå‰Ω†ÈúÄË¶ÅÂ∞ÜÂÖ∂ÊîæÂÖ• disposableBag ‰∏≠„ÄÇËøôÊ†∑ÁöÑÂäüÊïàÂ∞±ÊòØÂ¶ÇÊûú DelegateProxy ÂõûÊî∂‰∫ÜÔºåÈÇ£‰πà forwardDelegate Â∞±È°∫ÂäøÂçáÂÄº‰∫Ü„ÄÇ ÂÖ∂ÂÆûËøô‰πüÂ∞±ÊòØ Disposer ÁªôÊàë‰ª¨Â∏¶Êù•ÁöÑ‰æøÂà©„ÄÇÊàë‰ª¨‰∏çÈúÄË¶ÅÂÜç dealloc ÁöÑÊó∂ÂÄôÂÅöËÆæÁΩÆ‰∫ÜÔºåÁõ¥Êé•ÂÖ®ÈÉ®ÊâîÂà∞ disposableBag ‰∏≠Âéª„ÄÇ Êï¥‰∏™ËøáÁ®ãÂ∞±ÊòØÔºåÊàë‰ª¨ÈÄöËøá proxyForObject Â∞Ü delegate ËÆæÁΩÆ‰∏∫ DelegateProxy„ÄÇDelegateProxy ‰∏∫ÊØè‰∏Ä‰∏™Êó†ËøîÂõûÂÄºÁöÑ‰ª£ÁêÜÊñπÊ≥ïÈÉΩÂàõÂª∫‰∫Ü subject„ÄÇÊàë‰ª¨ÈÄöËøá DelegateProxy Êèê‰æõÁöÑ methodInvoked Ëé∑ÂèñËøô‰∫õ subjectÔºåÂπ∂ËÆ¢ÈòÖ„ÄÇ‰∏çÂú® DelegateProxy ‰∏≠ÂÆûÁé∞Ëøô‰∫õ‰ª£ÁêÜÊñπÊ≥ïÔºå‰ΩøÂÖ∂Ëß¶ÂèëÊ∂àÊÅØËΩ¨Âèë„ÄÇÊ∂àÊÅØËΩ¨Âèë‰∏≠Áªü‰∏ÄÊâßË°åÊñπÊ≥ïÔºåËé∑Âèñ selector ÁöÑ subjectÔºåÂπ∂Ëß¶Âèë‰∫ã‰ª∂„ÄÇ Êàë‰ª¨ÈúÄË¶ÅÂÅöÁöÑÊòØÔºö Âú® rx ÊãìÂ±ï‰∏≠ÔºåÊ∑ªÂä†‰∏Ä‰∏™Âè™ËØªÁöÑ‰ª£ÁêÜÂ±ûÊÄß(‰∏ç‰∏ÄÂÆöÂè´ÂÅö delegate)„ÄÇËØªÂèñÊñπÊ≥ï‰∏≠Ë∞ÉÁî®Áõ∏Â∫î DelegateProxy ÁöÑ proxyForObject Âπ∂ËøîÂõû„ÄÇ Âú® rx ÊãìÂ±ï‰∏≠ÔºåÊ∑ªÂä†Âè™ËØªÁöÑÂ±ûÊÄß„ÄÇËØªÂèñÊñπÊ≥ï‰∏≠Ë∞ÉÁî® DelegateProxy ÁöÑ methodInvoked Ëé∑ÂèñÁõ∏Â∫î selector ÁöÑ subject Âú®Áõ∏Â∫î DelegateProxy ‰∏≠Ê∑ªÂä† currentDelegateFor Âíå setCurrentDelegate ÊñπÊ≥ïÔºåËøîÂõûÔºåËÆæÁΩÆÁ±ªÁöÑÂéüÂßã‰ª£ÁêÜÂ±ûÊÄß(‰∏ç‰∏ÄÂÆöÊòØ delegate)„ÄÇ Âú®Áõ∏Â∫î DelegateProxy ‰∏≠Ê∑ªÂä†ËøîÂõûÂÄºÈùûÁ©∫ÁöÑ‰ª£ÁêÜÊñπÊ≥ïÁöÑÂÆûÁé∞„ÄÇ ‰∏çÊÉ≥Âú®ÂÜô‰∫ÜÔºåÁ¥ØÁöÑÂÖîË°ÄÔºåÊöÇÊó∂Â∞±ËøôÊ†∑Âêß„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
        <tag>RxSwift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RxCocoa ÁöÑÂ∫îÁî®]]></title>
    <url>%2F2017%2F11%2F03%2FRxCocoa%E5%BA%94%E7%94%A8%2F</url>
    <content type="text"><![CDATA[ÁªßÁª≠ RxSwift ÁöÑÂ≠¶‰π†„ÄÇËøôÁ´†ÁöÑÈöæÂ∫¶ÊòéÊòæÂ§ß‰∫ÜËÆ∏Â§öÔºåÂæàÂ§ö‰∏úË•øÔºå‰Ω†Áü•ÈÅìË¶ÅËøô‰πàÁî®Ê≤°ÊúâÁî®Ôºå‰Ω†ÂæóÁü•ÈÅì‰∏∫‰ªÄ‰πàË¶ÅËøô‰πàÁî®ÔºåËøôÂ∞±ÈúÄË¶ÅÈòÖËØªÊ∫êÁ†Å‰∫Ü„ÄÇÊú¨ÊñáËøòÊòØÊåâÁÖß‰π¶‰∏≠ÁöÑÁ´†ËäÇËøõË°å„ÄÇÁü•ÂÖ∂ÊâÄ‰ª•ÁÑ∂‰ºöÂú®ÂêéÈù¢ÁöÑÊñáÁ´†‰∏≠Ë°•ÂÖ®„ÄÇ ‰ΩøÁî® RxCocoa ÁöÑÂ∫îÁî®ÂºÄÂßã‰ΩøÁî® RxCocoaËøô‰∏ÄÁ´†ËäÇ‰∏ªË¶ÅÊòØ‰∏Ä‰∏™‰æãÂ≠ê„ÄÇËÆ≤ÁöÑÊòØÂ¶Ç‰ΩïÈÄöËøá Rx Â∞ÜÂ§©Ê∞î‰ø°ÊÅØÂ±ïÁ§∫Âá∫Êù•„ÄÇ ÂàùÂç∞Ë±°ÊâìÂºÄ UITextField+Rx.swiftÔºåÂÖ∂‰∏≠Âè™Êúâ‰∏Ä‰∏™Á±ªÂûã‰∏∫ ControlProperty&lt;String?&gt; ÁöÑ text Â±ûÊÄßÔºö ControlProperty ÊòØ‰∏Ä‰∏™ÁâπÊÆäÁöÑ subjectÔºåÂâçÈù¢‰πüÊèêÂà∞Ëøá‰∫ÜÔºåÂíå UI Êéß‰ª∂‰∫§‰∫íÁöÑÂ±ûÊÄßÈÉΩÊòØ subject Á±ªÂûãÁöÑ„ÄÇÊõ¥ÂÖ∑‰Ωì‰∏ÄÁÇπÔºåRxcocoa ‰∏≠ÔºåÂíå UI ‰∫§‰∫íÁöÑÂ±ûÊÄßÈÉΩÊòØ ControlProperty Á±ªÂûã„ÄÇ ÂÜçÊâìÂºÄ UILabel+Rx.swiftÔºåÂÆÉÁöÑ‰∏§‰∏™Â±ûÊÄßÈÉΩÊòØ UIBindingObserver Á±ªÂûãÔºö UIBindingObserver ÊòØ‰∏Ä‰∏™ Observer„ÄÇÂÆÉÂ∞±ÊòØÂú® Subject ‰∏é Observer ‰∏ÄËäÇ‰∏≠ÊèêÂà∞ÁöÑÁâπÊÆäÁöÑ Observer„ÄÇÂÆÉÊúâ‰∏Ä‰∏™ binding Â±ûÊÄßÔºåÁî®Êù•‰øùÂ≠òÈªòËÆ§ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÔºåÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôËÆæÁΩÆ„ÄÇ ÂâçÈù¢‰πüÊèêÂà∞ËøáÔºåËøôÁßç ObserverÔºåÊ≤°ÊúâËá™ÂÆö‰πâÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÔºåÊâÄ‰ª•Âè™ËÉΩÂÅöËØ∏Â¶ÇËÆæÁΩÆ UILabel ÁöÑ text Á≠âÊó†È°ª UI ‰∫§‰∫íÁöÑ‰∫ã„ÄÇ ‰ΩøÁî® RxCocoa ÁöÑ UIKitApiController.swift Áî®Êù•Êèê‰æõÊï∞ÊçÆÔºåÂú®ÂÖ∂‰∏≠ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ï currentWeather(city:)ÔºåÁî®Êù•Êèê‰æõÈªòËÆ§ÁöÑÂ§©Ê∞îÊï∞ÊçÆÔºö 12345678func currentWeather(city: String) -&gt; Observable&lt;Weather&gt; &#123; return Observable.just( Weather( cityName: city, temperature: 20, humidity: 90) )&#125; Ëøô‰∏™ÊñπÊ≥ïÊé•Âèó‰∏Ä‰∏™ÂèÇÊï∞ÔºöÂüéÂ∏ÇcityÔºåËøîÂõû‰∏Ä‰∏™Âè™Êúâ‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑ ObservableÔºå‰∫ã‰ª∂ÂÄºÁ±ªÂûã‰∏∫Â§©Ê∞îWeatherÁ±ªÂûã„ÄÇ Êé•‰∏ãÊù•Â∞±ÂèØ‰ª•Âú® ViewController ‰∏≠ËÆ¢ÈòÖ‰∫Ü„ÄÇÂú® viewDidLoad ‰∏≠ËÆæÁΩÆ: 1234567ApiController.shared.currentWeather(city: "Shanghai") .observeOn(MainScheduler.instance) .subscribe( onNext: &#123; data in self.tempLabel.text = "\(data.temperature)¬∞C" self.cityNameLabel.text = data.cityName self.humidityLabel.text = "\(data.humidity)%" &#125;).addDisposableTo(bag) ÂÖ∂‰∏≠ shared Áî®Êù•Ëé∑ÂèñÂçï‰æãÔºåobserveOn(MainScheduler.instance) Áî®Êù•Â∞ÜÊìç‰ΩúÈôêÂà∂Âú®‰∏ªÁ∫øÁ®ã‰∏≠ÔºåÂõ†‰∏∫ËøôÊòØÂú®Êìç‰Ωú UI„ÄÇ ÈÇ£‰πàÂ¶Ç‰ΩïËé∑ÂèñÂà∞ city ÁöÑÂë¢ÔºüÊàë‰ª¨ÂèØ‰ª•Êúâ‰∏Ä‰∏™ textfield searchCityName Áî®Êù•Êé•ÂèóÁî®Êà∑ÁöÑËæìÂÖ•„ÄÇRxCocoa ÈÄöËøáÂçèËÆÆÊãìÂ±ïÁöÑÊñπÂºè‰∏∫Â§ßÂ§öÊï∞ UIKit ÁöÑÊàêÂëòÈÉΩÊ∑ªÂä†‰∫Ü rx ÁöÑÁõ∏ÂÖ≥Â±ûÊÄß„ÄÇÊØîÂ¶Ç textfieldÔºåÊàë‰ª¨ÂèØ‰ª•ËæìÂÖ• searchCityName.rx. Â∞±ÂèØ‰ª•Êü•ÁúãÂà∞ÂæàÂ§öÂèØ‰ª•‰ΩøÁî®ÁöÑ Rx Áõ∏ÂÖ≥ÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ï„ÄÇËøôÈáåÊàë‰ª¨Ë¶Å‰ΩøÁî®ÁöÑÊòØ textfield ÁöÑ text Â±ûÊÄßÔºö 12345678910let search = searchCityName.rx.text .filter &#123; ($0 ?? "").characters.count &gt; 0&#125; .flatMapLatest &#123; text in return ApiController.shared.currentWeather(city: text ?? "Error") .catchErrorJustReturn(ApiController.Weather.empty) &#125;.observeOn(MainScheduler.instance)// ËÆ¢ÈòÖsearch.subscribe( ... ).addDisposableTo(bag) ËøôÊÆµ‰ª£Á†ÅÂÅö‰∫Ü‰ªÄ‰πàÔºåËøôÊÆµ‰ª£Á†ÅÂ∞Ü textfield ÁöÑËæìÂÖ•Ê°ÜÂíåÂ§ÑÁêÜÈÄªËæëÁªëÂÆö‰∫ÜËµ∑Êù•ÔºåËæìÂÖ•Ê°Ü‰∏ÄÊúâËæìÂÖ•ÔºåÈÇ£‰πàÂ∞±Ëß¶Âèë‰∫ã‰ª∂„ÄÇÂÖàÂ∞ÜÁ©∫ËæìÂÖ•ËøáÊª§ÊéâÔºåÁÑ∂ÂêéÂ∞Ü textfield ‰∏≠ËæìÂÖ•ÁöÑÂÄºÈÄöËøá flatMapLatest ÂÜçËΩ¨Êç¢‰∏∫Êñ∞ÁöÑ ObservableÔºåÂç≥ city ËΩ¨ Weather ÁöÑËøáÁ®ã„ÄÇÂÖ∂‰∏≠Â¶ÇÊûú currentWeather ÁöÑËΩ¨Êç¢‰∫ßÁîü‰∫ÜÈîôËØØÔºåÂ∞±ÈÄöËøá catchErrorJustReturn ‰ΩøÁî®ÈªòËÆ§ÁöÑ‰∫ã‰ª∂ÂÄºÔºåÁ©∫ Weather„ÄÇ ÈÄöËøáËøô‰∏™‰æãÂ≠êÔºåÂèØ‰ª•ÂÜçÂ§ç‰π†‰∏Ä‰∏ã flatMapLatest Âíå flatMap ÁöÑÂå∫Âà´„ÄÇËøô‰∏™‰æãÂ≠ê‰∏≠ flatMapLatest Âíå flatMap ÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂõ†‰∏∫ currentWeather ËøîÂõûÁöÑ Observable Âè™Êúâ‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÊâÄ‰ª•Âè™ËÆ¢ÈòÖÊúÄÂêéÁöÑ Observable Âíå ËÆ¢ÈòÖÊØè‰∏Ä‰∏™ Observable Ê≤°ÊúâÂå∫Âà´ÔºåÂõ†‰∏∫ Observable ‰∏ç‰ºöÂÜçÊúâ‰∫ã‰ª∂ÂèëÁîü‰∫Ü„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûúËøôÈáå currentWeather ÊòØ‰∏Ä‰∏™ÂºÇÊ≠•ÁöÑÊìç‰ΩúÔºåÊØîÂ¶ÇÂéªÁΩë‰∏äÊãâÂèñÊï∞ÊçÆÔºåÈÇ£Â∞±ÂøÖÈ°ª‰ΩøÁî® flatMapLatest ‰∫Ü„ÄÇËØïÊÉ≥‰∏Ä‰∏ãÔºåÂú®‰∏ä‰∏Ä‰∏™ÁΩëÁªúËØ∑Ê±ÇËøòÊ≤°ÊúâÂÆåÊàêÁöÑÊó∂ÂÄôÔºåËæìÂÖ•ÂèòÂåñÔºåËøôÊ†∑ÂèàËß¶Âèë‰∫Ü‰∏ÄÊ¨°ÁΩëÁªúËØ∑Ê±Ç„ÄÇ‰ΩøÁî® flatMap Â∞±‰ºöÂú®ÊØè‰∏ÄÊ¨°ÁΩëÁªúËØ∑Ê±ÇÁªìÊùüÊó∂ÈÉΩÂÅöÂìçÂ∫îÔºå‰ΩÜËøô‰∏™Âπ∂‰∏çÁ¨¶ÂêàÈÄªËæëÔºåÂ∫îËØ•Âè™ÂìçÂ∫îÊúÄÂêé‰∏ÄÊ¨°ÁΩëÁªúËØ∑Ê±ÇÔºåÂê¶Âàô‰ºö‰∫ßÁîüËØ∑Ê±ÇË¶ÜÁõñ„ÄÇÊâÄ‰ª•‰∏ÄÂÆöË¶ÅÁî® flatMapLatest„ÄÇ ‰ª•‰∏äÁöÑÊï∞ÊçÆÊµÅÁ®ãÂ¶ÇÂõæÊâÄÁ§∫Ôºö ÁªëÂÆö ObservableÁªëÂÆöÊòØ‰∏ÄÁßçÂçïÂêëÁöÑÊï∞ÊçÆÊµÅ„ÄÇRxCocoa ‰∏≠ÁöÑÁªëÂÆöÈÄöËøá bindTo(_:) ÂÆûÁé∞„ÄÇË¢´ÁªëÂÆöÁöÑÂØπË±°ÁöÑÁ±ªÂûãÂøÖÈ°ªÊòØ ObserverTypeÔºå‰πüÂ∞±ÊòØ Observer ÂØπË±°„ÄÇ ‰π¶‰∏äËøô‰∏™Âú∞ÊñπÊàëËÆ§‰∏∫ÊòØÊúâÈóÆÈ¢òÁöÑÔºå‰π¶‰∏äÁöÑÂéüËØùÊòØÔºö The fundamental function of binding is bindTo(_:). To bind an observable to another entity, the receiver must conform to ObserverType. This entity has been explained in previous chapters: it‚Äôs a Subject which can process values, but can also be written to manually. ‰π¶‰∏äËØ¥ ObserverType Â∞±ÊòØ‰∏ÄÁßç SubjectÔºåËøôÊ†∑ËØ¥ÊòØÊ≤°ÊúâÈÅìÁêÜÁöÑ„ÄÇSubject ÁöÑËåÉÂõ¥Ë¶ÅÊØî ObserverType Â§ßÔºåSubject ÂèØ‰ª•Ë¢´ËÆ¢ÈòÖÔºåÊèê‰æõËá™ÂÆö‰πâ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÔºå‰ΩÜÊòØ bindTo() Âπ∂‰∏çÈúÄË¶ÅÔºåÂÆÉÂè™ÈúÄË¶ÅÊúâ‰∏Ä‰∏™ÈªòËÆ§ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÂç≥ÂèØ„ÄÇÊâÄ‰ª•ÊàëËÆ§‰∏∫‰π¶‰∏äËøô‰πàËØ¥Ëá≥Â∞ëÊòØ‰∏ç‰∏•Ë∞®ÁöÑ„ÄÇ bindTo(_:) ÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑ subscribeÔºå‰πüÊòØÂú® Observable Ëß¶Âèë‰∫ã‰ª∂ÁöÑÊó∂ÂÄôÔºåË∞ÉÁî® Observer ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ï„ÄÇ‰ΩÜÊòØÂéüÊú¨ÈúÄË¶ÅÂú® subscribe ÁöÑÊó∂ÂÄô‰º†ÂÖ•ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÁé∞Âú®Ë¶ÅÊ±ÇË¢´ÁªëÂÆöÁöÑ Observer Ëá™Â∑±Êèê‰æõ„ÄÇÊâÄ‰ª•ÂÉè UIBindingObserver ËøôÊ†∑ÊúâÈªòËÆ§‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÁöÑ Observer ÊàñËÄÖ‰∏Ä‰∏™Â∑≤ÁªèË¢´ËÆ¢ÈòÖËøáÁöÑ Subject ÈÉΩÊòØÂèØ‰ª•‰Ωú‰∏∫ÁªëÂÆöÂØπË±°ÁöÑ„ÄÇ 12345678910let search = searchCityName.rx.text .filter &#123; ($0 ?? "").characters.count &gt; 0&#125; .flatMapLatest &#123; text in return ApiController.shared.currentWeather(city: text ?? "Error") .catchErrorJustReturn(ApiController.Weather.empty) &#125;.observeOn(MainScheduler.instance)// ÁªëÂÆösearch.map &#123;"\($0.temperature)¬∞C"&#125; .bindTo(tempLabel.rx.text) .addDisposableTo(bag) ÁúãÂà∞‰∏äÈù¢ÁöÑ‰ª£Á†ÅÔºåÈÄöËøá‰∏Ä‰∏™ map Â∞ÜÊï¥‰∏™ Weather ÂØπË±°Ââ•Á¶ªÂá∫Êù•ÔºåÂè™Ë¶ÅÂÖ∂‰∏≠ÁöÑ temperature Â±ûÊÄß„ÄÇÁÑ∂ÂêéÂ∞ÜÂÖ∂ÁªëÂÆöÁªô tempLabel.rx.text Ëøô‰∏™ ObserverÔºàËøôÁßçÈÄöËøá map ÂèñÂá∫ÈÉ®ÂàÜÂ±ûÊÄßÂÜçËøõË°åÁªëÂÆöÊòØ‰∏Ä‰∏™ÂæàÂ•ΩÁöÑÊñπÂºèÔºâ„ÄÇËøôÂ∞±ÊòØÂâçÈù¢ËØ¥Âà∞ÁöÑ UIBindingObserver Á±ªÂûãÔºåÂÆÉÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÈªòËÆ§ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÔºåÂ∞ÜÂ§ñÈÉ®‰º†Êù•ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåËÆæÁΩÆ‰∏∫Ëá™Â∑±ÁöÑ text Â±ûÊÄß„ÄÇ ‰ΩøÁî® UnitsUnits ÊòØ‰∏ÄÁ±ª‰∏ìÈó®Áî®Êù•‰Ωø UI ÁªëÂÆöÊõ¥ÁÆÄÂçïÁöÑ Observables„ÄÇÂÆÉ‰∏ç‰ºö‰∫ßÁîüÂºÇÂ∏∏ÔºåÂπ∂‰∏îÈªòËÆ§Âú®‰∏ªÁ∫øÁ®ã‰∏≠„ÄÇÂÆÉÊúâ‰ª•‰∏ã‰∏§Â§ßÁ±ªÔºö ControlProperty Âíå ControlEvent Driver ControlProperty ÂâçÈù¢Â∑≤ÁªèÁúãÂà∞Ëøá‰∫ÜÔºåÊòØ‰∏ÄÁßç SubjectÔºåÁî®Êù•Â∞Ü UI ÁªÑ‰ª∂ÂíåÊï∞ÊçÆÁªëÂÆöÔºå‰æãÂ≠ê‰∏≠ÁöÑ searchCityName.rx.text Â∞±ÊòØ‰∏Ä‰∏™ ControlProperty„ÄÇControlEvent ‰ªéÂëΩÂêç‰∏ä‰πüËÉΩÊé®ÊµãÂá∫ÔºåÂÆÉÁî®Êù•ÁõëÂê¨ UIControlEvents„ÄÇDriversÂ∞±ÊòØÂàöÊâçËØ¥ÁöÑ‰∏ç‰ºö‰∫ßÁîüÂºÇÂ∏∏ÔºåÂπ∂‰∏î‰∏ÄÂÆöÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÁöÑ Observable„ÄÇÂ¶ÇÊûú‰∏ç‰ΩøÁî® UnitsÔºå‰Ω†ÂèØËÉΩ‰ºöÂøòËÆ∞Ë∞ÉÁî® .observeOn(MainScheduler.instance)ÔºåÊúÄÁªàÂú®ÂÖ∂‰ªñÁ∫øÁ®ã‰∏≠Êõ¥Êñ∞ UI ÂØºËá¥Â¥©Ê∫É„ÄÇ 123456789let search = searchCityName.rx.text .filter &#123; ($0 ?? "").characters.count &gt; 0&#125; .flatMapLatest &#123; text in return ApiController.shared.currentWeather(city: text ?? "Error") &#125;.asDriver(onErrorJustReturn: ApiController.Weather.empty)search.map &#123; "\($0/temerature)¬∞C" &#125; .drive(tempLabel.rx.text) .addDisposableTo(bag) ÂèØ‰ª•ÁúãÂà∞Ôºå‰ΩøÁî® asDriver(onErrorJustReturn:) ‰ª£Êõø‰∫Ü observeOn(MainSchedule.instance)„ÄÇÂè¶Â§ñÔºåÁî® drive ‰ª£Êõø‰∫Ü bindTo„ÄÇ Êàë‰ª¨Áé∞Âú®ÁªëÂÆö‰∫Ü‰∏Ä‰∏™ textfieldÔºåÂú®ÊØèÊ¨°ÂÖ∂ËæìÂÖ•ÁöÑÊó∂ÂÄôÈÉΩÂÅö‰∫ÜÂìçÂ∫îÔºåËøôÊ†∑ÂÖ∂ÂÆûÊòØÊ≤°ÊúâÂøÖË¶ÅÁöÑ„ÄÇ‰∏ÄËà¨ÂèØ‰ª•‰ΩøÁî® throttle Êìç‰ΩúÁ¨¶ÔºåËøô‰∏™ÊòØÁî®Êù•ÊéßÂà∂ÊØèÈöîÂ§ö‰πÖÂèëÈÄÅ‰∏ÄÊ¨°‰∫ã‰ª∂ÁöÑ„ÄÇËøòÊúâÊõ¥Â•ΩÁöÑÊñπÊ≥ïÊòØÁõëÂê¨Áî®Êà∑ÁÇπÂáªËøîÂõûÊåâÈíÆÔºåÂΩìÁÇπÂáªÁöÑÊó∂ÂÄôËé∑ÂèñÊêúÁ¥¢Ê°Ü‰∏≠ÁöÑËæìÂÖ•„ÄÇÈúÄË¶ÅÂØπ‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂÅö‰∏Ä‰∫õÂèòÂåñÔºö 123456let search = searchCityName.rx.controlEvent(.editingDidEndOnExit).asObservable() .map &#123; self.searchCityName.text &#125; .filter &#123; ($0 ?? "").characters.count &gt; 0&#125; .flatMapLatest &#123; text in return ApiController.shared.currentWeather(city: text ?? "Error") &#125;.asDriver(onErrorJustReturn: ApiController.Weather.empty) ÊâÄ‰ª•Áé∞Âú®ÁöÑÊï∞ÊçÆÊµÅÂõæÂèòÊàê‰∫ÜÔºö Ëøõ‰∏ÄÊ≠•ÊãìÂ±ï‰∏ä‰∏ÄÁ´†‰∏≠ÔºåÂÆåÊàê‰∫Ü‰∏Ä‰∏™ËæìÂÖ•ÂüéÂ∏ÇÔºåÁÑ∂ÂêéÊòæÁ§∫ÂüéÂ∏ÇÂ§©Ê∞îÁöÑÂäüËÉΩ„ÄÇËøô‰∏ÄÁ´†Â∞ÜÂØπÂÖ∂ËøõË°åÊãìÂ±ï„ÄÇ Âä†ËΩΩÁ≠âÂæÖÁä∂ÊÄÅÈ¶ñÂÖàÊòØÁªôÂä†ËΩΩÂ§©Ê∞îËøô‰∏™ËøáÁ®ã‰∏≠Âä†ËΩΩ‰∏Ä‰∏™Á≠âÂæÖÁöÑËèäËä±Âõæ„ÄÇËøô‰∏™ËèäËä±ÂõæÁöÑÂ±ïÁ§∫‰∏éÂê¶Êúâ‰∏§‰∏™Êù°‰ª∂ÔºöÁî®Êà∑ÁÇπÂáªÊêúÁ¥¢Êó∂Âä†ËΩΩÔºåËé∑ÂèñÂà∞ÊêúÁ¥¢ÁªìÊûúÂêéÈöêËóè„ÄÇÁÇπÂáªÊêúÁ¥¢ÂíåËé∑ÂèñÊêúÁ¥¢ÁªìÊûúÁöÑ Observable ÂàÜÂà´ÂÆö‰πâ‰∏∫Â¶Ç‰∏ãÔºö 123456789let searchInput = searchCityName.rx.controlEvent(.editingDidEndOnExit).asObservable() .map &#123; self.searchCityName.text &#125; .filter &#123; ($0 ?? "").characters.count &gt; 0&#125;let search = searchInput.flatMapLatest &#123; text in return ApiController.shared.currentWeather(city: text ?? "Error") .catchErrorJustReturn(ApiController.Weather.dummy)&#125;.asDriver(onErrorJustReturn: ApiController.Weather.dummy) ‰ªÄ‰πàÊó∂ÂÄôÊª°Ë∂≥Ëøô‰∏§‰∏™Êù°‰ª∂ÔºüÂΩì searchInput ‰∫ã‰ª∂ÂèëÁîüÁöÑÊó∂ÂÄôÊòæÁ§∫ÔºåÂΩì search ‰∫ã‰ª∂ÂèëÁîüÁöÑÊó∂ÂÄôÈöêËóè„ÄÇÊâÄ‰ª•Êàë‰ª¨ÁöÑÁ≠âÂæÖÁä∂ÊÄÅÈúÄË¶ÅÂàÜÂà´ËÆ¢ÈòÖËøô‰∏§‰∏™ Observable„ÄÇ‰ΩÜÊòØËøôÊ†∑ÁöÑÂÅöÊ≥ïÂπ∂‰∏ç‰ºòÈõÖÔºå‰∏ä‰∏ÄÁØáÊàë‰ª¨Â≠¶ËøáÂ¶Ç‰ΩïÂêàÂπ∂‰∏§‰∏™ Observable ÁöÑ‰∫ã‰ª∂‰∫ÜÔºåÂ∞±ÊòØÁî® merge: 12345678910111213let running = Observable.from([ searchInput.map &#123; _ in true&#125;.asObservable(), search.map &#123; _ in false&#125;.asObservable()]).merge().startWith(true).asDriver(onErrorJustReturn: false)running.skip(1) .drive(activityIndicator.rx.isAnimating) .addDisposableTo(bag)running.drive(tempLabel.rx.isHidden) .addDisposableTo(bag) ‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂèØ‰ª•ÁúãÂà∞ÔºåÊØèÂΩì searchInput Ëß¶ÂèëÁöÑÊó∂ÂÄôÔºåÂèëÂá∫‰∏Ä‰∏™‰∫ã‰ª∂ÂÄº‰∏∫ true ÁöÑ‰∫ã‰ª∂ÔºåÂΩì search Ëß¶ÂèëÁöÑÊó∂ÂÄôÔºåÂèëÂá∫‰∏Ä‰∏™‰∫ã‰ª∂ÂÄº‰∏∫ false ÁöÑ‰∫ã‰ª∂„ÄÇ‰ΩÜÊòØ‰∏∫‰ªÄ‰πàË¶ÅËÆæÁΩÆÁ¨¨‰∏Ä‰∏™‰∫ã‰ª∂‰∏∫ trueÔºåÂèàÁï•ËøáÁ¨¨‰∏Ä‰∏™‰∫ã‰ª∂Âë¢ÔºüÂõ†‰∏∫Â±ïÁ§∫ÁöÑ label ÁöÑ isHidden Â±ûÊÄßÂíåÁ≠âÂæÖÁä∂ÊÄÅÁöÑ isAnumating ÊòØÁõ∏ÂèçÁöÑÔºåÂç≥Â±ïÁ§∫ label ÁöÑÊó∂ÂÄôÈöêËóèÁ≠âÂæÖÁä∂ÊÄÅÔºåÂ±ïÁ§∫Á≠âÂæÖÁä∂ÊÄÅÁöÑÊó∂ÂÄôÈöêËóè label„ÄÇ‰ΩÜÊòØÊúÄÂºÄÂßãÁöÑÊó∂ÂÄôÊó¢Ë¶Å label ÈöêËóèÔºåÂèàË¶ÅÁ≠âÂæÖÁä∂ÊÄÅÈöêËóèÔºåÊâÄ‰ª•Ë¶ÅÁï•ËøáÁ¨¨‰∏Ä‰∏™‰∫ã‰ª∂ÂÄº„ÄÇ Ëé∑ÂèñÂΩìÂâç‰ΩçÁΩÆËøô‰∏ÄÁ´†‰∏ªË¶ÅËÆ≤ÁöÑÊòØÂ¶Ç‰ΩïÁî® RxSwift ÂÆûÁé∞‰∏Ä‰∏™‰ª£ÁêÜÊñπÊ≥ïÔºåË¶ÅÁêÜËß£Ëµ∑Êù•Êå∫ÊúâÈöæÂ∫¶ÁöÑÔºåËøôÈáåÂÖàÂè™ÊòØËÆ≤Ê≠•È™§ÔºåÂêéÈù¢‰ºöËΩ¨Èó®ÂÜô‰∏ÄÁØá‰ª£ÁêÜËΩ¨ÂèëÁöÑÊ∫êÁ†ÅËß£Êûê„ÄÇ Ëé∑Âèñ‰ΩçÁΩÆ‰ΩøÁî®ÁöÑÊòØ CCLocationManager Á±ªÔºåËøô‰∏™Á±ªÊúâ‰∏Ä‰∏™‰ª£ÁêÜ CLLocationManagerDelegate„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂÅöÁöÑÂ∞±ÊòØÂú® CCLocationManager ÂõûË∞É‰ª£ÁêÜÊñπÊ≥ïÁöÑÊó∂ÂÄôËß¶Âèë‰∫ã‰ª∂ÔºåÂ∞ÜÂõûË∞ÉÁöÑÂèÇÊï∞‰Ωú‰∏∫‰∫ã‰ª∂ÂÄº„ÄÇ ÊÄé‰πàÂÅöÂà∞ÁöÑÂë¢ÔºüËøôÈáå‰∏çÂÅöËØ¶ÁªÜÂ±ïÂºÄÔºåÂè™‰ªãÁªç‰∏Ä‰∏ãÂ§ßÊ¶ÇÊÄùË∑Ø„ÄÇÁÆÄÂçïÊù•ËØ¥ÔºåÂ∞±ÊòØÈ¶ñÂÖàÂ∞ÜÊàë‰ª¨ÂàõÂª∫ÁöÑÂü∫‰∫é Rx ÁöÑ‰ª£ÁêÜËÆæÁΩÆ‰∏∫ CCLocationManager ÁöÑ delegate„ÄÇÂÖ∂Ê¨°ÔºåÁî±‰∫éÊàë‰ª¨‰∏çÊòØÊ≤°ÊúâÂÜôÁúüÂÆûÁöÑÂìçÂ∫îÊñπÊ≥ïÂòõÔºåÂΩì CCLocationManager Ë¶ÅË∞ÉÁî®‰ª£ÁêÜÊñπÊ≥ïÁöÑÊó∂ÂÄô‰∏ÄËà¨ÊòØ‰ºö‰∫ßÁîüÂºÇÂ∏∏ÁöÑ„ÄÇ‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊ∂àÊÅØËΩ¨ÂèëÔºåÂ∞ÜÊâÄÊúâË∞ÉÁî®‰ª£ÁêÜÊñπÊ≥ïÁöÑË°å‰∏∫ËΩ¨Âåñ‰∏∫ÂèëÂá∫ÁâπÂÆö‰∫ã‰ª∂„ÄÇÊàë‰ª¨Âè™ÈúÄË¶ÅÈÄöËøáÊñπÊ≥ïÂêçËé∑ÂèñÂà∞Áõ∏Â∫îÁöÑ Observable Âπ∂‰∏îËÆ¢ÈòÖÔºåÂç≥ÂèØËææÂà∞ÂìçÂ∫îÂºèÁöÑÊïàÊûú„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨ÂàõÂª∫‰∏Ä‰∏™Âü∫‰∫é rx ÁöÑ‰ª£ÁêÜÁ±ª RxCLLocationManagerDelegateProxy„ÄÇËøô‰∏™ Delegate Ë¶ÅÁªßÊâø‰∫é DelegateProxyÔºåÂπ∂‰∏îÂÆûÁé∞ CLLocationManagerDelegate Âíå DelegateProxyType ÂçèËÆÆ„ÄÇÂÆûÁé∞ CLLocationManagerDelegate ÂçèËÆÆÂæàÂ•ΩÁêÜËß£ÔºåÂõ†‰∏∫Êàë‰ª¨Ë¶ÅÊääËá™Â∑±ËÆæ‰∏∫ CLLocationManager ÁöÑ‰ª£ÁêÜ„ÄÇÂè¶Â§ñ‰∏§‰∏™Â∞±ÊòØÂÆûÁé∞ÂìçÂ∫îÂºèÁöÑÂÖ≥ÈîÆ‰∫ÜÔºö 12class RxCLLocationManagerDelegateProxy: DelegateProxy, CLLocationManager, DelegateProxyType &#123;&#125; Êàë‰ª¨Ë¶ÅÊèê‰æõ‰∏§‰∏™ÊñπÊ≥ïÁî®Êù•ËÆæÁΩÆÂíåËé∑ÂèñÂΩìÂâç Delegate„ÄÇËøôÊòØ DelegateProxyType‰∏≠Ë¶ÅÊ±ÇÁöÑÔºåÊúâ‰∫ÜÂÆÉÔºåËÆ¢ÈòÖÂõûË∞ÉÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÂ∞±ÂèØ‰ª•Áî± Rx Ëá™Âä®ÊääÂΩìÂâçÁ±ªËÆæÁΩÆ‰∏∫ Delegate ‰∫ÜÔºåËÄå‰∏çÈúÄË¶ÅÊàë‰ª¨ÊòæÁ§∫ÁöÑËÆæÁΩÆÔºö 1234567891011class RxCLLocationManagerDelegateProxy: DelegateProxy, CLLocationManager, DelegateProxyType &#123; class func setCurrentDelegate(_ delegate: AnyObject?, toObject object: AnyObject) &#123; let locationManager: CLLocationManager = object as! CLLocationManager locationManager.delegate = delegate as? CLLocationManagerDelegate &#125; class func currentDelegateFor(_ object: AnyObject) -&gt; AnyObject? &#123; let locationManager: CLLocationManager = object as! CLLocationManager return locationManager.delegate &#125;&#125; Áé∞Âú®Êàë‰ª¨Ë¶Å CLLocationManager Ê∑ªÂä†‰∏Ä‰∏™ rx ÁöÑ delegate Â±ûÊÄß„ÄÇÂÖ≥‰∫é rx ÁöÑÂ±ûÊÄßÈÉΩÊòØÊ∑ªÂä†Âú® Reactive Á±ªÁöÑÊãìÂ±ï‰∏≠ÔºåÂÖ∑‰Ωì‰∏∫‰ªÄ‰πà‰ºöÂú®‰ª•ÂêéÁöÑÊñáÁ´†‰∏≠Ëß£Èáä„ÄÇËøôÊòØ‰∏Ä‰∏™ËÆ°ÁÆóÂ±ûÊÄßÔºåÊØèÊ¨°ÈÉΩ‰ºöË∞ÉÁî® proxyForObject ÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïÊòØÂú® DelegateProxy ‰∏≠ÂÆûÁé∞ÁöÑÔºå‰ΩúÁî®Â∞±ÊòØÂàõÂª∫ RxCLLocationManagerDelegateProxy ÂÆû‰æãÔºåÂπ∂‰∏îÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ CLLocationManager ÁöÑ‰ª£ÁêÜ 12345extension Reactive where Base: CLLocationManager &#123; var delegate: DelegateProxy &#123; return RxCLLocationManagerDelegateProxy.proxyForObject(base) &#125;&#125; Áé∞Âú®ËÆæÁΩÆÂà∞‰ª£ÁêÜÂ∞±ÂèØ‰ª•Ê∑ªÂä†ÁõëÂê¨‰ª£ÁêÜÊñπÊ≥ïË∞ÉÁî®ÁöÑ Observable ‰∫ÜÔºö 123456789101112extension Reactive where Base: CLLocationManager &#123; var delegate: DelegateProxy &#123; return RxCLLocationManagerDelegateProxy.proxyForObject(base) &#125; var didUpdateLocations: Observable&lt;[CLLocation]&gt; &#123; return delegate.methodInvoked(#selector(CLLocationManagerDelegate.locationManager(_:didUpdateLocations:))) .map &#123; paramters in return parameters[1] as! [CLLocation] &#125; &#125;&#125; methodInvoked ÊñπÊ≥ïÂêåÊ†∑ÊòØ DelegateProxy ‰∏≠ÂÆûÁé∞ÁöÑÊñπÊ≥ï„ÄÇÂÆÉËé∑ÂèñÁõ∏Â∫î selector ÊâÄÂØπÂ∫îÁöÑ Observable„ÄÇËøô‰∏™ selector Âíå Observable ÁöÑÂÖ≥Á≥ªÊòØ‰ª•Â≠óÂÖ∏ÁöÑÊñπÂºè‰øùÂ≠òÂú® DelegateProxy ‰∏≠ÁöÑ„ÄÇÂΩìË∞ÉÁî®‰ª£ÁêÜÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÂèò‰∏∫Ëß¶ÂèëÁõ∏Â∫î selector ÁöÑ Observable„ÄÇObservable ÁöÑ‰∫ã‰ª∂ÂÄºÂ∞±ÊòØ‰ª£ÁêÜÊñπÊ≥ïÁöÑÂèÇÊï∞Ôºå‰∏äÈù¢ÁöÑ parameters[1] Â∞±Ë°®Á§∫ didUpdateLocations: ÁöÑÂèÇÊï∞„ÄÇ Âà∞Ê≠§Ôºårx ÂÆûÁé∞ÁöÑ‰ª£ÁêÜÊñπÊ≥ïÂ∞±ÂÆåÊàê‰∫Ü„ÄÇ ÊúÄÂêéÂ¶Ç‰ΩïÁõëÂê¨ÊåâÈíÆÂºÄÂßãÂÆö‰ΩçÊàëÂ∞±‰∏çÂÜçËµòËø∞‰∫Ü„ÄÇ ‰∏≠Á∫ß RxSwift/RxCocoaÈîôËØØÂ§ÑÁêÜÈîôËØØÂ§ÑÁêÜÈÉ®ÂàÜÊØîËæÉÁÆÄÂçïÔºå‰∏ÄËà¨Êúâ‰∏§ÁßçÊñπÂºèÔºöÊçïËé∑ÊàñËÄÖÈáçËØï„ÄÇ ÊçïËé∑ÊçïËé∑Êúâ‰∏§ÁßçÔºå‰∏ÄÁßçÊòØÁõ¥Êé•‰º†ÈÄí‰∏Ä‰∏™ÈªòËÆ§ÂÄºÔºå‰πüÂ∞±ÊòØÂâçÈù¢Â∏∏ËßÅÁöÑ: 1func catchErrorJustReturn(_ element:) -&gt; RxSwift.Observable&lt;Self.E&gt; ÂÆÉ‰ºöËá™Âä®Â∞ÜËøô‰∏™ÈªòËÆ§ÂÄº‰Ωú‰∏∫‰∫ã‰ª∂ÂÄºÂèëÂá∫‰∏Ä‰∏™Êñ∞ÁöÑ‰∫ã‰ª∂„ÄÇÂè¶Â§ñËøòÊúâ‰∏ÄÁßçÔºåÊé•Âèó‰∏Ä‰∏™Èó≠ÂåÖÔºåÁÑ∂ÂêéËøîÂõû‰∏Ä‰∏™Êñ∞ÁöÑ ObservableÔºö 1func catchError(_ handler:) -&gt; RxSwift.Observable&lt;Self.E&gt; Á§∫‰æãÔºö 1234567.catchError &#123; error in if let text = text, let cachedData = self.cache[text] &#123; return Observable.just(cachedData) &#125; else &#123; return Observable.just(ApiController.Weather.empty) &#125;&#125; ÈáçËØïÈáçËØïÂ∞±ÊòØÂú® Observable Ëß¶Âèë error ÁöÑÊó∂ÂÄôÔºåÈáçÊñ∞Â∞ùËØïÂèëÂá∫‰∫ã‰ª∂„ÄÇ‰ΩøÁî®ÊñπÂºèÂæàÁÆÄÂçïÔºåÂú®ÊçïËé∑ÈîôËØØÂâçÂç≥ÂèØÔºåÂèÇÊï∞‰∏∫ÂÅöÂ§ßÂ∞ùËØïÊ¨°Êï∞Ôºö 12345678910111213return ApiController.shared.currentWeather(city: text ?? "Error") .do(onNext: &#123; data in if let text = text &#123; self.cache[text] = data &#125; &#125;).retry(3) .catchError &#123; error in if let text = text, let cachedData = self.cache[text] &#123; return Observable.just(cachedData) &#125; else &#123; return Observable.just(ApiController.Weather.empty) &#125; &#125; ËøòÊúâ‰∏ÄÁßç retryWhen() ÊñπÊ≥ïÔºö 12345678.retryWhen &#123; e in return e.flatMapWithIndex &#123; (error, attempt) -&gt; Observable&lt;Int&gt; in if attempt &gt;= maxAttempts - 1 &#123; return Observable.error(error) &#125; return Observable&lt;Int&gt;.timer(Double(attempt + 1), scheduler: MainScheduler.instance).take(1) &#125; &#125; Ëøô‰∏™ÊñπÊ≥ï‰∏≠ÔºåÂú®Êú™ËææÂà∞ÊúÄÂ§öÂ∞ùËØïÊ¨°Êï∞ÂâçÈÉΩ‰∏çÊä•Èîô„ÄÇÊØèÈöî‰∏ÄÁßíÈíüÈáçËØï‰∏ÄÊ¨°„ÄÇ ÂçïÂÖÉÊµãËØïRxSwift ÁöÑÂÆòÊñπÊèê‰æõ‰∫Ü RxTest Âíå RxBlocking ‰∏§‰∏™Â∫ìÂ∏ÆÂä©Êàë‰ª¨ËøõË°åÂçïÂÖÉÊµãËØï„ÄÇ‰∏ãÈù¢Êù•Â≠¶‰π†‰∏Ä‰∏ã„ÄÇ RxTestRxSwift ÁöÑÂçïÂÖÉÊµãËØïÁöÑ‰∏ªË¶ÅËøáÁ®ãÂ∞±ÊòØÔºöËá™Âª∫‰∏Ä‰∏™ ObservableÔºåÁÑ∂ÂêéÁªôÂÆöÂá†‰∏™ÈªòËÆ§ÁöÑÂÄºÔºå‰ª•Ê£ÄÊµãËÆ¢ÈòÖÊñπÊ≥ïÁöÑÊ≠£Á°ÆÊÄß„ÄÇ Observable ‰∏ªË¶ÅÂàÜ‰∏∫ Cold Observable Âíå Hot Observable„ÄÇRx ËÆ§‰∏∫ÔºåËøô‰∏§ËÄÖÈÉΩÊòØ ObservableÔºåÊâÄ‰ª•Âπ∂‰∏çÊÄé‰πàÂÅöÂå∫ÂàÜ„ÄÇ‰ΩÜÊòØÂçïÂÖÉÊµãËØïÁöÑÊó∂ÂÄôËøòÊòØÈúÄË¶Å‰∫ÜËß£‰∏Ä‰∏ãÁöÑ„ÄÇÁÆÄÂçïÁöÑËØ¥ÔºåÈÄöËøá create Á≠âÂàõÂª∫ÁöÑÊôÆÈÄöÁöÑ Observable Â∞±ÊòØ Cold ObservableÔºåÁâπÁÇπÂ∞±ÊòØÂΩìËÆ¢ÈòÖÂèëÁîüÁöÑÊó∂ÂÄôÁ´ãÂàªÂèëÂá∫‰∫ã‰ª∂ÔºõÂêÑÁßç Subject Â∞±ÊòØ Hot ObservableÔºåÁâπÁÇπÂ∞±ÊòØÊó†ËÆ∫ÊòØÂê¶ËÆ¢ÈòÖÈÉΩ‰ºöÂèëÂá∫‰∫ã‰ª∂ÔºåËÆ¢ÈòÖ‰πãÂêéÊâçËÉΩÊî∂Âà∞‰∫ã‰ª∂„ÄÇ Êàë‰ª¨Êù•Áúã‰∏Ä‰∏™‰æãÂ≠êÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546override func setUp() &#123; super.setUp() scheduler = TestScheduler(initialClock: 0)&#125;func testFilter() &#123; // 1 let observer = scheduler.createObserver(Int.self) // 2 let observable = scheduler.createHotObservable([ next(100, 1), next(200, 2), next(300, 3), next(400, 2), next(500, 1) ]) // 3 let filterObservable = observable.filter &#123; $0 &lt; 3 &#125; // 4 schedyler.scheduleAt(0) &#123; self.subscription = filterObservable.subscribe(observer) &#125; // 5 scheduler.start() // 6 let results = observer.events.map &#123; $0.value.element@ &#125; // 7 XCTAssertEqual(results, [1, 2, 2, 3])&#125;override func tearDown() &#123; scheduler.scheduleAt(1000) &#123; self.subsciprtion.dispose() &#125; super.tearDown()&#125; ‰∏ãÈù¢Êù•Ëß£Èáä‰∏Ä‰∏ãËøô‰∏™‰æãÂ≠ê„ÄÇÈ¶ñÂÖàÂú® setUp ÊñπÊ≥ï‰∏≠ÔºåÂàõÂª∫‰∫Ü TestScheduler ÂÆû‰æã„ÄÇÊâÄÊúâÁöÑËÆ¢ÈòÖ‰∫ã‰ª∂ÈÉΩ‰ºöÂú®Ëøô‰∏™ Scheduler ‰∏≠ËøõË°å„ÄÇÁÑ∂ÂêéÂ∞±ÊòØÊµãËØïÊñπÊ≥ï„ÄÇÊµãËØïÊñπÊ≥ïÂàÜ‰∏∫‰∏É‰∏™Ê≠•È™§Ôºö Áî® Scheduler ÂàõÂª∫ ObserverÔºåÂπ∂‰∏îËÆæÁΩÆ Observable ‰∫ã‰ª∂ÂÄºÁ±ªÂûã Áî® Scheduler ÂàõÂª∫ Hot ObservableÔºåÂπ∂‰∏îËÆæÁΩÆ‰∫ÜÂª∂ËøüÂ§ö‰πÖÂèëÂá∫‰∫ã‰ª∂Ôºå‰ª•ÂèäÂèëÂá∫ÁöÑ‰∫ã‰ª∂ÂÄº Ëøô‰∏ÄÊ≠•ÁöÑËøáÊª§Â∞±ÊòØË¢´ÊµãËØïÁöÑÊñπÊ≥ï Áî® Scheduler Âú®Êüê‰∏™Êó∂ÂàªÂºÄÂßãËÆ¢ÈòÖ‰∏äÈù¢ÂàõÂª∫ÁöÑ Observable ÂºÄÂêØ SchedulerÔºå‰∏çÂºÄÂêØÊòØ‰∏ç‰ºöÊúâ‰∫ã‰ª∂ÂèëÁîüÁöÑÂì¶ Áî®‰∏Ä‰∏™ÂØπË±°Êî∂ÈõÜ Observer Ëé∑ÂæóÁöÑ‰∫ã‰ª∂ÂÄº Êñ≠Ë®ÄÂà§Êñ≠ Observer Ëé∑ÂæóÁöÑ‰∫ã‰ª∂ÂÄºÊòØÂê¶ÂíåÈ¢ÑÊúüÁöÑ‰∏ÄÊ†∑ RxBlocking‰∏äÈù¢ÁöÑ RxTest ÊòØ‰∏Ä‰∏™ÂêåÊ≠•ÊµãËØï„ÄÇÂ¶ÇÊûúÊúâÁΩëÁªúËØ∑Ê±Ç‰πãÁ±ªÁöÑÂºÇÊ≠•‰∫ã‰ª∂ËØ•Â¶Ç‰ΩïÂë¢ÔºüÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® XCTest ‰∏≠Êèê‰æõÁöÑ expectationÔºå‰∏çËøáËøôÊ†∑Â∞±ÊòæÂæóÂæàÂï∞Âó¶‰∫Ü„ÄÇRxBlocking ÂèØ‰ª•ÁÆÄÂåñËøô‰∏ÄËøáÁ®ã„ÄÇ‰∏ãÈù¢ÊòØ‰∏Ä‰∏™‰ΩøÁî®ÂÆû‰æãÔºö 123456789func testRgbIs010() &#123; let rgbObservable = viewModel.rgb.asObservable().subscribeOn(scheduler) viewModel.hexString.value = "#00ff00" let result = try! rgbObservable.toBlocking(timeout: 1.0).first()! XCTAssertEqual(0 * 255, result.0) XCTAssertEqual(1 * 255, result.1) XCTAssertEqual(0 * 255, result.2)&#125; Áúã‰∏Ä‰∏ãËøô‰∏™‰æãÂ≠êÔºåËøôÈáå rgb ÊòØ‰∏Ä‰∏™ Driver Á±ªÂûãÔºåÊàëÊ≤°ÊúâÊääÂÆÉÁöÑÂÆö‰πâÂÜôÂá∫Êù•„ÄÇrgbObservable ÊòØ‰∏Ä‰∏™ÂºÇÊ≠•‰∫ã‰ª∂ÁöÑ Observable„ÄÇÂ¶ÇÊûú‰∏çÈÄÇÁî® toBlocking()ÔºåÈÇ£‰πàÁ®ãÂ∫èÈ°∫Â∫èÊâßË°åÔºåËÆ¢ÈòÖÂÆå‰∫Ü‰πüÂ∞±ÁªìÊùü‰∫Ü„ÄÇ‰ΩÜÊòØËøôÈáåÈÄöËøáÂØπ Observable ‰ΩøÁî® toBlocking ÊñπÊ≥ïÔºåÂ∞±Â∞Ü Observable ÈòªÂ°û‰Ωè‰∫Ü„ÄÇÂÆÉ‰ºöÁ≠âÂæÖ‰∫ã‰ª∂ÁöÑÂà∞Êù•ÔºåÁõ¥Âà∞ÂÆöÊó∂ÁªìÊùü„ÄÇ Scheduler ÁöÑ‰ªãÁªçÂØπ Scheduler ÁöÑÈÄöÂ∏∏ËØØËß£ÊòØËÆ§‰∏∫ Scheduler Â∞±ÊòØ thread„ÄÇÂÖ∂ÂÆû Scheduler Â∫îËØ•Á±ªÊØî dispatch queue„ÄÇ‰∏Ä‰∏™ Schelduler ÂèØËÉΩÂú®Â§ö‰∏™Á∫øÁ®ã‰∏≠ÔºåÂ§ö‰∏™ Scheduler ‰πüÂèØËÉΩÂú®‰∏Ä‰∏™Á∫øÁ®ã‰∏≠Ôºö Âü∫Êú¨‰ΩøÁî®Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá subscribeOn() ‰ª•Âèä observerOn() Êù•Â∞ÜËÆ¢ÈòÖÂíåÊâßË°åËÆæÁΩÆ‰∏çÂêå schedulerÔºö 12345678let globalScheduler = ConcurrentDispatchQueueScheduler(queue: DispatchQueue.global())observable.subscribeOn(globalScheduler) .subsribeOn(gloibalScheduler) .dump() .observeOn(MainScheduler.instance) .dumpingSubscription() .addDisposableTo(bag) ÂÜ∑ÁÉ≠Observable ÂØπ Schedulers ÁöÑÂΩ±ÂìçËøôÈáå‰∏ªË¶Å‰ªãÁªç‰∫Ü‰∏Ä‰∏™Ê≥®ÊÑèÁÇπÔºåÂ∞±ÊòØÂØπ‰∫é hot ObservableÔºåÂÆÉËÆ¢ÈòÖÊâÄÂú®ÁöÑÁ∫øÁ®ãÂ∞±ÊòØÂÖ∂ÂèëÂá∫‰∫ã‰ª∂ÊâÄÂú®ÁöÑÁ∫øÁ®ãÔºåÊâÄ‰ª•‰ΩøÁî® subscribeOn() ÊñπÊ≥ïÊéßÂà∂ÊòØÊó†ÊïàÁöÑ„ÄÇ Ëá™ÂÆö‰πâ Rx ÊãìÂ±ïËøôÈáåÊòØ‰∏Ä‰∏™ÊãìÂ±ï URLSessionÔºå‰ΩøÂÖ∂ÈÄöËøá rx Ëé∑ÂèñÊï∞ÊçÆ‰ª•ÂèäÂ§ÑÁêÜÊï∞ÊçÆÁöÑ‰æãÂ≠êÔºö 12345678910111213141516171819202122232425262728293031323334353637extensiong Reactive where Base: URLSession &#123; func response(request: URLRequest) -&gt; Observable&lt;(HTTPURLResponse, Data)&gt; &#123; return Observable.create &#123; observer in let tast = self.base.dataTask(with: request) &#123; (data, response, error) in guard let response = response, let data = data else &#123; observer.on(.error(error ?? RxURLSessionError.unKnown)) return &#125; guard let httpResponse = response as? HTTPURLResponse else &#123; observer.on(.error(RxURLSessionError.invalidResponse(response: response))) return &#125; observer.on(.next(httpResponse, data)) observer.on(.completed) &#125; task.resume() return Disponsables.create(with: task.cancel) &#125; &#125; func data(request: URLRequest) -&gt; Observable&lt;Data&gt; &#123; return response(requset: request).map &#123; (response, data) -&gt; Data in if 200 ..&lt; 300 ~= response.statusCode &#123; return data &#125; else &#123; throw RxURLSessionError.requestFailed(response: response, data: data) &#125; &#125; &#125; func image(request: URLResquest) -&gt; Observable&lt;UIImage&gt; &#123; return data(request: request).map &#123; d in return UIImage(data: d) ?? UIImage() &#125; &#125;&#125; ‰ª•‰∏äÂ∞±ÊòØ‰∏Ä‰∏™Ëé∑ÂèñÁΩëÁªúÂõæÁâáÁöÑÁöÑ‰∏Ä‰∏™Âü∫Êú¨ËøáÁ®ãÔºåÂÖàÊòØ‰∏Ä‰∏™ response ÊñπÊ≥ïÔºåÂõ†‰∏∫ÊòØ rx ÂòõÔºåÂøÖÈ°ªËøîÂõû‰∏Ä‰∏™ Observable ‰ª•‰æõËÆ¢ÈòÖ„ÄÇÂú®ÊñπÊ≥ï‰∏≠ÈÄöËøá .create() ÂàõÂª∫‰∏Ä‰∏™ ObservableÔºåÁÑ∂ÂêéÂú®ÂÖ∂‰∏≠ÂºÄÂßãÁΩëÁªúËØ∑Ê±ÇÔºå‰πüÂ∞±ÊòØ dataTask ÊñπÊ≥ï„ÄÇÂú®ÁΩëÁªúËØ∑Ê±ÇÁöÑÂõûË∞É‰∏≠ÔºåÂ∞ÜËé∑ÂèñÁöÑÊï∞ÊçÆ‰Ωú‰∏∫‰∫ã‰ª∂ÂÄºÔºåÂèëÂá∫‰∏Ä‰∏™‰∫ã‰ª∂Ôºå‰πãÂêéÁªìÊùüÊï¥‰∏™ Observable„ÄÇÂè¶Â§ñÁöÑ‰∏§‰∏™ÊñπÊ≥ïÊòØÂú®ÁΩëÁªúËØ∑Ê±ÇÁöÑÂü∫Á°Ä‰∏äÔºåÈÄöËøá map Â∞Ü‰∫ã‰ª∂ÂÄºËøõË°åËøõ‰∏ÄÊ≠•Â§ÑÁêÜ„ÄÇËøô‰∏™ÁΩëÁªúËØ∑Ê±ÇÊµÅÁ®ãÂ¶ÇÂõæÔºö Êõ¥Ëøõ‰∏ÄÊ≠•ÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•‰∏∫Ëøô‰∏™ÁΩëÁªúËØ∑Ê±ÇËÆæÁΩÆ‰∏Ä‰∏™ÁºìÂ≠òÔºåÂç≥Â∞ÜËé∑ÂèñÁöÑÊï∞ÊçÆÂÅö‰∏Ä‰∏™Êé•Âè£Â±ÇÈù¢ÁöÑÁºìÂ≠ò„ÄÇÊàë‰ª¨ÂèØ‰ª•ËøôÊ†∑ÂÅöÔºö 12345678910111213// ÂÖ®Â±ÄÁöÑÊàñËÄÖÊüê‰∏™Âçï‰æã,Áî®Êù•‰øùÂ≠òÁºìÂ≠òfileprivate var internalCache = [String: Data]()// ÁºìÂ≠òÊñπÊ≥ïextension ObservableType where E == (HTTPURLResponse, Data) &#123; func cache() -&gt; Observable&lt;E&gt; &#123; return self.do(onNext: &#123;(response, data) in if let url = response.url?.absoluteString, 200 ..&lt; 300 ~= response.statusCode &#123; internalCache[url] = data &#125; &#125;) &#125;&#125; ÂÖàÂàõÂª∫‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑ‰øùÂ≠òÁºìÂ≠òÁöÑÂú∞ÊñπÔºåÈîÆÊòØ urlÔºåÂÄºÊòØÊï∞ÊçÆ„ÄÇÁÑ∂ÂêéÂú® ObservableType ‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ÈíàÂØπÁΩëÁªúËØ∑Ê±ÇÁöÑÁºìÂ≠òÊñπÊ≥ïÔºåÊâÄÊúâ Observable ÈÉΩÊòØ ObservableType Á±ªÂûãÁöÑ„ÄÇËøô‰∏™ cache ÊñπÊ≥ïÂÅö‰∫Ü‰∏Ä‰ª∂‰∫ãÂ∞±ÊòØÈÄöËøá .doÁªô Observable Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™ onNext ÊñπÊ≥ïÔºåÊØèÊ¨°Ëß¶Âèë‰∫ã‰ª∂ÁöÑÊó∂ÂÄôÈÉΩ‰ºöË∞ÉÁî®„ÄÇ‰ΩøÁî®‰∏äÂíå map Á±ª‰ºº„ÄÇÁé∞Âú®Â∞Ü‰πãÂâçÁöÑ dataÔºå‰ª•Âèä image ÊñπÊ≥ï‰øÆÊîπ‰∏Ä‰∏ãÂç≥ÂèØÔºö 123return response(request: request).cache().map &#123; (response, data) -&gt; Data in //...&#125; Áî±‰∫éÊúâ‰∫ÜÁºìÂ≠òÔºåÊâÄ‰ª•ÈúÄË¶ÅÂú®ËØ∑Ê±ÇÊï∞ÊçÆÂâçÂä†‰∏ÄÊ≠•È™åËØÅ„ÄÇÂ¶ÇÊûúÊúâÁºìÂ≠òÔºåÁõ¥Êé•ËøîÂõû‰∏Ä‰∏™ ObservableÔºö 123if let url = request.url?.absoluteString, let data = internalCache[url] &#123; return Observable.just(data)&#125;]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
        <tag>RxSwift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RxSwift ÁöÑÊ¶ÇÂøµ]]></title>
    <url>%2F2017%2F10%2F26%2FRxSwift%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5%2F</url>
    <content type="text"><![CDATA[Â≠¶‰π† RxSwiftÔºåÂºÄÂßãÂÜ≤‰∫Ü‰∏™Ê≥äÂ≠¶‰ºöÂëòÁúãËßÜÈ¢ëÔºåÂèëÁé∞ÁúãËßÜÈ¢ëËøò‰∏çÂ¶ÇÁõ¥Êé•ÁúãÊ≥äÂ≠¶ÊñáÊ°£„ÄÇ‰πãÂêéÁúãÂà∞‰∫ÜËøôÊú¨‰π¶ÔºåÊûúÁÑ∂ÁúãÊñáÊ°£Ëøò‰∏çÂ¶ÇÁúã‰π¶„ÄÇÔºàÊ≥äÂ≠¶ËßÜÈ¢ë‰∏≠ÁöÑRxSwift Â∞±ÊòØÁÖßÊê¨‰∫ÜËøôÊú¨‰π¶ÁöÑÂâç‰∏§‰∏™ SectionÔºå‰æãÂ≠ê‰πüÊòØÁÖßÊê¨ÁöÑÔºâ ÁùÄÊâã RxSwiftÁÆÄ‰ªãRxSwift Êú¨Ë¥®‰∏äÊòØÈÄöËøáÂØπÊñ∞Êï∞ÊçÆÁöÑÈ°∫Â∫èÂ§ÑÁêÜÔºåÊù•ÁÆÄÂåñÂºÇÊ≠•Á®ãÂ∫èÁöÑÂºÄÂèë„ÄÇ RxSwift Âü∫Á°ÄRxSwift Áî±‰∏âÈÉ®ÂàÜÁªÑÊàêÔºöObservablesÔºåOperators Âíå Schedulers„ÄÇ Observables&lt;T&gt; Â∏ÆÂä©‰∏Ä‰∏™Á®ãÂ∫è‰∫ßÁîü‰∏Ä‰∏™Â∏¶ÊúâÊï∞ÊçÆÁöÑ‰∫ã‰ª∂Â∫èÂàóÔºåÂÖÅËÆ∏‰∏Ä‰∏™ÊàñÂ§ö‰∏™ Observers ÂìçÂ∫î‰∫ã‰ª∂Âπ∂Â§ÑÁêÜÊñ∞ÁöÑÊï∞ÊçÆ„ÄÇObservables ËÉΩÂèëÈÄÅ‰∏âÁßçÁ±ªÂûãÁöÑ‰∫ã‰ª∂Ôºönext ‰∫ã‰ª∂Ôºåcompleted ‰∫ã‰ª∂Ôºåerror ‰∫ã‰ª∂„ÄÇ‰ΩøÁî®‰∫ã‰ª∂Â∫èÂàóÊòØÊúÄÁªàÁöÑËß£ËÄ¶ÊñπÂºèÔºå‰∏çÂÜçÈúÄË¶Å‰ΩøÁî® delegate ÊàñËÄÖÈó≠ÂåÖ„ÄÇ Operators ÊåáÁöÑÊòØÊúâÁùÄÂºÇÊ≠•ÁöÑËæìÂÖ•ÔºåÁÑ∂Âêé‰∫ßÁîüÊ≤°ÊúâÂâØ‰ΩúÁî®ÁöÑËæìÂá∫ÁöÑÊñπÊ≥ï„ÄÇÂÆÉ‰ª¨ËÉΩÂ§üÁªÑÂêàÂú®‰∏ÄËµ∑ÔºåÂÆûÁé∞Â§çÊùÇÁöÑÈÄªËæë„ÄÇÊØîÂ¶Ç‰∏ãÂõæÁöÑ filter Âíå map ÁöÑËøáÁ®ãÔºö Schedulers ÊòØ Rx ‰∏≠ÁöÑË∞ÉÂ∫¶ÈòüÂàó„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá RxSwift Â∞ÜÂêå‰∏Ä‰∏™ËÆ¢ÈòÖÂú®‰∏çÂêåÁöÑË∞ÉÂ∫¶ÈòüÂàó‰∏≠ÂÆåÊàê‰ª•ËææÂà∞ÊúÄ‰Ω≥ÁöÑÊÄßËÉΩÔºö App Êû∂ÊûÑRx ÈÄÇÂêàÊâÄÊúâÁöÑÊû∂ÊûÑ„ÄÇÂΩìÁÑ∂ÊúÄÂåπÈÖçÁöÑËøòÊòØ MVVM„ÄÇMVVM ‰∏≠Êúâ‰∏ÄÂ±Ç ViewModel ËÉΩÂ§üÊö¥Èú≤Âá∫ÂêÑ‰∏™ Observables Â±ûÊÄßÔºå‰Ω†ÂèØ‰ª•Âú® ViewController ‰∏≠Áõ¥Êé•Â∞ÜÂÖ∂Âíå UI ÁªëÂÆö„ÄÇ RxCocoaRxSwift Êèê‰æõ‰∫ÜÈÄöÁî®ÁöÑ Rx API„ÄÇÂºÄÂèëÁöÑÊó∂ÂÄôËøòÈúÄË¶Å RxCocoa ÈÖçÂêà RxSwift ‰ΩøÁî® UIKit Âíå Cocoa„ÄÇÊØîÂ¶Ç RxCocoa Áªô UISwitch Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™ rx.isOn Â±ûÊÄßÔºå‰Ω†ÂèØ‰ª•ËÆ¢ÈòÖÂÆÉÊù•ÁõëÂê¨ UISwitch ÁöÑ‰∫ã‰ª∂ÈòüÂàó„ÄÇ ObservableObservable ÁöÑÁîüÂëΩÂë®Êúü‰∏Ä‰∏™ Observable ‰∏çÂèëÂá∫‰ªª‰Ωï‰∫ã‰ª∂ÔºåÁõ¥Âà∞ÊúâËÆ¢ÈòÖÂèëÁîü„ÄÇËÆ¢ÈòÖËÄÖÂèëÈÄÅ error ÊàñËÄÖ completed ‰∫ã‰ª∂ËÉΩÁªìÊùüËÆ¢ÈòÖ„ÄÇÂΩìËÆ¢ÈòÖÁªìÊùüÔºå‰πüÂ∞±‰∏ç‰ºöÂÜçÂèëÂá∫‰ªª‰Ωï‰∫ã‰ª∂‰∫Ü„ÄÇ ‰∫ã‰ª∂ event ÊòØ‰∏™Êûö‰∏æÁ±ªÂûãÔºö 12345678public enum Event&lt;Element&gt; &#123; /// Next element is produced. case next(Element) /// Sequence terminated with an error. case error(Swift.Error) /// Sequence completed successfully. case completed&#125; ÂàõÂª∫ Observables.just ÂèØ‰ª•Áî®Êù•ÂàõÂª∫‰∏Ä‰∏™Âè™Êúâ‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑ ObservableÔºö 1let observable = Observable&lt;Int&gt;.just(one) .of Êé•Êî∂Â§ö‰∏™ÂÖÉÁ¥†ÂΩ¢Êàê‰∏Ä‰∏™ ObservableÔºö 1let observable2 = Observable.of(1, 2, 3) .from Êé•Êî∂‰∏Ä‰∏™Êï∞ÁªÑÔºåÂ∞ÜÊï∞ÁªÑÂÖÉÁ¥†ÁîüÊàê‰∏Ä‰∏™ ObservableÔºö 1let observable3 = Observable.from([1, 2, 3]) .empty Êèê‰æõ 0 ‰∏™ÂÖÉÁ¥†ÁöÑ ObservableÔºåÂè™‰ºöËß¶Âèë completed ‰∫ã‰ª∂„ÄÇÂ∞ΩÁÆ° empty ‰∏çËß¶Âèë next ‰∫ã‰ª∂Ôºå‰ΩÜÊòØËøòÈúÄË¶ÅÊòéÁ°ÆÊ≥õÂûãÁ±ªÂûãÔºåÊâÄ‰ª•‰ΩøÁî® void ÊòØÊúÄÂ•ΩÁöÑÈÄâÊã©Ôºö 1let observable4 = Observable&lt;Void&gt;.empty() .never ÂàõÂª∫ÁöÑ Observable ‰∏ç‰ºöËß¶Âèë nextÔºå‰πü‰∏ç‰ºöËß¶Âèë completedÔºö 1let observable5 = Obnservable&lt;Any&gt;.never() .create ÂàõÂª∫ ObservableÔºåÈúÄË¶Å‰º†ÂÖ•‰∏Ä‰∏™ÂÖ•ÂèÇ‰∏∫ observerÔºåËøîÂõû‰∏Ä‰∏™ Disposable ÂÆû‰æãÁöÑÈó≠ÂåÖ„ÄÇÂú®Ëøô‰∏™Èó≠ÂåÖÈáåÂÆö‰πâ‰∫ÜÊâÄÊúâÂ∞ÜË¶ÅÂèëÈÄÅÁöÑ‰∫ã‰ª∂Ôºö 12345678910Observable&lt;String&gt;.create &#123; observer in // 1 observer.onNext("1") // 2 observer.onCompleted() // 3 observer.onNext("?") // 4 return Disposables.create()&#125; Ê≥®ÊÑèÂâçÈù¢ÁîüÂëΩÂë®Êúü‰∏≠ÊèêÂèäÁöÑÔºåonCompleted ÂèëÁîüÂêéÔºåËÆ¢ÈòÖÁªìÊùü„ÄÇÊâÄ‰ª•ÂêéÈù¢ÁöÑ observer.onNext(&quot;?&quot;) ‰∫ã‰ª∂ÊòØÊó†Ê≥ïÊé•Êî∂Âà∞ÁöÑ„ÄÇ ËÆ¢ÈòÖ ObservablesÈÄöËøá .subScribe ËÆ¢ÈòÖ ObservableÔºåËøîÂõû‰∏Ä‰∏™ Disposable ÂØπË±°„ÄÇ ‰∏ãÈù¢ÊòØ‰º†ÂÖ•‰∏Ä‰∏™ÂÖ•ÂèÇ‰∏∫‰∫ã‰ª∂ event Èó≠ÂåÖÁöÑ‰æãÂ≠êÔºö 12345let disposable = observable.subScribe &#123; event in if let element = event.element &#123; print(element) &#125;&#125; .subScribe ËøòÂèØ‰ª•Êé•ÂèóÂêÑÁßç‰∫ã‰ª∂ÁöÑÂõûË∞ÉÈó≠ÂåÖÔºåÊØîÂ¶Ç onNext,onCompleted,onErrorÔºö 123let disposable2 = observable.subscribe(onNext: &#123; element in print(element) &#125;) ÂèñÊ∂àËÆ¢ÈòÖ ObservablesÂ¶ÇÊûú‰∏çÂèñÊ∂àËÆ¢ÈòÖÔºåÂ∞Ü‰ºöÂ∞Ü‰ºö‰∫ßÁîüÂÜÖÂ≠òÊ≥ÑÊºèÔºåÂèñÊ∂àËÆ¢ÈòÖÂèØ‰ª•ÈÄöËøá .dispose Áõ¥Êé•ÂèñÊ∂àÔºö 1disposable.dispose() ‰ΩÜÊòØËøôÁßçÊâãÂä®ÁöÑÂèñÊ∂àÈùûÂ∏∏ÁöÑÈ∫ªÁÉ¶ÔºåRxSwift Êèê‰æõ‰∫Ü‰∏Ä‰∏™ DisposeBag Á±ªÂûãÔºåÁî®‰∫éËá™Âä®ÂõûÊî∂ÔºåÊääËÆ¢ÈòÖÂêéËøîÂõûÁöÑ disposable ÂØπË±°Áõ¥Êé•Âä†ÂÖ• DisposeBag: 12let disposeBag = DisposeBag()disposable.addDisposableTo(disposeBag) ÂΩì disposeBag ÂõûÊî∂ÁöÑÊó∂ÂÄôÔºå‰ºöËá™Âä®ÂèñÊ∂àËÆ¢ÈòÖ„ÄÇ ÂèñÊ∂àËÆ¢ÈòÖÊúâ‰∏§ÁßçÊñπÂºèÔºå‰∏ÄÁßçÊòØÊ≠§Â§ÑËØ¥ÁöÑ disposebagÔºåËøòÊúâ‰∏ÄÁßçÊñπÂºèÊòØËÆ¢ÈòÖËÄÖË∞ÉÁî® onCompleted ÊñπÊ≥ï„ÄÇÊØîÂ¶ÇÁ∫øÈù¢ÁöÑ Subjects Â∞±ÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®ÂèñÊ∂àÔºösubject.onCompleted() Subjects‰ªÄ‰πàÊòØ subjectsÔºüsubjects Êó¢ÊòØ Observable ÂèàÊòØ Observer„ÄÇÊúâÂõõÁßçÁ±ªÂûãÔºö PublishSubjectÔºöËÆ¢ÈòÖÂêéÊé•Âèó‰∫ã‰ª∂ BehaviorSubjectÔºöÊúâÂàùÂßãÂÄºÔºåÊñ∞ÁöÑËÆ¢ÈòÖËÄÖ‰ºöËé∑ÂæóËÆ¢ÈòÖÂâçÊúÄÊñ∞ÁöÑ‰∫ã‰ª∂ ReplySubjectÔºöÊúâ‰∏Ä‰∏™ bufferÔºåÊñ∞ÁöÑËÆ¢ÈòÖËÄÖ‰ºöËé∑Âæó buffer ‰∏≠ÁºìÂ≠òÁöÑ‰∫ã‰ª∂ VariableÔºöÂåÖË£Ö‰∫ÜÁöÑ BehaviorSubject„ÄÇÊääÂΩìÂâçÂÄº‰Ωú‰∏∫Áä∂ÊÄÅÔºåÂÄºÊîπÂèòÊó∂Ëß¶Âèë‰∫ã‰ª∂„ÄÇÊñ∞ÁöÑËÆ¢ÈòÖËÄÖÂêåÊ†∑‰ºöËé∑ÂæóËÆ¢ÈòÖÂâçÊúÄÊñ∞ÁöÑ‰∫ã‰ª∂„ÄÇ PublishSubjectsPublishSubject Âè™ÊúâÂú®ËÆ¢ÈòÖÂêéÊâçËÉΩÊé•Êî∂Âà∞‰∫ã‰ª∂„ÄÇÊµÅÁ®ãÂ¶ÇÂõæÊâÄÁ§∫ÔºåÂú®‰∫ã‰ª∂1Êó∂Âπ∂Ê≤°ÊúâËøõË°åËÆ¢ÈòÖÔºåÊâÄ‰ª•Âπ∂Ê≤°ÊúâÊî∂Âà∞‰∫ã‰ª∂ÔºõÂú®‰∫ã‰ª∂1Âíå‰∫ã‰ª∂2‰πãÈó¥ËøõË°åËÆ¢ÈòÖÔºåËÉΩÊî∂Âà∞‰∫ã‰ª∂2Âíå‰∫ã‰ª∂3ÔºõÂú®‰∫ã‰ª∂2Âíå‰∫ã‰ª∂3‰πãÈó¥ËÆ¢ÈòÖÔºåËÉΩÊî∂Âà∞‰∫ã‰ª∂3Ôºö Á§∫‰æã‰ª£Á†ÅÂ¶Ç‰∏ãÔºåË¶ÅÊ≥®ÊÑèÂàùÂßãÂåñÁöÑÊó∂ÂÄôË¶ÅËÆæÁΩÆÂ•ΩÊ≥õÂûãÁ±ªÂûãÔºö 123456789101112131415let disposeBag = DisposeBag()// ÂàõÂª∫ PublishSubjectlet subject = PublishSubject&lt;Int&gt;()// ËÆ¢ÈòÖsubject.subscribe &#123; print($0.element ?? $0) &#125; .addDisposableTo(disposeBag)// ÂèëÈÄÅ‰∫ã‰ª∂subject.onNext(1) //1// ÁªìÊùüËÆ¢ÈòÖsubject.onCompleted() //completed// ÂÜçÊ¨°ËÆ¢ÈòÖsubject.subscribe &#123; print($0.element ?? $0) &#125; .addDisposableTo(disposeBag) //completed// ÂèëÈÄÅ‰∫ã‰ª∂subject.onNext(2) //‰ªÄ‰πà‰πüÊ≤°ÊúâÂèëÁîü Ë¶ÅÊ≥®ÊÑè‰∏ÄÁÇπÔºåÂΩì‰∏Ä‰∏™ subject ÂèñÊ∂àËÆ¢ÈòÖÂêéÔºåÂÜçËÆ¢ÈòÖÔºå‰ºöÁõ¥Êé•ÂèóÂà∞‰∏Ä‰∏™ completed ‰∫ã‰ª∂Ôºå‰πãÂêéÂÜçÂèëÈÄÅ next ‰∫ã‰ª∂ÊòØÊ≤°Êúâ‰ªª‰ΩïÂìçÂ∫îÁöÑ„ÄÇ BehaviorSubjectsBehaviorSubjects Âú®ËÆ¢ÈòÖ‰πãÂêéÂèØ‰ª•Êé•Âà∞ÊúÄËøë‰∏ÄÊ¨°ÁöÑ‰∫ã‰ª∂„ÄÇÂπ∂‰∏îÊé•Âèó‰∏Ä‰∏™ÂàùÂßãÂÄºÔºåÂΩìËÆ¢ÈòÖÂâçÊ≤°Êúâ‰∫ã‰ª∂Êó∂ÔºåÂ∞ÜÂàùÂßãÂÄº‰Ωú‰∏∫‰∫ã‰ª∂ÂÄºÂèëÈÄÅ„ÄÇÂ¶ÇÊûúÊâÄÁ§∫Ôºå‰∫ã‰ª∂1Âíå‰∫ã‰ª∂2‰πãÈó¥ËÆ¢ÈòÖÁöÑÊó∂ÂÄôÔºåËøòÊòØËÉΩÊî∂Âà∞‰∫ã‰ª∂1Ôºõ‰∫ã‰ª∂2Âíå‰∫ã‰ª∂3‰πãÈó¥ËÆ¢ÈòÖÁöÑÊó∂ÂÄôÔºåËøòÊòØËÉΩÊî∂Âà∞‰∫ã‰ª∂2Ôºö Á§∫‰æã‰ª£Á†ÅÂ¶Ç‰∏ãÔºåÁî±‰∫éÊúâÂàùÂßãÂÄºÁöÑÁ±ªÂûãÊé®Êñ≠ÔºåÂ∞±‰∏çÈúÄË¶ÅËÆæÁΩÆÊ≥õÂûã‰∫ÜÔºö 123456789101112131415let disposeBag = DisposeBag()// ÂàõÂª∫ BehaviorSubjectlet subject = BehaviorSubject(value: "Initial value")// ËÆ¢ÈòÖsubject.subscribe &#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) // Initial Value// ÂèëÈÄÅ‰∫ã‰ª∂subject.onNext("X") // X// ÈîôËØØ‰∫ã‰ª∂subject.onError(MyError.anError) // anError// ÂÜçÊ¨°ËÆ¢ÈòÖsubject.subscribe &#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) // anError// ÂèëÈÄÅ‰∫ã‰ª∂subject.onNext("X") // Ê≤°Êúâ‰ªª‰Ωï‰∫ãÊÉÖÂèëÁîü Âíå PublishSubject Á±ª‰ººÁöÑÔºåÂΩì subject ÂÆåÊàêÊàñËÄÖÈîôËØØÊó∂ÔºåÂÜçËÆ¢ÈòÖÔºåÂ∞±Âè™‰ºöÂèëÂá∫ÂÆåÊàêÂíåÈîôËØØ‰∫ã‰ª∂ÔºåÂπ∂‰∏îÂøΩÁï•ÂêéÈù¢ÁöÑ next ‰∫ã‰ª∂„ÄÇ ReplaySubjectsReplaySubject Êúâ‰∏Ä‰∏™ buffer Áî®Êù•ÊöÇÂ≠òÂÖàÂâçÁöÑ‰∫ã‰ª∂ÂÄºÔºåÂàùÂßãÂåñÁöÑÊó∂ÂÄôËÆæÁΩÆÁºìÂ≠òÁöÑÂ§ßÂ∞è„ÄÇÂΩìÊúâËÆ¢ÈòÖÊó∂ÔºåÂ∞ÜÁºìÂ≠òÁöÑÂÄºÂèëÈÄÅ„ÄÇÂ¶ÇÂõæÊâÄÁ§∫ÔºåÂΩìÂú®‰∫ã‰ª∂2Âíå‰∫ã‰ª∂3‰πãÈó¥‰∫ßÁîüËÆ¢ÈòÖÁöÑÊó∂ÂÄôÔºåÁºìÂ≠òÁöÑ‰∫ã‰ª∂1Âíå‰∫ã‰ª∂2ÈÉΩËß¶Âèë‰∫ÜÔºö Á§∫‰æã‰ª£Á†ÅÂ¶Ç‰∏ãÔºåËøòÊòØË¶ÅÊ≥®ÊÑèËÆæÁΩÆÊ≥õÂûãÔºåÂπ∂‰∏îÂàùÂßãÂåñÊñπÊ≥ïÊòØ create(bufferSize:) 12345678910111213141516let disposeBag = DisposeBag()// ÂàõÂª∫ ReplaySubjectlet subject = ReplaySubject&lt;String&gt;.create(bufferSize: 2)// ÂèëÈÄÅ‰∫ã‰ª∂subject.onNext("1")subject.onNext("2")// ËÆ¢ÈòÖsubject.subscribe &#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) // 1 2// ÂèëÈÄÅÈîôËØØsubject.onError(MyError.annError) // annError// ÂÜçÊ¨°ËÆ¢ÈòÖsubject.subscribe &#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) // 1 2 annError// ÂèëÈÄÅ‰∫ã‰ª∂subject.onNext("3") // Ê≤°Êúâ‰ªª‰ΩïÂèçÂ∫î Ê≥®ÊÑèÔºåÂíåÂâçÈù¢ÈÉΩÁõ∏ÂêåÁöÑÊòØÔºåÁî±‰∫é‰πãÂâç subject Â∑≤ÁªèÂèëÂá∫ÈîôËØØ‰∫ã‰ª∂ÔºåÂÜçÊ¨°ËÆ¢ÈòÖÁöÑÊó∂ÂÄô‰ºöÁ´ãÂàªÊî∂Âà∞ÈîôËØØ‰∫ã‰ª∂„ÄÇ‰∏çÂêåÁöÑÊòØÔºåÁî±‰∫é ReplaySubject Êúâ bufferÔºåÊâÄ‰ª•‰ªçÁÑ∂‰ºöÂÖàÂìçÂ∫î buffer ‰∏≠ÁºìÂ≠òÁöÑ‰∫ã‰ª∂„ÄÇ VariablesVariable ÊòØ BehaviorSubject ÁöÑÂåÖË£ÖÔºåÂ∞ÜÂÖ∂ÂÄº‰Ωú‰∏∫Áä∂ÊÄÅ„ÄÇÂΩìÂÄºÂèòÂåñÊó∂ÔºåËß¶Âèë‰∫ã‰ª∂Ôºå‰∏çÂÜçÈúÄË¶Å onNext() ÊñπÊ≥ïËß¶Âèë‰∫ã‰ª∂„ÄÇVariable ‰∏ç‰ºöÂá∫Áé∞ errorÔºå‰πü‰∏çÈúÄË¶ÅÊâãÂä®Ëß¶Âèë completed ‰∫ã‰ª∂„ÄÇ ‰ª£Á†ÅÁ§∫‰æãÂ¶Ç‰∏ãÔºö 12345678910let disposeBag = DisposeBag()// ÂàõÂª∫ Variablevar variable = Variable("Initial value")// Êõ¥ÊîπÂÄºvariable.value = "New Value"// ËÆ¢ÈòÖvariable.asObservable() .subscribe &#123; print($0.element) &#125;.addDisposableTo(bag) // New Value Variable ÈúÄË¶Å‰ΩøÁî® asObservable() ÊñπÊ≥ïÂ∞ÜÂÖ∂ËΩ¨Êç¢‰∏∫ ObservableÔºåÂÄºÊòØÂÖ∂ value Â±ûÊÄß„ÄÇÂè¶Â§ñÔºåÁî±‰∫éÊòØ BehaviorSubject ÁöÑÂåÖË£ÖÔºåÂõ†Ê≠§ÔºåËÆ¢ÈòÖÁöÑÊó∂ÂÄô‰ºöÊâìÂç∞ÊúÄÂêé‰∏ÄÊ¨°ÁöÑ‰∫ã‰ª∂ÂÄº„ÄÇ Subject ‰∏é Observer Âíå Observable ÁöÑÂå∫Âà´Ëøô‰∏ÄËäÇÊòØÊàëËá™Â∑±ÁöÑÁêÜËß£ÔºåÂèØËÉΩÂú®ÁêÜËß£‰∏äÊúâÂÅèÂ∑Æ„ÄÇÂ¶ÇÊûúÁúãÂà∞ËøôÈáåÂèØ‰ª•Ëá™Â∑±‰πüÊÄùËÄÉ‰∏Ä‰∏ã„ÄÇ Subject ‰∏é Observable ÁöÑ‰∏çÂêåonNextÔºåonErrorÔºåonCompleted ÈÉΩÊòØ Observer ‰∏≠ÁöÑÊñπÊ≥ïÔºå‰ΩÜÊòØÊú¨Ë∫´Âπ∂Ê≤°ÊúâÂÖ∑‰ΩìÁöÑÂÆûÁé∞„ÄÇObservable Âú®ËÆ¢ÈòÖÁöÑÊó∂ÂÄô‰º†ÂÖ•‰∫ÜËøôÂá†‰∏™ÊñπÊ≥ïÁöÑÂÆûÁé∞ÔºåÊâÄ‰ª•Âú®Ëß¶Âèë‰∫ã‰ª∂ÁöÑÊó∂ÂÄôÔºåÁõ¥Êé•ÂÜÖÈÉ®Ë∞ÉÁî®Ëøô‰∫õÈó≠ÂåÖÂìçÂ∫î‰∫ã‰ª∂Âç≥ÂèØ„ÄÇ‰Ω†ÂèØ‰ª•ÊääËøô‰∏™ËøáÁ®ãÊÉ≥Ë±°Êàê Observable Ë∞ÉÁî®ÂÖ∂ÂÜÖÈÉ®ÁöÑ Observer„ÄÇÊâÄ‰ª• Observable ÂøÖÈ°ªË¶ÅËÉΩË¢´ËÆ¢ÈòÖÔºåËÆ¢ÈòÖÊúâ‰ªÄ‰πàÁî®ÔºüÁî®Êù•‰º†ÈÄí‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ï„ÄÇ Subject Êó¢ÊòØ Observable ÂèàÊòØ ObserverÔºåÊàë‰ª¨ËÆ¢ÈòÖÂÆåÔºå‰º†ÂÖ•‰∫ã‰ª∂ÁöÑÂÆûÁé∞ÂêéÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî® observer.onNext()„ÄÇÁõ∏ÂΩì‰∫éÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄâÊã©‰∏ªÂä®Ëß¶Âèë‰∫ã‰ª∂ÁöÑÊó∂Êú∫ÔºåÁÑ∂Âêé Observer ÂìçÂ∫î‰∫ã‰ª∂„ÄÇËøôÂæàÊúâÁî®ÔºåÊØîÂ¶ÇÂ§ÑÁêÜ UI ‰∫§‰∫íÔºåÂ∞±ÂøÖÈ°ªË¶ÅÂú®‰ªªÊÑèÊó∂ÂàªÈÉΩËÉΩ‰∏ªÂä®Ëß¶Âèë observer.onNext() ÊñπÊ≥ï„ÄÇËÄåÂçïÁ∫ØÁöÑ Observable Âàô‰∏çË°åÔºåÂÆÉÊòØÈùûÂ∏∏Ë¢´Âä®ÁöÑÔºåË¶Å‰πàÁõ¥Êé•Ëß¶ÂèëÔºåË¶Å‰πàÂª∂ËøüÂ§ö‰πÖÊàñËÄÖÂ§öÂ∞ëÂë®ÊúüËß¶Âèë„ÄÇ Subject ‰∏é Observer ÁöÑ‰∏çÂêåÂØπ‰∫éÂçïÁ∫ØÁöÑ ObserverÔºåÁî±‰∫éÊ≤°ÊúâËøô‰∫õ‰∫ã‰ª∂ÊñπÊ≥ïÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÔºåÊâÄ‰ª•Êàë‰ª¨‰πü‰∏çËÉΩÂÉè Subject ‰∏ÄÊ†∑‰∏ªÂä®Ëß¶Âèë‰∫ã‰ª∂„ÄÇ‰ΩÜÊòØÊúâ‰∏Ä‰∫õÁâπÊÆäÁöÑ Observer Êú¨Ë∫´Âú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÂ∞±Êèê‰æõ‰∫Ü‰∫ã‰ª∂Â§ÑÁêÜÁöÑÊñπÊ≥ïÔºåËøôÁßç Observer ‰∏çÈúÄË¶ÅÂÉè subscribe ‰∏ÄÊ†∑ËÆ¢ÈòÖÁöÑÊó∂ÂÄô‰º†ÂÖ•‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÔºåÁõ¥Êé•‰ΩøÁî® bindTo() ÁªëÂÆöÂç≥ÂèØ„ÄÇ ‰∏çËøá‰πüÊ≠£ÊòØÂõ†‰∏∫ Observer Êèê‰æõ‰∫ÜÈªòËÆ§ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÔºåÊâÄ‰ª•Êàë‰ª¨‰∏çËÉΩÁî®ÂÖ∂Â§ÑÁêÜ UI ‰∫§‰∫í„ÄÇÂõ†‰∏∫ UI ‰∫§‰∫íÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÊòØË¶ÅÊ†πÊçÆÂÖ∑‰ΩìÊÉÖÂÜµËÄåÂÆöÁöÑ„ÄÇÊØîÂ¶ÇÁÇπÂáª‰∏Ä‰∏™ÊåâÈíÆÊàëÂèØËÉΩË¶ÅËÆ©ËÆ°Êï∞Âä†‰∏ÄÔºåÊàñËÄÖËÆ©ËÆ°Êï∞Âáè‰∏Ä„ÄÇ ÊÄªÁªìÊâÄ‰ª•ÔºåÂú®ÊàëÁöÑÁêÜËß£‰∏ãÔºåObservable ÈúÄË¶Å‰º†ÈÄí‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÔºåÊâÄ‰ª•ÂèØ‰ª•ÂÆöÂà∂Ôºå‰ΩÜ‰∏çËÉΩ‰∏ªÂä®Ëß¶ÂèëÔºõObserver ÊúâÈªòËÆ§‰∫ã‰ª∂Â§ÑÁêÜÊñπÊ≥ïÔºåÊâÄ‰ª•ÂèØ‰ª•‰∏ªÂä®Ëß¶ÂèëÔºå‰ΩÜ‰∏çËÉΩÂÆöÂà∂„ÄÇ Âõ†‰∏∫ Subject Êó¢ËÉΩ‰∏ªÂä®ÈÄâÊã©Ëß¶Âèë‰∫ã‰ª∂ÁöÑÊó∂Êú∫ÔºåÂèàËÉΩ‰∏™ÊÄßÂåñ‰∫ã‰ª∂Â§ÑÁêÜÁöÑÊñπÊ≥ïÔºåÊâÄ‰ª•‰∏ÄËà¨‰∫§‰∫íÁöÑ UI Êéß‰ª∂‰∏≠ÁöÑÂ±ûÊÄßÈÉΩÊòØ Subject Á±ªÂûã„ÄÇ Êìç‰ΩúÁ¨¶ÁöÑÊúÄ‰Ω≥ÂÆûË∑µËøáÊª§Êìç‰ΩúÁ¨¶Igoring operatorsignoreElementsignoreElements Áî®Êù•ÂøΩÁï•ÊâÄÊúâÁöÑ .next ‰∫ã‰ª∂„ÄÇÊâÄ‰ª•Áî®Êù•ÊåáÊé•Âèó completed ‰∫ã‰ª∂ Á§∫‰æãÂ¶Ç‰∏ãÔºö 1234let strikes = PublishSubject&lt;String&gt;strikes.ignoreElements() .subscribt &#123; print("You are out") &#125; .addDisposableTo(bag) elementAtelementAt Âè™‰ºöËé∑ÂèñÁ¥¢ÂºïÂ∫èÂè∑ÁöÑ‰∫ã‰ª∂ÔºåÂøΩÁï•ÂÖ∂‰ªñÁöÑÊâÄÊúâ .next„ÄÇÁ¥¢ÂºïÂ∫èÂè∑‰ªé 0 ÂºÄÂßã: ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234let strikes = PublishSubject&lt;String&gt;()strikes.elementAt(1) .subscribe &#123; print("You are out") &#125; .addDisposableTo(bag) filterfilter Êé•Âèó‰∏Ä‰∏™Êñ≠Ë®ÄÈó≠ÂåÖÔºåÂÖ•ÂèÇ‰∏∫ÂΩìÂâç‰∫ã‰ª∂ÂÄº„ÄÇÊé•ÂèóÊâÄÊúâÊñ≠Ë®ÄÊ≠£Á°ÆÁöÑ‰∫ã‰ª∂„ÄÇÊ≥®ÊÑèÊòØÊé•ÂèóËÄå‰∏çÊòØËøáÊª§ÊéâÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234Observable.of(1, 2, 3, 4, 5) .filter &#123; $0 % 2 == 0&#125; .subscribe &#123; print($0.elemetn ?? $0) &#125; .addDisposableTo(bag) Skipping operators‰∏äÈù¢‰∏ÄËäÇÊòØÊ†πÊçÆÊù°‰ª∂Á≠õÈÄâÔºõËøô‰∏ÄËäÇÊòØÂøΩÁï•Âà∞Êüê‰∏™Êª°Ë∂≥Êù°‰ª∂ÁöÑÔºåÂêéÈù¢ÁöÑÂÖ®ÈÉ®Êé•Âèó„ÄÇ skipskip Áî®Êù•Áï•Ëøá‰∏ÄÂÆöÊï∞ÈáèÁöÑ .next‰∫ã‰ª∂ÔºåÁÑ∂ÂêéÂºÄÂßãÊé•Âèó„ÄÇ‰ªé 1 ÂºÄÂßãËÆ°Êï∞ ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234Observable.of(1, 2, 3, 4, 5) .skip(2) .subscribe &#123; print($0.element ?? $0)&#125; .addDisposableTo(bag) skipWhileskipWhile ÊòØÁï•ËøáÁõ¥Âà∞Êüê‰∏™Êª°Ë∂≥Êù°‰ª∂ÁöÑ‰∫ã‰ª∂ÂèëÁîü„ÄÇskipWhile ËøòÊúâ‰∏Ä‰∏™ÂÖÑÂºüÊñπÊ≥ï skipWhileWithIndexÔºåÈô§‰∫ÜÊé•Âèó‰∫ã‰ª∂ÂÄºÔºåËøòÊé•Âèó‰∫ã‰ª∂Â∫èÂè∑Ôºåindex ‰ªé 0 ÂºÄÂßãÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234Observable.of(1, 2, 3, 4, 5) .skipWhile &#123; $0 % 2 == 0 &#125; .subscribe &#123; print($0.element ?? $0)&#125; .addDisposableTo(bag) skipUntilskipUntil ÊòØÁï•ËøáÁõ¥Âà∞Êüê‰∏™‰∫ã‰ª∂ÂèëÁîü„ÄÇÂ∞±ÊòØÂΩìÂâç Observable ÂíåÂè¶Â§ñ‰∏Ä‰∏™ Observable Áõ∏ÂÖ≥ËÅîÔºåÂΩìÁâπÂÆöÁöÑ Observable ÁöÑ .next ÂèëÁîüÁöÑÊó∂ÂÄôÔºåÊâçÂºÄÂßãÊé•Âèó‰∫ã‰ª∂Ôºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789let subject = PublishSubject&lt;String&gt;()let trigger = PublishSubject&lt;String&gt;()subject.skipUntil(trigger) .subscribe &#123; print( $0.element ?? $0) &#125; .addDisposableTo(bag)// ... ÂΩìÂâçÊó∂ÂàªËôΩÁÑ∂ËÆ¢ÈòÖ‰∫ÜÔºå‰ΩÜÊòØÂèëÈÄÅ‰∫ã‰ª∂ÊòØÊó†ÂèçÂ∫îÁöÑtrigger.onNext("a")// ... Áî±‰∫é trigger ÂèëÈÄÅ‰∫Ü onNext ‰∫ã‰ª∂ÔºåÁé∞Âú® subject ÂèØ‰ª•Êé•Êî∂Âà∞ next ‰∫ã‰ª∂‰∫Ü Taking operatorsÊú¨Â∞èËäÇÂíå‰∏ä‰∏ÄÂ∞èÁªìÊ≠£Â•ΩÁõ∏ÂèçÔºåËøô‰∏ÄÂ∞èËäÇÊòØÊé•ÂèóÊüê‰∏™‰∫ã‰ª∂‰πãÂâçÁöÑÊâÄÊúâ‰∫ã‰ª∂Ôºå‰πãÂêéÁöÑÈÉΩ‰∏çÊé•Âèó„ÄÇ taketake Âíå skip Ê≠£Â•ΩÁõ∏Âèç„ÄÇtake ÊòØÁõ¥Âà∞‰∏ÄÂÆöÊï∞ÈáèÁöÑ‰∫ã‰ª∂ÂèëÁîüÂêéÊâçÂºÄÂßãÂèñÔºåËÄå‰∏çÊòØÂèñÂà∞‰∏ÄÂÆöÊï∞ÈáèÁöÑÊó∂ÂÄôÂÅú ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234Observable.of(1, 2, 3, 4, 5) .take(2) .subscribe &#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) takeWhiletakeWhile Âíå skipWhile Ê≠£Â•ΩÁõ∏Âèç„ÄÇtakeWhile ÊòØÂèñÂà∞Êüê‰∏™‰∏çÊª°Ë∂≥Êù°‰ª∂ÁöÑ‰∫ã‰ª∂„ÄÇtakeWhile ËøòÊúâ‰∏Ä‰∏™ÂÖÑÂºüÊñπÊ≥ï takeWhileWithIndexÔºåÈô§‰∫Ü‰∫ã‰ª∂ÂÄº valueÔºåËøòÊé•Âèó‰∫ã‰ª∂ÁöÑÂ∫èÂè∑ indexÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345Observable.of(1, 2, 3, 4, 5) .takeWhileWithIndex &#123; v, i in v &gt; 1 &amp;&amp; i &gt;1 &#125;.subscribe &#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) takeUntiltakeUntil Âíå skipUntil Áõ∏Âèç„ÄÇË°®Á§∫Êé•Âèó‰∫ã‰ª∂Áü•ÈÅìÊüê‰∏™ Observable ÁöÑ‰∫ã‰ª∂Ëß¶ÂèëÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789let subject = PublishSubject&lt;String&gt;()let trigger = PublishSubject&lt;String&gt;()subject.takeUntil(trigger) .subscribe &#123; print($0.element ?? $0 )&#125; .addDisposableTo(bag)// ... Ê≠§Êó∂‰∏ÄÁõ¥Êé•Âèó next ‰∫ã‰ª∂trigger.onNext("x")// ... Áé∞Âú®ÂøΩÁï•ÊâÄÊúâÁöÑ next ‰∫ã‰ª∂‰∫Ü Distinct operatorsÊú¨Â∞èËäÇÁöÑÊìç‰ΩúÁ¨¶ÂèØ‰ª•Èò≤Ê≠¢ÈáçÂ§ç‰∫ã‰ª∂ distinctUntilChangedÂ¶ÇÊûúÂΩìÂâç‰∫ã‰ª∂ÂíåÂâç‰∏Ä‰∏™‰∫ã‰ª∂ÁöÑ‰∫ã‰ª∂ÂÄºÁõ∏ÂêåÔºåÈÇ£‰πàÂøΩÁï•Ëøô‰∏™‰∫ã‰ª∂Ôºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234Observable.of(1, 2, 2, 1) .distinctUntilChanged() .subscribe &#123; print($0.elemet ?? $0) &#125; .addDisposableTo(bag) distinctUntilChanged ËøòÊé•Âèó‰∏Ä‰∏™Èó≠ÂåÖÔºåÈó≠ÂåÖÂÖ•ÂèÇ‰∏∫Áõ∏ÈÇª‰∫ã‰ª∂ÁöÑ‰∫ã‰ª∂ÂÄºÔºåÈó≠ÂåÖËøîÂõûÂÄº‰∏∫ true ÂàôÂøΩÁï•ÂΩìÂâç‰∫ã‰ª∂„ÄÇ ‰ª£Á†ÅÂ¶Ç‰∏ãÔºåÂΩìÂâç‰∏Ä‰∏™‰∫ã‰ª∂ÂÄº‰∏∫ 1ÔºåÂΩìÂâç‰∫ã‰ª∂ÂÄº‰∏∫ 2 ÁöÑÊó∂ÂÄôÂøΩÁï•ÂΩìÂâç‰∫ã‰ª∂Ôºö 1234567Observable.of(1, 2, 2, 1) .distinctUntilChanged &#123; a, b in if a == 1 &amp;&amp; b == 2 &#123; return true &#125; return false &#125; ËΩ¨Êç¢Êìç‰ΩúÁ¨¶ËΩ¨Êç¢ÂÖÉÁ¥†toArrayÂ∞Ü‰∫ã‰ª∂Â∫èÂàóÁöÑÂÖÉÁ¥†ËΩ¨Êç¢Êàê‰∏Ä‰∏™Êï∞ÁªÑÔºåÁÑ∂ÂêéÂ∞ÜËøô‰∏™Êï∞ÁªÑ‰Ωú‰∏∫‰∫ã‰ª∂ÂÄºÔºåËß¶Âèë .next ‰∫ã‰ª∂Ôºö ‰ª£Á†ÅÁ§∫‰æãÔºö 1234Observable.of("A", "B", "C") .toArray() .subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(bag) // ["A", "B", "c"] mapmap ÂíåÊï∞ÁªÑ‰∏≠ÁöÑ map Êó†ÂºÇÔºö ‰ª£Á†ÅÁ§∫‰æãÔºö 1234Observable.of(1, 2, 3) .map&#123; $0 * 2&#125; .subscribe&#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) map ËøòÊúâ‰∏Ä‰∏™ÂÖÑÂºüÊñπÊ≥ï mapWithIndex Â∏¶Êúâ‰∏Ä‰∏™Á¥¢ÂºïÔºö ‰ª£Á†ÅÁ§∫‰æãÔºö 12345Observable.of(1, 2, 3) .mapWithIndex&#123; v, i in i &gt; 1 ? v * 2 : v &#125;.subscribe&#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) ËΩ¨Êç¢ÂÜÖÈÉ® ObservablesflatMapflatMap ‰∏ªË¶ÅÂ∞±ÊòØÂ∞Ü‰∏Ä‰∏™ Observable ‰∏≠ÁöÑÊØè‰∏™ÂÖÉÁ¥†ÈÉΩËΩ¨Êç¢‰∏∫‰∏Ä‰∏™ ObservableÔºåÂπ∂‰∏îËÆ¢ÈòÖ„ÄÇflatMap ÈúÄË¶Å‰∏Ä‰∏™Èó≠ÂåÖÔºå‰º†ÂÖ•ÂΩìÂâç Observable ÁöÑ‰∫ã‰ª∂ÂÄºÔºåËøîÂõû‰∏Ä‰∏™Êñ∞ÁöÑ Observable„ÄÇ‰∏ãÈù¢ÂõæÁ§∫ÁöÑ‰æãÂ≠ê‰∏≠ Observable ÁöÑ‰∫ã‰ª∂ÂÄºÁ±ªÂûã‰∏∫ Variable„ÄÇ‰º†ÂÖ•‰∏Ä‰∏™ VariableÔºåÂ∞ÜÂÖ∂ value Â±ûÊÄßÊâ©Â§ßÂçÅÂÄçÔºö ‰ª£Á†ÅÁ§∫‰æãÔºö 12345678910let outter = PublishSubject&lt;Variable&lt;Int&gt;&gt;outter.asObservable() .flatMap &#123; $0.value *= 10 return $0.asObservable() &#125;.subscribe(onNext: &#123; print($0) &#125;) .addDisposableTo(bag)outter.onNext(Variable(1))outter.onNext(Variable(2)) flatMapLatestflatMapLatest ÊòØ flatMap Âíå switchlatest ÁöÑÂêà‰Ωì„ÄÇÂú®‰ΩøÁî®‰∏äÂíå flatMap ‰∏ÄËá¥Ôºå‰ΩÜÊòØÂÆÉÂÄºËÆ¢ÈòÖÊúÄÊñ∞ÁöÑ ObservableÔºö ÁúãÂá∫Âå∫Âà´‰∫Ü‰πàÔºüÂΩìÊúâÊñ∞ÁöÑËÆ¢ÈòÖ‰∫ßÁîüÁöÑÊó∂ÂÄôÔºåÊóßÁöÑ Observable Â∞±ÂèñÊ∂àËÆ¢ÈòÖ‰∫ÜÔºåÊâÄ‰ª•ËøôÈáåÁî±‰∫éËÆ¢ÈòÖ‰∫ÜÁªøËâ≤ÁöÑ ObservableÔºåÊâÄ‰ª•ËìùËâ≤Âèò‰∏∫ 30ÔºåÂπ∂‰∏ç‰ºöËß¶ÂèëËÆ¢ÈòÖÔºõÁî±‰∫éËÆ¢ÈòÖ‰∫ÜÊ©ôËâ≤ÁöÑ ObservableÔºåÊâÄ‰ª•ÁªøËâ≤Âèò‰∏∫ 50Ôºå‰πü‰∏ç‰ºöËß¶ÂèëËÆ¢ÈòÖ„ÄÇËÄå flatMap ÂàôÊòØÂÖ®ÈÉ®ÈÉΩËß¶Âèë‰∫ÜËÆ¢ÈòÖÁöÑ„ÄÇ ÂÖ≥ËÅîÊìç‰ΩúÁ¨¶ÂâçÁºÄ‰∏é‰∏≤ËÅîstartWithstartWith Êé•Âèó‰∏Ä‰∏™‰∫ã‰ª∂ÂÄºÔºåÂ∞ÜÂÖ∂ÊèíÂà∞ÂΩìÂâç‰∫ã‰ª∂Â∫èÂàóÁöÑÊúÄÂâçÈù¢ÔºåËøîÂõû‰∏Ä‰∏™Êñ∞ÁöÑ ObservableÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234let numbers = Observable.of(2, 3, 4)let observable = numbers.startWith(1)observable.subscribe&#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) concatconcat ËøûÊé•‰∏§‰∏™‰∫ã‰ª∂Â∫èÂàóÔºåÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑ‰∫ã‰ª∂Â∫èÂàóÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºåÊ≥®ÊÑèË¶ÅÁî® [] Â∞Ü‰∫ã‰ª∂Â∫èÂàóÂΩìÊàê‰∏Ä‰∏™Êï∞ÁªÑÔºö 123456let first = Observable.of(1, 2, 3)let second = Observable.of(4, 5, 6)let observable = Observable.concat([first, second])observable.subscribe&#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) Ëøû‰∏™‰∫ã‰ª∂Â∫èÂàóÁöÑÊ≥õÂûãÁ±ªÂûã‰∏ÄÂÆöË¶ÅÁõ∏ÂêåÔºåÂê¶ÂàôÂ¥©Ê∫ÉÁªô‰Ω†Áúãüòñ ÂêàÂπ∂mergemerge Â∞ÜÂÖÉÁ¥†‰∏∫‰∫ã‰ª∂Â∫èÂàóÁöÑ‰∫ã‰ª∂Â∫èÂàóËá™Âä®ÊãÜÂºÄÔºåÊàê‰∏∫‰∏Ä‰∏™Êñ∞ÁöÑ‰∫ã‰ª∂Â∫èÂàó„ÄÇÂÖ∂ÂÆû‰Ω†‰πüÂèØ‰ª•ÂàÜÂºÄÊù•ÂÜôÔºåËÆ©ÂÆÉ‰ª¨ÂàÜÂà´ËÆ¢ÈòÖÔºåmerge ‰∏ªË¶ÅÂ∞±ÊòØÁî®Êù•ÂáèÂ∞ë‰∫ã‰ª∂Â∫èÂàóÁöÑËÆ¢ÈòÖÁöÑÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789let left = PublishSubject&lt;String&gt;()let right = PublishSubject&lt;String&gt;()// Â∞Ü‰∏§‰∏™‰∫ã‰ª∂Â∫èÂàó‰Ωú‰∏∫‰∫ã‰ª∂ÂÄºlet source = Observable.of(left.asObservable(), right.asObservable())// Â∞ÜÊñ∞ÁöÑ‰∫ã‰ª∂Â∫èÂàóÁöÑÂÖÉÁ¥†ÂêàÂπ∂ÔºåËøîÂõû‰∏Ä‰∏™Êñ∞ÁöÑ‰∫ã‰ª∂Â∫èÂàólet observable = source.merge()observable.subscribe&#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) Ê≥®ÊÑèÔºåÂè™ÊúâÂΩìÂÜÖÈÉ®ÁöÑÊó∂Èó¥Â∫èÂàóÈÉΩ completed ÂêéÔºåmerge ‰∫ßÁîüÁöÑ‰∫ã‰ª∂Â∫èÂàóÊâç‰ºö completed„ÄÇ ÂÖ≥ËÅîÂÖÉÁ¥†combineLatestÂΩì combineLatest ‰∏≠ÁöÑÂ≠êÂ∫èÂàó‰∏≠ÁöÑ‰ªªÊÑè‰∏Ä‰∏™ÂèëÂá∫‰∫ã‰ª∂ÁöÑÊó∂ÂÄôÔºåÂ∞Ü‰ºöË∞ÉÁî®‰∏Ä‰∏™‰Ω†Êèê‰æõÁöÑÈó≠ÂåÖ„ÄÇËøô‰∏™Èó≠ÂåÖÂ∞ÜÂ≠êÂ∫èÂàóÁöÑÊúÄËøëÁöÑ‰∫ã‰ª∂ÂÄº‰Ωú‰∏∫ÂÖ•ÂèÇ‰º†ÂÖ•ÔºåÂæóÂà∞ÁöÑËøîÂõûÂÄº‰Ωú‰∏∫‰∫ã‰ª∂ÂÄºÊâßË°åËÆ¢ÈòÖÁöÑÊñπÊ≥ï„ÄÇ‰∏ªË¶ÅÁî®Âú®ÂêåÊó∂ÁõëÊéßÂ§ö‰∏™Ê∫êÁöÑÁä∂ÊÄÅ„ÄÇ ‰∏äÈù¢ÂõæÁ§∫‰∏≠ÔºåÂΩì‰∫ã‰ª∂ 1 Ëß¶ÂèëÁöÑÊó∂ÂÄôÔºåÁî±‰∫éÂè¶Â§ñ‰∏Ä‰∏™Â∫èÂàóÊ≤°Êúâ‰∫ã‰ª∂ÂèëÁîüËøáÔºåÊâÄ‰ª•‰∏çËß¶ÂèëËÆ¢ÈòÖÔºåÁõ¥Âà∞ÈÇ£‰∏Ä‰∏™Â∫èÂàóÂèëÁîü‰∫Ü‰∫ã‰ª∂ 4ÔºåÊâçËß¶Âèë‰∫ÜËÆ¢ÈòÖ„ÄÇ ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789let left = PublishSubject&lt;String&gt;()let right = PublishSubject&lt;String&gt;()let observable = Observable.combineLatest(left, right, resultSelector: &#123; lastLeft, lastRight in "\(lastLeft) \(lastRight)"&#125;)observable.subscribe(onNext: &#123; value in print(value) &#125;).addDisposableTo(bag) Âè¶Â§ñÈúÄË¶ÅËØ¥ÊòéÁöÑÂ∞±ÊòØÂè™Êúâ‰∏§‰∏™Â≠êÂ∫èÂàóÈÉΩ completedÔºåÂ§ñÈÉ®Â∫èÂàóÊâç‰ºö completed„ÄÇÂ¶ÇÊûúÂÖ∂‰∏≠‰∏Ä‰∏™Â≠êÂ∫èÂàóÂÖàÁªìÊùü‰∫ÜÔºåÂΩìÂè¶Â§ñ‰∏Ä‰∏™Â∫èÂàóËß¶Âèë‰∫ã‰ª∂ÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®ÁöÑÊòØÁªìÊùüÁöÑÈÇ£‰∏™Â≠êÂ∫èÂàóÁªìÊùüÂâçÊúÄÂêé‰∏ÄÊ¨°‰∫ã‰ª∂ÁöÑ‰∫ã‰ª∂ÂÄº„ÄÇÂÖ∂ÂÆû‰∏äÈù¢ÁöÑÂõæ‰∏≠‰πüÊúâÂ±ïÁ§∫Ôºåright ÂÖàÁªìÊùü‰∫ÜÔºåÊ≠§Êó∂left Ëß¶Âèë‰∫Ü‰∫ã‰ª∂ 3ÔºåÊâÄ‰ª•ÊúÄÁªàÊòØÂ∞Ü 3Ôºå6 ÁöÑÂÄº‰Ωú‰∏∫‰∫ã‰ª∂ÂÄºÁöÑ„ÄÇ zipÂíå‰∏äÈù¢ÁöÑ combineLatest ‰∏çÂêåÔºåzip Ë¶ÅÊ±ÇÂøÖÈ°ªÊØè‰∏™Â≠êÂ∫èÂàóÈÉΩÊúâÊñ∞Ê∂àÊÅØÁöÑÊó∂ÂÄôÔºåÊâçËß¶Âèë‰∫ã‰ª∂Ôºö ÂèØ‰ª•ÁúãÂà∞Ôºåleft Âíå right ÈÉΩÂøÖÈ°ªÊúâÊñ∞ÁöÑÊ∂àÊÅØÊúÄÁªàÊâçËÉΩ‰∫ßÁîü‰∫ã‰ª∂„ÄÇÁî±‰∫é right Â∑≤ÁªèÁªìÊùü‰∫ÜÔºåÊâÄ‰ª• sunny Ê∞∏Ëøú‰∏ç‰ºöÊé•Êî∂Âà∞„ÄÇ ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789let left = PublishSubject&lt;String&gt;()let right = PublishSubject&lt;String&gt;()let observable = Observable.zip(left, right) &#123; lastLeft, lastRight in "\(lastLeft) \(lastRight)"&#125;)observable.subscribe(onNext: &#123; value in print(value) &#125;).addDisposableTo(bag) ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåzip ‰∏çÈúÄË¶ÅÊâÄÊúâÂÜÖÈÉ®Â∫èÂàóÈÉΩÂÆåÊàêÔºåÂè™Ë¶ÅÊúâ‰∏Ä‰∏™ completedÔºåÊï¥‰∏™‰∫ã‰ª∂Â∫èÂàóÂ∞±ÁªìÊùü‰∫Ü„ÄÇ (Á°ÆÂÆûËøô‰∏™Êå∫ÂÉèÊãâÈìæÁöÑÔºåÂêçÂ≠óËµ∑ÂæóÂæàÂΩ¢Ë±°) Ëß¶ÂèëÂô®withLatestFromÂΩì‰∏Ä‰∏™ Observable Ëß¶ÂèëÁöÑÊó∂ÂÄôÔºåËé∑ÂèñÂè¶‰∏Ä‰∏™ Observable ÁöÑÊúÄÊñ∞ÁöÑ‰∫ã‰ª∂ÂÄº„ÄÇÂæàÂ∏∏Áî®ÔºåÊØîÂ¶ÇÁÇπÂáªÊåâÈíÆÁöÑÊó∂ÂÄôË¶ÅËé∑Âèñ textfield ÁöÑÊúÄÊñ∞ÂÄºÔºö text ‰∏çÁÆ°ÊÄé‰πà‰øÆÊîπÔºåÂΩì button ÁÇπÂáªÁöÑÊó∂ÂÄôÔºåÈÉΩËé∑ÂæóÊúÄÊñ∞ÁöÑ text ÁöÑÂÄº„ÄÇ ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456let button = PublishSubject&lt;Void&gt;()let textField = PublishSubject&lt;String&gt;()button.WithLatestFrom(textField) .subScribe &#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) simpleËß¶ÂèëÊüê‰∏™ Observable Ëé∑ÂèñÂè¶‰∏Ä‰∏™ Observable ÁöÑÊúÄÊñ∞ÂÄº„ÄÇ‰ΩÜÊòØÂíå withLatestFrom ‰∏çÂêåÁöÑÊòØÔºåÂΩìÂÜçÊ¨°Ëß¶ÂèëËøô‰∏™ Observable ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÂè¶‰∏Ä‰∏™ Observable Ê≤°ÊúâÊõ¥Êñ∞ÂÄºÔºåÈÇ£‰πà‰∏ç‰ºöËß¶Âèë‰∫ã‰ª∂ÔºåÁ±ª‰ºº‰∫é distinctUntilChangedÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1let Observable = textField.sample(button) ‰∏ÄÂÆöË¶ÅÊ≥®ÊÑèËøôÈáåÂïäÔºåÂâçÈù¢ÊòØ button.withLatestFrom(textField)ÔºåËøôÈáåÊòØ textField.sample(button)„ÄÇ ÂºÄÂÖ≥ambÂΩì‰∏§‰∏™ Observable ‰∏≠ÁöÑ‰ªªÊÑè‰∏Ä‰∏™Ëß¶ÂèëÁöÑÊó∂ÂÄôÔºåÂèñÊ∂àËÆ¢ÈòÖÂè¶‰∏Ä‰∏™Ôºå‰ª•ÂêéÂè™Êé•ÂèóÂΩìÂâç Observable ÁöÑ‰∫ã‰ª∂„ÄÇÂ¶ÇÂõæÊâÄÁ§∫ÔºåÁî±‰∫é right ÂÖàÂá∫Ê≥ïÔºåÊâÄ‰ª•Â∞±ÂèñÊ∂à‰∫Ü left ÁöÑËÆ¢ÈòÖÔºå‰ª•ÂêéÂ∞±Âè™ËÉΩÊé•Êî∂Âà∞ right ÁöÑ‰∫ã‰ª∂‰∫ÜÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456let left = PublishSubject&lt;String&gt;()let right = PublishSubject&lt;String&gt;()left.amb(right) .subscribe &#123; print($0.element ?? $0) &#125; .addDisposableTo(bag) switchLatestÂâçÈù¢ÈÇ£‰∏™ÊòØË¢´Âä®ÁöÑÂì™‰∏™ Observable ÊúÄÂÖàËß¶ÂèëÂ∞±‰∏ÄÁõ¥ËÆ¢ÈòÖÂì™‰∏Ä‰∏™„ÄÇËøô‰∏™ÊòØÂèØ‰ª•Ëá™Â∑±ÊéßÂà∂ÂΩìÂâçÊÉ≥Ë¶ÅËÆ¢ÈòÖÈÇ£‰∏™ ObservableÔºö Â¶ÇÂõæÊâÄÁ§∫Ôºåsource Âú®ÈÄâÊã© one ÁöÑÊó∂ÂÄôÔºåÂè™Êé•Âèó one ÁöÑ‰∫ã‰ª∂ÔºåÂú®ÈÄâÊã© two ÁöÑÊó∂ÂÄôÔºåÂè™Êé•Âèó two ÁöÑ‰∫ã‰ª∂„ÄÇ 1234567891011121314151617let one = PublishSubject&lt;String&gt;()let two = PublishSubject&lt;String&gt;()let three = PublishSubject&lt;String&gt;()// source ÁöÑ‰∫ã‰ª∂ÂÄºÁ±ªÂûãÊòØ Observable Á±ªÂûãlet source = PublishSubject&lt;Observable&lt;String&gt;&gt;()let observable = source.switchLatest()let disposable = observable.subscribe(onNext: &#123; value in print(value) &#125;)// ÈÄâÊã©Observable onesource.onNext(one)one.onNext("emit") // emittwo.onNext("emit") // Ê≤°Êúâ emit// ÈÄâÊã©Observable twosource.onNext(two)two.onNext("emit") // emit ËøòËÆ∞Âæó flatMapLatest ÂêóÔºü‰πãÂâçËØ¥Ëøá flatMapLatestÔºåÂ∞±ÊòØ map + switchLatest ÂÖÉÁ¥†ÂíåÂ∫èÂàóÁöÑÁªìÂêàreduceRx ‰∏≠ÁöÑ reduce Á±ª‰ºº‰∫é Swift ‰∏≠ÁöÑ reduceÔºåÂ∞Ü‰∏Ä‰∏™Â∫èÂàóÁöÑÊâÄÊúâ‰∫ã‰ª∂ÂÄºÈÄöËøáËøêÁÆóÔºåÂæóÂà∞‰∏Ä‰∏™ÊúÄÁªàÁöÑ‰∫ã‰ª∂ÂÄºÔºåÂπ∂Ëß¶Âèë‰∫ã‰ª∂Ôºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345Observable.of(1, 2, 3) .reduce(0) &#123; summary, newValue in return summary + newValue &#125;.subscribe &#123; print($0.element &amp;&amp; $0) &#125; .addDeposiableAt(bag) scanscan Âíå reduce ÁöÑ‰∏çÂêåÂú®‰∫éÔºåreduce ÊòØ‰∏ÄÈî§Â≠ê‰π∞ÂçñÔºåscan ÊØèÊ¨°Êé•Êî∂Âà∞‰∫ã‰ª∂ÂÄºÊó∂ÈÉΩ‰ºöËß¶Âèë‰∏Ä‰∏™‰∫ã‰ª∂Ôºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234Observable.of(1, 2, 3) .scan(0, accumulator: +) .subscribe(onNext: &#123; value in print(value) &#125;) .addDeposiableTo(bag) Âü∫‰∫éÊó∂Èó¥ÁöÑÊìç‰ΩúÁ¨¶ÁºìÂ≠òÊìç‰ΩúÁ¨¶replayËøô‰∏™Êìç‰ΩúÁ¨¶ÊòØÈíàÂØπ‰∏Ä‰∏™ ObservableÔºåÂ§ö‰∏™ËÆ¢ÈòÖËÄÖÁöÑ„ÄÇ‰∏∫ Observable ËÆæÁΩÆ replay ÔºåÂΩìÊúâÊñ∞ÁöÑËÆ¢ÈòÖËÄÖËÆ¢ÈòÖÁöÑÊó∂ÂÄôÔºå‰ºöÁ´ãÂç≥Ëß¶ÂèëÊúÄËøëÁöÑÂá†‰∏™‰∫ã‰ª∂Ôºö ‰∏äÈù¢ÁöÑÊòØ ObservableÔºåÊØèÈöî 1s ÂèëÂá∫‰∏ÄÊ¨°‰∫ã‰ª∂„ÄÇ‰∏ãÈù¢ÊòØ‰∏Ä‰∏™ËÆ¢ÈòÖËÄÖÔºåÂú®Á¨¨ 4s ÁöÑÊó∂ÂÄôÂºÄÂßãËÆ¢ÈòÖ„ÄÇÁî±‰∫éËÆæÁΩÆ‰∫Ü replay ÁöÑÊï∞Èáè‰∏∫ 1ÔºåÊâÄ‰ª•Á´ãÂàªÈáçÁé∞‰πãÂâçÁöÑ‰∫ã‰ª∂ 3ÔºåÂÜçÂä†‰∏äÂΩìÂâç‰∫ã‰ª∂ 4 ÁöÑËß¶ÂèëÔºåÊâÄ‰ª•ÂÜçÊó∂Âàª 4ÔºåÊúâ‰∏§‰∏™‰∫ã‰ª∂‰∏ÄËµ∑Ëß¶Âèë‰∫Ü„ÄÇ ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910let interval = Observable&lt;Int&gt;.interval(1, scheduler:MainScheduler.instance).replay(1)_ = interval.connect()delay(3) &#123; _ = interval.subscribe(onNext: &#123; print("Subscriber 2: Event - \($0) at \(stamp())") &#125;)&#125; ËøôÁßç‰∏Ä‰∏™ ObservableÔºåÂ§ö‰∏™ËÆ¢ÈòÖËÄÖÁöÑÊÉÖÂÜµÂè´ÂÅöÂèØËøûÊé• ObservableÔºå‰∏ÄËà¨ÁöÑ Observable Á±ªÂûã‰∏∫ Observable&lt;E&gt;ÔºåËøôÁßçÁ±ªÂûã‰∏∫ ConnectableObservable&lt;E&gt;„ÄÇÊâÄ‰ª•ÈúÄË¶Å‰ΩøÁî® .connect ÊñπÊ≥ïÊù•Ë°®Á§∫ Observable ÂºÄÂßãËøêË°å„ÄÇ Â¶ÇÊûúË¶ÅÊâÄÊúâÂÖÉÁ¥†ÈÉΩÈáçÁé∞ÔºåÈÇ£‰πàÂèØ‰ª•‰ΩøÁî® .replayAll() bufferbuffer Áî®‰∫éÂ∞Ü‰∫ã‰ª∂ÁºìÂ≠òÔºåÂú®Êüê‰∏™Êù°‰ª∂‰∏ãÔºå‰∏ÄÂπ∂ÂèëÂá∫„ÄÇbuffer(timeSpan:count:scheduler:) Êé•Âèó‰∏Ä‰∏™ÊúÄÂ§ßÊó∂Èó¥Ë∑®Â∫¶ timeSpanÔºå‰∏Ä‰∏™‰∫ã‰ª∂ÊúÄÂ§ßÂèëÁîüÊï∞Èáè count„ÄÇÂ§ÑÁêÜÈÄªËæëÂú®‰∫éÔºåÂΩìÊúÄÂ§ßÊó∂Èó¥Ë∑®Â∫¶ÂÜÖ‰∫ã‰ª∂Êï∞ÈáèÊ≤°ÊúâÂà∞Êó∂ÔºåÂèëÈÄÅ‰∏Ä‰∏™‰∫ã‰ª∂ÔºåÂÖ∂‰∫ã‰ª∂ÂÄº‰∏∫ÂΩìÂâç‰∫ã‰ª∂Ë∑®Â∫¶ÂÜÖÂèëÂá∫ÁöÑÊó∂Èó¥ÁöÑ‰∫ã‰ª∂ÂÄºÁªÑÊàêÁöÑÊï∞ÁªÑÔºåÈáçÁΩÆÊó∂Èó¥Ë∑®Â∫¶ÔºõÂΩìÊó∂Èó¥Ë∑®Â∫¶ÂÜÖÂèëÁîüÁöÑ‰∫ã‰ª∂Ë∂ÖËøá‰∫ÜÊúÄÂ§ßÂèëÁîüÊï∞ÈáèÊó∂ÔºåÁ´ãÂç≥ÂèëÈÄÅ‰∏Ä‰∏™‰∫ã‰ª∂ÂÄº‰∏∫Ëøô‰∫õ‰∫ã‰ª∂ÂÄºÊâÄÁªÑÊàêÁöÑÊï∞ÁªÑÁöÑ‰∫ã‰ª∂ÔºåÈáçÁΩÆÊó∂Èó¥Ë∑®Â∫¶Ôºö Â¶ÇÂõæÔºåÊó∂Èó¥Ë∑®Â∫¶‰∏∫4ÔºåÊúÄÂ§ß‰∫ã‰ª∂ÂÄº‰∏∫2„ÄÇÊúÄÂºÄÂßã‰ªÄ‰πàÊó∂Èó¥‰πüÊ≤°ÊúâÂèëÁîüÔºåÊâÄ‰ª•ÂèëÈÄÅ‰∏Ä‰∏™ 0 ‰∏™ÂÖÉÁ¥†ÁöÑÊï∞ÁªÑ„ÄÇ‰πãÂêéÊüê‰∏™Êó∂ÂàªÂèëÂá∫‰∫Ü‰∏â‰∏™‰∫ã‰ª∂ÔºåÊâÄ‰ª•Â∞ÜÂâç‰∏§‰∏™‰∫ã‰ª∂ÂÄºÂêàÊàê‰∏∫‰∏Ä‰∏™Êï∞ÁªÑÂèëÈÄÅÔºåÂâ©‰Ωô‰∏Ä‰∏™‰∫ã‰ª∂ÔºåÈáçÁΩÆÊó∂Èó¥Ë∑®Â∫¶„ÄÇÂêéÈù¢‰∫ã‰ª∂Êï∞ÈáèÊ≤°ÊúâÂà∞ÊúÄÂ§ßÂÄºÔºå‰ΩÜÊòØÊó∂Èó¥Ë∑®Â∫¶Âà∞‰∫ÜÔºåÊâÄ‰ª•‰πüÂèëÈÄÅ‰∏Ä‰∏™‰∫ã‰ª∂ÁöÑÊï∞ÁªÑÔºåÈáçÁΩÆÊó∂Èó¥Ë∑®Â∫¶„ÄÇÊúÄÂêéÂèàÊ≤°Êúâ‰∫ã‰ª∂ÂèëÁîüÔºåÂèëÈÄÅ 0 ‰∏™ÂÖÉÁ¥†ÁöÑÊï∞ÁªÑÁöÑ‰∫ã‰ª∂„ÄÇ 12345678let interval = Observable&lt;String&gt;.interval(1, scheduler: MainScheduler.instance) .buffer(timeSpan: 4, count: 2, scheduler: MainScheduler.instance)_ = interval.subscribe(onNext: $0)interval.onNext("üêà")interval.onNext("üêà")interval.onNext("üêà") Êó∂Èó¥Âπ≥ÁßªÊìç‰ΩúÁ¨¶delaySubscriptionÂª∂ËøüËÆ¢ÈòÖÔºåÂú®Ê≠£ÂºèËÆ¢ÈòÖÂâçÂèëÁîüÁöÑ‰∫ã‰ª∂ÈÉΩ‰ºöË¢´ÂøΩÁï•Ôºö Â¶ÇÂõæÔºåÂú® 1 Êó∂ÂàªÂºÄÂßãËÆ¢ÈòÖÔºåÁî±‰∫éÂª∂Ëøü‰∫Ü 1.5sÔºåÊâÄ‰ª•Ââç‰∏§‰∏™‰∫ã‰ª∂Ë¢´ÂøΩÁï•‰∫Ü„ÄÇ 123Observable.of(1, 2, 3, 4, 5) .delaySubscription(RxTimeInterval(delayInSeconds), scheduler: MainSchedular.instance) .subscribe&#123; print($0.element ?? $0) &#125; delaydelay ÂàôÂ∞ÜÂ∫èÂàó‰∏≠ÁöÑÊâÄÊúâ‰∫ã‰ª∂Âª∂ËøüÊâßË°åÔºåÊâÄ‰ª•Âπ∂‰∏ç‰ºöÂøΩÁï•Êéâ‰∫ã‰ª∂Ôºö Â∑ÆÂà´Â∞±Âú®‰∫éÔºå‰∏äÈù¢ÁöÑÂøΩÁï•‰∫Ü1Ôºå2ÔºåËÄåËøôÈáåÂàô‰ªçÊòØ‰ªé‰∫ã‰ª∂ 1 ÂºÄÂßã„ÄÇ 123Observable.of(1, 2, 3, 4, 5) .delay(RxTimeInterval(delayInSeconds), scheduler: MainSchedular.instance) .subscribe&#123; print($0.element ?? $0) &#125; ÂÆöÊó∂Êìç‰ΩúÁ¨¶intervalRx ‰∏≠ÁöÑÂÆöÊó∂‰∏çÈúÄË¶Å‰ΩøÁî® NSTimerÔºå‰πü‰∏çÈúÄË¶Å‰ΩøÁî® DispatchSource„ÄÇinterval ÁöÑ‰ΩøÁî®ÈùûÂ∏∏ÁÆÄÂçïÔºåÊØîÂ¶Ç‰∏Ä‰∏™1sÁöÑÂÆöÊó∂Âô®Ôºö 1Observable&lt;Int&gt;.interval(1, scheduler: MainScheduler.instance) ‰∫ã‰ª∂ÂÄºÈªòËÆ§ÊòØ‰ªé 0 ÂºÄÂßãÂèëÈÄÅÔºå‰æùÊ¨°ÈÄíÂ¢û„ÄÇÂ¶ÇÊûú‰Ω†‰∏çÊÉ≥Ë¶Å‰ªé 0 ÂºÄÂßãÔºåÂèØ‰ª•‰ΩøÁî® map„ÄÇ‰∏çËøá‰∏ÄËà¨Êàë‰ª¨‰∏çÈúÄË¶Å‰ΩøÁî®Ëøô‰∏™‰∫ã‰ª∂ÂÄº„ÄÇ timertimer(_:period:scheduler:) Âíå interval ÁöÑÂå∫Âà´Âú®‰∫éÔºåÂèØ‰ª•ËÆæÁΩÆ‰∏Ä‰∏™ÈáçÂ§çÊ¨°Êï∞ period„ÄÇÂ¶ÇÊûú‰∏çËÆæÁΩÆÔºåÈªòËÆ§Âè™ÊâßË°å‰∏ÄÊ¨°Ôºö 1Observable&lt;Int&gt;.timer(3, period:3, scheduler: MainScheduler.instance)]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
        <tag>RxSwift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[„ÄäSwift ÊäÄÂ∑ß„ÄãÁ¨îËÆ∞]]></title>
    <url>%2F2017%2F10%2F20%2FSwift%20%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[‰∏§Â§©ËØªÂÆå‰∫ÜËøôÊú¨‰π¶ÔºåÂπ≤Ë¥ßÊª°Êª° Swift Êñ∞ÂÖÉÁ¥†ÊüØÈáåÂåñÂéüÊú¨‰∏Ä‰∏™ÂáΩÊï∞Ë¶ÅÊé•Êî∂‰∏§‰∏™ÂèÇÊï∞Ôºå‰ΩÜÊòØÈÄöËøáÁßëÈáåÂåñÂ∞±‰∏çÈúÄË¶Å‰∫ÜÔºåÂÖà‰º†ÂÖ•‰∏Ä‰∏™ÂèÇÊï∞ÔºåÁÑ∂ÂêéËøîÂõû‰∏Ä‰∏™ÂåÖÂê´Ëøô‰∏™ÂèÇÊï∞ÁöÑÈó≠ÂåÖÔºåÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÂÜç‰º†ÂÖ•‰ªªÊÑèÁöÑÂèÇÊï∞‰∫Ü„ÄÇ Â∞Ü protocol ÊñπÊ≥ïÂ£∞Êòé‰∏∫ mutatingstruct Âíå enum ÁöÑÊñπÊ≥ïÈúÄË¶Å‰ΩøÁî® mutating Ê†áËÆ∞ÔºåÂê¶ÂàôÊó†Ê≥ïÈÄöËøáÁºñËØë„ÄÇÂπ∂‰∏îËøô‰∏™Ê†áËÆ∞ÂØπ‰∫é class Á±ªÂûãÊ≤°ÊúâÂΩ±Âìç„ÄÇÊâÄ‰ª•Â∞ΩÈáèÂ∞ÜÂçèËÆÆÊñπÊ≥ïÂ£∞Êòé‰∏∫ mutating SequenceÊâÄ‰ª•ËÉΩÂ§ü for‚Ä¶in ÁöÑÈÉΩÂÆûÁé∞‰∫Ü Sequence ÂçèËÆÆ„ÄÇ‰ºöË∞ÉÁî®Ëøô‰∏™ÂçèËÆÆÁöÑ makeIterator() ÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïËøîÂõû‰ªªÊÑèÂÆûÁé∞‰∫Ü IteratorProtocol ÂçèËÆÆÁöÑÁ±ª„ÄÇÂú®Êûö‰∏æÁöÑÊó∂ÂÄôÔºå‰ºöË∞ÉÁî®ËØ•ÂçèËÆÆÁöÑ next() ÊñπÊ≥ï„ÄÇ ÂÖÉÁªÑÂØπ‰∫é‰∏Ä‰∏™ÈúÄË¶ÅËøîÂõûÂ§ö‰∏™ÂØπË±°ÁöÑÂáΩÊï∞ÔºåÂèØ‰ª•‰ΩøÁî®ÂÖÉÁªÑ„ÄÇ @autoclosureÂ¶ÇÊûú‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÂÖ•ÂèÇÊòØ‰∏Ä‰∏™Èó≠ÂåÖÔºåÂπ∂‰∏îÂè™Êúâ‰∏ÄÂè•‰∏îÈó≠ÂåÖÁ±ªÂûã‰∏∫ () -&gt; TÔºåÈÇ£‰πàÂèØ‰ª•Âú®ÂáΩÊï∞Â£∞ÊòéÊó∂ÔºåÂú®ÂáΩÊï∞Á±ªÂûãÂâçÂä†‰∏ä @autoclosure Ê†áËÆ∞ÔºåÂ∞±ÂèØ‰ª•ÁúÅÁï• {} ‰∏Ä‰∏™ÁñëÈóÆÔºö‰∏∫‰ªÄ‰πàË¶ÅÁî® @autoclosure ËÄå‰∏çÁõ¥Êé•‰º†Ëøô‰∏™‰∏ÄÂè•Èó≠ÂåÖÁöÑÁªìÊûúÂë¢ÔºüÂõ†‰∏∫Ëøô‰∏™Èó≠ÂåÖ‰∏ç‰∏ÄÂÆö‰ºöÊâßË°åÔºåÂ¶ÇÊûúÁõ¥Êé•‰º†ÁªìÊûúÔºå‰ºöÈÄ†ÊàêÊÄßËÉΩÊçüËÄó„ÄÇ @escapingÂ¶ÇÊûú‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÂÖ•ÂèÇ‰∏≠ÂåÖÂê´‰∏Ä‰∏™Èó≠ÂåÖÔºå‰∏îËøô‰∏™Èó≠ÂåÖÂ∞Ü‰ºöË¢´‰øùÂ≠òÔºåÈÇ£‰πàÈúÄË¶ÅÂ∞ÜËøô‰∏™Èó≠ÂåÖÊ†áËÆ∞‰∏∫ @escaping„ÄÇ ÂÖ∂‰∏≠ÊâÄÊúâÁöÑ self ÁöÑÂ±ûÊÄßÈÉΩÈúÄË¶ÅÂÜôÊòéÔºåÂπ∂‰∏îË¶ÅÊ≥®ÊÑèÈúÄË¶ÅÊâìÁ†¥ÂºïÁî®Âæ™ÁéØ„ÄÇ Optional ChainingÂèØÈÄâÈìæ‰∏äÔºåÂç≥‰ΩøÂ∑¶ÂêéËÆøÈóÆÁöÑÊòØ‰∏Ä‰∏™ÈùûÂèØÈÄâÁöÑÂÄºÔºå‰ΩÜÊòØÊàë‰ª¨ÊãøÂà∞ÁöÑ‰ªçÁÑ∂ÊòØ‰∏Ä‰∏™ÂèØÈÄâÂÄº„ÄÇÂ¶Ç‰∏ãÔºåÂç≥‰Ωø name ÊòØÈùûÂèØÈÄâÔºåtoyName ‰ªçÁÑ∂ÊòØÂèØÈÄâÁöÑÔºö1let toyName = xiaoming.pet?.toy?.name Âè¶Â§ñËøòÊúâ‰∏Ä‰∏™Ê≥®ÊÑèÁÇπÔºåÊØîÂ¶Ç‰∏ãÈù¢ÁöÑ‰æãÂ≠êÔºö123let playClosure = &#123;(child: Child) -&gt; ()? in child.pet?.toy?.play()&#125; Áî±‰∫éÂè™Êúâ‰∏ÄÂè•ÔºåÈÇ£‰πàÁºñËØëÂô®ÈªòËÆ§ÁúÅÁï•‰∫Ü returnÔºåÁî±‰∫é play() ËøîÂõû voidÔºåÂèàÂõ†‰∏∫ÊòØÂèØÈÄâÈìæÔºåÊâÄ‰ª•ÊúÄÁªàËøô‰∏™Èó≠ÂåÖËøîÂõûÁöÑÊòØÂèØÈÄâÁöÑVoidÔºåÂç≥ VoidÔºü Êìç‰ΩúÁ¨¶ÂèØ‰ª•ÂØπÊìç‰ΩúÁ¨¶ËøõË°åÈáçËΩΩÔºö123func +(left: Vector2D, right: Vector2D) -&gt; Vector2D &#123; return Vector2D(x: left.x + right.x, y: left.y +right.y)&#125; ÂàõÂª∫Êñ∞ÁöÑÊìç‰ΩúÁ¨¶Ë¶ÅÂÖàÂØπÊìç‰ΩúÁ¨¶ËøõË°åÂ£∞ÊòéÔºåÁî®ÁöÑ‰∏çÂ§öÔºåÊöÇ‰∏î‰∏çË°®„ÄÇ func ÁöÑÂèÇÊï∞‰øÆÈ•∞ÂèØ‰ª•Âú®ÂÖ•ÂèÇÁ±ªÂûãÂâçÂä†‰∏ä inout Ê†áËÆ∞ÔºåÁõ∏ÂΩì‰∫éÂú®ÂáΩÊï∞ÂÜÖÈÉ®ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÂÄºÔºåÁÑ∂ÂêéÂú®ÂáΩÊï∞ËøîÂõûÊó∂Â∞ÜËøô‰∏™ÂÄºËµãÁªô &amp; ‰øÆÈ•∞ÁöÑÂèòÈáè ‰∏ãÊ†á‰∏ãÊ†áÂ∞±ÂÉèÊòØËÆ°ÁÆóÂûãÂ±ûÊÄßÂíåÂáΩÊï∞ÁöÑÁªìÂêàÔºåÈúÄË¶Å‰∏Ä‰∏™ÂÖ•ÂèÇÂíåÂá∫ÂèÇÁöÑÂ£∞ÊòéÔºåÂπ∂‰∏îËøòË¶ÅÊèê‰æõ get„ÄÅset ÊñπÊ≥ï„ÄÇ ÊñπÊ≥ïÂµåÂ•ó‰∏Ä‰∏™ÊñπÊ≥ïÂ§™ÈïøÔºå‰∏∫‰∫ÜÊòéÁ°ÆËÅåË¥£ÔºåÊàë‰ª¨‰∏ÄËà¨Â∞ÜÂÖ∂ÂàáÂàÜÊàêÂ§ö‰∏™Â∞èÁöÑÊñπÊ≥ïÔºå‰ΩÜÊòØËøô‰∫õÂ∞èÁöÑÊñπÊ≥ï‰∏ÄËà¨Âè™‰ºöË∞ÉÁî®‰∏ÄÊ¨°ÔºåÂπ≥Èì∫Ëøô‰∫õÊñπÊ≥ïÂπ∂‰∏çÊòØÊúÄ‰ºòÂäûÊ≥ï„ÄÇÊâÄ‰ª•ÂèØ‰ª•Â∞ÜËøô‰∫õÊñπÊ≥ïÂµåÂ•óÂú®ÂéüÊñπÊ≥ïÂÜÖÔºåËøôÊ†∑Êó¢ËÉΩÊòéÁ°ÆËÅåË¥£ÔºåÂèà‰∏ç‰ºöÂá∫Áé∞ÂæàÂ§öÊñπÊ≥ï„ÄÇ ÂëΩÂêçÁ©∫Èó¥Swift ÁöÑÂëΩÂêçÁ©∫Èó¥ÊòØ‰ª• target ‰Ωú‰∏∫Âå∫ÂàÜÁöÑ„ÄÇÂ¶ÇÊûúÈáçÂêçÔºåË¶ÅÂú®Á±ªÂûãÂêçÁß∞ÂâçÈù¢Âä†‰∏ä target Âêç„ÄÇ Â¶ÇÊûúÊòØÂêå‰∏Ä target ÂÜÖÁöÑÂêåÂêçÔºåÈÇ£‰πàÂèØ‰ª•‰ΩøÁî® struct Â∞ÜÁ±ªÂûãÂåÖË£π„ÄÇ typealias‰∏∫Â∑≤ÊúâÁ±ªÂûãÊ∑ªÂä†‰∏Ä‰∏™Âà´ÂêçÔºåÂ¢ûÂä†‰ª£Á†ÅÁöÑÂèØËØªÊÄß„ÄÇ‰∏ªË¶ÅÁî®Âú®ÂçèËÆÆÁöÑÂÖ≥ËÅîÁ±ªÂûã‰∏ä„ÄÇÂú®ÂÆûÁé∞ÂçèËÆÆÁöÑÁ±ª‰∏≠Ôºå‰∏∫ÂçèËÆÆÁöÑÂÖ≥ËÅîÁ±ªÂûãÊåáÂÆöÂÖ∑‰ΩìÁöÑÁ±ªÂûã„ÄÇ Â¶ÇÊûúÁ±ªÂûãÂ≠òÂú®Ê≥õÂûãÔºåÂà´ÂêçÂêåÊ†∑ÈúÄË¶ÅÂºïÂÖ•Ôºö1typealias Worker&lt;T&gt; = Person&lt;T&gt; ÂèØ‰ª•‰∏∫ÁªÑÂêàÁ±ªÂûãÂÆûÁé∞Âà´ÂêçÔºö1typealias Pat = Cat &amp; Dog associatedtypeÂú®ÂçèËÆÆ‰∏≠ÂèØ‰ª•‰ΩøÁî® associatedtype ÂÖ≥ÈîÆÂ≠óÊù•ÂÆö‰πâ‰∏Ä‰∏™Âç†‰ΩçÁ¨¶Á±ªÂûãÔºåÈúÄË¶ÅÂÆûÁé∞ÂçèËÆÆÁöÑÁ±ªÈÄöËøá typealias ÊàñËÄÖÁ±ªÂûãÊé®Êñ≠ÔºåÂ∞ÜÂç†‰ΩçÁ¨¶Á±ªÂûãËΩ¨Âåñ‰∏∫‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÁ±ªÂûãÔºö1234567891011protocol Animal &#123; associatedtype F func eat(_ food: F)&#125;struct Tiger: Animal &#123; typealias F = Meat func eat(_ food: Meat) &#123; print("eat \(food) &#125;&#125; Ê≥®ÊÑèÔºåassociatedtype ÂêéÔºåÂ∞±‰∏çËÉΩÂ∞ÜÂçèËÆÆÂΩìÂÅöÁã¨Á´ãÁöÑÁ±ªÂûã‰ΩøÁî®‰∫Ü„ÄÇËøôÊòØÂõ†‰∏∫ Swift ÈúÄË¶ÅÂú®ÁºñËØëÊó∂Á°ÆÂÆöÊâÄÊúâÁ±ªÂûãÔºåÊâÄ‰ª•‰∏çËÉΩÂÆπÂøç‰ΩøÁî®‰∫ÜÁ±ªÂûã‰∏≠ÁöÑ F Ê≤°ÊúâÁ°ÆÂÆö„ÄÇÂ¶ÇÊûú‰∏ÄÂÆöË¶Å‰ΩøÁî®ÔºåÈúÄË¶Å‰ΩøÁî®Ê≥õÂûã„ÄÇÊØîÂ¶Ç‰∏ãÈù¢ÊñπÊ≥ï‰∏≠Êàë‰ª¨Âè™ËÉΩÂú®ÊñπÊ≥ï‰∏≠‰ΩøÁî®Ê≥õÂûã TÔºåÊù•‰ª£Ë°®ÊâÄÊúâÂÆûÁé∞ Animal ÂçèËÆÆÁöÑÁ±ªÂûãÔºåËÄå‰∏çËÉΩÁõ¥Êé•‰ΩøÁî® Animal ‰∫ÜÔºö12func isDangerous&lt;T: Animal&gt;(animal: T) -&gt; Bool &#123;&#125; ÂèØÂèòÂèÇÊï∞ÂáΩÊï∞ÂÜô‰∏Ä‰∏™ÂèØÂèòÂèÇÊï∞ÁöÑÂáΩÊï∞Âè™ÈúÄË¶ÅÂú®Â£∞ÊòéÂèÇÊï∞Êó∂ÂÜçÁ±ªÂûãÂêéÈù¢Âä†‰∏ä ... Âç≥ÂèØ„ÄÇËæìÂÖ•ÁöÑÂèÇÊï∞Â∞ÜÂú®ÂáΩÊï∞‰ΩìÂÜÖÈÉ®Ë¢´ÂΩìÂÅöÊï∞ÁªÑÊù•‰ΩøÁî®„ÄÇ ÂàùÂßãÂåñÊñπÊ≥ïÈ°∫Â∫èSwift ÁöÑÂàùÂßãÂåñÊñπÊ≥ïÈúÄË¶Å‰øùËØÅÁ±ªÂûãÁöÑÊâÄÊúâÂ±ûÊÄßÈÉΩË¢´ÂàùÂßãÂåñ„ÄÇÈúÄË¶ÅÂÖàÂàùÂßãÂåñÂΩìÂâçÁ±ªÂûãÁöÑÊâÄÊúâÂ±ûÊÄßÂêéÔºåÊâçËÉΩË∞ÉÁî® super.init()ÔºåÁÑ∂Âêé‰øÆÊîπÁà∂Á±ªÂ±ûÊÄß„ÄÇÂ¶ÇÊûúÊàë‰ª¨‰∏çÈúÄË¶Å‰øÆÊîπÁà∂Á±ªÂ±ûÊÄßÔºåÈÇ£‰πàÂèØ‰ª•ÁúÅÁï• super ÁöÑË∞ÉÁî®ÔºåÁºñËØëÊó∂‰ºöËá™Âä®Âä†‰∏ä„ÄÇ DesignatedÔºåConvenience Âíå RequiredÂàùÂßãÂåñÊñπÊ≥ïÈÅµÂæ™‰∏§‰∏™ÂéüÂàôÔºö ÂàùÂßãÂåñË∑ØÂæÑÂøÖÈ°ª‰øùËØÅÂØπË±°ÂÆåÂÖ®ÂàùÂßãÂåñ Â≠êÁ±ªÁöÑ designated ÂàùÂßãÂåñÊñπÊ≥ïÂøÖÈ°ªË∞ÉÁî®Áà∂Á±ªÁöÑ designated ÊñπÊ≥ï ÂØπ‰∫éÊüê‰∫õÂ∏åÊúõÂ≠êÁ±ª‰∏≠‰∏ÄÂÆöÂÆûÁé∞ÁöÑ designated ÂàùÂßãÂåñÊñπÊ≥ïÔºåÊàë‰ª¨ÂèØ‰ª•Ê∑ªÂä† required ÂÖ≥ÈîÆÂ≠óÂ∞±Ë°åÈôêÂà∂ÔºåÂº∫Âà∂ÈáçÂÜô„ÄÇ ÂàùÂßãÂåñËøîÂõû nil‰ΩøÁî® init? ÂÆö‰πâÂèØÂ§±Ë¥•ÊñπÊ≥ï static Âíå classÊèèËø∞Á±ªÂûãÊñπÊ≥ïÊàñËÄÖÂ±ûÊÄßÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•‰ΩøÁî®ÂÖ≥ÈîÆÂ≠ó static ÊàñËÄÖ class„ÄÇ‰ΩÜÊòØ class Êúâ‰∏Ä‰∫õÈôêÂà∂Ôºå‰∏çËÉΩÂÜçÊûö‰∏æÂíåÊú∫ÊûÑ‰Ωì‰∏≠‰ΩøÁî®Ôºå‰∏î‰∏çËÉΩÁî®Âú®Á±ªÁ±ªÂûãÁöÑÂ≠òÂÇ®Â±ûÊÄß‰∏ä„ÄÇ ÊâÄ‰ª•ÂÖ∂ÂÆûÊó†ËÆ∫ÊÄé‰πàÊ†∑Ôºå‰ΩøÁî® static Â∞±‰∏ç‰ºöÈîôÔºå‰∏çË¶ÅÊ≤°‰∫ãÁî® class Â§öÁ±ªÂûãÂÆπÂô®ÂÆπÂô®Â≠òÊîæÂ§öÁ±ªÂûãÔºåÂèØ‰ª•‰ΩøÁî® Any Á±ªÂûãÔºå‰ΩÜÊòØËøôÊ†∑‰ºöÂ§±ÂéªÂ±ûÊÄßÁöÑÁâπÊÄß„ÄÇÊàë‰ª¨ÂèØ‰ª•Â∞ÜÂÆπÂô®Â£∞Êòé‰∏∫ÈÉΩÊª°Ë∂≥Êüê‰∏ÄÁßçÂçèËÆÆ„ÄÇ default ÈªòËÆ§ÂèÇÊï∞ÂèØ‰ª•‰∏∫Êüê‰∏Ä‰∏™ÂÖ•ÂèÇÊ∑ªÂä†ÈªòËÆ§ÂÄºÔºåÂè™ÈúÄË¶ÅÂú®Âú®ÂèÇÊï∞Á±ªÂûãÂêéÂä†‰∏äÂÄºÔºåÂΩ¢Â¶Çstr1: String = &quot;Default&quot;„ÄÇË∞ÉÁî®ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÊÉ≥Ë¶Å‰ΩøÁî®ÈªòËÆ§ÂÄºÔºåÂè™Ë¶ÅÂú®Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÁúÅÁï•ÊéâÈÇ£‰∏™ÂèÇÊï∞Âç≥ÂèØ„ÄÇ ‚Ä¶ Âíå ..&lt;Ëøô‰∏§‰∏™Êìç‰ΩúÁ¨¶ÂèØ‰ª•Êé•Âèó Int ËøîÂõû‰∏Ä‰∏™ Range„ÄÇÈô§Ê≠§‰πãÂ§ñÔºåËøòÂèØ‰ª•Êé•Âèó‰ªª‰ΩïÂÆûÁé∞‰∫Ü Comparable ÂçèËÆÆÁöÑËæìÂÖ•ÔºåÊØîÂ¶Ç String„ÄÇ‰∏ã‰æãË°®Á§∫‰∏Ä‰∏™ a-z ÁöÑÂ≠óÊØçËåÉÂõ¥„ÄÇ1let interval = "a"..."z" AnyClassÔºåÂÖÉÁ±ªÂûãÂíå .selfA.Type Ë°®Á§∫ÁöÑÊòØ A Ëøô‰∏™Á±ªÂûãÁöÑÁ±ªÂûã„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá .self ÂèñÂá∫Ôºö1let typeA: A.Type = A.self Swift ‰∏≠ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âà´Âêç AnyClass Ë°®Á§∫‰ªªÊÑèÁ±ªÂûãÁöÑÁ±ªÂûã„ÄÇ1typealias AnyClass = AnyObject.Type Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáËøô‰∏™Á±ªÂûãÁöÑÁ±ªÂûãÊù•Ë∞ÉÁî®Á±ªÂûãÊñπÊ≥ïÔºö12let anyClass: AnyClass = A.self(anyClass as! A.Type).method() ‰∏äÈù¢ÁöÑ‰æãÂ≠êÂíåÁõ¥Êé•‰ΩøÁî® A.method() ÊòØ‰∏Ä‰∏™ÊïàÊûú„ÄÇ‰ΩÜÊòØ‰ΩøÁî®ÂÖÉÁ±ªÂûãÁöÑÂ•ΩÂ§ÑÂ∞±ÊòØÂèØ‰ª•Âä®ÊÄÅÁöÑ‰º†ÈÄíÊüê‰∏™Á±ªÂûãÔºåËÄå‰∏çÊòØÂ¶ÇËøôÈáåÂè™ËÉΩÁî® A Ë∞ÉÁî®„ÄÇ Any Ë°®Á§∫ÊâÄÊúâÁ±ªÂûãÔºåÂåÖÊã¨ classÔºåstructÔºåenumAnyObject ÂÄºË°®Á§∫ classAnyClass Ë°®Á§∫ AnyObject.Type ÂçèËÆÆÂíåÁ±ªÊñπÊ≥ï‰∏≠ÁöÑ SelfÂú®ÂçèËÆÆÂíåÁ±ªÊñπÊ≥ï‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® Self Ë°®Á§∫Ëá™Â∑±ÁöÑÁ±ªÂûãÔºö123protocol IntervalType &#123; func clamp(intervalToClamp: Self) -&gt; Self&#125; Â£∞ÊòéÂçèËÆÆÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Â∏åÊúõÂçèËÆÆ‰∏≠‰ΩøÁî®ÁöÑÁ±ªÂûãÂ∞±ÊòØÂÆûÁé∞Ëøô‰∏™ÂçèËÆÆÊú¨ÁîüÁöÑÁ±ªÂûãÔºåÊâÄ‰ª•‰ΩøÁî® Self„ÄÇ Ëøô‰∏™ Self Ë°®Á§∫Ëá™Ë∫´ÔºåÊàñËÄÖÂ≠êÁ±ª„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨‰∏çËÉΩ‰ΩøÁî®ÊòéÁ°ÆÁöÑÁ±ªÂûãÔºåÊØîÂ¶Ç‰∏ãÈù¢ËøôÊ†∑Â∞±ÊòØÈîôÁöÑÔºö12345// ÈîôËØØÁ§∫‰æãfunc copy() -&gt; Self &#123; let result = MyClass() return result&#125; Êàë‰ª¨ÂàõÂª∫ÁöÑ‰πüÈúÄË¶ÅÊòØ Self Á±ªÂûãÁöÑÔºö12345678// Ê≠£Á°ÆÁ§∫‰æãfunc copy() -&gt; Self &#123; let result = type(of: Self).init() return result&#125;required init() &#123;&#125; Ê≥®ÊÑèÔºåËøôÈáå‰∏ÄÂÆöË¶Å‰∏∫ init() ÊñπÊ≥ïÂä†‰∏ä required ÂÖ≥ÈîÆËØç„ÄÇÂõ†‰∏∫ÂâçÈù¢ËØ¥‰∫Ü Self ÊòØÂΩìÂâçÁ±ªÊàñËÄÖÂ≠êÁ±ªÔºåÊâÄ‰ª•Êàë‰ª¨ÂøÖÈ°ª‰øùËØÅÂ≠êÁ±ª‰πüÂÆûÁé∞‰∫Ü init() ÊñπÊ≥ï„ÄÇÂè¶Â§ñÔºåÊàë‰ª¨ÂèØ‰ª•ÊääÂΩìÂâçÁ±ªÂÆö‰πâ‰∏∫ final ÔºåÂç≥‰∏çÂèØËÉΩÊúâÂ≠êÁ±ªÔºåÈÇ£‰πàÂ∞±‰∏çÈúÄË¶Å required ‰∫Ü„ÄÇ Â±ûÊÄßËßÇÂØüÊàë‰ª¨ÂèØ‰ª•‰∏∫‰∏Ä‰∏™Â≠òÂÇ®ÂûãÂ±ûÊÄßÊ∑ªÂä† willSet Âíå didSet ÂØπÂ±ûÊÄßËøõË°åËßÇÂØü„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® newValue Âíå oldValue Ëé∑ÂèñËÆæÂÆöÂíåÂ∑≤ÁªèËÆæÂÆöÁöÑÂÄº„ÄÇ Â±ûÊÄßËßÇÂØüÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÁöÑ‰ΩúÁî®ÊòØ‰Ωú‰∏∫ËÆæÁΩÆÂÄºÁöÑÈ™åËØÅ„ÄÇ lazy ‰øÆÈ•∞Á¨¶Êàë‰ª¨ÂèØ‰ª•ÂØπ‰∏Ä‰∏™ÂèòÈáè‰ΩøÁî® lazy ÂÖ≥ÈîÆÂ≠óÔºåË°®Á§∫Âª∂ËøüÂä†ËΩΩ„ÄÇÊàë‰ª¨ÂèØ‰ª•ÂØπËøô‰∏™ÂèòÈáèÁõ¥Êé•ËµãÂÄºÔºåÊàñËÄÖ‰ΩøÁî®ÊâßË°å‰∏Ä‰∏™Èó≠ÂåÖ„ÄÇËøô‰ºöÂú®ËØ•ÂèòÈáèÁ¨¨‰∏ÄÊ¨°Ë¢´‰ΩøÁî®Êó∂ÊâßË°å„ÄÇ ÈöêÂºèËß£ÂåÖ OptionalÈöêÂºèËß£ÂåÖ Optional Â∞±ÊòØÂú®ÂèòÈáèÂêéÂä†‰∏ä !ÔºåËææÂà∞ÂΩ¢Âºè‰∏äÁöÑÈùûÂèØÈÄâÁöÑÊïàÊûúÔºå‰ΩÜÊòØÂÆûË¥®‰∏äËøòÊòØÂèØÈÄâÁ±ªÂûã„ÄÇ ÊúÄÂ•ΩÂ∞ëÁî®ÈöêÂºèËß£ÂåÖÔºåÁé∞Âú®ÁöÑ‰∏ÄÁßçÂ∏∏Áî®ÁöÑÂú∫ÊôØÊòØ IBOutletÔºö1@IBOutlet weak var button: UIButton! Â§öÈáç OptionalÂ§öÈáçÂèØÈÄâÂ∞±ÊòØÂèØÈÄâÂèòÈáèÁöÑÂèØÈÄâÔºåÊôÆÈÄöÁöÑÂèØÈÄâÁöÑ‰∏§‰∏™Áä∂ÊÄÅÊòØÊúâÊàñËÄÖÊ≤°ÊúâÔºåÂ§öÈáçÂèØÈÄâÁöÑÁä∂ÊÄÅÊòØÊ≤°ÊúâÊàñËÄÖÂè¶‰∏Ä‰∏™ÂèØÈÄâÂèòÈáèÔºö12var string: String? = ‚ÄúString‚Äùvar another: String?? = string Â¶Ç‰∏äÊâÄÁ§∫Ôºåanother ÁöÑÂÄº‰∏∫‰∏Ä‰∏™ÂèØÈÄâÁ±ªÂûãÔºå Âõ†‰∏∫ÂèØÈÄâÊòØ‰∏Ä‰∏™Êûö‰∏æÁ±ªÂûãÔºåÂàÜ‰∏∫ÊúâÂÄºÂíåÊ≤°ÂÄºÔºåÊâÄ‰ª•ÂèØ‰ª•ÊÉ≥Ë±°Â§öÈáçÂèØÈÄâ‰∫ßÁîüÁöÑÊ†ëÁä∂ÁªìÊûÑ„ÄÇ Optional MapÂØπ‰∫éÂèØÈÄâÁ±ªÂûãÁöÑÈõÜÂêà‰πüÂèØ‰ª•‰ΩøÁî® MapÔºåÂ¶ÇÊûúÂÖÉÁ¥†‰∏ç‰∏∫ nilÔºåÂàôÂØπÂÖÉÁ¥†ÊâßË°å mapÔºåÂ¶ÇÊûúÂÖÉÁ¥†‰∏∫ nilÔºåÂàôÁõ¥Êé•ËøîÂõû nil Protocol ExtensionÂçèËÆÆÁöÑÊãìÂ±ïÂèØ‰ª•ÁªôÂçèËÆÆÊèê‰æõ‰∏Ä‰∏™ÈªòËÆ§ÁöÑÂÆûÁé∞„ÄÇÊàë‰ª¨ÂèØ‰ª•Â§ßËÉÜÁöÑÁî®Âä®ÊÄÅÊ¥æÂèë‰ΩøÁî®ÊúÄÁªàÁöÑÂÆûÁé∞Ôºå‰∏çËÆ∫ÊòØÁ±ª‰∏≠ÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÔºåËøòÊòØÂçèËÆÆ‰∏≠ÁöÑÈªòËÆ§ÂÆûÁé∞„ÄÇËøôÂÖ∂ÂÆûÂèòÁõ∏ÁöÑÔºåÂ∞Ü protocol ‰∏≠ÁöÑÊñπÊ≥ïËÆæÂÆö‰∏∫‰∫Ü optional ‰ΩÜÊòØËøòÂ≠òÂú®‰∏ÄÁßçÊÉÖÂÜµÔºåÂçèËÆÆÊãìÂ±ï‰∏≠ÂÆûÁé∞‰∫ÜÂçèËÆÆ‰∏≠Ê≤°ÊúâÂÆö‰πâÁöÑÊñπÊ≥ï„ÄÇËøô‰∏™ÂçèËÆÆÊ≤°ÊúâËßÑÂÆöËØ•ÊñπÊ≥ïÂøÖÈ°ªË¶ÅÂÆûÁé∞„ÄÇÂΩì‰Ω†ÂçèËÆÆÁöÑÂÆûÁé∞Á±ª‰πüÂÆûÁé∞‰∫ÜËøô‰∏™ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÈÇ£Â∞±Ë¶ÅÁúãË∞ÉÁî®ËØ•ÊñπÊ≥ïÁöÑÊòØ‰ª•ÂçèËÆÆÁöÑÁ±ªÂûãËøòÊòØ‰ª•ÂÆûÁé∞Á±ªÁöÑÁ±ªÂûã‰∫Ü„ÄÇÂ¶ÇÊûú‰ª•ÂçèËÆÆÁ±ªÂûãË∞ÉÁî®ÔºåÈÇ£‰πàË∞ÉÁî®ÂçèËÆÆÊãìÂ±ï‰∏≠ÁöÑÂÆûÁé∞ÔºõÂ¶ÇÊûú‰ª•Á±ªÁ±ªÂûãË∞ÉÁî®ÔºåÈÇ£‰πàË∞ÉÁî®Á±ª‰∏≠ÁöÑÂÆûÁé∞„ÄÇ where ÂíåÊ®°ÂºèÂåπÈÖçwhere ÁöÑ‰ΩøÁî®Âú∫ÊôØËøòÊòØÂæàÂ§öÁöÑÔºåÊÄªÁªì‰∫ÜÂõõÁßçÂú∫ÊôØ„ÄÇÂâç‰∏§ÁßçÂèØ‰ª•‰ª£Êõø ifÔºåÂêé‰∏§ÁßçÁî®Êù•ÈôêÂà∂Ê≥õÂûãÔºö case Êù°‰ª∂‰∏≠ÁöÑÈôêÂÆö for‚Ä¶in Âæ™ÁéØ‰∏≠ÈôêÂà∂Âæ™ÁéØÁöÑÊéâÂÖ• ÈôêÂà∂Ê≥õÂûãÔºåÂΩìÊ≥õÂûã‰∏≠Â≠òÂú®ÂÖ≥ËÅîÁ±ªÂûãÊó∂ÔºåËøòÂèØ‰ª•ÈôêÂà∂ÂÖ≥ËÅîÁ±ªÂûã ÈôêÂà∂ extension ‰∏≠ÁöÑÊ≥õÂûã 12345678910111213141516171819// caseswitch A case let x where x == 5: // for...infor score in n where score &gt; 60 &#123;&#125;// classclass A&lt;T,K&gt;: a where T: t, K: k, T.tType = K.kType: &#123;&#125;// funcfunc method&lt;T&gt;(param: T) where T: s &#123;&#125;// extensionextension A where T: t, K: k, T.tType = K.kType &#123;&#125; indirect ÂíåÂµåÂ•ó enumÂ¶ÇÊûúË¶ÅÂú®Êûö‰∏æÁ±ªÂûã‰∏≠ÂµåÂ•ó‰ΩøÁî®ÂΩìÂâçÁ±ªÂûãÁöÑËØùÔºåÈúÄË¶ÅÂú®Êûö‰∏æÁ±ªÂûãÂâçÂä†‰∏äÂÖ≥ÈîÆÂ≠ó indirect„ÄÇ ‰ªé OC Âà∞ SwiftSelectorOC ‰∏≠‰ΩøÁî® @selector Ëé∑ÂèñÂÖ≥ÈîÆÂ≠óÔºåSwift ‰∏≠‰ΩøÁî® #selector Ëé∑Âèñ‰∏Ä‰∏™ÊñπÊ≥ïÊö¥Èú≤Áªô OC„ÄÇÂú®Ë¶ÅÊö¥Èú≤Áªô OC ÁöÑÊñπÊ≥ïÂâçÈúÄË¶ÅÊ∑ªÂä† @objc ÂÖ≥ÈîÆÂ≠óÔºö12345@objc private func call(to: String)&#123;&#125;let someMethod = #selector(call(to:))NSTimer.scheduledTimerWithTimeInterval(1,target: self. selector: someMethod, userInfo: nil, repeats: true) ÂÆû‰æãÊñπÊ≥ïÁöÑÂä®ÊÄÅË∞ÉÁî®Swift Êèê‰æõ‰∫Ü‰∏ÄÁßçÊñπÊ≥ïÊõø‰ª£Áõ¥Êé•Ë∞ÉÁî®ÂÆû‰æãÊñπÊ≥ï„ÄÇÈÄöËøáÁ±ªÂûãÂÖàÂèñÂá∫Êüê‰∏™ÂÆû‰æãÊñπÊ≥ïÁöÑÁ≠æÂêçÔºåÁÑ∂ÂêéÂÜç‰º†ÈÄíÂÆû‰æãÊãøÂà∞ÂÆû‰æãÈúÄË¶ÅË∞ÉÁî®ÁöÑÊñπÊ≥ïÔºö123let f = MyClass.methodlet object = MyClass()let result = f(object)(1) ÂÖ∂ÂÆûÁ¨¨‰∏ÄÂè•Áõ∏ÂΩì‰∫éÂÅö‰∫Ü‰ª•‰∏ãÁöÑÂ≠óÈù¢ÈáèËΩ¨Êç¢Ôºå‰πüÂ∞±ÊòØÂ∞ÜËøô‰∏™ÊñπÊ≥ïÊîæÂà∞‰∫Ü‰∏Ä‰∏™Èó≠ÂåÖ‰∏≠ÂéªÔºö1let f = &#123; (obj: MyClass) in obj.method &#125; ËøôÁßçÂÜôÊ≥ïÂè™ÈÄÇÁî®‰∫éÂÆû‰æãÊñπÊ≥ïÔºå‰∏çÈÄÇÁî®‰∫éÂ±ûÊÄßÁöÑ getter Âíå setter ÊñπÊ≥ï„ÄÇÂè¶Â§ñÔºåÂ¶ÇÊûúÊúâÂ§ö‰∏™ÂêåÂêç‰ΩÜÊòØÂáΩÊï∞Á≠æÂêç‰∏çÂêåÁöÑÊñπÊ≥ïÔºåÊàñËÄÖ‰∏éÁ±ªÊñπÊ≥ïÂêåÂêçÁöÑËØùÔºåÂèØ‰ª•Âú®Ëé∑ÂæóÊñπÊ≥ïÁ≠æÂêçÁöÑÊó∂ÂÄôÔºåÊòæÁ§∫ÁöÑÂä†‰∏äÁ±ªÂûãÂ£∞ÊòéÔºö123456// ÊúâÂêåÂêçÁ±ªÊñπÊ≥ïÔºåÈÇ£‰πàËé∑ÂèñÁöÑÂ∞±ÊòØÁ±ªÊñπÊ≥ïlet f1 = MyClass.method// Âêåf1ÔºåÂõ†‰∏∫ÊòØÁ±ªÊñπÊ≥ïÔºåÊâÄ‰ª•‰∏çÈúÄË¶Å‰º†ÂÖ•Á±ªÂØπË±°let f2: (Int) -&gt;Int = MyClass.method// ÂÆû‰æãÊñπÊ≥ïÔºåÈúÄË¶Å‰º†ÂÖ•Á±ªÂØπË±°let f3: (MyClass) -&gt; (Int) = MyCLass.method Âçï‰æãSwift ÂèØ‰ª•Êó†Áºù‰ΩøÁî® GCDÔºå‰ΩÜÊòØ Swift3 ‰∏≠ÁßªÈô§‰∫Ü dispatch_once„ÄÇÂèØ‰ª•‰ΩøÁî® Swift ‰∏≠ÊúâÊõ¥ÁÆÄÂçïÁöÑ‰øùËØÅÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÊñπÂºè letÔºö1234class MyClass &#123; static let shared = MyClass() private init() &#123;&#125;&#125; ÊúÄ‰∏ªË¶ÅÁöÑÂ∞±ÊòØÂ∞Ü init ÊñπÊ≥ïÁßÅÊúâÂåñÔºåËøôÊ†∑Â§ñÈÉ®Êó†Ê≥ïË∞ÉÁî® Êù°‰ª∂ÁºñËØëSwift ‰∏≠Ê≤°Êúâ‰∫ÜÂÆèÁöÑÊ¶ÇÂøµÔºå‰∏çËÉΩ‰ΩøÁî® #ifdef Êù•Ê£ÄÊü•Êüê‰∏™Á¨¶Âè∑ÊòØÂê¶ÈÄöËøáÂÆèÁºñËØë„ÄÇ‰ΩÜÊòØÊàë‰ª¨‰ªçÂèØ‰ª•ÈÄöËøá #ifÔºå#elseÔºå#endif Êù•ÊéßÂà∂ÁºñËØëÊµÅÁ®ãÂíåÂÜÖÂÆπ„ÄÇ ‰∏∫‰∫ÜËá™ÂÆö‰πâÁºñËØëÁ¨¶Âè∑ÔºåÊàë‰ª¨ÈúÄË¶ÅÂú®ÁºñËØëÈÄâÈ°π‰∏≠ËøõË°åËÆæÁΩÆÔºåÂú®È°πÁõÆÁöÑ Build Setting ‰∏≠ÔºåÊâæÂà∞ Swift Compiler - Custom FlagsÔºåÁÑ∂ÂêéÂÜç Other Swift Flags ‰∏äÂä†‰∏ä -D DEBUG Âç≥ÂèØÂÆö‰πâ‰∏Ä‰∏™ DEBUG ÂÆè„ÄÇ ÁºñËØëÊ†áËÆ∞OC ‰∏≠‰∏ÄËà¨‰ΩøÁî® #param mark - xxx ÁöÑÊñπÂºèÊù•Ê†áËÆ∞‰ª£Á†ÅÂå∫Èó¥„ÄÇSwift ‰∏≠ÂèØ‰ª•‰ΩøÁî® // MARK: xxx ËøõË°åÊ†áËÆ∞„ÄÇÂú®ÂÜíÂè∑ÂêéÈù¢Âä†‰∏äÊ®™Êù† - ÔºåËøôÊ†∑ÂØºËà™Ê†è‰∏≠Ëøô‰∏™‰ΩçÁΩÆ‰ºöÂÜçÂ§öÊòæÁ§∫‰∏Ä‰∏™Ê®™Êù°„ÄÇ ËøòÊúâÂåÖÊã¨ // TODO:Ôºå// FIXME: ÁöÑÊ†áËÆ∞„ÄÇ @UIApplicationMainOC ‰∏≠‰ºöÊúâ‰∏Ä‰∏™ main Êñá‰ª∂ÔºåË∞ÉÁî® UIApplicationMain ÁöÑÊñπÊ≥ï„ÄÇSwift ‰∏≠Âè™ÊúâÂú® AppDelegate ‰∏äÊúâ‰∏Ä‰∏™ @UIApplicationMain Ê†áËÆ∞„ÄÇËøô‰∏™Ê†áÁ≠æÂ∞ÜË¢´Ê†áÊ≥®ÁöÑÁ±ª‰Ωú‰∏∫ÂßîÊâòÔºåÂéªÂàõÂª∫‰∏Ä‰∏™ UIApplication Âπ∂ÂêØÂä®Êï¥‰∏™Á®ãÂ∫è„ÄÇÁºñËØëÁöÑÊó∂ÂÄôÔºåÁºñËØëÂô®Â∞ÜÂØªÊâæËøô‰∏™Ê†áËÆ∞ÁöÑÁ±ªÔºåÁÑ∂ÂêéÊèíÂÖ•ÂÉè main ÂáΩÊï∞ËøôÊ†∑ÁöÑÊ®°Êùø‰ª£Á†Å„ÄÇ @objc Âíå dynamicÂèØ‰ª•ÂØπÈúÄË¶ÅÊö¥Èú≤Áªô OC ‰ΩøÁî®ÁöÑ‰ªªÊÑèÂú∞Êñπ(ÂåÖÊã¨Á±ªÔºåÂ±ûÊÄßÂíåÊñπÊ≥ïÁ≠â)ÁöÑÂ£∞ÊòéÂâçÂä†‰∏ä @objc ‰øÆÈ•∞Á¨¶„ÄÇËøô‰∏™Ê≠•È™§Âè™ÈúÄË¶ÅÂØπÈÇ£‰∫õ‰∏çÊòØÁªßÊâø‰∫é NSObject ÁöÑÁ±ªÂûãËøõË°åÔºåÂ¶ÇÊûú‰ΩøÁî® Swift ÂÜôÁöÑ class ÊòØÁªßÊâø‰∫é NSObject ÁöÑËØùÔºåSwift ‰ºöËá™Âä®‰∏∫ÊâÄÊúâ Èùû private Á±ªÂíåÊàêÂëòÂä†‰∏ä @objc„ÄÇ Ê∑ªÂä†‰∫Ü @objc ‰πüÂπ∂‰∏çÊÑèÂë≥ÁùÄÊñπÊ≥ïÊàñËÄÖÂ±ûÊÄß‰ºöÂèòÊàêÂä®ÊÄÅÊ¥æÂèëÔºåSwift ‰ºöÂ∞ÜÂÖ∂‰ºòÂåñ‰∏∫ÈùôÊÄÅË∞ÉÁî®„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÂä®ÊÄÅË∞ÉÁî®ÔºåÈúÄË¶Å‰ΩøÁî®‰øÆÈ•∞Á¨¶ dynamic ÂèØÈÄâÂçèËÆÆÂíåÂçèËÆÆÊãìÂ±ïSwift ÁöÑÂçèËÆÆ‰∏≠Ê≤°ÊúâÂèØÈÄâÈ°πÔºåÊâÄÊúâÊñπÊ≥ïÈªòËÆ§ÂøÖÈ°ªÂÆûÁé∞„ÄÇÂèØ‰ª•‰ΩøÁî®ÂçèËÆÆÊãìÂ±ïÔºåÂú®ÂèØÈÄâÁöÑÊñπÊ≥ïÂÆö‰πâÈªòËÆ§ÂÆûÁé∞„ÄÇ ÂÜÖÂ≠òÁÆ°ÁêÜÔºåweak Âíå unownedÈó≠ÂåÖ‰∏≠ÁöÑÂº±ÂºïÁî®ÔºåÂú®ÂáΩÊï∞Á±ªÂûãÂâçÊ∑ªÂä†‰∏≠Êã¨Âè∑Ôºö123&#123; [unowned self, weak someObject] (number: Int) -&gt; Bool in return true&#125; @autoreleasepoolSwift ‰∏≠‰πüÂèØ‰ª•Ëá™Âª∫Ëá™Âä®ÈáäÊîæÊ±†Ôºö12autoreleasepool &#123;&#125; ÂÄºÁ±ªÂûãÂíåÂºïÁî®Á±ªÂûãSwift ‰∏≠ÁöÑÊï∞ÁªÑÊòØÂÄºÁ±ªÂûãÔºåÂú®È¢ëÁπÅÂ¢ûÂáèÂÖ∂‰∏≠ÂÖÉÁ¥†Êó∂ÔºåÂ§çÂà∂‰∫ßÁîüÁöÑÊ∂àËÄóÈùûÂ∏∏Â§ß„ÄÇÂõ†Ê≠§ÔºåÂú®‰ΩøÁî®Êï∞ÁªÑÂíåÂ≠óÂÖ∏Êó∂ÔºåÂ¶ÇÊûúÊï∞ÊçÆÂ¢ûÂáèÈ¢ëÁπÅÔºå‰ΩøÁî® NSMutableArray Âíå NSMutableDictionary ‰ºöÊØîËæÉÂ•ΩÔºåÂÆπÂô®ÂÜÖÊù°ÁõÆÂ∞èÂπ∂‰∏îÊï∞ÁõÆÁ®≥ÂÆöÁöÑÊó∂ÂÄôÔºå‰ΩøÁî® Swift ÁöÑ Array Âíå Dictonary„ÄÇ String ËøòÊòØ NSStringString Âíå NSString ÂèØ‰ª•Êó†ÁºùÊõøÊç¢„ÄÇ‰ΩÜÊòØÊúÄÂ•Ω‰ΩøÁî®ÂéüÁîüÁöÑ String UnsafePointerC ËØ≠Ë®Ä‰∏≠ÁöÑÊåáÈíàÔºåÂ∞Ü‰ºöÂú® Swift ‰∏≠Ë¢´ËΩ¨‰∏∫ UnsafePointer&lt;Type&gt;Á±ªÂûãÔºö123456789// C ‰∏≠void method(const int *num) &#123; printf("%d", *num);&#125;// Swift ‰∏≠func method(_ num: UnsafePointer&lt;CInt&gt;) &#123; print(num.pointee)&#125; C ‰∏≠ÁöÑÂü∫Á°ÄÁ±ªÂûãÔºåSwift ÈÅµÂæ™Áªü‰∏ÄÁöÑÂëΩÂêçËßÑÂàôÔºåÂú®Âü∫Êú¨Á±ªÂûãÂâçÂä†‰∏ä C„ÄÇ ‰º†ÂÖ•ÊåáÈíàÂú∞ÂùÄÊòØÈÉΩÊòØÂú®ÂâçÈù¢Âä†‰∏ä &amp; GCD ÂíåÂª∂Êó∂Ë∞ÉÁî®Swift ‰∏≠Êó†Áºù‰ΩøÁî® GCD:123456789101112// ÂàõÂª∫‚Ω¨Ê†áÈòüÂàólet workingQueue = DispatchQueue(label: "my_queue")// Ê¥æÂèëÂà∞ÂàöÂàõÂª∫ÁöÑÈòüÂàó‰∏≠ÔºåGCD ‰ºöË¥üË¥£Ëøõ‚æèÁ∫øÁ®ãË∞ÉÂ∫¶workingQueue.async &#123; // Âú® workingQueue ‰∏≠ÂºÇÊ≠•Ëøõ‚æè print("Âä™‚ºí‚ºØ‰Ωú") Thread.sleep(forTimeInterval: 2) // Ê®°Êãü‰∏§ÁßíÁöÑÊâß‚æèÊó∂Èó¥ DispatchQueue.main.async &#123; // ËøîÂõûÂà∞‰∏ªÁ∫øÁ®ãÊõ¥Êñ∞ UI print("ÁªìÊùü‚ºØ‰ΩúÔºåÊõ¥Êñ∞ UI") &#125;&#125; Âª∂ËøüË∞ÉÁî®Ôºö1234let time: TimeInterval = 2DispatchQueue.main.asuncAfter(deadline: DisaptchTime.now() + time) &#123; print("2ÁßíÂêéËæìÂá∫")&#125; Ëé∑ÂèñÂØπË±°Á±ªÂûãË∞ÉÁî® type(of: xxx) Êù•Ëé∑ÂèñÂØπË±°Á±ªÂûã Ëá™ÁúÅÂêë‰∏Ä‰∏™ÂØπË±°ÂèëÂá∫ËØ¢ÈóÆÔºåÁ°ÆÂÆöÂÆÉÊòØ‰∏çÊòØÂ±û‰∫éÊüê‰∏™Á±ªÔºåËøôÁßçÊìç‰ΩúÂè´ÂÅöËá™ÁúÅ„ÄÇSwift ‰∏≠‰ΩøÁî® is Áõ∏ÂΩì‰∫é OC ‰∏≠ÁöÑ isKindOfClass:1234let obj: AnyObject = ClassB()if (obj is ClassB) &#123; print("Â±û‰∫é ClassB")&#125; KVOÊöÇÊó∂ËøòÊ≤°ÊúâÊØîËæÉÂ•ΩÁöÑ KVO ÁöÑÁ∫Ø Swift ÊñπÊ°àÔºåÂèØ‰ª•‰ΩøÁî®Â±ûÊÄßËßÇÂØüÂÆûÁé∞Á±ª‰ººÊõø‰ª£„ÄÇÁé∞ÊúâÂ∫ì Observable-Swift ÂØπËøô‰∏ÄÊÄùË∑ØËøõË°å‰∫ÜÂ∞ÅË£Ö„ÄÇ Âà§Á≠âSwift ‰∏≠Ôºå== ÊòØ‰Ω†‰∏Ä‰∏™Êìç‰ΩúÁ¨¶ÁöÑÂ£∞ÊòéÔºåÂú® Equatable ‰∏≠Â£∞Êòé‰∫ÜËøô‰∏™Êìç‰ΩúÁ¨¶ÁöÑÂçèËÆÆÊñπÊ≥ïÔºö123protocol Equatable &#123; func ==(lhs: Self, rhs: Self) -&gt; Bool&#125; ÂØπ‰∫éËá™Âª∫Á±ªÂûãÔºåÂ¶ÇÊûúÊÉ≥Ë¶ÅËÉΩÂ§ü‰ΩøÁî® == Âà§Á≠âÔºåÈúÄË¶ÅÂÆûÁé∞ Equatable ÂçèËÆÆ„ÄÇSwift ‰∏≠ÁöÑÊìç‰ΩúÁ¨¶ÈÉΩÊòØÂÖ®Â±ÄÁöÑÔºåÊàë‰ª¨‰∏çÈúÄË¶ÅÂú®ÊãìÂ±ï‰∏≠ÂÆûÁé∞Ëøô‰∏™ÈáçËΩΩÊñπÊ≥ïÔºåË¶ÅÂú®ÂÖ®Â±ÄÁöÑ scope ÈáåÂÆö‰πâËøô‰∏™ÊñπÊ≥ï„ÄÇ‰ΩøÁî®ÁöÑÊó∂ÂÄôÈÄöËøáÁ±ªÂûãÊé®Êñ≠Ë∞ÉÁî®Ê≠£Á°ÆÁöÑ == ÈáçËΩΩÔºö1234567891011121314class TodoItem &#123; let uuid: String init(uuid: String) &#123; self.uuid = uuid &#125;&#125;extension TodoItem: Equatable &#123;&#125;func ==(lhs: TodoItem, rhs: TodoItem) -&gt; Bool &#123; return lhs.uuid == rhs.uuid&#125; Swift ‰∏≠‰ΩøÁî® === Âà§Êñ≠‰∏§‰∏™Á±ªÂûãÊòØÂê¶ÊòØÂêå‰∏Ä‰∏™Âú∞ÂùÄ„ÄÇ OptionsOC ‰∏≠ÁöÑ NS_ENUM ‰∏é Swift ‰∏≠ÁöÑ enum ÂØπÂ∫î„ÄÇÈÇ£‰πà OC ‰∏≠ÁöÑ NS_OPTIONS Âë¢ÔºüÂØπÂ∫î‰∫éÊª°Ë∂≥ OptionSetType ÂçèËÆÆÁöÑ struct Á±ªÂûãÔºå‰ª•Âèä‰∏ÄÁªÑÈùôÊÄÅÁöÑ get Â±ûÊÄß„ÄÇ ‰ª•Âä®ÁîªÈÄâÈ°π‰∏∫‰æãÔºö1234567public struct UIViewAnimationOptions : OptionSetType &#123; public init(rawValue: UInt) static var layoutSubviews: UIViewAnimationOptions = UIViewAnimationOptions(rawValue: 0) static var allowUserInteraction: UIViewAnimationOptions UIViewAnimationOptions(rawValue: 1)//... static var transitionFlipFromBottom: UIViewAnimationOptions UIViewAnimationOptions(rawValue: 1 &lt;&lt; 1)&#125; ‰ΩøÁî®ÁöÑÊó∂ÂÄôÁõ¥Êé•‰ΩøÁî®Á±ªÂ±ûÊÄßÔºåoptions Êé•Âèó‰∏Ä‰∏™ OptionSetType ÁöÑÊï∞ÁªÑÔºö12345UIView.animate(withDuration: 0.3, delay: 0.0, options: [.curveEaseIn, .allowUserInteraction], animations: &#123;&#125;, completion: nil) Êï∞ÁªÑ enumerateOC ‰∏≠ÈúÄË¶ÅËé∑ÂæóÊï∞ÁªÑÁöÑ‰∏ãÊ†áÁ¥¢Âºï‰∏ÄËà¨‰ΩøÁî®ÊñπÊ≥ï enumerateObjectsUsingBlock:„ÄÇSwift ‰∏≠Êúâ‰∏Ä‰∏™Êõø‰ª£ÊñπÊ≥ïÔºö1234567var result = 0for (idx, num) in [1,2,3,4,5,6].enumerated() &#123; result += num if idx ==2 &#123; break &#125;&#125; delegateSwift ‰∏≠‰∏ÄËà¨ÁöÑ protocol ‰∏çËÉΩ‰Ωú‰∏∫ delegate ÁöÑÁ±ªÂûãÔºåÂõ†‰∏∫ struct Âíå enum ‰πüËÉΩÈÅµÂæ™ protocolÔºå‰ΩÜÊòØÂÆÉ‰ª¨‰∏çÊòØÈÄöËøáÂºïÁî®ËÆ°Êï∞Êù•ÁÆ°ÁêÜÂÜÖÂ≠òÁöÑÔºåÊâÄ‰ª•ËøôÊ†∑Â∞±‰ºöÂØºËá¥ delegate ‰∏çËÉΩ‰ΩøÁî® weak ‰øÆÈ•∞„ÄÇ ÊâÄ‰ª•‰∏Ä‰∏™ËÉΩ‰Ωú‰∏∫ delegate Á±ªÂûãÁöÑ protocol ÂøÖÈ°ªÊòØÂè™ËÉΩÁî± class ÂÆûÁé∞ÁöÑ„ÄÇÈúÄË¶ÅÂú®Â£∞ÊòéÁöÑÂêçÂ≠óÂêéÈù¢Âä†‰∏ä class:123protocol MyClassDelegate: class&#123; func method()&#125; Associated ObjectOC ‰∏≠ÂèØ‰ª•ÈÄöËøá Associated Object Âú® Category ‰∏≠ÁªôÂ∑≤ÊúâÁ±ªÊ∑ªÂä†ÊàêÂëòÂèòÈáè„ÄÇSwift ‰∏≠‰πüÂèØ‰ª•ÈÄöËøá Associated Object Âú® extension ‰∏≠ÁªôÂ∑≤ÊúâÁ±ªÊ∑ªÂä†ÊàêÂëòÂèòÈáèÔºö12345678910111213141516private var key: Void?extension MyClass &#123; var title: String? &#123; get &#123; return objc_getAssociatedObject(self, &amp;key) as? String &#125; set &#123; objc_setAssociatedObject(self, &amp;key, newValue, .OBJC_ASSOCIATION_RETAIN_NONATOMIC) &#125; &#125;&#125;let a = MyClass()a.title = "123" key ÁöÑ‰πêË°å‰∏∫ Void?ÔºåÈÄöËøá &amp; Êìç‰ΩúÁ¨¶ÂèñÂú∞ÂùÄÂπ∂‰Ωú‰∏∫ UnsafePointer&lt;Void&gt; Á±ªÂûãË¢´‰º†ÂÖ•„ÄÇ LockOC ‰∏≠Â∏∏Áî® @sychronized ‰Ωú‰∏∫ÈîÅÔºå‰ΩÜÊòØ Swift ‰∏≠‰∏çÂ≠òÂú®‰∫Ü„ÄÇÂ¶ÇÊûúÊÉ≥Ë¶Å lock ‰∏Ä‰∏™ÂèòÈáèÁöÑËØùÈúÄË¶ÅÂ¶Ç‰∏ãÔºö12345func myMethod(anObj: AnyObject!) &#123; objc_sync_enter(anObj) // Âú® enter Âíå exit ‰πãÈó¥ anObj ‰∏ç‰ºöË¢´ÂÖ∂‰ªñÁ∫øÁ®ãÊîπÂèò objc_sync_exit(anObj)&#125; ÂèØ‰ª•ÂÜô‰∏Ä‰∏™ÂÖ®Â±ÄÊñπÊ≥ïÂÅöÈÄÇÂΩìÂ∞ÅË£ÖÔºå‰ΩøÂÖ∂Á±ª‰ºº‰∫é OCÔºö1234567891011func synchronized(_ lock: AnyObject, closure: () -&gt; ()) &#123; objc_sync_enter(lock) closure() objc_sync_exit(lock)&#125;func myMethodLocked(anObj: AnyObject!) &#123; synchronized(anObj) &#123; // Âú®Êã¨Âè∑ÂÜÖ anObj ‰∏ç‰ºöË¢´ÂÖ∂‰ªñÁ∫øÁ®ãÊîπÂèò &#125;&#125;]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[„ÄäSwift ËøõÈò∂„ÄãÁ¨îËÆ∞]]></title>
    <url>%2F2017%2F10%2F18%2FSwift%20%E8%BF%9B%E9%98%B6%2F</url>
    <content type="text"><![CDATA[Ëøô‰π¶ËØªÁöÑÁ¥ØËßâ‰∏çÁà± Swift È£éÊ†º ‰ΩøÁî®Á±ªÂûãÊé®Êñ≠„ÄÇÁúÅÁï•ÊòæËÄåÊòìËßÅÁöÑÁ±ªÂûãÊúâÂä©‰∫éÊèêÈ´òÂèØËØªÊÄß ‰ºòÂÖà‰ΩøÁî®ÁªìÊûÑ‰Ωì„ÄÇÂè™ÊúâÁ°ÆÂÆöË¶Å‰ΩøÁî®Á±ªÁöÑÁâπÊÄßÊàñËÄÖÂºïÁî®ËØ≠‰πâÁöÑÊó∂ÂÄôÊâç‰ΩøÁî®Á±ª ÈÅøÂÖç‰ΩøÁî®Âº∫Âà∂Ëß£ÂåÖÊàñÈöêÂºèÂº∫Âà∂Ëß£ÂåÖÔºåÈô§ÈùûËÉΩÁ°ÆÂÆöÈùû nil ËØïÁùÄ‰ΩøÁî® map Âíå reduce ‰ª£Êõø for Âæ™ÁéØ Èô§ÈùûÈúÄË¶ÅÊîπÂèòÊüê‰∏™ÂÄºÔºåÂê¶ÂàôÂ∞ΩÈáèÁî® let Â∞ΩÈáè‰∏çË¶Å‰ΩøÁî® self„ÄÇ‰ΩøÁî® self ÊòØ‰∏Ä‰∏™Ê∏ÖÊô∞ÁöÑ‰ø°Âè∑ÔºåË°®ÊòéÈó≠ÂåÖ‰ºöÊçïËé∑ self ÂÖßÂª∫ÈõÜÂêàÊï∞ÁªÑÊï∞ÁªÑÂíåÂèØÂèòÊÄß ÂÄºÁ±ªÂûãÂπ∂‰∏çÊòØËµã‰∏™ÂÄºÂ∞±ÂàõÂª∫‰∏Ä‰∏™ÂÜÖÂ≠òÁ©∫Èó¥„ÄÇÂÄºÁ±ªÂûãÂú®‰∏çÂèòÁöÑÊÉÖÂÜµ‰∏ãËøòÊòØÂÖ±‰∫´ÂÜÖÂ≠òÁöÑ„ÄÇÂè™ÊúâÂÖ∂‰∏≠‰∏Ä‰∏™ÂèòÂåñÁöÑÊó∂ÂÄôÊâç‰ºöÂàÜÈÖçÊñ∞ÁöÑÂÜÖÂ≠ò„ÄÇËøôÊ†∑ËÉΩÂáèÂ∞ëÂ§çÂà∂Â∏¶Êù•ÁöÑÊÄßËÉΩÈóÆÈ¢ò„ÄÇÊï∞ÁªÑÂíåÂèØÈÄâÂÄº Â∫îËØ•Â∞ΩÈáè‰∏ç‰ΩøÁî®Âº∫Âà∂Ëß£ÂåÖ„ÄÇÂÖªÊàê‰π†ÊÉØÂêé‰ºöÂØºËá¥‰Ω†Âº∫Âà∂Ëß£ÂåÖÂéüÊú¨‰∏çËØ•Ëß£ÂåÖÁöÑ‰∏úË•ø„ÄÇÊï∞ÁªÑÂèòÂΩ¢ map ÂØπÊØè‰∏™ÂÖÉÁ¥†ËøõË°åÊìç‰ΩúÔºåÈó≠ÂåÖËøîÂõûÂ§ÑÁêÜËøáÁöÑÂÄºÔºåÊúÄÂêéÂæóÂà∞‰∏Ä‰∏™Â§ÑÁêÜÂÆåÊàêÁöÑÊï∞ÁªÑ filter ÂØπÊØè‰∏™ÂÖÉÁ¥†ËøõË°åÂà§Êñ≠ÔºåÈó≠ÂåÖËøîÂõû Bool ÂÄºÔºåÊúÄÂêéÂæóÂà∞‰∏Ä‰∏™ÊâÄÊúâÁ¨¶ÂêàË¶ÅÊ±ÇÂÖÉÁ¥†ÁöÑÊï∞ÁªÑ reduce ÂØπÊâÄÊúâÂÖÉÁ¥†ËøõË°åËøêÁÆóÔºåÈó≠ÂåÖËøîÂõûÁöÑÂÄºÂíå‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†‰Ωú‰∏∫‰∏ã‰∏ÄÊ¨°ËøêÁÆóÁöÑËæìÂÖ•ÔºåÊúÄÂêéËøîÂõû‰∏Ä‰∏™ÊâÄÊúâÂÖÉÁ¥†ÁöÑÂ§ÑÁêÜÁªìÊûúÂÄº„ÄÇ flatMap ÈíàÂØπ‰∫éÊØè‰∏ÄÊ¨° map Èó≠ÂåÖÂ§ÑÁêÜÂêéËøîÂõûÁöÑÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÂç≥ÊúÄÁªàËøîÂõû‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØÊï∞ÁªÑÁöÑÊï∞ÁªÑÁöÑÊÉÖÂÜµ„ÄÇÂèØ‰ª•‰ΩøÁî® flatMap Â∞ÜÂÜÖÈÉ®Êï∞ÁªÑÂ±ïÂºÄÔºåÊúÄÂêéÂæóÂà∞‰∏Ä‰∏™ÂåÖÂê´ÊâÄÊúâÂÖÉÁ¥†ÁöÑÊï∞ÁªÑ„ÄÇ forEach ÁöÑ return Âπ∂‰∏çËÉΩËøîÂõûÁªôÂ§ñÈÉ®„ÄÇÊâÄ‰ª•‰∏ÄËà¨‰∏çË¶Å‰ΩøÁî® forEachÔºåËÄå‰ΩøÁî® for‚Ä¶inÊï∞ÁªÑÁ±ªÂûã ÂΩìÊàë‰ª¨ÈÄöËøáÊï∞ÁªÑ‰∏ãÊ†áËé∑ÂæóÊï∞ÁªÑ‰∏≠ÁöÑ‰∏ÄÊÆµÊó∂ÔºåËé∑ÂæóÁöÑ‰∏çÊòØ‰∏Ä‰∏™Êñ∞ÁöÑ ArrayÔºåËÄåÊòØ ArraySlice„ÄÇArraySlice ÊòØ Array ÁöÑ‰∏ÄÁßçË°®Áé∞ÊñπÂºèÔºåÊ≤°ÊúâÁúüÊ≠£ÁöÑ alloc„ÄÇÁõ∏ÂΩì‰∫éÂú®ÂéüÊï∞ÁªÑÁöÑÂü∫Á°Ä‰∏äÔºåÂ§öÂä†‰∫Ü‰øùÂ≠ò‰∏§‰∏™ index ÁöÑÂèòÈáèÔºå‰πüÂ∞±ÊòØËØ¥Ôºåindex ‰∏çÊòØ‰ªé 0 ÂºÄÂßãÁöÑ„ÄÇ Range range Ë°®Á§∫‰∏Ä‰∏™Âå∫Èó¥Ôºå‰ΩÜÊòØÂπ∂‰∏çÊòØÊâÄÊúâËåÉÂõ¥ÈÉΩÊòØÂ∫èÂàóÊàñËÄÖÈõÜÂêàÁ±ªÂûã„ÄÇÂè™ÊúâÈÇ£‰∫õÊ≠•Èïø‰∏∫Êï¥Êï∞ÁöÑÊâçÊòØÈõÜÂêàÁ±ªÂûã„ÄÇ ÈõÜÂêàÁ±ªÂûãÂçèËÆÆÂ∫èÂàó ‰∏Ä‰∏™ÈõÜÂêà Collection Â∞±ÊòØ‰∏Ä‰∏™Â∫èÂàó SequenceÔºåËøôË¶ÅÊª°Ë∂≥ Sequence ÂçèËÆÆ„ÄÇÊª°Ë∂≥ Sequence ÂçèËÆÆË¶ÅÊ±ÇÂÆûÁé∞‰∏Ä‰∏™ËøîÂõûËø≠‰ª£Âô® ÂÆû‰æãÁöÑÊñπÊ≥ï makeIterator()Ëø≠‰ª£Âô® Ëø≠‰ª£Âô®Ë¶ÅÊª°Ë∂≥ IteratorProtocol ÂçèËÆÆÔºåË¶ÅÊ±ÇÂÆûÁé∞ next() ÊñπÊ≥ï„ÄÇ for Âæ™ÁéØÁöÑÂü∫Êú¨ËøáÁ®ãÊòØÔºåÈõÜÂêàË∞ÉÁî® makeIterator() ËøîÂõû‰∏Ä‰∏™Ëø≠‰ª£Âô®ÂÆû‰æãÔºåËø≠‰ª£Âô®Âú®ÂàõÂª∫ÁöÑÊó∂ÂÄôÂ∞ÜÈõÜÂêà‰º†ÂÖ•„ÄÇ‰∏çÂÅúË∞ÉÁî®Ëø≠‰ª£Âô®ÁöÑ next() ÊñπÊ≥ïÔºåËøîÂõûÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†„ÄÇ ÁªùÂ§ßÂ§öÊï∞Ëø≠‰ª£Âô®ÈÉΩÊòØÂÄºËØ≠‰πâÔºåÂ§çÂà∂ÁöÑÊó∂ÂÄô‰∏§‰∏™Ëø≠‰ª£Âô®ÂàÜÂà´Â∑•‰Ωú„ÄÇAnyIterator ÊòØ‰∏Ä‰∏™Áî®Êù•Â∞ÅË£ÖÂÖ∂‰ªñËø≠‰ª£Âô®ÁöÑËø≠‰ª£Âô®ÔºåÂÆÉÊòØÂºïÁî®ËØ≠‰πâÁöÑ„ÄÇAnyIterator Áõ∏ÂΩì‰∫é‰∏Ä‰∏™ÁõíÂ≠êÔºåÁõíÂ≠êË¢´ÂºïÁî®Â§çÂà∂ÔºåÁõíÂ≠êÈáåÁöÑËø≠‰ª£Âô®Â∞ÜË¢´ÂÖ±‰∫´„ÄÇ ÂàõÂª∫‰∏Ä‰∏™Â∫èÂàóÁöÑÊñπÂºè: AnySequence Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÂàùÂßãÂåñÊñπÊ≥ïÔºåÊé•Êî∂‰∏Ä‰∏™ËøîÂõûÂÄº‰∏∫Ëø≠‰ª£Âô®ÁöÑÂáΩÊï∞„ÄÇ ÈÄöËøá sequence(first:next:) ÊàñËÄÖ sequence(state:next:) ‰∏§‰∏™ÊñπÊ≥ï„ÄÇÈô§‰∫Ü next Ë¶ÅÊ±Ç‰º†ÂÖ•‰∏Ä‰∏™ÁîüÊàêÂêéÁª≠ÂÄºÁöÑÈó≠ÂåÖÂ§ñÔºåÂâçËÄÖ‰º†ÂÖ•‰∏Ä‰∏™ÂàùÂßãÂÄºÔºåÂêéËÄÖ‰º†ÂÖ•‰∏Ä‰∏™ÂÖÉÁªÑ„ÄÇ Êó†ÈôêÂ∫èÂàó Â∫èÂàóÂèØ‰ª•ÊòØÊó†ÈôêÁöÑÔºåËÄåÈõÜÂêàÂàôÊòØÊúâÈôêÁöÑ„ÄÇËøôÊòØ‰∏Ä‰∏™ÈáçË¶ÅÂå∫Âà´ ÂèØ‰ª•ÈÄöËøá let value = someSequence.prefix(10) ÁöÑÊñπÂºèËé∑ÂèñÂ∫èÂàóÁöÑÂâçÂçÅ‰∏™ÂÖÉÁ¥†„ÄÇÁÑ∂Âêé Array(value) ÁîüÊàê‰∏Ä‰∏™Êï∞ÁªÑ„ÄÇ‰∏çÁ®≥ÂÆöÂ∫èÂàó ‰∏çÂè™ÊòØÊï∞ÁªÑËøôÊ†∑ÁöÑÊâçÂè´Â∫èÂàó„ÄÇÁΩëÁªúÊµÅÔºåÊñá‰ª∂ÊµÅ‰πüÂèØ‰ª•ÂΩìÂÅöÂ∫èÂàó„ÄÇÂ∫èÂàóÂπ∂‰∏ç‰øùËØÅÂèØ‰ª•Ë¢´Â§öÊ¨°ÈÅçÂéÜÈÉΩ‰∏ÄÊ†∑„ÄÇ Â¶ÇÊûúÂ∫èÂàóÈÅµÂÆà Colleciton ÂçèËÆÆÔºåÈÇ£‰πàÂ∞±ÊòØÈõÜÂêà„ÄÇÈõÜÂêàÊòØÁ®≥ÂÆöÁöÑ„ÄÇËøôÊòØ‰∏§ËÄÖÁöÑÂè¶‰∏Ä‰∏™Â∑ÆÂà´„ÄÇÂ∫èÂàóÂíåËø≠‰ª£Âô®ÁöÑÂÖ≥Á≥ª ÈúÄË¶ÅÂú®Â∫èÂàó‰∏≠Êèê‰æõ‰∏Ä‰∏™Ëø≠‰ª£Âô®ÁöÑÊÑè‰πâÂú®‰∫éÔºåÊØèÊ¨°ÈÅçÂéÜÁöÑÊó∂ÂÄôÈÉΩÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑËø≠‰ª£Âô®ÔºåËøôÊ†∑ÂÜÖÈÉ®Áä∂ÊÄÅÁã¨Á´ã„ÄÇÂê¶ÂàôÂÜÖÈÉ®Áä∂ÊÄÅÈöèÁùÄ for Âæ™ÁéØÊîπÂèò„ÄÇÂ≠êÂ∫èÂàó Sequence Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÂÖ≥ËÅîÁ±ªÂûã associatedtype SubSequence„ÄÇÂú®ËøîÂõûÂéüÂ∫èÂàóÂàáÁâáÁöÑÊìç‰Ωú‰∏≠ÔºåSubSequence Ë¢´Áî®‰ΩúËøîÂõûÂÄºÁöÑÁ±ªÂûãÔºåÊØîÂ¶Ç ArraySlice„ÄÇ ÈõÜÂêàÁ±ªÂûã ÈõÜÂêàÁ±ªÂûãÊåáÁöÑÊòØÂèØ‰ª•Â§öÊ¨°ÈÅçÂéÜÁöÑÁ®≥ÂÆöÁöÑÂ∫èÂàó Collection ÂçèËÆÆÊòØÂª∫Á´ãÂú® Sequence ÂçèËÆÆ‰∏äÁöÑ Êú¨ËäÇÂêéÈÉ®ÂàÜÂä†Ëµ∑Êù•ÂÆûÁé∞‰∫Ü‰∏Ä‰∏™ FIFO ÈòüÂàóÂ¶Ç‰ΩïÂÆûÁé∞‰∏Ä‰∏™ FIFO ÈòüÂàó ÂàõÂª∫‰∏Ä‰∏™ FIFO ÈòüÂàóÁöÑÁªìÊûÑ‰ΩìÔºåÁÑ∂ÂêéÊèê‰æõ FIFO ÈòüÂàóÁöÑÁâπÊúâ enqueue„ÄÅdequeue ÊñπÊ≥ï„ÄÇ Ëã•‰Ω†ÊÉ≥Ëá™Â∑±ÂàõÂª∫‰∏Ä‰∏™ Collection Á±ªÂûãÔºåÁî±‰∫é Collection Êèê‰æõ‰∫ÜÂæàÂ§öÈªòËÆ§ÂÆûÁé∞ÔºåÊØîÂ¶ÇËø≠‰ª£Âô®Â∞±ÊúâÈªòËÆ§ÂÆûÁé∞Ôºå‰Ω†Âè™Ë¶ÅËá™Â∑±ÂÆûÁé∞ startIndex„ÄÅendIndex„ÄÅÊ†πÊçÆÁ¥¢ÂºïËÆøÈóÆÁâπÂÆö‰ΩçÁΩÆÔºå‰ª•Âèä‰∏ãÊ†áÊñπÊ≥ï„ÄÇ ÂÆûÁé∞ ExpressibleByArrayLiteral ÂçèËÆÆÔºåÂèØ‰ª•Áî®Êï∞ÁªÑÂ≠óÈù¢Èáè( ÂΩ¢Â¶Ç[1,2,3] ) ÁöÑÂΩ¢ÂºèÂàõÂª∫ÈòüÂàóÔºåÊï∞ÁªÑ‰πüÂÆûÁé∞‰∫ÜËøô‰∏™ÂçèËÆÆÔºåÂÆûÁé∞‰∫ÜËøô‰∏™ÂçèËÆÆÁöÑ‰∏ç‰∏ÄÂÆöÊòØÊï∞ÁªÑ„ÄÇ ÂàáÁâá ÂàáÁâáÂíåÂéüÊù•ÁöÑÈõÜÂêàÂÖ±‰∫´Â≠òÂÇ®ÁºìÂÜ≤Âå∫„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂàáÁâá‰∏ç‰ºöÂçïÁã¨ÂèñÂá∫ÂÜÖÂ≠òÔºåÂÆÉÂè™ÊòØÊ†áËÆ∞‰∫ÜÈõÜÂêàÁöÑÂºÄÂßãÂíåÁªìÊùü‰ΩçÁΩÆ„ÄÇ ÂèØÈÄâÂÄºÈÄöËøáÊûö‰∏æËß£ÂÜ≥È≠îÊ≥ïÊï∞ÁöÑÈóÆÈ¢ò ÂèØÈÄâÊòØ‰∏Ä‰∏™Êûö‰∏æÁ±ªÂûã1234enum Optional&lt;Wrapped&gt; &#123; case none case some(wrapped)&#125; ÂèØÈÄâÂÄºÊ¶ÇËßàif let Âíå while let ÈÄöËøáÂèØÈÄâÁªëÂÆö if let Ëé∑Âæó‰∏Ä‰∏™ÈùûÁ©∫ÂÄº„ÄÇwhile let ‰ª£Ë°®‰∏Ä‰∏™ÂΩìÈÅáÂà∞ nil Êó∂ÁªàÊ≠¢ÁöÑÂæ™ÁéØ„ÄÇ for‚Ä¶in ÂÖ∂ÂÆûÂ∞±ÊòØ‰∏Ä‰∏™ while let Âæ™ÁéØ„ÄÇÂèåÈáçÂèØÈÄâÂÄº ÂèØÈÄâÂÄºÁöÑÂÄº‰ªçÁÑ∂ÊòØ‰∏Ä‰∏™ÂèØÈÄâÂÄº optional&lt;Optional&lt;Int&gt;&gt; Âç≥ Int??if var Âíå while var Ëé∑Âèñ‰∏Ä‰∏™ËÉΩÂú®‰ΩúÁî®ÂüüÂÜÖ‰ΩøÁî®ÁöÑÂâØÊú¨ÁöÑÁÆÄ‰ªãÔºåÂπ∂‰∏ç‰ºöÊîπÂèòÂéüÊù•ÁöÑÂÄº„ÄÇËß£ÂåÖÂêéÁöÑÂèØÈÄâÂÄºÁöÑ‰ΩúÁî®Âüü Â¶ÇÊûú‰ΩøÁî® guard ËØ≠Âè•Ë¶ÅÊ±ÇÂøÖÈ°ªÊúâ return ÔºåÂú®Âæ™ÁéØ‰∏≠ÁöÑËØùÂàôÊòØ break Âíå continue ‰∏Ä‰∏™ÂáΩÊï∞ÁöÑËøîÂõûÂÄºÂ¶ÇÊûúÊòØ NeverÔºåÈÇ£‰πàË°®Á§∫‰ªÄ‰πà‰πü‰∏çËøîÂõû„ÄÇ‰∏ÄËà¨Êàë‰ª¨ÂÆö‰πâÁöÑÊñπÊ≥ï‰∏ç‰ºöËøîÂõû NeverÂèØÈÄâÈìæ Â¶ÇÊûúÊüê‰∏™ÊñπÊ≥ïÁöÑËøîÂõûÂÄºÂèØËÉΩ‰∏∫Á©∫ÔºåÈÇ£‰πàÂèØÈÄâÈìæÁöÑË∞ÉÁî®‰∏äÈúÄË¶ÅÂä†‰∏ä ?ÔºõÂèç‰πãÔºåÂàô‰∏çÈúÄË¶Å„ÄÇnil ÂêàÂπ∂ËøêÁÆóÁ¨¶ a ?? b Ë°®Á§∫ a ‰∏ç‰∏∫Á©∫‰Ωç aÔºå‰∏∫Á©∫Âàô‰∏∫ b„ÄÇÁ±ª‰ºº‰∫é‰∏âÂÖÉËøêÁÆóÁ¨¶ ?? ÂèØ‰ª•ÁªìÂêà if letÔºö1234// ‚ÄúÔºå‚ÄùË°®Á§∫‰∏éÔºåÈúÄË¶ÅÂêåÊó∂Êª°Ë∂≥‰∏ç‰∏∫Á©∫if let n = i,let m =j &#123;&#125;// ‚Äú??‚ÄùË°®Á§∫ÊàñÔºåÂè™Ë¶ÅÂÖ∂‰∏≠‰∏Ä‰∏™‰∏ç‰∏∫Á©∫if let n = i ?? j &#123;&#125; ÁªìÊûÑ‰ΩìÂíåÁ±ªÁªìÊûÑ‰Ωì ‰ΩøÁî® let ÂÆö‰πâÁöÑÁöÑÁªìÊûÑ‰ΩìÔºåÂÖ∂‰∏≠ var ÂÆö‰πâÁöÑÂ±ûÊÄß‰πüÊòØ‰∏çËÉΩË¢´ÊîπÂèòÁöÑ„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÁªìÊûÑ‰Ωì‰∏≠ÂåÖÂê´ÂºïÁî®Â±ûÊÄßÔºåÂè™Ë¶ÅÂºïÁî®Â±ûÊÄßÊ≤°ÊúâÊåáÂêëÊñ∞ÁöÑÂú∞ÂùÄÔºåÈÇ£‰πàÊîπÂèòÂºïÁî®Â±ûÊÄß‰∏≠ÁöÑÂ±ûÊÄßÊòØÊ≤°ÊúâÈóÆÈ¢òÁöÑ„ÄÇ Â¶ÇÊûúÊàë‰ª¨Ëá™ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÂàùÂßãÂåñÊñπÊ≥ïÔºåSwift Â∞±‰∏ç‰ºöËá™Âä®ÁîüÊàêÈªòËÆ§ÂàùÂßãÂåñÊñπÊ≥ï‰∫Ü ÂàùÂßãÂåñÊñπÊ≥ïÂèØ‰ª•ÊîæÂú® extension ‰∏≠ ÂΩìÊàë‰ª¨ÊîπÂèòÁªìÊûÑ‰Ωì‰∏≠ÁöÑÊüê‰∏™Â±ûÊÄßÁöÑÊó∂ÂÄôÔºåÁªìÊûÑ‰ΩìÁöÑ didSet ÊñπÊ≥ï‰ºöË¢´Ëß¶Âèë„ÄÇÂõ†‰∏∫ÁªìÊûÑ‰ΩìÁöÑÂ±ûÊÄßÊîπÂèòÂØºËá¥Êñ∞Âª∫‰∫Ü‰∏Ä‰∏™ÁªìÊûÑ‰Ωì„ÄÇÂ¶ÇÊûúÊòØÁ±ªÔºåÂàô‰∏ç‰ºöËß¶Âèë Êï∞ÁªÑÊòØÁªìÊûÑ‰ΩìÔºåÂõ†Ê≠§ÂΩìÊàë‰ª¨ÊîπÂèòÊï∞ÁªÑ‰∏≠ÁöÑÊüê‰∏™ÂÖÉÁ¥†Êó∂ÔºåÊï∞ÁªÑÁöÑ didSet ÊñπÊ≥ï‰πü‰ºöËß¶Âèë Ë¶ÅÊîπÂèòÁªìÊûÑ‰ΩìÂÖ∂‰∏≠Â±ûÊÄßÁöÑÂÄºÔºåÈúÄË¶ÅÂú®ÊñπÊ≥ïÂâçÂä†‰∏ä mutating Ê†áËØÜ„ÄÇÂä†‰∫ÜÊ†áËØÜÁöÑÊñπÊ≥ï‰∏çËÉΩË¢´ let ÂÆö‰πâÁöÑÁªìÊûÑ‰ΩìÂØπË±°Ë∞ÉÁî®„ÄÇ Swift ‰ºöËá™Âä®Â∞ÜÂ±ûÊÄßÁöÑ setter Ê†áËÆ∞‰∏∫ mutating„ÄÇÂõ†Ê≠§Ôºå‰Ω†Êó†Ê≥ïË∞ÉÁî® let ÁöÑ setter„ÄÇ ÁªìÊûÑ‰ΩìÁöÑÊúâ‰∏Ä‰∫õÊñπÊ≥ïÊúâ‰∏§‰∏™ÁâàÊú¨ÔºåÊØîÂ¶ÇÊï∞ÁªÑÁöÑ sort() Âíå sorted()ÔºåÂâçËÄÖ‰∏ÄÁ±ª‰ΩøÁî®Á•à‰ΩøÂä®ËØçÁü≠ËØ≠ÁöÑÊòØ mutating ÊñπÊ≥ïÔºåÂú®ÂéüÂØπË±°‰∏ä‰øÆÊîπÔºõÂêéËÄÖËøîÂõû‰∏Ä‰∏™Êñ∞ÂØπË±° mutating ÂÖ≥ÈîÆÂ≠óÂ¶Ç‰ΩïÂ∑•‰ΩúÔºüÂÆÉÂ∞ÜÈöêÂºèÁöÑ self ÂèÇÊï∞Âèò‰∏∫ inout ÂèØÂèò„ÄÇ ÂÜôÊó∂Â§çÂà∂ Swift ‰∏≠ÈõÜÂêàÁ±ªÂûãÂÆûÁé∞‰∫ÜÂÜôÊó∂Â§çÂà∂ÔºåÂç≥ËµãÂÄºÊó∂‰∏§‰∏™ÈõÜÂêàÊåáÂêëÂÜÖÂ≠ò‰∏≠ÁöÑÂêå‰∏Ä‰∏™‰ΩçÁΩÆÔºåÂè™ÊúâÂú®ÊîπÂèòÂÖ∂‰∏≠‰∏Ä‰∏™ÈõÜÂêàÊó∂ÔºåÊâç‰ºöÂ§çÂà∂Êï∞ÁªÑÔºåÂÜçËøõË°å‰øÆÊîπ„ÄÇËøôÊ†∑ËÉΩÂáèÂ∞ëÁªìÊûÑ‰ΩìÈ¢ëÁπÅÁöÑÂ§çÂà∂Êìç‰ΩúÂ∏¶Êù•ÁöÑÊÄßËÉΩÊçüËÄó ÂÜôÊó∂Â§çÂà∂‰∏çÊòØÁºñËØëÂô®ÁöÑ‰ºòÂåñÔºåËÄåÊòØË¶ÅËá™Â∑±ÂÆûÁé∞ÁöÑ„ÄÇÂÜôÊó∂Â§çÂà∂(ÊòÇË¥µÊñπÂºè) ÂØπ‰∫éËá™Â∑±ÂÆûÁé∞ÁöÑÁªìÊûÑ‰ΩìÔºåÂú®ÊñπÊ≥ï‰∏≠Â§çÂà∂Ëá™Â∑±ÔºåÁÑ∂ÂêéÂØπÂ§çÂà∂ÁöÑÂØπË±°ËøõË°å‰øÆÊîπËøîÂõû ÂØπ‰∫éÂºïÁî®Á±ªÂûãÔºåÈúÄË¶ÅÂ∞ÜÂÖ∂ÂåÖË£ÖÂú®‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÂÜÖÔºå‰Ωú‰∏∫‰∏Ä‰∏™ÁßÅÊúâÂ±ûÊÄß„ÄÇÂàõÂª∫‰∏Ä‰∏™ËÆ°ÁÆóÂ±ûÊÄßÔºåget ÊñπÊ≥ïÂàõÂª∫Ëøô‰∏™ÂºïÁî®Á±ªÂûãÁöÑÂ§çÂà∂Âπ∂Ë¶ÜÁõñÂéüÂ±ûÊÄßÔºåÁÑ∂ÂêéËøîÂõû„ÄÇÂú®ÈúÄË¶ÅÂÜôÊó∂Â§çÂà∂ÁöÑÊñπÊ≥ï‰∏≠Êìç‰ΩúËÆ°ÁÆóÂ±ûÊÄßÂç≥ÂèØ„ÄÇÂÜôÊó∂Â§çÂà∂(È´òÊïàÊñπÂºè) ‰∏äÈù¢Â≠òÂú®ÁöÑÈóÆÈ¢òÊòØÔºåÂ¶ÇÊûú‰Ω†ÂØπË±°Âè™ÊúâÂîØ‰∏ÄÂºïÁî®ÔºåËøòÊòØ‰ºöÂú®‰øÆÊîπÂâçÂ§çÂà∂ÂØπË±°„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂÖà‰ΩøÁî® isKnownUniquelyReferenced ÂáΩÊï∞Êù•Ê£ÄÊü•ÂºïÁî®ÁöÑÂîØ‰∏ÄÊÄß„ÄÇ Èó≠ÂåÖÂíåÂèØÂèòÊÄß Swift ÁöÑÁªìÊûÑ‰Ωì‰∏ÄËà¨Ë¢´Â≠òÂÇ®Âú®Ê†à‰∏äÔºåËÄåÈùûÂ†Ü‰∏äÔºåËøôÊòØ Swift ÁöÑ‰∏ÄÁßç‰ºòÂåñ„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÁªìÊûÑ‰ΩìÂ≠òÂÇ®Âú®Â†Ü‰∏äÔºåÁªùÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºå‰ºòÂåñ‰ºöÁîüÊïàÔºåÂ∞ÜÁªìÊûÑ‰ΩìÂ≠òÂÇ®Âà∞Ê†à‰∏ä„ÄÇ‰ΩÜÊòØÂΩìÁªìÊûÑ‰ΩìÂèòÈáèË¢´‰∏Ä‰∏™Èó≠ÂåÖÂºïÁî®ÁöÑÊó∂ÂÄôÔºå‰ºòÂåñÂ§±ÊïàÔºåÁªìÊûÑ‰ΩìÂ∞ÜÂ≠òÂÇ®Âú®Â†Ü‰∏ä„ÄÇÂõ†‰∏∫Â¶ÇÊûúÂ≠òÂú®Ê†à‰∏äÔºåÂΩìÂâç‰ΩúÁî®ÂüüÁªìÊùüÂ∞±‰ºöÈîÄÊØÅÔºå‰ΩÜÊòØË¢´Èó≠ÂåÖÂºïÁî®‰∫ÜÔºåÈúÄË¶ÅÂú®Êú™Êù•ÁöÑÊüê‰∏™Êó∂ÂÄôÁî®Âà∞ÔºåÊâÄ‰ª•ÂøÖÈ°ªË¶ÅÊîæÂú®Â†Ü‰∏ä„ÄÇ ÂáΩÊï∞inout ÂáΩÊï∞ÂíåÂèØÂèòÊñπÊ≥ï Swift ‰∏≠ inout ÂèÇÊï∞ÂâçÈù¢‰ΩøÁî®ÁöÑ &amp; Á¨¶Âè∑‰∏çÊòØ‰º†ÈÄíÂºïÁî®„ÄÇ‰∫ãÂÆû‰∏äÔºåinout ÂÅöÁöÑ‰∫ãÊòØÂ∞ÜÂÄº‰º†ÂõûÂéªÔºåÊõø‰ª£ÂéüÊù•ÁöÑÂÄº„ÄÇ ÂèØ‰ª•Âú®ÂµåÂ•óÂáΩÊï∞ÁöÑÂ§ñÈÉ®ÂáΩÊï∞‰∏≠‰ΩøÁî® inout ÂèÇÊï∞Ôºå‰ΩÜÊòØ‰∏çËÉΩËÆ© inout ÂèÇÊï∞ÈÄÉÈÄ∏„ÄÇÂõ†‰∏∫ÈÄÉÈÄ∏‰∫ÜÂ∞±‰∏çÁü•ÈÅìÂ∫îËØ•‰ªÄ‰πàÊó∂ÂÄôÂ§çÂà∂ÂõûÂéª‰∫Ü„ÄÇ ËÆ°ÁÆóÂ±ûÊÄß Âª∂ËøüÂ≠òÂÇ®Â±ûÊÄßÂú®Á¨¨‰∏ÄÊ¨°Ë¢´ËÆøÈóÆÊó∂ÔºåÈó≠ÂåÖË¢´ÊâßË°å„ÄÇ Âª∂ËøüÂ≠òÂÇ®Â±ûÊÄßÈó≠ÂåÖ‰∏≠ËÆøÈóÆÂ§ñÈÉ®ÊàêÂëòÁöÑÊó∂ÂÄôË¶ÅÊòéÁ°Æ‰ΩøÁî® self Êàë‰ª¨ÂèØ‰ª•Â∞ÜÂ±ûÊÄßÁöÑ didSet Âíå IBOutlet ÈÖçÂêà‰ΩøÁî®ÔºåÂú® IBOutlet Ë¢´ÈìæÊé•ÁöÑÊó∂ÂÄôËøêË°å‰ª£Á†ÅÔºåÂÅö‰∏Ä‰∫õËßÜÂõæÈÖçÁΩÆ„ÄÇ Ëá™Âä®Èó≠ÂåÖÂíåÈÄÉÈÄ∏Èó≠ÂåÖ ‰ΩøÁî® @autoclosure Ê†áÊ≥®Ëá™Âä®‰∏∫‰∏Ä‰∏™ÂèÇÊï∞ÂàõÂª∫Èó≠ÂåÖ„ÄÇ(ÊàëËßâÂæóËøôÊ†∑‰ª£Á†ÅÂèØËØªÊÄßÂæàÂ∑Æ) ÈÄÉÈÄ∏Èó≠ÂåÖÈúÄË¶ÅÂä†‰∏ä @escaping Ê†áÊ≥®ÔºåÂê¶ÂàôÁºñËØëÂô®‰∏çÂÖÅËÆ∏‰øùÂ≠òËøô‰∏™Èó≠ÂåÖ„ÄÇ Â≠óÁ¨¶‰∏≤Â≠óÁ¨¶‰∏≤ÂíåÈõÜÂêà String Á¨¶Âêà Collection ÂçèËÆÆÁöÑÊâÄÊúâË¶ÅÊ±ÇÔºå‰ΩÜÊòØ String ‰∏çÊòØ‰∏Ä‰∏™ÈõÜÂêà„ÄÇString Êèê‰æõ‰∫Ü characters Ëøô‰∏™ÈõÜÂêàËÆøÈóÆÂ≠óÁ¨¶‰∏≤ Êï∞ÁªÑ‰∏äÁöÑÂàáÁâá‰∏çÊòØ Array ËÄåÊòØ ArraySlice„ÄÇËÄå String ÁöÑÂàáÁâáÁ±ªÂûãÂàôÊòØËá™Ë∫´„ÄÇ String ÁöÑÂÜÖÈÉ®ÁªìÊûÑ ÁªìÊûÑ‰Ωì String ÂÜÖÈÉ®ÂåÖÂê´‰∫Ü‰∏Ä‰∏™ StringCore Á±ªÂûãÁöÑÁªìÊûÑ‰ΩìÔºåStringCore ÂåÖÂê´‰∫Ü‰∏â‰∏™Â±ûÊÄßÔºö_baseAddress Ê†à‰∏äÊàñËÄÖÂ†Ü‰∏äÁöÑ‰ΩçÁΩÆÔºõ_countAndFlags ÈïøÂ∫¶Ôºõ_ownerË¥üË¥£ÂÜôÊó∂ËµãÂÄºÂíåÂÜÖÂ≠òÂõûÊî∂ÁöÑÂØπË±°„ÄÇ Â≠óÁ¨¶‰∏≤ split ‰∏ç‰ºöÂÅöÂ§ßÈáèÁöÑÊã∑Ë¥ùÔºåËÄåÊòØÊåÅÊúâÂ≠óÁ¨¶‰∏≤Êüê‰∏™ÂàáÁâá„ÄÇËøô‰ºöÂØºËá¥Âç≥‰ΩøÂàáÁâáÂè™ÊúâÂá†‰∏™Â≠óÁ¨¶Â§ßÂ∞èÔºåËøòÊòØ‰ºöÂØºËá¥Êï¥‰∏™Â≠óÁ¨¶‰∏≤ÂÜÖÂ≠òÊó†Ê≥ïÈáäÊîæ„ÄÇ CustomStringConvertible Â¶ÇÊûúÊÉ≥Ë¶ÅËá™ÂÆö‰πâ print ÁöÑËæìÂá∫ÔºåÂèØ‰ª•Âú®‰∏Ä‰∏™ extension ‰∏≠ÂÆûÁé∞ CustomStringConvertible ÂçèËÆÆÔºåÈáçÂÜô description Â±ûÊÄßÁöÑ get ÊñπÊ≥ï„ÄÇ ÈîôËØØÂ§ÑÁêÜResult Á±ªÂûã Result Á±ªÂûãÂíåÂèØÈÄâÂÄºÈùûÂ∏∏Á±ª‰ºº„ÄÇResult Á±ªÂûã‰πüÊòØ‰∏§‰∏™ÊàêÂëòÁªÑÊàêÁöÑÊûö‰∏æÔºå‰∏Ä‰∏™‰ª£Ë°®Â§±Ë¥•ÊÉÖÂÜµÔºåÂπ∂ÂÖ≥ËÅî‰∫ÜÂÖ∑‰ΩìÁöÑÈîôËØØÂÄºÔºõ‰∏Ä‰∏™‰ª£Ë°®ÊàêÂäüÊÉÖÂÜµÔºåÂÆÉÂÖ≥ËÅî‰∫Ü‰∏Ä‰∏™Ê≥õÂûãÂèÇÊï∞„ÄÇ ËøôÊ†∑ÔºåÂØπ‰∫éÂèØËÉΩÊäõÂá∫ÈîôËØØÁöÑÊñπÊ≥ïÔºåÊàë‰ª¨‰ΩøÂÖ∂ËøîÂõû‰∏Ä‰∏™ Result Á±ªÂûã„ÄÇÁÑ∂ÂêéÂà§Êñ≠Âà∞Â∫ïÊòØÊàêÂäüÊûö‰∏æËøòÊòØÂ§±Ë¥•Êûö‰∏æÔºåÁÑ∂ÂêéÂèñÂá∫ÂÖ≥ËÅîÂÄº„ÄÇ ÊäõÂá∫ÂíåÊçïËé∑ Swift Âπ∂Ê≤°Êúâ‰ΩøÁî®ËøîÂõû Result ÁöÑÊñπÂºèÂ§ÑÁêÜÂ§±Ë¥•ÔºåËÄåÊòØÂ∞ÜÊñπÊ≥ïÊ†áËÆ∞‰∏∫ throws„ÄÇResult ÊòØ‰ΩúÁî®Âú®Á±ªÂûã‰∏äÁöÑÔºåËÄå throws ÊòØ‰ΩúÁî®‰∫éÂáΩÊï∞ÁöÑ„ÄÇÂØπ‰∫éÊØè‰∏™ÂèØ‰ª•ÊäõÂá∫ÁöÑÂáΩÊï∞ÔºåÁºñËØëÂô®‰ºöÈ™åËØÅË∞ÉÁî®ËÄÖÊúâÊ≤°ÊúâÊçïËé∑ÈîôËØØÔºåÊàñËÄÖÊääÈîôËØØÂêë‰∏ä‰º†ÈÄí„ÄÇ ÂåÖÂê´ throws ÁöÑÂáΩÊï∞ÊòØËøôÊ†∑ÁöÑÔºö 1func contents(ofFIle filename: String) throws -&gt; String Â§ÑÁêÜÁöÑÊó∂ÂÄôÊàë‰ª¨Ë¶ÅÂ∞Ü‰ºöÊäõÂá∫ÂºÇÂ∏∏ÁöÑÂáΩÊï∞Ê†áËÆ∞‰∏∫ try„ÄÇtry ÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂº∫Ë∞ÉË∞ÉÁî®ËÄÖÁü•ÈÅìÂáΩÊï∞‰ºöÊäõÂá∫ÈîôËØØ„ÄÇ Êàë‰ª¨ÈúÄË¶ÅÈÄöËøá do/catch Êù•Â§ÑÁêÜÈîôËØØÔºåÊàñËÄÖÊääÂΩìÂâçÂáΩÊï∞‰πüÊ†áËÆ∞‰∏∫ throws„ÄÇÂ¶ÇÊûú‰ΩøÁî® catchÔºåÊàë‰ª¨Áî®Ê®°ÂºèÂåπÈÖçÁöÑÊñπÂºèËé∑ÂèñÊüê‰∏™ÁâπÂÆöÁöÑÈîôËØØÊàñËÄÖÊâÄÊúâÈîôËØØÔºåÁÑ∂ÂêéÂú®ÊúÄÂêé catch-all ‰∏≠Â§ÑÁêÜÊâÄÊúâÈîôËØØ„ÄÇÂú® catch-all ‰∏≠ÔºåÂèòÈáè error ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®Ôºö 12345678do &#123; let result = try contents(ofFile:"input.txt") pint(result)&#125; catch FileError.fileDoesNotExist &#123; print("File not found")&#125; catch &#123; print(error)&#125; Èô§‰∫ÜÁ≥ªÁªüÊèê‰æõÁöÑÈîôËØØÔºåÊàë‰ª¨ËøòÂèØ‰ª•Ëá™Â∑±ÂÆö‰πâÈîôËØØÁ±ªÂûã„ÄÇÂàõÂª∫‰∏Ä‰∏™ÁªßÊâø‰∫é Error ÁöÑÊûö‰∏æÔºö 1234enum ParseError: Error &#123; case wrongEncoding case warning(line: Int, message: String)&#125; Swift ÁöÑÈîôËØØÊòØÊó†Á±ªÂûãÁöÑÔºåÊàë‰ª¨Âè™Â∞ÜÂáΩÊï∞Ê†áËÆ∞‰∏∫ throwsÔºå‰ΩÜÊòØÊ≤°ÊúâÊåáÂá∫Â∫îËØ•ÊäõÂá∫ÈÇ£‰∏™Á±ªÂûãÁöÑÈîôËØØ„ÄÇÊâÄ‰ª•Êàë‰ª¨ÊúÄÂ•ΩÂú®ÂáΩÊï∞ÂÆö‰πâÁöÑÊó∂ÂÄôËßÑËåÉÁöÑÂä†Â•ΩÊ≥®Èáä„ÄÇ ÈîôËØØÂíåÂáΩÊï∞ÂèÇÊï∞ Âú®ÂáΩÊï∞Â∞ÅË£ÖÁöÑÊó∂ÂÄôÂèØËÉΩ‰ºöÈÅáÂà∞‰∏ÄÁßçÊÉÖÂÜµÔºö‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÂáΩÊï∞ÂèÇÊï∞ÂèØËÉΩ‰ºöÊäõÂá∫ÈîôËØØ‰πüÂèØËÉΩ‰∏ç‰ºöÊäõÂá∫ÈîôËØØ„ÄÇÂ¶ÇÊûúËøô‰∏™ÂáΩÊï∞‰ΩøÁî® try Ë∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞ÂèÇÊï∞ÔºåÈÇ£‰πàËøô‰∏™ÂáΩÊï∞ÂèÇÊï∞‰∏ç‰ºöÊäõÂá∫ÈîôËØØÁöÑÁâàÊú¨‰πüÈúÄË¶ÅÂä†‰∏ä throws„ÄÇ ÂèØ‰ª•ÈÄöËøá rethrows Ê†áËÆ∞‰ª£Êõø throws„ÄÇ‰ΩøÁî®Ëøô‰∏™Ê†áËÆ∞ÁöÑÂáΩÊï∞ËøòÊòØÈúÄË¶ÅÂØπ‰∫éÂáΩÊï∞ÂèÇÊï∞‰ΩøÁî® tryÔºå‰ΩÜÊòØÂ¶ÇÊûúÂáΩÊï∞ÂèÇÊï∞‰∏ç‰ºöÊäõÂá∫ÈîôËØØÔºåÈÇ£‰πà‰πü‰∏çÂº∫Âà∂ÂáΩÊï∞ÂèÇÊï∞Áî® throws Ê†áËÆ∞‰∫Ü„ÄÇ ‰ΩøÁî® defer ËøõË°åÊ∏ÖÁêÜ Swift ‰∏≠ÁöÑ defer ÔºåÂõ¥ÁªïÁöÑ‰ª£Á†ÅÂùó‰∏ÄÂÆö‰ºöÂú®ÂáΩÊï∞ËøîÂõûÊó∂Ë¢´ÊâßË°åÔºàÂ∞±ÊòØÁõ∏ÂΩì‰∫éÂú® return ‰πãÂêéÂÜçÊâßË°å‰∏Ä‰∫õÊìç‰ΩúÔºâ defer Á±ª‰ºº‰∫éÂÖ∂‰ªñËØ≠Ë®ÄÁöÑ finallyÔºå‰ΩÜÊòØ defer ‰∏çÂè™ÊòØÁî®‰∫éÈîôËØØÂ§ÑÁêÜÔºåÂèØ‰ª•Â∞Ü defer ÊîæÂú®‰ª£Á†ÅÂùóÁöÑ‰ªªÊÑèÂú∞Êñπ„ÄÇ Â¶ÇÊûúÂêå‰∏Ä‰∏™‰ΩúÁî®ÂüüÈáå‰ΩøÁî®Â§ö‰∏™ deferÔºåÈÇ£‰πàÂÆÉ‰ª¨‰ºöË¢´ÈÄÜÂ∫èÊâßË°åÔºåÂèØ‰ª•ÊääÂÆÉÊÉ≥Ë±°Êàê‰∏Ä‰∏™Ê†à„ÄÇÁî®ÊÑèÂú®‰∫éÔºåÊØîÂ¶ÇÊàë‰ª¨ÂºÄÂêØÊï∞ÊçÆÂ∫ìÁÑ∂ÂêéËøûÊé•ÔºåÁî® defer Â∞±ËÉΩËá™ÁÑ∂ÁöÑÂÖàÂÖ≥Èó≠ËøûÊé•ÔºåÂÜçÂÖ≥Èó≠Êï∞ÊçÆÂ∫ì„ÄÇ ÈîôËØØÂíåÂèØÈÄâÂÄº ÂèØ‰ª•‰ΩøÁî® try? Êù•ÂøΩÁï•ÂáΩÊï∞ËøîÂõûÁöÑÈîôËØØÔºå‰πüÂ∞±ÊòØËØ¥‰∏çÁî®ÂÜç do-catch ‰∫Ü„ÄÇ È´òÈò∂ÂáΩÊï∞ÂíåÈîôËØØ Âú®ÂºÇÊ≠•Êìç‰ΩúÔºåÊØîÂ¶ÇÂõûË∞ÉÂáΩÊï∞‰∏≠Âπ∂‰∏çËÉΩ‰ΩøÁî® throwsÔºåÂõ†‰∏∫ËøôÂπ∂‰∏çË°®Á§∫ÂáΩÊï∞ÈáåÊâßË°åÁöÑÂÜÖÂÆπÂèØËÉΩÂ§±Ë¥•ÔºåËÄåÊòØÊåáÂáΩÊï∞Êú¨Áîü‰ºöÂ§±Ë¥•„ÄÇËøô‰∏™Êó∂ÂÄôÔºåÊàë‰ª¨Â∞±Ë¶Å‰ΩøÁî® Result Êõø‰ª£‰∫Ü„ÄÇ Ê≥õÂûãÊ≥õÂûãÁöÑÂ∑•‰ΩúÊñπÂºè Swift ‰∏∫Ê≥õÂûãÂºïÂÖ•‰∏Ä‰∏™‰∏≠Èó¥Â±ÇÔºåÂΩìÈÅáÂà∞Ê≥õÂûãÁ±ªÂûãÁöÑÂÄºÊó∂ÔºåÂÆÉ‰ºöÂ∞ÜÂÖ∂ÂåÖË£ÖÂà∞‰∏Ä‰∏™ÂÆπÂô®‰∏≠„ÄÇ ÂØπ‰∫éÊ≥õÂûãÁ±ªÂûãÁöÑÂèÇÊï∞ÔºåÁºñËØëÂô®Áª¥Êä§‰∫Ü‰∏ÄÁ≥ªÂàó‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÁõÆÂáªË°®ÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™ÂÄºÁõÆÂáªË°®Ôºå‰ª•ÂèäÁ±ªÂûã‰∏äÊØè‰∏™ÂçèËÆÆÁ∫¶Êùü‰∏Ä‰∏™ÂçèËÆÆÁõÆÂáªË°®„ÄÇÁõÆÂáªË°®Â∞ÜË¢´Áî®Êù•Â∞ÜËøêË°åÊó∂ÁöÑÂáΩÊï∞Ë∞ÉÁî®Âä®ÊÄÅÊ¥æÂèëÂà∞Ê≠£Á°ÆÁöÑÂÆûÁé∞ ‰ªªÊÑèÁöÑÊ≥õÂûãÁ±ªÂûãÔºåÊÄª‰ºöÂ≠òÂú®ÂÄºÁõÆÂáªË°®„ÄÇÂÆÉÂåÖÂê´‰∫ÜÊåáÂêëÂÜÖÂ≠òÁî≥ËØ∑ÔºåÂ§çÂà∂ÂíåÈáäÊîæËøô‰∫õÁ±ªÂûãÁöÑÂü∫Êú¨Êìç‰ΩúÁöÑÊåáÈíà(Â∞±ÊòØÂàõÂª∫Ê≥õÂûãÁ±ªÂûãÂÆû‰æãÁöÑÊåáÈíà) ÂÖ≥‰∫éÂçèËÆÆÁõÆÂáªË°®ÔºåÂØπ‰∫éËøô‰∏™ÂçèËÆÆÂ£∞ÊòéÁöÑÊØè‰∏™ÊñπÊ≥ïÊàñËÄÖÂ±ûÊÄßÔºåÂçèËÆÆÁõÆÂáªË°®‰∏≠ÈÉΩÂê´Êúâ‰∏Ä‰∏™ÊåáÈíàÔºåÊåáÂêëËØ•Êª°Ë∂≥ÂçèËÆÆÁöÑÁ±ªÂûã‰∏≠ÁöÑÂØπÂ∫îÂÆûÁé∞„ÄÇÂú®Ê≥õÂûãÂáΩÊï∞‰∏≠ÂØπËøô‰∫õÊñπÊ≥ïÁöÑÊØèÊ¨°Ë∞ÉÁî®ÔºåÈÉΩ‰ºöÂú®ËøêË°åÊó∂ÈÄöËøáÁõÆÂáªË°®ËΩ¨Êç¢‰∏∫ÊñπÊ≥ïÊ¥æÂèë„ÄÇ(ÊØè‰∏™ÊñπÊ≥ïÂ±ûÊÄßÈÉΩÊúâÂØπÂ∫îÊåáÈíà) ÂçèËÆÆÁõÆÂáªË°®Êèê‰æõ‰∫Ü‰∏ÄÁªÑÊò†Â∞ÑÂÖ≥Á≥ªÔºåÂèØ‰ª•Áü•ÈÅìÂçèËÆÆÂíåÂÖ∑‰ΩìÁöÑÂçèËÆÆÂäüËÉΩÁöÑÊò†Â∞ÑÂÖ≥Á≥ª„ÄÇ Ê≥õÂûãÂèÇÊï∞ÁöÑÂÆπÂô®Âè™ÂåÖÂê´ÂÄºÂ≠òÂÇ®ÔºåÁõÆÂáªË°®Ë¢´ÂçïÁã¨Â≠òÂÇ®„ÄÇËøôÊ†∑Ê≥õÂûãÂáΩÊï∞‰∏≠ÂêåÊ†∑Á±ªÂûãÁöÑÂÖ∂‰ªñÂèòÈáèÂ∞±ÂèØ‰ª•ÂÖ±‰∫´Ëøô‰∏™ÁõÆÂáªË°®‰∫Ü Ê≥õÂûãÁâπÂåñ Âõ†‰∏∫Ê≥õÂûãÊòØÂä®ÊÄÅÊ¥æÂèëÔºåÊâÄ‰ª•‰ºöÊúâ‰∏Ä‰∫õÊÄßËÉΩÊçüËÄó„ÄÇ‰∏çËøá Swift ÂèØ‰ª•ÈÄöËøáÊ≥õÂûãÁâπÂåñÁöÑÊñπÂºèÈÅøÂÖçÈ¢ùÂ§ñÂºÄÈîÄ„ÄÇ Ê≥õÂûãÁâπÂåñÊåáÁöÑÊòØÁºñËØëÂô®ÊåâÁÖßÂÖ∑‰ΩìÁöÑÂèÇÊï∞Á±ªÂûãÔºåÂ∞ÜÊ≥õÂûãÁ±ªÂûãÊàñËÄÖÂáΩÊï∞ËøõË°åÂ§çÂà∂„ÄÇ(Â∞±ÊòØÂú®ÁºñËØëÁöÑÊó∂ÂÄôÔºåÁî®‰ºöÁî®Âà∞ÁöÑÁâπÂÆöÁöÑÁ±ªÂûã‰ª£ÊõøÊ≥õÂûã) ÂçèËÆÆ ‰∏Ä‰∏™Áî±ÂÖ≥ËÅîÁ±ªÂûãÁöÑÂçèËÆÆ‰∏çËÉΩ‰Ωú‰∏∫Á±ªÂûãÔºåÂè™ËÉΩ‰Ωú‰∏∫Ê≥õÂûãÁ∫¶Êùü ÂΩìÊàë‰ª¨ÈÄöËøáÂçèËÆÆÁ±ªÂûãÂàõÂª∫‰∏Ä‰∏™ÂèòÈáèÁöÑÊó∂ÂÄôÔºåËøô‰∏™ÂèòÈáè‰ºöË¢´ÂåÖË£ÖÂà∞‰∏Ä‰∏™Âè´ÂÅöÂ≠òÂú®ÂÆπÂô®ÁöÑÁõíÂ≠ê‰∏≠„ÄÇ ÂØπ‰∫éÊôÆÈÄöÂçèËÆÆÔºå‰ºö‰ΩøÁî®‰∏çÈÄèÊòéÂ≠òÂú®ÂÆπÂô®Ôºå‰∏çÈÄèÊòéÂ≠òÂú®ÂÆπÂô®‰∏≠Âê´Êúâ‰∏Ä‰∏™Â≠òÂÇ®ÂÄºÁöÑÁºìÂÜ≤Âå∫Ôºå‰∏Ä‰∫õÂÖÉÊï∞ÊçÆÔºå‰ª•ÂèäËã•Âπ≤ÁõÆÂáªË°®„ÄÇ ÂØπ‰∫éÂè™ÈÄÇÁî®‰∫éÁ±ªÁöÑÂçèËÆÆÔºå‰ºöÊúâ‰∏Ä‰∏™Âè´ÂÅöÁ±ªÂ≠òÂú®ÂÆπÂô®ÁöÑÁâπÊÆäÂ≠òÂú®ÂÆπÂô®„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS ‰∏≠ÁöÑÁΩëÁªúÊ°ÜÊû∂]]></title>
    <url>%2F2017%2F09%2F19%2FiOS%E7%BD%91%E7%BB%9C%E6%A1%86%E6%9E%B6%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÂú®ÁúãÂ∑©Âõ∫ÁΩëÁªúËØ∑Ê±ÇÁõ∏ÂÖ≥ÁöÑÁü•ËØÜ„ÄÇÂáÜÂ§áÊää AFNetworking ‰ª•ÂèäÂü∫‰∫é AFNetworking ÁöÑ‰∏Ä‰∫õÂ∞ÅË£ÖÂ∫ìÁúã‰∏ÄÁúãÔºå‰∫ÜËß£‰∏Ä‰∏ãÂéüÁêÜ„ÄÇËøô‰∏ÄÁØáÂ∞ÜÊé¢Á©∂‰∏Ä‰∏ã AFNetworking ÁöÑ‰∏§‰∏™Â∞ÅË£ÖÂ∫ì Casa ÁöÑ CTNetworkingÔºå‰ª•ÂèäÁåøÈ¢òÂ∫ìÁöÑ YTKNetwork ÁöÑÂÆûÁé∞ËøáÁ®ã„ÄÇ Casa ÁöÑ CTNetworkingCasa ÂÖ≥‰∫éÁΩëÁªúÊû∂ÊûÑÁöÑÂçöÂÆ¢‰∏≠‰∏ªË¶ÅËÆ≤‰∫ÜÂ¶Ç‰ΩïÊ∏îÔºåÊ≤°ÊúâÂàÜÊûê‰ªñÁöÑÈ±ºÊòØ‰ªÄ‰πàÊ†∑ÁöÑ„ÄÇÂàöÁúãÁöÑÊó∂ÂÄôÔºåÊàëÊòØ‰∏ÄÂ§¥ÈõæÊ∞¥ÔºåÁõ∏ÂÖ≥ÁöÑÁ±ªÁõÆÂ§™Â§ö‰∫ÜÔºåÊúâ‰∫õÁ±ªËøò‰∏çÂ§™ËÉΩÂ§üÁêÜËß£ÊÑèÂõæ„ÄÇËøõËøá‰∏ÄÊÆµÊó∂Èó¥ÁöÑÁ†îÁ©∂ÔºåÁé∞Âú®ÊòéÁôΩ‰∫ÜÂêÑ‰∏™ÁéØËäÇÁöÑ‰ΩúÁî®ÔºåÂÅö‰∏Ä‰∏™Êï¥ÁêÜ„ÄÇ ÂàùÂßãÂåñÁî±‰∫éÈááÁî®ÁöÑÊòØÁ¶ªÊï£ÂûãÁöÑ APIÔºåÊØè‰∏Ä‰∏™ API ÈÉΩÂØπÂ∫î‰∏Ä‰∏™ APIManagerÔºåÊâÄ‰ª•ËøõË°åÁΩëÁªúËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåË¶ÅÂàÜÂà´ÂàùÂßãÂåñÂêÑËá™ÈúÄË¶ÅÁöÑ APIManager„ÄÇÂàùÂßãÂåñ APIManager ÁöÑÊó∂ÂÄôÔºåË¶ÅËÆæÁΩÆ‰∏Ä‰∫õ APIBaseManager ‰∏≠ÁöÑÂ±ûÊÄßÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÂÖ∂‰∏≠ÂåÖÊã¨ÊàêÂäü‰∏éÂ§±Ë¥•ÁöÑÁùÄÈôÜÁÇπ delegateÔºåÊèê‰æõÂèÇÊï∞ÁöÑ paramSourceÔºåÈ™åËØÅÂèÇÊï∞ÁöÑ validatorÔºå‰ª•ÂèäÊã¶Êà™Âô® interceptor„ÄÇÂÆÉ‰ª¨ÈÉΩÂÆûÁé∞‰∫ÜÂêÑËá™ÂçèËÆÆ„ÄÇ‰∏ÄËà¨Êù•ËØ¥ delegate ÊòØË∞ÉÁî®ÁöÑ ViewControllerÔºåparamSource ‰πüÊòØË∞ÉÁî®ÁöÑ ViewControllerÔºåvalidator ÊòØ APIManager Ëá™Ë∫´Ôºåinterceptor ÊòØË∞ÉÁî®ÁöÑ ViewControllerÔºåvalidator Âíå interceptor ÈÉΩ‰∏çÊòØÂøÖÈ°ªÁöÑ„ÄÇËøô‰∫õÂ±ûÊÄßÈúÄË¶ÅÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôËÆæÁΩÆÂ•Ω„ÄÇ ÂèØ‰ª•ÁúãÂà∞ÔºåÂÖ∂‰∏≠ËøòÊúâ‰∏Ä‰∏™ÂÆûÁé∞ CTAPIManager ÂçèËÆÆÁöÑ child Â±ûÊÄßÔºåÊâÄÊúâÊ¥æÁîüÁöÑ APIManager ÈÉΩÂøÖÈ°ªÂÆûÁé∞ CTAPIManager ÂçèËÆÆ„ÄÇÁΩëÁªúËØ∑Ê±ÇÊâÄÈúÄÁöÑ API ÂêçÔºåÊúçÂä°Á±ªÂûãÔºåËØ∑Ê±ÇÁ±ªÂûã‰ª•ÂèäÊòØÂê¶ÁºìÂ≠ò (ÊòØÂê¶ÁºìÂ≠òÂÖ∂ÂÆûÊ≤°ÂøÖË¶Å‰Ωú‰∏∫ÂøÖÈ°ªÁöÑÊñπÊ≥ïÂêßÔºåÈªòËÆ§‰∏çÁºìÂ≠òÔºåË¶ÅÁºìÂ≠òÁöÑÂ≠êÁ±ªÂÆûÁé∞Â∞±Â•Ω‰∫ÜÂïä) ÈÉΩÈúÄË¶ÅÈÄöËøáËøô‰∏™Êé•Âè£‰∏≠ËøîÂõûÔºö ÊâÄ‰ª•Áé∞Âú®ÁöÑÁªßÊâøÂÖ≥Á≥ªÂ∫îËØ•ÊòØÔºöAPIManager ÁªßÊâø‰∫é CTAPIBaseManagerÔºåÂπ∂‰∏îÂÆûÁé∞ÂçèËÆÆ CTAPIManager„ÄÇÂü∫Á±ªÊú¨ÁîüÂπ∂‰∏çÂÆûÁé∞ÂçèËÆÆ„ÄÇ ÈÇ£‰πà‰∏∫‰ªÄ‰πàÂü∫Á±ª‰∏çÁõ¥Êé•Êèê‰æõÂçèËÆÆ‰∏≠ÁöÑÊñπÊ≥ïÔºåËÄåÊòØË¶Å‰ª•ÂçèËÆÆÁöÑÊñπÂºèËé∑ÂèñÂë¢ÔºüÂçèËÆÆÁöÑÁâπÁÇπÂ∞±ÊòØÊèê‰æõÊé•Âè£ËßÑËåÉ„ÄÇÂØπ‰∫éËøô‰∫õÂøÖÈ°ªÂÆûÁé∞ÁöÑÊñπÊ≥ïÔºåÁ°ÆÂÆûÊòØÂèØ‰ª•ÈÄöËøáÂú®Âü∫Á±ª‰∏≠ÊäõÂá∫ÂºÇÂ∏∏Êù•Âº∫Âà∂Â≠êÁ±ªÈáçÂÜôÔºåËææÂà∞ÁõÆÁöÑ„ÄÇ‰ΩÜÊòØËøôÊúâ‰∏§‰∏™Áº∫ÁÇπÔºå‰∏Ä‰∏™ÊòØ‰∏çÁõ¥ËßÇÔºåË∞ÉÁî®ËÄÖ‰∏çËÉΩÁ´ãÂç≥Áü•ÈÅìÈúÄË¶ÅÈáçÂÜôÂì™‰∫õÊñπÊ≥ï„ÄÇÂè¶‰∏Ä‰∏™Áº∫ÁÇπÊòØÔºåÂèØËÉΩÊúâ‰∫õÊñπÊ≥ïÂøòËÆ∞‰∫ÜÈáçÂÜôÔºåËøôÊ†∑Âè™ÊúâÂú®ËøêË°åÁöÑÊó∂ÂÄôÊâç‰ºöÊäõÂá∫ÂºÇÂ∏∏Ôºå‰ΩÜÊòØ‰ΩøÁî®ÂçèËÆÆÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÆåÂÖ®ÂÆûÁé∞ÂøÖÈ°ªÁöÑÊñπÊ≥ïÔºåÁºñËØëÈÉΩÊó†Ê≥ïÈÄöËøá„ÄÇ Âõ†Ê≠§ÔºåÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôË¶ÅÂÖàÂà§Êñ≠Ê¥æÁîüÁ±ªÊòØÂê¶ÂÆûÁé∞‰∫Ü CTAPIManagerÔºåÊ≤°ÊúâÂÆûÁé∞ÁöÑÁõ¥Êé•ÊäõÂá∫ÂºÇÂ∏∏„ÄÇ Âü∫Êú¨ÊµÅÁ®ãÂú®ÂàõÂª∫‰∫Ü APIManager ÁöÑÂÆû‰æãÂêéÔºåË∞ÉÁî®ÂÖ∂Áªü‰∏ÄÁöÑÊñπÊ≥ï loadData Êù•ÂºÄÂßãÁΩëÁªúËØ∑Ê±Ç„ÄÇÂü∫Êú¨ÊµÅÁ®ãÂ¶ÇÂõæÊâÄÁ§∫Ôºö È¶ñÂÖàÊòØËé∑ÂèñÂèÇÊï∞„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÊòØÂú®ÁΩëÁªúËØ∑Ê±ÇÁöÑÊó∂ÂÄôÂ∞ÜÂèÇÊï∞‰∏ÄÂπ∂‰º†ËøáÂéªÔºåËÄåËøôÈáåÈúÄË¶Å‰Ω†Â∞ÜÂÆûÁé∞‰∫Ü CTAPIManagerParamSource ÂçèËÆÆÁöÑÁ±ª‰Ωú‰∏∫Êï∞ÊçÆÊ∫êÔºåÂÆûÁé∞ÂÖ∂Ëé∑ÂèñÊï∞ÊçÆÁöÑÊñπÊ≥ïÔºåÈÄöËøá manager ÁöÑ‰∏çÂêåÊù•Âå∫ÂàÜ‰∏çÂêå APIÔºö ÈáçÁªÑÂèÇÊï∞ reformParams:ÔºåÂπ∂‰∏çÊòØ‰∏Ä‰∏™ÂøÖÈ°ªÁöÑÊñπÊ≥ïÔºåÈªòËÆ§ËøîÂõûÂéüÂèÇÊï∞„ÄÇÂ≠êÁ±ªÂèØ‰ª•ÈáçÂÜôËØ•ÊñπÊ≥ïÂú®Ë∞ÉÁî® API ‰πãÂâçÈ¢ùÂ§ñÊ∑ªÂä†‰∏Ä‰∫õ‰∏é‰∏öÂä°ÈÄªËæëÊó†ÂÖ≥ÁöÑÂèÇÊï∞ÔºåÊØîÂ¶Ç pageNumber Âíå pageSize ‰πãÁ±ªÁöÑ„ÄÇ Êã¶Êà™Âô®‰∏çÊòØÂøÖÈ°ªÁöÑÔºåÊâÄ‰ª•Ë∞ÉÁî®Êã¶Êà™Âô®ÊñπÊ≥ïÂâçÔºåÂÖàË¶ÅÂà§Êñ≠‰∏Ä‰∏ãÊòØÂê¶ÊúâÊã¶Êà™Âô®„ÄÇÊã¶Êà™Âô®ÊòØÂíå‰∏öÂä°ÈÄªËæëÊúâÂÖ≥ÁöÑÔºåÊâÄ‰ª•‰∏ÄËà¨ÊòØ ViewControllerÔºåÂÖ∂ÈúÄË¶ÅÂÆûÁé∞ CTAPIManagerInterceptor ÂçèËÆÆ„ÄÇËøô‰∏™ÂçèËÆÆ‰∏≠ÂåÖÂê´‰∫ÜÂæàÂ§öÊã¶Êà™ÊñπÊ≥ïÔºåÂåÖÊã¨Ë∞ÉÁî® API ‰πãÂâç‰πãÂêéÔºåËØ∑Ê±ÇÊàêÂäü‰πãÂâç‰πãÂêéÔºåËØ∑Ê±ÇÂ§±Ë¥•‰πãÂâç‰πãÂêéÁöÑÂõûË∞ÉÊñπÊ≥ï„ÄÇÂΩìÂâçË∞ÉÁî®ÁöÑÊòØ manager:shouldCallAPIWithParams: ÊñπÊ≥ïÔºåÁî®Êù•Ê£ÄÊµãÊ≠§ manager ÊòØÂê¶ËÉΩ‰ª•ËØ• params Ë∞ÉÁî®ÁΩëÁªúËØ∑Ê±Ç„ÄÇÂ¶ÇÊûúÂÖÅËÆ∏Ë∞ÉÁî® API ÂàôËøõÂÖ•‰∏ã‰∏ÄÊ≠•ÔºåÂ¶ÇÊûú‰∏çÂÖÅËÆ∏ÔºåÁõ¥Êé•ÁªìÊùüËØ∑Ê±Ç(‰Ω†‰πüÂèØ‰ª•Âú®‰∏çÂÖÅËÆ∏ÁöÑÊó∂ÂÄôËÆæÁΩÆËµ∞Âà∞Â§±Ë¥•ÂõûË∞É)„ÄÇÊã¶Êà™Âô®‰∏ÄËà¨Áî®Êù•Â±ïÁ§∫ÂíåÈöêËóèËèäËä±~ Êé•‰∏ãÊù•ÊòØÈ™åËØÅÂô®ÔºåÁî®Êù•È™åËØÅËØ∑Ê±ÇÊï∞ÊçÆ‰ª•ÂèäËøîÂõûÊï∞ÊçÆÁöÑÂêàÊ≥ïÊÄß„ÄÇÈ™åËØÅÂô®ÊòØÂíå‰∏öÂä°Êó†ÂÖ≥ÁöÑÔºåÊâÄ‰ª•‰∏ÄËà¨‰∫§Áªô APIManager Â∞±Ë°å‰∫Ü„ÄÇÂú® API Ë∞ÉÁî®ÂâçÔºåÈ™åËØÅÂô®‰∏ÄËà¨Áî®Êù•Âú® API Ë∞ÉÁî®ÂâçÈ™åËØÅÂèÇÊï∞ÊòØÂê¶Á¨¶ÂêàËßÑÂàôÔºåÊØîÂ¶ÇÊâãÊú∫Âè∑ÂïäÔºåÈÇÆÁÆ±Âïä‰πãÁ±ªÔºåÈÅøÂÖçÊó†ÊïàÁöÑ API ËØ∑Ê±ÇÔºåÂä†Âø´ÂìçÂ∫îÈÄüÂ∫¶„ÄÇÂ¶ÇÊûúÈ™åËØÅÂ§±Ë¥•‰∫ÜÔºåÁõ¥Êé•Ëµ∞Â§±Ë¥•ÂõûË∞ÉÔºåÂ∞ÜCTAPIBaseManager ‰∏≠ÁöÑ CTAPIManagerErrorType errorType Â±ûÊÄßËÆæÁΩÆ‰∏∫ CTAPIManagerErrorTypeParamsError Ë°®Á§∫ÂèÇÊï∞ÈîôËØØ„ÄÇ Êé•‰∏ãÊù•ËØ¢ÈóÆÂ≠êÁ±ª APIManager ÊòØÂê¶Ë¶Å‰ªéÊú¨Âú∞Ëé∑ÂèñÊï∞ÊçÆ„ÄÇÂ¶ÇÊûúÂèØ‰ª•‰ªéÊú¨Âú∞Ëé∑ÂèñÔºåÈÇ£‰πà‰ªé UserDefault ‰∏≠ÂèñÂá∫Êï∞ÊçÆ„ÄÇÂ¶ÇÊûúÊúâÊï∞ÊçÆÔºåÈÇ£‰πàÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÊâßË°åÊàêÂäüÂõûË∞ÉÔºåÂ¶ÇÊûúÊ≤°ÊúâÊï∞ÊçÆÔºåÈÇ£‰πàËÆæÁΩÆ isNativeDataEmpty Ê†áËØÜ‰Ωç YESÔºåËøô‰∏™Ê†áËØÜ‰ΩçÂêéÈù¢‰ºöÁî®Âà∞„ÄÇ Ê≥®ÊÑèÂà∞ÔºåËøôÈáåÂç≥‰Ωø‰ªéÊú¨Âú∞Âä†ËΩΩ‰∫ÜÊï∞ÊçÆÔºå‰πü‰∏ç‰ºöÁõ¥Êé• return ËÄåÊòØË¶ÅÁªßÁª≠ËøõË°åÁΩëÁªúËØ∑Ê±ÇÁöÑ„ÄÇËøôÈáåÁöÑÈÄªËæëÊòØÂèØËÉΩÂ≠òÂú®‰∏Ä‰∫õ API Ëé∑ÂèñÂà∞Êï∞ÊçÆÂêé‰∏ç‰ºöÁ´ãÂç≥Â±ïÁ§∫ÔºåËÄåÊòØ‰øùÂ≠òËµ∑Êù•ÔºåÂ±ïÁ§∫‰∏äÊ¨°‰øùÂ≠òÁöÑÊï∞ÊçÆ„ÄÇÊØîÂ¶ÇÈ¶ñÂ±èÂπøÂëäÂõæÁâá„ÄÇ Êé•‰∏ãÊù•ËØ¢ÈóÆÊòØÂê¶ÂèØ‰ª•ÁºìÂ≠òÔºåÂ¶ÇÊûúÂ≠êÁ±ªÊ≤°ÊúâÂÆûÁé∞Ëøô‰∏™ÊñπÊ≥ïÔºåÈÇ£‰πà‰ªé CTNetworkingConfigurationManager Ëøô‰∏™ÈÖçÁΩÆ‰∏≠ÂøÉËé∑Âèñ„ÄÇÔºàËøôÈáå‰∏çÂ§™ÂØπÔºåÂõ†‰∏∫ shouldCache ÊòØ APIManager ÂçèËÆÆ‰∏≠ÂÆö‰πâÁöÑÂøÖÈ°ªÂÆûÁé∞ÁöÑÊñπÊ≥ïÊñπÊ≥ïÔºåÊâÄ‰ª•‰∏ç‰ºöÂ≠òÂú®‰ªéÈÖçÁΩÆ‰∏≠ÂøÉËØªÂèñËøô‰∏ÄÊ≠•„ÄÇÂÖ∂ÂÆûÊúÄÂ•ΩËøòÊòØÁõ¥Êé•ËÆæÁΩÆÊàêÂèØÈÄâÊñπÊ≥ïÔºåÂú® base ‰∏≠Êèê‰æõ‰∏™ÈªòËÆ§ÂÆûÁé∞„ÄÇÔºâ Â¶ÇÊûúËøô‰∏™ API ÂèØ‰ª•ÁºìÂ≠òÔºåÈÇ£‰πàÂÜçÈÄöËøá serviceTypeÔºåmethodName ‰ª•Âèä requestParams ÁªÑÊàêÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰ΩøÁî® CTCache Ëøô‰∏™Âçï‰æãÂéªÊü•ÁúãÊú¨Âú∞ÊòØÂê¶ÊúâÊï∞ÊçÆ„ÄÇÂèñÂá∫‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑ CTCachedObject Á±ªÂûã„ÄÇËøô‰∏™Á±ªÂûã‰øùÂ≠ò‰∏§‰∏™ NSData ÂØπË±°Ôºå‰∏Ä‰∏™ÊòØÁºìÂ≠òÁöÑÊï∞ÊçÆ contentÔºå‰∏Ä‰∏™ÊòØÁºìÂ≠òÁöÑÊó∂Èó¥ lastUpdateTimeÔºåÂõ†‰∏∫Ë¶ÅÂà§Êñ≠ÊòØÂê¶Ë∂ÖËøá‰∫ÜÁºìÂ≠òÁöÑÊó∂Èó¥„ÄÇÂ¶ÇÊûúÊó¢ÊúâÁºìÂ≠òÂÜÖÂÆπÔºåÁºìÂ≠òËøòÊ≤°ÊúâË∂ÖÊó∂ÔºåÈÇ£‰πàÊãøÂá∫Êù•ÔºåÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÊâßË°åÊàêÂäüÂõûË∞É„ÄÇ ‰∏çËÆ∫ÊòØ‰ªéÊú¨Âú∞ËøòÊòØ‰ªé Cache ÈÉΩ‰ΩøÁî®‰∫ÜÁîüÊàê‰∫Ü‰∏Ä‰∏™ËøîÂõûÂÆû‰æãÁöÑÂ∞ÅË£Ö CTURLResponseÔºåËøô‰∏™Â∞ÅË£ÖÈáåÊúâ‰∏Ä‰∏™Ê†áËØÜÁ¨¶ isCacheÔºåË°®Á§∫ÈùûÁΩëÁªúËØ∑Ê±ÇÂæóÂà∞ÁöÑÊï∞ÊçÆÔºå‰ª•Ê≠§ÂíåÁΩëÁªúËØ∑Ê±ÇÊï∞ÊçÆËøõË°åÂå∫Âà´„ÄÇÂÆÉÊèê‰æõ‰∫Ü‰∏â‰∏™ÂàùÂßãÂåñÊñπÊ≥ïÔºå‰∏äÈù¢‰∏§‰∏™ÊòØÁΩëÁªúËøîÂõûÊàêÂäüÂíåÂ§±Ë¥•ÁöÑÂàùÂßãÂåñÁöÑÊñπÊ≥ï„ÄÇÊúÄÂêé‰∏Ä‰∏™ initWithData: Â∞±ÊòØÂàöÊâçËØ¥ÁöÑÊú¨Âú∞Êï∞ÊçÆÁöÑÂàùÂßãÂåñÊñπÊ≥ï„ÄÇ Â¶ÇÊûúÊ≤°ÊúâÁºìÂ≠òÔºåÈÇ£‰πàÂ∞±Ë¶ÅÊâßË°åÁΩëÁªúËØ∑Ê±Ç‰∫Ü„ÄÇ‰ΩÜÊòØÂú®ËØ∑Ê±ÇÂâçÔºåËøòÈúÄË¶ÅÊ£ÄÊü•‰∏Ä‰∏ãÁΩëÁªúÊÉÖÂÜµ„ÄÇÂú®‰∏äÈù¢ÁöÑÈÖçÁΩÆ‰∏≠ÂøÉ(CTNetworkingConfigurationManagerÔºåÂÖ≥‰∫éÈÖçÁΩÆÁöÑÈÉΩÊâîÂú®ËøôÈáå)ËøòÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ïË∞ÉÁî® AFNetworking ÁöÑÊñπÊ≥ïÔºåÂè™Ë¶Å‰∏çÊòØÊòéÁ°ÆÁöÑÊó†ÁΩëÁªú NotReachable Â∞±ËøîÂõû YES„ÄÇÂ¶ÇÊûúÊó†ËøûÊé•ÔºåÈÇ£‰πàÊâßË°åÂ§±Ë¥•ÂõûË∞ÉÔºå errorType ‰∏∫Êó†ÁΩëÁªúËøûÊé•„ÄÇ ÊúÄÂêéÔºåÂèëÈÄÅÁΩëÁªúËØ∑Ê±ÇÂâçÔºåÂ∞Ü APIManager ‰∏≠ÁöÑ isLoading Ê†áÂøó‰ΩçÁΩÆ‰∏∫ YESÔºåË°®Á§∫Ê≠£Âú®ËøõË°åÁΩëÁªúËØ∑Ê±Ç„ÄÇËøô‰∏™ÁöÑ‰ΩúÁî®ÊòØÂú®Êüê‰∫õ API ‰∏≠ÂèØ‰ª•Èò≤Ê≠¢ÈáçÂ§çÂèëÈÄÅËØ∑Ê±Ç„ÄÇÊØîÂ¶ÇÁøªÈ°µÔºåÂ∞±ÂèØ‰ª•Âà§Êñ≠ isLoading ÁöÑÁä∂ÊÄÅÊù•ÊâßË°å‰∏çÂêåÁöÑËØ∑Ê±ÇÁ≠ñÁï•„ÄÇ ÁΩëÁªúËØ∑Ê±ÇÁΩëÁªúËØ∑Ê±ÇÂ§ßËá¥ÂàÜ‰∏∫‰∏§Ê≠•ÔºåÁ¨¨‰∏ÄÊ≠•ÊòØÁîüÊàê‰∏Ä‰∏™ NSURLRequestÔºåÁ¨¨‰∫åÊ≠•Â∞±ÊòØÊâßË°å„ÄÇÊï¥‰∏™ËøáÁ®ãÂú® CTApiProxy ‰∏≠ËøõË°å„ÄÇ ÁîüÊàê RequestÁîüÊàê Request ÁöÑ‰∏ªË¶ÅËøáÁ®ãÂú® CTRequestGenerator ‰∏≠ÂÆåÊàê„ÄÇ Âú®ÂºÄÂßãÂâçÔºåÊàë‰ª¨ÂÖàË¶ÅÁü•ÈÅì CTService ÊòØ‰∏™‰ªÄ‰πà‰∏úË•ø„ÄÇÊù•Áúã‰∏Ä‰∏ãÂÆÉÁöÑÊûÑÊàêÔºö ‰∏ªË¶ÅÂÆö‰πâ‰∫ÜÂÖ¨Èí•„ÄÅÁßÅÈí•„ÄÅÊ†π Url ‰ª•Âèä API ÁâàÊú¨„ÄÇÊ†πÊçÆËøô‰∏™ CTService ÂèØ‰ª•Ê¥æÁîüÂá∫ÂêÑÁßç serviceÔºåÊØè‰∏Ä‰∏™ service ÈÉΩÊúâËá™Â∑±ÁöÑ apiBaseUrl„ÄÇÊâÄ‰ª• CTService ÁöÑËÆæËÆ°ÊòØÁî®‰∫éÊèèËø∞Á¨¨‰∏âÊñπAPIÁöÑÁõ∏ÂÖ≥ÈÖçÁΩÆÂíå‰ø°ÊÅØÁöÑ„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÁ¨¨‰∏âÊñπ APIÔºåÂè™Ë¶ÅÂàõÂª∫‰∏Ä‰∏™Ëá™Ë∫´ÁöÑ Service Â∞±Ë°å‰∫Ü„ÄÇ Âè¶Â§ñÊàë‰ª¨ÁúãÂà∞ÔºåÂêå BaseAPIManager ‰∏ÄÊ†∑ÔºåCTService ‰πüÊúâ‰∏Ä‰∏™ child„ÄÇÂÆÉÂÆûÁé∞‰∫Ü CTServiceProtocol ÂçèËÆÆÔºö Â∞Ü CTService ‰∏≠ÁöÑÂá†‰∏™Â±ûÊÄßÂàÜ‰∏∫‰∫ÜÁ∫ø‰∏äÂíåÁ∫ø‰∏ãÁâàÊú¨„ÄÇÊâÄÊúâÂÆûÁé∞ËØ•ÂçèËÆÆÁöÑÁ±ªÈÉΩÈúÄË¶ÅÂÆö‰πâËøô‰∫õÂ±ûÊÄßÁöÑ get ÊñπÊ≥ï„ÄÇ‰∫ãÂÆû‰∏äÔºåÊàë‰ª¨ÂÆö‰πâÁöÑÂ≠êÁ±ª‰∏çÈúÄË¶ÅËÆæÁΩÆ CTService ÁöÑÂá†‰∏™Â±ûÊÄß„ÄÇÂÆÉ‰ºöËá™Âä®Ê†πÊçÆÂΩìÂâçÁéØÂ¢É isOnline ËøõË°åÈÄâÊã©ÔºåisOnline ÂèØ‰ª•Áªü‰∏ÄËØªÂèñÈÖçÁΩÆ‰ø°ÊÅØ‰∏≠ÁöÑËÆæÁΩÆ„ÄÇ‰æãÂ¶ÇÔºö CTServiceProtocol ÂÆö‰πâ‰∫ÜÂá†‰∏™ÈúÄË¶ÅÂÆûÁé∞ÁöÑËØªÂÜôÊñπÊ≥ï„ÄÇCTService ‰∏çÂÆûÁé∞ CTServiceProtocol ÂçèËÆÆÔºå‰ΩÜÊòØÂÆûÁé∞‰∫ÜÂçèËÆÆ‰∏≠ÁöÑËØªÂÜôÊñπÊ≥ïÔºåËøôÊ†∑ CTService ÁöÑÂ≠êÁ±ªÂ∞±‰∏çÈúÄË¶ÅÂÜçÈáçÂ§çÂÜôËØªÂÜôÊñπÊ≥ï‰∫Ü„ÄÇCTService ÁöÑÂ≠êÁ±ªË¶ÅÂÅöÁöÑÂ∞±ÊòØÊèê‰æõ CTServiceProtocol ‰∏≠ÂÆö‰πâÁöÑÂá†‰∏™Â±ûÊÄß„ÄÇÁõ∏ÂÖ≥ÈÄªËæëÂ∞±‰ºöÈÄöËøá CTService ‰∏≠Êèê‰æõÁöÑËØªÂÜôÊñπÊ≥ïËé∑ÂèñËøôÂá†‰∏™Â±ûÊÄßÂÄº‰∫Ü„ÄÇ Áî±‰∫éÂèØËÉΩÊúâÂ§ö‰∏™ serviceÔºåÂπ∂‰∏îÂ¶ÇÊûúÊØèÊ¨°ÈÉΩÂàõÂª∫ Service Â§™ÊçüËÄóÊÄßËÉΩÔºåÊâÄ‰ª•Â∞±Êèê‰æõ‰∫Ü‰∏Ä‰∏™Â∑•ÂéÇ CTServiceFactory Áî®‰∫éÁªü‰∏ÄÁÆ°ÁêÜ‰øùÂ≠òÊâÄÊúâÁöÑ service„ÄÇAPIManager ÈÄöËøá serviceType Â≠óÁ¨¶‰∏≤Ë°®Á§∫ÂÖ∂Â±û‰∫éÂì™‰∏™ serviceÔºåÂç≥Ë¶ÅÂàõÂª∫ÁöÑ service Á±ªÂûã„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶Å‰∏Ä‰∏™ serviceType Âíå CTService ÁöÑÊò†Â∞ÑË°®„ÄÇËøô‰∏™Êò†Â∞ÑË°®Áî±‰∏Ä‰∏™ÂÆûÁé∞‰∫Ü CTServiceFactoryDataSource ÂçèËÆÆÁöÑÁ±ªÊèê‰æõ„ÄÇ‰∏ÄËà¨Êàë‰ª¨Â∞Ü AppDelegate ËÆæÁΩÆ‰∏∫Ëøô‰∏™ DataSourceÔºåÊèê‰æõ type ‚Üí Service ÁöÑÊò†Â∞Ñ„ÄÇ ÂõûÂà∞‰∏ªÊµÅÁ®ã„ÄÇÂÖàÂà∞ CTServiceFactory ‰∏≠Êü•ÁúãÊòØÂê¶Â∑≤ÁªèÂ≠òÂú®Áõ∏Â∫îÁöÑ Service„ÄÇÂ¶ÇÊûú‰∏çÂ≠òÂú®Â∞±Ë¶ÅÈÄöËøáÊò†Â∞ÑË°®ÊâæÂà∞ÂØπÂ∫îÁöÑ Service Á±ªÔºåÂàõÂª∫‰∏Ä‰∏™„ÄÇ ÂæóÂà∞ Service ÂêéÔºåÂ∞±ÂèØ‰ª•ËøõË°åÂÆåÊï¥ url ÁöÑÊãºÊé•„ÄÇËøô‰∏ÄÊìç‰Ωú‰πüÊòØÁî± CTService ÂÆåÊàêÁöÑ„ÄÇÂõ†‰∏∫‰∏çÂêå Service ÂèØËÉΩÊúâ‰∏çÂêåÁöÑÊãºÊé•ËßÑÂàô„ÄÇ ‰πãÂêéÊ∑ªÂä†È¢ùÂ§ñÁöÑÂèÇÊï∞„ÄÇËøô‰∏™ÂèÇÊï∞‰∏çÊòØ‰∏öÂä°Á∫ßÁöÑÔºå‰πü‰∏çÊòØÊé•Âè£Á∫ßÁöÑÔºåËÄåÊòØ Service Á∫ßÁöÑÔºåÂç≥ÊâÄÊúâËØ• Service ÈÉΩÈúÄË¶Å‰º†ÈÄíÁöÑÂèÇÊï∞ÔºåÊØîÂ¶Ç token ‰πãÁ±ªÁöÑ„ÄÇ Ë∞ÉÁî® AFNetworking Êèê‰æõÁöÑÊñπÊ≥ïÔºå‰º†ÂÖ• url„ÄÅÂèÇÊï∞ÂíåËØ∑Ê±ÇÁ±ªÂûãÔºåÂàõÂª∫‰∏Ä‰∏™ NSURLRequest ÂÆû‰æã„ÄÇ Êúâ‰∏Ä‰∫õ Service ÈúÄË¶ÅÊ∑ªÂä†Ëá™Â∑±ÁâπÊúâÁöÑ header„ÄÇÂõ†Ê≠§ÔºåË∞ÉÁî® CTService ‰∏≠ÁöÑÊñπÊ≥ïÔºå‰∏∫‰∏çÂêå ServiceÊ∑ªÂä† header„ÄÇ Request Êú¨ÁîüÊòØÊ≤°ÊúâËØ∑Ê±ÇÂèÇÊï∞Ëøô‰∏™Â±ûÊÄßÁöÑ„ÄÇ‰ΩÜÊòØÊàë‰ª¨ÊÉ≥ÊääËØ∑Ê±ÇÂèÇÊï∞‰øùÂ≠òËµ∑Êù•ÔºåÂõ†‰∏∫Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºåÂú®ÊàêÂäüÂ§±Ë¥•ÂõûË∞ÉÁöÑÊó∂ÂÄôÂèØËÉΩÈúÄË¶ÅÁî®Âà∞ËØ∑Ê±ÇÂèÇÊï∞„ÄÇÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶Å‰∏∫ NSURLRequest Ê∑ªÂä†‰∏Ä‰∏™ÂàÜÁ±ªÔºåÁî®‰∫é‰øùÂ≠òËØ∑Ê±ÇÂèÇÊï∞„ÄÇ Áé∞Âú® Request ÁîüÊàêÂÆåÊØï ÊâßË°å Request ÊâßË°åËøáÁ®ãÊ∏ÖÊô∞‰∫ÜÂæàÂ§ö„ÄÇÈÄöËøá‰∏äÈù¢ÂàõÂª∫ÁöÑ RequestÔºåÂàõÂª∫‰∏Ä‰∏™ NSURLSessionDataTask ÁöÑÂÆû‰æã dataTask„ÄÇÁÑ∂ÂêéÈÄöËøáÊãøÂà∞ËØ• task ÁöÑ taskIdentifier ‰Ωú‰∏∫Ëøô‰∏™ËØ∑Ê±ÇÁöÑ requestId„ÄÇÂú® CTApiProxy ‰∏≠‰øùÂ≠ò‰∫Ü‰∏Ä‰∏™ dispatchTable Â≠óÂÖ∏ÔºåÁî®‰∫éÂ≠òÂÇ® requestId ÂØπÂ∫îÁöÑ dataTask„ÄÇÊé•ÁùÄÊâßË°åËøô‰∏™ dataTaskÔºåÂÜçÂ∞Ü requestId ‰∏ÄÂ±ÇÂ±Ç‰º†Âá∫ÔºåCTAPIBasemanager ‰∏≠Êúâ‰∏Ä‰∏™‰øùÂ≠òËøô‰∫õ id ÁöÑÊï∞ÁªÑ requestIdList„ÄÇËøô‰∏™ requestId ÁöÑÁî®Â§ÑÂú®‰∫éÈÄöËøáËøô‰∏™ requestId ÂèØ‰ª•ÈöèÊó∂ÂèñÊ∂àËØ∑Ê±Ç„ÄÇÂèñÊ∂àÁöÑÊó∂ÂÄôÈÄöËøá requestIdList ‰∏≠ÁöÑrequestId ÊâæÂà∞ dispatchTable ‰∏≠ÁöÑ NSURLSessionDataTask ÂÆû‰æãÔºåÁÑ∂ÂêéË∞ÉÁî®ÂÖ∂ cancel ÊñπÊ≥ï„ÄÇ ‰ΩÜÊòØË¶ÅÊ≥®ÊÑèÔºåÂΩì API ËØ∑Ê±ÇÈÄüÂ∫¶ÈùûÂ∏∏Âø´ÁöÑÊó∂ÂÄôÔºåAPIManager Âπ∂‰∏çËÉΩÁ°Æ‰øùÂΩìÂâçÊ≠£Âú®ËøõË°åÁöÑËØ∑Ê±ÇÊâÄÂØπÂ∫îÁöÑ requestId ÁöÑÊ≠£Á°ÆÊÄß„ÄÇÊâÄ‰ª•Â¶ÇÊûúË¶ÅÂèñÊ∂àËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÊúÄÂ•Ω cancelAllÔºåËÄå‰∏çÊòØÂè™ÂèñÊ∂àÊüê‰∏Ä‰∏™„ÄÇ ÂõûË∞ÉÁªü‰∏ÄÁöÑÂõûË∞ÉËøáÁ®ãÂú®ÂÆåÊàê‰∫Ü dataTask ÁöÑÊâßË°åÂêéÔºå‰ºöÁî± APIProxy ÊâßË°åÁªü‰∏ÄÁöÑÂõûË∞ÉËøáÁ®ã„ÄÇÂõûË∞É‰ºö‰º†ÂÖ•ÂìçÂ∫î‰ø°ÊÅØ NSURLResponse *responseÔºåÂìçÂ∫î‰Ωìid responseObjectÔºå‰ª•ÂèäÈîôËØØ NSError *error„ÄÇÂõ†‰∏∫ËØ∑Ê±ÇÂ∑≤ÁªèÂÆåÊàêÔºåÊâÄ‰ª•ÁßªÈô§ dispatchTable ‰∏≠Áõ∏Â∫îÁöÑÈ°π„ÄÇÂ¶ÇÊûúÂá∫Èîô‰∫ÜÔºåÈÇ£‰πàÁîüÊàê‰∏Ä‰∏™Âá∫ÈîôÁöÑËøîÂõûÂØπË±° CTURLResponseÔºåÂ¶ÇÊûúÊ≤°ÊúâÂá∫ÈîôÔºåÈÇ£‰πàÁîüÊàê‰∏Ä‰∏™Ê≠£Á°ÆÁöÑËøîÂõûÂØπË±° CTURLResponseÔºåÁÑ∂ÂêéÂ∞ÜËøô‰∏™ CTURLResponse ‰º†ÂÖ•Áî± CTAPIBaseManager ‰º†ÂÖ•ÁöÑÊàêÂäüÂ§±Ë¥•ÂõûË∞É„ÄÇÂØπ‰∫éÂìçÂ∫î‰ø°ÊÅØÁöÑÊó•ÂøóÊâìÂç∞Ôºå‰πüÊòØÂú®ËøôÈáåÂÆåÊàê„ÄÇ CTURLResponse Ê≤°Êúâ‰ªÄ‰πàÁâπÂà´ÁöÑÊñπÊ≥ïÔºåÂè™ÊòØÊ∑ªÂä†‰∫Ü‰∏Ä‰∫õÊ†áËØÜÂ±ûÊÄßÔºåÊØîÂ¶ÇÂâçÊñáËØ¥Âà∞ÁöÑ isCacheÔºå‰ª•Âèä requestIdÔºåerror Á≠âÔºåËøòÊúâÂ∞±ÊòØÊï∞ÊçÆ„ÄÇÂèçÊ≠£‰Ω†ÊÉ≥ËÆ©ÂõûË∞ÉÊñπÊ≥ïÁü•ÈÅìÁöÑ‰∏úË•øÈÉΩÊîæÂú®ËøôÈáåÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ ÊàêÂäüÂõûË∞ÉÊàêÂäüÂõûË∞ÉÂú® APIManager ‰∏≠ËøõË°åÔºåÈô§‰∫ÜË∞ÉÁî® ViewController ‰∏≠Êèê‰æõÁöÑÊàêÂäüÂõûË∞ÉÂ§ñÔºå‰∏ªË¶ÅÁî®Êù•‰øùÂ≠òÊï∞ÊçÆ„ÄÅÈ™åËØÅ‰ª•ÂèäÊã¶Êà™„ÄÇÊµÅÁ®ãÂ¶ÇÂõæÔºö È¶ñÂÖàÊòØË¶Å‰øùÂ≠òÊï∞ÊçÆÂà∞Êú¨Âú∞ÔºåËøôË¶ÅÊ±ÇËØ• API ÂÖÅËÆ∏‰ªéÊú¨Âú∞Ëé∑ÂèñÊï∞ÊçÆÂπ∂‰∏îÂìçÂ∫îÁªìÊûúÊù•Ëá™‰∫éÁΩëÁªúÔºå‰πüÂ∞±ÊòØ‰∏äÈù¢ÊâÄËØ¥ÁöÑ isCache ‰∏∫ NO„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÁî® NSUserDefaults ‰øùÂ≠òÁΩëÁªúÁ´Ø‰º†Êù•ÁöÑÂìçÂ∫îÊï∞ÊçÆ„ÄÇ ÂâçÈù¢Âú®ÁΩëÁªúËØ∑Ê±ÇÂÆåÊàêÊó∂Âà†Èô§‰∫Ü dispatchTable ‰∏≠ÁöÑ requestId Âíå dataTask ÁöÑÈîÆÂÄºÂØπ„ÄÇÁé∞Âú®Ë¶ÅÂà†Èô§ requestList ‰øùÂ≠òÁöÑ requestId„ÄÇ Áî±‰∫éÊØè‰∏™ API ÈÉΩÊúâ‰∏Ä‰∏™ ManagerÔºåÊâÄ‰ª•Áé∞Âú®Ê≤°ÊúâÂøÖË¶ÅÂ∞ÜÊï∞ÊçÆ‰∫§Áªô ViewController ‰øùÁÆ°‰∫Ü„ÄÇÂú® BaseManager ‰∏≠ÔºåÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ id fetchedRawData ‰∏ìÈó®‰øùÂ≠òÂéüÂßãÁöÑËøîÂõûÊï∞ÊçÆ„ÄÇ ‰πãÂêéÊòØÈ™åËØÅÂô®ÂØπ‰∫éËøîÂõûÁªìÊûúÊ≠£Á°ÆÊÄßÁöÑÈ™åËØÅ„ÄÇ‰∏ÄËà¨ÊòØÂØπ‰∫éËøîÂõûÁä∂ÊÄÅÊòØÂê¶Ê≠£Á°Æ„ÄÅÊüê‰∫õÁâπÂÆöÂ≠óÊÆµÊòØÂê¶‰∏∫Á©∫ÁöÑÂà§Êñ≠„ÄÇËøô‰∫õÈÉΩÁî± APIManager Êù•ÂÆåÊàê„ÄÇÂ¶ÇÊûúÂ§±Ë¥•ÔºåÂàôÁõ¥Êé•Ëµ∞Â§±Ë¥•ÂõûË∞ÉÔºåÂπ∂‰∏îËÆæÁΩÆÁõ∏Â∫îÁöÑÈîôËØØÁ±ªÂûã„ÄÇ Èô§‰∫Ü‰øùÂ≠òÂà∞Êú¨Âú∞Â∞±ÊòØÂà§Êñ≠ÊòØÂê¶Ë¶ÅÁºìÂ≠ò„ÄÇÂêåÊ†∑ÁöÑË¶ÅÂà§Êñ≠ÊòØÂê¶ËÉΩÁºìÂ≠òÔºå‰ª•ÂèäÊï∞ÊçÆÊòØÂê¶Êù•Ê≠§ÁΩëÁªú„ÄÇÂ¶ÇÊûúÂèØ‰ª•ÔºåË∞ÉÁî® CTCache ÁöÑÁõ∏Â∫îÊñπÊ≥ïÊõ¥Êñ∞ÁºìÂ≠ò„ÄÇ Êé•‰∏ãÊù•Â∞±ÊòØÂú®ÊúÄÁªàÊàêÂäüÂõûË∞ÉÂâçÁöÑÊã¶Êà™„ÄÇÊã¶Êà™ÂàÜ‰∏∫ÂÜÖÈÉ®Êã¶Êà™ÂíåÂ§ñÈÉ®Êã¶Êà™„ÄÇÂú® base ‰∏≠ÂÆö‰πâ‰∫Ü beforePerformSuccessWithResponse: ÊñπÊ≥ïÔºå‰ºöË∞ÉÁî®Êã¶Êà™Âô®ÁöÑÁõ∏Â∫îÊñπÊ≥ï„ÄÇÂ¶ÇÊûúË¶ÅÂÆûÁé∞ÂÜÖÈÉ®Êã¶Êà™ÔºåÈúÄË¶ÅÂ≠êÁ±ªÈáçÂÜôËØ•ÊñπÊ≥ïÔºåÂπ∂‰∏îË¶ÅË∞ÉÁî® super ÊñπÊ≥ï„ÄÇÊàêÂäüÂõûË∞ÉÂêéÁöÑÊã¶Êà™‰πüÊòØÁõ∏ÂêåÁöÑÈÅìÁêÜ„ÄÇ ÊúÄÂêéË¶ÅËØ¥ÁöÑÂ∞±ÊòØÊàêÂäüÂõûË∞É‰∫Ü„ÄÇËøôÈáåË¶ÅÂº∫Ë∞É‰∏Ä‰∏ãÔºåÂπ∂‰∏çÊòØÊâÄÊúâÁΩëÁªúËØ∑Ê±ÇÈÉΩË¶ÅËµ∞ÊúÄÁªàÁöÑÊàêÂäüÂõûË∞ÉÁöÑÔºàËá≥Â∞ëÂú®Êú¨ÊñáËøô‰∏™ÊÉÖÊôØ‰∏ãÊòØËøôÊ†∑ÁöÑÔºâ„ÄÇ else ÁöÑÈÄªËæëÔºå‰∏çÊòØ‰ªéÊú¨Âú∞Ëé∑ÂèñÁöÑÔºåÈÇ£‰πàÁõ¥Êé•ÊàêÂäüÂõûË∞ÉÊ≤°ÊúâÈóÆÈ¢ò„ÄÇÈÇ£‰πà‰ªéÊú¨Âú∞Ëé∑ÂèñÁöÑÊï∞ÊçÆÂÜçÂàÜËøô‰∏§ÁßçÊÉÖÂÜµÔºåÊúâ‰ΩïÁî®ÊÑèÂë¢ÔºüÂâçÈù¢ËØ¥ËøáÔºå‰ªéÊú¨Âú∞Âä†ËΩΩÁöÑÊï∞ÊçÆÊàêÂäüÂêé‰ºöÊúâ‰∏ÄÊ¨°ÊàêÂäüÂõûË∞ÉÔºå‰πãÂêéÂπ∂Ê≤°ÊúâÁªìÊùüÁΩëÁªúËØ∑Ê±ÇÔºåËÄåÊòØÁªßÁª≠ËØ∑Ê±ÇÊñ∞ÁöÑÊï∞ÊçÆÂéª‰∫Ü„ÄÇ‰ªéÁΩëÁªúËé∑ÂæóÊï∞ÊçÆÂêéÂèà‰ºö‰∫ßÁîü‰∏Ä‰∏™ÊàêÂäüÂõûË∞É„ÄÇËøôÈáåÂ∞±Ë¶ÅÊääÂêéÈù¢Ëøô‰∏™ÊàêÂäüÂõûË∞ÉÂ±èËîΩÊéâ„ÄÇÊâÄ‰ª•ËøôÈáåÂÖàÂà§Êñ≠ÊòØÂê¶Â∫îËØ•‰ªéÊú¨Âú∞ÊãøÊï∞ÊçÆ„ÄÇÂ¶ÇÊûúÊòØÔºåÈÇ£‰πàÂ∞±Èù¢‰∏¥ÁùÄ‰∏§Ê¨°ÂõûË∞ÉÁöÑÊÉÖÂÜµ„ÄÇÊú¨Âú∞Êï∞ÊçÆÁöÑÊàêÂäüÂõûË∞ÉÊòØÂ∫îËØ•ÊâßË°åÁöÑÔºåÂè¶Â§ñÊú¨Âú∞Ê≤°ÊúâÊï∞ÊçÆÊó∂‰ªéÁΩëÁªúÁ´ØÊãøÊï∞ÊçÆ‰πüÊòØÂ∫îËØ•ÊâßË°åÁöÑ„ÄÇËÄåÊú¨Âú∞Â≠òÂú®Êï∞ÊçÆÔºåÂèà‰ªéÁΩëÁªúÁ´ØÊãøÂà∞ÁöÑÔºåÊòØ‰∏çËÉΩÊâßË°åÊàêÂäüÂõûË∞ÉÁöÑ„ÄÇÔºàÂÖ∑‰ΩìËøòÈúÄË¶ÅÊ†πÊçÆÂÆûÈôÖ‰∏öÂä°ÂÅöÁõ∏Â∫îË∞ÉÊï¥ÁöÑÔºâ Â§±Ë¥•ÂõûË∞ÉÂ§±Ë¥•ÂõûË∞ÉËæÉ‰∏∫ÁÆÄÂçïÔºå‰ΩÜÊòØÂíåÊàë‰ª¨Âπ≥Êó∂ÂÜôÁöÑ‰∏ç‰∏ÄÊ†∑„ÄÇÁî±‰∫éÊ°ÜÊû∂‰∏≠ÊúâÂæàÂ§öÂú∞Êñπ‰∏ªÂä®Ë∞ÉÁî®‰∫ÜÂ§±Ë¥•ÂõûË∞ÉÔºåÊØîÂ¶ÇÊã¶Êà™Âô®„ÄÅÈ™åËØÅÂô®ÂèëËµ∑ÁöÑÂ§±Ë¥•ÂõûË∞É„ÄÇÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÊ†πÊçÆÈîôËØØÁ±ªÂûãÔºåÂÖàÂÅö‰∏Ä‰∫õÂ§ÑÁêÜ„ÄÇ CTServiceProtocol ‰∏≠Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÂèØÈÄâÊñπÊ≥ï shouldCallBackByFailedOnCallingAPI:ÔºåÁî®Êù•ÈõÜ‰∏≠Â§ÑÁêÜ Service Â±ÇÁöÑÈîôËØØÔºåÊØîÂ¶Ç token Â§±Êïà„ÄÇÊàë‰ª¨Â∞±ÂèØ‰ª•Âú® Service ‰∏≠ÂÆûÁé∞ËØ•ÊñπÊ≥ïÔºåÂú®ÂÖ∂‰∏≠ÂèëÂá∫ÈÄöÁü•„ÄÇÂ§ÑÁêÜÂÆåÈîôËØØÂêéÔºåÁõ¥Êé• returnÔºå‰∏çÂÜçÁªßÁª≠ÊâßË°å„ÄÇ ÊâÄ‰ª•ÊÄªÁöÑÊù•ËØ¥ÔºåÂàÜ‰∏∫‰∏âÂ±ÇÔºåService Â±ÇÔºåAPIManager Â±ÇÂíå‰∏öÂä°Â±ÇÔºåÊØè‰∏ÄÂ±ÇÈÉΩËÉΩËøõË°åÂ§ÑÁêÜ„ÄÇ Q&amp;AÈìæÂºèËØ∑Ê±ÇÂ¶Ç‰ΩïÂ§ÑÁêÜÈìæÂºèËØ∑Ê±ÇÔºü‰∏ÄËà¨Êàë‰ª¨ÈÉΩÊòØÂú®ÊàêÂäüÂõûË∞ÉÂêéÊãøÂà∞Êï∞ÊçÆÔºåÁÑ∂ÂêéÂÜçËøõË°å‰∏ã‰∏Ä‰∏™ËØ∑Ê±Ç„ÄÇÂ¶ÇÊûúÂ≠òÂú®Â§ö‰∏™ËØ∑Ê±ÇÔºåÈÇ£‰πàËøô‰∏™ÊàêÂäüÂõûË∞É‰ºöÂµåÂ•óÁöÑÈùûÂ∏∏Èïø„ÄÇËøõË°åÁöÑÊîπËøõÂ∞±ÊòØ‰∫âÂèñÂ∞ÜÂêÑ‰∏™ËØ∑Ê±Ç‰ªéÂõûË∞É‰∏≠ÂèñÂá∫„ÄÇÊàë‰ª¨ÂèØ‰ª•Â∞ÜÊØè‰∏Ä‰∏™ÂõûË∞ÉÊîæÂú®‰∏Ä‰∏™‰∏ìÈó®ÁöÑÁ±ª‰∏≠Ôºö Â¶ÇÂõæÊâÄÁ§∫Ôºå‰∏∫ÊØè‰∏Ä‰∏™ËØ∑Ê±ÇÈìæ‰∏äÁöÑ API ÂàõÂª∫‰∏Ä‰∏™ Command Á±ª„ÄÇËøô‰∏™ Command Á±ªÊòØÂØπ APIManager ÁöÑ‰∏ÄÂ±ÇÂ∞ÅË£ÖÔºåViewController ‰∏≠‰∏çÂÜçÁõ¥Êé•Ë∞ÉÁî® APIManager ‰∏≠ÁöÑ loadData ÊñπÊ≥ïÔºåËÄåÊòØË∞ÉÁî® Command ‰∏≠Êèê‰æõÁöÑ execute(ÂêçÂ≠óÂè´‰ªÄ‰πà‰∏çÈáçË¶Å)Ë°®Á§∫ÊàëÂèëËµ∑‰∫Ü‰∏Ä‰∏™ËØ∑Ê±ÇÈìæ„ÄÇÂ∞Ü Command ËÆæÁΩÆ‰∏∫ APIManager ÁöÑ paramSourceÔºådelegate„ÄÇAPIManager ÂÖàÊâßË°å Command ÁöÑÂõûË∞É„ÄÇCommand ‰∏≠Êèê‰æõ‰∫Ü‰∏Ä‰∏™Âêå‰∏∫ Command Á±ªÂûãÁöÑ next Â±ûÊÄßÔºåËøôÂ∞±ÊòØËØ∑Ê±ÇÈìæÁöÑ‰∏ã‰∏ÄÁ∫ß„ÄÇÂú® Command ÁöÑÂõûË∞É‰∏≠ÔºåÂà§Êñ≠ next ÊòØÂê¶‰∏∫Á©∫„ÄÇÂΩìÂ≠òÂú®Êó∂ÔºåÂ¶ÇÊûú‰∏ã‰∏ÄÁ∫ßË¶Å‰æùËµñ‰∏ä‰∏ÄÁ∫ßËøîÂõûÁöÑÁªìÊûú‰Ωú‰∏∫ÂèÇÊï∞ÔºåÂ∞±Â∞Ü‰∏ã‰∏ÄÁ∫ßÁöÑ paramSource ËÆæÁΩÆ‰∏∫‰∏ä‰∏ÄÁ∫ßÔºåÁÑ∂ÂêéÈÄöËøá [self.next execute] ÊâßË°å„ÄÇÂ¶ÇÊûú‰∏çÂ≠òÂú®ÔºåÈÇ£‰πàË∞ÉÁî® delegateÔºà‰∏ÄËà¨ÊòØ ViewControllerÔºâÁöÑÂÆåÊàêÂõûË∞ÉÔºåË°®Á§∫ËØ∑Ê±ÇÈìæÁªìÊùü„ÄÇ ‰ΩøÁî®ÁöÑÊó∂ÂÄô‰∏∫ÊØè‰∏Ä‰∏™ Command ËÆæÁΩÆ next Âç≥ÂèØÔºö 12345678910// ViewController ‰∏≠API1Command *api1 = [[API1Command alloc] init];API2Command *api2 = [[API2Command alloc] init];API3Command *api3 = [[API3Command alloc] init];api1.next = api2;api1.paramSource = self;api1.delegate = self;api2.next = api3;api3.delegate = self;[api1 execute]; ËøôÊ†∑ÂÅöÊúâ‰∏Ä‰∏™‰ºòÁÇπÔºåÂ∞±ÊòØÊúâ‰∫õÊó∂ÂÄôÔºå‰∏ã‰∏ÄÁ∫ßÁöÑÁΩëÁªúËØ∑Ê±ÇÂπ∂‰∏ç‰æùËµñ‰∫é VCÔºåËÄåÊòØ‰ªé‰∏ä‰∏ÄÁ∫ßÁΩëÁªúËØ∑Ê±ÇÁõ¥Êé•Ëé∑Âæó„ÄÇËøôÊ†∑ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Áõ¥Êé•ËÆæÁΩÆ next ÁöÑ paramsÔºåËÄå‰∏çÈúÄË¶ÅËÆ© next ÁªßÁª≠ÈóÆ VC Ë¶ÅÊï∞ÊçÆ‰∫Ü„ÄÇ‰∏äÈù¢ÁöÑ‰ª£Á†ÅÁ§∫‰æãÈáå‰πüÊòØËøôÊ†∑„ÄÇÈ¶ñÂÖàÂª∫Á´ãË∞ÉÁî®Èìæ api1‚Üíapi2‚Üíapi3Ôºåapi1 Âíå api3 ÈúÄË¶ÅÊâßË°å VC ‰∏≠ÁöÑÂõûË∞ÉÔºåÂ∞±ËÆæÁΩÆÂÖ∂ delegateÔºåapi2 Âíå api3 ÈÉΩ‰∏çÈúÄË¶Å VC ‰Ωú‰∏∫ paramSourceÔºåÊâÄ‰ª•Â∞±‰∏çËÆæÁΩÆ‰∫Ü„ÄÇ ËøôÁßçÊñ∞Âª∫ Command ÁöÑÂ•ΩÂ§ÑÊòØÔºåÊää delegateÔºåparamSource ÂÅöÁöÑ‰∫ãÊîæÂà∞‰∫Ü Command ÈáåÔºå‰∏çÈúÄË¶ÅÂú® VC ‰∏≠Â§ÑÁêÜ‰∫Ü„ÄÇ‰ΩÜÊòØËøôÊ†∑‰πüÂ∏¶Êù•‰∏Ä‰∏™ÈóÆÈ¢òÂ∞±ÊòØÊØè‰∏™ APIManager ÈÉΩÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™ÂàõÂª∫‰∏Ä‰∏™‰∏é‰πãÂØπÂ∫îÁöÑ CommandÔºåÂØºËá¥Á±ªÁõÆÂ¢ûÂ§ö„ÄÇÂΩìÁÑ∂ÔºåËøôÊòØ‰∏çÂèØÈÅøÂÖçÁöÑÔºåÊØïÁ´üËøô‰∫õ delegateÔºåparamSource ÁöÑÊñπÊ≥ïÊÄªÊòØË¶ÅÊúâ‰∏Ä‰∏™Âú∞ÊñπÊîæÁöÑ„ÄÇ Âè¶Â§ñÔºåÊúÄÂ•Ω‰∏çË¶ÅÂ∞Ü next ÊîæÂú® APIManager ‰∏≠ÔºåËøôÊ†∑‰ºöÊ±°Êüì APIManager„ÄÇ Á≠âÂæÖËßÜÂõæÂú®Âì™ÂÆûÁé∞Á≠âÂæÖËßÜÂõæÁöÑÂ±ïÁ§∫ÂíåÈöêËóèÂú® interceptor ÁöÑËØ∑Ê±ÇÂºÄÂßãÂâçÂíåËØ∑Ê±ÇÁªìÊùüÂêéË∞ÉÁî®„ÄÇÊàë‰ª¨Â∫îËØ•Â∞ÜÂä†ËΩΩÊ°ÜËÆæÁΩÆ‰∏∫‰∏Ä‰∏™Âçï‰æãÔºåÂÖ∂‰∏≠Áª¥Êä§‰∏Ä‰∏™ËÆ°Êï∞Âô®„ÄÇÂΩìËØ∑Ê±ÇÂºÄÂßãÁöÑÊó∂ÂÄôËÆ°Êï∞Âä†‰∏ÄÔºåËØ∑Ê±ÇÁªìÊùüÁöÑÊó∂ÂÄôËÆ°Êï∞Âáè‰∏Ä„ÄÇËÆ°Êï∞Âô®Ë¶ÅÂä†ÈîÅÔºåÂõ†‰∏∫ API ÊòØÂºÇÊ≠•ÁöÑ„ÄÇ paramsource ÊòØË∞ÅÔºü‰∏ÄËà¨Êàë‰ª¨ÁöÑ paramsource ËÆæÁΩÆ‰∏∫ VC„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú‰∏çÊ∂âÂèä‰∏öÂä°‰∏äÁöÑÊï∞ÊçÆÔºåÂèØ‰ª•Áõ¥Êé•ËÆæÁΩÆ‰∏∫ APIManager„ÄÇ Â¶Ç‰ΩïÂàÜÈ°µÂ∞ÜÈ°µÊï∞‰øùÂ≠òÂú® APIManager ‰∏≠„ÄÇÊØèÊ¨°Êàë‰ª¨Ë¶ÅÂä†ËΩΩ‰∏ã‰∏ÄÈ°µÁöÑÊó∂ÂÄô‰ΩøÁî® loadNextPage ÊñπÊ≥ïÂç≥ÂèØÔºå‰∏çÈúÄË¶Å VC ÁÆ°ÁêÜËØ∑Ê±ÇÈ°µ‰∫Ü„ÄÇ ÂÖ≥‰∫éÂÆûÁé∞ÔºåÂÆûÁé∞ÊñπÂºèÂ∫îËØ•ÊòØËøôÊ†∑ÁöÑ„ÄÇÈ¶ñÂÖàÂú® APIBaseManager ‰∏≠ÂÆö‰πâ‰∏Ä‰∏™ pageNo Â±ûÊÄßÔºåËÆæÁΩÆÈªòËÆ§ÂÄº‰∏∫ 1ÔºåË°®Á§∫Á¨¨‰∏ÄÈ°µÔºõ‰∏Ä‰∏™ pageSize Â±ûÊÄßÔºåËÆæÁΩÆÈªòËÆ§ÂÄº‰∏∫ 10„ÄÇÁÑ∂ÂêéËøòÂÆö‰πâ reloadData ÊñπÊ≥ïÔºåÂÆÉÁöÑÈªòËÆ§ÂÆûÁé∞Â∞±ÊòØÂ∞Ü pageNo ÁΩÆ‰∏∫ 1ÔºåÁÑ∂ÂêéË∞ÉÁî® loadData„ÄÇ ÂÜçÂÆö‰πâ‰∏Ä‰∏™ÂçèËÆÆ PageProtocolÔºåÂ£∞ÊòéÂèØÈÄâÁöÑ pageNo Âíå pageSize Â±ûÊÄßÔºåÂÜçÂ£∞Êòé‰∏Ä‰∏™ÂèØÈÄâÁöÑ reloadData ÊñπÊ≥ïÔºå‰ª•ÂëäËØâ‰ΩøÁî®ËÄÖÂèØ‰ª•‰ΩøÁî®„ÄÇ ÂØπ‰∫éË¶ÅÂàÜÈ°µÁöÑ APIÔºåÂú® loadData ÊñπÊ≥ï‰∏≠ÁöÑÈáçÁªÑÂèÇÊï∞ÊñπÊ≥ï‰∏≠ÔºåÂ∞ÜÂΩìÂâç pageNo ‰º†ÂÖ•„ÄÇÂú® APIBaseManager ‰∏≠ÁöÑÂÜÖÈÉ®Êã¶Êà™Âô®‰∏≠ÔºåÂà§Êñ≠ÂΩìÂâç APIManager ÊòØÂê¶ÂÆûÁé∞‰∫Ü PageProtocol ÂçèËÆÆÔºåÂÆûÁé∞‰∫ÜÔºåÂ∞±Êää pageNo Âä†‰∏Ä„ÄÇ requestId ÁöÑÁî®Â§ÑrequestId ËÆæËÆ°Âá∫Êù•ÊòØ‰∏∫‰∫ÜÈíàÂØπ request ÁöÑÊéßÂà∂ÁïôÊúâ‰ΩôÂú∞Áî®ÁöÑÔºå‰ΩÜÊòØÁé∞Âú®Âú®Â∑•Á®ã‰∏≠Áî®ÁöÑÂæàÂ∞ë„ÄÇÊâÄ‰ª•Ëøò‰∏çÂ¶ÇÂÉè YTK ÈÇ£Ê†∑Ôºå‰øùÂ≠ò dataTask Â∞±Ë°å‰∫Ü„ÄÇ CTService ÁöÑËÆæËÆ°ÊÑèÂõæService ÊòØÁî®Êù•Êé•ÂÖ•Á¨¨‰∏âÊñπ API ÁöÑ„ÄÇÂØπ‰∫éÁ¨¨‰∏âÊñπÁöÑ APIÔºåÂ∞±ÂàõÂª∫‰∏Ä‰∏™ÂÖ®Êñ∞ÁöÑ Service„ÄÇ ÁÆÄÂçïÊÄªÁªì‰∏Ä‰∏ãÔºåÂ§ßËá¥ÂàÜ‰∏∫‰∏âÊ≠•Ôºö ÊØè‰∏™ API ÈÉΩÊúâ‰∏Ä‰∏™ APIManagerÔºåÂÖ∂‰∏≠Êúâ ServiceTypeÔºåinterceptorÔºådelegateÔºåvalidatorÔºåparamSource Á≠âÂ±ûÊÄß„ÄÇÂú®Ê≠£ÁúüÁöÑÊï∞ÊçÆËØ∑Ê±ÇÂâçÔºåÂÖàÂØπËØ∑Ê±ÇÂèÇÊï∞ÂÅö‰∏Ä‰∫õÂ§ÑÁêÜÔºåÊØîÂ¶ÇÊ∑ªÂä† pageNum Á≠âÔºåÁÑ∂ÂêéÂú®ÂÖ∂‰∏≠ÁªèËøá‰∏ÄÁ≥ªÂàóÁöÑÂà§Êñ≠ÔºåÂåÖÊã¨ interceptorÔºåvalidatorÔºåÊòØÂê¶ÊúâÊú¨Âú∞ÁºìÂ≠òÔºåÊòØÂê¶Êúâ cache Á≠âÔºåÊ∂âÂèäÂà∞ÂÖ∑‰ΩìÁöÑÁ≠ñÁï•„ÄÇÁÑ∂ÂêéËøõË°åÁΩëÁªúËØ∑Ê±Ç„ÄÇ ÁΩëÁªúËØ∑Ê±ÇÈÄöËøá APIProxy ÂÆåÊàêÔºåÂÆÉÈúÄË¶Å APIManager Êèê‰æõÂêÑÁßçÁΩëÁªúËØ∑Ê±ÇÈúÄË¶ÅÁöÑ‰∏úË•øÔºåÂåÖÊã¨ËØ∑Ê±ÇÂèÇÊï∞ÔºåËØ∑Ê±ÇÂêçÔºåËØ∑Ê±ÇÁ±ªÂûãÔºåServiceType„ÄÇÂÆÉÂÖàÁî®Ëøô‰∫õÂèÇÊï∞ÔºåÈÄöËøá CTRequestGenerator ÂàõÂª∫ Request„ÄÇÂàõÂª∫ Request ÁöÑËøáÁ®ãÊòØÊ†πÊçÆ APPDelegate ‰∏≠ÂÆö‰πâÁöÑÂØπÁÖßË°®ÔºåÁî® ServiceType Âú® CTServiceFactory ‰∏≠ÊâæÂà∞Ê≠£ÁúüÁöÑ CTService ÂÆû‰æãÔºåÁÑ∂ÂêéËé∑Âèñ‰∏Ä‰∫õ Service Â±ÇÈù¢ÁöÑÂèÇÊï∞ÔºåÊØîÂ¶Ç baseUrlÔºåService Â±ÇÁöÑÂèÇÊï∞Á≠â„ÄÇÊúÄÂêéÈÄöËøá AF Êèê‰æõÁöÑ AFHTTPRequestSerializer ÁöÑÊñπÊ≥ïÁîüÊàê NSURLRequest„ÄÇ ÊúÄÂêé APIProxy Â∞±Ë¶ÅÂèëËµ∑ËØ∑Ê±Ç‰∫Ü„ÄÇËøòÊòØÈÄöËøá AF ÁöÑÊñπÊ≥ïÁîüÊàê dataTaskÔºåÂπ∂ÂºÄÂßã„ÄÇÂ∞Ü dataTask ÂíåÁΩëÁªúËØ∑Ê±ÇËøîÂõûÁöÑ requestId ‰ª•Â≠óÂÖ∏ÁöÑÊñπÂºè‰øùÂ≠òËµ∑Êù•ÔºåÂèàÂ∞Ü requestId ËøîÂõûÁªô APIManager ‰øùÂ≠ò„ÄÇÁÑ∂ÂêéÁ≠âÂæÖÂõûË∞É„ÄÇÂõûË∞ÉÂÖàÂ∞Ü APIProxy ÁöÑÂ≠óÂÖ∏‰∏≠Áõ∏Â∫îÈîÆÂÄºÂØπÂà†Èô§ÔºåÁÑ∂ÂêéÂà†Èô§ APIManager ÁöÑÊï∞ÁªÑ‰∏≠ÁöÑ requestId Âà†Èô§„ÄÇ ÁåøÈ¢òÂ∫ìÁöÑ YTKNetworkYTKNetWork ÂêåÊ†∑ÊòØ‰∏Ä‰∏™ star Êï∞ÈùûÂ∏∏È´òÁöÑÁΩëÁªúÊ°ÜÊû∂ÔºåÂÆÉ‰πüÊòØÂü∫‰∫éÁ¶ªÊï£Âûã API ÂÆåÊàêÁöÑ„ÄÇÂêåÊ†∑ÁöÑÊù•Ëß£Êûê‰∏Ä‰∏ã YTK Â∞ÅË£ÖÁöÑÂü∫Êú¨ÊµÅÁ®ã„ÄÇÂù¶ÁôΩËØ¥ÔºåCTNetworking ÁúüÁöÑÂæàÊäòËÖæÔºåÁ±ªÁõÆÂæàÂ§öÔºåÂØπÁ¨¨‰∏ÄÊ¨°ÁúãÁöÑ‰∫∫Âæà‰∏çÂèãÂ•Ω„ÄÇYTKNetwork ÂàôÁÆÄÂçï‰∫ÜËÆ∏Â§öÔºåÊÄªÂÖ±‰πüÂ∞±ÂçÅÊù•‰∏™Êñá‰ª∂„ÄÇ Âü∫Êú¨ÊµÅÁ®ãYTK Ê≤°Êúâ‰∫ÜÈÇ£‰πàÂ§öÁöÑ delegateÔºåÊ≤°Êúâ‰∫ÜÈáçÁªÑÂèÇÊï∞ÔºåÊ≤°Êúâ‰∫ÜÈ™åËØÅÂô®ÔºåÊã¶Êà™Âô®ÔºåÂè™ÊúâÂÖ≥‰∫éÁºìÂ≠òÁöÑËÆ®ËÆ∫„ÄÇÂõ†Ê≠§ÔºåÂÆÉÁöÑ‰∏ªÊµÅÁ®ã‰πüÊòæÂæóÁÆÄÂçï‰∫ÜËÆ∏Â§öÔºö È¶ñÂÖàËøô‰∏™ËøáÁ®ãÂü∫Êú¨ÈÉΩÊòØÂú® YTKRequest ‰∏≠ÂÆåÊàêÁöÑÔºåÂü∫Êú¨Á±ªÊØî‰∫é APIBaseManagerÔºåÊâÄÊúâÁöÑ API ÈÉΩÁªßÊâø‰∫éÂÆÉ„ÄÇÁ¨¨‰∏ÄÊ≠•Âà§Êñ≠ÊòØÂê¶ÂøΩÁï•ÁºìÂ≠òÔºåËøôÊòØÂêÑ‰∏™ API ÈúÄË¶ÅËÆæÁΩÆÁöÑÂ±ûÊÄß„ÄÇÈªòËÆ§‰∏∫‰∏çÁºìÂ≠ò„ÄÇ ÁÑ∂ÂêéÂà§Êñ≠ÊòØÂê¶Êúâ‰∏ãËΩΩË∑ØÂæÑ„ÄÇ‰πüÂ∞±ÊòØÂêÑ‰∏™ API ÊòØÂê¶ÂÆûÁé∞‰∫ÜÊèê‰æõ‰∏ãËΩΩË∑ØÂæÑÁöÑÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÊúâ‰∏ãËΩΩË∑ØÂæÑÔºåÈÇ£‰πàÂ∞±ÂæóÂèëÈÄÅÁΩëÁªúËØ∑Ê±Ç„ÄÇ ÊúÄÂêéÊòØÂà§Êñ≠ÊòØÂê¶ËÉΩÂ§üËØªÂèñÁºìÂ≠ò„ÄÇÂÖàËé∑ÂèñÂêÑ‰∏™ API ËÆæÁΩÆÁöÑÁºìÂ≠òÊó∂Èó¥ÔºåÂ¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆÔºåÈÇ£‰πàÂ∞±ÂæóÂèëÈÄÅÁΩëÁªúËØ∑Ê±Ç„ÄÇÁÑ∂ÂêéÂ∞ùËØïËØªÂèñÁºìÂ≠òÊï∞ÊçÆÁöÑÂÖÉÊï∞ÊçÆ„ÄÇÂÖÉÊï∞ÊçÆÂåÖÊã¨ÁºìÂ≠òÁöÑÁºìÂ≠òÊó∂Èó¥ÔºåAPP ÁâàÊú¨Âè∑ÔºåÊïèÊÑü‰ø°ÊÅØÁ≠â„ÄÇËøô‰∫õÈÉΩË¶ÅÂàÜÂà´Âà§Êñ≠ÊòØÂê¶ÂíåÂΩìÂâç‰∏ÄËá¥„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÂÖÉÊï∞ÊçÆÔºåÊàñËÄÖÂÖÉÊï∞ÊçÆ‰∏çÁ¨¶ÂêàË¶ÅÊ±ÇÁöÑÈÉΩÂæóËøõË°åÁΩëÁªúËØ∑Ê±Ç„ÄÇ Â¶ÇÊûú‰ª•‰∏äÈÉΩÊ≤°ÊúâÈóÆÈ¢òÔºåÈÇ£‰πàÊâßË°åÊàêÂäüÂõûË∞ÉÔºåÂ∞ÜÊï¥‰∏™ API ‰Ωú‰∏∫ÂèÇÊï∞ËøîÂõû„ÄÇ‰ΩÜÊòØÂÖ∂‰∏≠‰ªªÊÑè‰∏Ä‰∏™‰∏çÊª°Ë∂≥ÔºåÂ∞±‰ºöË¶ÅÂèëÈÄÅÁΩëÁªúËØ∑Ê±Ç„ÄÇÂèëÈÄÅÁΩëÁªúËØ∑Ê±ÇÂâçÊúâ‰∏Ä‰∏™ÊâßË°åÂáÜÂ§áÊñπÊ≥ïÁöÑÊú∫‰ºöÔºåÁ±ª‰ºº‰∫é interceptor„ÄÇ ÁΩëÁªúËØ∑Ê±ÇYTK ÁöÑÁΩëÁªúËØ∑Ê±ÇÁî± YTKNetworkAgent ÂÆåÊàêÔºåÁ±ªÊØî‰∫é ApiProxy„ÄÇ‰∏çËøá‰∏çÂêåÁöÑÊòØÔºåYTK ÁöÑËøô‰∏™ Agent ÂÅö‰∫ÜÊâÄÊúâÁöÑ‰∫ãÔºåÂπ∂‰∏îÂåÖÂê´‰∫ÜÊñá‰ª∂‰∏ãËΩΩ„ÄÇËÄå Casa ÁöÑ Proxy ÂàôÁªìÂêà CTService ‰ª•Âèä CTRequestGenerator Ê∑ªÂä†‰∫ÜÊõ¥Â§öÁöÑÂèÇÊï∞ÈÖçÁΩÆ„ÄÇYTK ÁΩëÁªúËØ∑Ê±ÇËøáÁ®ãÂ¶ÇÂõæÔºö È¶ñÂÖàÔºåYTK ÂÖÅËÆ∏‰ΩøÁî®ËÄÖËá™Â∑±Êèê‰æõ NSURLRequest ÁöÑÂÆû‰æã„ÄÇÊâÄ‰ª•Âà§Êñ≠‰ΩøÁî®ËÄÖÊòØÂê¶‰ΩøÁî®‰∫Ü Request„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÊèê‰æõÔºåÈÇ£‰πàÈúÄË¶ÅÂ∏Æ‰ΩøÁî®ËÄÖÂàõÂª∫‰∏Ä‰∏™ Request„ÄÇ ÂàõÂª∫ÁöÑÊó∂ÂÄôÈ¶ñÂÖàÊòØÂØπ detailUrl ÁöÑ‰øÆÊîπ„ÄÇYTK Êèê‰æõ‰∫Ü‰∏Ä‰∏™ YTKFilterProtocolÔºåÂÆûÁé∞‰∫ÜËøô‰∏™ÂçèËÆÆÁöÑÁ±ªÂèØ‰ª•ÂØπ YTKRequest Êèê‰æõÁöÑ detailUrl ËøõË°å‰∏ÄÂÆöÁöÑ‰øÆÊîπ„ÄÇ ‰πãÂêéËøòÂèØ‰ª•‰øÆÊîπ baseUrl„ÄÇËøô‰∏ÄËøáÁ®ã‰∏ªË¶ÅÊòØÂà§Êñ≠ÊòØÂê¶‰ΩøÁî®‰∫Ü cdnÔºåÂ¶ÇÊûú‰ΩøÁî®‰∫Ü cdnÔºåÈÇ£‰πàÂàáÊç¢Âà∞ cdn ÁöÑ baseUrl„ÄÇËøô‰∏™ÊñπÊ≥ïÊòØÊØè‰∏™ YTKRequest ÈÄâÊã©ÂÆûÁé∞ÁöÑ„ÄÇ AFConstructingBlocks ÊòØ AFNetwork ‰∏≠ÁöÑÂ±ûÊÄßÔºåÂÆÉ‰∏ÄËà¨ÊòØÂú®‰∏ä‰º†Êñá‰ª∂ÁöÑÊó∂ÂÄô‰ΩøÁî®„ÄÇÁî± YTKRequest ÈÄâÊã©ÂÆåÊàêÂÆÉÁöÑÂàõÂª∫„ÄÇÊØîÂ¶Ç‰∏ã‰æã‰∏≠Â∞Ü‰∏ÄÂº†ÂõæÁâá‰ª• Content-Type ‰∏∫ image/jpeg ÁöÑÂΩ¢Âºè‰∏ä‰º†Ôºö ÂáÜÂ§áÂ∑•‰ΩúÁªìÊùüÔºåÂàõÂª∫ Request ÂâçËøòÈúÄË¶ÅÊ£ÄÊü•‰∏Ä‰∏ãËØ•ËØ∑Ê±ÇÊòØÂê¶ÊòØ‰∏Ä‰∏™‰∏ãËΩΩËØ∑Ê±Ç„ÄÇËøòÊòØ YTKRequest Êèê‰æõÁöÑÂèØÈÄâÂÆûÁé∞ÁöÑÊñπÊ≥ïÔºåÂ¶ÇÊûúÊèê‰æõ‰∫Ü‰∏ãËΩΩË∑ØÂæÑÂ∞±Ë°®Á§∫ÊòØ‰∏Ä‰∏™‰∏ãËΩΩËØ∑Ê±Ç„ÄÇ‰∏ãËΩΩÁöÑËØ∑Ê±ÇÊ∂âÂèäÂà∞Âà§Êñ≠Ë∑ØÂæÑ‰∏äÊñá‰ª∂ÊòØÂê¶Â≠òÂú®ÔºåÊòØÂê¶ÂèØ‰ª•ÁªßÁª≠‰∏ãËΩΩÁ≠âÔºå‰ºöÈÄöËøá AFNetworking ÂàõÂª∫‰∏Ä‰∏™Á´ôÁ®≥ÁöÑ dataTask Á±ª:NSURLSessionDownloadTaskÔºåÊâÄ‰ª•ÂøÖÈ°ª‰∏ìÈó®ÂàõÂª∫‰∏Ä‰∏™‰∏ãËΩΩËØ∑Ê±ÇÁöÑ dataTask„ÄÇ ‰∏çÊòØ‰∏ãËΩΩËØ∑Ê±ÇÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ∞Ü‰∏äÈù¢ÂáÜÂ§áÁöÑÂêÑÁßç‰º†Áªô AFNetworkÔºåÁîüÊàê‰∏Ä‰∏™ Request„ÄÇ‰πãÂêéÂÜçÂ∞ÜËøô‰∏™ Request ‰º†Áªô AFNetworkÔºåÂæóÂà∞‰∏Ä‰∏™ dataTask„ÄÇ ‰πãÂêéËÆæÁΩÆ dataTask ÁöÑ‰ºòÂÖàÁ∫ß„ÄÇËøô‰∏™‰∏ÄËà¨‰πüÊ≤°ÊúâÂ§™Â§ßÁî®Â§ÑÂï¶„ÄÇ Âú®ÊâßË°åÂâçÔºådataTask ËÇØÂÆöÊòØË¶Å‰øùÂ≠òËµ∑Êù•ÁöÑÔºå‰∏ÄÊù•‰∏∫‰∫ÜÊñπ‰æøÂèñÊ∂àÔºå‰∫åÊù•‰∏∫‰∫ÜÂà∞Êó∂ÂÄôËÉΩÊãøÂà∞ËØ∑Ê±ÇÁöÑÂèÇÊï∞Á≠âÊï∞ÊçÆ„ÄÇCasa ÁöÑÂÆûÁé∞ÊñπÂºèÊòØÂ∞Ü dataTask ‰øùÂ≠òÂú® APIProxy (ÂØπÂ∫î YTKNetworkAgent)‰∏≠Ôºå‰ª•ÈîÆÂÄºÂàÜÂà´‰∏∫ requestId Âíå dataTask ÁöÑÂ≠óÂÖ∏ÁöÑÂΩ¢Âºè‰øùÂ≠òÔºåÁÑ∂ÂêéÂ∞Ü requestId ‰ª•Êï∞ÁªÑÁöÑÂΩ¢ÂºèÂèà‰øùÂ≠òÂú®‰∫ÜÂêÑ‰∏™ APIManager(ÂØπÂ∫î YTKRequest) Èáå„ÄÇÊØèÂèëÈÄÅ‰∏ÄÊ¨°ËØ∑Ê±ÇÔºåÊï∞ÁªÑÊ∑ªÂä†‰∏Ä‰∏™ id„ÄÇVC ÂèØ‰ª•ÊãøÁùÄ id Ë∞ÉÁî® APIManager ÁöÑÁõ∏ÂÖ≥ÊñπÊ≥ïÊù•ÂèñÊ∂àËØ∑Ê±Ç„ÄÇ YTK Â∞Ü dataTask Áõ¥Êé•‰øùÂ≠òÂú®‰∫Ü YTKRequest (ÂØπÂ∫î APIManager)‰∏≠„ÄÇËôΩÁÑ∂‰πüÊòØÈÄöËøá requestId Âíå dataTask ÁöÑÈîÆÂÄºÂØπÁöÑÊñπÂºè‰øùÂ≠òÔºå‰ΩÜÊòØÂèñÊ∂àÂπ∂‰∏çÊòØ‰ª• id ‰∏∫Ê†áËØÜÊù•ÂèñÊ∂àÁöÑÔºåËÄåÊòØ‰ª• YTKRequest ‰∏∫Ê†áËØÜÂèñÊ∂àÁöÑ„ÄÇVC Ë∞ÉÁî® YTKNetworkAgent ÁöÑÂèñÊ∂àÊñπÊ≥ïÂèñÊ∂àËØ∑Ê±Ç„ÄÇÊâÄ‰ª• YTK ‰∏≠ÊØèÊ¨°ÁΩëÁªúËØ∑Ê±ÇÔºåÈÉΩÈúÄË¶ÅÂÆû‰æãÂåñ‰∏Ä‰∏™ YTKRequest„ÄÇÁõ∏ÂÖ≥ËøáÁ®ãÂ¶ÇÂõæÊâÄÁ§∫Ôºö ‰∏çËøáÂ∞±ÁÆó‰∏Ä‰∏™ APIManager ËÉΩÂèëÂ§ö‰∏™ÁΩëÁªúËØ∑Ê±Ç‰∫ÜÔºåÊúÄÂêéÁöÑËøîÂõûÁªìÊûúËøòÊòØÂè™Êúâ‰∏Ä‰∏™Âπ∂‰∏îÊòØ‰ºöË¢´Ë¶ÜÁõñÁöÑÔºåÊâÄ‰ª•ËøôÁßç‰øùÂ≠ò requestId Êï∞ÁªÑÁöÑÊñπÂºèÂπ∂‰∏çÊØîÊØè‰∏™ËØ∑Ê±ÇÂÆû‰æãÂåñ‰∏Ä‰∏™ YTKRequest Â•Ω„ÄÇ ÊúÄÁªàÈÄöËøá dataTask ÁöÑ resume Â∞±ÂèØ‰ª•ÂºÄÂêØ‰ªªÂä°‰∫Ü„ÄÇ ÂõûË∞ÉÁªü‰∏ÄÁöÑÂõûË∞ÉËøáÁ®ãYTK ÁöÑÁªü‰∏ÄÁöÑÂõûË∞ÉËøáÁ®ãÂú® YTKNetworkAgent ‰∏≠ÂÆåÊàê„ÄÇ‰∏ªË¶ÅÂÅö‰∫Ü‰∏§‰ª∂‰∫ãÔºåÈ¶ñÂÖàÈÄöËøá requestId ÁßªÈô§‰øùÂ≠òÁöÑ dataTask„ÄÇÂÖ∂Ê¨°ÔºåÂ∞ÜËøîÂõûÁöÑÁªìÊûúËÆæÁΩÆ‰∏∫ YTKRequest ÁöÑÂ±ûÊÄßÔºåÂπ∂È™åËØÅÂô®ÊúâÊïàÊÄß„ÄÇ È™åËØÅÊúâÊïàÊÄßÁöÑËøáÁ®ãÂ∞±ÊòØÂú® YTKRequest ‰∏≠Êèê‰æõ‰∏Ä‰∏™ÁªìÊûúÁöÑÊ®°ÊùøÔºåÁÑ∂ÂêéÊØîËæÉËøîÂõûÁªìÊûúÂíåÊ®°ÊùøÁöÑÂΩ¢ÊÄÅÊòØÂê¶Áõ∏Âêå„ÄÇÊÄªÁöÑÊù•ËØ¥Â∞±ÊòØ‰∏Ä‰∏™ÈÄíÂΩíÈ™åËØÅÁöÑËøáÁ®ãÔºåÂ∞±‰∏çÂ§öËµòËø∞‰∫Ü„ÄÇ ÊàêÂäüÂõûË∞ÉYTK ÁöÑÊàêÂäüÂõûË∞É‰∏ªË¶ÅËøáÁ®ãÂ∞±ÊòØÂÜôÂÖ•ÁºìÂ≠òÔºåÁõ∏ÊØîËæÉ CTNetworking Ê†πÊçÆÈúÄÊ±ÇËÆæÁΩÆÁöÑËæÉ‰∏∫Â§çÊùÇÁöÑÂà§Êñ≠ÈÄªËæëË¶ÅÁõ¥Êé•‰∫ÜËÆ∏Â§öÔºöÂ∞±ÊòØÂ¶ÇÊûúË¶ÅÁºìÂ≠òÈÇ£‰πàÂ∞±ÁºìÂ≠ò„ÄÇ Ëøô‰∏™ÊàêÂäüÂõûË∞ÉËøòÊòØÂú® YTKNetworkAgent ‰∏≠ÂÆûÁé∞ÁöÑ„ÄÇÂú®ÂÖÅËÆ∏ÁºìÂ≠òÂπ∂‰∏îÊòØ‰ªéÁΩëÁªúËé∑ÂèñÁöÑÊÉÖÂÜµ‰∏ãÂÜôÂÖ•ÁºìÂ≠ò„ÄÇËøô‰∏§Ê≠•‰πüÊ≤°ÊúâÂ§™Â§öÂèØ‰ª•ËØ¥ÁöÑ„ÄÇÂÜôÂÖ•ÁºìÂ≠ò‰πüÊòØÊ≠£Â∏∏Êìç‰Ωú„ÄÇÂÖ≥‰∫éÂàõÂª∫ÂÖÉÊï∞ÊçÆÔºåÂâçÈù¢‰πüËØ¥Âà∞Ëøá‰∫ÜÔºåÂÜôÁºìÂ≠òÁöÑÊó∂ÂÄô‰∏ÄÂπ∂ÂàõÂª∫ÂÖÉÊï∞ÊçÆÂπ∂‰øùÂ≠òËµ∑Êù•„ÄÇÊúÄÂêéÁöÑÊã¶Êà™‰ª•ÂèäÊàêÂäüÂõûË∞ÉÂíå CTNetworking Á±ª‰ºº„ÄÇ ËøôÈáåÊàêÂäüÂõûË∞É‰ªçÁÑ∂ÊòØÂú® YTKNetworkAgent ËøõË°åÔºåÁõ∏ÊØîËæÉ CTNetworking ‰∫§Áî± APIManager Â§ÑÁêÜÔºåËøôÊ†∑Â∞ë‰∫Ü‰∏Ä‰∫õÂÆöÂà∂ÊÄß„ÄÇ Â§±Ë¥•ÂõûË∞ÉYTK ÂØπ‰∫éÂ§±Ë¥•ÁöÑÂõûË∞ÉÂü∫Êú¨ÂÆåÂÖ®ÊòØÁªôÂà∞‰ΩøÁî®ËÄÖÂ§ÑÁêÜ‰∫Ü„ÄÇÂú®Â§±Ë¥•ÂõûË∞É‰∏≠ÂÅöÁöÑ‰∏Ä‰ª∂‰∫ãÂ∞±ÊòØÂØπ‰∫é‰∏ãËΩΩÂ§±Ë¥•ÁöÑÊÉÖÂÜµÔºåÂà†Èô§Êú™ÂÆåÊàêÁöÑ‰∏ãËΩΩÈ°πÔºåÂπ∂Â∞ÜËøô‰∫õÊï∞ÊçÆ‰øùÂ≠òÂú®‰∏Ä‰∏™Êú™ÂÆåÊàêÁöÑË∑ØÂæÑ‰∏≠„ÄÇ ÊâπÈáèËØ∑Ê±Ç‰∏éÈìæÂºèËØ∑Ê±ÇÊâπÈáèËØ∑Ê±ÇÊâπÈáèËØ∑Ê±ÇË¶ÅÂÅöÁöÑÊòØÂêåÊó∂ÂºÄÂßãÂ§ö‰∏™ËØ∑Ê±ÇÔºåÂú®ÊúÄÂêé‰∏Ä‰∏™ËØ∑Ê±ÇÂÆåÊàêÁöÑÊó∂ÂÄôÂõûË∞ÉÂ§ÑÁêÜÊñπÊ≥ï„ÄÇYTK Êèê‰æõ‰∫ÜÊâπÈáèËØ∑Ê±ÇÁöÑÂ∞ÅË£Ö YTKBatchRequest„ÄÇËôΩÁÑ∂‰πüÂè´ RequestÔºå‰ΩÜÊòØÂÆÉÂπ∂‰∏çÁªßÊâø‰∫é YTKRequest„ÄÇËÄåÊòØ‰øùÂ≠ò‰∫Ü YTKRequest ÁöÑ‰∏Ä‰∏™ÈõÜÂêà„ÄÇ ÁÆÄÂçïÊù•ËØ¥ÔºåÂÆÉÁöÑÂÆûÁé∞ÊñπÂºèÂ∞±ÊòØÂàùÂßãÂåñÁöÑÊó∂ÂÄô‰º†ÂÖ•‰∏Ä‰∏™ YTKRequest ÁöÑÈõÜÂêà„ÄÇÂú®Ë∞ÉÁî® YTKBatchRequest ÁöÑ start ÊñπÊ≥ïÂºÄÂßãËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÂ∞ÜÊØè‰∏™ YTKRequest ÁöÑ delegate ÈÉΩËÆæÁΩÆ‰∏∫ÂΩìÂâçÁöÑ YTKBatchRequest„ÄÇËøôÊ†∑Âú®ÊØè‰∏Ä‰∏™ËØ∑Ê±ÇËøîÂõûÁöÑÊó∂ÂÄôÔºåÈÉΩ‰ºöËµ∞Âà∞ YTKBatchRequest ÁöÑÂ§ÑÁêÜÊñπÊ≥ï‰∏≠„ÄÇ ÁÑ∂Âêé YTKBatchRequest ‰∏≠‰∏∫ÂÆåÊàêÁöÑËØ∑Ê±ÇËÆ°Êï∞„ÄÇÂΩìÂÆåÊàêÁöÑËØ∑Ê±ÇÂ∞è‰∫éÊÄªËØ∑Ê±ÇÊó∂ÔºåÂõûË∞ÉÊñπÊ≥ïÁõ¥Êé• return„ÄÇÂè™ÊúâÂΩìÂÆåÊàêÁöÑËØ∑Ê±ÇÁ≠â‰∫éÊÄªËØ∑Ê±ÇÊó∂ÔºåË°®Á§∫ÂÖ®ÈÉ®ËØ∑Ê±ÇÂÆåÊàêÔºåÊ≠§Êó∂ÊâßË°åÊàêÂäüÂõûË∞É„ÄÇ Â¶ÇÊûúÂÖ∂‰∏≠Êúâ‰ªªÊÑè‰∏Ä‰∏™ËØ∑Ê±ÇÂ§±Ë¥•‰∫ÜÔºåÈÇ£‰πàÂú®Â§±Ë¥•ÂõûË∞É‰∏≠Á´ãÂç≥‰∏∫ÊØè‰∏Ä‰∏™ Request Ë∞ÉÁî® cancel ÊñπÊ≥ïÔºåÂèñÊ∂àÊâÄÊúâËØ∑Ê±Ç„ÄÇ ‰ª•‰∏äÂ∞±ÊòØÊâπÈáèËØ∑Ê±ÇÁöÑÂÆûÁé∞„ÄÇÈùûÂ∏∏ÁÆÄÂçï„ÄÇ ÈìæÂºèËØ∑Ê±ÇYTK ‰∏∫ÈìæÂºèËØ∑Ê±ÇÊèê‰æõ‰∫Ü‰∏Ä‰∏™ YTKChainRequest Á±ªÔºåÂêåÊ†∑Ë¶ÅÊ±ÇÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄô‰º†ÂÖ•‰∏Ä‰∏™ YTKRequest ÁöÑÊï∞ÁªÑ„ÄÇÂú®Ë∞ÉÁî® YTKChainRequest ÁöÑ start ÊñπÊ≥ïÂºÄÂßãËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÂ∞ÜÁ¨¨‰∏Ä‰∏™ YTKRequest ÁöÑ delegate ËÆæÁΩÆ‰∏∫ÂΩìÂâçÁöÑ YTKChainRequest„ÄÇËøôÊ†∑Âú®ËØ∑Ê±ÇËøîÂõûÁöÑÊó∂ÂÄôÔºåÈÉΩ‰ºöËµ∞Âà∞ YTKChainRequest ÁöÑÂ§ÑÁêÜÊñπÊ≥ï‰∏≠„ÄÇ Èô§‰∫Ü YTKRequest ÁöÑÊï∞ÁªÑÔºåÂàõÂª∫ÁöÑÊó∂ÂÄôËøòÈúÄË¶Å‰º†ÂÖ•‰∏Ä‰∏™ÂõûË∞ÉÈó≠ÂåÖÁöÑÊï∞ÁªÑ„ÄÇËøôÊ†∑ÔºåÂú®ÊØè‰∏™ËØ∑Ê±ÇÂÆåÊàêÂêéÔºå‰æùÊ¨°ÊâßË°åÂõûË∞ÉÈó≠ÂåÖ‰∏≠ÁöÑÊñπÊ≥ï„ÄÇ Â¶ÇÊûúÂÖ∂‰∏≠‰∏Ä‰∏™ËØ∑Ê±ÇÂ§±Ë¥•‰∫ÜÔºåÈÇ£‰πàÊâßË°åËá™ÂÆö‰πâÁöÑÂ§±Ë¥•ÂõûË∞ÉÂç≥ÂèØ„ÄÇ Âíå CTNetworking ÊØîËæÉÔºåËøôÊ†∑ÁöÑÂ§ÑÁêÜÊñπÂºèÊØîËæÉÁõ¥Êé•Ôºå‰ΩÜÊòØ‰∏çÂ§ü‰ºòÈõÖ„ÄÇ ÊÄªÁªìCTNetworking Âíå YTKNetwork ÈÉΩÊòØÁ¶ªÊï£Âûã API ÁöÑÂÆûÁé∞„ÄÇ‰∏çËøáÊàëËÆ§‰∏∫ CTNetworking ÁöÑÂÆûÁé∞ÊñπÂºèÊõ¥‰∏∫‰ºòÈõÖ„ÄÇ‰ª•ÂçèËÆÆÁöÑÊñπÂºèÊòéÁ°ÆËÅåË¥£ÔºåÂºïÂÖ• delegateÔºåvalidatorÔºåinterceptorÔºåËÆ©ÂÆöÂà∂ÂåñÁ®ãÂ∫¶Êõ¥È´òÔºåÂπ∂‰∏îÂáèËΩª‰∫Ü VC ÁöÑË¥üÊãÖ„ÄÇÂºïÂÖ• CTService ËÆ©Â§öÊúçÂä°Êé•ÂÖ•È™åËØÅÂèòÂæóÁÆÄÂçï„ÄÇ‰ΩÜÊòØÂèçËøáÊù•ËØ¥ÔºåËøô‰πü‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÊèêÈ´ò‰∫ÜÂ≠¶‰π†ÊàêÊú¨„ÄÇÂπ∂‰∏î CTNetworing Âπ∂‰∏çÊîØÊåÅ‰∏ä‰º†‰∏é‰∏ãËΩΩÊñá‰ª∂„ÄÇÂÖ∂ÁºìÂ≠òÁ≠ñÁï•‰πüÈúÄË¶Å‰ΩøÁî®ËÄÖÊ†πÊçÆÂÆûÈôÖÈúÄÊ±ÇÂÅö‰∏ÄÂÆöÁöÑÊîπÂÜô„ÄÇÁõ∏ÊØîËæÉËÄåË®ÄÔºåYTKNetwork ÁöÑÂäüËÉΩÂ∞±Êõ¥Á∫ØÁ≤π‰∫Ü‰∏Ä‰∫õÔºå‰∏ìÊ≥®‰∫éÁΩëÁªúËØ∑Ê±ÇÔºåÂú®ÁºìÂ≠ò‰∏é‰∏ãËΩΩÊñπÈù¢ÂÅö‰∫ÜÂÖÖË∂≥ÁöÑÂ§ÑÁêÜ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
        <tag>Êû∂ÊûÑ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS ÂçïÂÖÉÊµãËØï]]></title>
    <url>%2F2017%2F09%2F09%2FiOS%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%2F</url>
    <content type="text"><![CDATA[ÂØπ‰∫éÂçïÂÖÉÊµãËØï‰∏ÄÁõ¥ÈÉΩÊòØËΩªËßÜÁöÑÔºå‰ΩÜÊòØÂ•ΩÁöÑÂçïÂÖÉÊµãËØïÂØπ‰∏Ä‰∫õ‰ΩéÁ∫ßÈîôËØØÁöÑÊ£ÄÊµãËøòÊòØÈùûÂ∏∏È´òÊïàÁöÑ„ÄÇËøôÈáåÊî∂ÈõÜ‰∏Ä‰∏ãÂçïÂÖÉÊµãËØïÁöÑ‰ΩøÁî®ÊñπÂºè„ÄÇ ÂçïÂÖÉÊµãËØïÁöÑÂ•ΩÂ§Ñ‰∏ªË¶ÅÂú®‰∫éÔºåÂ¶ÇÊûú‰∏Ä‰∏™È°πÁõÆÊØîËæÉÂ§ßÔºåÊàñËÄÖÊüê‰∏™ÂäüËÉΩÊîπÂä®ÊØîËæÉÂ§öÔºåÈÇ£‰πà‰Ω†ÂèØËÉΩÈ°∫ÊâãÊîπÊéâ‰∫ÜÊüê‰∫õÈõ∂Á¢éÁöÑ‰∏úË•øÔºåÊØîÂ¶ÇÊüê‰∏™ÈÖçÁΩÆÔºå‰ΩÜÊòØËøô‰∏™ÈîôËØØÂèà‰∏çÂÆπÊòìË¢´ÂèëÁé∞„ÄÇÊúâ‰∫ÜÂçïÂÖÉÊµãËØïÔºåÂΩì‰Ω†ÊîπÊéâÊüê‰∫õ‰∏úË•øÁöÑÊó∂ÂÄôÔºåÁ´ãÈ©¨Â∞±‰ºöÊòæÁ§∫Âá∫Êù•„ÄÇ ÁªìÊûÑÂèØ‰ª•ÈÄöËøá new ÁöÑÊñπÂºèÂàõÂª∫‰∏Ä‰∏™ iOS Unit Testing Bundle target„ÄÇÂèØ‰ª•ÁúãÂà∞ÈªòËÆ§ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂçïÂÖÉÊµãËØïÊñá‰ª∂Ôºö ÂÖ∂‰∏≠Ôºå„ÄÇËøô‰∏™ÊµãËØïÊñá‰ª∂ÁªßÊâø‰∫é XCTestCaseÔºåÂπ∂‰∏îÊèê‰æõ‰∫ÜÂá†‰∏™ÈªòËÆ§ÁöÑÊñπÊ≥ïÔºö setUp Ë°®Á§∫Âú®ËøõË°åÊµãËØïÊñπÊ≥ïÂâçÁöÑÂáÜÂ§áÂ∑•‰Ωú„ÄÇ tearDown Ë°®Á§∫ÊµãËØïÊñπÊ≥ïÂêéÁöÑÂñÑÂêéÂ∑•‰Ωú„ÄÇ testExample ÊòØ‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÊµãËØïÊñπÊ≥ïÔºåÊâÄÊúâÁöÑÊµãËØïÊñπÊ≥ïÈÉΩÂøÖÈ°ª‰ª• test ‰∏∫ÂºÄÂ§¥„ÄÇXcode ‰ºöËØÜÂà´Âà∞ÔºåÂú®ÂÖ∂ÂâçÈù¢ÁöÑ‰ª£Á†ÅË°åÊï∞Âå∫ÂüüÂ∞±‰ºöÊúâ‰∏Ä‰∏™Â∞èÊñπÂùóÔºåÂèØ‰ª•ÊâßË°åÔºåÊâßË°åÊàêÂäüÂ∞±ÊòØÂ¶ÇÂõæÊâÄÁ§∫„ÄÇ testPerformanceExample Ë°®Á§∫ÊµãËØïÊÄßËÉΩÔºåÂú®Ëøô‰∏™Èó≠ÂåÖ‰∏≠ÂÜôÂÖ•Ë¶ÅÊµãËØïÁöÑ‰ª£Á†Å„ÄÇ ÂºïÂÖ•ÁõÆÊ†áÊàë‰ª¨ÂèØ‰ª•Ëá™Â∑±ÂàõÂª∫ÂçïÂÖÉÊµãËØïÊñá‰ª∂„ÄÇÂØπ‰∫é‰Ω†Ë¶ÅÊµãËØïÁöÑÁ±ªÔºå‰Ω†ÈúÄË¶ÅÂºïÂÖ•ÁõÆÊ†áÊñá‰ª∂Ôºå‰Ω†ÈúÄË¶ÅÂú® import ÂâçÂä†‰∏ä @testable Ê†áÊ≥®Ôºö 1@testable import TargetClass ÂºÄÂßãÊµãËØïÂú®Â∑¶Èù¢ÊùøÁöÑÊµãËØïÂØºËà™Ê†èÔºåÂèØ‰ª•ÁúãÂà∞ÊâÄÊúâÁöÑÊµãËØïÊñπÊ≥ïÔºå‰Ω†ÂèØ‰ª•ÈÇÆ‰ª∂ËøêË°åÊâÄÊúâÊñπÊ≥ïÔºå‰πüÂèØ‰ª•ÂçïÁã¨ËøêË°åÂÖ∂‰∏≠‰∏Ä‰∏™ÊñπÊ≥ï„ÄÇÂΩìÁÑ∂Ôºå‰Ω†‰πüÂèØ‰ª•Âú®ÊØè‰∏™ÊµãËØïÊñá‰ª∂ÁöÑÊµãËØïÊñπÊ≥ïÂâçÁöÑ‰ª£Á†ÅË°åÊï∞Â§ÑÁúãÂà∞‰∏Ä‰∏™Â∞èÊñπÂùóÔºå‰πüÂèØ‰ª•ÁÇπÂáªËøô‰∏™Â∞èÊñπÂùóÂºÄÂßãÊµãËØï„ÄÇ ÊµãËØïÊñ≠Ë®ÄÊµãËØïËÇØÂÆöÈúÄË¶ÅÊñ≠Ë®ÄÁöÑÔºå‰∏çÁÑ∂ÊÄé‰πàÁü•ÈÅìÊµãËØïÊòØÂê¶ÊàêÂäüÂë¢„ÄÇÂ∏∏Áî®Êñ≠Ë®ÄÊúâ‰ª•‰∏ãÔºö 12345678910XCTAssert(expression, format...)XCTFail(format...)XCTAssertTrue(expression, format...)XCTAssertFalse(expression, format...)XCTAssertEqual(expression1, expression2, format...)XCTAssertNotEqual(expression1, expression2, format...)XCTAssertEqualWithAccuracy(expression1, expression2, accuracy, format...)XCTAssertNotEqualWithAccuracy(expression1, expression2, accuracy, format...)XCTAssertNil(expression, format...)XCTAssertNotNil(expression, format...) Ëøô‰∫õÊñ≠Ë®ÄÁöÑÊÑèÊÄùËøòÊòØÊØîËæÉÂ•ΩÁêÜËß£ÁöÑ„ÄÇ ÊÄßËÉΩÊµãËØïÊÄßËÉΩÊµãËØïÂèØ‰ª•ËÆæÁΩÆÂü∫ÂáÜÊó∂Èó¥ÔºåÊúÄÂ§ßÂÖÅËÆ∏ÁöÑÊ†áÂáÜÂ∑ÆÔºåË∂ÖËøáËøô‰∏™Ê†áÂáÜÂ∑ÆÔºåÂ∞±Ë°®Á§∫ÊÄßËÉΩÊµãËØï‰∏çÈÄöËøá„ÄÇÂÖ∑‰ΩìËÆæÁΩÆÂ¶ÇÂõæÊâÄÁ§∫Ôºö ÁÇπÂáªÊÄßËÉΩÊµãËØïÂâçÁöÑÁÅ∞Ëâ≤Â∞èÊñπÂùóÔºåÂ∞±‰ºöÂá∫Áé∞‰∏Ä‰∏™ÂºπÊ°ÜÔºåÁÑ∂ÂêéÂú®ÂÖ∂‰∏≠ËÆæÁΩÆÂç≥ÂèØÔºåÂåÖÊã¨ baseline Âíå Max STDDEV„ÄÇ ÊµãËØïÊñ≠ÁÇπÊàë‰ª¨Áü•ÈÅìÂºÇÂ∏∏ÊúâÂºÇÂ∏∏Êñ≠ÁÇπ„ÄÇÊµãËØïÂ§±Ë¥•‰πüÊúâÊñ≠ÁÇπ„ÄÇËøòÊòØËÄÅÂú∞ÊñπËÆæÁΩÆÔºö ÂºÇÊ≠•ÊµãËØïÊµãËØï‰ª£Á†Å‰∏ÄËà¨ÊâßË°åÂÆåÂ∞±ÁªìÊùü‰∫Ü„ÄÇÂÉèÁΩëÁªúËØ∑Ê±ÇÁ≠âÂºÇÊ≠•Êìç‰ΩúÈúÄË¶ÅÁâπÊÆäÁöÑÊñπÂºè„ÄÇ 12345678910111213141516171819// ÂºÇÊ≠•ÊµãËØï: ÊàêÂäüÂùóÔºåÂ§±Ë¥•ÊÖ¢func testValidCallToiTunesGetsHTTPStatusCode200() &#123; let url = URL(string: "https://itunes.apple.com/search?media=music&amp;entity=song&amp;term=abba") let promise = expectation(description: "Status code: 200") let dataTask = sessionUnderTest.dataTask(with: url!) &#123; data, response, error in if let error = error &#123; XCTFail("Error: \(error.localizedDescription)") return &#125; else if let statusCode = (response as? HTTPURLResponse)?.statusCode &#123; if statusCode == 200 &#123; promise.fulfill() &#125; else &#123; XCTFail("Status code: \(statusCode)") &#125; &#125; &#125; dataTask.resume() waitForExpectations(timeout: 5, handler: nil)&#125; ËøôÈáåÁöÑ expectation() ÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™È¢ÑÊúüÂØπË±°„ÄÇÁÑ∂ÂêéÈÄöËøá waitForExpectations(timeout:handler:) ÊñπÊ≥ïËÆæÁΩÆ‰∏Ä‰∏™Ë∂ÖÊó∂Êó∂Èó¥ÔºåÊâßË°åÂà∞ËøôÂè•ÁöÑÊó∂ÂÄôÂ∞±‰ºöÁ≠âÂæÖÈ¢ÑÊúüÂØπË±°ÁöÑÂà∞Êù•„ÄÇÊâÄ‰ª•Âú®ÂºÇÊ≠•ÁöÑÊàêÂäüÂõûË∞É‰∏≠Ë∞ÉÁî® fulfill() ÊñπÊ≥ïÔºåË°®Á§∫È¢ÑÊúüÂØπË±°Âà∞Êù•‰∫Ü„ÄÇËøôÊ†∑‰ª£Á†ÅÂ∞±ÊâßË°åÂÆå‰∫Ü„ÄÇÂè™Ë¶Å‰∏çÊòØÈÄöËøáÊñ≠Ë®ÄÊäõÂá∫ÁöÑÈîôËØØÔºåÊàñËÄÖË∂ÖÊó∂ÔºåÈÉΩË°®Á§∫ÊµãËØïÊàêÂäü„ÄÇ Ê≥®ÊÑèÔºåwaitForExpectations ÊòØÊöÇÂÅúÔºå‰πüÂ∞±ÊòØËØ¥ÔºåËøô‰∏™ÊñπÊ≥ïÂêéÈù¢ÁöÑÊñπÊ≥ï‰ºöÂÖà‰∏çÊâßË°åÔºåÁ≠âÂà∞ fulfill() ÂêéÂÜçÊâßË°å„ÄÇÊâÄ‰ª•Ôºå‰∏ÄËà¨Êàë‰ª¨ÂèØ‰ª•ÊääÂà§Êñ≠ÁöÑÊñ≠Ë®ÄÊîæÂú®Ëøô‰∏™ÊñπÊ≥ï‰πãÂêé„ÄÇ ÊñπÊ≥ïÂëΩÂêçÊµãËØïÊñπÊ≥ïÂøÖÈ°ªË¶Å‰ª• test ‰∏∫Â§¥ÔºåÊñπÊ≥ïÂëΩÂêçË¶ÅÊääËøô‰∏™ÊµãËØïÊñπÊ≥ïÁöÑÂäüËÉΩËÆ≤Ê∏ÖÊ•öÔºå‰∏çÈúÄË¶Å‰ΩøÁî®È©ºÂ≥∞ÂºèÂëΩÂêçÔºåÁî®‰∏ãÂàíÁ∫øÈöîÂºÄÂç≥ÂèØ„ÄÇÂ¶ÇÔºö 1func test_weatherDataAt_handle_statuscode_not_equal_to_200() &#123;&#125; ÊµãËØïÁßÅÊúâÊñπÊ≥ïÂíåÂ±ûÊÄßÊàë‰ª¨‰∏çËÉΩÁõ¥Êé•Ëé∑ÂèñÂà∞ÁßÅÊúâÁöÑÊñπÊ≥ïÊàñËÄÖÂ±ûÊÄßÔºå‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá category Êö¥Èú≤ÁßÅÊúâÊñπÊ≥ïÂíåÂ±ûÊÄßÔºö 1234@interface JHSTestDataSource (UnitTest)- (NSInteger)getSellGroupCount;- (BOOL)needShowHeader:(NSInteger)section;@end ÊúÄÂêéÂÖ≥‰∫éÂ¶Ç‰Ωï mock Êï∞ÊçÆÔºåOC ‰∏≠Êèê‰æõ‰∫Ü OCMock Ëøô‰∏™Â∫ìÔºåÂèØ‰ª•ÈÄöËøá runtime Â∞ÜÊñπÊ≥ïËøîÂõûÁöÑÁªìÊûúÊõøÊç¢„ÄÇ‰ΩÜÊòØ Swift Áî±‰∫éÊòØÈùôÊÄÅËØ≠Ë®ÄÔºåÂπ∂‰∏çËÉΩÊèê‰æõÊîØÊåÅ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Â¶Ç‰ΩïÈÖçÁΩÆÂ∫îÁî®ÁöÑÁéØÂ¢ÉÂèòÈáè]]></title>
    <url>%2F2017%2F08%2F30%2F%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%E5%BA%94%E7%94%A8%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%2F</url>
    <content type="text"><![CDATA[‰∏ÄËà¨ÁöÑÈ°πÁõÆ‰∏≠Â§ö‰∏™ÁéØÂ¢ÉÁöÑÂàáÊç¢ÔºåÈÉΩÊòØ‰æùÈù†‰øÆÊîπ‰ª£Á†Å„ÄÇ‰ΩÜÊòØËøôÊ†∑ÁöÑÂÅöÊ≥ï‰∏çÂ§ü‰ºòÈõÖÔºåÊàë‰ª¨ÂÖ∂ÂÆûÂèØ‰ª•ÈÄöËøá‰∏§ÁßçÊõ¥Â•ΩÁöÑÊñπÂºèÂéªÂÆûÁé∞„ÄÇ ‰ΩøÁî® Build Configuration ÈÖçÁΩÆÁ≥ªÁªüÈªòËÆ§Êúâ‰∏§‰∏™ ConfigurationÔºå‰∏Ä‰∏™ÊòØ DebugÔºå‰∏Ä‰∏™ÊòØ Release„ÄÇÂ¶ÇÊûúË¶ÅÂ§öÁéØÂ¢ÉÂàáÊç¢ÁöÑËØùÂ∞±ÈúÄË¶ÅÊàë‰ª¨Ëá™Â∑±ÂàõÂª∫ Build Configuration„ÄÇ Êñ∞Âª∫ Build ConfigurationÂú® Project ÁöÑ Configuration ‰∏≠ÈÄâÊã© Duplicate &quot;Debug&quot; CofigurationÔºåÊ∑ªÂä†‰∏Ä‰∏™ Bebug Ê®°ÂºèÁöÑ copy„ÄÇÂ∞ÜÂÖ∂ÊîπÂêç‰∏∫ OnlineDebugÔºå‰πãÂêéÂÆÉÂ∞ÜË¢´Áî®‰∫éÁ∫ø‰∏äÁéØÂ¢ÉÁöÑ debugÔºö Â¶ÇÊûú‰ΩøÁî® CocoapodsÔºåÈÇ£‰πàÊ∑ªÂä†Êñ∞ÁöÑ Configuration ÂêéÂøÖÈ°ªÊâßË°å pod install„ÄÇpod ‰ºö‰∏∫Êñ∞ÁöÑ Configuration ÁîüÊàê xcconfig Êñá‰ª∂Ôºö Ê∑ªÂä†‰∫ÜËøô‰∏™ Configuration ÂêéÔºåÂú® Build Setting ‰∏≠Â∞±Â§ö‰∫Ü‰∏Ä‰∏™ OnlineDebug ÁöÑÈÖçÁΩÆÔºö ‰øÆÊîπ Build SettingÂàõÂª∫Â•Ω‰∫ÜÊñ∞ÁöÑ ConfigurationÔºåÊàë‰ª¨Ë¶ÅÁî®ÂÆÉÂπ≤‰ªÄ‰πàÂë¢ÔºüÊàë‰ª¨ÂèØ‰ª•Âú® Build Setting ‰∏≠Ê†πÊçÆ‰∏çÂêåÁöÑ Configuration ËÆæÁΩÆ‰∏çÂêåÁöÑÂèÇÊï∞„ÄÇÊØîÂ¶ÇÊàë‰ª¨ÂèØ‰ª•ÈíàÂØπ‰∏çÂêåÁöÑ Configuration ËÆæÁΩÆ target ÁöÑ Build Settings(Ê≥®ÊÑèÊòØ target ‰∏çÊòØ projectÔºå‰∏∫‰ªÄ‰πàÂêéÈù¢ÂÜçËØ¥) ‰∏≠ÁöÑ Product Bundle Indentifer ‰ª•Âèä Product Name „ÄÇËøôÊ†∑ÂÆâË£ÖÁöÑÊó∂ÂÄôÂ∞±‰ºöÊåâÁÖßÈÖçÁΩÆÊõ¥Êç¢ Bundle ID Âíå ÂêçÂ≠óÔºö ‰∏ç‰ªÖÂ¶ÇÊ≠§ÔºåÊàë‰ª¨ËøòÂèØ‰ª•Ëá™ÂÆö‰πâ‰∏Ä‰∫õËÆæÁΩÆ„ÄÇËøôÊ¨°Êàë‰ª¨ÂõûÂà∞ project ÁöÑ Build Setting ‰∏≠ÂéªÔºåÁÇπÂáª Add User-Defined Setting: ‰πãÂêéÂ∞±‰ºöÂú® Build Setting Â∫ïÈÉ®ÁöÑ User-SETTING ‰∏ÄÊ†èÊ∑ªÂä†‰∫Ü‰∏Ä‰∏™ NEW_SETTING„ÄÇ‰∏æ‰∏™‰æãÂ≠êÔºåÊàë‰ª¨Â∞ÜÂÖ∂ÊîπÂêç‰∏∫ CustomProductNameÔºåÁÑ∂Âêé‰øÆÊîπÂêÑ‰∏™ Configuration ÂØπÂ∫îÁöÑÂÄºÔºö ËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•Âú®ÂÖ∂‰ªñÂú∞Êñπ‰ΩøÁî®Ëøô‰∏™ CustomProductName ‰∫Ü„ÄÇ ËôΩÁÑ∂Êàë‰ª¨ÊòØÂú® Project ‰∏≠‰øÆÊîπÁöÑÔºå‰ΩÜÊòØÊâìÂºÄ target ÁöÑ Build SettingÔºåÂèØ‰ª•ÁúãÂà∞ÔºåÂú®ÂÖ∂‰∏≠‰πüÊ∑ªÂä†‰∫Ü‰∏Ä‰∏™ CustomProductName: ‰øÆÊîπ info.plist Êñá‰ª∂info.plist Êñá‰ª∂‰∏≠‰øùÂ≠òÁùÄËÆ∏Â§öÂ∫îÁî®ÁöÑÈÖçÁΩÆ‰ø°ÊÅØÔºö ÊØîÂ¶Ç‰∏äÈù¢ÁöÑ Bundle Name ÂØπÂ∫îÁöÑÂÄº $(PRODUCT_NAME)ÔºåÂ∞±Ë°®Á§∫ Build Setting ‰∏≠ÁöÑ Product Name Ëøô‰∏ÄÈ°π„ÄÇÂÖ∂ÂÆûÂèØ‰ª•Áõ¥Êé•Âú® Build Setting ‰∏≠ËÆæÁΩÆ Product Name ÁöÑÔºå‰ΩÜÊòØÁî±‰∫é‰∏äÈù¢Êàë‰ª¨ÊòØËá™ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ CustomProductNameÔºåÊâÄ‰ª•Êàë‰ª¨ËøôÈáåÂ∞ÜÂÖ∂Êîπ‰∏∫ ${CustomProductName}(Áî®Â∞èÊã¨Âè∑ÂíåÂ§ßÊã¨Âè∑ÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂèÇËÄÉ)„ÄÇËøêË°å‰∏Ä‰∏ãÂèëÁé∞ App ÁöÑÂêçÁß∞Á°ÆÂÆûÂíå CustomProductName ÈÖçÁΩÆÁöÑ‰∏ÄÊ†∑„ÄÇ ÂÖ∂ÂÆû info.plist ‰πüÊòØÂèØ‰ª•Âú® Build Setting ‰∏≠ËÆæÁΩÆÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•Ëá™Â∑±ÂàõÂª∫ËØ∏Â¶Ç myInfo.plistÔºåyourInfo.plist Á≠âÊñá‰ª∂ÔºåÂè™Ë¶ÅËÆæÁΩÆÂ•ΩÂÖ∂Á¥¢ÂºïÂ∞±Ë°åÔºö Êñ∞Âª∫ SchemeÁé∞Âú®Êàë‰ª¨Â¶ÇÊûúË¶ÅÂàáÊç¢ ConfigurationÔºåÈúÄË¶ÅÂú® Edit Scheme ‰∏≠ÂàáÊç¢ Build Configuration: ËøôÊ†∑ÊØèÊ¨° Run ÈÉΩÈúÄË¶ÅÂ§öÁÇπÂá†‰∏ãÊØîËæÉÈ∫ªÁÉ¶„ÄÇÊó¢ÁÑ∂Âú®‰∏Ä‰∏™ scheme ‰∏≠‰øÆÊîπÊØîËæÉÈ∫ªÁÉ¶ÔºåÈÇ£‰πàÊàë‰ª¨‰∏∫‰ªÄ‰πà‰∏çÊñ∞Âª∫Â§ö‰∏™ Scheme Âë¢Ôºü Êàë‰ª¨ÈÄâÊã© New Scheme ÂêéÔºå‰ºöÂºπÂá∫Â¶Ç‰∏ãÂØπËØùÊ°ÜÔºåÈÄâÊã©Ê≠£Á°ÆÁöÑÈúÄË¶ÅËøêË°åÁöÑ TargetÔºåÁÑ∂ÂêéÁªôÊñ∞ÁöÑ Scheme Âèñ‰∏Ä‰∏™ÂêçÂ≠ó TestConfigurationNew: Êñ∞Âª∫Âè∑ Scheme ÂêéÔºåÊàë‰ª¨ÈÄâÊã© manage scheme Êü•Áúã: ÁúãÂà∞Êúâ‰∏§‰∏™ÂãæÈÄâÈ°πÔºå‰∏Ä‰∏™Âè´ showÔºå‰∏Ä‰∏™Âè´ shared„ÄÇshow ÈÄâÈ°πÂãæ‰∏äÂêéÔºåÂ∞±ÂèØ‰ª•Âú®‰∏äÂõæÁöÑ‰ΩçÁΩÆÊòæÁ§∫‰ª•ÂèäËÉΩË¢´ÈÄâÊã©ËøêË°åÔºåÂê¶ÂàôÂ∞±ÈöêËóèËµ∑Êù•„ÄÇshared ÈÄâÈ°πË°®Á§∫ÊòØÂê¶Â∞Ü scheme ÂÖ±‰∫´ÁªôÂà´‰∫∫„ÄÇÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÂ¶ÇÊûúÊàë‰ª¨‰∏ç‰∏∫ÂàöÂàöÂàõÂª∫ÁöÑ TestConfigurationNew Âãæ‰∏äÔºåÈÇ£‰πàËØ• scheme ÁîüÊàêÁöÑ TestConfigurationNew.xcscheme Êñá‰ª∂Â∞Ü‰ºö‰øùÂ≠òÂú® zachary.xcuserdatad Êñá‰ª∂Â§π‰∏ãÔºåÂà´‰∫∫ÁöÑ xcode ÊòØÊó†Ê≥ïËØÜÂà´ÁöÑ„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú‰Ω†Âãæ‰∏ä‰∫Ü shareÔºåÈÇ£‰πàÂ∞±‰ºöÂÉè‰∏ãÈù¢ÈÇ£Ê†∑ÊòæÁ§∫Âú® xcshareddata Êñá‰ª∂Â§π‰∏ã„ÄÇËøô‰πüÂëäËØâÊàë‰ª¨ÔºåÂú®ÂÜô gitignore ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ÂøΩÁï• xcuserdata Êñá‰ª∂Â§πÂÜÖÁöÑÊñá‰ª∂Ôºå‰ΩÜÊòØ‰∏ÄÂÆö‰∏çËÉΩÂøΩÁï• xcshareddata ÂÜÖÁöÑÊñá‰ª∂„ÄÇ Áé∞Âú®Êàë‰ª¨Êñ∞Âª∫‰∫Ü TestConfigurationNew Ëøô‰∏™ scheme ÂêéÔºåÂ∞±ÂèØ‰ª•‰∏∫ÊØè‰∏™ scheme ËÆæÁΩÆÂçïÁã¨ÁöÑ Build Configuration„ÄÇÊØèÊ¨° Run ÁöÑÊó∂ÂÄôÔºåÂàáÊç¢ schemeÔºåËÄå‰∏çÊòØÂàáÊç¢ scheme ‰∏≠ÁöÑ Configuration„ÄÇ ÂàÜÁéØÂ¢ÉÁöÑÊØîËæÉÂ•ΩÁöÑÊñπÂºè‰∏äÈù¢ÁöÑÊñπÂºèÊòØÊñ∞Âª∫‰∏Ä‰∏™ schemeÔºåÁÑ∂ÂêéÂú® debug Ê®°Âºè‰∏ãÂØπÂ∫îÁöÑ Configuration ÊòØ OnlineDebugÔºå‰ΩÜÊòØÂÖ∂ Archieve ÂØπÂ∫îÁöÑËøòÊòØ release„ÄÇÈÇ£‰πàÂ¶ÇÊûúÊÉ≥Ë¶ÅÈíàÂØπ OnlineDebug ÁöÑÁéØÂ¢ÉÊâì‰∏Ä‰∏™ release ÂåÖÔºåËØ•ÊÄé‰πàÂäûÂë¢ÔºüÊàë‰ª¨ÈúÄË¶ÅÂÜç Deplicate release ConfigurationÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂ÂëΩÂêç‰∏∫ OnlineRelease: ÁÑ∂ÂêéÔºåÂ∞Ü TestConfigurationNew ÁöÑ archieve ‰∏≠ÁöÑ Build Configuration Êîπ‰∏∫ OnlineRelease: ‰πüÂ∞±ÊòØËØ¥ÔºåÊØè‰∏Ä‰∏™ÁéØÂ¢ÉÈÉΩÂ∫îËØ•ÊúâÂÖ∂ÂØπÂ∫îÁî® debug ‰ª•Âèä release ÁöÑ ConfigurationÔºö ÈÖçÁΩÆÂíåËé∑ÂèñÁéØÂ¢ÉÂèòÈáèËØ¥‰∫ÜÂçäÂ§©Ê∑ªÂä† ConfigurationÔºåÈÇ£‰πàÂà∞Â∫ïÂíåÂå∫ÂàÜÁéØÂ¢ÉÊúâ‰ªÄ‰πàÂÖ≥Á≥ªÂë¢ÔºüÊúâ‰∏§ÁßçÊñπÂºèÂèØ‰ª•Â§ÑÁêÜ„ÄÇ ‰ΩøÁî®È¢ÑÁºñËØëÂÆèÊàë‰ª¨ËøõÂÖ• Project ÁöÑ Build SettingÔºåÂÖ∂‰∏≠ÁöÑ Preprocessor Macros ÂèØ‰ª•Ê∑ªÂä†‰∏Ä‰∫õÁéØÂ¢ÉÂèòÈáèÁöÑÂÆèÊù•ÂÅöÊ†áËØÜÁ¨¶ÔºåÊØîÂ¶ÇÊ∑ªÂä† ONLINE Âíå OFFLINE Ê†áËØÜÁ¨¶ÔºåÊù•Âå∫ÂàÜÁ∫ø‰∏äÂíåÁ∫ø‰∏ãÁéØÂ¢ÉÔºö Áé∞Âú®Ôºå‰Ω†Â∞±ÂèØ‰ª•ËøôÊ†∑ËÆæÁΩÆÁéØÂ¢É‰∫ÜÔºö 12345678910#ifdef ONLINE#define searchURL @"http://www.baidu.com"#define sociaURL @"weibo.com"#elif OFFLINE#define searchURL @"http://www.bing.com"#define sociaURL @"twitter.com"#else#define searchURL @"http://www.google.com"#define sociaURL @"facebook.com"#endif ‰ΩøÁî® plist Êñá‰ª∂Âä®ÊÄÅÈÖçÁΩÆÈô§‰∫Ü‰ΩøÁî®ÂÆèÔºåËøòÂèØ‰ª•ËØªÂèñ plist ÈáåÁöÑÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇÊàë‰ª¨ÂèØ‰ª•‰∏∫ÊØè‰∏Ä‰∏™ Configuration Êèê‰æõ‰∏Ä‰∏™ plist Êñá‰ª∂ÔºåÂ∞ÜÈÖçÁΩÆ‰ø°ÊÅØÂàÜÂà´ÂÜôÂÖ•„ÄÇÁî±‰∫é‰∏Ä‰∏™Êñá‰ª∂Â§πÂÜÖ‰∏çËÉΩÊúâÂêåÂêçÁöÑÊñá‰ª∂ÔºåÊâÄ‰ª•Êàë‰ª¨‰∏∫ÊØè‰∏Ä‰∏™ Configuration ÁöÑ plist ÈÉΩÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂Â§πÔºö ÁÑ∂ÂêéÂú® target ÁöÑ build phase ‰∏≠Ê∑ªÂä† New Run Script PhaseÔºåÂ∞ÜÂÖ∂ÂëΩÂêç‰∏∫ Copy Configuration: Âú®ÂÖ∂‰∏≠Ê∑ªÂä†Â¶Ç‰∏ã shell ËÑöÊú¨Ôºö 1234567echo "CONFIGURATION -&gt; $&#123;CONFIGURATION&#125;"RESOURCE_PATH=$&#123;SRCROOT&#125;/$&#123;PRODUCT_NAME&#125;/config/$&#123;CONFIGURATION&#125;BUILD_APP_DIR=$&#123;BUILT_PRODUCTS_DIR&#125;/$&#123;PRODUCT_NAME&#125;.appecho "Copying all files under $&#123;RESOURCE_PATH&#125; to $&#123;BUILD_APP_DIR&#125;"cp -v "$&#123;RESOURCE_PATH&#125;/"* "$&#123;BUILD_APP_DIR&#125;/" Ëøô‰∏™ËÑöÊú¨ÁöÑÁõÆÁöÑÂ∞±ÊòØÂ∞ÜÊ†πÊçÆ Configuration Â§çÂà∂‰∏çÂêå config Êñá‰ª∂Â§π‰∏ãÁöÑÊñá‰ª∂ÔºåÂà∞ xxx.app ÁöÑÊ†πÁõÆÂΩï‰∏ãÔºå‰πüÂ∞±ÊòØ mainBundle ‰∏ã„ÄÇ ËØªÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•Ê†πÊçÆÊñá‰ª∂Ë∑ØÂæÑËé∑ÂèñÔºö 123456- (NSString *) readValueFromConfigurationFile &#123; NSBundle *bundle = [NSBundle mainBundle]; NSString *path = [bundle pathForResource:@"Configuration" ofType:@"plist"]; NSDictionary *config = [NSDictionary dictionaryWithContentsOfFile:path]; return config[@"serverURL"];&#125; Èô§‰∫Ü plistÔºåÊàë‰ª¨‰πüÂèØ‰ª•Áî®ËøôÁßçÊñπÊ≥ïÈÖçÁΩÆ‰∏çÂêåÁöÑÊñá‰ª∂„ÄÇ ‰∏äÈù¢ÊèêÂà∞ÁöÑÂá†‰∏™Ê¶ÇÂøµ‰∏äÈù¢‰∏Ä‰ºöÂÑø‰øÆÊîπ project ÁöÑ Build SettingÔºå‰∏Ä‰ºöÂÑø‰øÆÊîπ target ÁöÑ Build Setting„ÄÇ‰∏Ä‰ºöÂÑøÊ∑ªÂä† ConfigurationÔºå‰∏Ä‰ºöÂÑøÂèàÊ∑ªÂä† Scheme ÁöÑ„ÄÇÈÇ£‰πàËøô‰∫õÊ¶ÇÂøµÂà∞Â∫ïÊòØ‰ªÄ‰πàÊÑèÊÄùÂë¢Ôºü SchemeÔºåConfiguration ‰ª•Âèä TargetËøô‰∏âËÄÖÁöÑÂÖ≥Á≥ªÔºåÁî® Edit Scheme Â∞±ÂèØ‰ª•Ë°®Áé∞ÁöÑ‰∏ÄÁõÆ‰∫ÜÁÑ∂Ôºö ÂèØ‰ª•ÁúãÂà∞ÔºåSchemeÔºåÂ∞±ÊòØÂêåÊÑèË∞ÉÈÖç Configuration ‰ª•Âèä Target ÁöÑÔºå‰πüÂ∞±ÊòØËÆ©Âì™‰∏™ Target ÂØπÂ∫î‰∫é Âì™‰∏™ Configuration„ÄÇ .xcconfig Âíå ConfigurationÊàë‰ª¨ÂèØ‰ª•Áúã‰∏Ä‰∏ã‰∏Ä‰∏™ÈùûÂÆòÊñπÁöÑ xccofig ÁöÑÊïôÁ®ã(Ëøô‰∏™ÊïôÁ®ãÂØπ‰∫é xcconfig ‰ªãÁªçÁöÑÈùûÂ∏∏Â•Ω)‰∏≠ÁöÑ‰∏ÄÂè•ËØùÔºö A xcconfig file is used as a supplemental file to a specific build configuration. A build configuration can have an associated xcconfig file, this allows for additional changes to the target‚Äôs build settings from outside the Xcode project editor. ÊÑèÊÄùÊòØ‰∏Ä‰∏™ Configuration ÂèØ‰ª•Êúâ‰∏Ä‰∏™‰∏éÂÖ∂Áõ∏ÂÖ≥ËÅîÁöÑ xcconfig„ÄÇxcconfig ÂèØ‰ª•‰ΩøÊàë‰ª¨ËÉΩÂ§ü‰∏çÂú® Xcode ÁöÑÊèê‰æõÁöÑÁºñËæëÂô®‰∏≠ÁºñËæë Build Setting„ÄÇ ÂØπ‰∫é‰∏Ä‰∏™Ê≤°Êúâ‰ΩøÁî® Cocoapods ÁöÑÈ°πÁõÆÔºåÂÖ∂ Configuration ‰∏ã Based on Configuration File ÈÉΩÊòØ NoneÔºåÂõ†‰∏∫Êàë‰ª¨Áõ¥Êé•‰øÆÊîπ Build Setting Â∞±ÂèØ‰ª•‰∫ÜÔºö ‰ΩÜÊòØ‰ΩøÁî®‰∫Ü Cocoapods ÁöÑÈ°πÁõÆÔºåÂú® pod install ÂêéÔºå‰ºöËá™Âä®‰∏∫ÊØè‰∏Ä‰∏™ Configuration ÁîüÊàê‰∏Ä‰∏™ xcconfig„ÄÇÂõ†‰∏∫ Pod ‰∏çËÉΩÁõ¥Êé•‰øÆÊîπ‰Ω†ÁöÑ Build SettingÔºåÊâÄ‰ª•Âè™ËÉΩÂÄüÂä©‰∫é xcconfigÔºö Êàë‰ª¨Êù•Áúã‰∏Ä‰∏ã Pod ÁîüÊàêÁöÑ‰∏Ä‰∏™ xcconfigÔºö È¶ñÂÖàÁúãÁ¨¨‰∏ÄÂè• GCC_PREPROCESSOR_DEFINITIONS = $(inherited) COCOAPODS=1„ÄÇGCC_PREPROCESSOR_DEFINITIONS ÊòØ GCC È¢ÑÁºñËØëÂ§¥ÂèÇÊï∞Ôºå‰πüÂ∞±ÊòØÊàë‰ª¨‰πãÂâçËÆæÁΩÆËøáÁöÑ Preprocessor Macros„ÄÇ$(inherited) Ë°®Á§∫ÁªßÊâø‰∫é‰πãÂâçÁöÑËÆæÁΩÆ„ÄÇÊàë‰ª¨ÊâìÂºÄ target ÁöÑ Build SettingÔºåÊâæÂà∞Ëøô‰∏ÄÈ°πÔºö ÂèØ‰ª•ÁúãÂà∞ÔºåËøô‰∏ÄÈ°πÂíå xcconfig ‰∏≠ËÆæÁΩÆÁöÑ‰∏ÄÊ†∑„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•ÁåúÊÉ≥ÔºöÂú® project ÁöÑ Configuration Ëøô‰∏ÄÈ°π‰∏≠ÔºåÂ∞Ü target Âíåxcconfig ÂÖ≥ËÅî‰∫ÜËµ∑Êù•Ôºåxcconfig ‰∏≠ÁöÑÊØè‰∏ÄÈ°πÔºåÂ¶ÇÊûú target ÁöÑ Build Setting ‰∏≠ÂéüÊù•‰∏çÂ≠òÂú®ÔºåÈÇ£‰πàÂ∞±ÊòØÊñ∞Âª∫ÁöÑ User-DefinedÔºåÂ¶ÇÊûú target ÁöÑ Build Setting ‰∏≠Â≠òÂú®ÔºåÈÇ£‰πàÂ∞±ÊòØÈáçÂÜô„ÄÇ‰∏äÈù¢ÊèêÂèäÁöÑÈùûÂÆòÊñπÊïôÁ®ã‰∏≠‰πüÊúâËØ¶ÁªÜËØ¥Êòé„ÄÇ ÊØîÂ¶Ç‰∏äÈù¢ xcconfig ‰∏≠ÊèêÂèäÁöÑ PODS_ROOT ‰∏ÄÈ°πÊòØ Build Setting ‰∏≠ÂéüÊú¨Ê≤°ÊúâÁöÑÔºåÈÇ£Êàë‰ª¨Â∞±Âà∞ target ÁöÑ User-Defined ‰∏≠ÂéªÊü•ÁúãÔºåÁ°ÆÂÆûË¢´Êñ∞Âª∫‰∫ÜÂá∫Êù•„ÄÇ ÂÜçÊØîÂ¶ÇÔºåÊàë‰ª¨‰øÆÊîπ xcconfig ‰∏≠ÁöÑ GCC_PREPROCESSOR_DEFINITIONS = $(inherited) COCOAPODS=1 ‰∏∫ GCC_PREPROCESSOR_DEFINITIONS = $(inherited) COCOAPODS=1 hello=1ÔºåÂ¢ûÂä†‰∫Ü‰∏Ä‰∏™ hello=1„ÄÇÊàë‰ª¨Êù•Áúã Build SettingÔºåÁ°ÆÂÆûÂ¢ûÂä†‰∫Ü hello Ëøô‰∏ÄÈ°π„ÄÇÂÜçÊ¨°È™åËØÅ‰∫ÜÁåúÊÉ≥Ôºö ÊØè‰∏Ä‰∏™ target ÈÉΩÂèØ‰ª•ËÆæÁΩÆ‰∏Ä‰∏™Áõ∏ÂÖ≥ÁöÑ xcconfigÔºåÊù•ÈÖçÁΩÆÂÖ∂ Build SettingÔºåÊ≤°ÊúâÂ∞±ÊòØ NoneÔºåCocoapods Â∞±ÊòØÂü∫‰∫éËøô‰∏™ÂéüÁêÜ„ÄÇÊàë‰ª¨‰πüÂèØ‰ª•Ëá™Â∑±ÂàõÂª∫ xcconfig Êù•ÈÖçÁΩÆÔºö ËøôÈáåÁõóÁî®‰∫Ü‰∏ÄÂº†Âà´‰∫∫ÁöÑÂõæÔºå‰ªñ‰∏∫ÊØè‰∏Ä‰∏™ Configuration ÈÉΩÂàõÂª∫‰∫Ü‰∏Ä‰∏™ xcconfigÔºåÂπ∂Â∞ÜÂÖ∂‰∏é target ÂÖ≥ËÅîÔºö ÁÑ∂ÂêéÂú®ÂÖ∂‰∏≠Ê∑ªÂä†Ëá™Â∑±ÁöÑËÆæÁΩÆ„ÄÇÊ≥®ÊÑèÔºåÂ¶ÇÊûú‰ΩøÁî®‰∫Ü pod Ë¶ÅÂú®ÂÖ∂‰∏≠ÂºïÂÖ• pod ÁöÑ xcconfigÔºö ÊâÄ‰ª•ÔºåÂØπ‰∫éÊàë‰ª¨Êù•ËØ¥ÔºåËá™ÂÆö‰πâ xcconfig ÂÖ∂ÂÆûÂÆåÂÖ®Á≠â‰ª∑‰∫éÁõ¥Êé•Â§ÑÁêÜ Build Setting„ÄÇÂõ†Ê≠§ÔºåËøô‰πüÊòØ‰∏ÄÁßç‰øÆÊîπÁéØÂ¢ÉÂèòÈáèÁöÑÊñπÂºè„ÄÇ Target ‰ª•Âèä Project ÁöÑ Build Setting‰πãÂâçÊàë‰ª¨Êó∂ËÄåËÆæÁΩÆ Target ÁöÑ Build SettingÔºåÊó∂ËÄåËÆæÁΩÆ Project ÁöÑ Build SettingÔºåÈÇ£‰πàÂà∞Â∫ï‰∏§ËÄÖÊúâ‰ªÄ‰πàÂå∫Âà´Âë¢„ÄÇÂÖ∂ÂÆû‰πãÂâçËØ¥ÁöÑÈÇ£ÁØáÊïôÁ®ã‰∏≠‰πüÊúâËØ¥Êòé„ÄÇ ÁÆÄÂçïÊù•ËØ¥ÔºåBuild Setting Êúâ‰∏Ä‰∏™ÁªßÊâøÂÖ≥Á≥ªÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰∏ãÈù¢‰∏ÄÂº†Âõæ‰∫ÜËß£Ôºö Êàë‰ª¨Âú® Build Setting ‰∏≠ÈÄâÊã© LevelsÔºåËøôÊ†∑Êï¥‰∏™ÁªßÊâøÂÖ≥Á≥ªÂ∞±Âπ≥Èì∫‰∫Ü‰∏ãÊù•„ÄÇÁªßÊâøÁ∫ßÂà´‰ªéÂ∑¶ÂêëÂè≥‰æùÊ¨°Èôç‰Ωé„ÄÇÊúÄÂè≥ËæπÁöÑÊòØ iOS DefaultÔºåÊèê‰æõ‰∏Ä‰∏™ÈªòËÆ§ÁöÑËÆæÁΩÆÔºåÊàë‰ª¨ÂèØ‰ª•Âú® Project ÁöÑ Build Setting ‰∏≠‰øÆÊîπÂÆÉ„ÄÇÁÑ∂ÂêéÊòØ target ÁöÑ xcconfigÔºåËøôÈáåÂ∞±ÊòØ pod ÁîüÊàêÁöÑ xcconfigÔºåÂÆÉÂèØ‰ª•‰øÆÊîπ Build Setting ÁöÑÈÄâÈ°π„ÄÇÊúÄÂêéÊòØ target ÁöÑ Build SettingÔºå‰øÆÊîπÁ∫ßÂà´ÊúÄÈ´ò„ÄÇÊúÄÁªàÁöÑÁªìÊûúÂ∞±ÊòØ Resolved ‰∏ÄÊ†èÊòæÁ§∫ÁöÑ„ÄÇ Ëøô‰πüÂ∞±Ëß£Èáä‰∫Ü‰πãÂâç‰∏∫‰ªÄ‰πàÊó∂ËÄåÁî® Project ÁöÑ Build SettingÔºåÊó∂ËÄåÁî® Target ÁöÑ Build Setting„ÄÇÂΩì‰Ω†ÊÉ≥Ë¶Å‰øÆÊîπÁöÑ‰∏úË•øË¶Å‰ΩúÁî®‰∫éÊâÄÊúâ target ÁöÑÊó∂ÂÄôÔºåÂ∞±Âú® Project ‰∏≠‰øÆÊîπ„ÄÇÂ¶ÇÊûúÂè™ÊòØÊÉ≥ÈíàÂØπÊüê‰∏Ä‰∏™ targetÔºåÈÇ£‰πàÂ∞±‰øÆÊîπ target ÁöÑ Build Setting„ÄÇ ‰∏Ä‰∏™Â∞èÈóÆÈ¢òËøôÈáåÂú®ÁúãÂà∞‰∏Ä‰∏™ÂÖ≥‰∫éÊñ∞Âª∫ Configuration ‰ºö‰∫ßÁîüÁöÑ‰∏Ä‰∏™ÈóÆÈ¢òÔºöÊñ∞Âª∫ÁöÑ Configuration Âú®ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÊó†Ê≥ïË∞ÉËØïÔºö ÂèØËßÅÂÆòÊñπÊñáÊ°£ ‰ΩøÁî® Target ÈÖçÁΩÆÂú®ÂàõÂª∫‰∫ÜÈ°πÁõÆÂêéÔºåÈ°πÁõÆÊú¨Ë∫´ÂåÖÂê´‰∏Ä‰∏™ targetÔºåÊàë‰ª¨ÂèØ‰ª•‰ª•Ëøô‰∏™ target ‰∏∫Âü∫Á°ÄÔºåÂàõÂª∫Âá∫ÊµãËØïÁéØÂ¢ÉÔºåÁ∫ø‰∏äÁéØÂ¢ÉÁöÑ target„ÄÇ Êàë‰ª¨ÂÖà Duplicate ‰∏Ä‰∏™ targetÔºö Â∞Ü‰ºöÁîüÊàê‰∏Ä‰∏™ TestConfiguration copyÔºå‰ª•Âèä‰∏Ä‰∏™ TestConfiguration copy-Info.plist Êñá‰ª∂Ôºö Êàë‰ª¨Â∞ÜÂÖ∂ÂêçÂ≠ó‰øÆÊîπ‰∏∫ TestConfiguration_Test ‰ª•Âèä TestConfiguration_Test-Info.plist„ÄÇÊîπ‰∫Ü plist ÁöÑÂêçÁß∞ÂêéÔºåÂØπÂ∫îÁöÑÔºåÂú® target ÁöÑ Build Setting ‰∏≠ Info.plist File ‰πüË¶ÅÊîπÊàêÂØπÂ∫îÁöÑÂêçÁß∞Ôºö Èô§Ê≠§‰πãÂ§ñÔºåÊñ∞Âª∫‰∫Ü target ÂêéÔºåËøò‰ºöËá™Âä®ÂàõÂª∫‰∏Ä‰∏™ schemeÔºåÊàë‰ª¨ÂêåÊ†∑Ë¶Å‰øÆÊîπ scheme ÁöÑÂêçÂ≠ó„ÄÇËÆ∞ÂæóË¶ÅÂãæ‰∏ä sharedÔºö ‰πãÂêéÈÖçÁΩÆÂíåËé∑ÂèñÁéØÂ¢ÉÂèòÈáèÁöÑÊñπÂºèÂíå‰πãÂâçÁöÑ Configuration ‰∏ÄÊ®°‰∏ÄÊ†∑„ÄÇ‰∏§ËÄÖÁöÑ‰∏çÂêåÂú®‰∫é Configuration ‰øÆÊîπÁöÑÊòØÂêå‰∏Ä‰∏™ Build SettingÔºõÂ§çÂà∂ TargetÔºåÂàôÁõ∏ÂΩì‰∫éÂàõÂª∫‰∫Ü‰∏Ä‰∏™ Build Setting ÁöÑÂâØÊú¨„ÄÇ Â¶ÇÊûúÁª¥Êä§‰∏ÄÂ•ó‰ª£Á†ÅÔºå‰ª•ÂêéËøô‰∫õappÂ¶ÇÊûúÈúÄÊ±ÇÊúâ‰∏çÂêåÊÄé‰πàÂäûÔºüÔºüÊØîÂ¶ÇË¶ÅËøõÂÖ•‰∏çÂêåÁïåÈù¢ÔºåË∑≥ËΩ¨‰∏çÂêåÁïåÈù¢ÔºåÈ°µÈù¢‰πüÊòæÁ§∫‰∏çÂêåÊÄé‰πàÂäûÔºüÔºüËøô‰∏™ÈóÆÈ¢òÂÖ∂ÂÆûÂæàÁÆÄÂçï„ÄÇÂú®TargetsÈáåÈù¢ÁöÑCompile SourcesÈáåÈù¢ÊòØÂèØ‰ª•ÁªôÊØè‰∏™‰∏çÂêåÁöÑTargetsÊ∑ªÂä†‰∏çÂêåÁöÑÁºñËØë‰ª£Á†ÅÁöÑ„ÄÇÂè™ÈúÄË¶ÅÂú®ÊØè‰∏™‰∏çÂêåÁöÑTargetsÈáåÈù¢Âä†ÂÖ•‰∏çÂêåÁïåÈù¢ÁöÑ‰ª£Á†ÅËøõË°åÁºñËØëÂ∞±ÂèØ‰ª•‰∫ÜÔºåÂú®Ë∑≥ËΩ¨ÁöÑÈÇ£‰∏™ÁïåÈù¢Âä†‰∏äÂÆèÔºåÊù•ÊéßÂà∂‰∏çÂêåÁöÑappË∑≥ËΩ¨Âà∞Áõ∏Â∫îÁïåÈù¢„ÄÇËøôÊ†∑Êú¨Âú∞ËøòÊòØÁª¥Êä§ÁöÑ‰∏ÄÂ•ó‰ª£Á†ÅÔºåÂè™‰∏çËøáÊØè‰∏™TargetsÁºñËØëÁöÑ‰ª£Á†ÅÂ∞±ÊòØËøôÂ•ó‰ª£Á†ÅÁöÑÂ≠êÈõÜ‰∫Ü„ÄÇËøôÊ†∑Áª¥Êä§Ëµ∑Êù•ËøòÊòØÂæàÊñπ‰æø„ÄÇ‰πüÂÆûÁé∞‰∫Ü‰∏çÂêåapp‰∏çÂêåÁïåÈù¢Ôºå‰∏çÂêåÈúÄÊ±Ç‰∫Ü„ÄÇ Â¶Ç‰ΩïÈÄâÊã©ÈÇ£‰πà‰ªÄ‰πàÊó∂ÂÄôÈÄâÊã© Configuration ‰ªÄ‰πàÊó∂ÂÄôÈÄâÊã© Target Âë¢ÔºüÂ¶ÇÊûúÂè™‰∏äÊû∂‰∏Ä‰∏™ appÔºå‰ΩÜÊòØÈúÄË¶ÅÂ§ö‰∏™ÁéØÂ¢ÉÔºåÂπ∂‰∏î‰∏çÂêåÁéØÂ¢ÉÁöÑÂäüËÉΩÂü∫Êú¨Áõ∏ÂêåÔºåÈÇ£‰πàÁî® Configuration Â∞±ÂèØ‰ª•‰∫Ü„ÄÇÂ¶ÇÊûúË¶Å‰∏äÊû∂Â§ö‰∏™Á±ª‰ººÁöÑ appÔºåÈÇ£‰πà‰∏ÄÂÆöË¶ÅÁî® targetÔºåÂõ†‰∏∫‰∏çÂêå app ÊâÄÈúÄÁöÑËØÅ‰π¶‰∏çÂêåÔºåarchiveÁöÑÊó∂ÂÄôËøò‰ºöÊúâÂêÑÁßçÈóÆÈ¢ò„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËÆæËÆ°Ê®°ÂºèÂ≠¶‰π†]]></title>
    <url>%2F2017%2F08%2F05%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[Â≠¶‰π†Êû∂ÊûÑÁöÑÊó∂ÂÄôÂ§ç‰π†‰∏Ä‰∏ãËÆæËÆ°Ê®°Âºè Èù¢ÂêëÂØπË±°ËÆæËÆ°ÂéüÂàôÂçï‰∏ÄËÅåË¥£ÂéüÂàô Âçï‰∏ÄËÅåË¥£ÂéüÂàôÔºö‰∏Ä‰∏™Á±ªÂè™Ë¥üË¥£‰∏Ä‰∏™ÂäüËÉΩÈ¢ÜÂüü‰∏≠ÁöÑÁõ∏Â∫îËÅåË¥£ÔºåÊàñËÄÖÂèØ‰ª•ÂÆö‰πâ‰∏∫ÔºöÂ∞±‰∏Ä‰∏™Á±ªËÄåË®ÄÔºåÂ∫îËØ•Âè™Êúâ‰∏Ä‰∏™ÂºïËµ∑ÂÆÉÂèòÂåñÁöÑÂéüÂõ†„ÄÇ ‰∏Ä‰∏™Á±ªÔºàÂ§ßÂà∞Ê®°ÂùóÔºåÂ∞èÂà∞ÊñπÊ≥ïÔºâÊâøÊãÖÁöÑËÅåË¥£Ë∂äÂ§öÔºåÂÆÉË¢´Â§çÁî®ÁöÑÂèØËÉΩÊÄßÂ∞±Ë∂äÂ∞èÔºåËÄå‰∏î‰∏Ä‰∏™Á±ªÊâøÊãÖÁöÑËÅåË¥£ËøáÂ§öÔºåÂ∞±Áõ∏ÂΩì‰∫éÂ∞ÜËøô‰∫õËÅåË¥£ËÄ¶ÂêàÂú®‰∏ÄËµ∑ÔºåÂΩìÂÖ∂‰∏≠‰∏Ä‰∏™ËÅåË¥£ÂèòÂåñÊó∂ÔºåÂèØËÉΩ‰ºöÂΩ±ÂìçÂÖ∂‰ªñËÅåË¥£ÁöÑËøê‰Ωú„ÄÇ Âçï‰∏ÄËÅåË¥£ÂéüÂàôÊòØÂÆûÁé∞È´òÂÜÖËÅö„ÄÅ‰ΩéËÄ¶ÂêàÁöÑÊåáÂØºÊñπÈíàÔºåÈúÄË¶ÅËÆæËÆ°‰∫∫ÂëòÂèëÁé∞Á±ªÁöÑ‰∏çÂêåËÅåË¥£Âπ∂Â∞ÜÂÖ∂ÂàÜÁ¶ª„ÄÇ ‰æãÂ≠êÊØîÂ¶Ç‰∏Ä‰∏™Á±ªÂç≥ÂàõÂª∫‰∫ÜÊï∞ÊçÆÂ∫ìËøûÊé•ÔºåÂèàÊü•ËØ¢ÂÆ¢Êà∑‰ø°ÊÅØÔºåËøòÁîüÊàêÂíåÂ±ïÁ§∫ÂõæË°®„ÄÇÂÆÉÁöÑËÅåË¥£Â∞±ÊúâÁÇπÂ§ö‰∫Ü„ÄÇ ÈáçÊûÑÂêéÂ∞ÜÂêÑ‰∏™ÂäüËÉΩÊãÜÂàÜÊàê‰∏çÂêåÁöÑÁ±ªÔºåÁÑ∂ÂêéÂä†‰ª•ÁªÑÂêàÔºö ÂÖ∂ÂÆûÂ∞±ÊòØÔºåÊää‰∏Ä‰∏™Â§ßÁöÑÂäüËÉΩÊ®°ÂùóÂàíÂàÜ‰∏∫‰∏Ä‰∏™‰∏™Â∞èÁöÑÂäüËÉΩÊ®°ÂùóÔºåÁÑ∂Âêé‰ª•ÁªÑÂêàÁöÑÊñπÂºèÂêàÂπ∂Ëøô‰∫õÂäüËÉΩ ÂºÄÈó≠ÂéüÂàôÂºÄÈó≠ÂéüÂàôÊòØÈù¢ÂêëÂØπË±°ÁöÑÂèØÂ§çÁî®ËÆæËÆ°ÁöÑÁ¨¨‰∏ÄÂùóÂü∫Áü≥ÔºåÂÆÉÊòØÊúÄÈáçË¶ÅÁöÑÈù¢ÂêëÂØπË±°ËÆæËÆ°ÂéüÂàô„ÄÇ ÂºÄÈó≠ÂéüÂàôÔºö‰∏Ä‰∏™ËΩØ‰ª∂ÂÆû‰ΩìÔºåÂ∫îÂΩìÂØπÊâ©Â±ïÂºÄÊîæÔºåÂØπ‰øÆÊîπÂÖ≥Èó≠„ÄÇÂç≥ËΩØ‰ª∂ÂÆû‰ΩìÂ∫îÂ∞ΩÈáèÂú®‰∏ç‰øÆÊîπÂéüÊúâ‰ª£Á†ÅÁöÑÊÉÖÂÜµ‰∏ãËøõË°åÊâ©Â±ï„ÄÇ ÊäΩË±°ÂåñÊòØÂºÄÈó≠ÂéüÂàôÁöÑÂÖ≥ÈîÆ„ÄÇÂèØ‰ª•‰∏∫Á≥ªÁªüÂÆö‰πâ‰∏Ä‰∏™Áõ∏ÂØπÁ®≥ÂÆöÁöÑÊäΩË±°Â±ÇÔºåËÄåÂ∞Ü‰∏çÂêåÁöÑÂÆûÁé∞Ë°å‰∏∫ÁßªËá≥ÂÖ∑‰ΩìÁöÑÂÆûÁé∞Â±Ç‰∏≠ÂÆåÊàêÊãìÂ±ï„ÄÇÂ¶ÇÊûúÈúÄË¶Å‰øÆÊîπÁ≥ªÁªüÁöÑË°å‰∏∫ÔºåÊó†È°ªÂØπÊäΩË±°Â±ÇËøõË°å‰ªª‰ΩïÊîπÂä®ÔºåÂè™ÈúÄË¶ÅÂ¢ûÂä†Êñ∞ÁöÑÂÖ∑‰ΩìÁ±ªÊù•ÂÆûÁé∞Êñ∞ÁöÑ‰∏öÂä°ÂäüËÉΩÂç≥ÂèØÔºåÂÆûÁé∞Âú®‰∏ç‰øÆÊîπÂ∑≤Êúâ‰ª£Á†ÅÁöÑÂü∫Á°Ä‰∏äÊâ©Â±ïÁ≥ªÁªüÁöÑÂäüËÉΩÔºåËææÂà∞ÂºÄÈó≠ÂéüÂàôÁöÑË¶ÅÊ±Ç„ÄÇ ‰æãÂ≠ê‰∏ãÈù¢Ëøô‰∏™‰æãÂ≠ê‰∏ªË¶ÅÊòØÈÄöËøáÈáåÊ∞è‰ª£Êç¢ÂéüÂàôÔºàÊäΩË±°Á±ªÂèØ‰ª•ËΩ¨Êç¢‰∏∫ÂÆû‰ΩìÁ±ªÔºâÂíå‰æùËµñÂÄíËΩ¨ÂéüÂàôÔºàÂç≥Áî®ÊäΩË±°Á±ªÊù•‰ª£ÊõøÂÆû‰ΩìÁ±ªÔºâÊù•ÂÆûÁé∞ÂºÄÈó≠ÂéüÂàôÁöÑ„ÄÇÂºÄÈó≠ÂéüÂàôÊòØÁõÆÁöÑÔºåÈáåÊ∞è‰ª£Êç¢Âíå‰æùËµñÂÄíËΩ¨ÊòØÊâãÊÆµ„ÄÇ ‰∏ãÈù¢Ë∞ÉÁî®‰∏§‰∏™ Chart ÁöÑÂ±ïÁ§∫ÊñπÊ≥ïÔºåÂ¶ÇÊûúÊòØÁ°¨ÁºñÁ†ÅÂ∞±‰ºöÂú® ChartDisplay ‰∏≠ÂÜôÊòéË¶ÅË∞ÉÁî®ÁöÑÁ±ªÂûãÔºåÈÄöËøá if.else Âà§Êñ≠Ôºö 123456789...... if (type.equals("pie")) &#123; PieChart chart = new PieChart(); chart.display(); &#125;else if (type.equals("bar")) &#123; BarChart chart = new BarChart(); chart.display(); &#125; ...... Áé∞Âú®ÂèØ‰ª•Â∞ÜËøô‰∏™ÊñπÊ≥ïÊäΩË±°Âá∫Êù•ÔºåÈÄöËøáË∞ÉÁî®ÊäΩË±°ÊñπÊ≥ïÊù•Ëß£ÂÜ≥Ôºö ÂÖ∂ÂÆûÂ∞±ÊòØÔºåÂ∞ÜÂ§ö‰∏™Á±ª‰∏≠Á±ª‰ººÁöÑÂäüËÉΩÊäΩÂèñÂá∫Êù•Ôºå‰Ωú‰∏∫‰∏Ä‰∏™ÊäΩË±°Á±ªÔºå‰ª•ÂêéÊâÄÊúâÊúâËøô‰∏™ÂäüËÉΩÁöÑÂ∞±ÁªßÊâøËøô‰∏™ÊäΩË±°Á±ªÔºåË¶ÅË∞ÉÁî®ÁöÑÊó∂ÂÄôÂ∞±Ë∞ÉÁî®Ëøô‰∏™ÊäΩË±°Á±ªÁöÑÊñπÊ≥ï„ÄÇ Êé•Âè£ÈöîÁ¶ªÂéüÂàô Êé•Âè£ÈöîÁ¶ªÂéüÂàôÔºö‰ΩøÁî®Â§ö‰∏™‰∏ìÈó®ÁöÑÊé•Âè£ÔºåËÄå‰∏ç‰ΩøÁî®Âçï‰∏ÄÁöÑÊÄªÊé•Âè£ÔºåÂç≥ÂÆ¢Êà∑Á´Ø‰∏çÂ∫îËØ•‰æùËµñÈÇ£‰∫õÂÆÉ‰∏çÈúÄË¶ÅÁöÑÊé•Âè£„ÄÇ ÊØè‰∏Ä‰∏™Êé•Âè£Â∫îËØ•ÊâøÊãÖ‰∏ÄÁßçÁõ∏ÂØπÁã¨Á´ãÁöÑËßíËâ≤Ôºå‰∏çÂπ≤‰∏çËØ•Âπ≤ÁöÑ‰∫ã„ÄÇÊé•Âè£ÂèØ‰ª•Êúâ‰∏§Áßç‰∏çÂêåÁöÑÂÆö‰πâÔºö ÂΩìÊää‚ÄúÊé•Âè£‚ÄùÁêÜËß£Êàê‰∏Ä‰∏™Á±ªÂûãÊâÄÊèê‰æõÁöÑÊâÄÊúâÊñπÊ≥ïÁâπÂæÅÁöÑÈõÜÂêàÁöÑÊó∂ÂÄôÔºåËøôÂ∞±ÊòØ‰∏ÄÁßçÈÄªËæë‰∏äÁöÑÊ¶ÇÂøµÔºåÊé•Âè£ÁöÑÂàíÂàÜÂ∞ÜÁõ¥Êé•Â∏¶Êù•Á±ªÂûãÁöÑÂàíÂàÜ„ÄÇÂèØ‰ª•ÊääÊé•Âè£ÁêÜËß£ÊàêËßíËâ≤Ôºå‰∏Ä‰∏™Êé•Âè£Âè™ËÉΩ‰ª£Ë°®‰∏Ä‰∏™ËßíËâ≤ÔºåÊØè‰∏™ËßíËâ≤ÈÉΩÊúâÂÆÉÁâπÂÆöÁöÑ‰∏Ä‰∏™Êé•Âè£ÔºåÊ≠§Êó∂ÔºåËøô‰∏™ÂéüÂàôÂèØ‰ª•Âè´ÂÅö‚ÄúËßíËâ≤ÈöîÁ¶ªÂéüÂàô‚Äù„ÄÇ Â¶ÇÊûúÊää‚ÄúÊé•Âè£‚ÄùÁêÜËß£ÊàêÁã≠‰πâÁöÑÁâπÂÆöËØ≠Ë®ÄÁöÑÊé•Âè£ÔºåÈÇ£‰πàISPË°®ËææÁöÑÊÑèÊÄùÊòØÊåáÊé•Âè£‰ªÖ‰ªÖÊèê‰æõÂÆ¢Êà∑Á´ØÈúÄË¶ÅÁöÑË°å‰∏∫ÔºåÂÆ¢Êà∑Á´Ø‰∏çÈúÄË¶ÅÁöÑË°å‰∏∫ÂàôÈöêËóèËµ∑Êù•ÔºåÂ∫îÂΩì‰∏∫ÂÆ¢Êà∑Á´ØÊèê‰æõÂ∞ΩÂèØËÉΩÂ∞èÁöÑÂçïÁã¨ÁöÑÊé•Âè£ÔºåËÄå‰∏çË¶ÅÊèê‰æõÂ§ßÁöÑÊÄªÊé•Âè£„ÄÇ Âú®‰ΩøÁî®Êé•Âè£ÈöîÁ¶ªÂéüÂàôÊó∂ÔºåÊàë‰ª¨ÈúÄË¶ÅÊ≥®ÊÑèÊéßÂà∂Êé•Âè£ÁöÑÁ≤íÂ∫¶ÔºåÊé•Âè£‰∏çËÉΩÂ§™Â∞èÔºåÂ¶ÇÊûúÂ§™Â∞è‰ºöÂØºËá¥Á≥ªÁªü‰∏≠Êé•Âè£Ê≥õÊª•Ôºå‰∏çÂà©‰∫éÁª¥Êä§ÔºõÊé•Âè£‰πü‰∏çËÉΩÂ§™Â§ßÔºåÂ§™Â§ßÁöÑÊé•Âè£Â∞ÜËøùËÉåÊé•Âè£ÈöîÁ¶ªÂéüÂàôÔºåÁÅµÊ¥ªÊÄßËæÉÂ∑ÆÔºå‰ΩøÁî®Ëµ∑Êù•Âæà‰∏çÊñπ‰æø„ÄÇ ÂêàÊàêÂ§çÁî®ÂéüÂàô ÂêàÊàêÂ§çÁî®ÂéüÂàôÔºöÂ∞ΩÈáè‰ΩøÁî®ÂØπË±°ÁªÑÂêàÔºåËÄå‰∏çÊòØÁªßÊâøÊù•ËææÂà∞Â§çÁî®ÁöÑÁõÆÁöÑ„ÄÇ ÈÄöËøáÁªßÊâøÊù•ËøõË°åÂ§çÁî®ÁöÑ‰∏ªË¶ÅÈóÆÈ¢òÂú®‰∫éÁªßÊâøÂ§çÁî®‰ºöÁ†¥ÂùèÁ≥ªÁªüÁöÑÂ∞ÅË£ÖÊÄßÔºåÂõ†‰∏∫ÁªßÊâø‰ºöÂ∞ÜÂü∫Á±ªÁöÑÂÆûÁé∞ÁªÜËäÇÊö¥Èú≤ÁªôÂ≠êÁ±ªÔºõ‰ªéÂü∫Á±ªÁªßÊâøËÄåÊù•ÁöÑÂÆûÁé∞ÊòØÈùôÊÄÅÁöÑÔºàÁªÑÂêàÂ∞±ÂèØ‰ª•ÈÄöËøáÊäΩË±°Á±ªÁöÑÊñπÂºèÔºåÂú®ËøêË°åÊó∂ÈöèÊó∂ÂèòÊç¢ÂÖ∑‰ΩìÁöÑÂÆû‰æãÔºâÔºå‰∏çÂèØËÉΩÂú®ËøêË°åÊó∂ÂèëÁîüÊîπÂèòÔºåÊ≤°ÊúâË∂≥Â§üÁöÑÁÅµÊ¥ªÊÄß„ÄÇ ‰æãÂ≠êÊØîÂ¶Ç‰Ω†ÊÉ≥Ëá™ÂÆö‰πâ‰∏Ä‰∏™ buttonÔºåÈÇ£‰πà‰Ω†ÂèØ‰ª•ÈÄöËøáÁªßÊâøÂÆûÁé∞ÔºåÈáçÂÜô initWithFrame: ÊñπÊ≥ï„ÄÇ‰πüÂèØ‰ª•ÈÄöËøá‰∏∫ UIButton Ê∑ªÂä†‰∏Ä‰∏™ÂàÜÁ±ª UIButton+CustomÔºåÂú®ÂÖ∂‰∏≠Ê∑ªÂä†Ëá™Â∑±ÁöÑËá™ÂÆö‰πâÊñπÊ≥ï„ÄÇÂΩìÁÑ∂ÔºåÊåâÁÖßÊú¨ÂéüÂàôÔºåÂ∞ΩÈáè‰ΩøÁî®ÁªÑÂêàÁöÑÊñπÂºè„ÄÇ ÁªÑÂêàÂ∞±ÊòØÂú®ÂéüÊù•ÁöÑÂü∫Á°Ä‰∏äÊ∑ªÂä†Êñ∞ÁöÑÊñπÊ≥ïÔºåÂèØ‰ª•Áõ¥Êé•Ê∑ªÂä†ÔºàÂ¶Ç iOS ‰∏≠ÁöÑÂàÜÁ±ªÔºâÔºå‰πüÂèØ‰ª•ÈÄöËøáÊ∑ªÂä†‰∏Ä‰∏™Â±ûÊÄßÔºåÁî±Ëøô‰∏™Â±ûÊÄßÊù•ÊâßË°åË¶ÅÂÆûÁé∞ÁöÑÊñπÊ≥ï„ÄÇ ÁªßÊâø‰∏ªË¶ÅÊòØ‰∏∫‰∫Ü‰ª£Á†ÅÂ§çÁî®ÔºåÊòØÂú®ÂéüÊù•ÊñπÊ≥ïÁöÑÂü∫Á°Ä‰∏äÊãìÂ±ïÂéüÊñπÊ≥ï„ÄÇÁªßÊâøÁöÑÁõÆÁöÑÂπ∂‰∏çÊòØ‰∏∫‰∫ÜÁªôÂ≠êÁ±ªÊèê‰æõ‰∏Ä‰∏™ÊñπÊ≥ïÊ†áÂáÜÔºåÂõ†‰∏∫ÂÆö‰πâÊñπÊ≥ïÊ†áÂáÜÊúÄÂ•ΩÁöÑÊñπÂºèÊòØÂçèËÆÆ„ÄÇÊâÄ‰ª•‰∏çË¶ÅÂçïÁ∫Ø‰∏∫‰∫ÜÊèê‰æõÂÆö‰πâÊñπÊ≥ïÊù•ÁªßÊâø„ÄÇ ‰πüÂ∞±ÊòØËØ¥ÔºåÂÅáÂ¶ÇÂü∫Á±ª‰∏≠Êúâ‰∫õÊñπÊ≥ïÊòØÁ©∫ÊñπÊ≥ïÔºåÊòØË¶ÅÂ≠êÁ±ªÂÆûÁé∞ÁöÑÔºåÈÇ£‰πàÂ∞±ÊäΩÂá∫Êù•‰Ωú‰∏∫ÂçèËÆÆ„ÄÇ‰Ω†ÂèØ‰ª•Â∞ÜËØ•ÊñπÊ≥ïÁõ¥Êé•Â£∞ÊòéÂú®Âü∫Á±ªÁöÑ interface ÈáåÔºåÁÑ∂Âêé‰∏çÂú® implementation ‰∏≠ÂÆûÁé∞Ëøô‰∏™ÊñπÊ≥ïÔºåÊàñËÄÖÁõ¥Êé•Âú®Ëøô‰∏™ÂÆûÁé∞ÊñπÊ≥ï‰∏≠ÊäõÂá∫ÂºÇÂ∏∏(‰∏§ËÄÖÊòØÁ≠âÊïàÁöÑÔºåÊâßË°åÂà∞ÁöÑÊó∂ÂÄôÂ¶ÇÊûúÂ≠êÁ±ªÊ≤°ÊúâÈáçÂÜôËØ•ÊñπÊ≥ïÈÉΩ‰ºöÂºÇÂ∏∏)ÔºåËøôÊ†∑ÊâÄÊúâÂ≠êÁ±ªÈÉΩÂèØ‰ª•Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ï‰∫Ü„ÄÇÁÑ∂ÂêéËÆ©Â≠êÁ±ªÂÆûÁé∞‰∏Ä‰∏™Â∞ÜËØ•ÊñπÊ≥ïÂ£∞Êòé‰∏∫ required ÁöÑÂçèËÆÆ„ÄÇ‰∏∫‰ªÄ‰πàË¶ÅÂÜçÂºÑ‰∏Ä‰∏™ required ÁöÑÂçèËÆÆÂë¢ÔºüÂõ†‰∏∫ËøôÊ†∑ËÉΩÊèêÈÜíÂºÄÂèëËÄÖËøô‰∏ÄÁ±ªÂûãÁöÑÂ≠êÁ±ªÂøÖÈ°ªË¶ÅÂÆûÁé∞ËØ•ÊñπÊ≥ïÔºåÊúâÂä©‰∫é‰ª£Á†ÅËßÑËåÉ„ÄÇ ‰ΩïÊó∂Áî®ÁªßÊâø‰ΩïÊó∂Áî®ÁªÑÂêàÊ≤°ÊúâÁªùÂØπÁöÑÂÆö‰πâ„ÄÇÂè™Ë¶ÅËÆ∞‰Ωè‰∏çË¶ÅÊª•Áî®ÁªßÊâø„ÄÇÊÉ≥Ë¶ÅÁî®ÁªßÊâøÁöÑÊó∂ÂÄôÂÖàÈóÆËá™Â∑±ÔºåËÉΩ‰∏çËÉΩÁî®ÁªÑÂêàÔºü ÂàÜÁ±ªÂíå AOP ÈÉΩÊòØÁªÑÂêàÁöÑÂÆûÁé∞ÊÄùË∑Ø„ÄÇ‰∏çËøá‰ΩøÁî® AOP Êó∂Ë¶ÅÊ≥®ÊÑèÂ¶ÇÊûúÊüê‰∫õÂ≠êÁ±ª‰∏çÊé•Âèó AOP ÈúÄË¶ÅÂ¶Ç‰ΩïÁâπÊÆäÂåñÂ§ÑÁêÜÔºàÊØîÂ¶Ç‰Ω†ÂØπ UIViewController ÁöÑ viewDidLoad ÊñπÊ≥ïÂÅö AOPÔºå‰ΩÜÊòØ‰∏Ä‰∫õÁ≥ªÁªüÁöÑ UIViewController Â∞±‰∏çÈÄÇÁî®‰Ω†ÁöÑ AOP ÊñπÊ≥ïÔºåÈÇ£‰πà‰Ω†Ë¶ÅÂ¶Ç‰ΩïÊääÁ≥ªÁªüÁöÑ UIViewController Ê¥æÁîüÁöÑÂ≠êÁ±ªÊéíÈô§ÔºüÔºâ„ÄÇËøô‰∏™Êó∂ÂÄô‰Ω†Â∞±Ë¶ÅËØÑ‰º∞‰ΩøÁî® AOP ÁöÑÁªÑÂêàÂíå‰ΩøÁî®ÁªßÊâøÂú®‰ª£Á†ÅÂÆûÁé∞‰∏äÁöÑÈöæÊòìÁ®ãÂ∫¶‰∫Ü Ëø™Á±≥ÁâπÊ≥ïÂàô Ëø™Á±≥ÁâπÊ≥ïÂàôÔºö‰∏Ä‰∏™ËΩØ‰ª∂ÂÆû‰ΩìÂ∫îÂΩìÂ∞ΩÂèØËÉΩÂ∞ëÂú∞‰∏éÂÖ∂‰ªñÂÆû‰ΩìÂèëÁîüÁõ∏‰∫í‰ΩúÁî®„ÄÇ Â∫îËØ•Â∞ΩÈáèÂáèÂ∞ëÂØπË±°‰πãÈó¥ÁöÑ‰∫§‰∫íÔºåÂ¶ÇÊûú‰∏§‰∏™ÂØπË±°‰πãÈó¥‰∏çÂøÖÂΩºÊ≠§Áõ¥Êé•ÈÄö‰ø°ÔºåÈÇ£‰πàËøô‰∏§‰∏™ÂØπË±°Â∞±‰∏çÂ∫îÂΩìÂèëÁîü‰ªª‰ΩïÁõ¥Êé•ÁöÑÁõ∏‰∫í‰ΩúÁî®ÔºåÂ¶ÇÊûúÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∏™ÂØπË±°ÈúÄË¶ÅË∞ÉÁî®Âè¶‰∏Ä‰∏™ÂØπË±°ÁöÑÊüê‰∏Ä‰∏™ÊñπÊ≥ïÁöÑËØùÔºåÂèØ‰ª•ÈÄöËøáÁ¨¨‰∏âËÄÖËΩ¨ÂèëËøô‰∏™Ë∞ÉÁî®„ÄÇÁÆÄË®Ä‰πãÔºåÂ∞±ÊòØÈÄöËøáÂºïÂÖ•‰∏Ä‰∏™ÂêàÁêÜÁöÑÁ¨¨‰∏âËÄÖÊù•Èôç‰ΩéÁé∞ÊúâÂØπË±°‰πãÈó¥ÁöÑËÄ¶ÂêàÂ∫¶„ÄÇ ‰æãÂ≠ê‰∏ãÈù¢ÁÇπÂáª button ÂêéÔºå‰ºöË∞ÉÁî®ÂêÑÁßçÊéß‰ª∂‰∫ßÁîüÂèòÂåñÔºåËøôÊ†∑ button Â∞±Ë¶ÅÂíåÂêÑÁßçÁ©∫Èó¥ËÄ¶Âêà„ÄÇ ÂèØ‰ª•ÈÄöËøáÂä†ÂÖ•‰∏≠Èó¥‰ª∂ÔºåËß£ËÄ¶ button ÂíåÂÖ∂‰ªñÊéß‰ª∂Ôºö ÂÖ∂ÂÆûÂ∞±ÊòØÔºåÈÄöËøá‰∏≠Èó¥Â±ÇÔºåÂáèÂ∞ëÁ±ª‰∏éÁ±ªÁöÑËÄ¶Âêà ÂéüÂàôÊÄªÁªìËÆæËÆ°ÂéüÂàôÊÄªÁªìËµ∑Êù•‰∏§ÁÇπÔºö‚ÄùÂ∞ë‚ÄùÔºå‚ÄùËß£ËÄ¶‚ÄùÔºö Â∞ë ÂÜÖÈÉ®ÂäüËÉΩÂ∞ë =&gt; Âçï‰∏ÄËÅåË¥£ Â§ñÈÉ®Êö¥Èú≤Â∞ë =&gt; Êé•Âè£ÈöîÁ¶ª Áõ∏‰∫íÂÖ≥Á≥ªÂ∞ë =&gt; Ëø™Á±≥Áâπ Ëß£ËÄ¶ Á±ª‰∏éÂÜÖÈÉ®Â±ûÊÄßËß£ËÄ¶ =&gt; ÂºÄÈó≠ Á±ª‰∏éÊãìÂ±ïÊñπÊ≥ïËß£ËÄ¶ =&gt; ÁªÑÂêàÂ§çÁî® Á±ª‰∏éÁ±ªËß£ËÄ¶ =&gt; Ëø™Á±≥Áâπ ËÆæËÆ°Ê®°ÂºèÁöÑÊÑè‰πâ‰∏Ä‰∏™ÊñπÊ≥ïË¢´Â§ö‰∏™Á±ªË∞ÉÁî®Ôºå‰∏ÄËà¨ÁöÑÂÅöÊ≥ïÊòØÂ∞ÜËøô‰∏™ÊñπÊ≥ïÊäΩÂá∫Êù•‰Ωú‰∏∫‰∏Ä‰∏™ÊñπÊ≥ïÁ±ª‰æõÂÖ∂‰ªñÁ±ªË∞ÉÁî®ÔºåËøôÁßçÂÅöÊ≥ïÊ≤°Êúâ‰ΩøÁî®ËÆæËÆ°Ê®°ÂºèÔºåÊòØ‰∏ÄÁßçÂêàÊàêÂ§çÁî®Ôºõ‰∏Ä‰∏™Á±ªË¶ÅÊ†πÊçÆ‰∏çÂêåÊÉÖÂÜµË∞ÉÁî®‰∏çÂêåÊñπÊ≥ïÊàñËÄÖÊãìÂ±ïÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄâÊã©Â∞ÜÊñπÊ≥ïÊäΩÂá∫‰∏∫Á±ªÔºåÁõ¥Êé•Ë∞ÉÁî®ÊñπÊ≥ïÂü∫Á±ªÊèê‰æõÁöÑÊñπÊ≥ïÔºåÂàáÊç¢ÊñπÊ≥ïÁ±ªÁöÑÂÆû‰æãÊù•ÂàáÊç¢ÊñπÊ≥ïÔºå‰πüÂèØ‰ª•ÈÄâÊã©ÈÄöËøá‰∏Ä‰∏™‰∏≠Èó¥Á±ªÁöÑÂü∫Á±ªË∞ÉÁî®ÊñπÊ≥ïÁ±ªÁöÑÊñπÊ≥ïÔºåÈÄöËøáÂàáÊç¢‰∏≠Èó¥Á±ªÁöÑÂÆû‰æãÊù•ÂàáÊç¢ÊñπÊ≥ï„ÄÇËøôÂ∞±ÊòØ‰∏ÄÁßçËÆæËÆ°Ê®°ÂºèÁöÑÈÄâÊã©„ÄÇ ËÆæËÆ°Ê®°Âºè‰ΩúÁî®Âú®‰∫éËß£ËÄ¶„ÄÇ‰ΩÜÊòØ‰Ω†ÂèØËÉΩ‰ºöÈóÆÔºåÊàë‰ª¨ËôΩÁÑ∂ÊòØË¶Å‰πàË∞ÉÁî®ÊñπÊ≥ïÂü∫Á±ªÁöÑÊñπÊ≥ïÔºåË¶Å‰πàÊòØË∞ÉÁî®‰∏≠Èó¥Á±ªÂü∫Á±ªÁöÑÊñπÊ≥ïÔºå‰ΩÜÊòØÊúÄÂêéËøòÊòØË¶ÅÂÆû‰æãÂåñÁ©∂Á´üÊòØÂì™‰∏™ÊñπÊ≥ïÁ±ªÂíåÂì™‰∏™‰∏≠Èó¥Á±ªÔºåÈöæÈÅì‰∏çËøòÊòØË¶ÅËÄ¶ÂêàÂÖ∑‰ΩìÁöÑÊñπÊ≥ïÁ±ªÊàñËÄÖ‰∏≠Èó¥Á±ªÂêóÔºüÊòØÁöÑÔºåÊúâ‰∫õÊÉÖÂÜµ‰∏ãÊòØÔºå‰ΩÜÊòØÊúâ‰∫õÊó∂ÂÄôÊàë‰ª¨ËøòÂèØ‰ª•Â∞ÜÊñπÊ≥ïÁ±ªÊàñËÄÖ‰∏≠Èó¥Á±ªÁöÑÂÆû‰æã‰º†ÁªôË∞ÉÁî®ËÄÖÔºåÊàñËÄÖ‰ΩøÁî®ÊîæÂ∞ÑÁöÑÊñπÂºèÂä®ÊÄÅÂàõÂª∫Ë∞ÉÁî®ËÄÖÔºåËøô‰∏§ÁßçÊÉÖÂÜµ‰∏ãÔºåË∞ÉÁî®ËÄÖÂ∞±‰∏çÈúÄË¶ÅÂºïÂÖ•ÂÖ∑‰ΩìÁöÑÁ±ª‰∫Ü„ÄÇËøôÊ†∑Â∞±ÂÆûÁé∞‰∫ÜËß£ËÄ¶„ÄÇ ÊâÄ‰ª•ÔºåÂΩì‰Ω†ÂèëÁé∞‰Ω†ÁöÑÊüê‰∏™Á±ªÈúÄË¶ÅË∞ÉÁî®‰∏çÂêåÊñπÊ≥ïÊàñËÄÖÊãìÂ±ïÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÂ∞±ÂèØ‰ª•ËÄÉËôë‰ΩøÁî®ËÆæËÆ°Ê®°Âºè‰∫Ü ÂÖ≠ÁßçÂàõÂª∫ÂûãÊ®°ÂºèÂàõÂª∫ÂûãÊ®°Âºè‰∏ªË¶ÅÁî®‰∫éÊèèËø∞Â¶Ç‰ΩïÂàõÂª∫ÂØπË±° ‰∏∫‰ªÄ‰πàË¶ÅÁî®Â∑•ÂéÇÔºüËøô‰∏ÄËäÇ‰∏çÊòØ‰∏Ä‰∏™ËÆæËÆ°Ê®°ÂºèÔºå‰ΩÜÊòØÊúâÂøÖË¶ÅÊé¢ËÆ®‰∏Ä‰∏ãÔºå‰∏∫‰ªÄ‰πàË¶Å‰ΩøÁî®Â∑•ÂéÇÔºüÂ∑•ÂéÇÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂ∞ÜÂØπË±°ÁöÑÂàõÂª∫Âíå‰ΩøÁî®ÂàÜÁ¶ª„ÄÇÈÇ£‰πàËøôÊ†∑Êúâ‰ªÄ‰πàÂ•ΩÂ§ÑÔºü ÂØπ‰∫éÂàõÂª∫Á±ª‰∏é‰∫ßÂìÅÁ±ª‰πãÈó¥Êù•ËØ¥ÔºöÂ∑•ÂéÇÁ±ªÁöÑÂºïÂÖ•Â∞ÜÂáèÂ∞ëËÄ¶ÂêàÔºåÈôç‰ΩéÂõ†‰∏∫‰∫ßÂìÅÁ±ªÊîπÂèòÊâÄÈÄ†ÊàêÁöÑÁª¥Êä§Â∑•‰ΩúÈáè„ÄÇÂ¶ÇÊûú‰∫ßÂìÅÁ±ªÈúÄË¶ÅÊ∑ªÂä†ÊàñËÄÖÁßªÈô§ÁöÑÂ≠êÂ±ûÊÄßÔºåÊàñËÄÖË¶Å‰øÆÊîπ‰∫ßÂìÅÁ±ªÁöÑÊé•Âè£ÔºåÂ¶ÇÊûúÂíå‰∏öÂä°Êï∞ÊçÆÊï∞ÊçÆÊó†ÂÖ≥ÔºåÈÇ£‰πàÂè™Ë¶Å‰øÆÊîπÂ∑•ÂéÇÁ±ªÁöÑ‰ª£Á†ÅÂ∞±Ë°å‰∫ÜÔºå‰∏çÈúÄË¶ÅÊîπÂä®ÂàõÂª∫Á±ª‰∏≠ÁöÑ‰ª£Á†Å„ÄÇ ÂØπ‰∫éÂàõÂª∫Á±ªÊù•ËØ¥ÔºöÈò≤Ê≠¢Áî®Êù•ÂÆû‰æãÂåñ‰∏Ä‰∏™Á±ªÁöÑÊï∞ÊçÆÂíå‰ª£Á†ÅÂú®Â§ö‰∏™Á±ª‰∏≠Âà∞Â§ÑÈÉΩÊòØ„ÄÇ‰∫ßÂìÅÁ±ªÁöÑÊüê‰∫õÂèÇÊï∞ÂèØËÉΩ‰∏çËÉΩÁõ¥Êé•‰ΩøÁî®ÔºåËÄåÈúÄË¶ÅËΩ¨Âåñ(ÊØîÂ¶ÇÊó•ÊúüÂ≠óÁ¨¶‰∏≤ÁöÑËΩ¨Âåñ)ÔºåÂÜçÊØîÂ¶Ç‰∫ßÂìÅÁ±ªÁöÑÊûÑÂª∫ÁöÑÂèÇÊï∞ÂèØËÉΩÈúÄË¶Å‰ªéÊñá‰ª∂ËØªÂèñ„ÄÇËøô‰∫õÂÜôÂú®ÂàõÂª∫Á±ª‰∏≠Â∞±‰ºöËÆ©ÂàùÂßãÂåñÁöÑ‰ª£Á†ÅÂà∞Â§ÑÈÉΩÊòØ„ÄÇ ÂØπ‰∫é‰∫ßÂìÅÁ±ªÊù•ËØ¥ÔºöÈò≤Ê≠¢‰∫ßÂìÅÁ±ªËÅåË¥£ËøáÈáçÔºåËÄ¶ÂêàÂÖ∂‰ªñÁ±ª„ÄÇÂØπ‰∫é2ÔºåËé∑Âèñ‰Ω†ËÆ§‰∏∫ÂèØ‰ª•Â∞ÜÂèÇÊï∞ÁöÑËΩ¨ÂåñÊîæÂú®‰∫ßÂìÅÁöÑÂàùÂßãÂåñÊñπÊ≥ï‰∏≠Ôºå‰ΩÜÊòØËøôÊ†∑ÂÆπÊòì‰∫ßÁîüËÄ¶ÂêàÔºå‰∏ç‰æøÁßªÊ§ç„ÄÇÊØîÂ¶ÇÊàë(‰∫ßÂìÅÁ±ª)Êú¨Êù•Â∞±Âè™Ë¶Å‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ôºå‰Ω†ÈùûÂæóËÆ©Êàë‰ªéÊüê‰∏™Ë∑ØÂæÑËØªÊñá‰ª∂ÔºõÊú¨Êù•ÊàëÂè™Ë¶Å‰∏Ä‰∏™ UIViewÔºå‰Ω†ÈùûÂæóËÆ©ÊàëËá™Â∑±ÂºïÂÖ•Âπ∂ÂàõÂª∫‰∏Ä‰∏™ CustomView ÁöÑÂÆû‰æã„ÄÇ ÂΩíÊ†πÂà∞Â∫ïÔºåÂ∑•ÂéÇËøòÊòØÂú®‰∏§‰∏™Á±ª‰πãÈó¥Ëµ∑Âà∞‰∏Ä‰∏™‰∏≠Èó¥‰∫∫ÁöÑ‰ΩúÁî®ÔºåÂè™‰∏çËøáÂÆÉÊòØ‰∏ìÈó®Áî®Êù•ÂàõÂª∫ÂÆû‰æãÁöÑ„ÄÇÊâÄÊúâÁöÑ‰∏≠Èó¥‰∫∫ÈÉΩÂèØ‰ª•ÂàÜ‰∏∫‰∏âÈÉ®ÂàÜÊù•ÂàÜÊûêÔºöË∞ÉÁî®ËÄÖÔºåË¢´Ë∞ÉÁî®ËÄÖÔºå‰∏§ËÄÖ‰πãÈó¥„ÄÇ Â∑•ÂéÇÊ®°ÂºèÈÄÇÁî®‰∫éÂàõÂª∫‰∫ßÂìÅÁ±ªÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÂÅöÂæàÂ§öÂàùÂßãÂåñÊìç‰Ωú„ÄÇ iOS ‰∏≠ÁöÑÁ±ªÁ∞áÂ∞±ÊòØÂ∑•ÂéÇÊ®°ÂºèÁöÑ‰ΩìÁé∞„ÄÇÊØîÂ¶Ç NSString NSNumber NSArray ÁöÑÂàõÂª∫ÈÉΩÈöêËóè‰∫ÜÂÖ∂ÂÆûÈôÖÁöÑÂ≠êÁ±ª‰ø°ÊÅØ„ÄÇ ÁÆÄÂçïÂ∑•ÂéÇÊ®°ÂºèÈöæÂ∫¶Ôºö2 È¢ëÁéáÔºö3 ÁÆÄÂçïÂ∑•ÂéÇÊ®°ÂºèÔºöÂÆö‰πâ‰∏Ä‰∏™Â∑•ÂéÇÁ±ªÔºåÂÆÉÂèØ‰ª•Ê†πÊçÆÂèÇÊï∞ÁöÑ‰∏çÂêåËøîÂõû‰∏çÂêåÁ±ªÁöÑÂÆû‰æãÔºåË¢´ÂàõÂª∫ÁöÑÂÆû‰æãÈÄöÂ∏∏ÈÉΩÂÖ∑ÊúâÂÖ±ÂêåÁöÑÁà∂Á±ª„ÄÇ Â¶ÇÊûúÊàë‰ª¨Ë¶ÅÊ†πÊçÆÂèÇÊï∞ type ÁöÑ‰∏çÂêåÔºåÂàõÂª∫‰∏çÂêåÁ±ªÂûãÁöÑ‰∫ßÂìÅÁ±ªÔºåÈÇ£‰πàÊàë‰ª¨Â∞±Ë¶ÅÂú®Ë∞ÉÁî®ËÄÖÁ±ª‰∏≠Ê∑ªÂä†ÂæàÂ§öÁöÑ if‚Ä¶else‚Ä¶ Âà§Êñ≠„ÄÇÂ¶ÇÊûúÂÖ∂‰ªñË∞ÉÁî®ËÄÖ‰πüË¶ÅÂàõÂª∫ËøôÁßç‰∫ßÂìÅÁ±ªÔºå‰πü‰ºöÊ∑ªÂä†ÂæàÂ§ö if‚Ä¶else‚Ä¶ÔºåÈÇ£‰πàÂ∞±‰∏çÂ¶ÇÁõ¥Êé•Â∞ÜËøô‰∫õÂà§Êñ≠ÊèêÂèñÂá∫Êù•Ôºå‰Ωú‰∏∫‰∏Ä‰∏™ÁÆÄÂçïÂ∑•ÂéÇÁ±ª„ÄÇ ËøôÈáåÊòØÂõ†‰∏∫ÊúâÂæàÂ§ö‰∫ßÂìÅÁ±ªÊâçÂàõÂª∫‰ΩøÁî®ÁöÑÁÆÄÂçïÂ∑•ÂéÇÊ®°ÂºèÔºåÂ§çÁî® if‚Ä¶else‚Ä¶„ÄÇÂ¶ÇÊûúÂè™Êúâ‰∏Ä‰∏™‰∫ßÂìÅÁ±ªÂë¢ÔºüÂ¶ÇÊûúÂè™ÊòØÂçïÁ∫ØÁöÑÂàõÂª∫ÔºåÁ°ÆÂÆûÊ≤°‰ªÄ‰πà‰ª£Á†ÅÂèØ‰ª•Â§çÁî®ÁöÑÔºåÁõ¥Êé•ÂàõÂª∫Â∞±Ë°å‰∫Ü„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÂØπ‰∫ßÂìÅÁ±ªÊúâ‰∏Ä‰∫õËÆæÁΩÆÔºåËøôÊòØÂÖ±ÊÄßÁöÑÔºåÂèØ‰ª•Â§çÁî®ÔºåÊâÄ‰ª•ËøòÊòØÂèØ‰ª•ÂàõÂª∫Â∑•ÂéÇÔºå‰πüÂ∞±ÊòØ‰∏ãÈù¢Ë¶ÅËØ¥ÁöÑÂ∑•Á®ãÊñπÊ≥ïÊ®°Âºè„ÄÇ ‰æãÂ≠ê‰∏ãÈù¢Â∑•ÂéÇ ChartFactory ÈÄöËøá getChart: ÊñπÊ≥ïÂàõÂª∫‰∏çÂêåÁöÑ Chart ÂØπË±°„ÄÇÂÖ∂ÂÜÖÈÉ®ÊòØÈÄöËøá if‚Ä¶else ÂÆûÁé∞ÁöÑ„ÄÇHistogramChartÔºåLineChartÔºåPieChart ÂàÜÂà´ÂÆûÁé∞‰∫ÜÊé•Âè£ Chart ÁöÑ display() ÊñπÊ≥ïÔºö ËøôÈáåÁî±‰∫éÊâÄÊúâ Chart ÈÉΩË¶ÅÂÆûÁé∞‰∏Ä‰∏™ display ÊñπÊ≥ï‰æõË∞ÉÁî®ËÄÖÂàõÂª∫Â•ΩÂØπË±°ÂêéË∞ÉÁî®ÔºåÊâÄ‰ª•Ë¶ÅËÆæÁΩÆ‰∏Ä‰∏™Êé•Âè£Á±ªÂûã„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÔºåÂú®ÊäΩË±°Á±ª‰∏≠Êèê‰æõ‰∏Ä‰∏™ÈùôÊÄÅÊñπÊ≥ïÔºåÈÄöËøáËæìÂÖ•ÂèÇÊï∞ÁöÑ‰∏çÂêåÔºåÂàõÂª∫‰∏çÂêåÁöÑÂÖ∑‰ΩìÂ≠êÁ±ªÂÆû‰æã„ÄÇ Â∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÈöæÂ∫¶Ôºö2 È¢ëÁéáÔºö5 Â∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÔºöÂÆö‰πâ‰∏Ä‰∏™ÊäΩË±°Â∑•ÂéÇÁ±ªÔºåËÆ©ÂÖ∂Â≠êÁ±ªÂÜ≥ÂÆöÂ∞ÜÂì™‰∏Ä‰∏™‰∫ßÂìÅÁ±ªÂÆû‰æãÂåñ„ÄÇÂ∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèËÆ©‰∏Ä‰∏™‰∫ßÂìÅÁ±ªÁöÑÂÆû‰æãÂåñÂª∂ËøüÂà∞ÂÖ∂Â∑•ÂéÇÂ≠êÁ±ª‰∏≠„ÄÇ ‰ΩøÁî®ÁÆÄÂçïÂ∑•ÂéÇÈù¢‰∏¥ÁöÑÈóÆÈ¢òÊòØÊâÄÊúâÁöÑÂàùÂßãÂåñÊñπÊ≥ïÈÉΩÂú®‰∏Ä‰∏™Â∑•ÂéÇÁ±ª‰∏≠ÔºåÈÄöËøá if‚Ä¶else‚Ä¶Âà§Êñ≠ÔºåËøôÊ†∑ËÅåË¥£ËøáÈáçÔºåÂπ∂‰∏î‰∏çÊòìÊãìÂ±ï„ÄÇÊâÄ‰ª•‰ΩøÁî®Â∑•ÂéÇÊñπÊ≥ïÊ®°Âºè„ÄÇ Â∑•ÂéÇÊ®°Âºè‰∏≠‰∏çÂÜçÊèê‰æõ‰∏Ä‰∏™Áªü‰∏ÄÁöÑÂ∑•ÂéÇÁ±ªÊù•ÂàõÂª∫ÊâÄÊúâÁöÑ‰∫ßÂìÅÂØπË±°ÔºåËÄåÊòØÈíàÂØπ‰∏çÂêåÁöÑ‰∫ßÂìÅÊèê‰æõ‰∏çÂêåÁöÑÂ∑•ÂéÇÔºåÁ≥ªÁªüÊèê‰æõ‰∏Ä‰∏™‰∏é‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑÂØπÂ∫îÁöÑÂ∑•ÂéÇÁ≠âÁ∫ßÁªìÊûÑ„ÄÇÂ∑•ÂéÇÊñπÊ≥ïÈÄöËøáÂèçÂ∞ÑÁöÑÊñπÂºèÔºåÂä®ÊÄÅÁöÑÂàõÂª∫ÂÖ∑‰ΩìÂ∑•ÂéÇÂÆû‰æãÔºå‰ª£ÊõøÁÆÄÂçïÂ∑•ÂéÇ‰∏≠ÁöÑ if‚Ä¶elseÔºåÊª°Ë∂≥‰∫ÜÂºÄÈó≠ÂéüÂàô„ÄÇÂ¶ÇÊûú‰∏çÈÄÇÁî®ÂèçÂ∞ÑÁöÑÊñπÂºèÔºåÈÇ£‰πàÂ∞±ÂæóÂÖàÂàõÂª∫Â∑•ÂéÇÂÆû‰æãÔºåÁÑ∂ÂêéÂú®Ë∞ÉÁî®Â∑•ÂéÇÂàõÂª∫‰∫ßÂìÅÁöÑÊñπÊ≥ï‰∫Ü„ÄÇ ÈÇ£‰∏∫‰ªÄ‰πà‰∏çÁõ¥Êé•Âú®ÁÆÄÂçïÂ∑•ÂéÇÈáå‰ΩøÁî®ÂèçÂ∞ÑÂä®ÊÄÅÂú∞ÂàõÂª∫ÂÖ∑‰Ωì‰∫ßÂìÅÂÆû‰æãÂë¢ÔºüÂèçÂ∞ÑÁîüÊàêÂØπË±°Âè™ËÉΩÈÄÇÁî®‰∏Ä‰∫õÊúÄÁÆÄÂçïÁöÑÊÉÖÂÜµÔºåÂ¶ÇÊûúÂØπË±°ÁöÑÂàõÂª∫ËøáÁ®ãÊØîËæÉÂ§çÊùÇÔºå‰æãÂ¶ÇË¶ÅË∞ÉÁî®ÊúâÂèÇÊûÑÈÄ†ÂáΩÊï∞„ÄÅÂàõÂª∫‰πãÂâçË¶ÅÈÖçÁΩÆ‰∏Ä‰∫õ‰∏çÂêåÁöÑÁéØÂ¢ÉÁ≠âÁ≠âÔºåÈúÄË¶ÅÂ∞ÜËøô‰∫õ‰ª£Á†ÅÂ∞ÅË£ÖÂà∞Â∑•ÂéÇ‰∏≠„ÄÇ ‰æãÂ≠êÊèê‰æõ‰∫ÜÊé•Âè£ LoggerFactory ÂíåÊé•Âè£ Logger„ÄÇFileLoggerFactory Âíå DatabaseLoggerFactory ÂÆûÁé∞‰∫ÜÊé•Âè£ LoggerFactory ÁöÑ createLogger() ÊñπÊ≥ïÔºõFileLogger Âíå DatabaseLogger ÂÆûÁé∞‰∫ÜÊé•Âè£ Logger ÁöÑ writeLog() ÊñπÊ≥ï„ÄÇÂú®ÂÆûÁé∞ÁöÑÊó∂ÂÄôÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑÔºåÂä®ÊÄÅÂú∞ÂàõÂª∫ÂÖ∑‰ΩìÂ∑•ÂéÇÁ±ª FileLoggerFactory Âíå DatabaseLoggerFactory„ÄÇÁÑ∂ÂêéË∞ÉÁî®ÂêÑËá™ÂÆûÁé∞ÁöÑÊé•Âè£ÊñπÊ≥ï createLogger: ÂàõÂª∫ÂÖ∑‰ΩìÁöÑ‰∫ßÂìÅÁ±ª iOS ‰∏≠ [NSNumber numberWithInt:1] ËøôÁßçÈùû alloc ÂàõÂª∫ÁöÑÂ∞±ÊòØÂ∑•ÂéÇÊñπÊ≥ïÔºåÊàñÂàôÂáÜÁ°ÆÁöÑËØ¥ËøôÁßç‰∏çÈÄöËøá Factory Á±ªÁöÑÂ∑•ÂéÇÂè´ÂÅöÁ±ªÂ∑•ÂéÇÊñπÊ≥ï„ÄÇÂ∑•ÂéÇÊñπÊ≥ïÁõ¥Êé•Â∞ÜÈúÄË¶ÅÁöÑÂèòÈáè‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•„ÄÇÂ∑•ÂéÇÊñπÊ≥ïÁöÑÂêçÁß∞‰∏çË¶ÅÁî®ÂõæÁ§∫ÁöÑ createXXXÔºåÂ∫îËØ•Á±ª‰ºº‰∫é NSNumber ËøôÁßç OC ÁâπËâ≤ÁöÑÊñπÊ≥ïÂëΩÂêçÊñπÂºè„ÄÇ Áî±‰∫éË¶ÅËß£ËÄ¶ÔºåÊâÄ‰ª•Â∞Ü LoggerFactory Âíå Logger ÈÉΩËÆæÁΩÆ‰∏∫Êé•Âè£Á±ªÂûãÔºåÁÑ∂ÂêéÂ≠êÁ±ªÂàÜÂà´ÂÆûÁé∞‰ªñ‰ª¨ÁöÑÊñπÊ≥ï„ÄÇ ÂëΩÂêçÊúÄÂ•Ω‰ª• XxxFactory Âíå createXxxWithXxx: ÂëΩÂêç„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÔºå‰∏∫ÊØè‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑ‰∫ßÂìÅÁ±ªÈÉΩÂàõÂª∫‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÂ∑•ÂéÇÁ±ªÔºåÊù•ÂåÖË£π‰∏Ä‰∫õÂ§çÊùÇÁöÑÂàõÂª∫ËøáÁ®ã„ÄÇÊäΩË±°Á±ªÈÄöËøáÂèçÂ∞ÑÊñπÂºèÂàõÂª∫ÂÖ∑‰ΩìÁöÑÂ∑•ÂéÇÔºåÂÜçÁî±Â∑•ÂéÇÂÆû‰æãÂàõÂª∫‰∫ßÂìÅÂÆû‰æã„ÄÇ ÊäΩË±°Â∑•ÂéÇÊ®°ÂºèÈöæÂ∫¶Ôºö4 È¢ëÁéáÔºö5 ÊäΩË±°Â∑•ÂéÇÊ®°ÂºèÔºöÊèê‰æõ‰∏Ä‰∏™ÂàõÂª∫‰∏ÄÁ≥ªÂàóÁõ∏ÂÖ≥ÊàñÁõ∏‰∫í‰æùËµñÂØπË±°ÁöÑÊé•Âè£ÔºåËÄåÊó†È°ªÊåáÂÆöÂÆÉ‰ª¨ÂÖ∑‰ΩìÁöÑÁ±ª„ÄÇ ÂÖàË¶Å‰∫ÜËß£‰∏§‰∏™Ê¶ÇÂøµÔºö ‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑÔºö‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑÂç≥‰∫ßÂìÅÁöÑÁªßÊâøÁªìÊûÑÔºåÂ¶Ç‰∏Ä‰∏™ÊäΩË±°Á±ªÊòØÁîµËßÜÊú∫ÔºåÂÖ∂Â≠êÁ±ªÊúâÊµ∑Â∞îÁîµËßÜÊú∫„ÄÅÊµ∑‰ø°ÁîµËßÜÊú∫„ÄÅTCLÁîµËßÜÊú∫ÔºåÂàôÊäΩË±°ÁîµËßÜÊú∫‰∏éÂÖ∑‰ΩìÂìÅÁâåÁöÑÁîµËßÜÊú∫‰πãÈó¥ÊûÑÊàê‰∫Ü‰∏Ä‰∏™‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑÔºåÊäΩË±°ÁîµËßÜÊú∫ÊòØÁà∂Á±ªÔºåËÄåÂÖ∑‰ΩìÂìÅÁâåÁöÑÁîµËßÜÊú∫ÊòØÂÖ∂Â≠êÁ±ª„ÄÇ ‰∫ßÂìÅÊóèÔºöÂú®ÊäΩË±°Â∑•ÂéÇÊ®°Âºè‰∏≠Ôºå‰∫ßÂìÅÊóèÊòØÊåáÁî±Âêå‰∏Ä‰∏™Â∑•ÂéÇÁîü‰∫ßÁöÑÔºå‰Ωç‰∫é‰∏çÂêå‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑ‰∏≠ÁöÑ‰∏ÄÁªÑ‰∫ßÂìÅÔºåÂ¶ÇÊµ∑Â∞îÁîµÂô®Â∑•ÂéÇÁîü‰∫ßÁöÑÊµ∑Â∞îÁîµËßÜÊú∫„ÄÅÊµ∑Â∞îÁîµÂÜ∞ÁÆ±ÔºåÊµ∑Â∞îÁîµËßÜÊú∫‰Ωç‰∫éÁîµËßÜÊú∫‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑ‰∏≠ÔºåÊµ∑Â∞îÁîµÂÜ∞ÁÆ±‰Ωç‰∫éÁîµÂÜ∞ÁÆ±‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑ‰∏≠ÔºåÊµ∑Â∞îÁîµËßÜÊú∫„ÄÅÊµ∑Â∞îÁîµÂÜ∞ÁÆ±ÊûÑÊàê‰∫Ü‰∏Ä‰∏™‰∫ßÂìÅÊóè„ÄÇ ÊäΩË±°Â∑•ÂéÇÊ®°Âºè‰∏éÂ∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÊúÄÂ§ßÁöÑÂå∫Âà´Âú®‰∫éÔºåÂ∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÈíàÂØπÁöÑÊòØ‰∏Ä‰∏™‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑÔºåËÄåÊäΩË±°Â∑•ÂéÇÊ®°ÂºèÈúÄË¶ÅÈù¢ÂØπÂ§ö‰∏™‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑÔºå‰∏Ä‰∏™Â∑•ÂéÇÁ≠âÁ∫ßÁªìÊûÑÂèØ‰ª•Ë¥üË¥£Â§ö‰∏™‰∏çÂêå‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑ‰∏≠ÁöÑ‰∫ßÂìÅÂØπË±°ÁöÑÂàõÂª∫„ÄÇ ÂØπ‰∫éÂ¢ûÂä†Êñ∞ÁöÑ‰∫ßÂìÅÊóèÔºåÊäΩË±°Â∑•ÂéÇÊ®°ÂºèÂæàÂ•ΩÂú∞ÊîØÊåÅ‰∫Ü‚ÄúÂºÄÈó≠ÂéüÂàô‚ÄùÔºåÂè™ÈúÄË¶ÅÂ¢ûÂä†ÂÖ∑‰Ωì‰∫ßÂìÅÂπ∂ÂØπÂ∫îÂ¢ûÂä†‰∏Ä‰∏™Êñ∞ÁöÑÂÖ∑‰ΩìÂ∑•ÂéÇÔºåÂØπÂ∑≤Êúâ‰ª£Á†ÅÊó†È°ªÂÅö‰ªª‰Ωï‰øÆÊîπÔºõÂØπ‰∫éÂ¢ûÂä†Êñ∞ÁöÑ‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑÔºåÈúÄË¶Å‰øÆÊîπÊâÄÊúâÁöÑÂ∑•ÂéÇËßíËâ≤ÔºåÂåÖÊã¨ÊäΩË±°Â∑•ÂéÇÁ±ªÔºåÂú®ÊâÄÊúâÁöÑÂ∑•ÂéÇÁ±ª‰∏≠ÈÉΩÈúÄË¶ÅÂ¢ûÂä†Áîü‰∫ßÊñ∞‰∫ßÂìÅÁöÑÊñπÊ≥ïÔºåËøùËÉå‰∫Ü‚ÄúÂºÄÈó≠ÂéüÂàô‚Äù„ÄÇ ‰æãÂ≠ê‰∏ãÈù¢ÊòØ‰∏Ä‰∏™ÂÆöÂà∂‰∏çÂêåÁöÆËÇ§ÁöÑ‰æãÂ≠ê„ÄÇÁî± SpringSkinFactory Âíå SummerSkinFactory ÂÆûÁé∞‰∫ÜÊé•Âè£ SkinFactory ÁöÑ‰∏â‰∏™ÂàõÂª∫ÂØπË±°ÁöÑÊñπÊ≥ï„ÄÇÂêåÊ†∑ÁöÑÔºåÈÄöËøáÂèçÂ∞ÑÔºåÂä®ÊÄÅÁöÑÂàõÂª∫Â∑•ÂéÇÂÆû‰æã„ÄÇË∞ÉÁî®ÂÖ∂ÂÆûÁé∞ÁöÑÂàõÂª∫ÊñπÊ≥ïËé∑Âèñ‰∫ßÂìÅÂÆû‰æãÔºö ÂÖ∂ÂÆûÂ∞±ÊòØÔºåÊäΩË±°Â∑•ÂéÇÊ®°ÂºèÂíåÂ∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÊ≤°Âï•Â§ßÁöÑÂ∑ÆÂà´ÔºåÂè™‰∏çËøáÊääÂá†‰∏™‰∏çÂêåÁ±ªÂà´(Âç≥‰∏çÂêå‰∫ßÂìÅÁ≠âÁ∫ßÁªìÊûÑ)ÁöÑ‰∏úË•øÁöÑÂàõÂª∫ÊñπÊ≥ïÊîæÂú®‰∏ÄËµ∑ÔºåÂáèÂ∞ë‰∫ÜÂ∑•ÂéÇÁ±ªÁöÑÊï∞Èáè„ÄÇ Âçï‰æãÊ®°ÂºèÈöæÂ∫¶Ôºö1 È¢ëÁéáÔºö4 Âçï‰æãÊ®°ÂºèÔºöÁ°Æ‰øùÊüê‰∏Ä‰∏™Á±ªÂè™Êúâ‰∏Ä‰∏™ÂÆû‰æãÔºåËÄå‰∏îËá™Ë°åÂÆû‰æãÂåñÂπ∂ÂêëÊï¥‰∏™Á≥ªÁªüÊèê‰æõËøô‰∏™ÂÆû‰æãÔºåËøô‰∏™Á±ªÁß∞‰∏∫Âçï‰æãÁ±ªÔºåÂÆÉÊèê‰æõÂÖ®Â±ÄËÆøÈóÆÁöÑÊñπÊ≥ï„ÄÇÂçï‰æãÊ®°ÂºèÊòØ‰∏ÄÁßçÂØπË±°ÂàõÂª∫ÂûãÊ®°Âºè„ÄÇ Áº∫ÁÇπÔºöÂçï‰æãÁ±ªÊ≤°ÊúâÊäΩË±°Â±ÇÔºå‰∏çÊòì‰∫éÊâ©Â±ï„ÄÇÂêåÊó∂Âçï‰æãÁ±ªËÅåË¥£ËøáÈáçÔºåÂç≥ÂÖÖÂΩì‰∫ÜÂ∑•ÂéÇËßíËâ≤ÔºåÂèàÂÖÖÂΩì‰∫Ü‰∫ßÂìÅËßíËâ≤ ÁªìÊûÑÂçï‰æãÁ±ª‰∏≠Êúâ‰∏Ä‰∏™ÂØπË±°Â±ûÊÄßÔºåÂπ∂‰∏îÂ£∞Êòé‰∫Ü‰∏Ä‰∏™ÈùôÊÄÅÊñπÊ≥ï„ÄÇËøô‰∏™ÈùôÊÄÅÊñπÊ≥ïË¢´Ë∞ÉÁî®Êó∂Ôºå‰ºöÂÖàÂà§Êñ≠ÂØπË±°ÊòØÂê¶‰∏∫Á©∫ÔºåÂ¶ÇÊûú‰∏∫Á©∫Â∞±ÂàõÂª∫‰∏Ä‰∏™ÔºåÁÑ∂ÂêéËøîÂõû: ÂéüÂûãÊ®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö3 ÂéüÂûãÊ®°ÂºèÔºö‰ΩøÁî®ÂéüÂûãÂÆû‰æãÊåáÂÆöÂàõÂª∫ÂØπË±°ÁöÑÁßçÁ±ªÔºåÂπ∂‰∏îÈÄöËøáÊã∑Ë¥ùËøô‰∫õÂéüÂûãÂàõÂª∫Êñ∞ÁöÑÂØπË±°„ÄÇ ÂéüÂûãÊ®°ÂºèÁöÑÂ∑•‰ΩúÂéüÁêÜÂæàÁÆÄÂçïÔºöÂ∞Ü‰∏Ä‰∏™ÂéüÂûãÂØπË±°‰º†ÁªôÈÇ£‰∏™Ë¶ÅÂèëÂä®ÂàõÂª∫ÁöÑÂØπË±°ÔºåËøô‰∏™Ë¶ÅÂèëÂä®ÂàõÂª∫ÁöÑÂØπË±°ÈÄöËøáËØ∑Ê±ÇÂéüÂûãÂØπË±°Êã∑Ë¥ùËá™Â∑±Êù•ÂÆûÁé∞ÂàõÂª∫ËøáÁ®ã„ÄÇ Áº∫ÁÇπÔºöË¶Å‰∏∫ÊØè‰∏Ä‰∏™Á±ªÊèê‰æõ‰∏Ä‰∏™ÂÖãÈöÜÊñπÊ≥ïÔºåÂΩìÂØπÁ±ªËøõË°åÊîπÈÄ†Êó∂ÔºåÈúÄË¶Å‰øÆÊîπÊ∫ê‰ª£Á†ÅÔºåËøùÂèç‰∫ÜÂºÄÈó≠ÂéüÂàô„ÄÇÂè¶Â§ñÔºåÂµåÂ•óÂ§öÂ±ÇÊó∂ÔºåÂÆûÁé∞‰ª£Á†Å‰ºöËæÉ‰∏∫Â§çÊùÇ„ÄÇ ÁªìÊûÑÊØè‰∏™Ë¶Å clone ÁöÑÁ±ªÈÉΩÁªßÊâø‰∫é Prototype ÊäΩË±°Á±ªÔºåÁÑ∂ÂêéÂÆûÁé∞ÂÖ∂ clone ÊñπÊ≥ïÔºåÊ≥®ÊÑèËøôÈáåÁöÑÊñπÊ≥ïÊòØÂÆû‰æãÊñπÊ≥ïÔºö Ë∞ÉÁî®ÁöÑ‰ª£Á†ÅÁ±ª‰ººÔºö 123Prototype obj1 = new ConcretePrototype();obj1.setAttr("Sunny");Prototype obj2 = obj1.clone(); ÂÖ∂ÂÆûÂ∞±Á±ª‰ºº‰∫é iOS ‰∏≠ÁöÑÂÆûÁé∞ NSCopy ÂçèËÆÆÔºåÂÆåÊàê copyWithZone ÊñπÊ≥ïÔºåÁÑ∂ÂêéË∞ÉÁî® copy„ÄÇ Âª∫ÈÄ†ËÄÖÊ®°ÂºèÈöæÂ∫¶Ôºö4 È¢ëÁéáÔºö2 Âª∫ÈÄ†ËÄÖÊ®°ÂºèÔºöÂ∞Ü‰∏Ä‰∏™Â§çÊùÇÂØπË±°ÁöÑÊûÑÂª∫‰∏éÂÆÉÁöÑË°®Á§∫ÂàÜÁ¶ªÔºå‰ΩøÂæóÂêåÊ†∑ÁöÑÊûÑÂª∫ËøáÁ®ãÂèØ‰ª•ÂàõÂª∫‰∏çÂêåÁöÑË°®Á§∫„ÄÇ Âª∫ÈÄ†ËÄÖÊ®°ÂºèÂÖ∂ÂÆûÊòØ‰∏∫‰∫ÜÁªô‰∏Ä‰∏™ÁâπÂÆöÂØπË±°Âú®‰∏çÂêåÊÉÖÂÜµ‰∏ãËµã‰∏çÂêåÂÄºÁöÑ„ÄÇÊØîÂ¶Ç‰Ω†Ë¶ÅÂàùÂßãÂåñ‰∏Ä‰∏™ÂØπË±°ÔºåËøô‰∏™ÂØπË±°‰ºöÊ†πÊçÆ‰Ω†ÁªôÂá∫ÁöÑ type ‰∏çÂêåÔºåÂ∞ÜÂ±ûÊÄßÂàùÂßãÂåñ‰∏∫‰∏çÂêåÁöÑÂÄº„ÄÇ‰Ω†ÂèØ‰ª•Áî® if‚Ä¶else Âà§Êñ≠‰∏çÂêåÂ±ûÊÄßËµã‰∏çÂêåÂÄºÔºå‰ΩÜÊòØËøôÊ†∑ÊòæÁÑ∂ËøùËÉå‰∫ÜÂºÄÈó≠ÂéüÂàô„ÄÇÊâÄ‰ª•Âª∫ÈÄ†ËÄÖÊ®°ÂºèÂ∞±ÈúÄË¶Å‰Ω†‰∏∫ÊØè‰∏ÄÁßç type ÂàõÂª∫‰∏Ä‰∏™ builder Á±ªÔºåÂú® builder ‰∏≠Êèê‰æõÂØπÂØπË±°ÁöÑÂ±ûÊÄßËøõË°åËµãÂÄºÁöÑÊñπÊ≥ï„ÄÇÁÑ∂ÂêéÔºåÂàõÂª∫ÁöÑÊó∂ÂÄô‰º†ÂÖ•‰∏çÂêåÁöÑ builderÔºà‰Ω†‰πüÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑÁöÑÊñπÂºèÔºåÂè™‰º†ÂÖ•Â≠óÁ¨¶‰∏≤ÔºâÔºåË∞ÉÁî®Ëøô‰∫õËµãÂÄºÊñπÊ≥ïÔºå‰ª•Ê≠§ËææÂà∞ÂàÜÊãÜ if‚Ä¶else ÁöÑÁõÆÁöÑ„ÄÇ ÁªìÊûÑÊäΩË±°Á±ª Builder ÔºàÂõ†‰∏∫ Builder ‰∏≠Âê´ÊúâÂàõÂª∫ÁöÑÂØπË±°Â±ûÊÄßÔºåÊâÄ‰ª•‰∏çËÉΩËÆæÁΩÆ‰∏∫Êé•Âè£ÔºâÊèê‰æõ‰∫ÜÂàõÂª∫ÂØπË±°ÁöÑÊñπÊ≥ï‰ª•ÂèäËÆæÁΩÆËøô‰∏™ÂØπË±°‰∏≠ÁöÑÂ±ûÊÄßÁöÑÂêÑÁßçÊñπÊ≥ï„ÄÇ‰ºöÊúâÂ§ö‰∏™ ConcreteBuilder ÂÆûÁé∞‰∫ÜÊäΩË±° Builder ÁöÑÊñπÊ≥ï„ÄÇÊØè‰∏™ ConcreteBuilder ‰∏≠ËÆæÁΩÆÂ±ûÊÄßÊñπÊ≥ïÊâÄËÆæÁΩÆÁöÑÂ±ûÊÄßÈÉΩÊòØ‰∏çÂêåÁöÑ„ÄÇDirector ‰∏≠‰ºö‰øùÂ≠ò‰∏Ä‰∏™ Builder ÁöÑÂÆû‰æãÔºåÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑÂàõÂª∫‰∏çÂêåÁöÑ Builder ËÆæÁΩÆÁªô Director„ÄÇÂêåÊó∂ÔºåDirector Êèê‰æõ‰∫Ü‰∏Ä‰∏™ construct ÊñπÊ≥ïÔºåÁî®Êù•Ë∞ÉÁî® Builder ‰∏≠ËÆæÁΩÆÂ±ûÊÄßÁöÑÊñπÊ≥ïÔºåÊàë‰ª¨ÂèØ‰ª•Ëá™Áî±ÊéßÂà∂ÊòØÂê¶ÈúÄË¶ÅËÆæÁΩÆÊüê‰∏ÄÂ±ûÊÄßÔºàÂç≥ÊéßÂà∂ÊòØÂê¶Ë∞ÉÁî® builder ‰∏≠ËÆæÁΩÆÂ±ûÊÄßÁöÑÊñπÊ≥ïÔºâ„ÄÇÊúÄÂêéÈÄöËøá getResult() ËøîÂõûËÆæÁΩÆÂ•ΩÁöÑÂØπË±°Ôºö Âª∫ÈÄ†ËÄÖÊ®°Âºè‰∏éÊäΩË±°Â∑•ÂéÇÊ®°ÂºèÊúâÁÇπÁõ∏‰ººÔºå‰ΩÜÊòØÂª∫ÈÄ†ËÄÖÊ®°ÂºèËøîÂõû‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÂ§çÊùÇ‰∫ßÂìÅÔºåËÄåÊäΩË±°Â∑•ÂéÇÊ®°ÂºèËøîÂõû‰∏ÄÁ≥ªÂàóÁõ∏ÂÖ≥ÁöÑ‰∫ßÂìÅÔºõÂú®ÊäΩË±°Â∑•ÂéÇÊ®°Âºè‰∏≠ÔºåÂÆ¢Êà∑Á´ØÈÄöËøáÈÄâÊã©ÂÖ∑‰ΩìÂ∑•ÂéÇÊù•ÁîüÊàêÊâÄÈúÄÂØπË±°ÔºåËÄåÂú®Âª∫ÈÄ†ËÄÖÊ®°Âºè‰∏≠ÔºåÂÆ¢Êà∑Á´ØÈÄöËøáÊåáÂÆöÂÖ∑‰ΩìÂª∫ÈÄ†ËÄÖÁ±ªÂûãÂπ∂ÊåáÂØºÊåáÊå•ËÄÖÂ¶Ç‰ΩïÂéªÁîüÊàêÂØπË±°Ôºå‰æßÈáç‰∫é‰∏ÄÊ≠•Ê≠•ÊûÑÈÄ†‰∏Ä‰∏™Â§çÊùÇÂØπË±°ÔºåÁÑ∂ÂêéÂ∞ÜÁªìÊûúËøîÂõû„ÄÇÂ¶ÇÊûúÂ∞ÜÊäΩË±°Â∑•ÂéÇÊ®°ÂºèÁúãÊàê‰∏Ä‰∏™Ê±ΩËΩ¶ÈÖç‰ª∂Áîü‰∫ßÂéÇÔºåÁîüÊàê‰∏çÂêåÁ±ªÂûãÁöÑÊ±ΩËΩ¶ÈÖç‰ª∂ÔºåÈÇ£‰πàÂª∫ÈÄ†ËÄÖÊ®°ÂºèÂ∞±ÊòØ‰∏Ä‰∏™Ê±ΩËΩ¶ÁªÑË£ÖÂéÇÔºåÈÄöËøáÂØπÈÖç‰ª∂ËøõË°åÁªÑË£ÖËøîÂõû‰∏ÄËæÜÂÆåÊï¥ÁöÑÊ±ΩËΩ¶„ÄÇ ‰æãÂ≠ê‰∏ãÈù¢‰æãÂ≠ê‰∏≠ÔºåActorController ÂÖÖÂΩìÊåáÊå•ËÄÖ(Director)ÔºåActorBuilder ÂÖÖÂΩìÊäΩË±°Âª∫ÈÄ†ËÄÖÔºåHeroBuilder„ÄÅAngelBuilder Âíå DevilBuilder ÂÖÖÂΩìÂÖ∑‰ΩìÂª∫ÈÄ†ËÄÖÔºåActor ÂÖÖÂΩìÂ§çÊùÇ‰∫ßÂìÅ: ActorController ‰∏≠È¢ÑÂÖàËÆæÁΩÆ‰∏Ä‰∏™ builderÔºåÁÑ∂ÂêéÈÄöËøá construct ÊñπÊ≥ïË∞ÉÁî® builder ÁöÑÂêÑÁßçËÆæÁΩÆÊñπÊ≥ïÔºåËææÂà∞ËÆæÁΩÆ Actor ÁöÑÁõÆÁöÑ„ÄÇÂÖ∑‰ΩìÁöÑÊµÅÁ®ã‰∏äÈù¢Â∑≤ÁªèÂèôËø∞Ëøá‰∫Ü„ÄÇ Á±ªÊØîÂ∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÔºåbuilder ÂÖ∂ÂÆûÂíå factory Âü∫Êú¨‰∏ÄËá¥Ôºå‰∏§‰∏™ÈÉΩÊòØÂàùÂßãÂåñÂ±ûÊÄßÔºåbuilder ‰∏≠ÊúâÊõ¥Áªü‰∏ÄÁöÑÂàùÂßãÂåñÂ±ûÊÄßÁöÑÊñπÊ≥ï„ÄÇÂπ∂‰∏î‰∏Ä‰∏™ builder/factory ÂØπÂ∫î‰∏Ä‰∏™‰∫ßÂìÅÁ±ª„ÄÇ‰ΩÜÊòØ‰∏∫‰ªÄ‰πàËøôÈáå‰∏ìÈó®Ë¶ÅÊúâ‰∏Ä‰∏™ÊåáÊå•ËÄÖ(Director)Âë¢ÔºüÂõ†‰∏∫Êúâ‰∫ÜÊåáÊå•ËÄÖÂ∞±ÂèØ‰ª•ÊéßÂà∂ builder ‰∏≠ÁöÑÊñπÊ≥ïÂà∞Â∫ïÂì™‰∫õË¶ÅÊâßË°åÂì™‰∫õ‰∏çË¶ÅÊâßË°å‰∫ÜÔºåÂèØ‰ª•Ë£ÖÈó®ÂàõÂª∫‰∏Ä‰∏™ Director ÂØπË±°Ôºå‰ª•ÁªÑÂêàÁöÑÊñπÂºè‰Ωú‰∏∫dË∞ÉÁî®ËÄÖÁöÑ‰∏Ä‰∏™Â±ûÊÄßÔºåÈöèÊó∂ÂèØ‰ª•ÊõøÊç¢„ÄÇÂ∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÁöÑË∞ÉÁî®ËÄÖËØùÂ∞±‰∏çÂÖ≥ÂøÉË¶ÅËÆæÁΩÆÂì™‰∫õÂ±ûÊÄß‰∫ÜÔºåÊâÄ‰ª•Â∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÁöÑË∞ÉÁî®ËÄÖÂè™Ë∞ÉÁî® factory ÁöÑ create ÊñπÊ≥ïÔºåÂÖ∑‰ΩìÂ¶Ç‰ΩïËÆæÁΩÆÂ±ûÊÄßÁöÑÔºåË∞ÉÁî®ËÄÖÊó†‰ªéÁü•Êôì„ÄÇ ËøôÈáå Actor Ê≤°ÊúâÁªßÊâø‰ªª‰ΩïÁ±ªÔºåActorBuilder ÊòØ‰∏Ä‰∏™ÊäΩË±°Á±ªÔºåÂÖ∂‰∏≠‰øùÂ≠ò‰∫Ü Actor ÁöÑÂÆû‰æã„ÄÇÂÖ∂ÂÆûËÆæËÆ°Ê®°Âºè‰∏≠Ê≤°ÊúâÁ°¨ÊÄßËßÑÂÆöËøô‰∏™ËÆæËÆ°Ê®°Âºè‰∏≠‰∏ÄÂÆöË¶ÅÂåÖÂê´Êüê‰∏™Êé•Âè£ÔºåÊàñËÄÖÊüê‰∏™Âü∫Á±ªÔºåÂÆåÂÖ®ÊòØÊåâÁÖßÂÆûÈôÖÈúÄÊ±ÇÊù•ÁöÑÔºåÂè™ÈúÄË¶ÅÊèê‰æõÈÄöÁî®ÊñπÊ≥ïÁöÑÂ∞±ËÆæÁΩÆ‰∏∫Êé•Âè£ÔºåÈúÄË¶ÅÊèê‰æõÈÄöÁî®Â±ûÊÄßÁöÑÔºåÂ∞±ËÆæÁΩÆ‰∏∫Âü∫Á±ªÔºå‰ªÄ‰πà‰πü‰∏çÈúÄË¶ÅÁöÑÂ∞±ÊòØÊôÆÈÄöÁöÑÁ±ª„ÄÇÊØîÂ¶ÇÊú¨‰æãÔºåÊàë‰ª¨Â∞±Âè™ÈúÄË¶ÅÁîüÊàêËøô‰∏Ä‰∏™ Actor ÔºåÊâÄ‰ª•Â∞±‰∏çÈúÄË¶ÅÊêû‰ªª‰ΩïÁªßÊâøÂíåÁªÑÂêàÔºõActorBuilder ÂøÖÈ°ª‰øùÂ≠ò‰∏Ä‰∏™ Actor ÂÆû‰æãÂ±ûÊÄßÔºàÂõ†‰∏∫ÂêÑÁßçbuild ÊñπÊ≥ïÈÉΩË¶ÅË∞ÉÁî®ÂÆÉÁöÑÊñπÊ≥ïÔºâÔºåÊâÄ‰ª•Â∞±ÂøÖÈ°ªË¶ÅËÆæÁΩÆ‰∏∫ÊäΩË±°Á±ªÔºå‰∏çËÉΩËÆæÁΩÆ‰∏∫Êé•Âè£„ÄÇ ÂëΩÂêçÊúÄÂ•Ω‰ª• XxxBuilder Âíå buildXxxWithXxx: ÊñπÂºèÂëΩÂêç„ÄÇ Âª∫ÈÄ†ËÄÖÊ®°ÂºèÁöÑÊäΩË±°Á®ãÂ∫¶ÊØîÂ∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÁöÑÈ´òÔºåÊâÄ‰ª•ÂêåÊ†∑ÊòØÂàùÂßãÂåñÂ±ûÊÄßÁöÑÊìç‰ΩúÔºåÂª∫ÈÄ†ËÄÖÊ®°ÂºèÊäΩË±°Âá∫‰∫ÜÂêÑÁßç build ÊñπÊ≥ïÔºåËÄåÂ∑•ÂéÇÊñπÊ≥ïÊ®°ÂºèÂàôÂÖ®ÈÉ®ËóèÂú®Â∑•ÂéÇÁöÑ create ÊñπÊ≥ï‰∏≠„ÄÇ ‰∏ÉÁßçÁªìÊûÑÂûãÊ®°ÂºèÁªìÊûÑÂûãÊ®°Âºè‰∏ªË¶ÅÁî®‰∫éÊèèËø∞Á±ª‰∏éÁ±ª‰πãÈó¥ÁöÑÂÖ≥Á≥ªÔºåÂá†‰∏™Á±ª‰πãÈó¥Â¶Ç‰ΩïËß£ËÄ¶ÁöÑ ÈÄÇÈÖçÂô®Ê®°Âºè ÈÄÇÈÖçÂô®Ê®°ÂºèÔºöÂ∞Ü‰∏Ä‰∏™Êé•Âè£ËΩ¨Êç¢ÊàêÂÆ¢Êà∑Â∏åÊúõÁöÑÂè¶‰∏Ä‰∏™Êé•Âè£Ôºå‰ΩøÊé•Âè£‰∏çÂÖºÂÆπÁöÑÈÇ£‰∫õÁ±ªÂèØ‰ª•‰∏ÄËµ∑Â∑•‰ΩúÔºåÂÖ∂Âà´Âêç‰∏∫ÂåÖË£ÖÂô®(Wrapper)„ÄÇÈÄÇÈÖçÂô®Ê®°ÂºèÊó¢ÂèØ‰ª•‰Ωú‰∏∫Á±ªÁªìÊûÑÂûãÊ®°ÂºèÔºå‰πüÂèØ‰ª•‰Ωú‰∏∫ÂØπË±°ÁªìÊûÑÂûãÊ®°Âºè„ÄÇ Ê†πÊçÆÈÄÇÈÖçÂô®Á±ª‰∏éÈÄÇÈÖçËÄÖÁ±ªÁöÑÂÖ≥Á≥ª‰∏çÂêåÔºåÈÄÇÈÖçÂô®Ê®°ÂºèÂèØÂàÜ‰∏∫ÂØπË±°ÈÄÇÈÖçÂô®ÂíåÁ±ªÈÄÇÈÖçÂô®‰∏§ÁßçÔºåÂú®ÂØπË±°ÈÄÇÈÖçÂô®Ê®°Âºè‰∏≠ÔºåÈÄÇÈÖçÂô®‰∏éÈÄÇÈÖçËÄÖ‰πãÈó¥ÊòØÂÖ≥ËÅîÂÖ≥Á≥ªÔºõÂú®Á±ªÈÄÇÈÖçÂô®Ê®°Âºè‰∏≠ÔºåÈÄÇÈÖçÂô®‰∏éÈÄÇÈÖçËÄÖ‰πãÈó¥ÊòØÁªßÊâøÔºàÊàñÂÆûÁé∞ÔºâÂÖ≥Á≥ª„ÄÇÂú®ÂÆûÈôÖÂºÄÂèë‰∏≠ÔºåÂØπË±°ÈÄÇÈÖçÂô®ÁöÑ‰ΩøÁî®È¢ëÁéáÊõ¥È´ò. ÁªìÊûÑ Ë∞ÉÁî®ÁõÆÊ†áÊäΩË±°Á±ªÁöÑÊüê‰∏™ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÈÄöËøáÈÄÇÈÖçÂô®ÔºåËΩ¨ËÄåË∞ÉÁî®‰∫ÜÈÄÇÈÖçËÄÖÁ±ªÁöÑÊüê‰∏™ÊñπÊ≥ïÔºåÂÆåÊàêÈÄÇÈÖç„ÄÇ ‰æãÂ≠êÂØπË±°ÈÄÇÈÖçÂô®ÂØπË±°ÈÄÇÈÖçÂô®ÁöÑÈÄÇÈÖçÂô®ÔºàadapterÔºâÂíåÈÄÇÈÖçËÄÖÔºàadapteeÔºâÊòØÂÖ≥ËÅîÂÖ≥Á≥ª„ÄÇ‰∏ãÈù¢ÁöÑ OperationAdapter ÊòØÂÆûÁé∞‰∫ÜÊé•Âè£ ScoreOperation ÁöÑ sort ‰ª•Âèä search ÊñπÊ≥ï„ÄÇÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑÁöÑÊñπÂºèËá™Áî±Êõ¥ÊîπÊé•Âè£ ScoreOperation ÁöÑÂÆûÁé∞Á±ª‰ª•Êª°Ë∂≥ÂºÄÈó≠ÂéüÂàô„ÄÇÂú®ÈÄÇÈÖçÂô®‰∏≠ÔºåÁúüÊ≠£ÁöÑÂÆûÁé∞ÂØπË±° QuickSort ‰ª•Âèä BinarySearch ÊòØ‰Ωú‰∏∫ÂÖ∂Â±ûÊÄß sortObj,searchObj Â≠òÂú®ÁöÑÔºåÊâÄ‰ª•Áß∞‰∏∫ÂÖ≥ËÅîÂÖ≥Á≥ª„ÄÇÂú®Ë∞ÉÁî® sortÔºåsearch ÊñπÊ≥ïÂêéÔºåÂ∞ÜË∞ÉÁî®ÁúüÊ≠£ÁöÑÂÆûÁé∞ÊñπÊ≥ïÔºö Á±ªÈÄÇÈÖçÂô®Á±ªÈÄÇÈÖçÂô®ÁöÑÈÄÇÈÖçÂô®ÂíåÈÄÇÈÖçËÄÖÊòØÁªßÊâøÂÖ≥Á≥ªÔºå Adapter ÊòØÁªßÊâø‰∫é Adaptee ÁöÑÔºåÂÆûÁé∞‰∫Ü specificRequest() ÊñπÊ≥ï.ÂêåÊó∂Ôºå Adapter ‰πüÂÆûÁé∞‰∫ÜÊé•Âè£ Target ÁöÑ request() ÊñπÊ≥ïÔºåÂú® request() ÊñπÊ≥ï‰∏≠Ë∞ÉÁî®ÂÆûÁé∞ÊñπÊ≥ï specificRequest()„ÄÇÊ≥®ÊÑè‰∏ãÂõæÂíå‰∏äÈù¢ÁªìÊûÑÂõæÁöÑÂå∫Âà´Ôºö Target ÊòØ‰∏Ä‰∏™Êé•Âè£ÔºåÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÈÄöÁî®ÁöÑÊñπÊ≥ï‰æõË¢´ÈÄÇÈÖçÂØπË±°Ë∞ÉÁî®ÔºåÁî±ÂÖ∑‰ΩìÁöÑ Adapter ÁªßÊâøÂÆûÁé∞„ÄÇAdaptee Áî±‰∫éÊòØÂÖ∑‰ΩìÁöÑÈÄÇÈÖçÁ±ªÔºåÂêÑ‰∏™Á±ª‰∏çÂêåÔºåÊâÄ‰ª•‰∏çÊèê‰æõÈÄöÁî®ÁöÑÊñπÊ≥ï„ÄÇ ÂëΩÂêçÊúÄÂ•Ω‰ª• XxxAdapter Âíå requestXxxWithXxx: ÂëΩÂêç„ÄÇ ÂÖ∂ÂÆûÂ§ßÈÉ®ÂàÜËÆæËÆ°Ê®°ÂºèÁöÑÁªìÊûÑÈÉΩÂíå‰∏äÈù¢ÊãøÂà∞ÂæàÂÉèÔºå‰∏Ä‰∏™Á±ªÈÄöËøá‰∏Ä‰∏™‰∏≠Èó¥‰∫∫Ë∞ÉÁî®Âè¶‰∏Ä‰∏™Á±ªÁöÑÊñπÊ≥ïÔºåÊàë‰ª¨ÂèØ‰ª•‰∏≠Èó¥‰∫∫Ë∞ÉÁî®Âè¶‰∏Ä‰∏™Á±ªÊñπÊ≥ïÂâçÂêéÂàÜÂà´Ë∞ÉÁî®‰∏Ä‰∫õËá™Â∑±ÁöÑÊñπÊ≥ï„ÄÇÊØîÂ¶ÇÂ§ñËßÇÊ®°ÂºèÔºå‰ª£ÁêÜÊ®°ÂºèÔºåÂëΩ‰ª§Ê®°ÂºèÁ≠â Âå∫ÂàÜËøô‰∫õËÆæËÆ°Ê®°ÂºèÁöÑË¶ÅÁÇπÂú®‰∫éÂå∫ÂàÜÁõÆÁöÑ„ÄÇ ÈÄÇÈÖçÂô®Ê®°ÂºèÁöÑÁõÆÁöÑÊòØÈÄÇÈÖçÔºå‰∏æ‰∏™ÁÆÄÂçïÁöÑ‰æãÂ≠êÔºåÊØîÂ¶ÇÊàëÂè™ËÉΩÊèê‰æõ CFloat ÁöÑÂèÇÊï∞Ôºå‰ΩÜÊòØË¢´Ë∞ÉÁî®ËÄÖÂøÖÈ°ªË¶Å NSNumberÔºåÈÇ£‰πàÊàëÂ∞±‰∏çËÉΩÁõ¥Êé•Ë∞ÉÁî®Ë¢´Ë∞ÉÁî®ËÄÖ„ÄÇÊâÄ‰ª•Ëøô‰∏™‰∏≠Èó¥Á±ªÂ∞±ÊòØÁî®Êù•ÈÄÇÈÖçÁöÑ„ÄÇ ‰ª£ÁêÜÊ®°ÂºèÁöÑÁõÆÁöÑÊòØ‰ª£ÁêÜÔºåÂ∞±ÊòØÊàëÂ∞±‰∏çÊÉ≥Áî®ÂéüÊù•ÁöÑË¢´Ë∞ÉÁî®ÂØπË±°ÔºåÊàëÊÉ≥Áî®‰∏Ä‰∏™Êñ∞ÁöÑ‰∏≠Èó¥Á±ª‰ª£ÊõøÂÆÉÔºåÁÑ∂ÂêéÂÅö‰∏Ä‰∫õÈ¢ùÂ§ñÁöÑÊìç‰Ωú„ÄÇÊâÄ‰ª•Ëøô‰∏™‰∏≠Èó¥Á±ªÊòØÁî®Êù•‰ª£ÁêÜÁöÑÔºåËôΩÁÑ∂ÂèØËÉΩ‰πüÂÅö‰∫ÜÈÄÇÈÖçÁöÑÂ∑•‰ΩúÔºå‰ΩÜÊòØÊàëÁõÆÁöÑÂ∞±ÊòØÊÉ≥Áî®ÂÆÉ‰ª£ÁêÜÂéüÊù•ÁöÑÁ±ª„ÄÇ Â§ñËßÇÊ®°ÂºèÁöÑÁõÆÁöÑÊòØÊîπÂèòÂ§ñËßÇ„ÄÇÂ∞±ÊòØÂéüÊù•ÊàëÊó¢Ë¶ÅË∞ÉÁî®Ëøô‰∏™Á±ªÁöÑÊé•Âè£ÔºåÂèàË¶ÅË∞ÉÁî®ÈÇ£‰∏™Á±ªÁöÑÊé•Âè£ÔºåÂ§™È∫ªÁÉ¶‰∫ÜÔºåÊâÄ‰ª•ÊàëÂàõÂª∫‰∫Ü‰∏Ä‰∏™‰∏≠Èó¥Á±ªÔºåÊù•Áªü‰∏ÄÊâÄÊúâÁöÑÊé•Âè£„ÄÇÊâÄÊúâÁöÑË∞ÉÁî®ÈÉΩËµ∞Ëøô‰∏™‰∏≠Èó¥Á±ªÔºåËôΩÁÑ∂ÂèØËÉΩÂÆÉ‰πüÂÅö‰∫ÜÈÄÇÈÖçÂíå‰ª£ÁêÜÁöÑÂ∑•‰ΩúÔºå‰ΩÜÊòØÊàëÁöÑÁõÆÁöÑÂ∞±ÊòØË¶ÅÁªü‰∏ÄÊâÄÊúâÊé•Âè£„ÄÇ ÂëΩ‰ª§Ê®°ÂºèÁöÑÁõÆÁöÑÊòØÂåÖË£ÖÊñπÊ≥ï„ÄÇËøôÂíå‰∏äÈù¢ÁöÑËß£ÊûÑÂûãËÆæËÆ°Ê®°Âºè‰∏çÂ§™‰∏ÄÊ†∑„ÄÇÂëΩ‰ª§Ê®°ÂºèÊòØË°å‰∏∫ÂûãËÆæËÆ°Ê®°ÂºèÔºåËÆ≤Á©∂ÁöÑÊòØÂØπ‰∫éÊñπÊ≥ïÁöÑÊâßË°åÔºåÁªìÊûÑÂûãËÆ≤Á©∂ÁöÑÊòØÁ±ª‰∏éÁ±ª‰πãÈó¥ÁöÑÂÖ≥Á≥ª„ÄÇÊàë‰∏çÊòØËÆ©‰ªñÈÄÇÈÖçÊüê‰∏Ä‰∏™Á±ªÔºå‰πü‰∏çÊòØËÆ©ÂÆÉ‰ª£ÁêÜÊüê‰∏Ä‰∏™Á±ªÔºåÊõ¥‰∏çÊòØÊÉ≥ËÆ©ÂÆÉÊõøÊç¢Êüê‰∏Ä‰∏™Á±ªÁöÑÊé•Âè£„ÄÇÂ∞±ÊòØÊÉ≥ÊääÊüê‰∏™Á±ªÁöÑÊüê‰∏™ÊñπÊ≥ïÂåÖË£Ö‰∏Ä‰∏ã„ÄÇ Ê°•Êé•Ê®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö3 Ê°•Êé•Ê®°ÂºèÔºöÂ∞ÜÊäΩË±°ÈÉ®ÂàÜ‰∏éÂÆÉÁöÑÂÆûÁé∞ÈÉ®ÂàÜÂàÜÁ¶ªÔºå‰ΩøÂÆÉ‰ª¨ÈÉΩÂèØ‰ª•Áã¨Á´ãÂú∞ÂèòÂåñ„ÄÇ Â¶ÇÊûúËΩØ‰ª∂Á≥ªÁªü‰∏≠Êüê‰∏™Á±ªÂ≠òÂú®‰∏§‰∏™ÊàñËÄÖÂ§ö‰∏™Áã¨Á´ãÂèòÂåñÁöÑÁª¥Â∫¶ÔºåÈÄöËøáËØ•Ê®°ÂºèÂèØ‰ª•Â∞ÜËøô‰∏§‰∏™Áª¥Â∫¶ÂàÜÁ¶ªÂá∫Êù•Ôºå‰Ωø‰∏§ËÄÖÂèØ‰ª•Áã¨Á´ãÊâ©Â±ïÔºåËÆ©Á≥ªÁªüÊõ¥Âä†Á¨¶Âêà‚ÄúÂçï‰∏ÄËÅåË¥£ÂéüÂàô‚Äù„ÄÇ‰∏éÂ§öÂ±ÇÁªßÊâøÊñπÊ°à‰∏çÂêåÔºåÂÆÉÂ∞Ü‰∏§‰∏™Áã¨Á´ãÂèòÂåñÁöÑÁª¥Â∫¶ËÆæËÆ°‰∏∫‰∏§‰∏™Áã¨Á´ãÁöÑÁªßÊâøÁ≠âÁ∫ßÁªìÊûÑÔºåÂπ∂‰∏îÂú®ÊäΩË±°Â±ÇÂª∫Á´ã‰∏Ä‰∏™ÊäΩË±°ÂÖ≥ËÅîÔºåËØ•ÂÖ≥ËÅîÂÖ≥Á≥ªÁ±ª‰ºº‰∏ÄÊù°ËøûÊé•‰∏§‰∏™Áã¨Á´ãÁªßÊâøÁªìÊûÑÁöÑÊ°•ÔºåÊïÖÂêçÊ°•Êé•Ê®°Âºè„ÄÇ Áº∫ÁÇπÔºöË¶ÅËÉΩÊ≠£Á°ÆËØÜÂà´Á≥ªÁªü‰∏≠‰∏§‰∏™Áã¨Á´ãÂèòÂåñÁöÑÁª¥Â∫¶„ÄÇÂ¶ÇÊûú‰∏çÊòØÁã¨Á´ãÂèòÂåñÁöÑÔºåÈÇ£ËøòÊòØ‰∏çÂèØÈÅøÂÖçÁöÑË¶ÅÈÄöËøá if‚Ä¶else Âà§Êñ≠„ÄÇ ÁªìÊûÑ Â¶ÇÂõæÔºåÊäΩË±°Á±ª Abstraction ‰∏∫‰∏Ä‰∏™Áª¥Â∫¶ÔºåÂÆÉË¶ÅÊ±ÇÂÆÉÁöÑÂ≠êÁ±ªÈÉΩÂÆûÁé∞ operation() ÊñπÊ≥ï„ÄÇÊé•Âè£ Implementor ÊòØÂè¶‰∏Ä‰∏™Áª¥Â∫¶ÔºåÂÆÉË¶ÅÊ±ÇÂÆûÁé∞ÂÆÉÊé•Âè£ÁöÑÁ±ªÈÉΩÈúÄË¶ÅÂÆûÁé∞ operationImpl ÊñπÊ≥ï„ÄÇÂú®ÊäΩË±°Á±ª Abstraction ‰∏≠‰øùÁïôÊúâÊé•Âè£ Implementor ÁöÑÂÖ∑‰ΩìÂÆûÁé∞Â±ûÊÄß impl„ÄÇ‰∏§ËÄÖÈÄöËøáÁªÑÂêàÁöÑÊñπÂºèÂÆûÁé∞‰∫ÜÂêå‰∏ÄÔºåËÉΩÂ§üÂÆûÁé∞‰∏§‰∏™Áª¥Â∫¶ÈúÄË¶ÅÁöÑÊñπÊ≥ï operation() Âíå operationImpl()„ÄÇ ‰ªçÁÑ∂ÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑÁöÑÊñπÂºèËé∑ÂæóÊäΩË±°Á±ªÁöÑÂÆûÁé∞ÔºåÂíåÊé•Âè£ÁöÑÂÆûÁé∞„ÄÇÂ¢ûÂä†Êñ∞ÁöÑÊäΩË±°Á±ªÊàñÊé•Âè£ÂÆûÁé∞Â∞±ÂèØ‰ª•ÊãìÂ±ïÁ≥ªÁªüÔºåÁ¨¶ÂêàÂºÄÈó≠ÂéüÂàô„ÄÇ ‰æãÂ≠êÊØîÂ¶ÇË¶ÅÂÆûÁé∞‰∏Ä‰∏™ÂõæÂÉèÊµèËßàÁ≥ªÁªüÔºåË¶ÅËÉΩÂ§üÊòæÁ§∫‰∏çÂêåÊ†ºÂºèÁöÑÂõæÁâáÊñá‰ª∂ÔºåÂèàË¶ÅÂÖºÂÆπ‰∏çÂêåÁöÑÂπ≥Âè∞„ÄÇÂ¶ÇÊûú‰∏çÁî®Ê°•Êé•Ê®°ÂºèÔºå‰ºö‰∫ßÁîüÂ¶Ç‰∏ãÁöÑÁªßÊâøÊ†ë„ÄÇÂõ†‰∏∫ÊúâÊ†ºÂºèÂíåÂπ≥Âè∞‰∏§‰∏™Áª¥Â∫¶ÔºåÊâÄ‰ª•ÁªßÊâøÊ†ëÊúâ‰∏§Â±ÇÔºö ‰ΩÜÊòØ‰ΩøÁî®Ê°•Êé•Ê®°ÂºèÔºåÂèØ‰ª•Â∞ÜÂπ≥Âè∞Áª¥Â∫¶‰Ωú‰∏∫Êé•Âè£Áã¨Á´ãÂá∫Êù•„ÄÇ‰ª•ÂõæÁâáÁª¥Â∫¶‰Ωú‰∏∫‰∏ªÁª¥Â∫¶ÔºåËÆæÁΩÆÊäΩË±°Á±ª ImageÔºåÂÖ∂‰∏≠Èô§‰∫ÜËá™Â∑±Áª¥Â∫¶ÈúÄË¶ÅÁöÑÊñπÊ≥ï parseFile() Â§ñÔºåËøò‰øùÂ≠ò‰∫ÜÂπ≥Âè∞Áª¥Â∫¶ ImageImp ÁöÑÂÆû‰æã imp„ÄÇÂèØ‰ª•ÈÄöËøá imp.doPaint() Ë∞ÉÁî®Âπ≥Âè∞Áª¥Â∫¶ÁöÑÊñπÊ≥ï„ÄÇ ‰∏Ä‰∏™Áª¥Â∫¶ÊòØ‰∏ªË¶ÅÁª¥Â∫¶ÔºåÊ∂âÂèäÂ±ûÊÄßÔºåÊâÄ‰ª•Ê∂âÂèä‰∏∫ÊäΩË±°Á±ªÔºåÂè¶‰∏Ä‰∏™Áª¥Â∫¶‰∏çÊ∂âÂèäÂ±ûÊÄßÔºåÂè™Ê∂âÂèä‰∏Ä‰∫õÊñπÊ≥ïÔºåÊâÄ‰ª•Ê∂âÂèä‰∏∫Êé•Âè£„ÄÇËøôÊòØÁªÑÂêàÁöÑ‰∏Ä‰∏™ÂÖ∏ÂûãËøêÁî®ÔºåÊ≤°ÊúâÊ∂âÂèäÂà∞‰∏≠Èó¥‰∫∫„ÄÇ Ê≤°ÊúâÂõ∫ÂÆöÁöÑÂëΩÂêçÊñπÂºè ‰ªÄ‰πàÊòØÁª¥Â∫¶ÔºüÊòØË¶ÅÂÅöÁõ∏‰ººÂ§ÑÁêÜÔºàÊúâÁùÄÁõ∏ÂêåÁöÑÊñπÊ≥ïÂêçÔºå‰ΩÜÊñπÊ≥ïÂÆûÁé∞ÊñπÂºè‰∏çÂêåÔºâÁöÑÊäΩË±° ÂÖ∂ÂÆûÂ∞±ÊòØÔºåÂ∞Ü‰∏ªË¶ÅÁª¥Â∫¶‰Ωú‰∏∫ÊäΩË±°Á±ªÁî®‰∫éÁªßÊâø„ÄÇÊ¨°Ë¶ÅÁª¥Â∫¶ÂàÜÁ¶ª‰∏∫Êé•Âè£„ÄÇÊúÄÁªàËøòÊòØÈÄöËøáÁªÑÂêàÁöÑÊñπÂºèÔºå‰ª£ÊõøÁªßÊâø„ÄÇ ÁªÑÂêàÊ®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö4 ÁªÑÂêàÊ®°ÂºèÔºöÁªÑÂêàÂ§ö‰∏™ÂØπË±°ÂΩ¢ÊàêÊ†ëÂΩ¢ÁªìÊûÑ‰ª•Ë°®Á§∫ÂÖ∑Êúâ‚ÄúÊï¥‰Ωì‚ÄîÈÉ®ÂàÜ‚ÄùÂÖ≥Á≥ªÁöÑÂ±ÇÊ¨°ÁªìÊûÑ„ÄÇÁªÑÂêàÊ®°ÂºèÂØπÂçï‰∏™ÂØπË±°ÔºàÂç≥Âè∂Â≠êÂØπË±°ÔºâÂíåÁªÑÂêàÂØπË±°ÔºàÂç≥ÂÆπÂô®ÂØπË±°ÔºâÁöÑ‰ΩøÁî®ÂÖ∑Êúâ‰∏ÄËá¥ÊÄßÔºåÁªÑÂêàÊ®°ÂºèÂèàÂèØ‰ª•Áß∞‰∏∫‚ÄúÊï¥‰Ωì‚ÄîÈÉ®ÂàÜ‚Äù(Part-Whole)Ê®°Âºè„ÄÇ ÁªÑÂêàÊ®°Âºè‰∏∫Â§ÑÁêÜÊ†ëÂΩ¢ÁªìÊûÑÊèê‰æõ‰∫Ü‰∏ÄÁßçËæÉ‰∏∫ÂÆåÁæéÁöÑËß£ÂÜ≥ÊñπÊ°àÔºåÂÆÉÊèèËø∞‰∫ÜÂ¶Ç‰ΩïÂ∞ÜÂÆπÂô®ÂíåÂè∂Â≠êËøõË°åÈÄíÂΩíÁªÑÂêàÔºå‰ΩøÂæóÁî®Êà∑Âú®‰ΩøÁî®Êó∂Êó†È°ªÂØπÂÆÉ‰ª¨ËøõË°åÂå∫ÂàÜÔºåÂèØ‰ª•‰∏ÄËá¥Âú∞ÂØπÂæÖÂÆπÂô®ÂíåÂè∂Â≠ê ÁªÑÂêàÊ®°ÂºèÁöÑÂÖ≥ÈîÆÊòØÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÊäΩË±°ÊûÑ‰ª∂Á±ªÔºåÂÆÉÊó¢ÂèØ‰ª•‰ª£Ë°®Âè∂Â≠êÔºåÂèàÂèØ‰ª•‰ª£Ë°®ÂÆπÂô®ÔºåËÄåÂÆ¢Êà∑Á´ØÈíàÂØπËØ•ÊäΩË±°ÊûÑ‰ª∂Á±ªËøõË°åÁºñÁ®ãÔºåÊó†È°ªÁü•ÈÅìÂÆÉÂà∞Â∫ïË°®Á§∫ÁöÑÊòØÂè∂Â≠êËøòÊòØÂÆπÂô®ÔºåÂèØ‰ª•ÂØπÂÖ∂ËøõË°åÁªü‰∏ÄÂ§ÑÁêÜ. ÁªìÊûÑ ÊäΩË±°Á±ª Component ÂÆö‰πâ‰∫Ü‰∏ÄÁ≥ªÂàóÊñπÊ≥ïÔºåoperation() ÊñπÊ≥ïÁî®Êù•ÂÅöÂÆûÈôÖ‰∏öÂä°Â§ÑÁêÜÔºåadd() Âíå remove() Áî®Êù•Ê∑ªÂä†ÂíåÂà†Èô§ÂØπË±°ÔºåËøô‰∏™ÂØπË±°ÂèØ‰ª•ÊòØÂè∂Â≠ê‰πüÂèØ‰ª•ÊòØÂÆπÂô®ÔºågetChild() Áî®Êù•ËøîÂõûÂè∂Â≠êÊàñËÄÖÂÆπÂô®„ÄÇÂú®ÂÆπÂô®ÁöÑ opeartion() ÊñπÊ≥ï‰∏≠Ôºå‰ºöË∞ÉÁî®ÂÖ∂ÊâÄÊúâÂ≠êÂØπË±°ÁöÑ operation() ÊñπÊ≥ï„ÄÇ Lead Âíå Composite ÁªßÊâø‰∫éÂêå‰∏Ä‰∏™Ë∂ÖÁ±ª ComponentÔºåComponent ‰∏≠ÁöÑ add Âíå remove ‰ª•Âèä getChild Âú® Leaf ‰∏≠ÂõΩ‰∏çÂÆûÁé∞ÔºåÂè™ÂÆûÁé∞ operation„ÄÇ ‰æãÂ≠ê ÊäΩË±°Á±ª AbstractFile ÂÆö‰πâ‰∫ÜÂ§ö‰∏™ÊñπÊ≥ïÔºåÂÖ∂‰∏≠ killVirus() Â∞±ÊòØ‰∏äÈù¢ÁöÑ operation() ÊñπÊ≥ï„ÄÇImageFile,VideoFile,TextFile Â∞±ÊòØÂè∂Â≠êÂØπË±°„ÄÇFolder Â∞±ÊòØÂÆπÂô®ÂØπË±°ÔºåÂÆπÂô®ÂØπË±°ÈáåÂèØËÉΩËøòÊúâÂæàÂ§öÂõæÂÉèËßÜÂõæÊñáÊú¨Êñá‰ª∂„ÄÇ Ê≤°ÊúâÂõ∫ÂÆöÁöÑÂëΩÂêçÊñπÂºèÔºå‰∏çËøáÂü∫Á±ªË¶ÅÂÆö‰πâÊ∑ªÂä†„ÄÅÂà†Èô§„ÄÅÊü•ÁúãÂ≠êËäÇÁÇπ‰ª•ÂèäÁúüÊ≠£ÁöÑÊâßË°åÊñπÊ≥ïÁöÑÂëΩÂêç„ÄÇ ÁªÑÂêàÊ®°ÂºèÂè∂Â≠êÂíåÂÆπÂô®ÁöÑÂÖ≥Á≥ªÔºõÂª∫ÈÄ†ËÄÖÊ®°ÂºèÊòØ‰∏Ä‰∏™Áª¥Â∫¶ÂíåÂè¶‰∏Ä‰∏™Áª¥Â∫¶ÁöÑÂÖ≥Á≥ª„ÄÇÁªÑÂêàÊ®°Âºè‰∏≠Âè∂Â≠êÂíåÂÆπÂô®ÂÖ∂ÂÆûÊòØ‰∏ÄÁ±ªÁöÑÔºå‰ªñ‰ª¨ÈÉΩÁªßÊâø‰∫éÂêå‰∏Ä‰∏™ÊäΩË±°Á±ªÔºõÂª∫ÈÄ†ËÄÖÊ®°Âºè‰∏≠‰∏§‰∏™Áª¥Â∫¶ÊòØ‰∏çÂêåÁöÑÔºåÁªßÊâø‰∫é‰∏çÂêåÁöÑÊäΩË±°Á±ªÊàñËÄÖÊé•Âè£„ÄÇ ÁªÑÂêàÊ®°Âºè‰∏çÊòØÊàë‰ª¨ÈÄöÂ∏∏ËÆ≤ÁöÑÁªÑÂêà„ÄÇÈÄöÂ∏∏Â∞ÜÁöÑÁªÑÂêàÊòØÊåáÊää‰∏Ä‰∏™ÂØπË±°ÊîæÂú®Âè¶‰∏Ä‰∏™ÂØπË±°‰∏≠‰Ωú‰∏∫ÂÖ∂Â±ûÊÄß„ÄÇËÄåÁªÑÂêàÊ®°ÂºèÂàôÊòØÊåáÊää‰∏ÄÂ†ÜÁ±ª‰ººÁöÑÂè∂Â≠êÂØπË±°ÊîæÂú®‰∏ÄËµ∑‰Ωú‰∏∫‰∏Ä‰∏™ÂÆπÂô®„ÄÇ Ë£ÖÈ•∞Ê®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö3 Ë£ÖÈ•∞Ê®°ÂºèÔºöÂä®ÊÄÅÂú∞Áªô‰∏Ä‰∏™ÂØπË±°Â¢ûÂä†‰∏Ä‰∫õÈ¢ùÂ§ñÁöÑËÅåË¥£ÔºåÂ∞±Â¢ûÂä†ÂØπË±°ÂäüËÉΩÊù•ËØ¥ÔºåË£ÖÈ•∞Ê®°ÂºèÊØîÁîüÊàêÂ≠êÁ±ªÂÆûÁé∞Êõ¥‰∏∫ÁÅµÊ¥ª„ÄÇ Â¶ÇÊûúÊàë‰ª¨‰∏çÈÄÇÁî®Ë£ÖÈ•∞Ê®°ÂºèÔºåÈÇ£‰πàÂØπ‰∏Ä‰∏™ÂäüËÉΩÊ∑ªÂä†Êñ∞ÁöÑÂäüËÉΩÂ∞±Ë¶ÅÁªßÊâøÊàê‰∏∫‰∏Ä‰∏™Êñ∞Á±ªÔºö ÁªìÊûÑ Â¶ÇÂõæÊâÄÁ§∫Ôºåcomponent ÊòØ‰∏Ä‰∏™ÊäΩË±°Á±ªÔºå‰πüÂèØ‰ª•ÊòØ‰∏Ä‰∏™Êé•Âè£ÔºåÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ operation() ÊñπÊ≥ï„ÄÇconcreteComponent ÊòØËøô‰∏™ÊäΩË±°Á±ªÊàñÊé•Âè£ÁöÑÂÆûÁé∞Ôºå‰πüÊòØË¢´Ë£ÖÈ•∞ÂØπË±°„ÄÇÁé∞Âú® Decorator ÊòØ‰∏Ä‰∏™ÊäΩË±°Á±ªÔºåÂÖ∂‰∏≠Âê´Êúâ‰∏Ä‰∏™ concreteComponent ÁöÑÂÖ∑‰ΩìÂÆû‰æã componentÔºåÂú®ÂÖ∂ operation() ÊñπÊ≥ï‰∏≠ÔºåÊØèÊ¨°ÈÉΩ‰ºöË∞ÉÁî®Ëøô‰∏™ component ÁöÑÊñπÊ≥ï„ÄÇ‰ºöÊúâËÆ∏Â§öÂÖ∑‰ΩìÁöÑÂÆûÁé∞Á±ª ConcreteDecorateX ÂÆûÁé∞ DecoratorÔºåÂÆÉ‰ª¨‰ºöÂú®Ëá™Ë∫´ operation() ÊñπÊ≥ï‰∏≠Ë∞ÉÁî®ÂÖ∂‰∏≠‰øùÂ≠òÁöÑ component ÁöÑÊñπÊ≥ïÔºåÂπ∂‰∏îÂä†‰∏äËá™Â∑±ÁöÑÂÆûÁé∞„ÄÇ Ë∞ÉÁî®ÁöÑËØùÔºåÈúÄË¶ÅÂÖàÂàõÂª∫‰∏Ä‰∏™ ConcreteComponentÔºåÁÑ∂ÂêéÊääÂÆÉËÆæÁΩÆÁªôË£ÖÈ•∞ËÄÖÁöÑ ComponentÔºåÁÑ∂ÂêéË∞ÉÁî®Ë£ÖÈ•∞ËÄÖ‰∏≠ÁöÑÂ§ÑÁêÜÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÊúâÂ§ö‰∏™Ë£ÖÈ•∞ËÄÖÔºåÂèØ‰ª•Â∞ÜÊüê‰∏™Ë£ÖÈ•∞ËÄÖ‰Ωú‰∏∫Âè¶‰∏Ä‰∏™Ë£ÖÈ•∞ËÄÖÁöÑ Component ËÆæÁΩÆËøõÂéª„ÄÇ Áº∫ÁÇπÔºö‰ºö‰∫ßÁîüÂ§ö‰∏™Â∞èÂØπË±°„ÄÇÊõ¥ÂÆπÊòìÂá∫ÈîôÔºå‰∏îÊéíÈîôÂõ∞Èöæ„ÄÇ ‰æãÂ≠ê ‰∏äÈù¢ÁöÑÈÇ£‰∏™‰æãÂ≠êÁöÑÊ≠£Á°ÆÊâìÂºÄÊñπÂºèÊòØÔºåÂú®Ë£ÖÈ•∞Á±ª ComponentDecorator ÁöÑÂ≠êÁ±ª‰∏≠ÂÆûÁé∞ÊñπÊ≥ï display() ÁöÑÊãìÂ±ï„ÄÇË∞ÉÁî®ÊñπÂºèÂ¶Ç‰∏ãÔºö 12345Component component,componentSB,componentBB; //ÂÖ®ÈÉ®‰ΩøÁî®ÊäΩË±°ÊûÑ‰ª∂ÂÆö‰πâcomponent = new Window();componentSB = new ScrollBarDecorator(component);componentBB = new BlackBorderDecorator(componentSB); //Â∞ÜË£ÖÈ•∞‰∫Ü‰∏ÄÊ¨°‰πãÂêéÁöÑÂØπË±°ÁªßÁª≠Ê≥®ÂÖ•Âà∞Âè¶‰∏Ä‰∏™Ë£ÖÈ•∞Á±ª‰∏≠ÔºåËøõË°åÁ¨¨‰∫åÊ¨°Ë£ÖÈ•∞componentBB.display(); Ë£ÖÈ•∞Ê®°ÂºèÁöÑË£ÖÈ•∞ÂØπË±°ÂíåË¢´Ë£ÖÈ•∞ÂØπË±°ÈÉΩÁªßÊâø‰∫é‰∏Ä‰∏™Âü∫Á±ªÔºåÂü∫Á±ª‰∏≠Êèê‰æõÁöÑÊñπÊ≥ïÂ∞±ÊòØÂ∞ÜË¢´Ë£ÖÈ•∞ÁöÑÊñπÊ≥ï„ÄÇÂàõÂª∫Ë£ÖÈ•∞ËÄÖÂØπË±°ÁöÑÊó∂ÂÄôË¶ÅÂ∞ÜË¢´Ë£ÖÈ•∞ËÄÖ(Ë¢´Ë£ÖÈ•∞ÁùÄÂèØ‰ª•ÊòØÊúÄÊ†πÊú¨ÁöÑ Component ‰πüÂèØ‰ª•ÊòØÂÖ∂‰ªñÁöÑ Director)‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•ÔºåË£ÖÈ•∞ËÄÖÂÜÖÈÉ®‰ºöÂ∞ÜÂÖ∂‰Ωú‰∏∫‰∏Ä‰∏™Â±ûÊÄß‰øùÂ≠ò„ÄÇÂ§ñÈÉ®Áõ¥Êé•Ë∞ÉÁî®Ë£ÖÈ•∞ËÄÖÁöÑÊñπÊ≥ïÔºåË£ÖÈ•∞ËÄÖÂú®ËøõË°åÊñπÊ≥ïÊãìÂ±ïÂêé‰ºöË∞ÉÁî®Ë¢´Ë£ÖÈ•∞ËÄÖÁöÑÁõ∏Â∫îÊñπÊ≥ï„ÄÇ ÂëΩÂêçÊúÄÂ•Ω‰ª• XxxDirector ÁöÑÊñπÂºèÔºåÊñπÊ≥ïÊ≤°ÊúâÁâπÂà´ÁöÑÂëΩÂêçÔºå‰∏éË¢´Ë£ÖÈ•∞ÂØπË±°Áõ∏ÂÖ≥„ÄÇ Â§ñËßÇÊ®°ÂºèÈöæÂ∫¶Ôºö1 È¢ëÁéáÔºö5 Â§ñËßÇÊ®°Âºè(Facade)Ôºö‰∏∫Â≠êÁ≥ªÁªü‰∏≠ÁöÑ‰∏ÄÁªÑÊé•Âè£Êèê‰æõ‰∏Ä‰∏™Áªü‰∏ÄÁöÑÂÖ•Âè£„ÄÇÂ§ñËßÇÊ®°ÂºèÂÆö‰πâ‰∫Ü‰∏Ä‰∏™È´òÂ±ÇÊé•Âè£ÔºåËøô‰∏™Êé•Âè£‰ΩøÂæóËøô‰∏ÄÂ≠êÁ≥ªÁªüÊõ¥Âä†ÂÆπÊòì‰ΩøÁî®„ÄÇ Â§ñËßÇÊ®°Âºè‰∏≠Ôºå‰∏Ä‰∏™Â≠êÁ≥ªÁªüÁöÑÂ§ñÈÉ®‰∏éÂÖ∂ÂÜÖÈÉ®ÁöÑÈÄö‰ø°ÈÄöËøá‰∏Ä‰∏™Áªü‰∏ÄÁöÑÂ§ñËßÇÁ±ªËøõË°åÔºåÂ§ñËßÇÁ±ªÂ∞ÜÂÆ¢Êà∑Á±ª‰∏éÂ≠êÁ≥ªÁªüÁöÑÂÜÖÈÉ®Â§çÊùÇÊÄßÂàÜÈöîÂºÄÔºå‰ΩøÂæóÂÆ¢Êà∑Á±ªÂè™ÈúÄË¶Å‰∏éÂ§ñËßÇËßíËâ≤Êâì‰∫§ÈÅìÔºåËÄå‰∏çÈúÄË¶Å‰∏éÂ≠êÁ≥ªÁªüÂÜÖÈÉ®ÁöÑÂæàÂ§öÂØπË±°Êâì‰∫§ÈÅì„ÄÇ Â§ñËßÇÊ®°ÂºèÁöÑ‰∏ªË¶ÅÁõÆÁöÑÂú®‰∫éÈôç‰ΩéÁ≥ªÁªüÁöÑÂ§çÊùÇÁ®ãÂ∫¶ÔºåÂú®Èù¢ÂêëÂØπË±°ËΩØ‰ª∂Á≥ªÁªü‰∏≠ÔºåÁ±ª‰∏éÁ±ª‰πãÈó¥ÁöÑÂÖ≥Á≥ªË∂äÂ§öÔºå‰∏çËÉΩË°®Á§∫Á≥ªÁªüËÆæËÆ°ÂæóË∂äÂ•ΩÔºåÂèçËÄåË°®Á§∫Á≥ªÁªü‰∏≠Á±ª‰πãÈó¥ÁöÑËÄ¶ÂêàÂ∫¶Â§™Â§ßÔºåËøôÊ†∑ÁöÑÁ≥ªÁªüÂú®Áª¥Êä§Âíå‰øÆÊîπÊó∂ÈÉΩÁº∫‰πèÁÅµÊ¥ªÊÄßÔºåÂõ†‰∏∫‰∏Ä‰∏™Á±ªÁöÑÊîπÂä®‰ºöÂØºËá¥Â§ö‰∏™Á±ªÂèëÁîüÂèòÂåñÔºåËÄåÂ§ñËßÇÊ®°ÂºèÁöÑÂºïÂÖ•Âú®ÂæàÂ§ßÁ®ãÂ∫¶‰∏äÈôç‰Ωé‰∫ÜÁ±ª‰∏éÁ±ª‰πãÈó¥ÁöÑËÄ¶ÂêàÂÖ≥Á≥ª„ÄÇ ÁªìÊûÑ Client ‰∏çÂíå SubSystem Áõ¥Êé•Êé•Ëß¶ÔºåËÄåÊòØÈÄöËøá‰∏Ä‰∏™‰∏≠Èó¥Â±Ç Facade ‰∫§‰∫í„ÄÇ Âú®Ê†áÂáÜÁöÑÂ§ñËßÇÊ®°ÂºèÁªìÊûÑÂõæ‰∏≠ÔºåÂ¶ÇÊûúÈúÄË¶ÅÂ¢ûÂä†„ÄÅÂà†Èô§ÊàñÊõ¥Êç¢‰∏éÂ§ñËßÇÁ±ª‰∫§‰∫íÁöÑÂ≠êÁ≥ªÁªüÁ±ªÔºåÂøÖÈ°ª‰øÆÊîπÂ§ñËßÇÁ±ªÊàñÂÆ¢Êà∑Á´ØÁöÑÊ∫ê‰ª£Á†ÅÔºåËøôÂ∞ÜËøùËÉåÂºÄÈó≠ÂéüÂàôÔºåÂõ†Ê≠§ÂèØ‰ª•ÈÄöËøáÂºïÂÖ•ÊäΩË±°Â§ñËßÇÁ±ªÊù•ÂØπÁ≥ªÁªüËøõË°åÊîπËøõÔºåÂú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÂèØ‰ª•Ëß£ÂÜ≥ËØ•ÈóÆÈ¢ò„ÄÇÂú®ÂºïÂÖ•ÊäΩË±°Â§ñËßÇÁ±ª‰πãÂêéÔºåÂÆ¢Êà∑Á´ØÂèØ‰ª•ÈíàÂØπÊäΩË±°Â§ñËßÇÁ±ªËøõË°åÁºñÁ®ãÔºåÂØπ‰∫éÊñ∞ÁöÑ‰∏öÂä°ÈúÄÊ±ÇÔºå‰∏çÈúÄË¶Å‰øÆÊîπÂéüÊúâÂ§ñËßÇÁ±ªÔºåËÄåÂØπÂ∫îÂ¢ûÂä†‰∏Ä‰∏™Êñ∞ÁöÑÂÖ∑‰ΩìÂ§ñËßÇÁ±ªÔºåÁî±Êñ∞ÁöÑÂÖ∑‰ΩìÂ§ñËßÇÁ±ªÊù•ÂÖ≥ËÅîÊñ∞ÁöÑÂ≠êÁ≥ªÁªüÂØπË±°ÔºåÂêåÊó∂ÈÄöËøá‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂Êù•ËææÂà∞‰∏ç‰øÆÊîπ‰ªª‰ΩïÊ∫ê‰ª£Á†ÅÂπ∂Êõ¥Êç¢Â§ñËßÇÁ±ªÁöÑÁõÆÁöÑ„ÄÇ ‰æãÂ≠ê ‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠Êèê‰æõ‰∫Ü‰∏§‰∏™Â≠êÁ≥ªÁªüÁ±ªÔºåÂÆÉ‰ª¨ÁöÑ cipher ÊòØ‰∏çÂêåÁöÑ„ÄÇClient Âè™Ë¶ÅË∞ÉÁî® FileEncrypt() Âç≥ÂèØÔºå‰∏çÈúÄË¶ÅÂÜçÂíå FileReader,FileWriter,CipherMachine ËÄ¶Âêà‰∫Ü„ÄÇ ÂëΩÂêçÊúÄÂ•Ω‰∏∫ XxxFacadeÔºåÊñπÊ≥ïÊ≤°ÊúâÁâπÂà´ÁöÑÂëΩÂêçÔºå‰∏éË¢´Ë∞ÉÁî®ÊñπÊ≥ïÁõ∏ÂÖ≥ ÂÖ∂ÂÆûÂ∞±ÊòØÂéüÊú¨‰∏Ä‰∏™ÊñπÊ≥ï‰∏≠Ë¶ÅË∞ÉÁî®Â•ΩÂá†‰∏™Á±ªÁöÑÂ•ΩÂá†‰∏™ÊñπÊ≥ïÔºåÁé∞Âú®Â∞±ÊääËøô‰∏™ÊñπÊ≥ïÊãøÂá∫ÂéªÔºå‰Ωú‰∏∫Â§ñËßÇÁ±ªÁöÑ‰∏Ä‰∏™ÊñπÊ≥ï‰∫Ü„ÄÇ ‰ª£ÁêÜÊ®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö4 ‰ª£ÁêÜÊ®°ÂºèÔºöÁªôÊüê‰∏Ä‰∏™ÂØπË±°Êèê‰æõ‰∏Ä‰∏™‰ª£ÁêÜÊàñÂç†‰ΩçÁ¨¶ÔºåÂπ∂Áî±‰ª£ÁêÜÂØπË±°Êù•ÊéßÂà∂ÂØπÂéüÂØπË±°ÁöÑËÆøÈóÆ„ÄÇ Âú®‰ª£ÁêÜÊ®°Âºè‰∏≠ÂºïÂÖ•‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑ‰ª£ÁêÜÂØπË±°Ôºå‰ª£ÁêÜÂØπË±°Âú®ÂÆ¢Êà∑Á´ØÂØπË±°ÂíåÁõÆÊ†áÂØπË±°‰πãÈó¥Ëµ∑Âà∞‰∏≠‰ªãÁöÑ‰ΩúÁî®ÔºåÂÆÉÂéªÊéâÂÆ¢Êà∑‰∏çËÉΩÁúãÂà∞ÁöÑÂÜÖÂÆπÂíåÊúçÂä°ÊàñËÄÖÂ¢ûÊ∑ªÂÆ¢Êà∑ÈúÄË¶ÅÁöÑÈ¢ùÂ§ñÁöÑÊñ∞ÊúçÂä°„ÄÇ ÁªìÊûÑ ÊäΩË±°‰∏ªÈ¢òËßíËâ≤ Subject ‰∏≠Êúâ‰∏Ä‰∏™ÊñπÊ≥ï request()Ôºå‰ª£ÁêÜ‰∏ªÈ¢òËßíËâ≤ Proxy ÂíåÁúüÂÆû‰∏ªÈ¢òËßíËâ≤ RealSubject ÈÉΩÂÆûÁé∞‰∫ÜÂÖ∂ÊñπÊ≥ï„ÄÇProxy ‰ºöËá™Â∑±ÂàõÂª∫ RealSubject ÁöÑÂÆû‰æãÔºåÂÖ∂ request() ÊñπÊ≥ï‰∏≠Ôºå‰∏ç‰ªÖË∞ÉÁî® RealSubject ÁöÑÁõ∏Â∫îÊñπÊ≥ïÔºåËøòÂú®ÂÖ∂ÂâçÂêéÂêÑÂä†‰∏äËá™Â∑±ÁöÑÊñπÊ≥ï PreRequest() ‰ª•Âèä PostRequest()„ÄÇÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑÂä®ÊÄÅÊõøÊç¢‰ª£ÁêÜ‰∏ªÈ¢òÁ±ªÂêç„ÄÇ ÂëΩÂêçÊúÄÂ•Ω‰∏∫ XxxProxyÔºåÊñπÊ≥ïÊ≤°ÊúâÁâπÂà´ÁöÑÂëΩÂêçÔºå‰∏éË¢´‰ª£ÁêÜÂØπË±°Áõ∏ÂÖ≥„ÄÇ Ë£ÖÈ•∞Âô®Ê®°ÂºèÂíå‰ª£ÁêÜÊ®°ÂºèÂíåÂ§ñËßÇÊ®°ÂºèÁöÑÂå∫Âà´Ë£ÖÈ•∞Âô®Ê®°ÂºèÂÖ≥Ê≥®‰∫éÂú®‰∏Ä‰∏™ÂØπË±°‰∏äÂä®ÊÄÅÁöÑÊ∑ªÂä†ÊñπÊ≥ïÔºåÂΩìÊàë‰ª¨‰ΩøÁî®Ë£ÖÈ•∞Âô®Ê®°ÂºèÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÈÄöÂ∏∏ÁöÑÂÅöÊ≥ïÊòØÂ∞ÜÂéüÂßãÂØπË±°‰Ωú‰∏∫‰∏Ä‰∏™ÂèÇÊï∞‰º†ÁªôË£ÖÈ•∞ËÄÖÁöÑÊûÑÈÄ†Âô®„ÄÇË£ÖÈ•∞ËÄÖËÉΩÂ§üÂú®ËøêË°åÊó∂ÈÄíÂΩíÂú∞Ë¢´ÊûÑÈÄ†„ÄÇ ÁÑ∂ËÄå‰ª£ÁêÜÊ®°ÂºèÂÖ≥Ê≥®‰∫éÊéßÂà∂ÂØπÂØπË±°ÁöÑËÆøÈóÆ„ÄÇÂØπ‰ΩøÁî®ËÄÖÊù•ËØ¥Ôºå‰ª£ÁêÜÁ±ªÂ∞±ÊòØ‰Ω†Ë¶ÅÁî®ÁöÑÈÇ£‰∏™ÂØπË±°„ÄÇÂõ†Ê≠§ÔºåÂΩì‰ΩøÁî®‰ª£ÁêÜÊ®°ÂºèÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Â∏∏Â∏∏Âú®‰∏Ä‰∏™‰ª£ÁêÜÁ±ª‰∏≠Ëá™Â∑±ÂàõÂª∫‰∏Ä‰∏™ÂØπË±°ÁöÑÂÆû‰æã„ÄÇ‰ª£ÁêÜÂíåÁúüÂÆûÂØπË±°‰πãÈó¥ÁöÑÁöÑÂÖ≥Á≥ªÈÄöÂ∏∏Âú®ÁºñËØëÊó∂Â∞±Â∑≤ÁªèÁ°ÆÂÆö‰∫Ü Â§ñËßÇÊ®°ÂºèÁî®Êù•Â∞ÅË£ÖÂ≠êÁ≥ªÁªüÁöÑÊñπÊ≥ïÔºåÈöêËóèÂ≠êÁ≥ªÁªüÈó¥ÁöÑÈÄö‰ø°Âíå‰æùËµñÂÖ≥Á≥ª„ÄÇÂÖ∂ÂÆûÂ§ñËßÇÊòØ‰ΩøÁî®ÊúÄÂπøÁöÑÔºåÊòØ‰∏™ÊñπÊ≥ïÈÉΩËÉΩÊäΩÂá∫Êù•ÂÅöÊàêÂ§ñËßÇÊ®°ÂºèÔºåÂè™‰∏çËøá‰∏ÄËà¨Êé•Âè£Ê≤°ÊúâÂ§çÁî®ÈúÄÊ±ÇÁöÑËØùÊ≤°ÂøÖË¶ÅÁΩ¢‰∫Ü„ÄÇ ÂçÅ‰∏Ä‰∏™Ë°å‰∏∫ÂûãÊ®°ÂºèË°å‰∏∫ÂûãÊ®°Âºè‰∏ªË¶ÅÁî®‰∫éÊèèËø∞ÊñπÊ≥ïÊòØÂ¶Ç‰ΩïÊâßË°åÁöÑ ËÅåË¥£ÈìæÊ®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö2 ËÅåË¥£ÈìæÊ®°ÂºèÔºöÈÅøÂÖçËØ∑Ê±ÇÂèëÈÄÅËÄÖ‰∏éÊé•Êî∂ËÄÖËÄ¶ÂêàÂú®‰∏ÄËµ∑ÔºåËÆ©Â§ö‰∏™ÂØπË±°ÈÉΩÊúâÂèØËÉΩÊé•Êî∂ËØ∑Ê±ÇÔºåÂ∞ÜËøô‰∫õÂØπË±°ËøûÊé•Êàê‰∏ÄÊù°ÈìæÔºåÂπ∂‰∏îÊ≤øÁùÄËøôÊù°Èìæ‰º†ÈÄíËØ∑Ê±ÇÔºåÁõ¥Âà∞ÊúâÂØπË±°Â§ÑÁêÜÂÆÉ‰∏∫Ê≠¢„ÄÇ Êàë‰ª¨ÁªèÂ∏∏‰ºöÂÜôÂá∫ÂæàÈïøÁöÑ if‚Ä¶else Êù•ÂàÜÂà´Â§ÑÁêÜ‰∏çÂêåÁöÑÊÉÖÂÜµ„ÄÇ‰æãÂ¶Ç 12345678910111213141516if (request.getAmount() &lt; 50000) &#123; //‰∏ª‰ªªÂèØÂÆ°ÊâπËØ•ÈááË¥≠Âçï this.handleByDirector(request); &#125; else if (request.getAmount() &lt; 100000) &#123; //ÂâØËë£‰∫ãÈïøÂèØÂÆ°ÊâπËØ•ÈááË¥≠Âçï this.handleByVicePresident(request); &#125; else if (request.getAmount() &lt; 500000) &#123; //Ëë£‰∫ãÈïøÂèØÂÆ°ÊâπËØ•ÈááË¥≠Âçï this.handleByPresident(request); &#125; else &#123; //Ëë£‰∫ã‰ºöÂèØÂÆ°ÊâπËØ•ÈááË¥≠Âçï this.handleByCongress(request); &#125; ËøôÊ†∑ÂêÑ‰∏™ÊñπÊ≥ïÈÉΩÂá†ÁßçÂú®‰∏Ä‰∏™Á±ª‰∏≠ÔºåËøùÂèç‰∫ÜÂçï‰∏ÄËÅåË¥£ÂéüÂàô„ÄÇÂπ∂‰∏îÊúâ if‚Ä¶else ÁöÑÂú∞ÊñπÂü∫Êú¨ÈÉΩÊòØËøùÂèçÂºÄÈó≠ÂéüÂàôÁöÑ„ÄÇÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®ËÅåË¥£ÈìæÊ®°Âºè‰øÆÊîπ„ÄÇ ÁªìÊûÑ ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÊäΩË±°Â§ÑÁêÜËÄÖhandler ÔºåÂÆÉÊúâ‰∏Ä‰∏™ successor Â±ûÊÄßÔºåÁî®Êù•Ê†áËØÜË∞ÅÊòØÂìçÂ∫îÈìæÁöÑ‰∏ã‰∏ÄÁ∫ß„ÄÇ handler ËøòÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÊäΩË±°Â§ÑÁêÜÊñπÊ≥ï handleRequest()ÔºåÊØè‰∏Ä‰∏™ÂÖ∑‰ΩìÂ§ÑÁêÜËÄÖ concreteHandler ÁªßÊâøËØ•ÊñπÊ≥ïÈÉΩ‰ºöÂÖàÂà§Êñ≠Ëá™Â∑±ËÉΩÂê¶Â§ÑÁêÜÔºåÂ¶ÇÊûúËÉΩÂ∞±Ëµ∞Ëá™Â∑±ÁöÑÂÆûÁé∞ÈÄªËæëÔºåÂ¶ÇÊûú‰∏çËÉΩÂ∞±Ë∞ÉÁî® successor.handleRequest() „ÄÇ ËÅåË¥£ÈìæÊ®°ÂºèÂπ∂‰∏çÂàõÂª∫ËÅåË¥£ÈìæÔºåËÅåË¥£ÈìæÁöÑÂàõÂª∫Â∑•‰ΩúÂøÖÈ°ªÁî±Á≥ªÁªüÁöÑÂÖ∂‰ªñÈÉ®ÂàÜÊù•ÂÆåÊàêÔºå‰∏ÄËà¨ÊòØÂú®‰ΩøÁî®ËØ•ËÅåË¥£ÈìæÁöÑÂÆ¢Êà∑Á´Ø‰∏≠ÂàõÂª∫ËÅåË¥£Èìæ„ÄÇËÅåË¥£ÈìæÊ®°ÂºèÈôç‰Ωé‰∫ÜËØ∑Ê±ÇÁöÑÂèëÈÄÅÁ´ØÂíåÊé•Êî∂Á´Ø‰πãÈó¥ÁöÑËÄ¶ÂêàÔºå‰ΩøÂ§ö‰∏™ÂØπË±°ÈÉΩÊúâÊú∫‰ºöÂ§ÑÁêÜËøô‰∏™ËØ∑Ê±Ç„ÄÇ ‰æãÂ≠ê ‰∏äÂõæ‰∏≠ Approver ÊòØÊäΩË±°Â§ÑÁêÜËÄÖÔºåsuccessor ÁöÑÁ±ªÂûãÊòØËá™Â∑±Êú¨Ë∫´ÔºåÁî®Êù•Ê†áËÆ∞Â§ÑÁêÜÈìæ‰∏≠ÁöÑ‰∏ã‰∏ÄÁ∫ßÂ§ÑÁêÜËÄÖ„ÄÇprocessRequest() ÊñπÊ≥ïÁî®Êù•Â§ÑÁêÜÂÖ∑‰ΩìÁöÑ‰∫ã‰ª∂ÔºåÊé•Êî∂‰∏Ä‰∏™ PurchaseRequest ÂØπË±°ÔºåËøôÊòØ‰∏Ä‰∏™ÂÖ∑‰ΩìË¶ÅÂ§ÑÁêÜÁöÑ‰∫ã‰ª∂„ÄÇÁÑ∂ÂêéÂ∞±ÊòØÂêÑ‰∏™ÂÖ∑‰ΩìÂ§ÑÁêÜËÄÖ„ÄÇ‰ªñ‰ª¨‰ºöÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôËÆæÁΩÆÂ•ΩÂ§ÑÁêÜÂ±ÇÁ∫ß„ÄÇ ÊâÄÊúâË¥£‰ªªÈìæÁöÑÂØπË±°ÈÉΩÁªßÊâø‰∫éÁªü‰∏ÄÁöÑÂü∫Á±ªÔºåÂõ†‰∏∫Ë¶ÅÁªßÊâøÂú®Âü∫Á±ª‰∏≠Êèê‰æõÁöÑ successor„ÄÇ ÂëΩÂêçÊúÄÂ•ΩÂú®Âü∫Á±ª‰∏≠Â∞ÜÂ±ûÊÄßÂÆö‰πâ‰∏∫ successor ÊàñËÄÖ next Ë¥£‰ªªÈìæÊ®°ÂºèÁî®Âú®ÂêåÁ±ªÂûãÁöÑ‰∏≤Ë°åÂ§ÑÁêÜÔºåÊØîÂ¶ÇÁΩëÁªúËØ∑Ê±ÇÔºåÂ∞±ÂèØ‰ª•Êèê‰æõ‰∏Ä‰∏™ successorÔºå‰øùÂ≠ò‰∏ã‰∏ÄÁ∫ßËØ∑Ê±Ç„ÄÇÂÜçÊØîÂ¶ÇÊú¨‰æãÔºåÂêÑ‰∏™Â§ÑÁêÜËÄÖÂÖ∂ÂÆûÈÉΩÊòØÂêåÁ∫ßÁöÑÔºå‰ªñ‰ª¨Áõ∏Â∫îÁöÑÂ§ÑÁêÜÊñπÊ≥ïÈÉΩ‰ºöÊâßË°åÂà∞„ÄÇ ÂëΩ‰ª§Ê®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö4 ÂëΩ‰ª§Ê®°ÂºèÔºöÂ∞Ü‰∏Ä‰∏™ËØ∑Ê±ÇÂ∞ÅË£Ö‰∏∫‰∏Ä‰∏™ÂØπË±°Ôºå‰ªéËÄåËÆ©Êàë‰ª¨ÂèØÁî®‰∏çÂêåÁöÑËØ∑Ê±ÇÂØπÂÆ¢Êà∑ËøõË°åÂèÇÊï∞ÂåñÔºõÂØπËØ∑Ê±ÇÊéíÈòüÊàñËÄÖËÆ∞ÂΩïËØ∑Ê±ÇÊó•ÂøóÔºå‰ª•ÂèäÊîØÊåÅÂèØÊí§ÈîÄÁöÑÊìç‰Ωú„ÄÇÂëΩ‰ª§Ê®°ÂºèÂà´Âêç‰∏∫Âä®‰Ωú(Action)Ê®°ÂºèÊàñ‰∫ãÂä°(Transaction)Ê®°Âºè„ÄÇ ÂëΩ‰ª§Ê®°ÂºèÂ∞ÜËØ∑Ê±ÇÂèëÈÄÅËÄÖÂíåÊâßË°åËÄÖËß£ËÄ¶„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÂëΩ‰ª§Ê®°ÂºèÔºåÈÇ£‰πàËØ∑Ê±ÇÂèëÈÄÅËÄÖÂíåÊâßË°åËÄÖÊòØËÄ¶ÂêàÂú®‰∏ÄËµ∑ÁöÑ„ÄÇÈÇ£‰πàÂ∞±ÂÉèÂºÄÂÖ≥‰∏ÄÊ†∑Ôºå‰∏Ä‰∏™ÂºÄÂÖ≥Âè™ËÉΩÊéßÂà∂‰∏Ä‰∏™ÁîµÂô®Ôºå‰∏çËÉΩÊõ¥Êç¢ÁîµÂô®Ôºå‰∏îÂ¢ûÂä†ÁîµÂô®ÁöÑÊó∂ÂÄôÂøÖÈ°ªË¶ÅÂ¢ûÂä†ÂºÄÂÖ≥„ÄÇ ÂëΩ‰ª§Ê®°ÂºèÁöÑÊú¨Ë¥®ÊòØÂØπËØ∑Ê±ÇËøõË°åÂ∞ÅË£ÖÔºå‰∏Ä‰∏™ËØ∑Ê±ÇÂØπÂ∫î‰∫é‰∏Ä‰∏™ÂëΩ‰ª§ÔºåÂ∞ÜÂèëÂá∫ÂëΩ‰ª§ÁöÑË¥£‰ªªÂíåÊâßË°åÂëΩ‰ª§ÁöÑË¥£‰ªªÂàÜÂâ≤ÂºÄ„ÄÇÊØè‰∏Ä‰∏™ÂëΩ‰ª§ÈÉΩÊòØ‰∏Ä‰∏™Êìç‰ΩúÔºöËØ∑Ê±ÇÁöÑ‰∏ÄÊñπÂèëÂá∫ËØ∑Ê±ÇË¶ÅÊ±ÇÊâßË°å‰∏Ä‰∏™Êìç‰ΩúÔºõÊé•Êî∂ÁöÑ‰∏ÄÊñπÊî∂Âà∞ËØ∑Ê±ÇÔºåÂπ∂ÊâßË°åÁõ∏Â∫îÁöÑÊìç‰Ωú„ÄÇÂëΩ‰ª§Ê®°ÂºèÂÖÅËÆ∏ËØ∑Ê±ÇÁöÑ‰∏ÄÊñπÂíåÊé•Êî∂ÁöÑ‰∏ÄÊñπÁã¨Á´ãÂºÄÊù•Ôºå‰ΩøÂæóËØ∑Ê±ÇÁöÑ‰∏ÄÊñπ‰∏çÂøÖÁü•ÈÅìÊé•Êî∂ËØ∑Ê±ÇÁöÑ‰∏ÄÊñπÁöÑÊé•Âè£ÔºåÊõ¥‰∏çÂøÖÁü•ÈÅìËØ∑Ê±ÇÂ¶Ç‰ΩïË¢´Êé•Êî∂„ÄÅÊìç‰ΩúÊòØÂê¶Ë¢´ÊâßË°å„ÄÅ‰ΩïÊó∂Ë¢´ÊâßË°åÔºå‰ª•ÂèäÊòØÊÄé‰πàË¢´ÊâßË°åÁöÑ„ÄÇ ÂëΩ‰ª§Ê®°ÂºèÁöÑÂÖ≥ÈîÆÂú®‰∫éÂºïÂÖ•‰∫ÜÊäΩË±°ÂëΩ‰ª§Á±ªÔºåËØ∑Ê±ÇÂèëÈÄÅËÄÖÈíàÂØπÊäΩË±°ÂëΩ‰ª§Á±ªÁºñÁ®ãÔºåÂè™ÊúâÂÆûÁé∞‰∫ÜÊäΩË±°ÂëΩ‰ª§Á±ªÁöÑÂÖ∑‰ΩìÂëΩ‰ª§Êâç‰∏éËØ∑Ê±ÇÊé•Êî∂ËÄÖÁõ∏ÂÖ≥ËÅî„ÄÇ ÁªìÊûÑ Ë∞ÉÁî®ËÄÖ Invoker ‰∏≠Êúâ‰∏Ä‰∏™ÊäΩË±°ÂëΩ‰ª§Á±ª Command ÁöÑÂÆû‰æã„ÄÇInvoker ‰∏çÁõ¥Êé•Ë∞ÉÁî®Êé•ÂèóËÄÖ Receiver ÁöÑÊñπÊ≥ïÔºåËÄåÊòØÂú®Ëøô‰∏™ Command ÁöÑ execute() ÊñπÊ≥ïÈáåË∞ÉÁî®„ÄÇÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑÁöÑÊñπÂºèÂä®ÊÄÅÂàõÂª∫ ConcreteCommand ÂÆû‰æãÔºåÊù•ÂÜ≥ÂÆö Invoker ÊúÄÁªàË∞ÉÁî®ÁöÑÊòØÈÇ£‰∏™ ReceiverÔºåÂÆåÊàê‰∫Ü‰∏§ËÄÖÈó¥ÁöÑËß£ËÄ¶„ÄÇ ‰æãÂ≠ê Ëøô‰∏™‰æãÂ≠êÁöÑÂú∫ÊôØÊòØÊéßÂà∂Êüê‰∏Ä‰∏™ÊåâÈíÆ FunctionButton ÁöÑÂäüËÉΩ„ÄÇFunctionButton Âπ∂‰∏çÁõ¥Êé•ÊéßÂà∂Á©∂Á´üÊòØÊâßË°å WindowHandler ËøòÊòØ HelpHandler„ÄÇÂÆÉÂÜÖÈÉ®Â≠òÊúâ‰∏Ä‰∏™ commandÔºåËøô‰∏™ command Ê†πÊçÆÂèçÂ∞ÑÂÜ≥ÂÆöÁ©∂Á´üÊòØ MinimizeCommand ËøòÊòØ HelpCommand ÂÆû‰æã„ÄÇÊúÄÂêéË∞ÉÁî®ÂÖ∂ÂÆûÁé∞ÁöÑ execute() ÊñπÊ≥ï„ÄÇ Command Á±ª‰∏≠ÂèØ‰ª•Ê∑ªÂä†Ëá™Â∑±ÁöÑÂ±ûÊÄß„ÄÇ‰Ω†ÂèØ‰ª•Âú® execute ÊñπÊ≥ïÂâçÂêéÊ∑ªÂä†Ëá™Â∑±ÁöÑÊñπÊ≥ïÔºåÂ¶ÇÊûúË∞ÉÁî®ËÄÖË¶ÅÁõëÊéßÂëΩ‰ª§ÁöÑÊâßË°åÊÉÖÂÜµÔºåÂèØ‰ª•Âú® command ‰∏≠ËÆæÁΩÆ‰∏Ä‰∏™ delegateÔºåÊèê‰æõ command:didRequestXXXWithXXX: ‰ª•Âèä command:didFinishXXX: ÊñπÊ≥ï„ÄÇ ÂëΩÂêçÊúÄÂ•Ω‰∏∫ XxxCommand ‰ª•Âèä execute: ÁöÑÂΩ¢ÂºèÔºå‰ª£ÁêÜÂëΩÂêç‰∏∫ XxxCommandDelegate Ôºå‰ª£ÁêÜÊñπÊ≥ïÂëΩÂêç‰∏∫ command:didRequestXXXWithXXX: ‰ª•Âèä command:didFinishXXX: ÂÖ∂ÂÆûÂ∞±ÊòØÂä†‰∏™‰∏≠Èó¥Â±ÇÔºåËÆ©Ë∞ÉÁî®ÂíåÂÆûÁé∞ÂàÜÁ¶ª ÂëΩ‰ª§Ê®°ÂºèÁöÑÊí§ÈîÄÂëΩ‰ª§Ê®°ÂºèÁöÑ‰∏Ä‰∏™Â∫îÁî®ÊòØÂú®Â∞ÅË£ÖÂëΩ‰ª§ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•Ê∑ªÂä†‰∏Ä‰∫õÊí§ÈîÄÂíå‰øùÂ≠òÁä∂ÊÄÅ„ÄÇiOS ‰∏≠Êèê‰æõ‰∫Ü NSUndoManager Êù•ÂÆûÁé∞Ëøô‰∏™Êí§ÈîÄÂíåÊÅ¢Â§çÁöÑËøáÁ®ã„ÄÇ Ëø≠‰ª£Âô®Ê®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö5 Ëø≠‰ª£Âô®Ê®°ÂºèÔºöÊèê‰æõ‰∏ÄÁßçÊñπÊ≥ïÊù•ËÆøÈóÆËÅöÂêàÂØπË±°ÔºåËÄå‰∏çÁî®Êö¥Èú≤Ëøô‰∏™ÂØπË±°ÁöÑÂÜÖÈÉ®Ë°®Á§∫ÔºåÂÖ∂Âà´Âêç‰∏∫Ê∏∏Ê†á(Cursor)„ÄÇ Âú®ËΩØ‰ª∂ÂºÄÂèë‰∏≠ÔºåÊàë‰ª¨ÁªèÂ∏∏ÈúÄË¶Å‰ΩøÁî®ËÅöÂêàÂØπË±°Êù•Â≠òÂÇ®‰∏ÄÁ≥ªÂàóÊï∞ÊçÆ„ÄÇËÅöÂêàÂØπË±°Êã•Êúâ‰∏§‰∏™ËÅåË¥£Ôºö‰∏ÄÊòØÂ≠òÂÇ®Êï∞ÊçÆÔºõ‰∫åÊòØÈÅçÂéÜÊï∞ÊçÆ„ÄÇ‰ªé‰æùËµñÊÄßÊù•ÁúãÔºåÂâçËÄÖÊòØËÅöÂêàÂØπË±°ÁöÑÂü∫Êú¨ËÅåË¥£ÔºõËÄåÂêéËÄÖÊó¢ÊòØÂèØÂèòÂåñÁöÑÔºåÂèàÊòØÂèØÂàÜÁ¶ªÁöÑ„ÄÇÂõ†Ê≠§ÔºåÂèØ‰ª•Â∞ÜÈÅçÂéÜÊï∞ÊçÆÁöÑË°å‰∏∫‰ªéËÅöÂêàÂØπË±°‰∏≠ÂàÜÁ¶ªÂá∫Êù•ÔºåÂ∞ÅË£ÖÂú®‰∏Ä‰∏™Ë¢´Áß∞‰πã‰∏∫‚ÄúËø≠‰ª£Âô®‚ÄùÁöÑÂØπË±°‰∏≠ÔºåÁî±Ëø≠‰ª£Âô®Êù•Êèê‰æõÈÅçÂéÜËÅöÂêàÂØπË±°ÂÜÖÈÉ®Êï∞ÊçÆÁöÑË°å‰∏∫ÔºåËøôÂ∞ÜÁÆÄÂåñËÅöÂêàÂØπË±°ÁöÑËÆæËÆ°ÔºåÊõ¥Á¨¶Âêà‚ÄúÂçï‰∏ÄËÅåË¥£ÂéüÂàô‚ÄùÁöÑË¶ÅÊ±Ç„ÄÇ ÁªìÊûÑ ËÅöÂêàÁ±ª ConcreteAggregate ‰∏≠Êúâ‰∏Ä‰∏™ÂàóË°®Â±ûÊÄßÔºåÂêåÊó∂ËøòÊèê‰æõ‰∫Ü‰∏Ä‰∏™ createIterator() ÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ï‰ºöÂ∞ÜÂÖ∂ÂàóË°®Â±ûÊÄß‰º†ÂÖ•ÔºåÂπ∂ËøîÂõû‰∏Ä‰∏™ÂÖ∑‰ΩìËø≠‰ª£Âô®ÂØπË±° ConcreteIterator„ÄÇConcreteIterator ‰∏≠‰øùÂ≠ò‰∏Ä‰∏™ÂàóË°®ÔºåÂêåÊó∂ËøòÊúâ‰∏Ä‰∏™ÁßÅÊúâÁöÑÊ∏∏Ê†á cursor Áî®Êù•Ê†áËØÜËø≠‰ª£Âà∞ÁöÑÂΩìÂâçÂÄºÔºåÂπ∂Êèê‰æõ first(),next() Á≠âÊñπÊ≥ïËøõË°åËø≠‰ª£„ÄÇ ‰æãÂ≠ê Ëøô‰∏™‰æãÂ≠êÂíå‰∏äÈù¢ËØ¥ÁöÑÂü∫Êú¨Á±ª‰ººÔºåProductList ‰∏≠Êúâ‰∏Ä‰∏™Êï∞ÁªÑÔºåËøòÊèê‰æõ createIterator() ÊñπÊ≥ïÂàõÂª∫Ëø≠‰ª£Âô® ProductIteratorÔºåÂπ∂Â∞ÜÊï∞ÁªÑËÆæÁΩÆÁªôËø≠‰ª£Âô®ÁöÑ productList Â±ûÊÄß‰∏≠„ÄÇËø≠‰ª£Âô®Êèê‰æõ‰∫Ü‰∏§‰∏™Ê∏∏Ê†á cursor ÂàÜÂà´Áî®Êù•Ê≠£Â∫èÈÅçÂéÜÂíåÈÄÜÂ∫èÈÅçÂéÜ„ÄÇ Â∞±ÊòØÂú®‰∏Ä‰∏™Á±ª‰∏≠‰øùÂ≠ò‰∏Ä‰∏™Êï∞ÁªÑÔºåÁÑ∂ÂêéË∞ÉÁî®‰∏Ä‰∫õÊñπÊ≥ïÈÅçÂéÜÊï∞ÁªÑ ‰∏≠‰ªãËÄÖÊ®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö2 ‰∏≠‰ªãËÄÖÊ®°ÂºèÔºöÁî®‰∏Ä‰∏™‰∏≠‰ªãÂØπË±°Ôºà‰∏≠‰ªãËÄÖÔºâÊù•Â∞ÅË£Ö‰∏ÄÁ≥ªÂàóÁöÑÂØπË±°‰∫§‰∫íÔºå‰∏≠‰ªãËÄÖ‰ΩøÂêÑÂØπË±°‰∏çÈúÄË¶ÅÊòæÂºèÂú∞Áõ∏‰∫íÂºïÁî®Ôºå‰ªéËÄå‰ΩøÂÖ∂ËÄ¶ÂêàÊùæÊï£ÔºåËÄå‰∏îÂèØ‰ª•Áã¨Á´ãÂú∞ÊîπÂèòÂÆÉ‰ª¨‰πãÈó¥ÁöÑ‰∫§‰∫í„ÄÇ‰∏≠‰ªãËÄÖÊ®°ÂºèÂèàÁß∞‰∏∫Ë∞ÉÂÅúËÄÖÊ®°Âºè„ÄÇ ‰∏≠‰ªãËÄÖÊ®°ÂºèÊòØ‚ÄúËø™Á±≥ÁâπÊ≥ïÂàô‚ÄùÁöÑ‰∏Ä‰∏™ÂÖ∏ÂûãÂ∫îÁî®. Áº∫ÁÇπÔºö‰∏≠‰ªãËÄÖÁ±ªÂèØËÉΩÈùûÂ∏∏Â§çÊùÇÔºåÈöæ‰ª•Áª¥Êä§ ÁªìÊûÑ ‰∏≠‰ªãËÄÖÊ®°Âºè‰∏ªË¶ÅÊòØÊ∂àÈô§ËÄ¶Âêà„ÄÇÊâÄÊúâÁöÑÂÖ∑‰ΩìÂêå‰∫ãÁ±ª ConcreteColleague ÈÉΩ‰∏çËÉΩÁõ¥Êé•Áõ∏‰∫íË∞ÉÁî®ÔºåÂÆÉ‰ª¨ÂÜÖÈÉ®Êúâ‰∏Ä‰∏™‰ªé Colleague ‰∏≠ÁªßÊâøËøáÊù•ÁöÑ Mediator Â±ûÊÄßÔºåÂú®ÂàõÂª∫ÁöÑÊó∂ÂÄôËÆæÁΩÆÂÖ∑‰Ωì‰∏≠‰ªãËÄÖ ConcreteMediator„ÄÇConcreteMediator ‰∏≠Â≠òÂú®ÂêÑÁßçË∞ÉÁî®ÂÖ∑‰ΩìÂêå‰∫ãÁ±ªConcreteColleague ÁöÑÊñπÊ≥ï„ÄÇ ‰æãÂ≠ê ËøôÊòØ‰∏Ä‰∏™ÂêÑ‰∏™ÁªÑ‰ª∂Áõ∏‰∫íË∞ÉÁî®ÁöÑ‰æãÂ≠ê„ÄÇÂêå‰∏äÈù¢ÊâÄËØ¥ÁöÑ‰∏ÄÊ†∑ÔºåComponent ‰∏≠ÊúâÊäΩË±°‰∏≠‰ªãËÄÖ mediatorÔºå‰ºöÂú®ÁîüÊàêÂÖ∑‰ΩìÂêå‰∫ãÁ±ª(Âç≥ÂêÑ‰∏™ÁªÑ‰ª∂)ÁöÑÊó∂ÂÄôÔºåsetMediator() ËÆæÁΩÆÂÖ∑‰Ωì‰∏≠‰ªãËÄÖ ConcreteMediator„ÄÇÂÆÉÊèê‰æõ‰∏Ä‰∏™ componentChanged() ÊñπÊ≥ï‰æõÂÖ∑‰ΩìÂêå‰∫ãÁ±ªË∞ÉÁî®ÔºåËøô‰∏™ÊñπÊ≥ïÁî®Êù•Â§ÑÁêÜË∑≥ËΩ¨Âïä‰∫§‰∫í‰πãÁ±ªÁöÑÈÄªËæë„ÄÇComponent ‰∏≠Êèê‰æõÁöÑ change() ÊñπÊ≥ïÁî®Êù•Ë∞ÉÁî®ÂÖ∂ÂÜÖÈÉ® mediator ÁöÑ componentChanged()ÔºåÁõ∏ÂΩì‰∫éÊòØ‰∏Ä‰∏™ÂØπ‰∫é componentChanged() ÊñπÊ≥ïÁöÑÂ∞ÅË£Ö„ÄÇupdate() ÊñπÊ≥ïÊòØÂú®ÂÖ∂‰ªñÁ±ªË∞ÉÁî®‰∫Ü componentChanged() ÂêéÔºåÂΩìÂâçÁ±ªÂÅöÂá∫ÁöÑÂìçÂ∫îÊìç‰Ωú„ÄÇchange() Âíå update() ‰∏§‰∏™ÊñπÊ≥ïÈÉΩ‰∏çÊòØÂøÖÈ°ªÁöÑ„ÄÇ Â§áÂøòÂΩïÊ®°ÂºèÈöæÂ∫¶Ôºö2 È¢ëÁéáÔºö2 Â§áÂøòÂΩïÊ®°ÂºèÔºöÂú®‰∏çÁ†¥ÂùèÂ∞ÅË£ÖÁöÑÂâçÊèê‰∏ãÔºåÊçïËé∑‰∏Ä‰∏™ÂØπË±°ÁöÑÂÜÖÈÉ®Áä∂ÊÄÅÔºåÂπ∂Âú®ËØ•ÂØπË±°‰πãÂ§ñ‰øùÂ≠òËøô‰∏™Áä∂ÊÄÅÔºåËøôÊ†∑ÂèØ‰ª•Âú®‰ª•ÂêéÂ∞ÜÂØπË±°ÊÅ¢Â§çÂà∞ÂéüÂÖà‰øùÂ≠òÁöÑÁä∂ÊÄÅ„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÊèê‰æõ‰∫Ü‰∏Ä‰∏™Â§áÂøòÂΩïÁ±ªÔºåÁî®Êù•Â≠òÂÇ®ÂéÜÂè≤Áä∂ÊÄÅ„ÄÇ ÁªìÊûÑ Ë¥üË¥£‰∫∫ Caretaker ÊòØÁÆ°ÁêÜËÄÖÔºåÁî®Êù•‰øùÂ≠òÂ§áÂøòÂΩï MementoÔºå‰ΩÜÊòØ‰∏çËÉΩÂØπÂÖ∂ÂÜÖÂÆπËøõË°åÊìç‰Ωú„ÄÇCaretaker ÂèØ‰ª•Â≠òÂÇ®‰∏Ä‰∏™ÊàñÂ§ö‰∏™Â§áÂøòÂΩïÂØπË±°„ÄÇÂ§áÂøòÂΩï Memento Áî®Êù•‰øùÂ≠òÂéüÂèëÂô® Originator ÁöÑÂÜÖÈÉ®Áä∂ÊÄÅÔºåÊ†πÊçÆÂéüÂèëÂô®Êù•ÂÜ≥ÂÆö‰øùÂ≠òÂì™‰∫õÂÜÖÈÉ®Áä∂ÊÄÅ„ÄÇÂéüÂèëÂô® Originator ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÁ±ªÔºåÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™Â§áÂøòÂΩïÔºåÂπ∂Â≠òÂÇ®ÂÆÉÁöÑÂΩìÂâçÂÜÖÈÉ®Áä∂ÊÄÅÔºå‰πüÂèØ‰ª•Áî®Â§áÂøòÂΩïÊù•ÂõûÂ§çÂÖ∂ÂÜÖÈÉ®Áä∂ÊÄÅ„ÄÇ ‰æãÂ≠ê Â¶ÇÂõæÊòØ‰∏Ä‰∏™‰øùÂ≠òË±°Ê£ãË∑ØÂæÑÁöÑ‰æãÂ≠ê„ÄÇË¥üË¥£‰∫∫ MementoCaretaker ‰∏≠‰øùÂ≠ò‰∫Ü‰∏Ä‰∏™Â§áÂøòÂΩï memento„ÄÇËøôÈáåÁöÑ memento Âè™ÊòØË°®Á§∫Â§áÂøò‰∏ÄÁßçÁä∂ÊÄÅÔºåÂ¶ÇÊûú‰Ω†ÊÉ≥‰øùÂ≠òÂ§ö‰∏™Áä∂ÊÄÅÔºåÈÇ£‰πàÈúÄË¶Å‰ΩøÁî®‰∏Ä‰∏™ memento ÁöÑÊï∞ÁªÑ„ÄÇÂÆÉËøòÊèê‰æõ‰∫ÜËÆæÁΩÆÂíåËé∑Âèñ memento ÁöÑÊñπÊ≥ï getMemento() Âíå setMemento()(Áî±‰∫éÂè™ÊúâÂéüÂèëÂô® Originator ËÉΩÂ§üÂàõÂª∫Â§áÂøòÂΩï MementoÔºåÊâÄ‰ª•ËøôÈáå setMemento() ‰º†ÂÖ•ÁöÑÊòØÊ≠§‰æã‰∏≠ Chessman ÁöÑ save() ÊñπÊ≥ï)„ÄÇÂ§áÂøòÂΩïÂØπË±° ChesmanMemento ‰øùÂ≠ò‰∫ÜÂÖ∑‰ΩìÈúÄË¶ÅÂ§áÂøòÁöÑÂ±ûÊÄßÔºåËøôÈáåÊåáÂùêÊ†áx„ÄÅy„ÄÇÂéüÂèëÂô® Chessman Êèê‰æõ‰∫ÜÈúÄË¶ÅÂ§áÂøòÁöÑÁä∂ÊÄÅÂÄºÔºåÂÆÉÁöÑ save() ÊñπÊ≥ïÁî®Êù•ÂàõÂª∫Êñ∞ÁöÑÂ§áÂøòÂΩïÂØπË±° ChessmanMemento„ÄÇÂêåÊó∂ÔºåÂÆÉËøòÊèê‰æõ‰∫Ü‰∏Ä‰∏™ restore() ÊñπÊ≥ïÁî®Êù•ÊÅ¢Â§çÂéüÊù•ÁöÑÁä∂ÊÄÅ„ÄÇÁî±‰∫éÂÖ∂‰∏çÁÆ°ÁêÜ mementoÔºåÊâÄ‰ª•‰º†ÂÖ•ÁöÑÊòØ MementoCaretaker ‰∏≠‰øùÂ≠òÁöÑÂ§áÂøòÂΩï„ÄÇ 123456789101112131415public static void main(String args[]) &#123; MementoCaretaker mc = new MementoCaretaker(); Chessman chess = new Chessman("ËΩ¶",1,1); display(chess); mc.setMemento(chess.save()); //‰øùÂ≠òÁä∂ÊÄÅ chess.setY(4); display(chess); mc.setMemento(chess.save()); //‰øùÂ≠òÁä∂ÊÄÅ display(chess); chess.setX(5); display(chess); System.out.println("******ÊÇîÊ£ã******"); chess.restore(mc.getMemento()); //ÊÅ¢Â§çÁä∂ÊÄÅ display(chess);&#125; Ê≤°‰ªÄ‰πàÁâπÂà´ÁöÑÂëΩÂêçÊñπÂºèÔºåËøôÊòØ‰∏Ä‰∏™ÂæàÂü∫Á°ÄÁöÑËÆæËÆ°Ê®°Âºè„ÄÇ ÂÖ∂ÂÆûËøô‰∏™ÈÄªËæëÊ≤°ÊúâÂÜôÁöÑËøô‰πàÂ§çÊùÇ„ÄÇÂ¶ÇÊûú‰Ω†ÊÉ≥‰øùÂ≠òÂéÜÂè≤Áä∂ÊÄÅÔºå‰Ω†Â∞±ÈúÄË¶Å‰∏Ä‰∏™ÂØπË±°Âéª‰øùÂ≠òÂÆÉÔºå‰πüÂ∞±ÊòØÁÆ°ÁêÜËÄÖ Caretaker„ÄÇÈÇ£‰πàË¶Å‰øùÂ≠ò‰ªÄ‰πàÁä∂ÊÄÅÂë¢ÔºüÈÇ£Â∞±ÊäΩË±°Âá∫Êù•ÔºåÁºñÁ®ã‰∏Ä‰∏™Â§áÂøòÂΩïÁ±ª Memento Âêß„ÄÇÈÇ£‰πàËøô‰∏™Áä∂ÊÄÅÂì™ÈáåÊù•ÁöÑÂë¢ÔºüÈÇ£Âè™ÊúâÂéüÂèëÂô® Originator ËÉΩÂ§üÂàõÂª∫ÔºåÂõ†‰∏∫Âè™ÊúâÂÆÉÊâçÁü•ÈÅìÂΩìÂâçÁöÑÁä∂ÊÄÅÂïä„ÄÇ ËßÇÂØüËÄÖÊ®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö5 ËßÇÂØüËÄÖÊ®°ÂºèÔºöÂÆö‰πâÂØπË±°‰πãÈó¥ÁöÑ‰∏ÄÁßç‰∏ÄÂØπÂ§ö‰æùËµñÂÖ≥Á≥ªÔºå‰ΩøÂæóÊØèÂΩì‰∏Ä‰∏™ÂØπË±°Áä∂ÊÄÅÂèëÁîüÊîπÂèòÊó∂ÔºåÂÖ∂Áõ∏ÂÖ≥‰æùËµñÂØπË±°ÁöÜÂæóÂà∞ÈÄöÁü•Âπ∂Ë¢´Ëá™Âä®Êõ¥Êñ∞„ÄÇ ÁªìÊûÑ ÁõÆÊ†á Subject ‰∏≠‰øùÂ≠ò‰∫ÜËÆ∏Â§öËßÇÂØüËÄÖ ObserverÔºåÈÄöËøá attach() Âíå detach() ÊñπÊ≥ïÂ¢ûÂà†„ÄÇÂêåÊó∂ÔºåËøòÊèê‰æõ‰∫Ü‰∏Ä‰∏™ notify() ÁöÑÊñπÊ≥ïÔºåÂΩì Subject ËßâÂæóÁä∂ÊÄÅÂèòÂåñ‰∫ÜÔºåÈúÄË¶ÅÈÄöÁü•ËßÇÂØüËÄÖÁöÑÊó∂ÂÄôÔºå‰∏ªÂä®Ë∞ÉÁî®Ëß¶ÂèëËßÇÂØüËÄÖÁöÑÊñπÊ≥ïÔºå„ÄÇ(‰∏çÁî®ÁÆ°ÈáåÈù¢ÁöÑ subjectState Áõ∏ÂÖ≥) ‰æãÂ≠ê Ëøô‰∏™‰æãÂ≠êÁöÑËÉåÊôØÊòØ‰∏Ä‰∏™ËÅîÊú∫ÂØπÊàòÊ∏∏ÊàèÔºå‰∏Ä‰∏™Áé©ÂÆ∂Ë¢´ÊîªÂáªÂêéÔºå‰ºöÈÄöÁü•ÂÖ∂ÂÆÉÁé©ÂÆ∂„ÄÇÂÖ∂‰∏≠ÁõÆÊ†á Subject ÊòØ‰∏Ä‰∏™ÊéßÂà∂‰∏≠ÂøÉ ConcreteAllyControlCenter ÔºåÂÆÉÁªßÊâø‰∫ÜÊäΩË±°ÁõÆÊ†á AllyControlCenter ÔºåÂÆûÁé∞‰∫ÜÂÖ∂ÈÄöÁü•ÊñπÊ≥ï notifyObserver()&gt;ÂÆÉÁöÑËßÇÂØüËÄÖ Observer ÊòØÂêÑ‰∏™Áé©ÂÆ∂ Player„ÄÇÂΩìÊüê‰∏™Áé©ÂÆ∂Ë¢´ÊîªÂáªÂêéÔºå‰ºöË∞ÉÁî® beAttached ÊñπÊ≥ïÔºåÂÆÉ‰ºöË∞ÉÁî®ÊéßÂà∂‰∏≠ÂøÉÁöÑ notifyObserver() ÊñπÊ≥ïÈÄöÁü•ÂÖ∂ÂÆÉËßÇÂØüËÄÖ„ÄÇ Áä∂ÊÄÅÊ®°ÂºèÈöæÂ∫¶Ôºö3 È¢ëÁéáÔºö3 Áä∂ÊÄÅÊ®°ÂºèÔºöÂÖÅËÆ∏‰∏Ä‰∏™ÂØπË±°Âú®ÂÖ∂ÂÜÖÈÉ®Áä∂ÊÄÅÊîπÂèòÊó∂ÊîπÂèòÂÆÉÁöÑË°å‰∏∫ÔºåÂØπË±°ÁúãËµ∑Êù•‰ºº‰πé‰øÆÊîπ‰∫ÜÂÆÉÁöÑÁ±ª„ÄÇ Áä∂ÊÄÅÊ®°ÂºèÁî®‰∫éËß£ÂÜ≥Á≥ªÁªü‰∏≠Â§çÊùÇÂØπË±°ÁöÑÁä∂ÊÄÅËΩ¨Êç¢‰ª•Âèä‰∏çÂêåÁä∂ÊÄÅ‰∏ãË°å‰∏∫ÁöÑÂ∞ÅË£ÖÈóÆÈ¢ò„ÄÇÂØπË±°Ê†πÊçÆ‰∏çÂêåÁöÑÁä∂ÊÄÅÊâßË°å‰∏çÂêåÁöÑÊìç‰ΩúÔºåÂêå‰∫ãÂØπË±°‰∏≠ÁöÑÁä∂ÊÄÅ‰πü‰ºöÂõ†‰∏∫Â§ñÈÉ®Âõ†Á¥†ÊîπÂèò„ÄÇ ÁªìÊûÑ ÁéØÂ¢ÉÁ±ª Context ÊòØÊã•Êúâ‰∏çÂêåÁä∂ÊÄÅ state ÁöÑÂØπË±°„ÄÇÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™ request() ÊñπÊ≥ïÔºå‰ºöÊâßË°å‰∏çÂêåÁä∂ÊÄÅ‰∏ãÁöÑ‰∏çÂêåÊìç‰Ωú„ÄÇÊäΩË±°Áä∂ÊÄÅÁ±ª State ‰∏≠‰πü‰øùÂ≠ò‰∫ÜÁéØÂ¢ÉÁ±ªÁöÑÂÆû‰æãÔºåÁõÆÁöÑÊòØÊñπ‰æøÈíàÂØπ‰∏çÂêåÁä∂ÊÄÅÂØπÁéØÂ¢ÉÁ±ªÁöÑÂ±ûÊÄßÊìç‰Ωú„ÄÇ‰∏çÂêåÁä∂ÊÄÅÁöÑ‰∏çÂêåÊìç‰ΩúÂú®ÂÖ∑‰ΩìÁä∂ÊÄÅÁ±ª ConcreteState ‰∏≠ÁöÑ handle() ÊñπÊ≥ï‰∏≠ÂÆûÁé∞„ÄÇÊîπÂèòÁä∂ÊÄÅÁöÑÊñπÊ≥ïÊúÄÂ•ΩÂú®ÁéØÂ¢ÉÁ±ª‰∏≠ÂÆûÁé∞„ÄÇ ‰æãÂ≠ê ËØ•‰æãÂ≠ê‰∏≠ÔºåÁéØÂ¢ÉÁ±ª Account Êúâ‰∏âÁßçÁä∂ÊÄÅ OverdraftState,RestrictedState,NormalState„ÄÇÁä∂ÊÄÅ‰∏≠‰πü‰øùÂ≠òÁùÄÁéØÂ¢ÉÁ±ªÁöÑÂÆû‰æã acc„ÄÇÁéØÂ¢ÉÁ±ªË∞ÉÁî®ÂÖ∂Â§ÑÁêÜÊñπÊ≥ïËØ∏Â¶Ç deposit() ÁöÑÊó∂ÂÄôÔºå‰ºöË∞ÉÁî®Áä∂ÊÄÅÁ±ªÁöÑÁõ∏Â∫îÊñπÊ≥ïËøõË°åÂ§ÑÁêÜ„ÄÇ ËøôÈáåÔºåÊäΩË±°Áä∂ÊÄÅÁ±ª AccountState ‰∏≠Êúâ‰∏Ä‰∏™ stateCheck() ÊñπÊ≥ïÔºåÁî®Êù•ÊîπÂèòÁéØÂ¢ÉÁ±ªÁöÑÁä∂ÊÄÅÔºåÂÆÉ‰ºöÂú®Â§ÑÁêÜÂÆåÁéØÂ¢ÉÁ±ªÁöÑÁõ∏ÂÖ≥Â±ûÊÄßÂêéË¢´Ë∞ÉÁî®„ÄÇÊàëËÆ§‰∏∫ÔºåÂú®Áä∂ÊÄÅÁ±ª‰∏≠Ë∞ÉÁî®ÊîπÂèòÁä∂ÊÄÅÁöÑÊñπÊ≥ïÊòØ‰∏çÂØπÁöÑÔºåËøôÊ†∑ÊòéÊòæËøùÂèç‰∫ÜËø™Á±≥ÁâπÊ≥ïÂàôÔºå‰ΩøË∞ÉËØïÂèòÂæóËâ∞Èöæ„ÄÇÊàëËÆ§‰∏∫Â∫îËØ•ËøòÊòØÂú®ÁéØÂ¢ÉÁ±ª‰∏≠ËøõË°åÂà§Êñ≠„ÄÇÂèØ‰ª•ÁªìÂêàËÅåË¥£ÈìæÊ®°ÂºèËøõË°åÁä∂ÊÄÅÁöÑËÆæÁΩÆ„ÄÇ Áä∂ÊÄÅÊ®°ÂºèÂíåËÅåË¥£ÈìæÊ®°ÂºèÁöÑÂå∫Âà´ÂÖ∂ÂÆûÔºåÁä∂ÊÄÅÊ®°ÂºèÂíåËÅåË¥£ÈìæÊ®°ÂºèÊå∫ÂÉèÁöÑ„ÄÇ ËÅåË¥£ÈìæÊ®°ÂºèÂØπÁõÆÊ†áÁ±ª‰∏≠ÁöÑÊüê‰∏™Â±ûÊÄßËøõË°åÂà§Êñ≠ÔºåÊù•ÂÜ≥ÂÆöËÅåË¥£Èìæ‰∏äÁöÑÂì™‰∏™Á±ªÊù•ËøõË°åÂ§ÑÁêÜÔºõËÄåÁä∂ÊÄÅÊ®°ÂºèÈ¢ÑÂÖàÂ∞ÜÁä∂ÊÄÅ(Âç≥Ë¶ÅÂ§ÑÁêÜÁöÑÁ±ª)ËÆæÁΩÆÂ•ΩÔºåÊØèÊ¨°Â§ÑÁêÜÂÆå‰πãÂêéÂÜçÂà§Êñ≠‰∏ã‰∏Ä‰∏™Áä∂ÊÄÅÊòØ‰ªÄ‰πà(Âç≥‰∏ãÊ¨°Â∫îËØ•ÈÇ£‰∏™Á±ªÂ§ÑÁêÜ)„ÄÇ Á≠ñÁï•Ê®°ÂºèÈöæÂ∫¶Ôºö1 È¢ëÁéáÔºö4 Á≠ñÁï•Ê®°ÂºèÔºöÂÆö‰πâ‰∏ÄÁ≥ªÂàóÁÆóÊ≥ïÁ±ªÔºåÂ∞ÜÊØè‰∏Ä‰∏™ÁÆóÊ≥ïÂ∞ÅË£ÖËµ∑Êù•ÔºåÂπ∂ËÆ©ÂÆÉ‰ª¨ÂèØ‰ª•Áõ∏‰∫íÊõøÊç¢ÔºåÁ≠ñÁï•Ê®°ÂºèËÆ©ÁÆóÊ≥ïÁã¨Á´ã‰∫é‰ΩøÁî®ÂÆÉÁöÑÂÆ¢Êà∑ËÄåÂèòÂåñÔºå‰πüÁß∞‰∏∫ÊîøÁ≠ñÊ®°Âºè ÂÆûÁé∞Êüê‰∏Ä‰∏™ÂäüËÉΩÊúâÂ§öÊù°ÈÄîÂæÑÔºåÊØè‰∏ÄÊù°ÈÄîÂæÑÂØπÂ∫î‰∏ÄÁßçÁÆóÊ≥ïÔºåÊ≠§Êó∂Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®‰∏ÄÁßçËÆæËÆ°Ê®°ÂºèÊù•ÂÆûÁé∞ÁÅµÊ¥ªÂú∞ÈÄâÊã©Ëß£ÂÜ≥ÈÄîÂæÑÔºå‰πüËÉΩÂ§üÊñπ‰æøÂú∞Â¢ûÂä†Êñ∞ÁöÑËß£ÂÜ≥ÈÄîÂæÑ„ÄÇ Á≠ñÁï•Ê®°ÂºèÁöÑ‰∏ªË¶ÅÁõÆÁöÑÊòØÂ∞ÜÁÆóÊ≥ïÁöÑÂÆö‰πâ‰∏é‰ΩøÁî®ÂàÜÂºÄÔºå‰πüÂ∞±ÊòØÂ∞ÜÁÆóÊ≥ïÁöÑË°å‰∏∫ÂíåÁéØÂ¢ÉÂàÜÂºÄ„ÄÇ ÁªìÊûÑ ÁéØÂ¢ÉÁ±ª Context ‰∏≠Êúâ‰∏Ä‰∏™ÊäΩË±°Á≠ñÁï•Á±ª StrategyÔºåËøô‰∏™Á≠ñÁï•Á±ªÂ∞Ü‰ºöÂú®ÊâßË°åÁöÑÊó∂ÂÄôÈÄöËøáÂèçÂ∞ÑÁöÑÊñπÂºèÂä®ÊÄÅÁöÑÁîüÊàêÂÖ∑‰ΩìÊäΩË±°Á±ª ConcreteStrategyÔºå‰ª•Ë°®Á§∫‰∏çÂêåÁöÑÁ≠ñÁï•„ÄÇÂú®ÊâßË°åÁéØÂ¢ÉÁ±ª‰∏≠ÊñπÊ≥ï algorithm() ÁöÑÊó∂ÂÄôÔºå‰ºöÊâßË°åÁ≠ñÁï•Á±ªÁöÑÁõ∏Â∫îÊñπÊ≥ï„ÄÇ ‰æãÂ≠ê ËøôÊòØ‰∏Ä‰∏™ÁîµÂΩ±Á•®ÊâìÊäòÁöÑ‰æãÂ≠ê„ÄÇÈíàÂØπ‰∏çÂêåÁöÑ‰∫∫Áæ§Êúâ‰∏çÂêåÁöÑÊâìÊäòÁ≠ñÁï• StudentDiscount,VIPDiscount,ChildrenDiscount„ÄÇËøô‰∏™Á≠ñÁï•Â∞Ü‰øùÂ≠òÂú®ÁéØÂ¢ÉÁ±ª MoviewTicket ÁöÑ discount Â±ûÊÄß‰∏≠ÔºåÂèØ‰ª•„ÄÇÊØèÊ¨°ÊâßË°åÁéØÂ¢ÉÁ±ªÁöÑÊñπÊ≥ï setPrice() ÁöÑÊó∂ÂÄôÔºåÈÉΩ‰ºöË∞ÉÁî®Áõ∏Â∫îÁ≠ñÁï•ÁöÑÊñπÊ≥ï„ÄÇ Á≠ñÁï•Ê®°ÂºèÂíåÁä∂ÊÄÅÊ®°ÂºèÁöÑÂå∫Âà´Á≠ñÁï•Ê®°ÂºèÂíåÁä∂ÊÄÅÊ®°ÂºèÂæàÂÉè„ÄÇÁ≠ñÁï•Ê®°ÂºèÈúÄË¶ÅÂú®ÁéØÂ¢ÉÁ±ª‰∏≠ËÆæÁΩÆ‰∏Ä‰∏™Á≠ñÁï•Á±ªÔºåÁä∂ÊÄÅÊ®°Âºè‰πüÈúÄË¶ÅÂú®ÁéØÂ¢ÉÁ±ª‰∏≠ËÆæÁΩÆ‰∏Ä‰∏™Áä∂ÊÄÅÁ±ª„ÄÇ‰∏§ËÄÖÁöÑÂå∫Âà´Âú®‰∫éÔºåÁä∂ÊÄÅÊ®°Âºè‰ºöÊ†πÊçÆÁéØÂ¢ÉÁ±ª‰∏≠ÁöÑÂ±ûÊÄßËá™Âä®ÊîπÂèòÁä∂ÊÄÅÁöÑÂÄºÔºåËÄåÁ≠ñÁï•Á±ªÈúÄË¶ÅÁõ¥Êé•ËÆæÁΩÆ‰∏çÂêåÁöÑÁ≠ñÁï•„ÄÇ Á≠ñÁï•Ê®°ÂºèÂíåÂëΩ‰ª§Ê®°ÂºèÂå∫Âà´ÂëΩ‰ª§Ê®°ÂºèÁî®Êù•ÈöêËóèÊé•Êî∂ËÄÖÊâßË°åÁöÑÁªÜËäÇ„ÄÇ‰πüÂ∞±ÊòØËØ¥Ë¶ÅÊúâ‰∏Ä‰∏™Êé•Êî∂ËÄÖÔºåÂëΩ‰ª§Á±ªÂÖÖÂΩìËΩ¨ÂèëÁöÑËøáÁ®ã„ÄÇ Á≠ñÁï•Ê®°Âºè‰∏çÂê´ÊúâÊé•Êî∂ËÄÖÔºå‰ªÖ‰ªÖÊòØÂØπÁÆóÊ≥ïÁöÑÂ§öÁßçÂ∞ÅË£Ö„ÄÇ Ê®°ÊùøÊñπÊ≥ïÊ®°ÂºèÈöæÂ∫¶Ôºö2 È¢ëÁéáÔºö3 Ê®°ÊùøÊñπÊ≥ïÊ®°ÂºèÔºöÂÆö‰πâ‰∏Ä‰∏™Êìç‰Ωú‰∏≠ÁÆóÊ≥ïÁöÑÊ°ÜÊû∂ÔºåËÄåÂ∞Ü‰∏Ä‰∫õÊ≠•È™§Âª∂ËøüÂà∞Â≠êÁ±ª‰∏≠„ÄÇÊ®°ÊùøÊñπÊ≥ïÊ®°Âºè‰ΩøÂæóÂ≠êÁ±ªÂèØ‰ª•‰∏çÊîπÂèò‰∏Ä‰∏™ÁÆóÊ≥ïÁöÑÁªìÊûÑÂç≥ÂèØÈáçÂÆö‰πâËØ•ÁÆóÊ≥ïÁöÑÊüê‰∫õÁâπÂÆöÊ≠•È™§„ÄÇ ÁªìÊûÑ ÊäΩË±°Á±ª‰∏≠ÂÆö‰πâ‰∫ÜÂ§ö‰∏™ÊñπÊ≥ïÔºåÂπ∂Âú®ÊñπÊ≥ï TemplateMethod() ‰∏≠ÂÆö‰πâ‰∫ÜË∞ÉÁî®Ê¨°Â∫è„ÄÇÂÖ∑‰ΩìÂ≠êÁ±ª‰∏≠ÂÆûÁé∞Ëøô‰∫õÊñπÊ≥ï„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÂú®Âü∫Á±ª‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ÊñπÊ≥ïÔºåË∞ÉÁî®‰∏Ä‰∫õÈúÄË¶ÅÂ≠êÁ±ªÂÆûÁé∞ÁöÑÊäΩË±°ÊñπÊ≥ï„ÄÇÂæàÊôÆÈÄöÁöÑËÆæËÆ°Ê®°Âºè ËÆøÈóÆËÄÖÊ®°ÂºèÈöæÂ∫¶Ôºö4 È¢ëÁéáÔºö1 ËÆøÈóÆËÄÖÊ®°Âºè(Visitor Pattern):Êèê‰æõ‰∏Ä‰∏™‰ΩúÁî®‰∫éÊüêÂØπË±°ÁªìÊûÑ‰∏≠ÁöÑÂêÑÂÖÉÁ¥†ÁöÑÊìç‰ΩúË°®Á§∫ÔºåÂÆÉ‰ΩøÊàë‰ª¨ÂèØ‰ª•Âú®‰∏çÊîπÂèòÂêÑÂÖÉÁ¥†ÁöÑÁ±ªÁöÑÂâçÊèê‰∏ãÂÆö‰πâ‰ΩúÁî®‰∫éËøô‰∫õÂÖÉÁ¥†ÁöÑÊñ∞Êìç‰Ωú„ÄÇ ËØïÊÉ≥‰∏Ä‰∏ãÔºåÂ¶ÇÊûúÊüê‰∏™Á±ªË¶ÅÂä®ÊÄÅÊõøÊç¢Êüê‰∏Ä‰∏™ÊñπÊ≥ïÊÄé‰πàÂÅöÔºüÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÂëΩ‰ª§Ê®°ÂºèÔºå‰∏çÂêåÁöÑ command Á±ªÁöÑ excute()ÊâßË°å‰∏çÂêåÁöÑË°å‰∏∫„ÄÇÈÇ£‰πàÊõ¥Ëøõ‰∏ÄÊ≠•ÔºåÂ¶ÇÊûúËøô‰∏™Á±ªÊúâÂ§ö‰∏™ÂÖÑÂºüÁ±ª‰πüÂêÑËá™ÊúâÂÆûÁé∞‰∫ÜËøô‰∏™ÊñπÊ≥ïÂë¢ÔºüÂ¶ÇÊûúËøòÊòØÁî®ÂëΩ‰ª§Ê®°ÂºèÔºåÈÇ£‰πàÊØè‰∏™ÂÖÑÂºüÁ±ªÈÉΩË¶ÅÂØπÂ∫î‰∏Ä‰∏™ Command Á±ªÔºåÁ±ªÂûãÂ∞ÜÈùûÂ∏∏Â§ö„ÄÇËøô‰∏™Êó∂ÂÄôÔºåÂèØ‰ª•ÂÄüÂä©‰∫éËÆøÈóÆËÄÖÊ®°Âºè„ÄÇ‰∏ãÈù¢ÁúãÁúãËÆøÈóÆËÄÖÊ®°ÂºèÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑ„ÄÇ ÁªìÊûÑ ÂÖàÁúã Element ÔºåÂ∞±ÊòØ‰∏äÈù¢ËØ¥ÁöÑË¶ÅÂä®ÊÄÅÊñπÊ≥ïÁöÑÂü∫Á±ªÔºå‰πüÂ∞±ÊòØ‰∏ãÈù¢ÊâÄËØ¥ÁöÑË¢´ËÆøÈóÆËÄÖÔºåÂÆÉÁöÑÂ≠êÁ±ªÂêÑËá™ÂÆûÁé∞‰∫Ü‰∏Ä‰∫õÊñπÊ≥ï opertaionA()ÔºåoperationB()„ÄÇÁé∞Âú®ËøòÊúâ‰∏Ä‰∏™ËÆøÈóÆËÄÖÁöÑÂü∫Á±ª VisitorÔºåÂú®Âü∫Á±ª‰∏≠Áõ¥Êé•Â∞±ÂÆö‰πâ‰∫ÜÈíàÂØπ Element ‰∏çÂêåÂ≠êÁ±ª‰ºöË¢´Ë∞ÉÁî®ÁöÑÊñπÊ≥ï visitConcreteElementA() Âíå visitConcreteElementB()„ÄÇElement ÁöÑÂ≠êÁ±ªÂ∞ÜÂéüÊú¨Âú® operationA() ‰∏≠Ë∞ÉÁî®ÁöÑ‰∏öÂä°ÊñπÊ≥ïÔºåÊîæÂà∞‰∫Ü Visitor ÁöÑÂ≠êÁ±ªÁöÑ visitCooncreteElementA() ‰∏≠Âéª„ÄÇÂè¶Â§ñÔºå Element ÊñπÊ≥ïÊèê‰æõ‰∫Ü‰∏Ä‰∏™Êé•Êî∂‰∏çÂêå Visitor ÁöÑÊñπÊ≥ï accept()„ÄÇ ÂÖ∑‰ΩìÁöÑË∞ÉÁî®ËøáÁ®ãÂ∞±ÊòØÔºåÂéüÊú¨Ë∞ÉÁî®‰∏öÂä°ÈÄªËæëÁöÑ operationA() Áé∞Âú®Êîπ‰∏∫Ë∞ÉÁî® accept() ÊñπÊ≥ïÔºåÁÑ∂ÂêéÂÜçÂú® accept() ÊñπÊ≥ï‰∏≠ÔºåË∞ÉÁî®ÂÖ∑‰ΩìÁöÑÂÆûÁé∞ÊñπÊ≥ï visitConcreteElementA() „ÄÇÂèÇËÄÉ‰ª£Á†ÅÂ¶Ç‰∏ã: 12345678910111213141516171819// ElementA- operationA &#123; Visitor *visitor = [[ConcreteVisitorA alloc] init]; [self accept:visitor];&#125;- accept:(Visitor *)visitor &#123; [visitor visitConcreteElementA:self];&#125;// ElementB- operationB &#123; Visitor *visitor = [[ConcreteVisitorA alloc] init]; [self accept:visitor];&#125;- accept:(Visitor *)visitor &#123; [visitor visitConcreteElementB:self];&#125; ËÆøÈóÆËÄÖÊ®°ÂºèÂèØ‰ª•Êñπ‰æøÁöÑÊõøÊç¢ Visitor Á¨¶ÂêàÂºÄÈó≠ÂéüÂàôÔºå‰ΩÜÊòØÂ¶ÇÊûúÂ¢ûÂä†‰∫Ü Element ÁöÑÂ≠êÁ±ªÔºåÂ∞±ÈúÄË¶Å‰∏∫ÊØè‰∏Ä‰∏™ Visitor Ê∑ªÂä† visitConcreteElementC() ÊñπÊ≥ïÔºå‰∏çÁ¨¶ÂêàÂºÄÈó≠ÂéüÂàô„ÄÇ ÂëΩÂêç‰∏äÔºåËÆøÈóÆËÄÖÁ±ªÂëΩÂêç‰∏∫ XxxVisitorÔºåÁÑ∂Âêé‰∏∫ÊØè‰∏Ä‰∏™Ë¢´ËÆøÈóÆËÄÖÂØπË±°ÁöÑÂ≠êÁ±ªÊèê‰æõ visitXxx: ÊñπÊ≥ï„ÄÇË¢´ËÆøÈóÆËÄÖÁöÑÂü∫Á±ªÊèê‰æõÊäΩË±°ÊñπÊ≥ï accept: ÊñπÊ≥ï„ÄÇ ËÆøÈóÆËÄÖÊ®°ÂºèÁ°ÆÂÆûÁî®ÁöÑÊØîËæÉÂ∞ëÔºåÁÆóÊòØ‰∏ÄÁßçÈíàÂØπ‰∫éÂ§öÂ≠êÁ±ªÂØπË±°ÁöÑÂëΩ‰ª§Ê®°ÂºèÂêß ÂàÜÁ±ªÊé•Âè£ÈÄÇÈÖç ÈÄÇÈÖçÂô® Ê°•Êé• Â§ñËßÇ ÂØπË±°ÂéªËÄ¶ ‰∏≠‰ªãËÄÖ ËßÇÂØüËÄÖ ÊäΩË±°ÈõÜÂêà ÁªÑÂêà Ëø≠‰ª£Âô® Ë°å‰∏∫ÊãìÂ±ï ËÆøÈóÆËÄÖ Ë£ÖÈ•∞ Ë¥£‰ªªÈìæ ÁÆóÊ≥ïÂ∞ÅË£ÖÔºö Ê®°ÊùøÊñπÊ≥ï Á≠ñÁï• ÂëΩ‰ª§ ÂØπË±°ËÆøÈóÆÔºö ‰ª£ÁêÜ ÂØπË±°Áä∂ÊÄÅÔºö Â§áÂøòÂΩï ÂØπË±°ÂàõÂª∫Ôºö ÂéüÂûã Â∑•ÂéÇÊñπÊ≥ï ÊäΩË±°Â∑•ÂéÇ Âª∫ÈÄ†ËÄÖ Âçï‰æã Â§áÊ≥®Êú¨Êñá‰∏≠ÁöÑÊâÄÊúâÁ§∫ÊÑèÂõæÔºöÁ¥´Ëâ≤ÁöÑÈÉΩË°®Á§∫Êé•Âè£Á±ªÂûãÔºåËìùËâ≤ÁöÑÈÉΩË°®Á§∫ÂÆû‰ΩìÁ±ªÔºàÂ¶ÇÊûúË¶ÅÂú®Êüê‰∏™Á±ªÂÜÖÈÉ®‰øùÂ≠òÂ±ûÊÄßÔºåÈÇ£‰πàÂ∞±‰∏çËÉΩÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫Êé•Âè£Ôºâ Êú¨Êñá‰∏≠ÁöÑÊâÄÊúâÁ§∫ÊÑèÂõæÔºö‚Äú+‚Äù Ë°®Á§∫ÊñπÊ≥ïÔºå‚Äù-‚Äú Ë°®Á§∫ÂØπË±° ËøòÊúâËß£ÈáäÂô®Ê®°ÂºèÂíåËÆøÈóÆËÄÖÊ®°ÂºèÂíå‰∫´ÂÖÉÊ®°ÂºèÊ≤°ÊúâÁúãÔºåÁî®ÁöÑÂ§™Â∞ë‰∏çÁúã‰∫Ü„ÄÇ ÊÑüË∞¢Âè≤‰∏äÊúÄÂÖ®ËÆæËÆ°Ê®°ÂºèÂØºÂ≠¶ÁõÆÂΩï]]></content>
      <categories>
        <category>ËÆ°ÁÆóÊú∫</category>
      </categories>
      <tags>
        <tag>Êû∂ÊûÑ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êï∞ÊçÆÁªìÊûÑ‰∏éÁÆóÊ≥ï]]></title>
    <url>%2F2017%2F07%2F31%2Fdatastructure%2F</url>
    <content type="text"><![CDATA[ËÆ∞ÂΩï‰∏Ä‰∫õÊï∞ÊçÆÁªìÊûÑÂíåÁÆóÊ≥ïÁöÑÂ≠¶‰π† ÊûÅÂÆ¢Êó∂Èó¥Êï∞ÊçÆÁªìÊûÑ‰∏éÁÆóÊ≥ï‰πãÁæé‚ÄîÁéã‰∫âÊï∞ÁªÑ‰∏∫‰ªÄ‰πàÁºñÁ®ãËØ≠Ë®Ä‰∏≠Êï∞ÁªÑÂ§ö‰ª• 0 ‰Ωú‰∏∫ÂºÄÂßãÔºüÊï∞ÁªÑÁöÑÁâπÁÇπÊòØÈöèÊú∫ËÆøÈóÆÔºåÂÆö‰Ωç‰∏Ä‰∏™Êï∞ÊçÆÈúÄË¶ÅÈÄöËøáÊï∞ÁªÑÈ¶ñÂú∞ÂùÄÂíåÂÅèÁßªÈáèÊù•Á°ÆÂÆö„ÄÇÂ¶ÇÊûúÊï∞ÁªÑ‰ª• 0 ÂºÄÂßãÔºåÈÇ£‰πàËÆ°ÁÆó a[k] ÁöÑÂÜÖÂ≠òÂú∞ÂùÄÁöÑÂÖ¨Âºè‰∏∫Ôºö 1a[k]_address = base_address + k * t Â¶ÇÊûú‰ª• 1 ‰Ωú‰∏∫ÂºÄÂßãÔºåÈÇ£‰πàÂÖ¨ÂºèÂ∞±Âèò‰∏∫‰∫ÜÔºö 1a[k]_address = base_address + (k - 1) * t ‰ºöÈúÄË¶ÅÂ§ö‰∏ÄÊ¨°ÁöÑËÆ°ÁÆóÈáè„ÄÇ ÊéíÂ∫èÂ¶Ç‰ΩïÊâæÂà∞Êï∞ÁªÑÊÄªÁ¨¨kÂ§ßÁöÑÊï∞Â¶ÇÊûúËØ¥ÂÖàÊéíÂ∫èÂÜçÁõ¥Êé•ËøáÂéªÁ¨¨kÂ§ßÊú™ÂÖçÊúâ‰∫õÂ§™ÊÖ¢‰∫Ü„ÄÇÂèØ‰ª•ÂèÇËÄÉÂø´ÊéíÁöÑÊÄùË∑Ø„ÄÇÈÄâÂèñÊúÄÂêé‰∏Ä‰∏™Êï∞ÁöÑÂÄº x ‰Ωú‰∏∫Ê†áËØÜÔºåÁÑ∂ÂêéÁªèËøá‰∏ÄÊ¨°ÈÅçÂéÜÊääÂ§ß‰∫é x ÁöÑÈÉΩÊîæÂà∞ x ÁöÑÂè≥ËæπÔºåÂ∞è‰∫é x ÁöÑÈÉΩÊîæÂà∞ x ÁöÑÂ∑¶Ëæπ„ÄÇÂ¶ÇÊûú x ÊâÄÂú®‰ΩçÁΩÆÂ§ß‰∫é kÔºåÈÇ£‰πàÂ∞±ÂØπ x Â∑¶ËæπÁªßÁª≠‰πãÂâçÁöÑÊìç‰Ωú„ÄÇÂê¶ÂàôÂØπ x Âè≥ËæπËøõË°å‰πãÂâçÁöÑÊìç‰Ωú„ÄÇËøôÊ†∑Â∞±‰∏çÈúÄË¶ÅÂÉèÂø´Êéí‰∏ÄÊ†∑ÔºåÊØèÊ¨°ÈÉΩË¶ÅÂØπ‰∏§ËæπÈáçÂ§çËøõË°åÊìç‰Ωú‰∫Ü„ÄÇ Êó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫ O(n)Ôºå‰∏çËøáÈúÄË¶ÅÊØîËæÉÂ§çÊùÇÁöÑËØÅÊòé„ÄÇ ÂΩíÂπ∂ÊéíÂ∫èÁöÑÊÄùÊÉ≥ÊòØ‰ªÄ‰πàÔºü‰∏∫‰ªÄ‰πàËÆ°ÁÆóÊú∫‰∏ç‰ΩøÁî®ÂΩíÂπ∂ÊéíÂ∫èÔºüÂΩíÂπ∂ÊéíÂ∫èÊòØ‰∏ÄÁßçËá™‰∏ãËÄå‰∏äÁöÑÊéíÂ∫èÔºåÂ∞Ü‰∏§‰∏™ÂàÜÂà´ÊéíÂ•ΩÂ∫èÁöÑÈòüÂàó merge ‰∏∫‰∏Ä‰∏™ÊéíÂ•ΩÂ∫èÁöÑÈòüÂàóÔºå‰∏çÊñ≠ÈáçÂ§çÔºåÁõ¥Âà∞ÁîüÊàêÊúÄÁªàÊéíÂ•ΩÂ∫èÁöÑÈòüÂàó„ÄÇ ÂΩíÂπ∂ÊéíÂ∫èÂπ∂‰∏çÊòØ‰∏ÄÁßçÂéüÂú∞ÊéíÂ∫èÔºåÂú® merge ÁöÑÊó∂ÂÄôÊòØÈúÄË¶ÅÁî≥ËØ∑È¢ùÂ§ñÁöÑÂ≠òÂÇ®Âú∞ÂùÄÁöÑÔºåÁ©∫Èó¥Â§çÊùÇÂ∫¶‰∏∫ O(n)„ÄÇÂõ†Ê≠§ÔºåÊ≤°ÊúâÂø´ÊéíÂ∫îÁî®ÂπøÊ≥õ„ÄÇ ‰ªÄ‰πàÊòØÊ°∂ÊéíÂ∫èÔºåÊó∂Èó¥Â§çÊùÇÂ∫¶ÊòØÂ§öÂ∞ëÔºåÈÄÇÁî®Âú∫ÊôØÊòØ‰ªÄ‰πàÔºüÊ°∂ÊéíÂ∫èÁöÑÊ†∏ÂøÉÊòØÂ∞ÜÊéíÂ∫èÁöÑÊï∞ÊçÆÂàÜÂà∞ÊúâÂ∫èÁöÑÂá†‰∏™Ê°∂‰∏≠ÔºåÊØè‰∏™Ê°∂ÂÜÖÁöÑÊï∞ÊçÆÂÜçÂçïÁã¨ËøõË°åÂø´Êéí„ÄÇÊéíÂÆåÂ∫èÂêéÂÜçÊääÊï∞ÊçÆ‰æùÊ¨°ÂèñÂá∫ÔºåÁªÑÊàêÊúâÂ∫èÂ∫èÂàó„ÄÇ Êó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫ O(n) ÈÄÇÁî®‰∫éÂ§ñÈÉ®ÊéíÂ∫è„ÄÇÂç≥Êï∞ÊçÆÂ≠òÂÇ®Âú®Â§ñÈÉ®Á£ÅÁõò‰∏≠ÔºåÊï∞ÊçÆÈáèËæÉÂ§ßÔºåÂÜÖÂ≠òÊúâÈôêÔºåÊó†Ê≥ïÂ∞ÜÊï∞ÊçÆÂÖ®ÈÉ®Âä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠„ÄÇÔºàÊâÄ‰ª•Â∞±ÂÖàÊääÂ§ñÈÉ®Êï∞ÊçÆÂÖàÂàÜÂà∞‰∏Ä‰∏™‰∏™Ê°∂‰∏≠ÔºåÁÑ∂ÂêéÂ∞ÜÊ°∂Âä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠ÊéíÂ∫è„ÄÇÔºâ Ë∑≥Ë°®‰ªÄ‰πàÊòØË∑≥Ë°®ÔºåÊó∂Èó¥Â§çÊùÇÂ∫¶ÊòØÂ§öÂ∞ëÔºüÊúâÂ∫èÈìæË°®Â¶Ç‰ΩïËÉΩÂÉèÊï∞ÁªÑ‰∏ÄÊ†∑Âø´ÈÄüÊâæÂà∞Á¨¨ n ‰∏™ËäÇÁÇπÔºüÂ¢ûÂä†‰∏Ä‰∫õÁ¥¢ÂºïËäÇÁÇπÔºå‰ΩøÊó∂Èó¥Â§çÊùÇÂ∫¶‰ªé O(n) ÂáèÂ∞ëÂà∞ O(logn) ‰∫åÂèâÊ†ë‰ªÄ‰πàÊòØ‰∫åÂèâÊü•ÊâæÊ†ë‰∫åÂèâÊü•ÊâæÊ†ëË¶ÅÊ±ÇÊ†ë‰∏≠ÁöÑ‰ªªÊÑè‰∏Ä‰∏™ËäÇÁÇπÔºåÂÖ∂Â∑¶Â≠êÊ†ë‰∏≠ÁöÑÊØè‰∏™ËäÇÁÇπÁöÑÂÄºÈÉΩË¶ÅÂ∞è‰∫éËøô‰∏™ËäÇÁÇπÔºåËÄåÂè≥Â≠êÊ†ëÁöÑÂÄºÈÉΩË¶ÅÂ§ß‰∫éËøô‰∏™ËäÇÁÇπ„ÄÇ Á∫¢ÈªëÊ†ëÊúâ‰ªÄ‰πàÁî®Á∫¢ÈªëÊ†ëÊòØ‰∏ÄÁßç‰∏çÂÆåÂÖ®Âπ≥Ë°°ÁöÑ‰∫åÂèâÊü•ÊâæÊ†ëÔºåÁ∫¢ÈªëÊ†ëÁöÑÈ´òÂ∫¶‰πüÂ∞±ÊòØÁ∫¢ÈªëÊ†ëÁöÑÊü•ÊâæÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫ logn„ÄÇ Â†Ü‰ªÄ‰πàÊòØÂ†Ü Â†ÜÊòØ‰∏Ä‰∏™ÂÆåÂÖ®‰∫åÂèâÊ†ë Â†Ü‰∏≠ÁöÑÊØè‰∏Ä‰∏™ËäÇÁÇπÁöÑÂÄºÈÉΩÂøÖÈ°ªÂ§ß‰∫éÁ≠â‰∫éÊàñÂ∞è‰∫éÁ≠â‰∫éÂ≠êÊ†ë‰∏≠ÊØè‰∏™ËäÇÁÇπÁöÑÂÄº Â†ÜÊéíÂ∫èÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶Â†ÜÊéíÂ∫èÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶ÊòØ nlogn„ÄÇÂ†ÜÊéíÂ∫èÊÄªÂÖ±ÂàÜ‰∏§Ê≠•Ôºö Á¨¨‰∏ÄÊ≠•ÊòØÂª∫Â†ÜÔºåÂ∞±ÊòØÊääÊï∞ÁªÑ‰∏≠ÁöÑÂÖÉÁ¥†‰ª•Êª°Ë∂≥Â†ÜÁöÑÊñπÂºèÊéíÂàó„ÄÇÂäûÊ≥ïÂ∞±ÊòØÂ∞ÜÊï∞ÊçÆ‰∏Ä‰∏™‰∏Ä‰∏™ÁöÑÊèíÂÖ•Â†Ü‰∏≠„ÄÇ Á¨¨‰∫åÊ≠•ÊòØÊéíÂ∫èÔºå‰æùÊ¨°Â∞ÜÂ†ÜÈ°∂ÁöÑÂÖÉÁ¥†ÂèñÂá∫ÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂Â∑¶Âè≥Â≠êÈáçÊñ∞ÊûÑÂª∫Â†Ü„ÄÇ ‰ªÄ‰πàÊòØÂ§ßÈ°∂Â†Ü‰ªÄ‰πàÊòØÂ∞èÈ°∂Â†ÜÊØè‰∏™ËäÇÁÇπÈÉΩÂ§ß‰∫éÁ≠â‰∫éÂ∑¶Âè≥Â≠êÊ†ëÁöÑÂ†ÜÂè´Â§ßÈ°∂Â†ÜÔºåÂèç‰πãÂàôÊòØÂ∞èÈ°∂Â†Ü Â†ÜÁöÑÂ∫îÁî®Âú∫ÊôØÂ†Ü‰∏ªË¶ÅÁî®Âú®‰∏çÈúÄË¶ÅÊâÄÊúâÊï∞ÂÖ®ÊéíÂàóÁöÑÊÉÖÂÜµÔºåÊØîÂ¶Ç‰∏ªË¶ÅÊâæÂà∞ÊúÄÂ§ßÔºåÊàñËÄÖÊúÄÂ§ßÁöÑÂá†‰∏™Ôºö ‰ºòÂÖàÁ∫ßÈòüÂàó Ê±Ç Top k ÂíåÊ±Ç‰∏≠‰ΩçÊï∞ ‰∏çÈúÄË¶ÅÂÖ®ÊéíÂ∫èÁöÑÂ∞±ÂèØ‰ª•Áî®‰∏Ä‰∏™ k ÁöÑÂ§ßÈ°∂Â†ÜÊàñËÄÖÂ∞èÈ°∂Â†ÜÂÆûÁé∞ÔºåÂ•ΩÂ§ÑÊòØÈÅøÂÖç‰∫ÜÊéíÂàóÂÖ∂‰ªñ‰∏çÁî®ÁöÑÊï∞ÊçÆ‰∫ßÁîüÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶„ÄÇ ‰ªÄ‰πàÊòØ‰ºòÂÖàÁ∫ßÈòüÂàó‰ºòÂÖàÁ∫ßÈòüÂàóÂ∞±ÊòØÊåâÁÖß‰ºòÂÖàÁ∫ßÂ§ßÂ∞èÊéíÂ•ΩÂ∫èÁöÑÈòüÂàó„ÄÇ ‰ºòÂÖàÁ∫ßÈòüÂàóÂèØ‰ª•ÊòØÁõ¥Êé•ÊéíÂ•ΩÂ∫èÁöÑÊï∞ÁªÑ„ÄÇ‰ΩÜ‰∏ÄËà¨Êù•ËØ¥ÔºåÊàë‰ª¨Âè™Ë¶Å‰øùËØÅÊØèÊ¨°Âá∫ÈòüÂàóÁöÑÊòØ‰ºòÂÖàÁ∫ßÊúÄÈ´òÁöÑÂÖÉÁ¥†Âç≥ÂèØ„ÄÇ Âõ†Ê≠§‰ºòÂÖàÁ∫ßÈòüÂàóÊòØ‰ΩøÁî®Â†ÜÁöÑÊúÄÈÄÇÂÆúÁöÑÂú∫ÊôØÔºåÂç≥ÊØèÊ¨°Ê±ÇÂá∫Â†Ü‰∏≠ÊúÄÂ§ßÁöÑÂÖÉÁ¥†„ÄÇ ÂõûÊ∫ØÊ≥ïÂõûÊ∫ØÊ≥ïÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÂõûÊ∫ØÊ≥ïÁöÑÊÄùÊÉ≥‰∏çÊòØÁ∫ØÁ≤πÁöÑforÂæ™ÁéØÔºåËÄåÊòØÁî® for Âæ™ÁéØÁ°ÆÂÆöÂΩìÂâçÊÉÖÂÜµÔºåÁÑ∂ÂêéËøêÁî®ÈÄíÂΩíÔºåÁ°ÆÂÆö‰πãÂêéÁöÑÊÉÖÂÜµ„ÄÇÂú®Á°ÆÂÆöÂΩìÂâçÊÉÖÂÜµÁöÑÊó∂ÂÄôÂèØ‰ª•Âà©Áî®Ââ™ÊûùÂéªÈô§ÊòéÊòæÈîôËØØÁöÑÊÉÖÂÜµ„ÄÇ ‰æãÂ¶ÇÂÖ´ÁöáÂêéÈóÆÈ¢òÔºåforÂæ™ÁéØÁ°ÆÂÆöÂΩìÂâçÂàóÁöÑ‰ΩçÁΩÆÔºåÂÜçÂà§Êñ≠ÂΩìÁÑ∂ÈÄâÊã©ÊòØÂê¶Á¨¶ÂêàËßÑÂàôÔºåÁÑ∂ÂêéÈÄíÂΩíÂêéÈù¢ÁöÑÂàóÊâßË°åÁõ∏ÂêåÁöÑÊìç‰Ωú„ÄÇ Âä®ÊÄÅËßÑÂàíÂä®ÊÄÅËßÑÂàíÁöÑÊ†∏ÂøÉÊòØÂ≠òÂú®ÈáçÂ§çÂ≠êÈóÆÈ¢ò„ÄÇ ÂΩìÂ≠òÂú®ÈáçÂ§çÂ≠êÈóÆÈ¢òÁöÑÊó∂ÂÄôÂèØ‰ª•Â∞ùËØïÊâæÂà∞Áä∂ÊÄÅËΩ¨ÁßªÊñπÁ®ã„ÄÇÂΩìÊâæÂà∞Áä∂ÊÄÅËΩ¨ÁßªÊñπÁ®ãÔºåÈóÆÈ¢òÂü∫Êú¨Â∞±ËÉΩËß£ÂÜ≥‰∫Ü„ÄÇ‰∏çËøáËøòË¶ÅÊ≥®ÊÑèÈÄíÂΩíÁªàÊ≠¢Êù°‰ª∂ ÊúÄÁü≠Ë∑ØÂæÑÁÆóÊ≥ïDijkstra ÁÆóÊ≥ïÁ¨¨‰∏ÄÊ≠•ÔºåÊâæÂá∫‰∏éËµ∑ÁÇπ O Áõ∏ÈÇªÁöÑÁÇπÔºåËÆæÂÆöËøô‰∫õÁÇπÁöÑÊùÉÂÄºÊòØÂÆÉ‰ª¨ÂêÑËá™‰∏éËµ∑ÁÇπ O ‰πãÈó¥ÁöÑË∑ùÁ¶ª„ÄÇÊâæÂá∫ÊùÉÂÄºÊúÄÂ∞èÁöÑÁÇπ aÔºåOa Â∞±ÊòØÊúÄÁü≠Ë∑ØÂæÑ„ÄÇÁ¨¨‰∫åÊ≠•ÔºåÊâæÂá∫‰∏éÁÇπ a Áõ∏ÈÇªÁöÑÊâÄÊúâÁÇπÔºåËøô‰∫õÁÇπÁöÑÊùÉÂÄºÁ≠â‰∫éÁÇπ a ÁöÑÊùÉÂÄºÂä†‰∏äËøô‰∫õÁÇπÂà∞ÁÇπ a ÁöÑË∑ùÁ¶ª„ÄÇÂú®Ëøô‰∏§Ê≠•‰∏≠Ëé∑ÂæóÁöÑÊâÄÊúâÊúâÊùÉÈáçÁöÑÁÇπ‰∏≠ÔºåÊâæÂà∞ÊùÉÈáçÊúÄÂ∞èÁöÑÁÇπ b„ÄÇÁÇπ b ÂèØËÉΩÁõ¥Êé•ÂíåËµ∑ÁÇπ O Áõ∏ËøûÔºåÈÇ£‰πà Ob Â∞±ÊòØÂÖ∂ÊúÄÁü≠Ë∑ØÂæÑ„ÄÇÁÇπ b ‰πüÂèØËÉΩ‰∏éÁÇπ a Áõ∏ËøûÔºåÈÇ£‰πà Oab Â∞±ÊòØ b Âà∞Ëµ∑ÁÇπ O ÁöÑÊúÄÁü≠Ë∑ØÂæÑ„ÄÇÂ¶ÇÊ≠§ÂèçÂ§çÔºåÁõ¥Âà∞ÊâÄÊúâÁÇπÈÉΩË¢´ÈÅçÂéÜÂÆå„ÄÇ Ëø™ÁßëÊñØÂΩªÁÆóÊ≥ïÊòØ BFS ÁöÑÊãìÂ±ï„ÄÇÂÆÉÊòØ‰∏ÄÁßçË¥™ÂøÉÁÆóÊ≥ïÁöÑÂÆûÁé∞„ÄÇÊØèÊ¨°ÊâæË∑ùÁ¶ªËµ∑ÁÇπÊúÄËøëÁöÑÁÇπ„ÄÇ Ëø™ÁßëÊñØÂΩªÁÆóÊ≥ïÊØèÊ¨°Ëé∑Âæó‰∏Ä‰∏™Ë∑ùÁ¶ªËµ∑ÁÇπÊúÄËøëÁöÑÁÇπÔºå‰∏çËÉΩÂ≠òÂú®Ë¥üÊùÉÂÄº„ÄÇÂè™ÊúâÂú®ÊùÉÂÄº‰∏∫Ê≠£ÁöÑÊÉÖÂÜµ‰∏ãÔºåa Âà∞ O ÊùÉÂÄºÊúÄÂ∞èÔºåÊâÄ‰ª•‰∏çÂ≠òÂú®‰ªªÊÑèÁÇπ x ‰ΩøÂæó ax+xO &lt; aOÔºåÂç≥ aO ÊòØÊúÄÁü≠Ë∑ØÂæÑ Ëøô‰∏ÄÂÅáËÆæÊâçËÉΩÂ§üÊàêÁ´ã Ëø™ÁßëÊñØÂΩªÁÆóÊ≥ïÊòØË∑ØÁî±ÈÄâÊã©ÂçèËÆÆ ospf ÁöÑËß£ÂÜ≥ÊñπÂºè Âà©Áî®‰ΩçÂõæÂà§Èáç‰ΩøÁî® hashmap ÁöÑÂà§ÈáçÂ∞Ü‰ºöÂç†Áî®ÊØîËæÉÂ§ßÁöÑÂÜÖÂ≠òÁ©∫Èó¥„ÄÇÊØîÂ¶ÇÂØπ‰∏Ä‰∏™ÊñáÊú¨ÂÖàËøõË°å hashÔºåÂæóÂà∞‰∏Ä‰∏™ 32 ‰ΩçÁöÑ hash ÂÄºÔºåÂ∞Ü‰ºöÂç†Áî® 4 ‰∏™Â≠óËäÇ„ÄÇÂΩìÊï∞ÊçÆÈáèÈùûÂ∏∏Â§ßÁöÑÊó∂ÂÄôÂ∞ÜÂç†Áî®ÊûÅÂ§ßÁöÑÂÜÖÂ≠òÁ©∫Èó¥„ÄÇ Âà©Áî®‰ΩçÂõæÊù•Âà§ÈáçÔºåÂ∞Ü‰Ωø 32 ‰ΩçÁöÑÂç†Áî®ÈáèÂáèÂ∞ë‰∏∫ 1 ‰Ωç„ÄÇ‰ΩÜÊòØ‰ø°ÊÅØÈáèÁöÑÂáèÂ∞ëÂøÖÁÑ∂‰ºöÈÄ†ÊàêÂ§ßÈáèÁöÑËØØÂà§ÔºåÂ¶Ç‰ΩïËß£ÂÜ≥Ëøô‰∏ÄÈóÆÈ¢òÔºüÂèØ‰ª•‰ΩøÁî®Â∏ÉÈöÜËøáÊª§Âô® Â∏ÉÈöÜËøáÊª§Âô®Â∏ÉÈöÜËøáÊª§Âô®Ë¶ÅÊ±ÇÊàë‰ª¨‰ΩøÁî® k ‰∏™ÂìàÂ∏åÂáΩÊï∞ÔºåÂØπÂêå‰∏Ä‰∏™ÂÄºÊ±ÇÂìàÂ∏åÂÄºÔºåÂ∞Ü‰ºöÂæóÂà∞ k ‰∏™‰∏çÂêåÁöÑÂìàÂ∏åÂÄº X1 X2 X3 ‚Ä¶ Xn„ÄÇÊàë‰ª¨ÊääËøô k ‰∏™Êï∞Â≠ó‰Ωú‰∏∫‰ΩçÂõæÁöÑ‰∏ãÊ†áÔºåÂ∞ÜÂØπÂ∫îÁöÑ BitMap[X1],BitMap[x2],BitMap[x3]‚Ä¶ ÈÉΩËÆæÁΩÆ‰∏∫ true„ÄÇËøôÊ†∑Â∞±Áî® k ‰∏™‰∫åËøõÂà∂‰ΩçÔºåË°®Á§∫‰∏Ä‰∏™ÂÄºÁöÑÂ≠òÂú®„ÄÇ ÂΩìË¶ÅÊü•ËØ¢Êüê‰∏™ÂÄºÊòØÂê¶Â≠òÂú®ÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®ÂêåÊ†∑ÁöÑ k ‰∏™ÂìàÂ∏åÂáΩÊï∞ÔºåÂØπËøô‰∏™Êï∞Â≠óÊ±ÇÂìàÂ∏åÔºåÁÑ∂ÂêéÂú®‰ΩçÂõæ‰∏≠Áõ∏Â∫îÁöÑ‰ΩçÁΩÆÊü•ÁúãÊòØÂê¶ÈÉΩ‰∏∫ true„ÄÇÂ¶ÇÊûúÈÉΩÊòØ trueÔºåÈÇ£‰πàËØ¥ÊòéËøô‰∏™ÂÄºÂ≠òÂú®ÔºåÂ¶ÇÊûúÂ≠òÂú®‰∏Ä‰∏™‰∏∫ falseÔºåÈÇ£‰πàÂ∞±ËØ¥ÊòéËøô‰∏™Êï∞Â≠ó‰∏çÂ≠òÂú®„ÄÇ Â∏ÉÈöÜËøáÊª§Âô®ÂÖ∂ÂÆû‰πüÂ≠òÂú®ËØØÂà§(ËØØÂà§Êüê‰∏™Êï∞Â≠òÂú®)Ôºå‰ΩÜÊòØÂá†ÁéáÊØîËæÉ‰Ωé Ëß£È¢òÊäÄÂ∑ßÁ∫øÊÄßË°® ÂØπÊï∞ÁªÑÊéíÂ∫è Â¶ÇÊûúÈ¢òÁõÆ‰∏≠ÊòØ‰∏Ä‰∏™Êó†Â∫èÊï∞ÁªÑÔºåÈÇ£‰πàÈÄöÂ∏∏ÂèØ‰ª•ÂÖàÂ∞ÜÊï∞ÁªÑËøõË°åÊéíÂ∫è„ÄÇÂ¶ÇÊûúÂØπÊó∂Èó¥Â§çÊùÇÂ∫¶ÊúâË¶ÅÊ±ÇÔºåÂèØ‰ª•‰ΩøÁî® hashmap ‰∫åÂàÜÊü•Êâæ ÂØπ‰∫é‰∏Ä‰∏™Â∑≤ÁªèÊéí‰∫ÜÂ∫èÁöÑÊï∞ÁªÑÔºåÂèØ‰ª•ÈÄöËøá‰∫åÂàÜÊ≥ïÊù•Èôç‰ΩéÊó∂Èó¥Â§çÊùÇÂ∫¶ ‰ªé‰∏≠Èó¥Âêë‰∏§Ëæπ ÂåπÈÖçÁöÑÈÄöÁî®ÂÅöÊ≥ï„ÄÇ‰æãÂ¶ÇÊ±ÇÊúÄÂ§ßËøûÁª≠Â∫èÂàóÔºåÊúÄÈïøÂõûÊñáÔºåÊúÄÈïøÊúâÂ∫èÊã¨Âè∑„ÄÇ ÂèåÊåáÈíàÂ§πÈÄº ‰æãÂ¶ÇÊâæÂà∞Â∫èÂàó‰∏≠Âíå‰∏∫ÁâπÂÆöÂÄºÁöÑ‰∏§‰∏™Êï∞ Âø´ÊÖ¢ÊåáÈíà ‰æãÂ¶ÇÊòØÂê¶ÊúâÁéØÁ≠âÈóÆÈ¢ò Â†ÜÊâæÊúÄÂ§ßÁöÑ k ‰∏™Êï∞‰ΩøÁî®Â†ÜÊØîÊØèÊ¨°ÈÉΩÊéíÂ∫èÂø´ Ê†ëÊûö‰∏æÊâÄÊúâÁöÑÂèØËÉΩÂΩìÈ¢òÂπ≤‰∏≠Âá∫Áé∞Êûö‰∏æÊâÄÊúâÂèØËÉΩÁöÑÊó∂ÂÄôÔºåË¶ÅÂø´ÈÄüËΩ¨Êç¢‰∏∫Ê†ëÁöÑÂΩ¢ÂºèÔºåÈÄöËøáÈÄíÂΩíÂÆûÁé∞„ÄÇ ÊòØÂê¶Â≠òÂú®ÊüêÁßçÂèØËÉΩ‰ΩøÁî® DFS ÊàñËÄÖ BFS ÂÆåÊàê„ÄÇ‰∏ÄÂÆöË¶ÅÁ´ãÂàªÂèçÂ∫îÂà∞Áî®Ê†ëÂÆûÁé∞„ÄÇ Âä®ÊÄÅËßÑÂàíÈÄíÂΩí+Â§áÂøòÂΩïÂíåÂä®ÊÄÅËßÑÂàíÁöÑÂ∑ÆÂà´Âú®‰∫éÔºåÈÄíÂΩíÊòØÈÄöËøáÈÄíÊé®ÂÖ¨ÂºèÔºå‰ªéÁªìÊûúÂæÄÊù°‰ª∂ÁöÑÂèçÂêëÈÄíÊé®„ÄÇËÄåÂä®ÊÄÅËßÑÂàíÊòØÂü∫‰∫é for Âæ™ÁéØÁöÑÊ≠£ÂêëËø≠‰ª£„ÄÇ Ê†∏ÂøÉÊ†∏ÂøÉÊòØËÉΩÂÜôÂá∫Áä∂ÊÄÅËΩ¨ÁßªÊñπÁ®ãÔºå‰Ωø‰πãËÉΩËΩ¨‰∏∫Ê±ÇËß£‰∏Ä‰∏™‰∏™Â≠êÈóÆÈ¢ò„ÄÇ Âú®ÂÜôÁä∂ÊÄÅËΩ¨ÁßªÊñπÁ®ãÁöÑÊó∂ÂÄôË¶ÅËÄÉËôëÔºåÂΩìÂâçÈóÆÈ¢òÈúÄË¶ÅÂ§öÂ∞ë‰∏™Â≠êÈóÆÈ¢òÂÖ±ÂêåÂèÇ‰∏éÊ±ÇËß£„ÄÇÊØîÂ¶ÇÁà¨Ê•ºÊ¢ØÈóÆÈ¢òÔºåÊØèÊ¨°Âè™ËÉΩÁà¨‰∏ÄÂ±ÇÊàñËÄÖ‰∏§Â±ÇÔºåÈÇ£‰πàÊØè‰∏™ÈóÆÈ¢òÂ∞±Âè™ÈúÄË¶Å‰∏§‰∏™Â≠êÈóÆÈ¢òÂèÇ‰∏é„ÄÇÂÜçÊØîÂ¶ÇÊ±ÇÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàóÔºåÈÇ£‰πàÂΩìÂâç‰ΩçÁΩÆÁöÑÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàóÔºåÂ∞±Âíå‰πãÂâçÁöÑÊâÄÊúâ‰ΩçÁΩÆÁöÑÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàóÁõ∏ÂÖ≥„ÄÇÂÜçÊØîÂ¶Ç‰π∞ÂçñËÇ°Á•®ÁöÑÈóÆÈ¢òÔºåÊ±ÇÂΩìÂâçÂ§©ÁöÑÊúÄÂ§ßÊî∂ÁõäÔºåÂ∞±‰∏çÂè™ÊòØÊ±Ç‰πãÂâçÊØè‰∏ÄÂ§©ÁöÑÊúÄÂ§ßÊî∂ÁõäÔºåËøòË¶ÅÂàÜÂà´ËÆ°ÂÖ•ÊØè‰∏ÄÂ§©ÁöÑ‰π∞ËøõÂçñÂá∫Áä∂ÊÄÅ„ÄÇ]]></content>
      <categories>
        <category>ËÆ°ÁÆóÊú∫</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰∏ÄÁØáËæÉ‰∏∫ËØ¶ÁªÜÁöÑ UICollectionView ‰ΩøÁî®ÊñπÊ≥ïÊÄªÁªì]]></title>
    <url>%2F2017%2F07%2F27%2FUICollectionView%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Ëä±‰∫Ü‰∏ÄÂë®ÁöÑÊó∂Èó¥ÁúãÂÆå‰∫Ü„ÄäiOS UICollectionView:The Complete Guide„Äã„ÄÇËã±Êñá‰π¶ËØªËµ∑Êù•ËøòÊòØÊúâÁÇπÁ¥Ø‰∫∫ÁöÑÔºåËØªÂÆåÂÜô‰∫Ü‰∫õ‰ª£Á†ÅÂÅö‰∫Ü‰∫õÁ¨îËÆ∞ÂíåÂ§ßÂÆ∂ÂàÜ‰∫´„ÄÇ‰π¶‰∏≠Ê∑±ÂÖ•ÁöÑ‰∏úË•ø‰∏çÊòØÂ§™Â§öÔºåÊó∂Èó¥‰∏çÂÖÖË£ïÁöÑËØù‰∏çÂ§™Âª∫ËÆÆÂ§ßÂÆ∂Ëá™Â∑±ËØª‰∏ÄÈÅç‰∫Ü„ÄÇ Âü∫Êú¨Â±ïÁ§∫UIScrollView Ê¶ÇËø∞UICollectionView ÁªßÊâø‰∫é UIScrollViewÔºåUICollectionViewDelegate ÂçèËÆÆÁªßÊâø‰∫é UIScrollViewDelegate ÂçèËÆÆ„ÄÇÊâÄ‰ª•Âú®‰ΩøÁî® UICollectionView ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî® UIScrollView ÁöÑÂêÑ‰∏™Â±ûÊÄßÊñπÊ≥ï„ÄÇ UIScrollView ‰∏≠ÊúâÂá†‰∏™ÈáçË¶ÅÁöÑÂ±ûÊÄßÔºåcontentSize Áî®Êù•Ê†áËØÜ UIScrollView ÁöÑÊªöÂä®ËåÉÂõ¥ÔºõcontentOffset Áî®Êù•ËÆæÁΩÆËßÜÂõæÂéüÁÇπ‰∏éÂèØËßÜÂå∫ÂüüÂ∑¶‰∏äËßíÁöÑË∑ùÁ¶ªÔºõcontentInset ÂèØÁî®ÈÄöËøá UIEdgeInsetMake(10,10,10,10) ÁöÑÊñπÊ≥ïËÆæÁΩÆ‰∏Ä‰∏™ÂÜÖËæπÊ°ÜÔºåËøô‰∏™ÂÄºÂèØ‰ª•ÊòØË¥üÁöÑÔºåËÉΩ‰ΩøËßÜÂõæË∂ÖÂá∫ÂèØËßÜÁöÑÊªöÂä®ËåÉÂõ¥„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá setContentOffset:animated: Â∞ÜËßÜÂõæÊªöÂä®Âà∞Êüê‰∏Ä‰∏™‰ΩçÁΩÆÔºå‰πüÂèØ‰ª•‰ΩøÁî® scrollRectToVisible:animated: Â∞ÜÊüêÂùó rect ÊªöÂä®Âà∞ÂèØËßÜÂå∫ÂüüÂÜÖÔºàÂ¶ÇÊûúÂ∑≤ÁªèÂèØËßÅÂàô‰∏ç‰ºöÊªöÂä®Ôºâ„ÄÇ ‰∏Ä‰∫õÊúâÁî®ÁöÑ UIScrollViewDelegate ÁöÑÊñπÊ≥ïÔºö scrollViewDidScroll:ÔºöÂú®‰ªª‰Ωï contentOffset ÂèëÁîüÊîπÂèòÁöÑÊó∂ÂàªË∞ÉÁî®„ÄÇÂèØ‰ª•Áî®Êù•Ëá™ÂÆö‰πâ‰∏Ä‰∏™‰∏ãÊãâÂà∑Êñ∞Êéß‰ª∂„ÄÇ scrollViewWillBeginDragging:ÔºöÂú® scrollView Ë¢´ÊãñÊãΩÁöÑÊó∂ÂÄôË∞ÉÁî®„ÄÇÂèØ‰ª•Âú®Ê≠§Êó∂ÊöÇÂÅú‰∏Ä‰∫õÂ§çÊùÇÊìç‰Ωú‰ª•‰øùËØÅÊªëÂä®ÁöÑÊµÅÁïÖÊÄß„ÄÇ scrollViewWillEndDragging:withVelocity:targetContentOffset:ÔºöÂú®Áî®Êà∑ÁªìÊùüÊãñÊãΩÂπ∂Êä¨Ëµ∑ÊâãÊåáÂêéË∞ÉÁî®„ÄÇÁ¨¨‰∫å‰∏™ÂèÇÊï∞Ë°®Á§∫ÁªìÊùüÊãñÂä®Êó∂ÁöÑÈÄüÂ∫¶„ÄÇÁ¨¨‰∏â‰∏™ÂèÇÊï∞Ë°®Á§∫ÊúÄÁªàÁªìÊùüÊªöÂä®Êó∂ÁöÑ contentOffset ÂÄºÔºåËøôÈáåÊòØ‰∏Ä‰∏™ CGPoint ÁöÑÊåáÈíàÔºåÊàë‰ª¨ÂèØ‰ª•ËÆ©ÂÖ∂ÊåáÂêë‰∏Ä‰∏™Êñ∞ÁöÑ CGPoint ‰ª•Ëá™Áî±ÊéßÂà∂ÊúÄÁªàÁöÑ contentOffset Â§ßÂ∞è„ÄÇÈô§‰∫ÜËÆ©Êàë‰ª¨ÊîπÂèòÊúÄÁªàÂÅúÊ≠¢ÁöÑ‰ΩçÁΩÆÔºåËøô‰∏™ÊñπÊ≥ïËøòÂèØ‰ª•‰ΩøÊàë‰ª¨ËÉΩÂ§üÂØπË¶ÅÂ±ïÁ§∫Âå∫ÂüüÁöÑÊï∞ÊçÆÊèêÂâçËøõË°åÂáÜÂ§á„ÄÇ scrollViewShouldScrollToTop:ÔºöÂú®Áî®Êà∑ÁÇπÂáªÁä∂ÊÄÅÊ†èÁöÑÊó∂ÂÄôÂõûË∞ÉÔºåËøîÂõû YES ÂÖÅËÆ∏ scrollView ÊªöÂä®Âà∞È°∂Á´Ø„ÄÇ scrollViewDidScrollToTop:ÔºöÂú®ÁÇπÂáªÈ°∂ÈÉ®Áä∂ÊÄÅÊ†èÂπ∂‰∏îÊªöÂä®Âà∞È°∂Á´ØÂêéÂõûË∞É„ÄÇ scrollViewDidEndDecelerating:ÔºöÂú®ÁªìÊùüÂáèÈÄüÂä®ÁîªÁöÑÊó∂ÂÄôË∞ÉÁî®„ÄÇÂèØ‰ª•Áî®Êù•ÁªßÁª≠‰πãÂâçÊöÇÂÅúÁöÑÂ§çÊùÇÊìç‰Ωú„ÄÇ Â¶Ç‰ΩïÈáçÁî® UICollectionViewCellÂèØ‰ª•ÈÄöËøá UINib ‰ª•Âèä class ‰∏§ÁßçÊñπÂºèÊ≥®ÂÜå cellÔºö registerClass:forCellWithReuserIdentifier: registerNib:forCellWithReuseIdentifer: ÂΩì dequeueReuseableCellWithReuseIdentifirer:forIndexPath: Ë¢´Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÔºå‰Ω†Â∞ÜËé∑Âæó‰∏Ä‰∏™Ë¢´ÈáçÁî®ÁöÑ cellÔºåÂ¶ÇÊûúÊ≠§Êó∂Ê≤°ÊúâÂèØÁî®ÁöÑ cellÔºåÁ≥ªÁªü‰ºöÂ∏Æ‰Ω†ÂàõÂª∫‰∏Ä‰∏™„ÄÇ Â±ïÁé∞ÂÜÖÂÆπÂáÜÂ§á‰∏Ä‰∏™ cell Á±ªËá™ÂÆö‰πâ‰∏Ä‰∏™Á±ªÁªßÊâø‰∫é UICollectionViewCell: 1234567@interface SimpleCollectionViewCell : UICollectionViewCell@property (nonatomic,copy) NSString *num;- (void)refreshData;@end UICollectionViewCell Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÈáçÁî®ÂâçÊ∏ÖÁ©∫ cell ÂÜÖÊï∞ÊçÆÁöÑÊñπÊ≥ï prepareForReuseÔºåÈáçÂÜôÂÆÉÔºåÔºö 1234- (void)prepareForReuse &#123; [super prepareForReuse]; self.num = @"";&#125; ‰∏ÄÂÆöË¶ÅË∞ÉÁî® super ÊñπÊ≥ï ËÆæÁΩÆ ViewControllerÂÖàÊ∑ªÂä†‰∏Ä‰∏™ CollectionViewÔºåÁÑ∂ÂêéÊ≥®ÂÜåÔºåÂÖàÂÆö‰πâ‰∏Ä‰∏™ static ÁöÑ IdentifierÔºö 12345678910111213141516171819202122static NSString *SIMPLECELLIDENTIFIER = @"Simple Cell Identifier";- (void)viewDidLoad &#123; [super viewDidLoad]; // ËÆæÁΩÆ flowLayout UICollectionViewFlowLayout *flowLayout = [[UICollectionViewFlowLayout alloc] init]; flowLayout.minimumInteritemSpacing = 40; flowLayout.minimumLineSpacing = 40; flowLayout.sectionInset = UIEdgeInsetsMake(10, 10, 10, 10); flowLayout.itemSize = CGSizeMake(50, 50); // Ê∑ªÂä† collectionViewÔºåËÆ∞ÂæóË¶ÅËÆæÁΩÆ delegate Âíå dataSource ÁöÑ‰ª£ÁêÜÂØπË±° _collectionView = [[UICollectionView alloc] initWithFrame:self.view.frame collectionViewLayout:flowLayout]; _collectionView.delegate = self; _collectionView.dataSource = self; _collectionView.backgroundColor = [UIColor redColor]; [self.view addSubview:_collectionView]; // Ê≥®ÂÜå cell [_collectionView registerClass:[SimpleCollectionViewCell class] forCellWithReuseIdentifier:SIMPLECELLIDENTIFIER];&#125; ‰∏ÄÂÆöË¶ÅÂÖàÂ∞Ü collectionView ÁöÑ delegate Âíå dataSource ËÆæÁΩÆ‰∏∫ self Âì¶ ÂÆûÁé∞‰ª£ÁêÜÂÆûÁé∞‰∏§‰∏™ÂøÖÈ°ªÁöÑ‰ª£ÁêÜÔºå‰∏Ä‰∏™ËøîÂõû item ÁöÑÊï∞ÈáèÔºå‰∏Ä‰∏™ËøîÂõûÂÖ∑‰ΩìÁöÑ cellÔºö 12345678910- (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section &#123; return _count;&#125;- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath &#123; SimpleCollectionViewCell *cell = (SimpleCollectionViewCell *)[collectionView dequeueReusableCellWithReuseIdentifier:SIMPLECELLIDENTIFIER forIndexPath:indexPath]; cell.num = [NSString stringWithFormat:@"%ld",(long)indexPath.item]; [cell refreshData]; return cell;&#125; ÊâπÈáèÂ§ÑÁêÜÂèØ‰ª•Â∞ÜËøô‰∫õÊìç‰ΩúÈÄöËøá performBatchUpdates:completion: ÊñπÊ≥ïËøõË°åÊâπÈáèÂ§ÑÁêÜÔºö 123456- (void)addItem:(id)sender &#123; [self.collectionView performBatchUpdates:^&#123; [self.collectionView deleteItemsAtIndexPaths:@[[NSIndexPath indexPathForItem:2 inSection:0]]]; [self.collectionView insertItemsAtIndexPaths:@[[NSIndexPath indexPathForItem:5 inSection:0]]]; &#125; completion:nil];&#125; Cell ÁöÑËßÜÂõæÂ±ÇÁ∫ßÂú® cell ‰∏≠Ê∑ªÂä†ËßÜÂõæÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Ë¶ÅÂ∞ÜËßÜÂõæÊ∑ªÂä†Âà∞ contentView ‰∏äÔºåËÄå‰∏çÊòØ self„ÄÇÊàë‰ª¨ÂèØ‰ª•ËßÇÂØü cell ÁöÑËßÜÂõæÂ±ÇÁ∫ßÔºö Âú® contentView Âíå UICollectionViewCell ‰πãÈó¥ËøòÂ≠òÂú®ÁùÄ selectedBackgroundView Âíå backgroundView„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåËøô‰∏§‰∏™ view ÈÉΩÊòØ nil ÁöÑ„ÄÇÂ¶ÇÊûú‰Ω†Â∏åÊúõ‰ªñ‰ª¨ËÉΩÊòæÁ§∫Âá∫Êù•ÔºåÈÇ£‰πàÈúÄË¶Å alloc Âá∫Êù•Ôºå‰∏çÈúÄË¶ÅÊâãÂä®ËÆæÁΩÆ frame Â§ßÂ∞èÔºåÁ≥ªÁªü‰ºöËá™Â∑±ÊíëÊª°Êï¥‰∏™ cellÔºö 1self.backgroundView = [UIView alloc] init]; Êõ¥Ëøõ‰∏ÄÊ≠•‰∏äÈù¢‰∏ÄËäÇËÆ≤‰∫ÜÂ¶Ç‰ΩïÂ±ïÁ§∫‰∏Ä‰∏™ÊúÄÂü∫Êú¨ÁöÑ CollectionViewÔºåÊú¨ËäÇË¶ÅÂú®Â±ïÁ§∫ÁöÑÂü∫Á°Ä‰∏äÊãìÂ±ï‰∏Ä‰∫õÊìç‰ΩúÊñπÊ≥ï„ÄÇ Supplementary ViewsSupplementary View ÊòØ UICollectionViewLayout Êèê‰æõÁöÑÔºåÂèØ‰ª•ÈöèÁùÄ CollectionView ÊªöÂä®ÔºåÂπ∂‰∏îÊòØÊï∞ÊçÆÈ©±Âä®ÔºåÂèØ‰ª•Â±ïÁ§∫‰ø°ÊÅØÁöÑ„ÄÇ Âú® UICollectionViewFlowLayout ‰∏≠Êèê‰æõ‰∫Ü‰∏§Áßç Supplementary ViewÔºöÂ§¥ÈÉ®ËßÜÂõæÂíåÂ∞æÈÉ®ËßÜÂõæ„ÄÇ‰ΩÜÊòØËøôÂè™ÊòØÂú®ËøôÁßç Layout ÊñπÂºè‰∏ãÁöÑÁâπÊÆäÁ±ªÂûãÔºå‰πãÂêéÊàë‰ª¨‰ºöÂ≠¶‰π†Â¶Ç‰ΩïËá™ÂÆö‰πâ Supplementary View„ÄÇÂè™Ë¶ÅËÆ∞‰ΩèÔºå‰ªª‰ΩïÊúâÊï∞ÊçÆÂ±ïÁ§∫ÁöÑÂπ∂‰∏î‰∏çÊòØ cell ÁöÑËßÜÂõæÔºåÈÉΩÂèØ‰ª•Áî® Supplementary View Â±ïÁ§∫„ÄÇ Supplementary View Âíå cell Á±ª‰ººÔºå‰πüÈúÄË¶ÅÊ≥®ÂÜå Nib ÊàñËÄÖ ClassÔºå‰πü‰ºöË¢´‰∏ÄÁõ¥ÈáçÁî®„ÄÇ ÂÆö‰πâ‰∏Ä‰∏™ Supplementary View Á±ªËá™ÂÆö‰πâÁöÑ Supplementary View ÁªßÊâø‰∫é UICollectionReusableView„ÄÇËøô‰∏™Á±ªÊèê‰æõ‰∫Ü‰∏Ä‰∫õÂíå UICollectionViewCell Áõ∏ÂêåÁöÑÊñπÊ≥ïÔºàÂÖ∂ÂÆû UICollectionViewCell Â∞±ÊòØÁªßÊâø‰∫é UICollectionReusableView ÁöÑÔºâÔºå‰ΩÜÊòØÊØîÂÖ∂Êõ¥ËΩªÈáèÁ∫ßÔºåÊØîÂ¶ÇÊó†Ê≥ïÂÉè Cell ‰∏ÄÊ†∑ÔºåÂ§ÑÁêÜÁÇπÂáª‰ª•ÂèäÈ´ò‰∫ÆÁ≠âÔºàÂ¶ÇÊûú‰Ω†ÊÉ≥Ë¶ÅÔºå‰Ω†ÈúÄË¶ÅËá™Â∑±ÂÆûÁé∞Ôºâ„ÄÇ 1234567@interface SimpleReusableView : UICollectionReusableView@property (nonatomic,strong) NSString *num;- (void)refreshData;@end ÂêåÊ†∑ÂÆûÁé∞‰ª•‰∏ã prepareForReuse ÊñπÊ≥ïÔºö 1234- (void)prepareForReuse &#123; [super prepareForReuse]; self.num = @"";&#125; ËÆæÁΩÆ ViewControllerËøòÊòØÂú® viewDidLoad ÊñπÊ≥ï‰∏≠Ê≥®ÂÜåÔºåÂêåÊ†∑ÂÖàÂÆö‰πâ‰∏Ä‰∏™ IdentifierÔºö 12345678910111213static NSString *SIMPLESUPPLEMENTARYIDENTIFIER = @"Simple Supplementary Identifier";static NSString *SIMPLECELLIDENTIFIER = @"Simple Cell Identifier";- (void)viewDidLoad &#123; [super viewDidLoad]; ... // ËÆæÁΩÆÂ§ßÂ∞è flowLayout.headerReferenceSize = CGSizeMake(self.view.bounds.size.width, 30); // Ê≥®ÂÜå Supplementary View [_collectionView registerClass:[SimpleReusableView class] forSupplementaryViewOfKind:UICollectionElementKindSectionHeader withReuseIdentifier:SIMPLESUPPLEMENTARYIDENTIFIER];&#125; ËøôÈáåÊ≥®ÂÜåÁöÑÊòØ header:UICollectionElementKindSectionHeaderÔºåÁ±ª‰ººÁöÑËøòÂèØ‰ª•Ê≥®ÂÜå footer:UICollectionElementKindSectionFooter Âè¶Â§ñÔºå‰∏ÄÂÆöË¶ÅËÆæÁΩÆ UICollectionViewFlowLayout ÁöÑ headerReferenceSize Â±ûÊÄßÔºåÂÖ∂ÈªòËÆ§ÊòØ CGSizeZero ÁöÑÔºåÂ¶ÇÊûú‰∏çÊâãÂä®ËÆæÁΩÆÔºåSupplementary View Â∞±Êó†Ê≥ïÊòæÁ§∫„ÄÇ‰ΩÜÊòØÂàáËÆ∞ÔºåÂ¶ÇÊûú‰Ω†ËÆæÁΩÆ‰∫ÜËøô‰∏™ÂÄºÔºåÂ∞±‰∏ÄÂÆöË¶ÅÂÆûÁé∞ collectionView:viewForSupplementaryElementOfKind:atIndexPath: ËøîÂõû‰∏Ä‰∏™ SupplementaryViewÔºåÂê¶ÂàôÂ∞±‰ºö‰∫ßÁîüÂºÇÂ∏∏„ÄÇ ÂÆûÁé∞‰ª£ÁêÜÔºöÂêåÊ†∑ÂÆûÁé∞‰∏§‰∏™‰ª£ÁêÜÔºå‰∏Ä‰∏™ËøîÂõû section ÁöÑÊï∞ÈáèÔºå‰∏Ä‰∏™ËøîÂõû Supplementary View Ôºö 12345678910- (NSInteger)numberOfSectionsInCollectionView:(UICollectionView *)collectionView &#123; return _sectionCount;&#125;- (UICollectionReusableView *)collectionView:(UICollectionView *)collectionView viewForSupplementaryElementOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath &#123; SimpleReusableView *reuseableView = (SimpleReusableView *)[collectionView dequeueReusableSupplementaryViewOfKind:kind withReuseIdentifier:SIMPLESUPPLEMENTARYIDENTIFIER forIndexPath:indexPath]; reuseableView.num = [NSString stringWithFormat:@"%ld",(long)indexPath.section]; [reuseableView refreshData]; return reuseableView;&#125; ÂìçÂ∫î‰∫§‰∫íÂÆûÁé∞ CollectionViewDelegate ÁöÑÊñπÊ≥ï collectionView:didSelectedAtIndexPath: 1234567- (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath &#123; // ÂèñÊ∂àÈÄâ‰∏≠ [collectionView deselectItemAtIndexPath:indexPath animated:YES]; // Ëé∑ÂèñÂΩìÂâçÁÇπÂáªÁöÑ cell SimpleCollectionViewCell *cell = (SimpleCollectionViewCell *)[collectionView cellForItemAtIndexPath:indexPath]; ...&#125; deselectItemAtIndexPath:animted: ÊñπÊ≥ïÂèñÊ∂àÈÄâ‰∏≠„ÄÇ cellForItemAtIndexPath: ÊñπÊ≥ïÈÄöËøá indexPath Ëé∑ÂèñÂΩìÂâç cell„ÄÇ ÂØπ item Âíå section ÁöÑÊìç‰ΩúÁ≥ªÁªüÊèê‰æõ‰∫Ü‰ª•‰∏ãÊñπÊ≥ïÊù•ÂØπ item Âíå section ËøõË°åÊèíÂÖ•„ÄÅÂà†Èô§„ÄÅÈáçËΩΩ„ÄÅÁßªÂä®Êìç‰ΩúÔºö insertSections: deleteSections: reloadSections: moveSection:toSection: insertItemsAtIndexPaths: deleteItemsAtIndexPaths: reloadItemsAtIndexPaths: moveItemAtIndexPath:toIndexPath: Ê≥®ÊÑè‰∏ÄÂÆöË¶ÅÂÖàÊîπÂèò item ÊàñËÄÖ section ÁöÑÊï∞ÈáèÔºåÁÑ∂ÂêéÊâçËÉΩÂØπ item ÊàñËÄÖ section ËøõË°åÊèíÂÖ•ÂíåÂà†Èô§„ÄÇ Ëøô‰∫õÊñπÊ≥ïÂèØ‰ª•ÊîæÂú® performBatchUpdates:completion: ‰∏≠ËøõË°åÊâπÈáèÂ§ÑÁêÜ„ÄÇ ÊîπÂèò item Âíå section ÁöÑÂ§ßÂ∞èÂâçÈù¢ÔºåÊàë‰ª¨ÈÄöËøá UICollectionViewFlowLayout ÁöÑ itemSize Âíå headerReferenceSize (ÂåÖÊã¨ footerReferenceSize) Áªü‰∏ÄËÆæÁΩÆ‰∫Ü item Âíå section ÁöÑÂ§ßÂ∞è„ÄÇ Â¶Ç‰ΩïÊØè‰∏™ item Âíå section ÁöÑÂ§ßÂ∞è‰∏çËßÑÂàôÂë¢Ôºü Êàë‰ª¨ÂèØ‰ª•ÂÆûÁé∞ UICollectionViewDelegateFlowLayout ÂçèËÆÆ‰∏≠ÁöÑ‰ª•‰∏ãÊñπÊ≥ïÂÆûÁé∞Ôºö collectionView:layout:sizeForItemAtIndexPath: collectionView:layout:referenceSizeForHeaderInSection: collectionView:layout:referenceSizeForFooterInSection: ÂÆûÁé∞Ëøô‰∫õÊñπÊ≥ïÔºåÂπ∂Âú®Ê†πÊçÆ indexPath ËøîÂõûÂìçÂ∫îÁöÑ CGSize. UICollectionViewDelegateFlowLayoutÂçèËÆÆÁªßÊâø‰∫é UICollectionViewDelegateÂçèËÆÆÔºåÊâÄ‰ª•‰ªçÁÑ∂Â∞Ü CollectionView ÁöÑ delegate ËÆæÁΩÆ‰∏∫ ViewController Â∞±Ë°å‰∫Ü„ÄÇ ÊòØÂê¶ÂèØ‰ª•ÈÄâ‰∏≠ÂÆûÁé∞ UICollectionViewDelegate ÂçèËÆÆ‰∏≠ÁöÑ‰ª•‰∏ãÊñπÊ≥ïÂèØ‰ª•ÂÆûÁé∞ÊéßÂà∂ item ÊòØÂê¶ÂèØ‰ª•È´ò‰∫ÆÔºåÈÄâ‰∏≠ÔºåÂèñÊ∂àÈÄâ‰∏≠Ôºö collectionView:shouldHighlightItemAtIndexPath: collectionView:shouldSelectItemAtIndexPath: collectionView:shouldDeselectedItemAtIndexPath: Â§çÂà∂Á≤òË¥¥Êìç‰ΩúÊúâÊó∂ÂÄôÊàë‰ª¨ÊÉ≥Â§çÂà∂‰∏Ä‰∫õ cell ‰∏≠ÁöÑ‰∏úË•øÔºåÂÆûÁé∞‰∏ãÈù¢ÊñπÊ≥ïÂ∞±ÂèØ‰ª•Â§çÂà∂Ôºö 12345678910111213141516171819202122// ËÉΩÂê¶ÈÄâ‰∏≠- (BOOL)collectionView:(UICollectionView *)collectionView shouldSelectItemAtIndexPath:(NSIndexPath *)indexPath &#123; return YES;&#125;// ÈÄâ‰∏≠ÂêéËÉΩÂê¶ÂºπÂá∫ËèúÂçï- (BOOL)collectionView:(UICollectionView *)collectionView shouldShowMenuForItemAtIndexPath:(NSIndexPath *)indexPath &#123; return YES;&#125;// ËÉΩÂê¶ÊâßË°åËèúÂçïÈáåÁöÑÊüê‰∏™Êìç‰Ωú- (BOOL)collectionView:(UICollectionView *)collectionView canPerformAction:(SEL)action forItemAtIndexPath:(NSIndexPath *)indexPath withSender:(id)sender &#123; return YES;&#125;// Ê£òÁ™ÅÊâßË°åËèúÂçïÈÄâÈ°πÁöÑÊìç‰Ωú- (void)collectionView:(UICollectionView *)collectionView performAction:(SEL)action forItemAtIndexPath:(NSIndexPath *)indexPath withSender:(id)sender &#123; if ([NSStringFromSelector(action) isEqualToString:@"copy:"]) &#123; UIPasteboard *pasteboard = [UIPasteboard generalPasteboard]; [pasteboard setString:((SimpleCollectionViewCell *)[collectionView cellForItemAtIndexPath:indexPath]).num]; &#125;&#125; ‰ΩøÁî® UICollectionViewFlowLayoutÂàõÂª∫ UICollectionViewFlowLayout ÁöÑÂ≠êÁ±ªÁ≥ªÁªüÁöÑ UICollectionViewFlowLayout ËôΩÁÑ∂ÂÖÅËÆ∏‰Ω†ÂÆö‰πâ item ‰ª•Âèä Supplementary Views ÁöÑÂ§ßÂ∞èÔºå‰ΩÜÊòØ‰Ω†‰∏çËÉΩËá™ÂÆö‰πâÊØè‰∏™ View ÁöÑ‰ΩçÁΩÆ„ÄÇÊØîÂ¶Ç‰∏ãÂõæÔºå‰Ω†ÊÉ≥ËÆ©ÊâÄÊúâ item ÈÉΩÊ≤øÁùÄËôöÁ∫øÊéíÂ∏ÉÔºåÂè™Áî® UICollectionViewFlowLayout ÊòØ‰∏çÂ§üÁöÑ„ÄÇÊàë‰ª¨ÈúÄË¶ÅÁªßÊâøÂÆÉÔºåÂπ∂‰∏îÈáçÂÜôÂÖ∂‰∏≠ÁöÑÈÉ®ÂàÜÊñπÊ≥ïÔºåÂÆûÁé∞Ëá™ÂÆö‰πâÁöÑÂ∏ÉÂ±Ä„ÄÇ ÁªßÊâø UICollectionViewFlowLayoutÂàõÂª∫‰∏Ä‰∏™Á±ªÔºåÁªßÊâø‰∫é UICollectionViewFlowlayoutÔºåÈáçÂÜôÂÆÉ init ÊñπÊ≥ï„ÄÇÊàë‰ª¨ÂèØ‰ª•Êää‰πãÂâçÂÜôÂú® ViewController ‰∏≠ÁöÑÂØπ‰∫é layout ÁöÑËÆæÁΩÆÁßªÂà∞ init ÊñπÊ≥ï‰∏≠Ôºå‰Ωú‰∏∫ÈªòËÆ§ÂÆûÁé∞ÔºåÂáèÂ∞ë VC ‰∏≠ÁöÑ‰ª£Á†ÅÈáèÔºö 123456789101112- (instancetype)init &#123; if (!(self = [super init])) &#123; return nil; &#125; self.minimumInteritemSpacing = 20; self.minimumLineSpacing = 40; self.sectionInset = UIEdgeInsetsMake(10, 10, 10, 10); self.itemSize = CGSizeMake(50, 50); self.headerReferenceSize = CGSizeMake([UIScreen mainScreen].bounds.size.width, 30); return self;&#125; ÈáçÂÜôÂ∏ÉÂ±ÄÊñπÊ≥ï layoutAttributesForElementsInRect:Êàë‰ª¨ÈúÄË¶ÅÈáçÂÜô layoutAttributesForElementsInRect: ÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™ÂåÖÂê´ÊâÄÊúâÂ∏ÉÂ±Ä‰ø°ÊÅØ UICollectionViewLayoutAttributesÁöÑÊï∞ÁªÑ„ÄÇÊØîÂ¶ÇÊàë‰ª¨ÂèØ‰ª•Êää CollectionView ‰∏≠ÊâÄÊúâ cell ÈÉΩÊóãËΩ¨ 45¬∞Ôºö 123456789101112- (NSArray&lt;UICollectionViewLayoutAttributes *&gt; *)layoutAttributesForElementsInRect:(CGRect)rect &#123; NSArray *array = [super layoutAttributesForElementsInRect:rect]; NSMutableArray *newArray = [NSMutableArray array]; for (UICollectionViewLayoutAttributes *attrs in newArray) &#123; UICollectionViewLayoutAttributes *newAttrs = [attrs copy]; if (attrs.representedElementKind == nil) &#123; newAttrs.transform = CGAffineTransformMakeRotation(45); &#125; [newArray addObject:newAttrs]; &#125; return newArray;&#125; Êàë‰ª¨ÈÄöËøáÁà∂Á±ªÊñπÊ≥ï [super layoutAttributesForElementsInRect:rect] ÂÖàÂàõÂª∫‰∫Ü‰∏Ä‰∏™Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ãÁöÑÊâÄÊúâÂ±ûÊÄßÁöÑÊï∞ÁªÑ„ÄÇËøô‰∏™Áà∂Á±ªÊñπÊ≥ïÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂè™‰ºöÂàõÂª∫Âú® rect ËåÉÂõ¥ÂÜÖÁöÑËßÜÂõæÁöÑÂ∏ÉÂ±ÄÂ±ûÊÄß„ÄÇÊâÄ‰ª•Â¶ÇÊûú‰Ω†ÊÉ≥ÊääÂéüÊù•‰∏ç‰ºöË¢´Áé∞ÂÆûÁöÑËßÜÂõæ‰πüÊòæÁ§∫Âá∫Êù•ÁöÑËØùÔºå‰Ω†Â∞±‰∏çÂæó‰∏çËá™Â∑±ÊääÊâÄÊúâÂ∏ÉÂ±ÄÂ±ûÊÄßÈÉΩÂàõÂª∫Âá∫Êù•ÔºåÊîæÂÖ•Êï∞ÁªÑ‰∏≠„ÄÇ ÊúÄÂ•Ω‰∏çË¶ÅÁõ¥Êé•‰øÆÊîπËøô‰∏™Êï∞ÁªÑÈáåÁöÑÂÖÉÁ¥†ÔºåËÄåÊòØÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÊã∑Ë¥ù„ÄÇÂê¶ÂàôÂΩì‰Ω†ÊÉ≥Â¢ûÂà†‰øÆÊîπ cell ÁöÑÊó∂ÂÄô‰ºöÂá∫Áé∞‰∏ãÈù¢ÁöÑÈóÆÈ¢òÔºåÊûÅÊúâÂèØËÉΩÂºïËµ∑Â∫îÁî®Â¥©Ê∫ÉÔºö ‰øÆÊîπÁöÑÊó∂ÂÄôÊàë‰ª¨ËøòË¶ÅÂà§Êñ≠ attrs.representedElementKind == nil„ÄÇËøôÊòØÁî±‰∫éËøô‰∏™Â±ûÊÄßÊï∞ÁªÑÂåÖÂê´‰∫ÜÊâÄÊúâËßÜÂõæÁöÑÂ∏ÉÂ±Ä‰ø°ÊÅØÔºåÂåÖÊã¨ cell,supplementary view,decortation view„ÄÇÂΩì representedElementKind ÊòØ nil ÁöÑÊó∂ÂÄôÔºåË°®Á§∫Ëøô‰∏™Â∏ÉÂ±Ä‰ø°ÊÅØÊòØ Item ÁöÑÂ∏ÉÂ±Ä‰ø°ÊÅØ„ÄÇ ÈáçÂÜôÂÖ∂‰ªñÂ∏ÉÂ±ÄÊñπÊ≥ïÈô§‰∫ÜlayoutAttributesForElementsInRect: ÊñπÊ≥ïÔºåËøòÊèê‰æõ‰∫ÜÂ¶Ç‰∏ãÊñπÊ≥ïÁî®Êù•ÂàÜÂà´ËÆ¢Âà∂ ItemÔºåSupplementaryViewÔºåDecorationViewÔºö layoutAttributesForItemAtIndexPath: layoutAttributesForSupplementaryViewOfKind:atIndexPath: layoutAttributesForDecorationViewOfKind:atIndexPath: Ëøô‰∫õÊñπÊ≥ïÁî®Êù•ËÆ¢Âà∂Êüê‰∏™ÁâπÊÆäÁöÑËßÜÂõæÁöÑÂ∏ÉÂ±Ä„ÄÇÁ≥ªÁªü‰∏ÄËà¨‰∏ç‰ºö‰∏ªÂä®Ë∞ÉÁî®‰Ω†‰Ω†ÈáçÂÜôÁöÑËøôÂá†‰∏™ÊñπÊ≥ïÔºà‰∏çÊòØÁªùÂØπ‰∏ç‰ºöË∞ÉÁî®ÂïäÔºåÊØîÂ¶Ç‰∏ãÈù¢ÁöÑÁßªÂä® Item ÁöÑÊó∂ÂÄôÔºåÂ∞±ÊòØÁ≥ªÁªüË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïËé∑ÂèñË¢´ÁÇπÂáªÁöÑ Item ÁöÑÂ∏ÉÂ±ÄÂ±ûÊÄß„ÄÇÊâÄ‰ª•ÊúÄÂ•ΩËøòÊòØÂÆûÁé∞ËøôÂá†‰∏™ÊñπÊ≥ïÔºåÁÑ∂ÂêéÊâãÂä®Âú® layoutAttributesForElementsInRect: ‰∏≠Ë∞ÉÁî®ÔºâÔºåÈúÄË¶Å‰Ω†Ëá™Â∑±Âú® layoutAttributesForElementsInRect: ‰∏≠ÊâãÂä®Ë∞ÉÁî®„ÄÇÊØîÂ¶ÇÂ∞ÜÁ¨¨‰∫åÊ†èÁöÑÁ¨¨‰∫î‰∏™ Item ÂèäÁ¨¨‰∫åÊ†èÁöÑ SupplementaryView ÊóãËΩ¨ 45¬∞Ôºö 12345678910111213141516171819202122232425262728293031323334- (NSArray&lt;UICollectionViewLayoutAttributes *&gt; *)layoutAttributesForElementsInRect:(CGRect)rect &#123; NSArray *array = [super layoutAttributesForElementsInRect:rect]; NSMutableArray *newArray = [NSMutableArray array]; for (UICollectionViewLayoutAttributes *attrs in array) &#123; UICollectionViewLayoutAttributes *newAttrs = [attrs copy]; // ËÆæÁΩÆÊØè‰∏Ä‰∏™ item if (attrs.representedElementKind == nil) &#123; if (attrs.indexPath.item == 5 &amp;&amp; attrs.indexPath.section == 1) &#123; newAttrs = [self layoutAttributesForItemAtIndexPath:[NSIndexPath indexPathForItem:5 inSection:1]]; &#125; &#125; // ËÆæÁΩÆÊØè‰∏Ä‰∏™ SupplementaryView if (attrs.representedElementCategory == UICollectionElementCategorySupplementaryView) &#123; if (attrs.indexPath.section == 1) &#123; newAttrs = [self layoutAttributesForSupplementaryViewOfKind:UICollectionElementKindSectionHeader atIndexPath:[NSIndexPath indexPathForItem:0 inSection:1]]; &#125; &#125; [newArray addObject:newAttrs]; &#125; return newArray;&#125;- (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)indexPath &#123; UICollectionViewLayoutAttributes *itemAttributes = [super layoutAttributesForItemAtIndexPath:indexPath]; itemAttributes.transform = CGAffineTransformMakeRotation(-45); return itemAttributes;&#125;- (UICollectionViewLayoutAttributes *)layoutAttributesForSupplementaryViewOfKind:(NSString *)elementKind atIndexPath:(NSIndexPath *)indexPath &#123; UICollectionViewLayoutAttributes *supplementaryAttributes = [super layoutAttributesForSupplementaryViewOfKind:elementKind atIndexPath:indexPath]; itemAttributes.transform = CGAffineTransformMakeRotation(45); return supplementaryAttributes;&#125; ÂÖ∂‰∏≠Âà§Êñ≠ representElementCategory ÊòØÂê¶‰∏∫ UICollectionElementCategorySupplementaryView Êù•Âå∫ÂàÜÊòØÂê¶ÊòØ SupplementaryView„ÄÇ ‰ΩøÁî® DecorationViewDecorationView ‰∏çÂ±ïÁ§∫‰ªª‰Ωï‰ø°ÊÅØÔºåÊâÄ‰ª•‰∏çÈúÄË¶ÅÂÜç ViewController ‰∏≠Ê∑ªÂä†‰ªª‰Ωï‰ª£Á†ÅÔºåÊâÄÊúâÁöÑ‰ª£Á†ÅÈÉΩÂú® UICollectionViewFlowLayout ÁöÑÂ≠êÁ±ª‰∏≠„ÄÇDecorationView ‰πüÊòØÁªßÊâø‰∫é UICollectionReusableView„ÄÇ ÂàõÂª∫‰∏Ä‰∏™ DecorationView ÂÆû‰æãDecorationView Èô§‰∫ÜÁªßÊâø‰∫é UICollectionReusableView ‰πãÂ§ñÂíåÊôÆÈÄö View ÁöÑÂàõÂª∫ÊØ´Êó†Â∑ÆÂºÇ„ÄÇÈáçÂÜôÂÆÉÁöÑ init ÊñπÊ≥ïÔºö 12345678910111213- (instancetype)initWithFrame:(CGRect)frame &#123; if (!(self = [super initWithFrame:frame])) &#123; return nil; &#125; _decorationView = [[UIView alloc] initWithFrame:frame]; _decorationView.backgroundColor = [UIColor blueColor]; [self addSubview:_decorationView]; return self;&#125;- (void)layoutSubviews &#123; _decorationView.frame = self.bounds;&#125; ÈáçÂÜô layoutAttributesForDecorationViewOfKind:atIndexPath:Â¶ÇÊûú‰Ω†ÊÑøÊÑèÔºå‰Ω†ÊÉ≥ËÆæÁΩÆÂ§öÂ∞ë‰∏™ DecorationView Â∞±ÂèØ‰ª•ËÆæÁΩÆÂ§öÂ∞ë‰∏™„ÄÇ‰∏ãÈù¢Â∞ÜÂÆûÁé∞‰∏∫Êüê‰∏™ section Ê∑ªÂä†‰∏Ä‰∏™ DecorationView ÁöÑËÉåÊôØÔºö 1234567891011121314- (UICollectionViewLayoutAttributes *)layoutAttributesForDecorationViewOfKind:(NSString *)elementKind atIndexPath:(NSIndexPath *)indexPath &#123; UICollectionViewLayoutAttributes *decorationAttributes = [UICollectionViewLayoutAttributes layoutAttributesForDecorationViewOfKind:elementKind withIndexPath:indexPath]; UICollectionViewLayoutAttributes *newDecorationAttributes = [decorationAttributes copy]; if ([elementKind isEqualToString:SIMPLEDECORATIONKIND]) &#123; NSIndexPath *indexPathFirst = [NSIndexPath indexPathForItem:0 inSection:1]; NSIndexPath *indexPathLast = [NSIndexPath indexPathForItem:[self.collectionView numberOfItemsInSection:1] inSection:1]; UICollectionViewLayoutAttributes *attrsFirst = [self layoutAttributesForItemAtIndexPath:indexPathFirst]; UICollectionViewLayoutAttributes *attrsLast = [self layoutAttributesForItemAtIndexPath:indexPathLast]; newDecorationAttributes.frame = CGRectMake(attrsFirst.frame.origin.x, attrsFirst.frame.origin.y, self.collectionView.frame.size.width, attrsLast.frame.origin.y-attrsFirst.frame.origin.y); // ÊÉ≥Ë¶Å‰Ωú‰∏∫ËÉåÊôØÂõæÂÉèÔºåÂ∞±‰∏ÄÂÆöË¶ÅÂ∞ÜÂÖ∂ zIndex ËÆæÁΩÆ‰∏∫ -1 newDecorationAttributes.zIndex = -1; &#125; return newDecorationAttributes;&#125; Ëøô‰∏™ÊñπÊ≥ï‰∏≠ÔºåÈÄöËøá section1 ‰∏≠ÊúÄÂêé‰∏Ä‰∏™ item ‰∏éÁ¨¨‰∏Ä‰∏™ itemÔºåËÆ°ÁÆóÂæóÂá∫‰∫Ü section ÁöÑÂ§ßÂ∞è‰ª•Âèä‰ΩçÁΩÆ„ÄÇÂ∞ÜËÆæÁΩÆ‰∏∫ UICollectionViewLayoutAttributes ÁöÑ frame Â±ûÊÄß„ÄÇ Áî±‰∫éÊòØËÉåÊôØÊâÄ‰ª•‰∏ÄÂÆöË¶ÅÂ∞ÜÂÖ∂ zIndex ËÆæÁΩÆ‰∏∫‰∏Ä‰∏™Ë¥üÂÄºÔºå‰ΩøÂÖ∂Ê∞∏ËøúÂú®ÂõæÂ±ÇÁöÑ‰∏ãÈÉ®„ÄÇ ËøôÈáåÂà§Êñ≠ÁöÑ SIMPLEDECORATIONKIND ÊòØ‰∏Ä‰∏™Ëá™Â∑±ËÆæÂÆöÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÁî®Êù•Ê†áËØÜÊòØÂì™‰∏™ DecorationView„ÄÇ ÂèØ‰ª•ÈÄöËøá [UICollectionViewLayoutAttributes layoutAttributesForDecorationViewOfKind:elementKind withIndexPath:indexPath] Ëøô‰∏™Á±ªÊñπÊ≥ïËé∑Âèñ‰∫Ü‰∏Ä‰∏™ÈªòËÆ§ÁöÑÂ∏ÉÂ±ÄÂ±ûÊÄßÁöÑÂÄºÔºà‰πãÂâçÊàë‰ª¨ÈÉΩÊòØÁî® super Ëé∑ÂèñÁöÑÔºâÔºåItem Âíå SupplementaryView ‰πüÊúâÁ±ª‰ººÁöÑÊñπÊ≥ïÔºö [UICollectionViewLayoutAttributes layoutAttributesForCellWithIndexPath:indexPath] [UICollectionViewLayoutAttributes layoutAttributesForSupplementaryViewOfKind:elementKind withIndexPath:indexPath] [UICollectionViewLayoutAttributes layoutAttributesForDecorationViewOfKind:elementKind withIndexPath:indexPath] Ê∑ªÂä†Â∏ÉÂ±ÄÂ±ûÊÄßÂú® layoutAttributesForElementsInRect: ‰∏≠Ë∞ÉÁî®‰∏äÈù¢ÁöÑÊñπÊ≥ïÔºåÂ∞ÜÂÖ∂Â±ûÊÄßÊ∑ªÂä†Âà∞Â∏ÉÂ±ÄÂ±ûÊÄßÊï∞ÁªÑ‰∏≠„ÄÇ 1234567891011- (NSArray&lt;UICollectionViewLayoutAttributes *&gt; *)layoutAttributesForElementsInRect:(CGRect)rect &#123; NSArray *array = [super layoutAttributesForElementsInRect:rect]; NSMutableArray *newArray = [NSMutableArray array]; // ËÆæÁΩÆ Item Âíå SupplementaryView ... // ËÆæÁΩÆ DecorationView UICollectionViewLayoutAttributes *newAttrs = [self layoutAttributesForDecorationViewOfKind:SIMPLEDECORATIONKIND atIndexPath:[NSIndexPath indexPathForItem:0 inSection:1]]; [newArray addObject:newAttrs]; return newArray;&#125; ÂàùÂßãÊñπÊ≥ï‰∏≠Ê≥®ÂÜåËá™Â∑±Áî±‰∫é DecorationView ÊòØÂíåÊï∞ÊçÆÊó†ÂÖ≥ÁöÑÔºå‰∏çÈúÄË¶ÅÂú® ViewController ‰∏≠Ê∑ªÂä†‰ªª‰Ωï‰ª£Á†Å„ÄÇÊàë‰ª¨Âú® UICollectionViewFlowLayout ‰∏≠Ê≥®ÂÜåËá™Â∑±Ôºö 123456789101112// SimpleCollectionViewFlowLayout.mstatic NSString *SIMPLEDECORATIONKIND = @"Simple Decoration Kind";- (instancetype)init &#123; if (!(self = [super init])) &#123; return nil; &#125; // layout ÁöÑÂÖ∂‰ªñÂàùÂßãÂåñËÆæÁΩÆ ... [self registerClass:[SimpleDecorationView class] forDecorationViewOfKind:SIMPLEDECORATIONKIND]; return self;&#125; ‰∏∫‰ªÄ‰πàË¶ÅÊ≥®ÂÜåÂë¢ÔºüÂõ†‰∏∫Â∏ÉÂ±ÄÂ±ûÊÄß‰∏≠Âè™Áü•ÈÅì kind Ëøô‰∏™Ê†áËØÜÁöÑÂ≠óÁ¨¶‰∏≤ÊòØ‰∏çË°åÁöÑÔºåË¶ÅÂ∞Ü kind Âíå class ÂÖ≥ËÅîËµ∑Êù•„ÄÇÊâÄ‰ª•ÈúÄË¶Å registerClass:forDecorationViewOfKind: Ëøô‰∏Ä‰∏™Ê≠•È™§„ÄÇItem Âíå SupplementaryView ÁöÑÊ≥®ÂÜå‰πüÊòØÁ±ª‰ººÁöÑÈÅìÁêÜÔºàËøô‰∏§‰∏™ÁöÑÊ≥®ÂÜåÊòØ‰∏∫‰∫Ü class ÂíåÈáçÁî®Êï∞ÁªÑÂÖ≥ËÅîËµ∑Êù•Ôºâ„ÄÇ ÊúÄÁªàÁöÑÊòæÁ§∫ÊïàÊûúÔºö UICollectionViewLayoutAttributes ÁöÑÂ±ûÊÄßÂ∏ÉÂ±ÄÂ±ûÊÄß UICollectionViewLayoutAttributes ÂåÖÂê´‰∫ÜËÆ∏Â§öÂ±ûÊÄßÔºö Frame Center Size 3D Transform Alpha Z-Index Hidden Element category ÔºàcellÔºåsupplementary viewÔºåor decoration viewÔºâ Element kind Ôºànil for cellsÔºâ ÊúÄÂêé‰∏§‰∏™Â±ûÊÄßÁî®Êù•Âà§Êñ≠ËßÜÂõæÁöÑÁ±ªÂûãÔºåËøô‰∏™Âú®‰πãÂâç‰πüÁî®Âà∞Ëøá‰∫Ü„ÄÇrepresentedElementCategory ÊòØ‰∏Ä‰∏™Êûö‰∏æÔºåÂåÖÂê´‰∫ÜË°®Á§∫ cellÔºåSupplementaryViewÔºåDecorationView ÁöÑÂá†‰∏™Êûö‰∏æÂÄº„ÄÇrepresentedElementKind ÂÖ∂ÂÆûÂ∞±ÊòØÊ≥®ÂÜå SupplementaryView Âíå DecorationView Êó∂ÂÄô‰º†ÂÖ•ÁöÑ kindÔºåÁî±‰∫é Item Ê≥®ÂÜåÁöÑÊó∂ÂÄô‰∏çÈúÄË¶Å‰º†ÂÖ• kindÔºåÊâÄ‰ª• Item Â∏ÉÂ±ÄÁöÑËøô‰∏™Â±ûÊÄßÂ∞±ÊòØ nil„ÄÇ ÁªßÊâø UICollectionViewLayout‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåËÉΩÁî® UICollectionViewFlowLayout ÁöÑÔºåÊàë‰ª¨Â∞±‰∏çÈúÄË¶ÅËá™Â∑±ÁªßÊâø UICollectionViewLayout„ÄÇ Êñ∞Âª∫‰∏Ä‰∏™Á±ªÁªßÊâø‰∫é UICollectionViewLayoutÔºåËØ•Á±ªÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ï prepareLayout Áî®Êù•ÂÅöÂ∏ÉÂ±ÄÂâçÁöÑÂáÜÂ§áÔºåÂú®ÊØèÊ¨°Â∏ÉÂ±ÄÁöÑÊó∂ÂÄôÈÉΩ‰ºöË∞ÉÁî®„ÄÇÊàë‰ª¨ÂèØ‰ª•Êää‰πãÂâçÂú® init ‰∏≠ÁöÑËÆæÁΩÆÊîæÂà∞Ëøô‰∏™ÊñπÊ≥ï‰∏≠Ôºö 1234567- (void)prepareLayout &#123; [super prepareLayout]; CGSize size = self.collectionView.bounds.size; _cellCount = [self.collectionView numberOfItemsInSection:0]; _center = CGPointMake(size.width/2, size.height/2); _radius = size.width/2.5;&#125; ÂêåÊ†∑ÁöÑÊàë‰ª¨ÈúÄË¶ÅÂÆûÁé∞ layoutAttributesForElementsInRect: Êù•Ëé∑ÂèñÂ∏ÉÂ±ÄÂ±ûÊÄßÔºö 12345678910111213141516- (NSArray&lt;UICollectionViewLayoutAttributes *&gt; *)layoutAttributesForElementsInRect:(CGRect)rect &#123; NSMutableArray *attrs = [NSMutableArray array]; for (int i = 0; i &lt; self.cellCount; i++) &#123; NSIndexPath *indexPath = [NSIndexPath indexPathForItem:i inSection:0]; [attrs addObject:[self layoutAttributesForItemAtIndexPath:indexPath]]; &#125; return attrs; &#125;- (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)indexPath &#123; UICollectionViewLayoutAttributes *attrs = [UICollectionViewLayoutAttributes layoutAttributesForCellWithIndexPath:indexPath]; attrs.size = CGSizeMake(70, 70); attrs.center = CGPointMake(self.center.x +self.radius * cosf(2 * indexPath.item * M_PI / self.cellCount -M_PI_2), self.center.y +self.radius * sinf(2 * indexPath.item * M_PI /self.cellCount - M_PI_2)); attrs.transform3D = CATransform3DMakeRotation(2 * M_PI *indexPath.item / self.cellCount, 0, 0, 1); return attrs;&#125; Âíå UICollectionViewFlowLayout ‰∏çÂêåÁöÑÊòØÔºåËøôÈáåÁöÑÊâÄÊúâÂ∏ÉÂ±ÄÂ±ûÊÄßÈÉΩÈúÄË¶ÅÊàë‰ª¨Ëá™Â∑±ÂÆûÁé∞ÔºåÊ≤°ÊúâÁà∂Á±ªÊñπÊ≥ïÂèØ‰ª•Ë∞ÉÁî®‰∫Ü„ÄÇÂè¶Â§ñÔºåÁî±‰∫é collectionView:sizeForItemAtIndexPath: Ëøô‰∏™Ëé∑Âèñ Item Â§ßÂ∞èÁöÑÊñπÊ≥ï‰πüÊòØ FlowLayout Êèê‰æõÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅËá™Â∑±ËÆæÁΩÆÂ∏ÉÂ±ÄÂ±ûÊÄßÁöÑ size„ÄÇ ### ‰∏Ä‰∏™‰æãÂ≠êÂ¶Ç‰ΩïÂ∞ÜÂ∏ÉÂ±ÄÂàáÊç¢Âà∞‰∏ãÈù¢Ëøô‰∏™ÂõæÁâáÁöÑÊïàÊûúÂë¢Ôºü‰∏ãÈù¢Â∞ÜÂàÜÊûêÂá†‰∏™Âü∫Êú¨ÁÇπÔºåÂÖ∑‰ΩìËØ¶ËßÅ Demo„ÄÇ ÂàáÊç¢Â∏ÉÂ±Ä‰∏Ä‰∏™ CollectionView ÂèØ‰ª•ÈÄöËøáÂÖ∂Ëá™Ë∫´ÁöÑ setCollectionViewLayout:animated: ÊñπÊ≥ïÈöèÊó∂ÂàáÊç¢Â∏ÉÂ±Ä„ÄÇÂú®ÂàáÊç¢Â∏ÉÂ±ÄÂêéÔºåÈúÄË¶ÅÈÄöËøá invalidateLayout ÊñπÊ≥ïÂà∑Êñ∞Êñ∞ËÆæÁΩÆÁöÑÂ∏ÉÂ±Ä„ÄÇ ‰∏ÄÂàóÂ±ïÁ§∫‰∏Ä‰∏™‰∏ÄÂàóÂ±ïÁ§∫‰∏Ä‰∏™Ôºå‰Ω†ÂèØ‰ª•ÈáçÂÜô Item ÁöÑÂ∏ÉÂ±ÄÊñπÊ≥ïÊâãÂä®ËÆ°ÁÆóÊØè‰∏Ä‰∏™ Item ÁöÑ frameÔºå‰ΩÜÊòØËøôÊòØÊ≤°ÊúâÂøÖË¶ÅÁöÑ„ÄÇUICollectionViewFlowLayout ÈªòËÆ§Âú®ÂΩìÂâçÂàó‰∏çËÉΩÊéí‰∏ã‰∏ã‰∏Ä‰∏™ Item ÁöÑÊó∂ÂÄôËá™Âä®Êç¢ÂàóÔºåÊâÄ‰ª•Êàë‰ª¨Âè™Ë¶ÅÂ∞Ü minimumInteritemSpacing ËÆæÁΩÆÁöÑÂæàÂ§ßÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ ËÆæÁΩÆÂ∏ÉÂ±ÄÂ±ûÊÄßÊàë‰ª¨Ë¶ÅÂØπÂú®Â±èÂπï‰∏äÊòæÁ§∫ÁöÑËßÜÂõæÔºåÊ†πÊçÆÂÖ∂ÊâÄÂú®ÁöÑ‰ΩçÁΩÆËÆæÁΩÆÂ∏ÉÂ±ÄÂ±ûÊÄß„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáËá™ÂÆö‰πâÁöÑ FlowLayout Á±ªÊãøÂà∞ CollectionView ÂÆû‰æãÁöÑ contentOffsetÔºàself.collectionView.contentOffset.xÔºâÔºåÁÑ∂ÂêéÂíåÂ∏ÉÂ±ÄÂ±ûÊÄßÁöÑ frame ËøõË°åÊØîËæÉ„ÄÇ 12345678910111213141516- (NSArray&lt;UICollectionViewLayoutAttributes *&gt; *)layoutAttributesForElementsInRect:(CGRect)rect &#123; NSArray *array = [super layoutAttributesForElementsInRect:rect]; NSMutableArray *newArray = [NSMutableArray array]; float centerX = self.collectionView.contentOffset.x + self.collectionView.bounds.size.width/2; for (UICollectionViewLayoutAttributes *attrs in array) &#123; UICollectionViewLayoutAttributes *newAttrs = [attrs copy]; if (newAttrs.representedElementCategory == UICollectionElementCategorySupplementaryView) &#123; continue; &#125; float offset = 1.5 - fabs(centerX - attrs.center.x)/self.collectionView.frame.size.width; newAttrs.transform = CGAffineTransformScale(newAttrs.transform, offset, offset); [newArray addObject:newAttrs]; &#125; return newArray;&#125; Âä®ÊÄÅËÆ°ÁÆóÂ∏ÉÂ±ÄÂ±ûÊÄßËé∑ÂèñÂ∏ÉÂ±ÄÂ±ûÊÄßÂè™‰ºöÂú®Âä†ËΩΩÁöÑÊó∂ÂÄôËøõË°å‰∏ÄÊ¨°ÔºåËÄåËøô‰∏™‰æãÂ≠êÈúÄË¶ÅÊó∂Êó∂Ê†πÊçÆ offset Êõ¥Êñ∞„ÄÇËøôÂ∞±ÈúÄË¶ÅÈáçÂÜô FlowLayout ÁöÑ shouldInvalidateLayoutForBoundsChange: ÊñπÊ≥ïÔºåÂπ∂ËøîÂõû YESÔºå‰øùËØÅÁî®Êà∑ÊªëÂä®ÁöÑÊó∂ÂÄôÔºåÂ∏ÉÂ±ÄÂ±ûÊÄßÁöÑÊñπÊ≥ïÊÄªÊòØ‰ºöÈáçÊñ∞ËÆ°ÁÆóÁöÑÔºö 123- (BOOL)shouldInvalidateLayoutForBoundsChange:(CGRect)newBounds &#123; return YES;&#125; ÊªëÂä®Âà∞ÁâπÂÆö‰ΩçÁΩÆËøô‰∏™‰æãÂ≠ê‰∏≠ÈúÄË¶ÅÂú®ÂÅúÊ≠¢ÊªëÂä®ÁöÑÊó∂ÂÄôÔºåÂõæÁâáÊÄªÊòØÂú®ÊúÄ‰∏≠Èó¥ÁöÑÔºåÈÇ£Â∞±ÈúÄË¶ÅÊîπÂèòÊúÄÁªàÁöÑ offset„ÄÇÂèØ‰ª•ÈáçÂÜô targetContentOffsetForProposedContentOffset:withScrollingVelocity:ÔºåËØ•ÊñπÊ≥ïËæìÂÖ•ÁêÜÊÉ≥ÊÉÖÂÜµ‰∏ãÁöÑ contentOffsetÔºåËøîÂõû‰∏Ä‰∏™Ëá™Â∑±ËÆæÂÆöÁöÑ contentOffset„ÄÇÂõ†Ê≠§Ôºå‰Ω†ÂèØ‰ª•ÊâæÂà∞Á¶ªÂ±èÂπï‰∏≠ÂøÉÊúÄËøëÁöÑÂ∏ÉÂ±ÄÂ±ûÊÄßÔºåÁÑ∂ÂêéËÆ°ÁÆóÂÖ∂‰∏é‰∏≠ÂøÉÁöÑÂ∑ÆÂÄº‰Ωú‰∏∫Ë°•ÂÅøÂÄºÔºö 1234567891011121314- (CGPoint)targetContentOffsetForProposedContentOffset:(CGPoint)proposedContentOffset withScrollingVelocity:(CGPoint)velocity &#123; CGRect proposedRect = CGRectMake(proposedContentOffset.x, 0, self.collectionView.bounds.size.width, self.collectionView.bounds.size.height); NSArray *array = [self layoutAttributesForElementsInRect:proposedRect]; float offset = 1000; for (UICollectionViewLayoutAttributes *attrs in array) &#123; if (attrs.representedElementCategory == UICollectionElementCategorySupplementaryView) &#123; continue; &#125; if (fabs(attrs.center.x - (proposedContentOffset.x+self.collectionView.bounds.size.width/2))&lt;fabs(offset)) &#123; offset = attrs.center.x - (proposedContentOffset.x+self.collectionView.bounds.size.width/2); &#125; &#125; return CGPointMake(proposedContentOffset.x + offset, proposedContentOffset.y);&#125; ÊÄªÁªì Êï¥‰∏™ CollectionView ÂèØ‰ª•ÂàíÂàÜ‰∏∫‰∏§‰∏™ÈÉ®ÂàÜÔºåËßÜÂõæÈÉ®ÂàÜÂíåÂ∏ÉÂ±ÄÈÉ®ÂàÜ„ÄÇËøô‰∏§ËÄÖÂ¶Ç‰ΩïËÅîÁ≥ªÂú®‰∏ÄËµ∑ÁöÑÔºåÊàñËÄÖËØ¥ÁªôÂÆö‰∏ÄÂùóÂå∫ÂüüÂà∞Â∫ïÊòØÂ¶Ç‰ΩïÁü•ÈÅìÂ∫îËØ•ÊòæÁ§∫Âì™‰∏™ËßÜÂõæÁöÑÂë¢ÔºüÈÄöËøá indexPath ‰ª•Âèä representedElementKind„ÄÇËøô‰∏§‰∏™ÈÉΩÊòØ UICollectionViewLayoutAttributes ‰∏≠ÁöÑÂ±ûÊÄß„ÄÇ Âú®ËßÜÂõæÂä†ËΩΩÁöÑÊó∂ÂÄôÔºå‰ºöÂú® layoutAttributesForElementsInRect ËøîÂõûÁöÑÊï∞ÁªÑ‰∏≠ÊâæÂà∞‰ºöÂú®Â±èÂπï‰∏äÊòæÁ§∫ÁöÑÂ∏ÉÂ±ÄÔºåÁÑ∂ÂêéÊ†πÊçÆËøô‰∏™Â∏ÉÂ±ÄÁöÑ indexPath ‰ª•Âèä representedElementKind ÈÄöËøá collectionView:viewForSupplementaryElementOfKind:atIndexPath,collectionView:cellForItemAtIndexPath Ëøô‰∏§‰∏™‰ª£ÁêÜÊñπÊ≥ïÔºåËé∑ÂèñÁõ∏ÂØπÂ∫îÁöÑËßÜÂõæÂ±ïÁ§∫Âá∫Êù•„ÄÇ ÈÇ£‰πà‰∏∫‰ªÄ‰πàÊúâ‰∫Ü indexPath ‰∫ÜËøòË¶Å representedElementKind Âë¢ÔºüÂØπ‰∫é Item Êù•ËØ¥ÔºåindexPath ÂèØ‰ª•ÈÄöËøá item Âíå section ÂîØ‰∏ÄÂú∞Á°ÆÂÆöËßÜÂõæ„ÄÇ‰ΩÜÊòØÂØπ‰∫é SupplementaryView ÁöÑ DecorationViewÔºåËøô‰∏§‰∏™ËßÜÂõæÈÄöÂ∏∏Âè™Áî®Âà∞‰∫Ü section ËÄå‰∏çÁî® itemÔºàÂÖ∂ÂÆû‰Ω†ÊÉ≥Áî® item Êù•Ê†áËØÜ‰πüÊòØÂèØ‰ª•ÁöÑÔºårepresentedElementKind ÂÖ∂ÂÆûÂ∞±Áõ∏ÂΩì‰∫éÊòØ‰∏™ item ÁöÑ‰ΩúÁî®„ÄÇÊØîÂ¶Ç‰∏Ä‰∏™ SupplementaryView ÁöÑÂ§¥Â∞æËßÜÂõæÔºå‰Ω†ÂèØ‰ª•ËßÑÂÆö item ‰∏∫0‰ª£Ë°®Â§¥ËßÜÂõæÔºåitem ‰∏∫1‰ª£Ë°®Â∞æËßÜÂõæÔºå‰ΩÜÊòØËøôÊ†∑ËÇØÂÆöÊ≤°ÊúâÁî® UICollectionElementKindSectionHeader,UICollectionElementKindSectionFooter Êù•ÁöÑÁõ¥ËßÇÔºâÔºåÊâÄ‰ª•Â∞±Ë¶ÅÁî®‰∏Ä‰∏™ representedElementKind Êù•Ê†áËØÜÂú®Âêå‰∏Ä‰∏™ section ÂÜÖÔºåËøô‰∏™‰ΩçÁΩÆÂà∞Â∫ïÊòØÂ∫îËØ•ÊòæÁ§∫Âì™‰∏™ËßÜÂõæ„ÄÇ ‰∏Ä‰∫õÂ∫îÁî®ÁßªÂä® ItemÈ¶ñÂÖàÔºåÂú® ViewController ‰∏≠‰∏∫ CollectionView Ê∑ªÂä†ÈïøÊåâÊâãÂäøÔºö 12345- (void)viewDidLoad &#123; ... UILongPressGestureRecognizer *longGesture = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(handlelongGesture:)]; [self.collectionView addGestureRecognizer:longGesture];&#125; ÂÆûÁé∞ÊâãÂäøÊìç‰ΩúÔºåÁÆóÊòØÊØîËæÉÂõ∫ÂÆöÁöÑÂ•óË∑ØÔºö 123456789101112131415161718192021222324252627//ÂÜçÂÆûÁé∞ÊâãÂäøÊìç‰Ωú- (void)handlelongGesture:(UILongPressGestureRecognizer *)longGesture &#123; //Âà§Êñ≠ÊâãÂäøÁä∂ÊÄÅ switch (longGesture.state) &#123; case UIGestureRecognizerStateBegan:&#123; //Âà§Êñ≠ÊâãÂäøËêΩÁÇπ‰ΩçÁΩÆÊòØÂê¶Âú®Ë∑ØÂæÑ‰∏ä NSIndexPath *indexPath = [self.collectionView indexPathForItemAtPoint:[longGesture locationInView:self.collectionView]]; if (indexPath == nil) &#123; break; &#125; //Âú®Ë∑ØÂæÑ‰∏äÂàôÂºÄÂßãÁßªÂä®ËØ•Ë∑ØÂæÑ‰∏äÁöÑcell [self.collectionView beginInteractiveMovementForItemAtIndexPath:indexPath]; &#125; break; case UIGestureRecognizerStateChanged: //ÁßªÂä®ËøáÁ®ãÂΩì‰∏≠ÈöèÊó∂Êõ¥Êñ∞cell‰ΩçÁΩÆ [self.collectionView updateInteractiveMovementTargetPosition:[longGesture locationInView:self.collectionView]]; break; case UIGestureRecognizerStateEnded: //ÁßªÂä®ÁªìÊùüÂêéÂÖ≥Èó≠cellÁßªÂä® [self.collectionView endInteractiveMovement]; break; default: [self.collectionView cancelInteractiveMovement]; break; &#125;&#125; ÂÖ∂‰∏≠ CollectionView Êèê‰æõ‰∫Ü indexPathForItemAtPoint: ÊñπÊ≥ïÈÄöËøáÂùêÊ†áÊâæÂà∞ÂØπÂ∫îÁöÑ Item„ÄÇ Âú® CollectionView ‰∏≠ÂÖÅËÆ∏ Item ÁßªÂä®Ôºö 12345678//ËøîÂõûYESÂÖÅËÆ∏ÂÖ∂itemÁßªÂä®- (BOOL)collectionView:(UICollectionView *)collectionView canMoveItemAtIndexPath:(NSIndexPath *)indexPath&#123; return YES;&#125;//ÁßªÂä®itemÊó∂ÂõûË∞É- (void)collectionView:(UICollectionView *)collectionView moveItemAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath*)destinationIndexPath &#123;&#125; ÁÇπÂáª Item È´ò‰∫ÆÊìç‰ΩúÂÆûÁé∞ÊñπÂºèÊòØÂú®È´ò‰∫ÆÁöÑÂõûË∞ÉÊñπÊ≥ï‰∏≠Ëé∑ÂèñÂΩìÂâçÁÇπÂáªÁöÑ ItemÔºåÁÑ∂ÂêéÂØπÂÖ∂Â∏ÉÂ±ÄÂ±ûÊÄßËøõË°å‰øÆÊîπÔºö 12345678910111213141516171819// ÂÖÅËÆ∏ÈÄâ‰∏≠Êó∂ÔºåÈ´ò‰∫Æ-(BOOL)collectionView:(UICollectionView *)collectionView shouldHighlightItemAtIndexPath:(NSIndexPath *)indexPath&#123; return YES;&#125;// È´ò‰∫ÆÂÆåÊàêÂêéÂõûË∞É// ÊîæÂ§ßÁº©Â∞èÊïàÊûú-(void)collectionView:(UICollectionView *)collectionView didHighlightItemAtIndexPath:(NSIndexPath *)indexPath&#123; UICollectionViewCell *selectedCell = [collectionView cellForItemAtIndexPath:indexPath]; [UIView animateWithDuration:1 animations:^&#123; selectedCell.transform = CGAffineTransformMakeScale(2.0f, 2.0f); &#125;];&#125;// Áî±È´ò‰∫ÆËΩ¨ÊàêÈùûÈ´ò‰∫ÆÂÆåÊàêÊó∂ÁöÑÂõûË∞É-(void)collectionView:(UICollectionView *)collectionView didUnhighlightItemAtIndexPath:(NSIndexPath *)indexPath&#123; UICollectionViewCell *selectedCell = [collectionView cellForItemAtIndexPath:indexPath]; [UIView animateWithDuration:1 animations:^&#123; selectedCell.transform = CGAffineTransformMakeScale(1.0f, 1.0f); &#125;];&#125; Êó†ÈôêËΩÆÊí≠Êó†ÈôêËΩÆÊí≠ÁöÑ‰∏ªË¶ÅÊñπÊ≥ïÂ∞±ÊòØÂ∞Ü CollectionView ÁöÑ Item ËÆæÁΩÆÁöÑË∂≥Â§üÂ§ö‰ª•Ëá≥‰∫éËÆ©Áî®Êà∑‰∏çËÉΩ‰∏Ä‰∏ãÂ≠êÊªöÂä®Âà∞Â∫ïÈÉ®„ÄÇÂπ∂‰∏îÔºåÂú®ÊªëÂä®Âà∞‰∏¥ÁïåÂå∫ÁöÑÊó∂ÂÄô‰øÆÊîπÂô® contentOffset. ÂàùÂßãÂåñÊØîÂ¶ÇË¶ÅÂÆûÁé∞‰∏Ä‰∏™ÂõæÁâáÁöÑËΩÆÊí≠Ôºåcollectionview ‰º†ÂÖ•‰∫Ü‰∏ÄÁªÑ urlÔºö 1234567891011121314151617181920212223242526- (instancetype)initWithURLs:(NSArray &lt;NSURL *&gt; *)urls &#123; // UICollectionViewFlowLayout self = [super initWithFrame:CGRectZero collectionViewLayout:[[LoopViewLayout alloc] init]]; if (self) &#123; _urls = urls; self.dataSource = self; self.delegate = self; // Ëá™ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ LoopViewCell ÂÖ∑‰ΩìÂ∏ÉÂ±ÄÊåâÁÖßÂÆûÈôÖÊÉÖÂÜµËÆæÁΩÆ [self registerClass:[LoopViewCell class] forCellWithReuseIdentifier:loopViewCellId]; // ÂàùÂßãÊòæÁ§∫Á¨¨‰∫åÁªÑ [0,1,2] [3(_urls.count),4,5] // ‰∏ªÈòüÂàóÔºö // 1. ÂÆâÊéí‰ªªÂä°Âú®‰∏ªÁ∫øÁ®ã‰∏äÊâßË°å // 2. Â¶ÇÊûú‰∏ªÁ∫øÁ®ãÂΩìÂâçÊúâ‰ªªÂä°Ôºå‰∏ªÈòüÂàóÊöÇÊó∂‰∏çË∞ÉÂ∫¶‰ªªÂä°ÔºÅÊâÄ‰ª•Á≠âcellÁöÑÊï∞ÊçÆÊ∫êÂíå‰ª£ÁêÜÊñπÊ≥ïÊâßË°åÂÆåÊØïÂêéÊâçÊâßË°åËøô‰∏™blockÈáåÈù¢ÁöÑÊªöÂä®‰ªªÂä°. dispatch_async(dispatch_get_main_queue(), ^&#123; NSIndexPath *indexPath = [NSIndexPath indexPathForItem:_urls.count inSection:0]; // ÊªöÂä®‰ΩçÁΩÆÔºÅ [self scrollToItemAtIndexPath:indexPath atScrollPosition:UICollectionViewScrollPositionLeft animated:NO]; &#125;); &#125; return self;&#125; ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÂÖàÂ∞Ü collectionview ÊªöÂä®Âà∞Á¨¨‰∫åÁªÑÁöÑÁ¨¨‰∏Ä‰∏™cell„ÄÇ ËÆæÁΩÆcell‰∏™Êï∞1234- (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section &#123; //ËøôÈáå‰∏∫‰∫ÜÈò≤Ê≠¢ÊªöÂä®Âà∞ÊúÄÂêé‰∏ÄÈ°µÊù•ÂõûË∑≥Âä®ÂØºËá¥ÁöÑÂç°È°ø,Â§öÂÜôÁÇπÁªÑÊï∞ËÆ©‰∏ÄÁõ¥Âà∞‰∏ç‰∫ÜÊúÄÂêé‰∏ÄÁªÑ,Âõ†‰∏∫cellÈáçÁî®,ÊâÄ‰ª•‰∏çÂΩ±ÂìçÂÜÖÂ≠ò. return _urls.count * 100;&#125; Èò≤Ê≠¢ÊªöÂä®Â§™Â§öÂºïËµ∑Âç°È°øÔºåÊâÄ‰ª•Â∞ÜÊï∞ÈáèËÆæÁΩÆÁöÑÂæàÂ§ß ËæπÁïåËÆæÁΩÆ123456789101112131415161718#pragma mark - UICollectionViewDelegate- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView &#123; // 1. Ëé∑ÂèñÂΩìÂâçÂÅúÊ≠¢ÁöÑÈ°µÈù¢ NSInteger offset = scrollView.contentOffset.x / scrollView.bounds.size.width; // 2. Á¨¨0È°µÔºåË∞ÉËΩ¨Âà∞ÔºåÁ¨¨1ÁªÑÁöÑÁ¨¨0È°µ // ÊúÄÂêé‰∏ÄÈ°µÔºåË∑≥ËΩ¨Âà∞Á¨¨0ÁªÑÁöÑÊúÄÂêé‰∏ÄÈ°µ if (offset == 0 || offset == ([self numberOfItemsInSection:0] - 1)) &#123;// NSLog(@"%zd", offset); // Á¨¨ 0 È°µ if (offset == 0) &#123; offset = _urls.count; &#125; else &#123; offset = _urls.count - 1; &#125; // ÈáçÊñ∞Ë∞ÉÊï¥ contentOffset scrollView.contentOffset = CGPointMake(offset * scrollView.bounds.size.width, 0); &#125;&#125; Ëá™Ë°åÊåâÁÖßÊÉÖÂÜµËÆæÁΩÆ contentOffse ÊµÅÂºèÂ∏ÉÂ±ÄÂÖ∂ÂÆûÂ∞±ÊòØÂú® prepareLayout ÊñπÊ≥ï‰∏≠ÔºåËá™ÂÆö‰πâ‰∫ÜÊØè‰∏Ä‰∏™ Item ÁöÑÂ∏ÉÂ±ÄÂ±ûÊÄß„ÄÇ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364@interface MyLayout : UICollectionViewFlowLayout@property(nonatomic,assign)int itemCount;@end @interface MyLayout()@property (nonatomic,assign) CGFloat maxHeight;@end@implementation MyLayout&#123; //Ëøô‰∏™Êï∞ÁªÑÂ∞±ÊòØÊàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂ∏ÉÂ±ÄÈÖçÁΩÆÊï∞ÁªÑ NSMutableArray * _attributeAttay;&#125;//Êï∞ÁªÑÁöÑÁõ∏ÂÖ≥ËÆæÁΩÆÂú®Ëøô‰∏™ÊñπÊ≥ï‰∏≠//Â∏ÉÂ±ÄÂâçÁöÑÂáÜÂ§á‰ºöË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ï-(void)prepareLayout&#123; _attributeAttay = [[NSMutableArray alloc]init]; [super prepareLayout]; //ÊºîÁ§∫Êñπ‰æø Êàë‰ª¨ËÆæÁΩÆ‰∏∫ÈùôÊÄÅÁöÑ2Âàó //ËÆ°ÁÆóÊØè‰∏Ä‰∏™itemÁöÑÂÆΩÂ∫¶ float WIDTH = ([UIScreen mainScreen].bounds.size.width-self.sectionInset.left-self.sectionInset.right-self.minimumInteritemSpacing)/2; //ÂÆö‰πâÊï∞ÁªÑ‰øùÂ≠òÊØè‰∏ÄÂàóÁöÑÈ´òÂ∫¶ //Ëøô‰∏™Êï∞ÁªÑÁöÑ‰∏ªË¶Å‰ΩúÁî®ÊòØ‰øùÂ≠òÊØè‰∏ÄÂàóÁöÑÊÄªÈ´òÂ∫¶ÔºåËøôÊ†∑Âú®Â∏ÉÂ±ÄÊó∂ÔºåÊàë‰ª¨ÂèØ‰ª•ÂßãÁªàÂ∞Ü‰∏ã‰∏Ä‰∏™ItemÊîæÂú®ÊúÄÁü≠ÁöÑÂàó‰∏ãÈù¢ CGFloat colHight[2]=&#123;self.sectionInset.top,self.sectionInset.bottom&#125;; //itemCountÊòØÂ§ñÁïå‰º†ËøõÊù•ÁöÑitemÁöÑ‰∏™Êï∞ ÈÅçÂéÜÊù•ËÆæÁΩÆÊØè‰∏Ä‰∏™itemÁöÑÂ∏ÉÂ±Ä for (int i=0; i&lt;_itemCount; i++) &#123; //ËÆæÁΩÆÊØè‰∏™itemÁöÑ‰ΩçÁΩÆÁ≠âÁõ∏ÂÖ≥Â±ûÊÄß NSIndexPath *index = [NSIndexPath indexPathForItem:i inSection:0]; //ÂàõÂª∫‰∏Ä‰∏™Â∏ÉÂ±ÄÂ±ûÊÄßÁ±ªÔºåÈÄöËøáindexPathÊù•ÂàõÂª∫ UICollectionViewLayoutAttributes * attris = [UICollectionViewLayoutAttributes layoutAttributesForCellWithIndexPath:index]; //ÈöèÊú∫‰∏Ä‰∏™È´òÂ∫¶ Âú®40‚Äî‚Äî190‰πãÈó¥ CGFloat hight = arc4random()%150+40; //Âì™‰∏ÄÂàóÈ´òÂ∫¶Â∞è ÂàôÊîæÂà∞ÈÇ£‰∏ÄÂàó‰∏ãÈù¢ //Ê†áËÆ∞ÊúÄÁü≠ÁöÑÂàó int width=0; if (colHight[0]&lt;colHight[1]) &#123; //Â∞ÜÊñ∞ÁöÑitemÈ´òÂ∫¶Âä†ÂÖ•Âà∞Áü≠ÁöÑ‰∏ÄÂàó colHight[0] = colHight[0]+hight+self.minimumLineSpacing; width=0; &#125;else&#123; colHight[1] = colHight[1]+hight+self.minimumLineSpacing; width=1; &#125; //ËÆæÁΩÆitemÁöÑ‰ΩçÁΩÆ attris.frame = CGRectMake(self.sectionInset.left+(self.minimumInteritemSpacing+WIDTH)*width, colHight[width]-hight-self.minimumLineSpacing, WIDTH, hight); [_attributeAttay addObject:attris]; &#125; if (colHight[0]&gt;colHight[1]) &#123; _maxHeight = colHight[0]; &#125;else&#123; _maxHeight = colHight[1]; &#125; &#125;-(CGSize)collectionViewContentSize&#123; return CGSizeMake(100, _maxHeight);&#125;//Ëøô‰∏™ÊñπÊ≥ï‰∏≠ËøîÂõûÊàë‰ª¨ÁöÑÂ∏ÉÂ±ÄÊï∞ÁªÑ-(NSArray&lt;UICollectionViewLayoutAttributes *&gt; *)layoutAttributesForElementsInRect:(CGRect)rect&#123; return _attributeAttay;&#125;@end Êú¨ÊñáDemo]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Âü∫Êú¨Êéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËÆ∞Á¨¨‰∏ÄÊ¨°Èù¢ËØï]]></title>
    <url>%2F2017%2F07%2F25%2F%E7%AC%AC%E4%B8%80%E6%AC%A1%E9%9D%A2%E8%AF%95%2F</url>
    <content type="text"><![CDATA[Á¨¨‰∏ÄÊ¨°Èù¢ËØïÁªìÊùüÔºåÂøÉÈáå‰∫îÂë≥ÊùÇÈôà„ÄÇ ‰∏ä‰∏äÂë®bangÁ™ÅÁÑ∂ÊâæÂà∞ÊàëÔºåËØ¥ÊàëÂçöÂÆ¢ÂÜôÁöÑ‰∏çÈîôÔºåÈóÆÊàëÊúâÊ≤°ÊúâÂÖ¥Ë∂£ÂéªËöÇËöÅÈáëÊúç„ÄÇÁúãÂà∞Ê∂àÊÅØÊàëÊòØÂç≥ÂÖ¥Â•ãÂèàÂøêÂøëÁöÑ„ÄÇÂΩìÁÑ∂ËøôÊòØ‰∏Ä‰∏™Â•ΩÊú∫‰ºöÔºå‰ΩÜÊòØÊàëÂèàÂÆ≥ÊÄïËá™Ë∫´ËÉΩÂäõ‰∏çË∂≥Êµ™Ë¥π‰∫Ü‰∫∫ÂÆ∂ÁöÑÂ•ΩÊÑè„ÄÇÁî±‰∫éÊØï‰∏öÂâç‰∏ÄÁõ¥ÈÉΩÊòØÁ†îÁ©∂ androidÔºå‰ªéÂéªÂπ¥7ÊúàÊØï‰∏öÂºÄÂßãÂ≠¶‰π† oc Âà∞Áé∞Âú®ÔºåÊàë‰πüÂ∞±ÊÄªÂÖ±Â≠¶‰π†‰∫Ü‰∏ÄÂπ¥„ÄÇÂèØ‰ª•ËØ¥ÁªèÈ™åÈùûÂ∏∏ÁöÑÊµÖÔºåÂêÑÊñπÈù¢Êé•Ëß¶ËøáÁöÑ‰∏úË•ø‰πü‰∏•Èáç‰∏çË∂≥„ÄÇÊØèÊØèÁúãÂà∞ÁΩë‰∏ä‰∏Ä‰∫õÂíåÊàëÂêåÈæÑÁöÑ‰∫∫ÁöÑÂçöÂÆ¢ÔºåÈÉΩÊúâÁßçËá™ÊÉ≠ÂΩ¢ÁßΩÁöÑÊÑüËßâ„ÄÇÊÑüÂèπÂΩìÊó∂‰∏∫‰ªÄ‰πàË¶Å‰ªé android ËΩ¨Âà∞ iOSÔºåÁôΩÁôΩÊµ™Ë¥π‰∫Ü‰∏ÄÂπ¥ÁöÑÊó∂Èó¥„ÄÇ Ëøô‰∏ÄÊ¨°ÁöÑÈù¢ËØï‰πüÊòØÊàëÁ¨¨‰∏ÄÊ¨°Ê≠£ÂºèÁöÑÈù¢ËØïÔºåÁÆÄÂéÜ‰πãÂâçÈÉΩÊ≤°ÊúâÂÜôËøáÔºå‰πü‰∏çÁü•ÈÅìÈù¢ËØïÁöÑÊó∂ÂÄô‰ºöÈóÆ‰ªÄ‰πàÔºåÂèØ‰ª•ËØ¥ÈùûÂ∏∏ÁöÑËå´ÁÑ∂Ôºå‰∏çËøá‰πüÊòØÁ°¨ÁùÄÂ§¥ÁöÆ‰∏ä‰∫Ü„ÄÇÁ¨¨‰∏ÄÈù¢ÁöÑÊó∂ÂÄôÊ≥¢Êæú‰∏çÊÉäÂêßÔºåÈóÆÁöÑÈÉΩÊòØ oc Âü∫Á°ÄÁöÑ‰∏úË•øÔºå‰πüÊòØËøô‰∏ÄÂπ¥ÈáåÊúÄÂºÄÂßãÂ≠¶ÁöÑ‰∏úË•ø„ÄÇ‰ªäÂ§©Êó©‰∏äÊé•Âà∞‰∫ÜÁ¨¨‰∫åÈù¢ÔºåÂºÄÂßãÈóÆ‰∏Ä‰∫õÈ°πÁõÆÈáåÁöÑÈóÆÈ¢ò„ÄÇËôΩÁÑ∂‰πüÈÉΩÊòØÂæàÂü∫Á°ÄÁöÑÈóÆÈ¢òÔºåÂèØ‰ª•ËØ¥ÊòØÁî®ËøáÂ∞±‰ºöÁöÑ‰∏úË•øÔºå‰ΩÜÊòØ‚Ä¶..ÂÅèÂÅèÊàëÂπ∂Ê≤°ÊúâÁî®Ëøá„ÄÇÂìé„ÄÇÁÑ∂ÂêéË∂äÈóÆË∂äÁ¥ßÂº†Ôºå‰∏Ä‰∫õÂéüÊú¨Áü•ÈÅìÁöÑ‰∏úË•ø‰πüÂèòÂæóÊîØÊîØÂêæÂêæÁöÑ‰∫Ü„ÄÇË°®Áé∞ÈùûÂ∏∏ÁöÑÁ≥üÁ≥ï„ÄÇ ËØ¥ÂÆûËØùÔºåÂøÉÈáåËøòÊòØÂæàÈöæËøáÁöÑ„ÄÇÊØïÁ´üËøôÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Â•ΩÁöÑÊú∫‰ºöÔºåËÄå‰∏îÊú¨Ë∫´ËßâÂæóÂú®Áé∞Âú®ÂÖ¨Âè∏Â≠¶‰∏çÂà∞‰ªÄ‰πà‰πüÁäπË±´ÊòØ‰∏çÊòØË¶ÅÊç¢Â∑•‰Ωú„ÄÇ‰ΩÜÊòØËøòÊòØËá™Â∑±Â§™Âº±‰∫ÜÂïäÔºåËøû‰∏Ä‰∫õÂü∫Êú¨ÁöÑ‰∏úË•øÈÉΩÊ≤°ÊúâÁúãËøáÔºå‰πüÊÄ™‰∏çÂæóÂà´‰∫∫„ÄÇ Â§±Ë¥•‰∫ÜÂ∞±Â§±Ë¥•‰∫ÜÂêß„ÄÇËøô‰∏ÄÊ¨°Â§±Ë¥•‰πüËÆ©ÊàëÊÑèËØÜÂà∞‰∫ÜÈïøË∑ØÊº´Êº´ÔºåËøòÈúÄË¶Å‰∏çÊñ≠ÁöÑÂ≠¶‰π†„ÄÇ‰∏ÄÂπ¥ÁöÑÊó∂Èó¥ÔºåÊî∂Ëé∑‰∏çÂ∞ëÔºå‰ΩÜÊòØËµ∑ÁÇπÂ§™‰ΩéÔºåÊó∂Èó¥Â§™Áü≠ÔºåÊâÄ‰ª•Ë∑ëÁöÑÊ≤°ÊúâÂà´‰∫∫Ëøú„ÄÇ‰ΩÜÊòØÔºåÂè™Ë¶ÅËÉΩ‰øùÊåÅÁùÄÊØîÂà´‰∫∫Êõ¥È´òÁöÑÈÄüÂ∫¶ÔºåÂ∞±‰∏ÄÂÆöËÉΩÂú®Êú™Êù•ÁöÑÊüê‰∏ÄÂ§©Ëµ∂Ë∂Ö‰∏äÂéª„ÄÇ Âπ≤‰ªñÂ¶àÁöÑÔºÅ]]></content>
      <categories>
        <category>Êó†Â§ÑÁΩÆÊîæ</category>
      </categories>
      <tags>
        <tag>ÊùÇË∞à</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Swift Âíå OC ÁöÑÊ∑∑ÁºñÂÆûË∑µ]]></title>
    <url>%2F2017%2F07%2F05%2FSwift%E5%92%8COC%E7%9A%84%E6%B7%B7%E7%BC%96%E5%AE%9E%E8%B7%B5%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÊÉ≥Áî® Swift ÈáçÂÜôÈ°πÁõÆÔºåÊé•Ëß¶‰∫Ü‰∏Ä‰∏ã OC Âíå Swift ÁöÑÊ∑∑ÁºñÊäÄÂ∑ßÔºåÂèëÁé∞ÂùëËøòÊòØÊå∫Â§öÁöÑ„ÄÇÂ∞§ÂÖ∂ÊòØ‰ΩøÁî® cocoapods ÂØºÂÖ•ÁöÑÂ∫ìÁöÑÊ∑∑Áºñ„ÄÇËøôÈáåËÆ∞ÂΩï‰∏Ä‰∏ãÂêÑÁßçÂ∫îÁî®Âú∫ÊôØ„ÄÇ ‰∏ªÂ∑•Á®ã‰∏≠‰ΩøÁî®Swift ‰∏≠Ë∞ÉÁî® OCÈ¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™ OC ÁöÑÈ°πÁõÆÔºåÁÑ∂ÂêéÁõ¥Êé•Âú®Â∑•Á®ãÈáåÊ∑ªÂä† Swift Êñá‰ª∂„ÄÇÊ≠§Êó∂‰ºöÂºπÂá∫‰∏Ä‰∏™ÊèêÁ§∫ÔºåÈóÆ‰Ω†ÊòØÂê¶Ê∑ªÂä†‰∏Ä‰∏™Ê°•Êé•Êñá‰ª∂Ôºå‰Ω†ÈúÄË¶ÅËá™Â∑±Ê∑ªÂä†Ë¶ÅÊö¥Èú≤Áªô Swift ‰ΩøÁî®ÁöÑ OC ÁöÑÂ§¥Êñá‰ª∂„ÄÇ Ëá™Âä®Â∏Æ‰Ω†ÂàõÂª∫ÁöÑÔºå‰∏çË¶ÅÁôΩ‰∏çË¶ÅÂïäÔºåÊâÄ‰ª•ÊûúÊñ≠ÁÇπÂáª create„ÄÇ Ëøô‰∏™Êó∂ÂÄôÂ∞±‰ºöÁîüÊàê‰∏Ä‰∏™ È°πÁõÆÂêç-Bridgeing-Header.h ÁöÑÂ§¥Êñá‰ª∂Ôºö ÂΩìÁÑ∂Ôºå‰Ω†‰πüÂèØ‰ª•Ëá™Â∑±ÂàõÂª∫‰∏éËÆæÁΩÆÔºåÂú® Build Settings ‰∏≠ËÆæÁΩÆÔºö Áé∞Âú®Âú®Ê°•Êé•Êñá‰ª∂‰∏≠Ê∑ªÂä†Ë¶ÅÊö¥Èú≤Áªô Swift Ë∞ÉÁî®ÁöÑÂ§¥Êñá‰ª∂Ôºö ÁÑ∂ÂêéÂú® Swift ‰∏≠Ë∞ÉÁî®Âç≥ÂèØÔºåÈùûÂ∏∏ÁöÑ easyÔºö OC ‰∏≠Ë∞ÉÁî® SwiftOC ‰∏≠Ë¶ÅË∞ÉÁî® Swift ‰πüË¶ÅÂØºÂÖ•‰∏Ä‰∏™Â§¥Êñá‰ª∂ÔºåËøô‰∏™Â§¥Êñá‰ª∂ÂØπÂ§ñ‰∏çÂèØÊòæÁ§∫ÔºåÂÖ∂ÂëΩÂêçÊñπÂºèÊòØÔºöÊ®°ÂùóÂêç-Swift.h„ÄÇÂèØ‰ª•Âú® Build setting ‰∏≠Êü•ÁúãÔºö Áé∞Âú®Êàë‰ª¨Âú® OC ‰∏≠Ê∑ªÂä†Ëøô‰∏™Â§¥Êñá‰ª∂Ôºö ÊØîËæÉ OC Âíå Swift ÁöÑË∞ÉÁî®ÊñπÂºèËøòÊòØ‰∏çÂêåÁöÑÔºåÊàë‰ª¨ÈúÄË¶ÅÊü•Áúã‰∏Ä‰∏ãÂà∞Â∫ïÂèØ‰ª•Ë∞ÉÁî®ÈÇ£‰∫õÊñπÊ≥ïÂíåÁ±ª„ÄÇËøô‰∏™Êó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•ÁÇπËøõËøô‰∏™Â§¥Êñá‰ª∂‰∏≠Âéª„ÄÇËøõÂÖ•Â§¥Êñá‰ª∂ÂæÄ‰∏ãÊãâÔºåÂèØ‰ª•ÁúãÂà∞Êö¥Èú≤Âá∫Êù•ÁöÑ Swift ÁöÑÁ±ªÂêçÂíåÊñπÊ≥ïÔºö Ê∂âÂèä cocoapods‰∏äÈù¢ÂÆåÂÖ®ÊòØ‰∏ªÂ∑•Á®ãÈáå‰ΩøÁî®ÂΩìÁÑ∂ÊØ´Êó†ÈöæÂ∫¶Ôºå‰ΩÜÊòØÊó•Â∏∏ÁöÑÂºÄÂèë‰∏≠ËÇØÂÆöË¶ÅÁî®Âà∞ÂÖ∂‰ªñÁöÑÂà´‰∫∫ÁöÑÂ∫ìÔºåÊàñËÄÖËá™Âª∫ÁöÑÁßÅÊúâÂ∫ìÔºåËøô‰∏™Êó∂ÂÄôÊÄé‰πàÊ∑∑ÁºñÂë¢ÔºüÊàë‰ª¨ÂÖàÁî® pod lib create OCWithSwift ÂëΩ‰ª§ÂàõÂª∫‰∏Ä‰∏™Á±ªÂ∫ì„ÄÇÁÑ∂ÂêéÂú®ÂÖ∂‰∏≠ÂàÜÂà´Ê∑ªÂä†‰∏Ä‰∏™ Swift Êñá‰ª∂Âíå‰∏Ä‰∏™ OC Êñá‰ª∂Ôºö Â∫ì‰∏≠ Swift Ë∞ÉÁî® OCÂ∫ì‰∏≠ Swift Ë∞ÉÁî® OC Âíå‰∏ªÂ∑•Á®ã‰∏≠Êúâ‰ªÄ‰πà‰∏çÂêåÂë¢ÔºüÊàë‰ª¨ÂÖàÂà∞ Build Settings ‰∏≠Êü•ÁúãËøô‰∏™Â§¥Êñá‰ª∂Â∫îËØ•Âè´‰ªÄ‰πàÔºö ÂèëÁé∞‰ªÄ‰πà‰πüÊ≤°Êúâ„ÄÇËøô‰∏™Êó∂ÂÄôÂçÉ‰∏á‰∏çË¶ÅÊâãË¥±ÂéªÂàõÂª∫‰∏Ä‰∏™ÔºåÂíå‰∏ªÂ∑•Á®ã‰∏≠‰∏çÂêåÁöÑÊòØÔºå‰ΩøÁî®cocoapods ÂàõÂª∫ÁöÑÂ∫ìÈáåÈù¢Êàë‰ª¨‰∏çÈúÄË¶ÅËá™Â∑±ÂàõÂª∫Ëøô‰∏™Ê°•Êé•Êñá‰ª∂‰∫Ü„ÄÇÁé∞Âú®Áõ¥Êé•Âú® Swift Êñá‰ª∂‰∏≠Ë∞ÉÁî®ÔºåÂèØ‰ª•‰ΩøÁî® OC ÁöÑÁ±ªÂíåÊñπÊ≥ïÔºö Êàë‰ª¨ÁÇπËøõËøô‰∏™Á±ª‰∏≠ÔºåÂèëÁé∞ Xcode Â∑≤ÁªèËá™Âä®ÁîüÊàê‰∫ÜËøô‰∏™ OC Êñá‰ª∂ÁöÑ Swift ‰ª£Á†ÅÔºö ÈÇ£‰πàËøôÊòØ‰∏∫‰ªÄ‰πàÂë¢ÔºüÊêúÁ¥¢‰∏Ä‰∏ãÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞Âú® OCWithSwift-umbrella.h ‰∏≠ÂºïÁî®‰∫ÜËøô‰∏™ OC Êñá‰ª∂„ÄÇÊâÄ‰ª•Ëøô‰∏™Â§¥Êñá‰ª∂ÂÖ∂ÂÆûÂ∞±ÊòØÂÅö‰∫ÜÊ°•Êé•ÁöÑ‰ΩúÁî®ÔºåÂ∫îËØ•ÊòØÁî± cocoapods ËÆæÁΩÆÁöÑÔºö ‰∏∫‰∫ÜÊµãËØïÔºåÊàë‰ª¨ÂÜçÂàõÂª∫‰∏Ä‰∏™ OC Êñá‰ª∂ OCFile_2.hÔºåÁÑ∂ÂêéÂêåÊ†∑ÂØºÂÖ•Âà∞ OCWithSwift-umbrella.h: Ëøô‰∏™Êó∂ÂÄôÁºñËØëÔºåÊä•Âá∫ÂºÇÂ∏∏Ôºö Êàë‰ª¨ÈúÄË¶ÅÂÅöÁöÑÂ∞±ÊòØÂ∞ÜËøô‰∏™Êñá‰ª∂ËÆæÁΩÆ‰∏∫ PublicÔºö Áé∞Âú®ÂÜçÁºñËØëÂ∞±Ê≤°ÊúâÈóÆÈ¢ò‰∫Ü„ÄÇÂèØ‰ª•Áõ¥Êé•Âú® Swift ‰∏≠‰ΩøÁî®Ôºö Â∫ì‰∏≠ OC Ë∞ÉÂä® SwiftÂ∫ì‰∏≠ OC Ë∞ÉÁî® Swift ÁöÑËøáÁ®ãËøòÊòØÂ§ßËá¥Áõ∏ÂêåÁöÑ„ÄÇÂÖàÁúãÁúã Build SettingsÔºö Êàë‰ª¨Âú® OC Êñá‰ª∂‰∏≠ÂºïÂÖ•Ôºå‰∏çËøáËøôÊ¨°Ë¶ÅÂºïÂÖ•ÁöÑÊ†ºÂºè‰∏∫ #import &lt;‰∫ßÂìÅÂêç/Ê®°ÂùóÂêç-Swift.h&gt;ÔºåÊàë‰ª¨ËøòÊòØÂèØ‰ª•Âú® Build Settings ‰∏≠Êü•ÁúãÔºö Áé∞Âú®Âú® OC ‰∏≠‰ΩøÁî®ÔºåÁºñËØëÂêéÊä•Âá∫ÈîôËØØÔºåuse of undeclared identifier &#39;SwiftFile&#39;: ‰∏∫‰ªÄ‰πà SwiftFile ‰ºöÊòØÊú™Ë¢´Â£∞ÊòéÁöÑÂë¢ÔºüÊàë‰ª¨ËøõÂÖ• OCWithSwift-Swift.h ‰∏≠Êü•ÁúãÔºö Ê°•Êé•Êñá‰ª∂‰∏≠Âπ∂Ê≤°ÊúâÂèëÁé∞ SwiftFile ÁöÑË∫´ÂΩ±ÔºåÁ°ÆÂÆûÊòØÊ≤°ÊúâÂ£∞Êòé„ÄÇÈÇ£‰πàË¶ÅÂ¶Ç‰ΩïÊâçËÉΩÂ∞Ü SwiftFile Êö¥Èú≤Âá∫Êù•Âë¢Ôºü‰∏∫ Swift Á±ªÂíåÊñπÊ≥ïÊ∑ªÂä† public ‰øÆÈ•∞Á¨¶Ôºö ÈáçÊñ∞ Build ‰∏Ä‰∏ãÔºå Êàë‰ª¨ÂÜçÊ¨°ËøõÂÖ• OCWithSwift-Swift.h Êñá‰ª∂ÔºåÊñπÊ≥ïÂá∫Áé∞‰∫ÜÔºö ‰∏ªÂ∑•Á®ã‰∏≠ Swift Ë∞ÉÁî®Â∫ì‰∏≠Á±ª‰∏éÊñπÊ≥ïÂú®‰∏ä‰∏ÄÊ≠•‰∏≠ÔºåÂÖ∂ÂÆûÂ∫ì‰∏≠ÁöÑ Swift Âíå OC ÈÉΩÂ∑≤ÁªèÁîüÊàê‰∫ÜÂØπÂ∫îÁöÑ OC Âíå Swift ÊñπÊ≥ï„ÄÇÂú®‰∏ªÂ∑•Á®ã‰∏≠Áõ¥Êé•ÂºïÂÖ•Ë∞ÉÁî®Âç≥ÂèØ: ÂèØ‰ª•ÁúãÂà∞Ôºå‰∏çËÆ∫ÊòØ Swift Áõ¥Êé•Ë∞ÉÁî® SwiftÔºåËøòÊòØ Swift Ë∞ÉÁî® OC ËΩ¨Êç¢ÂêéÁöÑ Swift ÈÉΩÊòØÊ≤°ÊúâÈóÆÈ¢òÁöÑ„ÄÇ ‰∏ªÂ∑•Á®ã‰∏≠ OC Ë∞ÉÁî®Â∫ì‰∏≠Á±ª‰∏éÊñπÊ≥ïÂêåÊ†∑Âú®‰∏ªÂ∑•Á®ã‰∏≠ÁöÑ OC Á±ª‰∏≠ÂºïÁî®ÈúÄË¶ÅÁöÑÁ±ªÂç≥ÂèØÔºö OC Ë∞ÉÁî®Â∫ì‰∏≠ OC Âíå Swift ËΩ¨Êç¢ÁöÑ OC ÂêåÊ†∑Ê≤°ÊúâÈóÆÈ¢ò„ÄÇ Âà∞ËøôÈáåÂü∫Êú¨‰∏äËØ•Ë∂üÁöÑÂùëÈÉΩË∂üËøá‰∫Ü ÂèÇËÄÉËá™ÂÆòÊñπÊñáÊ°£ ÊàëÁöÑdemo]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
        <tag>Cocoapods</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[app Èó¥ÁöÑË∑≥ËΩ¨‰∏é‰ø°ÊÅØ‰º†ÈÄí]]></title>
    <url>%2F2017%2F07%2F02%2Fapp%E9%97%B4%E7%9A%84%E8%B7%B3%E8%BD%AC%2F</url>
    <content type="text"><![CDATA[Êó•Â∏∏‰ΩøÁî®‰∏≠ÔºåÁªèÂ∏∏‰ºöÈÅáÂà∞ÂàÜ‰∫´„ÄÅÊîØ‰ªòÁ≠âÂäüËÉΩÈúÄË¶ÅË∑≥ËΩ¨Âà∞Âè¶‰∏Ä‰∏™ app ËøõË°åÂ§ÑÁêÜÔºåÁÑ∂ÂêéÂ§ÑÁêÜÂõûË∞É‰ø°ÊÅØ„ÄÇÊú¨ÁØáÂ∞ÜÂØπËøô‰∏™ÂäüËÉΩËøõË°åÂ≠¶‰π†„ÄÇ Â∫îÁî®Èó¥Ë∑≥ËΩ¨ÊòØÈÄöËøáËãπÊûúÂÆûÁé∞ÁöÑÁ±ª‰ºº‰∫éË∑ØÁî±ÁöÑ URL SchemesÔºàËá™ÂÆö‰πâÂçèËÆÆÂ§¥ÔºâÂÆûÁé∞ÁöÑ„ÄÇÂ∫îÁî®BÁ∫¶ÂÆöÂ•ΩÊâìÂºÄËá™Ë∫´ÁöÑÂçèËÆÆÂ§¥ÔºåÂ∫îÁî®AÂàôÂú®ÁâπÂÆöÁöÑÂú∫ÂêàË∞ÉÁî®Ëøô‰∏™ÂçèËÆÆÂ§¥ÔºåÂÆûÁé∞Ë∑≥ËΩ¨„ÄÇ URL SchemeA-&gt;BÁõ¥Êé•Ë∑≥ËΩ¨B‰∏≠Ê≥®ÂÜåË¶ÅË∑≥ËΩ¨Âà∞BÔºåÂ∞±ÂæóÂÖàËÆ©BÊ≥®ÂÜåËá™Â∑±ÁöÑ URL Schemes„ÄÇÂú® Info-&gt;URL Types ‰∏≠Êñ∞Âª∫‰∏Ä‰∏™: ËøôÈáåÁöÑÊ∑ªÂä†ÊúÄÁªàÊò†Â∞ÑÂà∞ÁöÑÊòØ plist Êñá‰ª∂‰∏≠ÔºåURL Schemes Â∞ÜÂú® plist Êñá‰ª∂‰∏≠‰ª•ÈîÆÂÄºÂØπÁöÑÊñπÂºè‰øùÂ≠òÔºåÂèØ‰ª•Ëá™Áî±ÁöÑÊ∑ªÂä†ÂíåÂà†Èô§ A‰∏≠Ë∞ÉÁî®B‰∏≠Ê≥®ÂÜåÂ•Ω‰∫Ü URL SchemesÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Âú® safari ‰∏≠ËæìÂÖ• zacharyB1:// Â∞±ÂèØ‰ª•ÊâìÂºÄ app ‰∫ÜÔºåËøô‰πüÊòØÂæàÂ§öh5‰∏≠Ë¶ÅÊâìÂºÄÂÖ≥ËÅîÁöÑ app ÈÉΩÊèêÁ§∫Âú® safari ‰∏≠ÊâìÂºÄÁöÑÂéüÂõ†„ÄÇÊàë‰ª¨Áé∞Âú®Âú®A‰∏≠Ê∑ªÂä†Ë∑≥ËΩ¨ÈÄªËæëÔºö 123456789101112- (IBAction)jumpToAppB:(id)sender &#123; // 1.Ëé∑ÂèñÂ∫îÁî®Á®ãÂ∫èApp-BÁöÑURL Scheme NSURL *appBUrl = [NSURL URLWithString:@"zacharyB1://"]; // 2.Âà§Êñ≠ÊâãÊú∫‰∏≠ÊòØÂê¶ÂÆâË£Ö‰∫ÜÂØπÂ∫îÁ®ãÂ∫è if ([[UIApplication sharedApplication] canOpenURL:appBUrl]) &#123; // 3. ÊâìÂºÄÂ∫îÁî®Á®ãÂ∫èApp-B [[UIApplication sharedApplication] openURL:appBUrl]; &#125; else &#123; NSLog(@"Ê≤°ÊúâÂÆâË£Ö"); &#125;&#125; ËøôÈáåË¶ÅÊ≥®ÊÑè‰∏ÄÁÇπÔºåiOS9 ÂêéÂºïÂÖ•‰∫ÜÁôΩÂêçÂçïÁöÑÊ¶ÇÂøµ„ÄÇAÂú®Ë∞ÉÁî® canOpenURL: ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºå‰ºöÂú®AÁöÑÁôΩÂêçÂçï‰∏≠Êü•ÁúãÊòØÂê¶ÂèØ‰ª•Ë∑≥ËΩ¨Â∫îÁî®BÔºåÊâÄ‰ª•Êàë‰ª¨ËøòË¶ÅÊèêÂâçÂ∞ÜBÊ≥®ÂÜåÂà∞AÁöÑÁôΩÂêçÂçïÂΩì‰∏≠„ÄÇÂÖ∑‰ΩìÂÅöÊ≥ïÂ∞±ÊòØÂú®Â∫îÁî®AÁöÑ plist Êñá‰ª∂‰∏≠ÔºåÊ∑ªÂä† LSApplicationQueriesSchemes Êï∞ÁªÑÔºåÁÑ∂ÂêéÂáè‰ª∑ÈîÆÂÄº‰∏∫ zacharyB1 ÁöÑÂ≠óÁ¨¶‰∏≤Ôºö Ê∑ªÂä†Â•ΩÁôΩÂêçÂçïÂêéÔºåÂ∞±ÂèØ‰ª•Ê≠£Â∏∏ÁöÑË∑≥ËΩ¨‰∫Ü„ÄÇ Â∏¶ÂèÇÊï∞ÁöÑË∑≥ËΩ¨A‰∏≠Ë∞ÉÁî®‰∏äÈù¢ÊòØÁõ¥Êé•Ë∑≥ËΩ¨ÊâìÂºÄÂ∫îÁî®BÔºå‰ΩÜÊòØÂÆûÈôÖÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÂèØËÉΩË¶ÅÊâìÂºÄBÁöÑÊüê‰∏™È°µÈù¢ÔºåÂπ∂‰∏îË¶Å‰º†ÈÄí‰∏Ä‰∫õÂèÇÊï∞ËøáÂéª„ÄÇÊú¨Ë∫´ openURL ÊòØ‰∏çÂ∏¶ÂèÇÊï∞ÁöÑÔºåÊàë‰ª¨ÈúÄË¶ÅÊåâÁÖßÁ∫¶ÂÆöÁöÑËßÑÂàôÔºåÂ∞ÜÂèÇÊï∞‰Ωú‰∏∫ URL ÁöÑ‰∏ÄÈÉ®ÂàÜ‰º†ÂÖ•ÔºåÁî±Â∫îÁî®BËá™Â∑±Ëß£Êûê„ÄÇ ÊØîÂ¶ÇÂå∫ÂàÜË∑≥ËΩ¨Âà∞BÁöÑÊüê‰∏Ä‰∏™È°µÈù¢1ËøòÊòØÈ°µÈù¢2ÔºåÊàë‰ª¨ÂàÜÂà´ÂÆöÂà∂ URLÔºö 12345678910111213141516171819202122232425- (IBAction)jumpToAppBPage1:(id)sender &#123; // 1.Ëé∑ÂèñÂ∫îÁî®Á®ãÂ∫èApp-BÁöÑPage1È°µÈù¢ÁöÑURL NSURL *appBUrl = [NSURL URLWithString:@"zacharyB1://Page1"]; // 2.Âà§Êñ≠ÊâãÊú∫‰∏≠ÊòØÂê¶ÂÆâË£Ö‰∫ÜÂØπÂ∫îÁ®ãÂ∫è if ([[UIApplication sharedApplication] canOpenURL:appBUrl]) &#123; // 3. ÊâìÂºÄÂ∫îÁî®Á®ãÂ∫èApp-BÁöÑPage1È°µÈù¢ [[UIApplication sharedApplication] openURL:appBUrl]; &#125; else &#123; NSLog(@"Ê≤°ÊúâÂÆâË£Ö"); &#125;&#125;- (IBAction)jumpToAppBPage2:(id)sender &#123; // 1.Ëé∑ÂèñÂ∫îÁî®Á®ãÂ∫èApp-BÁöÑPage2È°µÈù¢ÁöÑURL NSURL *appBUrl = [NSURL URLWithString:@"zacharyB1://Page2"]; // 2.Âà§Êñ≠ÊâãÊú∫‰∏≠ÊòØÂê¶ÂÆâË£Ö‰∫ÜÂØπÂ∫îÁ®ãÂ∫è if ([[UIApplication sharedApplication] canOpenURL:appBUrl]) &#123; // 3. ÊâìÂºÄÂ∫îÁî®Á®ãÂ∫èApp-BÁöÑPage2È°µÈù¢ [[UIApplication sharedApplication] openURL:appBUrl]; &#125; else &#123; NSLog(@"Ê≤°ÊúâÂÆâË£Ö"); &#125;&#125; B‰∏≠Â§ÑÁêÜÂú®AË∞ÉËµ∑BÂêéÔºåB‰∏≠‰ºöÊâßË°åÁâπÂÆöÊñπÊ≥ïÔºåÊàë‰ª¨ÂèØ‰ª•Âú®ÂÖ∂‰∏≠Ê∑ªÂä†Â§ÑÁêÜÈÄªËæëÔºåËé∑ÂèñÂèÇÊï∞Ôºö 1234567891011121314151617- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation&#123; // 1.Ëé∑ÂèñÂØºËà™Ê†èÊéßÂà∂Âô® UINavigationController *rootNav = (UINavigationController *)self.window.rootViewController; // 2.ÊØèÊ¨°Ë∑≥ËΩ¨ÂâçÂøÖÈ°ªÊòØÂú®Ë∑üÊéßÂà∂Âô®(ÁªÜËäÇ) [rootNav popToRootViewControllerAnimated:NO]; // 3.Ê†πÊçÆÂ≠óÁ¨¶‰∏≤ÂÖ≥ÈîÆÂ≠óÊù•Ë∑≥ËΩ¨Âà∞‰∏çÂêåÈ°µÈù¢ if ([url.absoluteString containsString:@"Page1"]) &#123; // Ë∑≥ËΩ¨Âà∞Â∫îÁî®BÁöÑPage1È°µÈù¢ [rootNav pushViewController:[[Page1ViewController alloc] init] animated:YES]; &#125; else if ([url.absoluteString containsString:@"Page2"]) &#123; // Ë∑≥ËΩ¨Âà∞Â∫îÁî®BÁöÑPage2È°µÈù¢ [rootNav pushViewController:[[Page1ViewController alloc] init] animated:YES]; &#125; return YES;&#125; B-&gt;ABËøîÂõûAÁöÑËøáÁ®ãÂíåAË∞ÉÁî®BÁöÑËøáÁ®ãÁ±ª‰ººÔºåÁõ∏ÂΩì‰∫éB‰∏ªÂä®Ë∞ÉÁî®AÁöÑ URL Scheme„ÄÇBÂ¶Ç‰ΩïÁü•ÈÅìÊòØÂì™‰∏™Â∫îÁî®Ë∞ÉÁî®‰∫ÜÂÆÉÂë¢ÔºüËøôÂ∞±ÈúÄË¶ÅAÂ∞ÜËá™Â∑±ÁöÑ URL Scheme ‰º†ÁªôB„ÄÇÂêåÊ†∑ÁöÑÔºåÈúÄË¶ÅÁ∫¶ÂÆöËßÑÂàôÔºåÊØîÂ¶ÇÂ¶Ç‰∏ãÔºö 1Â∫îÁî®BÁöÑURL Schemes://Ë¶Å‰º†ÁöÑÂèÇÊï∞?Â∫îÁî®AÁöÑURL Schemes Â∞ÜÂ∫îÁî®AÁöÑ URL Scheme Âú®Êú´Â∞æ‰º†ÂÖ•ÔºåÂπ∂‰∏î‰ª• ? ÂàÜÈöî„ÄÇBÊãøÂà∞ÂêéÂèñÂá∫AÁöÑ URL SchemeÔºåÂú®ÂøÖË¶ÅÁöÑÊó∂ÂÄôÔºàÂ¶ÇÁÇπÂáªÊüê‰∏™ÊåâÈíÆÔºâÈÄöËøáÂÖ∂Ë∞ÉËµ∑Â∫îÁî®A„ÄÇ 12345678910111213- (IBAction)page1BackToAppA:(id)sender &#123; // 1.ÊãøÂà∞ÂØπÂ∫îÂ∫îÁî®Á®ãÂ∫èÁöÑURL Scheme NSString *urlSchemeString = [[self.urlString componentsSeparatedByString:@"?"] lastObject]; NSString *urlString = [urlSchemeString stringByAppendingString:@"://"]; // 2.Ëé∑ÂèñÂØπÂ∫îÂ∫îÁî®Á®ãÂ∫èÁöÑURL NSURL *url = [NSURL URLWithString:urlString]; // 3.Âà§Êñ≠ÊòØÂê¶ÂèØ‰ª•ÊâìÂºÄ if ([[UIApplication sharedApplication] canOpenURL:url]) &#123; [[UIApplication sharedApplication] openURL:url]; &#125;&#125; Universal LinksÈô§‰∫Ü URL SchemeÔºåiOS9‰∏≠ËøòÊèê‰æõ‰∫Ü‰∏ÄÁßçÁ≥ªÁªüÁ∫ßÁöÑ APP Âî§ÈÜíÊñπÂºè„ÄÇËøôÂèØ‰ª•‰Ωø‰Ω†ÁöÑÂ∫îÁî®ÂèØ‰ª•ÈÄöËøá‰º†ÁªüÁöÑHTTPÈìæÊé•Êù•ÂêØÂä®APP(Â¶ÇÊûúiOSËÆæÂ§á‰∏äÂ∑≤ÁªèÂÆâË£Ö‰∫Ü‰Ω†ÁöÑappÔºå‰∏çÁÆ°Âú®ÂæÆ‰ø°ÈáåËøòÊòØÂú®Âì™Èáå)Ôºå ÊàñËÄÖÊâìÂºÄÁΩëÈ°µ(iOSËÆæÂ§á‰∏äÊ≤°ÊúâÂÆâË£Ö‰Ω†ÁöÑapp)„ÄÇ ÂºÄÂêØ‰ΩøÁî®È¶ñÂÖàË¶ÅÂú®ÂºÄÂèëËÄÖ‰∏≠ÂøÉ‰∏≠ÂºÄÂêØËøô‰∏ÄÂäüËÉΩÔºö ÁÑ∂ÂêéÂú®È°πÁõÆÁöÑÈÖçÁΩÆ‰∏≠ÊâæÂà∞ Capabilities-&gt;Associated DomainsÔºö ‰ª• applinks: ÂºÄÂ§¥ÔºåÂêéÈù¢Ë∑üÁùÄ‰Ω†ÁöÑÂüüÂêç„ÄÇËøô‰∏™ÂüüÂêçÂøÖÈ°ªÊîØÊåÅ HTTPS ÁöÑ GET ËØ∑Ê±Ç„ÄÇÂú®Á¨¨‰∏ÄÊ¨°ÂêØÂä® APP ÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªü‰ºöËá™Âä®Âà∞Ëøô‰∏™ÂüüÂêçÁöÑÊ†πÁõÆÂΩï‰∏ãÔºåËØ∑Ê±ÇÂêç‰∏∫apple-app-site-associationÁöÑÊñá‰ª∂ÔºåÂç≥‰ºöÂèëÈÄÅ https://domain.com/apple-app-site-association ËØ∑Ê±Ç„ÄÇ apple-app-site-association Ê†ºÂºèapple-app-site-association ÊòØ‰∏Ä‰∏™ÂÜÖÂÆπ‰∏∫jsonÊñá‰ª∂Ôºå‰∏îÊ≤°ÊúâÂêéÁºÄÂêçÁöÑÊñá‰ª∂(‰∏çËÉΩÂ∏¶.jsonÁöÑÂêéÁºÄ)„ÄÇÊñá‰ª∂ÂÜÖÂÆπÂ§ßËá¥Â¶Ç‰∏ãÔºö 123456789101112131415&#123; "applinks": &#123; "apps": [], "details": [ &#123; "appID": "9JA89QQLNQ.com.apple.wwdc", "paths": [ "/wwdc/news/", "/videos/wwdc/2015/*"] &#125;, &#123; "appID": "ABCD1234.com.apple.wwdc", "paths": [ "*" ] &#125; ] &#125;&#125; appID ÁöÑÁªÑÊàêÈÉ®ÂàÜ‰∏∫ÔºöTeamID . BundleId TeamID„ÄÇÂÖ∂‰∏≠ÔºåTeamID ÂèØ‰ª•‰ªéËãπÊûúÂºÄÂèëË¥¶Âè∑È°µÈù¢‰πü Your Account ‰∏ãÊü•ÁúãÔºåBundleId Â∞±Áõ¥Êé•Âú®Â∑•Á®ãÈáåÁúã‰∫Ü„ÄÇ ÂÆåÊàêËøôÊ≠•ÂêéÔºåÁ≥ªÁªüÂ∞±Â∞ÜÂüüÂêçÂíå app ÁªëÂÆö‰∫ÜËµ∑Êù•„ÄÇÂú®‰ªª‰ΩïÂÖ∂ÂÆÉÂ∫îÁî®‰∏≠Âä†ËΩΩËøô‰∏™ÂüüÂêç‰∏ãÁöÑÈìæÊé•ÈÉΩÂ∞ÜËá™Âä®ÊâìÂºÄ‰Ω†ÁªëÂÆöÁöÑ app„ÄÇ APP ÂÜÖÁöÑÂ§ÑÁêÜÊâìÂºÄ APP Âêé‰ºöË∞ÉÁî®‰ª•‰∏ãÊñπÊ≥ïÔºö 123456789101112131415- (BOOL)application:(UIApplication *)application continueUserActivity:(NSUserActivity *)userActivity restorationHandler:(void (^)(NSArray * _Nullable))restorationHandler&#123; if ([userActivity.activityType isEqualToString:NSUserActivityTypeBrowsingWeb])&#123; //urlÊòØÂÆåÊï¥ÁöÑÂ∏¶ domain ÁöÑurl NSURL *url = userActivity.webpageURL; if (urlÊòØÊàë‰ª¨Â∏åÊúõÂ§ÑÁêÜÁöÑ)&#123; //ÊâìÂºÄÂØπÂ∫îÈ°µÈù¢ &#125; else&#123; //‰∏çËÉΩËØÜÂà´ÁöÑÁî® safari ÊâìÂºÄ [[UIApplication sharedApplication] openURL:url]; &#125; &#125; return YES;&#125; ÂΩì userActivity ÊòØ NSUserActivityTypeBrowsingWeb Á±ªÂûã, ÂàôÊÑèÂë≥ÁùÄÂÆÉÂ∑≤ÁªèÁî±ÈÄöÁî®ÈìæÊé• API ‰ª£ÁêÜ„ÄÇËøôÊ†∑ÁöÑËØù, ÂÆÉ‰øùËØÅÁî®Êà∑ÊâìÂºÄÁöÑ URL Â∞ÜÊúâ‰∏Ä‰∏™ÈùûÁ©∫ÁöÑ webpageURL Â±ûÊÄß„ÄÇ iOSÂºÄÂèë‚Äì‰∏ÄÊ≠•Ê≠•Êïô‰Ω†ÂΩªÂ∫ïÂ≠¶‰ºö„ÄéiOSÂ∫îÁî®Èó¥Áõ∏‰∫íË∑≥ËΩ¨„Äè iOS 9Â≠¶‰π†Á≥ªÂàóÔºöÊâìÈÄö iOS 9 ÁöÑÈÄöÁî®ÈìæÊé•ÔºàUniversal LinksÔºâ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ΩøÁî® cocoapods ÂàõÂª∫‰∏Ä‰∏™‰ªìÂ∫ì]]></title>
    <url>%2F2017%2F06%2F30%2Fcocoapods%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%BA%93%2F</url>
    <content type="text"><![CDATA[ÊÉ≥Êêû‰∏Ä‰∏™ÁªÑ‰ª∂ÂåñÁöÑÈ°πÁõÆÔºåÊâÄ‰ª•ÂÖàÂ•ΩÂ•ΩÁúã‰∏ãÂ¶Ç‰Ωï‰ΩøÁî® cocoapods ÂàõÂª∫‰∏Ä‰∏™ÁßÅÊúâÂ∫ì Cocoapods ÁÆÄÂçïÂéüÁêÜ‰πãÂâçÁöÑÊñáÁ´†‰∏≠ÊàëÊèêÂà∞ËøáÔºåÂä†ÈÄü pod install ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÊòØ pod install--no-repo-updateÔºå‰∏ãÈù¢Â∞±Ë¶ÅËß£Èáä‰∏Ä‰∏ãËøô‰∏™ÂêéÁºÄÊòØË¶ÅÂπ≤‰ªÄ‰πà„ÄÇ Cocoapods Êú¨Âú∞ÁõÆÂΩïÊàë‰ª¨È¶ñÂÖàËøõÂÖ• Cocoapods ÁöÑÊú¨Âú∞ÁõÆÂΩïÔºö 1$cd ~/.cocoapods/repos/master ÂèØ‰ª•ÂèëÁé∞ËøôÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™ git ‰ªìÂ∫ìÔºö 1234$ git remote -vorigin https://github.com/CocoaPods/Specs.git (fetch)origin https://github.com/CocoaPods/Specs.git (push) ËøõÂÖ• Specs Êñá‰ª∂Â§πÔºå‰ºöÊúâÂæàÂ§öÊ≠å0~fÁöÑÊñá‰ª∂Â§πÂµåÂ•óÔºå‰∏ÄÂ±Ç‰∏ÄÂ±ÇÁÇπ‰∏ãÂéªÔºåÂèØ‰ª•ÁúãÂà∞ÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∫õÁÜüÊÇâÁöÑÁ¨¨‰∏âÊñπÂ∫ìÔºåÈöè‰æøÈÄâ‰∏Ä‰∏™ÁÇπËøõÂéªÔºåÊòØÂêÑ‰∏™ÁâàÊú¨ÁöÑÊñá‰ª∂Â§πÔºåÂÜçÈöè‰æøÊâæ‰∏™Êñá‰ª∂Â§πËøõÂÖ•ÔºåÊòØ‰∏Ä‰∏™jsonÊñá‰ª∂„ÄÇ ÊâìÂºÄËøô‰∏™jsonÊñá‰ª∂ÔºåÈáåÈù¢ËÆ∞ÂΩï‰∫ÜËøô‰∏™ÁâàÊú¨ÁöÑÂ∫ìÁöÑ‰∏Ä‰∫õ‰ø°ÊÅØÔºåÂåÖÊã¨Ëøô‰∏™Â∫ìÁöÑËøúÁ®ã‰ªìÂ∫ìÁöÑÂú∞ÂùÄÔºö ÊâÄ‰ª•Êàë‰ª¨Â∞±ËÉΩÂ§ßÊ¶ÇÊòéÁôΩ‰∫ÜÔºåÊØèÊ¨°Êàë‰ª¨ pod install ÂêéÔºåÂ∞±‰ºöÂú®Ëøô‰∏™ Specs ‰∏ãÊü•ÊâæÂØπÂ∫îÁöÑÂ∫ìÁöÑÂØπÂ∫îÁâàÊú¨ÔºåÁÑ∂ÂêéÊâæÂà∞Áõ∏Â∫îÁöÑËøúÁ®ã‰ªìÂ∫ìÔºåÂéªËøúÁ®ã‰ªìÂ∫ìÊãâÂèñ‰ª£Á†Å„ÄÇ Pod install ËøáÁ®ãÂú® install ÂâçÔºåÊàë‰ª¨Ë¶ÅÁºñÂÜô‰∏Ä‰∏™ Podfile„ÄÇÊï¥‰∏™‰æùËµñÂÆâË£ÖÂ§ßÊ¶ÇÊúâÂõõ‰∏™ÈÉ®ÂàÜÔºö Ëß£Êûê Podfile ‰∏≠ÁöÑ‰æùËµñ ‰∏ãËΩΩ‰æùËµñ ÂàõÂª∫ Pods.xcodeproj Â∑•Á®ã ÈõÜÊàê workspace Podfile ÊòØ ruby ÁöÑËØ≠Ê≥ïÔºåÂú® install ËøáÁ®ã‰∏≠ÔºåÊâßË°å Podfile Êñá‰ª∂ÔºåÂ∞Ü‰ºöËé∑ÂèñÂà∞Ë¶Å‰æùËµñÁöÑÂ∫ì‰ª•ÂèäÂ∫ìÁöÑÁâàÊú¨Âè∑„ÄÇÁÑ∂ÂêéÂú®Êú¨Âú∞ÁöÑ Specs ‰∏≠ËøõË°åÊØîÂØπÔºåÊâæÂà∞ÂØπÂ∫îÁöÑËøúÁ®ã‰ªìÂ∫ìÁöÑÂú∞ÂùÄ„ÄÇ Â§ßÈÉ®ÂàÜÁöÑ‰æùËµñÈÉΩ‰ºöË¢´‰∏ãËΩΩÂà∞ ~/Library/Caches/CocoaPods/Pods/Release/ Ëøô‰∏™Êñá‰ª∂Â§π‰∏≠ÔºåÁÑ∂Âêé‰ªéËøô‰∏™ËøôÈáåÂ§çÂà∂Âà∞È°πÁõÆÂ∑•Á®ãÁõÆÂΩï‰∏ãÁöÑ ./Pods ‰∏≠„ÄÇ Â¶ÇÊûú Specs ‰∏≠Â¶ÇÊûúÊ≤°ÊúâÊâæÂà∞ Podfile ‰∏≠Ëß£ÊûêÁöÑÂ∫ìÔºåÂ∞±‰ºöÊä•Èîô„ÄÇÈÇ£‰πàÂ¶ÇÊûúÊàë‰ª¨Âæà‰πÖÊ≤°ÊúâÊâãÂä®Êõ¥Êñ∞ Spec ‰∫ÜÂë¢Ôºü‰∏çÁî®ÊãÖÂøÉÔºåÊØèÊ¨° Pod install ÁöÑÊó∂ÂÄôÔºåÈÉΩ‰ºöËá™Âä®ÂÖàÂéªÊõ¥Êñ∞‰∏Ä‰∏ã SpecsÔºöpod repo updateÔºåÂΩìÁΩëÁªú‰∏çÂ•ΩÁöÑÊó∂ÂÄôÂ∞±‰ºöÂæàÊÖ¢ÔºåÊâÄ‰ª•ÊâçÊúâ‰∫Ü pod install --no-repo-updateÔºåÂú® install Êó∂Ôºå‰∏çÊõ¥Êñ∞ Specs ÁöÑÂëΩ‰ª§„ÄÇ pod install ÂÆåÊàêÂêéÔºå‰ºöËá™Âä®ÁîüÊàê‰∏Ä‰∏™ Podfile.lockÔºåÁî®Êù•ÈîÅÂÆöÁâàÊú¨„ÄÇÊàë‰ª¨‰∏çÂ∫îËØ•Â∞ÜÂÖ∂Ê∑ªÂä†Âà∞ .gitignore ‰∏≠Âéª„ÄÇÂè™ÊúâÂú® pod update ÂêéÔºåÊâç‰ºöËá™Âä®Êõ¥Êñ∞ Podfile.lock„ÄÇ CocoaPods ÈÄöËøáÁªÑ‰ª∂ CocoaPods-Downloader Â∑≤ÁªèÊàêÂäüÂ∞ÜÊâÄÊúâÁöÑ‰æùËµñ‰∏ãËΩΩÂà∞‰∫ÜÂΩìÂâçÂ∑•Á®ã‰∏≠ÔºåËøôÈáå‰ºöÂ∞ÜÊâÄÊúâÁöÑ‰æùËµñÊâìÂåÖÂà∞ Pods.xcodeproj ‰∏≠„ÄÇ‰∏ªË¶ÅÂÅö‰∫ÜÂá†‰ª∂‰∫ãÔºöÁîüÊàê Pods.xcodeproj Â∑•Á®ãÔºõÂ∞Ü‰æùËµñ‰∏≠ÁöÑÊñá‰ª∂Âä†ÂÖ•Â∑•Á®ãÔºõÂ∞Ü‰æùËµñ‰∏≠ÁöÑ Library Âä†ÂÖ•Â∑•Á®ãÔºõËÆæÁΩÆÁõÆÊ†á‰æùËµñÔºàTarget DependenciesÔºâ ËøôÂá†‰ª∂‰∫ãÊÉÖÈÉΩÁ¶ª‰∏çÂºÄ CocoaPods ÁöÑÂè¶Â§ñ‰∏Ä‰∏™ÁªÑ‰ª∂ XcodeprojÔºåËøôÊòØ‰∏Ä‰∏™ÂèØ‰ª•Êìç‰Ωú‰∏Ä‰∏™ Xcode Â∑•Á®ã‰∏≠ÁöÑ Group ‰ª•ÂèäÊñá‰ª∂ÁöÑÁªÑ‰ª∂ÔºåÊàë‰ª¨ÈÉΩÁü•ÈÅìÂØπ Xcode Â∑•Á®ãÁöÑ‰øÆÊîπÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÈÉΩÊòØÂØπ‰∏Ä‰∏™ÂêçÂè´ project.pbxproj ÁöÑÊñá‰ª∂ËøõË°å‰øÆÊîπÔºåËÄå Xcodeproj Ëøô‰∏™ÁªÑ‰ª∂Â∞±ÊòØ CocoaPods Âõ¢ÈòüÂºÄÂèëÁöÑÁî®‰∫éÊìç‰ΩúËøô‰∏™Êñá‰ª∂ÁöÑÁ¨¨‰∏âÊñπÂ∫ì„ÄÇ ÊúÄÂêéÁöÑËøô‰∏ÄÈÉ®ÂàÜ‰∏éÁîüÊàê Pods.xcodeproj ÁöÑËøáÁ®ãÊúâ‰∏Ä‰∫õÁõ∏‰ºº„ÄÇÈ¶ñÂÖà‰ºöÂàõÂª∫‰∏Ä‰∏™ workspaceÔºå‰πãÂêé‰ºöËé∑ÂèñÊâÄÊúâË¶ÅÈõÜÊàêÁöÑ Target ÂÆû‰æãÔºåÁÑ∂ÂêéÂ∞ÜÊØè‰∏Ä‰∏™ Target Âä†ÂÖ•Âà∞‰∫ÜÂ∑•Á®ãÔºå‰ΩøÁî® Xcodeproj ‰øÆÊîπ Copy Resource Script Phrase Á≠âËÆæÁΩÆÔºå‰øùÂ≠ò project.pbxprojÔºåÊï¥‰∏™ Pod install ÁöÑËøáÁ®ãÂ∞±ÁªìÊùü‰∫Ü„ÄÇ CocoaPods ÈÉΩÂÅö‰∫Ü‰ªÄ‰πà? Ê∑±ÂÖ•ÁêÜËß£ CocoaPods Podfile ‰∏≠ÁöÑ‰∏Ä‰∫õÂÖ≥ÈîÆËØç:pathÂ¶ÇÊûúÊòØÊàë‰ª¨Ëá™Â∑±ÂºÄÂèëÁöÑÁßÅÊúâÂ∫ìÔºåÂπ∂‰∏îÂú®ÂºÄÂèëÈò∂ÊÆµÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØËÉΩÂ∞±Â∏åÊúõÂºÄÂèëÊ®°ÂºèËøõË°åÂºïÁî®ÔºåÂàôÂèØ‰ª•‰ΩøÁî®pathÂèÇÊï∞Ôºö:path =&gt; &#39;~/Documents/AFNetworking&#39; 1234target ‚ÄòMike‚Äô dopod 'RNFS', :path =&gt; '../node_modules/react-native-fs'pod 'React', :path =&gt; '../node_modules/react-native'end cocoapods ‰ºöËá™Âä®Âà∞ path ÊâÄÂú®Êñá‰ª∂Â§πÂÜÖÊü•Êâæ RNFS.podspec ‰ª•Âèä React.podspec Êñá‰ª∂ÔºåÁÑ∂ÂêéÊ†πÊçÆËøô‰∏§‰∏™Êñá‰ª∂ÂÜÖÊèê‰æõÁöÑ‰ø°ÊÅØÂàõÂª∫Â∫ìÔºà‰∏ãÈù¢‰ªãÁªçÂ¶Ç‰ΩïÂàõÂª∫Â∫ìÁöÑÊó∂ÂÄô‰ºöËØ¥Âà∞Ôºâ„ÄÇ platformËøô‰∏™ÂèÇÊï∞ÊòØÂè™‰æùËµñÁöÑÂ∫ìÂ∏åÊúõÂú®Âì™‰∏™Âπ≥Âè∞Ë¢´ÁºñËØë„ÄÇÁõ¥Êé•‰ΩøÁî®platform :ios, &#39;9.0&#39;„ÄÇËØ¥Â∏åÊúõÈááÁî®iOS9.0ÁöÑËøõË°åÁºñËØë„ÄÇ use_frameworks!Ëøô‰∏™ÊåáÊòéÁºñËØëÊàêÂä®ÊÄÅÂ∫ìÔºåËÄå‰∏çÊòØÈùôÊÄÅÂ∫ìÔºåÁâπÂà´ÊòØÂú®‰ΩøÁî®SwiftÂ∫ìÁöÑËøáÁ®ã‰∏≠ÔºåÁâπÂà´ÈúÄË¶Å‰ΩøÁî®ËøôÂè•„ÄÇ‰∏çËøá‰ªñ‰ºöÊääÊâÄÊúâÈ°πÁõÆÁöÑÁºñËØëÂä®ÊÄÅÂ∫ìÔºåËøô‰∏ÄÁÇπÊúâÁÇπ‰∏çÂ•Ω„ÄÇ‰∏çËøáÂú®‰ΩøÁî®SwiftÂ∫ìÁöÑËøáÁ®ã‰∏≠Â∞±Ê≤°ÂäûÊ≥ï‰∫Ü„ÄÇ sourceËøô‰∏™ÂèÇÊï∞ÊòØÊåáCocoapods‰ªéÂì™‰∫õ‰ªìÂ∫ì(Spec)‰∏≠Ëé∑ÂæóÊ°ÜÊû∂ÁöÑÊ∫ê‰ª£Á†ÅÔºåÂ¶ÇÊûúÂú®ÁªìÂêà‰ΩøÁî®ÂºÄÊ∫êÂ∫ì‰ª•ÂèäËá™Â∑±ÁßÅÊúâÂ∫ìÁöÑÊÉÖÂÜµ‰∏ãÔºåËøô‰∏™ÂèÇÊï∞ËøòÊòØÈùûÂ∏∏ÊúâÊÑè‰πâÁöÑ„ÄÇÂú®Áî®Âà∞Ëá™Â∑±ÁßÅÊúâÂ∫ìÁöÑÊÉÖÂÜµ‰∏ãÂè™ÈúÄË¶ÅÂú®PodfileÊñá‰ª∂ÂºÄÂ§¥ÂàóÂá∫‰Ω†ÈúÄË¶ÅÂºïÁî®Â∫ìÁöÑÊâÄÊúâ‰ªìÂ∫ìÂú∞ÂùÄÂç≥ÂèØ„ÄÇ 12source 'https://github.com/artsy/Specs.git' source 'https://192.168.0.90:8888/MySepcs/Specs.git' ÊúÄÂêé‰∏Ä‰∏™ÂÆòÊñπ demo 123456789101112131415161718192021# open sourcesource 'https://github.com/CocoaPods/Specs.git'# my worksource 'https://github.com/Artsy/Specs.git'target 'App' do pod 'Artsy+UIColors' pod 'Artsy+UIButtons' pod 'FLKAutoLayout' pod 'ISO8601DateFormatter', '0.7' pod 'AFNetworking', '~&gt; 2.0' target 'AppTests' do pod 'FBSnapshotTestCase' pod 'Quick' pod 'Nimble' endend ÂàõÂª∫‰∏Ä‰∏™ÂÖ¨ÊúâÂ∫ìÊ≥®ÂÜå CocoaPods Ë¥¶Âè∑È¶ñÂÖàË¶ÅÊ≥®ÂÜå‰∏Ä‰∏™ CocoaPods Ë¥¶Âè∑ÔºåÂú®ÁªàÁ´Ø‰ΩøÁî® pod trunk ÂëΩ‰ª§Ê≥®ÂÜåÔºå‰πãÂêé‰ºöÊúâ‰∏ÄÂ∞ÅÁ°ÆËÆ§ÈÇÆ‰ª∂ÔºåÊøÄÊ¥ªË¥¶Âè∑Ôºö 1$pod trunk register 759740844@qq.com 'Zachary' --verbose ÊøÄÊ¥ªÊàêÂäüÂêéÔºåÂÜçÂà∞ÁªàÁ´ØËæìÂÖ•ÔºåÂèØ‰ª•ÁúãÂà∞Ê≥®ÂÜå‰ø°ÊÅØÔºö 1$pod trunk me 1234567ZacharydeMacBook-Pro:1.0.0 zachary$ pod trunk me - Name: Zachary - Email: 759740844@qq.com - Since: June 29th, 21:08 - Pods: None - Sessions: - June 29th, 21:08 - November 4th, 21:09. IP: 140.207.1.250 ÂàõÂª∫ .podspecËøô‰∏ÄÈÉ®ÂàÜ‰πãÂâçÁöÑÊñáÁ´†ÊâìÂåÖÈùôÊÄÅÂ∫ìÈáåÊúâËæÉ‰∏∫ËØ¶ÁªÜÁöÑËØ¥Êòé„ÄÇ‰∏∫Êñπ‰æøÊü•ÁúãÔºåÂ§çÂà∂‰∫ÜËøáÊù•„ÄÇ ÂàõÂª∫Â∑•Á®ãÂè™ÈúÄË¶ÅËæìÂÖ• pod ÁöÑ lib ÂëΩ‰ª§Âç≥ÂèØÂÆåÊàêÂàùÂßãÈ°πÁõÆÁöÑÊê≠Âª∫: 1pod lib create StaticWithCocoapods ËæìÂá∫Êåá‰ª§ÂêéÔºå‰ºöÊèêÁ§∫Á°ÆËÆ§‰∫î‰∏™ÈóÆÈ¢òÔºåÊåâÈúÄÊ±ÇÂõûÁ≠îÂç≥ÂèØÔºö Á®çÁ≠âÁâáÂàªÔºåÂ∞±‰ºöËá™Âä®ÁîüÊàê‰∏Ä‰∏™Â∑•Á®ã„ÄÇ ÈÖçÁΩÆ‰ø°ÊÅØÂú®È°πÁõÆÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™ xxx.podspec ÈÖçÁΩÆÊñá‰ª∂ÔºåÈúÄË¶ÅËøõË°å‰øÆÊîπÔºåÊëòÂΩïÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122232425262728293031323334353637Pod::Spec.new do |s| s.name = 'StaticWithCocoapods' s.version = '0.1.0' s.summary = 'A short description of StaticWithCocoapods.'# This description is used to generate tags and improve search results.# * Think: What does it do? Why did you write it? What is the focus?# * Try to keep it short, snappy and to the point.# * Write the description between the DESC delimiters below.# * Finally, don't worry about the indent, CocoaPods strips it! s.description = &lt;&lt;-DESCTODO: Add long description of the pod here. DESC s.homepage = 'https://github.com/zhang759740844' s.license = &#123; :type =&gt; 'MIT', :file =&gt; 'LICENSE' &#125; s.author = &#123; 'Zachary' =&gt; '759740844@qq.com' &#125; s.source = &#123; :git =&gt; '/Users/zachary/Desktop/StaticWithCocoapods', :tag =&gt; s.version.to_s &#125; s.ios.deployment_target = '8.0' s.source_files = 'StaticWithCocoapods/Classes/**/*' s.resources = ['Images/*.png','Sounds/*'] s.resource_bundles = &#123; 'StaticWithCocoapods' =&gt; ['StaticWithCocoapods/Assets/*.png'] &#125; s.public_header_files = 'StaticWithCocoapods/Classes/**/*.h' s.frameworks = 'UIKit', 'MapKit' s.dependency 'AFNetworking', '~&gt; 2.3' s.dependency 'SVProgressHUD' s.subspec 'Aswift' do |a| a.source_files = 'A_swift/A_swift/**/*' endend s.version Ë°®Á§∫ÁöÑÊòØÂΩìÂâçÁ±ªÂ∫ìÁöÑÁâàÊú¨Âè∑ s.source Ë°®Á§∫ÂΩìÂâçÁ±ªÂ∫ìÊ∫ê s.sources_files Ë°®Á§∫Á±ªÂ∫ìÁöÑÊ∫êÊñá‰ª∂Â≠òÊîæÁõÆÂΩï s.resources Ë°®Á§∫Â∞ÜËµÑÊ∫êÊñá‰ª∂ÊâìÂåÖÂú® mainBundle ‰∏≠ s.resource_bundles Ë°®Á§∫Â∞ÜËµÑÊ∫êÊñá‰ª∂ÂàõÂª∫‰∏∫Êüê‰∏™ bundle s.frameworks Ë°®Á§∫Á±ªÂ∫ì‰æùËµñÁöÑframework s.dependency Ë°®Á§∫‰æùËµñÁöÑÁ¨¨‰∏âÊñπÁ±ªÂ∫ìÔºåÂ¶ÇÊûúÊúâÂ§ö‰∏™Ë¶ÅÂÜôÂ§ö‰∏™ s.dependency s.subspec Ë°®Á§∫‰æùËµñÁöÑÂ≠ê podspec„ÄÇ ÂÖ∂‰∏≠Ë¶ÅËØ¥ÊòéÁöÑÊòØÔºö source Ë°®Á§∫‰ªéÂì™ÈáåÊãâÂèñ‰ª£Á†Å„ÄÇÂèØ‰ª•Â°´ÂÜôËøúÁ´Ø git ‰ªìÂ∫ìÔºå‰πüÂèØ‰ª•ÊòØÂÉèÊàëÂÜôÁöÑÈÇ£Ê†∑ÁöÑÊú¨Âú∞ git ‰ªìÂ∫ì„ÄÇÂ¶ÇÊûú Podfile ‰∏≠ÊåáÂÆö‰∫Ü :pathÔºå ÈÇ£‰πàÔºåÂ∞±‰ºöÂú®ÊåáÂÆöÁöÑË∑ØÂæÑÊü•ÊâæÔºåsource ËøôÈáåÂÜôÂï•ÈÉΩÊó†ÊâÄË∞ì„ÄÇ ‰æùËµñÈ°π‰∏ç‰ªÖË¶ÅÂåÖÂê´‰Ω†Ëá™Â∑±Á±ªÂ∫ìÁöÑ‰æùËµñÔºåËøòË¶ÅÂåÖÊã¨ÊâÄÊúâÁ¨¨‰∏âÊñπÁ±ªÂ∫ìÁöÑ‰æùËµñÔºåÂè™ÊúâËøôÊ†∑ÂΩì‰Ω†ÁöÑÁ±ªÂ∫ìÊâìÂåÖÊàê .a Êàñ .framework Êó∂ÊâçËÉΩËÆ©ÂÖ∂‰ªñÈ°πÁõÆÊ≠£Â∏∏‰ΩøÁî®„ÄÇ source_file Ë∑ØÂæÑ‰∏≠Âá∫Áé∞ÁöÑÈÄöÈÖçÁ¨¶ * Ë°®Á§∫ÂåπÈÖç‰ªªÊÑèÂ≠óÁ¨¶Ôºå ** Ë°®Á§∫ÂåπÈÖçÊâÄÊúâÂΩìÂâçÊñá‰ª∂Â§πÂíåÂ≠êÊñá‰ª∂Â§π„ÄÇ s.resources ‰∏≠ÁöÑËµÑÊ∫êÊñá‰ª∂Â¶ÇÊûúÊòØÈùôÊÄÅÂ∫ìÂ∞±Áõ¥Êé•ÊîæÂú® mainBundle ‰∏≠ÔºåÂ¶ÇÊûúÊòØÂä®ÊÄÅÂ∫ìÂ∞±ÊîæÂú®Âä®ÊÄÅÂ∫ìÊâÄÂú® bundle ‰∏≠„ÄÇËøôÊ†∑Êñá‰ª∂Â§ö‰∫ÜÂèØËÉΩ‰ºöÈáçÂêçÔºå‰∏ÄËà¨ÁöÑÂÅöÊ≥ïÊòØËÆ≤ËµÑÊ∫êÊñá‰ª∂ÂÖàËá™Â∑±Êâì‰∏™ bundleÔºåÁÑ∂ÂêéÂÜçÈÄöËøá s.sources ÂºïÂÖ•„ÄÇÂè¶Â§ñÔºåCocoapods Êèê‰æõ‰∫Ü s.resource_bundlesÔºåÂèØ‰ª•Â∞ÜËµÑÊ∫êÊñá‰ª∂ÊåâÈúÄÊâìÊàê‰∏çÂêåÁöÑ bundle„ÄÇÊØîÂ¶Ç‰∏äÈù¢Â∞±ÊòØÂ∞Ü StaticWithCocoapods/Assets/*.png ÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÂõæÁâáÊâìÊàê StaticWithCocoapods ÁöÑ bundle„ÄÇ ËøôÈáåÁöÑ dependency ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊòØ cocoapods ÁöÑÂÆòÊñπÂ∫ì‰∏≠ÁöÑ„ÄÇÂΩìÁÑ∂‰Ω†‰πüÂèØ‰ª•ÁªôËá™Â∑±ÂàõÂª∫ÁöÑÂ∫ìÊ∑ªÂä†Ëá™Â∑±ÁöÑÁßÅÊúâÂ∫ìÔºåÂêåÊ†∑ÊòØÁõ¥Êé•ÂÜôÂú® dependency Èáå„ÄÇ‰ΩÜÊòØÁî±‰∫é dependency Ë°®Á§∫ÁºñËØëÂô®ÈúÄË¶ÅËøôÊ†∑ÁöÑ‰∏Ä‰∏™‰æùËµñÔºåÊ≤°ÊúâÊåáÂÆö‰ªéÂì™ÈáåËé∑ÂèñÔºåÂõ†Ê≠§ÔºåÊ∑ªÂä†ÁßÅÊúâÂ∫ìÁöÑÊó∂ÂÄôË¶ÅÂú®‰ΩøÁî®Ëøô‰∏™Â∫ìÁöÑÂ∑•Á®ãÁöÑ Podfile ‰∏≠Ê∑ªÂä†‰Ω†ÁßÅÊúâÂ∫ìÁöÑËøúÁ´ØÂú∞ÂùÄ„ÄÇËøôÊ†∑ÁöÑËØùÔºåÂú®‰∏ãËΩΩ s.dependency Êó∂ÔºåÂÆòÊñπÂ∫ìÊâæ‰∏çÂà∞ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ∞±‰ºöÂà∞ÁßÅÊúâÂ∫ìÁöÑËøúÁ´ØÂú∞ÂùÄ‰∏≠Êü•Êâæ„ÄÇÂ¶ÇÊûúÈÉΩÊâæ‰∏çÂà∞Â∞±‰ºö pod install Â§±Ë¥•„ÄÇÊúâ‰∏ÄÁßçÊÉÖÂÜµ‰∏çÁî®Ê∑ªÂä†ÁßÅÊúâÂ∫ìÁöÑËøúÁ´ØÂú∞ÂùÄÔºå‰πüÂèØ‰ª• install ÊàêÂäü„ÄÇÈÇ£Â∞±ÊòØÂú® Podfile ‰∏≠Ê∑ªÂä†Ëøô‰∏™ÁßÅÊúâÂ∫ìÔºåÂπ∂‰∏∫Ëøô‰∏™ÁßÅÊúâÂ∫ìËÆæÁΩÆÊú¨Âú∞Ë∑ØÂæÑ :path„ÄÇÁî±‰∫é s.dependency ÂÖ∂ÂÆûÊòØÂàõÂª∫‰∫Ü‰∏Ä‰∏™Â§ñÈÉ®‰æùËµñÔºåÊâÄ‰ª•Âè™Ë¶ÅÂ§ñÈÉ®Â≠òÂú®Ëøô‰∏™ÁßÅÊúâÂ∫ìÔºås.denpendency Â∞±‰ºöËá™Âä®ÈìæÊé•ËøáÂéª„ÄÇËøô‰∏ÄÁÇπÈùûÂ∏∏ÈùûÂ∏∏ÈáçË¶Å„ÄÇÊàë‰ª¨Âπ≥Êó∂Áî® pod ÂÆûÁé∞ÁªÑ‰ª∂ÂåñÂ∞±ÊòØËøô‰πàÂÅöÁöÑ„ÄÇÊØîÂ¶Ç‰Ω†ÁöÑ‰∏ªÂ∑•Á®ãÂêåÊó∂‰æùËµñ‰∫éÁßÅÊúâÂ∫ì pod AÔºåpod BÔºå‰ª•ÂèäÊú¨Âú∞ÁßÅÊúâÂ∫ì pod C„ÄÇ‰∏éÊ≠§ÂêåÊó∂Ôºåpod A Âíå pod B ‰πü‰æùËµñ‰∫é pod C„ÄÇËøô‰∏™Êó∂ÂÄôÊòØ‰∏çÊòØ‰∏ÄÂÆöË¶ÅÂ∞Ü pod C ÊîæÂà∞ËøúÁ´ØÔºåÁÑ∂ÂêéÊâçËÉΩÊàêÂäüËÆæÁΩÆ pod A Âíå pod B Âë¢ÔºüËÇØÂÆö‰∏çÁî®„ÄÇÂõ†‰∏∫ pod C Â∑≤ÁªèÈÄöËøáÊú¨Âú∞Ë∑ØÂæÑÂºïÂÖ•: pod &#39;C&#39;, :path =&gt; &#39;../&#39;„ÄÇÊâÄ‰ª• pod A Âíå pod B ÁöÑ s.dependency Â∞±‰∏çÈúÄË¶ÅÂÜçÂà∞ËøúÁ´ØÂéªÊü•Êâæ pod C ‰∫Ü„ÄÇ ‰ªÄ‰πàÊó∂ÂÄôÁî® s.subspec Âë¢Ôºü‰∏ÄËà¨‰∏Ä‰∏™Â§ßÁöÑÈ°πÁõÆÂÜôÊàêpodÁöÑÊó∂ÂÄôÔºåÂÆÉÂèØËÉΩ‰ºöÂàÜ‰∏∫Â§ö‰∏™subspecÔºåËøôÊ†∑ÁöÑËØùÂΩì‰Ω†Áî®‰∏Ä‰∏™Â∫ûÂ§ßÁöÑÂ∫ìÊó∂ÔºåÂè™ÈúÄË¶ÅÂÖ∂‰∏≠ÁöÑ‰∏ÄÂ∞èÈÉ®ÂàÜÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•‰ΩøÁî®ÂÖ∂‰∏≠ÁöÑÊüê‰∏™subspec‰∫Ü„ÄÇ Êàë‰ª¨ÊãøAFNetworking.podspecÊù•Áúã: 123pod 'AFNetworking/Reachability'ÊàñËÄÖpod 'AFNetworking',:subspecs=&gt;['Reachability','Security'] ÊâÄ‰ª•ÂèØ‰ª•ÊääsubspecÂΩìÂÅö‰∏Ä‰∏™Â∞èÂûãÁöÑpodÊù•Áúã„ÄÇÊù•Áúã‰∏Ä‰∏ãÁî® subspec ÂêéÔºåÂú® pod install ÂêéÂæóÂà∞Â¶Ç‰∏ãÊñá‰ª∂ÁªìÊûÑ„ÄÇ‰ΩøÁî®‰∫Ü subspec ÂêéÔºåsubspec ‰ºöÂçïÁã¨ÂèòÊàê‰∏Ä‰∏™Êñá‰ª∂Â§πÔºö Ê∑ªÂä†Êñá‰ª∂Âêë sources_files Âíå public_header_files ‰ª•Âèä resource_bundle ‰∏≠Ê∑ªÂä†ÂõæÁâáÂíåÁ±ªÊñá‰ª∂„ÄÇÂú® demo ÁöÑÊñá‰ª∂Â§π‰∏ãÊâßË°å pod install„ÄÇÁé∞Âú®ÊâìÂºÄ demo Â∑•Á®ãÔºåÂèØ‰ª•ÁúãÂà∞ÂàõÂª∫ÁöÑ StaticWithCocoapods Â∫ìÁöÑÊñá‰ª∂ÁªìÊûÑÂ¶Ç‰∏ãÂõæÔºö Áé∞Âú®Â∑•Á®ãÈáåÊòØÂ∏¶Êúâ demo application ÁöÑÔºå‰∏çËøá‰∏çÁî®ÊãÖÂøÉÔºåÂú®.podspec ‰∏≠Â∑≤ÁªèËÆæÁΩÆ‰∫ÜÊ∫êÊñá‰ª∂ÁöÑÁõÆÂΩïÔºå‰∏ç‰ºöÊää demo ‰∏≠ÁöÑÂêÑÁßçÊµãËØïÊñá‰ª∂‰πüÊâìÂåÖËøõÂéªÁöÑ„ÄÇ ‰∏çË¶ÅÂú®ÊÑè‰∏äÈù¢ÂõæÁâá‰∏äÁöÑÂõæÁâáË∑ØÂæÑ Âíå .podspec ‰∏≠ËÆæÁΩÆÁöÑ s.resource_bundles Ë∑ØÂæÑ‰∏ç‰∏ÄËá¥„ÄÇËøôÈáåÁöÑ Resources Áúã‰ººÊòØ‰∏™Êñá‰ª∂Â§πÔºåÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™ groupÔºå‰∏çÊòØÂÆûÈôÖÊñá‰ª∂Ë∑ØÂæÑÁöÑÂú∞ÂùÄ„ÄÇÊú¨‰æã‰∏≠ÂÆûÈôÖÁöÑÂú∞ÂùÄÂ∞±ÊòØ [&#39;StaticWithCocoapods/Assets/*.png&#39;] Ëøô‰∏™Ë∑ØÂæÑ„ÄÇ Âä†ËΩΩÂõæÁâáËµÑÊ∫êÁöÑÈóÆÈ¢òÂà∞ËøôÈáå‰∏ÄÂàáÊ≠£Â∏∏Ôºå‰πüÂèØ‰ª•‰ΩøÁî® SVProgressHUD Ôºå‰ΩÜÊòØÂΩìÊàëÊÉ≥Áî® [UIImage imageNamed:[[[NSBundle mainBundle] pathForResource:@&quot;StaticWithCocoapods&quot; ofType:@&quot;bundle&quot;] stringByAppendingString:@&quot;/author.png&quot;]] Âä†ËΩΩÂõæÁâáËµÑÊ∫êÊñá‰ª∂Êó∂Ôºå‰∏ÄÁõ¥ËøîÂõû nil „ÄÇÊúÄÂêéÂú® Stackoverflow ÁöÑ‰∏Ä‰∏™ËØÑËÆ∫ÈáåÊÄªÁÆóÊâæÂà∞‰∫ÜËß£ÂÜ≥ÊñπÊ≥ï[Cocoapods]:Resource Bundle not accessbile ÂéüÂÖà demo ‰∏≠ prdfile ÁöÑÂÜÖÂÆπÂ¶Ç‰∏ãÔºö 1234567891011use_frameworks!target 'StaticWithCocoapods_Example' do pod 'StaticWithCocoapods', :path =&gt; '../' target 'StaticWithCocoapods_Tests' do inherit! :search_paths pod 'FBSnapshotTestCase' endend Áé∞Âú®Ë¶ÅÂà†Èô§ use_frameworks! ‰ª•ÂèäÂÖ∂Áõ∏ÂÖ≥ÂÜÖÂÆπÔºåÂèòÊàêËøôÊ†∑Ôºö 123target 'StaticWithCocoapods_Example' do pod 'StaticWithCocoapods', :path =&gt; ‚Äò../‚Äòend ÂÜçÊ¨°Â∞ùËØïÂä†ËΩΩÂõæÁâáÔºåÂèØ‰ª•ÂæóÂà∞Ê≠£Á°ÆÁªìÊûú. ^_^„ÄÇ‰ΩÜÊòØ‰∏∫‰ªÄ‰πà‰ºöËøôÊ†∑Ôºü use_frameworks! ÁöÑÊ∑ªÂä†‰∏éÂê¶ÔºåË°®Á§∫Â∞Ü pod ‰∏≠ÁöÑÂ∫ìÊâìÂåÖÊàêÈùôÊÄÅÂ∫ì.a ËøòÊòØÂä®ÊÄÅÂ∫ì.framework„ÄÇÂÖ∂ÂÆûÂ∞±ÊòØÂõæÁâáÂú®ÁõóÂÆùÊàêÈùôÊÄÅÂ∫ìÊàñËÄÖÂä®ÊÄÅÂ∫ìÁöÑÊó∂ÂÄôÊâÄÂ§ÑÁöÑ bundle ‰∏çÂêå„ÄÇ Â¶ÇÊûúÊâìÂåÖÊàê‰∫Ü .aÔºåÈÇ£‰πàÁºñËØëÁöÑÊó∂ÂÄôÂ∫ìÈáåÁöÑÊâÄÊúâÊñá‰ª∂ÂÖ∂ÂÆûÊòØË¢´ÊâìÂåÖÂú®‰∏ªÂ∑•Á®ã‰∏ãÁöÑÔºåÂç≥ mainBundle ‰∏≠ÔºåÂç≥ÂèØÂÉèÈÄöÂ∏∏ÈÇ£Ê†∑Âú® mainBundle ‰∏≠Ëé∑Âèñ StaticWithCocoapods.bundle ‰∏≠ÁöÑÂõæÁâá„ÄÇ Â¶ÇÊûúÊâìÂåÖÊàê‰∫Ü .framework ÔºåÂä®ÊÄÅÂ∫ìÈáåÁöÑÊñá‰ª∂‰∏çÂÜçË¢´ÊâìÂåÖÂú®‰∏ªÂ∑•Á®ã‰∏ã‰∫ÜÔºåËÄåÊòØÂú®Âä®ÊÄÅÂ∫ìËá™Â∑±ÁöÑ bundle ‰∏≠ÔºåÊØîÂ¶ÇÊú¨‰æã‰∏≠ÁöÑÂä®ÊÄÅÂ∫ì bundle Ë∑ØÂæÑÂ¶Ç‰∏ãÔºö Ê≠§Êó∂Â∞±‰∏çËÉΩÂÜçÂú® mainBundle ‰∏≠ÔºåËÄåÈúÄË¶ÅÂú®Âä®ÊÄÅÂ∫ì‰∏≠ÁöÑ bundle ‰∏ãÊâæÊñá‰ª∂‰∫Ü„ÄÇÊàë‰ª¨ÂèØ‰ª•Â≠¶‰π†‰∏ã SVProgressHUD ÁöÑÂÅöÊ≥ïÔºåÈÄöËøá [NSBundle bundleForClass:[SVProgressHUD class]] ÊãøÂà∞ SVProgressHUD Êñá‰ª∂ÊâÄÂú®ÁöÑ bundleÔºå‰πüÂ∞±ÊòØËµÑÊ∫êÊñá‰ª∂ÊâÄÂú®ÁöÑ SVProgressHUD.Bundle ÊâÄÂú®ÁöÑ bundleÔºåÁÑ∂ÂêéËé∑ÂèñÂõæÁâáÔºö 1234NSBundle *bundle = [NSBundle bundleForClass:[SVProgressHUD class]];NSURL *url = [bundle URLForResource:@"SVProgressHUD" withExtension:@"bundle"];NSBundle *imageBundle = [NSBundle bundleWithURL:url];UIImage* infoImage = [UIImage imageWithContentsOfFile:[imageBundle pathForResource:@"info" ofType:@"png"]]; ÊµãËØïÁ±ªÂ∫ìÂú® demo application ‰∏≠ÔºåÂ¶ÇÊûúÊääËá™Â∑±ÁöÑÂ∫ì‰ΩøÁî® pod ÂºïÂÖ•ÔºåÊ≥®ÊÑèË¶Å‰øÆÊîπ Podfile ‰∏≠Â∫ìÁöÑË∑ØÂæÑ‰∏∫Êú¨Âú∞ podspec ÊâÄÂú®ÁöÑË∑ØÂæÑÔºå‰∏çÁÑ∂ÊØèÊ¨°ÈÉΩË¶Å‰ªéËøúÁ´ØÊãâ‰∫Ü„ÄÇÂè¶Â§ñËøòÊúâ‰∏Ä‰∏™ÈóÆÈ¢òÊòØËøôÊ†∑ÊØèÊ¨°Êõ¥Êñ∞Â∫ìÈáåÁöÑÂÜÖÂÆπÔºåËøêË°åÁöÑÊó∂ÂÄôÈÉΩË¶ÅÂÖà pod install ‰∏Ä‰∏ãÔºåËøôÊ†∑ÈùûÂ∏∏ÁöÑÈ∫ªÁÉ¶„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Â∞ÜÂ∫ìÈáåÁöÑÊñá‰ª∂Ê∑ªÂä†Âà∞ demo application ‰∏≠ÔºåÂêåÊó∂Ë¶Å‰øÆÊîπ PodfileÔºå‰ΩøÂÖ∂‰∏çË¶Å pod Ëá™Ë∫´ÔºåËÄåÊòØ pod ÂÖ∂‰æùËµñÁöÑÂÖ∂‰ªñÁ±ªÂ∫ì„ÄÇËøôÊ†∑ÂÅöÂ∞±ÊòØÊääÁ±ªÂ∫ìÁöÑÊñá‰ª∂ÊîæÂà∞‰∏ªÂ∑•Á®ã‰∏ãÔºåÂ∞±‰∏çÁî®ÊØèÊ¨°ÈÉΩ pod install Êõ¥Êñ∞‰øÆÊîπ‰∫Ü„ÄÇÊØîÂ¶ÇÔºö 123456789# ÂéüÊù•ÂèØËÉΩÊòØËøôÊ†∑ÁöÑtarget 'StaticWithCocoapods_Example' do pod 'StaticWithCocoapods', :path =&gt; ‚Äò../‚Äòend# Áé∞Âú®Ë¶ÅÊää‰æùËµñ StaticWithCocoapods ÁöÑÁ±ªÂ∫ìÂä†‰∏äÔºåÂà†Èô§Ëá™Â∑±Ôºötarget 'StaticWithCocoapods_Example' do pod 'SVProgressHUD'end ‰∏çÁî®ÊãÖÂøÉËøôÊ†∑ÂÅö‰∏ç‰ºö‰∫ßÁîü‰ªª‰ΩïÈóÆÈ¢ò„ÄÇdemo ‰∏≠ÁöÑÊñá‰ª∂‰æùËµñÁöÑÊîπÂä®Âπ∂‰∏çÂΩ±Âìç .podspec ‰∏≠ÁöÑËÆæÁΩÆÔºåÂè™Ë¶ÅÊñá‰ª∂ËøòÊòØÊîæÂú® .podspec ÁöÑÊåáÂÆöË∑ØÂæÑ‰∏ãÂ∞±Ë°å„ÄÇÂèëÂ∏ÉÁ±ªÂ∫ìÁöÑÊó∂ÂÄôËøòÊòØÊåâÁÖß .podspec ËøõË°åÁöÑÔºåÊâÄ‰ª•Ê≤°Êúâ‰ªª‰ΩïÂΩ±Âìç„ÄÇ ‰ΩÜÊòØË¶ÅÊ≥®ÊÑè‰∏ÄÁÇπÔºåËôΩÁÑ∂‰Ω†ÊääÊñá‰ª∂ÊîæÂú®‰∏ªÂ∑•Á®ã‰∏ãÁºñËØëÔºå‰ΩÜÊòØ‰ª£Á†Å‰∏≠Ëé∑ÂèñËµÑÊ∫êÊñá‰ª∂ÁöÑÊó∂ÂÄôÁªùÂØπ‰∏çËÉΩÂÅ∑Êáí‰ΩøÁî® mainBundle Âä†ËΩΩ„ÄÇÂõ†‰∏∫Âà´‰∫∫ÂèØËÉΩÂ∞Ü‰Ω†ÂèëÂ∏ÉÁöÑÂ∫ìÊâìÊàêÂä®ÊÄÅÂ∫ìÊîæÂà∞Ëá™Ë∫´ÁöÑÂ∑•Á®ã‰∏≠ÔºåËøôÂ∞±‰ºöÈÄ†Êàê‰∏äÈù¢Âä†ËΩΩÂõæÁâáËµÑÊ∫ê‰∏ÄÊ†∑ÁöÑÈóÆÈ¢ò„ÄÇÊâÄ‰ª•Âä†ËΩΩËµÑÊ∫êÊñá‰ª∂ÁöÑÊó∂ÂÄô‰∏ÄÂÆöË¶ÅÁî®‰∏äÈù¢ËØ¥ÁöÑÈÄöÁî®ÁöÑÊñπÊ≥ï„ÄÇ Êèê‰∫§‰ª£Á†Å ‰ΩøÁî® sourcetree Ê∑ªÂä†Êú¨Âú∞‰ªìÂ∫ì Êèê‰∫§‰∏äÈù¢ÁöÑÊâÄÊúâÊîπÂä® ‰∏∫ÊîπÂä®Ê∑ªÂä† tag ‰∏∫ 0.1.0 ËÆæÁΩÆÂ•ΩÂêéÂ¶ÇÂõæÔºö ËøôÈáåË¶ÅÊ≥®ÊÑèÔºåtag ‰∏ÄÂÆöË¶ÅÊâì‰∏äÔºåÁâàÊú¨ÊéßÂà∂ÁöÑÊó∂ÂÄôÂ∞±ÊòØ‰ª• tag Êù•Ëæ®Âà´ÁöÑ„ÄÇ È™åËØÅÁ±ªÂ∫ìÂºÄÂèëÂÆåÊàêÈùôÊÄÅÁ±ªÂ∫ì‰πãÂêéÔºåÈúÄË¶ÅËøêË°åpod lib lintÈ™åËØÅ‰∏Ä‰∏ãÁ±ªÂ∫ìÊòØÂê¶Á¨¶ÂêàpodÁöÑË¶ÅÊ±Ç„ÄÇÊ∑ªÂä† --allow-warnings ÂøΩÁï•Ë≠¶ÂëäÔºö ÊâìÂåÖÂ∫ìÂ¶ÇÊûú‰Ω†Ë¶ÅÂèëÂ∏ÉÂà∞ cocoapdsÔºåÈÇ£‰πàËøô‰∏™Êìç‰ΩúÊòØ‰∏çÂøÖË¶ÅÁöÑ„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú‰Ω†ÊÉ≥Áõ¥Êé•Ëé∑Âæó‰∏Ä‰∏™Âä®ÊÄÅÊàñËÄÖÈùôÊÄÅÂ∫ìÔºåÈÇ£‰πàÂèØ‰ª•ÊâãÂä®ÊâìÂåÖËøô‰∏™Â∫ì„ÄÇ ÊâìÂåÖÂ∫ìÈúÄË¶Å‰∏Ä‰∏™ cocoapods ÁöÑÊèí‰ª∂ cocoapods-packagerÊù•ÂÆåÊàêÁ±ªÂ∫ìÁöÑÊâìÂåÖ„ÄÇ Âú®ÁªàÁ´ØÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ÔºåÂÆâË£ÖÊèí‰ª∂Ôºö 1sudo gem install cocoapods-packager Âú®ÁõÆÊ†áÊñá‰ª∂Â§πÂÜÖÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ÔºåÂÆåÊàêÊâìÂåÖÔºö 1pod package StaticWithCocoapods.podspec --force ÊâìÂåÖÊàê .framework Ôºå‰πüÂèØ‰ª•Áî® --library ÊâìÂåÖÊàê .a „ÄÇ Áé∞Âú®Âú®ÁõÆÊ†áÊñá‰ª∂Â§π‰∏ãÂ∞±‰ºöÂ§öÂá∫‰∏Ä‰∏™ StaticWithCocoapods-0.2.0 ÁõÆÂΩïÔºåÈáåÈù¢ÊòØÊâìÂåÖÂ•ΩÁöÑ framework „ÄÇ ËôΩÁÑ∂ s.dependency Âè™ÊòØÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÈìæÊé•Ôºå‰ΩÜÊòØ package ‰ºö‰∏ãËΩΩ dependency ÁöÑ‰ª£Á†ÅÔºåÂπ∂Â∞ÜÂÖ∂ÊâìÂåÖËøõ‰Ω†ÁöÑÂ∫ì‰∏≠ ÂèëÂ∏É.podspecÊúÄÂêé‰∏ÄÊ≠•ÔºöÂèëÂ∏É„ÄÇÂú®‰ªìÂ∫ìÁõÆÂΩï‰∏ãÊâßË°åÔºö 1pod trunk push xxxxx.podspec ‰∏äËø∞ÂëΩ‰ª§Â∞Ü‰ºöÊõ¥Êñ∞Êú¨Âú∞ÁöÑ repo ÁõÆÂΩïÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂Êèê‰∫§Âà∞CocoapodsÂÆòÊñπÁöÑ‰ªìÂ∫ìÈáåÂéª„ÄÇ Êèê‰∫§ÂÆåÊàêÂêéÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰∏Ä‰∏ãÂëΩ‰ª§Êü•ËØ¢ÊòØÂê¶‰∏ä‰º†ÊàêÂäüÔºö 1pod search xxx Â¶ÇÊûúÊòØÂ§ö‰∫∫ÂºÄÂèëÔºåÂ∏åÊúõÂ∞ÜÂÖ∂‰ªñ‰∫∫‰πüÂä†ÂÖ•Âà∞È°πÁõÆ‰∏≠ÂéªÁöÑËØùÔºåÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÊñπÂºèÔºö 1pod trunk add-owner 'È°πÁõÆÂêç' 'ÈÇÆÁÆ±' Êõ¥Êñ∞Âà†Èô§Á≠âÊìç‰ΩúÂΩìÁâàÊú¨Êõ¥Êñ∞ÂêéÔºåÈúÄË¶ÅÂÅöÁöÑÂ∞±ÊòØÊîπÂèò xxx.podspec ‰∏≠ÁöÑÁâàÊú¨Âè∑ÔºåÁÑ∂ÂêéÈáçÂ§ç‰∏ä‰∏ÄÊ≠•ÁöÑÊ≠•È™§ÂèëÂ∏ÉÂç≥ÂèØ„ÄÇ Ëá≥‰∫éÂà†Èô§Â∫üÂºÉÁ≠âÊìç‰ΩúÂèØ‰ª•ËØ¶ËßÅpod trunk ÁöÑ help‰∏≠Ôºö CocoaPodsÂÖ¨Êúâ‰ªìÂ∫ìÁöÑÂàõÂª∫ CocoapodsÁ≥ªÂàóÊïôÁ®ã(‰∫å)‚Äî‚ÄîÂºÄÊ∫ê‰∏ª‰πâÊé•Áè≠‰∫∫ ÂàõÂª∫‰∏Ä‰∏™ÁßÅÊúâÂ∫ìÂàõÂª∫ÁâàÊú¨Â∫ìÔºàrepoÔºâ‰πãÂâçËØ¥Âà∞ÔºåÂú®~/.cocoapods/repos/ ÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™ master Êñá‰ª∂Â§πÔºåÂØπÂ∫îÁùÄ cocoapods ÂÆòÊñπÁöÑ‰∏Ä‰∏™ÁâàÊú¨Â∫ìÔºå‰øùÂ≠òÁùÄÂêÑ‰∏™Á¨¨‰∏âÊñπÂ∫ìÁöÑÁ¥¢Âºï„ÄÇÊàë‰ª¨Ë¶ÅÂàõÂª∫‰∏Ä‰∏™ÁßÅÊúâÂ∫ìÔºåÂ∞±ÂæóÂÖàÂàõÂª∫‰∏Ä‰∏™ÁßÅÊúâÁöÑÁâàÊú¨Â∫ìÊù•Â≠òÊîæËøô‰∫õÁßÅÊúâÂ∫ìÁöÑÁ¥¢Âºï„ÄÇ Êàë‰ª¨ÂÖàÂú®ËøúÁ´ØÂàõÂª∫‰∏Ä‰∏™Á©∫ÁöÑ‰ªìÂ∫ìtestÔºåÁÑ∂ÂêéÂÜçÁªàÁ´ØÊâßË°åÔºö 1$ pod repo add test https://git.oschina.net/baiyingqiu/test.git Ëøô‰∏™‰ªìÂ∫ìÂ∞±Ë¢´ clone ‰∫Ü‰∏ãÊù•Ôºå‰Ωú‰∏∫Êú¨Âú∞ÁöÑÁâàÊú¨ÁõÆÂΩï‰∫ÜÔºåÂèØ‰ª•ËøõÂÖ•~/.cocoapods/repos/ Êñá‰ª∂Â§πÊü•ÁúãÔºö ÂàõÂª∫.podspecÂíå‰∏äÈù¢ÂÖ¨ÊúâÁöÑÊó†‰∫åËá¥„ÄÇÂ∞ÜÊú¨Âú∞‰ª£Á†ÅÊé®ÈÄÅÂà∞ËøúÁ®ãÔºåÂπ∂Êâì‰∏ä tag„ÄÇ ÈúÄË¶ÅÊòéÁ°ÆÔºåcocoapods ÊòØÈÄöËøá tag Êù•Âå∫ÂàÜÁâàÊú¨‰ø°ÊÅØÁöÑÔºåËÄå‰∏çÊòØ branch„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå‰∏çËÆ∫‰Ω†ÁöÑ tag ÊòØÊâìÂú® master ËøòÊòØ develop ‰∫¶Êàñ‰ªªÊÑè‰∏Ä‰∏™ÂÖ∂‰ªñÂàÜÊîØÔºåcocoapods ÈÉΩËÉΩÂ§üÊ≠£Á°ÆËé∑ÂèñËØ• tag ÊâÄÂ§ÑÁöÑ commit ÁöÑÊñá‰ª∂„ÄÇ ÊâÄ‰ª•‰Ω†ÁöÑÁßÅÊúâÂ∫ìÂÖ∂ÂÆû‰∏çÁî®ÂÜçÂºÄ‰∏Ä‰∏™Êñ∞ÁöÑ repo ÂéªÂ≠òÂÇ®ÔºåÂèØ‰ª•Áõ¥Êé•Âú®ÂΩìÂâçÂ∑•Á®ã‰∏ãÂºÄÂèë„ÄÇÊñ∞ÂºÄ‰∏Ä‰∏™ÁßÅÊúâÂ∫ìÁöÑÂàÜÊîØÔºå‰∏ìÈó®ÂºÄÂèëÁßÅÊúâÂ∫ì‰πüÊòØÊ≤°ÊúâÈóÆÈ¢òÁöÑ„ÄÇ Â∞ÜÊèèËø∞Êñá‰ª∂Êé®ÈÄÅÂà∞ÁâàÊú¨Â∫ìÂ∞ÜÊàë‰ª¨ÁßÅÊúâÂ∫ìÁöÑÊèèËø∞‰ø°ÊÅØ push Âà∞ÂàöÊâçÁöÑÁâàÊú¨Â∫ì‰∏≠Ôºö 1$ pod repo push test xxx.podspec --verbose --allow-warnings Ë¶ÅÂä†‰∏ä --allow-warnings ‰∏çÁÑ∂ËøòÊòØ‰∏çËÉΩÈÄöËøá„ÄÇ Áé∞Âú®Â∞±ÂèØ‰ª•ÈÄöËøá pod search xxx Êù•ÊêúÁ¥¢‰∫Ü„ÄÇ ‰ΩøÁî®ÁßÅÊúâÂ∫ì‰ΩøÁî®ÁßÅÊúâÂ∫ìÁöÑÊó∂ÂÄôË¶ÅÂú®‰ΩøÁî®ÁöÑÂ∑•Á®ãÁöÑ Podfile ‰∏≠Âä†‰∏äÁßÅÊúâÂ∫ìÁöÑÁâàÊú¨Â∫ìÁöÑË∑ØÂæÑÔºåËã•ÊúâËøò‰ΩøÁî®‰∫ÜÂÖ¨ÊúâÁöÑpodÂ∫ìÔºåÈúÄË¶ÅÊääÂÖ¨ÊúâÂ∫ìÂú∞ÂùÄ‰πüÂ∏¶‰∏ä„ÄÇ‰æãÂ≠êÔºö 12345678source ‚Äòhttps://github.com/CocoaPods/Specs.git‚Äôsource ‚Äòhttps://github.com/zhang759740844/test.git‚Äôplatform :ios, '8.0'target ‚ÄòMike‚Äô do pod 'xxx'end Áé∞Âú®Â∞±ÂèØ‰ª• pod install ‰∫Ü„ÄÇ CocoaPodsÁßÅÊúâ‰ªìÂ∫ìÁöÑÂàõÂª∫ CocoapodsÁ≥ªÂàóÊïôÁ®ã(‰∏â)‚Äî‚ÄîÁßÅÊúâÂ∫ìÁÆ°ÁêÜÂíåÊ®°ÂùóÂåñÁÆ°ÁêÜ ‰ΩøÁî®CocoapodsÂàõÂª∫ÁßÅÊúâpodspecÊé®Ëçê]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Cocoapods</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS ‰∏≠ÁöÑÂÆè]]></title>
    <url>%2F2017%2F06%2F30%2FiOS%E4%B8%AD%E7%9A%84%E5%AE%8F%2F</url>
    <content type="text"><![CDATA[Â≠¶‰∏Ä‰∏ãÂ¶Ç‰ΩïÂú® OC ‰∏≠Ëá™ÂÆö‰πâÂÆè„ÄÇÂèÇËÄÉËá™ÂÆòÊñπÊñáÊ°£ Á±ªÂØπË±°ÂÆèÁ±ªÂØπË±°ÂÆèÊòØ‰∏ÄÁßç‰ºöÂú®È¢ÑÂ§ÑÁêÜÊó∂Ë¢´‰ª£Á†ÅÁâáÊÆµÊõø‰ª£ÁöÑÁÆÄÂçïÊ†áËØÜ„ÄÇ‰πãÊâÄ‰ª•Ë¢´Âè´ÂÅöÁ±ªÂØπË±°ÂÆèÊòØÂõ†‰∏∫Âú®‰ΩøÁî®ÁöÑÊó∂ÂÄôÁ±ª‰ºº‰∫é‰∏Ä‰∏™ÂØπË±°„ÄÇÊúÄÂ∏∏ËßÅÁöÑ‰ΩøÁî®ÊñπÂºèÊòØÁî®ÂÖ∂‰∏∫‰∏Ä‰∏™Â∏∏ÈáèÂÆö‰πâ‰∏Ä‰∏™Âà´Âêç„ÄÇ Âü∫Êú¨‰ΩøÁî®ÊúÄÂü∫Êú¨ÁöÑ‰ΩøÁî®ÊñπÂºèÔºö 123456// ÂÆö‰πâ#define BUFFER_SIZE 1024// ‰ΩøÁî®foo = (char *) malloc (BUFFER_SIZE); ‚Üí foo = (char *) malloc (1024); ‰∏ÄËà¨ÁöÑÔºåÈÉΩË¶Å‰ΩøÁî®Â§ßÂÜôÊù•ÂëΩÂêçÂÆè„ÄÇ Êç¢Ë°åÂÆèÂÆö‰πâÂú® #define ÈÇ£‰∏ÄË°åÁªìÊùü„ÄÇÂ¶ÇÊûú‰Ω†Ë¶Å‰π¶ÂÜôÂ§öË°åÔºåÈúÄË¶Å‰ΩøÁî® \ Êç¢Ë°å„ÄÇÂú®ÂÆèÂ±ïÂºÄÁöÑÊó∂ÂÄôÔºå‰ºöË¢´Ëá™Âä®Â±ïÂºÄ‰∏∫‰∏ÄË°åÔºö 12345#define NUMBERS 1, \ 2, \ 3int x[] = &#123; NUMBERS &#125;; ‚Üí int x[] = &#123; 1, 2, 3 &#125;; È°∫Â∫èÊõøÊç¢È¢ÑÂ§ÑÁêÜÂô®È°∫Â∫èÁöÑËØªÂèñÁ®ãÂ∫èÔºåÂõ†Ê≠§Âè™ÊúâÂú®ÂÆö‰πâÂÆè‰πãÂêéÔºåÂÆèÊâçËÉΩÁîüÊïàÔºö 1234567foo = X;#define X 4bar = X;//----result----foo = X;bar = 4; ÂÆèÊòØ‰∏Ä‰∏™ÊõøÊç¢ËøáÁ®ãÔºåÂú®È°∫Â∫èÊõøÊç¢ÁöÑÊó∂ÂÄôÔºåX ËøòÊ≤°ÊúâË¢´ÂÆö‰πâÔºåÊâÄ‰ª• foo = XÔºå‰πãÂêéÂÆè X Ë¢´ÂÆö‰πâ‰∫ÜÔºåÊâÄ‰ª•‰πãÂêéÁöÑËØªÂèñÂÆèÁöÑÈÉΩ‰ºöË¢´ÊõøÊç¢‰∏∫ÂÖ∑‰ΩìÂÜÖÂÆπ„ÄÇ ÂµåÂ•óÂÆèÂú®ÊãìÂ±ïÂÆèÁöÑÊó∂ÂÄôÔºåÈ¢ÑÂ§ÑÁêÜÂô®‰ºöÊ£ÄÊü•ÂÆèÁöÑÂÜÖÂÆπÊòØÂê¶ËøòÊòØ‰∏Ä‰∏™ÂÆèÔºå‰ºöÂØπÂÖ∂ÁªßÁª≠ÊõøÊç¢Ôºö 12345#define TABLESIZE BUFSIZE#define BUFSIZE 1024TABLESIZE ‚Üí BUFSIZE ‚Üí 1024 ÂÆèÂÆö‰πâ‰ª•ÊúÄÂêéÁîüÊïàÁöÑÂÆö‰πâ‰∏∫ÂáÜÔºåÂõ†Ê≠§‰∏ãÈù¢ÁöÑ‰ª£Á†Å TABLESIZE ÂØπÂ∫î37: 1234#define BUFSIZE 1020#define TABLESIZE BUFSIZE#undef BUFSIZE#define BUFSIZE 37 Á±ªÂáΩÊï∞ÂÆèÂÆèËøòÂèØ‰ª•ÂÆö‰πâÂáΩÊï∞Ôºö 123#define lang_init() c_init()lang_init() ‚Üí c_init() Ê≥®ÊÑèÔºå() ‰∏ÄÂÆöË¶ÅË∑üÂú®ÂêçÁß∞ÂêéÈù¢ÔºåÂê¶Âàô‰ºöË¢´ËÆ§‰∏∫ÊòØ‰∏Ä‰∏™Á±ªÂØπË±°ÂÆèÔºö 123#define lang_init () c_init()lang_init() ‚Üí () c_init()() È¢ÑÂ§ÑÁêÜÂô®‰ºöËÆ§‰∏∫ lang_init ÊòØ‰∏Ä‰∏™Êï¥‰ΩìÔºå() c_init() ÊòØ‰∏Ä‰∏™Êï¥‰ΩìËøõË°åÊõøÊç¢„ÄÇ ÂÆèÂèÇÊï∞ÂèØ‰ª•Âú®Á±ªÂáΩÊï∞ÂÆè‰∏≠‰º†ÂÖ•ÂèÇÊï∞Ôºö 123#define min(A, B) ((A) &lt; (B) ? (A) : (B))x = min(a, b); ‚Üí x = ((a) &lt; (b) ? (a) : (b)); Â¶ÇÊûúÂÆèÁöÑÂÜÖÂÆπ‰∏≠ÊúâÂ≠óÁ¨¶‰∏≤ÔºåÈÇ£‰πà‰∏ç‰ºöË¢´ÂÆèÂèÇÊï∞ÊõøÊç¢Ôºö 12#define foo(x) x, "x"foo(bar) ‚Üí bar, "x" ‰∏â‰∏™ÈùûÂ∏∏ÈáçË¶ÅÁöÑÊ≥®ÊÑè‰∫ãÈ°πÂÆèÁöÑ‰ΩøÁî®ÁªèÂ∏∏‰ºö‰∫ßÁîüÈîôËØØÔºå‰∏ãÈù¢‰∏âÁÇπËØ∑‰∏ÄÂÆöÊ≥®ÊÑèÔºåÊúâÂä©‰∫éÊ∂àÈô§Â§ßÈÉ®ÂàÜÁöÑ bug ‰∏∫ÂÆèÂèÇÊï∞Ê∑ªÂä†Êã¨Âè∑ÊØîÂ¶Ç‰∏äÈù¢ÁöÑ min ÁöÑ‰æãÂ≠êÔºåÂ¶ÇÊûúÊàë‰ª¨Âú®ÂÆèÁöÑÂÜÖÂÆπ‰∏≠‰∏ç‰∏∫ X Âíå Y Ê∑ªÂä†Êã¨Âè∑Ôºå‰ºöÂá∫Áé∞‰ªÄ‰πàÊ†∑ÁöÑÊÉÖÂÜµÔºü 1#define MIN(A,B) (A &lt; B ? A : B) ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã‰∏ç‰ºöÊúâ‰ªª‰ΩïÈóÆÈ¢òÔºå‰ΩÜÊòØÂ¶ÇÊûú A Êàñ B ÊòØ‰∏Ä‰∏™Ë°®ËææÂºèÔºåÂ∞±‰ºöÂá∫ÈîôÔºö 123456int a = MIN(3, 4 &lt; 5 ? 4 : 5);// =&gt; int a = (3 &lt; 4 &lt; 5 ? 4 : 5 ? 3 : 4 &lt; 5 ? 4 : 5); //Â∏åÊúõ‰Ω†ËøòËÆ∞ÂæóËøêÁÆóÁ¨¶‰ºòÂÖàÁ∫ß// =&gt; int a = ((3 &lt; (4 &lt; 5 ? 4 : 5) ? 3 : 4) &lt; 5 ? 4 : 5); //‰∏∫‰∫ÜÊÇ®‰∏çÂ§™Á∫†ÁªìÔºåÊàëÁªôËøô‰∏™ÂºèÂ≠êÂä†‰∏ä‰∫ÜÊã¨Âè∑// =&gt; int a = ((3 &lt; 4 ? 3 : 4) &lt; 5 ? 4 : 5)// =&gt; int a = (3 &lt; 5 ? 4 : 5)// =&gt; int a = 4 ÊâÄ‰ª•Ôºå‰∏ÄÂÆöË¶Å‰∏∫ÂÆèÂèÇÊï∞Ê∑ªÂä†Êã¨Âè∑Ôºå‰ΩøÂÖ∂‰Ωú‰∏∫‰∏Ä‰∏™ÂÄºË¢´‰ΩøÁî®„ÄÇ Ëã•ÂÆèÁöÑÁªìÊûú‰∏∫ÂÄºÔºåÂàô‰∏∫Êï¥‰∏™ÂÆèÊ∑ªÂä†Êã¨Âè∑ËøòÊòØ‰∏äÈù¢ min ÁöÑ‰æãÂ≠êÔºåÂ¶ÇÊûúÊ≠§Êó∂‰∏çÂú®Êï¥‰∏™Á∫¢ÁöÑÂ§ñÈù¢Ê∑ªÂä†Êã¨Âè∑Ôºå‰ºöÂ¶Ç‰ΩïÂë¢Ôºü 1#define min(A, B) (A) &lt; (B) ? (A) : (B) ÂêåÊ†∑ÁöÑÔºå‰∏ÄËà¨‰∏ç‰ºöÂá∫Áé∞‰ªÄ‰πàÈóÆÈ¢òÔºå‰ΩÜÊòØÂ¶ÇÊûúÂØπËøô‰∏™ÂÄºÂÅöÂÖ∂‰ªñÁöÑÊìç‰ΩúÔºö 1234int a = 2 * MIN(3, 4);// =&gt; int a = 2 * 3 &lt; 4 ? 3 : 4;// =&gt; int a = 6 &lt; 4 ? 3 : 4;// =&gt; int a = 4; Ë¢´ÊõøÊç¢ÂêéÔºåÁî±‰∫é‰ºòÂÖàÁ∫ßÁöÑÈóÆÈ¢òÔºå2*3 ‰ºöË¢´ÁéáÂÖàÊâßË°å„ÄÇÊâÄ‰ª•Ëøò‰∏äÈù¢Á±ª‰ººÁöÑÔºåË¶Å‰∏∫Êï¥‰∏™ÂÆèÊ∑ªÂä†Êã¨Âè∑Ôºå‰ΩøÂÖ∂‰Ωú‰∏∫‰∏Ä‰∏™ÂÄºË¢´‰ΩøÁî®„ÄÇ Ëã•ÂÆèÊõøÊç¢ÁöÑÊòØ‰ª£Á†ÅÂùóÔºåÂàôË¶Å‰∏∫ËøôÊÆµ‰ª£Á†ÅÊ∑ªÂä† do{...}while(0)Â¶ÇÊûúÂÆèÊõøÊç¢ÁöÑÊòØÊüê‰∏™‰ª£Á†ÅÂùóÔºåÊØîÂ¶Çüëá(‰∏çÁî®ËÄÉËôëÂÖ∑‰Ωì‰ª£Á†ÅÂùóË°®Ëææ‰ªÄ‰πàÊÑèÊÄù)Ôºö 123//A wrong version of NSLog#define NSLog(format, ...) ...(ËØ≠Âè•1); \ ...(ËØ≠Âè•2); ‰∏ÄËà¨‰ΩøÁî®‰ªªÁÑ∂‰∏ç‰ºöÂá∫ÈîôÔºåÊØîÂ¶Ç‰∏ãÈù¢ËøôÁßçÊÉÖÂÜµÂ∞±ËÉΩÊ≠£Á°ÆÊõøÊç¢Ôºö 123...NSLog(@"Oops, error happened");... ‰ΩÜÊòØËÄÉËôëÂ¶ÇÊûú‰ª£Á†ÅÂùóÊòØ if ‰∏≠ÂçïÊù°ËØ≠Âè•ÁöÑÁÆÄÂÜôÂΩ¢ÂºèÔºö 12if (errorHappend) NSLog(@"Oops, error happened"); Â±ïÂºÄÂêéÂèØ‰ª•Áü•ÈÅìËøôÊ†∑‰∏ÄÂÆöÁºñËØëÂá∫ÈîôÔºö 123if (errorHappend) ...(ËØ≠Âè•1); ...(ËØ≠Âè•2); ‰Ω†ÂèØ‰ª•Âú®ÂÆè‰∏≠‰∏∫‰ª£Á†ÅÂùóÂä†‰∏ä {}„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÂà§Êñ≠‰∏≠Êúâ else ËØ≠Âè•ÔºåÈÇ£‰πàÂç≥‰Ωø‰∏∫ÂÆèÂ•ó‰∏ä‰∫Ü {}Ôºå‰πü‰∏çËÉΩÈÄöËøáÁºñËØëÔºö 123456if (errorHappend) &#123; ...(ËØ≠Âè•1); ...(ËØ≠Âè•2);&#125;; else &#123; //Yep, no error, I am happy~ :)&#125; Âõ†Ê≠§ÔºåËß£ÂÜ≥ÊñπÂºèÊòØÂú®ÂÆö‰πâÂÆèÁöÑÊó∂ÂÄô‰∏∫‰ª£Á†ÅÂùóÂ•ó‰∏ä do{...}while(0)Ôºå‰ΩøÊï¥‰∏™‰ª£Á†ÅÂùóÂΩ¢Êàê‰∏Ä‰∏™Êï¥‰ΩìÔºåÁõ∏ÂΩì‰∫é‰∏ÄÊù°ËØ≠Âè•ÔºåÂπ∂‰∏î‰øùËØÅ‰∫Ü‰ª£Á†ÅÂùóÂè™‰ºöÊâßË°å‰∏ÄÊ¨°„ÄÇËøôÊ†∑Â∞±ÂèØ‰ª•Á¨¶Âêà if ÁöÑÁÆÄÂÜôÊñπÂºè‰∫ÜÔºö 12345678if (errorHappend) do &#123; ...(ËØ≠Âè•1); ...(ËØ≠Âè•2); &#125; while (0);else &#123; //Yep, no error, I am really happy~ :)&#125; ‰∏∫‰ª£Á†ÅÂùóÊ∑ªÂä† do{...}while(0) ÊòØÈÄöÁî®ÂÜôÊ≥ï Â≠óÁ¨¶‰∏≤ÂåñÂèØ‰ª•Âú®ÂÆèÂèÇÊï∞ÂâçÊ∑ªÂä† #ÔºåÂ∞ÜÂèÇÊï∞ËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤Ôºö 1234567#define WARN_IF(EXP) \do &#123; if (EXP) \ fprintf (stderr, "Warning: " #EXP "\n"); &#125; \while (0)WARN_IF (x == 0); ‚Üí do &#123; if (x == 0) fprintf (stderr, "Warning: " "x == 0" "\n"); &#125; while (0); Â≠óÁ¨¶‰∏≤Âåñ‰ºöÂ∞ÜÂèÇÊï∞‰∏≠ÁöÑÊâÄÊúâÂ≠óÁ¨¶(ÂåÖÊã¨ÂºïÂè∑)ÈÉΩÂ≠óÁ¨¶‰∏≤ÂåñÔºåÂ¶ÇÊûú‰∏≠Èó¥ÊúâÂæàÂ§öÁ©∫Ê†ºÔºåÂ≠óÁ¨¶‰∏≤ÂåñÂêéÂ∞ÜÂè™Êúâ‰∏Ä‰∏™Á©∫Ê†º„ÄÇ ÈÇ£Â¶ÇÊûúÊÉ≥ÈÄöËøá # Êù•ÂÆûÁé∞ÂèÇÊï∞ÂÄºÁöÑÂ≠óÁ¨¶‰∏≤ÂåñÔºåËÄå‰∏ç‰ªÖ‰ªÖÊòØÂ∞ÜÂèÇÊï∞ÂêçÂ≠óÁ¨¶‰∏≤ÂåñÂë¢ÔºüËøôÂ∞±ÈúÄË¶ÅÈúÄË¶Å‰ΩøÁî®‰∏§Â±ÇÁöÑÂÆèÔºö 123456789#define xstr(s) str(s)#define str(s) #s#define foo 4str (foo) ‚Üí "foo"xstr (foo) ‚Üí xstr (4) ‚Üí str (4) ‚Üí "4" Âú®‰ΩøÁî® str ÁöÑÊó∂ÂÄôÔºås ‰ºöÁ´ãÂç≥Ë¢´Â≠óÁ¨¶‰∏≤ÂåñÔºåËÄåÊ≤°ÊúâË¢´ÂÆèÂ±ïÂºÄ„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÊàë‰ª¨‰ΩøÁî®Âè¶Â§ñ‰∏Ä‰∏™ÂÆè xstr ÂµåÂ•óÁùÄÔºåÈÇ£Â∞±‰ºöÂÖàÂ±ïÂºÄÔºåÂ∞ÜÂÄºÂ∏¶ÂÖ•ÂêéÔºåÁÑ∂ÂêéÂÜçÂ≠óÁ¨¶‰∏≤Âåñ„ÄÇ ËøûÊé•ÂèØ‰ª•‰ΩøÁî® ## ËøûÊé•‰∏§‰∏™ tokenÔºö 123456789101112131415161718192021struct command&#123; char *name; void (*function) (void);&#125;;struct command commands[] =&#123; &#123; "quit", quit_command &#125;, &#123; "help", help_command &#125;, ‚Ä¶&#125;;#define COMMAND(NAME) &#123; #NAME, NAME ## _command &#125;struct command commands[] =&#123; COMMAND (quit), COMMAND (help), ‚Ä¶&#125;; È¢ÑÂ§ÑÁêÜÂô®‰ºöÂ∞ÜÊâÄÊúâÊ≥®ÈáäËΩ¨‰∏∫Á©∫Ê†ºÔºå## ‰ºöÂ∞ÜÂ∑¶Âè≥ÁöÑÁ©∫Ê†ºÈÉΩÂøΩÁï•„ÄÇ Â§öÂèÇÊï∞ÂÆèÂ¶ÇÊûú‰∏çÁ°ÆÂÆöÊúâÂ§öÂ∞ë‰∏™ÂÆèÂèÇÊï∞ÔºåÂèØ‰ª•‰ΩøÁî® ‚Ä¶ ‰ª£ÊõøÔºåËøôÂú®ÂæàÂ§öËØ≠Ë®Ä‰∏≠ÈÉΩÊúâÁ±ª‰ººÁöÑÂÅöÊ≥ï„ÄÇÁõ∏Â∫îÁöÑÔºå‰ΩøÁî® __VA_ARGS__ Âú®ÂÖ∑‰ΩìÁöÑÂÆè‰∏≠Ôºå‰ª£Êõø ...Ôºö 1234#define eprintf(‚Ä¶) fprintf (stderr, __VA_ARGS__)eprintf ("%s:%d: ", input_file, lineno) ‚Üí fprintf (stderr, "%s:%d: ", input_file, lineno) ‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåÂ¶ÇÊûúÂÆèÂèÇÊï∞Áº∫Â§±ÔºåÈÇ£‰πàÊõøÊç¢Âêé‰∏çÂ∞±Êàê fprintf (stderr,) ‰∫Ü‰πàÔºüÈúÄË¶ÅÁ®çÂæÆ‰øÆÊîπÔºö 1#define eprintf(‚Ä¶) fprintf (stderr, ##__VA_ARGS__) Âú®Âä†‰∏ä ## ‰πãÂêéÔºåÈ¢ÑÂ§ÑÁêÜÂô®Â∞±‰ºöÂú®‰º†ÂÖ•Á©∫ÁöÑÊó∂ÂÄôÔºåÂà†ÊéâÂâçÈù¢ÁöÑ , ‰∫Ü„ÄÇ Êù°‰ª∂ÁºñËØë#if/#elif/#elseÂ¶ÇÊûú IOS10 ÂÄº‰∏∫ÁúüÊó∂ÔºåËæìÂá∫ It is an iOS10 device!Ôºõ Ëã• IOS10 ÂÄº‰∏∫ÂÅá‰∏î IOS9 ÂÄº‰∏∫ÁúüÊó∂ÔºåËæìÂá∫It is an iOS9 device!ÔºõÂê¶ÂàôËæìÂá∫It is a device NOT runing iOS10 or iOS9! #if Âíå #endif ÈÖçÂØπÂá∫Áé∞Ôºå#endif Áî®‰∫éÁªàÊ≠¢ #if È¢ÑÂ§ÑÁêÜÊåá‰ª§ 1234567#if IOS10 NSLog(@"It is an iOS10 device!");#elif IOS9 NSLog(@"It is an iOS9 device!");#else NSLog(@"It is a device NOT runing iOS10 or iOS9!");#endif #ifdef#ifdef Á≠â‰ª∑‰∫é #if definedÔºåÂ¶ÇÊûúÂêéÈù¢Ë∑üÁöÑÂÆèË¢´ÂÆö‰πâËøáÔºåÂàôÊâßË°å‰∏ãÈù¢ÁöÑ‰ª£Á†Å„ÄÇ 123#ifdef RUN NSLog(@&quot;defined...&quot;);#endif #ifndefÂíå‰∏äÈù¢Áõ∏ÂèçÔºåÂ¶ÇÊûúÊ≤°ÊúâË¢´ÂÆö‰πâËøáÔºåÂàôÊâßË°å‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºö 123#ifndef RUN NSLog(@&quot;not defined...&quot;);#endif ÂÜÖËÅîÂáΩÊï∞Âú® iOS ÁöÑ‰∏Ä‰∫õÊ°ÜÊû∂‰∏≠Ôºåstatic incline ÊòØÁªèÂ∏∏Âá∫Áé∞ÁöÑÂÖ≥ÈîÆÂ≠óÁªÑÂêà„ÄÇÊØîÂ¶ÇÔºö 1234// Áõ¥Êé•ÂÜôÂú®Êñá‰ª∂ÂÜÖÔºå‰∏çË¶Å‰Ωú‰∏∫Á±ªÊñπÊ≥ïstatic inline CGFloat CGFloatFromPixel(CGFloat value) &#123; return value / YYScreenScale();&#125; ÂÜÖËÅîÂáΩÊï∞ÁöÑÊ†áÂøóÂ∞±ÊòØ incline„ÄÇÂÜÖËÅîÂáΩÊï∞Áõ¥Êé•ÂÜôÂú®Êñá‰ª∂ÂÜÖÔºå‰∏çË¶Å‰Ωú‰∏∫Á±ªÊñπÊ≥ïÔºå‰ΩøÁî®ÁöÑÊó∂ÂÄôÂØºÂÖ•Êñá‰ª∂ÔºåÁõ¥Êé•Ë∞ÉÁî®Âç≥ÂèØ„ÄÇ ÂÜÖËÅîÂáΩÊï∞Êúâ‰ªÄ‰πàÁî®Âë¢ÔºüÂÜÖËÅîÂáΩÊï∞Á±ª‰ºº‰∫éÂÆèÔºå‰ºöÊää‰ª£Á†ÅÁõ¥Êé•ÂµåÂÖ•Ë∞ÉÁî®‰ª£Á†Å‰∏≠ÔºåÂõ†Ê≠§Ê≤°ÊúâÊôÆÈÄöÂáΩÊï∞Ë∞ÉÁî®‰∫ßÁîüÁöÑÊÄßËÉΩÊçüËÄó„ÄÇÂ¶ÇÊûúËØ•ÂáΩÊï∞‰ºöË¢´ÁªèÂ∏∏Ë∞ÉÁî®ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÊèêÈ´òÊÄßËÉΩ„ÄÇÂÆÉ‰∏é #define ÂÆèÁöÑÂå∫Âà´Âú®‰∫éÔºö #define ÂÆö‰πâÁöÑÊ†ºÂºèË¶ÅÊúâË¶ÅÊ±ÇÔºåËÄå‰ΩøÁî®inlineÂàôÂ∞±Ë°åÂπ≥Â∏∏ÂÜôÂáΩÊï∞ÈÇ£Ê†∑ÔºåÂè™Ë¶ÅÂä†‰∏äinlineÂç≥ÂèØÔºÅ ‰ΩøÁî® #define ÂÆèÂÆö‰πâÁöÑ‰ª£Á†ÅÔºåÁºñËØëÂô®‰∏ç‰ºöÂØπÂÖ∂ËøõË°åÂèÇÊï∞ÊúâÊïàÊÄßÊ£ÄÊü•Ôºå‰ªÖ‰ªÖÂè™ÊòØÂØπÁ¨¶Âè∑Ë°®ËøõË°åÊõøÊç¢ #define ÂÆèÂÆö‰πâÁöÑ‰ª£Á†ÅÔºåÂÖ∂ËøîÂõûÂÄº‰∏çËÉΩË¢´Âº∫Âà∂ËΩ¨Êç¢ÊàêÂèØËΩ¨Êç¢ÁöÑÈÄÇÂêàÁöÑËΩ¨Êç¢Á±ªÂûã Âú®inlineÂä†‰∏ästatic‰øÆÈ•∞Á¨¶ÔºåÂè™ÊòØ‰∏∫‰∫ÜË°®ÊòéËØ•ÂáΩÊï∞Âè™Âú®ËØ•Êñá‰ª∂‰∏≠ÂèØËßÅÔºÅ‰πüÂ∞±ÊòØËØ¥ÔºåÂú®Âêå‰∏Ä‰∏™Â∑•Á®ã‰∏≠ÔºåÂ∞±ÁÆóÂú®ÂÖ∂‰ªñÊñá‰ª∂‰∏≠‰πüÂá∫Áé∞ÂêåÂêç„ÄÅÂêåÂèÇÊï∞ÁöÑÂáΩÊï∞‰πü‰∏ç‰ºöÂºïËµ∑ÂáΩÊï∞ÈáçÂ§çÂÆö‰πâÁöÑÈîôËØØÔºÅ ÂèÇËÄÉÊñáÁ´†ÂÆòÊñπÊñáÊ°£ iOSÂºÄÂèëÈ´òÁ∫ßÔºö‰ΩøÁî®ÂÆèÂÆö‰πâmacros ÂÆèÂÆö‰πâÁöÑÈªëÈ≠îÊ≥ï - ÂÆèËèúÈ∏üËµ∑È£ûÊâãÂÜå]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Xcode other link flags ÂàÜÊûê]]></title>
    <url>%2F2017%2F06%2F19%2FiOS%E9%93%BE%E6%8E%A5%20%2F</url>
    <content type="text"><![CDATA[ÂØºÂÖ•Á¨¨‰∏âÊñπÂ∫ìÁöÑÊó∂ÂÄôÔºåÁªèÂ∏∏‰ºöÁúãÂà∞Ë¶ÅËÆæÁΩÆ ‚Äúother link flags‚Äù„ÄÇÈÇ£‰πàËøôÂà∞Â∫ïÊòØÊúâ‰ªÄ‰πàÁî®Ôºü Âü∫Á°ÄÁºñËØëËøûÊé•‰ªéC‰ª£Á†ÅÂà∞ÂèØÊâßË°åÊñá‰ª∂ÁªèÂéÜÁöÑÊ≠•È™§ÊòØÔºö1Ê∫ê‰ª£Á†Å &gt; È¢ÑÂ§ÑÁêÜÂô® &gt; ÁºñËØëÂô® &gt; Ê±áÁºñÂô® &gt; Êú∫Âô®Á†Å &gt; ÈìæÊé•Âô® &gt; ÂèØÊâßË°åÊñá‰ª∂ ÁªèËøáÁºñËØëÊ±áÁºñ‰πãÂêéËæìÂá∫ÁöÑÊñá‰ª∂ÊòØ.oÊñá‰ª∂ÔºåÁÑ∂ÂêéÂØπËøô‰∫õ.oÊñá‰ª∂ËøõË°åÈìæÊé•ÔºåÂ∞±ÊòØÊúÄÁªàÁöÑÂèØÊâßË°åÊñá‰ª∂„ÄÇÈùôÊÄÅÈìæÊé•Â∫ì‰∏ÄËà¨ÊòØ‰∏Ä‰∏™.a ÂéãÁº©Êñá‰ª∂ÔºåËß£ÂéãÂêéÂèØ‰ª•ÂæóÂà∞‰ºóÂ§öÁöÑ.oÊñá‰ª∂ÔºåÈùôÊÄÅÂ∫ì‰πü‰ºöÂú®ÈìæÊé•ËøáÁ®ã‰∏≠ËøûÊé•Âà∞‰Ω†ÁöÑÂèØÊâßË°åÊñá‰ª∂‰∏≠Âéª„ÄÇ Á¨¶Âè∑Êàë‰ª¨Âú®Ê∫êÁ†Å‰∏≠ÂÜôÁöÑÂÖ®Â±ÄÂèòÈáèÂêç„ÄÅÂáΩÊï∞Âêç„ÄÅÁ±ªÂêçÂú®ÁîüÊàêÁöÑ .o Êñá‰ª∂‰∏≠ÈÉΩÂèØ‰ª•Âè´ÂÅöÁ¨¶Âè∑ÔºåÂ≠òÂú®‰∏Ä‰∏™Á¨¶Âè∑Ë°®‰∏≠„ÄÇ OC ÈìæÊé•ÁâπÊÄß The ‚Äúselector not recognized‚Äù runtime exception occurs due to an issue between the implementation of standard UNIX static libraries, the linker and the dynamic nature of Objective-C. Objective-C does not define linker symbols for each function (or method, in Objective-C) - instead, linker symbols are only generated for each class. If you extend a pre-existing class with categories, the linker does not know to associate the object code of the core class implementation and the category implementation. This prevents objects created in the resulting application from responding to a selector that is defined in the category. Object-CÁöÑÈìæÊé•Âô®Âπ∂‰∏ç‰ºö‰∏∫ÊØè‰∏™ÊñπÊ≥ïÂª∫Á´ãÁ¨¶Âè∑Ë°®ÔºåËÄåÊòØ‰∏∫ÊØè‰∏™Á±ªÂª∫Á´ãÈìæÊé•Á¨¶Âè∑„ÄÇËøôÊ†∑ÁöÑËØùÈùôÊÄÅÂ∫ì‰∏≠ÂÆö‰πâ‰∫ÜÂ∑≤Â≠òÂú®ÁöÑÁ±ªÁöÑÂàÜÁ±ªÔºåÈìæÊé•Âô®Â∞±‰ª•‰∏∫Ëøô‰∏™Á±ªÂ≠òÂú®‰∫ÜÔºå‰∏ç‰ºöÂ∞ÜÂàÜÁ±ªÂíåÊ†∏ÂøÉÁ±ª‰ª£Á†ÅÂÖ≥ËÅîÔºàÂêàÂπ∂ÔºâËµ∑Êù•ÔºåËøôÊ†∑Âú®ÊúÄÂêéÂèØÊâßË°åÊñá‰ª∂‰∏≠ÔºåÂ∞±‰ºöÊâæ‰∏çÂà∞ÂàÜÁ±ªÈáåÊâÄÂÆö‰πâÁöÑÊñπÊ≥ï„ÄÇ ‰∏â‰∏™ÂèÇÊï∞-ObjC This flag causes the linker to load every object file in the library that defines an Objective-C class or category. While this option will typically result in a larger executable (due to additional object code loaded into the application), it will allow the successful creation of effective Objective-C static libraries that contain categories on existing classes. Âä†ÂÖ•Ëøô‰∏™ÂèÇÊï∞ÂêéÔºåÈìæÊé•Âô®‰ºöÂ∞ÜÈùôÊÄÅÂ∫ì‰∏≠ÁöÑÊØè‰∏™Á±ªÂíåÂàÜÁ±ªÊåâÈúÄÂä†ËΩΩÂà∞ÊúÄÂêéÁöÑÂèØÊâßË°åÊñá‰ª∂ÔºåÂΩìÁÑ∂ÔºåËøô‰∏™ÂèÇÊï∞‰ºöÂØºËá¥ÂèØÊâßË°åÊñá‰ª∂ÊØîËæÉÂ§ßÔºåÂéüÂõ†ÊòØÂä†ËΩΩ‰∫ÜÊõ¥Â§öÁöÑÈ¢ùÂ§ñÂØπË±°ÁöÑ‰ª£Á†ÅÂà∞ÂèØÊâßË°åÊñá‰ª∂ÂΩì‰∏≠ÂéªÔºå‰ΩÜÊòØËøô‰ºöËß£ÂÜ≥ Objec-C ‰∏≠ÈùôÊÄÅÂ∫ì‰∏≠Â∑≤Â≠òÂú®ÁöÑÁ±ªÂåÖÂê´ÁöÑÂàÜÁ±ªÈóÆÈ¢ò„ÄÇ Important: For 64-bit and iPhone OS applications, there is a linker bug that prevents -ObjC from loading objects files from static libraries that contain only categories and no classes. The workaround is to use the -allload or -forceload flags. ËøôÈáåËøòÊèêÂà∞ÔºåÈìæÊé•Âô®Êúâ‰∏Ä‰∏™bugÔºåÂ∞±ÊòØÂΩìÈùôÊÄÅÂ∫ì‰∏≠Âè™Êúâ category Ê≤°Êúâ class ÁöÑÊó∂ÂÄôÔºåÂøÖÈ°ª‰ΩøÁî® -all_load ÊàñËÄÖ -force_load ‰ª£Êõø„ÄÇ -all_load:ËØ•ÂèÇÊï∞ÊääÊâÄÊâæÂà∞ÁöÑÁõÆÊ†áÊñá‰ª∂ÈÉΩÂä†ËΩΩÂà∞ÂèØÊâßË°åÊñá‰ª∂ÂΩì‰∏≠ÂéªÔºà-ObjC ÊòØÊåâÈúÄÂä†ËΩΩÔºâÔºå‰ΩÜÊòØËøôÂ∞±Â≠òÂú®‰∏Ä‰∏™ÈóÆÈ¢ò‰∫ÜÔºåÂ¶ÇÊûú‰∏§‰∏™ÈùôÊÄÅÂ∫ì‰∏≠ÔºåÈÉΩ‰ΩøÁî®‰∫ÜÂêå‰∏Ä‰ªΩÂèØÊâßË°åÊñá‰ª∂ÔºàËøôÊòØ‰∏Ä‰∏™ÂæàÂ∏∏ËßÅÁöÑÈóÆÈ¢òÔºå‰æãÂ¶ÇÂ§ßÂÆ∂ÁöÑÁõÆÊ†áÊñá‰ª∂ÈÉΩ‰ΩøÁî®‰∫ÜÁî®‰ª•ÂêçÂ≠ó base64.oÔºâÂ∞±‰ºöÂèëÁîü ld: duplicate symbol Á¨¶Âè∑ÂÜ≤Á™ÅÈóÆÈ¢òÔºåÊâÄ‰ª•‰∏çÂ§™Âª∫ËÆÆ‰ΩøÁî®„ÄÇ -force_loadÔºöËØ•ÂèÇÊï∞ÁöÑ‰ΩúÁî®Ë∑ü -all_loadÂÖ∂ÂÆûÊòØ‰∏ÄÊ†∑ÁöÑÔºå‰ΩÜÊòØ -force_load ÈúÄË¶ÅÊåáÂÆöË¶ÅËøõË°åÂÖ®ÈÉ®Âä†ËΩΩÁöÑÂ∫ìÊñá‰ª∂ÁöÑË∑ØÂæÑÔºåËøôÊ†∑ÁöÑËØùÔºåÂè™Ë¶ÅÂÆåÂÖ®Âä†ËΩΩ‰∏Ä‰∏™Â∫ìÊñá‰ª∂Ôºå‰∏çÂΩ±ÂìçÂÖ∂‰ΩôÂ∫ìÊñá‰ª∂ÁöÑÊåâÈúÄÂä†ËΩΩ„ÄÇ ÂéüÁêÜÂú®ÂØπÈùôÊÄÅÂ∫ìËøõË°åÈìæÊé•ÁöÑÊó∂ÂÄôÔºåÈìæÊé•Âô®‰ºöËé∑ÂèñÈùôÊÄÅÂ∫ìÁöÑÁ¨¶Âè∑Ë°®„ÄÇÂè™ÊúâË¢´‰ΩøÁî®‰∫ÜÁöÑÁ±ªÊâçËÉΩÊâç‰ºöË¢´ÈìæÊé•Âà∞ÂèØÊâßË°åÊñá‰ª∂‰∏≠Âéª„ÄÇÊØîÂ¶Ç‰Ω†Êúâ50‰∏™Á±ªÊñá‰ª∂Ôºå‰ΩÜÊòØÂè™Êúâ20‰∏™ÊòØ‰ΩøÁî®Âà∞ÁöÑÔºåÈÇ£‰πàÂè™ÊúâËøô20‰∏™‰ºöË¢´ÈìæÊé•ÔºåÂÖ∂ÂÆÉ30‰∏™Ë¢´ÂøΩÁï•„ÄÇ ËøôÁßçÊñπÂºèÂØπ‰∫éCÊàñËÄÖC++ÊòØÈùûÂ∏∏ÊúâÊïàÁöÑÔºåÂõ†‰∏∫Ëøô‰∫õÈùôÊÄÅËØ≠Ë®Ä‰ºöÂú®ÁºñËØëÁöÑÊó∂ÂÄôÂ∞±Â∑≤ÁªèÊääËØ•ÂÅöÁöÑÂ∑•‰ΩúÈÉΩÂÅöÂÆå‰∫Ü„ÄÇ‰ΩÜÊòØ OC ÊòØ‰∏ÄÈó®Âä®ÊÄÅËØ≠Ë®ÄÔºåÂæàÂ§ö OC ÁöÑÁâπÊÄßË¶ÅÂú®ËøêË°åÊó∂ÂÜ≥ÂÆö„ÄÇÂõ†Ê≠§ÔºåÈìæÊé•Âô®‰∏çËÉΩÂæóÁü•ÂÖ∂ÊòØÂê¶ÊòØË¢´‰ΩøÁî®Âà∞ÁöÑ„ÄÇcategory Â∞±ÊòØ‰∏Ä‰∏™ËøêË°åÊó∂ÁâπÊÄßÔºåcategory ‰∏çÊòØÂÉè class ÈÇ£Ê†∑ÁöÑÁ¨¶Âè∑ÔºåÊâÄ‰ª•ÈìæÊé•Âô®‰∏ç‰ºöÁõ¥Êé•Êää category ÈìæÊé•Âà∞ÂèØÊâßË°åÊñá‰ª∂‰∏≠Âéª„ÄÇÈÄöËøá -ObjC ÂèØ‰ª•ÂëäÁü•ÈìæÊé•Âô®ÔºåÂú®ÊåâÈúÄÂä†ËΩΩÁöÑÂâçÊèê‰∏ãÔºåÂ∞Ü category ‰πüÈìæÊé•ËøõÂèØÊâßË°åÊñá‰ª∂„ÄÇ Xcode other link flags ËØ¶Ëß£ [Objective-C categories in static library] ‰∏≠ Vladimir Âíå Mecki ÁöÑÂõûÁ≠î]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Xcode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS ÁªòÂõæ]]></title>
    <url>%2F2017%2F06%2F10%2FiOS%E7%BB%98%E7%94%BB%2F</url>
    <content type="text"><![CDATA[Êúâ‰∫õÊó∂ÂÄôÈúÄÊ±Ç‰∏äÁöÑÂä®ÁîªÊïàÊûú‰∏çËÉΩ‰ªÖÈÄöËøáË¥¥ÂõæÊù•Ëß£ÂÜ≥ÔºåËøôÂ∞±ÈúÄË¶ÅÊàë‰ª¨Ëá™ÂÆö‰πâÂêÑÁßçÂõæÊ°àÔºåÁÑ∂ÂêéÂä®ÊÄÅÁöÑÁªòÂà∂ÂÆåÊàêÂä®ÊÄÅÊïàÊûú„ÄÇÊØîËæÉÂ§çÊùÇÔºå‰ΩÜÊòØÂÆûÁé∞Âá∫Êù•ÁöÑ‰∏úË•øÈùûÂ∏∏Á≤æËá¥„ÄÇ drawRect Ëé∑ÂèñÂΩìÂâçÂõæÂΩ¢‰∏ä‰∏ãÊñáÁªòÂõæÁªòÂà∂Áü©ÂΩ¢123456789101112- (void)drawRect:(CGRect)rect&#123; UIColor *color = [UIColor colorWithRed:0 green:0 blue:0.7 alpha:1]; [color set]; //ËÆæÁΩÆÁ∫øÊù°È¢úËâ≤ UIBezierPath* aPath = [UIBezierPath bezierPathWithRect:CGRectMake(20, 20, 100, 50)]; aPath.lineWidth = 8.0; aPath.lineCapStyle = kCGLineCapRound; //Á∫øÊù°ÊãêËßí aPath.lineJoinStyle = kCGLineCapRound; //ÁªàÁÇπÂ§ÑÁêÜ [aPath stroke];&#125; ÂúÜÂíåÊ§≠ÂúÜÊõøÊç¢‰∏äÈù¢ÁöÑ‰ª£Á†Å‰∏∫Ôºö 1234// ÂúÜUIBezierPath* aPath = [UIBezierPath bezierPathWithOvalInRect:CGRectMake(20, 20, 100, 100)];// Ê§≠ÂúÜUIBezierPath* aPath = [UIBezierPath bezierPathWithOvalInRect:CGRectMake(20, 20, 100, 50)]; ÈÉΩÊòØÈúÄË¶Å‰∏Ä‰∏™Â§ñÊé•Áü©ÂΩ¢ÔºåÊ§≠ÂúÜÂíåÂúÜ‰∏çÂêå‰πãÂ§ÑÂú®‰∫éÂúÜÁöÑÂ§ñÊé•Áü©ÂΩ¢ÊòØ‰∏™Ê≠£ÊñπÂΩ¢„ÄÇ Â§öËæπÂΩ¢Â§öËæπÂΩ¢ÊòØ‰∏Ä‰∫õÁÆÄÂçïÁöÑÂΩ¢Áä∂,Ëøô‰∫õÂΩ¢Áä∂ÊòØÁî±‰∏Ä‰∫õÁõ¥Á∫øÁ∫øÊù°ÁªÑÊàêÔºåÊàë‰ª¨ÂèØ‰ª•Áî® moveToPoint: Âíå addLineToPoint: ÊñπÊ≥ïÂéªÊûÑÂª∫„ÄÇmoveToPoint: ËÆæÁΩÆÊàë‰ª¨ÊÉ≥Ë¶ÅÂàõÂª∫ÂΩ¢Áä∂ÁöÑËµ∑ÁÇπ„ÄÇ‰ªéËøôÁÇπÂºÄÂßãÔºåÊàë‰ª¨ÂèØ‰ª•Áî®ÊñπÊ≥ï addLineToPoint: ÂéªÂàõÂª∫‰∏Ä‰∏™ÂΩ¢Áä∂ÁöÑÁ∫øÊÆµ„ÄÇÊàë‰ª¨ÂèØ‰ª•ËøûÁª≠ÁöÑÂàõÂª∫ lineÔºåÊØè‰∏Ä‰∏™ line ÁöÑËµ∑ÁÇπÈÉΩÊòØÂÖàÂâçÁöÑÁªàÁÇπÔºåÁªàÁÇπÂ∞±ÊòØÊåáÂÆöÁöÑÁÇπ„ÄÇclosePath ÂèØ‰ª•Âú®ÊúÄÂêé‰∏Ä‰∏™ÁÇπÂíåÁ¨¨‰∏Ä‰∏™ÁÇπ‰πãÈó¥Áîª‰∏ÄÊù°Á∫øÊÆµ„ÄÇ 1234567891011121314151617181920212223242526- (void)drawRect:(CGRect)rect&#123; UIColor *color = [UIColor colorWithRed:0 green:0.7 blue:0 alpha:1]; [color set]; UIBezierPath* aPath = [UIBezierPath bezierPath]; aPath.lineWidth = 5.0; aPath.lineCapStyle = kCGLineCapRound; aPath.lineJoinStyle = kCGLineCapRound; // Ëµ∑ÁÇπ [aPath moveToPoint:CGPointMake(100.0, 0.0)]; // ÁªòÂà∂Á∫øÊù° [aPath addLineToPoint:CGPointMake(200.0, 40.0)]; [aPath addLineToPoint:CGPointMake(160, 140)]; [aPath addLineToPoint:CGPointMake(40.0, 140)]; [aPath addLineToPoint:CGPointMake(0.0, 40.0)]; [aPath closePath];//Á¨¨‰∫îÊù°Á∫øÈÄöËøáË∞ÉÁî®closePathÊñπÊ≥ïÂæóÂà∞ÁöÑ //Ê†πÊçÆÂùêÊ†áÁÇπËøûÁ∫ø [aPath stroke]; // Â∞ÜÂõæÂΩ¢Â°´ÂÖÖÊª° [aPath fill];&#125; closePath ÂèØ‰ª•Â∞ÜË∑ØÂæÑÂ∞ÅÈó≠ ‰∏çËßÑÂàôÂΩ¢Áä∂Ë¶ÅÁî®ÂºßÁ∫øÁªÑÊàê‰∏çËßÑÂàôÁöÑÂΩ¢Áä∂ÔºåÊàë‰ª¨ÈúÄË¶ÅÁî®Âà∞‰∏≠ÂøÉÁÇπ„ÄÅÂºßÂ∫¶ÂíåÂçäÂæÑ„ÄÇÂºßÂ∫¶‰ª•È°∫Êó∂Èíà‰∏∫ÂáÜÔºå0¬∞ ÊåáÂêëÂè≥Ëæπ„ÄÇ ÁªòÂà∂‰∏ÄÊÆµÂºßÂ∫¶1234567891011121314151617- (void)drawRect:(CGRect)rect&#123; UIColor *color = [UIColor redColor]; [color set]; //ËÆæÁΩÆÁ∫øÊù°È¢úËâ≤ UIBezierPath* aPath = [UIBezierPath bezierPathWithArcCenter:CGPointMake(80, 80) radius:75 startAngle:0 endAngle:DEGREES_TO_RADIANS(135) clockwise:YES]; aPath.lineWidth = 5.0; aPath.lineCapStyle = kCGLineCapRound; //Á∫øÊù°ÊãêËßí aPath.lineJoinStyle = kCGLineCapRound; //ÁªàÁÇπÂ§ÑÁêÜ [aPath stroke];&#125; Ë¥ùÂ°ûÂ∞îÊõ≤Á∫øË¥ùÂ°ûÂ∞îÊõ≤Á∫øÈúÄË¶Å‰∏Ä‰∏™Ëµ∑ÂßãÁÇπÔºåÁªàÁÇπÂíåÊéßÂà∂ÁÇπ 1234567891011121314151617- (void)drawRect:(CGRect)rect&#123; UIColor *color = [UIColor redColor]; [color set]; //ËÆæÁΩÆÁ∫øÊù°È¢úËâ≤ UIBezierPath* aPath = [UIBezierPath bezierPath]; aPath.lineWidth = 5.0; aPath.lineCapStyle = kCGLineCapRound; //Á∫øÊù°ÊãêËßí aPath.lineJoinStyle = kCGLineCapRound; //ÁªàÁÇπÂ§ÑÁêÜ // Ëµ∑ÂßãÁÇπ [aPath moveToPoint:CGPointMake(20, 100)]; // ÁªàÁÇπ Âíå ÊéßÂà∂ÁÇπ [aPath addQuadCurveToPoint:CGPointMake(120, 100) controlPoint:CGPointMake(70, 0)]; [aPath stroke];&#125; Ë¥ùÂ°ûÂ∞îÊõ≤Á∫øÂèØ‰ª•ÊúâÂ§ö‰∏™ÊéßÂà∂ÁÇπÔºåÂèØ‰ª•ÂÆûÁé∞Á±ª‰ººÊ≥¢Êµ™ÁöÑÊïàÊûúÔºö 1234567891011121314151617- (void)drawRect:(CGRect)rect&#123; UIColor *color = [UIColor redColor]; [color set]; //ËÆæÁΩÆÁ∫øÊù°È¢úËâ≤ UIBezierPath* aPath = [UIBezierPath bezierPath]; aPath.lineWidth = 5.0; aPath.lineCapStyle = kCGLineCapRound; //Á∫øÊù°ÊãêËßí aPath.lineJoinStyle = kCGLineCapRound; //ÁªàÁÇπÂ§ÑÁêÜ [aPath moveToPoint:CGPointMake(5, 80)]; [aPath addCurveToPoint:CGPointMake(155, 80) controlPoint1:CGPointMake(80, 0) controlPoint2:CGPointMake(110, 100)]; [aPath stroke];&#125; Ê†πÊçÆÊâãÂäøÁªòÂõæÊñπÊ≥ïÊòØÊ†πÊçÆÊâãÂäøÁßªÂä®ÁîüÊàêÁõ∏Â∫îÁöÑË¥ùÂ°ûÂ∞îÊõ≤Á∫øÔºåÁÑ∂ÂêéËÆæÁΩÆÈáçÁªò„ÄÇÂú® drawRect ‰∏≠ÊääËøô‰∫õÊõ≤Á∫øÁªòÂà∂Âá∫Êù•Ôºö stroke ÊñπÊ≥ïÁöÑËß£Èáä‰∏äÊñá‰∏≠ÈÉΩÊòØÂú® drawRect ÊñπÊ≥ï‰∏≠ÈÄöËøá UIBezierPath ÁªòÂà∂ÁöÑ„ÄÇstroke ÂÆûË¥®‰∏äÂ∏ÆÊàë‰ª¨ÁúÅÁï•‰∫ÜÂ•ΩÂá†‰∏™Ê≠•È™§ÔºåÂåÖÊã¨Ôºö Ëé∑ÂèñÂΩìÂâç‰∏ä‰∏ãÊñáÔºöCGContextRef ctx = UIGraphicsGetCurrentContext() ÊääË¥ùÂ°ûÂ∞îÊõ≤Á∫øÊ∑ªÂä†Âà∞‰∏ä‰∏ãÊñá‰∏≠ÔºöCGContextAddPath(ctx, aPath.CGPath) ÁªòÂà∂ÂõæÂΩ¢ÔºöCGContextStrokePath(ctx) ‰πüÂ∞±ÊòØËØ¥Âú® drawRect ‰∏≠ÈÉΩÊòØÈúÄË¶ÅÂºÄÂêØ‰∏ä‰∏ãÊñáÁöÑ„ÄÇÂè™‰∏çËøáÈÄöËøá stroke ÊñπÂºèÂ∞±ÁúÅÁï•‰∫Ü„ÄÇ drawRect ÁöÑÈóÆÈ¢òdrawRect ‰ºöÁîüÊàê‰∏Ä‰∏™ÂõæÂΩ¢‰∏ä‰∏ãÊñáÔºåËøô‰∏™Á©∫Èó¥‰∏∫ ÂõæÂ±ÇÂÆΩ*ÂõæÂ±ÇÈ´ò*4 Â≠óËäÇÔºå‰ºöÂºïËµ∑ÂÜÖÂ≠òÁöÑÊö¥Â¢û„ÄÇÊâÄ‰ª•Ôºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºå‰∏çË¶Å‰ΩøÁî® drawRect ÊñπÊ≥ï„ÄÇ CAShapeLayerÊòØ‰∏Ä‰∏™ÈÄöËøáÁü¢ÈáèÂõæÂΩ¢ËÄå‰∏çÊòØbitmapÊù•ÁªòÂà∂ÁöÑÂõæÂ±ÇÂ≠êÁ±ª„ÄÇÁî®CGPathÊù•ÂÆö‰πâÊÉ≥Ë¶ÅÁªòÂà∂ÁöÑÂõæÂΩ¢ÔºåÂÆÉÁöÑ‰ºòÁÇπÊúâ: 1. Ê∏≤ÊüìÂø´ÔºåÊúâ GPU Á°¨‰ª∂Âä†ÈÄü 2. ‰∏ç‰ºöÂç†Áî®Á≥ªÁªüÂÜÖÂ≠ò 3. ‰∏ç‰ºöË¢´ÂõæÂ±ÇËæπÁïåË£ÅÂáèÊéâ 4. ‰∏ç‰ºöÊúâÂÉèÁ¥†Âåñ Êé®Ëçê‰ΩøÁî® CAShapeLayerÔºå‰ΩøÁî®ÊñπÂºèÂ∑Æ‰∏çÂ§öÔºådrawRect ÊòØÊää path add Âà∞ context ‰∏äÔºåCAShapeLayer ÊòØÊää path ËµãÁªô layer.path ÂàõÂª∫Êñ∞ÁöÑÂõæÂΩ¢‰∏ä‰∏ãÊñáÁªòÂõæ‰∏äÈù¢ drawRect ‰ΩøÁî®ÁöÑÊòØÂΩìÂâçÂõæÂΩ¢‰∏ä‰∏ãÊñáUIGraphicsGetCurrentContext() ÁªòÂà∂ÁöÑ„ÄÇ‰∫ãÂÆû‰∏äÔºåÂèØ‰ª•Âú®‰ªª‰ΩïÊó∂ÂÄôÔºåÂàõÂª∫Êñ∞ÁöÑÂõæÂΩ¢‰∏ä‰∏ãÊñáÊñ∞Âª∫ UIImage Âú®ÂõæÁâá‰∏äÂÜôÂ≠óÁîüÊàêÊñ∞ÁöÑÂõæÁâáÁîüÊàê‰∏Ä‰∏™‰ΩçÂõæ‰∏ä‰∏ãÊñáÔºåÁÑ∂ÂêéÊääÂõæÁâáÂíåÊñáÂ≠óÁîª‰∏äÂéªÔºåÂÜçËé∑Âèñ‰ΩçÂõæÔºö Ë£ÅÂâ™ÂõæÁâáÔºàËøô‰∏™ÊñπÊ≥ïÂèØ‰ª•Áî®Êù•ÁªòÂà∂ÂúÜËßíÂõæÁâáÔºâÂÖàËÆæÁΩÆË£ÅÂâ™ÁöÑËåÉÂõ¥‰∏∫‰∏Ä‰∏™Ë¥ùÂ°ûÂ∞îÊõ≤Á∫øÔºåÁÑ∂ÂêéÊääÂõæÁâáÁîªÂà∞Ë¥ùÂ°ûÂ∞îÊõ≤Á∫ø‰∏≠Ôºö ÁîüÊàê‰∏ÄÂº†Â∏¶ËæπÊ°ÜÁöÑÂúÜËßíÂõæÁâáËøôÂú®‰∏äÈù¢ÁöÑÂü∫Á°Ä‰∏äÊ∑ªÂä†ËæπÊ°ÜÔºå‰πüÂ∞±ÊòØÊîπÂèòÁªòÂõæÁöÑ‰ΩçÁΩÆÔºö Êà™ÂõæÂºÄÂêØ‰∏Ä‰∏™‰∏ä‰∏ãÊñáÔºåÁÑ∂ÂêéÊääËßÜÂõæÈÄöËøá renderInContext: ÁªòÂà∂Âà∞‰∏ä‰∏ãÊñá‰∏ä„ÄÇËøôÁßçÊñπÂºèËé∑ÂèñÁöÑÊòØ UIImage ÂØπË±°Ôºö ÂΩìÁÑ∂ËøòÊúâ‰∏ÄÁßçÊÉÖÂÜµÔºåÁõ¥Êé•ÈÄöËøáÁ≥ªÁªü api Ëé∑ÂèñÔºåËØ•ÊñπÊ≥ïÁîüÊàê‰∏Ä‰∏™ UIViewÔºö 1234- (UIView *)snapshotView &#123; UIView *snapView = [self snapshotViewAfterScreenUpdates:YES]; return snapView;&#125; CAShapeLayer ÁöÑ‰ΩøÁî®Âè™Ë¶ÅÊääË¥ùÂ°ûÂ∞îÊõ≤Á∫øÁöÑ CGPath ËµãÂÄºÁªô CAShapeLayer ÁöÑ path Â∞±ÂèØ‰ª•‰∫ÜÔºå‰∏çÈúÄË¶ÅË∞ÉÁî®‰ªª‰ΩïÈáçÁªòÊñπÊ≥ï„ÄÇÂÆÉÁöÑÂü∫Êú¨Â±ûÊÄßÊúâÔºö pathÔºöÁªòÂà∂Ë∑ØÂæÑ fillColorÔºöÂ°´ÂÖÖÈ¢úËâ≤ fillRuleÔºöÂ°´ÂÖÖËßÑÂàôÔºåÂ∞±ÊòØÂ¶ÇÊûúÂõæÂΩ¢ÈáåÈù¢‰πüÊúâÁ∫øÊù°ÔºåÈÇ£‰πàÊòØÂê¶‰∏≠Èó¥‰πüË¶ÅÂ°´ÂÖÖ strokeColorÔºöÊèèËæπÁöÑÈ¢úËâ≤ strokeStartÔºöÊèèËæπÁöÑÂºÄÂßãÁÇπÔºåÈªòËÆ§‰∏∫0ÊúÄÂ§ß‰∏∫1 strokeEndÔºöÊèèËæπÁöÑÁªìÊùüÁÇπÔºåÈªòËÆ§‰∏∫1 (ÈÖçÂêàÊ†∏ÂøÉÂä®ÁîªÂèØ‰ª•ÂÆûÁé∞ÈÇ£ÁßçÊÖ¢ÊÖ¢ÂèòÂåñÁöÑÊïàÊûú) lineWidthÔºöÁ∫øÂÆΩ lineCapÔºöÁ∫øÁöÑÁ´ØÁÇπÁöÑÊ†∑Âºè lineJoinÔºöÁ∫ø‰∫§ÁïåÂ§ÑÊ†∑Âºè ‰ΩøÁî® CAShapeLayer ËÆæÁΩÆÂúÜËßíÂ∞Ü CAShapeLayer ‰Ωú‰∏∫ÂõæÁâáÁöÑ layer ÁöÑmaskÔºö1234let roundedRectPath = UIBezierPath(roundedRect: avatorView.bounds, byRoundingCorners: .AllCorners, cornerRadii: CGSize(width: 10, height: 10))let shapeLayer = CAShapeLayer()shapeLayer.path = roundedRectPath.CGPathavatorView.layer.mask = shapeLayer ËøôÁßçÈÄöËøá mask ÁöÑÊñπÂºè‰∏ç‰ºöÊ∂àÈô§Á¶ªÂ±èÊ∏≤ÊüìÔºåÂè™ÊòØËøôÁßçÊñπÂºèÊØî cornerRadius ÊÄßËÉΩÂ•Ω‰∏Ä‰∫õ„ÄÇ ËøõÂ∫¶Êù°‰∏çÊñ≠ÁöÑÁªô layer Ëµã‰∏çÊñ≠ËæπÈïøÁöÑË¥ùÂ°ûÂ∞îÊõ≤Á∫ø 12345678910111213141516171819202122232425- (void)viewDidLoad &#123; // ÂàõÂª∫‰∏Ä‰∏™ layer CAShapeLayer *layer = [CAShapeLayer layer]; layer.bounds = CGRectMake(0, 0, 200, 45); layer.position = self.view.center; layer.path = [UIBezierPath bezierPathWithRect:CGRectMake(0, 0, count / 6 * 2, 45)].CGPath; layer.fillColor = [UIColor redColor].CGColor; layer.fillRule = kCAFillRuleEvenOdd; self.redLayer = layer; // Ê∑ªÂä† layer Âà∞ÂõæÂ±Ç‰∏ä [self.view.layer addSublayer:self.redLayer]; // Ê∑ªÂä†‰∏Ä‰∏™ÂÆöÊó∂Âô® self.displayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(action)]; [self.displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];&#125;// ÂÆöÊó∂Âô®ÊñπÊ≥ï- (void)action &#123; count ++; self.redLayer.path = [UIBezierPath bezierPathWithRect:CGRectMake(0, 0, count / 6 * 2, 45)].CGPath; if (count &gt; 60 * 10 -1) &#123; [self.displayLink invalidate]; &#125;&#125; ÂõæÂ±ÇÁöÑ bounds ÁöÑ xÔºåy ‰∏çËÉΩÁûéÊîπÔºåÂê¶Âàô path ‰ºöË∑üÁùÄ xÔºåy ÂèòÂåñ View Ê∂àÈô§Èò¥ÂΩ±ÁöÑÁ¶ªÂ±èÊ∏≤ÊüìÂáÜÁ°ÆÁöÑËØ¥ÔºåËøô‰∏çÂ±û‰∫é CAShapeLayer„ÄÇ Â¶ÇÊûúÁõ¥Êé•ÂØπ‰∏Ä‰∏™ View Âä†‰∏Ä‰∏™ shadowÔºåÈÇ£‰πà‰ºö‰∫ßÁîüÁ¶ªÂ±èÊ∏≤Êüì„ÄÇÊàë‰ª¨ÂèØ‰ª•ÊåáÂÆö shaowPathÔºåÈÅøÂÖçÁ¶ªÂ±èÊ∏≤ÊüìÔºö 12345678let imageViewLayer = avatorView.layerimageViewLayer.shadowColor = UIColor.blackColor().CGColorimageViewLayer.shadowOpacity = 1.0 //Ê≠§ÂèÇÊï∞ÈªòËÆ§‰∏∫0ÔºåÂç≥Èò¥ÂΩ±‰∏çÊòæÁ§∫imageViewLayer.shadowRadius = 2.0 //ÁªôÈò¥ÂΩ±Âä†‰∏äÂúÜËßíÔºåÂØπÊÄßËÉΩÊó†ÊòéÊòæÂΩ±ÂìçimageViewLayer.shadowOffset = CGSize(width: 5, height: 5)//ËÆæÂÆöË∑ØÂæÑÔºö‰∏éËßÜÂõæÁöÑËæπÁïåÁõ∏Âêålet path = UIBezierPath(rect: cell.imageView.bounds)imageViewLayer.shadowPath = path.CGPath//Ë∑ØÂæÑÈªòËÆ§‰∏∫ nil]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>UI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HTML+CSS ‰ΩøÁî®ÊñπÂºè]]></title>
    <url>%2F2017%2F05%2F31%2FHTML%2BCSS%2F</url>
    <content type="text"><![CDATA[‰ªéÊúÄÁÆÄÂçïÁöÑÁúãËµ∑ÔºåËøôÁØáÊñáÁ´†Áü•ËØÜ‰∏∫‰∫ÜÂ§áÂøò HTMLÂü∫Êú¨ÁöÑÂõõ‰∏™ HTML Ê†áÁ≠æHTML Ê†áÈ¢òÔºàHeadingÔºâÊòØÈÄöËøá &lt;h1&gt; - &lt;h6&gt; Á≠âÊ†áÁ≠æËøõË°åÂÆö‰πâÁöÑ„ÄÇ 1&lt;h1&gt;This is a heading&lt;/h1&gt; HTML ÊÆµËêΩÊòØÈÄöËøá &lt;p&gt;Ê†áÁ≠æËøõË°åÂÆö‰πâÁöÑ„ÄÇ 1&lt;p&gt;This is a paragraph.&lt;/p&gt; HTML ÈìæÊé•ÊòØÈÄöËøá &lt;a&gt; Ê†áÁ≠æËøõË°åÂÆö‰πâÁöÑ„ÄÇÂú® href Â±ûÊÄß‰∏≠ÊåáÂÆöÈìæÊé•ÁöÑÂú∞ÂùÄ„ÄÇ 1&lt;a href="http://www.w3school.com.cn"&gt;This is a link&lt;/a&gt; HTML ÂõæÂÉèÊòØÈÄöËøá &lt;img&gt; Ê†áÁ≠æËøõË°åÂÆö‰πâÁöÑ„ÄÇ 1&lt;img src="w3school.jpg" width="104" height="142" /&gt; HTML ÂÖÉÁ¥†HTML ÂÖÉÁ¥†ÊåáÁöÑÊòØ‰ªéÂºÄÂßãÊ†áÁ≠æÔºàstart tagÔºâÂà∞ÁªìÊùüÊ†áÁ≠æÔºàend tagÔºâÁöÑÊâÄÊúâ‰ª£Á†Å„ÄÇ &lt;p&gt;ÂÖÉÁ¥†ÂÆö‰πâ‰∫Ü HTML ÊñáÊ°£‰∏≠ÁöÑ‰∏Ä‰∏™ÊÆµËêΩ„ÄÇ 1&lt;p&gt;This is my first paragraph.&lt;/p&gt; &lt;body&gt; ÂÖÉÁ¥†ÂÆö‰πâ‰∫Ü HTML ÊñáÊ°£ÁöÑ‰∏ª‰Ωì 123&lt;body&gt;&lt;p&gt;This is my first paragraph.&lt;/p&gt;&lt;/body&gt; &lt;html&gt; ÂÖÉÁ¥†ÂÆö‰πâ‰∫ÜÊï¥‰∏™ HTML ÊñáÊ°£„ÄÇ 1234567&lt;html&gt;&lt;body&gt;&lt;p&gt;This is my first paragraph.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt; Ê≤°ÊúâÂÜÖÂÆπÁöÑ HTML ÂÖÉÁ¥†Ë¢´Áß∞‰∏∫Á©∫ÂÖÉÁ¥†„ÄÇÁ©∫ÂÖÉÁ¥†ÊòØÂú®ÂºÄÂßãÊ†áÁ≠æ‰∏≠ÂÖ≥Èó≠ÁöÑ„ÄÇÊâÄÊúâÂÖÉÁ¥†ÈÉΩÂøÖÈ°ªË¢´ÂÖ≥Èó≠ÔºåÂú®ÂºÄÂßãÊ†áÁ≠æ‰∏≠Ê∑ªÂä†ÊñúÊù†ÔºåÊØîÂ¶Ç&lt;br /&gt;ÔºåÊòØÂÖ≥Èó≠Á©∫ÂÖÉÁ¥†ÁöÑÊ≠£Á°ÆÊñπÊ≥ï„ÄÇ HTML Â±ûÊÄßHTML Ê†áÁ≠æÂèØ‰ª•Êã•ÊúâÂ±ûÊÄßÔºåÊÄªÊòØ‰ª•ÂêçÁß∞/ÂÄºÂØπÁöÑÂΩ¢ÂºèÂá∫Áé∞ÔºåÊØîÂ¶ÇÔºöname=‚Äùvalue‚Äù„ÄÇÂ±ûÊÄßÊÄªÊòØÂú® HTML ÂÖÉÁ¥†ÁöÑÂºÄÂßãÊ†áÁ≠æ‰∏≠ËßÑÂÆöÔºå‰æãÂ¶ÇÔºö 1&lt;table border="1"&gt; Â±ûÊÄßÂÄºÂ∫îËØ•ÂßãÁªàË¢´ÂåÖÊã¨Âú®ÂºïÂè∑ÂÜÖ„ÄÇÂèåÂºïÂè∑ÊòØÊúÄÂ∏∏Áî®ÁöÑÔºåÂú®Êüê‰∫õ‰∏™Âà´ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊØîÂ¶ÇÂ±ûÊÄßÂÄºÊú¨Ë∫´Â∞±Âê´ÊúâÂèåÂºïÂè∑ÔºåÈÇ£‰πàÊÇ®ÂøÖÈ°ª‰ΩøÁî®ÂçïÂºïÂè∑Ôºå‰æãÂ¶ÇÔºö 1name='Bill "HelloWorld" Gates' Â∏∏Áî®Â±ûÊÄßÔºö 1234class: ËßÑÂÆöÂÖÉÁ¥†ÁöÑÁ±ªÂêçid: ËßÑÂÆöÂÖÉÁ¥†ÁöÑÂîØ‰∏Ä idstyle: ËßÑÂÆöÂÖÉÁ¥†ÁöÑË°åÂÜÖÊ†∑Âºètitle: ËßÑÂÆöÂÖÉÁ¥†ÁöÑÈ¢ùÂ§ñ‰ø°ÊÅØ HTML Ê†áÈ¢òÊ†áÈ¢òÔºàHeadingÔºâÊòØÈÄöËøá &lt;h1&gt; - &lt;h6&gt;Á≠âÊ†áÁ≠æËøõË°åÂÆö‰πâÁöÑ„ÄÇ 123&lt;h1&gt;This is a heading&lt;/h1&gt;&lt;h2&gt;This is a heading&lt;/h2&gt;&lt;h3&gt;This is a heading&lt;/h3&gt; &lt;hr /&gt;Ê†áÁ≠æÂú® HTML È°µÈù¢‰∏≠ÂàõÂª∫Ê∞¥Âπ≥Á∫ø„ÄÇhr ÂÖÉÁ¥†ÂèØÁî®‰∫éÂàÜÈöîÂÜÖÂÆπ„ÄÇ 12345&lt;p&gt;This is a paragraph&lt;/p&gt;&lt;hr /&gt;&lt;p&gt;This is a paragraph&lt;/p&gt;&lt;hr /&gt;&lt;p&gt;This is a paragraph&lt;/p&gt; HTML ÊÆµËêΩÊÆµËêΩÊòØÈÄöËøá &lt;p&gt; Ê†áÁ≠æÂÆö‰πâÁöÑ„ÄÇ 12&lt;p&gt;This is a paragraph&lt;/p&gt;&lt;p&gt;This is another paragraph&lt;/p&gt; ÂØπ‰∫é HTMLÔºåÊÇ®Êó†Ê≥ïÈÄöËøáÂú® HTML ‰ª£Á†Å‰∏≠Ê∑ªÂä†È¢ùÂ§ñÁöÑÁ©∫Ê†ºÊàñÊç¢Ë°åÊù•ÊîπÂèòËæìÂá∫ÁöÑÊïàÊûú„ÄÇÂ¶ÇÊûúÂ∏åÊúõÂú®‰∏ç‰∫ßÁîü‰∏Ä‰∏™Êñ∞ÊÆµËêΩÁöÑÊÉÖÂÜµ‰∏ãËøõË°åÊç¢Ë°åÔºàÊñ∞Ë°åÔºâÔºåËØ∑‰ΩøÁî® &lt;br /&gt; Ê†áÁ≠æÔºö 1&lt;p&gt;This is&lt;br /&gt;a para&lt;br /&gt;graph with line breaks&lt;/p&gt; HTML Ê†∑Âºèstyle Â±ûÊÄßÁî®‰∫éÊîπÂèò HTML ÂÖÉÁ¥†ÁöÑÊ†∑Âºè„ÄÇÂÖ∑‰ΩìÂú® CSS Á≥ªÂàó‰∏≠ËÉΩÂ§üÂ≠¶Âà∞ 12345678&lt;html&gt;&lt;body&gt;&lt;h1 style="font-family:verdana"&gt;A heading&lt;/h1&gt;&lt;p style="font-family:arial;color:red;font-size:20px;"&gt;A paragraph.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt; HTML ÊñáÊú¨Ê†ºÂºèÂåñ12345678910&lt;b&gt; ÂÆö‰πâÁ≤ó‰ΩìÊñáÊú¨„ÄÇ&lt;big&gt; ÂÆö‰πâÂ§ßÂè∑Â≠ó„ÄÇ&lt;em&gt; ÂÆö‰πâÁùÄÈáçÊñáÂ≠ó„ÄÇ&lt;i&gt; ÂÆö‰πâÊñú‰ΩìÂ≠ó„ÄÇ&lt;small&gt; ÂÆö‰πâÂ∞èÂè∑Â≠ó„ÄÇ&lt;strong&gt; ÂÆö‰πâÂä†ÈáçËØ≠Ê∞î„ÄÇ&lt;sub&gt; ÂÆö‰πâ‰∏ãÊ†áÂ≠ó„ÄÇ&lt;sup&gt; ÂÆö‰πâ‰∏äÊ†áÂ≠ó„ÄÇ&lt;ins&gt; ÂÆö‰πâÊèíÂÖ•Â≠ó„ÄÇ&lt;del&gt; ÂÆö‰πâÂà†Èô§Â≠ó„ÄÇ HTML ÂºïÁî®&lt;q&gt;ÂÖÉÁ¥†ÂÆö‰πâÁü≠ÁöÑÂºïÁî®„ÄÇÊµèËßàÂô®ÈÄöÂ∏∏‰ºö‰∏∫ &lt;q&gt; ÂÖÉÁ¥†ÂåÖÂõ¥ÂºïÂè∑„ÄÇ 1&lt;p&gt;WWF ÁöÑÁõÆÊ†áÊòØÔºö&lt;q&gt;ÊûÑÂª∫‰∫∫‰∏éËá™ÁÑ∂ÂíåË∞êÂÖ±Â≠òÁöÑ‰∏ñÁïå„ÄÇ&lt;/q&gt;&lt;/p&gt; &lt;blockquote&gt; ÂÖÉÁ¥†ÂÆö‰πâË¢´ÂºïÁî®ÁöÑËäÇ„ÄÇÊµèËßàÂô®ÈÄöÂ∏∏‰ºöÂØπ &lt;blockquote&gt;ÂÖÉÁ¥†ËøõË°åÁº©ËøõÂ§ÑÁêÜ„ÄÇ 123456&lt;p&gt;‰ª•‰∏ãÂÜÖÂÆπÂºïÁî®Ëá™ WWF ÁöÑÁΩëÁ´ôÔºö&lt;/p&gt;&lt;blockquote&gt;‰∫îÂçÅÂπ¥Êù•ÔºåWWF ‰∏ÄÁõ¥Ëá¥Âäõ‰∫é‰øùÊä§Ëá™ÁÑ∂ÁïåÁöÑÊú™Êù•„ÄÇ‰∏ñÁïåÈ¢ÜÂÖàÁöÑÁéØ‰øùÁªÑÁªáÔºåWWF Â∑•‰Ωú‰∫é 100 ‰∏™ÂõΩÂÆ∂ÔºåÂπ∂ÂæóÂà∞ÁæéÂõΩ‰∏ÄÁôæ‰∫åÂçÅ‰∏á‰ºöÂëòÂèäÂÖ®ÁêÉËøë‰∫îÁôæ‰∏á‰ºöÂëòÁöÑÊîØÊåÅ„ÄÇ&lt;/blockquote&gt; HTML ËÆ°ÁÆóÊú∫‰ª£Á†ÅÂÖÉÁ¥† &lt;code&gt; ÂÖÉÁ¥†ÂÆö‰πâÁºñÁ®ã‰ª£Á†Å,‰∏ç‰øùÁïôÂ§ö‰ΩôÁöÑÁ©∫Ê†ºÂíåÊäòË°å,Á§∫‰æãÔºö 1234&lt;p&gt;Coding Example:&lt;/p&gt;&lt;code&gt;var person = &#123; firstName:"Bill", lastName:"Gates", age:50, eyeColor:"blue" &#125;&lt;/code&gt; Â¶ÇÈúÄ‰øùÁïôÁ©∫Ê†ºÊäòË°åÔºåÈúÄË¶Å‰ΩøÁî® &lt;pre&gt; : 123456789101112&lt;p&gt;Coding Example:&lt;/p&gt;&lt;code&gt;&lt;pre&gt;var person = &#123; firstName:"Bill", lastName:"Gates", age:50, eyeColor:"blue"&#125;&lt;/pre&gt;&lt;/code&gt; HTML Ê≥®ÈáäÊ≥®ÈáäÊòØËøôÊ†∑ÂÜôÁöÑÔºåÂºÄÂßãÊã¨Âè∑‰πãÂêéÔºàÂ∑¶ËæπÁöÑÊã¨Âè∑ÔºâÈúÄË¶ÅÁ¥ßË∑ü‰∏Ä‰∏™ÂèπÂè∑ÔºåÁªìÊùüÊã¨Âè∑‰πãÂâçÔºàÂè≥ËæπÁöÑÊã¨Âè∑Ôºâ‰∏çÈúÄË¶Å„ÄÇÔºö 1&lt;! This is a comment &gt; HTML CSSÂΩìÊ†∑ÂºèÈúÄË¶ÅË¢´Â∫îÁî®Âà∞ÂæàÂ§öÈ°µÈù¢ÁöÑÊó∂ÂÄôÔºåÂ§ñÈÉ®Ê†∑ÂºèË°®Â∞ÜÊòØÁêÜÊÉ≥ÁöÑÈÄâÊã©„ÄÇ‰ΩøÁî®Â§ñÈÉ®Ê†∑ÂºèË°®Ôºå‰Ω†Â∞±ÂèØ‰ª•ÈÄöËøáÊõ¥Êîπ‰∏Ä‰∏™Êñá‰ª∂Êù•ÊîπÂèòÊï¥‰∏™Á´ôÁÇπÁöÑÂ§ñËßÇ„ÄÇ 123&lt;head&gt;&lt;link rel="stylesheet" type="text/css" href="/html/csstest1.css"&gt;&lt;/head&gt; ËøôÈáåÁöÑË∑ØÂæÑÊòØÁõ∏ÂΩì‰∫éÁΩëÁ´ôÊ†πË∑ØÂæÑÁöÑ ÂΩìÂçï‰∏™Êñá‰ª∂ÈúÄË¶ÅÁâπÂà´Ê†∑ÂºèÊó∂ÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî®ÂÜÖÈÉ®Ê†∑ÂºèË°®„ÄÇ‰Ω†ÂèØ‰ª•Âú® head ÈÉ®ÂàÜÈÄöËøá &lt;style&gt; Ê†áÁ≠æÂÆö‰πâÂÜÖÈÉ®Ê†∑ÂºèË°®„ÄÇ 123456&lt;head&gt;&lt;style type="text/css"&gt;body &#123;background-color: red&#125;p &#123;margin-left: 20px&#125;&lt;/style&gt;&lt;/head&gt; ÂΩìÁâπÊÆäÁöÑÊ†∑ÂºèÈúÄË¶ÅÂ∫îÁî®Âà∞‰∏™Âà´ÂÖÉÁ¥†Êó∂ÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî®ÂÜÖËÅîÊ†∑Âºè: 123&lt;p style="color: red; margin-left: 20px"&gt;This is a paragraph&lt;/p&gt; HTML ÈìæÊé•ÂºÄÂßãÊ†áÁ≠æÂíåÁªìÊùüÊ†áÁ≠æ‰πãÈó¥ÁöÑÊñáÂ≠óË¢´‰Ωú‰∏∫Ë∂ÖÁ∫ßÈìæÊé•Êù•ÊòæÁ§∫„ÄÇ‚ÄùÈìæÊé•ÊñáÊú¨‚Äù ‰∏çÂøÖ‰∏ÄÂÆöÊòØÊñáÊú¨„ÄÇÂõæÁâáÊàñÂÖ∂‰ªñ HTML ÂÖÉÁ¥†ÈÉΩÂèØ‰ª•Êàê‰∏∫ÈìæÊé•„ÄÇ 1&lt;a href="http://www.w3school.com.cn/"&gt;Visit W3School&lt;/a&gt; ‰ΩøÁî® Target Â±ûÊÄßÔºå‰Ω†ÂèØ‰ª•ÂÆö‰πâË¢´ÈìæÊé•ÁöÑÊñáÊ°£Âú®‰ΩïÂ§ÑÊòæÁ§∫„ÄÇ 12// ËøôÊÆµ‰ª£Á†Å‰ºöÂú®Êñ∞Á™óÂè£ÊòæÁ§∫&lt;a href="http://www.w3school.com.cn/" target="_blank"&gt;Visit W3School!&lt;/a&gt; name Â±ûÊÄßËßÑÂÆöÈîöÔºàanchorÔºâÁöÑÂêçÁß∞„ÄÇÂèØ‰ª•‰ΩøÁî® name Â±ûÊÄßÂàõÂª∫ HTML È°µÈù¢‰∏≠ÁöÑ‰π¶Á≠æ„ÄÇÂΩì‰ΩøÁî®ÂëΩÂêçÈîöÔºànamed anchorsÔºâÊó∂ÔºåÊàë‰ª¨ÂèØ‰ª•ÂàõÂª∫Áõ¥Êé•Ë∑≥Ëá≥ËØ•ÂëΩÂêçÈîöÔºàÊØîÂ¶ÇÈ°µÈù¢‰∏≠Êüê‰∏™Â∞èËäÇÔºâÁöÑÈìæÊé•ÔºåËøôÊ†∑‰ΩøÁî®ËÄÖÂ∞±Êó†ÈúÄ‰∏çÂÅúÂú∞ÊªöÂä®È°µÈù¢Êù•ÂØªÊâæ‰ªñ‰ª¨ÈúÄË¶ÅÁöÑ‰ø°ÊÅØ‰∫Ü„ÄÇ È¶ñÂÖàÔºåÊàë‰ª¨Âú® HTML ÊñáÊ°£‰∏≠ÂØπÈîöËøõË°åÂëΩÂêçÔºàÂàõÂª∫‰∏Ä‰∏™‰π¶Á≠æÔºâÔºö 1&lt;a name="tips"&gt;Âü∫Êú¨ÁöÑÊ≥®ÊÑè‰∫ãÈ°π - ÊúâÁî®ÁöÑÊèêÁ§∫&lt;/a&gt; ÁÑ∂ÂêéÔºåÊàë‰ª¨Âú®Âêå‰∏Ä‰∏™ÊñáÊ°£‰∏≠ÂàõÂª∫ÊåáÂêëËØ•ÈîöÁöÑÈìæÊé•Ôºö 1&lt;a href="#tips"&gt;ÊúâÁî®ÁöÑÊèêÁ§∫&lt;/a&gt; ÊÇ®‰πüÂèØ‰ª•Âú®ÂÖ∂‰ªñÈ°µÈù¢‰∏≠ÂàõÂª∫ÊåáÂêëËØ•ÈîöÁöÑÈìæÊé•Ôºö 1&lt;a href="http://www.w3school.com.cn/html/html_links.asp#tips"&gt;ÊúâÁî®ÁöÑÊèêÁ§∫&lt;/a&gt; Âú®‰∏äÈù¢ÁöÑ‰ª£Á†Å‰∏≠ÔºåÊàë‰ª¨Â∞Ü # Á¨¶Âè∑ÂíåÈîöÂêçÁß∞Ê∑ªÂä†Âà∞ URL ÁöÑÊú´Á´ØÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•ÈìæÊé•Âà∞ tips Ëøô‰∏™ÂëΩÂêçÈîö‰∫Ü„ÄÇ HTML ÂõæÂÉèÂõæÂÉèÁî± &lt;img&gt; Ê†áÁ≠æÂÆö‰πâ„ÄÇË¶ÅÂú®È°µÈù¢‰∏äÊòæÁ§∫ÂõæÂÉèÔºå‰Ω†ÈúÄË¶Å‰ΩøÁî®Ê∫êÂ±ûÊÄß 1&lt;img src="http://www.w3school.com.cn/images/boat.gif" /&gt; alt Â±ûÊÄßÁî®Êù•‰∏∫ÂõæÂÉèÂÆö‰πâ‰∏Ä‰∏≤È¢ÑÂ§áÁöÑÂèØÊõøÊç¢ÁöÑÊñáÊú¨„ÄÇÂú®ÊµèËßàÂô®Êó†Ê≥ïËΩΩÂÖ•ÂõæÂÉèÊó∂ÔºåÊõøÊç¢ÊñáÊú¨Â±ûÊÄßÂëäËØâËØªËÄÖÂ•π‰ª¨Â§±ÂéªÁöÑ‰ø°ÊÅØ„ÄÇ 1&lt;img src="boat.gif" alt="Big Boat"&gt; HTML Ë°®Ê†ºË°®Ê†ºÁî± &lt;table&gt; Ê†áÁ≠æÊù•ÂÆö‰πâ„ÄÇÊØè‰∏™Ë°®Ê†ºÂùáÊúâËã•Âπ≤Ë°åÔºàÁî± &lt;tr&gt; Ê†áÁ≠æÂÆö‰πâÔºâÔºåÊØèË°åË¢´ÂàÜÂâ≤‰∏∫Ëã•Âπ≤ÂçïÂÖÉÊ†ºÔºàÁî± &lt;td&gt; Ê†áÁ≠æÂÆö‰πâÔºâ ‰ΩøÁî®ËæπÊ°ÜÂ±ûÊÄßÊù•ÊòæÁ§∫‰∏Ä‰∏™Â∏¶ÊúâËæπÊ°ÜÁöÑË°®Ê†º Ë°®Ê†ºÁöÑË°®Â§¥‰ΩøÁî® &lt;th&gt; Ê†áÁ≠æËøõË°åÂÆö‰πâ„ÄÇÂ§ßÂ§öÊï∞ÊµèËßàÂô®‰ºöÊääË°®Â§¥ÊòæÁ§∫‰∏∫Á≤ó‰ΩìÂ±Ö‰∏≠ÁöÑÊñáÊú¨„ÄÇ ‰ΩøÁî®&lt;caption&gt; Â±ûÊÄßÊèèËø∞Ë°®Ê†ºÊ†áÈ¢òÔºåÊ†áÈ¢òÁöÑÊòæÁ§∫‰ΩçÁΩÆÔºöË°®Ê†º‰∏äÊñπ„ÄÇ 1234567891011121314&lt;table border="1"&gt;&lt;caption&gt;Ê†áÈ¢òÊñáÊú¨&lt;/caption&gt;&lt;tr&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Another Heading&lt;/th&gt;&lt;tr&gt;&lt;td&gt;row 1, cell 1&lt;/td&gt;&lt;td&gt;row 1, cell 2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;row 2, cell 1&lt;/td&gt;&lt;td&gt;row 2, cell 2&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt; HTML ÂàóË°®Êó†Â∫èÂàóË°®ÊòØ‰∏Ä‰∏™È°πÁõÆÁöÑÂàóË°®ÔºåÊ≠§ÂàóÈ°πÁõÆ‰ΩøÁî®Á≤ó‰ΩìÂúÜÁÇπÔºàÂÖ∏ÂûãÁöÑÂ∞èÈªëÂúÜÂúàÔºâËøõË°åÊ†áËÆ∞„ÄÇÊó†Â∫èÂàóË°®Âßã‰∫é &lt;ul&gt; Ê†áÁ≠æ„ÄÇÊØè‰∏™ÂàóË°®È°πÂßã‰∫é &lt;li&gt;„ÄÇ 1234&lt;ul&gt;&lt;li&gt;Coffee&lt;/li&gt;&lt;li&gt;Milk&lt;/li&gt;&lt;/ul&gt; ÊúâÂ∫èÂàóË°®‰πüÊòØ‰∏ÄÂàóÈ°πÁõÆÔºåÂàóË°®È°πÁõÆ‰ΩøÁî®Êï∞Â≠óËøõË°åÊ†áËÆ∞„ÄÇÊúâÂ∫èÂàóË°®Âßã‰∫é &lt;ol&gt; Ê†áÁ≠æ„ÄÇÊØè‰∏™ÂàóË°®È°πÂßã‰∫é &lt;li&gt; Ê†áÁ≠æ„ÄÇ 1234&lt;ol&gt;&lt;li&gt;Coffee&lt;/li&gt;&lt;li&gt;Milk&lt;/li&gt;&lt;/ol&gt; HTML &lt;div&gt; Âíå &lt;span&gt;Â§ßÂ§öÊï∞ HTML ÂÖÉÁ¥†Ë¢´ÂÆö‰πâ‰∏∫ÂùóÁ∫ßÂÖÉÁ¥†ÊàñÂÜÖËÅîÂÖÉÁ¥†„ÄÇÂùóÁ∫ßÂÖÉÁ¥†Âú®ÊµèËßàÂô®ÊòæÁ§∫Êó∂ÔºåÈÄöÂ∏∏‰ºö‰ª•Êñ∞Ë°åÊù•ÂºÄÂßãÂíåÁªìÊùüÔºåÂ¶ÇÔºö 1&lt;h1&gt;, &lt;p&gt;, &lt;ul&gt;, &lt;table&gt; ÂÜÖËÅîÂÖÉÁ¥†Âú®ÊòæÁ§∫Êó∂ÈÄöÂ∏∏‰∏ç‰ºö‰ª•Êñ∞Ë°åÂºÄÂßã: 1&lt;b&gt;, &lt;td&gt;, &lt;a&gt;, &lt;img&gt; HTML &lt;div&gt; ÂÖÉÁ¥†ÊòØÂùóÁ∫ßÂÖÉÁ¥†ÔºåÂÆÉÊòØÂèØÁî®‰∫éÁªÑÂêàÂÖ∂‰ªñ HTML ÂÖÉÁ¥†ÁöÑÂÆπÂô®„ÄÇ‰∏é CSS ‰∏ÄÂêå‰ΩøÁî®Ôºå&lt;div&gt; ÂÖÉÁ¥†ÂèØÁî®‰∫éÂØπÂ§ßÁöÑÂÜÖÂÆπÂùóËÆæÁΩÆÊ†∑ÂºèÂ±ûÊÄß„ÄÇ&lt;div&gt; ÂÖÉÁ¥†ÁöÑÂè¶‰∏Ä‰∏™Â∏∏ËßÅÁöÑÁî®ÈÄîÊòØÊñáÊ°£Â∏ÉÂ±Ä„ÄÇ HTML &lt;span&gt; ÂÖÉÁ¥†ÊòØÂÜÖËÅîÂÖÉÁ¥†ÔºåÂèØÁî®‰ΩúÊñáÊú¨ÁöÑÂÆπÂô®„ÄÇÂΩì‰∏é CSS ‰∏ÄÂêå‰ΩøÁî®Êó∂Ôºå&lt;span&gt; ÂÖÉÁ¥†ÂèØÁî®‰∫é‰∏∫ÈÉ®ÂàÜÊñáÊú¨ËÆæÁΩÆÊ†∑ÂºèÂ±ûÊÄß„ÄÇ HTML Á±ªÂØπ HTML ËøõË°åÂàÜÁ±ªÔºàËÆæÁΩÆÁ±ªÔºâÔºå‰ΩøÊàë‰ª¨ËÉΩÂ§ü‰∏∫ÂÖÉÁ¥†ÁöÑÁ±ªÂÆö‰πâ CSS Ê†∑Âºè„ÄÇ 123456789101112131415161718192021222324&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;style&gt;.cities &#123; background-color:black; color:white; margin:20px; padding:20px;&#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="cities"&gt;&lt;h2&gt;London&lt;/h2&gt;&lt;p&gt;London is the capital city of England. It is the most populous city in the United Kingdom, with a metropolitan area of over 13 million inhabitants.&lt;/p&gt;&lt;/div&gt; &lt;/body&gt;&lt;/html&gt; ËøôÈáåÁöÑ .cities Ë°®Á§∫‰ªªÊÑèÂêç‰∏∫ cities ÁöÑÁ±ªÔºåÂèØ‰ª•Âú®ÂâçÈù¢Âä†‰∏äÂâçÁºÄ div Ë°®Á§∫Âè™Êúâ &lt;div&gt; ÊâçËÉΩ‰ΩøÁî®Ëøô‰∏™Á±ª. ËøòÂèØ‰ª•‰∫åÁ∫ßÂÖÉÁ¥†ÔºåÂ¶Ç &lt;table&gt; ‰∏≠ÁöÑ &lt;th&gt; Á≠âÔºö 123456789101112131415161718192021222324252627282930//html&lt;body&gt;&lt;table class="lamp"&gt;&lt;caption&gt;Ê†áÈ¢òÊñáÊú¨&lt;/caption&gt;&lt;tr&gt; &lt;th&gt; &lt;img src="/images/lamp.jpg" alt="Note" style="height:32px;width:32px"&gt; &lt;/th&gt; &lt;td&gt; The table element was not designed to be a layout tool. &lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/body&gt;//css&lt;style&gt;table.lamp &#123; width:100%; border:1px solid #d4d4d4;&#125;table.lamp th, td &#123; padding:10px;&#125;table.lamp td &#123; width:40px;&#125;&lt;/style&gt; HTML Â∏ÉÂ±Ä&lt;div&gt; ÂÖÉÁ¥†Â∏∏Áî®‰ΩúÂ∏ÉÂ±ÄÂ∑•ÂÖ∑Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960// html&lt;body&gt;&lt;div id="header"&gt;&lt;h1&gt;City Gallery&lt;/h1&gt;&lt;/div&gt;&lt;div id="nav"&gt;London&lt;br&gt;Paris&lt;br&gt;Tokyo&lt;br&gt;&lt;/div&gt;&lt;div id="section"&gt;&lt;h1&gt;London&lt;/h1&gt;&lt;p&gt;London is the capital city of England. It is the most populous city in the United Kingdom,with a metropolitan area of over 13 million inhabitants.&lt;/p&gt;&lt;p&gt;Standing on the River Thames, London has been a major settlement for two millennia,its history going back to its founding by the Romans, who named it Londinium.&lt;/p&gt;&lt;/div&gt;&lt;div id="footer"&gt;Copyright W3School.com.cn&lt;/div&gt;&lt;/body&gt;//css&lt;style&gt;#header &#123; background-color:black; color:white; text-align:center; padding:5px;&#125;#nav &#123; line-height:30px; background-color:#eeeeee; height:300px; width:100px; float:left; padding:5px; &#125;#section &#123; width:350px; float:left; padding:10px; &#125;#footer &#123; background-color:black; color:white; clear:both; text-align:center; padding:5px; &#125;&lt;/style&gt; ‰ΩøÁî®‰∫Ü id Ë°®Á§∫ÂÖÉÁ¥†ÔºåÂØπÂ∫îÈúÄË¶ÅÂä†‰∏ä # HTML ËÑöÊú¨&lt;script&gt; Ê†áÁ≠æÁî®‰∫éÂÆö‰πâÂÆ¢Êà∑Á´ØËÑöÊú¨Ôºåscript ÂÖÉÁ¥†Êó¢ÂèØÂåÖÂê´ËÑöÊú¨ËØ≠Âè•Ôºå‰πüÂèØÈÄöËøá src Â±ûÊÄßÊåáÂêëÂ§ñÈÉ®ËÑöÊú¨Êñá‰ª∂„ÄÇ HTML Â§¥ÈÉ®ÂÖÉÁ¥†&lt;head&gt; ÂÖÉÁ¥†ÊòØÊâÄÊúâÂ§¥ÈÉ®ÂÖÉÁ¥†ÁöÑÂÆπÂô®„ÄÇ&lt;head&gt; ÂÜÖÁöÑÂÖÉÁ¥†ÂèØÂåÖÂê´ËÑöÊú¨ÔºåÊåáÁ§∫ÊµèËßàÂô®Âú®‰ΩïÂ§ÑÂèØ‰ª•ÊâæÂà∞Ê†∑ÂºèË°®ÔºåÊèê‰æõÂÖÉ‰ø°ÊÅØ„ÄÇ &lt;title&gt; Ê†áÁ≠æÂÆö‰πâÊñáÊ°£ÁöÑÊ†áÈ¢ò„ÄÇËÉΩÂ§üÂÆö‰πâÊµèËßàÂô®Â∑•ÂÖ∑Ê†è‰∏≠ÁöÑÊ†áÈ¢ò;Êèê‰æõÈ°µÈù¢Ë¢´Ê∑ªÂä†Âà∞Êî∂ËóèÂ§πÊó∂ÊòæÁ§∫ÁöÑÊ†áÈ¢ò;ÊòæÁ§∫Âú®ÊêúÁ¥¢ÂºïÊìéÁªìÊûú‰∏≠ÁöÑÈ°µÈù¢Ê†áÈ¢ò. 1234567891011&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Title of the document&lt;/title&gt;&lt;/head&gt;&lt;body&gt;The content of the document......&lt;/body&gt;&lt;/html&gt; &lt;base&gt; Ê†áÁ≠æ‰∏∫È°µÈù¢‰∏äÁöÑÊâÄÊúâÈìæÊé•ËßÑÂÆöÈªòËÆ§Âú∞ÂùÄÊàñÈªòËÆ§ÁõÆÊ†áÔºàtargetÔºâÔºö 1234&lt;head&gt;&lt;base href="http://www.w3school.com.cn/images/" /&gt;&lt;base target="_blank" /&gt;&lt;/head&gt; &lt;link&gt; Ê†áÁ≠æÂÆö‰πâÊñáÊ°£‰∏éÂ§ñÈÉ®ËµÑÊ∫ê‰πãÈó¥ÁöÑÂÖ≥Á≥ª„ÄÇÊúÄÂ∏∏Áî®‰∫éËøûÊé•Ê†∑ÂºèË°®Ôºö 123&lt;head&gt;&lt;link rel="stylesheet" type="text/css" href="mystyle.css" /&gt;&lt;/head&gt; &lt;style&gt; Ê†áÁ≠æÁî®‰∫é‰∏∫ HTML ÊñáÊ°£ÂÆö‰πâÊ†∑Âºè‰ø°ÊÅØ: 123456&lt;head&gt;&lt;style type="text/css"&gt;body &#123;background-color:yellow&#125;p &#123;color:blue&#125;&lt;/style&gt;&lt;/head&gt; &lt;meta&gt; Ê†áÁ≠æÊèê‰æõÂÖ≥‰∫é HTML ÊñáÊ°£ÁöÑÂÖÉÊï∞ÊçÆ„ÄÇÂÖÉÊï∞ÊçÆ‰∏ç‰ºöÊòæÁ§∫Âú®È°µÈù¢‰∏äÔºå‰ΩÜÊòØÂØπ‰∫éÊú∫Âô®ÊòØÂèØËØªÁöÑ„ÄÇÂÖ∏ÂûãÁöÑÊÉÖÂÜµÊòØÔºåmeta ÂÖÉÁ¥†Ë¢´Áî®‰∫éËßÑÂÆöÈ°µÈù¢ÁöÑÊèèËø∞„ÄÅÂÖ≥ÈîÆËØç„ÄÅÊñáÊ°£ÁöÑ‰ΩúËÄÖ„ÄÅÊúÄÂêé‰øÆÊîπÊó∂Èó¥‰ª•ÂèäÂÖ∂‰ªñÂÖÉÊï∞ÊçÆ„ÄÇ&lt;meta&gt; Ê†áÁ≠æÂßãÁªà‰Ωç‰∫é head ÂÖÉÁ¥†‰∏≠„ÄÇ &lt;script&gt; Ê†áÁ≠æÁî®‰∫éÂÆö‰πâÂÆ¢Êà∑Á´ØËÑöÊú¨ÔºåÊØîÂ¶Ç JavaScript„ÄÇ HTML Â≠óÁ¨¶ÂÆû‰ΩìÂú® HTML ‰∏≠ÔºåÊüê‰∫õÂ≠óÁ¨¶ÊòØÈ¢ÑÁïôÁöÑ. ÊØîÂ¶Ç‰∏çËÉΩÁõ¥Êé•‰ΩøÁî® &lt; Âõ†‰∏∫‰ºöË¢´ËÆ§‰∏∫ÊòØÊ†áÁ≠æÔºåÂøÖÈ°ªÂÜôÊàê &amp;lt;„ÄÇÂÜçÊØîÂ¶Ç‰∏çËÉΩÁõ¥Êé•‰ΩøÁî®Á©∫Ê†ºÔºåÈúÄË¶ÅÁ©∫Ê†ºÂàôÂøÖÈ°ªÂÜôÊàê&amp;nbspÔºåÂÖ∑‰ΩìÂèØ‰ª•Êü•Ë°®„ÄÇ HTML Áªü‰∏ÄËµÑÊ∫êÂÆö‰ΩçÂô®Áªü‰∏ÄËµÑÊ∫êÂÆö‰ΩçÂô®ÔºàURLÔºâÁî®‰∫éÂÆö‰Ωç‰∏áÁª¥ÁΩë‰∏äÁöÑÊñáÊ°£ÔºåÈÅµÂÆà‰ª•‰∏ãÁöÑËØ≠Ê≥ïËßÑÂàôÔºö 12345678scheme://host.domain:port/path/filenamescheme - ÂÆö‰πâÂõ†ÁâπÁΩëÊúçÂä°ÁöÑÁ±ªÂûã„ÄÇÊúÄÂ∏∏ËßÅÁöÑÁ±ªÂûãÊòØ httphost - ÂÆö‰πâÂüü‰∏ªÊú∫Ôºàhttp ÁöÑÈªòËÆ§‰∏ªÊú∫ÊòØ wwwÔºâdomain - ÂÆö‰πâÂõ†ÁâπÁΩëÂüüÂêçÔºåÊØîÂ¶Ç w3school.com.cn:port - ÂÆö‰πâ‰∏ªÊú∫‰∏äÁöÑÁ´ØÂè£Âè∑Ôºàhttp ÁöÑÈªòËÆ§Á´ØÂè£Âè∑ÊòØ 80Ôºâpath - ÂÆö‰πâÊúçÂä°Âô®‰∏äÁöÑË∑ØÂæÑÔºàÂ¶ÇÊûúÁúÅÁï•ÔºåÂàôÊñáÊ°£ÂøÖÈ°ª‰Ωç‰∫éÁΩëÁ´ôÁöÑÊ†πÁõÆÂΩï‰∏≠Ôºâ„ÄÇfilename - ÂÆö‰πâÊñáÊ°£/ËµÑÊ∫êÁöÑÂêçÁß∞ HTML URLÂ≠óÁ¨¶ÁºñÁ†ÅURL Âè™ËÉΩ‰ΩøÁî® ASCII Â≠óÁ¨¶ÈõÜÊù•ÈÄöËøáÂõ†ÁâπÁΩëËøõË°åÂèëÈÄÅ„ÄÇÁî±‰∫é URL Â∏∏Â∏∏‰ºöÂåÖÂê´ ASCII ÈõÜÂêà‰πãÂ§ñÁöÑÂ≠óÁ¨¶ÔºåURL ÂøÖÈ°ªËΩ¨Êç¢‰∏∫ÊúâÊïàÁöÑ ASCII Ê†ºÂºè„ÄÇURL ÁºñÁ†Å‰ΩøÁî® ‚Äú%‚Äù ÂÖ∂ÂêéË∑üÈöè‰∏§‰ΩçÁöÑÂçÅÂÖ≠ËøõÂà∂Êï∞Êù•ÊõøÊç¢Èùû ASCII Â≠óÁ¨¶„ÄÇ HTML &lt;!DOCTYPE&gt;&lt;!DOCTYPE&gt; ‰∏çÊòØ HTML Ê†áÁ≠æ„ÄÇÂÆÉ‰∏∫ÊµèËßàÂô®Êèê‰æõ‰∏ÄÈ°π‰ø°ÊÅØÔºàÂ£∞ÊòéÔºâÔºåÂç≥ HTML ÊòØÁî®‰ªÄ‰πàÁâàÊú¨ÁºñÂÜôÁöÑ„ÄÇÊúÄÂ∏∏Áî®ÁöÑÂ∏¶Êúâ HTML5 DOCTYPE ÁöÑ HTML ÊñáÊ°£Ôºö 1&lt;!DOCTYPE html&gt; HTML Ë°®ÂçïHTML Ë°®ÂçïÁî®‰∫éÊêúÈõÜ‰∏çÂêåÁ±ªÂûãÁöÑÁî®Êà∑ËæìÂÖ•„ÄÇ&lt;form&gt; ÂÖÉÁ¥†ÂÆö‰πâ HTML Ë°®Âçï„ÄÇË°®ÂçïÂÖÉÁ¥†ÊåáÁöÑÊòØ‰∏çÂêåÁ±ªÂûãÁöÑ input ÂÖÉÁ¥†„ÄÅÂ§çÈÄâÊ°Ü„ÄÅÂçïÈÄâÊåâÈíÆ„ÄÅÊèê‰∫§ÊåâÈíÆÁ≠âÁ≠â„ÄÇ &lt;input&gt; ÂÖÉÁ¥†ÊòØÊúÄÈáçË¶ÅÁöÑË°®ÂçïÂÖÉÁ¥†„ÄÇ&lt;input&gt; ÂÖÉÁ¥†ÊúâÂæàÂ§öÂΩ¢ÊÄÅÔºåÊ†πÊçÆ‰∏çÂêåÁöÑ type Â±ûÊÄß„ÄÇ &lt;input type=&quot;text&quot;&gt; ÂÆö‰πâÁî®‰∫éÊñáÊú¨ËæìÂÖ•ÁöÑÂçïË°åËæìÂÖ•Â≠óÊÆµÔºö 1234567&lt;form&gt;First name:&lt;br&gt;&lt;input type="text" name="firstname"&gt;&lt;br&gt;Last name:&lt;br&gt;&lt;input type="text" name="lastname"&gt;&lt;/form&gt; ‰∏äÈù¢‰ª£Á†ÅËØ¥Êòé‰∏çË¶Å‰ªª‰ΩïÊ†áÁ≠æ‰πüÊòØÂèØ‰ª•ÊòæÁ§∫Âá∫Â≠óÁ¨¶ÁöÑ &lt;input type=&quot;radio&quot;&gt; ÂÆö‰πâÂçïÈÄâÊåâÈíÆ: 12345&lt;form&gt;&lt;input type="radio" name="sex" value="male" checked&gt;Male&lt;br&gt;&lt;input type="radio" name="sex" value="female"&gt;Female&lt;/form&gt; &lt;input type=&quot;submit‚Äù&gt;ÂÆö‰πâÁî®‰∫éÂêëË°®ÂçïÂ§ÑÁêÜÁ®ãÂ∫èÊèê‰∫§Ë°®ÂçïÁöÑÊåâÈíÆ: 123456789&lt;form action="action_page.php" target="_blank"&gt;First name:&lt;br&gt;&lt;input type="text" name="firstname" value="Mickey"&gt;&lt;br&gt;Last name:&lt;br&gt;&lt;input type="text" name="lastname" value="Mouse"&gt;&lt;br&gt;&lt;br&gt;&lt;input type="submit" value="Submit"&gt;&lt;/form&gt; action Â±ûÊÄßÂÆö‰πâÂú®Êèê‰∫§Ë°®ÂçïÊó∂ÊâßË°åÁöÑÂä®‰Ωú„ÄÇÂú®‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåÊåáÂÆö‰∫ÜÊüê‰∏™ÊúçÂä°Âô®ËÑöÊú¨Êù•Â§ÑÁêÜË¢´Êèê‰∫§Ë°®ÂçïÔºö 1&lt;form action="action_page.php"&gt; targetÂ±ûÊÄßË°®Á§∫ËßÑÂÆö action Â±ûÊÄß‰∏≠Âú∞ÂùÄÁöÑÁõÆÊ†áÔºàÈªòËÆ§Ôºö_selfÔºâ„ÄÇÊú¨‰æã‰∏≠Ë°®Á§∫ÊâìÂºÄÊñ∞ÁöÑÁΩëÈ°µÔºö 1&lt;form action="action_page.php" target="_blank"&gt; method Â±ûÊÄßËßÑÂÆöÂú®Êèê‰∫§Ë°®ÂçïÊó∂ÊâÄÁî®ÁöÑ HTTP ÊñπÊ≥ïÔºàGET Êàñ POSTÔºâÔºåÈªòËÆ§ GETÔºö 1&lt;form action="action_page.php" method="GET"&gt; Â¶ÇÊûúË¶ÅÊ≠£Á°ÆÂú∞Ë¢´Êèê‰∫§ÔºåÊØè‰∏™ËæìÂÖ•Â≠óÊÆµÂøÖÈ°ªËÆæÁΩÆ‰∏Ä‰∏™ name Â±ûÊÄßÔºåÁõ∏ÂΩì‰∫éÈîÆ„ÄÇ‰∏äÈù¢ÁöÑ‰æãÂ≠êÂè™‰ºöÊèê‰∫§ ‚ÄúLast name‚Äù ËæìÂÖ•Â≠óÊÆµÔºåÂÖ∂ http ËØ∑Ê±ÇÊòØÔºö 1baseUrl/action_page.php?lastname=Mouse ÊØè‰∏™ËæìÂÖ•Â≠óÊÆµÁöÑvalueÂ±ûÊÄßÊòØË¢´Êèê‰∫§ÁöÑÂÄºÔºå‰∏äÈù¢ÁöÑ value ÊòØÈªòËÆ§ÁöÑÂ°´ÂÖÖ„ÄÇ HTML Ë°®ÂçïÂÖÉÁ¥†&lt;select&gt; ÂÖÉÁ¥†ÂÆö‰πâ‰∏ãÊãâÂàóË°®Ôºå&lt;option&gt; ÂÖÉÁ¥†ÂÆö‰πâÂæÖÈÄâÊã©ÁöÑÈÄâÈ°π„ÄÇÊÇ®ËÉΩÂ§üÈÄöËøáÊ∑ªÂä† selected Â±ûÊÄßÊù•ÂÆö‰πâÈ¢ÑÂÆö‰πâÈÄâÈ°π„ÄÇ 12345&lt;select name="cars"&gt;&lt;option value="volvo"&gt;Volvo&lt;/option&gt;&lt;option value="saab"&gt;Saab&lt;/option&gt;&lt;option value="fiat" selected&gt;Fiat&lt;/option&gt;&lt;option value="audi"&gt;Audi&lt;/option&gt; &lt;textarea&gt; ÂÖÉÁ¥†ÂÆö‰πâÂ§öË°åËæìÂÖ•Â≠óÊÆµÔºàÊñáÊú¨ÂüüÔºâ: 123&lt;textarea name="message" rows="10" cols="30"&gt;The cat was playing in the garden.&lt;/textarea&gt; HTML Input Â±ûÊÄßvalue Â±ûÊÄßËßÑÂÆöËæìÂÖ•Â≠óÊÆµÁöÑÂàùÂßãÂÄºÔºö 1234567&lt;form action=""&gt; First name:&lt;br&gt;&lt;input type="text" name="firstname" value="John"&gt;&lt;br&gt; Last name:&lt;br&gt;&lt;input type="text" name="lastname"&gt;&lt;/form&gt; readonly Â±ûÊÄßËßÑÂÆöËæìÂÖ•Â≠óÊÆµ‰∏∫Âè™ËØª: 1234567&lt;form action=""&gt; First name:&lt;br&gt;&lt;input type="text" name="firstname" value="John" readonly&gt;&lt;br&gt; Last name:&lt;br&gt;&lt;input type="text" name="lastname"&gt;&lt;/form&gt; disabled Â±ûÊÄßËßÑÂÆöËæìÂÖ•Â≠óÊÆµÊòØÁ¶ÅÁî®ÁöÑ„ÄÇË¢´Á¶ÅÁî®ÁöÑÂÖÉÁ¥†ÊòØ‰∏çÂèØÁî®Âíå‰∏çÂèØÁÇπÂáªÁöÑ„ÄÇË¢´Á¶ÅÁî®ÁöÑÂÖÉÁ¥†‰∏ç‰ºöË¢´Êèê‰∫§„ÄÇ 1234567&lt;form action=""&gt; First name:&lt;br&gt;&lt;input type="text" name="firstname" value="John" disabled&gt;&lt;br&gt; Last name:&lt;br&gt;&lt;input type="text" name="lastname"&gt;&lt;/form&gt; size Â±ûÊÄßËßÑÂÆöËæìÂÖ•Â≠óÊÆµÁöÑÂ∞∫ÂØ∏Ôºà‰ª•Â≠óÁ¨¶ËÆ°ÔºâÔºö 1234567&lt;form action=""&gt; First name:&lt;br&gt;&lt;input type="text" name="firstname" value="John" size="40"&gt;&lt;br&gt; Last name:&lt;br&gt;&lt;input type="text" name="lastname"&gt;&lt;/form&gt; maxlength Â±ûÊÄßËßÑÂÆöËæìÂÖ•Â≠óÊÆµÂÖÅËÆ∏ÁöÑÊúÄÂ§ßÈïøÂ∫¶ÔºåËØ•Â±ûÊÄß‰∏ç‰ºöÊèê‰æõ‰ªª‰ΩïÂèçÈ¶à„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÊèêÈÜíÁî®Êà∑ÔºåÂàôÂøÖÈ°ªÁºñÂÜô JavaScript ‰ª£Á†ÅÔºö 1234567&lt;form action=""&gt; First name:&lt;br&gt;&lt;input type="text" name="firstname" maxlength="10"&gt;&lt;br&gt; Last name:&lt;br&gt;&lt;input type="text" name="lastname"&gt;&lt;/form&gt; HTML labelÊ†áÁ≠ælabelÊ†áÁ≠æ‰∏ç‰ºöÂêëÁî®Êà∑ÂëàÁé∞‰ªª‰ΩïÁâπÊÆäÊïàÊûúÔºåÂÆÉÁöÑ‰ΩúÁî®ÊòØ‰∏∫Èº†Ê†áÁî®Êà∑ÊîπËøõ‰∫ÜÂèØÁî®ÊÄß„ÄÇÂ¶ÇÊûú‰Ω†Âú® label Ê†áÁ≠æÂÜÖÁÇπÂáªÊñáÊú¨ÔºåÂ∞±‰ºöËß¶ÂèëÊ≠§Êéß‰ª∂„ÄÇÂ∞±ÊòØËØ¥ÔºåÂΩìÁî®Êà∑ÂçïÂáªÈÄâ‰∏≠ËØ•labelÊ†áÁ≠æÊó∂ÔºåÊµèËßàÂô®Â∞±‰ºöËá™Âä®Â∞ÜÁÑ¶ÁÇπËΩ¨Âà∞ÂíåÊ†áÁ≠æÁõ∏ÂÖ≥ÁöÑË°®ÂçïÊéß‰ª∂‰∏äÔºàÂ∞±Ëá™Âä®ÈÄâ‰∏≠ÂíåËØ•labelÊ†áÁ≠æÁõ∏ÂÖ≥ËøûÁöÑË°®ÂçïÊéß‰ª∂‰∏äÔºâ„ÄÇ ËØ≠Ê≥ïÔºö&lt;label for=&quot;Êéß‰ª∂idÂêçÁß∞&quot;&gt; 123456789&lt;form&gt; &lt;label for="male"&gt;Áî∑&lt;/label&gt; &lt;input type="radio" name="gender" id="male" /&gt; &lt;br /&gt; &lt;label for="female"&gt;Â•≥&lt;/label&gt; &lt;input type="radio" name="gender" id="female" /&gt; &lt;label for="email"&gt;ËæìÂÖ•‰Ω†ÁöÑÈÇÆÁÆ±Âú∞ÂùÄ&lt;/label&gt; &lt;input type="email" id="email" placeholder="Enter email"&gt;&lt;/form&gt; CSSCSS Âü∫Á°ÄËØ≠Ê≥ïCSS ÁöÑÂ£∞ÊòéÊñπÂºèÔºö 1selector &#123;property: value; property: value; property: value&#125; Â¶ÇÊûúÊòØËã•Âπ≤ÂçïËØçÔºåÈúÄË¶ÅÁªôÂÄºÂä†‰∏äÂºïÂè∑ÔºåÂÄº‰πãÂâçÊúÄÂ•ΩÂä†‰∏™ÂÜíÂè∑Ôºå‰∏ÄË°åÊúÄÂ•ΩÂè™ÂÜô‰∏Ä‰∏™Â±ûÊÄßÔºö 1234h1 &#123; color: red; font-size: 14px; font-family: "sans serif";&#125; CSS È´òÁ∫ßËØ≠Ê≥ïÂèØ‰ª•ÂØπÈÄâÊã©Âô®ËøõË°åÂàÜÁªÑÔºåË¢´ÂàÜÁªÑÁöÑÈÄâÊã©Âô®Â∞±ÂèØ‰ª•ÂàÜ‰∫´Áõ∏ÂêåÁöÑÂ£∞ÊòéÔºö 123h1,h2,h3,h4,h5,h6 &#123; color: green;&#125; CSS Ê¥æÁîüÈÄâÊã©Âô®ÈÄöËøá‰æùÊçÆÂÖÉÁ¥†Âú®ÂÖ∂‰ΩçÁΩÆÁöÑ‰∏ä‰∏ãÊñáÂÖ≥Á≥ªÊù•ÂÆö‰πâÊ†∑ÂºèÔºå‰Ω†ÂèØ‰ª•‰ΩøÊ†áËÆ∞Êõ¥Âä†ÁÆÄÊ¥ÅÔºö 1234li strong &#123; font-style: italic; font-weight: normal;&#125; ËøôÊ†∑Âè™Êúâ li ‰∏≠ÁöÑ strong ÊâçÊòØÂ¶Ç‰∏äÁöÑÂÆö‰πâÔºö 123456&lt;p&gt;&lt;strong&gt;ÊàëÊòØÁ≤ó‰ΩìÂ≠óÔºå‰∏çÊòØÊñú‰ΩìÂ≠óÔºåÂõ†‰∏∫Êàë‰∏çÂú®ÂàóË°®ÂΩì‰∏≠ÔºåÊâÄ‰ª•Ëøô‰∏™ËßÑÂàôÂØπÊàë‰∏çËµ∑‰ΩúÁî®&lt;/strong&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;strong&gt;ÊàëÊòØÊñú‰ΩìÂ≠ó„ÄÇËøôÊòØÂõ†‰∏∫ strong ÂÖÉÁ¥†‰Ωç‰∫é li ÂÖÉÁ¥†ÂÜÖ„ÄÇ&lt;/strong&gt;&lt;/li&gt;&lt;li&gt;ÊàëÊòØÊ≠£Â∏∏ÁöÑÂ≠ó‰Ωì„ÄÇ&lt;/li&gt;&lt;/ol&gt; id ÈÄâÊã©Âô®id ÈÄâÊã©Âô®ÂèØ‰ª•‰∏∫Ê†áÊúâÁâπÂÆö id ÁöÑ HTML ÂÖÉÁ¥†ÊåáÂÆöÁâπÂÆöÁöÑÊ†∑Âºè„ÄÇid ÈÄâÊã©Âô®‰ª• # Êù•ÂÆö‰πâ: 12#red &#123;color:red;&#125;#green &#123;color:green;&#125; 12&lt;p id="red"&gt;Ëøô‰∏™ÊÆµËêΩÊòØÁ∫¢Ëâ≤„ÄÇ&lt;/p&gt;&lt;p id="green"&gt;Ëøô‰∏™ÊÆµËêΩÊòØÁªøËâ≤„ÄÇ&lt;/p&gt; id Â±ûÊÄßÂè™ËÉΩÂú®ÊØè‰∏™ HTML ÊñáÊ°£‰∏≠Âá∫Áé∞‰∏ÄÊ¨° Âú®Áé∞‰ª£Â∏ÉÂ±Ä‰∏≠Ôºåid ÈÄâÊã©Âô®Â∏∏Â∏∏Áî®‰∫éÂª∫Á´ãÊ¥æÁîüÈÄâÊã©Âô®: 12345#sidebar p &#123; font-style: italic; text-align: right; margin-top: 0.5em; &#125; ‰∏éÈ°µÈù¢‰∏≠ÁöÑÂÖ∂‰ªñ p ÂÖÉÁ¥†ÊòéÊòæ‰∏çÂêåÁöÑÊòØÔºåsidebar ÂÜÖÁöÑ p ÂÖÉÁ¥†ÂæóÂà∞‰∫ÜÁâπÊÆäÁöÑÂ§ÑÁêÜ CSS Á±ªÈÄâÊã©Âô®Á±ªÈÄâÊã©Âô®‰ª•‰∏Ä‰∏™ÁÇπÂè∑ÊòæÁ§∫Ôºö 1.center &#123;text-align: center&#125; 1234567&lt;h1 class="center"&gt;This heading will be center-aligned&lt;/h1&gt;&lt;p class="center"&gt;This paragraph will also be center-aligned.&lt;/p&gt; Âíå id ‰∏ÄÊ†∑Ôºåclass ‰πüÂèØË¢´Áî®‰ΩúÊ¥æÁîüÈÄâÊã©Âô®ÔºåÊ≠§‰æã‰∏≠Á±ªÂêç‰∏∫ fancy ÁöÑÊõ¥Â§ßÁöÑÂÖÉÁ¥†ÂÜÖÈÉ®ÁöÑË°®Ê†ºÂçïÂÖÉÈÉΩ‰ºö‰ª•ÁÅ∞Ëâ≤ËÉåÊôØÊòæÁ§∫Ê©ôËâ≤ÊñáÂ≠óÔºö 1234.fancy td &#123; color: #f60; background: #666; &#125; ÂÖÉÁ¥†‰πüÂèØ‰ª•Âü∫‰∫éÂÆÉ‰ª¨ÁöÑÁ±ªËÄåË¢´ÈÄâÊã©Ôºå‰ªª‰ΩïÂÖ∂‰ªñË¢´Ê†áÊ≥®‰∏∫ fancy ÁöÑÂÖÉÁ¥†‰∏ç‰ºöÂèóËøôÊù°ËßÑÂàôÁöÑÂΩ±ÂìçÔºö 1234td.fancy &#123; color: #f60; background: #666; &#125; 1&lt;td class="fancy"&gt; CSS Â≠êÈÄâÊã©Âô®Â≠êÈÄâÊã©Âô®ÔºåÂ§ß‰∫éÁ¨¶Âè∑(&gt;)ÔºåÁî®‰∫éÈÄâÊã©ÊåáÂÆöÊ†áÁ≠æÂÖÉÁ¥†ÁöÑÁ¨¨‰∏Ä‰ª£Â≠êÂÖÉÁ¥† 1.food&gt;li&#123;border:1px solid red;&#125; Ëøô‰∏™ÊòØÁ±ªÂûã‰∏ãÈù¢ÁöÑÂÖÉÁ¥†ÔºåÊ¥æÁîüÈÄâÊã©Âô®ÊòØÂÖÉÁ¥†‰∏ãÈù¢ÁöÑÂÖÉÁ¥† CSS ÂåÖÂê´(Âêé‰ª£)ÈÄâÊã©Âô®ÂåÖÂê´ÈÄâÊã©Âô®ÔºåÂç≥Âä†ÂÖ•Á©∫Ê†º,Áî®‰∫éÈÄâÊã©ÊåáÂÆöÊ†áÁ≠æÂÖÉÁ¥†‰∏ãÁöÑÂêéËæàÂÖÉÁ¥†Ôºö 1.first span&#123;color:red;&#125; &gt;‰ΩúÁî®‰∫éÂÖÉÁ¥†ÁöÑÁ¨¨‰∏Ä‰ª£Âêé‰ª£ÔºåÁ©∫Ê†º‰ΩúÁî®‰∫éÂÖÉÁ¥†ÁöÑÊâÄÊúâÂêé‰ª£„ÄÇ CSS ÈÄöÁî®ÈÄâÊã©Âô®ÂÆÉ‰ΩøÁî®‰∏Ä‰∏™Ôºà*ÔºâÂè∑ÊåáÂÆöÔºåÂÆÉÁöÑ‰ΩúÁî®ÊòØÂåπÈÖçhtml‰∏≠ÊâÄÊúâÊ†áÁ≠æÂÖÉÁ¥†Ôºö 1* &#123;color:red;&#125; CSS Â±ûÊÄßÈÄâÊã©Âô®‰∏∫Êã•ÊúâÊåáÂÆöÂ±ûÊÄßÁöÑ HTML ÂÖÉÁ¥†ËÆæÁΩÆÊ†∑ÂºèÔºåËÄå‰∏ç‰ªÖÈôê‰∫é class Âíå id Â±ûÊÄß„ÄÇ‰∏ãÈù¢ÁöÑ‰æãÂ≠ê‰∏∫Â∏¶Êúâ title Â±ûÊÄßÁöÑÊâÄÊúâÂÖÉÁ¥†ËÆæÁΩÆÊ†∑ÂºèÔºö 123[title] &#123; color:red;&#125; ‰∏ãÈù¢ÁöÑ‰æãÂ≠ê‰∏∫ title=&quot;W3School&quot; ÁöÑÊâÄÊúâÂÖÉÁ¥†ËÆæÁΩÆÊ†∑ÂºèÔºö 123[title=W3School] &#123; border:5px solid blue;&#125; Â±ûÊÄßÈÄâÊã©Âô®Âú®‰∏∫‰∏çÂ∏¶Êúâ class Êàñ id ÁöÑË°®ÂçïËÆæÁΩÆÊ†∑ÂºèÊó∂ÁâπÂà´ÊúâÁî®Ôºö 12345678910111213141516input[type="text"]&#123; width:150px; display:block; margin-bottom:10px; background-color:yellow; font-family: Verdana, Arial;&#125;input[type="button"]&#123; width:120px; margin-left:35px; display:block; font-family: Verdana, Arial;&#125; CSS ÁªßÊâøCSSÁöÑÊüê‰∫õÊ†∑ÂºèÊòØÂÖ∑ÊúâÁªßÊâøÊÄßÁöÑÔºåÂÆÉÂÖÅËÆ∏Ê†∑Âºè‰∏ç‰ªÖÂ∫îÁî®‰∫éÊüê‰∏™ÁâπÂÆöhtmlÊ†áÁ≠æÂÖÉÁ¥†ÔºåËÄå‰∏îÂ∫îÁî®‰∫éÂÖ∂Âêé‰ª£„ÄÇÂ¶ÇÊüêÁßçÈ¢úËâ≤Â∫îÁî®‰∫épÊ†áÁ≠æÔºåËøô‰∏™È¢úËâ≤ËÆæÁΩÆ‰∏ç‰ªÖÂ∫îÁî®pÊ†áÁ≠æÔºåËøòÂ∫îÁî®‰∫épÊ†áÁ≠æ‰∏≠ÁöÑÊâÄÊúâÂ≠êÂÖÉÁ¥†ÊñáÊú¨ÔºåËøôÈáåÂ≠êÂÖÉÁ¥†‰∏∫spanÊ†áÁ≠æÔºö 1p&#123;color:red;&#125; 1&lt;p&gt;‰∏âÂπ¥Á∫ßÊó∂ÔºåÊàëËøòÊòØ‰∏Ä‰∏™&lt;span&gt;ËÉÜÂ∞èÂ¶ÇÈº†&lt;/span&gt;ÁöÑÂ∞èÂ•≥Â≠©„ÄÇ&lt;/p&gt; ‰ΩÜÊ≥®ÊÑèÊúâ‰∏Ä‰∫õcssÊ†∑ÂºèÊòØ‰∏çÂÖ∑ÊúâÁªßÊâøÊÄßÁöÑ„ÄÇÂ¶Ç border:1px solid red; CSS ÂàõÂª∫ÊèíÂÖ•Ê†∑ÂºèË°®ÁöÑÊñπÊ≥ïÊúâ‰∏âÁßçÔºö Â§ñÈÉ®Ê†∑ÂºèË°®ÔºöÂΩìÊ†∑ÂºèÈúÄË¶ÅÂ∫îÁî®‰∫éÂæàÂ§öÈ°µÈù¢Êó∂ÔºåÂ§ñÈÉ®Ê†∑ÂºèË°®Â∞ÜÊòØÁêÜÊÉ≥ÁöÑÈÄâÊã©„ÄÇÂú®‰ΩøÁî®Â§ñÈÉ®Ê†∑ÂºèË°®ÁöÑÊÉÖÂÜµ‰∏ãÔºå‰Ω†ÂèØ‰ª•ÈÄöËøáÊîπÂèò‰∏Ä‰∏™Êñá‰ª∂Êù•ÊîπÂèòÊï¥‰∏™Á´ôÁÇπÁöÑÂ§ñËßÇ„ÄÇÊØè‰∏™È°µÈù¢‰ΩøÁî® &lt;link&gt; Ê†áÁ≠æÈìæÊé•Âà∞Ê†∑ÂºèË°®„ÄÇ&lt;link&gt; Ê†áÁ≠æÂú®ÔºàÊñáÊ°£ÁöÑÔºâÂ§¥ÈÉ®Ôºö 123&lt;head&gt;&lt;link rel="stylesheet" type="text/css" href="mystyle.css" /&gt;&lt;/head&gt; ÂÜÖÈÉ®Ê†∑ÂºèË°®:ÂΩìÂçï‰∏™ÊñáÊ°£ÈúÄË¶ÅÁâπÊÆäÁöÑÊ†∑ÂºèÊó∂ÔºåÂ∞±Â∫îËØ•‰ΩøÁî®ÂÜÖÈÉ®Ê†∑ÂºèË°®„ÄÇ‰Ω†ÂèØ‰ª•‰ΩøÁî® &lt;style&gt; Ê†áÁ≠æÂú®ÊñáÊ°£Â§¥ÈÉ®ÂÆö‰πâÂÜÖÈÉ®Ê†∑ÂºèË°®ÔºåÂ∞±ÂÉèËøôÊ†∑: 1234567&lt;head&gt;&lt;style type="text/css"&gt; hr &#123;color: sienna;&#125; p &#123;margin-left: 20px;&#125; body &#123;background-image: url("images/back40.gif");&#125;&lt;/style&gt;&lt;/head&gt; ÂÜÖËÅîÊ†∑Âºè:Áî±‰∫éË¶ÅÂ∞ÜË°®Áé∞ÂíåÂÜÖÂÆπÊ∑∑ÊùÇÂú®‰∏ÄËµ∑ÔºåÂÜÖËÅîÊ†∑Âºè‰ºöÊçüÂ§±ÊéâÊ†∑ÂºèË°®ÁöÑËÆ∏Â§ö‰ºòÂäø„ÄÇËØ∑ÊÖéÁî®ËøôÁßçÊñπÊ≥ïÔºå‰æãÂ¶ÇÂΩìÊ†∑Âºè‰ªÖÈúÄË¶ÅÂú®‰∏Ä‰∏™ÂÖÉÁ¥†‰∏äÂ∫îÁî®‰∏ÄÊ¨°Êó∂„ÄÇË¶Å‰ΩøÁî®ÂÜÖËÅîÊ†∑ÂºèÔºå‰Ω†ÈúÄË¶ÅÂú®Áõ∏ÂÖ≥ÁöÑÊ†áÁ≠æÂÜÖ‰ΩøÁî®Ê†∑ÂºèÔºàstyleÔºâÂ±ûÊÄß„ÄÇStyle Â±ûÊÄßÂèØ‰ª•ÂåÖÂê´‰ªª‰Ωï CSS Â±ûÊÄßÔºö 123&lt;p style="color: sienna; margin-left: 20px"&gt;This is a paragraph&lt;/p&gt; CSS Ê≥®ÈáäÂíå html ÁöÑÊ≥®Èáä‰∏çÂêåÔºåcss ÁöÑ‰ΩøÁî® /*‚Ä¶*/ Ê≥®Èáä 12345/* Ê≥®Èáä */p&#123; font-size:12px; color:red;&#125; ‰∏Ä‰∫õÂ∏∏Áî®ÁöÑ CSS Â±ûÊÄß1234567891011body&#123; font-size:12px; color:#666; font-weight:bold; font-style:italic; text-decoration:underline; text-indent:2em; line-height:1.5em; letter-spacing:50px; text-align:center;&#125; CSS ËæπÊ°ÜÁöÑ‰∏Ä‰∫õÂ±ûÊÄß12345div&#123; border-width:2px; border-style:solid; border-color:red;&#125; CSS ÂÜÖËæπË∑ùpadding Â±ûÊÄßÂÆö‰πâÂÖÉÁ¥†ÁöÑÂÜÖËæπË∑ùÔºö 1h1 &#123;padding: 10px;&#125; ËøòÂèØ‰ª•ÊåâÁÖß‰∏ä„ÄÅÂè≥„ÄÅ‰∏ã„ÄÅÂ∑¶ÁöÑÈ°∫Â∫èÂàÜÂà´ËÆæÁΩÆÂêÑËæπÁöÑÂÜÖËæπË∑ùÔºåÂêÑËæπÂùáÂèØ‰ª•‰ΩøÁî®‰∏çÂêåÁöÑÂçï‰ΩçÊàñÁôæÂàÜÊØîÂÄºÔºö 123456h1 &#123; padding-top: 10px; padding-right: 0.25em; padding-bottom: 2ex; padding-left: 20%; &#125; ÁôæÂàÜÊï∞ÂÄºÊòØÁõ∏ÂØπ‰∫éÂÖ∂Áà∂ÂÖÉÁ¥†ÁöÑ width ËÆ°ÁÆóÁöÑÔºåËøô‰∏ÄÁÇπ‰∏éÂ§ñËæπË∑ù‰∏ÄÊ†∑„ÄÇÊâÄ‰ª•ÔºåÂ¶ÇÊûúÁà∂ÂÖÉÁ¥†ÁöÑ width ÊîπÂèòÔºåÂÆÉ‰ª¨‰πü‰ºöÊîπÂèò„ÄÇ CSS Â§ñËæπË∑ùËÆæÁΩÆÂ§ñËæπË∑ùÁöÑÊúÄÁÆÄÂçïÁöÑÊñπÊ≥ïÂ∞±ÊòØ‰ΩøÁî® margin Â±ûÊÄß„ÄÇ 1h1 &#123;margin : 0.25in;&#125; ‰∏Ä‰∏™ËßÑÂàô‰∏≠ÂèØ‰ª•‰ΩøÁî®Â§ö‰∏™ËøôÁßçÂçïËæπÂ±ûÊÄß: 123456h2 &#123; margin-top: 20px; margin-right: 30px; margin-bottom: 30px; margin-left: 20px;&#125; CSS Â§ñËæπË∑ùÂêàÂπ∂Â§ñËæπË∑ùÂêàÂπ∂ÊåáÁöÑÊòØÔºåÂΩì‰∏§‰∏™ÂûÇÁõ¥Â§ñËæπË∑ùÁõ∏ÈÅáÊó∂ÔºåÂÆÉ‰ª¨Â∞ÜÂΩ¢Êàê‰∏Ä‰∏™Â§ñËæπË∑ù„ÄÇÂêàÂπ∂ÂêéÁöÑÂ§ñËæπË∑ùÁöÑÈ´òÂ∫¶Á≠â‰∫é‰∏§‰∏™ÂèëÁîüÂêàÂπ∂ÁöÑÂ§ñËæπË∑ùÁöÑÈ´òÂ∫¶‰∏≠ÁöÑËæÉÂ§ßËÄÖ„ÄÇ Â§ñËæπË∑ùÂêàÂπ∂ÂàùÁúã‰∏äÂéªÂèØËÉΩÊúâÁÇπÂ•áÊÄ™Ôºå‰ΩÜÊòØÂÆûÈôÖ‰∏äÔºåÂÆÉÊòØÊúâÊÑè‰πâÁöÑ„ÄÇ‰ª•Áî±Âá†‰∏™ÊÆµËêΩÁªÑÊàêÁöÑÂÖ∏ÂûãÊñáÊú¨È°µÈù¢‰∏∫‰æã„ÄÇÁ¨¨‰∏Ä‰∏™ÊÆµËêΩ‰∏äÈù¢ÁöÑÁ©∫Èó¥Á≠â‰∫éÊÆµËêΩÁöÑ‰∏äÂ§ñËæπË∑ù„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÂ§ñËæπË∑ùÂêàÂπ∂ÔºåÂêéÁª≠ÊâÄÊúâÊÆµËêΩ‰πãÈó¥ÁöÑÂ§ñËæπË∑ùÈÉΩÂ∞ÜÊòØÁõ∏ÈÇª‰∏äÂ§ñËæπË∑ùÂíå‰∏ãÂ§ñËæπË∑ùÁöÑÂíå„ÄÇËøôÊÑèÂë≥ÁùÄÊÆµËêΩ‰πãÈó¥ÁöÑÁ©∫Èó¥ÊòØÈ°µÈù¢È°∂ÈÉ®ÁöÑ‰∏§ÂÄç„ÄÇÂ¶ÇÊûúÂèëÁîüÂ§ñËæπË∑ùÂêàÂπ∂ÔºåÊÆµËêΩ‰πãÈó¥ÁöÑ‰∏äÂ§ñËæπË∑ùÂíå‰∏ãÂ§ñËæπË∑ùÂ∞±ÂêàÂπ∂Âú®‰∏ÄËµ∑ÔºåËøôÊ†∑ÂêÑÂ§ÑÁöÑË∑ùÁ¶ªÂ∞±‰∏ÄËá¥‰∫Ü„ÄÇ Âè™ÊúâÊôÆÈÄöÊñáÊ°£ÊµÅ‰∏≠ÂùóÊ°ÜÁöÑÂûÇÁõ¥Â§ñËæπË∑ùÊâç‰ºöÂèëÁîüÂ§ñËæπË∑ùÂêàÂπ∂„ÄÇË°åÂÜÖÊ°Ü„ÄÅÊµÆÂä®Ê°ÜÊàñÁªùÂØπÂÆö‰Ωç‰πãÈó¥ÁöÑÂ§ñËæπË∑ù‰∏ç‰ºöÂêàÂπ∂„ÄÇ CSS ‰ª£Á†ÅÁº©ÂÜô‰∏çËÆ∫ÊòØ padding ËøòÊòØ margin ÈÉΩÂèØ‰ª•ÁÆÄÂÜôÔºåÈ°∫Â∫è‰∏∫ ‰∏äÂè≥‰∏ãÂ∑¶Ôºö 1234p&#123; padding:13px 13px 13px 13px; margin:10px 40px 10px 40px;&#125; ÂÖ≥‰∫éÂ≠ó‰Ωì‰πüÊúâÂæàÂ§öÂ±ûÊÄßÂèØ‰ª•ËøõË°åÁº©ÂÜôÔºö 123456789101112body&#123; font-style:italic; font-variant:small-caps; font-weight:bold; font-size:12px; line-height:1.5em; font-family:"ÂÆã‰Ωì",sans-serif;&#125;=&gt;body&#123; font:italic small-caps bold 12px/1.5em "ÂÆã‰Ωì",sans-serif;&#125; Âú®Áº©ÂÜôÊó∂ font-size ‰∏é line-height ‰∏≠Èó¥Ë¶ÅÂä†ÂÖ•‚Äú/‚ÄùÊñúÊâõ„ÄÇ‰∏çÁÑ∂ÊµèËßàÂô®Êó†Ê≥ïÁü•ÈÅìÂì™‰∏™ÊòØ size Âì™‰∏™ÊòØ height CSS Áõ∏ÂØπÂÆö‰ΩçËÆæÁΩÆ‰∏∫Áõ∏ÂØπÂÆö‰ΩçÁöÑÂÖÉÁ¥†Ê°Ü‰ºöÂÅèÁßªÊüê‰∏™Ë∑ùÁ¶ª„ÄÇÂÖÉÁ¥†‰ªçÁÑ∂‰øùÊåÅÂÖ∂Êú™ÂÆö‰ΩçÂâçÁöÑÂΩ¢Áä∂ÔºåÂÆÉÂéüÊú¨ÊâÄÂç†ÁöÑÁ©∫Èó¥‰ªç‰øùÁïô„ÄÇ 12345#box_relative &#123; position: relative; left: 30px; top: 20px;&#125; Âú®‰ΩøÁî®Áõ∏ÂØπÂÆö‰ΩçÊó∂ÔºåÊó†ËÆ∫ÊòØÂê¶ËøõË°åÁßªÂä®ÔºåÂÖÉÁ¥†‰ªçÁÑ∂Âç†ÊçÆÂéüÊù•ÁöÑÁ©∫Èó¥„ÄÇÂõ†Ê≠§ÔºåÁßªÂä®ÂÖÉÁ¥†‰ºöÂØºËá¥ÂÆÉË¶ÜÁõñÂÖ∂ÂÆÉÊ°Ü„ÄÇ CSS ÁªùÂØπÂÆö‰ΩçËÆæÁΩÆ‰∏∫ÁªùÂØπÂÆö‰ΩçÁöÑÂÖÉÁ¥†Ê°Ü‰ªéÊñáÊ°£ÊµÅÂÆåÂÖ®Âà†Èô§ÔºåÂπ∂Áõ∏ÂØπ‰∫éÂÖ∂ÂåÖÂê´ÂùóÂÆö‰ΩçÔºåÂåÖÂê´ÂùóÂèØËÉΩÊòØÊñáÊ°£‰∏≠ÁöÑÂè¶‰∏Ä‰∏™ÂÖÉÁ¥†ÊàñËÄÖÊòØÂàùÂßãÂåÖÂê´Âùó„ÄÇÂÖÉÁ¥†ÂéüÂÖàÂú®Ê≠£Â∏∏ÊñáÊ°£ÊµÅ‰∏≠ÊâÄÂç†ÁöÑÁ©∫Èó¥‰ºöÂÖ≥Èó≠ÔºåÂ∞±Â•ΩÂÉèËØ•ÂÖÉÁ¥†ÂéüÊù•‰∏çÂ≠òÂú®‰∏ÄÊ†∑„ÄÇÂÖÉÁ¥†ÂÆö‰ΩçÂêéÁîüÊàê‰∏Ä‰∏™ÂùóÁ∫ßÊ°ÜÔºåËÄå‰∏çËÆ∫ÂéüÊù•ÂÆÉÂú®Ê≠£Â∏∏ÊµÅ‰∏≠ÁîüÊàê‰ΩïÁßçÁ±ªÂûãÁöÑÊ°Ü„ÄÇ 12345#box_relative &#123; position: absolute; left: 30px; top: 20px;&#125; Â∞èÊäÄÂ∑ßÔºöÂ¶ÇÊûúÊúâ‰∏Ä‰∏™ÂÖÉÁ¥†Ë¶ÅÊîæÂú®Âè¶‰∏Ä‰∏™ÂÖÉÁ¥†‰∏≠ÔºåÊØîÂ¶ÇÂõæÁâá‰∏äË¶ÅÈò≤ÊîæÁΩÆ‰∏ÄË°åÊñáÂ≠óÔºåÈÇ£‰πàÂèØ‰ª•Â∞ÜÊñáÂ≠óËÆæÁΩÆ‰∏∫ÁªùÂØπÂÆö‰ΩçÔºåÊîæÁΩÆÂú®ÂõæÁâáÊâÄÂú®ÁöÑÂùó‰∏≠ÔºåÊ≥®ÊÑèÔºåÂèÇÁÖßÂÆö‰ΩçÁöÑÂÖÉÁ¥†ÂøÖÈ°ªÂä†ÂÖ• position:relative;Ôºö 12345678910#box1&#123; width:200px; height:200px; position:relative; // Ëøô‰∏™‰∏ÄÂÆöË¶ÅÊúâ &#125;#box2&#123; position:absolute; top:20px; left:30px;&#125; 123&lt;div id="box1"&gt; &lt;div id="box2"&gt;Áõ∏ÂØπÂèÇÁÖßÂÖÉÁ¥†ËøõË°åÂÆö‰Ωç&lt;/div&gt;&lt;/div&gt; ÁªùÂØπÂÆö‰ΩçÁöÑÂÖÉÁ¥†ÁöÑ‰ΩçÁΩÆÁõ∏ÂØπ‰∫éÊúÄËøëÁöÑÂ∑≤ÂÆö‰ΩçÁ•ñÂÖàÂÖÉÁ¥†ÔºåÂ¶ÇÊûúÂÖÉÁ¥†Ê≤°ÊúâÂ∑≤ÂÆö‰ΩçÁöÑÁ•ñÂÖàÂÖÉÁ¥†ÔºåÈÇ£‰πàÂÆÉÁöÑ‰ΩçÁΩÆÁõ∏ÂØπ‰∫éÊúÄÂàùÁöÑÂåÖÂê´Âùó„ÄÇ CSS ÊµÆÂä®ÊµÆÂä®ÁöÑÊ°ÜÂèØ‰ª•ÂêëÂ∑¶ÊàñÂêëÂè≥ÁßªÂä®ÔºåÁõ¥Âà∞ÂÆÉÁöÑÂ§ñËæπÁºòÁ¢∞Âà∞ÂåÖÂê´Ê°ÜÊàñÂè¶‰∏Ä‰∏™ÊµÆÂä®Ê°ÜÁöÑËæπÊ°Ü‰∏∫Ê≠¢„ÄÇ 123456789101112.news &#123; background-color: gray; border: solid 1px black; &#125;.news img &#123; float: left; &#125;.news p &#123; clear:both; &#125; 1234&lt;div class="news"&gt;&lt;img src="news-pic.jpg" /&gt;&lt;p&gt;some text&lt;/p&gt;&lt;/div&gt; ÊµÆÂä®Ê°Ü‰ºöÂΩ±ÂìçÂêé‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå‰ΩøÂÖ∂‰∏éËá™Ë∫´Âú®Âêå‰∏ÄË°å‰∏≠„ÄÇ‰∏äÈù¢‰æãÂ≠ê‰∏≠Ôºå&lt;p&gt; Â∞±‰ºöÂíå‰∏§‰∏™ÊµÆÂä®Ê°ÜÂú®Âêå‰∏ÄË°å‰∏≠ÔºåÂ¶ÇÊûú‰∏çÊÉ≥ËÆ©&lt;p&gt; ÂèóÂà∞ÊµÆÂä®ÁöÑÂΩ±ÂìçÔºåÂè¶Ëµ∑‰∏ÄË°åÔºåÈúÄË¶Å‰ΩøÁî® clear Â±ûÊÄß„ÄÇ ÊµÆÂä®ÁöÑ‰ΩúÁî®ÊòØÂÆûÁé∞ÊñáÂ≠óÁéØÁªïÊïàÊûú‰∏ÄËà¨ÂèØ‰ª•Áî®ÂÖ∂ÂÆûÁé∞‰∏§Ê†è CSS ÂÖÉÁ¥†ÂàÜÁ±ª12345678Â∏∏Áî®ÁöÑÂùóÁä∂ÂÖÉÁ¥†ÊúâÔºö&lt;div&gt;„ÄÅ&lt;p&gt;„ÄÅ&lt;h1&gt;...&lt;h6&gt;„ÄÅ&lt;ol&gt;„ÄÅ&lt;ul&gt;„ÄÅ&lt;dl&gt;„ÄÅ&lt;table&gt;„ÄÅ&lt;address&gt;„ÄÅ&lt;blockquote&gt; „ÄÅ&lt;form&gt;Â∏∏Áî®ÁöÑÂÜÖËÅîÂÖÉÁ¥†ÊúâÔºö&lt;a&gt;„ÄÅ&lt;span&gt;„ÄÅ&lt;br&gt;„ÄÅ&lt;i&gt;„ÄÅ&lt;em&gt;„ÄÅ&lt;strong&gt;„ÄÅ&lt;label&gt;„ÄÅ&lt;q&gt;„ÄÅ&lt;var&gt;„ÄÅ&lt;cite&gt;„ÄÅ&lt;code&gt;Â∏∏Áî®ÁöÑÂÜÖËÅîÂùóÁä∂ÂÖÉÁ¥†ÊúâÔºö&lt;img&gt;„ÄÅ&lt;input&gt; ËÆæÁΩÆ display:block Â∞±ÊòØÂ∞ÜÂÖÉÁ¥†ÊòæÁ§∫‰∏∫ÂùóÁ∫ßÂÖÉÁ¥†„ÄÇÂ¶Ç‰∏ã‰ª£Á†ÅÂ∞±ÊòØÂ∞ÜÂÜÖËÅîÂÖÉÁ¥† &lt;a&gt; ËΩ¨Êç¢‰∏∫ÂùóÁä∂ÂÖÉÁ¥†Ôºå‰ªéËÄå‰Ωø &lt;a&gt;ÂÖÉÁ¥†ÂÖ∑ÊúâÂùóÁä∂ÂÖÉÁ¥†ÁâπÁÇπ„ÄÇ 1a &#123;display:block;&#125; ÂùóÁ∫ßÂÖÉÁ¥†ÁöÑÁâπÁÇπÔºöÊØè‰∏™ÂùóÁ∫ßÂÖÉÁ¥†ÈÉΩ‰ªéÊñ∞ÁöÑ‰∏ÄË°åÂºÄÂßãÔºåÂπ∂‰∏îÂÖ∂ÂêéÁöÑÂÖÉÁ¥†‰πüÂè¶Ëµ∑‰∏ÄË°å„ÄÇÂÖÉÁ¥†ÁöÑÈ´òÂ∫¶„ÄÅÂÆΩÂ∫¶„ÄÅË°åÈ´ò‰ª•ÂèäÈ°∂ÂíåÂ∫ïËæπË∑ùÈÉΩÂèØËÆæÁΩÆ„ÄÇÂÖÉÁ¥†ÂÆΩÂ∫¶Âú®‰∏çËÆæÁΩÆÁöÑÊÉÖÂÜµ‰∏ãÔºåÊòØÂÆÉÊú¨Ë∫´Áà∂ÂÆπÂô®ÁöÑ100%ÔºàÂíåÁà∂ÂÖÉÁ¥†ÁöÑÂÆΩÂ∫¶‰∏ÄËá¥ÔºâÔºåÈô§ÈùûËÆæÂÆö‰∏Ä‰∏™ÂÆΩÂ∫¶„ÄÇ ÂΩìÁÑ∂ÂùóÁä∂ÂÖÉÁ¥†‰πüÂèØ‰ª•ÈÄöËøá‰ª£Á†Å display:inline Â∞ÜÂÖÉÁ¥†ËÆæÁΩÆ‰∏∫ÂÜÖËÅîÂÖÉÁ¥†„ÄÇÂ¶Ç‰∏ã‰ª£Á†ÅÂ∞±ÊòØÂ∞ÜÂùóÁä∂ÂÖÉÁ¥† &lt;div&gt; ËΩ¨Êç¢‰∏∫ÂÜÖËÅîÂÖÉÁ¥†Ôºå‰ªéËÄå‰Ωø &lt;div&gt; ÂÖÉÁ¥†ÂÖ∑ÊúâÂÜÖËÅîÂÖÉÁ¥†ÁâπÁÇπ„ÄÇ 1div &#123;display:inline;&#125; ÂÜÖËÅîÂÖÉÁ¥†ÁâπÁÇπÔºöÂíåÂÖ∂‰ªñÂÖÉÁ¥†ÈÉΩÂú®‰∏ÄË°å‰∏äÔºõÂÖÉÁ¥†ÁöÑÈ´òÂ∫¶„ÄÅÂÆΩÂ∫¶ÂèäÈ°∂ÈÉ®ÂíåÂ∫ïÈÉ®ËæπË∑ù‰∏çÂèØËÆæÁΩÆÔºõÂÖÉÁ¥†ÁöÑÂÆΩÂ∫¶Â∞±ÊòØÂÆÉÂåÖÂê´ÁöÑÊñáÂ≠óÊàñÂõæÁâáÁöÑÂÆΩÂ∫¶Ôºå‰∏çÂèØÊîπÂèò„ÄÇ ÂÜÖËÅîÂùóÁä∂ÂÖÉÁ¥†Â∞±ÊòØÂêåÊó∂ÂÖ∑Â§áÂÜÖËÅîÂÖÉÁ¥†„ÄÅÂùóÁä∂ÂÖÉÁ¥†ÁöÑÁâπÁÇπÔºå‰ª£Á†Å display:inline-block Â∞±ÊòØÂ∞ÜÂÖÉÁ¥†ËÆæÁΩÆ‰∏∫ÂÜÖËÅîÂùóÁä∂ÂÖÉÁ¥†„ÄÇ&lt;img&gt;„ÄÅ&lt;input&gt; Ê†áÁ≠æÂ∞±ÊòØËøôÁßçÂÜÖËÅîÂùóÁä∂Ê†áÁ≠æ„ÄÇ ÂÜÖËÅîÂùóÁä∂ÂÖÉÁ¥†ÁâπÁÇπÔºöÂíåÂÖ∂‰ªñÂÖÉÁ¥†ÈÉΩÂú®‰∏ÄË°å‰∏äÔºõÂÖÉÁ¥†ÁöÑÈ´òÂ∫¶„ÄÅÂÆΩÂ∫¶„ÄÅË°åÈ´ò‰ª•ÂèäÈ°∂ÂíåÂ∫ïËæπË∑ùÈÉΩÂèØËÆæÁΩÆ„ÄÇ CSS ÊäÄÂ∑ß‚Äî‚ÄîÊ∞¥Âπ≥Â±Ö‰∏≠Â¶ÇÊûúË¢´ËÆæÁΩÆÂÖÉÁ¥†‰∏∫ÊñáÊú¨„ÄÅÂõæÁâáÁ≠âË°åÂÜÖÂÖÉÁ¥†Êó∂ÔºåÊ∞¥Âπ≥Â±Ö‰∏≠ÊòØÈÄöËøáÁªôÁà∂ÂÖÉÁ¥†ËÆæÁΩÆ text-align:center Êù•ÂÆûÁé∞ÁöÑ„ÄÇ 12345&lt;style&gt; .txtCenter&#123; text-align:center; &#125;&lt;/style&gt; 123&lt;body&gt; &lt;div class="txtCenter"&gt;ÊàëÊÉ≥Ë¶ÅÂú®Áà∂ÂÆπÂô®‰∏≠Ê∞¥Âπ≥Â±Ö‰∏≠ÊòæÁ§∫„ÄÇ&lt;/div&gt;&lt;/body&gt; ÂΩìË¢´ËÆæÁΩÆÂÖÉÁ¥†‰∏∫ ÂùóÁä∂ÂÖÉÁ¥† Êó∂Áî® text-alignÔºöcenter Â∞±‰∏çËµ∑‰ΩúÁî®‰∫ÜÔºåËøôÊó∂‰πüÂàÜ‰∏§ÁßçÊÉÖÂÜµÔºöÂÆöÂÆΩÂùóÁä∂ÂÖÉÁ¥†Âíå‰∏çÂÆöÂÆΩÂùóÁä∂ÂÖÉÁ¥†„ÄÇ Êª°Ë∂≥ÂÆöÂÆΩÂíåÂùóÁä∂‰∏§‰∏™Êù°‰ª∂ÁöÑÂÖÉÁ¥†ÊòØÂèØ‰ª•ÈÄöËøáËÆæÁΩÆ‚ÄúÂ∑¶Âè≥margin‚ÄùÂÄº‰∏∫‚Äúauto‚ÄùÊù•ÂÆûÁé∞Â±Ö‰∏≠ÁöÑ„ÄÇÊàë‰ª¨Êù•Áúã‰∏™‰æãÂ≠êÂ∞±ÊòØËÆæÁΩÆ div Ëøô‰∏™ÂùóÁä∂ÂÖÉÁ¥†Ê∞¥Âπ≥Â±Ö‰∏≠Ôºö 12345678&lt;style&gt;div&#123; border:1px solid red;/*‰∏∫‰∫ÜÊòæÁ§∫Â±Ö‰∏≠ÊïàÊûúÊòéÊòæ‰∏∫ div ËÆæÁΩÆ‰∫ÜËæπÊ°Ü*/ width:200px;/*ÂÆöÂÆΩ*/ margin:20px auto;/* margin-left ‰∏é margin-right ËÆæÁΩÆ‰∏∫ auto */&#125;&lt;/style&gt; 123&lt;body&gt; &lt;div&gt;ÊàëÊòØÂÆöÂÆΩÂùóÁä∂ÂÖÉÁ¥†ÔºåÂìàÂìàÔºåÊàëË¶ÅÊ∞¥Âπ≥Â±Ö‰∏≠ÊòæÁ§∫„ÄÇ&lt;/div&gt;&lt;/body&gt; ‰Ωø‰∏çÂÆöÂÆΩÂùóÁä∂ÂÖÉÁ¥†Ê∞¥Âπ≥Â±Ö‰∏≠ÔºåÂèØ‰ª•ÊîπÂèòÂùóÁ∫ßÂÖÉÁ¥†ÁöÑ display:inline; Á±ªÂûãÔºàËÆæÁΩÆ‰∏∫ Ë°åÂÜÖÂÖÉÁ¥† ÊòæÁ§∫ÔºâÔºåÁÑ∂Âêé‰ΩøÁî® text-align:center Êù•ÂÆûÁé∞Â±Ö‰∏≠ÊïàÊûú„ÄÇÂ¶Ç‰∏ã‰æãÂ≠êÔºö 1234567891011121314151617&lt;style&gt;.container&#123; text-align:center;&#125;/* margin:0;padding:0ÔºàÊ∂àÈô§ÊñáÊú¨‰∏édivËæπÊ°Ü‰πãÈó¥ÁöÑÈó¥ÈöôÔºâ*/.container ul&#123; list-style:none; margin:0; padding:0; display:inline;&#125;/* margin-right:8pxÔºàËÆæÁΩÆliÊñáÊú¨‰πãÈó¥ÁöÑÈó¥ÈöîÔºâ*/.container li&#123; margin-right:8px; display:inline;&#125;&lt;/style&gt; 123456789&lt;body&gt;&lt;div class="container"&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;1&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;2&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;3&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;&lt;/body&gt; CSS ÊäÄÂ∑ß‚Äî‚ÄîÂûÇÁõ¥Â±Ö‰∏≠Áà∂ÂÖÉÁ¥†È´òÂ∫¶Á°ÆÂÆöÁöÑÂçïË°åÊñáÊú¨ÁöÑÁ´ñÁõ¥Â±Ö‰∏≠ÁöÑÊñπÊ≥ïÊòØÈÄöËøáËÆæÁΩÆÁà∂ÂÖÉÁ¥†ÁöÑ height Âíå line-height È´òÂ∫¶‰∏ÄËá¥Êù•ÂÆûÁé∞ÁöÑ„ÄÇ(height: ËØ•ÂÖÉÁ¥†ÁöÑÈ´òÂ∫¶Ôºåline-height: È°æÂêçÊÄù‰πâÔºåË°åÈ´òÔºàË°åÈó¥Ë∑ùÔºâÔºåÊåáÂú®ÊñáÊú¨‰∏≠ÔºåË°å‰∏éË°å‰πãÈó¥ÁöÑ Âü∫Á∫øÈó¥ÁöÑË∑ùÁ¶ª )„ÄÇline-height ‰∏é font-size ÁöÑËÆ°ÁÆóÂÄº‰πãÂ∑ÆÔºåÂú® CSS ‰∏≠Êàê‰∏∫‚ÄúË°åÈó¥Ë∑ù‚Äù„ÄÇÂàÜ‰∏∫‰∏§ÂçäÔºåÂàÜÂà´Âä†Âà∞‰∏Ä‰∏™ÊñáÊú¨Ë°åÂÜÖÂÆπÁöÑÈ°∂ÈÉ®ÂíåÂ∫ïÈÉ®„ÄÇ 1234567&lt;style&gt;.container&#123; height:100px; line-height:100px; background:#999;&#125;&lt;/style&gt; 123&lt;div class="container"&gt; hi,imooc!&lt;/div&gt;]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>HTML</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS ‰∏≠ÁöÑËá™Âä®ÂºïÁî®ËÆ°Êï∞]]></title>
    <url>%2F2017%2F05%2F13%2Farc%2F</url>
    <content type="text"><![CDATA[ÂØπËøôÊú¨‰π¶ÂÅö‰∏Ä‰∏ã„Ääoc È´òÁ∫ßÁºñÁ®ã„ÄãÁöÑËØª‰π¶Á¨îËÆ∞ ÂÜÖÂ≠òÁÆ°ÁêÜ/ÂºïÁî®ËÆ°Êï∞ÂÜÖÂ≠òÁÆ°ÁêÜÁöÑÊÄùËÄÉÊñπÂºèÂØπË±°Êìç‰Ωú‰∏éOC ÊñπÊ≥ïÁöÑÂØπÂ∫î: ÁîüÊàêÂπ∂ÊåÅÊúâÂØπË±°Ôºöalloc/new/copy/mutableCopy ÊåÅÊúâÂØπË±°Ôºöretain ÈáäÊîæÂØπË±°Ôºörelease Â∫üÂºÉÂØπË±°Ôºödealloc NSObject Á±ªË¥üÊãÖÂÜÖÂ≠òÁÆ°ÁêÜÁöÑËÅåË¥£„ÄÇ Ëá™Â∑±ÁîüÊàêÂØπË±°ÔºåËá™Â∑±ÊåÅÊúâ‰ΩøÁî®‰ª•‰∏ãÂêçÁß∞ÂºÄÂ§¥ÁöÑÊñπÊ≥ïÊÑèÂë≥ÁùÄËá™Â∑±ÁîüÊàêÁöÑÂØπË±°Âè™ÊúâËá™Â∑±ÊåÅÊúâÔºö alloc new copy mutableCopy ËøôÈáåÁöÑÊÑèÊÄùÊòØÂè™Ë¶Å‰ª•ËøôÂá†‰∏™ËØçÂºÄÂ§¥ÔºåÂ∞±‰∏çÈúÄË¶ÅÂÜçË∞ÉÁî® retain ÊñπÊ≥ïÂ∞±ÂèØ‰ª•‰øùÁïô‰∫ÜÂØπË±°‰∫Ü„ÄÇÂú® ARC ‰∏≠ÔºåÁ≥ªÁªü‰∏ç‰ºöËá™Âä®Ë°•‰∏ä retain ÊñπÊ≥ï 123// Ëá™Â∑±ÁîüÊàêÂπ∂ÊåÅÊúâÂØπË±°id obj = [[NSObject alloc] init];// Ëá™Â∑±ÊåÅÊúâÂØπË±° ËøôÈáåÂ∞±‰∏ç‰ºöÂÜçË∞ÉÁî® [obj retain] ‰∫Ü„ÄÇobj Â∑≤ÁªèÊåÅÊúâ‰∫ÜÂØπË±°„ÄÇ ÈùûËá™Â∑±ÁîüÊàêÁöÑÂØπË±°ÔºåËá™Â∑±‰πüËÉΩÊåÅÊúâÈô§‰∫Ü‰∏äÈù¢ÁöÑÊñπÊ≥ïÂèñÂæóÁöÑÂØπË±°ÔºåÂõ†‰∏∫ÈùûËá™Â∑±ÁîüÊàêÂπ∂ÊåÅÊúâÔºåÊâÄ‰ª•Ëá™Â∑±‰∏çÊòØËØ•ÂØπË±°ÁöÑÊåÅÊúâËÄÖ„ÄÇ 12345// ÂèñÂæóÈùûËá™Â∑±ÁîüÊàêÂπ∂ÊåÅÊúâÁöÑÂØπË±°id obj = [NSMutableArray array];// ÂèñÂæóÂØπË±°ÁöÑÂ≠òÂú®Ôºå‰ΩÜËá™Â∑±‰∏çÊåÅÊúâÂØπË±°[obj retain];// Ëá™Â∑±ÊåÅÊúâÂØπË±° ÈÄöËøá retain ÊñπÊ≥ïÔºåÈùûËá™Â∑±ÁîüÊàêÁöÑÂØπË±°‰πüÂèØ‰ª•Êàê‰∏∫Ëá™Â∑±ÊåÅÊúâ„ÄÇ ‰∏çÂÜçÈúÄË¶ÅËá™Â∑±ÊåÅÊúâÁöÑÂØπË±°Êó∂ÈáäÊîæreleaseËá™Â∑±ÊåÅÊúâÁöÑÂØπË±°Ôºå‰∏ÄÊó¶‰∏çÂÜçÈúÄË¶ÅÔºåÊåÅÊúâËÄÖÂèØ‰ª•ÈÄöËøá release ÊñπÊ≥ïÔºåÈáäÊîæËØ•ÂØπË±°„ÄÇ 1234567// ÂèñÂæóÈùûËá™Â∑±ÁîüÊàêÂπ∂ÊåÅÊúâÁöÑÂØπË±°id obj = [NSMutableArray array];// ÂèñÂæóÂØπË±°ÁöÑÂ≠òÂú®Ôºå‰ΩÜËá™Â∑±‰∏çÊåÅÊúâÂØπË±°[obj retain];// Ëá™Â∑±ÊåÅÊúâÂØπË±°[obj release];// ÈáäÊîæÂØπË±°ÔºåÂØπË±°‰∏çÂèØÂÜçË¢´ËÆøÈóÆ autoreleaseËá™ÂÆö‰πâ‰∏Ä‰∏™Á¨¶ÂêàÂâçÊñáÂëΩÂêçËßÑËåÉÁöÑÁîüÊàêÂØπË±°ÁöÑÊñπÊ≥ïÔºö 12345678910- (id)allocObject&#123; //Ëá™Â∑±ÁîüÊàêÂπ∂ÊåÅÊúâÂØπË±° id obj = [[NSObject alloc] init]; // Ëá™Â∑±ÊåÅÊúâÂØπË±° return objÔºõ&#125;// ÂèñÂæóÈùûËá™Â∑±ÁîüÊàêÂπ∂ÊåÅÊúâÁöÑÂØπË±°id obj1 = [obj0 allocObject];// Ëá™Â∑±ÊåÅÊúâÂØπË±° Áî±‰∫éÂ§ñÈÉ®ÊòØÈÄöËøá allocObject ÁîüÊàêÁöÑÔºåÊâÄ‰ª•ÂÜÖÈÉ®‰∏çÁî® [obj autorelease] ‰∏äÈù¢ÁöÑ‰æãÂ≠êÊää allocObject ‰∏≠‰∏çÁî® alloc ÂàõÂª∫ÔºåËøô‰∏™Êó∂ÂÄôÂ∞±‰ºöÊ∑ªÂä† retain ‰∫ÜÔºö 123456789101112- (id)allocObject&#123; //ÂèñÂæóÈùûËá™Â∑±ÁîüÊàêÂπ∂ÊåÅÊúâÁöÑÂØπË±° id obj = [NSArray array]; //ÂèñÂæóÂØπË±°ÁöÑÂ≠òÂú®Ôºå‰ΩÜËá™Â∑±‰∏çÊåÅÊúâÂØπË±° [obj retain]; // Ëá™Â∑±ÊåÅÊúâÂØπË±° return objÔºõ&#125;// ÂèñÂæóÈùûËá™Â∑±ÁîüÊàêÂπ∂ÊåÅÊúâÁöÑÂØπË±°id obj1 = [obj0 allocObject];// Ëá™Â∑±ÊåÅÊúâÂØπË±° Áî±‰∫éÂ§ñÈÉ®ÊòØÁ¨¶ÂêàÂëΩÂêçËßÑËåÉÁöÑÔºåÂõ†Ê≠§ÔºåÂÜÖÈÉ®‰∏çÊ∑ªÂä† autorelease ÊñπÊ≥ï„ÄÇ ÂÖ∂ÂÆûÂèØ‰ª•Ëøô‰πàÁêÜËß£ÔºåÊñπÊ≥ïÂÜÖÂ¶ÇÊûúÊòØÁî® alloc ÂàõÂª∫ÂØπË±°Âπ∂ËøîÂõûÁöÑÔºåÈÇ£‰πà‰∏çÁî® retainÔºõÂ¶ÇÊûú‰∏çÁî® alloc ÂàõÂª∫ÂØπË±°ÁöÑÔºå‰ºöËá™Âä®ÊèíÂÖ• retainÔºåÊâÄ‰ª•‰∏çÁÆ°ÊÄéÊ†∑ÂºïÁî®ËÆ°Êï∞Âô®ÂøÖÁÑ∂Âä†‰∏Ä„ÄÇËøô‰∏™Êó∂ÂÄôÔºåÁî±‰∫éÊñπÊ≥ïÊòØÂ∏¶Êúâ alloc Á≠âÂ≠óÁúºÁöÑÔºåÁºñËØëÂô®‰∏ç‰ºöÂú®ÊñπÊ≥ï‰∏≠ÁöÑÊúÄÂêéÊ∑ªÂä† release ÊñπÊ≥ï„ÄÇÂõ†Ê≠§ÔºåÂ§ñÈÉ®Â∞±‰∏çÁî®ÂÜç retain ‰∫ÜÔºåÂõ†‰∏∫ÂÜÖÈÉ®Â∑≤ÁªèÂä†Ëøá‰∏Ä‰∫Ü„ÄÇ ÈÇ£‰πàÂ¶ÇÊûúÊòØÁ±ª‰ºº [NSMutableArray array] ÊñπÂºèÔºåËØ•Â¶Ç‰ΩïÂèñÂæóÂØπË±°Âë¢Ôºü‰ª•Ëá™ÂÆö‰πâ‰∏Ä‰∏™ object ÊñπÊ≥ï‰∏∫‰æãÔºö 123456789101112- (id)object&#123; id obj = [[NSObject alloc] init]; // Ëá™Â∑±ÊåÅÊúâÂØπË±° [obj autorelease]; // ÂèñÂæóÂØπË±°ÁöÑÂ≠òÂú®Ôºå‰ΩÜËá™Â∑±‰∏çÊåÅÊúâÂØπË±° return obj;&#125;id obj1 = [obj0 object];// ÂèñÂæóÂØπË±°ÁöÑÂ≠òÂú®Ôºå‰ΩÜËá™Â∑±‰∏çÊåÅÊúâ[obj1 retain]Ôºõ// Ëá™Â∑±ÊåÅÊúâÂØπË±° Âú® ARC ‰∏≠ÔºåÂ¶ÇÊûú‰∏çÁ¨¶Âêà‰∏äÈù¢ÁöÑÂëΩÂêçËßÑËåÉÔºåÈÇ£‰πàÁ≥ªÁªü‰ºöËá™Âä®Ê∑ªÂä† autorelease ÊñπÊ≥ïÔºåÂπ∂‰∏îÂ§ñÈÉ®Â∞±ÈúÄË¶ÅÂÜç retain ‰∏ÄÊ¨°‰∫Ü„ÄÇ Â¶ÇÊ≠§ÔºöÁ¨¶ÂêàÂëΩÂêçËßÑËåÉÔºåÊó¢‰∏çË¶ÅÂÜÖÈÉ® releaseÔºå‰πü‰∏çË¶ÅÂ§ñÈÉ® retainÔºõ‰∏çÁ¨¶ÂêàÂëΩÂêçËßÑËåÉÔºåÊó¢Ë¶ÅÂÜÖÈÉ® release ‰∏ÄÊ¨°Ôºå‰πüË¶ÅÂ§ñÈÉ® retain ‰∏ÄÊ¨°„ÄÇËøôÊ†∑ÊàêÂØπÁöÑÊìç‰ΩúÔºåÊâç‰øùËØÅ‰∫ÜÂºïÁî®ËÆ°Êï∞ÁöÑÊ≠£Á°ÆÊÄß„ÄÇ ÈÇ£‰∏çÁ¨¶ÂêàÂëΩÂêçËßÑËåÉÁöÑÊó∂ÂÄôÂÖà release Âú® retain ‰∏çÊòØÂæàÊµ™Ë¥πÊÄßËÉΩ‰πàÔºüÂÖ∂ÂÆûÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåoc ÂÅö‰∫Ü‰ºòÂåñÔºå‰∏ç‰ºöÊääÂØπË±°Ê≥®ÂÜåÂà∞ AutoreleasePool ‰∏≠ÔºåÂÆûÁé∞ÊñπÊ≥ïÊòØ‰ΩøÁî®objc_retainAutoreleasedReturnValue() Âíå objc_autoreleaseReturnValue()ÔºåÂÖ∑‰ΩìÂú®‰∏ãÊñπ„ÄÇ ‰∏ä‰æã‰∏≠Ôºå‰ΩøÁî® autorelease ÊñπÊ≥ïÔºåÂèñÂæóÂØπË±°ÁöÑÂ≠òÂú®Ôºå‰ΩÜÊòØËá™Â∑±‰∏çÊåÅÊúâÂØπË±°„ÄÇautorelease Êèê‰æõËøôÊ†∑ÁöÑÂäüËÉΩÔºå‰ΩøÂØπË±°Âú®Ë∂ÖÂá∫ÊåáÂÆöÁöÑÁîüÂ≠òËåÉÂõ¥ËÉΩÂ§üËá™Âä®Âπ∂Ê≠£Á°ÆÁöÑÈáäÊîæ(Ë∞ÉÁî® release ÊñπÊ≥ï)„ÄÇ Êó†Ê≥ïÈáäÊîæÈùûËá™Â∑±ÊåÅÊúâÁöÑÂØπË±°ÈáäÊîæÈùûËá™Â∑±ÊåÅÊúâÁöÑÂØπË±°Êó∂‰ºöÂèëÁîüÂ¥©Ê∫É alloc/retain/release/dealloc ÂÆûÁé∞ËãπÊûúÂ∞ÜÂØπË±°ÁöÑÂºïÁî®ËÆ°Êï∞‰øùÂ≠òÂú®Êï£ÂàóË°®‰∏≠„ÄÇËøôÊ†∑ÁöÑÂ•ΩÂ§ÑÊòØÔºö ÂØπË±°Áî®ÂÜÖÂ≠òÂùóÁöÑÂàÜÈÖçÊó†È°ªËÄÉËôëÂÜÖÂ≠òÂùóÂ§¥ÈÉ® ÂºïÁî®ËÆ°Êï∞Ë°®ÂêÑËÆ∞ÂΩï‰∏≠Â≠òÊúâÂÜÖÂ≠òÂùóÂú∞ÂùÄÔºåÂèØ‰ªéÂêÑ‰∏™ËÆ∞ÂΩïËøΩÊ∫ØÂà∞ÂêÑÂØπË±°ÁöÑÂÜÖÂ≠òÂùó„ÄÇ ÂÆûÁé∞ËßÑÂàôÔºö Ë∞ÉÁî® alloc ÊàñËÄÖ reatain ÂêéÔºåÂºïÁî®ËÆ°Êï∞ÂÄºÂä†1 Ë∞ÉÁî® release ÂêéÔºåÂºïÁî®ËÆ°Êï∞Âáè1 ÂºïÁî®ËÆ°Êï∞ÂÄº‰∏∫0ÂêéÔºåË∞ÉÁî® dealloc ÊñπÊ≥ïÂ∫üÂºÉÂØπË±° autoreleaseautorelease ‰ΩøÂØπË±°Ë∂ÖÂá∫‰ΩúÁî®ÂüüÂêéÔºåÂØπË±°ÂÆû‰æãÁöÑ release ÂÆû‰æãÊñπÊ≥ïË¢´Ë∞ÉÁî®„ÄÇÂÖ∂ÂÖ∑‰Ωì‰ΩøÁî®ÊñπÊ≥ïÂ¶Ç‰∏ãÔºö ÁîüÊàêÂπ∂ÊåÅÊúâ NSAutoreleasePool ÂØπË±° Ë∞ÉÁî®Â∑≤ÂàÜÈÖçÂØπË±°ÁöÑ autorelease ÂÆû‰æãÊñπÊ≥ï Â∫üÂºÉ NSAutoreleasePool ÂØπË±° ÂØπ‰∫éÊâÄÊúâÊéâÁî®Ëøá autorelease ÂÆû‰æãÊñπÊ≥ïÁöÑÂØπË±°ÔºåÂú®Â∫üÂºÉ NSAutoreleasePool ÂØπË±°Êó∂ÔºåÈÉΩÂ∞ÜË∞ÉÁî® release ÂÆû‰æãÊñπÊ≥ï„ÄÇ NSRunLoop ‰ºöËá™Âä®ÂÆåÊàê NSAutoreleasePool ÁöÑÁîüÊàê„ÄÅÊåÅÊúâÂíåÂ∫üÂºÉÂ§ÑÁêÜÔºå‰∏ç‰∏ÄÂÆöÈùûË¶ÅÂ∫îÁî®ÂºÄÂèëËÄÖÊâãÂä®‰ΩøÁî® NSAutoreleasePool„ÄÇ‰∏çËøáÂ¶ÇÊûúÂ≠òÂú®Â§ßÈáè autorelease ÁöÑÂØπË±°ÁöÑËØùÔºåËøòÊòØÂª∫ËÆÆËá™Â∑±ÁîüÊàêÂíåÂ∫üÂºÉ NSAutoreleasePool ÁöÑ„ÄÇ autorelease ÂÆûÁé∞autorelease ÂÆû‰æãÊñπÊ≥ïÁöÑÊú¨Ë¥®ÊòØË∞ÉÁî® NSAutoreleasePool ÂØπË±°ÁöÑ addObject Á±ªÊñπÊ≥ï„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÂ∞ÜË¶ÅÈáäÊîæÁöÑÂØπË±°Ê∑ªÂä†Âà∞ NSAutoreleasePool ‰∏≠ÁöÑÊï∞ÁªÑ‰∏≠Âéª„ÄÇÂΩì NSAutoreleasePool Â∞ÜË¶ÅÈîÄÊØÅÊó∂ÔºåÂØπÊï∞ÁªÑ‰∏≠ÁöÑÊâÄÊúâÂØπË±°Ë∞ÉÁî® release ÊñπÊ≥ï„ÄÇ ARC ‰∏≠ÁöÑÊâÄÊúâÊùÉ‰øÆÈ•∞Á¨¶ARC ÊúâÊïàÊó∂ÔºåÂØπË±°Á±ªÂûã‰∏äÂøÖÈ°ªÈôÑÂä†ÊâÄÊúâÊùÉ‰øÆÈ•∞Á¨¶Ôºö __strong __weak __unsafe_unretained __autoreleasing __strong ‰øÆÈ•∞Á¨¶__strong ‰øÆÈ•∞Á¨¶ÊòØÈªòËÆ§ÁöÑÊâÄÊúâÊùÉ‰øÆÈ•∞Á¨¶Ôºå‰πüÂ∞±ÊòØËØ¥Ôºå‰∏ãÈù¢ÁöÑ id ÂèòÈáèÔºåÂÆûÈôÖ‰∏äË¢´ÈôÑÂä†‰∫ÜÊâÄÊúâÊùÉ‰øÆÈ•∞Á¨¶ 12id obj = [[NSObject alloc] init];=&gt; id __strong obj = [[NSObject alloc] init]; Â¶ÇÊûúÊåáÂÆö‰∫ÜÂèòÈáèÁöÑ‰ΩúÁî®ÂüüÔºö 12345678&#123; id __strong obj = [[NSObject alloc] init];&#125;// Áõ∏ÂΩì‰∫é‰∏ãÈù¢üëá&#123; id obj = [[NSObject alloc] init]; [obj release];&#125; __strong ‰øÆÈ•∞Á¨¶Ë°®Á§∫ÂØπÂØπË±°ÁöÑÂº∫ÂºïÁî®ÔºåÊåÅÊúâÂº∫ÂºïÁî®ÁöÑÂØπË±°ÔºåÂú®Ë∂ÖÂá∫ÂÖ∂‰ΩúÁî®ÂüüÊó∂Ë¢´Â∫üÂºÉÔºåÈöèÁùÄÂº∫ÂºïÁî®ÁöÑÂ§±ÊïàÔºåÂºïÁî®ÁöÑÂØπË±°‰ºöÈöè‰πãÈáäÊîæ„ÄÇ __weak‰øÆÈ•∞Á¨¶__strong ‰øÆÈ•∞Á¨¶ÂÆπÊòìÂºïËµ∑ÂºïÁî®Âæ™ÁéØÔºå‰ΩøÁî® __weak ‰øÆÈ•∞Á¨¶ÂèØ‰ª•ÈÅøÂÖçÂæ™ÁéØÂºïÁî®„ÄÇ 1id __weak obj = [[NSObject alloc] init]; ‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂ≠òÂú®‰∏Ä‰∏™ÈóÆÈ¢òÔºåÁî±‰∫é‰ΩøÁî®Âº±ÂºïÁî®ÔºåÊñ∞Âª∫ NSObject ÂØπË±°Âú®ÂàõÂª∫Âêé‰ºöÁ´ãÂàªÈáäÊîæ(Ëøô‰πüÊòØÂπ≥Êó∂‰ΩøÁî® weak Êó∂ÈúÄË¶ÅÊ≥®ÊÑèÁöÑ)„ÄÇÈúÄË¶Å‰øÆÊîπÊàê‰∏ãÈù¢ 12id __strong obj0 = [[NSObject alloc] init];id __weak obj1 = obj0; ‰∏æ‰∏™‰æãÂ≠êÔºö 1234567id __weak obj1 = nil;&#123; id __strong obj0 = [[NSObject alloc] init]; obj1 = obj0; NSLog(@"A: %@",obj1);&#125;NSLog(@"B: %@",obj1); Áî±‰∫éÂº±ÂºïÁî®ÔºåÂú®Êã¨Âè∑ÂêéËåÉÂõ¥Â§ñÔºåobj0 Ë¢´ÂõûÊî∂Ôºåobj1 ‰∏∫ÁΩÆ‰∏∫ nil __unsafe_unretained‰øÆÈ•∞Á¨¶Â∑≤ÁªèË¢´Â∫üÂºÉÁöÑ‰øÆÈ•∞Á¨¶ÔºåËøô‰∏™‰øÆÈ•∞Á¨¶Âíå __weak ÁöÑÂ∑ÆÂà´Âú®‰∫éÔºå__weak ‰øÆÈ•∞Á¨¶Âú®ÂØπË±°Ë¢´ÂõûÊî∂Âêé‰ºöÁΩÆ‰∏∫ nilÔºåËÄåËØ•‰øÆÈ•∞Á¨¶Âàô‰ªçÊåáÂêëÂéüÊúâÂÜÖÂ≠òÂú∞ÂùÄÔºåËÆøÈóÆË¢´Â∫üÂºÉÁöÑÂØπË±°Â∞ÜÂèØËÉΩ‰ºö‰∫ßÁîüÂ¥©Ê∫É„ÄÇ __autoreleasing ‰øÆÈ•∞Á¨¶ autorelease ÂÖ∂ÂÆûÂ∞±ÊòØÂ∞Ü release ÊñπÊ≥ïÂª∂Ëøü‰∏ÄÊÆµÊó∂Èó¥ÊâßË°å ARC ‰∏≠Êó†Ê≥ïÁõ¥Êé•‰ΩøÁî® autorelease„ÄÇÂú® ARC Êó†ÊïàÊó∂‰ºöÂÉè‰∏ãÈù¢Êù•‰ΩøÁî®Ôºö 12345// ARC Êó†ÊïàNSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];id obj = [[NSObject alloc] init];[obj autorelease];[pool drain]; ACR ÊúâÊïàÊó∂ÔºåÂ∞ÜÊ∫ê‰ª£Á†ÅÂÜôÊàêËøôÊ†∑: 123@autoreleasepool&#123; id __autoreleasing obj = [[NSObject alloc] init];&#125; Âú® ARC ÊúâÊïàÊó∂ÔºåÁî® @autoreleaseing Âùó‰ª£Êõø NSAutoreleasePoolÁ±ªÔºåÁî®ÈôÑÊúâ __autoreleasing ‰øÆÈ•∞Á¨¶ÁöÑÂèòÈáèÊõø‰ª£ autorelease ÊñπÊ≥ï„ÄÇ ARC ÁöÑÂÆûÁé∞__strong‰øÆÈ•∞Á¨¶123456789&#123; id __strong obj = [[NSObject alloc] init];&#125;ÁºñËØëÂô®Ê®°ÊãüÁöÑ‰ª£Á†Å =&gt;&#123; id obj = objc_msgSend(NSObject, @selector(alloc)); objc_msgSend(obj, @selector(init)); objc_release(obj);&#125; ‰∏§Ê¨°Ë∞ÉÁî® objc_msgSend ÊñπÊ≥ïÔºåÂèòÈáè‰ΩúÁî®ÂüüÁªìÊùüÊó∂ÈÄöËøá objc_release ÈáäÊîæÂØπË±°„ÄÇËôΩÁÑ∂ ARC ÊúâÊïàÊó∂‰∏çËÉΩ‰ΩøÁî® release ÊñπÊ≥ïÔºå‰ΩÜÊòØÁºñËØëÂô®‰ºöËá™Âä®ÊèíÂÖ•„ÄÇ Â¶ÇÊûú‰ΩøÁî®ÂÖ∂‰ªñÁöÑÂàõÂª∫ÊñπÊ≥ïÔºö 123456789&#123; id __strong obj = [NSMutableArray array];&#125;ÁºñËØëÂô®Ê®°ÊãüÁöÑ‰ª£Á†Å =&gt;&#123; id obj = objc_msgSend(NSMutableArray, @selector(array)); objc_retainAutoreleasedReturnValue(obj); objc_release(obj);&#125; ‰∏≠Èó¥Ë∞ÉÁî®‰∫Ü objc_retainAutoreleasedReturnValue() ÊñπÊ≥ï„ÄÇÂÆÉÊåÅÊúâÁöÑÂØπË±°Â∫î‰∏∫ ËøîÂõûÊ≥®ÂÜåÂú® autoreleasepool ‰∏≠ÂØπË±°ÁöÑÊñπÊ≥ïÔºåÊàñÊòØÂáΩÊï∞ÁöÑËøîÂõûÂÄº„ÄÇËøô‰∏™ÊñπÊ≥ïÊòØ‰∏é objc_autoreleaseReturnValue() ÊñπÊ≥ïÊàêÂØπÂá∫Áé∞ÁöÑÔºåÁî®‰∫é‰ºòÂåñÁ®ãÂ∫èËøêË°å„ÄÇÊù•Áúã [NSMutableArray array] ÊñπÊ≥ï: 123456789+ (id)array&#123; return [[NSMutableArray alloc] init];&#125;ÁºñËØëÂô®Ê®°ÊãüÁöÑ‰ª£Á†Å =&gt;+ (id)array&#123; id obj = objc_msgSend(NSMutableArray, @selector(alloc)); objc_msgSend(obj, @selector(init)); return objc_autoreleaseReturnValue(obj);&#125; ËøôÊ†∑ÂÅöÂ∞±‰∏çÈúÄË¶ÅÂÜçÊää obj ÂØπË±°Ê≥®ÂÜåÂà∞ NSAutoreleasePool ‰∏≠‰∫ÜÔºåËÄåÊòØÁõ¥Êé•Âº∫ÂºïÁî®Ëøô‰∏™ÂØπË±°„ÄÇÂ¶Ç‰∏ãÂõæÔºö __weakÂÅáËÆæÂèòÈáè obj ÈôÑÂä† __strong ‰øÆÈ•∞Á¨¶‰∏îÂØπË±°Ë¢´ËµãÂÄº: 123456789&#123; id __weak obj1 = obj;&#125;ÁºñËØëÂô®Ê®°Êãü‰ª£Á†Å =&gt;&#123; id obj1; objc_initWeak(&amp;obj1,obj); objc_destroyWeak(&amp;obj1);&#125; ÂÖ∂‰∏≠ objc_initWeak ÂáΩÊï∞Ôºå‰ºöÂ∞ÜÈôÑÊúâ __weak ‰øÆÈ•∞Á¨¶ÁöÑÂèòÈáèÂàùÂßãÂåñ‰∏∫0ÂêéÔºåË∞ÉÁî® objc_storeWeak ÂáΩÊï∞„ÄÇobjc_destroyWeak ÂáΩÊï∞‰ºöÂ∞Ü0‰Ωú‰∏∫ÂèÇÊï∞Ë∞ÉÁî® objc_storeWeak ÂáΩÊï∞„ÄÇÊâÄ‰ª•Ôºå‰∏äÈù¢Á≠âÊïà‰∫é‰∏ãÈù¢Ôºö 1234567ÁºñËØëÂô®Ê®°Êãü‰ª£Á†Å =&gt;&#123; id obj1; obj1 = 0; objc_storeWeak(&amp;obj1, obj); objc_storeWeak(&amp;obj1, 0);&#125; objc_storeWeak ÂáΩÊï∞ÊääÁ¨¨‰∫åÂèÇÊï∞ÁöÑËµãÂÄºÂØπË±°ÁöÑÂú∞ÂùÄ‰Ωú‰∏∫ÈîÆÂÄºÔºåÂ∞ÜÁ¨¨‰∏ÄÂèÇÊï∞ÁöÑÈôÑÊúâ__weak ‰øÆÈ•∞Á¨¶ÁöÑÂèòÈáèÁöÑÂú∞ÂùÄÊ≥®ÂÜåÂà∞ weak Ë°®‰∏≠„ÄÇÂ¶ÇÊûúÁ¨¨‰∫å‰∏™ÂèÇÊï∞‰∏∫0ÔºåÂàôÊääÂèòÈáèÁöÑÂú∞ÂùÄ‰ªé weak Ë°®‰∏≠Âà†Èô§„ÄÇ weak Ë°®ÂíåÂºïÁî®ËÆ°Êï∞Âô®Ë°®Áõ∏ÂêåÔºå‰Ωú‰∏∫Êï£ÂàóË°®Ë¢´ÂÆûÁé∞„ÄÇÂ¶ÇÊûú‰ΩøÁî® weak Ë°®ÔºåÂ∞ÜÂ∫üÂºÉÂØπË±°ÁöÑÂú∞ÂùÄ‰Ωú‰∏∫ÈîÆÂÄºËøõË°åÊ£ÄÁ¥¢ÔºåÂ∞±ËÉΩÈ´òÈÄüÂú∞Ëé∑ÂèñÂØπÂ∫îÁöÑÈôÑÊúâ __weak ‰øÆÈ•∞Á¨¶ÁöÑÂèòÈáèÁöÑÂú∞ÂùÄ„ÄÇ ÂÅáËÆæËÄÉËôëÂà∞ obj1 ÊòØË¢´Âä†ÂÖ•Âà∞ autoreleasepool ‰∏≠ÁöÑ„ÄÇÈÇ£‰πàÁºñËØëÂô®Ê®°Êãü‰ª£Á†ÅÂèàÊòØ‰ªÄ‰πàÂë¢Ôºü 12345678910111213&#123; id __weak obj1 = obj; NSLog(@"%@",obj1);&#125;ÁºñËØëÂô®Ê®°Êãü‰ª£Á†Å =&gt;&#123; id obj1; objc_initWeak(&amp;obj1,obj); id tmp = objc_loadWeakRetained(&amp;obj1); objc_autorelease(tmp); NSLog(@"%@",tmp); objc_destroyWeak(&amp;obj1);&#125; ‰∏éË¢´ËµãÂÄºÁõ∏ÊØîÔºåÂ¢ûÂä†‰∫Üobjc_loadWeakRetained Âíå objc_autorelease ÊñπÊ≥ïÁöÑË∞ÉÁî®Ôºö objc_loadWeakRetained ÂèñÂá∫‰∫ÜÈôÑÊúâ __weak ‰øÆÈ•∞Á¨¶ÂèòÈáèÊâÄÂºïÁî®ÁöÑÂØπË±°Âπ∂ retain objc_autorelease Â∞ÜÂØπË±°Ê≥®ÂÜåÂà∞ autoreleasepool ‰∏≠ ‰πüÂ∞±ÊòØËØ¥Âú®‰ΩøÁî® weak ÂèòÈáèÁöÑ‰ª£Á†ÅÂùóÈáåÔºå‰∏¥Êó∂ÁöÑ‰∫ßÁîü‰∫ÜÂº∫ÂºïÁî® Â¶ÇÊûúÂ§ßÈáèÂú∞‰ΩøÁî®ÈôÑÊúâ __weak ‰øÆÈ•∞Á¨¶ÁöÑÂèòÈáèÔºåÊ≥®ÂÜåÂà∞ autoreleasepool ÁöÑÂØπË±°‰ºöÂ§ßÈáèÂú∞Â¢ûÂä†ÔºåÂç≥‰ºöÂ§ßÈáèÂàõÂª∫ tmp„ÄÇÊâÄ‰ª•Ôºå‰ΩøÁî®ÈôÑÊúâ __weak ‰øÆÈ•∞Á¨¶ÁöÑÂèòÈáèÔºåÊúÄÂ•ΩÂÖàÊöÇÊó∂ÁªôÈôÑÊúâ __strong ‰øÆÈ•∞Á¨¶ÁöÑÂèòÈáèÂêéÂÜç‰ΩøÁî®Ôºö 1234567&#123; id __weak obj1 = obj; id tmp = obj1; NSLog(@"1 %@",obj1); NSLog(@"2 %@",obj1); NSLog(@"3 %@",obj1);&#125; Â¶ÇÊûúÊ≤°Êúâ id tmp = obj1Ôºåobj1 Â∞±‰ºöË¢´Ê≥®ÂÜåÂà∞ autoreleasepool Ê≥®ÂÜå3Ê¨°Ôºå‰ΩÜÊòØÂ¶ÇÊûúÊúâËøôÂè•ÔºåÂ∞±Âè™‰ºöÊ≥®ÂÜå‰∏ÄÊ¨°„ÄÇ __autoreleasing__autoreleasing ‰øÆÈ•∞Á¨¶ÁöÑÂèòÈáèÁ≠âÂêå‰∫é ARC Êó†ÊïàÊó∂Ë∞ÉÁî®ÂØπË±°ÁöÑ autorelease ÊñπÊ≥ïÔºö 1234567891011@autoreleasepool&#123; id __autoreleasing obj = [[NSObject alloc] init];&#125;ÁºñËØëÂô®Ê®°ÊãüÁºñÁ†Å =&gt;&#123; id pool = objc_autoreleasePoolPush(); id obj = objc_msgSend(NSObject, @selector(alloc)); objc_msgSend(obj,@selector(init)); objc_autorelease(obj); objc_autoreleasePoolPop(pool);&#125; ÂíåËãπÊûú autorelease ÂÆûÁé∞‰∏≠ÁöÑËØ¥ÊòéÂÆåÂÖ®Áõ∏Âêå„ÄÇ oc ÂØπË±°ÊåáÈíà‰∏é c ÊåáÈíàÁöÑËΩ¨Êç¢__bridge __bridge_transfer Âíå __bridge_retained ÁöÑÂå∫Âà´Êàë‰ª¨Âú®Â∞ÜÂ∞Ü c ÊåáÈíàÂíå oc ÂØπË±°ÊåáÈíà‰πãÈó¥ÂÅöËΩ¨Êç¢ÁöÑÊó∂ÂÄô‰ºöÁî®Âà∞‰∏äËø∞Âá†‰∏™‰øÆÈ•∞Á¨¶„ÄÇÂÆÉ‰ª¨ÈÉΩ‰ºöÂ∞Ü c ÊåáÈíàËΩ¨‰∏∫ oc ÂØπË±°ÊåáÈíà„ÄÇÂ∑ÆÂà´Âú®‰∫éÔºö __bridgeÔºöARC ‰∏ç‰ºöÊèíÂÖ• retain Âíå release ÔºåÂç≥ÁîüÂëΩÂë®ÊúüÂíå c ÊåáÈíà‰∏ÄËá¥ __bridge_retained Ôºö ARC ‰ºöÊèíÂÖ•‰∏ÄÊù° retainÔºå‰∏ç‰ºöÊèíÂÖ• release __bridge_transferÔºöARC ‰ºöÊèíÂÖ•‰∏ÄÊù° releaseÔºå‰∏ç‰ºöÊèíÂÖ• retain Ëß£ÂÜ≥ NSInvocation getArgument ÂºïÂèëÁöÑ Double Release‰ªé NSInvocation ‰∏≠Ëé∑ÂèñÂèÇÊï∞‰ºöËøôÊ†∑ÂèñÔºö 12id arg;[invocation getArgument:&amp;arg atIndex:i]; ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãËµãÂÄºÊìç‰Ωú‰ºöÊàêÂØπÁöÑÊèíÂÖ• retain Âíå releaseÔºö 123456- (void)method &#123;id arg = [SomeClass getSomething];// [arg retain]...// [arg release] ÈÄÄÂá∫‰ΩúÁî®ÂüüÂâçrelease&#125; ‰ΩÜÊòØ ARC ‰∏ãÁî±‰∫é arg ‰∏çÊòØËµãÂÄºÊìç‰ΩúÔºåÂõ†Ê≠§Ê≤°ÊúâÂä†ÂÖ• [arg retain]„ÄÇ‰ΩÜÊòØÂú®ÁªìÂ∞æÁöÑÊó∂ÂÄôËøòÊòØË∞ÉÁî®‰∫Ü [arg release] Â∞±‰ºöÈÄ†Êàê crashÔºö 123id arg;[invocation getArgument:&amp;arg atIndex:i];// [arg release]; Êàë‰ª¨Êúâ‰∏§ÁßçÊñπÂºèËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºå‰∏ÄÁßçÊòØÈÄöËøá __unsafe_unretained ‰øÆÈ•∞Á¨¶ÔºåÂëäËØâÁºñËØëÂô®‰∏çË¶ÅÊèíÂÖ• [arg release] Âíå [arg retain] 12__unsafe_unretained id arg;[invocation getReturnValue:&amp;arg]; ËøòÊúâ‰∏ÄÁßçÊñπÂºèÂ∞±ÊòØÈÄöËøá‰∏äÈù¢ÊèêÂà∞ÁöÑ __bridgeÔºåÂêåÊ†∑ÂëäËØâÁºñËØëÂô®‰∏çË¶ÅÊèíÂÖ• [arg release] Âíå [arg retain] 1234id returnValue;void *result;[invocation getReturnValue:&amp;result];returnValue = (__bridge id)result; ËøôÁßçÊìç‰ΩúÊåáÈíàÁöÑËøòÊòØÈÄöËøá __bridge ÊØîËæÉÂ•Ω Ëß£ÂÜ≥ NSInvocation ÂàõÂª∫ÂØπË±°Âêé getReturnValue ÂºïÂèëÁöÑÂÜÖÂ≠òÊ≥ÑÊºèÂâçÈù¢ËØ¥ËøáÔºåÂΩìÊñπÊ≥ïÂêçÂºÄÂ§¥ÊòØ alloc / new / copy / mutableCopy Êó∂ÔºåËøîÂõûÁöÑÂØπË±°ÊòØ retainCount = 1 ÁöÑ„ÄÇÂõ†Ê≠§ÔºåÈúÄË¶ÅÂú®‰ΩúÁî®‰∫éÁªìÊùüÁöÑÊó∂ÂÄôÊ∑ªÂä† release ÔºåÈáäÊîæÂºïÁî®ËÆ°Êï∞„ÄÇ‰ΩÜÊòØÈÄöËøá __bridge Â∞Ü c ÂØπË±°ËΩ¨‰∏∫ oc ÂØπË±°ÁöÑÊó∂ÂÄô‰ºöÁúÅÁï• release „ÄÇÂõ†Ê≠§ÔºåË¶Å‰ΩøÁî® __bridge_transferÔºå‰ªçÁÑ∂ÊèíÂÖ• releaseÔºö 12345678id returnValue;void *result;[invocation getReturnValue:&amp;result];if ([selectorName isEqualToString:@"alloc"] || [selectorName isEqualToString:@"new"]) &#123; returnValue = (__bridge_transfer id)result;&#125; else &#123; returnValue = (__bridge id)result;&#125;]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[„ÄäVim ÂÆûÁî®ÊäÄÂ∑ß„ÄãËØª‰π¶Á¨îËÆ∞]]></title>
    <url>%2F2017%2F05%2F08%2FVim%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[Â≠¶‰π† Vim ÁöÑ‰∏Ä‰∫õÂø´Êç∑ÈîÆ‰∏éÊäÄÂ∑ß„ÄÇ ÁºñËæë . ÂëΩ‰ª§ÂèØ‰ª•ÈáçÂ§ç‰∏äÊ¨°‰øÆÊîπ„ÄÇÂú®ÊôÆÈÄöÊ®°Âºè‰∏≠ÁöÑÂêÑÁßçÊìç‰ΩúÁÆó‰∏ÄÊ¨°‰øÆÊîπ(‰∏çÂåÖÊã¨ÂÖâÊ†áÁßªÂä®ÂèäË∑≥ËΩ¨)ÔºåÂú®ÁºñËæëÊ®°Âºè‰∏ãÁöÑÂÜÖÂÆπÁöÑÁºñËæë‰πüÁÆó‰∏ÄÊ¨°‰øÆÊîπ„ÄÇ(ËÉΩÁî® . ÁöÑÂ∞±‰∏çË¶ÅÁõ¥Êé•Áî®Êï∞Â≠óÔºâ caw Âà†Èô§ÂΩìÂâçÂçïËØçÂπ∂ËøõÂÖ•ÊèíÂÖ•Ê®°Âºè„ÄÇc3w Âà†Èô§3‰∏™ÂçïËØç„ÄÇc Â∞±Ë°®Á§∫Âà†Èô§ÊñáÊú¨Âπ∂ËøõÂÖ•ÁºñËæëÊ®°Âºè„ÄÇ(Ëøô‰∏™ÂëΩ‰ª§ÂèØ‰ª•ÈÖçÂêà‰∏ãÈù¢ÁöÑÂêë‰∏ãÊü•Êâæ/{char} Êàñ *ÔºåÊñπ‰æøÁöÑÈÄöËøá .ÊâπÈáèÊõøÊç¢ÂçïËØç) C Âà†Èô§ÂÖâÊ†áÂêéÁöÑÊâÄÊúâÔºåÂπ∂‰∏îËøõÂÖ•ÊèíÂÖ•Ê®°Âºè„ÄÇ dw Âà†Èô§ÂΩìÂâçÂÖâÊ†áÂêéÁöÑ(ÂåÖÊã¨ÂÖâÊ†á)Ôºådaw Âà†Èô§‰∏ÄÊï¥‰∏™ÂçïËØç„ÄÇ(w,b Êú¨Ë∫´ÂàÜÂà´Ë°®Á§∫ÁßªÂä®Âà∞‰∏ã‰∏Ä‰∏™ÂçïËØçÂíå‰∏ä‰∏Ä‰∏™ÂçïËØç)„ÄÇD Âà†Èô§ÂΩìÂâçÂÖâÊ†á‰πãÂêé(ÂåÖÊã¨ÂΩìÂâçÂÖâÊ†á)ÁöÑÊâÄÊúâÂçïËØç„ÄÇdd Âà†Èô§Êï¥Ë°å„ÄÇ y Â§çÂà∂Ôºå‰∏é d Âü∫Êú¨Áõ∏Âêå d+i] Ë°®Á§∫Âà†Èô§ÂΩìÂâçÂÖâÊ†áÊâÄÂú®‰ΩçÁΩÆÁöÑ[] ÂåπÈÖçÈ°πÂÜÖÁöÑÂÜÖÂÆπÔºåÂ¶ÇÊûúÊòØa]ÈÇ£‰πà‰ºöËøûÊã¨Âè∑‰∏ÄËµ∑Âà†Èô§„ÄÇÁ±ª‰ººÁöÑËøòÊúâ c,y Ë°®Á§∫Âà†Èô§Âπ∂ÊèíÂÖ•‰ª•ÂèäÂ§çÂà∂„ÄÇi]‰πüÂèØ‰ª•ÊòØi),i} Á≠âÁõ∏Â∫îÂëΩ‰ª§„ÄÇ(‰∏äÈù¢ÁöÑ daw ÂÖ∂‰∏≠ aw Â∞±ÂíåËøôÈáåÁ±ª‰ººÔºåÁõ∏Â∫îÁöÑËøòÊúâ diw)„ÄÇ(ÂæàÊúâÁî®ÂæàÈÖ∑ÁöÑ‰∏Ä‰∏™ÂëΩ‰ª§) p Á≤òË¥¥„ÄÇÂàÜ‰∏∫‰∏§ÁßçÊÉÖÂÜµÔºö Â¶ÇÊûúÂ§çÂà∂ÁöÑÊï¥Ë°åÂàô p Ë°®Á§∫Âú®ÂΩìÂâçË°å‰∏ãÁ≤òË¥¥ÔºåP Âú®ÂΩìÂâçË°å‰∏äÁ≤òË¥¥„ÄÇ Â¶ÇÊûúÂ§çÂà∂ÁöÑÂá†‰∏™ÂçïËØçÂàô p Ë°®Á§∫Âú®ÂΩìÂâçÂÖâÊ†áÂêéÁ≤òË¥¥ÔºåP Ë°®Á§∫Âú®ÂΩìÂâçÂÖâÊ†áÂâçÁ≤òË¥¥„ÄÇ o Âú®ÂΩìÂâçË°å‰∏ãÊèíÂÖ•‰∏ÄË°åÂπ∂ÁºñËæëÔºåO Âú®ÂΩìÂâçË°å‰∏äÊèíÂÖ•‰∏ÄË°åÂπ∂ÁºñËæë x Âà†Èô§ÂÖâÊ†á‰∏ãÂ≠óÊØçÔºåi Âú®ÂÖâÊ†áÂêéÊèíÂÖ•Ôºåa Âú®ÂÖâÊ†áÂâçÊèíÂÖ•ÔºåA Âú®Ë°åÂ∞æÊèíÂÖ•ÔºåI Âú®Ë°åÈ¶ñÊèíÂÖ•„ÄÇ ‚Äã ÊêúÁ¥¢ /{char} ÂëΩ‰ª§Âêë‰∏ãÊü•ÊâæÂåπÈÖçÈ°π„ÄÇÁ±ª‰ººÁöÑËøòÊúâ * Áî®Êù•ÂåπÈÖçÂΩìÂâçÂÖâÊ†áÊâÄÂú®ÂçïËØç„ÄÇn ‰∏ã‰∏ÄÂ§ÑÔºåN ‰∏ä‰∏ÄÂ§Ñ„ÄÇÊü•ÊâæÁöÑÊñáÂ≠óÂèØ‰ª•Ë∞ÉÊàêÈ´ò‰∫ÆÁöÑÔºåÂ¶ÇÊûúÊ≤°ÊúâÂèØ‰ª•ÈÄöËøá :set hls(hightlight search ÁöÑÊÑèÊÄù) ËÆæÁΩÆ,ÂèñÊ∂àÁî® :set nohls Âç≥ÂèØ„ÄÇ Â¶ÇÊûúË¶ÅÂèñÊ∂àÊêúÁ¥¢ÈîÆÂÖ• :nohÔºànohighlightÔºâÂç≥ÂèØ„ÄÇ Vim ÈªòËÆ§ÊòØÂ§ßÂ∞èÂÜôÊïèÊÑüÁöÑÔºåÂèØ‰ª•ÈÄöËøá :set ic(ignore case ÁöÑÊÑèÊÄù) ÂèñÊ∂àÂ§ßÂ∞èÂÜôÊïèÊÑüÔºå‰πüÂèØ‰ª•ÂÜç‰ΩøÁî® :set smartcase ÂΩìÊúâ‰∏Ä‰∏™Â≠óÊØçÊòØÂ§ßÂÜôÁöÑÊó∂ÂÄôÂêØÂä®Â§ßÂ∞èÂÜôÊïèÊÑü Âú®ÈÄâ‰∏≠ÊÉÖÂÜµ‰∏ãÈîÆÂÖ• :&#39;&lt;,&#39;&gt;s/foo/bar/g Ë°®Á§∫Â∞Ü foo ÊõøÊç¢‰∏∫ bar„ÄÇÈÄâÁßçÊÉÖÂÜµ‰∏ãÈîÆÂÖ•:ÁöÑÊó∂ÂÄôvim‰ºöÈªòËÆ§Â°´ÂÖÖ&#39;&lt;,&gt;&#39;ÔºåÊâÄ‰ª•Âè™Ë¶ÅËæìÂÖ•s/foo/bar/g Âç≥ÂèØ„ÄÇ /g Ë°®Á§∫ÂÖ®ÈÉ®ÊõøÊç¢Ôºås Ë°®Á§∫ selected Ë∑≥ËΩ¨ zz Â∞ÜÂΩìÂâçË°åÊòæÁ§∫Âú®Á™óÂè£Ê≠£‰∏≠„ÄÇÊØîÂ¶Ç‰Ω†‰ª£Á†ÅÂÜôÁùÄÂÜôÁùÄÂÜôÂà∞‰∫ÜÂ±èÂπïÁöÑÊúÄÂ∫ï‰∏ãÔºåËøôÊó∂ÂÄô‰∏çÈúÄË¶ÅÊªëÂä®Èº†Ê†áÊªöËΩÆÔºå‰ΩøÁî®ËØ•Âø´Êç∑ÈîÆÂ∞±ÂèØ‰ª•Â∞ÜÂΩìÂâçË°åÁßªÂä®Âà∞Á™óÂè£Ê≠£‰∏≠ÔºåÁªßÁª≠ËøõË°åÁºñËæë„ÄÇ gg Ë∑≥ËΩ¨Âà∞È°µÈù¢ÊúÄ‰∏äÈù¢ (Âä† import Êñá‰ª∂ÁöÑÊó∂ÂÄôÊå∫Â•ΩÁî®ÁöÑ)„ÄÇGË∑≥ËΩ¨Âà∞È°µÈù¢ÊúÄ‰∏ãÈù¢(Âä†ÊñπÊ≥ïÁöÑÊó∂ÂÄôÁî®)„ÄÇ w,b Ë∑≥Âà∞Âêé‰∏Ä‰∏™/Ââç‰∏Ä‰∏™ÂçïËØç(ËøûÁª≠ÁöÑÁ¨¶Âè∑‰πüÁÆó‰∏Ä‰∏™ÂçïËØç)„ÄÇW,B ÂøΩÁï•Á¨¶Âè∑Ôºå‰ª•Á©∫Ê†º‰∏∫ÂàÜÁïå„ÄÇ e(end) Âø´ÈÄüÂ∞ÜÂÖâÊ†áË∑≥ËΩ¨Âà∞ÂçïËØçÁöÑÊú´Â∞æ„ÄÇÂíå w,b Êê≠ÈÖç‰ΩøÁî®„ÄÇ(‰πüÊå∫Â•ΩÁî®ÁöÑÔºåw Âíå b ËÉΩ‰ª•ÂçïËØçÂêëÂêéÂêëÂâçË∑≥ËΩ¨Ôºå‰ΩÜÊòØÂÖâÊ†áÈÉΩÊòØÂú®ÂçïËØçÁöÑÂâçÈù¢„ÄÇÁî® e ÂèØ‰ª•Âà∞ÂçïËØçÊú´Â∞æÔºåÂèØ‰ª•Áî® a Âú®ÂçïËØçÂêéÈù¢ËæìÂÖ•)„ÄÇE Á±ª‰ºº‰∫é W,B ‰ª•Á©∫Ê†º‰∏∫ÂàÜÁïåÔºåË∑≥Âà∞ÂçïËØçÁöÑÂ∞æÈÉ®„ÄÇ mx Ê†áËÆ∞x (mark x)Ôºå`xË∞ÉÂà∞Ê†áËÆ∞x„ÄÇËøô‰∏™‰πüÊå∫Â•ΩÁî®ÁöÑÔºåÊØîÂ¶Ç‰Ω†Ë¶ÅÂú®Êñá‰ª∂Â§¥Ê∑ªÂä†‰∏™ÂºïÁî®ÔºåÈÇ£‰πàÂÖàÊ†áËÆ∞‰∏Ä‰∏ãÂΩìÂâçË°å„ÄÇ % ÂèØ‰ª•Âú®‰∏ÄÁªÑÂºÄ„ÄÅÊØïÊã¨Âè∑Èó¥Ë∑≥ËΩ¨„ÄÇÂ¶ÇÊûúÂΩìÂâçÂÖâÊ†áÂ§Ñ‰∏çÊòØ‰∏™Êã¨Âè∑ÔºåÈÇ£‰πàÂ∞±Ë∑≥ËΩ¨Âà∞ÂΩìÂâçÂÖâÊ†áÂêéÊúÄËøëÁöÑ‰∏Ä‰∏™Êã¨Âè∑Â§Ñ„ÄÇËøô‰∏™ÊñπÊ≥ïÂÜô oc ÁöÑÊó∂ÂÄôÂæàÊúâÁî®Âïä„ÄÇ CTRL+E Â±èÂπïÂêë‰∏ãÊªöÂä®‰∏ÄË°åÔºåCTRL+Y Â±èÂπïÂêë‰∏äÊªöÂä®‰∏ÄË°å„ÄÇCTRL+D Âíå CTRL+U ÂéüÊú¨ÊòØÊªöÂä®ÂçäÂ±èÔºåÊàë‰ª¨ÂèØ‰ª•Âú® .vimrc ‰∏≠ map ‰∏∫5Ë°åÔºö 123".vimrcmap &lt;C-U&gt; 5&lt;C-Y&gt;map &lt;C-D&gt; 5&lt;C-E&gt; ÈÄâÊã©‰∏ªË¶ÅÁî®Êù•Â§çÂà∂ÂíåÂà†Èô§ v ËøõÂÖ•ÈÄâÊã©Ê®°Âºè„ÄÇÂèØ‰ª•ÈÖçÂêà‰∏äÈù¢ËØ¥Âà∞ÁöÑÊâÄÊúâÔºöw,b,i],3w V ÈÄâÊã©Êï¥Ë°å„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>Vim</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UINavigationController‰ΩøÁî®ÊñπÊ≥ï]]></title>
    <url>%2F2017%2F05%2F04%2FUINavigationController%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[navigation ÁÆÄÂçï‰∫ÜËß£‰∏ã‰ΩøÁî® Â∏∏Áî®ÊñπÊ≥ïÊ∑ªÂä†ÂØºËà™Ê†è123TestViewController * mainVC = [[TestViewController alloc] init];UINavigationController * nav = [[UINavigationController alloc] initWithRootViewController:mainVC];self.window.rootViewController = nav; pushÈ¶ñÂÖàÊòØÊúÄÂ∏∏Áî®ÁöÑÊñπÊ≥ïÔºö 1- (void)pushViewController:(UIViewController *)viewController animated:(BOOL)animated; ‰ΩøÁî® setViewControllers ‰∏ÄÊ¨°ÊÄß‰æùÊ¨°ÂéãÂÖ•Â§ö‰∏™ÊéßÂà∂Âô®ÔºåÊúÄÂêéÊòæÁ§∫ÊúÄÂêéÁöÑÊéßÂà∂Âô®Ôºö 1234567891011UINavigationController *nav = [[UINavigationController alloc] init];window.rootViewController = nav;// ÂàõÂª∫3‰∏™ÊµãËØïÊéßÂà∂Âô®UIViewController *vc1 = [[UIViewController alloc] init];vc1.view.backgroundColor = [UIColor blueColor];UIViewController *vc2 = [[UIViewController alloc] init];vc2.view.backgroundColor = [UIColor redColor];UIViewController *vc3 = [[UIViewController alloc] init];vc3.view.backgroundColor = [UIColor greenColor];// ÊúÄÁªà‰ºöÊòæÁ§∫vc3[nav setViewControllers:@[vc1,vc2,vc3] animated:YES]; popÂ∏∏Áî®ÊñπÊ≥ïÔºö 1- (UIViewController *)popViewControllerAnimated:(BOOL)animated; ‰∏ÄÂ±ÇÂ±ÇËøîÂõû‰∏çÊñπ‰æøÔºåÂèØ‰ª•Áõ¥Êé•ËøîÂõûÂà∞Êüê‰∏Ä‰∏™ÊéßÂà∂Âô®Ôºö 12345// ËøîÂõûÂà∞Êüê‰∏Ä‰∏™ÊéßÂà∂Âô®- (NSArray *)popToViewController:VC_A animated:(BOOL)animated;// ËøîÂõûÂà∞Ê†πÊéßÂà∂Âô®-(NSArray *)popToRootViewControllerAnimated:(BOOL)animated; ÈÇ£‰πàÂ¶Ç‰ΩïËé∑ÂèñË¶Å pop Âà∞ÁöÑÊéßÂà∂Âô®Âë¢Ôºü 12345678/// ÂΩìÂâçÁÆ°ÁêÜÁöÑÊâÄÊúâÁöÑÊéßÂà∂Âô®@property(nonatomic,copy) NSArray&lt;__kindof UIViewController *&gt; *viewControllers;/// Ê†àÈ°∂ÊéßÂà∂Âô®@property(nullable, nonatomic,readonly,strong) UIViewController *topViewController;/// ÂΩìÂâçÂèØËßÅÁöÑVCÔºåÂèØËÉΩÊòØtopViewControllerÔºå‰πüÂèØËÉΩÊòØÂΩìÂâçtopViewController present(modal)Âá∫Êù•ÁöÑVCÔºåÊÄªËÄåË®Ä‰πãÂ∞±ÊòØÂèØËßÅÁöÑVC@property(nullable, nonatomic,readonly,strong) UIViewController *visibleViewController; Ê≥®ÊÑèÔºåtopViewController‰∏évisibleViewControllerÂ§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ÄÊ†∑Ôºå‰πüÊúâÂèØËÉΩ‰∏çÂêå ÂØºËà™Êù°Âü∫Êú¨Â±ûÊÄßNaviagationItem Êù•ÂÜ≥ÂÆöÂ§ßÈÉ®ÂàÜÁöÑÊòæÁ§∫‰∏éÊéßÂà∂„ÄÇÈ¶ñÂÖàÁúãÁúãÊúâÂì™‰∫õÂ±ûÊÄßÔºö 12345678// ‰∏≠Èó¥ÁöÑÊ†áÈ¢òÊñáÂ≠ó@property(nullable, nonatomic,copy) NSString *title;// ‰∏≠Èó¥Ê†áÈ¢òËßÜÂõæ@property(nullable, nonatomic,strong) UIView *titleView;// Ëá™ÂÆö‰πâÂ∑¶‰∏äËßíÁöÑËøîÂõûÊåâÈíÆ@property(nullable, nonatomic,strong) UIBarButtonItem *leftBarButtonItem; ËÆæÁΩÆÈªòËÆ§ËøîÂõûÊåâÈíÆËÆæÁΩÆËøîÂõûÁÆ≠Â§¥ÂØºËà™Ê†èÈªòËÆ§Êúâ‰∏Ä‰∏™ËøîÂõûÁöÑÊåâÈíÆÔºåÊàë‰ª¨ÂèØ‰ª•Ëá™ÂÆö‰πâÂÆÉÁöÑÁÆ≠Â§¥Ôºö 1234567// ËÆæÁΩÆÈ¢úËâ≤Êó∂ÔºåimageWithRenderingMode ËÆæÁΩÆ UIImage Ê∏≤Êüì‰∏∫ÂéüÊù•ÁöÑÈ¢úËâ≤[[UINavigationBar appearance] setBackIndicatorImage:[[UIImage imageNamed:@"back"] imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal]];// ‰ΩøÁî® tintColor ËÆæÁΩÆÈ¢úËâ≤[[UINavigationBar appearance] setBackIndicatorImage:[UIImage imageNamed:@"back"]];[[UINavigationBar appearance] setBackIndicatorTransitionMaskImage:[UIImage imageNamed:@"back"]];[[UINavigationBar appearance] setTintColor:[UIColor lightGrayColor]]; ÈÄöÁî®ÁöÑÈöêËóèËøîÂõûÊñáÂ≠óËøîÂõûÊåâÈíÆÊóÅÁöÑÊ†áÈ¢òÈªòËÆ§ÊòØ‰∏ä‰∏ÄÁ∫ßÈ°µÈù¢ÁöÑ titleÔºåÂèØ‰ª•Â¶Ç‰∏ãËÆæÁΩÆÈöêËóè title: 1[[UIBarButtonItem appearance] setBackButtonTitlePositionAdjustment:UIOffsetMake(-100, 0) forBarMetrics:UIBarMetricsDefault]; ÁâπÊÆäÈ°µÈù¢ËÆæÁΩÆËøîÂõûÊåâÈíÆÊääËá™ÂÆö‰πâÁöÑ barbutton ËÆæÁΩÆÂà∞ backBarButtonItem Âç≥ÂèØ 12let backbtn = UIBarButtonItem(title: "ÂèñÊ∂à", style: UIBarButtonItemStyle.Plain, target:self, action: nil)self.navigationItem.backBarButtonItem = backbtn Ê≥®ÊÑèÔºåËøôÊÆµ‰ª£Á†ÅË¶ÅÂÜôÂú®‰∏ä‰∏Ä‰∏™ÊéßÂà∂Âô®‰∏≠„ÄÇÂõ†‰∏∫ back Ë¶ÅËøîÂõûÁöÑÊòØ‰∏ä‰∏Ä‰∏™ÊéßÂà∂Âô®„ÄÇ Ëá™ÂÆö‰πâÂ∑¶‰æßÊåâÈíÆÊåâÈíÆ‰ΩøÁî®ÁöÑÊòØ UIBarButtonItem Ëøô‰∏™Á±ªÔºåÈÄöËøá initWithCustomView: ÊñπÊ≥ïÂàùÂßãÂåñ„ÄÇ 123456789101112131415- (void)viewDidLoad &#123; [super viewDidLoad]; // Ëá™ÂÆö‰πâÂØºËà™Ê†èÂ∑¶‰æßÊåâÈíÆ UIButton * leftBtn = [UIButton buttonWithType:UIButtonTypeRoundedRect]; leftBtn.frame = CGRectMake(0, 7, 83, 30); leftBtn.backgroundColor = [UIColor orangeColor]; [leftBtn addTarget:self action:@selector(onTap) forControlEvents:UIControlEventTouchUpInside]; UIBarButtonItem * leftItem = [[UIBarButtonItem alloc] initWithCustomView:leftBtn]; self.navigationItem.leftBarButtonItem = leftItem;&#125;// ÁÇπÂáª‰∫ã‰ª∂Â§ÑÁêÜ- (void)onTap &#123; NSLog(@"ÁÇπÂáª‰∫ÜÂØºËà™Ê†èÂ∑¶‰æßÊåâÈíÆ");&#125; Ëá™ÂÆö‰πâÂè≥‰æßÊåâÈíÆÂíåÂ∑¶‰æßÊåâÈíÆÊñπÊ≥ïÁ±ª‰ºº„ÄÇ Ê≥®ÊÑèÔºåËÆæÁΩÆ‰∫Ü leftBarButtonItem Â∞±Êõø‰ª£‰∫ÜÂéüÊù•ÁöÑÁöÑËøîÂõûÊåâÈíÆ„ÄÇÂèØ‰ª•ÈÄöËøáËÆæÁΩÆ self.navigationItem.leftItemsSupplementBackButton = YES; ‰øùÁïôËøîÂõûÊåâÈíÆÂíå leftItems Ëá™ÂÆö‰πâ‰∏≠Èó¥ËßÜÂõæËá™ÂÆö‰πâ‰∏≠Èó¥ËßÜÂõæÊØîËæÉÁÆÄÂçïÔºåÁõ¥Êé•ËÆæÁΩÆ navigationItem ÁöÑ titleView„ÄÇ ÁªôÁ≥ªÁªüÁöÑ leftBarButtonItem Ê∑ªÂä† Badge‰∏äÈù¢ÊèêÂà∞‰∫ÜÂ¶Ç‰ΩïËá™ÂÆö‰πâÂ∑¶‰æßÊåâÈíÆÔºåÊàë‰ª¨ÂèØ‰ª•Âú®Ëá™ÂÆö‰πâÁöÑ Button ‰∏äÊ∑ªÂä† Badge ÂÆûÁé∞ÊïàÊûú„ÄÇÂ¶ÇÊûúÊòØÁ≥ªÁªüÁöÑÂë¢ÔºüÁî±‰∫é leftBarButtonItem ÊòØ UIBarButtonItem ÁöÑÂÆû‰æãÔºåËÄå UIBarButtonItem Âπ∂ÈùûÁªßÊâø‰∫é UIViewÔºåÂèØ‰ª•Êé®ÊµãÂá∫ÔºåUIBarButtonItem ‰∏äÊòæÁ§∫ÁöÑ image Âíå label ÊòØÈöêËóèÁöÑÂ±ûÊÄß„ÄÇ Êàë‰ª¨ÈúÄË¶Å‰ΩøÁî® runtime Êü•Êâæ UIBarButtonItem ‰∏≠ËßÜÂõæÁöÑÂ±ûÊÄßÂêçÔºåÂπ∂‰∏îÈÄöËøá KVCÔºåÊãøÂà∞Ëøô‰∏™ËßÜÂõæÂ±ûÊÄßÔºö 1234567891011121314// UIBarButtonItem+Badge.m#pragma mark - Ëé∑ÂèñBadgeÁöÑÁà∂ËßÜÂõæ- (UIView *)bottomView&#123; // ÈÄöËøáXcodeËßÜÂõæË∞ÉËØïÂ∑•ÂÖ∑ÊâæÂà∞UIBarButtonItemÁöÑBadgeÊâÄÂú®Áà∂ËßÜÂõæ‰∏∫:UIImageView UIView *navigationButton = [self valueForKey:@"_view"]; for (UIView *subView in navigationButton.subviews) &#123; if ([subView isKindOfClass:NSClassFromString(@"UIImageView")]) &#123; subView.layer.masksToBounds = NO; return subView; &#125; &#125; return navigationButton;&#125; ÁªèËøáÊØîÂØπÔºåÂèëÁé∞ËßÜÂõæÂ±ûÊÄßÂêç‰∏∫ _viewÔºåÊãøÂà∞Ëøô‰∏™Â±ûÊÄßÂêéÔºåÂØπÂÖ∂ÂÜÖÈÉ®ËßÜÂõæËøõË°åÈÅçÂéÜÔºåÊâæÂà∞ UIImageView ÁöÑÂØπË±°ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âú® UIImageView ‰∏äÊ∑ªÂä† Badge ‰∫Ü„ÄÇ ÂêåÊ†∑ÁöÑÔºåÊàë‰ª¨ËøòÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÊ≥ïÔºåËá™ÂÆö‰πâ UITabBarItem ÁöÑ Badge 1234567891011#pragma mark - Ëé∑ÂèñBadgeÁöÑÁà∂ËßÜÂõæ- (UIView *)bottomView&#123; // ÈÄöËøáXcodeËßÜÂõæË∞ÉËØïÂ∑•ÂÖ∑ÊâæÂà∞UITabBarItemÂéüÁîüBadgeÊâÄÂú®Áà∂ËßÜÂõæ‰∏∫:UITabBarSwappableImageView UIView *tabBarButton = [self valueForKey:@"_view"]; for (UIView *subView in tabBarButton.subviews) &#123; if ([subView isKindOfClass:NSClassFromString(@"UITabBarSwappableImageView")]) &#123; return subView; &#125; &#125; return tabBarButton;&#125; Demo ÂèÇËÄÉËá™:iOS: Êïô‰Ω†Áªô UI Êéß‰ª∂Ê∑ªÂä† Badge(Ê∂àÊÅØÊèêÈÜíÂ∞èÂúÜÁÇπ) Ëá™ÂÆö‰πâÂè≥‰∏äËßíÊåâÈíÆÊàñÂ§ö‰∏™ÊåâÈíÆ123@property(nullable, nonatomic,strong) UIBarButtonItem *rightBarButtonItem;/// ‰∏ÄÊ¨°ËÆæÁΩÆÂ§ö‰∏™ÊåâÈíÆ@property(nullable,nonatomic,copy) NSArray&lt;UIBarButtonItem *&gt; *rightBarButtonItems; ËÆæÁΩÆ navigationItem Â≠ó‰ΩìÊ†ºÂºèÂèØ‰ª•ÈÄöËøá [UINavigationBar appearance] ÊñπÊ≥ï ËÆæÁΩÆÔºö 1[[UINavigationBar appearance]setTitleTextAttributes:@&#123;NSForegroundColorAttributeName:[UIColor whiteColor],NSFontAttributeName:[UIFont systemFontOfSize:18]&#125;]; Ëøô‰∏™ËÆæÁΩÆÂíåÊòØÂê¶ÈöêËóèÂØºËà™Ê†è‰∏ÄÊ†∑ÔºåÈÉΩÊòØÂÖ®Â±ÄÁöÑÔºåÊó†Ê≥ïÂ≠§Á´ãÂú∞ËÆæÁΩÆÊüê‰∏Ä‰∏™ ViewController„ÄÇÂ¶ÇÊûúÊúâ‰∏Ä‰∏™Âú∞ÊñπÈúÄË¶ÅÁâπÊÆäËÆæÁΩÆÔºåÈÇ£‰πàÈúÄË¶ÅÂú®ÂÖ∂ÂÆÉÂú∞ÊñπÂÜçËÆæÁΩÆÂõûÂéª„ÄÇ Êìç‰Ωú navigationItem‰∏äÈù¢Êàë‰ª¨ÁúãÂà∞Êìç‰Ωú navigationBar ÈÉΩÊòØÈÄöËøá self.navigationController.navigationBarÔºåÊìç‰Ωú navigationItem ÈÉΩÊòØÈÄöËøá self.navigationItem„ÄÇ ‰∫ãÂÆû‰∏äÔºåUINavigationController Âπ∂Ê≤°ÊúânavigationItemËøôÊ†∑‰∏Ä‰∏™Áõ¥Êé•ÁöÑÂ±ûÊÄßÔºåÁî±‰∫é UINavigationController ÁªßÊâø‰∫é UIViewController ,ËÄå UIViewController ÊòØÊúânavigationItemËøô‰∏™Â±ûÊÄßÁöÑÊòØÔºåÊâÄ‰ª•ÂØπ navigationController ‰ΩøÁî®ÁÇπËØ≠Ê≥ïËé∑Âèñ navigationItem ÊòØÁºñËØëÂæóËøáÁöÑÔºå‰ΩÜÊòØËøôÊ†∑Êìç‰ΩúÊòØÊ≤°ÊúâÊïàÊûúÁöÑ„ÄÇ NavigationItem ÊòØ‰∏Ä‰∏™ NSObject ÂØπË±°ÔºåÈáåÈù¢‰øùÂ≠ò‰∫ÜÂØºËà™Ê†è‰∏äÁöÑÂêÑ‰∏™ viewÔºõ NavigationBar ÊòØ‰∏Ä‰∏™ UIView ÂØπË±°ÔºåNavigationItem ‰∏≠ÁöÑÂêÑ‰∏™ view ÈÉΩË¢´Ê∑ªÂä†Âà∞ÂÖ∂‰∏ä UINavigationController ËøîÂõûÊâãÂäøÂ§±ÊïàÁ≥ªÁªü‰∏∫ UINavigationController Êèê‰æõ‰∫Ü‰∏Ä‰∏™ interactivePopGestureRecognizer Áî®‰∫éÂè≥ÊªëËøîÂõû(pop),‰ΩÜÊòØÔºåÂ¶ÇÊûúËá™ÂÆö‰∫Ü left button ÊàñËÄÖÈöêËóè‰∫Ü navigationBar ÔºåËØ•ÊâãÂäøÂ∞±Â§±Êïà‰∫Ü„ÄÇÊàë‰ª¨ÈúÄË¶ÅËá™Â∑±ÂÆûÁé∞‰∏Ä‰∏ã delegate ÊñπÊ≥ï; ‰∏çËøá‰∏ÄËà¨Êàë‰ª¨ÊúÄÂ•ΩËøòÊòØ‰ΩøÁî®ÈªòËÆ§ÁöÑ backbutton ËøîÂõû‰∏∫Â•Ω„ÄÇ‰∏ÄËà¨Ëá™ÂÆö‰πâ‰∫Ü left buttonÔºåÂπ∂‰∏îÈöêËóè‰∫Ü backbutton ÁöÑÊÉÖÂÜµÔºåÈÉΩÂ∫îËØ•ÊòØ‰∏çËÆ©Áî®Êà∑ËÉΩÂ§üÁõ¥Êé•ËøîÂõûÁöÑÊÉÖÂÜµ„ÄÇ Êñ∞Âª∫‰∏Ä‰∏™ BaseNavigationController ÂÆûÁé∞ delegateÔºö 1234- (void)viewDidLoad &#123; [super viewDidLoad]; self.interactivePopGestureRecognizer.delegate = self;&#125; ÈúÄË¶ÅÂÆûÁé∞ÁöÑ‰ª£ÁêÜÊñπÊ≥ïÔºö 1234567891011- (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer &#123; if (gestureRecognizer == self.interactivePopGestureRecognizer) &#123; //Â±èËîΩË∞ÉÁî®rootViewControllerÁöÑÊªëÂä®ËøîÂõûÊâãÂäøÔºåÈÅøÂÖçÂè≥ÊªëËøîÂõûÊâãÂäøÂºïËµ∑Ê≠ªÊú∫ÈóÆÈ¢ò if (self.viewControllers.count &lt; 2 || self.visibleViewController == [self.viewControllers objectAtIndex:0]) &#123; return NO; &#125; &#125; //ËøôÈáåÂ∞±ÊòØÈùûÂè≥ÊªëÊâãÂäøË∞ÉÁî®ÁöÑÊñπÊ≥ïÂï¶ÔºåÁªü‰∏ÄÂÖÅËÆ∏ÊøÄÊ¥ª return YES;&#125; ËÄÉËôëÂà∞Âú® push Âä®ÁîªÂèëÁîüÁöÑÊó∂ÂÄôÔºåË¶ÅÁ¶ÅÊ≠¢ÊªëÂä®ÊâãÂäøÔºåÊâÄ‰ª•ÁªßÁª≠Âú® BaseNavigationController ‰∏≠ÂÆûÁé∞‰ª£ÁêÜÊñπÊ≥ïÔºåÁ¶ÅÊ≠¢ÊªëÂä®ÊâãÂäøÔºö 1234- (void)pushViewController:(UIViewController *)viewController animated:(BOOL)animated &#123; [super pushViewController:viewController animated:animated]; self.interactivePopGestureRecognizer.enabled = NO;&#125; ÁÑ∂ÂêéÂú®Êñ∞ push Âá∫Êù•ÁöÑ ViewController ‰∏≠ËÆæÁΩÆÂêØÁî®ÊªëÂä®ÊâãÂäøÔºö 1234- (void)viewDidAppear:(BOOL)animated &#123; [super viewDidAppear:animated]; self.navigationController.interactivePopGestureRecognizer.enabled = YES;&#125; ËøôÁßçÊòØÂºÄÂêØ‰∫ÜÂÖ®Â±ÄÁöÑÂè≥ÊªëËøîÂõûÔºåÂØπ‰∫éÁâπÂÆöÈ°µÈù¢ÁöÑÁ¶ÅÁî®Âè≥ÊªëÊâãÂäøÂèØ‰ª•ÈÄöËøáÔºö 1234567- (void)viewDidAppear:(BOOL)animated &#123; self.navigationController.interactivePopGestureRecognizer.enabled = NO;&#125;- (void)viewWillDisappear:(BOOL)animated &#123; self.navigationController.interactivePopGestureRecognizer.enabled = YES;&#125; ÂØºËà™Ê†èÈöêËóèÂØºËà™Ê†è123- (void)viewWillAppear:(BOOL)animated&#123; [self.navigationController setNavigationBarHidden:YES animated:animated];&#125; Ëøô‰∏™ÊñπÊ≥ïËÆæÁΩÆ‰πãÂêéÔºåÂêéÈù¢ÁöÑÈ°µÈù¢ÁöÑÂØºËà™Ê†è‰πüÈÉΩÈöêËóè‰∫Ü„ÄÇÊâÄ‰ª•Ë¶ÅÊ≥®ÊÑè‰∏Ä‰∏™ÂéüÂàôÔºåÂú®ÂΩìÂâçÈ°µÈù¢ viewWillAppear ÊñπÊ≥ï‰∏≠ÂÅöÁöÑ‰øÆÊîπÔºå‰πüË¶ÅÂú®ÂΩìÂâçÈ°µÈù¢ÁöÑ viewWillDisappear ‰∏≠ËøòÂéüÂõûÊù•„ÄÇ ‰øÆÊîπÂØºËà™Ê†èËÉåÊôØËâ≤ÈîôËØØÁ§∫ËåÉ12345- (void)viewDidLoad &#123; [super viewDidLoad]; // Êó†ÊïàÊûú self.navigationController.navigationBar.backgroundColor = [UIColor redColor];&#125; Ëøô‰∏™ÊñπÊ≥ïÊó†Ê≥ïËææÂà∞ÁêÜÊÉ≥ÊïàÊûúÔºå‰∏äÈù¢‰ºöÁõñ‰∏äÁôΩËâ≤ÁöÑ‰∏ÄÂ±Ç UIImageViewÔºåÂøÖÈ°ªÁõ¥Êé•ËÆæÁΩÆËøô‰∏™ UIImageView ÊâçËÉΩËææÂà∞ÁêÜÊÉ≥ÁöÑÊïàÊûú„ÄÇ Ê≠£Á°ÆÁ§∫ËåÉ1[self.navigationController.navigationBar setBackgroundImage:[UIImage imageNamed:@"xxx"] forBarMetrics:UIBarMetricsDefault]; Â∞±ÂÉè‰∏äÈù¢ËØ¥ÁöÑÔºåÂøÖÈ°ªË¶ÅÁõ¥Êé•ËÆæÁΩÆ UIImageViewÔºåÂèØ‰ª•Ëá™Â∑±ÂÜô‰∏™Á∫ØËâ≤ÁöÑ UIImage ‰πüÂèØ‰ª•Áõ¥Êé•Êîæ‰∏ÄÂº†ÂõæÁâá„ÄÇ ËÆæÁΩÆÂØºËà™Ê†èÈÄèÊòéÂ∫¶ËÆæÁΩÆÂØºËà™Ê†èÈÄèÊòéÂ∫¶ÈúÄË¶ÅËá™Â∑±ÂàõÂª∫‰∏Ä‰∏™Â∏¶ÊúâÈÄèÊòéÂ∫¶ÁöÑ UIImage: 1234567891011121314// ËÉåÊôØËâ≤UIImage *image = [self imageWithColor:[color colorWithAlphaComponent:alpha]];[self.navigationController.navigationBar setBackgroundImage:image forBarMetrics:UIBarMetricsDefault];- (UIImage *)imageWithColor:(UIColor *)color &#123; CGRect rect = CGRectMake(0, 0, 1, 1); UIGraphicsBeginImageContext(rect.size); CGContextRef context = UIGraphicsGetCurrentContext(); CGContextSetFillColorWithColor(context, [color CGColor]); CGContextFillRect(context, rect); UIImage *image = UIGraphicsGetImageFromCurrentImageContext(); UIGraphicsEndImageContext(); return image;&#125; ËøôÈáåÂè™ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂÉèÁ¥†ÁöÑÂõæÁâáÔºå‰ΩÜÊòØËøòÊòØËÉΩËææÂà∞Âπ≥Èì∫Êï¥‰∏™ÂØºËà™Ê†èÁöÑÊïàÊûú„ÄÇ ÂàõÂª∫ÁöÑ UIImage ÁöÑÂ§ßÂ∞èÂè™Êúâ‰∏Ä‰∏™ÂÉèÁ¥†ÁöÑÂ•ΩÂ§ÑÊòØËäÇÁ∫¶ CPU ËµÑÊ∫ê„ÄÇ ÈöêËóèÂØºËà™Ê†èÂ∫ïÈÉ®ÁöÑÂàÜÂâ≤Á∫øÂ∞±ÊòØËÆæÁΩÆ‰∏Ä‰∏™ÈÄèÊòéÁöÑÂõæÁâáÔºåÂíåËÆæÁΩÆÂØºËà™Ê†èËÉåÊôØËâ≤‰∏Ä‰∏™ÈÅìÁêÜ„ÄÇ 123UINavigationBar *navigationBar = self.navigationController.navigationBar;//Ê≠§Â§Ñ‰ΩøÂ∫ïÈÉ®Á∫øÊù°Â§±Êïà[navigationBar setShadowImage:[UIImage new]]; ÂØºËà™Ê†èÁöÑÂá†‰∏™Â±ûÊÄßËøô‰∫õÂ±ûÊÄß‰∏ÄËà¨Áî®Â§Ñ‰∏çÂ§ßÔºå‰ΩÜÊòØÊúâÁÇπÂç∞Ë±°Â∞±Ë°å‰∫Ü„ÄÇ‰ª•‰∏ã‰∏∫ÈªòËÆ§ÂÄº 1234self.navigationController.navigationBar.translucent = YES;self.edgesForExtendedLayout = UIRectEdgeAll;self.automaticallyAdjustsScrollViewInsets = YES;self.extendedLayoutIncludesOpaqueBars = NO; ÂØºËà™ÂçäÈÄèÊòéÁöÑÊó∂ÂÄô ËÆæÁΩÆ edgesForExtendedLayout ‰∏∫ UIRectEdgeAll ÔºåËßÜÂõæ‰ºöÂª∂‰º∏Âà∞ÂØºËà™Ê†è‰∏ã„ÄÇÈªòËÆ§‰∏∫ YES Ê≠§Êó∂ÈªòËÆ§ automaticallyAdjustScrollViewInsets ‰∏∫ YES„ÄÇScrollView ‰ºöËá™Âä®ËÆæÁΩÆ contentInset ËÆæÁΩÆedgesForExtendedLayout ‰∏∫ UIRectEdgeNone ÔºåËßÜÂõæ‰∏ç‰ºöÂª∂‰º∏„ÄÇ ÂØºËà™Ê†è‰∏çÈÄèÊòéÁöÑÊó∂ÂÄô ËÆæÁΩÆ edgesForExtendedLayout Êó†Êïà„ÄÇ ËÆæÁΩÆ extendedLayoutIncludesOpaqueBars ‰∏∫ YESÔºåÂèØ‰ª•Âª∂‰º∏Âà∞‰∏çÈÄèÊòéÁöÑÂØºËà™Ê†è‰∏ã ËÆæÁΩÆextendedLayoutIncludesOpaqueBars ‰∏∫ NOÔºå‰∏ç‰ºöÂª∂‰º∏Âà∞ÈÄèÊòéÁöÑÂØºËà™Ê†èÁ≥ª‰∏ãÔºåÈªòËÆ§‰∏∫ NO Êõ¥ÊîπÈ°∂ÈÉ®Áä∂ÊÄÅÊ†èÈ¢úËâ≤ Âú®Â∑•Á®ãÁöÑInfo.plistÊñá‰ª∂‰∏≠Ê∑ªÂä†‰∏ÄË°åUIViewControllerBasedStatusBarAppearanceÔºåÈÄâÊã©BooleanÁ±ªÂûãÔºåÂπ∂ËÆæÁΩÆ‰∏∫YESÔºåXcode‰ºöËá™Âä®ÊääÂêçÁß∞Âèò‰∏∫View controller-based status bar appearance„ÄÇ Âú®‰Ω†ÁöÑViewController‰∏≠Ê∑ªÂä†‰∏ãÈù¢ÁöÑÊñπÊ≥ï 1234-(UIStatusBarStyle)preferredStatusBarStyle&#123; // return UIStatusBarStyleDefault; ÈªëËâ≤ return UIStatusBarStyleLightContent; // ÁôΩËâ≤&#125; Ë∞ÉÁî® UIViewController ÁöÑ setNeedsStatusBarAppearanceUpdate ÊñπÊ≥ïÔºåÈÄöÁü•Áä∂ÊÄÅÊ†èÈ¢úËâ≤ÊîπÂèò‰∫Ü„ÄÇ ÂÖ®Â±èÊªëÂä®ËøîÂõûÂÆûÁé∞ÂÖ®Â±èÊªëÂä®ËøîÂõû‰ªÖÈúÄÂú®ÂØºËà™Ê†èÁªôÂØºËà™Ê†èÊ∑ªÂä†UIGestureRecognizerDelegateÂçèËÆÆÔºåÂπ∂Âú®ViewDidLoad‰∏≠ËÆæÁΩÆ„ÄÇÂÖ≥ÈîÆÂú®‰∫éË∞ÉÁî®Á≥ªÁªüËøîÂõûÂ§ÑÁêÜÊñπÊ≥ï hyandleNavigationTransition 1234567891011121314// Ëé∑ÂèñÁ≥ªÁªüËá™Â∏¶ÊªëÂä®ÊâãÂäøÁöÑtargetÂØπË±°id target = self.interactivePopGestureRecognizer.delegate;// ÂàõÂª∫ÂÖ®Â±èÊªëÂä®ÊâãÂäøÔºåË∞ÉÁî®Á≥ªÁªüËá™Â∏¶ÊªëÂä®ÊâãÂäøÁöÑtargetÁöÑactionÊñπÊ≥ïUIPanGestureRecognizer *pan = [[UIPanGestureRecognizer alloc] initWithTarget:target action:@selector(handleNavigationTransition:)];// ËÆæÁΩÆÊâãÂäø‰ª£ÁêÜÔºåÊã¶Êà™ÊâãÂäøËß¶Âèëpan.delegate = self;// ÁªôÂØºËà™ÊéßÂà∂Âô®ÁöÑviewÊ∑ªÂä†ÂÖ®Â±èÊªëÂä®ÊâãÂäø[self.view addGestureRecognizer:pan];// Á¶ÅÊ≠¢‰ΩøÁî®Á≥ªÁªüËá™Â∏¶ÁöÑÊªëÂä®ÊâãÂäøself.interactivePopGestureRecognizer.enabled = NO; ÂØºËà™Ê†èËøáÊ∏°ÂØºËà™Ê†èËøáÊ∏°ÊòØ‰∏Ä‰∏™ÈúÄË¶ÅÂ•ΩÂ•ΩËÆæËÆ°ÁöÑÂäüËÉΩ„ÄÇÂ¶ÇÊûúÂÅöÂæó‰∏çÂ•ΩÔºåpush Âíå pop Êó∂ÂÄô‰ºöÈùûÂ∏∏ÂÉµÁ°¨„ÄÇ ÊØîËæÉÂ•ΩÁöÑÊñπÂºèÊòØÈÄöËøá Method Swizzling Ëé∑ÂèñÁ≥ªÁªüÊñπÊ≥ï _updateInteractiveTransition ÊãøÂà∞ÂΩìÂâçÁöÑËøõÂ∫¶„ÄÇ ÂÖ∑‰ΩìÂèØÂèÇËÄÉÂ¶Ç‰∏ã‰∏§ÁØáÊñáÁ´†Ôºö iOS: ËÆ∞‰∏ÄÊ¨°ÂØºËà™Ê†èÂπ≥ÊªëËøáÊ∏°ÁöÑÂÆûÁé∞ Ë∂ÖÁÆÄÂçïÔºÅÔºÅÔºÅ iOSËÆæÁΩÆÁä∂ÊÄÅÊ†è„ÄÅÂØºËà™Ê†èÊåâÈíÆ„ÄÅÊ†áÈ¢ò„ÄÅÈ¢úËâ≤„ÄÅÈÄèÊòéÂ∫¶ÔºåÂÅèÁßªÁ≠â Â¶ÇÊûúË¶ÅÊ±Ç‰∏çÈ´òÔºåÂØπ‰∫éÁâπÊÆäÁöÑÈ°µÈù¢ÔºåÁõ¥Êé•Âú® viewWillAppear Âíå viewWillDisapper ‰∏≠ÈÄöËøá [self.navigationController setNavigationBarHidden:YES animated:YES] ÊòæÁ§∫ÂíåÈöêËóèÂç≥ÂèØ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Âü∫Êú¨Êéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UITextField ÁÆÄ‰ªã]]></title>
    <url>%2F2017%2F04%2F23%2FUITextField%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[UITextFied ÊòØÁªèÂ∏∏Áî®Âà∞ÁöÑ‰∏Ä‰∏™Êéß‰ª∂„ÄÇËøòÊòØÊúâ‰∏Ä‰∫õÁÇπÈúÄË¶ÅÊ≥®ÊÑèÁöÑ„ÄÇ Âü∫Êú¨Â±ûÊÄßÊåëÈÄâ‰∏Ä‰∫õÂèØËÉΩ‰ºöÂøòËÆ∞ÈúÄË¶ÅÊü•ÈòÖÁöÑÂ∏∏Áî®ÁöÑÂü∫Êú¨Â±ûÊÄßÔºåÂèØËÉΩ‰∏çÂÆåÂÖ®ÔºåÊØîÂ¶ÇËÉåÊôØËâ≤ÂïäÔºåÂç†‰ΩçÁ¨¶ÂïäÔºåËÆæÁΩÆÂíåËØªÂèñÊñáÂ≠óÂïäÈÉΩÊ≤°ÂàóÂÖ•„ÄÇ ËÆæÁΩÆËæπÊ°ÜÊ†∑Âºè1234567textField.borderStyle = UITextBorderStyleRoundedRect;//ÂúÜËßí//ÂèØÈÄâÂ±ûÊÄßÔºöUITextBorderStyleNone,Êó†ËæπÊ°ÜUITextBorderStyleLine,ÊúâËæπÊ°ÜUITextBorderStyleBezel,ÊúâËæπÊ°ÜÂíåÈò¥ÂΩ±UITextBorderStyleRoundedRectÂúÜËßí ËÆæÁΩÆÂ≠ó‰Ωì1[textField setFont:[UIFont fontWithName:@"Arial" size:30]]; ÂØÜÊñáËæìÂÖ•1textField.secureTextEntry = YES; ÈîÆÁõòÁ±ªÂûã12345678910textField.keyboardType = UIKeyboardTypeNumberPad; Êï∞Â≠óÈîÆ//ÂÖ®ÈÉ®Á±ªÂûã UIKeyboardTypeDefault,ÂΩìÂâçÈîÆÁõòÔºàÈªòËÆ§ÔºâUIKeyboardTypeASCIICapable,Â≠óÊØçËæìÂÖ•ÈîÆUIKeyboardTypeNumbersAndPunctuation,Êï∞Â≠óÂíåÁ¨¶Âè∑UIKeyboardTypeURL,URLÈîÆÁõòUIKeyboardTypeNumberPad,Êï∞Â≠óÈîÆÁõòUIKeyboardTypePhonePad,ÁîµËØùÂè∑Á†ÅËæìÂÖ•ÈîÆÁõò UIKeyboardTypeEmailAddress,ÈÇÆ‰ª∂Âú∞ÂùÄËæìÂÖ•ÈîÆÁõò ÈîÆÁõòÈ£éÊ†º12345textView.keyboardAppearance=UIKeyboardAppearanceDefaultÔºõ//ÂèØÈÄâÂ±ûÊÄßUIKeyboardAppearanceDefaultÔºå ÈªòËÆ§Â§ñËßÇÔºåÊµÖÁÅ∞Ëâ≤UIKeyboardAppearanceAlertÔºå Ê∑±ÁÅ∞ Áü≥Â¢®Ëâ≤ ËÆæÁΩÆÂ∑¶Âè≥ËßÜÂõætextField ÂèØ‰ª• leftView Âíå rightViewÔºåÊñáÊú¨ËæìÂÖ•Âå∫ÂüüÂú®‰∏§ËÄÖ‰πãÈó¥„ÄÇËÆæÁΩÆÊ∏ÖÈô§ÊåâÈíÆÊ†∑Âºè 12textField.clearButtonMode = UITextFieldViewModeAlways;//ModeÂêåÂ∑¶Âè≥ËßÜÂõæÁöÑmode‰∏ÄÊ†∑„ÄÇ ÂÜçÊ¨°ÁºñËæëÊó∂ÊòØÂê¶Ê∏ÖÈô§‰πãÂâçÂÜÖÂÆπ12// ÈªòËÆ§ÊòØNOtextField.clearsOnBeginEditing = YES ÂØπÈΩêÊñπÂºèÂûÇÁõ¥ÂØπÈΩêÔºö 1234567textField.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter //ÂèØÈÄâÂ±ûÊÄßÔºöUIControlContentVerticalAlignmentCenter Â±Ö‰∏≠ÂØπÈΩêUIControlContentVerticalAlignmentTop È°∂ÈÉ®ÂØπÈΩêÔºåÈªòËÆ§ÊòØÈ°∂ÈÉ®ÂØπÈΩêUIControlContentVerticalAlignmentBottom Â∫ïÈÉ®ÂØπÈΩêUIControlContentVerticalAlignmentFill ÂÆåÂÖ®Â°´ÂÖÖ Ê∞¥Âπ≥ÂØπÈΩêÔºö 123456textField.textAlignment = UITextAlignmentCenter;//ÂèØÈÄâÂ±ûÊÄßÔºöUITextAlignmentLeftÔºåÂ∑¶ÂØπÈΩêÔºåÈªòËÆ§ÊòØÂ∑¶ÂØπÈΩêUITextAlignmentCenterÔºåUITextAlignmentRightÔºåÂè≥ÂØπÈΩê ËÆæÁΩÆÊªöÂä®1textField.adjustsFontSizeToFitWidth = YES; ÈªòËÆ§ÊòØ NO„ÄÇÂΩìÊòØ YESÂΩìÂÖÖÊª°ËæπÊ°ÜÊó∂ÔºåÊñáÂ≠ó‰ºöÁº©Â∞èÔºåÂΩìÂ∞èÂà∞‰∏ÄÂÆöÁ®ãÂ∫¶Êó∂‰ªçÁÑ∂‰ºöÊªöÂä®„ÄÇ 1textField.minimumFontSize = 20; ËÆæÁΩÆÊªöÂä®Êó∂ÂÄôÁöÑÊúÄÂ∞èÂ≠óÂè∑„ÄÇ ËÆæÁΩÆreturnÈîÆ1234567891011121314textField.returnKeyType = UIReturnKeyGoogle;search//ÂèØÈÄâÂ±ûÊÄßUIReturnKeyDefault, ÈªòËÆ§ ÁÅ∞Ëâ≤ÊåâÈíÆÔºåÊ†áÊúâReturnUIReturnKeyGo,Ê†áÊúâGoÁöÑËìùËâ≤ÊåâÈíÆUIReturnKeyGoogle,Ê†áÊúâGoogleÁöÑËìùËâ≤ÊåâÈíÆÔºåÁî®ËØ≠ÊêúÁ¥¢UIReturnKeyJoin,Ê†áÊúâJoinÁöÑËìùËâ≤ÊåâÈíÆUIReturnKeyNext,Ê†áÊúâNextÁöÑËìùËâ≤ÊåâÈíÆUIReturnKeyRoute,Ê†áÊúâRouteÁöÑËìùËâ≤ÊåâÈíÆUIReturnKeySearch,Ê†áÊúâSearchÁöÑËìùËâ≤ÊåâÈíÆUIReturnKeySend,Ê†áÊúâSendÁöÑËìùËâ≤ÊåâÈíÆUIReturnKeyYahoo,Ê†áÊúâYahooÁöÑËìùËâ≤ÊåâÈíÆUIReturnKeyYahoo,Ê†áÊúâYahooÁöÑËìùËâ≤ÊåâÈíÆUIReturnKeyEmergencyCall, Á¥ßÊÄ•ÂëºÂè´ÊåâÈíÆ ÊñáÊú¨ÁºñËæëÊ°Ü‰ª£ÁêÜÈ¶ñÂÖàË¶ÅÊ≥®ÊÑèÔºåÂøÖÈ°ªÂÖàËÆæÁΩÆÂΩìÂâç textField ÁöÑ delegateÔºåÂê¶Âàô‰∏ãÈù¢ÁöÑÂõûË∞ÉÊó†Ê≥ïÂìçÂ∫î„ÄÇÂèØ‰ª•‰ª£Á†ÅËÆæÁΩÆÔºå‰πüÂèØ‰ª•Âú® xib ‰∏≠ËøûÂΩìÂâç textField ÁöÑ delegate Âà∞ file&#39;s owner ‰∏ä„ÄÇ ÊòØÂê¶ËøõÂÖ•ÁºñËæëÊ®°Âºè1- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField ÈªòËÆ§ËøîÂõûYESÔºåËøõÂÖ•ÁºñËæëÊ®°Âºè„ÄÇNO‰∏çËøõÂÖ•ÁºñËæëÊ®°Âºè„ÄÇ ËøõÂÖ•ÁºñËæëÊ®°Âºè1- (void)textFieldDidBeginEditing:(UITextField *)textField ÊòØÂê¶ÈÄÄÂá∫ÁºñËæëÊ®°Âºè1- (BOOL)textFieldShouldEndEditing:(UITextField *)textField ÈªòËÆ§ËøîÂõûYESÔºåÈÄÄÂá∫ÁºñËæëÊ®°Âºè„ÄÇNO‰∏çÈÄÄÂá∫ÁºñËæëÊ®°Âºè ÈÄÄÂá∫ÁºñËæëÊ®°Âºè1- (void)textFieldDidEndEditing:(UITextField *)textField ÁÇπÂáªÊ∏ÖÈô§ÊåâÈíÆÊòØÂê¶Ê∏ÖÁ©∫1- (BOOL)textFieldShouldClear:(UITextField *)textField ÈªòËÆ§ËøîÂõûYESÔºåËøîÂõûNO‰∏çÊ∏ÖÈô§„ÄÇ ÁÇπÂáªÈîÆÁõò‰∏äReturnÊåâÈíÆÊó∂ÂÄôË∞ÉÁî®1- (BOOL)textFieldShouldReturn:(UITextField *)textField ËæìÂÖ•‰ªª‰ΩïÂ≠óÁ¨¶ÁöÑÊó∂ÂÄôË∞ÉÁî®ËØ•ÊñπÊ≥ï1-(BOOL)textField:(UITextField *)field shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string ÂΩìËæìÂÖ•Â≠óÁ¨¶Êó∂Ôºå‰ª£ÁêÜË∞ÉÁî®ËØ•ÊñπÊ≥ïÔºåÂ¶ÇÊûúËøîÂõûYESÂàôËøôÊ¨°ËæìÂÖ•ÂèØ‰ª•ÊàêÂäüÔºåÂ¶ÇÊûúËøîÂõûNOÔºå‰∏çËÉΩËæìÂÖ•ÊàêÂäü„ÄÇrangeË°®Á§∫ÂÖâÊ†á‰ΩçÁΩÆÔºåstringË°®Á§∫ËøôÊ¨°ËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ ‰∏Ä‰∫õÊäÄÂ∑ßÂÖ®Â±èËß¶Êë∏ÂÖ≥Èó≠ÁõëÂê¨ÊâãÂäøÔºåÂΩìÁÇπÂáªÂºÄÂßãÊó∂ÔºåÂÖ≥Èó≠ textfield 123- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123; [self.textField resignFirstResponder];&#125; Â¶ÇÊûú‰Ω†‰∏çËÉΩÊãøÂà∞ textfield ÁöÑÂÆû‰æãÔºåÂÖ∂ÂÆûÂèØ‰ª•Áõ¥Êé•ËÆæÁΩÆ endEditing Â±ûÊÄßÔºåË°®Á§∫ÁªìÊùüÁºñËæëÔºö 1[self.view endEditing:YES]; ÈôêÂà∂ÈïøÂ∫¶‰ΩøÁî®‰∏äÈù¢ÁöÑ shouldChangeCharactersInRange: ÊñπÊ≥ïÔºö 12345678910111213141516171819- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string&#123; //stringÂ∞±ÊòØÊ≠§Êó∂ËæìÂÖ•ÁöÑÈÇ£‰∏™Â≠óÁ¨¶textFieldÂ∞±ÊòØÊ≠§Êó∂Ê≠£Âú®ËæìÂÖ•ÁöÑÈÇ£‰∏™ËæìÂÖ•Ê°ÜËøîÂõûYESÂ∞±ÊòØÂèØ‰ª•ÊîπÂèòËæìÂÖ•Ê°ÜÁöÑÂÄºNOÁõ∏Âèç //Êåâ‰ºöËΩ¶ÂèØ‰ª•ÊîπÂèò if ([string isEqualToString:@"\n"])&#123; return YES; &#125; NSString * toBeString = [textField.text stringByReplacingCharactersInRange:range withString:string]; //ÂæóÂà∞ËæìÂÖ•Ê°ÜÁöÑÂÜÖÂÆπ //Âà§Êñ≠ÊòØÂê¶Êó∂Êàë‰ª¨ÊÉ≥Ë¶ÅÈôêÂÆöÁöÑÈÇ£‰∏™ËæìÂÖ•Ê°Ü if (self.myTextField == textField)&#123; if ([toBeString length] &gt; 20) &#123; //Â¶ÇÊûúËæìÂÖ•Ê°ÜÂÜÖÂÆπÂ§ß‰∫é20ÂàôÂºπÂá∫Ë≠¶Âëä textField.text = [toBeString substringToIndex:20]; UIAlertView *alert = [[[UIAlertView alloc] initWithTitle:nil message:@"Ë∂ÖËøáÊúÄÂ§ßÂ≠óÊï∞‰∏çËÉΩËæìÂÖ•‰∫Ü" delegate:nil cancelButtonTitle:@"Ok" otherButtonTitles:nil, nil] autorelease]; [alert show]; return NO; &#125; &#125; return YES; &#125; UITextFieldËæìÂÖ•‰∏≠ÊñáÊó∂ÊñáÂ≠ó‰∏ãÊ≤âÁöÑËß£ÂÜ≥ÊñπÊ≥ïÂá∫Áé∞ÊÉÖÂÜµÔºöÂú® xib ÂàõÂª∫ÁöÑ UITextField ‰∏≠ËæìÂÖ•‰∏≠ÊñáÁöÑÊó∂ÂÄôÔºåBorder Style Ëøô‰∏™Â±ûÊÄßËÆæÁΩÆ‰∏∫Á¨¨‰∏ÄÁßç UITextBorderStyleNoneÔºåÂêåÊó∂ Clear Button ËÆæÁΩÆ‰∏∫ Never appears Êó∂‰ºöÂá∫Áé∞ËøôÁßçÊÉÖÂÜµ Ëß£ÂÜ≥ÊñπÊ≥ïÔºöÂèØ‰ª•ËÆæÁΩÆ Clear Button ÁöÑÂá∫Áé∞Êó∂Êú∫ÔºåÊàñËÄÖËÆæÁΩÆ Border Style ‰∏∫ÂÖ∂‰ªñÁ±ªÂûã „ÄÇÂ¶ÇÊûú‰∏ÄÂÆöË¶ÅÊòØËøôÁßç Border Style Âíå Clear ButtonÔºåÈÇ£‰πàÂèØ‰ª•Â∞Ü xib ‰∏≠ÁöÑ UITextField ÊãñÂá∫Êù•ÔºåÈÄöËøá‰ª£Á†ÅËÆæÁΩÆ Border Style ÁöÑÊñπÂºèËÆæÁΩÆÂÖ∂‰∏∫UITextBorderStyleNone (Âú® xib ‰∏≠Ë¶ÅÂÖàËÆæÁΩÆ‰∏∫ÂÖ∂‰ªñÁöÑÂÜçÂú®‰ª£Á†ÅÈáåËøôÊ†∑ËÆæÁΩÆÊâçËÉΩÊàêÂäü)„ÄÇ Â§ö‰∏™ UITextField ÁÇπÂáªÊç¢Ë°åÊåâÈíÆÔºåÂàáÊç¢ FirstResponder‰∏ªË¶ÅÂ∞±ÊòØÂà©Áî® textFieldShouldReturn: Ëøô‰∏™ÂõûË∞ÉÊñπÊ≥ïÔºö 12345678910111213- (BOOL)textFieldShouldReturn:(UITextField *)textField&#123; if (textField == errorTF1) &#123; [errorTF2 becomeFirstResponder]; &#125; else if (textField == errorTF2) &#123; [errorTF3 becomeFirstResponder]; &#125; else if (textField == errorTF3) &#123; [errorTF4 becomeFirstResponder]; &#125; else if (textField == errorTF4)&#123; [errorTF4 resignFirstResponder]; &#125; return NO;//YES or NO,that is a question&#125; textField ÈîÆÁõòÈÅÆÊå°ÁïåÈù¢‰∏äÁßª‰∏ªË¶ÅÁöÑÊÄùÊÉ≥Â∞±ÊòØÁõëÂê¨ÈîÆÁõòÂºπÂá∫ÂíåÊ∂àÂ§±ÁöÑÈÄöÁü•ÔºåÁÑ∂ÂêéÂà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅÂ∞ÜÂ±èÂπï‰∏äÁßª„ÄÇÂÆåÊï¥‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374- (void)viewDidLoad &#123; [super viewDidLoad]; //Do any additional setup after loading the view, typically from a nib. //self.view.backgroundColor = [UIColor underPageBackgroundColor]; myTextField = [[UITextField alloc] init];//ÂàùÂßãÂåñUITextField myTextField.frame = CGRectMake(35, 230, 250, 35); myTextField.delegate = self;//ËÆæÁΩÆ‰ª£ÁêÜ myTextField.borderStyle = UITextBorderStyleRoundedRect; myTextField.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;//ÂûÇÁõ¥Â±Ö‰∏≠ myTextField.placeholder = @"Please entry your content!";//ÂÜÖÂÆπ‰∏∫Á©∫Êó∂ÈªòËÆ§ÊñáÂ≠ó myTextField.returnKeyType = UIReturnKeyDone;//ËÆæÁΩÆÊîæÂõûÊåâÈíÆÁöÑÊ†∑Âºè myTextField.keyboardType = UIKeyboardTypeNumbersAndPunctuation;//ËÆæÁΩÆÈîÆÁõòÊ†∑Âºè‰∏∫Êï∞Â≠ó [self.view addSubview:myTextField]; //Ê≥®ÂÜåÈîÆÁõòÂá∫Áé∞‰∏éÈöêËóèÊó∂ÂÄôÁöÑÈÄöÁü• [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboadWillShow:) name:UIKeyboardWillShowNotification object:nil]; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillHide:) name:UIKeyboardWillHideNotification object:nil]; //Ê∑ªÂä†ÊâãÂäøÔºåÁÇπÂáªÂ±èÂπïÂÖ∂‰ªñÂå∫ÂüüÂÖ≥Èó≠ÈîÆÁõòÁöÑÊìç‰Ωú UITapGestureRecognizer *gesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(hideKeyboard)]; gesture.numberOfTapsRequired = 1;//ÊâãÂäøÊï≤ÂáªÁöÑÊ¨°Êï∞ [self.view addGestureRecognizer:gesture]; &#125; //ÈîÆÁõòÂá∫Áé∞Êó∂ÂÄôË∞ÉÁî®ÁöÑ‰∫ã‰ª∂ -(void) keyboadWillShow:(NSNotification *)note&#123; NSDictionary *info = [note userInfo]; CGSize keyboardSize = [[info objectForKey:UIKeyboardFrameEndUserInfoKey] CGRectValue].size;//ÈîÆÁõòÁöÑframe CGFloat offY = (460-keyboardSize.height)-myTextField.frame.size.height;//Â±èÂπïÊÄªÈ´òÂ∫¶-ÈîÆÁõòÈ´òÂ∫¶-UITextFieldÈ´òÂ∫¶ [UIView beginAnimations:nil context:NULL];//Ê≠§Â§ÑÊ∑ªÂä†Âä®ÁîªÔºå‰Ωø‰πãÂèòÂåñÂπ≥Êªë‰∏ÄÁÇπ [UIView setAnimationDuration:0.3];//ËÆæÁΩÆÂä®ÁîªÊó∂Èó¥ Áßí‰∏∫Âçï‰Ωç myTextField.frame = CGRectMake(35, offY, 250, 35);//UITextField‰ΩçÁΩÆÁöÑyÂùêÊ†áÁßªÂä®Âà∞offY [UIView commitAnimations];//ÂºÄÂßãÂä®ÁîªÊïàÊûú &#125; //ÈîÆÁõòÊ∂àÂ§±Êó∂ÂÄôË∞ÉÁî®ÁöÑ‰∫ã‰ª∂ -(void)keyboardWillHide:(NSNotification *)note&#123; [UIView beginAnimations:nil context:NULL];//Ê≠§Â§ÑÊ∑ªÂä†Âä®ÁîªÔºå‰Ωø‰πãÂèòÂåñÂπ≥Êªë‰∏ÄÁÇπ [UIView setAnimationDuration:0.3]; myTextField.frame = CGRectMake(35, 230, 250, 35);//UITextField‰ΩçÁΩÆÂ§çÂéü [UIView commitAnimations]; &#125; //ÈöêËóèÈîÆÁõòÊñπÊ≥ï -(void)hideKeyboard&#123; [myTextField resignFirstResponder]; &#125; #pragma mark - #pragma mark UITextFieldDelegate //ÂºÄÂßãÁºñËæëÔºö - (BOOL)textFieldShouldBeginEditing:(UITextField *)textField &#123; return YES; &#125; //ÁÇπÂáªreturnÊåâÈíÆÊâÄÂÅöÁöÑÂä®‰ΩúÔºö - (BOOL)textFieldShouldReturn:(UITextField *)textField &#123; [textField resignFirstResponder];//ÂèñÊ∂àÁ¨¨‰∏ÄÂìçÂ∫î return YES; &#125; //ÁºñËæëÂÆåÊàêÔºö - (void)textFieldDidEndEditing:(UITextField *)textField &#123; &#125; -(void)viewDidDisappear:(BOOL)animated&#123; [super viewDidDisappear:animated]; [[NSNotificationCenter defaultCenter] removeObserver:self];//ÁßªÈô§ËßÇÂØüËÄÖ &#125; ËÆæÁΩÆ UITextField ÁöÑ PaddingÔºàleftview Âíå rightviewÔºâÂΩìËÆæÁΩÆ UITextField ‰∏∫Â∑¶ÂØπÈΩêÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÂèëÁé∞ËæìÂÖ•ÁöÑÂ≠óÂíå placeholder ‰ºöÁ¥ßË¥¥ÁùÄÂ∑¶ËæπÊ°Ü„ÄÇÊÉ≥Ë¶ÅÂ∞ÜÂ≠óÂæÄÂè≥ÁßªÔºåÂèØ‰ª•Âà©Áî®Â•Ω leftView Âíå rightView Ëøô‰∏§‰∏™Â±ûÊÄß„ÄÇ Ëøô‰∏§‰∏™Â±ûÊÄß‰ºöË¢´ÊîæÂú® textField ÁöÑÊúÄÂ∑¶ËæπÂíåÊúÄÂè≥Ëæπ„ÄÇÊàë‰ª¨Âè™Ë¶ÅÂàõÂª∫‰∏Ä‰∏™ UIView ÁÑ∂ÂêéËµãÂÄºÁªô leftView Â∞±ÂèØ‰ª•‰∫ÜÔºö 123UIView spacerView = [[UIView alloc] initWithFrame: CGRectMake(0, 0, 10, 10)]; [textfield setLeftViewMode: UITextFieldViewModeAlways]; [textfield setLeftView: spacerView]; Ê≥®ÊÑèËøôÈáåË¶ÅÂ∞Ü mode ËÆæÁΩÆ‰∏∫ UITextFieldViewModeAlwaysÔºåÂê¶ÂàôÂ∑¶ËßÜÂõæÊó†Ê≥ïÊòæÁé∞Âá∫Êù•„ÄÇ ÁÇπÂáª‰∫ã‰ª∂Ôºå‰∏çËß¶ÂèëÂºπÂá∫ÈîÆÁõòÔºåËß¶ÂèëÂÖ∂‰ªñ‰∫ã‰ª∂Â∞±ÊòØ‰∏çËÆ©Áõ¥Êé•‰øÆÊîπÔºåÁÇπÂáªÂêéËß¶ÂèëËá™Â∑±ÁöÑÂìçÂ∫î„ÄÇÂè™Ë¶ÅÂÆûÁé∞‰ª£ÁêÜÊñπÊ≥ïÂ∞±ÂèØ‰ª•‰∫ÜÔºö 1234- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField&#123;//ÂÜô‰Ω†Ë¶ÅÂÆûÁé∞ÁöÑÔºöÈ°µÈù¢Ë∑≥ËΩ¨ÁöÑÁõ∏ÂÖ≥‰ª£Á†Å return NOÔºõ&#125; ÂÖàÂÆåÊàêËá™Â∑±ÁöÑÊìç‰ΩúÔºåÁÑ∂ÂêéËÆæÁΩÆËøô‰∏™ textField ‰∏çËÉΩÂìçÂ∫î„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Âü∫Êú¨Êéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Notification ‰ΩøÁî®Â∞èÁªì]]></title>
    <url>%2F2017%2F04%2F03%2FNotification%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÈúÄÊ±ÇÊúâÂÖ≥‰∫éÈÄöÁü•ÁöÑÔºåÊäòËÖæ‰∫ÜËÆ∏‰πÖÔºåÁé∞Âú®ÈõÜ‰∏≠Â≠¶‰π†‰∏Ä‰∏ã„ÄÇ‰∏ªË¶ÅÈíàÂØπ iOS10 ÁöÑÊñ∞ÁâπÊÄß„ÄÇ Âü∫Êú¨ÂéüÁêÜÊú¨Âú∞Êé®ÈÄÅÔºàLocal NotificationÔºâ App Êú¨Âú∞ÂàõÂª∫ÈÄöÁü•ÔºåÂä†ÂÖ•Á≥ªÁªüÁöÑ Schedule ‰∏≠„ÄÇ Â¶ÇÊûúËææÊàêËß¶ÂèëÊù°‰ª∂ÂàôÊé®ÈÄÅÁõ∏Â∫îÊ∂àÊÅØÂÜÖÂÆπ„ÄÇ ËøúÁ®ãÊé®ÈÄÅÔºàRemote NotificationÔºâ ËÆæÂ§áÂêë APNS(Apple Push Notification Service)ÂèëÈÄÅËØ∑Ê±ÇÔºåÊ≥®ÂÜåËá™Â∑±„ÄÇAPNS ËøîÂõû‰∏Ä‰∏™ deviceTokenÔºåËÆæÂ§áÂÜçÂ∞ÜÂèëÈÄÅÁªô PUSH ÊúçÂä°Âô®„ÄÇ ÊúçÂä°Âô®Â∞ÜË¶ÅÂèëÈÄÅÁöÑÊ∂àÊÅØÔºåÁõÆÊ†áËÆæÂ§áÁöÑ deviceToken ÊâìÂåÖÔºåÂèëÁªô APNS„ÄÇ APNS Âú®Ëá™Ë∫´ÁöÑÂ∑≤Ê≥®ÂÜå Push ÊúçÂä°ÁöÑ iPhone ÂàóË°®‰∏≠ÔºåÊü•ÊâæÊúâÁõ∏Â∫îÊ†áËØÜÁöÑiPhoneÔºåÂπ∂ÊääÊ∂àÊÅØÂèëÂà∞ iPhone„ÄÇ iPhone ÊääÂèëÊù•ÁöÑÊ∂àÊÅØ‰º†ÈÄíÁªôÁõ∏Â∫îÁöÑÂ∫îÁî®Á®ãÂ∫èÔºå Âπ∂‰∏îÊåâÁÖßËÆæÂÆöÂºπÂá∫ Push ÈÄöÁü•„ÄÇ Âü∫Êú¨ËÆæÁΩÆÈÖçÁΩÆÂÖ≥‰∫éÊé®ÈÄÅËØÅ‰π¶ÁöÑÂáÜÂ§áÂ∞±‰∏çËØ¥‰∫Ü„ÄÇÈô§‰∫ÜÊé®ÈÄÅËØÅ‰π¶ÔºåËøòÈúÄË¶ÅÊâìÂºÄ Push Notification ÂºÄÂÖ≥ËøõË°åÊéàÊùÉ„ÄÇÊâìÂºÄÂºÄÂÖ≥ÂêéÔºå‰ºöËá™Âä®ÁîüÊàê‰∏Ä‰∏™ xxx.entitlements Êñá‰ª∂ÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ËøôÈáåÁöÑ value ÈªòËÆ§ÊòØ developmentÔºå‰∏çÈúÄË¶ÅÊàë‰ª¨ÊâãÂä®ÊîπÔºåXcode ‰ºöÂú®Êàë‰ª¨ÂèëÂ∏ÉÁöÑÊó∂ÂÄôËá™Âä®ÊîπÊàê producetion ÁöÑ„ÄÇ ÊñπÊ≥ïÂ§¥Êñá‰ª∂ÂØºÂÖ• #import &lt;UserNotifications/UserNotifications.h&gt;‰∏îË¶ÅÈÅµÂÆà&lt;UNUserNotificationCenterDelegate&gt;ÁöÑÂçèËÆÆÔºåÂú® Appdelegate.m‰∏≠„ÄÇËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÔºåÊàë‰ª¨ÊúÄÂ•ΩÂÜôÊàêËøôÁßçÂΩ¢ÂºèÔºàÈò≤Ê≠¢‰ΩéÁâàÊú¨Êâæ‰∏çÂà∞Â§¥Êñá‰ª∂Âá∫Áé∞ÈóÆÈ¢òÔºâ: 123#ifdef NSFoundationVersionNumber_iOS_9_x_Max#import &lt;UserNotifications/UserNotifications.h&gt;#endif Ëé∑ÂèñÊùÉÈôê‰∏éÊ≥®ÂÜåÂú® Appdelegate ‰∏≠ÂÖàÂêëÁî®Êà∑Ëé∑ÂèñÊùÉÈôê‰∏éÊ≥®ÂÜåÔºö 1234567891011121314151617181920212223242526272829303132333435363738- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; [self replyPushNotificationAuthorization:application]; return YES;&#125;#pragma mark - Áî≥ËØ∑ÈÄöÁü•ÊùÉÈôê// Áî≥ËØ∑ÈÄöÁü•ÊùÉÈôê- (void)replyPushNotificationAuthorization:(UIApplication *)application&#123; if (IOS10_OR_LATER) &#123; //iOS 10 later //Ëé∑ÂèñÂçï‰æãÂØπË±° UNUserNotificationCenter *center = [UNUserNotificationCenter currentNotificationCenter]; //ÂøÖÈ°ªÂÜô‰ª£ÁêÜÔºå‰∏çÁÑ∂Êó†Ê≥ïÁõëÂê¨ÈÄöÁü•ÁöÑÊé•Êî∂‰∏éÁÇπÂáª‰∫ã‰ª∂ center.delegate = self; [center requestAuthorizationWithOptions:(UNAuthorizationOptionBadge | UNAuthorizationOptionSound | UNAuthorizationOptionAlert) completionHandler:^(BOOL granted, NSError * _Nullable error) &#123; if (!error &amp;&amp; granted) &#123; //Áî®Êà∑ÁÇπÂáªÂÖÅËÆ∏ NSLog(@"Ê≥®ÂÜåÊàêÂäü"); &#125;else&#123; //Áî®Êà∑ÁÇπÂáª‰∏çÂÖÅËÆ∏ NSLog(@"Ê≥®ÂÜåÂ§±Ë¥•"); &#125; &#125;]; // ÂèØ‰ª•ÈÄöËøá getNotificationSettingsWithCompletionHandler Ëé∑ÂèñÊùÉÈôêËÆæÁΩÆ //‰πãÂâçÊ≥®ÂÜåÊé®ÈÄÅÊúçÂä°ÔºåÁî®Êà∑ÁÇπÂáª‰∫ÜÂêåÊÑèËøòÊòØ‰∏çÂêåÊÑèÔºå‰ª•ÂèäÁî®Êà∑‰πãÂêéÂèàÂÅö‰∫ÜÊÄéÊ†∑ÁöÑÊõ¥ÊîπÊàë‰ª¨ÈÉΩÊó†‰ªéÂæóÁü•ÔºåÁé∞Âú® apple ÂºÄÊîæ‰∫ÜËøô‰∏™ APIÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Ëé∑ÂèñÂà∞Áî®Êà∑ÁöÑËÆæÂÆö‰ø°ÊÅØ‰∫Ü„ÄÇÊ≥®ÊÑèUNNotificationSettingsÊòØÂè™ËØªÂØπË±°Âì¶Ôºå‰∏çËÉΩÁõ¥Êé•‰øÆÊîπÔºÅ [center getNotificationSettingsWithCompletionHandler:^(UNNotificationSettings * _Nonnull settings) &#123; NSLog(@"========%@",settings); &#125;]; &#125;else if (IOS8_OR_LATER)&#123; //iOS 8 - iOS 10Á≥ªÁªü UIUserNotificationSettings *settings = [UIUserNotificationSettings settingsForTypes:UIUserNotificationTypeAlert | UIUserNotificationTypeBadge | UIUserNotificationTypeSound categories:nil]; [application registerUserNotificationSettings:settings]; &#125; //ÂêëAPNSÊ≥®ÂÜå [application registerForRemoteNotifications];&#125; ÂÖ∂‰∏≠ÂÆö‰πâÁöÑÂÆèÔºö 1234#define IOS10_OR_LATER ([[[UIDevice currentDevice] systemVersion] floatValue] &gt;= 10.0)#define IOS9_OR_LATER ([[[UIDevice currentDevice] systemVersion] floatValue] &gt;= 9.0)#define IOS8_OR_LATER ([[[UIDevice currentDevice] systemVersion] floatValue] &gt;= 8.0)#define IOS7_OR_LATER ([[[UIDevice currentDevice] systemVersion] floatValue] &gt;= 7.0) ‰∏äÈù¢ÊñπÊ≥ïÂÖºÈ°æ‰∫Ü iOS8 ‰ª•‰∏äÁöÑÂêÑ‰∏™Á≥ªÁªü„ÄÇË∞ÉÁî®‰∫Ü‰∏äÈù¢ÁöÑÊñπÊ≥ïÂêéÔºåÁúüÊú∫Â∞±‰ºöÂú®Â±èÂπï‰∏äÊòæÁ§∫Ëé∑ÂèñÈÄöÁü•ÊùÉÈôêÁöÑÂØπËØùÊ°Ü„ÄÇ ÈÄöËøá getNotificationSettingsWithCompletionHandler: Ëøô‰∏™Êñ∞ÊñπÊ≥ïÂèØ‰ª•Ëé∑ÂèñÁî®Êà∑ÁöÑËÆæÂÆö‰ø°ÊÅØÔºåÊâìÂç∞‰ø°ÊÅØÂ¶Ç‰∏ãÔºö 12345 [center getNotificationSettingsWithCompletionHandler:^(UNNotificationSettings * _Nonnull settings) &#123; NSLog(@"========%@",settings); &#125;];ÊâìÂç∞‰ø°ÊÅØÂ¶Ç‰∏ãÔºö========&lt;UNNotificationSettings: 0x1740887f0; authorizationStatus: Authorized, notificationCenterSetting: Enabled, soundSetting: Enabled, badgeSetting: Enabled, lockScreenSetting: Enabled, alertSetting: NotSupported, carPlaySetting: Enabled, alertStyle: Banner&gt; UNUserNotificationCenter ÊòØ‰∏Ä‰∏™Âçï‰æãÁöÑÂØπË±°ÔºåÂèØ‰ª•Âú®‰ª£Á†ÅÁöÑ‰ªªÊÑè‰ΩçÁΩÆËé∑ÂèñËØ•ÂØπË±°ÁöÑÂÆû‰æãÔºåËØ∑Ê±ÇÈÄöÁü•ÊùÉÈôê„ÄÇ DeviceTokenÂèØËÉΩ‰ºöÊúâÊõ¥ÊîπÔºåÂõ†Ê≠§ÈúÄË¶ÅÂú®Á®ãÂ∫èÁöÑÊØèÊ¨°ÂêØÂä®ÈÉΩÂéªÊ≥®ÂÜåÂíåËÆæÁΩÆ„ÄÇ Ëé∑Âèñ deviceToken‰∏äÈù¢ÁöÑÊñπÊ≥ïÂêëËãπÊûúÊ≥®ÂÜåÂêéÔºåËãπÊûúËøîÂõû deviceToken: 123456789101112#pragma mark - Ëé∑Âèñdevice Token//Ëé∑ÂèñDeviceTokenÊàêÂäü- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken&#123; NSLog(@"deviceToken===========%@",deviceString); // Â∞Ü deviceToken ÂèëÈÄÅÁªôÂêÑÁßçÁ¨¨‰∏âÊñπÊé®ÈÄÅÊàñËÄÖËá™Â∑±ÁöÑÊúçÂä°Á´Ø ...&#125;//Ëé∑ÂèñDeviceTokenÂ§±Ë¥•- (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error&#123; NSLog(@"[DeviceToken Error]:%@\n",error.description);&#125; Êé•Êî∂ÈÄöÁü•ÈÄöÁü•ÁöÑÁ±ªÂûãÂú® iOS10 ‰∏≠ÔºåÊú¨Âú∞ÈÄöÁü•ÂíåËøúÁ®ãÈÄöÁü•Âêà‰∫å‰∏∫‰∏Ä„ÄÇÂå∫ÂàÜÊú¨Âú∞ÈÄöÁü•Ë∑üËøúÁ®ãÈÄöÁü•ÁöÑÁ±ªÊòØUNPushNotificationTrigger.hÁ±ª‰∏≠ÔºåUNPushNotificationTriggerÁöÑÁ±ªÂûãÊòØÊñ∞Â¢ûÂä†ÁöÑÔºåÈÄöËøáÂÆÉÔºåÊàë‰ª¨ÂèØ‰ª•ÂæóÂà∞‰∏Ä‰∫õÈÄöÁü•ÁöÑËß¶ÂèëÊù°‰ª∂ ÔºåËß£ÈáäÂ¶Ç‰∏ãÔºö UNPushNotificationTrigger ÔºàËøúÁ®ãÈÄöÁü•Ôºâ ËøúÁ®ãÊé®ÈÄÅÁöÑÈÄöÁü•Á±ªÂûã UNTimeIntervalNotificationTrigger ÔºàÊú¨Âú∞ÈÄöÁü•Ôºâ ‰∏ÄÂÆöÊó∂Èó¥‰πãÂêéÔºåÈáçÂ§çÊàñËÄÖ‰∏çÈáçÂ§çÊé®ÈÄÅÈÄöÁü•„ÄÇÊàë‰ª¨ÂèØ‰ª•ËÆæÁΩÆtimeIntervalÔºàÊó∂Èó¥Èó¥ÈöîÔºâÂíårepeatsÔºàÊòØÂê¶ÈáçÂ§çÔºâ„ÄÇ UNCalendarNotificationTriggerÔºàÊú¨Âú∞ÈÄöÁü•Ôºâ ‰∏ÄÂÆöÊó•Êúü‰πãÂêéÔºåÈáçÂ§çÊàñËÄÖ‰∏çÈáçÂ§çÊé®ÈÄÅÈÄöÁü• ‰æãÂ¶ÇÔºå‰Ω†ÊØèÂ§©8ÁÇπÊé®ÈÄÅ‰∏Ä‰∏™ÈÄöÁü•ÔºåÂè™Ë¶ÅdateComponents‰∏∫8ÔºåÂ¶ÇÊûú‰Ω†ÊÉ≥ÊØèÂ§©8ÁÇπÈÉΩÊé®ÈÄÅËøô‰∏™ÈÄöÁü•ÔºåÂè™Ë¶Årepeats‰∏∫YESÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ UNLocationNotificationTrigger ÔºàÊú¨Âú∞ÈÄöÁü•ÔºâÂú∞ÁêÜ‰ΩçÁΩÆÁöÑ‰∏ÄÁßçÈÄöÁü•ÔºåÂΩìÁî®Êà∑ËøõÂÖ•ÊàñÁ¶ªÂºÄ‰∏Ä‰∏™Âú∞ÁêÜÂå∫ÂüüÊù•ÈÄöÁü•„ÄÇ iOS10ÂØπ‰∫é iOS10Ôºå‰∏îÂÆûÁé∞‰∫Ü UNUserNotificationCenterDelegate ÂçèËÆÆÔºåÂ∞ÜÈÄöËøá‰∏ãÈù¢‰∏§‰∏™ÊñπÊ≥ïÊé•Êî∂ÂíåÂ§ÑÁêÜÈÄöÁü•Ôºö ÂΩìAppÂ§Ñ‰∫éÂâçÂè∞Ôºö 12345678910111213141516171819202122232425262728293031323334353637383940414243- (void)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(UNNotificationPresentationOptions))completionHandler&#123; //Êî∂Âà∞Êé®ÈÄÅÁöÑËØ∑Ê±Ç UNNotificationRequest *request = notification.request; //Êî∂Âà∞Êé®ÈÄÅÁöÑÂÜÖÂÆπ UNNotificationContent *content = request.content; //Êî∂Âà∞Áî®Êà∑ÁöÑÂü∫Êú¨‰ø°ÊÅØ NSDictionary *userInfo = content.userInfo; //Êî∂Âà∞Êé®ÈÄÅÊ∂àÊÅØÁöÑËßíÊ†á NSNumber *badge = content.badge; //Êî∂Âà∞Êé®ÈÄÅÊ∂àÊÅØbody NSString *body = content.body; //Êé®ÈÄÅÊ∂àÊÅØÁöÑÂ£∞Èü≥ UNNotificationSound *sound = content.sound; // Êé®ÈÄÅÊ∂àÊÅØÁöÑÂâØÊ†áÈ¢ò NSString *subtitle = content.subtitle; // Êé®ÈÄÅÊ∂àÊÅØÁöÑÊ†áÈ¢ò NSString *title = content.title; if([notification.request.trigger isKindOfClass:[UNPushNotificationTrigger class]]) &#123; //Ê≠§Â§ÑÁúÅÁï•‰∏Ä‰∏áË°åÈúÄÊ±Ç‰ª£Á†Å„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ NSLog(@"iOS10 Êî∂Âà∞ËøúÁ®ãÈÄöÁü•:%@",userInfo); &#125;else &#123; // Âà§Êñ≠‰∏∫Êú¨Âú∞ÈÄöÁü• //Ê≠§Â§ÑÁúÅÁï•‰∏Ä‰∏áË°åÈúÄÊ±Ç‰ª£Á†Å„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ NSLog(@"iOS10 Êî∂Âà∞Êú¨Âú∞ÈÄöÁü•:&#123;\\\\nbody:%@Ôºå\\\\ntitle:%@,\\\\nsubtitle:%@,\\\\nbadgeÔºö%@Ôºå\\\\nsoundÔºö%@Ôºå\\\\nuserInfoÔºö%@\\\\n&#125;",body,title,subtitle,badge,sound,userInfo); &#125; // ÈúÄË¶ÅÊâßË°åËøô‰∏™ÊñπÊ≥ïÔºåÈÄâÊã©ÊòØÂê¶ÊèêÈÜíÁî®Êà∑ÔºåÊúâBadge„ÄÅSound„ÄÅAlert‰∏âÁßçÁ±ªÂûãÂèØ‰ª•ËÆæÁΩÆ completionHandler(UNNotificationPresentationOptionBadge| UNNotificationPresentationOptionSound| UNNotificationPresentationOptionAlert);&#125; ËøôÈáåÂ∞±ÂèØ‰ª•ÈÄöËøá‰∏äÈù¢Âàó‰∏æÁöÑÁ±ªÂûãÂà§Êñ≠Êé®ÈÄÅÁöÑÁ±ªÂûã‰∫Ü„ÄÇÊúÄÂêé‰∏Ä‰∏™ÊâßË°åÁöÑ completionHandler(...) ÊñπÊ≥ïÂèØ‰ª•Âú®ÂâçÂè∞‰∏ã‰πüÊòæÁ§∫Ê®™ÂπÖ„ÄÇ App Ê®™ÂπÖÁöÑÁÇπÂáª‰∫ã‰ª∂Ôºö 12345678910111213141516171819202122232425262728293031323334353637- (void)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void (^)())completionHandler&#123; //Êî∂Âà∞Êé®ÈÄÅÁöÑËØ∑Ê±Ç UNNotificationRequest *request = response.notification.request; //Êî∂Âà∞Êé®ÈÄÅÁöÑÂÜÖÂÆπ UNNotificationContent *content = request.content; //Êî∂Âà∞Áî®Êà∑ÁöÑÂü∫Êú¨‰ø°ÊÅØ NSDictionary *userInfo = content.userInfo; //Êî∂Âà∞Êé®ÈÄÅÊ∂àÊÅØÁöÑËßíÊ†á NSNumber *badge = content.badge; //Êî∂Âà∞Êé®ÈÄÅÊ∂àÊÅØbody NSString *body = content.body; //Êé®ÈÄÅÊ∂àÊÅØÁöÑÂ£∞Èü≥ UNNotificationSound *sound = content.sound; // Êé®ÈÄÅÊ∂àÊÅØÁöÑÂâØÊ†áÈ¢ò NSString *subtitle = content.subtitle; // Êé®ÈÄÅÊ∂àÊÅØÁöÑÊ†áÈ¢ò NSString *title = content.title; if([response.notification.request.trigger isKindOfClass:[UNPushNotificationTrigger class]]) &#123; NSLog(@"iOS10 Êî∂Âà∞ËøúÁ®ãÈÄöÁü•:%@",userInfo); //Ê≠§Â§ÑÁúÅÁï•‰∏Ä‰∏áË°åÈúÄÊ±Ç‰ª£Á†Å„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ &#125;else &#123; // Âà§Êñ≠‰∏∫Êú¨Âú∞ÈÄöÁü• //Ê≠§Â§ÑÁúÅÁï•‰∏Ä‰∏áË°åÈúÄÊ±Ç‰ª£Á†Å„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ NSLog(@"iOS10 Êî∂Âà∞Êú¨Âú∞ÈÄöÁü•:&#123;\\\\nbody:%@Ôºå\\\\ntitle:%@,\\\\nsubtitle:%@,\\\\nbadgeÔºö%@Ôºå\\\\nsoundÔºö%@Ôºå\\\\nuserInfoÔºö%@\\\\n&#125;",body,title,subtitle,badge,sound,userInfo); &#125; completionHandler(); // Á≥ªÁªüË¶ÅÊ±ÇÊâßË°åËøô‰∏™ÊñπÊ≥ï&#125; Ëøô‰∏™ÊñπÊ≥ïÁöÑÂêçÂ≠óÊòØ didReceiveNotificationResponseÔºåÊòØÊääÊú¨Âú∞Êé®ÈÄÅÂíåËøúÁ´ØÊé®ÈÄÅÊï¥ÂêàÂú®‰∏ÄËµ∑‰∫Ü„ÄÇ‰∏ãÈù¢üëáÁöÑÊñπÊ≥ïÂ∞±ÊòØ‰∏ìÈó®ÈíàÂØπËøúÁ´ØÊé®ÈÄÅÁöÑ„ÄÇ iOS10 Ââçapp Âú®ÂâçÂè∞Ôºå‰∏ç‰ºöÊúâÈÄöÁü•Êù°ÂπÖÔºå‰ΩÜÊòØËøòÊòØËÉΩËµ∞Âà∞‰∏ãÈù¢ÁöÑÊñπÊ≥ï„ÄÇËøõÁ®ãÊùÄÊ≠ªÔºåÁÇπÂáªÊù°ÂπÖÂêØÂä®Âêé‰πüËÉΩËµ∞Âà∞‰∏ãÈù¢ÁöÑÊñπÊ≥ï„ÄÇ 12345- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo fetchCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler &#123; NSLog(@"iOS7Âèä‰ª•‰∏äÁ≥ªÁªüÔºåÊî∂Âà∞ÈÄöÁü•:%@", userInfo); completionHandler(UIBackgroundFetchResultNewData); //Ê≠§Â§ÑÁúÅÁï•‰∏Ä‰∏áË°åÈúÄÊ±Ç‰ª£Á†Å„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ&#125; Â¶ÇÊûúiOS10Ôºå‰∏îÂÆûÁé∞‰∫Ü‰∏äÈù¢ÁöÑ‰ª£ÁêÜÊñπÊ≥ïÔºåÂàô‰∏ç‰ºöËµ∞‰∏ãÈù¢ÁöÑËøô‰∏™ÊñπÊ≥ï„ÄÇ Êó†ËÆ∫ËøõÁ®ãÊòØÂê¶Ë¢´ÊùÄÊ≠ªÔºåÈÉΩËÉΩËµ∞Âà∞‰∏äÈù¢ÁöÑÊñπÊ≥ï‰∏≠„ÄÇ Ê∑ªÂä†Êé®ÈÄÅÊú¨Âú∞Êé®ÈÄÅÊú¨Âú∞Êé®ÈÄÅÁöÑÂü∫Êú¨ÊµÅÁ®ãÊòØÔºö ÂàõÂª∫‰∏Ä‰∏™Ëß¶ÂèëÂô®ÔºàtriggerÔºâ ÂàõÂª∫Êé®ÈÄÅÁöÑÂÜÖÂÆπÔºàUNMutableNotificationContentÔºâ ÂàõÂª∫Êé®ÈÄÅËØ∑Ê±ÇÔºàUNNotificationRequestÔºâ Êé®ÈÄÅËØ∑Ê±ÇÊ∑ªÂä†Âà∞Êé®ÈÄÅÁÆ°ÁêÜ‰∏≠ÂøÉÔºàUNUserNotificationCenterÔºâ‰∏≠ ÂàõÂª∫Ëß¶ÂèëÂô®ÔºàtriggerÔºâÊñ∞ÂäüËÉΩtriggerÂèØ‰ª•Âú®ÁâπÂÆöÊù°‰ª∂Ëß¶ÂèëÔºåÊúâ‰∏âÁ±ª: UNTimeIntervalNotificationTrigger„ÄÅUNCalendarNotificationTrigger„ÄÅUNLocationNotificationTrigger„ÄÇ ÂÆöÊó∂Êé®ÈÄÅÔºö 123//timeIntervalÔºöÂçï‰Ωç‰∏∫ÁßíÔºàsÔºâ repeatsÔºöÊòØÂê¶Âæ™ÁéØÊèêÈÜí//50sÂêéÊèêÈÜíUNTimeIntervalNotificationTrigger *trigger1 = [UNTimeIntervalNotificationTrigger triggerWithTimeInterval:50 repeats:NO]; ÂÆöÊúüÊé®ÈÄÅÔºö 1234567//Âú®ÊØèÂë®‰∏ÄÁöÑ14ÁÇπ3ÂàÜÊèêÈÜíNSDateComponents *components = [[NSDateComponents alloc] init]; components.weekday = 2;components.hour = 16;components.minute = 3; // components Êó•ÊúüUNCalendarNotificationTrigger *calendarTrigger = [UNCalendarNotificationTrigger triggerWithDateMatchingComponents:components repeats:YES]; Âú∞ÁÇπÊé®ÈÄÅÔºö Âú∞Âå∫‰ø°ÊÅØ‰ΩøÁî®CLRegionÁöÑÂ≠êÁ±ªCLCircularRegionÔºåÂèØ‰ª•ÈÖçÁΩÆregionÂ±ûÊÄß notifyOnEntryÂíånotifyOnExitÔºåÊòØÂú®ËøõÂÖ•Âú∞Âå∫„ÄÅ‰ªéÂú∞Âå∫Âá∫Êù•ÊàñËÄÖ‰∏§ËÄÖÈÉΩË¶ÅÁöÑÊó∂ÂÄôËøõË°åÈÄöÁü•: 12345678//È¶ñÂÖàÂæóÂØºÂÖ•#import &lt;CoreLocation/CoreLocation.h&gt;Ôºå‰∏çÁÑ∂‰ºöreginÂàõÂª∫ÊúâÈóÆÈ¢ò„ÄÇ// ÂàõÂª∫‰ΩçÁΩÆ‰ø°ÊÅØCLLocationCoordinate2D center1 = CLLocationCoordinate2DMake(39.788857, 116.5559392);CLCircularRegion *region = [[CLCircularRegion alloc] initWithCenter:center1 radius:500 identifier:@"ÁªèÊµ∑‰∫îË∑Ø"];region.notifyOnEntry = YES;region.notifyOnExit = YES;// region ‰ΩçÁΩÆ‰ø°ÊÅØ repeats ÊòØÂê¶ÈáçÂ§ç ÔºàCLRegion ÂèØ‰ª•ÊòØÂú∞ÁêÜ‰ΩçÁΩÆ‰ø°ÊÅØÔºâUNLocationNotificationTrigger *locationTrigger = [UNLocationNotificationTrigger triggerWithRegion:region repeats:YES]; ÂàõÂª∫Êé®ÈÄÅÁöÑÂÜÖÂÆπÔºàUNMutableNotificationContentÔºâÂ±ûÊÄßÊúâ title„ÄÅsubtitle„ÄÅbody„ÄÅbadge„ÄÅsound„ÄÅlauchImageName„ÄÅuserInfo„ÄÅattachments„ÄÅcategoryIdentifier„ÄÅthreadIdentifier„ÄÇ 12345678// ÂàõÂª∫ÈÄöÁü•ÂÜÖÂÆπ UNMutableNotificationContent, Ê≥®ÊÑè‰∏çÊòØ UNNotificationContent ,Ê≠§ÂØπË±°‰∏∫‰∏çÂèØÂèòÂØπË±°„ÄÇ UNMutableNotificationContent *content = [[UNMutableNotificationContent alloc] init]; content.title = @"Dely Êó∂Èó¥ÊèêÈÜí - title"; content.subtitle = [NSString stringWithFormat:@"Dely Ë£ÖÈÄºÂ§ß‰ºöÁ´ûÈÄâÊó∂Èó¥ÊèêÈÜí - subtitle"]; content.body = @"Dely Ë£ÖÈÄºÂ§ß‰ºöÊÄªÂÜ≥ËµõÊó∂Èó¥Âà∞ÔºåÊ¨¢Ëøé‰Ω†ÂèÇÂä†ÊÄªÂÜ≥ËµõÔºÅÂ∏åÊúõ‰Ω†‰∏ÄÁªüXÁïå - body"; content.badge = @666; content.sound = [UNNotificationSound defaultSound]; content.userInfo = @&#123;@"key1":@"value1",@"key2":@"value2"&#125;; categoryIdentifier ÂêéÈù¢‰ºöÁî®Âà∞,Â∞±ÊòØ‰∏ãÈù¢ Notification Actions ÈáåÈù¢ÁöÑ identifier. ÂàõÂª∫Êé®ÈÄÅËØ∑Ê±ÇÔºàUNNotificationRequestÔºâ1234// ÂàõÂª∫ÈÄöÁü•Ê†áÁ§∫NSString *requestIdentifier = @"Dely.X.time";// ÂàõÂª∫ÈÄöÁü•ËØ∑Ê±Ç UNNotificationRequest Â∞ÜËß¶ÂèëÊù°‰ª∂ÂíåÈÄöÁü•ÂÜÖÂÆπÊ∑ªÂä†Âà∞ËØ∑Ê±Ç‰∏≠UNNotificationRequest *request = [UNNotificationRequest requestWithIdentifier:requestIdentifier content:content trigger:timeTrigger]; ËøôÈáåÁöÑ identifier ÊòØÁî®Êù•Ê†áËØÜÊú¨Âú∞Êé®ÈÄÅÁöÑÔºåÁî®Âú®ÂØπÊú¨Âú∞Êé®ÈÄÅÁöÑ‰øÆÊîπÂà†Èô§Ôºå‰∏ÄËà¨Áî®Â§Ñ‰∏çÊòØÂ§™Â§ß„ÄÇ Ê∑ªÂä†Âà∞Êé®ÈÄÅÁÆ°ÁêÜ‰∏≠ÂøÉÔºàUNUserNotificationCenterÔºâ‰∏≠12345678910111213UNUserNotificationCenter* center = [UNUserNotificationCenter currentNotificationCenter];// Â∞ÜÈÄöÁü•ËØ∑Ê±Ç add Âà∞ UNUserNotificationCenter[center addNotificationRequest:request withCompletionHandler:^(NSError * _Nullable error) &#123; if (!error) &#123; NSLog(@"Êé®ÈÄÅÂ∑≤Ê∑ªÂä†ÊàêÂäü %@", requestIdentifier); //‰Ω†Ëá™Â∑±ÁöÑÈúÄÊ±Ç‰æãÂ¶Ç‰∏ãÈù¢Ôºö UIAlertController *alert = [UIAlertController alertControllerWithTitle:@"Êú¨Âú∞ÈÄöÁü•" message:@"ÊàêÂäüÊ∑ªÂä†Êé®ÈÄÅ" preferredStyle:UIAlertControllerStyleAlert]; UIAlertAction *cancelAction = [UIAlertAction actionWithTitle:@"ÂèñÊ∂à" style:UIAlertActionStyleCancel handler:nil]; [alert addAction:cancelAction]; [[UIApplication sharedApplication].keyWindow.rootViewController presentViewController:alert animated:YES completion:nil]; //Ê≠§Â§ÑÁúÅÁï•‰∏Ä‰∏áË°åÈúÄÊ±Ç„ÄÇ„ÄÇ„ÄÇ„ÄÇ &#125;&#125;]; ËøúÁ´ØÊé®ÈÄÅËøúÁ´ØÊé®ÈÄÅÈúÄË¶ÅÊúçÂä°Âô®ÊåâÁÖßËãπÊûúÁöÑÊ†ºÂºèÊé®ÈÄÅ aps ÂÜÖÂÆπÔºö 12345678910&#123; "aps" : &#123; "alert" : &#123; "title" : "iOSËøúÁ®ãÊ∂àÊÅØÔºåÊàëÊòØ‰∏ªÊ†áÈ¢òÔºÅ-title", "subtitle" : "iOSËøúÁ®ãÊ∂àÊÅØÔºåÊàëÊòØ‰∏ªÊ†áÈ¢òÔºÅ-Subtitle", "body" : "Dely,why am i so handsome -body" &#125;, "badge" : "2" &#125;&#125; Notification ActionsËøôÊòØ iOS10 Êé®Âá∫ÁöÑÈÄöÁü•ÂäüËÉΩÊãìÂ±ïÔºåÂèØÂä†ÂèØ‰∏çÂä†ÔºåÁî®Êù•ÁªôÊé®ÈÄÅÊ∑ªÂä†‰∏Ä‰∫õÊåâÈíÆ„ÄÇ ÂàõÂª∫ActionbuttonÂûãÔºö12345 UNNotificationAction *lookAction = [UNNotificationAction actionWithIdentifier:@"action.join" title:@"Êé•Êî∂ÈÇÄËØ∑" options:UNNotificationActionOptionAuthenticationRequired];UNNotificationAction *joinAction = [UNNotificationAction actionWithIdentifier:@"action.look" title:@"Êü•ÁúãÈÇÄËØ∑" options:UNNotificationActionOptionForeground];UNNotificationAction *cancelAction = [UNNotificationAction actionWithIdentifier:@"action.cancel" title:@"ÂèñÊ∂à" options:UNNotificationActionOptionDestructive]; ÂÖ∂‰∏≠ UNNotificationActionOptions ÊòØ‰∏Ä‰∏™Êûö‰∏æÁ±ªÂûãÔºåÁî®Êù•Ê†áËØÜ Action Ëß¶ÂèëÁöÑË°å‰∏∫ÊñπÂºèÂàÜÂà´‰∏∫Ôºö UNNotificationActionOptionAuthenticationRequired = (1 &lt;&lt; 0)ÔºåÈúÄË¶ÅËß£ÈîÅÊòæÁ§∫ÔºåÁÇπÂáª‰∏ç‰ºöËøõapp UNNotificationActionOptionDestructive = (1 &lt;&lt; 1)ÔºåÁ∫¢Ëâ≤ÊñáÂ≠ó„ÄÇÁÇπÂáª‰∏ç‰ºöËøõapp UNNotificationActionOptionForeground = (1 &lt;&lt; 2)ÔºåÈªëËâ≤ÊñáÂ≠óÔºåÁÇπÂáª‰ºöËøõapp ËæìÂÖ•Ê°ÜÂûãÔºö1UNTextInputNotificationAction *inputAction = [UNTextInputNotificationAction actionWithIdentifier:@"action.input" title:@"ËæìÂÖ•" options:UNNotificationActionOptionForeground textInputButtonTitle:@"ÂèëÈÄÅ" textInputPlaceholder:@"tell me loudly"] ËæìÂÖ•Ê°ÜÂûãÂ§ö‰∫Ü‰∏§‰∏™ÂèÇÊï∞ÔºåbuttonTitle ËæìÂÖ•Ê°ÜÂè≥ËæπÁöÑÊåâÈíÆÊ†áÈ¢òÔºåplaceholder ËæìÂÖ•Ê°ÜÂç†‰ΩçÁ¨¶„ÄÇ ÂàõÂª∫categorybuttonÂûã1UNNotificationCategory *notificationCategory = [UNNotificationCategory categoryWithIdentifier:@"Dely_locationCategory" actions:@[lookAction, joinAction, cancelAction] intentIdentifiers:@[] options:UNNotificationCategoryOptionCustomDismissAction]; ÂÖ∂‰∏≠Ôºö identifier: Ê†áËØÜÁ¨¶ÊòØËøô‰∏™ category ÁöÑÂîØ‰∏ÄÊ†áËØÜÔºåÁî®Êù•Âå∫ÂàÜÂ§ö‰∏™ category,Ëøô‰∏™ id ‰∏çÁÆ°ÊòØ Local NotificationÔºåËøòÊòØ remote NotificationÔºå‰∏ÄÂÆöË¶ÅÊúâÂπ∂‰∏îË¶Å‰øùÊåÅ‰∏ÄËá¥ actions: ÂàõÂª∫ÁöÑ action Êìç‰ΩúÊï∞ÁªÑ intentIdentifiers: ÊÑèÂõæÊ†áËØÜÁ¨¶ ÂèØÂú® &lt;Intents/INIntentIdentifiers.h&gt; ‰∏≠Êü•ÁúãÔºå‰∏ªË¶ÅÊòØÈíàÂØπÁîµËØù„ÄÅcarplay Á≠âÂºÄÊîæÁöÑ API options: ‰∏ÄËà¨ÈÉΩÊòØ UNNotificationCategoryOptionCustomDismissAction Â∞±Ë°å ‰∏çÂêåÈÄöÁü•Ôºåaction ÁöÑÊñπÂºè‰πü‰ºö‰∏çÂêå„ÄÇÊâÄ‰ª•Ëøô‰∏™ identifier ÊòØÁî®Êù•Ê†áËØÜËØ•Áî®Âì™ÁßçÊñπÂºèÂ§ÑÁêÜÁöÑ„ÄÇÂØπ‰∫é remote notificationÔºåÈúÄË¶ÅÂú®ÂèëÁªô APNS ÁöÑÊ∂àÊÅØ‰∏≠Ê∑ªÂä† category Â≠óÊÆµÔºåÂÄº‰∏é identifier Áõ∏Âêå„ÄÇÂØπ‰∫é local notificationÔºåÈúÄË¶ÅËÆæÁΩÆ UNMutableNotificationContent ÂÆû‰æãÁöÑ categoryIdentifier Â±ûÊÄß„ÄÇ ËæìÂÖ•Ê°ÜÂûã1UNNotificationCategory *notificationCategory = [UNNotificationCategory categoryWithIdentifier:@"Dely_locationCategory" actions:@[inputAction] intentIdentifiers:@[] options:UNNotificationCategoryOptionCustomDismissAction]; Â∞Ü category Ê∑ªÂä†Âà∞ÈÄöÁü•‰∏≠ÂøÉ123// Â∞Ü category Ê∑ªÂä†Âà∞ÈÄöÁü•‰∏≠ÂøÉ UNUserNotificationCenter *center = [UNUserNotificationCenter currentNotificationCenter]; [center setNotificationCategories:[NSSet setWithObject:notificationCategory]]; ‰∫ã‰ª∂ÁöÑÊìç‰Ωú‰∏äÈù¢‰ª£Á†ÅÂπ∂Ê≤°ÊúâÊ∑ªÂä†ÂÖ∑‰ΩìÁöÑÊìç‰ΩúÊñπÂºèÔºåÂÖ∑‰ΩìÁöÑÊìç‰ΩúÈÉΩÂú®ÂâçÈù¢ËØ¥ËøáÁöÑ didReceiveNotificationResponse ÊñπÊ≥ï‰∏≠ËøõË°åÔºö 1234567891011121314151617181920212223//AppÈÄöÁü•ÁöÑÁÇπÂáª‰∫ã‰ª∂- (void)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void (^)())completionHandler&#123; //ÁÇπÂáªÊàñËæìÂÖ•action NSString* actionIdentifierStr = response.actionIdentifier; //ËæìÂÖ•Ê°ÜÂûã if ([response isKindOfClass:[UNTextInputNotificationResponse class]]) &#123; NSString* userSayStr = [(UNTextInputNotificationResponse *)response userText]; NSLog(@"actionid = %@\n userSayStr = %@",actionIdentifierStr, userSayStr); //Ê≠§Â§ÑÁúÅÁï•‰∏Ä‰∏áË°åÈúÄÊ±Ç‰ª£Á†Å„ÄÇ„ÄÇ„ÄÇ„ÄÇ &#125; //buttonÂûã if ([actionIdentifierStr isEqualToString:@"action.join"]) &#123; //Ê≠§Â§ÑÁúÅÁï•‰∏Ä‰∏áË°åÈúÄÊ±Ç‰ª£Á†Å NSLog(@"actionid = %@\n",actionIdentifierStr); &#125;else if ([actionIdentifierStr isEqualToString:@"action.look"])&#123; //Ê≠§Â§ÑÁúÅÁï•‰∏Ä‰∏áË°åÈúÄÊ±Ç‰ª£Á†Å NSLog(@"actionid = %@\n",actionIdentifierStr); &#125; ÈÄöËøá response ÊãøÂà∞ÂâçÈù¢ËÆæÁΩÆÁöÑ identifierÔºåÊù•ÊåâÁÖßÈúÄÊ±ÇÔºåÂÆöÂà∂Êìç‰Ωú„ÄÇ Media AttachmentsËøô‰∏™‰∏úË•øÊòØÁªôÊé®ÈÄÅÊ∑ªÂä†Â§öÂ™í‰ΩìÊïàÊûúÔºåÊØîÂ¶ÇÂõæÁâáÔºåËßÜÈ¢ëÁ≠â„ÄÇÊöÇÊó∂Áî®Âà∞ÁöÑ‰∏çÂ§öÔºåÁî®Âà∞ÂÜçÁúã„ÄÇ ËØ¶ÁªÜÁöÑÂèÇËÄÉÊñáÊ°£ Êé®ÈÄÅÊãìÂ±ïËØ¶Ëß£ iOS10ÊãìÂ±ïÂÆåÂÖ®Ëß£Êûê]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Âõ†‰∏∫IPv6Ë¢´Êãí‰πãÂêé]]></title>
    <url>%2F2017%2F03%2F31%2F%E7%94%B1%E4%BA%8EIPv6%E8%A2%AB%E6%8B%92%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÁöÑ‰∏§‰∏™ app Áõ∏ÁªßË¢´Êãí„ÄÇË¢´ÊãíÁöÑÂéüÂõ†ÈÉΩÊòØÁî±‰∫é IPv6ÔºåÂØºËá¥ÁΩëÁªúÊó†Ê≥ïËøûÊé•„ÄÇ‰∏ÄËà¨Êù•ËØ¥ÈúÄË¶ÅÊõ¥Êñ∞ÁΩëÁªúÂ∫ì„ÄÇ‰ΩÜÊòØ‰πüËØ¥‰∏çÂÆöÊòØÂÆ°Ê†∏ÁöÑÈóÆÈ¢òÂïä„ÄÇÊâÄ‰ª•ÂèØ‰ª•ÂÖàÊê≠Âª∫‰∏Ä‰∏™Êú¨Âú∞ÁöÑ IPv6 ÁöÑÁéØÂ¢ÉÔºåÊµãËØï‰∏ãÊòØÂê¶ÊòØËá™Â∑±ÁöÑÈóÆÈ¢ò„ÄÇ Êê≠Âª∫Ê≠•È™§ÂèØ‰ª•ÈÄöËøá mac ÊûÑÂª∫‰∏Ä‰∏™ IPv6 ÁöÑÁéØÂ¢ÉÔºåÁÑ∂ÂêéËÆ©ÊâãÊú∫ËøûÊé•‰∏ä mac„ÄÇ‰ΩÜÊòØËøôÂ∞±ÈúÄË¶Å‰∏Ä‰∏™ËΩ¨Êé•Âè£ÔºåÂõ†‰∏∫ÈúÄË¶Å mac Áõ¥Êé•ËøûÊé•Âà∞‰ª•Â§™ÁΩë„ÄÇÂ¶ÇÊûúÊ≤°ÊúâËΩ¨Êé•Âè£ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÂèÇÁÖß‰∏ãÈù¢ÁöÑÊñπÊ≥ïÈúÄË¶Å‰∏§Âè∞ iphoneÔºà‰∏ÄÈÉ®Êèê‰æõÁΩëÁªúÔºå‰∏ÄÈÉ®Áî®‰∫éÊµãËØïÔºâ ‰ª•Âèä‰∏ÄÊ†πÊï∞ÊçÆÁ∫ø„ÄÇ Á¨¨‰∏ÄÊ≠•ÔºåÂ∞ÜÁî®‰∫éÊèê‰æõÁΩëÁªúÁöÑÊú∫Âô®ÈÄöËøáÊï∞ÊçÆÁ∫øËøûÊé•‰∏ämac„ÄÇ Á¨¨‰∫åÊ≠•ÔºåÂÖ≥Èó≠Êú∫Âô®ÁöÑ wifi Âíå 4GÔºåÊâìÂºÄÊú∫Âô®ÁöÑ‰∏™‰∫∫ÁÉ≠ÁÇπÂπ∂‰∏îÈÄâÊã©‰ªÖ USB Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Á¨¨‰∏âÊ≠•ÔºåÊâìÂºÄÁ≥ªÁªüÂÅèÂ•ΩËÆæÁΩÆ,Êåâ‰Ωèoption(alt)ÈîÆÔºà‰∏ÄÂÆöË¶ÅÊåâÔºâÁÇπÂáªÂÖ±‰∫´Ôºö Á¨¨ÂõõÊ≠•ÔºåÂàõÂª∫ NAT64 ÁΩëÁªú Á¨¨‰∫îÊ≠•ÔºåÂÖ≥Èó≠ mac ÂΩìÂâçËøûÊé•ÁöÑwifiÔºåÁ≠âÂæÖ‰∏Ä‰ºöÂ∞±‰ºöÊòæÁ§∫Â¶Ç‰∏ãÂõæÁâáÊâÄÁ§∫ÁöÑÂõæÊ†áÔºö Á¨¨ÂÖ≠Ê≠•ÔºåÊµãËØïÁî®ÁöÑÊâãÊú∫ËøûÊé• wifi Â¶ÇÊûúËøûÊé•Ê≠£Á°ÆÔºåÂ¶ÇÊûúÊòæÁ§∫Â¶Ç‰∏äÂõæÁöÑ DNSÔºåÈÇ£‰πàÂ∞±Ë°®Á§∫ IPv6 ÁöÑÁéØÂ¢ÉÂ∑≤ÁªèÊê≠Âª∫Â•Ω‰∫Ü„ÄÇÂèØ‰ª•ÊµãËØïÊòØÂê¶ÊòØËá™Â∑±‰ª£Á†ÅÁöÑÈóÆÈ¢òÔºåËøòÊòØËãπÊûúÊµãËØïÁöÑÈóÆÈ¢ò‰∫Ü„ÄÇ ‰æùÊóßË¢´ÊãíÂ¶ÇÊûú‰æùÊóßË¢´ÊãíÈÇ£‰πàÂèØ‰ª•Êãç‰∏Ä‰∏™ËßÜÈ¢ëÁªôÂÆ°Ê†∏‰∫∫ÂëòËØ¶ÊÉÖÂèÇËÄÉËøô‰∏™ÈìæÊé•,ÊúâËØ¶ÁªÜ‰æãÂ≠êÂ¶Ç‰ΩïÊãçËßÜÈ¢ë,ÁÇπÂáªÊü•Áúã,Â¶Ç‰ΩïÂΩïÂà∂ËßÜÈ¢ëÁöÑÊ†∑‰æã,ÊúâÂá†‰ΩçÊåâÁÖßËøô‰∏™ÂΩïÂà∂È°∫Âà©ÈÄöËøáÂÆ°Ê†∏ ÈóÆÈ¢ò:Â¶Ç‰ΩïÊãçËßÜÈ¢ëÂïä? Á≠î:Êãø‰∏™ÂÆâÂçìÊàñËÄÖiOSÊâãÊú∫ÊãçÊëÑ.‰∏™‰∫∫ËßâÂæó‰∏çÂ∫îËØ•ÊòØÂΩïÂà∂Â±èÂπï,ÂΩïÂà∂Â±èÂπï‰∏çËÉΩÂæàÂ•ΩÁöÑÂèçÊò†Âá∫‰Ω†ÈÄÇÈÖçipv6ÁöÑËøáÁ®ãÈóÆÈ¢ò:ÊÄé‰πàÊãç Á≠î:ÂÖàÊãç‰Ω†Êê≠Âª∫ÁéØÂ¢ÉÁöÑËøáÁ®ã,ipv6ÁéØÂ¢ÉÊê≠Âª∫Â•Ω‰∫Ü,wifiÊúâÁÆ≠Â§¥Âêß,ipv6 ÁöÑDNSÊòØ:ÈöîÂºÄÁöÑ,iPv4 ÁöÑDNS ÊòØÈöîÂºÄÁöÑ,ÊâãÊú∫Ê≠£Á°ÆËøûÊé•ÁîµËÑëwifiÁöÑËøáÁ®ã‰πüÈúÄË¶ÅÊãçÊëÑÁöÑ,Ëøô‰∫õÊ†áÂøó‰Ω†Êê≠Âª∫ipv6ÁéØÂ¢ÉÊê≠Âª∫ÊàêÂäüÁöÑÁîªÈù¢ÈÉΩÈúÄË¶Å Êãç,Âú®ÊãçÁöÑÊó∂ÂÄôÊääËá™Â∑±ÁöÑappÊâÄÊúâÁïåÈù¢(ÈÉΩÂèØ‰ª•Âä†ËΩΩÊï∞ÊçÆ)ËøêË°åËâØÂ•ΩÁöÑÁä∂ÊÄÅÊãç‰∏Ä‰∏ãÈóÆÈ¢ò:ÊãçÂ•ΩÁöÑËßÜÈ¢ëÊÄé‰πà‰º†ÁªôËãπÊûúÂÆ°Ê†∏‰∫∫Âëò? Á≠î:ÊãçÂ•ΩÁöÑËßÜÈ¢ë‰º†Âà∞youtwobe,(‰∏çÊé®Ëçê‰º†Âà∞‰ºòÈÖ∑,‰∏á‰∏ÄÁæéÂõΩÁöÑÂÆ°Ê†∏‰∫∫ÂëòÊ≤°ÊúâËÄêÂøÉÁ≠âÂæÖ‰Ω†ÁöÑËßÜÈ¢ëÂä†ËΩΩ,ÂèàÁªô‰Ω†ÊâìÂõûÊù• ‰∫Ü,ÁæéÂõΩËÆøÈóÆ‰∏≠ÂõΩÁöÑÁΩëÈÄü‰ºöÊØî‰∏≠ÂõΩËÆøÈóÆ‰∏≠ÂõΩÁöÑÁΩëÈÄüË¶ÅÊÖ¢) Â¶ÇÊûú‰Ω†ÈáçÊñ∞Êèê‰∫§Êñ∞ÁâàÊú¨,Â∞±ÊääÈìæÊé•Ë¥¥Âú®Â§áÊ≥®ÁöÑÊèèËø∞ ‰∏ã,Âπ≥Êó∂Âú®Ëøô‰∏™ÊèèËø∞ÈáåÂÜôËøô‰∏™app.Â¶ÇÊûú‰Ω†ÁöÑapp ‰Ω†ËßâÂæóÊ≤°‰ªª‰ΩïÈóÆÈ¢ò,‰∏çÊÉ≥ÂÜç‰∏ä‰º†ipaÂåÖ,ÁôªÂΩïËãπÊûúÂºÄÂèëËÄÖË¥¶Âè∑ ÊâæÂà∞ËãπÊûúÊãíÁªùÁöÑÊèèËø∞,Ëøô‰∏™ÊèèËø∞ÊòØÂèØ‰ª•ÂõûÂ§çÁöÑ(Reply),Âú®Ëøô‰∏™ReplyÈáåÈù¢Ë¥¥‰∏ä‰Ω†ÁöÑËßÜÈ¢ëÈìæÊé•,ÂÜô‰∏äÂ§ßËá¥ÊÑèÊÄù ÊòØ:‚ÄùÊàëÁúüÁöÑÈÄÇÈÖç‰∫Üipv6,ÊàëÊääÈÄÇÈÖçÂíåÊµãËØïËøáÁ®ãÈÉΩÊéí‰∫Ü,È∫ªÁÉ¶‰Ω†ÂÜçÂÆ°‰∏ÄÈÅç‚ÄùÁöÑËØù,ËØ¥ËØù‰∏ÄÂÆöË¶ÅËØöÊÅ≥,Á§ºË≤å,ËØ¥ËØù‰∏ÄÂÆöË¶ÅËØöÊÅ≥,Á§ºË≤å,ËØ¥ËØù‰∏ÄÂÆöË¶ÅËØöÊÅ≥,Á§ºË≤å(ÈáçË¶Å‰∫ãËØ¥‰∏âÈÅç),‰∏äÈù¢ÁöÑËøô‰∫õÂÅö‰∫ÜËøòÊòØË¢´ÊãíÁªùÊÄé‰πàÂäû,Êé™ÊñΩ1ËØïËøá,Êé™ÊñΩ2‰πüËØïËøá,ËøòÊòØ‰∏çÁÆ°Áî®,ÊàëÂè™ËÉΩÂª∫ËÆÆ‰Ω†ÁªßÁª≠Êèê‰∫§‰∫Ü,stakeoverflow‰∏äÈù¢Êúâ‰∫∫ËØ¥,Ëá™Â∑±ÊµãËØï‰∫ÜÈÉΩÊòØÊ≤°ÈóÆÈ¢ò,ÊÄé‰πàËãπÊûúËøòÊòØÊãíÁªù,ËãπÊûúÁöÑÂ∑•Á®ãÂ∏àÂëäËØâ‰ªñ‰Ω†Â∞±ÁªßÁª≠Êèê‰∫§Âêß,ËøôÊòØÂÆ°Ê†∏‰∫∫ÂëòÁöÑbug,ÂÖ∂ÂÆûËøôÁßçÊÉÖÂÜµÂõΩÂÜÖÁöÑÂºÄÂèëËÄÖ(ÂåÖÊã¨Á¨îËÄÖ)‰πüÈÅáÂà∞Ëøá,‰Ω†ÊòéÊòéÊèê‰æõ‰∫ÜappÁöÑÊµãËØïË¥¶Âè∑,‰ªñËØ¥‰Ω†Ê≤°Êèê‰æõ,‰Ω†ÂõûÂ§ç‰∏ãÂ∞±Â•Ω‰∫Ü!‰ªñ‰ª¨‰∫∫Â∑•ÂÆ°Ê†∏‰πü‰ºöÊúâÂ§±ËØØÁöÑÊó∂ÂÄô,Âè™ÊòØËøô‰∏™Â§±ËØØË¢´‰Ω†Á¢∞Âà∞‰∫Ü!ËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πàÊúâÈÉ®ÂàÜÁΩëÂèãÂï•ÈÉΩÊ≤°‰øÆÊîπ,Âè™ÊòØÂú®ÊãíÁªùÁöÑÊèèËø∞Âì™Èáåreply ‰∏Ä‰∏ãÂ∞±ÈÄöËøá‰∫Ü. ÂèÇËÄÉÊñáÁ´†Ôºö iOS-Áî®ÊâãÊú∫ÁΩëÁªúÊµãËØïIpv6 ipv6ÂÆ°Ê†∏Ë¢´ÊãíÁªùÁöÑËß£ÂÜ≥ÊñπÊ°à]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS Êñá‰ª∂‰∏ãËΩΩ‰∏éÂ§ÑÁêÜÁõ∏ÂÖ≥]]></title>
    <url>%2F2017%2F03%2F30%2FiOS%20%E6%B2%99%E7%9B%92%E6%9C%BA%E5%88%B6%2F</url>
    <content type="text"><![CDATA[iOS Êñá‰ª∂‰∏ãËΩΩ‰∏éÂ§ÑÁêÜÁõ∏ÂÖ≥ iOS Ê≤ôÁõíÊú∫Âà∂ÊØè‰∏™Â∫îÁî®Á®ãÂ∫èÁöÑÊ¥ªÂä®ËåÉÂõ¥ÈÉΩÈôêÂÆöÂú®Ëá™Â∑±ÁöÑÊ≤ôÁõíÈáå„ÄÇ‰∏çËÉΩÈöèÊÑèË∑®Ë∂äËá™Â∑±ÁöÑÊ≤ôÁõíÂéªËÆøÈóÆÂà´ÁöÑÂ∫îÁî®Á®ãÂ∫èÊ≤ôÁõí‰∏≠ÁöÑÂÜÖÂÆπ„ÄÇ Ê≤ôÁõí‰∏≠ÁöÑÁõÆÂΩïÁ±ªÂûãËØ¶Ëß£Â∞±ÂÉè url ‰∏ÄÊ†∑ÔºåÊØè‰∏™ÊâãÊú∫‰∏≠ÁöÑ app ÈÉΩÊúâ‰∏Ä‰∏™Áã¨‰∏ÄÊó†‰∫åÁöÑË∑ØÂæÑÔºåÈÄöËøáËøô‰∏™Ë∑ØÂæÑÔºåÊàë‰ª¨ËÉΩÊãøÂà∞ app ‰∏≠‰øùÂ≠òÁöÑËµÑÊ∫ê„ÄÇÂú®Ê†πË∑ØÂæÑ‰∏ã‰øùÂ≠òÁùÄÂá†‰∏™ÁâπÂÆöÁöÑÊñá‰ª∂Â§πÔºå‰∏ãÈù¢Â∞Ü‰ªãÁªçËøôÂá†‰∏™Êñá‰ª∂Â§πÔºö Document:‰øùÂ≠òÂ∫îÁî®ËøêË°åÊó∂ÁîüÊàêÁöÑÈúÄË¶ÅÊåÅ‰πÖÂåñÁöÑÊï∞ÊçÆ„ÄÇÂª∫ËÆÆÂ∞ÜÂú®Â∫îÁî®Á®ãÂ∫è‰∏≠Âè™ÊúâÁî®Êà∑ÁîüÊàêÁöÑÊñá‰ª∂„ÄÅÂ∫îÁî®Á®ãÂ∫è‰∏çËÉΩÈáçÊñ∞ÂàõÂª∫ÁöÑÊñá‰ª∂‰øùÂ≠òÂú®ËØ•Êñá‰ª∂Â§π„ÄÇiCloud ‰ºöËá™Âä®Â§á‰ªΩËøô‰∏™Êñá‰ª∂Â§π„ÄÇ Library:ËØ•Êñá‰ª∂Â§π‰∏ãÂèàÊúâ‰∏§‰∏™Â≠êÊñá‰ª∂Â§π„ÄÇ Caches:ÂèØ‰ª•ÈáçÊñ∞‰∏ãËΩΩÊàñËÄÖÈáçÊñ∞ÁîüÊàêÁöÑÊï∞ÊçÆÂ∫îËØ•‰øùÂ≠òÂú®ËØ•ÁõÆÂΩï‰∏ãÔºåËØ•Êñá‰ª∂Â§π‰∏ãÁöÑÊñá‰ª∂‰∏ç‰ºöÂõ†‰∏∫ÈÄÄÂá∫ËÄåÊ∏ÖÈô§„ÄÇiCloud ‰∏ç‰ºöËá™Âä®Â§á‰ªΩËØ•Êñá‰ª∂Â§π Preferences:‰øùÂ≠òÂ∫îÁî®Á®ãÂ∫èÁöÑÊâÄÊúâÂÅèÂ•ΩËÆæÁΩÆ iOS ÁöÑ SettingsÔºåÊàë‰ª¨‰∏çÂ∫îËØ•Áõ¥Êé•Âú®ËøôÈáåÂàõÂª∫Êñá‰ª∂ÔºåËÄåÊòØÈúÄË¶ÅÈÄöËøá NSUserDefault Ëøô‰∏™Á±ªÊù•ËÆøÈóÆÂ∫îÁî®Á®ãÂ∫èÁöÑÂÅèÂ•ΩËÆæÁΩÆ„ÄÇ Tmp:‰øùÂ≠ò‰∏¥Êó∂‰ΩøÁî®ÁöÑÊï∞ÊçÆÔºåÂÖ∂‰∏≠ÁöÑÊï∞ÊçÆ‰ºöÂú®Â∫îÁî®ÈÄÄÂá∫ÂêéÊ∏ÖÈô§„ÄÇ Ê†πË∑ØÂæÑ‰∏ÄËà¨ÂΩ¢ÂºèÂ¶Ç‰∏ãÔºåÂêÑ‰∏™Êñá‰ª∂Â§πÈÉΩ‰øùÂ≠òÂú®ËØ•ÁõÆÂΩï‰∏ã: 1/var/mobile/Containers/Data/Application/‰∏Ä‰∏≤ÈöèÊú∫Â≠óÁ¨¶Áî®‰ª•ÂíåÂÖ∂‰ªñappÂå∫ÂàÜÂºÄ Èô§‰∫Ü‰∏äÈù¢ÁöÑÊèêÂà∞ÁöÑÊ†πÁõÆÂΩïÔºåÈöèÁùÄ app ‰∏ÄËµ∑ÊâìÂåÖÁöÑËµÑÊ∫êÊñá‰ª∂ÈÉΩ‰ºöË¢´ÊîæÂú®‰∏Ä‰∏™ bundle ÁõÆÂΩï‰∏ãÔºåË∑ØÂæÑ‰∏ÄËà¨‰∏∫Ôºö 1/var/containers/Bundle/Application/ÈöèÊú∫Â≠óÁ¨¶‰∏≤ÔºåÂíå‰∏äÈù¢ÁöÑ‰∏çÂêå/Â∫îÁî®Âêç.app ËµÑÊ∫êÊñá‰ª∂ÈÉΩÊòØÈÄöËøáËøô‰∏™Ê†πË∑ØÂæÑÊãºÊé•Ëé∑ÂæóÁöÑÔºåÊØîÂ¶ÇË¶ÅÂæóÂà∞‰∏Ä‰∏™ www ÁõÆÂΩï‰∏ãÁöÑ test.js Êñá‰ª∂ÔºåÈÇ£‰πàË∑ØÂæÑÂ∞±ÊòØ 1/var/containers/Bundle/Application/ÈöèÊú∫Â≠óÁ¨¶‰∏≤ÔºåÂíå‰∏äÈù¢ÁöÑ‰∏çÂêå/Â∫îÁî®Âêç.app/www/test.js Ê≥®ÊÑèÂ¶ÇÊûú‰Ω†ÂÅö‰∏™ËÆ∞‰∫ãÊú¨ÁöÑappÔºåÈÇ£‰πàÁî®Êà∑ÂÜô‰∫Ü‰∏úË•øÔºåÊÄªË¶ÅÊää‰∏úË•øÂ≠òËµ∑Êù•„ÄÇÈÇ£‰πàËøô‰∏™Êñá‰ª∂ÂàôÊòØÁî®Êà∑Ëá™Ë°åÁîüÊàêÁöÑÔºåÂ∞±ÊîæÂú®documentsÊñá‰ª∂Â§πÈáåÈù¢„ÄÇ Â¶ÇÊûú‰Ω†Êúâ‰∏Ä‰∏™appÔºåÈúÄË¶ÅÂíåÊúçÂä°Âô®ÈÖçÂêàÔºåÁªèÂ∏∏‰ªéÊúçÂä°Âô®‰∏ãËΩΩ‰∏úË•øÔºåÂ±ïÁ§∫ÁªôÁî®Êà∑Áúã„ÄÇÈÇ£‰πàËøô‰∫õ‰∏ãËΩΩ‰∏ãÊù•ÁöÑ‰∏úË•øÂ∞±ÊîæÂú® library/cache„ÄÇ Âú® cache ÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂Âú®Â≠òÂÇ®Á©∫Èó¥‰∏çË∂≥ÁöÑÊÉÖÂÜµ‰∏ãÔºå‰ºöË¢´Ê∏ÖÁ©∫„ÄÇÊâÄ‰ª•‰∏Ä‰∫õÈáçË¶ÅÁöÑÊñá‰ª∂ÊúÄÂ•Ω‰∏çË¶ÅÊîæÂú® cache ‰∏≠„ÄÇ appleÂØπËøô‰∏™Âæà‰∏•Ê†ºÔºåÊîæÈîô‰∫ÜÂ∞±‰ºöË¢´Êãí„ÄÇ‰∏ªË¶ÅÂéüÂõ†ÊòØiosÁöÑicloudÁöÑÂêåÊ≠•ÈóÆÈ¢ò„ÄÇ Ëé∑ÂèñÊ≤ôÁõíË∑ØÂæÑËé∑ÂèñÊ≤ôÁõíÁöÑ Home ÁõÆÂΩï123//Ëé∑ÂèñÊ†πÁõÆÂΩï NSString *homePath = NSHomeDirectory(); NSLog(@"HomeÁõÆÂΩïÔºö%@",homePath); Ëé∑ÂèñÊ≤ôÁõíÁöÑ Documents ÁõÆÂΩï1NSString *filePath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask,YES) firstObject]; Ëé∑Âèñ Library Êñá‰ª∂Ë∑ØÂæÑ1NSString *filePath = [NSSearchPathForDirectoriesInDomains(NSLibraryDirectory,NSUserDomainMask,YES) firstObject]; Ëé∑Âèñ Caches Êñá‰ª∂Ë∑ØÂæÑ1NSString *filePath = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory,NSUserDomainMask,YES) firstObject]; Ëé∑Âèñ Tmp Êñá‰ª∂Ë∑ØÂæÑ1NSString *filePath = NSTemporaryDirectory(); ÂÖ∂‰∏≠ NSUserDomainMask Ë°®Á§∫Âú®ÂΩìÂâçÊ≤ôÁõíËåÉÂõ¥ÂÜÖÊü•ÊâæÔºåYES Ë°®Á§∫Â±ïÂºÄË∑ØÂæÑÔºåNO Ë°®Á§∫‰∏çÂ±ïÂºÄË∑ØÂæÑ„ÄÇÈáåÈù¢ÁöÑÊâÄÊúâÊñá‰ª∂Â§πÈÉΩÂèØ‰ª•ÈÄöËøá Home ÁõÆÂΩïÊãºÊé•ËÄåÊàê„ÄÇ Ê≤ôÁõíÈáåËøòÊúâÂæàÂ§öÂÖ∂‰ªñÁöÑÊñá‰ª∂Â§πÔºå‰∏äÈù¢Âè™ÊòØÂàó‰∏æ‰∫ÜÂ∏∏Áî®ÁöÑÂá†‰∏™„ÄÇ Ëé∑Âèñ Bundle Êñá‰ª∂Ë∑ØÂæÑ1NSString *bundle = [[NSBundle mainBundle] resourcePath]; Ëøô‰∏™ Bundle Ë∑ØÂæÑÂ∞±ÊòØÂ∑•Á®ãÁöÑ‰∏ªË∑ØÂæÑÔºåÂèØ‰ª•ÈÄöËøáÊãºÊé•Ë∑ØÂæÑÁöÑÊñπÂºèÔºåËé∑ÂèñÂ∑•Á®ã‰∏ãÁöÑÂêÑÁßçËµÑÊ∫êÊñá‰ª∂„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÔºåË∑ØÂæÑÊòØÊñá‰ª∂Â§πÁöÑÁªùÂØπË∑ØÂæÑÔºåËÄå‰∏çÊòØ xcode ‰∏≠ÊòæÁ§∫ÁöÑ group Ë∑ØÂæÑ„ÄÇ Êñá‰ª∂‰∏ãËΩΩÊñá‰ª∂Êìç‰ΩúÂàõÂª∫Êñá‰ª∂Â§πÂú® Document ÁõÆÂΩï‰∏ãÂàõÂª∫ test Êñá‰ª∂Â§πÔºö 123456789101112//ÂàõÂª∫Êñá‰ª∂Â§π -(void)createDir&#123; NSString *documentsPath =[self dirDoc]; NSFileManager *fileManager = [NSFileManager defaultManager]; NSString *testDirectory = [documentsPath stringByAppendingPathComponent:@"test"]; // ÂàõÂª∫ÁõÆÂΩï BOOL res=[fileManager createDirectoryAtPath:testDirectory withIntermediateDirectories:YES attributes:nil error:nil]; if (res) &#123; NSLog(@"Êñá‰ª∂Â§πÂàõÂª∫ÊàêÂäü"); &#125;else NSLog(@"Êñá‰ª∂Â§πÂàõÂª∫Â§±Ë¥•"); &#125; NSFileManger ÊòØ‰∏Ä‰∏™Êñá‰ª∂Â§ÑÁêÜÁöÑÁ±ª„ÄÇ self dirDoc ÊòØËá™ÂÆö‰πâÁöÑËé∑Âæó Document Êñá‰ª∂Ë∑ØÂæÑÁöÑÊñπÊ≥ïÔºå‰∏äÈù¢ËØ¥Âà∞Ëøá„ÄÇ ÂàõÂª∫Êñá‰ª∂123456789101112//ÂàõÂª∫Êñá‰ª∂ -(void)createFile&#123; NSString *documentsPath =[self dirDoc]; NSString *testDirectory = [documentsPath stringByAppendingPathComponent:@"test"]; NSFileManager *fileManager = [NSFileManager defaultManager]; NSString *testPath = [testDirectory stringByAppendingPathComponent:@"test.txt"]; BOOL res=[fileManager createFileAtPath:testPath contents:nil attributes:nil]; if (res) &#123; NSLog(@"Êñá‰ª∂ÂàõÂª∫ÊàêÂäü: %@" ,testPath); &#125;else NSLog(@"Êñá‰ª∂ÂàõÂª∫Â§±Ë¥•"); &#125; ÂÜôÊï∞ÊçÆÂà∞Êñá‰ª∂123456789101112//ÂÜôÊñá‰ª∂ -(void)writeFile&#123; NSString *documentsPath =[self dirDoc]; NSString *testDirectory = [documentsPath stringByAppendingPathComponent:@"test"]; NSString *testPath = [testDirectory stringByAppendingPathComponent:@"test.txt"]; NSString *content=@"ÊµãËØïÂÜôÂÖ•ÂÜÖÂÆπÔºÅ"; BOOL res=[content writeToFile:testPath atomically:YES encoding:NSUTF8StringEncoding error:nil]; if (res) &#123; NSLog(@"Êñá‰ª∂ÂÜôÂÖ•ÊàêÂäü"); &#125;else NSLog(@"Êñá‰ª∂ÂÜôÂÖ•Â§±Ë¥•"); &#125; ‰ªéÊñá‰ª∂ËØªÊï∞ÊçÆ12345678910//ËØªÊñá‰ª∂ -(void)readFile&#123; NSString *documentsPath =[self dirDoc]; NSString *testDirectory = [documentsPath stringByAppendingPathComponent:@"test"]; NSString *testPath = [testDirectory stringByAppendingPathComponent:@"test.txt"]; // NSData *data = [NSData dataWithContentsOfFile:testPath]; // NSLog(@"Êñá‰ª∂ËØªÂèñÊàêÂäü: %@",[[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding]); NSString *content=[NSString stringWithContentsOfFile:testPath encoding:NSUTF8StringEncoding error:nil]; NSLog(@"Êñá‰ª∂ËØªÂèñÊàêÂäü: %@",content); &#125; Êñá‰ª∂Â§ßÂ∞è12345678+(float)fileSizeAtPath:(NSString *)path&#123; NSFileManager *fileManager=[NSFileManager defaultManager]; if([fileManager fileExistsAtPath:path])&#123; long long size=[fileManager attributesOfItemAtPath:path error:nil].fileSize; return size/1024.0/1024.0; &#125; return 0;&#125; Ëøô‰∏™ÊñπÊ≥ïËé∑ÂæóÊñá‰ª∂ÁöÑÂêÑ‰∏™Â±ûÊÄßÔºåÂÖ∂‰∏≠‰∏Ä‰∏™Â±ûÊÄßÊòØ fileSize„ÄÇ‰∏ÄËà¨Ê∏ÖÈô§ÁºìÂ≠òÁöÑÊó∂ÂÄôÈúÄË¶ÅÁî®Âà∞ËÆ°ÁÆóÊñá‰ª∂Â§ßÂ∞è„ÄÇ Âà†Èô§Êñá‰ª∂12345678910111213//Âà†Èô§Êñá‰ª∂ -(void)deleteFile&#123; NSString *documentsPath =[self dirDoc]; NSString *testDirectory = [documentsPath stringByAppendingPathComponent:@"test"]; NSFileManager *fileManager = [NSFileManager defaultManager]; NSString *testPath = [testDirectory stringByAppendingPathComponent:@"test.txt"]; BOOL res=[fileManager removeItemAtPath:testPath error:nil]; if (res) &#123; NSLog(@"Êñá‰ª∂Âà†Èô§ÊàêÂäü"); &#125;else NSLog(@"Êñá‰ª∂Âà†Èô§Â§±Ë¥•"); NSLog(@"Êñá‰ª∂ÊòØÂê¶Â≠òÂú®: %@",[fileManager isExecutableFileAtPath:testPath]?@"YES":@"NO"); &#125; NSData ‰ΩøÁî®‰∏ãËΩΩÂæóÂà∞ÁöÑÊñá‰ª∂Ôºå‰∏ÄËà¨ÊòØ‰ª• NSData ÁöÑÂΩ¢ÂºèÂá∫Áé∞Ôºå‰ΩøÁî®Êó∂ÈúÄË¶ÅÂ∞ÜÂÖ∂ËΩ¨Êç¢ÊàêÁõ∏Â∫îÁöÑÁ±ªÔºåÊØîÂ¶Ç NSString,UIImage Á≠âÁ±ªÁöÑÂΩ¢Âºè„ÄÇ NSData ‰∏é NSStringNSData ËΩ¨ NSStringÔºö 1NSString *newStr = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding]; NSString ËΩ¨ NSDataÔºö 1NSData *data = [str dataUsingEncoding:NSUTF8StringEncoding]; NSData ‰∏é UIImageNSData ËΩ¨ UIImageÔºö 1UIImage *aimage = [UIImage imageWithData: imageData]; UIImage ËΩ¨ NSDataÔºö 1NSData *imageData = UIImagePNGRepresentation(aImage); ‰∏ãËΩΩÂèØ‰ª•ÈÄöËøá NSURLConnectionÁ±ªÂàõÂª∫‰∏ãËΩΩÔºå‰∏çËøáËØ•Á±ªÂú® iOS9 ‰∏≠Ë¢´Â∫üÂºÉ‰∫ÜÔºåÂèñËÄå‰ª£‰πãÁöÑÊòØ NSURLSession Á±ª„ÄÇÊàë‰ª¨‰∏ãÈù¢Âè™Â≠¶‰π†‰∏ãËØ•Á±ªÁöÑ‰ΩøÁî®ÊñπÂºèÂíåÊäÄÂ∑ß„ÄÇ ÊôÆÈÄöÁöÑÁΩëÁªúËØ∑Ê±ÇÂàõÂª∫‰ªªÂä°ÂêéÔºå‰∏ç‰ºöËá™Âä®ÂèëÈÄÅËØ∑Ê±ÇÔºåÈúÄË¶ÅÊâãÂä®ÂºÄÂßã‰ªªÂä°Ôºö 1234567891011121314// 1.ÂæóÂà∞sessionÂØπË±°NSURLSession* session = [NSURLSession sharedSession];NSURL* url = [NSURL URLWithString:@""];// 2.ÂàõÂª∫‰∏Ä‰∏™taskÔºå‰ªªÂä°NSURLSessionDataTask* dataTask = [session dataTaskWithURL:url completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) &#123; // data ‰∏∫ËøîÂõûÊï∞ÊçÆ dispatch_async(dispatch_get_main_queue(), ^&#123; [_image setImage:[UIImage imageWithData:data]]; &#125;);&#125;];// 3.ÂºÄÂßã‰ªªÂä°[dataTask resume]; Âõ†‰∏∫ÊòØ‰∏ªË¶ÅËÆ≤‰∏ãËΩΩÊñá‰ª∂ÁöÑÔºåÊâÄ‰ª•ËøôÈáåÁúÅÁï•‰∫Ü Session ÂàõÂª∫ÁöÑÂÖ∑‰ΩìËøáÁ®ã„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÊòØÈúÄË¶Å‰∏∫ Session ËÆæÁΩÆ delegate ÁöÑÔºå‰ª•Ê≠§ÁõëÂê¨‰∏ãËΩΩÊÉÖÂÜµÔºåËøôÈáåÈÉΩÁúÅÁï•‰∫Ü„ÄÇ Ê≥®ÊÑèÔºåcompletionHandler Ëøô‰∏™ÂõûË∞ÉÊòØÂú®ÂêéÂè∞Á∫øÁ®ã‰∏≠ÁöÑÔºåÂ¶ÇÊûúÊÉ≥Ë¶ÅÊîπÂèòUIÔºåÂ∞±ÂøÖÈ°ªdispatchÂà∞‰∏ªÁ∫øÁ®ã‰∏≠ÂéªÔºåÂê¶Âàô‰ºöÁ≠âÂæÖÂæàÈïøÊó∂Èó¥ÊâçËÉΩÊòæÁ§∫Âá∫Êù• ‰∏ãËΩΩÊñá‰ª∂Â¶ÇÊûú‰ΩøÁî® NSURLSessionDataTask ‰∏ãËΩΩÊñá‰ª∂ÔºåÈÇ£‰πàÂ∞±Ë¶ÅËÄÉËôëËæπ‰∏ãËæπÂ≠òÁöÑÊÉÖÂÜµÔºåÂ¶ÇÊûúÊñá‰ª∂ÂæàÂ§ßÔºåÈÇ£‰πàÂÜÖÂ≠òÂæàÂÆπÊòìÁàÜÁÇ∏„ÄÇ‰ΩÜÊòØ‰ΩøÁî® NSURLSessionDownloadTask Â∞±‰∏çÈúÄË¶ÅËæπ‰∏ãËΩΩËæπÂÜôÂÖ•Á≠âÈóÆÈ¢òÔºåËãπÊûúÂÅöÂ•Ω‰∫ÜÂ∞ÅË£Ö„ÄÇÂè™ÈúÄË¶ÅÂú®ÁªìÊùüÁöÑÊó∂ÂÄôÂ∞Ü‰∏¥Êó∂Êñá‰ª∂ÁßªÂä®Âà∞ÁõÆÊ†áÊñá‰ª∂ÁõÆÂΩï‰∏≠Âç≥ÂèØÔºö 1234567891011NSURL* url = [NSURL URLWithString:@"http://dlsw.baidu.com/sw-search-sp/soft/9d/25765/sogou_mac_32c_V3.2.0.1437101586.dmg"];// ÂæóÂà∞sessionÂØπË±°NSURLSession* session = [NSURLSession sharedSession];// ÂàõÂª∫‰ªªÂä°NSURLSessionDownloadTask* downloadTask = [session downloadTaskWithURL:url completionHandler:^(NSURL *location, NSURLResponse *response, NSError *error) &#123; // ... ÁúÅÁï•‰∫ÜÂ∞Ü location ‰∏ãÁöÑÊñá‰ª∂ÁßªÂä®Âà∞ÁõÆÊ†áÊñá‰ª∂ÁõÆÂΩï‰∏≠ÁöÑËøáÁ®ã&#125;];// ÂºÄÂßã‰ªªÂä°[downloadTask resume]; ËøôÈáåÂõûË∞ÉÂèÇÊï∞Ê≤°Êúâ‰∫Ü NSDataÔºåÂ§ö‰∫Ü‰∏Ä‰∏™ locationÔºåËøô‰∏™Â∞±ÊòØ‰∏ãËΩΩÂ•ΩÁöÑÊñá‰ª∂ÂÜôÂÖ•Ê≤ôÁõíÁöÑÂú∞ÂùÄÔºåÊâìÂç∞ÂêéÂèëÁé∞‰∏ãËΩΩÂ•ΩÁöÑÊñá‰ª∂Ë¢´ÂÜôÂÖ•‰∫Ü temp Êñá‰ª∂Â§π‰∏ã„ÄÇ ËøôÈáåÁõ¥Êé•Âú®ÂàõÂª∫ downloadTask ÁöÑÊó∂ÂÄôÊèê‰æõ‰∫ÜÁªìÊùüÁöÑÂõûË∞ÉÔºåÂÖ∂ÂÆû‰πüÂèØ‰ª•ËÆæÁΩÆ delegateÔºåÊØîÂ¶ÇË¶ÅÁõëÂê¨‰∏ãËΩΩËøõÂ∫¶ÁöÑÊó∂ÂÄôÔºåÂ∞±ÂøÖÈ°ª‰ΩøÁî® delegate ‰∫Ü„ÄÇÂÖ∑‰ΩìËßÅ‰∏ãÊñπ ÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂ∞Ü temp ÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂ËΩ¨ÁßªÂà∞‰∏ç‰ºöË¢´Âà†Èô§ÁöÑ caches ÁõÆÂΩï‰∏ã„ÄÇ 12345678910NSString *caches = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) lastObject];// response.suggestedFilename Ôºö Âª∫ËÆÆ‰ΩøÁî®ÁöÑÊñá‰ª∂ÂêçÔºå‰∏ÄËà¨Ë∑üÊúçÂä°Âô®Á´ØÁöÑÊñá‰ª∂Âêç‰∏ÄËá¥NSString *file = [caches stringByAppendingPathComponent:response.suggestedFilename];// Â∞Ü‰∏¥Êó∂Êñá‰ª∂Ââ™ÂàáÊàñËÄÖÂ§çÂà∂CachesÊñá‰ª∂Â§πNSFileManager *mgr = [NSFileManager defaultManager];// AtPath : Ââ™ÂàáÂâçÁöÑÊñá‰ª∂Ë∑ØÂæÑ// ToPath : Ââ™ÂàáÂêéÁöÑÊñá‰ª∂Ë∑ØÂæÑ[mgr moveItemAtPath:location.path toPath:file error:nil]; ÁõëÂê¨‰∏ãËΩΩËøõÂ∫¶‰∏äÈù¢ÁöÑÊñπÊ≥ïÂèØ‰ª•‰∏ãËΩΩÔºå‰ΩÜÊòØÊó†Ê≥ïÁõëÂê¨‰∏ãËΩΩÁöÑËøõÂ∫¶„ÄÇÊÉ≥Ë¶ÅÁõëÂê¨‰∏ãËΩΩËøõÂ∫¶ÔºåÈúÄË¶ÅÈÄöËøá delegateÔºåË¶ÅÈÅµÂæ™ÂçèËÆÆNSURLSessionDownloadDelegate Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142/* * Messages related to the operation of a task that writes data to a * file and notifies the delegate upon completion. */@protocol NSURLSessionDownloadDelegate &lt;NSURLSessionTaskDelegate&gt;/* Sent when a download task that has completed a download. The delegate should * copy or move the file at the given location to a new location as it will be * removed when the delegate message returns. URLSession:task:didCompleteWithError: will * still be called. * ‰∏ãËΩΩÂÆåÊØï‰ºöË∞ÉÁî® * * @param location Êñá‰ª∂‰∏¥Êó∂Âú∞ÂùÄ */- (void)URLSession:(NSURLSession *)session downloadTask:(NSURLSessionDownloadTask *)downloadTask didFinishDownloadingToURL:(NSURL *)location;@optional/* Sent periodically to notify the delegate of download progress. * ÊØèÊ¨°ÂÜôÂÖ•Ê≤ôÁõíÂÆåÊØïË∞ÉÁî® * Âú®ËøôÈáåÈù¢ÁõëÂê¨‰∏ãËΩΩËøõÂ∫¶ÔºåtotalBytesWritten/totalBytesExpectedToWrite * * @param bytesWritten ËøôÊ¨°ÂÜôÂÖ•ÁöÑÂ§ßÂ∞è * @param totalBytesWritten Â∑≤ÁªèÂÜôÂÖ•Ê≤ôÁõíÁöÑÂ§ßÂ∞è * @param totalBytesExpectedToWrite Êñá‰ª∂ÊÄªÂ§ßÂ∞è */- (void)URLSession:(NSURLSession *)session downloadTask:(NSURLSessionDownloadTask *)downloadTask didWriteData:(int64_t)bytesWritten totalBytesWritten:(int64_t)totalBytesWritten totalBytesExpectedToWrite:(int64_t)totalBytesExpectedToWrite;/* Sent when a download has been resumed. If a download failed with an * error, the -userInfo dictionary of the error will contain an * NSURLSessionDownloadTaskResumeData key, whose value is the resume * data. * ÊÅ¢Â§ç‰∏ãËΩΩÂêéË∞ÉÁî®Ôºå */- (void)URLSession:(NSURLSession *)session downloadTask:(NSURLSessionDownloadTask *)downloadTask didResumeAtOffset:(int64_t)fileOffset expectedTotalBytes:(int64_t)expectedTotalBytes;@end ‰∏äÈù¢ËØ¥Âà∞ËÆæÁΩÆ delegate Êó∂Ôºå NSURLSessionDownloadTask ÂàõÂª∫ÊñπÂºèÊúâÊâÄ‰∏çÂêåÔºö 12345678910// ÂæóÂà∞sessionÂØπË±°NSURLSessionConfiguration* cfg = [NSURLSessionConfiguration defaultSessionConfiguration]; // ÈªòËÆ§ÈÖçÁΩÆNSURLSession* session = [NSURLSession sessionWithConfiguration:cfg delegate:self delegateQueue:[NSOperationQueue mainQueue]];// ÂàõÂª∫‰ªªÂä°NSURLSessionDownloadTask* downloadTask = [session downloadTaskWithURL:url];// ÂºÄÂßã‰ªªÂä°[downloadTask resume]; Êñ≠ÁÇπ‰∏ãËΩΩ‰∏ªÂä®ÊöÇÂÅúÊñá‰ª∂ÁöÑÊöÇÂÅúÂíåÊÅ¢Â§çÂèØ‰ª•ÈÄöËøá resume Âíå suspend ÊñπÊ≥ïÂÆûÁé∞„ÄÇ‰ΩÜÊòØËøôÊ†∑ÂÅöÔºåÁ®ãÂ∫èÈÄÄÂá∫ÂêéÂÜçÂºÄÂêØÂ∞±‰∏çËÉΩÊé•ÁùÄ‰∏ãËΩΩ‰∫Ü„ÄÇ‰∏ÄËà¨Â¶ÇÊûúÊòØ‰∏ªÂä®ÊöÇÂÅúÁöÑËØù‰ºö‰ΩøÁî® cancelByProducingResumeData: ÊñπÊ≥ï: 123456__weak typeof(self) selfVc = self;[self.downloadTask cancelByProducingResumeData:^(NSData *resumeData) &#123; // resumeData : ÂåÖÂê´‰∫ÜÁªßÁª≠‰∏ãËΩΩÁöÑÂºÄÂßã‰ΩçÁΩÆ\‰∏ãËΩΩÁöÑurl selfVc.resumeData = resumeData; selfVc.downloadTask = nil;&#125;]; Ë∞ÉÁî®ËØ•ÂèñÊ∂àÊñπÊ≥ïÂêé‰ºöÂõûË∞É‰∏Ä‰∏™ blockÔºåÂπ∂‰º†ÂÖ• resumeDataÔºåËØ•ÂèÇÊï∞ÂåÖÂê´‰∫ÜÁªßÁª≠‰∏ãËΩΩÊñá‰ª∂ÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØÔºå‰Ω†ÂèØ‰ª•Â∞ÜÂÖ∂ËΩ¨Êç¢‰∏∫ NSStringÔºåÊâìÂç∞Âá∫Êù•ÂèØ‰ª•ÁúãÂà∞ÂÖ∂ÂÆûÊòØ plist ÁöÑÂΩ¢ÂºèÔºå‰Ω†ÂèØ‰ª•Â∞ÜÂÖ∂‰øùÂ≠ò‰∏∫ plist Êñá‰ª∂„ÄÇ‰∏äÈù¢ selfVc.downloadTask = nil Áõ¥Êé•Â∞Ü downloadTask Áõ¥Êé•ÁΩÆ‰∏∫‰∫Ü nilÔºåÂõ†‰∏∫ÂêéÈù¢ÁªßÁª≠‰∏ãËΩΩÁöÑÊó∂ÂÄô‰ºöÈáçÊñ∞ÂàõÂª∫‰∏Ä‰∏™„ÄÇ ÁªßÁª≠‰∏ãËΩΩÁöÑÊó∂ÂÄôÈúÄË¶ÅÈáçÊñ∞ÂàõÂª∫‰∏Ä‰∏™‰∏é resumeData Áõ∏ÂÖ≥ÁöÑdownloadTaskÔºö 123// ‰º†ÂÖ•‰∏äÊ¨°ÊöÇÂÅú‰∏ãËΩΩËøîÂõûÁöÑÊï∞ÊçÆÔºåÂ∞±ÂèØ‰ª•ÊÅ¢Â§ç‰∏ãËΩΩself.downloadTask = [self.session downloadTaskWithResumeData:self.resumeData];[self.downloadTask resume]; // ÂºÄÂßã‰ªªÂä° ÊâãÂä®ÊùÄÊéâÂ∫îÁî®ÂêéÁöÑË¢´Âä®ÊöÇÂÅú‰∏çËÆ∫ÊòØÊôÆÈÄöÁöÑ NSURLSession ËøòÊòØÂèØ‰ª•Âú®ÂêéÂè∞‰ΩøÁî®ÁöÑ NSURLSessionÔºåÂÆÉ‰ª¨Âú®Ë¢´ÊâãÂä®ÊùÄÊéâÂêéÈÉΩ‰ºö‰øùÂ≠òÂΩìÂâçÁöÑ NSURLSession ‰ø°ÊÅØÔºåÂú®‰∏ãÊ¨°ÂêØÂä®Âπ∂‰∏îÂàõÂª∫‰∫ÜÁõ∏Âêå Identifier ÁöÑ session ÂÆû‰æã‰πãÂêéÔºåÂ∞±‰ºöËá™Âä®Ë∞ÉÁî® NSURLSessionTaskDelegate ‰∏≠ÁöÑ task ÁªìÊùüÂõûË∞É„ÄÇÁî±‰∫éÊòØ‰∏ãËΩΩÂ§±Ë¥•ÔºåÊâÄ‰ª• error ‰∏≠‰ºöÂåÖÂê´‰ø°ÊÅØÔºåÂèØ‰ª•‰ªéÂÖ∂‰∏≠ÂèñÂá∫ resumeDataÔºåÂπ∂ÈáçÊñ∞ÂàõÂª∫‰∏ãËΩΩÔºö 1234567891011121314- (void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)taskdidCompleteWithError:(NSError *)error&#123; if (error) &#123; // check if resume data are available if ([error.userInfo objectForKey:NSURLSessionDownloadTaskResumeData]) &#123; NSData *resumeData = [error.userInfo objectForKey:NSURLSessionDownloadTaskResumeData]; // ÈáçÊñ∞ÂàõÂª∫‰∏Ä‰∏™ DownloadTaskÔºåÂπ∂ÂºÄÂßã‰∏ãËΩΩ NSURLSessionDownloadTask *task = [self.session] downloadTaskWithResumeData:resumeData]; [task resume]; &#125; &#125;&#125; ÂêÑ‰∏™Á≥ªÁªüÁâàÊú¨ÂØºËá¥ÁöÑ resumeData ÁöÑÈîôËØØiOS10.0 - 10.1 ‰∏≠‰ΩøÁî®Á≥ªÁªüÁöÑ resumeData Êó†Ê≥ïÁõ¥Êé•ÊÅ¢Â§ç‰∏ãËΩΩÔºåÂéüÂõ†ÊòØcurrentRequestÂíåoriginalRequest ÁöÑNSKeyArchivedÁºñÁ†ÅÂºÇÂ∏∏„ÄÇËé∑ÂèñÂà∞resumeDataÂêéÔºåÈúÄË¶ÅÂØπÂÆÉËøõË°å‰øÆÊ≠£Ôºå‰ΩøÁî®‰øÆÊ≠£ÂêéÁöÑresumeDataÂàõÂª∫downloadTaskÔºåÂÜçÂØπdownloadTaskÁöÑcurrentRequestÂíåoriginalRequestËµãÂÄºÔºåStack Overflow‰∏äÈù¢ÊúâÂÖ∑‰ΩìËØ¥Êòé„ÄÇ iOS 11.0 - 11.2 ‰∏≠Áî±‰∫éÂ§öÊ¨°ÂØπdownloadTaskËøõË°å ÂèñÊ∂à - ÊÅ¢Â§ç Êìç‰ΩúÔºåÁîüÊàêÁöÑresumeData‰ºöÂ§öÂá∫‰∏Ä‰∏™key‰∏∫NSURLSessionResumeByteRangeÁöÑÈîÆÂÄºÂØπÔºåÊâÄ‰ª•‰ºöÂØºËá¥Áõ¥Êé•‰∏ãËΩΩÊàêÂäüÔºàÂÆûÈôÖ‰∏äÊ≤°ÊúâÔºâÔºå‰∏ãËΩΩÁöÑÊñá‰ª∂Â§ßÂ∞èÁõ¥Êé•ÂèòÊàê0„ÄÇÈúÄË¶ÅÊääkey‰∏∫NSURLSessionResumeByteRangeÁöÑÈîÆÂÄºÂØπÂà†Èô§„ÄÇ ÊôÆÈÄö‰∏ãËΩΩ‰∏éÂêéÂè∞‰∏ãËΩΩÊôÆÈÄö‰∏ãËΩΩÂêéÂêéÂè∞‰∏ãËΩΩÁöÑÂå∫Âà´Âú®‰∫éÂàõÂª∫ÁöÑ NSURLSession ÊòØÊôÆÈÄöÁöÑËøòÊòØÊîØÊåÅÂêéÂè∞ÁöÑÔºå‰πüÂ∞±ÊòØÂàõÂª∫Êó∂‰º†ÂÖ•ÁöÑ config ÁöÑÂå∫Âà´Ôºö 12345// ÊîØÊåÅÂêé‰∏ãËΩΩÁöÑ NSURLSession ÁöÑ configNSURLSessionConfiguration* sessionConfig = [NSURLSessionConfiguration backgroundSessionConfigurationWithIdentifier:@"some Identifier"];// ÊôÆÈÄöÁöÑ NSURLSession ÁöÑ configNSURLSessionConfiguration* sessionConfig = [NSURLSessionConfiguration default]; ÂêéÂè∞ÁöÑ config Ë¶ÅÊ±Ç‰º†ÂÖ•‰∏Ä‰∏™ IdentifierÔºåËÄåÊôÆÈÄöÁöÑ config ÂàôÊòØÈªòËÆ§ÁöÑ„ÄÇ ËøõÂÖ•ÂêéÂè∞„ÄÅÂ∫îÁî® crashÊôÆÈÄö‰∏ãËΩΩÂú®ÂêéÂè∞ crash Êó∂‰ºöÁ´ãÂàªÂÅúÊ≠¢‰∏ãËΩΩÔºõËÄåÂêéÂè∞‰∏ãËΩΩÂàô‰∏çÂêåÔºåÂÆÉÂú®ËøõÂÖ•ÂêéÂè∞ÂêéÔºå‰ºöÂíå background task ‰∏ÄÊ†∑ËÆ©Â∫îÁî®Ëé∑Âèñ 3 ÂàÜÈíüÁöÑÊ¥ªÂä®Êó∂Èó¥ÔºåÊó∂Èó¥Âà∞ÂêéËøòÊ≤°‰∏ãËΩΩÂÆåÊàêÁöÑÔºå‰ºöË¢´Á≥ªÁªüÁöÑ watchdog ÊùÄÊ≠ªÔºåËøõËÄåÁî±Âè¶‰∏Ä‰∏™Á≥ªÁªüÁöÑËøõÁ®ãÁªßÁª≠‰∏ãËΩΩ„ÄÇÂÖ∂‰ªñÂêÑÁßç‰ª£Á†Å‰∏ç‰∏•Ë∞®ÂØºËá¥ÁöÑ crash ‰πüÊòØ‰∏ÄÊ†∑ÔºåÁ≥ªÁªü‰ºöÂàõÂª∫Âè¶‰∏Ä‰∏™ËøõÁ®ã‰∏ãËΩΩ„ÄÇ Âú®ÂõûÂà∞ÂâçÂè∞ÔºåÊàñËÄÖÈáçÊñ∞ÂàõÂª∫ Session ‰πãÂêéÔºåsession ÁöÑ‰ª£ÁêÜÊñπÊ≥ï‰ºöË¢´ÁªßÁª≠Ë∞ÉÁî®„ÄÇÂú®ÈáçÂª∫ Session ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ÈÄöËøá Session ÁöÑ getTasksWithCompletionHandler: ÊñπÊ≥ïËé∑ÂèñÈáçÂª∫ Session ‰πãÂêéÔºåÊÅ¢Â§çÁöÑ‰πãÂâçÁöÑ downloadTaskÔºåÂπ∂ÂØπÂÖ∂ÂÅö‰∏ÄÂÆöÁöÑËÆæÁΩÆ(ÊØîÂ¶Ç‰Ω†Áî®‰∏Ä‰∏™ÂåÖË£ÖÁ±ªÂ∞Ü Task ÂåÖË£Ö‰∫ÜËµ∑Êù•ÔºåTask ÂõûË∞É‰∏≠‰ΩøÁî®ÁöÑÊòØÂåÖË£ÖÁ±ªÁöÑÊñπÊ≥ïÔºåÈÇ£‰πà‰Ω†Â∞±‰∏ÄÂÆöË¶ÅÂú®ÂàõÂª∫ÂÆå Session ‰πãÂêéÁ´ãÂç≥Ëé∑ÂèñÊâÄÊúâÁöÑ TaskÔºåÈáçÂª∫ÂåÖË£ÖÁ±ª„ÄÇ) ‰∏ãËΩΩÂÆåÊàêÊôÆÈÄö‰∏ãËΩΩÁöÑ‰∏ãËΩΩÂÆåÊàêÂ∞±ÊòØÊ≠£Â∏∏ÁöÑÂâçÂè∞‰∏ãËΩΩÂÆåÊàê„ÄÇËÄåÂêéÂè∞‰∏ãËΩΩÂÆåÊàêÂàôÂå∫ÂàÜÂêÑÁßçÊÉÖÂÜµÔºö Â∫îÁî®Âú®ÂâçÂè∞ Â∫îÁî®Âú®ÂêéÂè∞ Â∫îÁî®Ë¢´ÊùÄÔºå‰∏î‰∏ãËΩΩÂÆåÊàêÊó∂Â∫îÁî®Ê≤°ÊúâË¢´ÊâìÂºÄ Â∫îÁî®Ë¢´ÊùÄÔºå‰∏î‰∏ãËΩΩÂÆåÊàêÊó∂Â∫îÁî®Ë¢´ÊâìÂºÄÔºå‰∏îÂêåÊó∂ÂàõÂª∫Â•ΩÁõ∏Âêå Identifier ÁöÑ Session Â∫îÁî®Ë¢´ÊùÄÔºå‰∏î‰∏ãËΩΩÂÆåÊàêÊó∂Â∫îÁî®Ë¢´ÊâìÂºÄÔºå‰ΩÜÊ≤°ÊúâÂàõÂª∫Áõ∏Âêå Identifier ÁöÑ Session 1 Â∞±ÊòØËµ∞ÊôÆÈÄöÁöÑÂõûË∞É 2 ÂÖ®ÈÉ® task ÂÆåÊàêÂêéÂõûË∞É‰∏ãÈù¢ÊñπÊ≥ïÊøÄÊ¥ª appÔºö 1234//Âú®Â∫îÁî®Â§Ñ‰∫éÂêéÂè∞Ôºå‰∏îÂêéÂè∞‰ªªÂä°‰∏ãËΩΩÂÆåÊàêÊó∂ÂõûË∞É - (void)application:(UIApplication *)applicationhandleEventsForBackgroundURLSession:(NSString *)identifier completionHandler:(void (^)())completionHandler; ‰πãÂêé‰ºöË∞ÉÁî® session Áõ∏ÂÖ≥‰ª£ÁêÜÊñπÊ≥ïÔºåÊúÄÂêéË∞ÉÁî®: 12345/* Â∫îÁî®Âú®ÂêéÂè∞ÔºåËÄå‰∏îÂêéÂè∞ÊâÄÊúâ‰∏ãËΩΩ‰ªªÂä°ÂÆåÊàêÂêéÔºå * Âú®ÊâÄÊúâÂÖ∂‰ªñNSURLSessionÂíåNSURLSessionDownloadTaskÂßîÊâòÊñπÊ≥ïÊâßË°åÂÆåÂêéÂõûË∞ÉÔºå * ÂèØ‰ª•Âú®ËØ•ÊñπÊ≥ï‰∏≠ÂÅö‰∏ãËΩΩÊï∞ÊçÆÁÆ°ÁêÜÂíåUIÂà∑Êñ∞ */ - (void)URLSessionDidFinishEventsForBackgroundURLSession:(NSURLSession *)session; ÊúÄÂ•ΩÂ∞ÜhandleEventsForBackgroundURLSession‰∏≠completionHandler‰øùÂ≠òÔºåÂú®ËØ•ÊñπÊ≥ï‰∏≠ÂæÖÊâÄÊúâËΩΩÊï∞ÊçÆÁÆ°ÁêÜÂíåUIÂà∑Êñ∞ÂÅöÂÆåÂêéÔºåÂÜçË∞ÉÁî®completionHandler() 3 Áî±‰∫éÂ∫îÁî®Ê≤°ÊúâË¢´ÊâìÂºÄÔºå‰ºöÂÖàÂêØÂä® appÔºåÂõûË∞É AppDelegate ‰∏≠ÁöÑ didFinishLaunchingWithOptions: ÊñπÊ≥ï„ÄÇÈöèÂêé‰ºöÂõûË∞É 2 ‰∏≠ÁöÑ handleEventsForBackgroundURLSession„ÄÇÁî±‰∫é 2 Âú®ÂêéÂè∞ÔºåSession Ê≤°ÊúâË¢´Ê∏ÖÈô§ÔºåÊâÄ‰ª•ÂêéÈù¢Â∞±ÂèØ‰ª•Áõ¥Êé•ÂõûË∞É Session ÁöÑ‰ª£ÁêÜÊñπÊ≥ï„ÄÇËÄå 3 Ê≠§Êó∂ÂàöÂàöÈáçÊñ∞ÂêØÂä®ÔºåÊ≤°ÊúâÂàõÂª∫ SessionÔºåÂõ†Ê≠§ÔºåÈúÄË¶ÅÂú® handleEventsForBackgroundURLSession ÊñπÊ≥ï‰∏≠ÈÄöËøá Identifier ÈáçÂª∫ SessionÔºåÊâçËÉΩËøõË°åÂêéÁª≠ÁöÑÂõûË∞ÉÊñπÊ≥ï„ÄÇÈáçÂª∫Â•Ω Session ‰πãÂêéÁöÑËøáÁ®ãÂíå 2 Áõ∏Âêå„ÄÇ 4 Áî±‰∫éÂú®ÂâçÂè∞Ôºå‰∏îÂàõÂª∫Â•Ω‰∫Ü SessionÔºåÂõ†Ê≠§Âíå 1 ‰∏ÄÊ†∑ 5 Áî±‰∫éÊ≤°ÊúâÂàõÂª∫ SessionÔºå‰ºöË∞ÉÁî® handleEventsForBackgroundURLSession ÂàõÂª∫ SessionÔºåÂíå 3 Á±ª‰ºº„ÄÇ ÂèÇËÄÉiOS‰ΩøÁî®NSURLSessionËøõË°å‰∏ãËΩΩÔºàÂåÖÊã¨ÂêéÂè∞‰∏ãËΩΩÔºåÊñ≠ÁÇπ‰∏ãËΩΩÔºâ ÂÜôÁöÑÈùûÂ∏∏Â•Ω iOSÂéüÁîüÁ∫ßÂà´ÂêéÂè∞‰∏ãËΩΩËØ¶Ëß£]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS ËØÅ‰π¶Áõ∏ÂÖ≥]]></title>
    <url>%2F2017%2F03%2F04%2FiOS%E8%AF%81%E4%B9%A6%2F</url>
    <content type="text"><![CDATA[ÂÖ≥‰∫éËãπÊûúÁöÑËØÅ‰π¶ÈóÆÈ¢òÊêûÂæóÁÑ¶Â§¥ÁÉÇÈ¢ùÔºå‰ª£Á†ÅÊ≤°ÈóÆÈ¢òÔºåË∑ë‰∏çËµ∑Êù•ËøôÊòØÊúÄÊ∞îÁöÑ„ÄÇÊâÄ‰ª•ÂÜ≥ÂÆöÂÆåÊï¥Âú∞‰∫ÜËß£‰∏Ä‰∏ã„ÄÇ Âü∫Á°ÄÂØÜÁ†ÅÂü∫Á°ÄÂä†ÂØÜÊñπÊ≥ïÂèØ‰ª•ÂàÜ‰∏∫‰∏§Â§ßÁ±ª„ÄÇ‰∏ÄÁ±ªÊòØÂØπÁß∞Âä†ÂØÜÔºàprivate key cryptographyÔºâÔºåËøòÊúâ‰∏ÄÁ±ªÂè´ÂÅöÈùûÂØπÁß∞Âä†ÂØÜÔºàpublic key cryptographyÔºâ„ÄÇÂâçËÄÖÁöÑÂä†ÂØÜÂíåËß£ÂØÜËøáÁ®ãÈÉΩÁî®Âêå‰∏ÄÂ•óÂØÜÁ†ÅÔºåÂêéËÄÖÁöÑÂä†ÂØÜÂíåËß£ÂØÜËøáÁ®ãÁî®ÁöÑÊòØ‰∏§Â•óÂØÜÁ†Å„ÄÇ ÂØπÁß∞Âä†ÂØÜÊÉÖÂÜµ‰∏ãÔºåÂØÜÈí•Âè™Êúâ‰∏ÄÊääÔºåÂä†ÂØÜËß£ÂØÜÈÉΩÈÄöËøáÂÖ∂ÂÆåÊàê„ÄÇÂØÜÈí•ÁöÑ‰øùÂ≠òÈùûÂ∏∏ÈáçË¶Å„ÄÇ ÈùûÂØπÁß∞Âä†ÂØÜÊó∂ÔºåÂØÜÈí•Êúâ‰∏§ÊääÔºå‰∏ÄÊääÁªôÂà´‰∫∫‰ΩøÁî®ÁöÑÂÖ¨Èí•Ôºå‰∏ÄÊääÂè™ÊúâËá™Â∑±Áü•ÈÅìÁöÑÁßÅÈí•„ÄÇÂÖ¨Èí•ÂíåÁßÅÈí•‰∏Ä‰∏ÄÂØπÂ∫îÔºåÂÖ¨Èí•ËÉΩËß£ÂºÄÁßÅÈí•Âä†ÂØÜÁöÑ‰ø°ÊÅØÔºåÁßÅÈí•‰πüËÉΩËß£ÂºÄÂÖ¨Èí•Âä†ÂØÜÁöÑ‰ø°ÊÅØ„ÄÇÂêåÊó∂ÁîüÊàêÂÖ¨Èí•ÂíåÁßÅÈí•ÊØîËæÉÂÆπÊòìÔºå‰ΩÜÊòØ‰ªéÂÖ¨Èí•Êé®ÁÆóÂá∫ÁßÅÈí•ÊòØÂá†‰πé‰∏çÂèØËÉΩÁöÑ„ÄÇ ÁõÆÂâçÔºåÈÄöÁî®ÁöÑÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ï‰∏∫AESÔºàAdvanced Encryption StandardÔºâÔºåÈÄöÁî®ÁöÑÈùûÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ï‰∏∫RSAÔºà Rivest-Shamir-AdlemanÔºâ„ÄÇ Âú®ÈùûÂØπÁß∞‰ΩìÁ≥ª‰∏≠ÔºåÂÖ¨Èí•Áî®Êù•Âä†ÂØÜ‰ø°ÊÅØÔºàÂõ†‰∏∫Âè™ÊúâÁßÅÈí•ÊâçËÉΩÊâìÂºÄÔºâÔºåÁßÅÈí•Áî®Êù•Êï∞Â≠óÁ≠æÂêçÔºà‰øùËØÅÊï∞ÊçÆÂÆåÊï¥ÊÄßÁöÑÔºå‰ΩÜÂÆÉ‰∏ç‰øùËØÅÊï∞ÊçÆÂä†ÂØÜÔºå‰∏ç‰øùËØÅÊï∞ÊçÆ‰º†ËæìÈÄî‰∏≠Êó†‰∫∫ÂóÖÊé¢Á™ÉÂê¨Ôºâ„ÄÇ Âõ†‰∏∫‰ªª‰Ωï‰∫∫ÈÉΩÂèØ‰ª•ÁîüÊàêËá™Â∑±ÁöÑÔºàÂÖ¨Èí•ÔºåÁßÅÈí•ÔºâÂØπÔºåÊâÄ‰ª•‰∏∫‰∫ÜÈò≤Ê≠¢Êúâ‰∫∫Êï£Â∏É‰º™ÈÄ†ÁöÑÂÖ¨Èí•È™óÂèñ‰ø°‰ªªÔºåÂ∞±ÈúÄË¶Å‰∏Ä‰∏™ÂèØÈù†ÁöÑÁ¨¨‰∏âÊñπÊú∫ÊûÑÊù•ÁîüÊàêÁªèËøáËÆ§ËØÅÁöÑÔºàÂÖ¨Èí•ÔºåÁßÅÈí•ÔºâÂØπ„ÄÇ ÈùûÂØπÁß∞Âä†ÂØÜÂéüÁêÜÂÖ≥‰∫éÈùûÂØπÁß∞Âä†ÂØÜÔºåÂú®‰πãÂâçÂÜôËøáÁöÑ ‚ÄúhttpÂéüÁêÜ‚Äù ‰∏ÄÊñá‰∏≠‰πüÊúâÂ§ßÊ¶ÇÁöÑÊ¢≥ÁêÜ„ÄÇËøôËæπÂÜç‰ªîÁªÜËØ¥‰∏ã„ÄÇ ÈúÄË¶ÅÊòéÁ°ÆÔºöÂÖ¨Èí•‰ªª‰Ωï‰∫∫ÈÉΩËÉΩÊúâÔºåÁßÅÈí•Âè™ËÉΩËá™Â∑±ÊåÅÊúâÔºåÂ¶ÇÊûúÂà´‰∫∫ÊãøÂà∞‰∫Ü‰Ω†ÁöÑÁßÅÈí•ÔºåÈÇ£‰πàÂà´‰∫∫‰πüÂ∞±Êàê‰∏∫‰∫Ü‰Ω†„ÄÇÂõ†Ê≠§ÔºåÁî®ÂÖ¨Èí•Âä†ÂØÜÔºåÁßÅÈí•Ëß£ÂØÜÁöÑ‰ø°ÊÅØÊòØÁªùÂØÜÁöÑÔºõËÄåÁî®ÁßÅÈí•Âä†ÂØÜÔºåÂÖ¨Èí•Ëß£ÂØÜÁöÑ‰ø°ÊÅØÔºåÂπ∂‰∏çËÉΩ‰øùËØÅÂÆâÂÖ®„ÄÇÊâÄ‰ª•Áî®ÁßÅÈí•Âä†ÂØÜÁöÑ‰ø°ÊÅØ‰∏ÄËà¨Áî®Êù•‰øùËØÅ‰º†Ëæì‰ø°ÊÅØÁöÑÂÆåÊï¥ÊÄß‰∏éÊú™Ë¢´‰øÆÊîπ„ÄÇ Êï¥‰∏™Âä†ÂØÜËß£ÂØÜÁöÑÊµÅÁ®ãÂ§ßÊ¶ÇÊòØËøôÊ†∑ÁöÑÔºö A ÊúâÂÖ¨Èí•ÔºåB ÊúâÁßÅÈí•„ÄÇA Â∞ÜÁî®ÂÖ¨Èí•Âä†ÂØÜÁöÑÊ∂àÊÅØÂèëÈÄÅÁªô BÔºåÈÇ£‰πàÂè™ÊúâÊã•ÊúâÁßÅÈí•ÁöÑ B ÊâçËÉΩÂ§üËß£ÂØÜÔºåÂÖ∂‰ªñ‰∫∫Êó†Ê≥ïËß£ÂØÜÂá∫Ê∂àÊÅØÊòéÊñá„ÄÇ B Ë¶ÅÂèëÊ∂àÊÅØÁªô A„ÄÇÁî±‰∫éÂÖ¨Èí•ÊòØÂÖ¨ÂºÄÁöÑÔºåÈÇ£‰πà B Áî®ÁßÅÈí•Âä†ÂØÜÁöÑÊ∂àÊÅØÂØπÊâÄÊúâ‰∫∫ÂÖ∂ÂÆûÈÉΩÊòØÂÖ¨ÂºÄÁöÑÔºåÊâÄ‰ª•‰∏ÄËà¨‰∏çÁî® B ÁöÑÁßÅÈí•Âä†ÂØÜÊ∂àÊÅØ„ÄÇËÄåÂè™ÊòØÊãø B ÁöÑÁßÅÈí•‰∫ßÁîü‰∏Ä‰∏™‚ÄúÊï∞Â≠óÁ≠æÂêç‚Äù„ÄÇÊï∞Â≠óÁ≠æÂêçÂ∞±ÊòØ Â∞Ü B Âç≥Â∞ÜÁªô A ÂèëÈÄÅÁöÑÊ∂àÊÅØÁöÑ hash ÂÄºÔºàÈÄöËøá MD5„ÄÅSHAÁ≠âÁÆóÊ≥ïÔºâËøõË°åÂä†ÂØÜ„ÄÇB ÂèëÈÄÅÊ∂àÊÅØÁöÑÊó∂ÂÄôÔºåÂ∞ÜÊ∂àÊÅØÂéüÊñáÂíåÊï∞Â≠óÁ≠æÂêç‰∏ÄÂπ∂ÂèëÂá∫„ÄÇA Êé•Êî∂Âà∞‰∏§ËÄÖÂêéÔºåÂØπÂéüÊñáÂèñ hashÔºå‰∏éÂÖ¨Èí•Ëß£ÂØÜÁöÑÊï∞Â≠óÁ≠æÂêç‰∏≠Ëé∑ÂæóÁöÑ hash ÂÄºÊØîÂØπÔºåÂ¶ÇÊûúÁõ∏ÂêåË°®Á§∫Ê∂àÊÅØÊ≤°ÊúâÁªèËøáÂà´‰∫∫ÁöÑ‰øÆÊîπ„ÄÇ ‰∏äÈù¢‰øùËØÅ‰∫Ü A ÁöÑ‰ø°ÊÅØËÉΩÂÆâÂÖ®ÁöÑÂà∞ B„ÄÇ‰ΩÜÊòØÊ≤°ÊúâËß£ÂÜ≥‚ÄúÂ¶Ç‰ΩïÊâçËÉΩ‰Ωø B Áªô A ÂèëÈÄÅÁöÑÊ∂àÊÅØ‰∏çË¢´Âà´‰∫∫Á™•Êé¢Ôºü‚Äù ÂæàÂÆπÊòìÊÉ≥Âà∞ÔºåÂè™Ë¶ÅÂÜçÊù•‰∏ÄÂ•óÂÖ¨Èí•ÁßÅÈí•ÔºåÂç≥ B ÂêåÊó∂‰πüÊã•Êúâ A ÁöÑÂÖ¨Èí•ÔºåÂèë‰ø°ÊÅØÁöÑÊó∂ÂÄôÁî® A ÁöÑÂÖ¨Èí•Âä†ÂØÜÂç≥ÂèØÔºå‰∏çËøáËøôÊ†∑Â§ÑÁêÜÈùûÂ∏∏È∫ªÁÉ¶Ë¥πÊó∂„ÄÇhttps ÊòØËøôÊ†∑ÂÅöÁöÑÔºöÂÆ¢Êà∑Á´ØÊã•ÊúâÊúçÂä°Á´ØÁöÑÂÖ¨Èí•ÔºàÂç≥‰∏äÈù¢ÊâÄËØ¥ÁöÑ AÔºåÂÖà‰∏çË¶ÅÁÆ°ÊÄé‰πàÊãøÂà∞ÁöÑÊúçÂä°Á´ØÂÖ¨Èí•ÁöÑ‰ª•ÂèäÊòØÂ¶Ç‰ΩïÁ°ÆÂÆöÂ∞±ÊòØÊúçÂä°Á´ØÂÖ¨Èí•ËÄå‰∏çÊòØÂÖ∂‰ªñÊîªÂáªËÄÖÁöÑÂÖ¨Èí•ÁöÑËøô‰∏§ÁÇπÔºâÔºåÊúçÂä°Á´ØÊã•ÊúâÂÖ∂Ëá™Â∑±ÁöÑÁßÅÈí•ÔºàÂç≥ BÔºâ„ÄÇA Âú®Êú¨Âú∞ÁîüÊàê‰∏ÄÊÆµÈöèÊú∫Â≠óÁ¨¶Ôºå‰Ωú‰∏∫‰πãÂêéÂØπÁß∞Âä†ÂØÜÁöÑÂØÜÈí•ÔºåÂ∞ÜËøô‰∏™ÂØÜÈí•ÈÄöËøáÂÖ¨Èí•Âä†ÂØÜÂèëÁªô BÔºåËøôÊ†∑ A B Â∞±ÂÖ±ÂêåÊã•Êúâ‰∫ÜÂÖ∂‰ªñ‰∫∫ÈÉΩ‰∏çÁü•ÈÅìÁöÑÂÖ±ÂêåÂØÜÈí•Ôºå‰∏§ËÄÖ‰πãÈó¥ÁöÑÈÄö‰ø°Â∞±ÂÆâÂÖ®‰∫Ü„ÄÇÊâÄ‰ª• https ÁöÑÊú¨Ë¥®ÊòØÂØπÁß∞Âä†ÂØÜÔºåÊ†∏ÂøÉÊòØÂÆ¢Êà∑Á´ØÂ¶Ç‰ΩïÂ∞ÜÂØÜÈí•‰º†ÁªôÊúçÂä°Á´ØÔºåÊ†πÊú¨ÈóÆÈ¢òÂ∞±ÊòØÂ¶Ç‰ΩïËÉΩÂ§üÊ≠£Á°ÆÁöÑÊãøÂà∞ÊúçÂä°Á´ØÁöÑÂÖ¨Èí•ÔºåËÄå‰∏çË¢´‰∏≠Èó¥‰∫∫ÁØ°Êîπ„ÄÇ ‰∏äÈù¢ËØ¥Âà∞Â¶Ç‰ΩïÊãøÂà∞ÊúçÂä°Á´ØÁöÑÂÖ¨Èí•ÔºåÂú®ÂÆ¢Êà∑Á´ØÂèëËµ∑ËØ∑Ê±ÇÂêéÔºåÊúçÂä°Á´Ø‰ºöËøîÂõû‰∏Ä‰∏™ËØÅ‰π¶ÔºåËøô‰∏™ËØÅ‰π¶‰∏≠Â∞±ÂåÖÂê´ÁùÄÂÖ¨Èí•„ÄÇÂÆ¢Êà∑Á´ØÂ¶Ç‰ΩïÁõ∏‰ø°Ëøô‰∏™ËØÅ‰π¶Â∞±ÊòØÊÉ≥Ë¶ÅËØ∑Ê±ÇÁöÑÊúçÂä°Á´ØÁöÑËØÅ‰π¶ËÄå‰∏çÊòØÊîªÂáªËÄÖÁöÑËØÅ‰π¶Âë¢ÔºüËøôÂ∞±ÈúÄË¶Å‰∏Ä‰∏™ÊùÉÂ®ÅÁöÑÁ¨¨‰∏âÊñπÁöÑÈ™åËØÅÔºåÂç≥‚ÄùËØÅ‰π¶‰∏≠ÂøÉ‚ÄùÔºàcertificate authorityÔºåÁÆÄÁß∞CAÔºâÔºå‰∏∫ÂÖ¨Èí•ÂÅöËÆ§ËØÅ„ÄÇËØÅ‰π¶‰∏≠ÂøÉÁî®Ëá™Â∑±ÁöÑÁßÅÈí•‰∏∫ÊúçÂä°Âô®ÁöÑÂÖ¨Èí•Ôºå‰ª•ÂèäÊúçÂä°Á´ØÁöÑ‰ø°ÊÅØÂÅöÂä†ÂØÜÔºåËøûÂêå CA ‰ø°ÊÅØÔºå‰øùÂ≠òÂú®Êñ∞ÁîüÊàêÁöÑ‚ÄùÊï∞Â≠óËØÅ‰π¶‚Äù‰∏≠„ÄÇÂÆ¢Êà∑Á´ØÊúÄÁªàËé∑ÂèñÂà∞ËØÅ‰π¶Â∞±ÊòØÁªèËøáËØÅ‰π¶‰∏≠ÂøÉÂä†ÂØÜËøáÁöÑËØÅ‰π¶„ÄÇÊãøÂà∞ËØÅ‰π¶ÂêéÔºåÂÆ¢Êà∑Á´ØÂÖàÂà∞Ëá™Ë∫´Ê†πËØÅ‰π¶ÂàóË°®Êü•ÁúãËØ•ËØÅ‰π¶‰∏≠ÂøÉÊòØÂê¶ÊòØÊú¨Êú∫‰ø°‰ªªÁöÑËØÅ‰π¶‰∏≠ÂøÉÔºàËá™Â∑±ËÆ°ÁÆóÊú∫ÁöÑÁâ©ÁêÜÂÆâÂÖ®ÊòØÂâçÊèêÔºåÂ¶ÇÊûúÂà´‰∫∫Â∑≤ÁªèÂèØ‰ª•Áõ¥Êé•ÊéßÂà∂‰Ω†ÁöÑËÆ°ÁÆóÊú∫Ôºå‰øÆÊîπÊ†πËØÅ‰π¶ÂàóË°®ÔºåÈÇ£‰ªÄ‰πàËØÅ‰π¶ÂÆâÂÖ®‰πüÊïë‰∏ç‰∫Ü‰Ω†„ÄÇÔºâ„ÄÇÁÑ∂ÂêéÂ∞±Áî®Ê†πËØÅ‰π¶ÈáåÁöÑÂÖ¨Èí•ÂéªËß£ÊûêËØ•ËØÅ‰π¶ÔºåÈ™åËØÅÊúçÂä°Á´Ø‰ø°ÊÅØ‰ª•ÂèäÂÖ¨Èí•ÊòØÂê¶Ë¢´‰øÆÊîπ„ÄÇ ÂÖ∂ÂÆûÈÅìÁêÜÂ∞±ÊòØÔºö‰Ω†‰∏çÊòØ‰∏çÁõ∏‰ø°ÂèëÊù•ÁöÑÂÖ¨Èí•ÁöÑÂèØÈù†ÊÄß‰πà„ÄÇÈÇ£‰πàÂ∞±‰Ω†Ëá™Â∑±ÂÖà‰øùÂ≠ò‰∏Ä‰∫õ‰ø°‰ªªÁöÑÁ¨¨‰∏âÊñπÁöÑÂÖ¨Èí•ÔºåÈÄöËøá CA ÁöÑÂÖ¨Èí•ÂéªËß£ÊûêËé∑ÂæóÊúçÂä°Á´ØÁöÑÂÖ¨Èí•„ÄÇÊîªÂáªËÄÖÊòØÊ≤°Êúâ CA ËÆ§ËØÅËøá ÔºåÊàñËÄÖÂç≥‰ΩøËÆ§ËØÅ‰∫ÜÔºåËØÅ‰π¶‰∏≠ÁöÑ‰ø°ÊÅØ‰πüÊòØ‰∏éÁúüÊ≠£Ë¶ÅËØ∑Ê±ÇÁöÑÊúçÂä°Á´Ø‰∏çÂêåÁöÑ„ÄÇÂõ†Ê≠§ÔºåËøôÊ†∑Â∞±ËÉΩ‰øùËØÅÂÖ∂ÂèØ‰ø°ÊÄß‰∫Ü„ÄÇ ËØ¥ÂÆå‰∫Ü httpsÔºåÂÖ∂ÂÆû SSH ‰πüÊòØÁ±ª‰ººÁöÑÔºåÊúçÂä°Á´Ø‰º†ËæìÂÖ¨Èí•ÁªôÂÆ¢Êà∑Á´ØÁªôÂÖ∂Âä†ÂØÜ‰ΩøÁî®ÔºåÂêåÊ†∑ÁöÑ‰πü‰ºöÈÅáÂà∞‰∏≠Èó¥‰∫∫ÊîªÂáªÁöÑÈóÆÈ¢ò„ÄÇÁî±‰∫é SSH Ê≤°Êúâ CA ËÆ§ËØÅÔºåÊâÄ‰ª•Âú®Á¨¨‰∏ÄÊ¨°ËøûÊé•ÊúçÂä°Âô®Êó∂Ë¶ÅÊÖéÈáçÔºå‰ºöÊèêÁ§∫‰Ω†ÊòØÂê¶Êé•ÂèóËøô‰∏™ËøúÁ®ã‰∏ªÊú∫ÁöÑÂÖ¨Èí•Ôºö 1Are you sure you want to continue connecting (yes/no)? yes Â¶ÇÊûúÊé•ÂèóÔºåÈÇ£‰πàËØ•ÂÖ¨Èí•Â∞±‰ºö‰øùÂ≠òÂú®Êú¨Êú∫‰∏≠„ÄÇ‰∏ãÊ¨°ÂÜçËøûÊé•ËøôÂè∞‰∏ªÊú∫ÔºåÁ≥ªÁªüÂ∞±‰ºöËÆ§Âá∫ÂÆÉÁöÑÂÖ¨Èí•Â∑≤Áªè‰øùÂ≠òÂú®Êú¨Âú∞‰∫Ü„ÄÇ https Âíå SSH ÈÉΩÊé•ÂèóÁî®Êà∑ÂêçÂØÜÁ†ÅÁôªÂΩïÔºåÂç≥ÂÆ¢Êà∑Á´ØÈÄöËøáÊúçÂä°Âô®‰∏ãÂèëÁöÑÂÖ¨Èí•Âä†ÂØÜÂêé‰º†ËæìÁªôËøúÁ®ã‰∏ªÊú∫„ÄÇSSH ËøòÊé•ÂèóÂÖ¨Èí•ÁôªÂΩïÔºåÂ∞±ÊòØÊú¨Êú∫ÁîüÊàê‰∏ÄÂØπÂÖ¨Èí•ÂíåÁßÅÈí•Ôºà‰øùÂ≠òÂú®Ê†πÁõÆÂΩïÁöÑ .ssh Êñá‰ª∂Â§π‰∏ãÔºâÔºåÂ∞ÜÂÖ¨Èí•‰øùÂ≠òÂú®ÊúçÂä°Âô®‰∏äÔºåÊúâÁÇπÁ±ª‰ºº‰∫é‰∏äÈù¢ËØ¥ÁöÑ A Âíå B ÂêÑËá™‰øùÂ≠òËá™Â∑±ÁöÑÂÖ¨Èí•ÂíåÂØπÊñπÁöÑÁßÅÈí•„ÄÇÁôªÂΩïÁöÑÊó∂ÂÄôÔºåËøúÁ®ã‰∏ªÊú∫‰ºöÂêëÁî®Êà∑ÂèëÈÄÅ‰∏ÄÊÆµÈöèÊú∫Â≠óÁ¨¶‰∏≤ÔºåÁî®Êà∑Áî®Ëá™Â∑±ÁöÑÁßÅÈí•Âä†ÂØÜÂêéÔºåÂÜçÂèëÂõûÊù•„ÄÇËøúÁ®ã‰∏ªÊú∫Áî®‰∫ãÂÖàÂÇ®Â≠òÁöÑÂÖ¨Èí•ËøõË°åËß£ÂØÜÔºåÂ¶ÇÊûúÊàêÂäüÔºåÂ∞±ËØÅÊòéÁî®Êà∑ÊòØÂèØ‰ø°ÁöÑÔºåÁõ¥Êé•ÂÖÅËÆ∏ÁôªÂΩïshellÔºå‰∏çÂÜçË¶ÅÊ±ÇÂØÜÁ†Å„ÄÇ Âú® Apple ÂºÄÂèëÁΩëÁ´ô‰∏ä‰º†ÂåÖÂê´ÂÖ¨Èí•ÁöÑ CSR Êñá‰ª∂‰Ωú‰∏∫Êç¢ÂèñËØÅ‰π¶ÁöÑÂá≠ËØÅÔºàUpload CSR file to generate your certificateÔºâÔºàÂç≥Ëá™Â∑±ÁöÑÂÖ¨Èí•ÔºâÔºåÊúâÁÇπÁ±ª‰ºº‰∏∫githubË¥¶Âè∑Ê∑ªÂä†SSHÂÖ¨Èí•Âà∞ÊúçÂä°Âô®‰∏äËøõË°åÊéàÊùÉ„ÄÇ iOS Áõ∏ÂÖ≥App IDsapp id Âíå bundle identifier ÊòØ‰∏ÄËá¥ÔºàExplicitÔºâÁöÑÊàñÂåπÈÖçÔºàWildcardÔºâÁöÑ„ÄÇ Âú® name ‰∏≠ËæìÂÖ• app id ÊòæÁ§∫ÁöÑÂêçÂ≠óÔºö ÂèØ‰ª•ÈÄâÊã© explicit app id ÊàñËÄÖ wildcard app id„ÄÇÂâçËÄÖÁî®‰∫éË°®Á§∫Ê†áËØÜÂîØ‰∏ÄÁöÑÂ∫îÁî®Á®ãÂ∫èÔºåÂêéËÄÖ‰∏∫Âê´ÊúâÈÄöÈÖçÁ¨¶ÁöÑ app idÔºåÁî®‰∫éÊ†áËØÜ‰∏ÄÁªÑÂ∫îÁî®Á®ãÂ∫è„ÄÇ‰∏ÄËà¨Êé®ËçêÁî®ÂâçËÄÖ„ÄÇ ÊúÄÂêéÂãæÈÄâÈúÄË¶ÅÁî®Âà∞ÁöÑ app serviceÔºåÊØîÂ¶Ç push notification: ÁªßÁª≠ÁÇπÂáª continue-&gt;submit-&gt;doneÔºåÂÆåÊàê app id ÁöÑÂàõÂª∫„ÄÇÂèØ‰ª•ÁÇπÂáªÂàöÁî≥ËØ∑ÁöÑ idÔºåÂØπÂÖ∂ËøõË°åÁºñËæëÔºö ÊØîÂ¶ÇÂ¶ÇÊûúÁî®Âà∞Êé®ÈÄÅÂäüËÉΩÔºåÂ∞±Ë¶Å‰∏∫ÂÖ∂Ê∑ªÂä†Êé®ÈÄÅËØÅ‰π¶Ôºö ÊÄªÁªìÔºöapp id ‰∏ªË¶ÅËÆæÁΩÆ‰∫Ü bundle id ÁöÑ app ÁâπÊúâÊ†áËØÜÔºåÂè¶Â§ñ‰∏∫ËØ• app ËÆæÁΩÆ‰∫ÜÊâÄÈúÄÁöÑÊúçÂä°„ÄÇ CertificatesiOSËØÅ‰π¶ÊòØÁî®Êù•ËØÅÊòéiOS AppÂÜÖÂÆπÔºàexecutable codeÔºâÁöÑÂêàÊ≥ïÊÄßÂíåÂÆåÊï¥ÊÄßÁöÑÊï∞Â≠óËØÅ‰π¶„ÄÇÂØπ‰∫éÊÉ≥ÂÆâË£ÖÂà∞ÁúüÊú∫ÊàñÂèëÂ∏ÉÂà∞AppStoreÁöÑÂ∫îÁî®Á®ãÂ∫èÔºàAppÔºâÔºåÂè™ÊúâÁªèËøáÁ≠æÂêçÈ™åËØÅÔºàSignature ValidatedÔºâÊâçËÉΩÁ°Æ‰øùÊù•Ê∫êÂèØ‰ø°ÔºåÂπ∂‰∏î‰øùËØÅAppÂÜÖÂÆπÊòØÂÆåÊï¥„ÄÅÊú™ÁªèÁØ°ÊîπÁöÑ„ÄÇ‰∏äÈù¢ËÆ≤‰∫ÜËÆ∏Â§öÂÖ≥‰∫éËØÅ‰π¶ÁöÑÂéüÁêÜÔºåËøôÈáå‰∏ªË¶ÅËÆ≤ËÆ≤ iOS ‰∏≠ËØÅ‰π¶ÁöÑÈÖçÁΩÆ„ÄÇ ËØÅ‰π¶ÂàÜÁ±ªiOSËØÅ‰π¶ÊåâÂäüËÉΩÂàÜ‰∏∫‰∏§ÁßçÔºöÂºÄÂèëËØÅ‰π¶ÔºàDevelopmentÔºâ ÂíåÁîü‰∫ßËØÅ‰π¶ÔºàProductionÔºâ„ÄÇ ÂºÄÂèëËØÅ‰π¶Áî®‰∫éÂºÄÂèëÂíåË∞ÉËØïÂ∫îÁî®Á®ãÂ∫èÔºåÂèØÁî®‰∫éËÅîÊú∫Ë∞ÉËØï„ÄÇÊó†ËÆ∫ÊòØ debug ËøòÊòØ release Áî®ÁöÑÈÉΩÊòØÂºÄÂèëËØÅ‰π¶ Áîü‰∫ßËØÅ‰π¶Áî®Êù•ÂèëÂ∏ÉÂ∫îÁî®Á®ãÂ∫è„ÄÇ iOS ËØÅ‰π¶ÊåâÁ±ªÂûãÂàÜ‰∏∫‰∏§ÁßçÔºö‰∏™‰∫∫ËØÅ‰π¶ÔºàPersonalÔºâ Âíå‰ºÅ‰∏öËØÅ‰π¶ÔºàenterpriseÔºâ ‰∏™‰∫∫ËØÅ‰π¶‰ªÖ‰ºöÂú®ÂÆâË£ÖÁöÑÊó∂ÂÄôÈ™åËØÅËØÅ‰π¶ÁöÑÊúâÊïàÊÄß„ÄÇÂõ†Ê≠§ÔºåÂΩì‰Ω†ÂÆâË£ÖÂÆå app ÂêéÔºåÂç≥‰Ωø‰Ω†Âà†Èô§ developer Ë¥¶Âè∑‰∏≠ÁöÑÂºÄÂèëËØÅ‰π¶ÊàñËÄÖÁîü‰∫ßËØÅ‰π¶ÈÉΩÊòØÊ≤°ÊúâÂÖ≥Á≥ªÁöÑ„ÄÇ ‰ºÅ‰∏öËØÅ‰π¶Âú®‰ªª‰ΩïÊâìÂºÄ app ÁöÑÊó∂ÂÄôÈÉΩ‰ºöÈ™åËØÅËØÅ‰π¶ÁöÑÊúâÊïàÊÄß„ÄÇÂõ†Ê≠§ÔºåÊó†ËÆ∫‰ΩïÊó∂Ôºå‰∏ÄÂÆö‰∏çËÉΩÂà†Èô§ developer Ë¥¶Âè∑‰∏≠ÁöÑÂºÄÂèëËØÅ‰π¶ÊàñËÄÖÁîü‰∫ßËØÅ‰π¶„ÄÇÂê¶ÂàôÔºåÁî®ËØ•ËØÅ‰π¶Á≠æÂêçÁöÑ app Â∞ÜÊèêÁ§∫ËØÅ‰π¶ÈîôËØØÔºåÂ∞ÜÊó†Ê≥ïÊâìÂºÄ„ÄÇ ÁîüÊàêËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂ ÔºàCSRÔºâCSR ÊòØ Cerificate Signing Request ÁöÑËã±ÊñáÁº©ÂÜôÔºåÂç≥ËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂Ôºå‰πüÂ∞±ÊòØËØÅ‰π¶Áî≥ËØ∑ËÄÖÂú®Áî≥ËØ∑Êï∞Â≠óËØÅ‰π¶Êó∂Áî± CSP (Âä†ÂØÜÊúçÂä°Êèê‰æõËÄÖ)Âú®ÁîüÊàêÁßÅÈí•ÁöÑÂêåÊó∂‰πüÁîüÊàêËØÅ‰π¶ËØ∑Ê±ÇÊñá‰ª∂ÔºàÁßÅÈí•Âíå CSR ÂêåÊó∂ÁîüÊàêÔºâÔºàCSR ÂÖ∂ÂÆû‰πüÂ∞±ÊòØÂÖ¨Èí•ÔºâÔºåËØÅ‰π¶Áî≥ËØ∑ËÄÖÂè™Ë¶ÅÊää CSR Êñá‰ª∂Êèê‰∫§ÁªôËØÅ‰π¶È¢ÅÂèëÊú∫ÊûÑÂêéÔºåËØÅ‰π¶È¢ÅÂèëÊú∫ÊûÑ‰ΩøÁî®ÂÖ∂Ê†πËØÅ‰π¶ÁßÅÈí•Á≠æÂêçÂ∞±ÁîüÊàê‰∫ÜËØÅ‰π¶ÂÖ¨Èí•Êñá‰ª∂Ôºå‰πüÂ∞±ÊòØÈ¢ÅÂèëÁªôÁî®Êà∑ÁöÑËØÅ‰π¶„ÄÇÈÄöËøáÂ¶Ç‰∏ãÊñπÂºèÁî≥ËØ∑Ôºö ÈÄâÊã© ‚Äú‰ªéËØÅ‰π¶È¢ÅÂèëÊú∫ÊûÑËØ∑Ê±ÇËØÅ‰π¶‚Äù ÂêéÂá∫Áé∞‰∏ãÈù¢ÊÉÖÂÜµÔºåÂ°´ÂÜôÂºÄÂèëË¥¶Âè∑Âè≥ÈîÆÂíåÂ∏∏Áî®ÂêçÁß∞ÔºåCA ÁîµÂ≠êÂè≥ÈîÆÂú∞ÂùÄÂèØ‰∏çÂ°´ÔºåÂãæÈÄâ ‚ÄúÂ≠òÂÇ®Âà∞Á£ÅÁõò‚ÄùÔºåÁÑ∂ÂêéÁªßÁª≠Ôºö ÊúÄÂêéÂæóÂà∞‰∏Ä‰∏™ csr Êñá‰ª∂ Áî≥ËØ∑ËØÅ‰π¶Áé∞Âú®ËøõÂÖ•Áî≥ËØ∑ËØÅ‰π¶ÁöÑÊµÅÁ®ãÔºö Áî±‰∫é apple ËßÑÂÆö‰∏Ä‰∏™Ë¥¶Âè∑Âè™ËÉΩÁî≥ËØ∑3‰∏™ÂºÄÂèëËØÅ‰π¶Ôºå2‰∏™ÂèëÂ∏ÉËØÅ‰π¶ÔºåÊâÄ‰ª•Áé∞Âú®ÂõæÁâá‰∏äÁöÑÈÉ®ÂàÜ‰∏çËÉΩË¢´ÂãæÈÄâ„ÄÇÈô§‰∫ÜÂºÄÂèëËØÅ‰π¶ÂíåÂèëÂ∏ÉËØÅ‰π¶ÔºåËøòÂèØ‰ª•ÂãæÈÄâ Apple Push Notification service SSL (Sandbox) Âíå Apple Push Notification service SSL (Sandbox &amp; Production) Êù•Âà∂‰ΩúÂºÄÂèëÂíåÂèëÂ∏ÉÊé®ÈÄÅËØÅ‰π¶„ÄÇ Â¶ÇÊûúÊòØÂà∂‰ΩúÊé®ÈÄÅËØÅ‰π¶ÔºåÈúÄË¶ÅÁªëÂÆö App idÔºö Â¶ÇÊûú‰∏çÊòØÊé®ÈÄÅËØÅ‰π¶Ë∑≥Ëøá‰∏ä‰∏ÄÊ≠•ÔºåÁõ¥Êé•ÂæÄ‰∏ãËµ∞Ôºå‰∏ä‰º† CSR Êñá‰ª∂Ôºö ÁÇπÂáªÁîüÊàêÔºåÂ∞±ÂÆåÊàê‰∫ÜËãπÊûúÁî®ÁßÅÈí•ÂØπ‰Ω†ÁöÑÂÖ¨Èí•Âä†ÂØÜÁîüÊàêËØÅ‰π¶ÁöÑËøáÁ®ã„ÄÇÂ∞ÜÁîüÊàêÁöÑËØÅ‰π¶‰∏ãËΩΩÂêéÂèåÂáªÂØºÂÖ•Èí•Âåô‰∏≤ÔºåËá™Âä®Âíå‰πãÂâçÁîüÊàêÁöÑÁßÅÈí•ÂåπÈÖç„ÄÇÂú®Èí•Âåô‰∏≤ÁöÑÊàëÁöÑËØÅ‰π¶‰∏≠Â∞±ËÉΩÁúãÂà∞Áõ∏Â∫îËØÅ‰π¶„ÄÇ ÂØºÂá∫ËØÅ‰π¶ÂØπ‰∫éÂõ¢ÈòüÂêà‰ΩúÔºåÂà´‰∫∫ÈúÄË¶Å‰Ω†ÂàõÂª∫ÁöÑËØÅ‰π¶Ôºå‰Ω†Â∞±Ë¶ÅÂ∞ÜËãπÊûú‰∏ãÂèëÁöÑËØÅ‰π¶ÔºàÁî®ËãπÊûúÁßÅÈí•Âä†ÂØÜÁöÑ‰Ω†ÁöÑÂÖ¨Èí•Ôºâ‰ª•ÂèäÁõ∏Â∫îÁßÅÈí•ÂØºÂá∫‰∏∫ .p12 Ê†ºÂºèÁöÑÊñá‰ª∂ÔºåÂèëÁªôÂà´‰∫∫‰ΩøÁî®„ÄÇÊ≥®ÊÑèÔºå‰Ω†ÂØºÂá∫ p12 ÁöÑÊó∂ÂÄô‰∏ÄÂÆöË¶ÅÂ∞ÜËØÅ‰π¶ÂíåÁßÅÈí•‰∏ÄËµ∑ÈÄâ‰∏≠ÂØºÂá∫ ËØÅ‰π¶Êù•Ëá™Êüê‰∫∫ÁöÑ MacBook‰∏çÁü•ÈÅì‰Ω†ÊúâÊ≤°ÊúâÊ≥®ÊÑèËøáÔºåÂΩì‰Ω†ÁôªÂΩïÂà∞ developer Ë¥¶Âè∑‰∏≠Êü•ÁúãËØÅ‰π¶ÁöÑÊó∂ÂÄôÔºåÁªèÂ∏∏‰ºöÁúãËßÅÂ¶Ç‰∏ãÁöÑÊÉÖÂÜµÔºö ËøôÁßçÂ∏¶Êã¨Âè∑ÊüêÊüê‰∫∫ÁöÑ MacBook ÁöÑËØÅ‰π¶ÊÄé‰πà‰∫ßÁîüÁöÑÂë¢ÔºüËøôÊòØÂõ†‰∏∫Êàë‰ª¨Âú® Xcode ‰∏≠ÁôªÂΩï‰∫ÜÂºÄÂèëËÄÖË¥¶Âè∑ÔºåÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö ÁôªÂΩï AppleId ÂêéÔºå‰ºöÊòæÁ§∫‰Ω†‰∏Ä‰∏™ User ÁöÑ Team ‰∏Ä‰∏™ Agent ÁöÑ Team Èáå„ÄÇXcode Ëá™Âä®Â∏Æ‰Ω†Âú®Á≠æÂêçÁöÑÊó∂ÂÄôÁîüÊàê‰∫Ü‰∏Ä‰∏™ÁßÅÈí•‰ª•ÂèäËØÅ‰π¶„ÄÇ DevicesDeviceÊòØÊåáËøêË°åiOSÁ≥ªÁªüÁî®‰∫éÂºÄÂèëË∞ÉËØïAppÁöÑËÆæÂ§áÔºàÂç≥ËãπÊûúËÆæÂ§áÔºâ„ÄÇÊØèÂè∞AppleËÆæÂ§á‰ΩøÁî®UDIDÊù•ÂîØ‰∏ÄÊ†áËØÜ„ÄÇ ËÆæÂ§áÁöÑUDIDÂèØÈÄöËøáiTunes-&gt;SummaryÊàñËÄÖXcode-&gt;Window-&gt;DevicesËé∑Âèñ„ÄÇ Ê∑ªÂä†ËÆæÂ§áÊØîËæÉÁÆÄÂçïÔºåÂ∞±ÊòØËæìÂÖ•ËÆæÂ§áÁöÑ UUIDÔºåÂπ∂‰∏îÁªôËÆæÂ§áÂèñ‰∏Ä‰∏™Âà´ÂêçÂç≥ÂèØ„ÄÇ Provisioning ProfilesProvisioning Profile ÂåÖÂê´‰∫Ü‰∏äËø∞ÁöÑÊâÄÊúâÂÜÖÂÆπÔºöËØÅ‰π¶Ôºåapp idÔºåËÆæÂ§á„ÄÇÁî®Êù•Â∞ÜËØÅ‰π¶Âíå app id ÁªëÂÆö„ÄÇ Provisioning Profile ‰πüÂàÜ‰∏∫ Development Âíå Distribution ‰∏§Á±ªÔºåÊúâÊïàÊúüÂêå Certificate ‰∏ÄÊ†∑„ÄÇDevelopment ÁâàÊú¨ÁöÑ ProvisioningProfile Áî®‰∫éÂºÄÂèëË∞ÉËØïÔºåÂåÖÊã¨ debug Âíå release ÁâàÊú¨ÔºåDistribution ÁâàÊú¨ÁöÑ ProvisioningProfile Âè™Áî®‰∫éÊèê‰∫§ App Store ÂÆ°Ê†∏ÔºåÂÖ∂‰∏çÊåáÂÆöÂºÄÂèëÊµãËØïÁöÑ Devices„ÄÇ Âú® XcodeTarget-&gt;Build Settings-&gt;Code Signing-&gt;Provisioning Profile ÂèØÈÄâÊã©‚ÄúAutomatic‚ÄùÔºåxcode ‰ºöÊ†πÊçÆËØ• Target ÁöÑ‚ÄúBundle identifier‚ÄùÈÄâÊã©ÈªòËÆ§ÁöÑÈÖçÁΩÆÊñá‰ª∂ÂèäËØÅ‰π¶Ôºö Ëá™Âä®Á≠æÂêçÁöÑÊÉÖÂÜµ‰∏ãÔºå‰∏çÈúÄË¶ÅËá™Â∑±ËÆæÁΩÆ Provisioning Profiles„ÄÇ‰∏çËøá‰Ω†‰πüÂèØ‰ª•ÈÄâÊã©ÊâãÂä®ËÆæÁΩÆÁ≠æÂêçÔºö debug Âíå release Áî®ÁöÑÈÉΩÊòØÂºÄÂèëÁöÑÈÖçÁΩÆÊñá‰ª∂„ÄÇ Êõ¥Â§öËøôÊñπÈù¢ÁöÑ‰ø°ÊÅØÂèØ‰ª•ÂèÇËÄÉiOS ÂêÑÁßçËØÅ‰π¶/Á≠æÂêçËØ¶Ëß£ÊñáÁ´†ÂÜôÂæóÂæàËØ¶ÁªÜ„ÄÇ iOS app Á≠æÂêçÁõ∏ÂÖ≥ÁõÆÁöÑÂØπ APP ËøõË°åÁ≠æÂêçÁöÑÁõÆÁöÑÂæàÁÆÄÂçïÔºåÂ∞±ÊòØ‰∏∫‰∫ÜÈ™åËØÅÔºå‰Ω†‰∏ãËΩΩÁöÑ app ÊòØÂêàÊ≥ïÁöÑÁªèËøáËãπÊûúÂÆ°Ê†∏ÁöÑ„ÄÇ ÁÆÄÂçïÁöÑÁ≠æÂêçÊñπÂºè‰∏ãÈù¢Âõæ‰∏≠ÊúâËØ¥ÊòéÔºö ËøôÁßçÁÆÄÂçïÁöÑÁ≠æÂêçÊñπÂºèÊòØËãπÊûúËá™Â∑±ÁîüÊàê‰∫ÜÁßÅÈí•ÂíåÂÖ¨Èí•ÔºåÂÖ¨Èí•‰øùÂ≠òÂú®ÊØè‰∏Ä‰∏™Áîü‰∫ßÂá∫Êù•ÁöÑ iOS ËÆæÂ§á‰∏≠„ÄÇÈÄöËøáËãπÊûúÁöÑÁßÅÈí•ÂíåÂÖ¨Èí•Áõ¥Êé•ÂØπ app ËøõË°åÁ≠æÂêçÂíåÈ™åËØÅ„ÄÇ Êñ∞ÁöÑÈóÆÈ¢ò ËøôÁßçÊñπÂºèÈù¢‰∏¥ÁöÑÈóÆÈ¢òÊòØÊâÄÊúâÁöÑ app ÈÉΩË¶ÅÁªèËøáËãπÊûúÁöÑ app store„ÄÇ‰ΩÜÊòØÔºåÊØîÂ¶Ç‰ºÅ‰∏öÂèëÂ∏ÉÂïäÔºåÂºÄÂèëÊó∂ÁöÑÁõ¥Êé•Ë∞ÉËØïÂïäÔºåÈÉΩ‰∏çÁªèËøá app store„ÄÇÊàë‰ª¨Èù¢‰∏¥‰∏§‰∏™ÈúÄÊ±ÇÔºö ÂÆâË£ÖÂåÖ‰∏çÈúÄË¶Å‰º†Âà∞ËãπÊûúÊúçÂä°Âô®ÔºåÂèØ‰ª•Áõ¥Êé•ÂÆâË£ÖÂà∞ÊâãÊú∫‰∏ä„ÄÇÂ¶ÇÊûú‰Ω†ÁºñËØë‰∏Ä‰∏™ APP Âà∞ÊâãÊú∫ÂâçË¶ÅÂÖà‰º†Âà∞ËãπÊûúÊúçÂä°Âô®Á≠æÂêçÔºåËøôÊòæÁÑ∂ÊòØ‰∏çËÉΩÊé•ÂèóÁöÑ„ÄÇÂç≥‰∏çËÉΩÁõ¥Êé•Áî®ËãπÊûúÁöÑÁßÅÈí•ÂØπ app ËøõË°åÁ≠æÂêçÔºåÂõ†‰∏∫ËøôÊ†∑ÂøÖÁÑ∂Ë¶ÅÂ∞Ü app ‰∏ä‰º† ËãπÊûúÂøÖÈ°ªÂØπËøôÈáåÁöÑÂÆâË£ÖÊúâÊéßÂà∂ÊùÉÔºåÂåÖÊã¨ÁªèËøáËãπÊûúÂÖÅËÆ∏ÊâçÂèØ‰ª•ËøôÊ†∑ÂÆâË£ÖÔºå‰∏çËÉΩË¢´Êª•Áî®ÂØºËá¥ÈùûÂºÄÂèëapp‰πüËÉΩË¢´ÂÆâË£Ö„ÄÇÂç≥Ë¶Å‰øùËØÅ app ÁªèËøá‰∫ÜËãπÊûúÁöÑÁßÅÈí•ÂíåÂÖ¨Èí•ÁöÑÁ≠æÂêçÂíåÈ™åËØÅËøáÁ®ã ‰∏§Ê≠•Á≠æÂêçÊòéÁôΩ‰∫ÜÈúÄÊ±ÇÂ∞±ÂÆπÊòìÊâæÂà∞ÊÄùË∑Ø‰∫Ü„ÄÇÊó¢ÁÑ∂‰∏çËÉΩÂ∞ÜappÁöÑÁ≠æÂêçÈ™åËØÅÊîæÂú®‰∫ëÁ´ØÔºàËãπÊûúÔºâÔºåÈÇ£‰πàÂ∞±ÊääÈ™åËØÅÊîæÂú®Êú¨Âú∞„ÄÇ È¶ñÂÖà‰∏çËÉΩÁî®ËãπÊûúÁöÑÁßÅÈí•Á≠æÂêç appÔºåÈÇ£‰πàÂæàÂÆπÊòìÊÉ≥Âà∞ÔºåÊàë‰ª¨ÂèØ‰ª•Ëá™Â∑±ÂàõÂª∫‰∏ÄÂØπÈí•ÂåôÔºåÁî®Êàë‰ª¨Ëá™Â∑±ÁöÑÁßÅÈí•ÂØπ app Á≠æÂêçÔºåÂÖ¨Èí•ÂØπ app È™åËØÅ„ÄÇ ‰∏∫‰∫ÜÊª°Ë∂≥ÈúÄÊ±Ç‰∫åÔºåÊàë‰ª¨Â∞ÜÊàë‰ª¨Ëá™Â∑±ÂàõÂª∫ÁöÑÂÖ¨Èí•‰∏ä‰º†Âà∞ËãπÊûúÁöÑÊúçÂä°Âô®ËÆ©ËãπÊûúÁî®ÂÖ∂Ëá™Â∑±ÁöÑÁßÅÈí•Á≠æÂêçÔºàËøôÂ∞±ÊòØÊâÄË∞ìÁöÑÂºÄÂèëËÄÖËØÅ‰π¶ÔºâÔºåËøôÊ†∑Â∞±ÈÅøÂÖç‰∫Ü‰º† app ËøõË°åÁ≠æÂêçÁöÑÈ∫ªÁÉ¶„ÄÇÂΩìË£ÖÂà∞ÊâãÊú∫‰∏≠ÂêéÔºå‰ºöÂ∞ÜËãπÊûú‰∏ãÂèëÁöÑËØÅ‰π¶‰ª•ÂèäÊàë‰ª¨ÁöÑÁßÅÈí•ÂØπ app ÁöÑÁ≠æÂêçÂØºÊä•Âà∞ËÆæÂ§á‰∏≠ÔºàÊàë‰ª¨ÁöÑÁßÅÈí•Ê≤°ÊúâÊîæÂà∞ËÆæÂ§á‰∏≠ÔºåÂè™ÊòØÂ∞ÜÁßÅÈí•ÂØπapp ÁöÑÁ≠æÂêçÊîæËøõÂéª‰∫ÜÔºâ„ÄÇÈÄöËøáËÆæÂ§á‰∏≠ÁöÑËãπÊûúÂÖ¨Èí•Â∞±ËÉΩËß£ÊûêÂá∫Êàë‰ª¨Ëá™Â∑±ÂàõÂª∫ÁöÑÂÖ¨Èí•‰∫Ü„ÄÇÁÑ∂ÂêéÁî®ÂÖ¨Èí•ÂØπÁßÅÈí•ÂØπappÁöÑÁ≠æÂêçËøõË°åËß£ÂØÜÔºåÈ™åËØÅÂ∫îÁî®ÁöÑÂÆåÊï¥ÊÄß„ÄÇËøô‰∫õÊìç‰ΩúÈÉΩÊòØÂú®Êú¨Âú∞ÂÆåÊàêÁöÑÔºåÊâÄ‰ª•Êú¨Âú∞ÂÆâË£ÖÁöÑÊó∂ÂÄôÂ∞±‰∏çÈúÄË¶ÅËÅîÁΩëËØ∑Ê±Ç‰ªª‰Ωï‰∏úË•øËøõË°åÈ™åËØÅ‰∫Ü„ÄÇ ÂÖ∑‰ΩìÊµÅÁ®ãÂ¶Ç‰∏ãÂõæÔºö Âú®‰Ω†ÁöÑ Mac ÂºÄÂèëÊú∫Âô®ÁîüÊàê‰∏ÄÂØπÂÖ¨ÁßÅÈí•ÔºåËøôÈáåÁß∞‰∏∫ÂÖ¨Èí•LÔºåÁßÅÈí•L„ÄÇL:Local ËãπÊûúËá™Â∑±ÊúâÂõ∫ÂÆöÁöÑ‰∏ÄÂØπÂÖ¨ÁßÅÈí•ÔºåË∑ü‰∏äÈù¢ AppStore ‰æãÂ≠ê‰∏ÄÊ†∑ÔºåÁßÅÈí•Âú®ËãπÊûúÂêéÂè∞ÔºåÂÖ¨Èí•Âú®ÊØè‰∏™ iOS ËÆæÂ§á‰∏ä„ÄÇËøôÈáåÁß∞‰∏∫ÂÖ¨Èí•AÔºåÁßÅÈí•A„ÄÇA:Apple ÊääÂÖ¨Èí• L ‰º†Âà∞ËãπÊûúÂêéÂè∞ÔºåÁî®ËãπÊûúÂêéÂè∞ÈáåÁöÑÁßÅÈí• A ÂéªÁ≠æÂêçÂÖ¨Èí• L„ÄÇÂæóÂà∞‰∏Ä‰ªΩÊï∞ÊçÆÂåÖÂê´‰∫ÜÂÖ¨Èí• L ‰ª•ÂèäÂÖ∂Á≠æÂêçÔºåÊääËøô‰ªΩÊï∞ÊçÆÁß∞‰∏∫ËØÅ‰π¶„ÄÇ Âú®ÂºÄÂèëÊó∂ÔºåÁºñËØëÂÆå‰∏Ä‰∏™ APP ÂêéÔºåÁî®Êú¨Âú∞ÁöÑÁßÅÈí• L ÂØπËøô‰∏™ APP ËøõË°åÁ≠æÂêçÔºåÂêåÊó∂ÊääÁ¨¨‰∏âÊ≠•ÂæóÂà∞ÁöÑËØÅ‰π¶‰∏ÄËµ∑ÊâìÂåÖËøõ APP ÈáåÔºåÂÆâË£ÖÂà∞ÊâãÊú∫‰∏ä„ÄÇ Âú®ÂÆâË£ÖÊó∂ÔºåiOS Á≥ªÁªüÂèñÂæóËØÅ‰π¶ÔºåÈÄöËøáÁ≥ªÁªüÂÜÖÁΩÆÁöÑÂÖ¨Èí• AÔºåÂéªÈ™åËØÅËØÅ‰π¶ÁöÑÊï∞Â≠óÁ≠æÂêçÊòØÂê¶Ê≠£Á°Æ„ÄÇ È™åËØÅËØÅ‰π¶ÂêéÁ°Æ‰øù‰∫ÜÂÖ¨Èí• L ÊòØËãπÊûúËÆ§ËØÅËøáÁöÑÔºåÂÜçÁî®ÂÖ¨Èí• L ÂéªÈ™åËØÅ APP ÁöÑÁ≠æÂêçÔºåËøôÈáåÂ∞±Èó¥Êé•È™åËØÅ‰∫ÜËøô‰∏™ APP ÂÆâË£ÖË°å‰∏∫ÊòØÂê¶ÁªèËøáËãπÊûúÂÆòÊñπÂÖÅËÆ∏„ÄÇ Ê≥®ÊÑèÔºå‰ΩøÁî®ËãπÊûúÁöÑÁßÅÈí•ÂéªÁ≠æÂêçÂºÄÂèëËÄÖÁöÑÂÖ¨Èí•ÔºåÂºÄÂèëËÄÖÁöÑÁßÅÈí•ÂéªÁ≠æÂêç APP„ÄÇ ÊÉ≥Ë¶ÅÁ°Æ‰øù‰ªÄ‰πàÁöÑÂÆåÊï¥ÊÄßÔºåÂ∞±Áî®ÁßÅÈí•ÂéªÁ≠æÂêç‰ªÄ‰πà Êõ¥Â§öÁªÜËäÇ‰∏äÈù¢Â∑≤ÁªèÊòØÂü∫Êú¨ÁöÑÊµÅÁ®ã‰∫Ü„ÄÇ‰∏çËøáËãπÊûúÂÜçÂä†‰∫Ü‰∏§‰∏™ÈôêÂà∂Ôºå‰∏ÄÊòØÈôêÂà∂Âú®ËãπÊûúÂêéÂè∞Ê≥®ÂÜåËøáÁöÑËÆæÂ§áÊâçÂèØ‰ª•ÂÆâË£ÖÔºå‰∫åÊòØÈôêÂà∂Á≠æÂêçÂè™ËÉΩÈíàÂØπÊüê‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑ APP„ÄÇÈô§‰∫Ü ËÆæÂ§á ID / AppIDÔºåËøòÊúâÂÖ∂‰ªñ‰ø°ÊÅØ‰πüÈúÄË¶ÅÂú®ËøôÈáåÁî®ËãπÊûúÁ≠æÂêçÔºåÂÉèËøô‰∏™ APP Èáå iCloud / push / ÂêéÂè∞ËøêË°å Á≠âÊùÉÈôêËãπÊûúÈÉΩÊÉ≥ÊéßÂà∂ÔºåËãπÊûúÊääËøô‰∫õÊùÉÈôêÂºÄÂÖ≥Áªü‰∏ÄÁß∞‰∏∫ EntitlementsÔºåÂÆÉ‰πüÈúÄË¶ÅÈÄöËøáÁ≠æÂêçÂéªÊéàÊùÉ„ÄÇ‰∫éÊòØËãπÊûúÂè¶Â§ñÊêû‰∫Ü‰∏™‰∏úË•øÔºåÂè´ Provisioning ProfileÔºå‰∏Ä‰∏™ Provisioning Profile ÈáåÂ∞±ÂåÖÂê´‰∫ÜËØÅ‰π¶‰ª•Âèä‰∏äËø∞ÊèêÂà∞ÁöÑÊâÄÊúâÈ¢ùÂ§ñ‰ø°ÊÅØÔºå‰ª•ÂèäÊâÄÊúâ‰ø°ÊÅØÁöÑÁ≠æÂêç„ÄÇ ÊµÅÁ®ãÂ∞±ÂèòÊàê‰∫Ü‰∏ãÈù¢ÁöÑÊ†∑Â≠êÔºö Á≠æÂêç‰∏éËØÅ‰π¶ÁöÑÂÖ≥Á≥ªÊàë‰ª¨ÁúãÂà∞Áî®ÁßÅÈí•ÂØπ app Âä†ÂØÜÂè´ÂÅöÁ≠æÂêçÔºåÁî®ÁßÅÈí•ÂØπÂà´‰∫∫ÁöÑÂÖ¨Èí•ËøõË°åÂä†ÂØÜÂè´ÂÅöËØÅ‰π¶„ÄÇ ËãπÊûúÁöÑÈ™åËØÅÊú∫Âà∂Âíå https È™åËØÅÊú∫Âà∂ÁöÑÂºÇÂêåÂÖ∂ÂÆûÂè™Ë¶ÅÊ∂âÂèäÂà∞ËØÅ‰π¶ÁöÑÈÉΩÊòØ‰∏∫‰∫ÜÊãøÂà∞ÂÖ¨Èí•„ÄÇhttps ‰∏≠ÊúçÂä°Âô®ÊãøÂÖ¨Èí•Âêë CA Ë¶ÅÂèñÁ≠æÂêçÔºåËãπÊûúÁöÑÈ™åËØÅ‰∏≠ÂàôÂºÄÂèëËÄÖÊãøÂÖ¨Èí•ÂêëËãπÊûúË¶ÅÂèñÁ≠æÂêç„ÄÇhttps ‰∏≠ÊµèËßàÂô®‰∏≠Êúâ CA Êú∫ÊûÑÁöÑÂÖ¨Èí•ÔºåËãπÊûúÁöÑÈ™åËØÅ‰∏≠ iOS ËÆæÂ§á‰∏≠ÊúâËãπÊûúÁöÑÂÖ¨Èí•„ÄÇ ‰∏çÂêåÁöÑÊòØÔºåhttps ‰∏≠ÔºåÊµèËßàÂô®ÊãøÂà∞ÂÖ¨Èí•ÔºåÊòØ‰∏∫‰∫ÜÂä†ÂØÜÊï∞ÊçÆÔºõËÄå iOS ËÆæÂ§á‰∏≠ÊãøÂà∞ÂÖ¨Èí•ÔºåÊòØ‰∏∫‰∫ÜÈ™åËØÅÁ≠æÂêç„ÄÇ ÊÄªÁªìÊâÄ‰ª•ÂØπ‰∫é‰∏äÈù¢ÁöÑÂêÑ‰∏™Ê¶ÇÂøµÂ∫îËØ•Êúâ‰∫ÜÊõ¥Ê∑±ÁöÑÁêÜËß£Ôºö ËØÅ‰π¶cerÔºöÂÜÖÂÆπÊòØÂÖ¨Èí•ÊàñÁßÅÈí•ÔºåÁî±ÂÖ∂‰ªñÊú∫ÊûÑÂØπÂÖ∂Á≠æÂêçÁªÑÊàêÁöÑÊï∞ÊçÆÂåÖ„ÄÇ EntitlementsÔºöÂåÖÂê´‰∫Ü App ÊùÉÈôêÂºÄÂÖ≥ÂàóË°®„ÄÇ CertificateSigningRequestÔºöÊú¨Âú∞ÂÖ¨Èí•„ÄÇ p12ÔºöÊú¨Âú∞ÁßÅÈí•ÊàñËÄÖËØÅ‰π¶ÊàñËÄÖÁßÅÈí•‰∏éËØÅ‰π¶ÁöÑ‰∫åÁ∫ßÂà∂ÂΩ¢ÂºèÔºåÂèØ‰ª•ÂØºÂÖ•Âà∞ÂÖ∂‰ªñÁîµËÑë„ÄÇ PEMÔºöÊú¨Âú∞ÁßÅÈí•ÊàñËÄÖËØÅ‰π¶ÊàñËÄÖÁßÅÈí•‰∏éËØÅ‰π¶ÁöÑbase64ÂΩ¢ÂºèÔºå‰∏é p12 Á±ª‰ºº„ÄÇ Provisioning ProfileÔºöÂåÖÂê´‰∫Ü ËØÅ‰π¶ / Entitlements Á≠âÊï∞ÊçÆÔºåÂπ∂Áî±ËãπÊûúÂêéÂè∞ÁßÅÈí•Á≠æÂêçÁöÑÊï∞ÊçÆÂåÖ„ÄÇ ‰∏äÈù¢ËØ¥ÁöÑÊòØÂºÄÂèëÊó∂ÊàñËÄÖÊòØ‰ºÅ‰∏öÁöÑÁ≠æÂêçÈ™åËØÅÊµÅÁ®ã„ÄÇAppStore ÁöÑÁ≠æÂêçÈ™åËØÅÊñπÂºèÊúâ‰∫õ‰∏ç‰∏ÄÊ†∑ÔºåÂâçÈù¢Êàë‰ª¨ËØ¥Âà∞ÊúÄÁÆÄÂçïÁöÑÁ≠æÂêçÊñπÂºèÔºåËãπÊûúÂú®ÂêéÂè∞Áõ¥Êé•Áî®ÁßÅÈí•Á≠æÂêç App Â∞±ÂèØ‰ª•‰∫ÜÔºåÂÆûÈôÖ‰∏äËãπÊûúÁ°ÆÂÆûÊòØËøôÊ†∑ÂÅöÁöÑÔºåÂ¶ÇÊûúÂéª‰∏ãËΩΩ‰∏Ä‰∏™ AppStore ÁöÑÂÆâË£ÖÂåÖÔºå‰ºöÂèëÁé∞ÂÆÉÈáåÈù¢ÊòØÊ≤°Êúâ embedded.mobileprovision Êñá‰ª∂ÁöÑÔºå‰πüÂ∞±ÊòØÂÆÉÂÆâË£ÖÂíåÂêØÂä®ÁöÑÊµÅÁ®ãÊòØ‰∏ç‰æùËµñËøô‰∏™Êñá‰ª∂ÔºåÈ™åËØÅÊµÅÁ®ã‰πüÂ∞±Ë∑ü‰∏äËø∞Âá†ÁßçÁ±ªÂûã‰∏ç‰∏ÄÊ†∑‰∫Ü„ÄÇ ÈÇ£‰∏∫‰ªÄ‰πàÂèëÂ∏É AppStore ÁöÑÂåÖËøòÊòØË¶ÅË∑üÂºÄÂèëÁâà‰∏ÄÊ†∑ÊêûÂêÑÁßçËØÅ‰π¶Âíå Provisioning ProfileÔºüÁåúÊµãÂõ†‰∏∫ËãπÊûúÊÉ≥ÂÅöÁªü‰∏ÄÁÆ°ÁêÜÔºåProvisioning Profile ÈáåÂåÖÂê´‰∏Ä‰∫õÊùÉÈôêÊéßÂà∂ÔºåAppID ÁöÑÊ£ÄÈ™åÁ≠âÔºåËãπÊûú‰∏çÊÉ≥Âú®‰∏ä‰º† AppStore ÂåÖÊó∂ÈáçÊñ∞Áî®Âè¶‰∏ÄÁßçÂçèËÆÆÂÅö‰∏ÄÈÅçËøô‰∫õÈ™åËØÅÔºåÂ∞±‰∏çÂ¶ÇÁªü‰∏ÄÊääËøôÈÉ®ÂàÜÊîæÂú® Provisioning Profile ÈáåÔºå‰∏ä‰º† AppStore Êó∂Âè™Ë¶ÅÁî®ÂêåÊ†∑ÁöÑÊµÅÁ®ãÈ™åËØÅËøô‰∏™ Provisioning Profile ÊòØÂê¶ÂêàÊ≥ïÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ ÊâÄ‰ª• App ‰∏ä‰º†Âà∞ AppStore ÂêéÔºåÂ∞±Ë∑ü‰Ω†ÁöÑ ËØÅ‰π¶ / Provisioning Profile ÈÉΩÊ≤°ÊúâÂÖ≥Á≥ª‰∫ÜÔºåÊó†ËÆ∫‰ªñ‰ª¨ÊòØÂê¶ËøáÊúüÊàñË¢´Â∫üÈô§ÔºåÈÉΩ‰∏ç‰ºöÂΩ±Âìç AppStore ‰∏äÁöÑÂÆâË£ÖÂåÖ„ÄÇ Êõ¥Â§öËøôÊñπÈù¢ÁöÑ‰ø°ÊÅØÂèØ‰ª•ÂèÇËÄÉbangÁöÑÊñáÁ´† ÊñáÁ´†ÂÜôÂæóÂæàËØ¶ÁªÜ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Xcode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Swift 3.1 ËØ≠Ê≥ïÂ≠¶‰π†Ôºà‰∏ÉÔºâ]]></title>
    <url>%2F2017%2F02%2F22%2Fswift%E8%AF%AD%E6%B3%957%2F</url>
    <content type="text"><![CDATA[Êé•ÁùÄ‰∏ä‰∏ÄÁØá ËÆøÈóÆÊéßÂà∂Ê®°ÂùóÂíåÊ∫êÊñá‰ª∂Ê®°ÂùóÊåáÁöÑÊòØÁã¨Á´ãÁöÑ‰ª£Á†ÅÂçïÂÖÉÔºåÊ°ÜÊû∂ÊàñÂ∫îÁî®Á®ãÂ∫è‰ºö‰Ωú‰∏∫‰∏Ä‰∏™Áã¨Á´ãÁöÑÊ®°ÂùóÊù•ÊûÑÂª∫ÂíåÂèëÂ∏É„ÄÇÂú® Swift ‰∏≠Ôºå‰∏Ä‰∏™Ê®°ÂùóÂèØ‰ª•‰ΩøÁî® import ÂÖ≥ÈîÆÂ≠óÂØºÂÖ•Âè¶Â§ñ‰∏Ä‰∏™Ê®°Âùó„ÄÇÂú® Swift ‰∏≠ÔºåXcode ÁöÑÊØè‰∏™ targetÔºà‰æãÂ¶ÇÊ°ÜÊû∂ÊàñÂ∫îÁî®Á®ãÂ∫èÔºâÈÉΩË¢´ÂΩì‰ΩúÁã¨Á´ãÁöÑÊ®°ÂùóÂ§ÑÁêÜ„ÄÇ Ê∫êÊñá‰ª∂Â∞±ÊòØ Swift ‰∏≠ÁöÑÊ∫ê‰ª£Á†ÅÊñá‰ª∂ÔºåÂÆÉÈÄöÂ∏∏Â±û‰∫é‰∏Ä‰∏™Ê®°ÂùóÔºåÂç≥‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èÊàñËÄÖÊ°ÜÊû∂„ÄÇ ËÆøÈóÆÁ∫ßÂà´ open:Êèê‰æõÊúÄÈ´òÁöÑÊùÉÈôêÔºåÊ®°ÂùóÂÜÖÂ§ñÈÉΩËÉΩËÆøÈóÆÂíåÈáçÂÜô„ÄÇÂíå public ÁöÑÂå∫Âà´‰∏ãÈù¢ËØ¥ public:ÂèØ‰ª•ËÆøÈóÆÂêå‰∏ÄÊ®°ÂùóÊ∫êÊñá‰ª∂‰∏≠ÁöÑ‰ªª‰ΩïÂÆû‰ΩìÔºåÂú®Ê®°ÂùóÂ§ñ‰πüÂèØ‰ª•ÈÄöËøáÂØºÂÖ•ËØ•Ê®°ÂùóÊù•ËÆøÈóÆÊ∫êÊñá‰ª∂ÈáåÁöÑÊâÄÊúâÂÆû‰ΩìÔºå‰ΩÜÊòØ‰∏çÂÖÅËÆ∏ÈáçÂÜô„ÄÇ internal:ÂèØ‰ª•ËÆøÈóÆÂêå‰∏ÄÊ®°ÂùóÊ∫êÊñá‰ª∂‰∏≠ÁöÑ‰ªª‰ΩïÂÆû‰ΩìÔºå‰ΩÜÊòØ‰∏çËÉΩ‰ªéÊ®°ÂùóÂ§ñËÆøÈóÆËØ•Ê®°ÂùóÊ∫êÊñá‰ª∂‰∏≠ÁöÑÂÆû‰Ωì„ÄÇ fileprivate:ÈôêÂà∂ÂÆû‰ΩìÂè™ËÉΩÂú®ÊâÄÂú®ÁöÑÊ∫êÊñá‰ª∂ÂÜÖÈÉ®‰ΩøÁî®ÔºåÂç≥‰Ωø‰∏çÂú®Âêå‰∏Ä‰∏™‰ΩúÁî®ÂüüÂÜÖ„ÄÇ privateÔºöÊèê‰æõÊúÄ‰ΩéÁöÑÊùÉÈôêÔºåÂè™ÊúâÂú®Âêå‰∏Ä‰∏™‰ΩúÁî®ÂüüÂÜÖÂèØËÆøÈóÆ„ÄÇ open Âíå public Âú®‰ΩúÁî®‰∏äÂæàÂÉè„ÄÇopen ÂàôÊòØ‰∏∫‰∫ÜÂº•Ë°• public ËØ≠‰πâ‰∏äÁöÑ‰∏çË∂≥„ÄÇÈÄöËøá open Âíå public Ê†áËÆ∞Âå∫Âà´‰∏Ä‰∏™ÂÖÉÁ¥†Âú®ÂÖ∂‰ªñ module ‰∏≠ÊòØÂè™ËÉΩË¢´ËÆøÈóÆËøòÊòØÂèØ‰ª•Ë¢´ override„ÄÇÁé∞Âú®ÁöÑ public Âú® module ÂÜÖÂèØ‰ª•Ë¢´ overrideÔºåÂú®Ë¢´ import Âà∞ÂÖ∂‰ªñÂú∞ÊñπÂêéÂÖ∂‰ªñÁî®Êà∑‰ΩøÁî®ÁöÑÊó∂ÂÄô‰∏çËÉΩË¢´ overrideÔºåËÄå open ÂàôÂèØ‰ª•„ÄÇ‰∏ãÈù¢ÁöÑ‰æãÂ≠êÂæàÂ•ΩÁöÑËß£Èáä‰∫ÜÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667/// ModuleA:// Ëøô‰∏™Á±ªÂú®ModuleAÁöÑËåÉÂõ¥Â§ñÊòØ‰∏çËÉΩË¢´ÁªßÊâøÁöÑÔºåÂè™ËÉΩË¢´ËÆøÈóÆpublic class NonSubclassableParentClass &#123; public func foo() &#123;&#125; // ËøôÊòØÈîôËØØÁöÑÂÜôÊ≥ïÔºåÂõ†‰∏∫classÂ∑≤Áªè‰∏çËÉΩË¢´ÁªßÊâøÔºå // ÊâÄ‰ª•‰ªñÁöÑÊñπÊ≥ïÁöÑËÆøÈóÆÊùÉÈôê‰∏çËÉΩÂ§ß‰∫éÁ±ªÁöÑËÆøÈóÆÊùÉÈôê open func bar() &#123;&#125; // finalÁöÑÂê´‰πâ‰øùÊåÅ‰∏çÂèò public final func baz() &#123;&#125;&#125;// Âú®ModuleAÁöÑËåÉÂõ¥Â§ñÂèØ‰ª•Ë¢´ÁªßÊâøopen class SubclassableParentClass &#123; // Ëøô‰∏™Â±ûÊÄßÂú®ModuleAÁöÑËåÉÂõ¥Â§ñ‰∏çËÉΩË¢´override public var size : Int // Ëøô‰∏™ÊñπÊ≥ïÂú®ModuleAÁöÑËåÉÂõ¥Â§ñ‰∏çËÉΩË¢´override public func foo() &#123;&#125; // Ëøô‰∏™ÊñπÊ≥ïÂú®‰ªª‰ΩïÂú∞ÊñπÈÉΩÂèØ‰ª•Ë¢´override open func bar() &#123;&#125; ///finalÁöÑÂê´‰πâ‰øùÊåÅ‰∏çÂèò public final func baz() &#123;&#125;&#125;/// finalÁöÑÂê´‰πâ‰øùÊåÅ‰∏çÂèòpublic final class FinalClass &#123; &#125;/// ModuleB:import ModuleA// Ëøô‰∏™ÂÜôÊ≥ïÊòØÈîôËØØÁöÑÔºåÁºñËØë‰ºöÂ§±Ë¥•// Âõ†‰∏∫NonSubclassableParentClassÁ±ªËÆøÈóÆÊùÉÈôêÊ†áËÆ∞ÁöÑÊòØpublicÔºåÂè™ËÉΩË¢´ËÆøÈóÆ‰∏çËÉΩË¢´ÁªßÊâøclass SubclassA : NonSubclassableParentClass &#123; &#125;// ËøôÊ†∑ÂÜôÊ≥ïÂèØ‰ª•ÈÄöËøáÔºåÂõ†‰∏∫SubclassableParentClassËÆøÈóÆÊùÉÈôê‰∏∫ `open`.class SubclassB : SubclassableParentClass &#123; // ËøôÊ†∑ÂÜô‰πü‰ºöÁºñËØëÂ§±Ë¥• // Âõ†‰∏∫Ëøô‰∏™ÊñπÊ≥ïÂú®SubclassableParentClass ‰∏≠ÁöÑÊùÉÈôê‰∏∫publicÔºå‰∏çÊòØ`open'. override func foo() &#123; &#125; // Ëøô‰∏™ÊñπÊ≥ïÂõ†‰∏∫Âú®SubclassableParentClass‰∏≠Ê†áËÆ∞‰∏∫openÔºåÊâÄ‰ª•ÂèØ‰ª•ËøôÊ†∑ÂÜô // ËøôÈáå‰∏çÈúÄË¶ÅÂÜçÂ£∞Êòé‰∏∫openÔºåÂõ†‰∏∫Ëøô‰∏™Á±ªÊòØinternalÁöÑ override func bar() &#123; &#125;&#125;open class SubclassC : SubclassableParentClass &#123; // ËøôÁßçÂÜôÊ≥ï‰ºöÁºñËØëÂ§±Ë¥•ÔºåÂõ†‰∏∫Ëøô‰∏™Á±ªÂ∑≤ÁªèÊ†áËÆ∞‰∏∫open // Ëøô‰∏™ÊñπÊ≥ïoverrideÊòØ‰∏Ä‰∏™openÁöÑÊñπÊ≥ïÔºåÂàô‰πüÈúÄË¶ÅË°®ÊòéËÆøÈóÆÊùÉÈôê override func bar() &#123; &#125; &#125;open class SubclassD : SubclassableParentClass &#123; // Ê≠£Á°ÆÁöÑÂÜôÊ≥ïÔºåÊñπÊ≥ï‰πüÈúÄË¶ÅÊ†áËÆ∞‰∏∫open open override func bar() &#123; &#125; &#125;open class SubclassE : SubclassableParentClass &#123; // ‰πüÂèØ‰ª•ÊòæÂºèÁöÑÊåáÂá∫Ëøô‰∏™ÊñπÊ≥ï‰∏çËÉΩÂú®Ë¢´override public final override func bar() &#123; &#125; &#125; Âú® Swift3 ‰∏≠ private ‰øÆÈ•∞ÁöÑÂèòÈáè extension ‰∏≠ÊòØ‰∏çËÉΩËÆøÈóÆÁöÑÔºåÂõ†‰∏∫‰∏çÂú®‰∏Ä‰∏™‰ΩúÁî®Âüü‰∏≠„ÄÇ‰ΩÜÊòØ Swift4 ‰∏≠‰øÆÊîπ‰∫ÜËøô‰∏Ä‰∏™ÈôêÂà∂„ÄÇÁé∞Âú®Âú® extension ‰∏≠‰πüÊòØËÉΩÂ§üËÆøÈóÆ private ÁöÑÂ±ûÊÄßÁöÑ„ÄÇ ËÆøÈóÆÁ∫ßÂà´Âü∫Êú¨ÂéüÂàôSwift ‰∏≠ÁöÑËÆøÈóÆÁ∫ßÂà´ÈÅµÂæ™‰∏Ä‰∏™Âü∫Êú¨ÂéüÂàôÔºö‰∏çÂèØ‰ª•Âú®Êüê‰∏™ÂÆû‰Ωì‰∏≠ÂÆö‰πâËÆøÈóÆÁ∫ßÂà´Êõ¥È´òÁöÑÂÆû‰Ωì„ÄÇ ÁúãËµ∑Êù•ÂæàÁÆÄÂçïÁöÑ‰∏Ä‰∏™ÂéüÂàôÔºå‰ΩÜÊòØË¶ÅÂæàÊ≥®ÊÑèÁöÑ„ÄÇ ÈªòËÆ§ËÆøÈóÆÁ∫ßÂà´ÂØπ‰∫éÈùû private ÁöÑÁ±ªÔºå‰Ω†‰∏ç‰∏∫‰ª£Á†Å‰∏≠ÁöÑÂÆû‰ΩìÊòæÂºèÊåáÂÆöËÆøÈóÆÁ∫ßÂà´Êó∂ÔºåÂÆÉ‰ª¨ÈªòËÆ§‰∏∫ internal Á∫ßÂà´„ÄÇÂØπ‰∫é private ÁöÑÁ±ªÔºåÊ≤°ÂøÖË¶ÅÊòæÂºèÊåáÂÆöËÆøÈóÆÁ∫ßÂà´ÔºåÈªòËÆ§‰∏∫ private„ÄÇ ÂÖÉÁªÑÁ±ªÂûãÂÖÉÁªÑÁöÑËÆøÈóÆÁ∫ßÂà´Â∞ÜÁî±ÂÖÉÁªÑ‰∏≠ËÆøÈóÆÁ∫ßÂà´ÊúÄ‰∏•Ê†ºÁöÑÁ±ªÂûãÊù•ÂÜ≥ÂÆö„ÄÇ‰æãÂ¶ÇÔºåÂ¶ÇÊûú‰Ω†ÊûÑÂª∫‰∫Ü‰∏Ä‰∏™ÂåÖÂê´‰∏§Áßç‰∏çÂêåÁ±ªÂûãÁöÑÂÖÉÁªÑÔºåÂÖ∂‰∏≠‰∏Ä‰∏™Á±ªÂûã‰∏∫ internal Á∫ßÂà´ÔºåÂè¶‰∏Ä‰∏™Á±ªÂûã‰∏∫ private Á∫ßÂà´ÔºåÈÇ£‰πàËøô‰∏™ÂÖÉÁªÑÁöÑËÆøÈóÆÁ∫ßÂà´‰∏∫ private„ÄÇ ÂÖÉÁªÑ‰∏çÂêå‰∫éÁ±ª„ÄÅÁªìÊûÑ‰Ωì„ÄÅÊûö‰∏æ„ÄÅÂáΩÊï∞ÈÇ£Ê†∑ÊúâÂçïÁã¨ÁöÑÂÆö‰πâ„ÄÇÂÖÉÁªÑÁöÑËÆøÈóÆÁ∫ßÂà´ÊòØÂú®ÂÆÉË¢´‰ΩøÁî®Êó∂Ëá™Âä®Êé®Êñ≠Âá∫ÁöÑÔºåËÄåÊó†Ê≥ïÊòéÁ°ÆÊåáÂÆö„ÄÇ ÂáΩÊï∞Á±ªÂûãÂáΩÊï∞ÁöÑËÆøÈóÆÁ∫ßÂà´Ê†πÊçÆËÆøÈóÆÁ∫ßÂà´ÊúÄ‰∏•Ê†ºÁöÑÂèÇÊï∞Á±ªÂûãÊàñËøîÂõûÁ±ªÂûãÁöÑËÆøÈóÆÁ∫ßÂà´Êù•ÂÜ≥ÂÆö„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûúËøôÁßçËÆøÈóÆÁ∫ßÂà´‰∏çÁ¨¶ÂêàÂáΩÊï∞ÂÆö‰πâÊâÄÂú®ÁéØÂ¢ÉÁöÑÈªòËÆ§ËÆøÈóÆÁ∫ßÂà´ÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÊòéÁ°ÆÂú∞ÊåáÂÆöËØ•ÂáΩÊï∞ÁöÑËÆøÈóÆÁ∫ßÂà´„ÄÇ ‰∏ãÈù¢ÁöÑ‰æãÂ≠êÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ someFunction ÁöÑÂÖ®Â±ÄÂáΩÊï∞ÔºåÂπ∂‰∏îÊ≤°ÊúâÊòéÁ°ÆÂú∞ÊåáÂÆöÂÖ∂ËÆøÈóÆÁ∫ßÂà´„ÄÇ‰πüËÆ∏‰Ω†‰ºöËÆ§‰∏∫ËØ•ÂáΩÊï∞Â∫îËØ•Êã•ÊúâÈªòËÆ§ÁöÑËÆøÈóÆÁ∫ßÂà´ internalÔºå‰ΩÜ‰∫ãÂÆûÂπ∂ÈùûÂ¶ÇÊ≠§„ÄÇ‰∫ãÂÆû‰∏äÔºåÂ¶ÇÊûúÊåâ‰∏ãÈù¢ËøôÁßçÂÜôÊ≥ïÔºå‰ª£Á†ÅÂ∞ÜÊó†Ê≥ïÈÄöËøáÁºñËØëÔºö 123func someFunction() -&gt; (SomeInternalClass, SomePrivateClass) &#123; // Ê≠§Â§ÑÊòØÂáΩÊï∞ÂÆûÁé∞ÈÉ®ÂàÜ&#125; Ê†πÊçÆÂÖÉÁªÑËÆøÈóÆÁ∫ßÂà´ÁöÑÂéüÂàôÔºåËØ•ÂÖÉÁªÑÁöÑËÆøÈóÆÁ∫ßÂà´ÊòØ privateÔºàÂÖÉÁªÑÁöÑËÆøÈóÆÁ∫ßÂà´‰∏éÂÖÉÁªÑ‰∏≠ËÆøÈóÆÁ∫ßÂà´ÊúÄ‰ΩéÁöÑÁ±ªÂûã‰∏ÄËá¥Ôºâ„ÄÇÂõ†‰∏∫ËØ•ÂáΩÊï∞ËøîÂõûÁ±ªÂûãÁöÑËÆøÈóÆÁ∫ßÂà´ÊòØ privateÔºåÊâÄ‰ª•‰Ω†ÂøÖÈ°ª‰ΩøÁî® private ‰øÆÈ•∞Á¨¶ÔºåÊòéÁ°ÆÊåáÂÆöËØ•ÂáΩÊï∞ÁöÑËÆøÈóÆÁ∫ßÂà´Ôºö 123private func someFunction() -&gt; (SomeInternalClass, SomePrivateClass) &#123; // Ê≠§Â§ÑÊòØÂáΩÊï∞ÂÆûÁé∞ÈÉ®ÂàÜ&#125; Â∞ÜËØ•ÂáΩÊï∞ÊåáÂÆö‰∏∫ public Êàñ internalÔºåÊàñËÄÖ‰ΩøÁî®ÈªòËÆ§ÁöÑËÆøÈóÆÁ∫ßÂà´ internal ÈÉΩÊòØÈîôËØØÁöÑÔºåÂõ†‰∏∫Â¶ÇÊûúÊääËØ•ÂáΩÊï∞ÂΩìÂÅö public Êàñ internal Á∫ßÂà´Êù•‰ΩøÁî®ÁöÑËØùÔºåÂèØËÉΩ‰ºöÊó†Ê≥ïËÆøÈóÆ private Á∫ßÂà´ÁöÑËøîÂõûÂÄº„ÄÇ Êûö‰∏æÁ±ªÂûãÊûö‰∏æÊàêÂëòÁöÑËÆøÈóÆÁ∫ßÂà´ÂíåËØ•Êûö‰∏æÁ±ªÂûãÁõ∏ÂêåÔºå‰Ω†‰∏çËÉΩ‰∏∫Êûö‰∏æÊàêÂëòÂçïÁã¨ÊåáÂÆö‰∏çÂêåÁöÑËÆøÈóÆÁ∫ßÂà´„ÄÇ 123456public enum CompassPoint &#123; case North case South case East case West&#125; ÂéüÂßãÂÄºÂíåÂÖ≥ËÅîÂÄºÊûö‰∏æÂÆö‰πâ‰∏≠ÁöÑ‰ªª‰ΩïÂéüÂßãÂÄºÊàñÂÖ≥ËÅîÂÄºÁöÑÁ±ªÂûãÁöÑËÆøÈóÆÁ∫ßÂà´Ëá≥Â∞ë‰∏çËÉΩ‰Ωé‰∫éÊûö‰∏æÁ±ªÂûãÁöÑËÆøÈóÆÁ∫ßÂà´„ÄÇ‰æãÂ¶ÇÔºå‰Ω†‰∏çËÉΩÂú®‰∏Ä‰∏™ internal ËÆøÈóÆÁ∫ßÂà´ÁöÑÊûö‰∏æ‰∏≠ÂÆö‰πâ private Á∫ßÂà´ÁöÑÂéüÂßãÂÄºÁ±ªÂûã„ÄÇ ÂµåÂ•óÁ±ªÂûãÂ¶ÇÊûúÂú® private Á∫ßÂà´ÁöÑÁ±ªÂûã‰∏≠ÂÆö‰πâÂµåÂ•óÁ±ªÂûãÔºåÈÇ£‰πàËØ•ÂµåÂ•óÁ±ªÂûãÂ∞±Ëá™Âä®Êã•Êúâ private ËÆøÈóÆÁ∫ßÂà´„ÄÇÂ¶ÇÊûúÂú® public ÊàñËÄÖ internal Á∫ßÂà´ÁöÑÁ±ªÂûã‰∏≠ÂÆö‰πâÂµåÂ•óÁ±ªÂûãÔºåÈÇ£‰πàËØ•ÂµåÂ•óÁ±ªÂûãËá™Âä®Êã•Êúâ internal ËÆøÈóÆÁ∫ßÂà´„ÄÇÂ¶ÇÊûúÊÉ≥ËÆ©ÂµåÂ•óÁ±ªÂûãÊã•Êúâ public ËÆøÈóÆÁ∫ßÂà´ÔºåÈÇ£‰πàÈúÄË¶ÅÊòéÁ°ÆÊåáÂÆöËØ•ÂµåÂ•óÁ±ªÂûãÁöÑËÆøÈóÆÁ∫ßÂà´„ÄÇ Â≠êÁ±ªÂ≠êÁ±ªÁöÑËÆøÈóÆÁ∫ßÂà´‰∏çÂæóÈ´ò‰∫éÁà∂Á±ªÁöÑËÆøÈóÆÁ∫ßÂà´„ÄÇ‰æãÂ¶ÇÔºåÁà∂Á±ªÁöÑËÆøÈóÆÁ∫ßÂà´ÊòØ internalÔºåÂ≠êÁ±ªÁöÑËÆøÈóÆÁ∫ßÂà´Â∞±‰∏çËÉΩÊòØ public„ÄÇ Ê≠§Â§ñÔºå‰Ω†ÂèØ‰ª•Âú®Á¨¶ÂêàÂΩìÂâçËÆøÈóÆÁ∫ßÂà´ÁöÑÊù°‰ª∂‰∏ãÈáçÂÜô‰ªªÊÑèÁ±ªÊàêÂëòÔºàÊñπÊ≥ï„ÄÅÂ±ûÊÄß„ÄÅÊûÑÈÄ†Âô®„ÄÅ‰∏ãÊ†áÁ≠âÔºâ„ÄÇÂèØ‰ª•ÈÄöËøáÈáçÂÜô‰∏∫ÁªßÊâøÊù•ÁöÑÁ±ªÊàêÂëòÊèê‰æõÊõ¥È´òÁöÑËÆøÈóÆÁ∫ßÂà´Ôºö 1234567public class A &#123; fileprivate func someMethod() &#123;&#125;&#125;internal class B: A &#123; override internal func someMethod() &#123;&#125;&#125; Ê≥®ÊÑèÊèê‰æõÊõ¥È´òËÆøÈóÆÁ∫ßÂà´ÈúÄË¶ÅÊ≥®ÊÑèÁ¨¶ÂêàÂΩìÂâçËÆøÈóÆÁ∫ßÂà´Ôºå‰∏äÈù¢ someMethod ÊòØ fileprivate ÁöÑÔºåÊâÄ‰ª•ÂèØ‰ª•ÈáçÂÜôÔºå‰ΩÜÊòØ‰∏ãÈù¢Â∞±ÊòØÈîôÁöÑÔºö 12345678public class A &#123; //‰∏çËÉΩËøô‰πàÂÜô private func someMethod() &#123;&#125;&#125;internal class B: A &#123; override internal func someMethod() &#123;&#125;&#125; Â∏∏Èáè„ÄÅÂèòÈáè„ÄÅÂ±ûÊÄß„ÄÅ‰∏ãÊ†áÂ∏∏Èáè„ÄÅÂèòÈáè„ÄÅÂ±ûÊÄß‰∏çËÉΩÊã•ÊúâÊØîÂÆÉ‰ª¨ÁöÑÁ±ªÂûãÊõ¥È´òÁöÑËÆøÈóÆÁ∫ßÂà´„ÄÇ‰æãÂ¶ÇÔºå‰Ω†‰∏çËÉΩÂÆö‰πâ‰∏Ä‰∏™ public Á∫ßÂà´ÁöÑÂ±ûÊÄßÔºå‰ΩÜÊòØÂÆÉÁöÑÁ±ªÂûãÂç¥ÊòØ private Á∫ßÂà´ÁöÑ„ÄÇÂêåÊ†∑Ôºå‰∏ãÊ†á‰πü‰∏çËÉΩÊã•ÊúâÊØîÁ¥¢ÂºïÁ±ªÂûãÊàñËøîÂõûÁ±ªÂûãÊõ¥È´òÁöÑËÆøÈóÆÁ∫ßÂà´„ÄÇ Â¶ÇÊûúÂ∏∏Èáè„ÄÅÂèòÈáè„ÄÅÂ±ûÊÄß„ÄÅ‰∏ãÊ†áÁöÑÁ±ªÂûãÊòØ private Á∫ßÂà´ÁöÑÔºåÈÇ£‰πàÂÆÉ‰ª¨ÂøÖÈ°ªÊòéÁ°ÆÊåáÂÆöËÆøÈóÆÁ∫ßÂà´‰∏∫ privateÔºö 1private var privateInstance = SomePrivateClass() ÂçèËÆÆÂ¶ÇÊûúÊÉ≥‰∏∫‰∏Ä‰∏™ÂçèËÆÆÁ±ªÂûãÊòéÁ°ÆÂú∞ÊåáÂÆöËÆøÈóÆÁ∫ßÂà´ÔºåÂú®ÂÆö‰πâÂçèËÆÆÊó∂ÊåáÂÆöÂç≥ÂèØ„ÄÇËøôÂ∞ÜÈôêÂà∂ËØ•ÂçèËÆÆÂè™ËÉΩÂú®ÈÄÇÂΩìÁöÑËÆøÈóÆÁ∫ßÂà´ËåÉÂõ¥ÂÜÖË¢´ÈááÁ∫≥„ÄÇ ÂçèËÆÆ‰∏≠ÁöÑÊØè‰∏Ä‰∏™Ë¶ÅÊ±ÇÈÉΩÂÖ∑ÊúâÂíåËØ•ÂçèËÆÆÁõ∏ÂêåÁöÑËÆøÈóÆÁ∫ßÂà´„ÄÇ‰Ω†‰∏çËÉΩÂ∞ÜÂçèËÆÆ‰∏≠ÁöÑË¶ÅÊ±ÇËÆæÁΩÆ‰∏∫ÂÖ∂‰ªñËÆøÈóÆÁ∫ßÂà´„ÄÇËøôÊ†∑ÊâçËÉΩÁ°Æ‰øùËØ•ÂçèËÆÆÁöÑÊâÄÊúâË¶ÅÊ±ÇÂØπ‰∫é‰ªªÊÑèÈááÁ∫≥ËÄÖÈÉΩÂ∞ÜÂèØÁî®„ÄÇ Â¶ÇÊûú‰Ω†ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ public ËÆøÈóÆÁ∫ßÂà´ÁöÑÂçèËÆÆÔºåÈÇ£‰πàËØ•ÂçèËÆÆÁöÑÊâÄÊúâÂÆûÁé∞‰πü‰ºöÊòØ public ËÆøÈóÆÁ∫ßÂà´„ÄÇËøô‰∏ÄÁÇπ‰∏çÂêå‰∫éÂÖ∂‰ªñÁ±ªÂûãÔºå‰æãÂ¶ÇÔºåÂΩìÁ±ªÂûãÊòØ public ËÆøÈóÆÁ∫ßÂà´Êó∂ÔºåÂÖ∂ÊàêÂëòÁöÑËÆøÈóÆÁ∫ßÂà´Âç¥Âè™ÊòØ internal„ÄÇ ÂçèËÆÆÁªßÊâøÂ¶ÇÊûúÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÁªßÊâøËá™ÂÖ∂‰ªñÂçèËÆÆÁöÑÊñ∞ÂçèËÆÆÔºåÈÇ£‰πàÊñ∞ÂçèËÆÆÊã•ÊúâÁöÑËÆøÈóÆÁ∫ßÂà´ÊúÄÈ´ò‰πüÂè™ËÉΩÂíåË¢´ÁªßÊâøÂçèËÆÆÁöÑËÆøÈóÆÁ∫ßÂà´Áõ∏Âêå„ÄÇ‰æãÂ¶ÇÔºå‰Ω†‰∏çËÉΩÂ∞ÜÁªßÊâøËá™ internal ÂçèËÆÆÁöÑÊñ∞ÂçèËÆÆÂÆö‰πâ‰∏∫ publicÂçèËÆÆ„ÄÇ ÂçèËÆÆ‰∏ÄËá¥ÊÄß‰∏Ä‰∏™Á±ªÂûãÂèØ‰ª•ÈááÁ∫≥ÊØîËá™Ë∫´ËÆøÈóÆÁ∫ßÂà´‰ΩéÁöÑÂçèËÆÆ„ÄÇ‰æãÂ¶ÇÔºå‰Ω†ÂèØ‰ª•ÂÆö‰πâ‰∏Ä‰∏™ public Á∫ßÂà´ÁöÑÁ±ªÂûãÔºåÂÆÉÂèØ‰ª•Âú®ÂÖ∂‰ªñÊ®°Âùó‰∏≠‰ΩøÁî®ÔºåÂêåÊó∂ÂÆÉ‰πüÂèØ‰ª•ÈááÁ∫≥‰∏Ä‰∏™ internal Á∫ßÂà´ÁöÑÂçèËÆÆÔºå‰ΩÜÊòØÂè™ËÉΩÂú®ËØ•ÂçèËÆÆÊâÄÂú®ÁöÑÊ®°Âùó‰∏≠‰Ωú‰∏∫Á¨¶ÂêàËØ•ÂçèËÆÆÁöÑÁ±ªÂûã‰ΩøÁî®„ÄÇ ÈááÁ∫≥‰∫ÜÂçèËÆÆÁöÑÁ±ªÂûãÁöÑËÆøÈóÆÁ∫ßÂà´ÂèñÂÆÉÊú¨Ë∫´ÂíåÊâÄÈááÁ∫≥ÂçèËÆÆ‰∏§ËÄÖÈó¥ÊúÄ‰ΩéÁöÑËÆøÈóÆÁ∫ßÂà´„ÄÇ‰πüÂ∞±ÊòØËØ¥Â¶ÇÊûú‰∏Ä‰∏™Á±ªÂûãÊòØ public Á∫ßÂà´ÔºåÈááÁ∫≥ÁöÑÂçèËÆÆÊòØ internal Á∫ßÂà´ÔºåÈÇ£‰πàÈááÁ∫≥‰∫ÜËøô‰∏™ÂçèËÆÆÂêéÔºåËØ•Á±ªÂûã‰Ωú‰∏∫Á¨¶ÂêàÂçèËÆÆÁöÑÁ±ªÂûãÊó∂ÔºåÂÖ∂ËÆøÈóÆÁ∫ßÂà´‰πüÊòØ internal„ÄÇ Â¶ÇÊûú‰Ω†ÈááÁ∫≥‰∫ÜÂçèËÆÆÔºåÈÇ£‰πàÂÆûÁé∞‰∫ÜÂçèËÆÆÁöÑÊâÄÊúâË¶ÅÊ±ÇÂêéÔºå‰Ω†ÂøÖÈ°ªÁ°Æ‰øùËøô‰∫õÂÆûÁé∞ÁöÑËÆøÈóÆÁ∫ßÂà´‰∏çËÉΩ‰Ωé‰∫éÂçèËÆÆÁöÑËÆøÈóÆÁ∫ßÂà´„ÄÇ‰æãÂ¶ÇÔºå‰∏Ä‰∏™ public Á∫ßÂà´ÁöÑÁ±ªÂûãÔºåÈááÁ∫≥‰∫Ü internal Á∫ßÂà´ÁöÑÂçèËÆÆÔºåÈÇ£‰πàÂçèËÆÆÁöÑÂÆûÁé∞Ëá≥Â∞ë‰πüÂæóÊòØ internal Á∫ßÂà´ Ë°•ÂÖÖÊñ≠Ë®Ä‰∏éÂÖàÂÜ≥Êù°‰ª∂Êñ≠Ë®ÄÂíåÂÖàÂÜ≥Êù°‰ª∂Áî®Êù•Ê£ÄÊü•Êüê‰∫õÊù°‰ª∂ÊòØÂê¶Êª°Ë∂≥„ÄÇÊñ≠Ë®ÄÂíåÂÖàÂÜ≥Êù°‰ª∂‰∏çÂêå‰πãÂ§ÑÂú®‰∫é‰ªÄ‰πàÊó∂ÂÄôÂÅöÊ£ÄÊü•ÔºöÊñ≠Ë®ÄÂè™Âú® debug Êó∂ÂÄôÊ£ÄÊü•ÔºåÂÖàÂÜ≥Êù°‰ª∂ÂàôÂú® debug ÂíåÁîü‰∫ßÊûÑÂª∫‰∏≠ÈÉΩÁîüÊïà„ÄÇÁîü‰∫ßÊûÑÂª∫‰∏≠ÔºåÊñ≠Ë®ÄÁöÑÊù°‰ª∂‰∏ç‰ºöË¢´ËÆ°ÁÆóÔºåÂõ†Ê≠§Êó†ÈúÄÊãÖÂøÉÊñ∞ËÉΩ„ÄÇ Êñ≠Ë®ÄÁöÑ‰ΩøÁî®ÊñπÂºè‰ΩøÁî® assert(_:_:) Êù•ËøõË°åÊñ≠Ë®ÄÔºö 12let age = -3assert(age &gt;= 0, "A person's age cannot be less than zero") Â¶ÇÊûú‰∏çÈúÄË¶ÅÊ£ÄÊü•Êù°‰ª∂Áõ¥Êé•ÊäõÂá∫ÂºÇÂ∏∏ÔºåÈÇ£‰πàÂèØ‰ª•‰ΩøÁî® assertionFailure(_:) 1234567if age &gt; 10 &#123; print("You can ride the roller-coaster or the ferris wheel.")&#125; else if age &gt; 0 &#123; print("You can ride the ferris wheel.")&#125; else &#123; assertionFailure("A person's age can't be less than zero.")&#125; Âº∫Âà∂ÂÖàÂÜ≥Êù°‰ª∂‰ΩøÁî®‰∏äÂíåÊñ≠Ë®ÄÁ±ª‰ººÔºå‰ΩøÁî® precondition(_:_:) ‰πüÊúâ preconditionFailure(_:) Êù•Âº∫Âà∂ÊäõÂá∫Ôºö 1precondition(index &gt; 0, "Index must be greater than zero.") Ê≥õÂûã‰∏≠ÁöÑ WhereÊ≥õÂûã‰∏≠ÁöÑ Where ‰∏ªË¶ÅÁî®Êù•Á∫¶ÊùüÊ≥õÂûãÊàñËÄÖÂçèËÆÆ‰∏≠ÁöÑÂÖ≥ËÅîÁ±ªÂûã„ÄÇÂú®Á±ªÂûã„ÄÅÂáΩÊï∞„ÄÅÊãìÂ±ï„ÄÅÂçèËÆÆ‰∏≠ÈÉΩÂèØ‰ª•‰ΩøÁî®„ÄÇ Á±ªÂûãÂíåÂáΩÊï∞‰∏≠Á±ªÂûãÊàñÂáΩÊï∞‰∏≠Êú¨Êù•ÊòØÂèØ‰ª•Áõ¥Êé•ÂÆö‰πâÊ≥õÂûãÁöÑÔºåÂèØ‰ª•Áõ¥Êé•ÂØπÊ≥õÂûãÂÅöÁ∫¶ÊùüÔºö 12345678910111213protocol a &#123; associatedtype itemType&#125;protocol b &#123; associatedtype itemType&#125;class s &#123;&#125;class S&lt;T: a, K: b&gt; : s &#123;&#125; ‰ΩÜÊòØËøôÊ†∑ÔºåÊàë‰ª¨Êó†Ê≥ïÁ∫¶ÊùüÂçèËÆÆ a Âíå b ‰∏≠ÁöÑÂÖ≥ËÅîÁ±ªÂûã„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Áî® where ÂàÜÂè•Ôºö 123456class S&lt;T: a, K: b&gt; : s where T.itemType == K.itemitemType &#123;&#125;ÊàñËÄÖclass S&lt;T,K&gt; : s where T: a, K: b, T.itemType == K.itemType &#123;&#125; Ê≥õÂûãÂÆûÁé∞ÁöÑÂçèËÆÆ‰ª•ÂèäÂçèËÆÆ‰∏≠ÁöÑÂÖ≥ËÅîÁ±ªÂûãÈÉΩÂèØ‰ª•Áî® where ÈôêÂà∂„ÄÇ ÂáΩÊï∞‰∏≠‰ΩøÁî® where ‰πüÁ±ª‰ººÔºåÂ∞Ü where ÊîæÂú®ÂáΩÊï∞Á≠æÂêç‰πãÂêéÔºö 12func method&lt;T&gt;(param: T) where T: s &#123;&#125; extension ‰∏≠Áî±‰∫é extension ‰∏≠‰∏çËÉΩÂÆö‰πâÊ≥õÂûãÔºåÂè™ËÉΩ‰ΩøÁî®Ê≥õÂûãÔºåÊâÄ‰ª•‰∏çËÉΩÁõ¥Êé•Âú® &lt;&gt; ‰∏≠Áõ¥Êé•Á∫¶ÊùüÊ≥õÂûã‰∫ÜÔºå‰ΩÜÊòØ‰ªçÁÑ∂ÂèØ‰ª•‰ΩøÁî® WhereÔºö 12345678extension Stack where Element: Equatable &#123; func isTop(_ item: Element) -&gt; Bool &#123; guard let topItem = items.last else &#123; return false &#125; return topItem == item &#125;&#125; ÂçèËÆÆ‰∏≠ÂçèËÆÆ‰∏≠‰∏çÈÄÇÁî® &lt;&gt; ÂÆö‰πâÊ≥õÂûãÔºåËÄåÊòØ‰ΩøÁî®ÂÖ≥ËÅîÁ±ªÂûã„ÄÇÂ¶ÇÊûúË¶ÅÁ∫¶ÊùüÂÖ≥ËÅîÁ±ªÂûãÔºåÈÇ£‰πà‰πüÂèØ‰ª•‰ΩøÁî® whereÔºö 1234567891011protocol pro &#123;&#125;protocol Container where Item: pro &#123; associatedtype Item mutating func append(_ item: Item) var count: Int &#123; get &#125; subscript(i: Int) -&gt; Item &#123; get &#125; associatedtype Iterator: IteratorProtocol where Iterator.Element == Item func makeIterator() -&gt; Iterator&#125; Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ôºöwhere ÈÉΩÊòØÂ∞ÜÊ≥õÂûãÊàñËÄÖÂÖ≥ËÅîÁ±ªÂûãÁ∫¶Êùü‰∏∫ÂÆûÁé∞Êüê‰∏™ÂçèËÆÆËÄå‰∏çÊòØÁªßÊâøÊüê‰∏™Á±ªÔºåÂéüÂõ†ÂæàÊòéÊòæÔºåÂõ†‰∏∫ÊòéÁ°Æ‰∫ÜÊüê‰∏™Á±ª‰∫ÜÂ∞±‰∏çÈúÄË¶ÅÊ≥õÂûã‰ª•ÂèäÂÖ≥ËÅîÁ±ªÂûã‰∫Ü„ÄÇ Êù°‰ª∂Âà§Êñ≠ÁöÑ wherewhere ËøòÂèØ‰ª•Áî®Âú®Êù°‰ª∂Âà§Êñ≠‰∏äÔºåÊØîÂ¶Ç‰πãÂâçÂú®Â≠¶‰π† Swith ÁöÑ‰ΩøÁî®Áî®Âà∞ÁöÑÔºåwhere Êé•Âèó‰∏Ä‰∏™ËøîÂõû Bool Á±ªÂûãÁöÑÂàÜÂè•ÔºåÁî®Êù•ÂÅöÊù°‰ª∂Âà§Êñ≠Ôºö 1case let(x, y) where x == y: Âú® for‚Ä¶in Âæ™ÁéØ‰∏≠ÔºåÂêåÊ†∑ÂèØ‰ª•‰ΩøÁî® whereÔºö 1234for element in 1...5 where element &gt;3 &#123; print(element)&#125;// 4,5 Áõ∏ÂΩì‰∫éÔºö 12345for element in 1...5 &#123; if element &gt; 3 &#123; print element &#125;&#125;]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Swift 3.1 ËØ≠Ê≥ïÂ≠¶‰π†ÔºàÂÖ≠Ôºâ]]></title>
    <url>%2F2017%2F02%2F22%2Fswift%E8%AF%AD%E6%B3%956%2F</url>
    <content type="text"><![CDATA[Êé•ÁùÄ‰∏ä‰∏ÄÁØá ÊãìÂ±ïÊâ©Â±ï Â∞±ÊòØ‰∏∫‰∏Ä‰∏™Â∑≤ÊúâÁöÑÁ±ª„ÄÅÁªìÊûÑ‰Ωì„ÄÅÊûö‰∏æÁ±ªÂûãÊàñËÄÖÂçèËÆÆÁ±ªÂûãÊ∑ªÂä†Êñ∞ÂäüËÉΩ„ÄÇËøôÂåÖÊã¨Âú®Ê≤°ÊúâÊùÉÈôêËé∑ÂèñÂéüÂßãÊ∫ê‰ª£Á†ÅÁöÑÊÉÖÂÜµ‰∏ãÊâ©Â±ïÁ±ªÂûãÁöÑËÉΩÂäõ„ÄÇ Á±ª‰ºº‰∫é oc ÁöÑ category Swift ‰∏≠ÁöÑÊâ©Â±ïÂèØ‰ª•Ôºö Ê∑ªÂä†ËÆ°ÁÆóÂûãÂ±ûÊÄßÂíåËÆ°ÁÆóÂûãÁ±ªÂûãÂ±ûÊÄß ÂÆö‰πâÂÆû‰æãÊñπÊ≥ïÂíåÁ±ªÂûãÊñπÊ≥ï Êèê‰æõÊñ∞ÁöÑÊûÑÈÄ†Âô®(ÂÖ∑‰ΩìÁúã‰∏ãÈù¢) ÂÆö‰πâ‰∏ãÊ†á ÂÆö‰πâÂíå‰ΩøÁî®Êñ∞ÁöÑÂµåÂ•óÁ±ªÂûã ‰Ωø‰∏Ä‰∏™Â∑≤ÊúâÁ±ªÂûãÁ¨¶ÂêàÊüê‰∏™ÂçèËÆÆ ÊãìÂ±ïÂèØ‰ª•‰∏∫‰∏Ä‰∏™Á±ªÂûãÊ∑ªÂä†Êñ∞ÁöÑÂäüËÉΩÔºå‰ΩÜÊòØ‰∏çËÉΩÈáçÂÜôÂ∑≤ÊúâÂäüËÉΩÔºå‰πü‰∏çÂèØ‰ª•Ê∑ªÂä†Â≠òÂÇ®ÂûãÁöÑÂ±ûÊÄß„ÄÅÁ±ªÂ±ûÊÄßÔºåËøôÂíå oc ‰∏ÄËá¥ ÊãìÂ±ïËØ≠Ê≥ï‰ΩøÁî®ÂÖ≥ÈîÆÂ≠ó extension Êù•Â£∞ÊòéÊâ©Â±ïÔºö 123extension SomeType &#123; // ‰∏∫ SomeType Ê∑ªÂä†ÁöÑÊñ∞ÂäüËÉΩÂÜôÂà∞ËøôÈáå&#125; ÂèØ‰ª•ÈÄöËøáÊâ©Â±ïÊù•Êâ©Â±ï‰∏Ä‰∏™Â∑≤ÊúâÁ±ªÂûãÔºå‰ΩøÂÖ∂ÈááÁ∫≥‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂçèËÆÆ„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊó†ËÆ∫ÊòØÁ±ªËøòÊòØÁªìÊûÑ‰ΩìÔºåÂçèËÆÆÂêçÂ≠óÁöÑ‰π¶ÂÜôÊñπÂºèÂÆåÂÖ®‰∏ÄÊ†∑Ôºö 123extension SomeType: SomeProtocol, AnotherProctocol &#123; // ÂçèËÆÆÂÆûÁé∞ÂÜôÂà∞ËøôÈáå&#125; Â¶ÇÊûú‰Ω†ÈÄöËøáÊâ©Â±ï‰∏∫‰∏Ä‰∏™Â∑≤ÊúâÁ±ªÂûãÊ∑ªÂä†Êñ∞ÂäüËÉΩÔºåÈÇ£‰πàÊñ∞ÂäüËÉΩÂØπËØ•Á±ªÂûãÁöÑÊâÄÊúâÂ∑≤ÊúâÂÆû‰æãÈÉΩÊòØÂèØÁî®ÁöÑÔºåÂç≥‰ΩøÂÆÉ‰ª¨ÊòØÂú®Ëøô‰∏™Êâ©Â±ïÂÆö‰πâ‰πãÂâçÂàõÂª∫ÁöÑ„ÄÇ swift4 ‰∏≠Êñ∞ÁâπÊÄßÔºåextension ‰∏≠‰πüÂèØ‰ª•ËÆøÈóÆÂéüÊú¨ private ÁöÑÂ±ûÊÄß„ÄÇÂú® Swift3 ‰∏≠Â∞±ÈúÄË¶Å‰ΩøÁî® fileprivate„ÄÇ 12345678910111213struct Date &#123; private let secondsSinceReferenceDate: Double&#125;extension Date: Equatable &#123; static func ==(lhs: Date, rhs: Date) -&gt; Bool &#123; return lhs.secondsSinceReferenceDate == rhs.secondsSinceReferenceDate &#125;&#125;extension Date: Comparable &#123; static func &lt;(lhs: Date, rhs: Date) -&gt; Bool &#123; return lhs.secondsSinceReferenceDate &lt; rhs.secondsSinceReferenceDate &#125;&#125; ËøôÈáåÂ∞±ÂèØ‰ª•ËÆøÈóÆ secondsSinceReferenceDate Â±ûÊÄß„ÄÇ Âú® Swift 4 ‰∏≠Ôºåprivate ÁöÑÂ±ûÊÄßÁöÑ‰ΩúÁî®ÂüüÊâ©Â§ßÂà∞‰∫Ü extension ‰∏≠ÔºåÂπ∂‰∏îË¢´ÈôêÂÆöÂú®‰∫Ü struct Âíå extension ÂÜÖÈÉ®ÔºåËøôÊ†∑Â∞±‰∏çÈúÄË¶ÅÂÜçÊîπÊàê fileprivate ‰∫ÜÔºåËøôÊòØÊúÄÂ•ΩÁöÑÁªìÊûú„ÄÇ ËÆ°ÁÆóÂûãÂ±ûÊÄßÊâ©Â±ïÂèØ‰ª•‰∏∫Â∑≤ÊúâÁ±ªÂûãÊ∑ªÂä†ËÆ°ÁÆóÂûãÂÆû‰æãÂ±ûÊÄßÂíåËÆ°ÁÆóÂûãÁ±ªÂûãÂ±ûÊÄß„ÄÇ 12345678910111213extension Double &#123; var km: Double &#123; return self * 1_000.0 &#125; var m : Double &#123; return self &#125; var cm: Double &#123; return self / 100.0 &#125; var mm: Double &#123; return self / 1_000.0 &#125; var ft: Double &#123; return self / 3.28084 &#125;&#125;let oneInch = 25.4.mmprint("One inch is \(oneInch) meters")// ÊâìÂç∞ ‚ÄúOne inch is 0.0254 meters‚Äùlet threeFeet = 3.ftprint("Three feet is \(threeFeet) meters")// ÊâìÂç∞ ‚ÄúThree feet is 0.914399970739201 meters‚Äù Áî±‰∫éÊãìÂ±ïÈáå‰∏ç‰ºöÊúâÈùûÂèØÈÄâÂ±ûÊÄßÔºåÊâÄ‰ª•ÔºåËøôÈáåÂèØ‰ª•Áõ¥Êé•Ëé∑Âèñ self Êâ©Â±ïÂèØ‰ª•Ê∑ªÂä†Êñ∞ÁöÑËÆ°ÁÆóÂûãÂ±ûÊÄßÔºå‰ΩÜÊòØ‰∏çÂèØ‰ª•Ê∑ªÂä†Â≠òÂÇ®ÂûãÂ±ûÊÄßÔºå‰πü‰∏çÂèØ‰ª•‰∏∫Â∑≤ÊúâÂ±ûÊÄßÊ∑ªÂä†Â±ûÊÄßËßÇÂØüÂô®„ÄÇ Ê∑ªÂä†ËÆ°ÁÆóÂûãÂ±ûÊÄßÂ∞±Áõ∏ÂΩì‰∫éÊòØÊ∑ªÂä†ÊñπÊ≥ï ÊûÑÈÄ†Âô®Êâ©Â±ïËÉΩ‰∏∫Á±ªÊ∑ªÂä†Êñ∞ÁöÑ‰æøÂà©ÊûÑÈÄ†Âô®Ôºå‰ΩÜÊòØÂÆÉ‰ª¨‰∏çËÉΩ‰∏∫Á±ªÊ∑ªÂä†Êñ∞ÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ÊàñÊûêÊûÑÂô®„ÄÇÊåáÂÆöÊûÑÈÄ†Âô®ÂíåÊûêÊûÑÂô®ÂøÖÈ°ªÊÄªÊòØÁî±ÂéüÂßãÁöÑÁ±ªÂÆûÁé∞Êù•Êèê‰æõ„ÄÇ Â§ç‰π†‰∏Ä‰∏ãÔºå‰æøÂà©ÊûÑÈÄ†Âô®ÂíåÊåáÂÆöÊûÑÈÄ†Âô®ÊòØÁ±ª‰∏≠ÁöÑ‰∏§Áßç‰∏çÂêåÁ±ªÂûãÊûÑÈÄ†Âô®Ôºå‰∏çÊòØÁªìÊûÑ‰Ωì‰∏≠ÁöÑ„ÄÇÂõ†Ê≠§Ôºå‰∏äÈù¢ÁöÑËØù‰∏çÈÄÇÁî®‰∫éÁªìÊûÑ‰ΩìÔºåÁªìÊûÑ‰Ωì‰∏≠ËøòÊòØÂèØ‰ª•Áî®ÊãìÂ±ïÊ∑ªÂä†ÊûÑÈÄ†Âô®ÁöÑ„ÄÇ 1234567891011121314151617181920212223242526struct Size &#123; var width = 0.0, height = 0.0&#125;struct Point &#123; var x = 0.0, y = 0.0&#125;struct Rect &#123; var origin = Point() var size = Size()&#125;let defaultRect = Rect()let memberwiseRect = Rect(origin: Point(x: 2.0, y: 2.0), size: Size(width: 5.0, height: 5.0)) extension Rect &#123; init(center: Point, size: Size) &#123; let originX = center.x - (size.width / 2) let originY = center.y - (size.height / 2) self.init(origin: Point(x: originX, y: originY), size: size) &#125;&#125;let centerRect = Rect(center: Point(x: 4.0, y: 4.0), size: Size(width: 3.0, height: 3.0))// centerRect ÁöÑÂéüÁÇπÊòØ (2.5, 2.5)ÔºåÂ§ßÂ∞èÊòØ (3.0, 3.0) ÊñπÊ≥ïÊâ©Â±ïÂèØ‰ª•‰∏∫Â∑≤ÊúâÁ±ªÂûãÊ∑ªÂä†Êñ∞ÁöÑÂÆû‰æãÊñπÊ≥ïÂíåÁ±ªÂûãÊñπÊ≥ï„ÄÇ‰∏ãÈù¢ÁöÑ‰æãÂ≠ê‰∏∫ Int Á±ªÂûãÊ∑ªÂä†‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ repetitions ÁöÑÂÆû‰æãÊñπÊ≥ïÔºö 1234567891011121314extension Int &#123; func repetitions(task: () -&gt; Void) &#123; for _ in 0..&lt;self &#123; task() &#125; &#125;&#125;3.repetitions(task: &#123; print("Hello!")&#125;)// Hello!// Hello!// Hello! ‚Äã ÂèØÂèòÂÆû‰æãÊñπÊ≥ïÈÄöËøáÊâ©Â±ïÊ∑ªÂä†ÁöÑÂÆû‰æãÊñπÊ≥ï‰πüÂèØ‰ª•‰øÆÊîπËØ•ÂÆû‰æãÊú¨Ë∫´„ÄÇÁªìÊûÑ‰ΩìÂíåÊûö‰∏æÁ±ªÂûã‰∏≠‰øÆÊîπ selfÊàñÂÖ∂Â±ûÊÄßÁöÑÊñπÊ≥ïÂøÖÈ°ªÂ∞ÜËØ•ÂÆû‰æãÊñπÊ≥ïÊ†áÊ≥®‰∏∫ mutatingÔºåÊ≠£Â¶ÇÊù•Ëá™ÂéüÂßãÂÆûÁé∞ÁöÑÂèØÂèòÊñπÊ≥ï‰∏ÄÊ†∑„ÄÇ 12345678extension Int &#123; mutating func square() &#123; self = self * self &#125;&#125;var someInt = 3someInt.square()// someInt ÁöÑÂÄºÁé∞Âú®ÊòØ 9 ÊâÄ‰ª•ËØ¥Âòõ Int ÊòØÁªìÊûÑ‰Ωì ‰∏ãÊ†áÊâ©Â±ïÂèØ‰ª•‰∏∫Â∑≤ÊúâÁ±ªÂûãÊ∑ªÂä†Êñ∞‰∏ãÊ†á„ÄÇËøô‰∏™‰æãÂ≠ê‰∏∫ Swift ÂÜÖÂª∫Á±ªÂûã Int Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™Êï¥Âûã‰∏ãÊ†á„ÄÇËØ•‰∏ãÊ†á [n] ËøîÂõûÂçÅËøõÂà∂Êï∞Â≠ó‰ªéÂè≥ÂêëÂ∑¶Êï∞ÁöÑÁ¨¨ n ‰∏™Êï∞Â≠óÔºö 123456789[0] ËøîÂõû 9 123456789[1] ËøîÂõû 8 1234567891011121314151617extension Int &#123; subscript(digitIndex: Int) -&gt; Int &#123; var decimalBase = 1 for _ in 0..&lt;digitIndex &#123; decimalBase *= 10 &#125; return (self / decimalBase) % 10 &#125;&#125;746381295[0]// ËøîÂõû 5746381295[1]// ËøîÂõû 9746381295[2]// ËøîÂõû 2746381295[8]// ËøîÂõû 7 0..&lt;digitIndex Ë°®Á§∫‰∏Ä‰∏™ËåÉÂõ¥ ÂµåÂ•óÁ±ªÂûãÊâ©Â±ïÂèØ‰ª•‰∏∫Â∑≤ÊúâÁöÑÁ±ª„ÄÅÁªìÊûÑ‰ΩìÂíåÊûö‰∏æÊ∑ªÂä†Êñ∞ÁöÑÂµåÂ•óÁ±ªÂûãÔºö 123456789101112131415extension Int &#123; enum Kind &#123; case Negative, Zero, Positive &#125; var kind: Kind &#123; switch self &#123; case 0: return .Zero case let x where x &gt; 0: return .Positive default: return .Negative &#125; &#125;&#125; ËØ•‰æãÂ≠ê‰∏∫ Int Ê∑ªÂä†‰∫ÜÂµåÂ•óÊûö‰∏æ„ÄÇËøô‰∏™Âêç‰∏∫ Kind ÁöÑÊûö‰∏æË°®Á§∫ÁâπÂÆöÊï¥Êï∞ÁöÑÁ±ªÂûã„ÄÇÂÖ∑‰ΩìÊù•ËØ¥ÔºåÂ∞±ÊòØË°®Á§∫Êï¥Êï∞ÊòØÊ≠£Êï∞„ÄÅÈõ∂ÊàñËÄÖË¥üÊï∞„ÄÇ ‰∏çËÉΩÊ∑ªÂä†Â±ûÊÄßÔºå‰ΩÜÊòØÂèØ‰ª•Ê∑ªÂä†Êûö‰∏æ ‰ΩøÁî®Ôºö 123456789101112131415func printIntegerKinds(numbers: [Int]) &#123; for number in numbers &#123; switch number.kind &#123; case .Negative: print("- ", terminator: "") case .Zero: print("0 ", terminator: "") case .Positive: print("+ ", terminator: "") &#125; &#125; print("")&#125;printIntegerKinds([3, 19, -27, 0, -6, 0, 7])// ÊâìÂç∞ ‚Äú+ + - 0 - 0 + ‚Äù Áî±‰∫éÂ∑≤Áü• number.kind ÊòØ Int.Kind Á±ªÂûãÔºåÂõ†Ê≠§Âú® switch ËØ≠Âè•‰∏≠ÔºåInt.Kind ‰∏≠ÁöÑÊâÄÊúâÊàêÂëòÂÄºÈÉΩÂèØ‰ª•‰ΩøÁî®ÁÆÄÂÜôÂΩ¢ÂºèÔºå‰æãÂ¶Ç‰ΩøÁî® .NegativeËÄå‰∏çÊòØ Int.Kind.Negative„ÄÇ ÂçèËÆÆËßÑÂÆö‰∫ÜÁî®Êù•ÂÆûÁé∞Êüê‰∏ÄÁâπÂÆö‰ªªÂä°ÊàñËÄÖÂäüËÉΩÁöÑÊñπÊ≥ï„ÄÅÂ±ûÊÄßÔºå‰ª•ÂèäÂÖ∂‰ªñÈúÄË¶ÅÁöÑ‰∏úË•ø„ÄÇÁ±ª„ÄÅÁªìÊûÑ‰ΩìÊàñÊûö‰∏æÈÉΩÂèØ‰ª•ÈááÁ∫≥ÂçèËÆÆÔºåÂπ∂‰∏∫ÂçèËÆÆÂÆö‰πâÁöÑËøô‰∫õË¶ÅÊ±ÇÊèê‰æõÂÖ∑‰ΩìÂÆûÁé∞„ÄÇ ÂçèËÆÆËØ≠Ê≥ï123protocol SomeProtocol &#123; // ËøôÈáåÊòØÂçèËÆÆÁöÑÂÆö‰πâÈÉ®ÂàÜ&#125; Ë¶ÅËÆ©Ëá™ÂÆö‰πâÁ±ªÂûãÈááÁ∫≥Êüê‰∏™ÂçèËÆÆÔºåÂú®ÂÆö‰πâÁ±ªÂûãÊó∂ÔºåÈúÄË¶ÅÂú®Á±ªÂûãÂêçÁß∞ÂêéÂä†‰∏äÂçèËÆÆÂêçÁß∞Ôºå‰∏≠Èó¥‰ª•ÂÜíÂè∑Ôºà:ÔºâÂàÜÈöî„ÄÇÈááÁ∫≥Â§ö‰∏™ÂçèËÆÆÊó∂ÔºåÂêÑÂçèËÆÆ‰πãÈó¥Áî®ÈÄóÂè∑Ôºà,ÔºâÂàÜÈöîÔºåÊã•ÊúâÁà∂Á±ªÁöÑÁ±ªÂú®ÈááÁ∫≥ÂçèËÆÆÊó∂ÔºåÂ∫îËØ•Â∞ÜÁà∂Á±ªÂêçÊîæÂú®ÂçèËÆÆÂêç‰πãÂâçÔºå‰ª•ÈÄóÂè∑ÂàÜÈöîÔºö 123class SomeClass: SomeSuperClass, FirstProtocol, AnotherProtocol &#123; // ËøôÈáåÊòØÁ±ªÁöÑÂÆö‰πâÈÉ®ÂàÜ&#125; Â±ûÊÄßË¶ÅÊ±ÇÂçèËÆÆÂèØ‰ª•Ë¶ÅÊ±ÇÈááÁ∫≥ÂçèËÆÆÁöÑÁ±ªÂûãÊèê‰æõÁâπÂÆöÂêçÁß∞ÂíåÁ±ªÂûãÁöÑÂÆû‰æãÂ±ûÊÄßÊàñÁ±ªÂûãÂ±ûÊÄß„ÄÇÂçèËÆÆ‰∏çÊåáÂÆöÂ±ûÊÄßÊòØÂ≠òÂÇ®ÂûãÂ±ûÊÄßËøòÊòØËÆ°ÁÆóÂûãÂ±ûÊÄßÔºåÂÆÉÂè™ÊåáÂÆöÂ±ûÊÄßÁöÑÂêçÁß∞ÂíåÁ±ªÂûã„ÄÇÊ≠§Â§ñÔºåÂçèËÆÆËøòÊåáÂÆöÂ±ûÊÄßÊòØÂèØËØªÁöÑËøòÊòØÂèØËØªÂèØÂÜôÁöÑ„ÄÇ Â¶ÇÊûúÂçèËÆÆË¶ÅÊ±ÇÂ±ûÊÄßÊòØÂèØËØªÂèØÂÜôÁöÑÔºåÈÇ£‰πàËØ•Â±ûÊÄß‰∏çËÉΩÊòØÂ∏∏ÈáèÂ±ûÊÄßÊàñÂè™ËØªÁöÑËÆ°ÁÆóÂûãÂ±ûÊÄß„ÄÇÂ¶ÇÊûúÂçèËÆÆÂè™Ë¶ÅÊ±ÇÂ±ûÊÄßÊòØÂèØËØªÁöÑÔºåÈÇ£‰πàËØ•Â±ûÊÄß‰∏ç‰ªÖÂèØ‰ª•ÊòØÂèØËØªÁöÑÔºåÂ¶ÇÊûú‰ª£Á†ÅÈúÄË¶ÅÁöÑËØùÔºåËøòÂèØ‰ª•ÊòØÂèØÂÜôÁöÑ„ÄÇÔºàÂèØËØªÂåÖÊã¨ÂèØÂÜôÂèØËØªÔºâ ÂçèËÆÆÊÄªÊòØÁî® var ÂÖ≥ÈîÆÂ≠óÊù•Â£∞ÊòéÂèòÈáèÂ±ûÊÄßÔºåÂú®Á±ªÂûãÂ£∞ÊòéÂêéÂä†‰∏ä { set get } Êù•Ë°®Á§∫Â±ûÊÄßÊòØÂèØËØªÂèØÂÜôÁöÑÔºå‰ΩøÁî®{get} Êù•ÊòéÁ°ÆÂèØËØªÁöÑÂ±ûÊÄßÔºö 1234protocol SomeProtocol &#123; var mustBeSettable: Int &#123; get set &#125; var doesNotNeedToBeSettable: Int &#123; get &#125;&#125; Âú®ÂçèËÆÆ‰∏≠ÂÆö‰πâÁ±ªÂûãÂ±ûÊÄßÊó∂ÔºåÊÄªÊòØ‰ΩøÁî® static ÂÖ≥ÈîÆÂ≠ó‰Ωú‰∏∫ÂâçÁºÄ„ÄÇ 123protocol AnotherProtocol &#123; static var someTypeProperty: Int &#123; get set &#125;&#125; ÂΩìÁ±ªÁ±ªÂûãÈááÁ∫≥ÂçèËÆÆÊó∂ÔºåÈô§‰∫Ü static ÂÖ≥ÈîÆÂ≠óÔºåËøòÂèØ‰ª•‰ΩøÁî® class ÂÖ≥ÈîÆÂ≠óÊù•Â£∞ÊòéÁ±ªÂûãÂ±ûÊÄßÔºåË°®Á§∫ÂèØË¢´ÁªßÊâø Swift ‰∏≠ÊòØÁúüËÉΩÂú®ÂçèËÆÆ‰∏≠Ê∑ªÂä†Â±ûÊÄßÔºåËÄå OC ‰∏≠ÔºåÊ∑ªÂä†ÁöÑÂ±ûÊÄßÂè™ÊòØË°®Á§∫Ë¶ÅÊ±ÇÂÆûÁé∞ get set ÊñπÊ≥ïÔºå‰ΩÜÊòØÂπ∂Ê≤°ÊúâÂÆû‰æãÂèòÈáè ÊñπÊ≥ïË¶ÅÊ±ÇËøô‰∫õÊñπÊ≥ï‰Ωú‰∏∫ÂçèËÆÆÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÂÉèÊôÆÈÄöÊñπÊ≥ï‰∏ÄÊ†∑ÊîæÂú®ÂçèËÆÆÁöÑÂÆö‰πâ‰∏≠Ôºå‰ΩÜÊòØ‰∏çÈúÄË¶ÅÂ§ßÊã¨Âè∑ÂíåÊñπÊ≥ï‰Ωì„ÄÇÂèØ‰ª•Âú®ÂçèËÆÆ‰∏≠ÂÆö‰πâÂÖ∑ÊúâÂèØÂèòÂèÇÊï∞ÁöÑÊñπÊ≥ïÔºåÂíåÊôÆÈÄöÊñπÊ≥ïÁöÑÂÆö‰πâÊñπÂºèÁõ∏Âêå„ÄÇ‰ΩÜÊòØÔºå‰∏çÊîØÊåÅ‰∏∫ÂçèËÆÆ‰∏≠ÁöÑÊñπÊ≥ïÁöÑÂèÇÊï∞Êèê‰æõÈªòËÆ§ÂÄº„ÄÇ Ê≠£Â¶ÇÂ±ûÊÄßË¶ÅÊ±Ç‰∏≠ÊâÄËø∞ÔºåÂú®ÂçèËÆÆ‰∏≠ÂÆö‰πâÁ±ªÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÊÄªÊòØ‰ΩøÁî® static ÂÖ≥ÈîÆÂ≠ó‰Ωú‰∏∫ÂâçÁºÄ„ÄÇ 123protocol SomeProtocol &#123; static func someTypeMethod()&#125; ÂΩìÁ±ªÁ±ªÂûãÈááÁ∫≥ÂçèËÆÆÊó∂ÔºåÈô§‰∫Ü static ÂÖ≥ÈîÆÂ≠óÔºåËøòÂèØ‰ª•‰ΩøÁî® class ÂÖ≥ÈîÆÂ≠ó‰Ωú‰∏∫ÂâçÁºÄ 12345678910111213141516171819protocol RandomNumberGenerator &#123; func random() -&gt; Double&#125;class LinearCongruentialGenerator: RandomNumberGenerator &#123; var lastRandom = 42.0 let m = 139968.0 let a = 3877.0 let c = 29573.0 func random() -&gt; Double &#123; lastRandom = ((lastRandom * a + c) % m) return lastRandom / m &#125;&#125;let generator = LinearCongruentialGenerator()print("Here's a random number: \(generator.random())")// ÊâìÂç∞ ‚ÄúHere's a random number: 0.37464991998171‚Äùprint("And another one: \(generator.random())")// ÊâìÂç∞ ‚ÄúAnd another one: 0.729023776863283‚Äù Mutating ÊñπÊ≥ïË¶ÅÊ±ÇÂ¶ÇÊûú‰Ω†Âú®ÂçèËÆÆ‰∏≠ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÂÆû‰æãÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ï‰ºöÊîπÂèòÈááÁ∫≥ËØ•ÂçèËÆÆÁöÑÁ±ªÂûãÁöÑÂÆû‰æãÔºåÈÇ£‰πàÂú®ÂÆö‰πâÂçèËÆÆÊó∂ÈúÄË¶ÅÂú®ÊñπÊ≥ïÂâçÂä† mutating ÂÖ≥ÈîÆÂ≠ó„ÄÇËøô‰ΩøÂæóÁªìÊûÑ‰ΩìÂíåÊûö‰∏æËÉΩÂ§üÈááÁ∫≥Ê≠§ÂçèËÆÆÂπ∂Êª°Ë∂≥Ê≠§ÊñπÊ≥ïË¶ÅÊ±Ç„ÄÇ ÂÆûÁé∞ÂçèËÆÆ‰∏≠ÁöÑ mutating ÊñπÊ≥ïÊó∂ÔºåËã•ÊòØÁ±ªÁ±ªÂûãÔºåÂàô‰∏çÁî®ÂÜô mutating ÂÖ≥ÈîÆÂ≠ó„ÄÇËÄåÂØπ‰∫éÁªìÊûÑ‰ΩìÂíåÊûö‰∏æÔºåÂàôÂøÖÈ°ªÂÜô mutating ÂÖ≥ÈîÆÂ≠ó„ÄÇ 1234567891011121314enum OnOffSwitch: Togglable &#123; case off, on mutating func toggle() &#123; switch self &#123; case .off: self = .on case .on: self = .off &#125; &#125;&#125;var lightSwitch = OnOffSwitch.offlightSwitch.toggle()// lightSwitch is now equal to .on ÊûÑÈÄ†Âô®Ë¶ÅÊ±Ç‰Ω†ÂèØ‰ª•ÂÉèÁºñÂÜôÊôÆÈÄöÊûÑÈÄ†Âô®ÈÇ£Ê†∑ÔºåÂú®ÂçèËÆÆÁöÑÂÆö‰πâÈáåÂÜô‰∏ãÊûÑÈÄ†Âô®ÁöÑÂ£∞ÊòéÔºå‰ΩÜ‰∏çÈúÄË¶ÅÂÜôËä±Êã¨Âè∑ÂíåÊûÑÈÄ†Âô®ÁöÑÂÆû‰ΩìÔºö 123protocol SomeProtocol &#123; init(someParameter: Int)&#125; ÊûÑÈÄ†Âô®Ë¶ÅÊ±ÇÂú®Á±ª‰∏≠ÁöÑÂÆûÁé∞‰Ω†ÂèØ‰ª•Âú®ÈááÁ∫≥ÂçèËÆÆÁöÑÁ±ª‰∏≠ÂÆûÁé∞ÊûÑÈÄ†Âô®ÔºåÊó†ËÆ∫ÊòØ‰Ωú‰∏∫ÊåáÂÆöÊûÑÈÄ†Âô®ÔºåËøòÊòØ‰Ωú‰∏∫‰æøÂà©ÊûÑÈÄ†Âô®„ÄÇÊó†ËÆ∫Âì™ÁßçÊÉÖÂÜµÔºå‰Ω†ÈÉΩÂøÖÈ°ª‰∏∫ÊûÑÈÄ†Âô®ÂÆûÁé∞Ê†á‰∏ä required ‰øÆÈ•∞Á¨¶Ôºö 12345class SomeClass: SomeProtocol &#123; required init(someParameter: Int) &#123; // ËøôÈáåÊòØÊûÑÈÄ†Âô®ÁöÑÂÆûÁé∞ÈÉ®ÂàÜ &#125;&#125; ‰ΩøÁî® required ‰øÆÈ•∞Á¨¶ÂèØ‰ª•Á°Æ‰øùÊâÄÊúâÂ≠êÁ±ª‰πüÂøÖÈ°ªÊèê‰æõÊ≠§ÊûÑÈÄ†Âô®ÂÆûÁé∞Ôºå‰ªéËÄå‰πüËÉΩÁ¨¶ÂêàÂçèËÆÆ„ÄÇÂ∞±ÊòØÊûÑÈÄ†Âô®ÊØîËæÉÁâπÊÆä Â¶ÇÊûúÁ±ªÂ∑≤ÁªèË¢´Ê†áËÆ∞‰∏∫ finalÔºåÈÇ£‰πà‰∏çÈúÄË¶ÅÂú®ÂçèËÆÆÊûÑÈÄ†Âô®ÁöÑÂÆûÁé∞‰∏≠‰ΩøÁî® required ‰øÆÈ•∞Á¨¶ÔºåÂõ†‰∏∫ final Á±ª‰∏çËÉΩÊúâÂ≠êÁ±ª„ÄÇ Â¶ÇÊûú‰∏Ä‰∏™Â≠êÁ±ªÈáçÂÜô‰∫ÜÁà∂Á±ªÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ÔºåÂπ∂‰∏îËØ•ÊûÑÈÄ†Âô®Êª°Ë∂≥‰∫ÜÊüê‰∏™ÂçèËÆÆÁöÑË¶ÅÊ±ÇÔºåÈÇ£‰πàËØ•ÊûÑÈÄ†Âô®ÁöÑÂÆûÁé∞ÈúÄË¶ÅÂêåÊó∂Ê†áÊ≥® required Âíå override ‰øÆÈ•∞Á¨¶Ôºö 1234567891011121314151617protocol SomeProtocol &#123; init()&#125;class SomeSuperClass &#123; init() &#123; // ËøôÈáåÊòØÊûÑÈÄ†Âô®ÁöÑÂÆûÁé∞ÈÉ®ÂàÜ &#125;&#125;class SomeSubClass: SomeSuperClass, SomeProtocol &#123; // Âõ†‰∏∫ÈááÁ∫≥ÂçèËÆÆÔºåÈúÄË¶ÅÂä†‰∏ä required // Âõ†‰∏∫ÁªßÊâøËá™Áà∂Á±ªÔºåÈúÄË¶ÅÂä†‰∏ä override required override init() &#123; // ËøôÈáåÊòØÊûÑÈÄ†Âô®ÁöÑÂÆûÁé∞ÈÉ®ÂàÜ &#125;&#125; Ë≤å‰ºº‰πüÊ≤°ÈÇ£‰πàÂ∑ßÔºåÈáçÂÜôÁöÑÊñπÊ≥ïÂíåÁªßÊâøÁöÑÊñπÊ≥ïÂêåÂêçÂêß ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Ë¶ÅÊ±ÇÈááÁ∫≥ÂçèËÆÆÁöÑÁ±ªÂûãÂèØ‰ª•ÈÄöËøáÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Ôºàinit?ÔºâÊàñÈùûÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÔºàinitÔºâÊù•Êª°Ë∂≥ÂçèËÆÆ‰∏≠ÂÆö‰πâÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Ë¶ÅÊ±Ç„ÄÇÂçèËÆÆ‰∏≠ÂÆö‰πâÁöÑÈùûÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Ë¶ÅÊ±ÇÂèØ‰ª•ÈÄöËøáÈùûÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÔºàinitÔºâÊàñÈöêÂºèËß£ÂåÖÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Ôºàinit!ÔºâÊù•Êª°Ë∂≥„ÄÇ ÂçèËÆÆ‰Ωú‰∏∫Á±ªÂûãÂ∞ΩÁÆ°ÂçèËÆÆÊú¨Ë∫´Âπ∂Êú™ÂÆûÁé∞‰ªª‰ΩïÂäüËÉΩÔºå‰ΩÜÊòØÂçèËÆÆÂèØ‰ª•Ë¢´ÂΩìÂÅö‰∏Ä‰∏™ÊàêÁÜüÁöÑÁ±ªÂûãÊù•‰ΩøÁî®„ÄÇ Ê≥®ÊÑèÔºåSwift ‰∏≠ÂçèËÆÆ‰πüÊòØ‰∏ÄÁßçÁ±ªÂûã„ÄÇ 12345678910111213141516171819202122class Dice &#123; let sides: Int let generator: RandomNumberGenerator init(sides: Int, generator: RandomNumberGenerator) &#123; self.sides = sides self.generator = generator &#125; func roll() -&gt; Int &#123; return Int(generator.random() * Double(sides)) + 1 &#125;&#125;//LinearCongruentialGenerator Âíå RandomNumberGenerator ‰∏äÈù¢ÂÆö‰πâËøávar d6 = Dice(sides: 6, generator: LinearCongruentialGenerator())for _ in 1...5 &#123; print("Random dice roll is \(d6.roll())")&#125;// Random dice roll is 3// Random dice roll is 5// Random dice roll is 4// Random dice roll is 5// Random dice roll is 4 RandomNumberGenerator ÊòØ‰∏äÈù¢ÂÆö‰πâÁöÑÂçèËÆÆÂêç oc ‰∏≠‰ΩøÁî®Êüê‰∏™ÂçèËÆÆÊòØ id&lt;ÂçèËÆÆÂêç&gt;„ÄÇswift ‰∏≠Áõ¥Êé•Â∞ÜÂçèËÆÆÂΩìÊàê‰∏ÄÁßçÁ±ªÂûã‰∫Ü ÈÄöËøáÊâ©Â±ïÊ∑ªÂä†ÂçèËÆÆ‰∏ÄËá¥ÊÄßÂç≥‰æøÊó†Ê≥ï‰øÆÊîπÊ∫ê‰ª£Á†ÅÔºå‰æùÁÑ∂ÂèØ‰ª•ÈÄöËøáÊâ©Â±ï‰ª§Â∑≤ÊúâÁ±ªÂûãÈááÁ∫≥Âπ∂Á¨¶ÂêàÂçèËÆÆ„ÄÇ ÈÄöËøáÊâ©Â±ï‰ª§Â∑≤ÊúâÁ±ªÂûãÈááÁ∫≥Âπ∂Á¨¶ÂêàÂçèËÆÆÊó∂ÔºåËØ•Á±ªÂûãÁöÑÊâÄÊúâÂÆû‰æã‰πü‰ºöÈöè‰πãËé∑ÂæóÂçèËÆÆ‰∏≠ÂÆö‰πâÁöÑÂêÑÈ°πÂäüËÉΩ„ÄÇ 123456789protocol TextRepresentable &#123; var textualDescription: String &#123; get &#125;&#125;extension Dice: TextRepresentable &#123; var textualDescription: String &#123; return "A \(sides)-sided dice" &#125;&#125; ‰ΩøÁî®ÊãìÂ±ïÂ£∞ÊòéÈááÁ∫≥ÂçèËÆÆÂ¶ÇÊûú‰∏Ä‰∏™Á±ªÂûãÂ∑≤ÁªèÈÅµÂæ™‰∫ÜÂçèËÆÆÁöÑÊâÄÊúâÈúÄÊ±ÇÔºå‰ΩÜÊòØËøòÊ≤°ÊúâÂ£∞ÊòéÂÆÉÈááÁ∫≥‰∫ÜËøô‰∏™ÂçèËÆÆÔºå‰Ω†ÂèØ‰ª•ËÆ©ÈÄöËøá‰∏Ä‰∏™Á©∫ÁöÑÊâ©Â±ïÊù•ËÆ©ÂÆÉÈááÁ∫≥Ëøô‰∏™ÂçèËÆÆÔºö 1234567struct Hamster &#123; var name: String var textualDescription: String &#123; return "A hamster named \(name)" &#125;&#125;extension Hamster: TextRepresentable &#123;&#125; ÂçèËÆÆÁöÑÁªßÊâøÂçèËÆÆËÉΩÂ§üÁªßÊâø‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂÖ∂‰ªñÂçèËÆÆÔºåÂèØ‰ª•Âú®ÁªßÊâøÁöÑÂçèËÆÆÁöÑÂü∫Á°Ä‰∏äÂ¢ûÂä†Êñ∞ÁöÑË¶ÅÊ±Ç„ÄÇÂçèËÆÆÁöÑÁªßÊâøËØ≠Ê≥ï‰∏éÁ±ªÁöÑÁªßÊâøÁõ∏‰ººÔºåÂ§ö‰∏™Ë¢´ÁªßÊâøÁöÑÂçèËÆÆÈó¥Áî®ÈÄóÂè∑ÂàÜÈöîÔºö 123protocol PrettyTextRepresentable: TextRepresentable &#123; var prettyTextualDescription: String &#123; get &#125;&#125; ‰ªª‰ΩïÈááÁ∫≥ PrettyTextRepresentable ÂçèËÆÆÁöÑÁ±ªÂûãÂú®Êª°Ë∂≥ËØ•ÂçèËÆÆÁöÑË¶ÅÊ±ÇÊó∂Ôºå‰πüÂøÖÈ°ªÊª°Ë∂≥ TextRepresentable ÂçèËÆÆÁöÑË¶ÅÊ±Ç„ÄÇ Á±ªÁ±ªÂûã‰∏ìÂ±ûÂçèËÆÆ‰Ω†ÂèØ‰ª•Âú®ÂçèËÆÆÁöÑÁªßÊâøÂàóË°®‰∏≠ÔºåÈÄöËøáÊ∑ªÂä† class ÂÖ≥ÈîÆÂ≠óÊù•ÈôêÂà∂ÂçèËÆÆÂè™ËÉΩË¢´Á±ªÁ±ªÂûãÈááÁ∫≥ÔºåËÄåÁªìÊûÑ‰ΩìÊàñÊûö‰∏æ‰∏çËÉΩÈááÁ∫≥ËØ•ÂçèËÆÆ„ÄÇclass ÂÖ≥ÈîÆÂ≠óÂøÖÈ°ªÁ¨¨‰∏Ä‰∏™Âá∫Áé∞Âú®ÂçèËÆÆÁöÑÁªßÊâøÂàóË°®‰∏≠ÔºåÂú®ÂÖ∂‰ªñÁªßÊâøÁöÑÂçèËÆÆ‰πãÂâçÔºö 123protocol SomeClassOnlyProtocol: class, SomeInheritedProtocol &#123; // ËøôÈáåÊòØÁ±ªÁ±ªÂûã‰∏ìÂ±ûÂçèËÆÆÁöÑÂÆö‰πâÈÉ®ÂàÜ&#125; ÂçèËÆÆÂêàÊàêÊúâÊó∂ÂÄôÈúÄË¶ÅÂêåÊó∂ÈááÁ∫≥Â§ö‰∏™ÂçèËÆÆÔºå‰Ω†ÂèØ‰ª•Â∞ÜÂ§ö‰∏™ÂçèËÆÆÈááÁî® SomeProtocol &amp; AnotherProtocol ËøôÊ†∑ÁöÑÊ†ºÂºèËøõË°åÁªÑÂêàÔºåÁß∞‰∏∫ ÂçèËÆÆÂêàÊàê„ÄÇ‰Ω†ÂèØ‰ª•ÁΩóÂàó‰ªªÊÑèÂ§ö‰∏™‰Ω†ÊÉ≥Ë¶ÅÈááÁ∫≥ÁöÑÂçèËÆÆÔºå‰ª•‰∏éÁ¨¶Âè∑(&amp;)ÂàÜÈöî„ÄÇ 12345678910111213141516protocol Named &#123; var name: String &#123; get &#125;&#125;protocol Aged &#123; var age: Int &#123; get &#125;&#125;struct Person: Named, Aged &#123; var name: String var age: Int&#125;func wishHappyBirthday(to celebrator: Named &amp; Aged) &#123; print("Happy birthday, \(celebrator.name), you're \(celebrator.age)!")&#125;let birthdayPerson = Person(name: "Malcolm", age: 21)wishHappyBirthday(to: birthdayPerson)// ÊâìÂç∞ ‚ÄúHappy birthday Malcolm - you're 21!‚Äù ÂçèËÆÆÂêàÊàêÂπ∂‰∏ç‰ºöÁîüÊàêÊñ∞ÁöÑ„ÄÅÊ∞∏‰πÖÁöÑÂçèËÆÆÁ±ªÂûãÔºåËÄåÊòØÂ∞ÜÂ§ö‰∏™ÂçèËÆÆ‰∏≠ÁöÑË¶ÅÊ±ÇÂêàÊàêÂà∞‰∏Ä‰∏™Âè™Âú®Â±ÄÈÉ®‰ΩúÁî®ÂüüÊúâÊïàÁöÑ‰∏¥Êó∂ÂçèËÆÆ‰∏≠„ÄÇ Ê£ÄÊü•ÂçèËÆÆ‰∏ÄËá¥ÊÄßÂâçÈù¢ËØ¥ËøáÂçèËÆÆ‰πüËÉΩ‰Ωú‰∏∫Á±ªÂûã‰ΩøÁî®„ÄÇÈÇ£‰πà‰πüÂ∞±ÂèØ‰ª•‰ΩøÁî®Á±ªÂûãËΩ¨Êç¢‰∏≠ÊèèËø∞ÁöÑ is Âíå as Êìç‰ΩúÁ¨¶Êù•Ê£ÄÊü•ÂçèËÆÆ‰∏ÄËá¥ÊÄßÔºåÂç≥ÊòØÂê¶Á¨¶ÂêàÊüêÂçèËÆÆÔºåÂπ∂‰∏îÂèØ‰ª•ËΩ¨Êç¢Âà∞ÊåáÂÆöÁöÑÂçèËÆÆÁ±ªÂûã„ÄÇ 12345678910for object in objects &#123; if let objectWithArea = object as? HasArea &#123; print("Area is \(objectWithArea.area)") &#125; else &#123; print("Something that doesn't have an area") &#125;&#125;// Area is 12.5663708// Area is 243610.0// Something that doesn't have an area ÂèØÈÄâÁöÑÂçèËÆÆË¶ÅÊ±ÇÂçèËÆÆÂèØ‰ª•ÂÆö‰πâÂèØÈÄâË¶ÅÊ±ÇÔºåÈááÁ∫≥ÂçèËÆÆÁöÑÁ±ªÂûãÂèØ‰ª•ÈÄâÊã©ÊòØÂê¶ÂÆûÁé∞Ëøô‰∫õË¶ÅÊ±Ç„ÄÇÂú®ÂçèËÆÆ‰∏≠‰ΩøÁî® optional ÂÖ≥ÈîÆÂ≠ó‰Ωú‰∏∫ÂâçÁºÄÊù•ÂÆö‰πâÂèØÈÄâË¶ÅÊ±Ç„ÄÇ‰ΩøÁî®ÂèØÈÄâË¶ÅÊ±ÇÊó∂Ôºà‰æãÂ¶ÇÔºåÂèØÈÄâÁöÑÊñπÊ≥ïÊàñËÄÖÂ±ûÊÄßÔºâÔºåÂÆÉ‰ª¨ÁöÑÁ±ªÂûã‰ºöËá™Âä®ÂèòÊàêÂèØÈÄâÁöÑ„ÄÇÊØîÂ¶ÇÔºå‰∏Ä‰∏™Á±ªÂûã‰∏∫ (Int) -&gt; StringÁöÑÊñπÊ≥ï‰ºöÂèòÊàê ((Int) -&gt; String)?„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÊï¥‰∏™ÂáΩÊï∞Á±ªÂûãÊòØÂèØÈÄâÁöÑÔºåËÄå‰∏çÊòØÂáΩÊï∞ÁöÑËøîÂõûÂÄº„ÄÇ ÂçèËÆÆ‰∏≠ÁöÑÂèØÈÄâË¶ÅÊ±ÇÂèØÈÄöËøáÂèØÈÄâÈìæÂºèË∞ÉÁî®Êù•‰ΩøÁî®ÔºåÂõ†‰∏∫ÈááÁ∫≥ÂçèËÆÆÁöÑÁ±ªÂûãÂèØËÉΩÊ≤°ÊúâÂÆûÁé∞Ëøô‰∫õÂèØÈÄâË¶ÅÊ±Ç„ÄÇÁ±ª‰ºº someOptionalMethod?(someArgument) ËøôÊ†∑Ôºå‰Ω†ÂèØ‰ª•Âú®ÂèØÈÄâÊñπÊ≥ïÂêçÁß∞ÂêéÂä†‰∏ä ? Êù•Ë∞ÉÁî®ÂèØÈÄâÊñπÊ≥ï„ÄÇ 1234@objc protocol CounterDataSource &#123; @objc optional func increment(forCount count: Int) -&gt; Int @objc optional var fixedIncrement: Int &#123; get &#125;&#125; ‰∏Ä‰∏™ÂÆåÊï¥ÁöÑ‰æãÂ≠êÔºö 1234567891011121314151617181920212223242526class Counter &#123; var count = 0 var dataSource: CounterDataSource? func increment() &#123; if let amount = dataSource?.increment?(forCount: count) &#123; count += amount &#125; else if let amount = dataSource?.fixedIncrement &#123; count += amount &#125; &#125;&#125;class ThreeSource: NSObject, CounterDataSource &#123; let fixedIncrement = 3&#125;var counter = Counter()counter.dataSource = ThreeSource()for _ in 1...4 &#123; counter.increment() print(counter.count)&#125;// 3// 6// 9// 12 ËøôÈáåÊñπÊ≥ïÂêéÁöÑÂèØÈÄâÊòØÊåáËøô‰∏™ÊñπÊ≥ïÊòØÂê¶Â≠òÂú®ÔºåËÄå‰πãÂâçÂá∫Áé∞ËøáÁöÑÊñπÊ≥ïÂêéÁöÑÂèØÈÄâÊòØÊåáÔºåÊñπÊ≥ïÊòØÂê¶ÊúâËøîÂõûÂÄº„ÄÇ Ê≥®ÊÑè fixedIncrement Âú®ÂçèËÆÆ‰∏≠ÊòØ varÔºå‰ΩÜÊòØÂÆûÁé∞ÊòØÂèØ‰ª•ËÆæÁΩÆ‰∏∫ let ÂçèËÆÆÊâ©Â±ïÂçèËÆÆÂèØ‰ª•ÈÄöËøáÊâ©Â±ïÊù•‰∏∫ÈááÁ∫≥ÂçèËÆÆÁöÑÁ±ªÂûãÊèê‰æõÂ±ûÊÄß„ÄÅÊñπÊ≥ï‰ª•Âèä‰∏ãÊ†áÁöÑÂÆûÁé∞„ÄÇÈÄöËøáËøôÁßçÊñπÂºèÔºå‰Ω†ÂèØ‰ª•Âü∫‰∫éÂçèËÆÆÊú¨Ë∫´Êù•ÂÆûÁé∞Ëøô‰∫õÂäüËÉΩÔºåËÄåÊó†ÈúÄÂú®ÊØè‰∏™ÈááÁ∫≥ÂçèËÆÆÁöÑÁ±ªÂûã‰∏≠ÈÉΩÈáçÂ§çÂêåÊ†∑ÁöÑÂÆûÁé∞Ôºå‰πüÊó†ÈúÄ‰ΩøÁî®ÂÖ®Â±ÄÂáΩÊï∞„ÄÇ ‰æãÂ¶ÇÔºåÂèØ‰ª•Êâ©Â±ï RandomNumberGenerator ÂçèËÆÆÊù•Êèê‰æõ randomBool() ÊñπÊ≥ïÔºö 12345extension RandomNumberGenerator &#123; func randomBool() -&gt; Bool &#123; return random() &gt; 0.5 &#125;&#125; ÈÄöËøáÂçèËÆÆÊâ©Â±ïÔºåÊâÄÊúâÈááÁ∫≥ÂçèËÆÆÁöÑÁ±ªÂûãÔºåÈÉΩËÉΩËá™Âä®Ëé∑ÂæóËøô‰∏™Êâ©Â±ïÊâÄÂ¢ûÂä†ÁöÑÊñπÊ≥ïÂÆûÁé∞ÔºåÊó†ÈúÄ‰ªª‰ΩïÈ¢ùÂ§ñ‰øÆÊîπ„ÄÇ Ëøô‰∏™ÂçèËÆÆÊãìÂ±ïÁöÑÊú¨ÊÑèÊòØ‰∏∫‰∫ÜÁªôÂçèËÆÆÊèê‰æõÈªòËÆ§ÂÆûÁé∞ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•‰∏çÂøÖÂú®ÊØè‰∏™ÁöÑÁ±ª‰∏≠ÈÉΩÂÆûÁé∞ËØ•ÂçèËÆÆÁöÑÊñπÊ≥ï„ÄÇ‰ΩÜÊòØÔºåËøôÊ†∑‰∏ÄÊêûÂ∞±ÊúâÁÇπÂÉèÂ§öÁªßÊâø‰∫Ü„ÄÇÂ§öÁªßÊâøÁöÑÈóÆÈ¢òÊòØÂ¶ÇÊûúÁªßÊâø‰∫ÜÂ§ö‰∏™ÂÆûÁé∞Áõ∏ÂêåÊñπÊ≥ïÁöÑÂçèËÆÆÔºåÈÇ£‰πàË∞ÉÁî®ÁöÑÊó∂ÂÄôËØ•Â¶Ç‰ΩïÂèñËàçÔºü Swift ‰∏≠ÁöÑÁ±ªÂ¶ÇÊûúÊã•Êúâ‰∏§‰∏™ÊúâÁõ∏ÂêåÊñπÊ≥ïÂêçÁöÑÂçèËÆÆÊãìÂ±ïÔºåÈÇ£‰πàÁºñËØëÈÉΩ‰∏çËÉΩÈÄöËøáÔºåÈô§ÈùûÂú®Á±ª‰∏≠Ëá™Â∑±ÂÆûÁé∞‰∫Ü„ÄÇ Êèê‰æõÈªòËÆ§ÂÆûÁé∞ÂèØ‰ª•ÈÄöËøáÂçèËÆÆÊâ©Â±ïÊù•‰∏∫ÂçèËÆÆË¶ÅÊ±ÇÁöÑÂ±ûÊÄß„ÄÅÊñπÊ≥ï‰ª•Âèä‰∏ãÊ†áÊèê‰æõÈªòËÆ§ÁöÑÂÆûÁé∞„ÄÇÂ¶ÇÊûúÈááÁ∫≥ÂçèËÆÆÁöÑÁ±ªÂûã‰∏∫Ëøô‰∫õË¶ÅÊ±ÇÊèê‰æõ‰∫ÜËá™Â∑±ÁöÑÂÆûÁé∞ÔºåÈÇ£‰πàËøô‰∫õËá™ÂÆö‰πâÂÆûÁé∞Â∞Ü‰ºöÊõø‰ª£Êâ©Â±ï‰∏≠ÁöÑÈªòËÆ§ÂÆûÁé∞Ë¢´‰ΩøÁî®„ÄÇ Â¶Ç‰∏äÈù¢ÁöÑ PrettyTextRepresentable ÂçèËÆÆÁöÑÊñπÊ≥ïÔºö 12345extension PrettyTextRepresentable &#123; var prettyTextualDescription: String &#123; return textualDescription &#125;&#125; Ê≥õÂûãÊ≥õÂûãÂáΩÊï∞Ê≥õÂûãÁöÑ‰ΩøÁî®ÂÆû‰æãÔºö 1234567891011121314func swapTwoValues&lt;T&gt;(_ a: inout T, _ b: inout T) &#123; let temporaryA = a a = b b = temporaryA&#125;var someInt = 3var anotherInt = 107swapTwoValues(&amp;someInt, &amp;anotherInt)// someInt is now 107, and anotherInt is now 3var someString = "hello"var anotherString = "world"swapTwoValues(&amp;someString, &amp;anotherString) ‰æãÂ≠ê‰∏≠ÔºåÂΩìÂáΩÊï∞Á¨¨‰∏ÄÊ¨°Ë¢´Ë∞ÉÁî®Êó∂ÔºåT Ë¢´ Int ÊõøÊç¢ÔºåÁ¨¨‰∫åÊ¨°Ë∞ÉÁî®Êó∂ÔºåË¢´ String ÊõøÊç¢„ÄÇÂèØÊèê‰æõÂ§ö‰∏™Á±ªÂûãÂèÇÊï∞ÔºåÂ∞ÜÂÆÉ‰ª¨ÈÉΩÂÜôÂú®Â∞ñÊã¨Âè∑‰∏≠ÔºåÁî®ÈÄóÂè∑ÂàÜÂºÄ„ÄÇ ËøôÈáåËåÉÂûãÂêç‰∏∫ TÔºåÂèØ‰ª•ÊõøÊç¢‰∏∫‰ªªÊÑèÂ≠óÁ¨¶ Ê≥õÂûãÁ±ªÂûãÈô§‰∫ÜÊ≥õÂûãÂáΩÊï∞ÔºåSwift ËøòÂÖÅËÆ∏‰Ω†ÂÆö‰πâÊ≥õÂûãÁ±ªÂûã„ÄÇËøô‰∫õËá™ÂÆö‰πâÁ±ª„ÄÅÁªìÊûÑ‰ΩìÂíåÊûö‰∏æÂèØ‰ª•ÈÄÇÁî®‰∫é‰ªª‰ΩïÁ±ªÂûãÔºåÁ±ª‰ºº‰∫é Array Âíå Dictionary„ÄÇ 1234567891011struct Stack&lt;Element&gt; &#123; var items = [Element]() mutating func push(item: Element) &#123; items.append(item) &#125; mutating func pop() -&gt; Element &#123; return items.removeLast() &#125;&#125;var stackOfStrings = Stack&lt;String&gt;() ÊãìÂ±ï‰∏Ä‰∏™Ê≥õÂûãÁ±ªÂûãÂΩì‰Ω†Êâ©Â±ï‰∏Ä‰∏™Ê≥õÂûãÁ±ªÂûãÁöÑÊó∂ÂÄôÔºå‰Ω†Âπ∂‰∏çÈúÄË¶ÅÂú®Êâ©Â±ïÁöÑÂÆö‰πâ‰∏≠Êèê‰æõÁ±ªÂûãÂèÇÊï∞ÂàóË°®„ÄÇÂéüÂßãÁ±ªÂûãÂÆö‰πâ‰∏≠Â£∞ÊòéÁöÑÁ±ªÂûãÂèÇÊï∞ÂàóË°®Âú®Êâ©Â±ï‰∏≠ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®ÔºåÂπ∂‰∏îËøô‰∫õÊù•Ëá™ÂéüÂßãÁ±ªÂûã‰∏≠ÁöÑÂèÇÊï∞ÂêçÁß∞‰ºöË¢´Áî®‰ΩúÂéüÂßãÂÆö‰πâ‰∏≠Á±ªÂûãÂèÇÊï∞ÁöÑÂºïÁî®„ÄÇ 12345extension Stack &#123; var topItem: Element? &#123; return items.isEmpty ? nil : items[items.count - 1] &#125;&#125; Á±ªÂûãÁ∫¶Êùü‰∏äÈù¢ÁöÑÊ≥õÂûãÊòØÊâÄÊúâÁ±ªÂûãÈÉΩÂèØÁî®ÁöÑÔºå‰ΩÜÊòØÂÆûÈôÖ‰ΩøÁî®‰∏≠ÔºåÂèØËÉΩÈúÄË¶ÅÊéíÈô§Êéâ‰∏Ä‰∫õÁ±ªÂûã„ÄÇÊØîÂ¶Ç Dictionary Á±ªÂûãÂØπÂ≠óÂÖ∏ÁöÑÈîÆÂÅö‰∫ÜÈôêÂà∂ÔºåÂè™ÊúâÂèØ‰ª• hash ÁöÑÁ±ªÂûãÊâçËÉΩÊàê‰∏∫ÈîÆ„ÄÇ ÂΩì‰Ω†ÂàõÂª∫Ëá™ÂÆö‰πâÊ≥õÂûãÁ±ªÂûãÊó∂Ôºå‰Ω†ÂèØ‰ª•ÂÆö‰πâ‰Ω†Ëá™Â∑±ÁöÑÁ±ªÂûãÁ∫¶Êùü Á±ªÂûãÁ∫¶ÊùüËØ≠Ê≥ïÂèØ‰ª•Âú®‰∏Ä‰∏™Á±ªÂûãÂèÇÊï∞ÂêçÂêéÈù¢ÊîæÁΩÆ‰∏Ä‰∏™Á±ªÂêçÊàñËÄÖÂçèËÆÆÂêçÔºåÂπ∂Áî®ÂÜíÂè∑ËøõË°åÂàÜÈöîÔºåÊù•ÂÆö‰πâÁ±ªÂûãÁ∫¶ÊùüÔºåÂÆÉ‰ª¨Â∞ÜÊàê‰∏∫Á±ªÂûãÂèÇÊï∞ÂàóË°®ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ 123func someFunction&lt;T: SomeClass, U: SomeProtocol&gt;(someT: T, someU: U) &#123; // ËøôÈáåÊòØÊ≥õÂûãÂáΩÊï∞ÁöÑÂáΩÊï∞‰ΩìÈÉ®ÂàÜ&#125; ‰∏äÈù¢Ëøô‰∏™ÂáΩÊï∞Êúâ‰∏§‰∏™Á±ªÂûãÂèÇÊï∞„ÄÇÁ¨¨‰∏Ä‰∏™Á±ªÂûãÂèÇÊï∞ TÔºåÊúâ‰∏Ä‰∏™Ë¶ÅÊ±Ç T ÂøÖÈ°ªÊòØ SomeClass Â≠êÁ±ªÁöÑÁ±ªÂûãÁ∫¶ÊùüÔºõÁ¨¨‰∫å‰∏™Á±ªÂûãÂèÇÊï∞ UÔºåÊúâ‰∏Ä‰∏™Ë¶ÅÊ±Ç U ÂøÖÈ°ªÁ¨¶Âêà SomeProtocol ÂçèËÆÆÁöÑÁ±ªÂûãÁ∫¶Êùü„ÄÇ ÂÖ≥ËÅîÁ±ªÂûã‰∏∫ÂçèËÆÆÊèê‰æõÊ≥õÂûãÂç≥‰ΩøÁî®ÂÖ≥ËÅîÁ±ªÂûã„ÄÇÂÖ≥ËÅîÁ±ªÂûãÂèØ‰ª•ÈÄöËøá associatedtype ÂÖ≥ÈîÆÂ≠óÊù•ÊåáÂÆö„ÄÇ ÂÖ≥ËÅîÁ±ªÂûãÂÆû‰æã‰∏ãÈù¢ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÂÖ≥ËÅîÁ±ªÂûã ItemTypeÔºö 123456protocol Container &#123; associatedtype ItemType mutating func append(item: ItemType) var count: Int &#123; get &#125; subscript(i: Int) -&gt; ItemType &#123; get &#125;&#125; Container ÂçèËÆÆÂ£∞Êòé‰∫Ü‰∏Ä‰∏™ÂÖ≥ËÅîÁ±ªÂûã ItemTypeÔºåÂÜô‰Ωú associatedtype ItemType„ÄÇËøô‰∏™ÂçèËÆÆÊó†Ê≥ïÂÆö‰πâ ItemType ÊòØ‰ªÄ‰πàÁ±ªÂûãÁöÑÂà´ÂêçÔºåËøô‰∏™‰ø°ÊÅØÂ∞ÜÁïôÁªôÈÅµ‰ªéÂçèËÆÆÁöÑÁ±ªÂûãÊù•Êèê‰æõ„ÄÇ ‰ΩøÁî®Ôºö 123456789101112131415161718192021struct IntStack: Container &#123; // IntStack ÁöÑÂéüÂßãÂÆûÁé∞ÈÉ®ÂàÜ var items = [Int]() mutating func push(item: Int) &#123; items.append(item) &#125; mutating func pop() -&gt; Int &#123; return items.removeLast() &#125; // Container ÂçèËÆÆÁöÑÂÆûÁé∞ÈÉ®ÂàÜ typealias ItemType = Int mutating func append(_ item: Int) &#123; self.push(item: item) &#125; var count: Int &#123; return items.count &#125; subscript(i: Int) -&gt; Int &#123; return items[i] &#125;&#125; ËøôÈáåÊòæÂºèÂú∞ÊåáÂÆö ItemType ‰∏∫ Int Á±ªÂûãÔºåÂç≥ typealias ItemType = IntÔºå‰ªéËÄåÂ∞Ü Container ÂçèËÆÆ‰∏≠ÊäΩË±°ÁöÑ ItemType Á±ªÂûãËΩ¨Êç¢‰∏∫ÂÖ∑‰ΩìÁöÑ Int Á±ªÂûã„ÄÇ typealias ÊÄªÁÆóÊúâÁî®‰∫Ü ‰∏çËøáÁî±‰∫éÁ±ªÂûãÊé®Êñ≠ÔºåÂèØ‰ª•‰∏çÁî®Â£∞Êòé ItemType ‰∏∫ IntÔºö 1234567891011121314151617181920struct Stack&lt;Element&gt;: Container &#123; // Stack&lt;Element&gt; ÁöÑÂéüÂßãÂÆûÁé∞ÈÉ®ÂàÜ var items = [Element]() mutating func push(item: Element) &#123; items.append(item) &#125; mutating func pop() -&gt; Element &#123; return items.removeLast() &#125; // Container ÂçèËÆÆÁöÑÂÆûÁé∞ÈÉ®ÂàÜ mutating func append(item: Element) &#123; self.push(item) &#125; var count: Int &#123; return items.count &#125; subscript(i: Int) -&gt; Element &#123; return items[i] &#125;&#125; Ëøô‰∏ÄÊ¨°ÔºåÂç†‰ΩçÁ±ªÂûãÂèÇÊï∞ Element Ë¢´Áî®‰Ωú append(_:) ÊñπÊ≥ïÁöÑ item ÂèÇÊï∞Âíå‰∏ãÊ†áÁöÑËøîÂõûÁ±ªÂûã„ÄÇSwift ÂèØ‰ª•ÊçÆÊ≠§Êé®Êñ≠Âá∫ Element ÁöÑÁ±ªÂûãÂç≥ÊòØ ItemType ÁöÑÁ±ªÂûã„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Swift 3.1 ËØ≠Ê≥ïÂ≠¶‰π†Ôºà‰∫îÔºâ]]></title>
    <url>%2F2017%2F02%2F22%2Fswift%E8%AF%AD%E6%B3%955%2F</url>
    <content type="text"><![CDATA[Êé•ÁùÄ‰∏ä‰∏ÄÁØá ÊûêÊûÑËøáÁ®ãÊûêÊûÑÂô®Âè™ÈÄÇÁî®‰∫éÁ±ªÁ±ªÂûãÔºåÂΩì‰∏Ä‰∏™Á±ªÁöÑÂÆû‰æãË¢´ÈáäÊîæ‰πãÂâçÔºåÊûêÊûÑÂô®‰ºöË¢´Á´ãÂç≥Ë∞ÉÁî®„ÄÇÊûêÊûÑÂô®Áî®ÂÖ≥ÈîÆÂ≠ódeinitÊù•Ê†áÁ§∫ÔºåÁ±ª‰ºº‰∫éÊûÑÈÄ†Âô®Ë¶ÅÁî®initÊù•Ê†áÁ§∫„ÄÇ ÊûêÊûÑËøáÁ®ãÂéüÁêÜSwift ÈÄöËøáËá™Âä®ÂºïÁî®ËÆ°Êï∞ÔºàARCÔºâÂ§ÑÁêÜÂÆû‰æãÁöÑÂÜÖÂ≠òÁÆ°ÁêÜ„ÄÇÈÄöÂ∏∏ÂΩì‰Ω†ÁöÑÂÆû‰æãË¢´ÈáäÊîæÊó∂‰∏çÈúÄË¶ÅÊâãÂä®Âú∞ÂéªÊ∏ÖÁêÜ„ÄÇ‰ΩÜÊòØÔºåÂΩì‰ΩøÁî®Ëá™Â∑±ÁöÑËµÑÊ∫êÊó∂Ôºå‰Ω†ÂèØËÉΩÈúÄË¶ÅËøõË°å‰∏Ä‰∫õÈ¢ùÂ§ñÁöÑÊ∏ÖÁêÜ„ÄÇ‰æãÂ¶ÇÔºåÂ¶ÇÊûúÂàõÂª∫‰∫Ü‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑÁ±ªÊù•ÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂ÔºåÂπ∂ÂÜôÂÖ•‰∏Ä‰∫õÊï∞ÊçÆÔºå‰Ω†ÂèØËÉΩÈúÄË¶ÅÂú®Á±ªÂÆû‰æãË¢´ÈáäÊîæ‰πãÂâçÊâãÂä®ÂéªÂÖ≥Èó≠ËØ•Êñá‰ª∂„ÄÇ Âú®Á±ªÁöÑÂÆö‰πâ‰∏≠ÔºåÊØè‰∏™Á±ªÊúÄÂ§öÂè™ËÉΩÊúâ‰∏Ä‰∏™ÊûêÊûÑÂô®ÔºåËÄå‰∏îÊûêÊûÑÂô®‰∏çÂ∏¶‰ªª‰ΩïÂèÇÊï∞ÔºåÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö 123deinit &#123; // ÊâßË°åÊûêÊûÑËøáÁ®ã&#125; ÊûêÊûÑÂô®ÊòØÂú®ÂÆû‰æãÈáäÊîæÂèëÁîüÂâçË¢´Ëá™Âä®Ë∞ÉÁî®„ÄÇ‰Ω†‰∏çËÉΩ‰∏ªÂä®Ë∞ÉÁî®ÊûêÊûÑÂô®„ÄÇÂ≠êÁ±ªÁªßÊâø‰∫ÜÁà∂Á±ªÁöÑÊûêÊûÑÂô®ÔºåÂπ∂‰∏îÂú®Â≠êÁ±ªÊûêÊûÑÂô®ÂÆûÁé∞ÁöÑÊúÄÂêéÔºåÁà∂Á±ªÁöÑÊûêÊûÑÂô®‰ºöË¢´Ëá™Âä®Ë∞ÉÁî®„ÄÇÂç≥‰ΩøÂ≠êÁ±ªÊ≤°ÊúâÊèê‰æõËá™Â∑±ÁöÑÊûêÊûÑÂô®ÔºåÁà∂Á±ªÁöÑÊûêÊûÑÂô®‰πüÂêåÊ†∑‰ºöË¢´Ë∞ÉÁî®„ÄÇ Âõ†‰∏∫Áõ¥Âà∞ÂÆû‰æãÁöÑÊûêÊûÑÂô®Ë¢´Ë∞ÉÁî®ÂêéÔºåÂÆû‰æãÊâç‰ºöË¢´ÈáäÊîæÔºåÊâÄ‰ª•ÊûêÊûÑÂô®ÂèØ‰ª•ËÆøÈóÆÂÆû‰æãÁöÑÊâÄÊúâÂ±ûÊÄßÔºåÂπ∂‰∏îÂèØ‰ª•Ê†πÊçÆÈÇ£‰∫õÂ±ûÊÄßÂèØ‰ª•‰øÆÊîπÂÆÉÁöÑË°å‰∏∫ÔºàÊØîÂ¶ÇÊü•Êâæ‰∏Ä‰∏™ÈúÄË¶ÅË¢´ÂÖ≥Èó≠ÁöÑÊñá‰ª∂Ôºâ„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØ‰∏Ä‰∏™Âú®ÂØπË±°ÈîÄÊØÅÂâçÁöÑÂõûË∞ÉÔºå‰Ω†ÂèØ‰ª•Âú®ÂØπË±°ÈîÄÊØÅÂâçÂÅö‰ªª‰Ωï‰Ω†ÊÉ≥ÂÅöÁöÑ‰∫ã„ÄÇ Ëá™Âä®ÂºïÁî®ËÆ°Êï∞ ÂºïÁî®ËÆ°Êï∞‰ªÖ‰ªÖÂ∫îÁî®‰∫éÁ±ªÁöÑÂÆû‰æã„ÄÇÁªìÊûÑ‰ΩìÂíåÊûö‰∏æÁ±ªÂûãÊòØÂÄºÁ±ªÂûãÔºå‰∏çÊòØÂºïÁî®Á±ªÂûãÔºå‰πü‰∏çÊòØÈÄöËøáÂºïÁî®ÁöÑÊñπÂºèÂ≠òÂÇ®Âíå‰º†ÈÄí„ÄÇ Ëß£ÂÜ≥ÂÆû‰æãÈó¥ÁöÑÂæ™ÁéØÂº∫ÂºïÁî®Swift Êèê‰æõ‰∫Ü‰∏§ÁßçÂäûÊ≥ïÁî®Êù•Ëß£ÂÜ≥‰Ω†Âú®‰ΩøÁî®Á±ªÁöÑÂ±ûÊÄßÊó∂ÊâÄÈÅáÂà∞ÁöÑÂæ™ÁéØÂº∫ÂºïÁî®ÈóÆÈ¢òÔºöÂº±ÂºïÁî®Ôºàweak referenceÔºâÂíåÊó†‰∏ªÂºïÁî®Ôºàunowned referenceÔºâ„ÄÇ ÂØπ‰∫éÁîüÂëΩÂë®Êúü‰∏≠‰ºöÂèò‰∏∫nilÁöÑÂÆû‰æã‰ΩøÁî®Âº±ÂºïÁî®„ÄÇÁõ∏ÂèçÂú∞ÔºåÂØπ‰∫éÂàùÂßãÂåñËµãÂÄºÂêéÂÜç‰πü‰∏ç‰ºöË¢´ËµãÂÄº‰∏∫nilÁöÑÂÆû‰æãÔºå‰ΩøÁî®Êó†‰∏ªÂºïÁî®„ÄÇ Âº±ÂºïÁî®Âú®ÂÆû‰æãÁöÑÁîüÂëΩÂë®Êúü‰∏≠ÔºåÂ¶ÇÊûúÊüê‰∫õÊó∂ÂÄôÂºïÁî®Ê≤°ÊúâÂÄºÔºåÈÇ£‰πàÂº±ÂºïÁî®ÂèØ‰ª•ÈÅøÂÖçÂæ™ÁéØÂº∫ÂºïÁî®„ÄÇ Âº±ÂºïÁî®ÂøÖÈ°ªË¢´Â£∞Êòé‰∏∫ÂèòÈáèÔºåË°®ÊòéÂÖ∂ÂÄºËÉΩÂú®ËøêË°åÊó∂Ë¢´‰øÆÊîπ„ÄÇÂº±ÂºïÁî®‰∏çËÉΩË¢´Â£∞Êòé‰∏∫Â∏∏Èáè„ÄÇ Âº±ÂºïÁî®Âè™ËÉΩ‰øÆÈ•∞Á±ªÂØπË±°Ôºå‰∏çËÉΩ‰øÆÈ•∞ÂºïÁî®‰º†ÈÄíÂØπË±°ÔºåÂç≥Á±ªÂØπË±°Ôºå‰∏çËÉΩ‰øÆÈ•∞ÂÄº‰º†ÈÄíÂºïÁî®ÔºåÂç≥‰∏çËÉΩ‰øÆÈ•∞Âü∫Êú¨Á±ªÂûãÔºåÁªìÊûÑ‰ΩìÔºåÊï∞ÁªÑÁ≠â„ÄÇ(Ê∂âÂèäÂà∞ÂºïÁî®‰∫ÜÔºåËÇØÂÆöÊòØË¶Å‰øÆÈ•∞ÂºïÁî®‰º†ÈÄíÂØπË±°Âïä) Âõ†‰∏∫Âº±ÂºïÁî®ÂèØ‰ª•Ê≤°ÊúâÂÄºÔºå‰Ω†ÂøÖÈ°ªÂ∞ÜÊØè‰∏Ä‰∏™Âº±ÂºïÁî®Â£∞Êòé‰∏∫ÂèØÈÄâÁ±ªÂûã„ÄÇÂõ†‰∏∫Âº±ÂºïÁî®‰∏ç‰ºö‰øùÊåÅÊâÄÂºïÁî®ÁöÑÂÆû‰æãÔºåÂç≥‰ΩøÂºïÁî®Â≠òÂú®ÔºåÂÆû‰æã‰πüÊúâÂèØËÉΩË¢´ÈîÄÊØÅ„ÄÇÂõ†Ê≠§ÔºåARC ‰ºöÂú®ÂºïÁî®ÁöÑÂÆû‰æãË¢´ÈîÄÊØÅÂêéËá™Âä®Â∞ÜÂÖ∂ËµãÂÄº‰∏∫nil„ÄÇ‰Ω†ÂèØ‰ª•ÂÉèÂÖ∂‰ªñÂèØÈÄâÂÄº‰∏ÄÊ†∑ÔºåÊ£ÄÊü•Âº±ÂºïÁî®ÁöÑÂÄºÊòØÂê¶Â≠òÂú®Ôºå‰Ω†Â∞ÜÊ∞∏Ëøú‰∏ç‰ºöËÆøÈóÆÂ∑≤ÈîÄÊØÅÁöÑÂÆû‰æãÁöÑÂºïÁî®„ÄÇ Âº±ÂºïÁî®ÁöÑÂ£∞ÊòéÂú®ÂèòÈáèÂâçÂä†‰∏ä weak ÂÖ≥ÈîÆÂ≠óÔºö 123456class Apartment &#123; let unit: String init(unit: String) &#123; self.unit = unit &#125; weak var tenant: Person? deinit &#123; print("Apartment \(unit) is being deinitialized") &#125;&#125; Êó†‰∏ªÂºïÁî®ÂíåÂº±ÂºïÁî®Á±ª‰ººÔºåÊó†‰∏ªÂºïÁî®‰∏ç‰ºöÁâ¢Áâ¢‰øùÊåÅ‰ΩèÂºïÁî®ÁöÑÂÆû‰æã„ÄÇÂíåÂº±ÂºïÁî®‰∏çÂêåÁöÑÊòØÔºåÊó†‰∏ªÂºïÁî®ÊòØÊ∞∏ËøúÊúâÂÄºÁöÑ„ÄÇÂõ†Ê≠§ÔºåÊó†‰∏ªÂºïÁî®ÊÄªÊòØË¢´ÂÆö‰πâ‰∏∫ÈùûÂèØÈÄâÁ±ªÂûãÔºànon-optional typeÔºâ„ÄÇ‰Ω†ÂèØ‰ª•Âú®Â£∞ÊòéÂ±ûÊÄßÊàñËÄÖÂèòÈáèÊó∂ÔºåÂú®ÂâçÈù¢Âä†‰∏äÂÖ≥ÈîÆÂ≠óunownedË°®Á§∫ËøôÊòØ‰∏Ä‰∏™Êó†‰∏ªÂºïÁî®„ÄÇ Áî±‰∫éÊó†‰∏ªÂºïÁî®ÊòØÈùûÂèØÈÄâÁ±ªÂûãÔºå‰Ω†‰∏çÈúÄË¶ÅÂú®‰ΩøÁî®ÂÆÉÁöÑÊó∂ÂÄôÂ∞ÜÂÆÉÂ±ïÂºÄ„ÄÇÊó†‰∏ªÂºïÁî®ÊÄªÊòØÂèØ‰ª•Ë¢´Áõ¥Êé•ËÆøÈóÆ„ÄÇ‰∏çËøá ARC Êó†Ê≥ïÂú®ÂÆû‰æãË¢´ÈîÄÊØÅÂêéÂ∞ÜÊó†‰∏ªÂºïÁî®ËÆæ‰∏∫nilÔºåÂõ†‰∏∫ÈùûÂèØÈÄâÁ±ªÂûãÁöÑÂèòÈáè‰∏çÂÖÅËÆ∏Ë¢´ËµãÂÄº‰∏∫nil„ÄÇ Â¶ÇÊûú‰Ω†ËØïÂõæÂú®ÂÆû‰æãË¢´ÈîÄÊØÅÂêéÔºåËÆøÈóÆËØ•ÂÆû‰æãÁöÑÊó†‰∏ªÂºïÁî®Ôºå‰ºöËß¶ÂèëËøêË°åÊó∂ÈîôËØØ„ÄÇ‰ΩøÁî®Êó†‰∏ªÂºïÁî®Ôºå‰Ω†ÂøÖÈ°ªÁ°Æ‰øùÂºïÁî®ÂßãÁªàÊåáÂêë‰∏Ä‰∏™Êú™ÈîÄÊØÅÁöÑÂÆû‰æã„ÄÇ(A ‰∏≠Êúâ‰∏Ä‰∏™Â±ûÊÄß B‰∏∫Êó†‰∏ªÂºïÁî®ÔºåÈÇ£‰πàÂ∞±Ë¶ÅÁ°Æ‰øù B Ê≤°ÊúâË¢´ÂõûÊî∂) Êó†‰∏ªÂ∫îÁî®‰πüÂè™ËÉΩ‰øÆÈ•∞ÂºïÁî®‰º†ÈÄíÂØπË±° Êó†‰∏ªÂºïÁî®‰ª•ÂèäÈöêÂºèËß£ÊûêÂèØÈÄâÂ±ûÊÄß‰∏äÈù¢Âº±ÂºïÁî®ÂíåÊó†‰∏ªÂºïÁî®ÁöÑ‰æãÂ≠êÊ∂µÁõñ‰∫Ü‰∏§ÁßçÂ∏∏Áî®ÁöÑÈúÄË¶ÅÊâìÁ†¥Âæ™ÁéØÂº∫ÂºïÁî®ÁöÑÂú∫ÊôØ„ÄÇ ‰∏§‰∏™Â±ûÊÄßÁöÑÂÄºÈÉΩÂÖÅËÆ∏‰∏∫nilÔºåÂπ∂‰ºöÊΩúÂú®ÁöÑ‰∫ßÁîüÂæ™ÁéØÂº∫ÂºïÁî®„ÄÇËøôÁßçÂú∫ÊôØÊúÄÈÄÇÂêàÁî®Âº±ÂºïÁî®Êù•Ëß£ÂÜ≥„ÄÇ‰∏Ä‰∏™Â±ûÊÄßÁöÑÂÄºÂÖÅËÆ∏‰∏∫nilÔºåËÄåÂè¶‰∏Ä‰∏™Â±ûÊÄßÁöÑÂÄº‰∏çÂÖÅËÆ∏‰∏∫nilÔºåËøô‰πüÂèØËÉΩ‰ºö‰∫ßÁîüÂæ™ÁéØÂº∫ÂºïÁî®„ÄÇËøôÁßçÂú∫ÊôØÊúÄÈÄÇÂêàÈÄöËøáÊó†‰∏ªÂºïÁî®Êù•Ëß£ÂÜ≥„ÄÇ ÁÑ∂ËÄåÔºåÂ≠òÂú®ÁùÄÁ¨¨‰∏âÁßçÂú∫ÊôØÔºåÂú®ËøôÁßçÂú∫ÊôØ‰∏≠Ôºå‰∏§‰∏™Â±ûÊÄßÈÉΩÂøÖÈ°ªÊúâÂÄºÔºåÂπ∂‰∏îÂàùÂßãÂåñÂÆåÊàêÂêéÊ∞∏Ëøú‰∏ç‰ºö‰∏∫nil„ÄÇÂú®ËøôÁßçÂú∫ÊôØ‰∏≠ÔºåÈúÄË¶Å‰∏Ä‰∏™Á±ª‰ΩøÁî®Êó†‰∏ªÂ±ûÊÄßÔºåËÄåÂè¶Â§ñ‰∏Ä‰∏™Á±ª‰ΩøÁî®ÈöêÂºèËß£ÊûêÂèØÈÄâÂ±ûÊÄß„ÄÇ ÈùûÂèØÈÄâ A Âíå ÈùûÂèØÈÄâ B Áõ∏‰∫íÂºïÁî®Ôºå‰ΩÜÊòØÁî±‰∫é‚Äú‰∏§ÊÆµÂºèÊûÑÈÄ†ËøáÁ®ã‚ÄùÔºåÊØîÂ¶ÇË¶ÅÂàùÂßãÂåñ AÔºåÈÇ£‰πàÂøÖÈ°ªË¶ÅÂÖàÂàùÂßãÂåñBÔºå‰ΩÜÊòØBË¶ÅÂàùÂßãÂåñÂÆåÊàêÂøÖÈ°ªÂÖàÂàùÂßãÂåñAÔºåËøôÂ∞±ÂÉèÊ≠ªÈîÅ‰∏ÄÊ†∑„ÄÇÊâÄ‰ª•‰∏∫‰∫ÜÊâìÁ†¥ËøôÁßçÂæ™ÁéØÔºåÂøÖÈ°ªÁî®ÈöêÂºèÂèØÈÄâÂ±ûÊÄßÔºåÊó¢ËÉΩË°®Á§∫‰∏çËÉΩ‰∏∫Á©∫ÔºåÂèàËÉΩ‰∏çÂΩ±ÂìçÂàùÂßãÂåñÁöÑËøõË°å„ÄÇ 123456789101112131415161718192021class Country &#123; let name: String var capitalCity: City! init(name: String, capitalName: String) &#123; self.name = name self.capitalCity = City(name: capitalName, country: self) &#125;&#125;class City &#123; let name: String unowned let country: Country init(name: String, country: Country) &#123; self.name = name self.country = country &#125;&#125;var country = Country(name: "Canada", capitalName: "Ottawa")print("\(country.name)'s capital city is called \(country.capitalCity.name)")// ÊâìÂç∞ ‚ÄúCanada's capital city is called Ottawa‚Äù ‰∏äÈù¢Â¶ÇÊûú‰ΩøÁî®Êó†‰∏ªÂºïÁî®ÔºåÊó†‰∏ªÂºïÁî®ÊòØÂ∏∏ÈáèÁ±ªÂûãÔºåÂπ∂‰∏îÂØπË±°ÂøÖÈ°ªË¶ÅÂú®ÂÖ∂ÂÜÖÈÉ®Â∏∏ÈáèÂ±ûÊÄßÈÉΩÊúâ‰∫ÜÂàùÂÄº‰πãÂêéÊâçËÉΩ‰ΩøÁî® self Â±ûÊÄßÔºåÊâÄ‰ª• country:self Â∞±‰ºö‰∫ßÁîüÂºÇÂ∏∏„ÄÇÂøÖÈ°ªË¶Å‰ΩøÁî®ÂèòÈáèÁ±ªÂûãÊù•Êõø‰ª£ÂéüÊù•ÁöÑÊó†‰∏ªÂºïÁî®„ÄÇ Êó†‰∏ªÂºïÁî®ÂíåÈöêÂºèËß£ÊûêÁöÑÂå∫Âà´Âú®‰∫éÔºåÊó†‰∏ªÂºïÁî®Ê∞∏Ëøú‰∏çËÉΩ‰∏∫ nilÔºåËÄåÈöêÂºèËß£ÊûêÂÄºË¶Å‰øùËØÅÁî®Âà∞ÁöÑÊó∂ÂÄô‰∏ç‰∏∫ nil Èó≠ÂåÖÂºïËµ∑ÁöÑÂæ™ÁéØÂº∫ÂºïÁî®Ëøô‰∏™Èó≠ÂåÖ‰Ωì‰∏≠ÂèØËÉΩËÆøÈóÆ‰∫ÜÂÆû‰æãÁöÑÊüê‰∏™Â±ûÊÄßÔºå‰æãÂ¶Çself.somePropertyÔºåÊàñËÄÖÈó≠ÂåÖ‰∏≠Ë∞ÉÁî®‰∫ÜÂÆû‰æãÁöÑÊüê‰∏™ÊñπÊ≥ïÔºå‰æãÂ¶Çself.someMethod()„ÄÇËøô‰∏§ÁßçÊÉÖÂÜµÈÉΩÂØºËá¥‰∫ÜÈó≠ÂåÖ‚ÄúÊçïËé∑‚ÄùselfÔºå‰ªéËÄå‰∫ßÁîü‰∫ÜÂæ™ÁéØÂº∫ÂºïÁî®: 1234567891011121314151617181920212223class HTMLElement &#123; let name: String let text: String? lazy var asHTML: () -&gt; String = &#123; if let text = self.text &#123; return "&lt;\(self.name)&gt;\(text)&lt;/\(self.name)&gt;" &#125; else &#123; return "&lt;\(self.name) /&gt;" &#125; &#125; init(name: String, text: String? = nil) &#123; self.name = name self.text = text &#125; deinit &#123; print("\(name) is being deinitialized") &#125;&#125; asHTMLÂ£∞Êòé‰∏∫lazyÂ±ûÊÄßÔºåÂõ†‰∏∫Âè™ÊúâÂΩìÂÖÉÁ¥†Á°ÆÂÆûÈúÄË¶ÅË¢´Â§ÑÁêÜ‰∏∫ HTML ËæìÂá∫ÁöÑÂ≠óÁ¨¶‰∏≤Êó∂ÔºåÊâçÈúÄË¶Å‰ΩøÁî®asHTML„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂú®ÈªòËÆ§ÁöÑÈó≠ÂåÖ‰∏≠ÂèØ‰ª•‰ΩøÁî®selfÔºåÂõ†‰∏∫Âè™ÊúâÂΩìÂàùÂßãÂåñÂÆåÊàê‰ª•ÂèäselfÁ°ÆÂÆûÂ≠òÂú®ÂêéÔºåÊâçËÉΩËÆøÈóÆlazyÂ±ûÊÄß„ÄÇÂ¶ÇÊûúÊ≤°Êúâ lazy ‰øÆÈ•∞ÔºåÈÇ£‰πàÊòØ‰∏çËÉΩÁºñËØëÈÄöËøáÁöÑ„ÄÇ Ëß£ÂÜ≥Èó≠ÂåÖÂºïËµ∑ÁöÑÂæ™ÁéØÂº∫ÂºïÁî®Ëé∑ÂàóË°®‰∏≠ÁöÑÊØè‰∏ÄÈ°πÈÉΩÁî±‰∏ÄÂØπÂÖÉÁ¥†ÁªÑÊàêÔºå‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØweakÊàñunownedÂÖ≥ÈîÆÂ≠óÔºåÂè¶‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØÁ±ªÂÆû‰æãÁöÑÂºïÁî®Ôºà‰æãÂ¶ÇselfÔºâÊàñÂàùÂßãÂåñËøáÁöÑÂèòÈáèÔºàÂ¶Çdelegate = self.delegate!Ôºâ„ÄÇËøô‰∫õÈ°πÂú®ÊñπÊã¨Âè∑‰∏≠Áî®ÈÄóÂè∑ÂàÜÂºÄ„ÄÇ Â¶ÇÊûúÈó≠ÂåÖÊúâÂèÇÊï∞ÂàóË°®ÂíåËøîÂõûÁ±ªÂûãÔºåÊääÊçïËé∑ÂàóË°®ÊîæÂú®ÂÆÉ‰ª¨ÂâçÈù¢Ôºö 1234lazy var someClosure: (Int, String) -&gt; String = &#123; [unowned self, weak delegate = self.delegate!] (index, stringToProcess) in // ËøôÈáåÊòØÈó≠ÂåÖÁöÑÂáΩÊï∞‰Ωì&#125; ‰∏äÈù¢Èó≠ÂåÖÁöÑÂèÇÊï∞Á±ªÂûãÁî±‰∫éÂèØ‰ª•ÈÄöËøáÁ±ªÂûãÊé®Êñ≠ÂæóÂà∞ÔºåÂõ†Ê≠§ÈÉΩÁúÅÁï•‰∫Ü„ÄÇÂ¶ÇÊûúÈó≠ÂåÖÊ≤°ÊúâÊåáÊòéÂèÇÊï∞ÂàóË°®ÔºåÈÇ£‰πàÂèØ‰ª•ÊääÊçïËé∑ÂàóË°®ÂíåÂÖ≥ÈîÆÂ≠óinÊîæÂú®Èó≠ÂåÖÊúÄÂºÄÂßãÁöÑÂú∞ÊñπÔºö 1234lazy var someClosure: () -&gt; String = &#123; [unowned self, weak delegate = self.delegate!] in // closure body goes here&#125; ÂèØÈÄâÈìæÂºèË∞ÉÁî®ÂèØÈÄâÈìæÂºèË∞ÉÁî®ÔºàOptional ChainingÔºâÊòØ‰∏ÄÁßçÂèØ‰ª•Âú®ÂΩìÂâçÂÄºÂèØËÉΩ‰∏∫nilÁöÑÂèØÈÄâÂÄº‰∏äËØ∑Ê±ÇÂíåË∞ÉÁî®Â±ûÊÄß„ÄÅÊñπÊ≥ïÂèä‰∏ãÊ†áÁöÑÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÂèØÈÄâÂÄºÊúâÂÄºÔºåÈÇ£‰πàË∞ÉÁî®Â∞±‰ºöÊàêÂäüÔºõÂ¶ÇÊûúÂèØÈÄâÂÄºÊòØnilÔºåÈÇ£‰πàË∞ÉÁî®Â∞ÜËøîÂõûnil„ÄÇÂ§ö‰∏™Ë∞ÉÁî®ÂèØ‰ª•ËøûÊé•Âú®‰∏ÄËµ∑ÂΩ¢Êàê‰∏Ä‰∏™Ë∞ÉÁî®ÈìæÔºåÂ¶ÇÊûúÂÖ∂‰∏≠‰ªª‰Ωï‰∏Ä‰∏™ËäÇÁÇπ‰∏∫nilÔºåÊï¥‰∏™Ë∞ÉÁî®ÈìæÈÉΩ‰ºöÂ§±Ë¥•ÔºåÂç≥ËøîÂõûnil„ÄÇ ‰ΩøÁî®ÂèØÈÄâÈìæÂºèË∞ÉÁî®‰ª£ÊõøÂº∫Âà∂Â±ïÂºÄÈÄöËøáÂú®ÊÉ≥Ë∞ÉÁî®ÁöÑÂ±ûÊÄß„ÄÅÊñπÊ≥ï„ÄÅÊàñ‰∏ãÊ†áÁöÑÂèØÈÄâÂÄºÔºàoptional valueÔºâÂêéÈù¢Êîæ‰∏Ä‰∏™ÈóÆÂè∑Ôºà?ÔºâÔºåÂèØ‰ª•ÂÆö‰πâ‰∏Ä‰∏™ÂèØÈÄâÈìæ„ÄÇËøô‰∏ÄÁÇπÂæàÂÉèÂú®ÂèØÈÄâÂÄºÂêéÈù¢Êîæ‰∏Ä‰∏™ÂèπÂè∑Ôºà!ÔºâÊù•Âº∫Âà∂Â±ïÂºÄÂÆÉÁöÑÂÄº„ÄÇÂÆÉ‰ª¨ÁöÑ‰∏ªË¶ÅÂå∫Âà´Âú®‰∫éÂΩìÂèØÈÄâÂÄº‰∏∫Á©∫Êó∂ÂèØÈÄâÈìæÂºèË∞ÉÁî®Âè™‰ºöË∞ÉÁî®Â§±Ë¥•ÔºåÁÑ∂ËÄåÂº∫Âà∂Â±ïÂºÄÂ∞Ü‰ºöËß¶ÂèëËøêË°åÊó∂ÈîôËØØ„ÄÇ ÂèØÈÄâÈìæÂºèË∞ÉÁî®ÁöÑËøîÂõûÁªìÊûú‰∏éÂéüÊú¨ÁöÑËøîÂõûÁªìÊûúÂÖ∑ÊúâÁõ∏ÂêåÁöÑÁ±ªÂûãÔºå‰ΩÜÊòØË¢´ÂåÖË£ÖÊàê‰∫Ü‰∏Ä‰∏™ÂèØÈÄâÂÄº„ÄÇ‰æãÂ¶ÇÔºå‰ΩøÁî®ÂèØÈÄâÈìæÂºèË∞ÉÁî®ËÆøÈóÆÂ±ûÊÄßÔºåÂΩìÂèØÈÄâÈìæÂºèË∞ÉÁî®ÊàêÂäüÊó∂ÔºåÂ¶ÇÊûúÂ±ûÊÄßÂéüÊú¨ÁöÑËøîÂõûÁªìÊûúÊòØIntÁ±ªÂûãÔºåÂàô‰ºöÂèò‰∏∫Int?Á±ªÂûã„ÄÇ ‰∏ãÈù¢ÁöÑ‰æãÂ≠êÂæàÊ∏ÖÊ•öÊ¥ªÂëΩÂèØÈÄâÈìæÂºèË∞ÉÁî®Ôºö 12345678910111213141516171819class Person &#123; var residence: Residence?&#125;class Residence &#123; var numberOfRooms = 1&#125;let john = Person()let roomCount = john.residence!.numberOfRooms// Ëøô‰ºöÂºïÂèëËøêË°åÊó∂ÈîôËØØif let roomCount = john.residence?.numberOfRooms &#123; print("John's residence has \(roomCount) room(s).")&#125; else &#123; print("Unable to retrieve the number of rooms.")&#125;// Prints "John's residence has 1 room(s)." ‰∏çÂè™ÊòØÂ±ûÊÄßÔºåÊñπÊ≥ïÂíå‰∏ãÊ†á‰πüÊòØÂèØÈÄâÈìæÂºèË∞ÉÁî®ÁöÑ„ÄÇ ËøûÊé•Â§öÂ±ÇÂèØÈÄâÈìæÂºèË∞ÉÁî®ÊúâÊó∂ÂÄô‰ºöÂµåÂ•ó‰ΩøÁî®ÔºåÂ¶ÇÔºö 123456if let johnsStreet = john.residence?.address?.street &#123; print("John's street name is \(johnsStreet).")&#125; else &#123; print("Unable to retrieve the address.")&#125;// ÊâìÂç∞ ‚ÄúUnable to retrieve the address.‚Äù ËøîÂõûÁöÑ‰ªçÁÑ∂ÊòØ String? ËÄå‰∏çÊòØ String?? Âú®ÊñπÊ≥ïÁöÑÂèØÈÄâËøîÂõûÂÄº‰∏äËøõË°åÂèØÈÄâÈìæÂºèË∞ÉÁî®Â¶ÇÊûúË¶ÅÂú®ÊñπÊ≥ïÁöÑËøîÂõûÂÄº‰∏äËøõË°åÂèØÈÄâÈìæÂºèË∞ÉÁî®ÔºåÂú®ÊñπÊ≥ïÁöÑÂúÜÊã¨Âè∑ÂêéÈù¢Âä†‰∏äÈóÆÂè∑Âç≥ÂèØÔºö 123456789if let beginsWithThe = john.residence?.address?.buildingIdentifier()?.hasPrefix("The") &#123; if beginsWithThe &#123; print("John's building identifier begins with \"The\".") &#125; else &#123; print("John's building identifier does not begin with \"The\".") &#125;&#125;// ÊâìÂç∞ ‚ÄúJohn's building identifier begins with "The".‚Äù ÈîôËØØÂ§ÑÁêÜË°®Á§∫Âπ∂ÊäõÂá∫ÈîôËØØÂú® Swift ‰∏≠ÔºåÈîôËØØÁî®Á¨¶ÂêàErrorÂçèËÆÆÁöÑÁ±ªÂûãÁöÑÂÄºÊù•Ë°®Á§∫„ÄÇËøô‰∏™Á©∫ÂçèËÆÆË°®ÊòéËØ•Á±ªÂûãÂèØ‰ª•Áî®‰∫éÈîôËØØÂ§ÑÁêÜ„ÄÇ 1234567enum VendingMachineError: Error &#123; case invalidSelection case insufficientFunds(coinsNeeded: Int) case outOfStock&#125;throw VendingMachineError.insufficientFunds(coinsNeeded: 5) ËøôÈáåÊûö‰∏æ‰∏≠ÁöÑ coninsNeeded Â∞±ÊòØÂâçÈù¢ËÆ≤Êûö‰∏æÁöÑÊó∂ÂÄôÁöÑÂÖ≥ËÅîÂÄºÔºåÂè™ÊòØËÆæÁΩÆ‰∫ÜÂèÇÊï∞ÂêçÔºåÊØîÂ¶Ç‰∏ãÈù¢Êûö‰∏æÁöÑÂÖÉÁªÑÊÉÖÂÜµÂèØËÉΩ‰ºöÁî®Âà∞ Á±ªÂûãËΩ¨Êç¢Á±ªÂûãÊ£ÄÊü•Áî®Á±ªÂûãÊ£ÄÊü•Êìç‰ΩúÁ¨¶ÔºàisÔºâÊù•Ê£ÄÊü•‰∏Ä‰∏™ÂÆû‰æãÊòØÂê¶Â±û‰∫éÁâπÂÆöÂ≠êÁ±ªÂûã„ÄÇËã•ÂÆû‰æãÂ±û‰∫éÈÇ£‰∏™Â≠êÁ±ªÂûãÔºåÁ±ªÂûãÊ£ÄÊü•Êìç‰ΩúÁ¨¶ËøîÂõû trueÔºåÂê¶ÂàôËøîÂõû false„ÄÇ 1234567for item in library &#123; if item is Movie &#123; movieCount += 1 &#125; else if item is Song &#123; songCount += 1 &#125;&#125; ËøôÈáåÂè™Êà™Âèñ‰∫Ü‰ª£Á†ÅÁöÑÈÉ®ÂàÜ„ÄÇÊºîÁ§∫‰∫Ü is ÁöÑÁî®Ê≥ï„ÄÇ Á±ªÂûãËΩ¨Êç¢Áî®Á±ªÂûãËΩ¨Âåñ‰Ω†Êìç‰ΩúÁ¨¶ as Êù•ËΩ¨Êç¢Á±ªÂûã„ÄÇ as Â∫îÁî®Êù°‰ª∂Êúâ2ÁßçÊÉÖÂÜµÔºö Âíå as Âè≥ËæπÁ±ªÂûã‰∏ÄËá¥ ÊòØÂè≥ËæπÁ±ªÂûãÁöÑÂ≠êÁ±ª(Âêë‰∏äËΩ¨Âûã) Âêë‰∏ãËΩ¨ÂûãÊüêÁ±ªÂûãÁöÑ‰∏Ä‰∏™Â∏∏ÈáèÊàñÂèòÈáèÂèØËÉΩÂú®ÂπïÂêéÂÆûÈôÖ‰∏äÂ±û‰∫é‰∏Ä‰∏™Â≠êÁ±ª„ÄÇÂΩìÁ°ÆÂÆöÊòØËøôÁßçÊÉÖÂÜµÊó∂Ôºå‰Ω†ÂèØ‰ª•Â∞ùËØïÂêë‰∏ãËΩ¨Âà∞ÂÆÉÁöÑÂ≠êÁ±ªÂûãÔºåÁî®Á±ªÂûãËΩ¨Êç¢Êìç‰ΩúÁ¨¶Ôºàas? Êàñ as!Ôºâ„ÄÇ Âõ†‰∏∫Âêë‰∏ãËΩ¨ÂûãÂèØËÉΩ‰ºöÂ§±Ë¥•ÔºåÁ±ªÂûãËΩ¨ÂûãÊìç‰ΩúÁ¨¶Â∏¶Êúâ‰∏§Áßç‰∏çÂêåÂΩ¢Âºè„ÄÇÊù°‰ª∂ÂΩ¢ÂºèÔºàconditional formÔºâas? ËøîÂõû‰∏Ä‰∏™‰Ω†ËØïÂõæÂêë‰∏ãËΩ¨ÊàêÁöÑÁ±ªÂûãÁöÑÂèØÈÄâÂÄºÔºàoptional valueÔºâ„ÄÇÂº∫Âà∂ÂΩ¢Âºè as! ÊääËØïÂõæÂêë‰∏ãËΩ¨ÂûãÂíåÂº∫Âà∂Ëß£ÂåÖÔºàforce-unwrapsÔºâËΩ¨Êç¢ÁªìÊûúÁªìÂêà‰∏∫‰∏Ä‰∏™Êìç‰Ωú„ÄÇ Âú®Ëøô‰∏™Á§∫‰æã‰∏≠ÔºåÊï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ item ÂèØËÉΩÊòØ Movie Êàñ Song„ÄÇ‰∫ãÂâç‰Ω†‰∏çÁü•ÈÅìÊØè‰∏™ item ÁöÑÁúüÂÆûÁ±ªÂûãÔºåÊâÄ‰ª•ËøôÈáå‰ΩøÁî®Êù°‰ª∂ÂΩ¢ÂºèÁöÑÁ±ªÂûãËΩ¨Êç¢Ôºàas?ÔºâÂéªÊ£ÄÊü•Âæ™ÁéØÈáåÁöÑÊØèÊ¨°‰∏ãËΩ¨Ôºö 12345678910111213for item in library &#123; if let movie = item as? Movie &#123; print("Movie: '\(movie.name)', dir. \(movie.director)") &#125; else if let song = item as? Song &#123; print("Song: '\(song.name)', by \(song.artist)") &#125;&#125;// Movie: 'Casablanca', dir. Michael Curtiz// Song: 'Blue Suede Shoes', by Elvis Presley// Movie: 'Citizen Kane', dir. Orson Welles// Song: 'The One And Only', by Chesney Hawkes// Song: 'Never Gonna Give You Up', by Rick Astley Any Âíå AnyObject ÁöÑÁ±ªÂûãËΩ¨Êç¢Swift ‰∏∫‰∏çÁ°ÆÂÆöÁ±ªÂûãÊèê‰æõ‰∫Ü‰∏§ÁßçÁâπÊÆäÁöÑÁ±ªÂûãÂà´ÂêçÔºö AnyObject ÂèØ‰ª•Ë°®Á§∫‰ªª‰ΩïÁ±ªÁ±ªÂûãÁöÑÂÆû‰æã„ÄÇ Any ÂèØ‰ª•Ë°®Á§∫‰ªª‰ΩïÁ±ªÂûãÔºåÂåÖÊã¨ÂáΩÊï∞Á±ªÂûã„ÄÇ ‰æãÂ¶Ç‰∏ãÈù¢‰ΩøÁî® Any ÁöÑ‰æãÂ≠êÔºö 12345678910var things = [Any]() things.append(0)things.append(0.0)things.append(42)things.append(3.14159)things.append("hello")things.append((3.0, 5.0))things.append(Movie(name: "Ghostbusters", director: "Ivan Reitman"))things.append(&#123; (name: String) -&gt; String in "Hello, \(name)" &#125;) Áé∞Âú®ÁªìÂêà is Âíå as ‰ΩøÁî®Ôºö 123456789101112131415161718192021222324252627282930313233for thing in things &#123; switch thing &#123; case 0 as Int: print("zero as an Int") case 0 as Double: print("zero as a Double") case let someInt as Int: print("an integer value of \(someInt)") case let someDouble as Double where someDouble &gt; 0: print("a positive double value of \(someDouble)") case is Double: print("some other double value that I don't want to print") case let someString as String: print("a string value of \"\(someString)\"") case let (x, y) as (Double, Double): print("an (x, y) point at \(x), \(y)") case let movie as Movie: print("a movie called \(movie.name), dir. \(movie.director)") case let stringConverter as (String) -&gt; String: print(stringConverter("Michael")) default: print("something else") &#125;&#125; // zero as an Int// zero as a Double// an integer value of 42// a positive double value of 3.14159// a string value of "hello"// an (x, y) point at 3.0, 5.0// a movie called Ghostbusters, dir. Ivan Reitman// Hello, Michael case ËøòËÉΩÁî® is Á±ªÂûã Âà§Êñ≠ÊòØÊüê‰∏ÄÁ±ªÁ±ªÂûãÔºõlet xx as Á±ªÂûã Âà§Êñ≠ÊòØÊüê‰∏ÄÁßçÁ±ªÂûã„ÄÇ ÂéâÂÆ≥‰∫Ü ÂµåÂ•óÁ±ªÂûãÊûö‰∏æÂ∏∏Ë¢´Áî®‰∫é‰∏∫ÁâπÂÆöÁ±ªÊàñÁªìÊûÑ‰ΩìÂÆûÁé∞Êüê‰∫õÂäüËÉΩ„ÄÇÁ±ª‰ººÁöÑÔºåÊûö‰∏æÂèØ‰ª•Êñπ‰æøÁöÑÂÆö‰πâÂ∑•ÂÖ∑Á±ªÊàñÁªìÊûÑ‰ΩìÔºå‰ªéËÄå‰∏∫Êüê‰∏™Â§çÊùÇÁöÑÁ±ªÂûãÊâÄ‰ΩøÁî®„ÄÇ‰∏∫‰∫ÜÂÆûÁé∞ËøôÁßçÂäüËÉΩÔºåSwift ÂÖÅËÆ∏‰Ω†ÂÆö‰πâÂµåÂ•óÁ±ªÂûãÔºåÂèØ‰ª•Âú®ÊîØÊåÅÁöÑÁ±ªÂûã‰∏≠ÂÆö‰πâÂµåÂ•óÁöÑÊûö‰∏æ„ÄÅÁ±ªÂíåÁªìÊûÑ‰Ωì„ÄÇ Ë¶ÅÂú®‰∏Ä‰∏™Á±ªÂûã‰∏≠ÂµåÂ•óÂè¶‰∏Ä‰∏™Á±ªÂûãÔºåÂ∞ÜÂµåÂ•óÁ±ªÂûãÁöÑÂÆö‰πâÂÜôÂú®ÂÖ∂Â§ñÈÉ®Á±ªÂûãÁöÑ{}ÂÜÖÔºåËÄå‰∏îÂèØ‰ª•Ê†πÊçÆÈúÄË¶ÅÂÆö‰πâÂ§öÁ∫ßÂµåÂ•ó„ÄÇ ÂµåÂ•óÁ±ªÂûãÂÆûË∑µ12345678910111213141516171819202122232425262728293031323334353637383940struct BlackjackCard &#123; // ÂµåÂ•óÁöÑ Suit Êûö‰∏æ enum Suit: Character &#123; case Spades = "‚ô†", Hearts = "‚ô°", Diamonds = "‚ô¢", Clubs = "‚ô£" &#125; // ÂµåÂ•óÁöÑ Rank Êûö‰∏æ enum Rank: Int &#123; case Two = 2, Three, Four, Five, Six, Seven, Eight, Nine, Ten case Jack, Queen, King, Ace struct Values &#123; let first: Int, second: Int? &#125; var values: Values &#123; switch self &#123; case .Ace: return Values(first: 1, second: 11) case .Jack, .Queen, .King: return Values(first: 10, second: nil) default: return Values(first: self.rawValue, second: nil) &#125; &#125; &#125; // BlackjackCard ÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ï let rank: Rank, suit: Suit var description: String &#123; var output = "suit is \(suit.rawValue)," output += " value is \(rank.values.first)" if let second = rank.values.second &#123; output += " or \(second)" &#125; return output &#125;&#125;let theAceOfSpades = BlackjackCard(rank: .Ace, suit: .Spades)print("theAceOfSpades: \(theAceOfSpades.description)")// ÊâìÂç∞ ‚ÄútheAceOfSpades: suit is ‚ô†, value is 1 or 11‚Äù Ê≥®ÊÑèÁúãËøô‰∏™‰æãÂ≠êÁöÑÂ∫îÁî®ÈÉ®ÂàÜ„ÄÇÂ∞ΩÁÆ°RankÂíåSuitÂµåÂ•óÂú®BlackjackCard‰∏≠Ôºå‰ΩÜÂÆÉ‰ª¨ÁöÑÁ±ªÂûã‰ªçÂèØ‰ªé‰∏ä‰∏ãÊñá‰∏≠Êé®Êñ≠Âá∫Êù•ÔºåÊâÄ‰ª•Âú®ÂàùÂßãÂåñÂÆû‰æãÊó∂ËÉΩÂ§üÂçïÁã¨ÈÄöËøáÊàêÂëòÂêçÁß∞Ôºà.AceÂíå.SpadesÔºâÂºïÁî®Êûö‰∏æÂÆû‰æã„ÄÇ Â¶ÇÊûúÊ≤°ÊúâÁ±ªÂûãÊé®Êñ≠ÔºåÈúÄË¶ÅÂ∞Ü‰ª£Á†ÅË°•ÂÖ®ÁöÑËØùÔºåÈúÄË¶ÅÂÜôÊàêÔºöBlackjackCard.Rank.Ace ÁöÑÂΩ¢Âºè„ÄÇ ÂºïÁî®ÂµåÂ•óÁ±ªÂûãÂú®Â§ñÈÉ®ÂºïÁî®ÂµåÂ•óÁ±ªÂûãÊó∂ÔºåÂú®ÂµåÂ•óÁ±ªÂûãÁöÑÁ±ªÂûãÂêçÂâçÂä†‰∏äÂÖ∂Â§ñÈÉ®Á±ªÂûãÁöÑÁ±ªÂûãÂêç‰Ωú‰∏∫ÂâçÁºÄ„ÄÇÂ∞±Âíå‰∏äÈù¢ËØ¥ÁöÑ‰∏ÄÊ†∑Ôºö 12let heartsSymbol = BlackjackCard.Suit.Hearts.rawValue// Á∫¢ÂøÉÁ¨¶Âè∑‰∏∫ ‚Äú‚ô°‚Äù]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Swift 3.1 ËØ≠Ê≥ïÂ≠¶‰π†ÔºàÂõõÔºâ]]></title>
    <url>%2F2017%2F02%2F22%2Fswift%E8%AF%AD%E6%B3%954%2F</url>
    <content type="text"><![CDATA[Êé•ÁùÄ‰∏ä‰∏ÄÁØá ÁªßÊâøÂè™ÊúâÁ±ªÂèØ‰ª•Ë¢´ÁªßÊâøÔºåÁªìÊûÑ‰ΩìÂíåÊûö‰∏æ‰∏çËÉΩË¢´ÁªßÊâø ÂÆö‰πâ‰∏Ä‰∏™Âü∫Á±ª‰∏çÁªßÊâø‰∫éÂÖ∂ÂÆÉÁ±ªÁöÑÁ±ªÔºåÁß∞‰πã‰∏∫Âü∫Á±ª„ÄÇ 123456789class Vehicle &#123; var currentSpeed = 0.0 var description: String &#123; return "traveling at \(currentSpeed) miles per hour" &#125; func makeNoise() &#123; // ‰ªÄ‰πà‰πü‰∏çÂÅö-Âõ†‰∏∫ËΩ¶ËæÜ‰∏ç‰∏ÄÂÆö‰ºöÊúâÂô™Èü≥ &#125;&#125; Â≠êÁ±ªÁîüÊàê‰∏∫‰∫ÜÊåáÊòéÊüê‰∏™Á±ªÁöÑË∂ÖÁ±ªÔºåÂ∞ÜË∂ÖÁ±ªÂêçÂÜôÂú®Â≠êÁ±ªÂêçÁöÑÂêéÈù¢ÔºåÁî®ÂÜíÂè∑ÂàÜÈöîÔºö 123class SomeClass: SomeSuperclass &#123; // ËøôÈáåÊòØÂ≠êÁ±ªÁöÑÂÆö‰πâ&#125; ÁªßÊâø‰∏äÈù¢ÁöÑÂü∫Á±ªÔºö 123class Bicycle: Vehicle &#123; var hasBasket = false&#125; Èô§‰∫ÜÁªßÊâø‰∫Ü Vehicle ÁöÑÂ±ûÊÄßÂ§ñÔºåËøòÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ hasBasket Â±ûÊÄß„ÄÇ Âü∫Êú¨ÂíåÂÖ∂‰ªñËØ≠Ë®ÄÁöÑÁªßÊâøÊó†ÂºÇ„ÄÇ ÈáçÂÜôÂ¶ÇÊûúË¶ÅÈáçÂÜôÊüê‰∏™ÁâπÊÄßÔºå‰Ω†ÈúÄË¶ÅÂú®ÈáçÂÜôÂÆö‰πâÁöÑÂâçÈù¢Âä†‰∏äoverrideÂÖ≥ÈîÆÂ≠ó„ÄÇËøô‰πàÂÅöÔºå‰Ω†Â∞±Ë°®Êòé‰∫Ü‰Ω†ÊòØÊÉ≥Êèê‰æõ‰∏Ä‰∏™ÈáçÂÜôÁâàÊú¨ÔºåËÄåÈùûÈîôËØØÂú∞Êèê‰æõ‰∫Ü‰∏Ä‰∏™Áõ∏ÂêåÁöÑÂÆö‰πâ„ÄÇ‰ªª‰ΩïÁº∫Â∞ëoverrideÂÖ≥ÈîÆÂ≠óÁöÑÈáçÂÜôÈÉΩ‰ºöÂú®ÁºñËØëÊó∂Ë¢´ËØäÊñ≠‰∏∫ÈîôËØØ„ÄÇ overrideÂÖ≥ÈîÆÂ≠ó‰ºöÊèêÈÜí Swift ÁºñËØëÂô®ÂéªÊ£ÄÊü•ËØ•Á±ªÁöÑË∂ÖÁ±ªÔºàÊàñÂÖ∂‰∏≠‰∏Ä‰∏™Áà∂Á±ªÔºâÊòØÂê¶ÊúâÂåπÈÖçÈáçÂÜôÁâàÊú¨ÁöÑÂ£∞Êòé„ÄÇ ËÆøÈóÆË∂ÖÁ±ªÁöÑÊñπÊ≥ïÂ±ûÊÄßÂíå‰∏ãÊ†á‰ΩøÁî® super ÂÖ≥ÈîÆÂ≠ó„ÄÇ ÈáçÂÜôÂ±ûÊÄß‰Ω†ÂèØ‰ª•ÈáçÂÜôÁªßÊâøÊù•ÁöÑÂÆû‰æãÂ±ûÊÄßÊàñÁ±ªÂûãÂ±ûÊÄßÔºåÂú®Â±ûÊÄßÂâçÂä†‰∏ä override ÂÖ≥ÈîÆÂ≠óÔºåÊèê‰æõËá™Â∑±ÂÆöÂà∂ÁöÑ getter Âíå setterÔºåÊàñÊ∑ªÂä†Â±ûÊÄßËßÇÂØüÂô®‰ΩøÈáçÂÜôÁöÑÂ±ûÊÄßÂèØ‰ª•ËßÇÂØüÂ±ûÊÄßÂÄº‰ªÄ‰πàÊó∂ÂÄôÂèëÁîüÊîπÂèò„ÄÇ ÈáçÂÜôÂ±ûÊÄßÁöÑ Getters Âíå Setters‰Ω†ÂèØ‰ª•Êèê‰æõÂÆöÂà∂ÁöÑ getterÔºàÊàñ setterÔºâÊù•ÈáçÂÜô‰ªªÊÑèÁªßÊâøÊù•ÁöÑÂ±ûÊÄßÔºåÊó†ËÆ∫ÁªßÊâøÊù•ÁöÑÂ±ûÊÄßÊòØÂ≠òÂÇ®ÂûãÁöÑËøòÊòØËÆ°ÁÆóÂûãÁöÑÂ±ûÊÄß„ÄÇÂ≠êÁ±ªÂπ∂‰∏çÁü•ÈÅìÁªßÊâøÊù•ÁöÑÂ±ûÊÄßÊòØÂ≠òÂÇ®ÂûãÁöÑËøòÊòØËÆ°ÁÆóÂûãÁöÑÔºåÂÆÉÂè™Áü•ÈÅìÁªßÊâøÊù•ÁöÑÂ±ûÊÄß‰ºöÊúâ‰∏Ä‰∏™ÂêçÂ≠óÂíåÁ±ªÂûã„ÄÇ‰Ω†Âú®ÈáçÂÜô‰∏Ä‰∏™Â±ûÊÄßÊó∂ÔºåÂøÖÈúÄÂ∞ÜÂÆÉÁöÑÂêçÂ≠óÂíåÁ±ªÂûãÈÉΩÂÜôÂá∫Êù•„ÄÇËøôÊ†∑ÊâçËÉΩ‰ΩøÁºñËØëÂô®ÂéªÊ£ÄÊü•‰Ω†ÈáçÂÜôÁöÑÂ±ûÊÄßÊòØ‰∏éË∂ÖÁ±ª‰∏≠ÂêåÂêçÂêåÁ±ªÂûãÁöÑÂ±ûÊÄßÁõ∏ÂåπÈÖçÁöÑ„ÄÇ ‰Ω†ÂèØ‰ª•Â∞Ü‰∏Ä‰∏™ÁªßÊâøÊù•ÁöÑÂè™ËØªÂ±ûÊÄßÈáçÂÜô‰∏∫‰∏Ä‰∏™ËØªÂÜôÂ±ûÊÄßÔºåÂè™ÈúÄË¶ÅÂú®ÈáçÂÜôÁâàÊú¨ÁöÑÂ±ûÊÄßÈáåÊèê‰æõ getter Âíå setter Âç≥ÂèØ„ÄÇ‰ΩÜÊòØÔºå‰Ω†‰∏çÂèØ‰ª•Â∞Ü‰∏Ä‰∏™ÁªßÊâøÊù•ÁöÑËØªÂÜôÂ±ûÊÄßÈáçÂÜô‰∏∫‰∏Ä‰∏™Âè™ËØªÂ±ûÊÄß„ÄÇ Â¶ÇÊûú‰Ω†‰∏çÊÉ≥Âú®ÈáçÂÜôÁâàÊú¨‰∏≠ÁöÑ getter Èáå‰øÆÊîπÁªßÊâøÊù•ÁöÑÂ±ûÊÄßÂÄºÔºå‰Ω†ÂèØ‰ª•Áõ¥Êé•ÈÄöËøásuper.somePropertyÊù•ËøîÂõûÁªßÊâøÊù•ÁöÑÂÄºÔºåÂÖ∂‰∏≠somePropertyÊòØ‰Ω†Ë¶ÅÈáçÂÜôÁöÑÂ±ûÊÄßÁöÑÂêçÂ≠ó„ÄÇ ÈáçÂÜôÂ±ûÊÄßËßÇÂØüÂô®‰Ω†ÂèØ‰ª•ÈÄöËøáÈáçÂÜôÂ±ûÊÄß‰∏∫‰∏Ä‰∏™ÁªßÊâøÊù•ÁöÑÂ±ûÊÄßÊ∑ªÂä†Â±ûÊÄßËßÇÂØüÂô®„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÂΩìÁªßÊâøÊù•ÁöÑÂ±ûÊÄßÂÄºÂèëÁîüÊîπÂèòÊó∂Ôºå‰Ω†Â∞±‰ºöË¢´ÈÄöÁü•Âà∞ÔºåÊó†ËÆ∫ÈÇ£‰∏™Â±ûÊÄßÂéüÊú¨ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑ„ÄÇ 123456789101112class AutomaticCar: Car &#123; override var currentSpeed: Double &#123; didSet &#123; gear = Int(currentSpeed / 10.0) + 1 &#125; &#125;&#125;let automatic = AutomaticCar()automatic.currentSpeed = 35.0print("AutomaticCar: \(automatic.description)")// AutomaticCar: traveling at 35.0 miles per hour in gear 4 ÈáçÂÜôÁöÑÊòØÂ±ûÊÄßÁöÑÊñπÊ≥ïÔºåÈáçÂÜô‰∏çËÉΩÊîπÂèòÈùûËÆ°ÁÆóÂûãÂ±ûÊÄßÂéüÊúâÁöÑÂÄº„ÄÇÊâÄ‰ª•ÔºåÊØîÂ¶Ç‰∏äÈù¢ÁöÑ currentSpeed ‰∏çËÉΩËµãÂÄºÔºåÂõ†‰∏∫Áà∂Á±ª Car ÈáåÂ∑≤ÁªèÊúâËøô‰∏™Â±ûÊÄßÁöÑÂàùÂÄº‰∫Ü„ÄÇ Èò≤Ê≠¢ÈáçÂÜôÂèØ‰ª•ÈÄöËøáÊääÊñπÊ≥ïÔºåÂ±ûÊÄßÊàñ‰∏ãÊ†áÊ†áËÆ∞‰∏∫finalÊù•Èò≤Ê≠¢ÂÆÉ‰ª¨Ë¢´ÈáçÂÜôÔºåÂè™ÈúÄË¶ÅÂú®Â£∞ÊòéÂÖ≥ÈîÆÂ≠óÂâçÂä†‰∏äfinal‰øÆÈ•∞Á¨¶Âç≥ÂèØÔºà‰æãÂ¶ÇÔºöfinal varÔºåfinal funcÔºåfinal class funcÔºå‰ª•Âèäfinal subscriptÔºâ„ÄÇ ‰Ω†ÂèØ‰ª•ÈÄöËøáÂú®ÂÖ≥ÈîÆÂ≠óclassÂâçÊ∑ªÂä†final‰øÆÈ•∞Á¨¶Ôºàfinal classÔºâÊù•Â∞ÜÊï¥‰∏™Á±ªÊ†áËÆ∞‰∏∫ final ÁöÑ„ÄÇËøôÊ†∑ÁöÑÁ±ªÊòØ‰∏çÂèØË¢´ÁªßÊâøÁöÑÔºåËØïÂõæÁªßÊâøËøôÊ†∑ÁöÑÁ±ª‰ºöÂØºËá¥ÁºñËØëÊä•Èîô„ÄÇ ÊûÑÈÄ†ËøáÁ®ãÊûÑÈÄ†ËøáÁ®ãÊòØ‰ΩøÁî®Á±ª„ÄÅÁªìÊûÑ‰ΩìÊàñÊûö‰∏æÁ±ªÂûãÁöÑÂÆû‰æã‰πãÂâçÁöÑÂáÜÂ§áËøáÁ®ã„ÄÇÂú®Êñ∞ÂÆû‰æãÂèØÁî®ÂâçÂøÖÈ°ªÊâßË°åËøô‰∏™ËøáÁ®ãÔºåÂÖ∑‰ΩìÊìç‰ΩúÂåÖÊã¨ËÆæÁΩÆÂÆû‰æã‰∏≠ÊØè‰∏™Â≠òÂÇ®ÂûãÂ±ûÊÄßÁöÑÂàùÂßãÂÄºÂíåÊâßË°åÂÖ∂‰ªñÂøÖÈ°ªÁöÑËÆæÁΩÆÊàñÂàùÂßãÂåñÂ∑•‰Ωú„ÄÇ ÈÄöËøáÂÆö‰πâÊûÑÈÄ†Âô®ÔºàInitializersÔºâÊù•ÂÆûÁé∞ÊûÑÈÄ†ËøáÁ®ãÔºåËøô‰∫õÊûÑÈÄ†Âô®ÂèØ‰ª•ÁúãÂÅöÊòØÁî®Êù•ÂàõÂª∫ÁâπÂÆöÁ±ªÂûãÊñ∞ÂÆû‰æãÁöÑÁâπÊÆäÊñπÊ≥ï„ÄÇ‰∏é Objective-C ‰∏≠ÁöÑÊûÑÈÄ†Âô®‰∏çÂêåÔºåSwift ÁöÑÊûÑÈÄ†Âô®Êó†ÈúÄËøîÂõûÂÄº„ÄÇ Á±ªÁöÑÂÆû‰æã‰πüÂèØ‰ª•ÈÄöËøáÂÆö‰πâÊûêÊûÑÂô®ÔºàdeinitializerÔºâÂú®ÂÆû‰æãÈáäÊîæ‰πãÂâçÊâßË°åÁâπÂÆöÁöÑÊ∏ÖÈô§Â∑•‰Ωú„ÄÇ Â≠òÂÇ®Â±ûÊÄßÂàùÂßãËµãÂÄºÁ±ªÂíåÁªìÊûÑ‰ΩìÂú®ÂàõÂª∫ÂÆû‰æãÊó∂ÔºåÂøÖÈ°ª‰∏∫ÊâÄÊúâÂ≠òÂÇ®ÂûãÂ±ûÊÄßËÆæÁΩÆÂêàÈÄÇÁöÑÂàùÂßãÂÄº„ÄÇÂ≠òÂÇ®ÂûãÂ±ûÊÄßÁöÑÂÄº‰∏çËÉΩÂ§Ñ‰∫é‰∏Ä‰∏™Êú™Áü•ÁöÑÁä∂ÊÄÅ„ÄÇ‰Ω†ÂèØ‰ª•Âú®ÊûÑÈÄ†Âô®‰∏≠‰∏∫Â≠òÂÇ®ÂûãÂ±ûÊÄßËµãÂàùÂÄºÔºå‰πüÂèØ‰ª•Âú®ÂÆö‰πâÂ±ûÊÄßÊó∂‰∏∫ÂÖ∂ËÆæÁΩÆÈªòËÆ§ÂÄº„ÄÇ Ê≥®ÊÑèÔºåÂΩì‰Ω†‰∏∫Â≠òÂÇ®ÂûãÂ±ûÊÄßËÆæÁΩÆÈªòËÆ§ÂÄºÊàñËÄÖÂú®ÊûÑÈÄ†Âô®‰∏≠‰∏∫ÂÖ∂ËµãÂÄºÊó∂ÔºåÂÆÉ‰ª¨ÁöÑÂÄºÊòØË¢´Áõ¥Êé•ËÆæÁΩÆÁöÑÔºå‰∏ç‰ºöËß¶Âèë‰ªª‰ΩïÂ±ûÊÄßËßÇÂØüËÄÖÔºàproperty observersÔºâ„ÄÇ ÊûÑÈÄ†Âô®ÊûÑÈÄ†Âô®Âú®ÂàõÂª∫Êüê‰∏™ÁâπÂÆöÁ±ªÂûãÁöÑÊñ∞ÂÆû‰æãÊó∂Ë¢´Ë∞ÉÁî®„ÄÇÂÆÉÁöÑÊúÄÁÆÄÂΩ¢ÂºèÁ±ª‰ºº‰∫é‰∏Ä‰∏™‰∏çÂ∏¶‰ªª‰ΩïÂèÇÊï∞ÁöÑÂÆû‰æãÊñπÊ≥ïÔºå‰ª•ÂÖ≥ÈîÆÂ≠óinitÂëΩÂêçÔºö 123init() &#123; // Âú®Ê≠§Â§ÑÊâßË°åÊûÑÈÄ†ËøáÁ®ã&#125; ‰æãÂ≠êÔºö 123456789struct Fahrenheit &#123; var temperature: Double init() &#123; temperature = 32.0 &#125;&#125;var f = Fahrenheit()print("The default temperature is \(f.temperature)¬∞ Fahrenheit")// ËæìÂá∫ "The default temperature is 32.0¬∞ Fahrenheit‚Äù ÈªòËÆ§Â±ûÊÄßÂÄº‰Ω†ÂèØ‰ª•‰ΩøÁî®Êõ¥ÁÆÄÂçïÁöÑÊñπÂºèÂú®ÂÆö‰πâÁªìÊûÑ‰ΩìFahrenheitÊó∂‰∏∫Â±ûÊÄßtemperatureËÆæÁΩÆÈªòËÆ§ÂÄºÔºö 123struct Fahrenheit &#123; var temperature = 32.0&#125; Ëá™ÂÆö‰πâÊûÑÈÄ†ËøáÁ®ã‰Ω†ÂèØ‰ª•ÈÄöËøáËæìÂÖ•ÂèÇÊï∞ÂíåÂèØÈÄâÁ±ªÂûãÁöÑÂ±ûÊÄßÊù•Ëá™ÂÆö‰πâÊûÑÈÄ†ËøáÁ®ãÔºå‰πüÂèØ‰ª•Âú®ÊûÑÈÄ†ËøáÁ®ã‰∏≠‰øÆÊîπÂ∏∏ÈáèÂ±ûÊÄß„ÄÇ ÊûÑÈÄ†ÂèÇÊï∞Ëá™ÂÆö‰πâÊûÑÈÄ†ËøáÁ®ãÊó∂ÔºåÂèØ‰ª•Âú®ÂÆö‰πâ‰∏≠Êèê‰æõÊûÑÈÄ†ÂèÇÊï∞ÔºåÊåáÂÆöÊâÄÈúÄÂÄºÁöÑÁ±ªÂûãÂíåÂêçÂ≠ó„ÄÇÊûÑÈÄ†ÂèÇÊï∞ÁöÑÂäüËÉΩÂíåËØ≠Ê≥ïË∑üÂáΩÊï∞ÂíåÊñπÊ≥ïÁöÑÂèÇÊï∞Áõ∏Âêå„ÄÇ 12345678910111213struct Celsius &#123; var temperatureInCelsius: Double init(fromFahrenheit fahrenheit: Double) &#123; temperatureInCelsius = (fahrenheit - 32.0) / 1.8 &#125; init(fromKelvin kelvin: Double) &#123; temperatureInCelsius = kelvin - 273.15 &#125;&#125;let boilingPointOfWater = Celsius(fromFahrenheit: 212.0)// boilingPointOfWater.temperatureInCelsius ÊòØ 100.0let freezingPointOfWater = Celsius(fromKelvin: 273.15)// freezingPointOfWater.temperatureInCelsius ÊòØ 0.0‚Äù Á¨¨‰∏Ä‰∏™ÊûÑÈÄ†Âô®Êã•Êúâ‰∏Ä‰∏™ÊûÑÈÄ†ÂèÇÊï∞ÔºåÂÖ∂Â§ñÈÉ®ÂêçÂ≠ó‰∏∫fromFahrenheitÔºåÂÜÖÈÉ®ÂêçÂ≠ó‰∏∫fahrenheitÔºõÁ¨¨‰∫å‰∏™ÊûÑÈÄ†Âô®‰πüÊã•Êúâ‰∏Ä‰∏™ÊûÑÈÄ†ÂèÇÊï∞ÔºåÂÖ∂Â§ñÈÉ®ÂêçÂ≠ó‰∏∫fromKelvinÔºåÂÜÖÈÉ®ÂêçÂ≠ó‰∏∫kelvin„ÄÇËøô‰∏§‰∏™ÊûÑÈÄ†Âô®ÈÉΩÂ∞ÜÂîØ‰∏ÄÁöÑÂèÇÊï∞ÂÄºËΩ¨Êç¢ÊàêÊëÑÊ∞èÊ∏©Â∫¶ÂÄºÔºåÂπ∂‰øùÂ≠òÂú®Â±ûÊÄßtemperatureInCelsius‰∏≠„ÄÇ ÂíåÂáΩÊï∞ÂíåÊñπÊ≥ïÁöÑÂÆö‰πâÁ±ª‰ºº ÂèØÈÄâÂ±ûÊÄßÁ±ªÂûãÂ¶ÇÊûú‰Ω†ÂÆöÂà∂ÁöÑÁ±ªÂûãÂåÖÂê´‰∏Ä‰∏™ÈÄªËæë‰∏äÂÖÅËÆ∏ÂèñÂÄº‰∏∫Á©∫ÁöÑÂ≠òÂÇ®ÂûãÂ±ûÊÄß‚Äî‚ÄîÊó†ËÆ∫ÊòØÂõ†‰∏∫ÂÆÉÊó†Ê≥ïÂú®ÂàùÂßãÂåñÊó∂ËµãÂÄºÔºåËøòÊòØÂõ†‰∏∫ÂÆÉÂú®‰πãÂêéÊüê‰∏™Êó∂Èó¥ÁÇπÂèØ‰ª•ËµãÂÄº‰∏∫Á©∫‚Äî‚Äî‰Ω†ÈÉΩÈúÄË¶ÅÂ∞ÜÂÆÉÂÆö‰πâ‰∏∫ÂèØÈÄâÁ±ªÂûãÔºàoptional typeÔºâ„ÄÇÂèØÈÄâÁ±ªÂûãÁöÑÂ±ûÊÄßÂ∞ÜËá™Âä®ÂàùÂßãÂåñ‰∏∫nilÔºåË°®Á§∫Ëøô‰∏™Â±ûÊÄßÊòØÊúâÊÑèÂú®ÂàùÂßãÂåñÊó∂ËÆæÁΩÆ‰∏∫Á©∫ÁöÑ„ÄÇ ‰æãÂ≠êÔºö 1234567891011121314class SurveyQuestion &#123; var text: String var response: String? init(text: String) &#123; self.text = text &#125; func ask() &#123; print(text) &#125;&#125;let cheeseQuestion = SurveyQuestion(text: "Do you like cheese?")cheeseQuestion.ask()// Prints "Do you like cheese?"cheeseQuestion.response = "Yes, I do like cheese." ÊûÑÈÄ†ËøáÁ®ã‰∏≠Â∏∏ÈáèÂ±ûÊÄßÁöÑËµãÂÄº‰Ω†ÂèØ‰ª•Âú®ÊûÑÈÄ†ËøáÁ®ã‰∏≠ÁöÑ‰ªªÊÑèÊó∂Èó¥ÁÇπÁªôÂ∏∏ÈáèÂ±ûÊÄßÊåáÂÆö‰∏Ä‰∏™ÂÄºÔºåÂè™Ë¶ÅÂú®ÊûÑÈÄ†ËøáÁ®ãÁªìÊùüÊó∂ÊòØ‰∏Ä‰∏™Á°ÆÂÆöÁöÑÂÄº„ÄÇ‰∏ÄÊó¶Â∏∏ÈáèÂ±ûÊÄßË¢´ËµãÂÄºÔºåÂÆÉÂ∞ÜÊ∞∏Ëøú‰∏çÂèØÊõ¥Êîπ„ÄÇ ÂØπ‰∫éÁ±ªÁöÑÂÆû‰æãÊù•ËØ¥ÔºåÂÆÉÁöÑÂ∏∏ÈáèÂ±ûÊÄßÂè™ËÉΩÂú®ÂÆö‰πâÂÆÉÁöÑÁ±ªÁöÑÊûÑÈÄ†ËøáÁ®ã‰∏≠ËµãÂÄºÔºõ‰∏çËÉΩÂú®Â≠êÁ±ªÁöÑÊûÑÈÄ†ËøáÁ®ã‰∏≠ËµãÂÄº„ÄÇÈÅìÁêÜÂæàÊµÖÊòæÔºåÁî±‰∫éÂ∏∏Èáè‰∏çËÆ∫ÊòØÂê¶ÂèØÈÄâÈÉΩË¶ÅË¢´ËµãÂÄºÔºå‰∏çËÉΩÈÄöËøáÁ±ªÂûãÊé®Êñ≠ÔºåÊâÄ‰ª•Áà∂Á±ªÂàùÂßãÂåñÁöÑÊñπÊ≥ï‰∏≠ÂøÖÈ°ªË¶ÅÂØπÂ∏∏ÈáèËµãÂÄº„ÄÇÂèàÂõ†‰∏∫Â∏∏ÈáèÂú®ËµãÂÄº‰πãÂêéÂ∞±‰∏çËÉΩÊõ¥Êîπ‰∫ÜÔºåÊâÄ‰ª•Áà∂Á±ª‰∏≠ËµãÂÄº‰πãÂêéÔºåÂ∞±‰∏çËÉΩÂÜçÂú®Â≠êÁ±ª‰∏≠ËµãÂÄº‰∫Ü„ÄÇ ÂèØ‰ª•‰øÆÊîπ‰∏äÈù¢ÁöÑSurveyQuestionÁ§∫‰æãÔºåÁî®Â∏∏ÈáèÂ±ûÊÄßÊõø‰ª£ÂèòÈáèÂ±ûÊÄßtextÔºåË°®Á§∫ÈóÆÈ¢òÂÜÖÂÆπtextÂú®SurveyQuestionÁöÑÂÆû‰æãË¢´ÂàõÂª∫‰πãÂêé‰∏ç‰ºöÂÜçË¢´‰øÆÊîπ„ÄÇÂ∞ΩÁÆ°textÂ±ûÊÄßÁé∞Âú®ÊòØÂ∏∏ÈáèÔºåÊàë‰ª¨‰ªçÁÑ∂ÂèØ‰ª•Âú®Á±ªÁöÑÊûÑÈÄ†Âô®‰∏≠ËÆæÁΩÆÂÆÉÁöÑÂÄºÔºö 1234567891011121314class SurveyQuestion &#123; let text: String var response: String? init(text: String) &#123; self.text = text &#125; func ask() &#123; print(text) &#125;&#125;let beetsQuestion = SurveyQuestion(text: "How about beets?")beetsQuestion.ask()// ËæìÂá∫ "How about beets?"beetsQuestion.response = "I also like beets. (But not with cheese.)" ÈªòËÆ§ÊûÑÈÄ†Âô®Â¶ÇÊûúÁªìÊûÑ‰ΩìÊàñÁ±ªÁöÑÊâÄÊúâÂ±ûÊÄßÈÉΩÊúâÈªòËÆ§ÂÄºÔºåÂêåÊó∂Ê≤°ÊúâËá™ÂÆö‰πâÁöÑÊûÑÈÄ†Âô®ÔºåÈÇ£‰πà Swift ‰ºöÁªôËøô‰∫õÁªìÊûÑ‰ΩìÊàñÁ±ªÊèê‰æõ‰∏Ä‰∏™ÈªòËÆ§ÊûÑÈÄ†Âô®Ôºàdefault initializersÔºâ„ÄÇËøô‰∏™ÈªòËÆ§ÊûÑÈÄ†Âô®Â∞ÜÁÆÄÂçïÂú∞ÂàõÂª∫‰∏Ä‰∏™ÊâÄÊúâÂ±ûÊÄßÂÄºÈÉΩËÆæÁΩÆ‰∏∫ÈªòËÆ§ÂÄºÁöÑÂÆû‰æã„ÄÇ ‰∏ãÈù¢‰æãÂ≠ê‰∏≠ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Á±ªShoppingListItemÔºåÂÆÉÂ∞ÅË£Ö‰∫ÜË¥≠Áâ©Ê∏ÖÂçï‰∏≠ÁöÑÊüê‰∏ÄÁâ©ÂìÅÁöÑÂ±ûÊÄßÔºöÂêçÂ≠óÔºànameÔºâ„ÄÅÊï∞ÈáèÔºàquantityÔºâÂíåË¥≠‰π∞Áä∂ÊÄÅ purchase stateÔºö 123456class ShoppingListItem &#123; var name: String? var quantity = 1 var purchased = false&#125;var item = ShoppingListItem() Áî±‰∫éShoppingListItemÁ±ª‰∏≠ÁöÑÊâÄÊúâÂ±ûÊÄßÈÉΩÊúâÈªòËÆ§ÂÄºÔºå‰∏îÂÆÉÊòØÊ≤°ÊúâÁà∂Á±ªÁöÑÂü∫Á±ªÔºåÂÆÉÂ∞ÜËá™Âä®Ëé∑Âæó‰∏Ä‰∏™ÂèØ‰ª•‰∏∫ÊâÄÊúâÂ±ûÊÄßËÆæÁΩÆÈªòËÆ§ÂÄºÁöÑÈªòËÆ§ÊûÑÈÄ†Âô®ÔºàÂ∞ΩÁÆ°‰ª£Á†Å‰∏≠Ê≤°ÊúâÊòæÂºè‰∏∫nameÂ±ûÊÄßËÆæÁΩÆÈªòËÆ§ÂÄºÔºå‰ΩÜÁî±‰∫énameÊòØÂèØÈÄâÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºåÂÆÉÂ∞ÜÈªòËÆ§ËÆæÁΩÆ‰∏∫nilÔºâ„ÄÇ‰∏äÈù¢‰æãÂ≠ê‰∏≠‰ΩøÁî®ÈªòËÆ§ÊûÑÈÄ†Âô®ÂàõÈÄ†‰∫Ü‰∏Ä‰∏™ShoppingListItemÁ±ªÁöÑÂÆû‰æãÔºà‰ΩøÁî®ShoppingListItem()ÂΩ¢ÂºèÁöÑÊûÑÈÄ†Âô®ËØ≠Ê≥ïÔºâÔºåÂπ∂Â∞ÜÂÖ∂ËµãÂÄºÁªôÂèòÈáèitem„ÄÇ ÈªòËÆ§ÊûÑÈÄ†Âô®Ë¶ÅÊ±ÇÊâÄÊúâÂ±ûÊÄßÈÉΩÊúâÈªòËÆ§ÂÄº„ÄÇÊâÄ‰ª•‰∏äÈù¢‰æãÂ≠êÈáåÁöÑ name ÂøÖÈ°ªÊòØÂèØÈÄâÁöÑ„ÄÇÂ¶ÇÊûúÊòØÈùûÂèØÈÄâÁöÑÂ∞±‰ºö‰∫ßÁîüÂºÇÂ∏∏Ôºå‰Ω†ÈúÄË¶ÅÊ∑ªÂä†‰∏Ä‰∏™ init ÊñπÊ≥ïÊù•ÂàùÂßãÂåñËøô‰∏™ ÈùûÂèØÈÄâname ÁªìÊûÑ‰ΩìÁöÑÈÄê‰∏ÄÊàêÂëòÊûÑÈÄ†Âô®Èô§‰∫Ü‰∏äÈù¢ÊèêÂà∞ÁöÑÈªòËÆ§ÊûÑÈÄ†Âô®ÔºåÂ¶ÇÊûúÁªìÊûÑ‰ΩìÊ≤°ÊúâÊèê‰æõËá™ÂÆö‰πâÁöÑÊûÑÈÄ†Âô®ÔºåÂÆÉ‰ª¨Â∞ÜËá™Âä®Ëé∑Âæó‰∏Ä‰∏™ÈÄê‰∏ÄÊàêÂëòÊûÑÈÄ†Âô®ÔºåÂç≥‰ΩøÁªìÊûÑ‰ΩìÁöÑÂ≠òÂÇ®ÂûãÂ±ûÊÄßÊ≤°ÊúâÈªòËÆ§ÂÄº„ÄÇ ÈÄê‰∏ÄÊàêÂëòÊûÑÈÄ†Âô®ÊòØÁî®Êù•ÂàùÂßãÂåñÁªìÊûÑ‰ΩìÊñ∞ÂÆû‰æãÈáåÊàêÂëòÂ±ûÊÄßÁöÑÂø´Êç∑ÊñπÊ≥ï„ÄÇÊàë‰ª¨Âú®Ë∞ÉÁî®ÈÄê‰∏ÄÊàêÂëòÊûÑÈÄ†Âô®Êó∂ÔºåÈÄöËøá‰∏éÊàêÂëòÂ±ûÊÄßÂêçÁõ∏ÂêåÁöÑÂèÇÊï∞ÂêçËøõË°å‰º†ÂÄºÊù•ÂÆåÊàêÂØπÊàêÂëòÂ±ûÊÄßÁöÑÂàùÂßãËµãÂÄº„ÄÇ 1234struct Size &#123; var width = 0.0, height = 0.0&#125;let twoByTwo = Size(width: 2.0, height: 2.0) (Á±ªÂ∞±‰∏çÂ≠òÂú®ËøôÁßçÈÄê‰∏ÄÊàêÂëòÊûÑÈÄ†Âô®) ÂÄºÁ±ªÂûãÁöÑÊûÑÈÄ†Âô®‰ª£ÁêÜÊûÑÈÄ†Âô®ÂèØ‰ª•ÈÄöËøáË∞ÉÁî®ÂÖ∂ÂÆÉÊûÑÈÄ†Âô®Êù•ÂÆåÊàêÂÆû‰æãÁöÑÈÉ®ÂàÜÊûÑÈÄ†ËøáÁ®ã„ÄÇËøô‰∏ÄËøáÁ®ãÁß∞‰∏∫ÊûÑÈÄ†Âô®‰ª£ÁêÜÔºåÂÆÉËÉΩÂáèÂ∞ëÂ§ö‰∏™ÊûÑÈÄ†Âô®Èó¥ÁöÑ‰ª£Á†ÅÈáçÂ§ç„ÄÇ ÊûÑÈÄ†Âô®‰ª£ÁêÜÁöÑÂÆûÁé∞ËßÑÂàôÂíåÂΩ¢ÂºèÂú®ÂÄºÁ±ªÂûãÂíåÁ±ªÁ±ªÂûã‰∏≠ÊúâÊâÄ‰∏çÂêå„ÄÇÂÄºÁ±ªÂûãÔºàÁªìÊûÑ‰ΩìÂíåÊûö‰∏æÁ±ªÂûãÔºâ‰∏çÊîØÊåÅÁªßÊâøÔºåÊâÄ‰ª•ÊûÑÈÄ†Âô®‰ª£ÁêÜÁöÑËøáÁ®ãÁõ∏ÂØπÁÆÄÂçïÔºåÂõ†‰∏∫ÂÆÉ‰ª¨Âè™ËÉΩ‰ª£ÁêÜÁªôËá™Â∑±ÁöÑÂÖ∂ÂÆÉÊûÑÈÄ†Âô®„ÄÇ Â¶ÇÊûú‰Ω†‰∏∫Êüê‰∏™ÂÄºÁ±ªÂûãÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑÊûÑÈÄ†Âô®Ôºå‰Ω†Â∞ÜÊó†Ê≥ïËÆøÈóÆÂà∞ÈªòËÆ§ÊûÑÈÄ†Âô®ÔºàÂ¶ÇÊûúÊòØÁªìÊûÑ‰ΩìÔºåËøòÂ∞ÜÊó†Ê≥ïËÆøÈóÆÈÄê‰∏ÄÊàêÂëòÊûÑÈÄ†Âô®Ôºâ„ÄÇËøôÁßçÈôêÂà∂ÂèØ‰ª•Èò≤Ê≠¢‰Ω†‰∏∫ÂÄºÁ±ªÂûãÂ¢ûÂä†‰∫Ü‰∏Ä‰∏™È¢ùÂ§ñÁöÑ‰∏îÂçÅÂàÜÂ§çÊùÇÁöÑÊûÑÈÄ†Âô®‰πãÂêé,‰ªçÁÑ∂Êúâ‰∫∫ÈîôËØØÁöÑ‰ΩøÁî®Ëá™Âä®ÁîüÊàêÁöÑÊûÑÈÄ†Âô®„ÄÇ ‰∏æ‰æãÔºö 123456789101112131415161718192021struct Size &#123; var width = 0.0, height = 0.0&#125;struct Point &#123; var x = 0.0, y = 0.0&#125;struct Rect &#123; var origin = Point() var size = Size() init() &#123;&#125; init(origin: Point, size: Size) &#123; self.origin = origin self.size = size &#125; init(center: Point, size: Size) &#123; let originX = center.x - (size.width / 2) let originY = center.y - (size.height / 2) self.init(origin: Point(x: originX, y: originY), size: size) &#125;&#125; Â∞±ÊòØÁ±ª‰∏≠ÁöÑÊûÑÈÄ†Âô®Ë∞ÉÁî®Á±ª‰∏≠ÁöÑÂè¶‰∏Ä‰∏™ÊûÑÈÄ†Âô® Á±ªÁöÑÁªßÊâøÂíåÊûÑÈÄ†ËøáÁ®ãÁ±ªÈáåÈù¢ÁöÑÊâÄÊúâÂ≠òÂÇ®ÂûãÂ±ûÊÄß‚Äî‚ÄîÂåÖÊã¨ÊâÄÊúâÁªßÊâøËá™Áà∂Á±ªÁöÑÂ±ûÊÄß‚Äî‚ÄîÈÉΩÂøÖÈ°ªÂú®ÊûÑÈÄ†ËøáÁ®ã‰∏≠ËÆæÁΩÆÂàùÂßãÂÄº„ÄÇÔºàÂü∫Êú¨‰∏äÊâÄÊúâÂêéÈù¢ÁöÑÊâÄÊúâÁöÑÈôêÂà∂ÈÉΩÊòØÂõ¥ÁªïËøô‰∏ÄËßÑÂÆöÔºâ Swift ‰∏∫Á±ªÁ±ªÂûãÊèê‰æõ‰∫Ü‰∏§ÁßçÊûÑÈÄ†Âô®Êù•Á°Æ‰øùÂÆû‰æã‰∏≠ÊâÄÊúâÂ≠òÂÇ®ÂûãÂ±ûÊÄßÈÉΩËÉΩËé∑ÂæóÂàùÂßãÂÄºÔºåÂÆÉ‰ª¨ÂàÜÂà´ÊòØÊåáÂÆöÊûÑÈÄ†Âô®Âíå‰æøÂà©ÊûÑÈÄ†Âô®„ÄÇ ÊåáÂÆöÊûÑÈÄ†Âô®Âíå‰æøÂà©ÊûÑÈÄ†Âô®ÊåáÂÆöÊûÑÈÄ†Âô®ÊåáÂÆöÊûÑÈÄ†Âô®Ôºàdesignated initializersÔºâÊòØÁ±ª‰∏≠ÊúÄ‰∏ªË¶ÅÁöÑÊûÑÈÄ†Âô®„ÄÇ‰∏Ä‰∏™ÊåáÂÆöÊûÑÈÄ†Âô®Â∞ÜÂàùÂßãÂåñÁ±ª‰∏≠Êèê‰æõÁöÑÊâÄÊúâÂ±ûÊÄß(Â∞±ÊòØÈúÄË¶ÅÁ°Æ‰øùÊâÄÊúâÈùûÂèØÈÄâÂ±ûÊÄßÈÉΩÊúâÂÄº)ÔºåÂπ∂Ê†πÊçÆÁà∂Á±ªÈìæÂæÄ‰∏äË∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†Âô®Êù•ÂÆûÁé∞Áà∂Á±ªÁöÑÂàùÂßãÂåñ„ÄÇ ÊØè‰∏Ä‰∏™Á±ªÈÉΩÂøÖÈ°ªÊã•ÊúâËá≥Â∞ë‰∏Ä‰∏™ÊåáÂÆöÊûÑÈÄ†Âô®„ÄÇÂú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºåËÆ∏Â§öÁ±ªÈÄöËøáÁªßÊâø‰∫ÜÁà∂Á±ª‰∏≠ÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ËÄåÊª°Ë∂≥‰∫ÜËøô‰∏™Êù°‰ª∂„ÄÇ ÊåáÂÆöÊûÑÈÄ†Âô®Âè™ËÉΩË∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†Âô®Ôºå‰∏çËÉΩË∞ÉÁî®Ëá™Â∑±ÁöÑÂÖ∂‰ªñÊûÑÈÄ†Âô® ‰æøÂà©ÊûÑÈÄ†Âô®‰æøÂà©ÊûÑÈÄ†Âô®Ôºàconvenience initializersÔºâÊòØÁ±ª‰∏≠ÊØîËæÉÊ¨°Ë¶ÅÁöÑ„ÄÅËæÖÂä©ÂûãÁöÑÊûÑÈÄ†Âô®„ÄÇ‰Ω†ÂèØ‰ª•ÂÆö‰πâ‰æøÂà©ÊûÑÈÄ†Âô®Êù•Ë∞ÉÁî®Âêå‰∏Ä‰∏™Á±ª‰∏≠ÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ÔºåÂπ∂‰∏∫ÂÖ∂ÂèÇÊï∞Êèê‰æõÈªòËÆ§ÂÄº„ÄÇ‰Ω†‰πüÂèØ‰ª•ÂÆö‰πâ‰æøÂà©ÊûÑÈÄ†Âô®Êù•ÂàõÂª∫‰∏Ä‰∏™ÁâπÊÆäÁî®ÈÄîÊàñÁâπÂÆöËæìÂÖ•ÂÄºÁöÑÂÆû‰æã„ÄÇ ‰Ω†Â∫îÂΩìÂè™Âú®ÂøÖË¶ÅÁöÑÊó∂ÂÄô‰∏∫Á±ªÊèê‰æõ‰æøÂà©ÊûÑÈÄ†Âô®ÔºåÊØîÊñπËØ¥ÊüêÁßçÊÉÖÂÜµ‰∏ãÈÄöËøá‰ΩøÁî®‰æøÂà©ÊûÑÈÄ†Âô®Êù•Âø´Êç∑Ë∞ÉÁî®Êüê‰∏™ÊåáÂÆöÊûÑÈÄ†Âô®ÔºåËÉΩÂ§üËäÇÁúÅÊõ¥Â§öÂºÄÂèëÊó∂Èó¥Âπ∂ËÆ©Á±ªÁöÑÊûÑÈÄ†ËøáÁ®ãÊõ¥Ê∏ÖÊô∞Êòé‰∫Ü„ÄÇ ‰æøÂà©ÊûÑÈÄ†Âô®Âè™ËÉΩË∞ÉÁî®Ëá™Â∑±ÁöÑÂÖ∂‰ªñÊûÑÈÄ†Âô®Ôºå‰∏çËÉΩË∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†Âô® ÊåáÂÆöÊûÑÈÄ†Âô®Âíå‰æøÂà©ÊûÑÈÄ†Âô®ÁöÑËØ≠Ê≥ïÁ±ªÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ÁöÑÂÜôÊ≥ïË∑üÂÄºÁ±ªÂûãÁÆÄÂçïÊûÑÈÄ†Âô®‰∏ÄÊ†∑Ôºö 123init(parameters) &#123; statements&#125; ‰æøÂà©ÊûÑÈÄ†Âô®‰πüÈááÁî®Áõ∏ÂêåÊ†∑ÂºèÁöÑÂÜôÊ≥ïÔºå‰ΩÜÈúÄË¶ÅÂú®initÂÖ≥ÈîÆÂ≠ó‰πãÂâçÊîæÁΩÆconvenienceÂÖ≥ÈîÆÂ≠óÔºåÂπ∂‰ΩøÁî®Á©∫Ê†ºÂ∞ÜÂÆÉ‰ª¨‰ø©ÂàÜÂºÄÔºö 123convenience init(parameters) &#123; statements&#125; Á±ªÁöÑÊûÑÈÄ†Âô®‰ª£ÁêÜËßÑÂàô ÊåáÂÆöÊûÑÈÄ†Âô®ÂøÖÈ°ªÊÄªÊòØÂêë‰∏ä‰ª£ÁêÜ ‰æøÂà©ÊûÑÈÄ†Âô®ÂøÖÈ°ªÊÄªÊòØÊ®™Âêë‰ª£ÁêÜ ‰∏§ÊÆµÂºèÊûÑÈÄ†ËøáÁ®ãSwift ‰∏≠Á±ªÁöÑÊûÑÈÄ†ËøáÁ®ãÂåÖÂê´‰∏§‰∏™Èò∂ÊÆµ„ÄÇÁ¨¨‰∏Ä‰∏™Èò∂ÊÆµÔºåÊØè‰∏™Â≠òÂÇ®ÂûãÂ±ûÊÄßË¢´ÂºïÂÖ•ÂÆÉ‰ª¨ÁöÑÁ±ªÊåáÂÆö‰∏Ä‰∏™ÂàùÂßãÂÄº„ÄÇÂΩìÊØè‰∏™Â≠òÂÇ®ÂûãÂ±ûÊÄßÁöÑÂàùÂßãÂÄºË¢´Á°ÆÂÆöÂêéÔºåÁ¨¨‰∫åÈò∂ÊÆµÂºÄÂßãÔºåÂÆÉÁªôÊØè‰∏™Á±ª‰∏ÄÊ¨°Êú∫‰ºöÔºåÂú®Êñ∞ÂÆû‰æãÂáÜÂ§á‰ΩøÁî®‰πãÂâçËøõ‰∏ÄÊ≠•ÂÆöÂà∂ÂÆÉ‰ª¨ÁöÑÂ≠òÂÇ®ÂûãÂ±ûÊÄß„ÄÇ ‰∏äÈù¢ÁöÑËØùÁöÑÂ§ßËá¥ÊÑèÊÄùÊòØÔºöÂÖàÊääÂ≠êÁ±ªÁâπÊúâÁöÑÂ±ûÊÄßÂàùÂßãÂåñÂÆåÊàêÂêéÔºåÂÜçË∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞ÂàùÂßãÂåñÁà∂Á±ªÁöÑÂ±ûÊÄß„ÄÇÂàùÂßãÂåñÁà∂Á±ªÁöÑÂ±ûÊÄßÂÆåÂêéÔºåÂÜç‰øÆÊîπÁà∂Á±ªÁöÑÂ±ûÊÄß„ÄÇ Swift ÁºñËØëÂô®Â∞ÜÊâßË°å 4 ÁßçÊúâÊïàÁöÑÂÆâÂÖ®Ê£ÄÊü•Ôºå‰ª•Á°Æ‰øù‰∏§ÊÆµÂºèÊûÑÈÄ†ËøáÁ®ãËÉΩ‰∏çÂá∫ÈîôÂú∞ÂÆåÊàêÔºö ÂÆâÂÖ®Ê£ÄÊü•1ÊåáÂÆöÊûÑÈÄ†Âô®ÂøÖÈ°ª‰øùËØÅÂÆÉÊâÄÂú®Á±ªÂºïÂÖ•ÁöÑÊâÄÊúâÂ±ûÊÄßÈÉΩÂøÖÈ°ªÂÖàÂàùÂßãÂåñÂÆåÊàêÔºå‰πãÂêéÊâçËÉΩÂ∞ÜÂÖ∂ÂÆÉÊûÑÈÄ†‰ªªÂä°Âêë‰∏ä‰ª£ÁêÜÁªôÁà∂Á±ª‰∏≠ÁöÑÊûÑÈÄ†Âô®„ÄÇ Â¶Ç‰∏äÊâÄËø∞Ôºå‰∏Ä‰∏™ÂØπË±°ÁöÑÂÜÖÂ≠òÂè™ÊúâÂú®ÂÖ∂ÊâÄÊúâÂ≠òÂÇ®ÂûãÂ±ûÊÄßÁ°ÆÂÆö‰πãÂêéÊâçËÉΩÂÆåÂÖ®ÂàùÂßãÂåñ„ÄÇ‰∏∫‰∫ÜÊª°Ë∂≥Ëøô‰∏ÄËßÑÂàôÔºåÊåáÂÆöÊûÑÈÄ†Âô®ÂøÖÈ°ª‰øùËØÅÂÆÉÊâÄÂú®Á±ªÂºïÂÖ•ÁöÑÂ±ûÊÄßÂú®ÂÆÉÂæÄ‰∏ä‰ª£ÁêÜ‰πãÂâçÂÖàÂÆåÊàêÂàùÂßãÂåñ„ÄÇ Â∞±ÊòØÂú® super ‰πãÂâçÔºåÂÖàË¶ÅËÆ©Â≠êÁ±ªÁöÑÊâÄÊúâÂ±ûÊÄßÈÉΩÊúâÈªòËÆ§ÂÄº ÂÆâÂÖ®Ê£ÄÊü•2ÊåáÂÆöÊûÑÈÄ†Âô®ÂøÖÈ°ªÂÖàÂêë‰∏ä‰ª£ÁêÜË∞ÉÁî®Áà∂Á±ªÊûÑÈÄ†Âô®ÔºåÁÑ∂ÂêéÂÜç‰∏∫ÁªßÊâøÁöÑÂ±ûÊÄßËÆæÁΩÆÊñ∞ÂÄº„ÄÇÂ¶ÇÊûúÊ≤°Ëøô‰πàÂÅöÔºåÊåáÂÆöÊûÑÈÄ†Âô®Ëµã‰∫àÁöÑÊñ∞ÂÄºÂ∞ÜË¢´Áà∂Á±ª‰∏≠ÁöÑÊûÑÈÄ†Âô®ÊâÄË¶ÜÁõñ„ÄÇ Â∞±ÊòØÁ¨¨‰∏ÄÊ≠•‰πãÂêéÂÖàsuperÔºåÁÑ∂Âêé‰øÆÊîπÂÖ∂Â±ûÊÄß ÂÆâÂÖ®Ê£ÄÊü•3‰æøÂà©ÊûÑÈÄ†Âô®ÂøÖÈ°ªÂÖà‰ª£ÁêÜË∞ÉÁî®Âêå‰∏ÄÁ±ª‰∏≠ÁöÑÂÖ∂ÂÆÉÊûÑÈÄ†Âô®ÔºåÁÑ∂ÂêéÂÜç‰∏∫‰ªªÊÑèÂ±ûÊÄßËµãÊñ∞ÂÄº„ÄÇÂ¶ÇÊûúÊ≤°Ëøô‰πàÂÅöÔºå‰æøÂà©ÊûÑÈÄ†Âô®Ëµã‰∫àÁöÑÊñ∞ÂÄºÂ∞ÜË¢´Âêå‰∏ÄÁ±ª‰∏≠ÂÖ∂ÂÆÉÊåáÂÆöÊûÑÈÄ†Âô®ÊâÄË¶ÜÁõñ„ÄÇ ‰æøÂà©ÊûÑÈÄ†Âô®ÂÖàË∞ÉÁî®ÂÖ∂‰ªñÊûÑÈÄ†Âô®ÔºåÂÜç‰øÆÊîπÂÖ∂Â±ûÊÄß ÂÆâÂÖ®Ê£ÄÊü•4ÊûÑÈÄ†Âô®Âú®Á¨¨‰∏ÄÈò∂ÊÆµ(super ÂÆåÊàêÂêé)ÊûÑÈÄ†ÂÆåÊàê‰πãÂâçÔºå‰∏çËÉΩË∞ÉÁî®‰ªª‰ΩïÂÆû‰æãÊñπÊ≥ïÔºå‰∏çËÉΩËØªÂèñ‰ªª‰ΩïÂÆû‰æãÂ±ûÊÄßÁöÑÂÄºÔºå‰∏çËÉΩÂºïÁî®self‰Ωú‰∏∫‰∏Ä‰∏™ÂÄº„ÄÇ Âè™Êúâ super ÂÆåÊàêÂêéÔºåÊâçËÉΩ‰ΩøÁî®ÂÆû‰æãÁöÑÂ±ûÊÄßÊñπÊ≥ï Á±ªÂÆû‰æãÂú®Á¨¨‰∏ÄÈò∂ÊÆµÁªìÊùü‰ª•ÂâçÂπ∂‰∏çÊòØÂÆåÂÖ®ÊúâÊïàÁöÑ„ÄÇÂè™ÊúâÁ¨¨‰∏ÄÈò∂ÊÆµÂÆåÊàêÂêéÔºåËØ•ÂÆû‰æãÊâç‰ºöÊàê‰∏∫ÊúâÊïàÂÆû‰æãÔºåÊâçËÉΩËÆøÈóÆÂ±ûÊÄßÂíåË∞ÉÁî®ÊñπÊ≥ï„ÄÇ ÊÄªÁªìÂà∞ËøôÈáåÊàë‰ª¨Â∞±ÂèØ‰ª•Â∞ÜÊåáÂÆöÊûÑÈÄ†Âô®Âíå‰æøÂà©ÊûÑÈÄ†Âô®ÁöÑËÅåË¥£ÂàíÂàÜ‰∏Ä‰∏ã‰∫Ü„ÄÇ ÊåáÂÆöÊûÑÈÄ†Âô®ÂÆûÁé∞ÁöÑÂ∞±ÊòØÈò∂ÊÆµ‰∏ÄÔºåÂÖàËÆæÁΩÆËá™Ë∫´ÁöÑÈùûÂèØÈÄâÂ±ûÊÄßÔºåÁÑ∂ÂêéË∞ÉÁî® super ‰æøÂà©ÊûÑÈÄ†Âô®ÂÆûÁé∞ÁöÑÂ∞±ÊòØÈò∂ÊÆµ‰∫åÔºåÂú®ÊåáÂÆöÊûÑÈÄ†Âô®ÊûÑÈÄ†ÂÆåÊàêÂêéËøõË°å‰∏Ä‰∫õÂ±ûÊÄßÂÄºÁöÑ‰øÆÊîπ ‰∏ÄËà¨ÈÉΩÊòØÂ§ñÈÉ®Ë∞ÉÁî®‰æøÂà©ÊûÑÈÄ†Âô®ÔºåÂÜçÁî±‰æøÂà©ÊûÑÈÄ†Âô®Ë∞ÉÁî®ÊåáÂÆöÊûÑÈÄ†Âô® ÊûÑÈÄ†Âô®ÁöÑÁªßÊâøÂíåÈáçÂÜôË∑ü Objective-C ‰∏≠ÁöÑÂ≠êÁ±ª‰∏çÂêåÔºåSwift ‰∏≠ÁöÑÂ≠êÁ±ªÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏ç‰ºöÁªßÊâøÁà∂Á±ªÁöÑÊûÑÈÄ†Âô®„ÄÇ ÂÖ≥‰∫éÊåáÂÆöÊûÑÈÄ†Âô®ÔºåÂΩì‰Ω†Âú®ÁºñÂÜô‰∏Ä‰∏™ÂíåÁà∂Á±ª‰∏≠ÊåáÂÆöÊûÑÈÄ†Âô®Áõ∏ÂåπÈÖçÁöÑÂ≠êÁ±ªÊûÑÈÄ†Âô®Êó∂Ôºå‰Ω†ÂÆûÈôÖ‰∏äÊòØÂú®ÈáçÂÜôÁà∂Á±ªÁöÑËøô‰∏™ÊåáÂÆöÊûÑÈÄ†Âô®„ÄÇÂõ†Ê≠§Ôºå‰Ω†ÂøÖÈ°ªÂú®ÂÆö‰πâÂ≠êÁ±ªÊûÑÈÄ†Âô®Êó∂Â∏¶‰∏äoverride‰øÆÈ•∞Á¨¶„ÄÇÂç≥‰Ωø‰Ω†ÈáçÂÜôÁöÑÊòØÁ≥ªÁªüËá™Âä®Êèê‰æõÁöÑÈªòËÆ§ÊûÑÈÄ†Âô®Ôºå‰πüÈúÄË¶ÅÂ∏¶‰∏äoverride‰øÆÈ•∞Á¨¶„ÄÇ‰Ω†‰πüÂèØ‰ª•Â∞ÜÊåáÂÆöÊûÑÈÄ†Âô®ÈáçÂÜô‰∏∫‰æøÂà©ÊûÑÈÄ†Âô®„ÄÇ Áõ∏ÂèçÔºåÂÖ≥‰∫é‰æøÂà©ÊûÑÈÄ†Âô®ÔºåÂ¶ÇÊûú‰Ω†ÁºñÂÜô‰∫Ü‰∏Ä‰∏™ÂíåÁà∂Á±ª‰æøÂà©ÊûÑÈÄ†Âô®Áõ∏ÂåπÈÖçÁöÑÂ≠êÁ±ªÊûÑÈÄ†Âô®ÔºåÁî±‰∫éÂ≠êÁ±ª‰∏çËÉΩÁõ¥Êé•Ë∞ÉÁî®Áà∂Á±ªÁöÑ‰æøÂà©ÊûÑÈÄ†Âô®ÔºåÂõ†Ê≠§Ôºå‰∏•Ê†ºÊÑè‰πâ‰∏äÊù•ËÆ≤Ôºå‰Ω†ÁöÑÂ≠êÁ±ªÂπ∂Êú™ÂØπ‰∏Ä‰∏™Áà∂Á±ªÊûÑÈÄ†Âô®Êèê‰æõÈáçÂÜôÔºåËÄåÊòØÁõ¥Êé•Ë¶ÜÁõñ„ÄÇÊúÄÂêéÁöÑÁªìÊûúÂ∞±ÊòØÔºå‰Ω†Âú®Â≠êÁ±ª‰∏≠‚ÄúÈáçÂÜô‚Äù‰∏Ä‰∏™Áà∂Á±ª‰æøÂà©ÊûÑÈÄ†Âô®Êó∂Ôºå‰∏çÈúÄË¶ÅÂä†overrideÂâçÁºÄÔºåÂç≥ËôΩÁÑ∂Á±ªÂûãÁõ∏ÂêåÔºå‰ΩÜ‰∏çÊòØÂêå‰∏Ä‰∏™ÊñπÊ≥ï„ÄÇ ÊûÑÈÄ†Âô®ÁöÑËá™Âä®ÁªßÊâøÂ≠êÁ±ªÂú®ÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏ç‰ºöÁªßÊâøÁà∂Á±ªÁöÑÊûÑÈÄ†Âô®„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÊª°Ë∂≥ÁâπÂÆöÊù°‰ª∂ÔºåÁà∂Á±ªÊûÑÈÄ†Âô®ÊòØÂèØ‰ª•Ë¢´Ëá™Âä®ÁªßÊâøÁöÑ„ÄÇÂú®ÂÆûË∑µ‰∏≠ÔºåËøôÊÑèÂë≥ÁùÄÂØπ‰∫éËÆ∏Â§öÂ∏∏ËßÅÂú∫ÊôØ‰Ω†‰∏çÂøÖÈáçÂÜôÁà∂Á±ªÁöÑÊûÑÈÄ†Âô®ÔºåÂπ∂‰∏îÂèØ‰ª•Âú®ÂÆâÂÖ®ÁöÑÊÉÖÂÜµ‰∏ã‰ª•ÊúÄÂ∞èÁöÑ‰ª£‰ª∑ÁªßÊâøÁà∂Á±ªÁöÑÊûÑÈÄ†Âô®Ôºö Â¶ÇÊûúÂ≠êÁ±ªÊ≤°ÊúâÂÆö‰πâ‰ªª‰ΩïÊåáÂÆöÊûÑÈÄ†Âô®ÔºåÂÆÉÂ∞ÜËá™Âä®ÁªßÊâøÊâÄÊúâÁà∂Á±ªÁöÑÊûÑÈÄ†Âô®ÔºàÂåÖÊã¨ÊåáÂÆöÊûÑÈÄ†Âô®Âíå‰æøÂà©ÊûÑÈÄ†Âô®Ôºâ„ÄÇ Â¶ÇÊûúÂ≠êÁ±ªÊèê‰æõ‰∫ÜÊâÄÊúâÁà∂Á±ªÊåáÂÆöÊûÑÈÄ†Âô®ÁöÑÂÆûÁé∞ÔºåÂÆÉÂ∞ÜËá™Âä®ÁªßÊâøÊâÄÊúâÁà∂Á±ªÁöÑ‰æøÂà©ÊûÑÈÄ†Âô®„ÄÇ Âç≥‰Ωø‰Ω†Âú®Â≠êÁ±ª‰∏≠Ê∑ªÂä†‰∫ÜÂæàÂ§öÁöÑ‰æøÂà©ÊûÑÈÄ†Âô®ÔºåËøô‰∏§Êù°ËßÑÂàô‰ªçÁÑ∂ÈÄÇÁî®„ÄÇÂØπ‰∫éËßÑÂàô 2ÔºåÂ≠êÁ±ªÂèØ‰ª•Â∞ÜÁà∂Á±ªÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ÂÆûÁé∞‰∏∫‰æøÂà©ÊûÑÈÄ†„ÄÇ ÂÖ≥‰∫éÊûÑÈÄ†Âô®ÁªßÊâø‰∏éÈáçÂÜôÁöÑÊÄªÁªìÂâçÈù¢Âü∫Êú¨‰∏ä‰ª•ÂèäÈÉΩÊèêÂèä‰∫Ü‰ªÄ‰πàÊó∂ÂÄôËÉΩÂ§üËÉΩ‰ªÄ‰πàÊó∂ÂÄô‰∏çËÉΩÁªßÊâø‰∏éÈáçÂÜôÔºå‰ª•Âèä‰∏∫‰ªÄ‰πà„ÄÇÂÜçÂº∫Ë∞É‰∏Ä‰∏ã‰πãÂêéÁöÑÊâÄÊúâÂéüÂàôÈÉΩÊòØÂõ¥ÁªïÔºöÂ¶ÇÊûúÂì™ÈáåÁî®Âà∞‰∫ÜÊú™ËµãÂÄºÁöÑÂ±ûÊÄßÔºåÂ∞±‰ºö‰∫ßÁîüÂºÇÂ∏∏ ‰∏Ä‰∏™ÊåáÂÆöÊûÑÈÄ†Âô®‰∏çËÉΩË∞ÉÁî®Âêå‰∏Ä‰∏™Á±ªÂÜÖÁöÑÂÖ∂‰ªñÊåáÂÆöÊûÑÈÄ†Âô® Ëøô‰∏™ÂéüÂõ†ÂæàÁÆÄÂçï„ÄÇÂ¶ÇÊûúÊåáÂÆöÊûÑÈÄ†Âô®ËÉΩÂ§üË∞ÉÁî®ÂêåÁ±ªÁöÑÂÖ∂‰ªñÊåáÂÆöÊûÑÈÄ†Âô®ÔºåÈÇ£ËøòË¶Å‰æøÂà©ÊûÑÈÄ†Âô®Âπ≤ÂòõÔºü Â≠êÁ±ªÁöÑ‰æøÂà©ÊûÑÈÄ†Âô®‰∏çËÉΩË∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†Âô® Âõ†‰∏∫‰æøÂà©ÊûÑÈÄ†Âô®ÁöÑÁõÆÁöÑÂ∞±ÊòØ‰∏∫Á±ª‰∏≠ÁöÑÊåáÂÆöÊûÑÈÄ†Âô®Êèê‰æõËæÖÂä©ÁöÑÔºåÂç≥ÂÖ∂‰ΩúÁî®‰∫éÊ®™Âêë„ÄÇÂ¶ÇÊûúÂÖ∂ËÉΩÂ§üË∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†Âô®ÔºåÈÇ£‰πà‰æøÂà©ÊûÑÈÄ†Âô®ÂíåÊåáÂÆöÊûÑÈÄ†Âô®Â∞±Ê≤°ÊúâÂå∫Âà´‰∫ÜÔºå‰πüÂ∞±ÊòØËØ¥Ê≤°ÊúâÂøÖË¶ÅÊèê‰æõ‰æøÂà©ÊûÑÈÄ†Âô®Ëøô‰∏™Ê¶ÇÂøµ‰∫Ü„ÄÇ Â≠êÁ±ªÁöÑÊåáÂÆöÊûÑÈÄ†Âô®‰∏çËÉΩË∞ÉÁî®Áà∂Á±ªÁöÑ‰æøÂà©ÊûÑÈÄ†Âô® Â¶ÇÊûúÂ≠êÁ±ªÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ÂèØ‰ª•Ë∞ÉÁî®Áà∂Á±ªÁöÑ‰æøÂà©ÊûÑÈÄ†Âô®ÔºåÈÇ£‰πàËÄÉËôë‰∏ÄÁßçÊÉÖÂÜµÔºöÂ≠êÁ±ªÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ÈáçÂÜô‰∫ÜÁà∂Á±ªÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ÔºåÂπ∂‰∏îÁà∂Á±ªÁöÑ‰æøÂà©ÊûÑÈÄ†Âô®‰ºöË∞ÉÁî®ËØ•ÊåáÂÆöÊûÑÈÄ†Âô®„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÁî±‰∫éÈáçÂÜôÔºåÂ∞±‰ºöÈÄ†ÊàêÂæ™ÁéØË∞ÉÁî®Ôºö ‰∏∫‰ªÄ‰πà‰ºöÊúâ‰∏§ÊÆµÂºèÊûÑÈÄ†ËøáÁ®ã ÂíåÂÖ∂‰ªñÁöÑËØ≠Ë®Ä‰∏çÂêåÔºö‰∏ÄËà¨ÁöÑËØ≠Ë®Ä‰∏çÊòØÁ¨¨‰∏ÄÂè•ËØùÈÉΩÊòØË∞ÉÁî® super ‰πàÔºåÁÑ∂ÂêéÂÜçËá™Â∑±‰øÆÊîπÂÄº„ÄÇSwift ÂàôÂøÖÈ°ªÂÖàÂàùÂßãÂåñÂ≠êÁ±ªÁöÑÂ±ûÊÄßÂêéÔºåÊâçËÉΩËøõË°åÂêéÈù¢ÁöÑ super„ÄÇ‰∏∫‰ªÄ‰πà‰∏ÄÂÆöË¶ÅËøôÊ†∑ÔºüÂõ†‰∏∫ÂÖ∂‰ªñËØ≠Ë®ÄÂèØ‰ª•ÂÖàÂ∞ÜÂ≠êÁ±ªÁöÑÂ±ûÊÄßÈªòËÆ§ËÆæ‰∏∫0ÊàñËÄÖ nilÔºåËÄå Swift ‰∏çË°åÔºå‰∏ç‰ºö‰∏∫ÈùûÂèØÈÄâÂ±ûÊÄßËÆæÁΩÆÂàùÂÄº„ÄÇ ÂÆâÂÖ®Ê£ÄÊü•2Ôºå3Ôºå4ÁöÑÁõÆÁöÑÂ∞±Áü•ÈÅì‰∫ÜÔºåËøô‰∏âÁßçÊÉÖÂÜµÈÉΩÊúâÂèØËÉΩÁî®Âà∞Êú™ËµãÂÄºÁöÑÈùûÂèØÈÄâÂ±ûÊÄßÔºàËÆ©Êüê‰∏™Â±ûÊÄßÁ≠â‰∫éÊüê‰∏™Êú™ËµãÂÄºÁöÑÂ±ûÊÄßÔºõÂú®Êüê‰∏™ÊñπÊ≥ï‰∏≠‰ΩøÁî®‰∫ÜÊú™ËµãÂÄºÁöÑÂ±ûÊÄßÔºâ ÂÆâÂÖ®Ê£ÄÊü•1‰∏≠Ôºå‰∏∫‰ªÄ‰πà‰∏ÄÂÆöË¶ÅËÆ©ËµãÂàùÂÄºÂú® super ÂâçÂë¢ÔºüÂõ†‰∏∫Áà∂Á±ªÁöÑË∞ÉÁî®‰πüÊúâÂèØËÉΩ‰ΩøÁî®Âà∞Êú™ËµãÂàùÂÄºÁöÑÂ≠êÁ±ªÂ±ûÊÄß„ÄÇÊØîÂ¶ÇÂ≠êÁ±ªÈáçÂÜô‰∫ÜÊüê‰∏™Áà∂Á±ªÁöÑÊñπÊ≥ïÔºåÁÑ∂ÂêéÁà∂Á±ªÁöÑÂàùÂßãÂåñÊñπÊ≥ï‰∏≠Ê≠£Â•ΩË∞ÉÁî®‰∫ÜËøô‰∏™ÊñπÊ≥ï„ÄÇÂÖ∑‰ΩìÂèØËßÅËØ¶ËßÅ Â≠êÁ±ªÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏ç‰ºöÁªßÊâøÁà∂Á±ªÁöÑÊûÑÈÄ†Âô® ÁªßÊâøÁöÑÊûÑÈÄ†Âô®‰∏ç‰ºö‰∏∫Â≠êÁ±ªÁöÑÈùûÂèØÈÄâÂ±ûÊÄßËÆæÁΩÆÂàùÂßãÂÄºÔºåÂ¶ÇÊûúÂì™Èáå‰ΩøÁî®Âà∞‰∫ÜËøô‰∏™Â±ûÊÄßÔºåÂ∞±Â∞Ü‰∫ßÁîüÂºÇÂ∏∏„ÄÇÊâÄ‰ª•Â≠êÁ±ª‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã‰∏ç‰ºöÁªßÊâøÁà∂Á±ªÁöÑÊûÑÈÄ†Âô®„ÄÇ Â≠êÁ±ª‰∏≠Êúâ‰∏éÁà∂Á±ªÂêåÂêçÁöÑ‰æøÂà©ÊûÑÈÄ†Âô®Ôºå‰∏çÁÆóÈáçÂÜôÔºå‰∏çÈúÄË¶ÅÂä†‰∏ä override ÈáçÂÜôÁöÑÊÑè‰πâÊòØÂèØ‰ª•Âú®Â≠êÁ±ª‰∏≠ÈÄöËøá super Ë∞ÉÁî®Áà∂Á±ªÁöÑÂêåÂêçÊñπÊ≥ïÔºåÂ¶ÇÊûú‰∏çÈúÄË¶ÅË∞ÉÁî®Áà∂Á±ªÁöÑËØ•ÊñπÊ≥ïÔºåÈÇ£‰πà‰∏çÂ¶ÇÁõ¥Êé•Ë¶ÜÁõñ„ÄÇËøôÈáåÁöÑ‰æøÂà©ÊûÑÈÄ†Âô®Â∞±ÊòØË¶ÜÁõñÔºåËÄå‰∏çÊòØÈáçÂÜôÔºåÂõ†‰∏∫‰∏çÂ≠òÂú®Â≠êÁ±ªË∞ÉÁî®Áà∂Á±ª‰æøÂà©ÊûÑÈÄ†Âô®ÁöÑÊÉÖÂÜµ„ÄÇ Áà∂Á±ª‰∏≠ÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ÔºåÂ≠êÁ±ªÂèØ‰ª•Â∞ÜÂÖ∂ÈáçÂÜô‰∏∫ÊåáÂÆöÊûÑÈÄ†Âô®Ôºå‰πüÂèØ‰ª•Â∞ÜÂÖ∂ÈáçÂÜô‰∏∫‰æøÂà©ÊûÑÈÄ†Âô® Âíå‰∏äÈù¢‰∏çÂêåÁöÑÊòØÔºåÁà∂Á±ªÁöÑÊåáÂÆöÊûÑÈÄ†Âô®ÊòØ‰ºöË¢´Ë∞ÉÁî®ÁöÑÔºåÊâÄ‰ª•Êó†ËÆ∫‰Ω†Âú®Â≠êÁ±ª‰∏≠Â∞ÜÂÖ∂ÂÆûÁé∞‰∏∫ÊåáÂÆöÊûÑÈÄ†Âô®ËøòÊòØ‰æøÂà©ÊûÑÈÄ†Âô®ÔºåÈÉΩÊòØÈáçÂÜôÔºåÈúÄË¶ÅÂä†‰∏ä override ‰∏∫‰ªÄ‰πàÂ≠êÁ±ªÊ≤°ÊúâÂÆûÁé∞ÊåáÂÆöÊûÑÈÄ†Âô®ÔºåÊàñËÄÖÈáçÂÜô‰∫ÜÊâÄÊúâÊåáÂÆöÊûÑÈÄ†Âô®ÔºåÂ∞±ËÉΩÁªßÊâøÁà∂Á±ªÊâÄÊúâÁöÑÊûÑÈÄ†Âô®Ôºü ÂâçÈù¢ËØ¥ËøáÔºåÈªòËÆ§‰∏çËÉΩÁªßÊâøÊòØÂõ†‰∏∫ÂèØËÉΩÂ≠òÂú®Â≠êÁ±ªË∞ÉÁî®Áà∂Á±ªÁªßÊâøËøáÊù•ÁöÑÊñπÊ≥ïÂêéÔºåËÆøÈóÆÊú™ËµãÂàùÂßãÂÄºÁöÑÂ±ûÊÄßÔºå‰∫ßÁîüÂºÇÂ∏∏„ÄÇËøôÈáåËÉΩÂ§üÁªßÊâøÊòØÂõ†‰∏∫Ôºö Ê≤°ÊúâÂÆûÁé∞‰ªªÊÑèÊåáÂÆöÊûÑÈÄ†Âô®ÔºåËØ¥ÊòéÂ≠êÁ±ªÊ≤°Êúâ‰ªª‰ΩïÊ≤°ÊúâÂàùÂßãÂÄºÁöÑÂ±ûÊÄß ÂÆûÁé∞‰∫ÜÊâÄÊúâÊåáÂÆöÊûÑÈÄ†Âô®ÔºåËØ¥ÊòéÂ≠êÁ±ªÂ∞ÜÊâÄÊúâÊ≤°ÊúâÂàùÂßãÂÄºÁöÑÂ±ûÊÄßÈÉΩÂ∑≤ÁªèËµã‰∫ÜÂàùÂÄº ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Â¶ÇÊûú‰∏Ä‰∏™Á±ª„ÄÅÁªìÊûÑ‰ΩìÊàñÊûö‰∏æÁ±ªÂûãÁöÑÂØπË±°ÔºåÂú®ÊûÑÈÄ†ËøáÁ®ã‰∏≠ÊúâÂèØËÉΩÂ§±Ë¥•ÔºåÂàô‰∏∫ÂÖ∂ÂÆö‰πâ‰∏Ä‰∏™ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®„ÄÇËøôÈáåÊâÄÊåáÁöÑ‚ÄúÂ§±Ë¥•‚ÄùÊòØÊåáÔºåÂ¶ÇÁªôÊûÑÈÄ†Âô®‰º†ÂÖ•Êó†ÊïàÁöÑÂèÇÊï∞ÂÄºÔºåÊàñÁº∫Â∞ëÊüêÁßçÊâÄÈúÄÁöÑÂ§ñÈÉ®ËµÑÊ∫êÔºåÂèàÊàñÊòØ‰∏çÊª°Ë∂≥ÊüêÁßçÂøÖË¶ÅÁöÑÊù°‰ª∂Á≠â„ÄÇ ‰∏∫‰∫ÜÂ¶•ÂñÑÂ§ÑÁêÜËøôÁßçÊûÑÈÄ†ËøáÁ®ã‰∏≠ÂèØËÉΩ‰ºöÂ§±Ë¥•ÁöÑÊÉÖÂÜµ„ÄÇ‰Ω†ÂèØ‰ª•Âú®‰∏Ä‰∏™Á±ªÔºåÁªìÊûÑ‰ΩìÊàñÊòØÊûö‰∏æÁ±ªÂûãÁöÑÂÆö‰πâ‰∏≠ÔºåÊ∑ªÂä†‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®„ÄÇÂÖ∂ËØ≠Ê≥ï‰∏∫Âú®initÂÖ≥ÈîÆÂ≠óÂêéÈù¢Ê∑ªÂä†ÈóÆÂè∑(init?)„ÄÇ ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÁöÑÂèÇÊï∞ÂêçÂíåÂèÇÊï∞Á±ªÂûãÔºå‰∏çËÉΩ‰∏éÂÖ∂ÂÆÉÈùûÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÁöÑÂèÇÊï∞ÂêçÔºåÂèäÂÖ∂ÂèÇÊï∞Á±ªÂûãÁõ∏Âêå„ÄÇ ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®‰ºöÂàõÂª∫‰∏Ä‰∏™Á±ªÂûã‰∏∫Ëá™Ë∫´Á±ªÂûãÁöÑÂèØÈÄâÁ±ªÂûãÁöÑÂØπË±°„ÄÇ‰Ω†ÈÄöËøáreturn nilËØ≠Âè•Êù•Ë°®ÊòéÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Âú®‰ΩïÁßçÊÉÖÂÜµ‰∏ãÂ∫îËØ•‚ÄúÂ§±Ë¥•‚Äù„ÄÇ ‰∏•Ê†ºÊù•ËØ¥ÔºåÊûÑÈÄ†Âô®ÈÉΩ‰∏çÊîØÊåÅËøîÂõûÂÄº„ÄÇÂõ†‰∏∫ÊûÑÈÄ†Âô®Êú¨Ë∫´ÁöÑ‰ΩúÁî®ÔºåÂè™ÊòØ‰∏∫‰∫ÜÁ°Æ‰øùÂØπË±°ËÉΩË¢´Ê≠£Á°ÆÊûÑÈÄ†„ÄÇÂõ†Ê≠§‰Ω†Âè™ÊòØÁî®return nilË°®ÊòéÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÊûÑÈÄ†Â§±Ë¥•ÔºåËÄå‰∏çË¶ÅÁî®ÂÖ≥ÈîÆÂ≠óreturnÊù•Ë°®ÊòéÊûÑÈÄ†ÊàêÂäü„ÄÇ ‰∏ã‰æã‰∏≠ÔºåÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫AnimalÁöÑÁªìÊûÑ‰ΩìÔºåÊ£ÄÊü•‰º†ÂÖ•ÂèÇÊï∞ÊòØÂê¶ÊòØÁ©∫Â≠óÁ¨¶‰∏≤„ÄÇÂ¶ÇÊûúÊòØÁ©∫Â≠óÁ¨¶‰∏≤ÔºåÈÇ£‰πàÊûÑÈÄ†Â§±Ë¥•„ÄÇÂê¶ÂàôÔºåspeciesÂ±ûÊÄßË¢´ËµãÂÄºÔºåÊûÑÈÄ†ÊàêÂäü„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÂÖÅËÆ∏Âú®Êüê‰∫õËá™Â∑±ËÆæÂÆöÁöÑÊÉÖÂÜµ‰∏ãÔºåÊûÑÈÄ†ËøîÂõû nil 1234567struct Animal &#123; let species: String init?(species: String) &#123; if species.isEmpty &#123; return nil &#125; self.species = species &#125;&#125; ‰Ω†ÂèØ‰ª•ÈÄöËøáËØ•ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Êù•ÊûÑÂª∫‰∏Ä‰∏™AnimalÁöÑÂÆû‰æãÔºåÂπ∂Ê£ÄÊü•ÊûÑÈÄ†ËøáÁ®ãÊòØÂê¶ÊàêÂäüÔºö 123456789101112131415let someCreature = Animal(species: "Giraffe")// someCreature ÁöÑÁ±ªÂûãÊòØ Animal? ËÄå‰∏çÊòØ Animalif let giraffe = someCreature &#123; print("An animal was initialized with a species of \(giraffe.species)")&#125;// ÊâìÂç∞ "An animal was initialized with a species of Giraffe"let anonymousCreature = Animal(species: "")// anonymousCreature ÁöÑÁ±ªÂûãÊòØ Animal?, ËÄå‰∏çÊòØ Animalif anonymousCreature == nil &#123; print("The anonymous creature could not be initialized")&#125;// ÊâìÂç∞ "The anonymous creature could not be initialized" Êûö‰∏æÁ±ªÂûãÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÂèØ‰ª•ÈÄöËøá‰∏Ä‰∏™Â∏¶‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂèÇÊï∞ÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Êù•Ëé∑ÂèñÊûö‰∏æÁ±ªÂûã‰∏≠ÁâπÂÆöÁöÑÊûö‰∏æÊàêÂëò„ÄÇÂ¶ÇÊûúÊèê‰æõÁöÑÂèÇÊï∞Êó†Ê≥ïÂåπÈÖç‰ªª‰ΩïÊûö‰∏æÊàêÂëòÔºåÂàôÊûÑÈÄ†Â§±Ë¥•„ÄÇ 123456789101112131415enum TemperatureUnit &#123; case Kelvin, Celsius, Fahrenheit init?(symbol: Character) &#123; switch symbol &#123; case "K": self = .Kelvin case "C": self = .Celsius case "F": self = .Fahrenheit default: return nil &#125; &#125;&#125; Â∏¶ÂéüÂßãÂÄºÁöÑÊûö‰∏æÁ±ªÂûãÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Â∏¶ÂéüÂßãÂÄºÁöÑÊûö‰∏æÁ±ªÂûã‰ºöËá™Â∏¶‰∏Ä‰∏™ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®init?(rawValue:)ÔºåËØ•ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Êúâ‰∏Ä‰∏™Âêç‰∏∫rawValueÁöÑÂèÇÊï∞ÔºåÂÖ∂Á±ªÂûãÂíåÊûö‰∏æÁ±ªÂûãÁöÑÂéüÂßãÂÄºÁ±ªÂûã‰∏ÄËá¥ÔºåÂ¶ÇÊûúËØ•ÂèÇÊï∞ÁöÑÂÄºËÉΩÂ§üÂíåÊüê‰∏™Êûö‰∏æÊàêÂëòÁöÑÂéüÂßãÂÄºÂåπÈÖçÔºåÂàôËØ•ÊûÑÈÄ†Âô®‰ºöÊûÑÈÄ†Áõ∏Â∫îÁöÑÊûö‰∏æÊàêÂëòÔºåÂê¶ÂàôÊûÑÈÄ†Â§±Ë¥•„ÄÇ Âõ†Ê≠§‰∏äÈù¢ÁöÑTemperatureUnitÁöÑ‰æãÂ≠êÂèØ‰ª•ÈáçÂÜô‰∏∫Ôºö 123456789101112131415enum TemperatureUnit: Character &#123; case Kelvin = "K", Celsius = "C", Fahrenheit = "F"&#125;let fahrenheitUnit = TemperatureUnit(rawValue: "F")if fahrenheitUnit != nil &#123; print("This is a defined temperature unit, so initialization succeeded.")&#125;// ÊâìÂç∞ "This is a defined temperature unit, so initialization succeeded."let unknownUnit = TemperatureUnit(rawValue: "X")if unknownUnit == nil &#123; print("This is not a defined temperature unit, so initialization failed.")&#125;// ÊâìÂç∞ "This is not a defined temperature unit, so initialization failed." ÊûÑÈÄ†Â§±Ë¥•ÁöÑ‰º†ÈÄíÁ±ªÔºåÁªìÊûÑ‰ΩìÔºåÊûö‰∏æÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÂèØ‰ª•Ê®™Âêë‰ª£ÁêÜÂà∞Á±ªÂûã‰∏≠ÁöÑÂÖ∂‰ªñÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®„ÄÇÁ±ª‰ººÁöÑÔºåÂ≠êÁ±ªÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®‰πüËÉΩÂêë‰∏ä‰ª£ÁêÜÂà∞Áà∂Á±ªÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®„ÄÇ Êó†ËÆ∫ÊòØÂêë‰∏ä‰ª£ÁêÜËøòÊòØÊ®™Âêë‰ª£ÁêÜÔºåÂ¶ÇÊûú‰Ω†‰ª£ÁêÜÂà∞ÁöÑÂÖ∂‰ªñÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Ëß¶ÂèëÊûÑÈÄ†Â§±Ë¥•ÔºåÊï¥‰∏™ÊûÑÈÄ†ËøáÁ®ãÂ∞ÜÁ´ãÂç≥ÁªàÊ≠¢ÔºåÊé•‰∏ãÊù•ÁöÑ‰ªª‰ΩïÊûÑÈÄ†‰ª£Á†Å‰∏ç‰ºöÂÜçË¢´ÊâßË°å„ÄÇ ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®‰πüÂèØ‰ª•‰ª£ÁêÜÂà∞ÂÖ∂ÂÆÉÁöÑÈùûÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®„ÄÇÈÄöËøáËøôÁßçÊñπÂºèÔºå‰Ω†ÂèØ‰ª•Â¢ûÂä†‰∏Ä‰∏™ÂèØËÉΩÁöÑÂ§±Ë¥•Áä∂ÊÄÅÂà∞Áé∞ÊúâÁöÑÊûÑÈÄ†ËøáÁ®ã‰∏≠„ÄÇ ÈáçÂÜô‰∏Ä‰∏™ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Áà∂Á±ªÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÂèØË¢´Â≠êÁ±ªÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÈáçÂÜôÔºå‰πüÂèØË¢´Â≠êÁ±ªÁöÑÈùûÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÈáçÂÜô„ÄÇ‰ΩÜÊòØÂèçËøáÊù•ÔºåÁà∂Á±ªÁöÑÈùûÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®‰∏çËÉΩË¢´Â≠êÁ±ªÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÈáçÂÜô„ÄÇ ‰∏∫‰ªÄ‰πà‰ºöÊúâËøôÊ†∑ÁöÑËßÑÂÆöÔºüËØïÊÉ≥‰∏Ä‰∏ã‰Ω†Ê≠£Âú®Â≠êÁ±ª‰∏≠Áî®‰∏Ä‰∏™ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÈáçÂÜôÁà∂Á±ªÈùûÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÔºåÁºñËØëÂô®ÊòØËÇØÂÆö‰ºöÊä•ÈîôÁöÑÔºåÈÇ£‰πà‰Ω†Â∫îËØ•ÊÄé‰πàÂÅöÔºü‰Ω†ÈúÄË¶ÅÂ∞ÜÂ≠êÁ±ª‰∏≠ÂèØÂ§±Ë¥•ÁöÑÊÉÖÂÜµÁßªÂà∞Áà∂Á±ª‰∏≠Âéª„ÄÇËøôÂ∞±‰ΩìÁé∞‰∫ÜËãπÊûúÁöÑËÆæËÆ°ÊÑèÂõæ‰∫Ü„ÄÇËØ∏Â¶ÇÂ≠óÁ¨¶‰∏≤‰∏∫Á©∫Á≠âÈÄ†ÊàêÊûÑÈÄ†Â§±Ë¥•ÁöÑÊÉÖÂÜµÊòØÂÖ±ÊÄßÁöÑÔºåËãπÊûúÂ∏åÊúõ‰Ω†Â∞ÜËøô‰∫õÊÉÖÂÜµÊîæÂú®Áà∂Á±ª‰∏≠Âà§Êñ≠„ÄÇËá≥‰∫éÂ≠êÁ±ª‰∏≠ÂÖÅËÆ∏ËøôÊ†∑ÁöÑÂèëÁîüÁöÑËØùÔºåÂ∞±ÂÜçÁî®ÈùûÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÈáçÂÜô„ÄÇ ‰∏Ä‰∏™ÈáçÂÜôÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®ÁöÑ‰æãÂ≠êÔºö 12345678910class Document &#123; var name: String? // ËØ•ÊûÑÈÄ†Âô®ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ name Â±ûÊÄßÁöÑÂÄº‰∏∫ nil ÁöÑ document ÂÆû‰æã init() &#123;&#125; // ËØ•ÊûÑÈÄ†Âô®ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ name Â±ûÊÄßÁöÑÂÄº‰∏∫ÈùûÁ©∫Â≠óÁ¨¶‰∏≤ÁöÑ document ÂÆû‰æã init?(name: String) &#123; self.name = name if name.isEmpty &#123; return nil &#125; &#125;&#125; ÂèØ‰ª•Âú®Â≠êÁ±ªÁöÑÈùûÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®‰∏≠‰ΩøÁî®Âº∫Âà∂Ëß£ÂåÖÊù•Ë∞ÉÁî®Áà∂Á±ªÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®„ÄÇÊØîÂ¶ÇÔºå‰∏ãÈù¢ÁöÑUntitledDocumentÂ≠êÁ±ªÁöÑnameÂ±ûÊÄßÁöÑÂÄºÊÄªÊòØ&quot;[Untitled]&quot;ÔºåÂÆÉÂú®ÊûÑÈÄ†ËøáÁ®ã‰∏≠‰ΩøÁî®‰∫ÜÁà∂Á±ªÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®init?(name:)Ôºö 12345class UntitledDocument: Document &#123; override init() &#123; super.init(name: "[Untitled]")! &#125;&#125; Âú®Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåÂ¶ÇÊûúÂú®Ë∞ÉÁî®Áà∂Á±ªÁöÑÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®init?(name:)Êó∂‰º†ÂÖ•ÁöÑÊòØÁ©∫Â≠óÁ¨¶‰∏≤ÔºåÈÇ£‰πàÂº∫Âà∂Ëß£ÂåÖÊìç‰Ωú‰ºöÂºïÂèëËøêË°åÊó∂ÈîôËØØ„ÄÇ ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô® init!ÈÄöÂ∏∏Êù•ËØ¥Êàë‰ª¨ÈÄöËøáÂú®initÂÖ≥ÈîÆÂ≠óÂêéÊ∑ªÂä†ÈóÆÂè∑ÁöÑÊñπÂºèÔºàinit?ÔºâÊù•ÂÆö‰πâ‰∏Ä‰∏™ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Ôºå‰ΩÜ‰Ω†‰πüÂèØ‰ª•ÈÄöËøáÂú®initÂêéÈù¢Ê∑ªÂä†ÊÉäÂèπÂè∑ÁöÑÊñπÂºèÊù•ÂÆö‰πâ‰∏Ä‰∏™ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Ôºàinit!ÔºâÔºåËØ•ÂèØÂ§±Ë¥•ÊûÑÈÄ†Âô®Â∞Ü‰ºöÊûÑÂª∫‰∏Ä‰∏™ÂØπÂ∫îÁ±ªÂûãÁöÑÈöêÂºèËß£ÂåÖÂèØÈÄâÁ±ªÂûãÁöÑÂØπË±°„ÄÇ ‰Ω†ÂèØ‰ª•Âú®init?‰∏≠‰ª£ÁêÜÂà∞init!ÔºåÂèç‰πã‰∫¶ÁÑ∂„ÄÇ‰Ω†‰πüÂèØ‰ª•Áî®init?ÈáçÂÜôinit!ÔºåÂèç‰πã‰∫¶ÁÑ∂„ÄÇ‰Ω†ËøòÂèØ‰ª•Áî®init‰ª£ÁêÜÂà∞init!Ôºå‰∏çËøáÔºå‰∏ÄÊó¶init!ÊûÑÈÄ†Â§±Ë¥•ÔºåÂàô‰ºöËß¶Âèë‰∏Ä‰∏™Êñ≠Ë®Ä„ÄÇ ËøôÈáå self.init!() ÂÖ∂ÂÆûÁ≠â‰ª∑‰∫é self.init?()!„ÄÇËøôÊ†∑ÂÜôÊõ¥Êñπ‰æø‰∏Ä‰∫õ„ÄÇ ËøôÂíåÂèòÈáèÁöÑÂº∫Âà∂Ëß£ÂåÖÊúâ‰∏ÄÂÆöÁöÑÂå∫Âà´„ÄÇÂèòÈáèÁöÑÂº∫Âà∂Ëß£ÂåÖÊòØÂèòÈáèÂú®ÂÖ∂‰ªñÂú∞Êñπ‰ª•ÂèØÈÄâÁöÑÂΩ¢ÂºèÂ≠òÂú®ÔºåÂèØ‰ª•‰∏∫nilÔºåËÄåÊüê‰∫õÂú∞ÊñπÈúÄË¶ÅË°®Áé∞‰∏∫ÈùûÂèØÈÄâÔºå‰∏çËÉΩ‰∏∫nil„ÄÇËÄåËøôÈáå‰Ω†ÊòØÂàõÂª∫ÁöÑÊó∂ÂÄôÂ∞±ËøõË°å‰∫ÜÈöêÂºèËß£ÂåÖÔºåÂÖ∂‰ªñÂú∞ÊñπÊ†πÊú¨‰∏ç‰ºöÁî®Âà∞ÂÖ∂‰∏∫ nil ÁöÑÂΩ¢Âºè„ÄÇÂ¶ÇÊûú‰Ω†ÊÉ≥ÂàõÂª∫‰∏Ä‰∏™ÈùûÁ©∫ÁöÑÂÆû‰æãÔºå‰∏∫‰ªÄ‰πà‰∏çÁõ¥Êé•Áî®ÈùûÂèØÈÄâÊûÑÈÄ†Âô®Ôºü Âõ†‰∏∫ËøôÈáåÂ∞±ÊòØÊÉ≥Ë¶ÅÂú®Êüê‰∫õÊûÑÈÄ†Â§±Ë¥•ÁöÑÊÉÖÂÜµ‰∏ãËß¶ÂèëÊñ≠Ë®Ä„ÄÇÁ≠âÂêå‰∫éÈùûÂèØÈÄâÁöÑ init ÊñπÊ≥ï‰∏≠ÔºåÂú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÊâãÂä®ÊäõÂá∫ÂºÇÂ∏∏„ÄÇ ÂøÖË¶ÅÊûÑÈÄ†Âô®Âú®Á±ªÁöÑÊûÑÈÄ†Âô®ÂâçÊ∑ªÂä†required‰øÆÈ•∞Á¨¶Ë°®ÊòéÊâÄÊúâËØ•Á±ªÁöÑÂ≠êÁ±ªÈÉΩÂøÖÈ°ªÂÆûÁé∞ËØ•ÊûÑÈÄ†Âô®Ôºö 12345class SomeClass &#123; required init() &#123; // ÊûÑÈÄ†Âô®ÁöÑÂÆûÁé∞‰ª£Á†Å &#125;&#125; Âú®Â≠êÁ±ªÈáçÂÜôÁà∂Á±ªÁöÑÂøÖË¶ÅÊûÑÈÄ†Âô®Êó∂ÔºåÂøÖÈ°ªÂú®Â≠êÁ±ªÁöÑÊûÑÈÄ†Âô®Ââç‰πüÊ∑ªÂä†required‰øÆÈ•∞Á¨¶ÔºåË°®ÊòéËØ•ÊûÑÈÄ†Âô®Ë¶ÅÊ±Ç‰πüÂ∫îÁî®‰∫éÁªßÊâøÈìæÂêéÈù¢ÁöÑÂ≠êÁ±ª„ÄÇÂú®ÈáçÂÜôÁà∂Á±ª‰∏≠ÂøÖË¶ÅÁöÑÊåáÂÆöÊûÑÈÄ†Âô®Êó∂Ôºå‰∏çÈúÄË¶ÅÊ∑ªÂä†override‰øÆÈ•∞Á¨¶Ôºö 12345class SomeSubclass: SomeClass &#123; required init() &#123; // ÊûÑÈÄ†Âô®ÁöÑÂÆûÁé∞‰ª£Á†Å &#125;&#125; required Ë°®Á§∫ÊâÄÊúâÂ≠êÁ±ªÈÉΩÂøÖÈ°ªÂÆûÁé∞Ëøô‰∏™ÊûÑÈÄ†Âô®ÔºåËÄå‰∏çÊòØËØ¥ÔºåÂè™Ë¶Å‰∏Ä‰∏™Â≠êÁ±ªÂÆûÁé∞Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ ÈÄöËøáÈó≠ÂåÖÊàñÂáΩÊï∞ËÆæÁΩÆÂ±ûÊÄßÁöÑÈªòËÆ§ÂÄºÂ¶ÇÊûúÊüê‰∏™Â≠òÂÇ®ÂûãÂ±ûÊÄßÁöÑÈªòËÆ§ÂÄºÈúÄË¶Å‰∏Ä‰∫õÂÆöÂà∂ÊàñËÆæÁΩÆÔºå‰Ω†ÂèØ‰ª•‰ΩøÁî®Èó≠ÂåÖÊàñÂÖ®Â±ÄÂáΩÊï∞‰∏∫ÂÖ∂Êèê‰æõÂÆöÂà∂ÁöÑÈªòËÆ§ÂÄº„ÄÇÊØèÂΩìÊüê‰∏™Â±ûÊÄßÊâÄÂú®Á±ªÂûãÁöÑÊñ∞ÂÆû‰æãË¢´ÂàõÂª∫Êó∂ÔºåÂØπÂ∫îÁöÑÈó≠ÂåÖÊàñÂáΩÊï∞‰ºöË¢´Ë∞ÉÁî®ÔºåËÄåÂÆÉ‰ª¨ÁöÑËøîÂõûÂÄº‰ºöÂΩìÂÅöÈªòËÆ§ÂÄºËµãÂÄºÁªôËøô‰∏™Â±ûÊÄß„ÄÇ ËøôÁßçÁ±ªÂûãÁöÑÈó≠ÂåÖÊàñÂáΩÊï∞ÈÄöÂ∏∏‰ºöÂàõÂª∫‰∏Ä‰∏™Ë∑üÂ±ûÊÄßÁ±ªÂûãÁõ∏ÂêåÁöÑ‰∏¥Êó∂ÂèòÈáèÔºåÁÑ∂Âêé‰øÆÊîπÂÆÉÁöÑÂÄº‰ª•Êª°Ë∂≥È¢ÑÊúüÁöÑÂàùÂßãÁä∂ÊÄÅÔºåÊúÄÂêéËøîÂõûËøô‰∏™‰∏¥Êó∂ÂèòÈáèÔºå‰Ωú‰∏∫Â±ûÊÄßÁöÑÈªòËÆ§ÂÄº„ÄÇ 1234567class SomeClass &#123; let someProperty: SomeType = &#123; // Âú®Ëøô‰∏™Èó≠ÂåÖ‰∏≠Áªô someProperty ÂàõÂª∫‰∏Ä‰∏™ÈªòËÆ§ÂÄº // someValue ÂøÖÈ°ªÂíå SomeType Á±ªÂûãÁõ∏Âêå return someValue &#125;()&#125; Ê≥®ÊÑèÈó≠ÂåÖÁªìÂ∞æÁöÑÂ§ßÊã¨Âè∑ÂêéÈù¢Êé•‰∫Ü‰∏ÄÂØπÁ©∫ÁöÑÂ∞èÊã¨Âè∑„ÄÇËøôÁî®Êù•ÂëäËØâ Swift Á´ãÂç≥ÊâßË°åÊ≠§Èó≠ÂåÖ„ÄÇÂ¶ÇÊûú‰Ω†ÂøΩÁï•‰∫ÜËøôÂØπÊã¨Âè∑ÔºåÁõ∏ÂΩì‰∫éÂ∞ÜÈó≠ÂåÖÊú¨Ë∫´‰Ωú‰∏∫ÂÄºËµãÂÄºÁªô‰∫ÜÂ±ûÊÄßÔºåËÄå‰∏çÊòØÂ∞ÜÈó≠ÂåÖÁöÑËøîÂõûÂÄºËµãÂÄºÁªôÂ±ûÊÄß„ÄÇ Â¶ÇÊûú‰Ω†‰ΩøÁî®Èó≠ÂåÖÊù•ÂàùÂßãÂåñÂ±ûÊÄßÔºåËØ∑ËÆ∞‰ΩèÂú®Èó≠ÂåÖÊâßË°åÊó∂ÔºåÂÆû‰æãÁöÑÂÖ∂ÂÆÉÈÉ®ÂàÜÈÉΩËøòÊ≤°ÊúâÂàùÂßãÂåñ„ÄÇËøôÊÑèÂë≥ÁùÄ‰Ω†‰∏çËÉΩÂú®Èó≠ÂåÖÈáåËÆøÈóÆÂÖ∂ÂÆÉÂ±ûÊÄßÔºåÂç≥‰ΩøËøô‰∫õÂ±ûÊÄßÊúâÈªòËÆ§ÂÄº„ÄÇÂêåÊ†∑Ôºå‰Ω†‰πü‰∏çËÉΩ‰ΩøÁî®ÈöêÂºèÁöÑselfÂ±ûÊÄßÔºåÊàñËÄÖË∞ÉÁî®‰ªª‰ΩïÂÆû‰æãÊñπÊ≥ï„ÄÇ Â¶ÇÊûú‰∏ÄÂÆöÊÉ≥Ë¶ÅÁî®Âà∞selfÁ≠âÊÄé‰πàÂäûÔºåÂ∞ÜËØ•Â±ûÊÄßËÆæÁΩÆ‰∏∫ lazy„ÄÇ‰ΩøÁî®ÊáíÂä†ËΩΩÂ∞±ËÉΩ‰øùËØÅËØ•Â±ûÊÄß‰∏ÄÂÆöÂú®ÂØπË±°ÂàùÂßãÂåñÂÆåÊàêÂêéÂÜçÂàùÂßãÂåñ‰∫Ü ‰∏ÄÂÆöÊ≥®ÊÑèÂå∫ÂàÜÈó≠ÂåÖÂíåËÆ°ÁÆóÂûãÂ±ûÊÄßÁöÑ‰∏çÂêåÔºåÈó≠ÂåÖÊòØ‰∏™ËµãÂÄºÊìç‰ΩúÔºå‰∏îÊúÄÂêéÊúâ‰∏Ä‰∏™ÊâßË°åÈó≠ÂåÖÁöÑ ()„ÄÇËÆ°ÁÆóÂûãÂ±ûÊÄßÂàôÊòØÁõ¥Êé•Â∞ÜËÆ°ÁÆóÊñπÂºèÂÜôÂú®Â±ûÊÄßÂêéÈù¢ ‰æãÂ¶Ç‰∏ãÈù¢ÂàùÂßãÂåñ‰∏Ä‰∏™Ë•øÊ¥ãÊ£ãÁõòÔºàÈªëÁôΩÁõ∏Èó¥ÈÇ£ÁßçÔºâÔºö 1234567891011121314151617181920212223struct Checkerboard &#123; let boardColors: [Bool] = &#123; var temporaryBoard = [Bool]() var isBlack = false for i in 1...8 &#123; for j in 1...8 &#123; temporaryBoard.append(isBlack) isBlack = !isBlack &#125; isBlack = !isBlack &#125; return temporaryBoard &#125;() func squareIsBlackAtRow(row: Int, column: Int) -&gt; Bool &#123; return boardColors[(row * 8) + column] &#125;&#125;let board = Checkerboard()print(board.squareIsBlackAtRow(0, column: 1))// ÊâìÂç∞ "true"print(board.squareIsBlackAtRow(7, column: 7))// ÊâìÂç∞ "false"]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Swift 3.1 ËØ≠Ê≥ïÂ≠¶‰π†Ôºà‰∏âÔºâ]]></title>
    <url>%2F2017%2F02%2F22%2Fswift%E8%AF%AD%E6%B3%953%2F</url>
    <content type="text"><![CDATA[Êé•ÁùÄ‰∏ä‰∏ÄÁØá Êûö‰∏æÊûö‰∏æËØ≠Ê≥ï‰ΩøÁî®enumÂÖ≥ÈîÆËØçÊù•ÂàõÂª∫Êûö‰∏æÂπ∂‰∏îÊääÂÆÉ‰ª¨ÁöÑÊï¥‰∏™ÂÆö‰πâÊîæÂú®‰∏ÄÂØπÂ§ßÊã¨Âè∑ÂÜÖÔºö 123enum SomeEnumeration &#123; // Êûö‰∏æÂÆö‰πâÊîæÂú®ËøôÈáå&#125; ‰æãÂ≠ê: 123456enum CompassPoint &#123; case North case South case East case West&#125; Ê≥®ÊÑèÊØè‰∏Ä‰∏™ case Êù•ÂÆö‰πâ‰∏Ä‰∏™Êñ∞ÁöÑÊûö‰∏æÊàêÂëò„ÄÇÂ¶ÇÊûúÂá∫Áé∞Âú®Âêå‰∏ÄË°å‰∏äÔºåÈúÄË¶ÅÁî®ÈÄóÂè∑ÈöîÂºÄÔºö 123enum Planet &#123; case Mercury, Venus, Earth, Mars, Jupiter, Saturn, Uranus, Neptune&#125; Âíå oc ‰∏çÂêåÔºåËøôÈáåÁöÑÊûö‰∏æÂÄº‰∏ç‰ºöË¢´ÂÆåÂÖ®ÁöÑÈöêÂºèËµãÂÄº‰∏∫ 0Ôºå1Ôºå2Ôºå3Ôºà‰ΩÜÊòØÂ¶ÇÊûú‰Ω†ÁªôÂÆö‰∫ÜÂÖ∂‰∏≠‰∏Ä‰∏™ÁöÑÂÄºÔºåÂÖ∂‰ªñÁöÑÂÄºÂèØ‰ª•Ë¢´ÈöêÂºèÂú∞Êé®Êñ≠Âá∫Êù•Ôºâ„ÄÇËøô‰∫õÊûö‰∏æÊàêÂëòÊú¨Ë∫´Â∞±ÊòØÂÆåÂ§áÁöÑÂÄºÔºåÊØîÂ¶ÇÊúÄ‰∏äÈù¢ÁöÑËøô‰∫õÂÄºÁöÑÁ±ªÂûãÊòØÂ∑≤ÁªèÊòéÁ°ÆÂÆö‰πâÂ•ΩÁöÑ CompassPoint Á±ªÂûã„ÄÇ ‰ΩøÁî®ÊñπÂºèÔºö 1var directionToHead = CompassPoint.West directionToHeadÁöÑÁ±ªÂûãÂèØ‰ª•Âú®ÂÆÉË¢´CompassPointÁöÑÊüê‰∏™ÂÄºÂàùÂßãÂåñÊó∂Êé®Êñ≠Âá∫Êù•„ÄÇ‰∏ÄÊó¶directionToHeadË¢´Â£∞Êòé‰∏∫CompassPointÁ±ªÂûãÔºå‰Ω†ÂèØ‰ª•‰ΩøÁî®Êõ¥ÁÆÄÁü≠ÁöÑÁÇπËØ≠Ê≥ïÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫Âè¶‰∏Ä‰∏™CompassPointÁöÑÂÄºÔºö 1directionToHead = .East ‰ΩøÁî® switch Êûö‰∏æÂèØ‰ª•‰ΩøÁî® switch ÂåπÈÖçÊûö‰∏æÂÄºÔºö 1234567891011121314directionToHead = .Southswitch directionToHead &#123; case .North: print("Lots of planets have a north") case .South: print("Watch out for penguins") case .East: print("Where the sun rises") case .West: print("Where the skies are blue") default: print("Not a safe place for humans")&#125;// ËæìÂá∫ "Watch out for penguins‚Äù ÂÖ≥ËÅîÂÄºÊúâ‰∫õÊó∂ÂÄôÊûö‰∏æÂÄº‰ºöÈúÄË¶ÅÂ≠òÂÇ®‰∏Ä‰∫õÂÖ≥ËÅîÂÄº‰ª•Êñπ‰æø‰ΩøÁî®ÔºåÊØîÂ¶ÇÔºö 1234enum Barcode &#123; case UPCA(Int, Int, Int, Int) case QRCode(String)&#125; Ë°®Á§∫ UPCA ÂÖ∑Êúâ (IntÔºåIntÔºåIntÔºåInt) ÁöÑÂÖ≥ËÅîÂÄºÔºåQRCode ÂÖ∑Êúâ String ÁöÑÂÖ≥ËÅîÂÄº„ÄÇ‰ΩøÁî®Ôºö 12var productBarcode = Barcode.UPCA(8, 85909, 51226, 3)productBarcode = .QRCode("ABCDEFGHIJKLMNOP") Á±ªÂûãÊé®Êñ≠‰∏∫ BarcodeÔºåÂÖ≥ËÅîÂÄºÂè™ÊòØÈôÑÂä†‰ø°ÊÅØÔºå‰æø‰∫éÂ≠òÂÇ®‰∏Ä‰∫õÂøÖË¶Å‰ø°ÊÅØ„ÄÇÊØîÂ¶ÇÂú®‰ΩøÁî® switch ËØ≠Âè•Êó∂ÔºåÂèØ‰ª•Â∞ÜÂÖ≥ËÅîÂÄºÊèêÂèñÂá∫Êù•ÔºåÂ∞±ÂèØ‰ª•Âú®ÊâßË°åËØ≠Âè•‰∏≠‰ΩøÁî®„ÄÇÂèØ‰ª•Âú®switchÁöÑ case ÂàÜÊîØ‰ª£Á†Å‰∏≠ÊèêÂèñÊØè‰∏™ÂÖ≥ËÅîÂÄº‰Ωú‰∏∫‰∏Ä‰∏™Â∏∏ÈáèÔºàÁî®letÂâçÁºÄÔºâÊàñËÄÖ‰Ωú‰∏∫‰∏Ä‰∏™ÂèòÈáèÔºàÁî®varÂâçÁºÄÔºâÊù•‰ΩøÁî®Ôºö 1234567switch productBarcode &#123;case .UPCA(let numberSystem, let manufacturer, let product, let check): print("UPC-A: \(numberSystem), \(manufacturer), \(product), \(check).")case .QRCode(let productCode): print("QR code: \(productCode).")&#125;// ËæìÂá∫ "QR code: ABCDEFGHIJKLMNOP." ‰∏∫‰∫ÜÁÆÄÊ¥ÅÔºåÂèØ‰ª•Â∞ÜletÊàñËÄÖvar ÊèêÂèñÂá∫Êù•Ôºö 1234567switch productBarcode &#123;case let .UPCA(numberSystem, manufacturer, product, check): print("UPC-A: \(numberSystem), \(manufacturer), \(product), \(check).")case let .QRCode(productCode): print("QR code: \(productCode).")&#125;// ËæìÂá∫ "QR code: ABCDEFGHIJKLMNOP." ÂéüÂßãÂÄºÂéüÂßãÂÄºÁöÑÂÆö‰πâÂíå oc ‰∏≠Êûö‰∏æÁöÑÊïàÊûúÂæàÂÉè„ÄÇÂèØ‰ª•‰∏∫ÊØè‰∏™Êûö‰∏æÊàêÂëòÂÆö‰πâ‰∏Ä‰∏™ÈªòËÆ§ÂÄº„ÄÇËøô‰∫õÈªòËÆ§ÂÄºÁöÑÁ±ªÂûãÂøÖÈ°ªÁõ∏ÂêåÔºö 12345enum ASCIIControlCharacter: Character &#123; case Tab = "\t" case LineFeed = "\n" case CarriageReturn = "\r"&#125; ÂÖ∂‰∏≠ÔºåÂ∞ÜÊûö‰∏æÁ±ªÂûãÂÆö‰πâ‰∏∫Â≠óÁ¨¶‰∏≤Á±ªÂûã„ÄÇÂéüÂßãÂÄºËøòÂèØ‰ª•ÊòØÂ≠óÁ¨¶Ôºå‰ªªÊÑèÊï¥ÂΩ¢ÊàñÊµÆÁÇπÂûãÂÄº„ÄÇ Ê≥®ÊÑèÔºåÂéüÂßãÂÄºÂíåÂÖ≥ËÅîÂÄºÊòØ‰∏çÂêåÁöÑ„ÄÇÂéüÂßãÂÄºÊòØÂÆö‰πâÊûö‰∏æÊó∂Ë¢´È¢ÑÂÖàÂ°´ÂÖÖÁöÑÂÄº„ÄÇÂØπ‰∫é‰∏Ä‰∏™ÁâπÂÆöÁöÑÊûö‰∏æÊàêÂëòÔºåÂéüÂßãÂÄºÂßãÁªà‰∏çÂèò„ÄÇÂÖ≥ËÅîÂÄºÊòØÂàõÂª∫‰∏Ä‰∏™Âü∫‰∫éÊûö‰∏æÊàêÂëòÁöÑÂ∏∏ÈáèÊàñÂèòÈáèÊó∂ÊâçËÆæÁΩÆÁöÑÂÄºÔºåÊûö‰∏æÊàêÂëòÁöÑÂÖ≥ËÅîÂÄºÂèØ‰ª•ÂèòÂåñ„ÄÇ ÂÖ≥ËÅîÂÄºÂíåÂéüÂßãÂÄº‰∏çËÉΩÂêåÊó∂Ê∑∑Âêà‰ΩøÁî® ÂéüÂßãÂÄºÁöÑÈöêÂºèËµãÂÄº‰ΩøÁî®Êï¥Êï∞ÊàñËÄÖÂ≠óÁ¨¶‰∏≤‰Ωú‰∏∫ÂéüÂßãÂÄºÊûö‰∏æÊó∂Ôºå‰∏çÈúÄË¶ÅÊòæÂºèËµãÂÄºÔºåSwift ‰ºöËá™Âä®ËµãÂÄºÔºö 123enum Planet: Int &#123; case Mercury = 1, Venus, Earth, Mars, Jupiter, Saturn, Uranus, Neptune&#125; Âú®‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåPlant.MercuryÁöÑÊòæÂºèÂéüÂßãÂÄº‰∏∫1ÔºåPlanet.VenusÁöÑÈöêÂºèÂéüÂßãÂÄº‰∏∫2„ÄÇ ÂΩì‰ΩøÁî®Â≠óÁ¨¶‰∏≤‰Ωú‰∏∫Êûö‰∏æÁ±ªÂûãÁöÑÂéüÂßãÂÄºÊó∂ÔºåÊØè‰∏™Êûö‰∏æÊàêÂëòÁöÑÈöêÂºèÂéüÂßãÂÄº‰∏∫ËØ•Êûö‰∏æÊàêÂëòÁöÑÂêçÁß∞Ôºö 123enum CompassPoint: String &#123; case North, South, East, West&#125; ‰∏äÈù¢‰æãÂ≠ê‰∏≠ÔºåCompassPoint.SouthÊã•ÊúâÈöêÂºèÂéüÂßãÂÄºSouthÔºåÂç≥Â∞±ÊòØÂÖ∂Êú¨Áîü„ÄÇÂèØ‰ª•‰ΩøÁî®Êûö‰∏æÊàêÂëòÁöÑrawValueÂ±ûÊÄßÂèØ‰ª•ËÆøÈóÆËØ•Êûö‰∏æÊàêÂëòÁöÑÂéüÂßãÂÄºÔºö 12345let earthsOrder = Planet.Earth.rawValue// earthsOrder ÂÄº‰∏∫ 3let sunsetDirection = CompassPoint.West.rawValue// sunsetDirection ÂÄº‰∏∫ "West" ËøôÈáåÊãøÂá∫‰∫Ü rawValueÔºåÈÇ£‰πà earthsOrder ÂíåsunsetDirection Â∞±ÊòØÊòéÁ°ÆÁöÑÂÄº‰∫ÜÔºåËÄå‰∏çÊòØÊûö‰∏æÁ±ªÂûã„ÄÇ ‰ΩøÁî®ÂéüÂßãÂÄºÂàùÂßãÂåñÊûö‰∏æÂÆû‰æãÂ¶ÇÊûúÂú®ÂÆö‰πâÊûö‰∏æÁ±ªÂûãÁöÑÊó∂ÂÄô‰ΩøÁî®‰∫ÜÂéüÂßãÂÄºÔºåÈÇ£‰πàÂ∞Ü‰ºöËá™Âä®Ëé∑Âæó‰∏Ä‰∏™ÂàùÂßãÂåñÊñπÊ≥ïÔºåËøô‰∏™ÊñπÊ≥ïÊé•Êî∂‰∏Ä‰∏™Âè´ÂÅörawValueÁöÑÂèÇÊï∞ÔºåÂèÇÊï∞Á±ªÂûãÂç≥‰∏∫ÂéüÂßãÂÄºÁ±ªÂûãÔºåËøîÂõûÂÄºÂàôÊòØÊûö‰∏æÊàêÂëòÊàñnil„ÄÇ‰Ω†ÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™ÂàùÂßãÂåñÊñπÊ≥ïÊù•ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÊûö‰∏æÂÆû‰æã„ÄÇ ÊØîÂ¶ÇÂà©Áî®ÂéüÂßãÂÄº7ÂàõÂª∫‰∫ÜÊûö‰∏æÊàêÂëòUranusÔºö 12let possiblePlanet = Planet(rawValue: 7)// possiblePlanet Á±ªÂûã‰∏∫ Planet? ÂÄº‰∏∫ Planet.Uranus ÂéüÂßãÂÄºÊûÑÈÄ†Âô®ÊÄªÊòØËøîÂõû‰∏Ä‰∏™ÂèØÈÄâÁöÑÊûö‰∏æÊàêÂëòÔºåÂõ†‰∏∫ÂèØËÉΩÊ≤°ÊúâÂØπÂ∫îÁöÑÊûö‰∏æÁ±ªÂûã„ÄÇÂú®‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåpossiblePlanetÊòØPlanet?Á±ªÂûã„ÄÇ Á±ªÂíåÁªìÊûÑ‰ΩìÂÆö‰πâËØ≠Ê≥ï‰ΩøÁî® class Âíå struct ÂàÜÂà´Ë°®Á§∫Á±ªÂíåÁªìÊûÑ‰Ωì„ÄÇÁ§∫‰æãÂ¶Ç‰∏ãÔºö 12345678910struct Resolution &#123; var width = 0 var height = 0&#125;class VideoMode &#123; var resolution = Resolution() var interlaced = false var frameRate = 0.0 var name: String?&#125; ËøôÈáåÈù¢ÂèØ‰ª•Ê≥®ÊÑè‰∏ÄÁÇπ„ÄÇÂ∞±ÊòØÂØπ‰∫éÂèòÈáèËøõË°å‰∫ÜÂàùÂßãÂåñ„ÄÇËøôÊ†∑Êúâ‰ªÄ‰πàÂ•ΩÂ§ÑÂë¢ÔºüÂèØ‰ª•‰Ωø swift ËøõË°åÁ±ªÂûãÊé®Êñ≠Âá∫ÂΩìÂâçÂèòÈáèÁöÑÁ±ªÂûã„ÄÇÂú® swift ‰∏≠ÔºåÊØè‰∏™ÂèòÈáèÁöÑÁ±ªÂûãÈÉΩÂøÖÈ°ªÊòØÁ°ÆÂÆöÁöÑ„ÄÇ Á±ªÂíåÁªìÊûÑ‰ΩìÂÆû‰æãÂàõÂª∫Á±ªÂíåÁªìÊûÑ‰ΩìÂÆû‰æãÁöÑËØ≠Ê≥ïÁõ∏‰ººÔºö 12let someResolution = Resolution()let someVideoMode = VideoMode() ÈÄöËøáËøôÁßçÊñπÂºèÊâÄÂàõÂª∫ÁöÑÁ±ªÊàñËÄÖÁªìÊûÑ‰ΩìÂÆû‰æãÔºåÂÖ∂Â±ûÊÄßÂùá‰ºöË¢´ÂàùÂßãÂåñ‰∏∫ÈªòËÆ§ÂÄº„ÄÇÊõ¥Â§öÊûÑÈÄ†ËøáÁ®ãÂú®ÂêéÈù¢Â∞Ü‰ºöÊõ¥ËØ¶ÁªÜÁöÑËÆ®ËÆ∫„ÄÇ Â±ûÊÄßËÆøÈóÆÈÄöËøá . ËØ≠Ê≥ïÔºåÂèØ‰ª•ËÆøÈóÆÂÆû‰æãÁöÑÂ±ûÊÄß„ÄÇ‰∏é oc ‰∏çÂêåÁöÑÊòØÔºåSwift ÂÖÅËÆ∏Áõ¥Êé•ËÆæÁΩÆÁªìÊûÑ‰ΩìÂ±ûÊÄßÁöÑÂ≠êÂ±ûÊÄß„ÄÇÂèçÊ≠£ÈÄöËøá . ‰ªÄ‰πàÈÉΩËÉΩÊãøÂà∞Â∞±ÊòØ‰∫Ü„ÄÇ ÁªìÊûÑ‰ΩìÁ±ªÂûãÁöÑÊàêÂëòÈÄê‰∏ÄÊûÑÈÄ†Âô®ÊâÄÊúâÁªìÊûÑ‰ΩìÔºàÁâπÊåáÁªìÊûÑ‰ΩìÔºâÈÉΩÊúâ‰∏Ä‰∏™Ëá™Âä®ÁîüÊàêÁöÑÊàêÂëòÈÄê‰∏ÄÊûÑÈÄ†Âô®ÔºåÁî®‰∫éÂàùÂßãÂåñÊñ∞ÁªìÊûÑ‰ΩìÂÆû‰æã‰∏≠ÊàêÂëòÁöÑÂ±ûÊÄß„ÄÇÊñ∞ÂÆû‰æã‰∏≠ÂêÑ‰∏™Â±ûÊÄßÁöÑÂàùÂßãÂÄºÂèØ‰ª•ÈÄöËøáÂ±ûÊÄßÁöÑÂêçÁß∞‰º†ÈÄíÂà∞ÊàêÂëòÈÄê‰∏ÄÊûÑÈÄ†Âô®‰πã‰∏≠Ôºö 1let vga = Resolution(width:640, height: 480) ‰∏éÁªìÊûÑ‰Ωì‰∏çÂêåÔºåÁ±ªÂÆû‰æãÊ≤°ÊúâÈªòËÆ§ÁöÑÊàêÂëòÈÄê‰∏ÄÊûÑÈÄ†Âô®„ÄÇËØ¶ÁªÜËßÅÂêéÈù¢„ÄÇ ÁªìÊûÑ‰ΩìÂíåÊûö‰∏æÊòØÂÄºÁ±ªÂûã‰ªÄ‰πàÊòØÂÄºÁ±ªÂûãÔºüÂ∞±ÊòØÊàë‰ª¨ÊâÄËØ¥ÁöÑÂÄº‰º†ÈÄíÂíåÂºïÁî®‰º†ÈÄí‰∏≠ÁöÑÂÄº‰º†ÈÄí„ÄÇÊåáÂú®Ë¢´ËµãÁªô‰∏Ä‰∏™ÂèòÈáèÂ∏∏ÈáèÊàñËÄÖ‰º†ÈÄíÁªô‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÊó∂ÂÄôÔºåÂÄº‰ºöË¢´Êã∑Ë¥ù„ÄÇ ÊâÄÊúâÁöÑÂü∫Êú¨Á±ªÂûãÈÉΩÊòØÂÄºÊã∑Ë¥ùËøôÂíå‰ª•ÂâçÊØ´Êó†ÂºÇËÆÆ„ÄÇ‰ΩÜÊòØÂú® Swift ‰∏≠ÔºåÂ≠óÁ¨¶‰∏≤„ÄÅÊï∞ÁªÑÂíåÂ≠óÂÖ∏‰πüÊòØÂÄºÊã∑Ë¥ùÔºåËøôÂíå oc ‰∏≠Âæà‰∏çÁõ∏Âêå„ÄÇËøôÊÑèÂë≥ÁùÄÊï∞ÁªÑÂíåÂ≠óÂÖ∏‰∏≠ÁöÑÊâÄÊúâÂÖÉÁ¥†ÈÉΩ‰ºöË¢´Êã∑Ë¥ù‰∏Ä‰ªΩ„ÄÇÂÖ∂ÂÆûÊòØÂõ†‰∏∫ÂÆÉ‰ª¨Â∫ïÂ±ÇÈÉΩÊòØ‰ª•ÁªìÊûÑ‰ΩìÁöÑÂΩ¢ÂºèÂÆûÁé∞ÁöÑ„ÄÇ 12let hd = Resolution(width: 1920, height: 1080)var cinema = hd ‰æãÂ¶Ç‰∏äÈù¢ÁöÑ‰æãÂ≠êÔºåcinema Âíå hd Áõ∏ÂêåÔºå‰ΩÜÂÖ∂ÂÆûÂú®ÂÜÖÂ≠ò‰∏≠ÊòØ‰∏§‰∏™‰∏çÂêåÁöÑÂØπË±°„ÄÇ‰øÆÊîπÂÖ∂‰∏≠‰∏Ä‰∏™ÁöÑÂÄº‰∏ç‰ºöÊîπÂèòÂè¶‰∏Ä‰∏™ÂÆû‰æãÁõ∏Â∫îÂ±ûÊÄßÁöÑÂÄº„ÄÇÊûö‰∏æÂêåÊ†∑„ÄÇ ËøôÈáåÂè™ÊòØÊï∞ÁªÑÂØπË±°‰ºöË¢´ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÔºå‰ΩÜÊòØÊï∞ÁªÑÈáåÁöÑÂØπË±°ÈÉΩÊòØÂºïÁî®Á±ªÂûã„ÄÇ Á±ªÊòØÂºïÁî®Á±ªÂûãËøôÁÇπÊ≤°Âï•‰∏çÂêåÁöÑ„ÄÇÂ∞±ÊòØ‰∏çÂêåÂ∏∏ÈáèÊàñËÄÖÂèòÈáèÊåáÂêëÂÜÖÂ≠ò‰∏äÁöÑÁõ∏ÂêåÂú∞ÂùÄ„ÄÇ ÊÅíÁ≠âËøêÁÆóÁ¨¶Swift ‰∏≠ÂÜÖÂª∫‰∫Ü‰∏§‰∏™ÊÅíÁ≠âËøêÁÆóÁ¨¶Ôºö Á≠â‰ª∑‰∫éÔºà===Ôºâ ‰∏çÁ≠â‰ª∑‰∫é Ôºà!==Ôºâ Ê≥®ÊÑèËøôÂíå‚ÄúÁ≠â‰∫é‚Äù == Êúâ‰ªÄ‰πàÂå∫Âà´Âë¢Ôºü ‚ÄúÁ≠â‰ª∑‰∫é‚ÄùË°®Á§∫‰∏§‰∏™Á±ªÁ±ªÂûã(Ê≥®ÊÑèÂè™ËÉΩÁî®Âú®Á±ªÁ±ªÂûã‰∏≠)ÁöÑÂ∏∏ÈáèÊàñËÄÖÂèòÈáèÂºïÁî®Âêå‰∏Ä‰∏™Á±ªÂÆû‰æã„ÄÇ ‚ÄúÁ≠â‰∫é‚ÄùË°®Á§∫‰∏§‰∏™ÂÆû‰æãÁöÑÂÄº‚ÄúÁõ∏Á≠â‚ÄùÊàñ‚ÄúÁõ∏Âêå‚Äù„ÄÇ ‰πüÂ∞±ÊòØËØ¥ === ‰∏∫ true ÔºåÈÇ£‰πà‰∏§‰∏™Á±ªÂÆû‰æãÂøÖÁÑ∂ÊåáÂêëÂêå‰∏ÄÂùóÂÜÖÂ≠òÂú∞ÂùÄ„ÄÇ== ‰∏∫ true ÂàôÂè™Ë¶ÅÁ±ªÂÜÖÂ±ûÊÄßÁõ∏ÂêåÂç≥ÂèØ„ÄÇÔºàoc ‰∏≠ÁöÑ == Â∞±ÊòØËøôÈáåÁöÑ ===ÔºåÊØîËæÉÁöÑÊòØÊåáÈíàÂú∞ÂùÄ„ÄÇ ‰∏ÄËà¨ÂØπË±°Áõ∏Á≠âÈÉΩÊòØÊØîËæÉÂú∞ÂùÄÔºåÂç≥ ===„ÄÇÂ¶ÇÊûúË¶Å‰ΩøÁî® == ÂøÖÈ°ªË¶ÅÂÆûÁé∞ Equatable ÂçèËÆÆ„ÄÇÂú® Equatable ÈáåÂ£∞Êòé‰∫ÜËøô‰∏™Êìç‰ΩúÁ¨¶ÁöÑÊé•Âè£ÊñπÊ≥ï: 123protocol Equatable &#123; func ==(lhs: Self, rhs: Self) -&gt; Bool&#125; ÂÆûÁé∞ÂÆÉÔºö 123456789101112131415161718class MyClass: Equatable &#123; let myProperty: String init(s: String) &#123; myProperty = s &#125;&#125;func ==(lhs: MyClass, rhs: MyClass) -&gt; Bool &#123; return lhs.myProperty == rhs.myProperty&#125;let myClass1 = MyClass(s: "Hello")let myClass2 = MyClass(s: "Hello")myClass1 == myClass2 // truemyClass1 != myClass2 // falsemyClass1 === myClass2 // falsemyClass1 !== myClass2 // true Á±ªÂíåÁªìÊûÑ‰ΩìÁöÑÈÄâÊã©ÁªìÊûÑ‰ΩìÂÆû‰æãÊÄªÊòØÈÄöËøáÂÄº‰º†ÈÄíÔºåÁ±ªÂÆû‰æãÊÄªÊòØÈÄöËøáÂºïÁî®‰º†ÈÄí„ÄÇËøôÊÑèÂë≥‰∏§ËÄÖÈÄÇÁî®‰∏çÂêåÁöÑ‰ªªÂä°„ÄÇ ÂÖ∂ÂÆûÂ§ßÈÉ®ÂàÜÊï∞ÊçÆÊûÑÈÄ†ÈÉΩÊòØÁî®Á±ªÔºåËÄåÈùûÁªìÊûÑ‰Ωì„ÄÇÂè™ÊúâÂú®Êï∞ÊçÆÁªìÊûÑÈùûÂ∏∏ÁÆÄÂçïÁöÑÊó∂ÂÄôÁî®ÁªìÊûÑ‰Ωì„ÄÇ Â≠óÁ¨¶‰∏≤„ÄÅÊï∞ÁªÑ„ÄÅÂ≠óÂÖ∏ÁöÑËµãÂÄºÂíåÂ§çÂà∂Ë°å‰∏∫‰∏äÈù¢‰πüËØ¥Ëøá‰∫Ü Swift ‰∏≠ÁöÑ StringÔºåArrayÂíåDictionaryÁ±ªÂûãÂùá‰ª•ÁªìÊûÑ‰ΩìÁöÑÂΩ¢ÂºèÂÆûÁé∞„ÄÇËøôÊÑèÂë≥ÁùÄË¢´ËµãÂÄºÁªôÊñ∞ÁöÑÂ∏∏ÈáèÊàñÂèòÈáèÔºåÊàñËÄÖË¢´‰º†ÂÖ•ÂáΩÊï∞ÊàñÊñπÊ≥ï‰∏≠Êó∂ÔºåÂÆÉ‰ª¨ÁöÑÂÄº‰ºöË¢´Êã∑Ë¥ù„ÄÇ Objective-C ‰∏≠NSArrayÂíåNSDictionaryÁ±ªÂûãÂùá‰ª•Á±ªÁöÑÂΩ¢ÂºèÂÆûÁé∞ÔºåËÄåÂπ∂ÈùûÁªìÊûÑ‰Ωì„ÄÇÂÆÉ‰ª¨Âú®Ë¢´ËµãÂÄºÊàñËÄÖË¢´‰º†ÂÖ•ÂáΩÊï∞ÊàñÊñπÊ≥ïÊó∂Ôºå‰∏ç‰ºöÂèëÁîüÂÄºÊã∑Ë¥ùÔºåËÄåÊòØ‰º†ÈÄíÁé∞ÊúâÂÆû‰æãÁöÑÂºïÁî®„ÄÇ ‰∏çËøá‰∏çÁî®ÊãÖÂøÉÂÄºÊã∑Ë¥ù‰ºöÂΩ±ÂìçÊñ∞ËÉΩÔºåSwift ‰∏≠Êúâ‰ºòÂåñ„ÄÇ Â±ûÊÄßÂ≠òÂÇ®Â±ûÊÄßÁ±ªÂíåÁªìÊûÑ‰Ωì‰∏≠Áî® var ÊàñËÄÖ let ‰øÆÈ•∞ÁöÑÂ∞±ÊòØÂ≠òÂÇ®Â±ûÊÄßÔºö 12345678struct FixedLengthRange &#123; var firstValue: Int let length: Int&#125;var rangeOfThreeItems = FixedLengthRange(firstValue: 0, length: 3)// ËØ•Âå∫Èó¥Ë°®Á§∫Êï¥Êï∞0Ôºå1Ôºå2rangeOfThreeItems.firstValue = 6// ËØ•Âå∫Èó¥Áé∞Âú®Ë°®Á§∫Êï¥Êï∞6Ôºå7Ôºå8 Â∏∏ÈáèÁªìÊûÑ‰ΩìÁöÑÂ≠òÂÇ®Â±ûÊÄßÂ¶ÇÊûúÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÁöÑÂÆû‰æãÂπ∂Â∞ÜÂÖ∂ËµãÂÄºÁªô‰∏Ä‰∏™Â∏∏ÈáèÔºåÂàôÊó†Ê≥ï‰øÆÊîπËØ•ÂÆû‰æãÁöÑ‰ªª‰ΩïÂ±ûÊÄßÔºåÂç≥‰ΩøÊúâÂ±ûÊÄßË¢´Â£∞Êòé‰∏∫ÂèòÈáè‰πü‰∏çË°åÔºö 1234let rangeOfFourItems = FixedLengthRange(firstValue: 0, length: 4)// ËØ•Âå∫Èó¥Ë°®Á§∫Êï¥Êï∞0Ôºå1Ôºå2Ôºå3rangeOfFourItems.firstValue = 6// Â∞ΩÁÆ° firstValue ÊòØ‰∏™ÂèòÈáèÂ±ûÊÄßÔºåËøôÈáåËøòÊòØ‰ºöÊä•Èîô Âõ†‰∏∫ rangeOfFourItems Ë¢´Â£∞ÊòéÊàê‰∫ÜÂ∏∏ÈáèÔºàÁî® let ÂÖ≥ÈîÆÂ≠óÔºâÔºåÂç≥‰Ωø firstValue ÊòØ‰∏Ä‰∏™ÂèòÈáèÂ±ûÊÄßÔºå‰πüÊó†Ê≥ïÂÜç‰øÆÊîπÂÆÉ‰∫Ü„ÄÇ ËøôÁßçË°å‰∏∫ÊòØÁî±‰∫éÁªìÊûÑ‰ΩìÔºàstructÔºâÂ±û‰∫éÂÄºÁ±ªÂûã„ÄÇÂΩìÂÄºÁ±ªÂûãÁöÑÂÆû‰æãË¢´Â£∞Êòé‰∏∫Â∏∏ÈáèÁöÑÊó∂ÂÄôÔºåÂÆÉÁöÑÊâÄÊúâÂ±ûÊÄß‰πüÂ∞±Êàê‰∫ÜÂ∏∏Èáè„ÄÇÂ±û‰∫éÂºïÁî®Á±ªÂûãÁöÑÁ±ªÔºàclassÔºâÂàô‰∏ç‰∏ÄÊ†∑„ÄÇÊää‰∏Ä‰∏™ÂºïÁî®Á±ªÂûãÁöÑÂÆû‰æãËµãÁªô‰∏Ä‰∏™Â∏∏ÈáèÂêéÔºå‰ªçÁÑ∂ÂèØ‰ª•‰øÆÊîπËØ•ÂÆû‰æãÁöÑÂèòÈáèÂ±ûÊÄß„ÄÇ Âõ†Ê≠§Êï∞ÁªÑÂ≠óÂÖ∏Á≠âÂ¶ÇÊûúËÆæÁΩÆ‰∏∫ let ÔºåÈÇ£‰πàÊï∞ÁªÑÂ≠óÂÖ∏‰∏≠ÁöÑÈ°πÔºåÂÄºÁ±ªÂûãÊó†Ê≥ïÁªôÂÜÖÂÆπÔºåÂºïÁî®Á±ªÂûãÊó†Ê≥ïÊîπÂú∞ÂùÄ Âª∂ËøüÂ≠òÂÇ®Â±ûÊÄßÊåáÂΩìÁ¨¨‰∏ÄÊ¨°Ë¢´Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÊâç‰ºöËÆ°ÁÆóÂÖ∂ÂàùÂßãÂÄºÁöÑÂ±ûÊÄß„ÄÇÂú®Â±ûÊÄßÂ£∞ÊòéÂâç‰ΩøÁî® lazy Êù•Ê†áËØÜ„ÄÇÊ≥®ÊÑèÔºåÂª∂ËøüÂ≠òÂÇ®Â±ûÊÄßÂøÖÈ°ªË¢´Â£∞Êòé‰∏∫ var„ÄÇ 12345678910111213141516171819class DataImporter &#123; /* DataImporter ÊòØ‰∏Ä‰∏™Ë¥üË¥£Â∞ÜÂ§ñÈÉ®Êñá‰ª∂‰∏≠ÁöÑÊï∞ÊçÆÂØºÂÖ•ÁöÑÁ±ª„ÄÇ Ëøô‰∏™Á±ªÁöÑÂàùÂßãÂåñ‰ºöÊ∂àËÄó‰∏çÂ∞ëÊó∂Èó¥„ÄÇ */ var fileName = "data.txt" // ËøôÈáå‰ºöÊèê‰æõÊï∞ÊçÆÂØºÂÖ•ÂäüËÉΩ&#125;class DataManager &#123; lazy var importer = DataImporter() var data = [String]() // ËøôÈáå‰ºöÊèê‰æõÊï∞ÊçÆÁÆ°ÁêÜÂäüËÉΩ&#125;let manager = DataManager()manager.data.append("Some data")manager.data.append("Some more data")// DataImporter ÂÆû‰æãÁöÑ importer Â±ûÊÄßËøòÊ≤°ÊúâË¢´ÂàõÂª∫ ‰∏äÈù¢Ëøô‰∏™Á±ª‰∏≠ÔºåDataImporter ÊòØ‰∏Ä‰∏™ÂæàË¥πÊó∂ÁöÑÊìç‰Ωú„ÄÇÊâÄ‰ª•ËÆæÁΩÆ‰∏∫ lazyÔºåÂè™ÊúâÂú®Á¨¨‰∏ÄÊ¨°ËÆøÈóÆÂà∞ÁöÑÊó∂ÂÄôÊâç‰ºöË¢´ÂàõÂª∫„ÄÇ ËÆ°ÁÆóÂ±ûÊÄßËÆ°ÁÆóÂ±ûÊÄß‰∏çÁõ¥Êé•Â≠òÂÇ®ÂÄºÔºåËÄåÊòØÊèê‰æõ‰∏Ä‰∏™ getter Âíå‰∏Ä‰∏™ÂèØÈÄâÁöÑ setterÔºåÊù•Èó¥Êé•Ëé∑ÂèñÂíåËÆæÁΩÆÂÖ∂‰ªñÂ±ûÊÄßÊàñÂèòÈáèÁöÑÂÄº„ÄÇÂÖ∂ÂÆûÂ∞±ÊòØÊØèÊ¨°ÁÇπÂà∞Ëøô‰∏™Â±ûÊÄßÁöÑÊó∂ÂÄôÈÉΩ‰ºöÂÜçËÆ°ÁÆó‰∏ÄÈÅçÔºåÈÄÇÁî®‰∫é‰ºöÊ†πÊçÆÂÖ∂‰ªñÂÄºÂèòÂåñÁöÑÂ±ûÊÄßÔºåËøôÊ†∑Â∞±‰∏çÁî®ÊØèÊ¨°Áî®Âà∞ÁöÑÊó∂ÂÄô‰∏ìÈó®Ë∞ÉÁî®‰∏Ä‰∏™Â§ÑÁêÜÊñπÊ≥ï‰∫Ü„ÄÇËÄåÊòØÁî±Á≥ªÁªüÁõ¥Êé•Ë∞ÉÁî®‰∫Ü getter ÊñπÊ≥ï 123456789101112131415161718192021222324252627struct Point &#123; var x = 0.0, y = 0.0&#125;struct Size &#123; var width = 0.0, height = 0.0&#125;struct Rect &#123; var origin = Point() var size = Size() var center: Point &#123; get &#123; let centerX = origin.x + (size.width / 2) let centerY = origin.y + (size.height / 2) return Point(x: centerX, y: centerY) &#125; set(newCenter) &#123; origin.x = newCenter.x - (size.width / 2) origin.y = newCenter.y - (size.height / 2) &#125; &#125;&#125;var square = Rect(origin: Point(x: 0.0, y: 0.0), size: Size(width: 10.0, height: 10.0))let initialSquareCenter = square.centersquare.center = Point(x: 15.0, y: 15.0)print("square.origin is now at (\(square.origin.x), \(square.origin.y))")// ËæìÂá∫ "square.origin is now at (10.0, 10.0)‚Äù ‰∏äÈù¢Ëøô‰∏™Áü©ÂΩ¢ÁöÑÁ±ªÔºåÈÄöËøá origin Âíå size Êù•ËÆ°ÁÆóÂá∫ center„ÄÇÂÖ∂‰∏≠ setter ÊñπÊ≥ïÁöÑ newCenter Áî±‰∫éÁ±ªÂûãÊé®Êñ≠ÔºåÈªòËÆ§‰∏∫ Point Á±ªÂûãÔºåÂ∞±‰∏çÁî®ÂÜçÂÜôÊòéÁ±ªÂûã‰∫Ü„ÄÇ ËøôÈáåË¶ÅÂº∫Ë∞É‰∏ÄÁÇπ„ÄÇËÆ°ÁÆóÂ±ûÊÄßÁöÑ set ÊñπÊ≥ïÂú® init ÊñπÊ≥ï‰∏≠ÊòØ‰∏ç‰ºöË¢´Ë∞ÉÁî®ÁöÑ„ÄÇÂ¶ÇÊûú‰Ω†Âú®ÂàùÂßãÂåñÊñπÊ≥ï‰∏≠ÁªôËÆ°ÁÆóÂ±ûÊÄßËµãÂÄº‰∫ÜÔºåÈÇ£‰πàËøô‰∏™ËÆ°ÁÆóÂ±ûÊÄßÁõ¥Êé•Â∞±Á≠â‰∫éËøô‰∏™ÂÄºÔºåËÄå‰∏çÊòØÂÜçË∞ÉÁî® setter ÊñπÊ≥ï„ÄÇ ‰æøÊç∑ setter Â£∞ÊòéÁî±‰∫é setter ÂáΩÊï∞ÂøÖÁÑ∂Ë¶Å‰º†ÂÖ•‰∏Ä‰∏™Êñ∞ÂÄºÔºåÊâÄ‰ª• Swift ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÈªòËÆ§ÂêçÁß∞ newValue„ÄÇÊâÄ‰ª•ÂèØ‰ª•ÈááÂèñÁÆÄÁï•ÁöÑÂΩ¢ÂºèÔºö 123456789101112131415struct AlternativeRect &#123; var origin = Point() var size = Size() var center: Point &#123; get &#123; let centerX = origin.x + (size.width / 2) let centerY = origin.y + (size.height / 2) return Point(x: centerX, y: centerY) &#125; set &#123; origin.x = newValue.x - (size.width / 2) origin.y = newValue.y - (size.height / 2) &#125; &#125;&#125; Âè™ËØªËÆ°ÁÆóÂ±ûÊÄßÂè™Êúâ getter Ê≤°Êúâ setter ÁöÑËÆ°ÁÆóÂ±ûÊÄßÂ∞±ÊòØÂè™ËØªËÆ°ÁÆóÂ±ûÊÄß„ÄÇÂè™ËØªËÆ°ÁÆóÂ±ûÊÄßÊÄªÊòØËøîÂõû‰∏Ä‰∏™ÂÄºÔºåÂèØ‰ª•ÈÄöËøáÁÇπËøêÁÆóÁ¨¶ËÆøÈóÆÔºå‰ΩÜ‰∏çËÉΩËÆæÁΩÆÊñ∞ÁöÑÂÄº„ÄÇ Â¶ÇÊûúÊòØÂè™ËØªËÆ°ÁÆóÂ±ûÊÄßÔºåÈÇ£‰πàËøû get ÂÖ≥ÈîÆÂ≠óÈÉΩÂèØ‰ª•ÊâîÊéâ‰∫ÜÔºö 123456789struct Cuboid &#123; var width = 0.0, height = 0.0, depth = 0.0 var volume: Double &#123; return width * height * depth &#125;&#125;let fourByFiveByTwo = Cuboid(width: 4.0, height: 5.0, depth: 2.0)print("the volume of fourByFiveByTwo is \(fourByFiveByTwo.volume)")// ËæìÂá∫ "the volume of fourByFiveByTwo is 40.0" Â±ûÊÄßËßÇÂØüÂô®ÂèØ‰ª•ÁõëÂê¨Â±ûÊÄßÂÄºÁöÑÂèòÂåñÔºàÂèØ‰ª•‰∏∫Èô§‰∫ÜÂª∂ËøüÂ≠òÂÇ®Â±ûÊÄß‰πãÂ§ñÁöÑÂÖ∂‰ªñÂ≠òÂÇ®Â±ûÊÄßÊ∑ªÂä†Â±ûÊÄßËßÇÂØüÂô®ÔºåÂõ†‰∏∫ÂèØ‰ª•ÈÄöËøá setter ÊñπÊ≥ïÁõ¥Êé•ÁõëÊéßÔºâ„ÄÇ Êèê‰æõ‰∫Ü‰∏§‰∏™Â±ûÊÄßËßÇÂØüÂô®Ôºö willSet Êñ∞ÂÄºË¢´ËÆæÁΩÆÂâçË∞ÉÁî® didSet Êñ∞ÂÄºË¢´ËÆæÁΩÆÂêéË∞ÉÁî® willSet Êé•ÂèóÊñ∞ÁöÑÂ±ûÊÄßÂÄº‰Ωú‰∏∫Â∏∏Èáè‰º†ÂÖ•ÔºåÂèØ‰ª•Ëá™Â∑±ÊåáÂÆöËøô‰∏™ÂèÇÊï∞ÁöÑÂêçÁß∞„ÄÇÂ¶ÇÊûú‰∏çÊåáÂÆöÔºåÈªòËÆ§ÂêçÁß∞‰∏∫ newValue„ÄÇ didSet Â∞ÜÊóßÁöÑÂ±ûÊÄßÂÄº‰º†ÂÖ•Ôºå‰∏çÊé•ÂèóËá™ÂÆö‰πâÂèÇÊï∞ÂêçÔºåÈªòËÆ§ÂèÇÊï∞Âêç‰∏∫ oldValue„ÄÇÂ¶ÇÊûúÂú® didSet ÊñπÊ≥ï‰∏≠ÂÜçÊ¨°ÂØπËØ•Â±ûÊÄßËµãÂÄºÔºåÈÇ£‰πàÊñ∞ÂÄº‰ºöË¶ÜÁõñÊóßÁöÑÂÄº„ÄÇ 12345678910111213141516171819202122class StepCounter &#123; var totalSteps: Int = 0 &#123; willSet(newTotalSteps) &#123; print("About to set totalSteps to \(newTotalSteps)") &#125; didSet &#123; if totalSteps &gt; oldValue &#123; print("Added \(totalSteps - oldValue) steps") &#125; &#125; &#125;&#125;let stepCounter = StepCounter()stepCounter.totalSteps = 200// About to set totalSteps to 200// Added 200 stepsstepCounter.totalSteps = 360// About to set totalSteps to 360// Added 160 stepsstepCounter.totalSteps = 896// About to set totalSteps to 896// Added 536 steps Â¶ÇÊûúÂ∞ÜÂ±ûÊÄßÈÄöËøá in-out ÊñπÂºè‰º†ÂÖ•ÂáΩÊï∞ÔºåwillSet Âíå didSet ‰πü‰ºöË∞ÉÁî®„ÄÇËøôÊòØÂõ†‰∏∫ in-out ÂèÇÊï∞ÈááÁî®‰∫ÜÊã∑ÂÖ•Êã∑Âá∫Ê®°ÂºèÔºöÂç≥Âú®ÂáΩÊï∞ÂÜÖÈÉ®‰ΩøÁî®ÁöÑÊòØÂèÇÊï∞ÁöÑ copyÔºåÂáΩÊï∞ÁªìÊùüÂêéÔºåÂèàÂØπÂèÇÊï∞ÈáçÊñ∞ËµãÂÄº„ÄÇ Ëøô‰∏™Êù•ÂÆûÁé∞ kvo ÂÖ®Â±ÄÂèòÈáèÂíåÂ±ÄÈÉ®ÂèòÈáèÂÖ®Â±ÄÂèòÈáèÊòØÂú®ÂáΩÊï∞„ÄÅÊñπÊ≥ï„ÄÅÈó≠ÂåÖÊàñ‰ªª‰ΩïÁ±ªÂûã‰πãÂ§ñÂÆö‰πâÁöÑÂèòÈáè„ÄÇÂ±ÄÈÉ®ÂèòÈáèÊòØÂú®ÂáΩÊï∞„ÄÅÊñπÊ≥ïÊàñÈó≠ÂåÖÂÜÖÈÉ®ÂÆö‰πâÁöÑÂèòÈáè„ÄÇ ÂÖ®Â±ÄÁöÑÂ∏∏ÈáèÊàñÂèòÈáèÈÉΩÊòØÂª∂ËøüËÆ°ÁÆóÁöÑÔºåË∑üÂª∂ËøüÂ≠òÂÇ®Â±ûÊÄßÁõ∏‰ººÔºå‰∏çÂêåÁöÑÂú∞ÊñπÂú®‰∫éÔºåÂÖ®Â±ÄÁöÑÂ∏∏ÈáèÊàñÂèòÈáè‰∏çÈúÄË¶ÅÊ†áËÆ∞lazy‰øÆÈ•∞Á¨¶„ÄÇÂ±ÄÈÉ®ËåÉÂõ¥ÁöÑÂ∏∏ÈáèÊàñÂèòÈáè‰ªé‰∏çÂª∂ËøüËÆ°ÁÆó„ÄÇ Á±ªÂûãÂ±ûÊÄßÂÆû‰æãÂ±ûÊÄßÂ±û‰∫é‰∏Ä‰∏™ÁâπÂÆöÁ±ªÂûãÁöÑÂÆû‰æãÔºåÊØèÂàõÂª∫‰∏Ä‰∏™ÂÆû‰æãÔºåÂÆû‰æãÈÉΩÊã•ÊúâÂ±û‰∫éËá™Â∑±ÁöÑ‰∏ÄÂ•óÂ±ûÊÄßÂÄºÔºåÂÆû‰æã‰πãÈó¥ÁöÑÂ±ûÊÄßÁõ∏‰∫íÁã¨Á´ã„ÄÇÁ±ª‰ºº‰∫éÈùôÊÄÅÂèòÈáèÊàñÂ∏∏Èáè„ÄÇ Ë∑üÂÆû‰æãÁöÑÂ≠òÂÇ®ÂûãÂ±ûÊÄß‰∏çÂêåÔºåÂøÖÈ°ªÁªôÂ≠òÂÇ®ÂûãÁ±ªÂûãÂ±ûÊÄßÊåáÂÆöÈªòËÆ§ÂÄºÔºåÂõ†‰∏∫Á±ªÂûãÊú¨Ë∫´Ê≤°ÊúâÊûÑÈÄ†Âô®Ôºå‰πüÂ∞±Êó†Ê≥ïÂú®ÂàùÂßãÂåñËøáÁ®ã‰∏≠‰ΩøÁî®ÊûÑÈÄ†Âô®ÁªôÁ±ªÂûãÂ±ûÊÄßËµãÂÄº„ÄÇÂ≠òÂÇ®ÂûãÁ±ªÂûãÂ±ûÊÄßÊòØÂª∂ËøüÂàùÂßãÂåñÁöÑÔºåÂÆÉ‰ª¨Âè™ÊúâÂú®Á¨¨‰∏ÄÊ¨°Ë¢´ËÆøÈóÆÁöÑÊó∂ÂÄôÊâç‰ºöË¢´ÂàùÂßãÂåñ„ÄÇÂç≥‰ΩøÂÆÉ‰ª¨Ë¢´Â§ö‰∏™Á∫øÁ®ãÂêåÊó∂ËÆøÈóÆÔºåÁ≥ªÁªü‰πü‰øùËØÅÂè™‰ºöÂØπÂÖ∂ËøõË°å‰∏ÄÊ¨°ÂàùÂßãÂåñÔºåÂπ∂‰∏î‰∏çÈúÄË¶ÅÂØπÂÖ∂‰ΩøÁî® lazy ‰øÆÈ•∞Á¨¶„ÄÇ Á±ªÂûãÂ±ûÊÄßËØ≠Ê≥ïÂú® Swift ‰∏≠ÔºåÁ±ªÂûãÂ±ûÊÄßÊòØ‰Ωú‰∏∫Á±ªÂûãÂÆö‰πâÁöÑ‰∏ÄÈÉ®ÂàÜÂÜôÂú®Á±ªÂûãÊúÄÂ§ñÂ±ÇÁöÑËä±Êã¨Âè∑ÂÜÖÔºåÂõ†Ê≠§ÂÆÉÁöÑ‰ΩúÁî®ËåÉÂõ¥‰πüÂ∞±Âú®Á±ªÂûãÊîØÊåÅÁöÑËåÉÂõ¥ÂÜÖ„ÄÇ ‰ΩøÁî®ÂÖ≥ÈîÆÂ≠ó static Êù•ÂÆö‰πâÁ±ªÂûãÂ±ûÊÄß„ÄÇÂú®‰∏∫Á±ªÂÆö‰πâËÆ°ÁÆóÂûãÁ±ªÂûãÂ±ûÊÄßÊó∂ÔºåÂèØ‰ª•ÊîπÁî®ÂÖ≥ÈîÆÂ≠ó class Êù•ÊîØÊåÅÂ≠êÁ±ªÂØπÁà∂Á±ªÁöÑÂÆûÁé∞ËøõË°åÈáçÂÜô„ÄÇ‰∏ãÈù¢ÁöÑ‰æãÂ≠êÊºîÁ§∫‰∫ÜÂ≠òÂÇ®ÂûãÂíåËÆ°ÁÆóÂûãÁ±ªÂûãÂ±ûÊÄßÁöÑËØ≠Ê≥ïÔºö 123456789101112131415161718192021struct SomeStructure &#123; static var storedTypeProperty = "Some value." static var computedTypeProperty: Int &#123; return 1 &#125;&#125;enum SomeEnumeration &#123; static var storedTypeProperty = "Some value." static var computedTypeProperty: Int &#123; return 6 &#125;&#125;class SomeClass &#123; static var storedTypeProperty = "Some value." static var computedTypeProperty: Int &#123; return 27 &#125; class var overrideableComputedTypeProperty: Int &#123; return 107 &#125;&#125; ‰ΩøÁî®‰∫Ü classÔºåÂ≠êÁ±ªÊâçËÉΩÁü•ÈÅìËøô‰∏™ËÆ°ÁÆóÂûãÂ±ûÊÄßÊòØÂèØ‰ª•ÈáçÂÜôÁöÑÔºåÈáçÂÜôÁöÑÊó∂ÂÄôË¶ÅÂä†‰∏ä override Ë°®Á§∫Ôºö 12345class OverridedClass: SomeClass &#123; override class var overrideableComputedTypeProperty: Int &#123; return 20 &#125;&#125; ÂÖ∂ÂÆûËÆ°ÁÆóÂûãÂ±ûÊÄßÂ∞±Áõ∏ÂΩì‰∫éÊòØ‰∏™ÊñπÊ≥ï„ÄÇ Ëé∑ÂèñÂíåËÆæÁΩÆÁ±ªÂûãÂ±ûÊÄßÁöÑÂÄºÁ±ªÂûãÂ±ûÊÄßÈÄöËøáÁ±ªÂûãÊú¨Ë∫´ËÆøÈóÆÔºö 123456789print(SomeStructure.storedTypeProperty)// ËæìÂá∫ "Some value."SomeStructure.storedTypeProperty = "Another value."print(SomeStructure.storedTypeProperty)// ËæìÂá∫ "Another value.‚Äùprint(SomeEnumeration.computedTypeProperty)// ËæìÂá∫ "6"print(SomeClass.computedTypeProperty)// ËæìÂá∫ "27" ÊñπÊ≥ïÁ±ª„ÄÅÁªìÊûÑ‰Ωì„ÄÅÊûö‰∏æÈÉΩÂèØ‰ª•ÂÆö‰πâÂÆû‰æã„ÄÅÁ±ªÂûãÊñπÊ≥ïÔºàËøôÂíå oc ‰∏≠‰∏çÂêåÔºåoc Âè™ËÉΩÂú®Á±ª‰∏≠ÂÆö‰πâÊñπÊ≥ïÔºâ„ÄÇ ÂÆû‰æãÊñπÊ≥ïÂÆû‰æãÊñπÊ≥ïÁöÑËØ≠Ê≥ïÂíåÂáΩÊï∞ÂÆåÂÖ®‰∏ÄËá¥Ôºö 123456789101112class Counter &#123; var count = 0 func increment() &#123; count += 1 &#125; func incrementBy(amount: Int) &#123; count += amount &#125; func reset() &#123; count = 0 &#125;&#125; ÂíåË∞ÉÁî®Â±ûÊÄß‰∏ÄÊ†∑ÔºåÁî®ÁÇπËØ≠Ê≥ïË∞ÉÁî®ÂÆû‰æãÊñπÊ≥ïÔºö 12345678let counter = Counter()// the initial counter value is 0counter.increment()// the counter's value is now 1counter.increment(by: 5)// the counter's value is now 6counter.reset()// the counter's value is now 0 self Â±ûÊÄßÊØè‰∏™ÂÆû‰æãÈÉΩÊúâ‰∏Ä‰∏™ÈöêÂºèÁöÑÂ±ûÊÄßÂè´ÂÅö self„ÄÇÊàë‰ª¨ÂèØ‰ª•Âú®ÂÆû‰æãÊñπÊ≥ï‰∏≠ÔºåÈÄöËøá self Ëé∑ÂèñÂΩìÂâçÂÆû‰æã„ÄÇ ÂèØ‰ª•ÊîπÂÜô‰∏äÈù¢ÁöÑ incremnet() ÊñπÊ≥ïÔºö 123func increment() &#123; self.count += 1&#125; ÂÆûÈôÖ‰ΩøÁî®‰∏≠ÔºåÂπ∂‰∏çÂ§™ÈúÄË¶Å selfÔºåÂõ†‰∏∫Ê≤°ÂøÖË¶Å„ÄÇÈÇ£‰πà‰ªÄ‰πàÊó∂ÂÄôÊòØÂøÖÈ°ªÁöÑÂë¢Ôºü 1234567891011struct Point &#123; var x = 0.0, y = 0.0 func isToTheRightOf(x: Double) -&gt; Bool &#123; return self.x &gt; x &#125;&#125;let somePoint = Point(x: 4.0, y: 5.0)if somePoint.isToTheRightOf(x: 1.0) &#123; print("This point is to the right of the line where x == 1.0")&#125;// Prints "This point is to the right of the line where x == 1.0" ÊØîÂ¶Ç‰∏äÈù¢ÁöÑ‰ª£Á†ÅÔºåÂÆû‰æãÊñπÊ≥ïÁöÑÂÖ•ÂèÇÂêçÂíåÂÆû‰æãÂ±ûÊÄßÁõ∏ÂêåÔºåËøô‰∏™Êó∂ÂÄôÂøÖÈ°ªË¶ÅÁî® self ‰ª•Á§∫Âå∫ÂàÜ„ÄÇ ÂÆû‰æãÊñπÊ≥ï‰∏≠‰øÆÊîπÂÄºÁ±ªÂûãÁªìÊûÑ‰ΩìÂíåÊûö‰∏æÊòØÂÄºÁ±ªÂûã„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂÄºÁ±ªÂûãÁöÑÂ±ûÊÄß‰∏çËÉΩÂú®ÂÆÉÁöÑÂÆû‰æãÊñπÊ≥ï‰∏≠Ë¢´‰øÆÊîπÔºà‰πüÂ∞±ÊòØËØ¥‰∏ÄËà¨ÂàõÂª∫Â•Ω‰πãÂêéÔºåÁªìÊûÑ‰ΩìÂíåÊûö‰∏æ‰∏ÄËà¨Â∞±‰∏çËÆ©‰øÆÊîπ‰∫ÜÔºâ„ÄÇ Â¶ÇÊûú‰Ω†ÊÉ≥Âú®ËØ•ÂÆû‰æãÊñπÊ≥ï‰∏≠‰øÆÊîπÁªìÊûÑ‰ΩìÂíåÊûö‰∏æÁöÑÂ±ûÊÄßÔºåÈÇ£‰πàÈúÄË¶ÅÂú®ËØ•ÊñπÊ≥ïÂâçÂä†‰∏Ä‰∏™ÂèØÂèòÊ†áËÆ∞ÔºåÂ∞±ÂèØ‰ª•ÊîπÂèòÂÆÉÁöÑÂÄº‰∫Ü„ÄÇËøô‰∏™ÊñπÊ≥ïÂÅöÁöÑ‰ªª‰ΩïÊîπÂèòÈÉΩ‰ºöÂú®ÊñπÊ≥ïÊâßË°åÁªìÊùüÊó∂ÂÜôÂõûÂà∞ÂéüÂßãÁªìÊûÑ‰∏≠„ÄÇ Ë¶Å‰ΩøÁî®ÂèØÂèòÊñπÊ≥ïÔºåÂ∞ÜÂÖ≥ÈîÆÂ≠ómutating ÊîæÂà∞ÊñπÊ≥ïÁöÑfuncÂÖ≥ÈîÆÂ≠ó‰πãÂâçÂ∞±ÂèØ‰ª•‰∫ÜÔºö 1234567891011struct Point &#123; var x = 0.0, y = 0.0 mutating func moveBy(x deltaX: Double, y deltaY: Double) &#123; x += deltaX y += deltaY &#125;&#125;var somePoint = Point(x: 1.0, y: 1.0)somePoint.moveBy(x: 2.0, y: 3.0)print("The point is now at (\(somePoint.x), \(somePoint.y))")// Prints "The point is now at (3.0, 4.0)" Ê≥®ÊÑèÔºå‰∏çËÉΩÂú®ÁªìÊûÑ‰ΩìÁ±ªÂûãÁöÑÂ∏∏Èáè‰∏äË∞ÉÁî®ÂèØÂèòÊñπÊ≥ïÔºåÂõ†‰∏∫ÂÖ∂Â±ûÊÄß‰∏çËÉΩË¢´ÊîπÂèòÔºåÂç≥‰ΩøÂ±ûÊÄßÊòØÂèòÈáèÂ±ûÊÄß„ÄÇËøô‰∏ÄÁÇπÂú®Â±ûÊÄß‰∏ÄÁ´†‰∏≠Â∑≤ÁªèËÆ≤Ëøá‰∫Ü„ÄÇ ÂèØÂèòÊñπÊ≥ï‰∏≠Áªô self ËµãÂÄºÂèØÂèòÊñπÊ≥ïËøòËÉΩÂ§üËµãÁªôÈöêÂê´Â±ûÊÄßself‰∏Ä‰∏™ÂÖ®Êñ∞ÁöÑÂÆû‰æã„ÄÇ‰∏äÈù¢PointÁöÑ‰æãÂ≠êÂèØ‰ª•Áî®‰∏ãÈù¢ÁöÑÊñπÂºèÊîπÂÜôÔºö 123456struct Point &#123; var x = 0.0, y = 0.0 mutating func moveBy(x deltaX: Double, y deltaY: Double) &#123; self = Point(x: x + deltaX, y: y + deltaY) &#125;&#125; Êûö‰∏æÁöÑÂèØÂèòÊñπÊ≥ïÂèØ‰ª•ÊääselfËÆæÁΩÆ‰∏∫Âêå‰∏ÄÊûö‰∏æÁ±ªÂûã‰∏≠‰∏çÂêåÁöÑÊàêÂëòÔºö 123456789101112131415161718enum TriStateSwitch &#123; case off, low, high mutating func next() &#123; switch self &#123; case .off: self = .low case .low: self = .high case .high: self = .off &#125; &#125;&#125;var ovenLight = TriStateSwitch.lowovenLight.next()// ovenLight is now equal to .highovenLight.next()// ovenLight is now equal to .off ‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™‰∏âÊÄÅÂºÄÂÖ≥ÁöÑÊûö‰∏æ„ÄÇÊØèÊ¨°Ë∞ÉÁî®next()ÊñπÊ≥ïÊó∂ÔºåÂºÄÂÖ≥Âú®‰∏çÂêåÁöÑÁîµÊ∫êÁä∂ÊÄÅÔºàOffÔºåLowÔºåHighÔºâ‰πãÈó¥Âæ™ÁéØÂàáÊç¢„ÄÇ Á±ªÂûãÊñπÊ≥ïÂÆû‰æãÊñπÊ≥ïÊòØË¢´Êüê‰∏™Á±ªÂûãÁöÑÂÆû‰æãË∞ÉÁî®ÁöÑÊñπÊ≥ï„ÄÇ‰Ω†‰πüÂèØ‰ª•ÂÆö‰πâÂú®Á±ªÂûãÊú¨Ë∫´‰∏äË∞ÉÁî®ÁöÑÊñπÊ≥ïÔºåËøôÁßçÊñπÊ≥ïÂ∞±Âè´ÂÅöÁ±ªÂûãÊñπÊ≥ïÔºàType MethodsÔºâ„ÄÇÂú®ÊñπÊ≥ïÁöÑfuncÂÖ≥ÈîÆÂ≠ó‰πãÂâçÂä†‰∏äÂÖ≥ÈîÆÂ≠óstaticÔºåÊù•ÊåáÂÆöÁ±ªÂûãÊñπÊ≥ï„ÄÇÁ±ªËøòÂèØ‰ª•Áî®ÂÖ≥ÈîÆÂ≠óclassÊù•ÂÖÅËÆ∏Â≠êÁ±ªÈáçÂÜôÁà∂Á±ªÁöÑÊñπÊ≥ïÂÆûÁé∞„ÄÇ Âú® Objective-C ‰∏≠Ôºå‰Ω†Âè™ËÉΩ‰∏∫ Objective-C ÁöÑÁ±ªÁ±ªÂûãÔºàclassesÔºâÂÆö‰πâÁ±ªÂûãÊñπÊ≥ïÔºàtype-level methodsÔºâ„ÄÇÂú® Swift ‰∏≠Ôºå‰Ω†ÂèØ‰ª•‰∏∫ÊâÄÊúâÁöÑÁ±ª„ÄÅÁªìÊûÑ‰ΩìÂíåÊûö‰∏æÂÆö‰πâÁ±ªÂûãÊñπÊ≥ï„ÄÇÊØè‰∏Ä‰∏™Á±ªÂûãÊñπÊ≥ïÈÉΩË¢´ÂÆÉÊâÄÊîØÊåÅÁöÑÁ±ªÂûãÊòæÂºèÂåÖÂê´„ÄÇ Áî®ÁÇπËØ≠Ê≥ïË∞ÉÁî®Á±ªÂûãÊñπÊ≥ïÔºö 123456class SomeClass &#123; class func someTypeMethod() &#123; // type method implementation goes here &#125;&#125;SomeClass.someTypeMethod() Á±ªÂûãÊñπÊ≥ïÂíåÂÖ∂‰ªñËØ≠Ë®ÄÁöÑÈùôÊÄÅÊñπÊ≥ïÊó†‰∫åÔºå‰∏çÂ§öËØ¥‰∫Ü„ÄÇ ‰∏ãÊ†á ‰∏ãÊ†áÊòØËÆøÈóÆÈõÜÂêàÂàóË°®‰∏≠ÂÖÉÁ¥†ÁöÑË∑®ÁïåÊñπÂºè„ÄÇÂèØ‰ª•ÈÄöËøá‰∏ãÊ†áÁ¥¢ÂºïÔºåËÆæÁΩÆÂíåËé∑ÂèñÂÄºÔºåËÄåÁúÅÁï•Ë∞ÉÁî®Áõ∏Â∫îÁöÑÂ≠òÂèñÊñπÊ≥ï„ÄÇ‰Ω†ÂèØ‰ª•ÂÆö‰πâÊúâÂ§ö‰∏™ÂÖ•ÂèÇÁöÑ‰∏ãÊ†áÊª°Ë∂≥Ëá™ÂÆö‰πâÁ±ªÂûãÁöÑÈúÄÊ±Ç„ÄÇ ‰∏ãÊ†áËØ≠Ê≥ï‰∏ãÊ†áÂÖÅËÆ∏‰Ω†ÈÄöËøáÂú®ÂÆû‰æãÂêçÁß∞ÂêéÈù¢ÁöÑÊñπÊã¨Âè∑‰∏≠‰º†ÂÖ•‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™Á¥¢ÂºïÂÄºÊù•ÂØπÂÆû‰æãËøõË°åÂ≠òÂèñ„ÄÇËØ≠Ê≥ïÁ±ª‰ºº‰∫éÂÆû‰æãÊñπÊ≥ïËØ≠Ê≥ïÂíåËÆ°ÁÆóÂûãÂ±ûÊÄßËØ≠Ê≥ïÁöÑÊ∑∑Âêà„ÄÇ‰∏éÂÆö‰πâÂÆû‰æãÊñπÊ≥ïÁ±ª‰ººÔºåÂÆö‰πâ‰∏ãÊ†á‰ΩøÁî®subscriptÂÖ≥ÈîÆÂ≠óÔºåÊåáÂÆö‰∏Ä‰∏™ÊàñÂ§ö‰∏™ËæìÂÖ•ÂèÇÊï∞ÂíåËøîÂõûÁ±ªÂûã„ÄÇ‰∏ãÊ†áÂèØ‰ª•ËÆæÂÆö‰∏∫ËØªÂÜôÊàñÂè™ËØª„ÄÇËøôÁßçË°å‰∏∫Áî± getter Âíå setter ÂÆûÁé∞ÔºåÊúâÁÇπÁ±ª‰ººËÆ°ÁÆóÂûãÂ±ûÊÄßÔºö 123456789subscript(index: Int) -&gt; Int &#123; get &#123; // ËøîÂõû‰∏Ä‰∏™ÈÄÇÂΩìÁöÑ Int Á±ªÂûãÁöÑÂÄº &#125; set(newValue) &#123; // ÊâßË°åÈÄÇÂΩìÁöÑËµãÂÄºÊìç‰Ωú &#125;&#125; newValueÁöÑÁ±ªÂûãÂíå‰∏ãÊ†áÁöÑËøîÂõûÁ±ªÂûãÁõ∏Âêå„ÄÇÂ¶ÇÂêåËÆ°ÁÆóÂûãÂ±ûÊÄßÔºåÂèØ‰ª•‰∏çÊåáÂÆö setter ÁöÑÂèÇÊï∞ÔºànewValueÔºâ„ÄÇÂ¶ÇÊûú‰∏çÊåáÂÆöÂèÇÊï∞Ôºåsetter ‰ºöÊèê‰æõ‰∏Ä‰∏™Âêç‰∏∫newValueÁöÑÈªòËÆ§ÂèÇÊï∞„ÄÇ Â¶ÇÂêåÂè™ËØªËÆ°ÁÆóÂûãÂ±ûÊÄßÔºåÂèØ‰ª•ÁúÅÁï•Âè™ËØª‰∏ãÊ†áÁöÑgetÂÖ≥ÈîÆÂ≠óÔºö 123subscript(index: Int) -&gt; Int &#123; // ËøîÂõû‰∏Ä‰∏™ÈÄÇÂΩìÁöÑ Int Á±ªÂûãÁöÑÂÄº&#125; ‰∏ãÈù¢Áúã‰∏Ä‰∏™‰æãÂ≠êÔºö 123456789struct TimesTable &#123; let multiplier: Int subscript(index: Int) -&gt; Int &#123; return multiplier * index &#125;&#125;let threeTimesTable = TimesTable(multiplier: 3)print("six times three is \(threeTimesTable[6])")// ËæìÂá∫ "six times three is 18" ‰∏ãÊ†áÈÄâÈ°π‰∏Ä‰∏™Á±ªÊàñÁªìÊûÑ‰ΩìÂèØ‰ª•Ê†πÊçÆËá™Ë∫´ÈúÄË¶ÅÊèê‰æõÂ§ö‰∏™‰∏ãÊ†áÂÆûÁé∞Ôºå‰ΩøÁî®‰∏ãÊ†áÊó∂Â∞ÜÈÄöËøáÂÖ•ÂèÇÁöÑÊï∞ÈáèÂíåÁ±ªÂûãËøõË°åÂå∫ÂàÜÔºåËá™Âä®ÂåπÈÖçÂêàÈÄÇÁöÑ‰∏ãÊ†áÔºåËøôÂ∞±ÊòØ‰∏ãÊ†áÁöÑÈáçËΩΩ„ÄÇ ËôΩÁÑ∂Êé•ÂèóÂçï‰∏ÄÂÖ•ÂèÇÁöÑ‰∏ãÊ†áÊòØÊúÄÂ∏∏ËßÅÁöÑÔºå‰ΩÜ‰πüÂèØ‰ª•Ê†πÊçÆÊÉÖÂÜµÂÆö‰πâÊé•ÂèóÂ§ö‰∏™ÂÖ•ÂèÇÁöÑ‰∏ãÊ†á„ÄÇ‰æãÂ¶Ç‰∏ã‰æãÂÆö‰πâ‰∫Ü‰∏Ä‰∏™MatrixÁªìÊûÑ‰ΩìÔºåÁî®‰∫éË°®Á§∫‰∏Ä‰∏™DoubleÁ±ªÂûãÁöÑ‰∫åÁª¥Áü©Èòµ„ÄÇMatrixÁªìÊûÑ‰ΩìÁöÑ‰∏ãÊ†áÊé•Âèó‰∏§‰∏™Êï¥ÂûãÂèÇÊï∞Ôºö 12345678910111213141516171819202122struct Matrix &#123; let rows: Int, columns: Int var grid: [Double] init(rows: Int, columns: Int) &#123; self.rows = rows self.columns = columns grid = Array(count: rows * columns, repeatedValue: 0.0) &#125; func indexIsValidForRow(row: Int, column: Int) -&gt; Bool &#123; return row &gt;= 0 &amp;&amp; row &lt; rows &amp;&amp; column &gt;= 0 &amp;&amp; column &lt; columns &#125; subscript(row: Int, column: Int) -&gt; Double &#123; get &#123; assert(indexIsValidForRow(row, column: column), "Index out of range") return grid[(row * columns) + column] &#125; set &#123; assert(indexIsValidForRow(row, column: column), "Index out of range") grid[(row * columns) + column] = newValue &#125; &#125;&#125; ‰ΩøÁî®Ôºö 123var matrix = Matrix(rows: 2, columns: 2)matrix[0, 1] = 1.5matrix[1, 0] = 3.2 ÂÖ∂‰∏≠‰ΩøÁî®‰∫ÜÊñ≠Ë®ÄÔºåÊñ≠Ë®ÄÂú®‰∏ãÊ†áË∂äÁïåÊó∂Ëß¶Âèë„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Swift 3.1 ËØ≠Ê≥ïÂ≠¶‰π†Ôºà‰∫åÔºâ]]></title>
    <url>%2F2017%2F02%2F22%2Fswift%E8%AF%AD%E6%B3%952%2F</url>
    <content type="text"><![CDATA[Êé•ÁùÄ‰∏ä‰∏ÄÁØá ÊéßÂà∂ÊµÅFor-In Âæ™ÁéØfor-In Âæ™ÁéØ‰πãÂâç‰πüÊé•Ëß¶Ëøá‰∫Ü„ÄÇÂèØ‰ª•‰ΩøÁî®Âå∫Èó¥Êìç‰ΩúÁ¨¶ÊéßÂà∂Âæ™ÁéØÊ¨°Êï∞Ôºö 12345678for index in 1...5 &#123; print("\(index) times 5 is \(index * 5)")&#125;// 1 times 5 is 5// 2 times 5 is 10// 3 times 5 is 15// 4 times 5 is 20// 5 times 5 is 25 ‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠Ôºå index ÊòØ‰∏Ä‰∏™Ëá™Âä®Ë¢´ËÆæÁΩÆÁöÑÂÄºÔºå‰∏çÈúÄË¶ÅËá™Â∑±Â£∞Êòé„ÄÇ Â¶ÇÊûú‰∏çÈúÄË¶ÅÂæ™ÁéØÁöÑÊ¨°Êï∞ÔºåÂèØ‰ª•Áî®‰∏ãÂàíÁ∫ø _ Êù•Êõø‰ª£ index„ÄÇ 12345678let base = 3let power = 10var answer = 1for _ in 1...power &#123; answer *= base&#125;print("\(base) to the power of \(power) is \(answer)")// Prints "3 to the power of 10 is 59049" While Âæ™ÁéØwhilewhile ÁöÑÂΩ¢ÂºèÔºö while condition{ statements } Â∞±ÊòØ condition ÁöÑÊó∂ÂÄôÊ≤°ÊúâÊã¨Âè∑ÔºåÂÖ∂‰ªñÊ≤°ÊúâÁâπÂà´ÁöÑÂú∞Êñπ„ÄÇ Repeat-WhileÂíåÂÖ∂‰ªñËØ≠Ë®ÄÁöÑ do-while Á±ª‰ººÔºåÂè™‰∏çËøáÊç¢Êàê‰∫Ü repeatÔºö repeat { statements } while condition Êù°‰ª∂ËØ≠Âè•ifif ‰πãÂâç‰πüÁî®Âà∞ËøáËÆ∏Â§öÊ¨°‰∫ÜÔºåÂíåÂÖ∂‰ªñËØ≠Ë®Ä‰∏ÄÊ†∑ÔºåÊ≥®ÊÑèÂà§Êñ≠Êù°‰ª∂‰∏çÂä†Êã¨Âè∑„ÄÇelse ‰ª•Âèä else if Á±ª‰ºº„ÄÇ switchswitch Âü∫Êú¨Áî®Ê≥ï‰πüÂ∑Æ‰∏çÂ§öÔºåÁõ¥Êé•Áúã‰∏™‰æãÂ≠êÔºö 12345678910let someCharacter: Character = "z"switch someCharacter &#123;case "a": print("The first letter of the alphabet")case "z": print("The last letter of the alphabet")default: print("Some other character")&#125;// Prints "The last letter of the alphabet" ‰∏ÄÂÆöË¶ÅÊ≥®ÊÑèÔºåswift ‰∏≠ÁöÑ switch ‰∏ÄÂÆöË¶ÅÊúâ defaultÔºå‰∏ÄÂÆöË¶ÅÊúâ defaultÔºå‰∏ÄÂÆöË¶ÅÊúâ default„ÄÇ Ê≤°ÊúâÈöêÊÄßÊéâÂÖ•Áõ∏ÊØîËÄåË®ÄÔºåÊ≤°Êúâ breakÔºåÂåπÈÖç‰∏Ä‰∏™ÂêéÔºåÁõ¥Êé•ËøîÂõû„ÄÇ‰πüÂèØ‰ª•‰∏ÄÊù°ÈáåÈù¢ÂåπÈÖçÂ§ö‰∏™ÔºåÁî®ÈÄóÂè∑ÈöîÂºÄÔºö 12345678910let someCharacter: Character = "z"switch someCharacter &#123;case "a","z": print("The first letter of the alphabet")case "z": print("The last letter of the alphabet")default: print("Some other character")&#125;// Prints "The first letter of the alphabet" Ëøô‰∏™Â∞±Áõ∏ÂΩì‰∫éÊòØÊàñÊìç‰ΩúÔºå‰∏ãÈù¢ËøòÊúâ‰∏éÊìç‰Ωú ËøôÊ†∑Â∞±ÂåπÈÖçÂà∞‰∫ÜÁ¨¨‰∏Ä‰∏™ÊÉÖÂÜµ„ÄÇ Âè¶Â§ñÔºåÊØè‰∏™ case ÁöÑ‰∏ªÂπ≤ÈÉΩÈúÄË¶ÅËá≥Â∞ë‰∏ÄÂè•ÂèØÊâßË°åËØ≠Âè•Ôºå‰∏çËÉΩÂè™Êúâ caseÔºö 123456789let anotherCharacter: Character = "a"switch anotherCharacter &#123;case "a": // Invalid, the case has an empty bodycase "A": print("The letter A")default: print("Not the letter A")&#125;// This will report a compile-time error. ËøôÂ∞±ÂºïÂØºÊàë‰ª¨ÔºåÊ≤°ÊúâÊâßË°åÊñπÊ≥ïÁöÑÊù°‰ª∂ÔºåÂ∞±‰∏çË¶ÅÂÜô ËåÉÂõ¥ÂåπÈÖçÂú® case ‰∏≠ÂèØ‰ª•ÂÜô‰∏Ä‰∏™ËåÉÂõ¥Ôºö 12345678910111213141516171819let approximateCount = 62let countedThings = "moons orbiting Saturn"var naturalCount: Stringswitch approximateCount &#123;case 0: naturalCount = "no"case 1..&lt;5: naturalCount = "a few"case 5..&lt;12: naturalCount = "several"case 12..&lt;100: naturalCount = "dozens of"case 100..&lt;1000: naturalCount = "hundreds of"default: naturalCount = "many"&#125;print("There are \(naturalCount) \(countedThings).")// Prints "There are dozens of moons orbiting Saturn." ËøôÁßçÊñπÂºèÂèØ‰ª•‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÊõø‰ª£‰∏Ä‰∫õÂà§Êñ≠Êï∞ÂÄºÁöÑ if‚Ä¶else ÂÖÉÁªÑÂåπÈÖçÁöÑÊó∂ÂÄôËøòÂèØ‰ª•ÂåπÈÖçÂÖÉÁªÑÔºåÁî®‰∏ãÂàíÁ∫ø _ Êù•ÂåπÈÖç‰ªªÊÑèÂ≠óÁ¨¶„ÄÇÂΩìÂÖÉÁªÑÂÆåÂÖ®Áõ∏Á≠âÊó∂ÔºåËøõÂÖ• caseÔºö 1234567891011121314let somePoint = (1, 1)switch somePoint &#123;case (0, 0): print("(0, 0) is at the origin")case (_, 0): print("(\(somePoint.0), 0) is on the x-axis")case (0, _): print("(0, \(somePoint.1)) is on the y-axis")case (-2...2, -2...2): print("(\(somePoint.0), \(somePoint.1)) is inside the box")default: print("(\(somePoint.0), \(somePoint.1)) is outside of the box")&#125;// Prints "(1, 1) is inside the box" ÂÖÉÁªÑÂÖ∂ÂÆûÁõ∏ÂΩì‰∫é if‚Ä¶else‚Ä¶ ‰∏≠ &amp;&amp; ÁöÑÊìç‰Ωú ÂÄºÁªëÂÆöÂú®ÂâçÈù¢ÁöÑÂü∫Á°Ä‰∏äÔºåÂâçÈù¢Áî® _ ‰ª£Êõø‰ªªÊÑèÂÄº„ÄÇÂ¶ÇÊûúÂú® case ‰∏≠ÈúÄË¶ÅÁî®Âà∞Ëøô‰∏™ÂÄºÊÄé‰πàÂäûÂë¢ÔºüÁî® let Â£∞Êòé‰∏Ä‰∏™Ôºö 12345678910let anotherPoint = (2, 0)switch anotherPoint &#123;case (let x, 0): print("on the x-axis with an x value of \(x)")case (0, let y): print("on the y-axis with a y value of \(y)")case let (x, y): print("somewhere else at (\(x), \(y))")&#125;// Prints "on the x-axis with an x value of 2" ËøôÈáåÈù¢ let(x,y) Âíå (let x,let y) ÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ ËøôÁßçÂÄºÁªëÂÆöÁöÑÊñπÂºèÔºåÂèØ‰ª•ÊääÂáΩÊï∞‰∏≠Ë¶ÅÁî®Âà∞ÁöÑÂèòÈáèÂÖàÁ°ÆÂÆö‰∏ãÊù•„ÄÇ ÊúÄÂêé‰∏ÄÂÆöË¶ÅÊúâ‰∏Ä‰∏™ let(x,y)ÔºåË°®Á§∫‰∏Ä‰∏™ default Êìç‰ΩúÔºåÂê¶ÂàôÁºñËØëÂô®‰ºöÊäõÂá∫ÂºÇÂ∏∏„ÄÇ whereswitch ÁöÑ case ËÉΩ‰ΩøÁî® where Â≠êÂè•Êù•Ëøõ‰∏ÄÊ≠•Âà§Êñ≠Êù°‰ª∂„ÄÇ 12345678910let yetAnotherPoint = (1, -1)switch yetAnotherPoint &#123;case let (x, y) where x == y: print("(\(x), \(y)) is on the line x == y")case let (x, y) where x == -y: print("(\(x), \(y)) is on the line x == -y")case let (x, y): print("(\(x), \(y)) is just some arbitrary point")&#125;// Prints "(1, -1) is on the line x == -y" ‰∏â‰∏™ switch ÁöÑ case Â£∞Êòé‰∫ÜÂç†‰ΩçÂ∏∏Èáè x Âíå yÔºå‰∏¥Êó∂Âç†Áî® point ‰∏≠ÂÖÉÁªÑÂÄº„ÄÇËøô‰∫õÂ∏∏Èáè‰Ωú‰∏∫ where Â≠êÂè•ÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÁî®Êù•ÂàõÂª∫Âä®ÊÄÅÁöÑÁ≠õÈÄâ„ÄÇÂè™ÊúâÂΩì where Â≠êÂè•ÁöÑÊù°‰ª∂ÁªìÊûú‰∏∫ trueÔºåSwitch ÁöÑ case Âàô‰ºöÂåπÈÖçÁé∞Êúâ point ÁöÑÂÄº„ÄÇ ËøôÈáåÁöÑ where ‰∏ç‰ªÖÈÄÇÁî®‰∫éÂÖÉÁªÑÔºå‰πüÂèØ‰ª•ÊòØÊôÆÈÄöÁöÑ case let x where x==1:‰ΩÜÊòØÂ¶ÇÊûú‰∏çÁî®ÂÖÉÁªÑÂ∞±Ê≤°Êúâ if‚Ä¶else‚Ä¶ ÁÆÄÊ¥Å„ÄÇ switch ËÉΩÂú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏ä‰ª£ÊõøÂà§Êñ≠Áõ∏Á≠âÔºå‰ª•ÂèäÂà§Êñ≠Âú®Êüê‰∏Ä‰∏™ËåÉÂõ¥ÁöÑÁÆÄÂçï if‚Ä¶else Êìç‰Ωú ÊéßÂà∂ËΩ¨ÁßªÂ£∞ÊòéÊéßÂà∂ËΩ¨ÁßªÂ£∞ÊòéÂåÖÊã¨Ôºö continue break fallthrough return throw Èô§‰∫Ü fallthrough ÂÖ∂‰ªñÈÉΩÂ∑Æ‰∏çÂ§ö„ÄÇËøôÈáåË¶ÅÊ≥®ÊÑè‰∏Ä‰∏ãÂú® switch ‰∏≠‰ΩøÁî®ÁöÑ break„ÄÇÁî±‰∫é switch ‰∏≠ÁöÑ case ÈáåÁöÑÊâßË°åËØ≠Âè•‰∏çËÉΩ‰∏∫Á©∫ÔºåÊâÄ‰ª•Â¶ÇÊûúÂåπÈÖçÂà∞‰∏ÄÁßçÊÉÖÂÜµ‰∏çÈúÄË¶ÅÊìç‰ΩúÔºåÂèØ‰ª•Áõ¥Êé•Áî® break: 1234567891011121314let numberSymbol: Character = "‰∏â" // Chinese symbol for the number 3var possibleIntegerValue: Int?switch numberSymbol &#123;case "1", "Ÿ°", "‰∏Ä", "‡πë": possibleIntegerValue = 1case "2", "Ÿ¢", "‰∫å", "‡πí": possibleIntegerValue = 2case "3", "Ÿ£", "‰∏â", "‡πì": possibleIntegerValue = 3case "4", "Ÿ§", "Âõõ", "‡πî": possibleIntegerValue = 4default: break&#125; FallthroughSwift ‰∏≠Âú®ÂåπÈÖçÊàêÂäüÂêéÂ∞±‰∏ç‰ºöÊéâÂÖ•‰∏ã‰∏Ä‰∏™ case ‰∏≠„ÄÇÂ¶ÇÊûú‰Ω†Â∞±ÊÉ≥Ë¶ÅÊéâÂÖ•ÁöÑËØùÔºåÈÇ£‰πàÂú®ÊâßË°åËØ≠Âè•ÂêéÂä†‰∏ä fallthrough Âç≥ÂèØÔºö 1234567891011let integerToDescribe = 5var description = "The number \(integerToDescribe) is"switch integerToDescribe &#123;case 2, 3, 5, 7, 11, 13, 17, 19: description += " a prime number, and also" fallthroughdefault: description += " an integer."&#125;print(description)// Prints "The number 5 is a prime number, and also an integer." ÁâπÂà´Ê≥®ÊÑèÔºöË∞ÉÁî® fallthrough ÂêéÔºå‰∏çÊ£ÄÊü• case ÈáåÁöÑÊù°‰ª∂Ôºå‰ºöÁõ¥Êé•ÊéâÂÖ•‰∏ã‰∏Ä‰∏™ case „ÄÇÊâÄ‰ª•ËøôÈáåÈù¢Áõ¥Êé•ÊâßË°å‰∫Ü default ÁöÑ‰ª£Á†Å„ÄÇ ÈÄÇÁî®‰∫éÈÇ£ÁßçÊª°Ë∂≥‰∫ÜÊüê‰∏™Êù°‰ª∂ÂåÖÂê´ÂÖ∂‰ªñÊù°‰ª∂ÁöÑÊìç‰ΩúÔºåÂç≥Ë¶ÅÊâßË°å A ÈÇ£‰πà B ‰πüË¶ÅÊâßË°å„ÄÇÊúÄ‰∏äÈù¢ÁöÑÊ∞∏ËøúÊòØÊâßË°åÁöÑÊúÄÂ§öÁöÑ„ÄÇ Ê†áÁ≠æÂ£∞Êòé‰∏ªË¶ÅËØ±Âõ†ÊòØÂæ™ÁéØ‰∏é switch ÁöÑÂµåÂ•ó„ÄÇÊúâÊó∂ÂÄôÔºå‰Ω†ÈúÄË¶ÅË∑≥Âá∫Â§ñÂ±ÇÂæ™ÁéØÊàñËÄÖ switchÔºå‰ΩÜÊòØÁî±‰∫éÂµåÂ•óÔºå‰Ω†‰∏çÂæó‰∏ç break ÊàñËÄÖ continue Â•ΩÂá†Ê¨°„ÄÇÈÇ£‰πàÔºåÊ†áÁ≠æÂ£∞Êòé‰∏∫Âæ™ÁéØÂíå switch Êèê‰æõ‰∫Ü‰∏Ä‰∏™Ê†áËÆ∞ÔºåËøôÊ†∑Âú®Âæ™ÁéØÊàñËÄÖ switch ÂÜÖÈÉ®ÔºåÂèØ‰ª•ËΩªÊùæÁöÑÁªàÊ≠¢Â§ñÈÉ®ÁöÑÂæ™ÁéØÊàñ switch„ÄÇ 1234567891011121314151617gameLoop: while square != finalSquare &#123; diceRoll += 1 if diceRoll == 7 &#123; diceRoll = 1 &#125; switch square + diceRoll &#123; case finalSquare: // diceRoll will move us to the final square, so the game is over break gameLoop case let newSquare where newSquare &gt; finalSquare: // diceRoll will move us beyond the final square, so roll again continue gameLoop default: // this is a valid move, so find out its effect square += diceRoll square += board[square] &#125;&#125;print("Game over!") ËøôÊ†∑ÔºåÈÄöËøá break gameLoop Âíå continue gameLoop Â∞±ÂèØ‰ª•Êñπ‰æøÁöÑË∑≥Âá∫Êï¥‰∏™Âæ™ÁéØ„ÄÇ Guide Â£∞ÊòéËøô‰∏™ÊòØ Swift 3 ÁöÑÁâπÊÄßÔºåÂíå if Á±ª‰ºº„ÄÇÂêéÈù¢Ë∑üÁùÄ‰∏Ä‰∏™ elseÔºåÂÖàÁúã‰∏™‰æãÂ≠êÔºö 123456789101112131415161718192021func greet(person: [String: String]) &#123; guard let name = person["name"] else &#123; return &#125; print("Hello \(name)!") guard let location = person["location"] else &#123; print("I hope the weather is nice near you.") return &#125; print("I hope the weather is nice in \(location).")&#125; greet(person: ["name": "John"])// Prints "Hello John!"// Prints "I hope the weather is nice near you."greet(person: ["name": "Jane", "location": "Cupertino"])// Prints "Hello Jane!"// Prints "I hope the weather is nice in Cupertino." ÂΩì guard Êª°Ë∂≥ÁöÑÊó∂ÂÄô‰ª£Á†ÅÁõ¥Êé•ÂæÄÂêéËµ∞ÔºåÂ¶ÇÊûúÊù°‰ª∂‰∏çÊª°Ë∂≥ÔºåÈÇ£‰πàÊâßË°å else ÂÜÖÁöÑ‰ª£Á†Å„ÄÇÂÖ∂ÂÆûÈÄªËæëÂíå if ÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ‰ΩÜÊòØ‰∏∫‰ªÄ‰πàË¶ÅÂºÑÂá∫Ëøô‰πà‰∏™‰∏úË•øÂë¢Ôºü‰∏∫‰∫ÜËÆ©‰ª£Á†ÅÂèØËØªÊÄßÊõ¥È´ò„ÄÇ Êúâ‰∏§ÁÇπÂíå if ‰∏çÂêåÁöÑÊ≥®ÊÑèÁÇπÔºö guard let ‰∏≠ÂøÖÈ°ªË¶ÅÊúâ returnÔºåËÄå if let Âàô‰∏çÈúÄË¶Å return guard let ÂèòÈáèÁöÑ‰ΩúÁî®ÂüüÊòØÂ§ñÈÉ®‰ΩúÁî®ÂüüÔºåif let ÁöÑ‰ΩúÁî®ÂüüÊòØÂÜÖÈÉ®‰ΩúÁî®Âüü„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºåguard ÊñπÂºè let ÂæóÂà∞ÁöÑÂÄºÂ§ñÈÉ®ËøòËÉΩÁî®Âà∞Ôºåif ÊñπÂºè let Âà∞ÁöÑÂÄºÂ§ñÈÉ®Â∑≤ÁªèÊó†Ê≥ï‰ΩøÁî®„ÄÇ ‰∏äÈù¢ËØ¥Âà∞‰∏∫‰ªÄ‰πà‰ΩúÁî®ÂüüÊòØÂ§ñÈÉ®ÁöÑÔºåËøôÂ∞±Ë¶ÅÊòéÁôΩ guard ÁöÑÁõÆÁöÑ„ÄÇguard ÊòØÁî®Êù•‰ª£ÊõøÂú®‰∏Ä‰∏™ÂáΩÊï∞‰∏≠ if xxx ‰∏∫Á©∫ return ÁöÑÊÉÖÂÜµÁöÑ„ÄÇ‰πüÂ∞±ÊòØ‰∏ÄËà¨ÈÉΩÊòØÁî®Êù•ÂÅöÈùûÁ©∫Âà§Êñ≠ÁöÑ„ÄÇÊâÄ‰ª•ÈùûÁ©∫ÁöÑÊÉÖÂÜµ‰∏ãÊãøÂà∞ let ÁöÑÂÄºÔºåÂú®‰∏ãÈù¢‰ΩøÁî®„ÄÇ Ê£ÄÊü• API ÊòØÂê¶ÂèØÁî®Swift 3 ‰∏≠Êèê‰æõ‰∫ÜÊ£ÄÊü• API ÊòØÂê¶ÂèØÁî®ÁöÑÊñπÊ≥ïÔºö 12345if #available(iOS 10, macOS 10.12, *) &#123; // Use iOS 10 APIs on iOS, and use macOS 10.12 APIs on macOS&#125; else &#123; // Fall back to earlier iOS and macOS APIs&#125; Ë°®Á§∫Âú® iOS 10ÔºåmacOS 10.12Ôºå‰ª•Âèä‰ªªÊÑèÂÖ∂‰ªñÂπ≥Âè∞ÂèØÁî®„ÄÇ* Ë°®Á§∫‰ªªÊÑèÂÖ∂‰ªñÂπ≥Âè∞„ÄÇ ÂáΩÊï∞ÂÆö‰πâ‰∏Ä‰∏™ÂáΩÊï∞Áõ¥Êé•‰∏ä‰æãÂ≠êÔºö 1234func greet(person: String) -&gt; String &#123; let greeting = "Hello, " + person + "!" return greeting&#125; Ëøô‰∏™ÂáΩÊï∞Âêç‰∏∫ greet(person:)„ÄÇËøô‰∏™ÂáΩÊï∞ËæìÂÖ•‰∏Ä‰∏™ String Á±ªÂûãÂè´ÂÅö person ÁöÑÂÄºÔºåËæìÂá∫‰∏ÄÊÆµÂ≠óÁ¨¶‰∏≤„ÄÇÂáΩÊï∞‰ª• func ‰∏∫ÂâçÁºÄÔºå-&gt; ÊåáÂÆöÁöÑËøîÂõûÁ±ªÂûã„ÄÇ ÂèØ‰ª•Ë∞ÉÁî® print(_:separator:terminator:) ÊñπÊ≥ïÂéªÊâìÂç∞‰∏äÈù¢ÂáΩÊï∞ÁöÑËøîÂõûÂÄºÔºö 1234print(greet(person: "Anna"))// Prints "Hello, Anna!"print(greet(person: "Brian"))// Prints "Hello, Brian!" ËøôÈáåÁöÑ print(_:separator:terminator:) ÊñπÊ≥ïÁ¨¨‰∏Ä‰∏™ÂÖ•ÂèÇÊ≤°ÊúâÂêçÂ≠óÔºåÂêéÈù¢‰∏§‰∏™ÂÖ•ÂèÇÁî±‰∫éÊúâÈªòËÆ§ÂÄºÔºåÂõ†Ê≠§ÂèØÈÄâ„ÄÇÂÖ∑‰ΩìÂ∞ÜÂú®‰∏ãÈù¢ËØ¥Âà∞„ÄÇ ÂáΩÊï∞ÁöÑÂèÇÊï∞ÂíåËøîÂõûÂÄºÊ≤°ÊúâÂèÇÊï∞Á§∫‰æãÔºö 12345func sayHelloWorld() -&gt; String &#123; return "hello, world"&#125;print(sayHelloWorld())// Prints "hello, world" Â§ö‰∏™ÂèÇÊï∞ÂáΩÊï∞ÂèØ‰ª•ÊúâÂ§ö‰∏™ËæìÂÖ•ÂèÇÊï∞ÔºåÊää‰ªñ‰ª¨ÂÜôÂà∞ÂáΩÊï∞ÁöÑÊã¨Âè∑ÂÜÖÔºåÂπ∂Áî®ÈÄóÂè∑Âä†‰ª•ÂàÜÈöîÔºö 123456789func greet(person: String, alreadyGreeted: Bool) -&gt; String &#123; if alreadyGreeted &#123; return greetAgain(person: person) &#125; else &#123; return greet(person: person) &#125;&#125;print(greet(person: "Tim", alreadyGreeted: true))// Prints "Hello again, Tim!" Êó†ËøîÂõûÂÄºÊ≤°Êúâ return Ê≤°ÊúâËøîÂõûÁ±ªÂûã -&gt;Ôºö 12345func greet(person: String) &#123; print("Hello, \(person)!")&#125;greet(person: "Dave")// Prints "Hello, Dave!" ‰∏•Ê†ºÊù•ËØ¥ÔºåÂÖ∂ÂÆûÊó†ËøîÂõûÁ±ªÂûãÁöÑÂáΩÊï∞ËøòÊòØËøîÂõû‰∫Ü‰∏Ä‰∏™ÂÄºÔºåÂç≥‰ΩøÊ≤°ÊúâËøîÂõûÂÄºÂÆö‰πâ„ÄÇÂáΩÊï∞Ê≤°ÊúâÂÆö‰πâËøîÂõûÁ±ªÂûã‰ΩÜËøî Âõû‰∫Ü‰∏Ä‰∏™ void ËøîÂõûÁ±ªÂûãÁöÑÁâπÊÆäÂÄº„ÄÇÂÆÉÊòØ‰∏Ä‰∏™Á©∫ÁöÑÂÖÉÁªÑÔºåÂèØ‰ª•ÂÜô‰∏∫return () Â§ö‰∏™ËøîÂõûÂÄºÂèØ‰ª•Â∞ÜËøîÂõûÁ±ªÂûãËÆæÁΩÆ‰∏∫ÂÖÉÁªÑÔºåÊù•ËøîÂõûÂ§ö‰∏™ÂÄºÔºö 123456789101112func minMax(array: [Int]) -&gt; (min: Int, max: Int) &#123; var currentMin = array[0] var currentMax = array[0] for value in array[1..&lt;array.count] &#123; if value &lt; currentMin &#123; currentMin = value &#125; else if value &gt; currentMax &#123; currentMax = value &#125; &#125; return (currentMin, currentMax)&#125; Ê≥®ÊÑè -&gt; ÂêéÈù¢ÁöÑËøîÂõûÁ±ªÂûã‰π¶ÂÜôÊñπÂºèÔºö(min: Int, max: Int) „ÄÇ Áî±‰∫éÂú®ÂÆö‰πâËøîÂõûÁ±ªÂûãÁöÑÊó∂ÂÄôÔºåÂÖÉÁªÑ‰∏≠ÁöÑÂÖÉÁ¥†ÈÉΩÂ∑≤ÁªèË¢´ÂëΩÂêçÂ•Ω‰∫Ü„ÄÇÊâÄ‰ª•Êàë‰ª¨ÈÄöËøá . Êìç‰ΩúÁ¨¶Â∞±ËÉΩÊãøÂà∞ÂØπÂ∫îÁöÑÂÖÉÁ¥†Ôºö 123let bounds = minMax(array: [8, -6, 2, 109, 3, 71])print("min is \(bounds.min) and max is \(bounds.max)")// Prints "min is -6 and max is 109" ÂèØÈÄâÁöÑÂÖÉÁªÑËøîÂõûÁ±ªÂûãÂ¶ÇÊûúËøîÂõûÁöÑÂÖÉÁªÑÂèØËÉΩÊ≤°ÊúâÂÄºÔºåÈÇ£‰πàÂèØ‰ª•‰ΩøÁî®ÂèØÈÄâÁöÑÂÖÉÁªÑ‰Ωú‰∏∫ËøîÂõûÁ±ªÂûãÔºåÊù•Ë°®Á§∫Êï¥‰∏™ÂÖÉÁªÑÂèØ‰ª•‰∏∫ nil„ÄÇÂú®ÂÖÉÁªÑ‰πãÂêéÂä†‰∏ä ? Êù•Ë°®Á§∫ÂèØÈÄâÁ±ªÂûãÔºå‰æãÂ¶Ç (Int,Int)? ÔºàÊ≥®ÊÑè‰∏çË¶ÅÂÜôÊàê (Int?,Int?) Ëøô‰∏™Ë°®Á§∫ÂÖÉÁªÑ‰∏≠ÁöÑÂÖÉÁ¥†ÊòØÂèØÈÄâÁöÑÔºâ„ÄÇ Â¶ÇÊûúÊòØÂèØÈÄâÂÖÉÁªÑÔºåÈÇ£‰πà‰∏ÄÂÆöË¶ÅÂÖàÂÅöÈùûÁ©∫Âà§Êñ≠„ÄÇÂê¶ÂàôÂΩì‰Ω†ÊÉ≥Ë¶ÅÂèñÂá∫ÂÖÉÁªÑ‰∏≠ÂÖÉÁ¥†ÂêéÔºåÂ∞±‰ºöËß¶ÂèëËøêË°åÊó∂ÈîôËØØ„ÄÇ‰Ω†ÂèØ‰ª•ÈÄöËøáÂèØÈÄâÁªëÂÆöÊù•Âà§Êñ≠ÊòØÂê¶‰∏∫Á©∫Ôºö 123if let bounds = minMax(array: [8, -6, 2, 109, 3, 71]) &#123; print("min is \(bounds.min) and max is \(bounds.max)")&#125; ÂáΩÊï∞ÁöÑ argument label Âíå parameter nameËøô‰∏§‰∏™ËØçÊàë‰∏çÁü•ÈÅìÊÄé‰πàÁøªËØë„ÄÇÊØè‰∏™ÂáΩÊï∞ÈÉΩÊúâ argument label Âíå parameter name„ÄÇargument label Áî®Âú®Ë∞ÉÁî®ÂáΩÊï∞ÁöÑÊó∂ÂÄôÔºõparameter name Áî®Âú®ÊñπÊ≥ï‰Ωì‰∏≠ÁöÑÂèÇÊï∞‰ΩøÁî®„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏§ËÄÖÊòØÁõ∏Á≠âÁöÑ„ÄÇÂú®‰∏Ä‰∏™ÊñπÊ≥ï‰∏≠ÔºåÊâÄÊúâÁöÑ parameter name ÈÉΩÂ∫îËØ•ÊòØÁã¨‰∏ÄÊó†‰∫åÁöÑÔºåÂõ†‰∏∫Âú®ÊñπÊ≥ï‰Ωì‰∏≠‰ºöÁî®Âà∞Ôºõargument label Âàô‰∏çÂøÖÈÉΩ‰∏çÂêå„ÄÇ ÔºàÂ¶ÇÊûúÁúã‰∏çÊáÇÂï•ÊÑèÊÄùÔºåÂèØ‰ª•Áúã‰∏ãÈù¢ÁöÑÂá†‰∏™‰æãÂ≠êÂ∞±ÊòéÁôΩ‰∫ÜÔºâ„ÄÇ 12345func someFunction(firstParameterName: Int, secondParameterName: Int) &#123; // In the function body, firstParameterName and secondParameterName // refer to the argument values for the first and second parameters.&#125;someFunction(firstParameterName: 1, secondParameterName: 2) ‰∏äÈù¢ÊòØ‰∏Ä‰∏™ argument laebl Âíå parameter name ÈªòËÆ§Áõ∏Á≠âÁöÑ‰æãÂ≠ê„ÄÇ ÊòéÁ°ÆÁöÑ argument labelsÁé∞Âú®ËÄÉËôë argument labels Âíå parameter name ‰∏çÂêåÁöÑÊÉÖÂÜµ„ÄÇÂèØ‰ª•Â∞Ü argumentLabel ÂÜôÂú® parameterName ÂâçÈù¢Ôºö 1234func someFunction(argumentLabel parameterName: Int) &#123; // In the function body, parameterName refers to the argument value // for that parameter.&#125; Êù•Áúã‰∏Ä‰∏™ÂÖ∑‰ΩìÂÆû‰æãÔºö 12345func greet(person: String, from hometown: String) -&gt; String &#123; return "Hello \(person)! Glad you could visit from \(hometown)."&#125;print(greet(person: "Bill", from: "Cupertino"))// Prints "Hello Bill! Glad you could visit from Cupertino." ÂÖ∂‰∏≠ from ÊòØ argument labelsÔºåhometown ÊòØ parameter name„ÄÇÊ≥®ÊÑèÂú®ÊñπÊ≥ïÈáåÁî® hometownÔºåÂú®Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÁî® from„ÄÇ ÁúÅÁï•ÁöÑ argument labelsÂ¶ÇÊûú‰∏çÊÉ≥Ë¶Å argument labelsÔºåÂèØ‰ª•Áî® _ ‰ª£ÊõøÔºåË∞ÉÁî®ÁöÑÊó∂ÂÄôÂ∞±‰ªÄ‰πàÈÉΩ‰∏çÁî®ÂÜô‰∫ÜÔºö 12345func someFunction(_ firstParameterName: Int, secondParameterName: Int) &#123; // In the function body, firstParameterName and secondParameterName // refer to the argument values for the first and second parameters.&#125;someFunction(1, secondParameterName: 2) Ê≥®ÊÑèÔºåÂèÇÊï∞È°∫Â∫èËøòÊòØ‰∏çËÉΩÈîôÁöÑÔºåÂê¶Âàô‰∫ßÁîüÂºÇÂ∏∏„ÄÇ ÈªòËÆ§ÁöÑÂèÇÊï∞ÂÄºÂú®ÂÆö‰πâÂáΩÊï∞ÁöÑÊó∂ÂÄôÂèØ‰ª•Âú®ÂèÇÊï∞Á±ªÂûãÂêéÂä†‰∏äÈªòËÆ§ÂÄºÔºö 123456func someFunction(parameterWithoutDefault: Int, parameterWithDefault: Int = 12) &#123; // If you omit the second argument when calling this function, then // the value of parameterWithDefault is 12 inside the function body.&#125;someFunction(parameterWithoutDefault: 3, parameterWithDefault: 6) // parameterWithDefault is 6someFunction(parameterWithoutDefault: 4) // parameterWithDefault is 12 Â¶ÇÊûúÊúâÈªòËÆ§ÂÄº‰∫ÜÔºåÈÇ£‰πàÂú®Ë∞ÉÁî®ÁöÑÊó∂ÂÄôËøô‰∏™ÂèÇÊï∞Â∞±ÂèØ‰ª•ÁúÅÁï•‰∫Ü„ÄÇ Êé®ËçêÂ∞ÜÊúâÈªòËÆ§ÂÄºÁöÑÂèÇÊï∞ÊîæÂú®ÂÖ•ÂèÇÁöÑÂêéÈù¢„ÄÇÂõ†‰∏∫Ê≤°ÊúâÈªòËÆ§ÂÄºÁöÑÂèÇÊï∞‰∏ÄËà¨Êõ¥ÈáçË¶Å„ÄÇ ÂèØÂèòÊï∞ÈáèÁöÑÂÖ•ÂèÇ‰∏Ä‰∏™ÂèØÂèòÊï∞ÈáèÁöÑÂÖ•ÂèÇÂèØ‰ª•‰º†ÂÖ•Èõ∂‰∏™ÊàñËÄÖÊõ¥Â§öÁöÑÂèÇÊï∞ÔºåÂú®ÂèÇÊï∞Á±ªÂûãÂêéÈù¢Âä†‰∏ä ‚Ä¶ Â∞±Ë°å‰∫Ü„ÄÇËøô‰∫õÂÖ•ÂèÇÂ∞Ü‰ºö‰ª•‰∏Ä‰∏™Êï∞ÁªÑÁöÑÂΩ¢ÂºèÂú®ÊñπÊ≥ï‰Ωì‰∏≠‰ΩøÁî®Ôºö 1234567891011func arithmeticMean(_ numbers: Double...) -&gt; Double &#123; var total: Double = 0 for number in numbers &#123; total += number &#125; return total / Double(numbers.count)&#125;arithmeticMean(1, 2, 3, 4, 5)// returns 3.0, which is the arithmetic mean of these five numbersarithmeticMean(3, 8.25, 18.75)// returns 10.0, which is the arithmetic mean of these three numbers ËøôÈáåÂÖ•ÂèÇÁöÑÊï∞Â≠óÂ∞Ü‰ºö‰ª•Âêç‰∏∫ numbers ÁöÑ [Double] Êï∞ÁªÑÁöÑÂΩ¢Âºè‰º†ÂÖ•„ÄÇ ËøôÈáåÊúâÂá†‰∏™Ê≥®ÊÑèÁÇπÔºö ‰∏∫‰ªÄ‰πà‰∏çÁõ¥Êé•‰º†‰∏Ä‰∏™Êï∞ÁªÑÂë¢ÔºüÂõ†‰∏∫ÈÇ£Ê†∑‰∏çÁõ¥ËßÇ ‰∏äÈù¢ÁöÑÊòØÁúÅÁï•‰∫Ü argument labels ÁöÑÊÉÖÂÜµ„ÄÇÂ¶ÇÊûú‰∏çÁúÅÁï•ÔºåÊØîÂ¶ÇÂ∞Ü _ ÊõøÊç¢Êàê toÔºåÈÇ£‰πàË∞ÉÁî®ÁöÑÊó∂ÂÄôÊîπ‰∏∫ arithmeticMean(to:1, 2, 3, 4, 5) Âç≥ÂèØ„ÄÇ ‰∏Ä‰∏™ÂáΩÊï∞ÈáåÊúÄÂ§öÂè™ËÉΩÊúâ‰∏Ä‰∏™ÂèØÂèòÊï∞ÈáèÁöÑÂÖ•ÂèÇ„ÄÇ Â¶ÇÊûúÂèÇÊï∞ÊòØÂèØÂèòÁöÑÈÇ£‰πàÂ∞±Ê≤°Ê≥ïËÆæÁΩÆÈªòËÆ§ÂÄº‰∫Ü„ÄÇ ËøòÊúâ‰∏ÄÁßçÊÉÖÂΩ¢Ôºöfunc arithmeticMean(_ numbers: Double...,_ anotherNumber: Double)ÔºåËøôÁßçÊÉÖÂÜµ‰∏ãÁî±‰∫é‰∏§‰∏™ÂÖ•ÂèÇÈÉΩÊòØÁº∫ÁúÅÁöÑÔºåÊâÄÊúâ‰º†ÂÖ•ÁöÑÂèÇÊï∞ÈÉΩË¢´ numbers Êé•Êî∂ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞Êó†Ê≥ïÊé•Êî∂ÂèÇÊï∞„ÄÇÊúÄÂ•Ω‰∏çË¶ÅËøôÊ†∑ÂÜô„ÄÇ ËæìÂÖ•ËæìÂá∫ÂèÇÊï∞‰∏ÄËà¨ÂáΩÊï∞ÂÜÖÂèÇÊï∞ÂÄºÁöÑÂèòÂåñ‰∏ç‰ºöÂΩ±ÂìçÂ§ñÈÉ®‰º†ÂÖ•ÁöÑÂèòÈáèÁöÑÂÄº„ÄÇÁé∞Âú®ÂèØ‰ª•ÈÄöËøá inout Ê†áËÆ∞Ôºå‰ΩøÂèÇÊï∞ÂÄºÁöÑÂèòÂåñÂêåÊ≠•ÂΩ±ÂìçÂà∞Â§ñÈÉ®ÂÄºÁöÑÂèòÂåñ„ÄÇ 12345func swapTwoInts(_ a: inout Int, _ b: inout Int) &#123; let temporaryA = a a = b b = temporaryA&#125; Ëøô‰∏™Á§∫‰æã‰∏≠ÔºåËØ•ÂáΩÊï∞‰∫§Êç¢ËæìÂÖ•ÁöÑ‰∏§‰∏™ÂÄº„ÄÇÂú®ËøîÂõûÁ±ªÂûãÂâçÂä†‰∏ä inout Ê†áËÆ∞„ÄÇË∞ÉÁî®ÊñπÊ≥ïÁöÑÊó∂ÂÄôÈúÄË¶ÅÂú®ËæìÂÖ•ÂèÇÊï∞ÂâçÂä†‰∏ä &amp;(ÂÖ∂ÂÆûÂ∞±ÊòØ c ÈáåÈù¢ÁöÑÂºïÁî®ÂòõÔºåÂè™ÊòØÂ§öÂä†‰∏™ inout Ê†áËÆ∞Áî®Êù•ÊèêÁ§∫Ë∞ÉÁî®ËÄÖ)„ÄÇ‰ΩøÁî®Á§∫‰æãÔºö 12345var someInt = 3var anotherInt = 107swapTwoInts(&amp;someInt, &amp;anotherInt)print("someInt is now \(someInt), and anotherInt is now \(anotherInt)")// Prints "someInt is now 107, and anotherInt is now 3" ËæìÂÖ•ËæìÂá∫ÂèÇÊï∞ÈúÄË¶Å‰ΩøÁî®ÂèòÈáèËÄå‰∏çÊòØÂ∏∏ÈáèÔºåÂõ†‰∏∫Â∏∏Èáè‰∏çËÉΩÊîπÂèò„ÄÇ ÂáΩÊï∞Á±ªÂûã‰∏äÈù¢ÊúâÊèêÂà∞ËøáÔºåÊØè‰∏™ÂáΩÊï∞ÈÉΩÊúâÂÖ∂ÂáΩÊï∞Á±ªÂûãÔºåÁî±ËæìÂÖ•ÂèÇÊï∞Á±ªÂûãÂíåËøîÂõûÁ±ªÂûãÁªÑÊàê„ÄÇÊØîÂ¶ÇÔºö 123456func addTwoInts(_ a: Int, _ b: Int) -&gt; Int &#123; return a + b&#125;func multiplyTwoInts(_ a: Int, _ b: Int) -&gt; Int &#123; return a * b&#125; ‰∏äÈù¢ÁöÑÊñπÊ≥ïÁöÑÂáΩÊï∞Á±ªÂûã‰∏∫ (Int, Int) -&gt; Int„ÄÇÂÜçÊØîÂ¶Ç‰∏Ä‰∏™Ê≤°ÊúâÂÖ•ÂèÇÂíåËøîÂõûÂÄºÁöÑÂáΩÊï∞Ôºö 123func printHelloWorld() &#123; print("hello, world")&#125; Ëøô‰∏™ÂáΩÊï∞ÁöÑÁ±ªÂûãÊòØ ()-&gt;Void ‰ΩøÁî®ÂáΩÊï∞Á±ªÂûã‰Ω†ÂèØ‰ª•ÂÆö‰πâ‰∏Ä‰∏™Â∏∏ÈáèÊàñÂèòÈáè‰∏∫‰∏Ä‰∏™ÂáΩÊï∞Á±ªÂûãÔºåÂπ∂ÊåáÂÆöÈÄÇÂΩìÁöÑÂáΩÊï∞ÁªôËØ•ÂèòÈáèÔºö 1var mathFunction: (Int, Int) -&gt; Int = addTwoInts ÂèØ‰ª•Áõ¥Êé•ÂÜôÊàê mathFunction = addTwoInts ÈÄöËøáÁ±ªÂûãÊé®Êñ≠ÂÜ≥ÂÆöÁ±ªÂûã Áé∞Âú®Â∞±ÂèØ‰ª•ÂÉè‰ΩøÁî® addTwoInts ÊñπÊ≥ï‰∏ÄÊ†∑‰ΩøÁî® mathFunction ‰∫ÜÔºö 12print("Result: \(mathFunction(2, 3))")// Prints "Result: 5" Ê≥®ÊÑèÔºå‰ΩøÁî®ÂáΩÊï∞Á±ªÂûãÁöÑÂú∞ÊñπÂ∞±‰∏çËÉΩÂÜçÊúâ argument label ‰ª•Âèä parameter name ‰∫Ü Â∞±ÁÆó addTwoInts ÁöÑ‰∏§‰∏™ÂÖ•ÂèÇÊòØÊúâ argument label ÁöÑÔºåËøôÈáåË∞ÉÁî® mathFunction ÁöÑÊó∂ÂÄô‰πüË¶ÅÁúÅÁï•„ÄÇmathFunction ‰∏çËÉΩËá™Â∑±ÂÆö‰πâ argument label ‰ª•Âèä parameter name ÔºåÂè™ËÉΩËµã‰∫àÂáΩÊï∞‰πãÂêéÁõ¥Êé•‰ΩøÁî®„ÄÇ‰æãÂ≠êÔºö Ê≥®ÊÑèÔºåÂè™ÊúâÂáΩÊï∞Á±ªÂûãÂåπÈÖçÊâçËÉΩÂ§üÂ∞Ü addTwoInts ËµãÁªô mathFunction„ÄÇÁî±‰∫é mathFunction Âíå multiplyTwoInts Á±ªÂûã‰πüÁõ∏ÂêåÔºåÊâÄ‰ª•ÂèØ‰ª•ÁªßÁª≠ÂØπ mathFunction ËµãÂÄºÔºö 123mathFunction = multiplyTwoIntsprint("Result: \(mathFunction(2, 3))")// Prints "Result: 6" Áî±‰∫éÁ±ªÂûãÊé®Êñ≠ÁöÑ‰ΩúÁî®ÔºåÂÆö‰πâÂáΩÊï∞ÂèòÈáèÊàñËÄÖÂ∏∏ÈáèÁöÑÊó∂ÂÄôÂèØ‰ª•‰∏çÁî®ÂÜôÂá∫ÂáΩÊï∞Á±ªÂûãÔºö 12let anotherMathFunction = addTwoInts// anotherMathFunction is inferred to be of type (Int, Int) -&gt; Int Áî±‰∫é‰º†ÈÄíÂáΩÊï∞‰∏çËÉΩÊîπÂèò argument label ‰ª•Âèä parameter nameÔºåÊâÄ‰ª•‰ΩøÁî®Á±ªÂûãÊé®Êñ≠Êõ¥Êñπ‰æø‰∏Ä‰∫õÔºå‰∏çË¶ÅÂÜçÂÜô‰∏ÄÈÅçÂáΩÊï∞Á±ªÂûã‰∫Ü„ÄÇ ÂáΩÊï∞Á±ªÂûã‰Ωú‰∏∫ÂèÇÊï∞Á±ªÂûãÂèØ‰ª•Â∞Ü‰∏Ä‰∏™ÂáΩÊï∞‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•Âè¶‰∏Ä‰∏™ÂáΩÊï∞„ÄÇËøô‰Ωø‰Ω†È¢ÑÁïô‰∫Ü‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÊüê‰∫õÊñπÈù¢ÁöÑÂáΩÊï∞ÂÆûÁé∞ÔºåËÆ©Ë∞ÉÁî®ËÄÖÊèê‰æõÁöÑÂáΩÊï∞Êó∂Ë¢´Ë∞ÉÁî®Ôºö 12345func printMathResult(_ mathFunction: (Int, Int) -&gt; Int, _ a: Int, _ b: Int) &#123; print("Result: \(mathFunction(a, b))")&#125;printMathResult(addTwoInts, 3, 5)// Prints "Result: 8" ËøôÈáå mathFunction Â∞±ÊòØ‰∏Ä‰∏™ÂáΩÊï∞Á±ªÂûã (Int,Int)-&gt;Int„ÄÇ ÂáΩÊï∞Á±ªÂûã‰Ωú‰∏∫ËøîÂõûÁ±ªÂûãÂáΩÊï∞ÁöÑËøîÂõûÁ±ªÂûãÂèØ‰ª•ÊòØ‰∏Ä‰∏™ÂáΩÊï∞Á±ªÂûãÔºåÂç≥ËøîÂõû‰∏Ä‰∏™ÂáΩÊï∞„ÄÇ ‰æãÂ¶ÇÊúâ‰∏§‰∏™ÂáΩÊï∞ÔºåÂáΩÊï∞Á±ªÂûãÈÉΩ‰∏∫ (Int)-&gt;Int: 123456func stepForward(_ input: Int) -&gt; Int &#123; return input + 1&#125;func stepBackward(_ input: Int) -&gt; Int &#123; return input - 1&#125; Áé∞Âú®ÂÆö‰πâ‰∏Ä‰∏™ËøîÂõû (Int)-&gt;Int Á±ªÂûãÁöÑÂáΩÊï∞ chooseStepFunction(backward:)ÔºåÊ≥®ÊÑèËøîÂõûÁ±ªÂûãÁöÑÂÜôÊ≥ï: 123func chooseStepFunction(backward: Bool) -&gt; (Int) -&gt; Int &#123; return backward ? stepBackward : stepForward&#125; ‰∏ãÈù¢ÁúãÁúãÂ¶Ç‰Ωï‰ΩøÁî®ÁöÑÔºö 123456789101112131415var currentValue = 3let moveNearerToZero = chooseStepFunction(backward: currentValue &gt; 0)// moveNearerToZero now refers to the stepBackward() functionprint("Counting to zero:")// Counting to zero:while currentValue != 0 &#123; print("\(currentValue)... ") currentValue = moveNearerToZero(currentValue)&#125;print("zero!")// 3...// 2...// 1...// zero! ÂµåÂ•óÂáΩÊï∞ËøÑ‰ªä‰∏∫Ê≠¢Á¢∞Âà∞ÁöÑÊâÄÊúâÂáΩÊï∞ÈÉΩÊòØÂú®ÂÖ®Â±ÄËåÉÂõ¥ÈáåÁöÑÂáΩÊï∞ÔºåÊàë‰ª¨‰πüÂèØ‰ª•Â∞ÜÂáΩÊï∞ÂÆö‰πâÂú®ÂáΩÊï∞ÂÜÖÔºå‰Ωú‰∏∫ÂµåÂ•óÂáΩÊï∞„ÄÇÂµåÂ•óÂáΩÊï∞ÂØπÂ§ñÊòØÈöêËóèÁöÑÔºå‰ΩÜ‰ªçÁÑ∂ÂèØ‰ª•Ë∞ÉÁî®Âíå‰ΩøÁî®ÂÖ∂ÂÜÖÈÉ®ÁöÑÂáΩÊï∞„ÄÇ 123456789101112131415161718func chooseStepFunction(backward: Bool) -&gt; (Int) -&gt; Int &#123; func stepForward(input: Int) -&gt; Int &#123; return input + 1 &#125; func stepBackward(input: Int) -&gt; Int &#123; return input - 1 &#125; return backward ? stepBackward : stepForward&#125;var currentValue = -4let moveNearerToZero = chooseStepFunction(backward: currentValue &gt; 0)// moveNearerToZero now refers to the nested stepForward() functionwhile currentValue != 0 &#123; print("\(currentValue)... ") currentValue = moveNearerToZero(currentValue)&#125;print("zero!")// -4...// -3...// -2...// -1...// zero! Èó≠ÂåÖÈó≠ÂåÖË°®ËææÂºèsort ÂáΩÊï∞Swift Êèê‰æõ‰∫Ü sort(by:) ÂáΩÊï∞Ôºå‰ºöÊ†πÊçÆÊèê‰æõÁöÑÈó≠ÂåÖÔºåÂ∞ÜÂ∑≤Áü•Á±ªÂûãÊï∞ÁªÑ‰∏≠ÁöÑÂÄºËøõË°åÊéíÂ∫è„ÄÇÊéíÂ∫èÂÆåÊàêÔºåÂáΩÊï∞‰ºöËøîÂõû‰∏Ä‰∏™‰∏éÂéüÊï∞ÁªÑÂ§ßÂ∞èÁõ∏ÂêåÁöÑÊñ∞Êï∞ÁªÑÔºåËØ•Êï∞ÁªÑ‰∏≠ÂåÖÂê´Â∑≤ÁªèÊ≠£Á°ÆÊéíÂ∫èÁöÑÂêåÁ±ªÂûãÂÖÉÁ¥†„ÄÇ sort(by:) ÂáΩÊï∞ËæìÂÖ•‰∏Ä‰∏™ÊØîËæÉÂáΩÊï∞Â§ßÂ∞èÁöÑÊñπÊ≥ïÔºö 1234567let names = ["Chris", "Alex", "Ewa", "Barry", "Daniella"]func backward(_ s1: String, _ s2: String) -&gt; Bool &#123; return s1 &gt; s2&#125;var reversedNames = names.sorted(by: backward)// reversedNames is equal to ["Ewa", "Daniella", "Chris", "Barry", "Alex"] Èó≠ÂåÖË°®ËææÂºèËØ≠Ê≥ï‰∏äÈù¢ÊòØËæìÂÖ•‰∏Ä‰∏™ÂáΩÊï∞ÁöÑÊñπÂºèÔºåËøòÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™Èó≠ÂåÖË°®ËææÂºè„ÄÇÈó≠ÂåÖË°®ËææÂºèÁöÑËØ≠Ê≥ïÂ¶Ç‰∏ãÔºö {(parameters) -&gt; returntype in statements } ÊâÄ‰ª•ÂèØ‰ª•Â∞Ü‰∏äÈù¢ÁöÑÊéíÂ∫èÊñπÊ≥ïÊîπ‰∏∫Â¶Ç‰∏ãÔºö 123reversedNames = names.sorted(by: &#123; (s1: String, s2: String) -&gt; Bool in return s1 &gt; s2&#125;) Ê†πÊçÆ‰∏ä‰∏ãÊñáÊé®Êñ≠Á±ªÂûãÂõ†‰∏∫Èó≠ÂåÖÊòØ‰Ωú‰∏∫ÂáΩÊï∞ÁöÑÂèÇÊï∞‰º†ÂÖ•ÁöÑÔºåSwift ËÉΩÊé®Êñ≠Âá∫ÂÆÉÁöÑÂèÇÊï∞ÂíåËøîÂõûÂÄºÁöÑÁ±ªÂûã(Ê≥®ÊÑèÔºåÊòØÂè™Êúâ‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•ÁöÑÈó≠ÂåÖÔºåÊâçËÉΩ‰æùÊçÆÂáΩÊï∞ÁöÑÂèÇÊï∞Á±ªÂûãÊé®Êñ≠ÔºåÁúÅÁï•Èó≠ÂåÖÁöÑÂèÇÊï∞Á±ªÂûãÁöÑÂÆö‰πâ„ÄÇÂ¶ÇÊûúÊòØËá™Â∑±ÂçïÁã¨ÂÆö‰πâÁöÑ‰∏Ä‰∏™Èó≠ÂåÖÔºå‰∏çËÉΩËøõË°å‰∏ä‰∏ãÊñáÊé®Êñ≠Á±ªÂûã„ÄÇ)ÔºåÊâÄ‰ª•ÂèØ‰ª•ÁúÅÁï•Á±ªÂûãÔºö 1reversedNames = names.sorted(by: &#123; s1, s2 in return s1 &gt; s2 &#125; ) ÂÆûÈôÖ‰∏ä‰ªª‰ΩïÊÉÖÂÜµ‰∏ãÔºåÈÄöËøáÂÜÖËÅîÈó≠ÂåÖË°®ËææÂºèÊûÑÈÄ†ÁöÑÈó≠ÂåÖ‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄíÁªôÂáΩÊï∞Êó∂ÔºåÈÉΩÂèØ‰ª•Êé®Êñ≠Âá∫Èó≠ÂåÖÁöÑÂèÇÊï∞ÂíåËøîÂõûÂÄºÁ±ªÂûãÔºåËøôÊÑèÂë≥ÁùÄÊÇ®Âá†‰πé‰∏çÈúÄË¶ÅÂà©Áî®ÂÆåÊï¥Ê†ºÂºèÊûÑÈÄ†‰ªª‰ΩïÂÜÖËÅîÈó≠ÂåÖ„ÄÇÁÑ∂ËÄåÔºå‰Ω†‰πüÂèØ‰ª•‰ΩøÁî®ÊòéÁ°ÆÁöÑÁ±ªÂûãÔºåÂ¶ÇÊûú‰Ω†ÊÉ≥ÂÆÉÈÅøÂÖçËØªËÄÖÈòÖËØªÂèØËÉΩÂ≠òÂú®ÁöÑÊ≠ß‰πâÔºåËøôÊ†∑ËøòÊòØÂÄºÂæóÈºìÂä±ÁöÑ„ÄÇ ÂçïË°åË°®ËææÂºèÁúÅÁï•ÂçïË°åË°®ËææÂºèÈó≠ÂåÖÂèØ‰ª•ÈÄöËøáÈöêËóè return ÂÖ≥ÈîÆÂ≠óÊù•ÈöêÂºèËøîÂõûÂçïË°åË°®ËææÂºèÁöÑÁªìÊûúÔºåÂ¶Ç‰∏äÁâàÊú¨ÁöÑ‰æãÂ≠êÂèØ‰ª•ÊîπÂÜô‰∏∫Ôºö 1reversedNames = names.sorted(by: &#123; s1, s2 in s1 &gt; s2 &#125; ) ÂèÇÊï∞ÂêçÁÆÄÂÜôSwift ‰∏∫ÂÜÖËÅîÂáΩÊï∞Êèê‰æõ‰∫ÜÂèÇÊï∞ÂêçÁß∞ÁÆÄÂÜôÂäüËÉΩ„ÄÇÂèØ‰ª•Áõ¥Êé•Áî® $0,$1,$2 Á≠âÂêçÂ≠óÊù•ÂºïÁî®ÁöÑÈó≠ÂåÖÁöÑÂèÇÊï∞ÁöÑÂÄº„ÄÇÊ≠§Êó∂Ôºåin ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•Ë¢´ÁúÅÁï•„ÄÇÂú®Ëøô‰∏™‰æãÂ≠ê‰∏≠Ôºå$0 Âíå $1 Ë°®Á§∫Èó≠ÂåÖ‰∏≠Á¨¨‰∏Ä‰∏™ÂíåÁ¨¨‰∫å‰∏™ String Á±ªÂûãÁöÑÂèÇÊï∞„ÄÇ 1reversedNames = names.sorted(by: &#123; $0 &gt; $1 &#125; ) Â∞æÈÉ®Èó≠ÂåÖÂ¶ÇÊûúÂÆö‰πâÁöÑÂáΩÊï∞ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂèÇÊï∞ÊòØ‰∏Ä‰∏™Èó≠ÂåÖÔºåË∞ÉÁî®ÁöÑÊó∂ÂÄôÂèØ‰ª•‰ΩøÁî®Â∞æÈÉ®Èó≠ÂåÖ(Trailing Closures ‰∏çÁü•ÈÅìÊÄé‰πàÁøªËØëÂ•ΩÂ∞±Ëß£Èáä‰∏∫Â∞æÈÉ®Èó≠ÂåÖ‰∫Ü)„ÄÇÊ≥®ÊÑè‰π¶ÂÜôËØ≠Ê≥ïÔºö 123456789101112131415161718func someFunctionThatTakesAClosure(closure: () -&gt; Void) &#123; // function body goes here&#125; // Ê≤°Êúâ‰ΩøÁî®Â∞æÈÉ®Èó≠ÂåÖÁöÑÊÉÖÂÜµsomeFunctionThatTakesAClosure(closure: &#123; // closure's body goes here&#125;) // ‰ΩøÁî®Â∞æÈÉ®Èó≠ÂåÖÁöÑÊÉÖÂÜµ someFunctionThatTakesAClosure() &#123; // trailing closure's body goes here&#125;// ‰ΩøÁî®Â∞æÈÉ®Èó≠ÂåÖÂ¶ÇÊûúÊ≤°ÊúâÂèÇÊï∞ÔºåÂèØ‰ª•ÁúÅÁï•Êã¨Âè∑someFunctionThatTakesAclosure &#123; &#125; ÂèØ‰ª•ÁúãÂà∞ÂæàÊòéÊòæÁöÑÂå∫Âà´„ÄÇÊ≤°Êúâ‰ΩøÁî®Â∞æÈÉ®Èó≠ÂåÖÁöÑÊó∂ÂÄôÊòØÈùûÂ∏∏Ê≠£ËßÑÁöÑÂáΩÊï∞Ë∞ÉÁî®„ÄÇÂ¶ÇÊûúÊòØÂ∞æÈÉ®Èó≠ÂåÖÁöÑÊÉÖÂÜµÔºåÈÇ£‰πàÂ∞±ÂçïÁã¨ÊãøÂá∫Êù•ÊîæÂà∞Â§ñÈù¢„ÄÇ ÊØîÂ¶Ç‰∏äÈù¢ÁöÑ sorted(by:) ÊñπÊ≥ïÂèØ‰ª•ÊîπÊàêÂ∞æÈÉ®Èó≠ÂåÖÁöÑÂΩ¢ÂºèÔºö 1reversedNames = names.sorted() &#123; $0 &gt; $1 &#125; Â¶ÇÊûúÊï¥‰∏™ÂáΩÊï∞ÁöÑÂèÇÊï∞Âè™ÊúâËøô‰∏Ä‰∏™ÂÖ•ÂèÇÔºåÈÇ£‰πàËøòÂèØ‰ª•Áõ¥Êé•ÁúÅÁï•Ëøô‰∏™Êã¨Âè∑(ËôΩÁÑ∂Ê≤°ÊúâÊ≠ß‰πâÔºå‰ΩÜÊòØÊÄªÊÑüËßâËøôÁßçËØ≠Ê≥ïÁ≥ñ‰∏çÂ§™Â•Ω)Ôºö 1reversedNames = names.sorted &#123; $0 &gt; $1 &#125; ÂÜç‰∏æ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ‰æãÂ≠êÔºöÂú® Swift ‰∏≠ÁöÑÊï∞ÁªÑÁ±ªÂûã‰∏≠ÔºåÊúâ‰∏Ä‰∏™ map(_:) ÊñπÊ≥ïÔºåËøô‰∏™ÊñπÊ≥ïËæìÂÖ•‰∏Ä‰∏™Â§ÑÁêÜÂáΩÊï∞ÔºåÂØπÊï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏™ÂÖÉÁ¥†ËøõË°åÂ§ÑÁêÜÔºåËøîÂõû‰∏Ä‰∏™Â§ÑÁêÜËøáÁöÑÊñ∞Êï∞ÁªÑÔºö 1234567891011121314151617let digitNames = [ 0: "Zero", 1: "One", 2: "Two", 3: "Three", 4: "Four", 5: "Five", 6: "Six", 7: "Seven", 8: "Eight", 9: "Nine"]let numbers = [16, 58, 510]let strings = numbers.map &#123; (number) -&gt; String in var number = number var output = "" repeat &#123; output = digitNames[number % 10]! + output number /= 10 &#125; while number &gt; 0 return output&#125;// strings is inferred to be of type [String]// its value is ["OneSix", "FiveEight", "FiveOneZero"] ÊçïËé∑ÂÄºÈó≠ÂåÖÂèØ‰ª•Âú®ÊçïËé∑ÂÖ∂ÊâÄÂÆö‰πâÁöÑ‰∏ä‰∏ãÊñá‰∏≠ÁöÑÂèòÈáèÂíåÂ∏∏Èáè„ÄÇÂç≥‰ΩøÂÆö‰πâËøô‰∫õÂ∏∏ÈáèÂíåÂèòÈáèÁöÑÂéü‰ΩúÁî®ÂüüÂ∑≤Áªè‰∏çÂ≠òÂú®ÔºåÈó≠ÂåÖ‰ªçÁÑ∂ÂèØ‰ª•Âú®Èó≠ÂåÖÂáΩÊï∞‰ΩìÂÜÖÂºïÁî®Âíå‰øÆÊîπËøô‰∫õÂÄº„ÄÇ ‰∏ãÈù¢‰∏æ‰∏Ä‰∏™ÂÖ≥‰∫éÂµåÂ•óÂáΩÊï∞ÁöÑ‰æãÂ≠ê„ÄÇÂµåÂ•óÂáΩÊï∞ÂèØ‰ª•ÊçïËé∑ÂÖ∂Â§ñÈÉ®ÂáΩÊï∞ÊâÄÊúâÁöÑÂèÇÊï∞‰ª•ÂèäÂÆö‰πâÁöÑÂ∏∏ÈáèÂíåÂèòÈáèÔºö 1234567891011121314151617func makeIncrementer(forIncrement amount: Int) -&gt; () -&gt; Int &#123; var runningTotal = 0 func incrementer() -&gt; Int &#123; runningTotal += amount return runningTotal &#125; return incrementer&#125;// ‰ΩøÁî®:let incrementByTen = makeIncrementer(forIncrement: 10)incrementByTen()// returns a value of 10incrementByTen()// returns a value of 20incrementByTen()// returns a value of 30 incrementer ÂáΩÊï∞‰∏≠Âπ∂Ê≤°Êúâ‰øùÂ≠ò amount Âíå runningTotal„ÄÇincrementor ÂÆûÈôÖ‰∏äÊçïËé∑Âπ∂Â≠òÂÇ®‰∫ÜËØ•ÂèòÈáèÁöÑ‰∏Ä‰∏™ÂâØÊú¨ÔºåËÄåËØ•ÂâØÊú¨ÈöèÁùÄ incrementor ‰∏ÄÂêåË¢´Â≠òÂÇ®„ÄÇ Â¶ÇÊûúÊñ∞Âª∫‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑ incrementer ÔºåÂÖ∂‰ºöÊúâ‰∏Ä‰∏™Â±û‰∫éËá™Â∑±ÁöÑÁã¨Á´ãÁöÑ runningTotal ÂèòÈáèÁöÑÂºïÁî®Ôºö 12345let incrementBySeven = makeIncrementer(forIncrement: 7)incrementBySeven()// returns a value of 7incrementByTen()// returns a value of 40 Èó≠ÂåÖÊòØÂºïÁî®Á±ªÂûã‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåincrementBySeven Âíå incrementByTen ÊòØÂ∏∏ÈáèÔºå‰ΩÜÊòØËøô‰∫õÂ∏∏ÈáèÊåáÂêëÁöÑÈó≠ÂåÖ‰ªçÁÑ∂ÂèØ‰ª•Â¢ûÂä†ÂÖ∂ÊçïËé∑ÁöÑÂèòÈáèÂÄº„ÄÇ ËøôÊòØÂõ†‰∏∫ÂáΩÊï∞ÂíåÈó≠ÂåÖÈÉΩÊòØÂºïÁî®Á±ªÂûã„ÄÇ Êó†ËÆ∫ÊÇ®Â∞ÜÂáΩÊï∞/Èó≠ÂåÖËµãÂÄºÁªô‰∏Ä‰∏™Â∏∏ÈáèËøòÊòØÂèòÈáèÔºåÊÇ®ÂÆûÈôÖ‰∏äÈÉΩÊòØÂ∞ÜÂ∏∏Èáè/ÂèòÈáèÁöÑÂÄºËÆæÁΩÆ‰∏∫ÂØπÂ∫îÂáΩÊï∞/Èó≠ÂåÖÁöÑÂºïÁî®„ÄÇ ‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåincrementByTen ÊåáÂêëÈó≠ÂåÖÁöÑÂºïÁî®ÊòØ‰∏Ä‰∏™Â∏∏ÈáèÔºåËÄåÂπ∂ÈùûÈó≠ÂåÖÂÜÖÂÆπÊú¨Ë∫´„ÄÇ Ëøô‰πüÊÑèÂë≥ÁùÄÂ¶ÇÊûúÊÇ®Â∞ÜÈó≠ÂåÖËµãÂÄºÁªô‰∫Ü‰∏§‰∏™‰∏çÂêåÁöÑÂ∏∏Èáè/ÂèòÈáèÔºå‰∏§‰∏™ÂÄºÈÉΩ‰ºöÊåáÂêëÂêå‰∏Ä‰∏™Èó≠ÂåÖÔºö 123let alsoIncrementByTen = incrementByTenalsoIncrementByTen()// returns a value of 50 ÈÄÉÈÄ∏Èó≠ÂåÖÂΩì‰∏Ä‰∏™Èó≠ÂåÖ‰Ωú‰∏∫ÂèÇÊï∞‰º†Âà∞Âè¶‰∏Ä‰∏™ÂáΩÊï∞‰∏≠ÔºåÂπ∂‰∏îËøô‰∏™Èó≠ÂåÖÂú®ÂáΩÊï∞ËøîÂõûÂêéÊâçË∞ÉÁî®ÔºàÊØîÂ¶ÇÂú®ÂáΩÊï∞‰∏≠ÊâßË°å‰∏Ä‰∏™ÂºÇÊ≠•ÂõûË∞ÉÔºåÂõûË∞ÉÊó∂ÊâçÊâßË°åËøô‰∏™Èó≠ÂåÖÔºâÔºåÊàë‰ª¨Áß∞ËØ•Èó≠ÂåÖ‰ªéÂáΩÊï∞‰∏≠ÈÄÉÈÄ∏„ÄÇÈúÄË¶ÅÂú®ÂáΩÊï∞ÂêçÂâçÊ†áÊ≥® @escapingÔºåÁî®Êù•Ë°®Á§∫Ëøô‰∏™Èó≠ÂåÖÊòØÂÖÅËÆ∏ÈÄÉÈÄ∏Âá∫ÂáΩÊï∞ÁöÑ„ÄÇ ‰∏ãÈù¢Ê®°Êãü‰∏Ä‰∏ãÊÉÖÊôØÔºöÂ∞Ü completionHandler ÂèÇÊï∞‰øùÂ≠òÂú®Â§ñÈÉ®ÁöÑ‰∏Ä‰∏™Êï∞ÁªÑ‰∏≠ÔºåÊ≠§Êó∂ÂøÖÈ°ªË¶ÅÊ†áËÆ∞ @escaping Âê¶Âàô‰∫ßÁîüÁºñËØëÈîôËØØÔºö 1234var completionHandlers: [() -&gt; Void] = []func someFunctionWithEscapingClosure(completionHandler: @escaping () -&gt; Void) &#123; completionHandlers.append(completionHandler)&#125; Â∞ÜÈó≠ÂåÖÊ†áËÆ∞‰∏∫ÈÄÉÈÄ∏Èó≠ÂåÖÔºåÂ∞±ÂøÖÈ°ªÂú®Èó≠ÂåÖ‰∏≠ÊòæÂºèÂú∞ÂºïÁî® self„ÄÇÁúã‰∏ãÈù¢ÁöÑÁ§∫‰æãÔºö 1234567891011121314151617181920func someFunctionWithNonescapingClosure(closure: () -&gt; Void) &#123; closure()&#125;class SomeClass &#123; var x = 10 func doSomething() &#123; someFunctionWithEscapingClosure &#123; self.x = 100 &#125; someFunctionWithNonescapingClosure &#123; x = 200 &#125; &#125;&#125;let instance = SomeClass()instance.doSomething()print(instance.x)// ÊâìÂç∞Âá∫ "200"completionHandlers.first?()print(instance.x)// ÊâìÂç∞Âá∫ "100" ÂÖ∂‰∏≠ÔºåÈÄÉÈÄ∏ÁöÑÈó≠ÂåÖÊ≤°ÊúâÁ´ãÂàªÊâßË°åÔºåÊâÄ‰ª• instance.x ÂÖàË¢´ËÆæÁΩÆÊàê‰∫Ü 100ÔºåÁÑ∂ÂêéÈó≠ÂåÖÊâßË°å‰∫ÜÂêéÔºåÊâçË¢´ËÆæÁΩÆÊàê 200„ÄÇ Âè¶Â§ñÔºåÁúãÂà∞ completionHandlers.first?() ‰∫Ü‰πàÔºåËôΩÁÑ∂ËøôÂàóÊï∞ÁªÑÊòØÈùûÂèØÈÄâÁöÑÔºå‰ΩÜÊòØËøô‰∏™ first ÊñπÊ≥ïËøîÂõûÁöÑÊòØ‰∏Ä‰∏™ÂèØÈÄâÁ±ªÂûãÔºåÊâÄ‰ª•‰ΩøÁî®ÁöÑÊó∂ÂÄôË¶ÅÂä†‰∏ä ? ÊàñËÄÖ ! ÈÄÉÈÄ∏Èó≠ÂåÖË¶ÅÊ≥®ÊÑè‰∫ßÁîüÂºïÁî®Âæ™ÁéØÔºåÈúÄË¶ÅÂíå oc ‰∏ÄÊ†∑‰ΩøÁî® weak Ê†áËÆ∞Â±ûÊÄß„ÄÇ Ëá™Âä®Èó≠ÂåÖËá™Âä®Èó≠ÂåÖÊòØ‰∏ÄÁßçÈó≠ÂåÖÁöÑÁÆÄÂÜôÊñπÂºè„ÄÇ‰∏çÊé•Âèó‰ªª‰ΩïÂèÇÊï∞ÔºåÂΩì‰ªñË¢´Ë∞ÉÁî®Êó∂Ôºå‰ºöËøîÂõûË¢´ÂåÖË£ÖÂú®ÂÖ∂‰∏≠ÁöÑË°®ËææÂºèÁöÑÂÄº„ÄÇËøôÁßç‰æøÂà©ËØ≠Ê≥ïËÆ©‰Ω†ËÉΩÂ§üÁúÅÁï•Èó≠ÂåÖÁöÑËä±Êã¨Âè∑ÔºåÁî®‰∏Ä‰∏™ÊôÆÈÄöÁöÑË°®ËææÂºèÊù•‰ª£ÊõøÊòæÂºèÁöÑÈó≠ÂåÖ„ÄÇ Êù•Áúã‰∏™‰æãÂ≠êÂ∞±ÊòéÁôΩ‰∫ÜÔºåÂÖàÁúã‰∏Ä‰∏ã‰∏çÁî®Ëá™Âä®Èó≠ÂåÖÁöÑÊÉÖÂÜµÔºö 123456// customersInLine is ["Alex", "Ewa", "Barry", "Daniella"]func serve(customer customerProvider: () -&gt; String) &#123; print("Now serving \(customerProvider())!")&#125;serve(customer: &#123; customersInLine.remove(at: 0) &#125; )// ÊâìÂç∞Âá∫ "Now serving Alex!" ‰∏äÈù¢ËøôÁßçÊÉÖÂÜµÁöÑÂáΩÊï∞Ë∞ÉÁî®ÊòØÊ≠£Â∏∏ÁöÑÊâìÂºÄÊñπÂºè„ÄÇ‰∏ãÈù¢Êù•Áúã‰∏ãËá™Âä®Èó≠ÂåÖÁöÑ‰ΩøÁî®Ôºö 12345func serve(customer customerProvider: @autoclosure () -&gt; String) &#123; print("Now serving \(customerProvider())!")&#125;serve(customer: customersInLine.remove(at: 0))// ÊâìÂç∞Âá∫ "Now serving Ewa!" ‰∏äÈù¢Áî®‰∫Ü autoclosure Ê†áËÆ∞ÂêéÔºå‰∏ãÈù¢ÁöÑÈó≠ÂåÖÂèØ‰ª•‰∏çÁî®Êã¨Âè∑„ÄÇ(ËøôÁé©ÊÑè‰ºöÊúâ‰∫∫Áî®ÔºüÊØ´Êó†ÊÑè‰πâ„ÄÇÂ∞±ÂΩìËÆ∞ÂΩï‰∏Ä‰∏ãÂêß) Ë≤å‰ººÂè™ÈíàÂØπ‰∏ÄÂè•ËØùÁöÑÈó≠ÂåÖ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Swift 3.1 ËØ≠Ê≥ïÂ≠¶‰π†Ôºà‰∏ÄÔºâ]]></title>
    <url>%2F2017%2F02%2F22%2Fswift%E8%AF%AD%E6%B3%95%2F</url>
    <content type="text"><![CDATA[ÂºÄÂßãÂïÉ Swift 3.1 ÁöÑÂÆòÊñπÊñáÊ°£ÔºåÂú∞ÂùÄSwift ÂÆòÊñπÊñáÊ°£„ÄÇ ÂèØ‰ª•ÂèÇËßÅÁõ∏ÂÖ≥ÁöÑ‰∏≠ÊñáÊñáÊ°£ÔºöÊñáÊ°£1ÊñáÊ°£2 ÂÖ∂‰∏≠Êúâ‰∫õÂú∞ÊñπÁøªËØëÁöÑ‰∏çÂ•ΩÔºåÊâÄ‰ª•ÂèØ‰ª•ÂØπÁÖßÁùÄÁúã‰∏ÄÁúã„ÄÇ Âü∫Á°ÄÂèòÈáèÂíåÂ∏∏ÈáèÂ∏∏ÈáèËÆæÁΩÆÂ•ΩÂ∞±‰∏çËÉΩÂèòÔºåÂèòÈáèËÆæÁΩÆÂ•ΩËÉΩÂú®‰πãÂêéËÆæÁΩÆ‰∏çÂêåÁöÑÂÄº„ÄÇ Â£∞ÊòéÁî® let Â£∞ÊòéÂ∏∏ÈáèÔºåÁî® var Â£∞ÊòéÂèòÈáèÔºö 12let maximumNumberOfLoginAttempts = 10var currentLoginAttempt = 0 ÂèØ‰ª•Âú®‰∏ÄË°åÈáåÂ£∞ÊòéÂ§ö‰∏™ÂèòÈáèÊàñÂ∏∏ÈáèÔºåÁî®ÈÄóÂè∑ÈöîÂºÄÔºö 1var x = 0.0, y = 0.0, z = 0.0 ÔºàÂèòÈáèÂàùÂßãÂåñÂêéÂ∞±‰∏çËÉΩËµãÁªôÂÖ∂ÈùûËØ•Á±ªÂûãÁöÑÂÄº‰∫ÜÔºåÊØîÂ¶Ç‰∏äÈù¢ÁöÑ xÔºåÂ∞±Âè™ËÉΩÊé•Êî∂ double Á±ªÂûãÁöÑÂÄº‰∫ÜÔºâ ÂèòÈáèÂ∏∏ÈáèÈÉΩÂèØ‰ª•ÂÖàÂ£∞ÊòéÔºå‰∏çÁî®Á´ãÂç≥ËµãÂÄº„ÄÇ ‰ΩÜÊòØÂú®Ëé∑ÂèñÁöÑÊó∂ÂÄôÔºåÂè™ÊúâÂèØÈÄâÂèòÈáè‰ºöË¢´ÈªòËÆ§ËÆæÁΩÆ‰∏∫ nil„ÄÇ ÂÖ∂‰ΩôÈùûÂèØÈÄâÂèòÈáèÂ∏∏ÈáèÔºå‰ª•ÂèäÂèØÈÄâÂ∏∏ÈáèÔºåÂú®Ê≤°ÊúâËµãÂàùÂÄºÁöÑÊÉÖÂÜµ‰∏ãËØªÂèñÊàñËÄÖÂº∫Âà∂Ëß£ÂåÖÔºåÈÉΩ‰ºö‰∫ßÁîüÂºÇÂ∏∏„ÄÇ Á±ªÂûãÊ≥®ÈáäÂ£∞ÊòéÁöÑÊó∂ÂÄôÂèØ‰ª•Ê≥®ÊòéÁ±ªÂûãÔºö 1var welcomeMessage: String ËøôÊ†∑ÔºåËØ•ÂèòÈáèÂ∞±Âè™ËÉΩÊé•ÂèóÂ≠óÁ¨¶‰∏≤Á±ªÂûã„ÄÇÂèØ‰ª•‰ª•ËøôÊ†∑ÁöÑÊñπÂºè‰∏ÄÊ¨°ÂÆö‰πâÂ§ö‰∏™ÂèòÈáèÔºö 1var red, green, blue: Double Â¶ÇÊûúÊ≤°ÊúâÂÄºÔºåÂ∞±‰∏ÄÂÆöË¶ÅÊ†áÊ≥®Á±ªÂûãÔºåÂ¶ÇÊûúÊúâÂÄºÔºåÂ∞±ÂèØ‰ª•ÈÄöËøáÁ±ªÂûãÊé®Êñ≠„ÄÇ ÂèçÊ≠£‰∏ÄÂÆöË¶ÅÂú®Â£∞ÊòéÁöÑÊó∂ÂÄôÁ°ÆÂÆöÁ±ªÂûã ÊâìÂç∞ÂèØ‰ª•ÈÄöËøá print(_:separator:terminator:) ÊñπÊ≥ïÊâìÂç∞ÂèòÈáè„ÄÇÂÖ∂‰∏≠ separator Ë°®Á§∫ÂàÜÈöîÁ¨¶ÔºåÈªòËÆ§ÊòØÁ©∫Ê†ºÔºåterminator Ë°®Á§∫ÁªàÊ≠¢Á¨¶ÔºåÈªòËÆ§ÊòØÂõûËΩ¶„ÄÇËØ•ÊñπÊ≥ïÊé•ÂèóÂ§ö‰∏™ÈúÄË¶ÅÊâìÂç∞ÁöÑÂèòÈáèËæìÂÖ•Ôºå‰æãÔºö 1234print("item1","item2",separator:"_",terminator:" end")// ÊâìÂç∞ÁªìÊûú:"item1_item2 end"print("item1",terminator:" end")// ÊâìÂç∞ÁªìÊûú:"item1 end" Swift Êèê‰æõÂèçÊñúÊù† \ Êù•ËææÂà∞Â≠óÁ¨¶‰∏≤‰∏≠ÊõøÊç¢ÂèòÈáèÂêçÁöÑÊïàÊûúÔºàÂèØ‰ª•Êé•ÂèóÈùûÂ≠óÁ¨¶‰∏≤ÔºâÔºö 1234var myName = "Zachary"var myAge = 18print("My name is \(myName),and my age is \(myAge)")// ÊâìÂç∞ÁªìÊûú:"My name is Zachary,and my age is 18" ËøôÈáåÂèçÊñúÊù†Á±ª‰ºº‰∫éËΩ¨‰πâÔºåÊâÄ‰ª•ËøòÊòØË¶ÅÂú®Â≠óÁ¨¶‰∏≤ÈáåÂá∫Áé∞ÁöÑÔºå‰∏çËÉΩÊòØÁõ¥Êé• print(\(myName)) ÂàÜÂè∑Swift ‰∏≠‰∏çÈúÄË¶ÅÂÜôÂàÜÂè∑Ôºå‰∏ÄÂè•‰∏ÄË°å„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú‰∏ÄÂè•Ë¶ÅÊúâÂ§ö‰∏™Ë°®ËææÂºèÔºåËøòÊòØË¶ÅÁî®ÂàÜÂè∑ÈöîÂºÄÁöÑÔºö 12let cat = "üê±"; print(cat)// Prints "üê±" Á±ªÂûãÂÆâÂÖ®‰∏éÁ±ªÂûãÊé®Êñ≠Swift ÊòØÁ±ªÂûãÂÆâÂÖ®ÁöÑËØ≠Ë®Ä„ÄÇÂ¶ÇÊûú‰ª£Á†ÅÈáåÈúÄË¶ÅÁöÑÊòØ‰∏Ä‰∏™ StringÔºåÈÇ£‰πà‰Ω†Â∞±‰∏çËÉΩ‰º†‰∏™ Int„ÄÇ‰∏çËøáÂú®Á±ªÂûãÊé®Êñ≠Ëøô‰∏™Êú∫Âà∂ÁöÑ‰ΩúÁî®‰∏ãÔºå‰Ω†‰∏çÂøÖÂÖ∑‰ΩìËØ¥ÊòéÁ±ªÂûã„ÄÇÊØîÂ¶ÇÔºö 12let age1 = 18 // ÈªòËÆ§ÊòØ Int Á±ªÂûãlet age2 = 18.0 // ÈªòËÆ§ÊòØ Double Á±ªÂûã(Swift ÈªòËÆ§Áî® Double ËÄå‰∏çÊòØ Float) ËøôÈáåÁ±ªÂûãÊé®Êñ≠ÊòØÊåáÊ≤°ÊúâÂú®ÂêéÈù¢ÂÜô‰∏äÁ±ªÂûãÁöÑÔºåÊØîÂ¶Ç let age1: Int Â∞±Â∑≤ÁªèË°®Á§∫ÊòØÈùûÁ©∫ÁöÑ Int Âûã‰∫ÜÔºåÂ∞±‰∏çÂèØËÉΩÂÜçÊé®Êñ≠‰∫Ü Êï∞Â≠óÁöÑË°®Áé∞ÊñπÂºè(ÁúÅÁï•‰∫Ü‰∏çÂêåËøõÂà∂ÔºåÁßëÂ≠¶ËÆ°Êï∞Á≠âÂÜÖÂÆπ) Swift ÂÖÅËÆ∏‰ΩøÁî® _ ‰∏ãÂàíÁ∫øÊù•ÂÅöÊ†áËØÜÔºå‰∏çÂΩ±ÂìçÊï∞Â≠óÂ§ßÂ∞èÔºö 12let oneMillion = 1_000_000let justOverOneMillion = 1_000_000.000_000_1 Êï∞Â≠óÁ±ªÂûãËΩ¨Êç¢‰∏çËÉΩÂØπ‰∏§‰∏™‰∏çÂêåÁ±ªÂûãÁöÑÂèòÈáèËøõË°åÊìç‰ΩúÔºåÊØîÂ¶ÇÔºö 1234let three = 3let pointOneFourOneFiveNine = 0.14159let pi = Double(three) + pointOneFourOneFiveNine // 3.14159let num = three + Int(pointOneFourOneFiveNine) // 3 + 0 = 3 ËøôÈáåÁöÑ three ÊòØ Int ÂûãÔºåpointOneFourOneFiveNine ÊòØ Double Âûã„ÄÇÁî±‰∫éÊ≤°ÊúâÈöêÂºèËΩ¨Êç¢ÔºåË¶ÅÂØπ‰∏§‰∏™ÂèòÈáèËøõË°åÂíåÊìç‰ΩúÂøÖÈ°ªÂÖàÂØπÂÖ∂‰∏≠‰∏Ä‰∏™ËøõË°åÊòæÂºèÁ±ªÂûãËΩ¨Êç¢„ÄÇÔºàÊï∞Â≠ó3ÊòØÂèØ‰ª•Áõ¥Êé•ÂíåÊï∞Â≠ó0.14159Áõ∏Âä†ÁöÑÔºåÂõ†‰∏∫Êï∞Â≠óÊòØÊ≤°ÊúâÁ±ªÂûãÁöÑÔºâ Á±ªÂûãÂà´ÂêçÁ±ªÂûãÂà´Âêç‰∏∫Áé∞ÊúâÁ±ªÂûãÂÆö‰πâ‰∏Ä‰∏™Âà´Âêç„ÄÇÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Á±ªÂûãÂà´Âêç‰πãÂêéÔºå‰Ω†ÂèØ‰ª•Âú®‰ªª‰Ωï‰ΩøÁî®ÂéüÂßãÂêçÁöÑÂú∞Êñπ‰ΩøÁî®Âà´ÂêçÔºö 12typealias AudioSample = Intvar num:AudioSample = 10 ÊÑüËßâÊ≤°Âï•Áî®ÔºåËøòÂÆπÊòìËÆ©‰∫∫ËØØËß£ Â∏ÉÂ∞îÁ±ªÂûãSwift ÁöÑÂ∏ÉÂ∞îÁ±ªÂûãÂè´ÂÅö BoolÔºå‰∏§‰∏™Â∏ÉÂ∞îÂÄº‰∏∫ true Âíå false„ÄÇ ÂÖ∂ÂÆÉÊ≤°‰ªÄ‰πàÁâπÂà´ÁöÑÔºåÊúâ‰∏ÄÁÇπË¶ÅËØ¥ÊòéÔºö 1234567891011// ÁºñËØë‰∏çÈÄöËøálet i = 1if i &#123; // this example will not compile, and will report an error&#125;// ÁºñËØëÈÄöËøálet i = 1if i == 1 &#123; // this example will compile successfully&#125; Â¶ÇÊûú‰Ω†Âú®ÈúÄË¶Å‰ΩøÁî® Bool Á±ªÂûãÁöÑÂú∞Êñπ‰ΩøÁî®‰∫ÜÈùûÂ∏ÉÂ∞îÂÄºÔºåSwift ÁöÑÁ±ªÂûãÂÆâÂÖ®Êú∫Âà∂‰ºöÊä•Èîô„ÄÇËøôÂ∞±‰∏çÂÉèÂæàÂ§öÂÖ∂‰ªñËØ≠Ë®ÄÔºåÈùûÈõ∂ÈùûÁ©∫Â∞±ÊòØ true„ÄÇSwift ‰ºöÈòªÊ≠¢‰Ω†Áî®‰∏Ä‰∏™ÈùûÂ∏ÉÂ∞îÈáèÊõøÊç¢Ë∞É Bool if Êù°‰ª∂ËØ≠Âè•ÂøÖÈ°ªÊòØ‰∏Ä‰∏™ÊúâÂÄºÁöÑË°®ËææÂºè Êù°‰ª∂Âà§Êñ≠‰∏çÁî®Êã¨Âè∑ÔºåÂõ†‰∏∫‰∏ç‰ºö‰∫ßÁîü‰∫åÊÑè ÂÖÉÁªÑÂÖÉÁªÑÂú®ÂÖ∂ÂÆÉÁöÑËÑöÊú¨ËØ≠Ë®ÄÈáåÁî®ÁöÑÊå∫Â§ö‰∫Ü„ÄÇÂÆÉÊääÂ§ö‰∏™ÂÄºÁªÑÂêàÊàê‰∏Ä‰∏™Â§çÂêàÂÄº„ÄÇÂÖÉÁªÑÂÜÖÁöÑÂÄºÂèØ‰ª•ÊòØ‰ªªÊÑèÁ±ªÂûãÔºåÂπ∂‰∏çË¶ÅÊ±ÇÊòØÁõ∏ÂêåÁ±ªÂûã„ÄÇ ‰æãÂ¶Ç‰∏Ä‰∏™ HTTP Áä∂ÊÄÅÁ†ÅÔºö 12let http404Error = (404, "Not Found")// http404Error is of type (Int, String), and equals (404, "Not Found") ‰Ω†ÂèØ‰ª•Êää‰ªªÊÑèÈ°∫Â∫èÁöÑÁ±ªÂûãÁªÑÂêàÊàê‰∏Ä‰∏™ÂÖÉÁªÑÔºå‰πüÂèØ‰ª•Â∞ÜÂÖÉÁªÑÂàÜËß£Ôºö 12345let (statusCode, statusMessage) = http404Errorprint("The status code is \(statusCode)")// Prints "The status code is 404"print("The status message is \(statusMessage)")// Prints "The status message is Not Found" ËøôÊ†∑ÔºåÂØπÂ∫î‰ΩçÁΩÆÁöÑÂèòÈáèÂ∞±Ë¢´ËµãÂÄº‰∫Ü„ÄÇÂ¶ÇÊûúÂè™ÈúÄË¶ÅÈÉ®ÂàÜÂÖÉÁªÑÂÄºÔºåÂèØ‰ª•‰ΩøÁî® _ ÂøΩÁï•ÔºåËøôÊòØ‰∏ãÂàíÁ∫øÁöÑÁ¨¨‰∫åÁßçÁî®Ê≥ïÔºåÊ≥®ÊÑèËµãÂÄºÁöÑÊï∞ÈáèË¶ÅÂØπ‰∏äÔºö 123let (justTheStatusCode, _) = http404Errorprint("The status code is \(justTheStatusCode)")// Prints "The status code is 404" Êàë‰ª¨ËøòÂèØ‰ª•Áõ¥Êé•Êìç‰ΩúÂÖÉÁªÑÂÖÉÁ¥†ÁöÑ‰∏ãÊ†áÊãøÂà∞ÂÖÉÁ¥†Ôºö 1234print("The status code is \(http404Error.0)")// Prints "The status code is 404"print("The status message is \(http404Error.1)")// Prints "The status message is Not Found" Êàë‰ª¨‰πüÂèØ‰ª•Áõ¥Êé•Âú®Â£∞ÊòéÁöÑÊó∂ÂÄô‰∏∫ÂÖÉÁªÑÂÖÉÁ¥†ÂëΩÂêçÔºö 123456let http200Status = (statusCode: 200, description: "OK")print("The status code is \(http200Status.statusCode)")// Prints "The status code is 200"print("The status message is \(http200Status.description)")// Prints "The status message is OK" ÂÖÉÁªÑ‰Ωú‰∏∫ÂáΩÊï∞ËøîÂõûÂÄºÁöÑÊó∂ÂÄôÈùûÂ∏∏ÊúâÁî®ÔºåÈÄÇÂêà‰Ωú‰∏∫‰∏¥Êó∂ÁöÑ‰∏ÄÁªÑÂÄºÁöÑÈõÜÂêà„ÄÇ‰ΩÜÊòØ‰∏çÈÄÇÂêàÂàõÂª∫Â§çÊùÇÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇÂ¶ÇÊûúË¶ÅÂàõÂª∫‰∏Ä‰∏™ÊåÅ‰πÖÂåñÁöÑÊï∞ÊçÆÁªìÊûÑÔºåËøòÊòØÂª∫ËÆÆ‰ΩøÁî®Á±ªÂíåÁªìÊûÑ‰Ωì„ÄÇ ÂèØÈÄâÂèØÈÄâÂèØ‰ª•Áî®Âú®‰∏Ä‰∏™ÂÄºÂèØËÉΩÁº∫Â§±ÁöÑÊÉÖÂÜµ‰∏ã„ÄÇÂÖ∂ÂÆûÂ∞±ÊòØÂèØËÉΩ‰∏∫Âü∫Êú¨Á±ªÂûãÔºå‰πüÂèØËÉΩ‰∏∫Á©∫„ÄÇÊØîÂ¶ÇÂú®Âº∫Âà∂Á±ªÂûãËΩ¨Âåñ‰∏≠: 123let possibleNumber = "123"let convertedNumber = Int(possibleNumber)// convertedNumber is inferred to be of type "Int?", or "optional Int" ËøôÈáåÈù¢Â∞Ü possibleNumber Âº∫ËΩ¨‰∏∫ Int ÂûãÔºåÂèØËÉΩÊàêÂäüÔºå‰ΩÜÂ¶ÇÊûúÊòØ &quot;hello,world&quot; Â∞±ËÇØÂÆöÂ§±Ë¥•‰∫Ü„ÄÇÊâÄ‰ª•ËøôÈáå convertedNumber Â∞±ÊòØ‰∏Ä‰∏™ÂèØÈÄâÁ±ªÂûãÔºå‰∏ç‰∏ÄÂÆöÊòØ Int„ÄÇÂèØÈÄâÁöÑ Int Á±ªÂûãÁî® Int? Ë°®Á§∫„ÄÇÈóÆÂè∑ÊöóÁ§∫ÂåÖÂê´ÁöÑÂÄºÊòØÂèØÈÄâÔºå‰πüÂ∞±ÊòØËØ¥ÂèØËÉΩÊòØ Int ‰πüÂèØËÉΩ‰∏çÂåÖÂê´ÂÄº„ÄÇ ‰∏äÈù¢ possibleNumber Áî±‰∫éÁ±ªÂûãÊé®Êñ≠Ôºå‰∏ÄÂÆöÊòØ‰∏çÂèØÈÄâÁ±ªÂûãÔºåÈô§ÈùûÂ∞Ü possibleNumber ÂÜôÊàê let possibleNumber: String? = &quot;123&quot;ÔºåÊâçËÉΩË°®Á§∫ÂèØÈÄâ„ÄÇ convertedNumber ÊòØ‰∏Ä‰∏™ÂèØÈÄâÁ±ªÂûãÔºåÂú®ÂØπÂèØÈÄâÁ±ªÂûãËøõË°åËµãÂÄº‰ª•Â§ñÁöÑÊìç‰ΩúÁöÑÊó∂ÂÄôÔºåÈúÄË¶Å‰ΩøÁî® ! ÊàñËÄÖ ? ÂåÖË£π„ÄÇ ÂÖÉÁªÑ‰πüÂèØ‰ª•Ë¢´ËÆæÁΩÆ‰∏∫ÂèØÈÄâÔºåÂú®ÂÖÉÁªÑÂêéÊ∑ªÂä† ?Ôºö 1let a: (Int,Int)? = nil ËøòÊúâ‰∏ÄÁßçÈúÄË¶ÅÂå∫Âà´ÁöÑÊòØÂÖÉÁªÑÂÜÖÂÖÉÁ¥†ÁöÑÂèØÈÄâÔºåÂú®ÂèØÈÄâÁöÑÁ±ªÂûãÂêéÊ∑ªÂä† ?Ôºö 12let a: (String?,Int) = (nil,2) // ‚àölet a = (nil,2) // √ó Ê≤°ÊúâÂ£∞ÊòéÔºåÈÇ£Â∞±Ë°®Á§∫ÊòØÈùûÂèØÈÄâ Áõ¥Êé•ËµãÂÄºÁöÑÈÉΩËÉΩÈÄöËøáËµãÁªôÁöÑÂÄºËøõË°åÁ±ªÂûãÊé®Êñ≠ÔºåËÄå‰∏çÊòØÂèØÈÄâÁ±ªÂûãÔºõÂâçÈù¢Áõ¥Êé• var str: String Â£∞Êòé‰ΩÜÊ≤°ÊúâËµãÂÄºÁöÑ‰πüÊòØÈùûÂèØÈÄâÁöÑ„ÄÇ ÂèØÈÄâÂèòÈáèÁöÑÂ£∞ÊòéÔºå‰∏ÄÂÆöË¶ÅÊâãÂä®Ê†áÊòéÔºåÂç≥‰∏ÄÂÆöË¶ÅÂä†‰∏ä ?,Âç≥ let possibleNumber: String?ÔºåÂê¶ÂàôÂ∞±ÊòØ‰∏çÂèØÈÄâÁöÑ„ÄÇÂàáËÆ∞ÂàáËÆ∞„ÄÇ nilÂ¶ÇÊûú‰∏Ä‰∏™Á±ªÂûãÊòØÂèØÈÄâÁ±ªÂûãÔºåÈÇ£‰πà‰Ω†ÂèØ‰ª•Â∞ÜÂÖ∂ÂÄºËÆæ‰∏∫ nil: 1234var serverResponseCode: Int? = 404// serverResponseCode contains an actual Int value of 404serverResponseCode = nil// serverResponseCode now contains no value Â¶ÇÊûúÂèòÈáèÊàñÂ∏∏ÈáèÁöÑÁ±ªÂûã‰∏çÊòØÂèØÈÄâÁöÑÔºåÈÇ£‰πàÂ∞±‰∏çËÉΩÁî® nil ‰∫Ü„ÄÇÂèç‰πã‰∫¶ÁÑ∂ÔºåÂ¶ÇÊûú‰ª£Á†Å‰∏≠ÁöÑÂèòÈáèÊàñËÄÖÂ∏∏ÈáèÂèØËÉΩ‰ºö‰∏∫Á©∫ÁöÑÊó∂ÂÄôÔºåÊÄªÊòØÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ÂèØÈÄâÁ±ªÂûã„ÄÇ Â¶ÇÊûúÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Ê≤°ÊúâÊèê‰æõÈªòËÆ§ÂÄºÁöÑÂèØÈÄâÂèòÈáèÔºåÈÇ£‰πàÈªòËÆ§ËÆæÁΩÆ‰∏∫ nilÔºõÂÆö‰πâ‰∏Ä‰∏™Ê≤°ÊúâÈªòËÆ§ÂÄºÁöÑÈùûÂèØÈÄâÂèòÈáèÔºåÂ¶ÇÊûú‰ΩøÁî®ÈÇ£‰πà‰ºöÊä•ÈîôÔºö 1234var surveyAnswer: String?print(surveyAnswer) // nilvar surveyAnswer: String print(surveyAnswer) // variable 'surveyAnswer' used before being initialized ‰∏äÈù¢ÊòØ var Á±ªÂûãÔºålet Á±ªÂûãÁöÑÂ∏∏ÈáèÔºåÊó†ËÆ∫ÊòØÂê¶ÂèØÈÄâÔºå‰ΩøÁî®ÂâçÂøÖÈ°ªÂàùÂßãÂåñ„ÄÇ ÂèØËÉΩÊòØÂõ†‰∏∫Â¶ÇÊûúÊ≤°ÊúâÂàùÂßãÂåñÔºåÈÇ£Â∞±Ë¶ÅË¢´Êé®Êñ≠‰∏∫ nilÔºå‰∏î‰∏çËÉΩÊîπÂèò„ÄÇËøôÁßç‰∏çÊòØÁî±Á®ãÂ∫è‰∏ä‰∏ãÊñáËÆæÁΩÆÁöÑ nilÔºåËÄåÊòØÊé®Êñ≠Âá∫ÁöÑ nil Ê≤°ÊúâÊÑè‰πâÔºåÊâÄ‰ª•Á¥¢ÊÄßÊäõÂá∫‰∏™ÂºÇÂ∏∏„ÄÇ oc ‰∏≠ÁöÑ nil ÊòØ‰∏Ä‰∏™ÊåáÂêë‰∏çÂ≠òÂú®ÂØπË±°ÁöÑÊåáÈíà„ÄÇÂú® Swift ‰∏≠ nil ‰∏çÊòØÊåáÈíàÔºåÂè™ÊòØË°®Á§∫Áº∫Â§±ÂÄºÔºå‰ªª‰ΩïÁ±ªÂûãÈÉΩÂèØ‰ª•Ë¢´ËÆæÁΩÆ‰∏∫ nilÔºàÂåÖÊã¨Âü∫Êú¨Á±ªÂûãÔºâ„ÄÇ Âº∫Âà∂Ëß£Êûê Â¶ÇÊûú‰Ω†Á°Æ‰ø°‰Ω†ÁöÑÂèØÈÄâÁ±ªÂûã‰∏ÄÂÆöÊòØÊúâÂÄºÁöÑÔºåÈÇ£‰πàÂèØ‰ª•Âú®ÂèØÈÄâÁöÑÂèòÈáèÂêçÂêéÈù¢Âä†‰∏ä !ÔºåË°®Á§∫Ëøô‰∏™ÂèØÈÄâÂÄºÂøÖÁÑ∂ÊúâÂÄºÔºö 1234if convertedNumber != nil &#123; print("convertedNumber has an integer value of \(convertedNumber!).")&#125;// Prints "convertedNumber has an integer value of 123." Â¶ÇÊûúÊÉ≥Ë¶ÅÂØπ‰∏Ä‰∏™ÂèØÈÄâÁ±ªÂûãËøõË°åËµãÂÄº‰ª•Â§ñÁöÑÊìç‰ΩúÔºåÂøÖÈ°ª‰ΩøÁî®Âº∫Âà∂Ëß£ÊûêÔºåÂõ†‰∏∫Âè™ËÉΩÂØπÈùûÁ©∫ÂØπË±°ËøõË°åÊìç‰ΩúÔºö 123print(convertedNumber! - 12) //‚àöprint(convertedNumber - 12) //√óprint(convertedNumber? - 12) //√ó ÂèØÈÄâÁªëÂÆöÂèØÈÄâÁªëÂÆöÂèØ‰ª•Áî®Âú® if Âíå while ËØ≠Âè•‰∏≠Êù•ÂØπÂèØÈÄâÁöÑÂÄºËøõË°åÂà§Êñ≠ÔºåÂπ∂ÊääÂÄºËµãÁªô‰∏Ä‰∏™Â∏∏ÈáèÊàñËÄÖÂèòÈáèÔºåÊù•‰∏™‰æãÂ≠ê: 123456if let actualNumber = Int(possibleNumber) &#123; print("\"\(possibleNumber)\" has an integer value of \(actualNumber)")&#125; else &#123; print("\"\(possibleNumber)\" could not be converted to an integer")&#125;// Prints ""123" has an integer value of 123" Ëøô‰∏™Ë°®Á§∫ÔºåÂ¶ÇÊûú Int(possibleNumber) ËΩ¨Êç¢ÂêéÊúâÂÄºÔºåÈÇ£‰πàËµãÂÄºÁªô actualNumberÔºåËµ∞ÊàêÂäüÁöÑÂàÜÊîØÔºåÂê¶ÂàôËµ∞Â§±Ë¥•ÁöÑÂàÜÊîØ„ÄÇÊ≥®ÊÑèÔºåËøôÈáåÁöÑ actualNumber Â∞±‰∏çÈúÄË¶ÅÂä† ! ‰∫ÜÔºåÂõ†‰∏∫Áî±‰∫éÂèØÈÄâÁªëÂÆöÔºåÂÆÉÂ∑≤Áªè‰∏çÊòØ‰∏Ä‰∏™ÂèØÈÄâÁ±ªÂûã‰∫Ü„ÄÇ ËøôÂÖ∂ÂÆûÂ∞±ÊòØÂà§Êñ≠ÈùûÁ©∫Êìç‰ΩúÁöÑËØ≠Ê≥ïÁ≥ñ Ê≥®ÊÑèÂèØÈÄâÁªëÂÆöÁöÑÊ†ºÂºèÔºö if let constantName = someOptional { statements } ËøôÈáåÁöÑ let ÊàñËÄÖ var ÊòØÂøÖÈ°ªÁöÑÔºåÂπ∂‰∏î‰ΩúÁî®Âüü‰∏∫Êï¥‰∏™ if Âà§Êñ≠Â¶ÇÊûú Int(possibleNumber) Â≠òÂú®ÔºåÂ∞±Â£∞Êòé‰∫Ü actualNumberÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®Â∞±Áõ∏ÂΩì‰∫éÊ≤°ÊúâÂ£∞ÊòéËøô‰∏™ÂèòÈáè„ÄÇ ‰∏ÄÊù° if ÂèØ‰ª•ÂÜôÂ§ö‰∏™ÂèØÈÄâÁªëÂÆöÊàñËÄÖÊù°‰ª∂Âà§Êñ≠ÔºåÁî®ÈÄóÂè∑ÈöîÂºÄÂ∞±Ë°åÔºåË°®Á§∫ &amp; ÁöÑÂÖ≥Á≥ªÔºå‰∏Ä‰∏™ÊòØ false ÂàôÊï¥‰∏™Âà§Êñ≠Êù°‰ª∂ÊòØ false„ÄÇ 12345678910111213if let firstNumber = Int("4"), let secondNumber = Int("42"), firstNumber &lt; secondNumber, secondNumber &lt; 100 &#123; print("\(firstNumber) &lt; \(secondNumber) &lt; 100")&#125;// Prints "4 &lt; 42 &lt; 100" if let firstNumber = Int("4") &#123; if let secondNumber = Int("42") &#123; if firstNumber &lt; secondNumber &amp;&amp; secondNumber &lt; 100 &#123; print("\(firstNumber) &lt; \(secondNumber) &lt; 100") &#125; &#125;&#125;// Prints "4 &lt; 42 &lt; 100" ÂèØ‰ª•ÈÉΩÁî®ÈÄóÂè∑Ôºå‰ΩÜÊòØÊúâÂèØÈÄâÁªëÂÆöÂ∞±‰∏çËÉΩÁî® &amp;&amp; ÂèØÈÄâÁªëÂÆöÁöÑÁîüÂëΩÂë®ÊúüÂú®ÂáΩÊï∞ÂÜÖÔºåÂá∫‰∫ÜÂáΩÊï∞ÔºåËøô‰∏™ÂèòÈáèÂ∞±ÂõûÊî∂‰∫Ü„ÄÇ ÈöêÂºèËß£ÊûêÂèØÈÄâÊêû‰∫ÜËøô‰πà‰∏™ÂèØÈÄâÂêéÔºåÂ¶ÇÊûúÁ°ÆÂÆöÊúâÂÄºÔºåÊØèÊ¨°ÈÉΩË¶ÅÂà§Êñ≠ÂíåËß£ÊûêÂèØÈÄâÂÄºÊòØÈùûÂ∏∏‰ΩéÊïàÁöÑ„ÄÇÂõ†Ê≠§Â∞±ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÈöêÂºèËß£ÊûêÂèØÈÄâÁöÑÊñπÂºè: 123456let possibleString: String? = "An optional string."// ‰∏çËÉΩÁõ¥Êé• let forcedStringÔºöString = possibleString Âõ†‰∏∫Ôºå‰∏Ä‰∏™ÊòØÂèØÈÄâÁ±ªÂûãÔºå‰∏Ä‰∏™ÊòØÈùûÂèØÈÄâÁ±ªÂûãlet forcedString: String = possibleString! // requires an exclamation mark let assumedString: String! = "An implicitly unwrapped optional string."let implicitString: String = assumedString // no need for an exclamation mark ÂΩìÂèØÈÄâË¢´Á¨¨‰∏ÄÊ¨°ËµãÂÄº‰πãÂêéÂ∞±ÂèØ‰ª•Á°ÆÂÆö‰πãÂêé‰∏ÄÁõ¥ÊúâÂÄºÁöÑÊó∂ÂÄôÔºåÈöêÂºèËß£ÊûêÂèØÈÄâÈùûÂ∏∏ÊúâÁî®„ÄÇÈöêÂºèËß£ÊûêÂèØÈÄâ‰∏ªË¶ÅË¢´Áî®Âú® Swift ‰∏≠Á±ªÁöÑÊûÑÈÄ†ËøáÁ®ã‰∏≠(ÂèÇËÄÉÊó†‰∏ªËß£Êûê) ‰∏Ä‰∏™ÈöêÂºèËß£ÊûêÂèØÈÄâÁ±ªÂûãÂÖ∂ÂÆûÂ∞±ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÁöÑÂèØÈÄâÁ±ªÂûãÔºå‰ΩÜÊòØÂèØ‰ª•Ë¢´ÂΩìÂÅöÈùûÂèØÈÄâÁ±ªÂûãÊù•‰ΩøÁî®ÔºåÂπ∂‰∏çÈúÄË¶ÅÊØèÊ¨°ÈÉΩ‰ΩøÁî®Ëß£ÊûêÊù•Ëé∑ÂèñÂèØÈÄâÂÄº„ÄÇ‰Ω†ÂèØ‰ª•ÊääÈöêÂºèËß£ÊûêÂèØÈÄâÂΩìÂÅö‰∏Ä‰∏™ÂèØ‰ª•Ëá™Âä®Ëß£ÊûêÁöÑÂèØÈÄâ„ÄÇ‰Ω†Ë¶ÅÂÅöÁöÑÂè™ÊòØÂ£∞ÊòéÁöÑÊó∂ÂÄôÊääÊÑüÂèπÂè∑ÊîæÂà∞Á±ªÂûãÁöÑÁªìÂ∞æÔºåËÄå‰∏çÊòØÊØèÊ¨°ÂèñÂÄºÁöÑÂèØÈÄâÂêçÂ≠óÁöÑÁªìÂ∞æ„ÄÇÂÖ∂ÂÆûÂ∞±ÊòØÊú¨Ë¥®‰∏äÊòØÂèØÈÄâÔºå‰ΩÜÊòØË°®Èù¢‰∏ä(ÊåáÁöÑÊòØÂÜôÊ≥ï‰∏ä)ÂΩìÂÅöÈùûÂèØÈÄâÁî®„ÄÇ Â¶ÇÊûú‰Ω†Âú®ÈöêÂºèËß£ÊûêÂèØÈÄâÊ≤°ÊúâÂÄºÁöÑÊó∂ÂÄôÂ∞ùËØïÂèñÂÄºÔºå‰ºöËß¶ÂèëËøêË°åÊó∂ÈîôËØØ„ÄÇÂíå‰Ω†Âú®Ê≤°ÊúâÂÄºÁöÑÊôÆÈÄöÂèØÈÄâÂêéÈù¢Âä†‰∏Ä‰∏™ÊÉäÂèπÂè∑‰∏ÄÊ†∑„ÄÇ Â¶ÇÊûú‰∏Ä‰∏™ÂèòÈáè‰πãÂêéÂèØËÉΩÂèòÊàê nil ÁöÑËØùËØ∑‰∏çË¶Å‰ΩøÁî®ÈöêÂºèËß£ÊûêÂèØÈÄâ„ÄÇÂ¶ÇÊûú‰Ω†ÈúÄË¶ÅÂú®ÂèòÈáèÁöÑÁîüÂëΩÂë®Êúü‰∏≠Âà§Êñ≠ÊòØÂê¶ÊòØ nil ÁöÑËØùÔºåËØ∑‰ΩøÁî®ÊôÆÈÄöÂèØÈÄâÁ±ªÂûã„ÄÇ Âü∫Á°ÄËøêÁÆóÁ¨¶ËµãÂÄºËøêÁÆóÂíåÂà´ÁöÑËØ≠Ë®ÄÁöÑËµãÂÄºÊ≤°‰ªÄ‰πàÂå∫Âà´„ÄÇ ÂØπ‰∫éÂÖÉÁªÑÁöÑËµãÂÄºÔºåÂÖÉÁªÑÂÜÖÂÖÉÁ¥†‰ºöË¢´Á´ãÂàªÊãÜÂºÄÊàêÂ§ö‰∏™ÂèòÈáèÔºö 1let (x, y) = (1, 2) // Áé∞Âú® x Á≠â‰∫é 1, y Á≠â‰∫é 2 Ë°•ÂÖÖÔºöËøôÈáåÁöÑ x Âíå y Áõ∏ÂΩì‰∫éË¢´Â£∞ÊòéÊàê‰∏∫ let Á±ªÂûã„ÄÇ Âè¶Â§ñÔºåSwift ÁöÑËµãÂÄºÁ¨¶Âè∑Ëá™Ë∫´‰∏ç‰ºöËøîÂõûÂÄºÔºåÊâÄ‰ª•‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÂú® Swift ‰∏≠ÊòØ‰∏çÂêàÊ≥ïÁöÑÔºö 123if x = y &#123; // This is not valid, because x = y does not return a value.&#125; Êï∞ÂÄºËøêÁÆóÂíåÂà´ÁöÑËØ≠Ë®ÄÁöÑËµãÂÄºÊ≤°‰ªÄ‰πàÂå∫Âà´„ÄÇ Âä†Ê≥ïËøêÁÆóÁ¨¶‰πüÁî®‰∫éÂ≠óÁ¨¶‰∏≤ÁöÑÊãºÊé•„ÄÇÊ≥®ÊÑèÔºå‰∏çÊòØÂ≠óÁ¨¶‰∏≤Ë¶ÅÊâãÂä®ËΩ¨Êç¢ÔºåÂê¶Âàô‰∏çÂêàÊ≥ïÔºö 123let myAge = 18print("my age is "+myAge) // ‚ùéprint("my age is "+String(myAge)) // ‚úÖ Âèñ‰ΩôÊ±Ç‰ΩôËøêÁÆóÔºàa % bÔºâÊòØËÆ°ÁÆó b ÁöÑÂ§öÂ∞ëÂÄçÂàöÂàöÂ•ΩÂèØ‰ª•ÂÆπÂÖ• aÔºåËøîÂõûÂ§öÂá∫Êù•ÁöÑÈÇ£ÈÉ®ÂàÜÔºåËÆ°ÁÆóÂÖ¨Âºè‰∏∫Ôºö a = (b √ó ÂÄçÊï∞) + ‰ΩôÊï∞ 129%4 // 1-9%4 // -1 Swift ‰∏≠ÂèØ‰ª•ÂØπÊµÆÁÇπÊï∞ËøõË°åÂèñ‰ΩôÔºö 18 % 2.5 // Á≠â‰∫é 0.5 Âú®ÂØπË¥üÊï∞ b Ê±Ç‰ΩôÊó∂Ôºåb ÁöÑÁ¨¶Âè∑‰ºöË¢´ÂøΩÁï•„ÄÇËøôÊÑèÂë≥ÁùÄ a % b Âíå a % -bÁöÑÁªìÊûúÊòØÁõ∏ÂêåÁöÑ„ÄÇ Ëá™Â¢ûËá™ÂáèËá™Â¢ûËá™ÂáèÂ∑≤Ë¢´ÁßªÈô§ Áî±‰∫éËá™Â¢ûËá™ÂáèÂú® for Âæ™ÁéØ‰∏≠‰ΩøÁî®ÁöÑÂ§öÔºåÂπ∂‰∏î swift ‰∏≠Áé∞Âú® for Âæ™ÁéØÂ∑≤Áªè‰∏çÊòØ c ÈÇ£Áßç for Âæ™ÁéØ‰∫Ü„ÄÇÊâÄ‰ª•Â∞±Ë¢´Âπ≤Êéâ‰∫Ü ÂèØ‰ª•‰ΩøÁî®Â§çÂêàËµãÂÄºÊõø‰ª£ Â§çÂêàËµãÂÄº12var a = 1a += 2 // a Áé∞Âú®ÊòØ 3 Ê≥®ÊÑèÔºåÂ§çÂêàËµãÂÄºÊòØÊ≤°ÊúâËøîÂõûÂÄºÁöÑ„ÄÇ ÊØîËæÉËøêÁÆóÁ¨¶ÂíåÂà´ÁöÑËØ≠Ë®ÄÁöÑÊØîËæÉÊ≤°Âï•Âå∫Âà´ ÂÖÉÁªÑ‰πüÊòØËÉΩÂ§üÊØîËæÉÁöÑÔºå‰ªéÂ∑¶ÂêëÂè≥ÊØîËæÉÔºåÁõ¥Âà∞ÂèëÁé∞‰∏çÂêå„ÄÇÂ∏ÉÂ∞îÂÄº‰∏çËÉΩË¢´ÊØîËæÉÔºö 123(1, "zebra") &lt; (2, "apple") // true because 1 is less than 2; "zebra" and "apple" are not compared(3, "apple") &lt; (3, "bird") // true because 3 is equal to 3, and "apple" is less than "bird"(4, "dog") == (4, "dog") // true because 4 is equal to 4, and "dog" is equal to "dog" Á©∫ÂêàÂπ∂Êìç‰ΩúÁ¨¶Á©∫ÂêàÂπ∂Êìç‰ΩúÁ¨¶ (a ?? b)ÔºåËß£Êûê‰∏Ä‰∏™ÂèØÈÄâÁöÑ aÔºåÂ¶ÇÊûú‰∏ç‰∏∫Á©∫ÔºåÈÇ£‰πàËøîÂõû a!ÔºåÂ¶ÇÊûú‰∏∫Á©∫ÔºåÈÇ£‰πàËøîÂõûÈªòËÆ§ÂÄº b„ÄÇÁ≠âÊïà‰∫éÂ¶Ç‰∏ãÔºö 1a != nil ? a! : b ‰∏ªË¶ÅÂ∞±ÊòØÁªôÂèØÈÄâÈáèËÆæÁΩÆ‰∏Ä‰∏™ÈªòËÆ§ÂÄºÔºå‰æãÂ≠êÔºö 12345let defaultColorName = "red"var userDefinedColorName: String? // defaults to nil var colorNameToUse = userDefinedColorName ?? defaultColorName// userDefinedColorName is nil, so colorNameToUse is set to the default of "red" ‰∏âÂÖÉÈÄâÊã©Êìç‰ΩúÁ¨¶ÂíåÂÖ∂‰ªñËØ≠Ë®ÄÁöÑ‰∏âÂÖÉÊìç‰ΩúÁ¨¶Ê≤°Êúâ‰ªª‰ΩïÂå∫Âà´ Âå∫Èó¥Êìç‰ΩúÁ¨¶Èó≠Âå∫Èó¥ËøêÁÆóÁ¨¶Èó≠Âå∫Èó¥ËøêÁÆóÁ¨¶ a...bÔºåÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÂåÖÊã¨ a Âíå b ÁöÑÊâÄÊúâÂÄºÁöÑÂå∫Èó¥„ÄÇÂú® for‚Ä¶in Âæ™ÁéØ‰∏≠ÈùûÂ∏∏ÊúâÁî®Ôºö 12345678for index in 1...5 &#123; print("\(index) * 5 = \(index * 5)")&#125;// 1 * 5 = 5// 2 * 5 = 10// 3 * 5 = 15// 4 * 5 = 20// 5 * 5 = 25 ÂçäÈó≠Âå∫Èó¥ÂçäÈó≠Âå∫Èó¥ a..&lt;bÔºåÂÆö‰πâ‰∏Ä‰∏™‰ªé a Âà∞ bÔºå‰ΩÜ‰∏çÂåÖÊã¨ b ÁöÑÂå∫Èó¥„ÄÇ ÂçäÈó≠Âå∫Èó¥ÁöÑÂÆûÁî®ÊÄßÂú®‰∫éÂΩì‰Ω†‰ΩøÁî®‰∏Ä‰∏™ 0 ÂßãÁöÑÂàóË°®(Â¶ÇÊï∞ÁªÑ)Êó∂ÔºåÈùûÂ∏∏Êñπ‰æøÂú∞‰ªé 0 Êï∞Âà∞ÂàóË°®ÁöÑÈïøÂ∫¶Ôºö 123456789let names = ["Anna", "Alex", "Brian", "Jack"]let count = names.countfor i in 0..&lt;count &#123; print("Á¨¨ \(i + 1) ‰∏™‰∫∫Âè´ \(names[i])")&#125;// Á¨¨ 1 ‰∏™‰∫∫Âè´ Anna// Á¨¨ 2 ‰∏™‰∫∫Âè´ Alex// Á¨¨ 3 ‰∏™‰∫∫Âè´ Brian// Á¨¨ 4 ‰∏™‰∫∫Âè´ Jack Ê≥®ÊÑèÁé∞Âú®ÂçäÈó≠Âå∫Èó¥ÂøÖÈ°ªÊòØ ..&lt;Ôºå‰∏çÊòØ‰πãÂâçÁöÑ .. ÈÄªËæëÊìç‰ΩúÁ¨¶Ê≤°‰ªÄ‰πàÂå∫Âà´ Â≠óÁ¨¶‰∏≤‰∏éÂ≠óÁ¨¶ÂàùÂßãÂåñÂ≠óÁ¨¶‰∏≤‰∏§ÁßçÂàùÂßãÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÊñπÂºèÔºö 123var emptyString = "" // empty string literalvar anotherEmptyString = String() // initializer syntax// these two strings are both empty, and are equivalent to each other Âà§Êñ≠ÊòØÂê¶‰∏∫Á©∫ÔºåÁî® isEmpty ÊñπÊ≥ïÔºö 1234if emptyString.isEmpty &#123; print("Nothing to see here")&#125;// Prints "Nothing to see here" Â≠óÁ¨¶‰∏≤ÂèØÂèòÊÄßoc ‰∏≠ÈÄöËøá NSString Âíå NSMutableString Âå∫Âà´ÊòØÂê¶ÂèØ‰ª•‰øÆÊîπÂ≠óÁ¨¶‰∏≤„ÄÇSwift ‰∏≠Âè™ÈÄöËøáÊòØÂ∏∏ÈáèËøòÊòØÂèòÈáèÊù•Âà§Êñ≠Ôºö 1234567var variableString = "Horse"variableString += " and carriage"// variableString is now "Horse and carriage" let constantString = "Highlander"constantString += " and another Highlander"// this reports a compile-time error - a constant string cannot be modified Â≠óÁ¨¶‰∏≤ÊòØÂÄº‰º†ÈÄíSwift ‰∏≠ÔºåÂ¶ÇÊûúÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÈÇ£‰πàÂΩìÂÖ∂ËøõË°åÂ∏∏Èáè„ÄÅÂèòÈáèËµãÂÄºÊìç‰ΩúÊàñÂú®ÂáΩÊï∞/ÊñπÊ≥ï‰∏≠‰º†ÈÄíÊó∂ÔºåÈÉΩ‰ºöÂØπÂ∑≤ÊúâÂ≠óÁ¨¶‰∏≤ÂÄºÂàõÂª∫Êñ∞ÂâØÊú¨ÔºåÂπ∂ÂØπËØ•Êñ∞ÂâØÊú¨ËøõË°å‰º†ÈÄíÊàñËµãÂÄº„ÄÇ let Áõ∏ÂΩì‰∫é oc ‰∏≠ const ÁöÑ NSString var Áõ∏ÂΩì‰∫é oc ‰∏≠ÂèØÂèòÁöÑ NSString oc ‰∏≠ÁöÑ NSMutableString ÊòØÂºïÁî®‰º†ÈÄíÔºåswift ‰∏≠Ê≤°ÊúâÂíåÂÖ∂ÂØπÂ∫îÁöÑ Swift ÈªòËÆ§Â≠óÁ¨¶‰∏≤Êã∑Ë¥ùÁöÑÊñπÂºè‰øùËØÅ‰∫ÜÂú®ÂáΩÊï∞/ÊñπÊ≥ï‰∏≠‰º†ÈÄíÁöÑÊòØÂ≠óÁ¨¶‰∏≤ÁöÑÂÄºÔºåÂÖ∂ÊòéÁ°Æ‰∫ÜÊó†ËÆ∫ËØ•ÂÄºÊù•Ëá™‰∫éÂì™ÈáåÔºåÈÉΩÊòØÊÇ®Áã¨Ëá™Êã•ÊúâÁöÑ„ÄÇÊÇ®ÂèØ‰ª•ÊîæÂøÉÊÇ®‰º†ÈÄíÁöÑÂ≠óÁ¨¶‰∏≤Êú¨Ë∫´‰∏ç‰ºöË¢´Êõ¥Êîπ„ÄÇ ‰ΩøÁî®Â≠óÁ¨¶ÂèØ‰ª•ÈÄöËøá String ÁöÑ characters Â±ûÊÄßËé∑ÂèñÂ≠óÁ¨¶‰∏≤ÁöÑÂ≠óÁ¨¶Ôºö 12345678for character in "Dog!üê∂".characters &#123; print(character)&#125;// D// o// g// !// üê∂ swift ‰∏≠ÁöÑÂ≠óÁ¨¶‰∏≤Ê≤°Êúâ‰∫Ü length Ëøô‰∏™Â±ûÊÄß„ÄÇË¶ÅËé∑ÂèñÈïøÂ∫¶ËøòÂæóÈÄöËøá characters Ëøô‰∏™Êï∞ÁªÑÂ±ûÊÄß„ÄÇÊãøÂà∞Ëøô‰∏™Êï∞ÁªÑÁöÑ count Â∞±ÊòØÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÈïøÂ∫¶„ÄÇ ÂèØ‰ª•Áõ¥Êé•ÂàõÂª∫‰∏Ä‰∏™Â≠óÁ¨¶Ôºö 1let exclamationMark: Character = "!" ‰πüÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™Â≠óÁ¨¶Êï∞ÁªÑÔºåÂÜçËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤Ôºö 1234let catCharacters: [Character] = ["C", "a", "t", "!", "üê±"]let catString = String(catCharacters)print(catString)// Prints "Cat!üê±" ËøûÊé•Â≠óÁ¨¶‰∏≤Ëøô‰∏™ÂÖ∂ÂÆûÂú®ÂâçÈù¢ËØ¥Ëøá‰∫ÜÔºåÂ∞±ÊòØËÉΩÈÄöËøá + ÊàñËÄÖ += Êää‰∏§‰∏™Â≠óÁ¨¶‰∏≤ËøûËµ∑Êù•Ôºö 12345678let string1 = "hello"let string2 = " there"var welcome = string1 + string2// welcome now equals "hello there"var instruction = "look over"instruction += string2// instruction now equals "look over there" ÈúÄË¶ÅÊ≥®ÊÑèÔºå‰∏çËÉΩÁõ¥Êé•ËøûÊé•Â≠óÁ¨¶‰∏≤ÂíåÂ≠óÁ¨¶ÔºåÈúÄË¶ÅÈÄöËøá append ÊñπÊ≥ïÔºö 123let exclamationMark: Character = "!"welcome.append(exclamationMark)// welcome now equals "hello there!" Â≠óÁ¨¶‰∏≤ÊèíÂÖ•Ëøô‰∏™‰πãÂâç‰πüÁî®Ëøá‰∫ÜÔºåÂ∞±ÊòØÂú®Â≠óÁ¨¶‰∏≤‰∏≠Ê∑ªÂä†‰∏Ä‰∏™Âç†‰ΩçÁ¨¶Ôºö 123let multiplier = 3let message = "\(multiplier) times 2.5 is \(Double(multiplier) * 2.5)"// message is "3 times 2.5 is 7.5" Êã¨Âè∑ÂÜÖ‰∏çËÉΩÂåÖÂê´Êú™ËΩ¨‰πâÁöÑ \ÔºåÂõûËΩ¶ÊàñËÄÖÊç¢Ë°å„ÄÇ ÈõÜÂêàÁ±ªÂûãSwift Êèê‰æõ arrayÔºåsetsÔºådictionaries Êù•Â≠òÂÇ®Êï∞ÊçÆ„ÄÇÂú®Âêå‰∏Ä‰∏™ÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ÁöÑÁ±ªÂûãÂøÖÈ°ªÊòØÁõ∏ÂêåÁöÑ„ÄÇ ÂèØÂèòÈõÜÂêàÂíå String Á±ª‰ººÔºåÂ¶ÇÊûú‰Ω†Êää‰∏Ä‰∏™ÈõÜÂêàËµãÁªô‰∏Ä‰∏™ var Á±ªÂûãÁöÑÂèòÈáèÔºåÈÇ£‰πà‰Ω†ÂèØ‰ª•Âä®ÊÄÅÂú∞ÂØπÈõÜÂêàÊìç‰ΩúÔºõÂ¶ÇÊûú‰Ω†Êää‰∏Ä‰∏™ÈõÜÂêàËµãÁªô‰∏Ä‰∏™ let ÁöÑÂ∏∏ÈáèÔºåÈÇ£‰πàËøô‰∏™ÈõÜÂêàÂ∞±ÊòØ‰∏çÂèØÂèòÁöÑÔºàÂåÖÊã¨Êï∞ÁªÑÁöÑÈïøÂ∫¶Ôºå‰ª•ÂèäÊï∞ÁªÑÂÜÖÁöÑÂØπË±°ÁöÑÂú∞ÂùÄÔºå‰ΩÜÊòØÂèØ‰ª•ÊîπÂèòÂØπË±°ÁöÑÂ±ûÊÄßÔºâ„ÄÇ Êï∞ÁªÑÊï∞ÁªÑÁöÑÁÆÄÂÜôËØ≠Ê≥ïSwift Êï∞ÁªÑÁöÑÁ±ªÂûãË¢´ÂÜô‰Ωú Array&lt;Element&gt;ÔºåÂè¶‰∏ÄÁßçÁÆÄÂÜôÊñπÂºèÊòØ [Element]„ÄÇÊõ¥Êé®ËçêÁî®Âêé‰∏ÄÁßçÊñπÂºèÔºö 12var nums1:Array&lt;Int&gt; = [12,34,12]var nums2:[Int] = [12,12,32] ÂàõÂª∫‰∏Ä‰∏™Á©∫Êï∞ÁªÑÂèØ‰ª•Áî®‰ª•‰∏ãÂàùÂßãÂåñÊñπÂºèÊù•ÂàõÂª∫‰∏Ä‰∏™Á°ÆÂÆöÁ±ªÂûãÁöÑÁ©∫Êï∞ÁªÑÔºö 123var someInts = [Int]()print("someInts is of type [Int] with \(someInts.count) items.")// Prints "someInts is of type [Int] with 0 items." Ë¶ÅÊ≥®ÊÑèÂèòÈáè someInts ‰ºöË¢´Êé®Êñ≠‰∏∫ [Int] Á±ªÂûã„ÄÇ ‰∏äÈù¢ÁöÑÊìç‰Ωú‰∏ªË¶ÅËøòÊòØ‰∏∫‰∫ÜÊòéÁ°ÆÊï∞ÁªÑÁöÑÁ±ªÂûã„ÄÇ‰∏Ä‰∏™‰∏çÊòéÁ°ÆÁöÑÁ±ªÂûãÁöÑÊï∞ÁªÑÂ£∞ÊòéÔºåÊØîÂ¶Ç var someInts = []ÊòØ‰∏çÂêàÊ≥ïÁöÑ„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÊï∞ÁªÑÊú¨Ë∫´ÁöÑÁ±ªÂûãÂ∑≤ÁªèÊòéÁ°Æ‰∫ÜÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•Áî® [] ÁΩÆÁ©∫‰∫ÜÔºö 123456var someInts = [Int]()someInts.append(3)// someInts now contains 1 value of type IntsomeInts = []// someInts is now an empty array, but is still of type [Int] ÂàõÂª∫‰∏Ä‰∏™ÊúâÈªòËÆ§ÂÄºÁöÑÊï∞ÁªÑÂèçÊ≠£Â∞±ÊòØËøô‰∏™ËØ≠Ê≥ïÔºåÁî®Â§ÑÂ§ß‰∏çÂ§ßÊàëÂ∞±‰∏çÁü•ÈÅì‰∫Ü 12var threeDoubles = Array(repeating: 0.0, count: 3)// threeDoubles is of type [Double], and equals [0.0, 0.0, 0.0] Ê≤°Âï•Áî® ËøûÊé•‰∏§‰∏™Êï∞ÁªÑÂ¶ÇÊûú‰∏§‰∏™Êï∞ÁªÑÁ±ªÂûãÁõ∏ÂêåÔºåÈÇ£‰πàÂèØ‰ª•Áî® + ËøûÊé•‰∏§‰∏™Êï∞ÁªÑÔºåËøîÂõû‰∏Ä‰∏™Êñ∞Êï∞ÁªÑÔºö 12345var anotherThreeDoubles = Array(repeating: 2.5, count: 3)// anotherThreeDoubles is of type [Double], and equals [2.5, 2.5, 2.5] var sixDoubles = threeDoubles + anotherThreeDoubles// sixDoubles is inferred as [Double], and equals [0.0, 0.0, 0.0, 2.5, 2.5, 2.5] ÂàõÂª∫‰∏Ä‰∏™Êï∞ÁªÑ‰∏ãÈù¢‰æãÂ≠êÊòØÂàõÂª∫‰∏Ä‰∏™‰øùÂ≠òÂ≠óÁ¨¶‰∏≤ÁöÑÊï∞ÁªÑÔºö 12var shoppingList: [String] = ["Eggs", "Milk"]// shoppingList has been initialized with two initial items Áî±‰∫éÁ±ªÂûãÊé®Êñ≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúÅÁï• [String]Ôºö 1var shoppingList = ["Eggs", "Milk"] array Âíå String ‰∏ÄÊ†∑Ôºå‰πüÊòØÂÄºÂºïÁî®„ÄÇ var array1 = array2 Âú®Â†Ü‰∏≠ÂºÄËæü‰∫Ü‰∏§ÂùóÂÜÖÂ≠òÁ©∫Èó¥ÔºåËÄå‰∏çÊòØÊåáÂêëÂêå‰∏Ä‰∏™Âú∞ÂùÄ„ÄÇÂèØ‰ª•ÂàÜÂà´Â§ÑÁêÜ array1 Âíå array2 Â≠òÂèñÂíåÊõ¥ÊîπÊï∞ÁªÑÈÄöËøá count Â±ûÊÄßËé∑ÂæóÊï∞ÁªÑÈïøÂ∫¶Ôºö 12print("The shopping list contains \(shoppingList.count) items.")// Prints "The shopping list contains 2 items." ÈÄöËøá isEmpty Â±ûÊÄßËé∑ÂæóÊï∞ÁªÑÊòØÂê¶‰∏∫Á©∫Ôºö 123456if shoppingList.isEmpty &#123; print("The shopping list is empty.")&#125; else &#123; print("The shopping list is not empty.")&#125;// Prints "The shopping list is not empty." ÈÄöËøá append(_:) ÊñπÊ≥ïÊ∑ªÂä†Êñ∞È°πÔºö 12shoppingList.append("Flour")// shoppingList now contains 3 items, and someone is making pancakes ÈÄöËøá += Ê∑ªÂä†Êñ∞È°πÔºö 1234shoppingList += ["Baking Powder"]// shoppingList now contains 4 itemsshoppingList += ["Chocolate Spread", "Cheese", "Butter"]// shoppingList now contains 7 items ÈÄöËøá‰∏ãÊ†áËé∑ÂèñÊï∞ÁªÑÂÖÉÁ¥†: 12var firstItem = shoppingList[0]// firstItem is equal to "Eggs" ÂêåÊ†∑ÁöÑÊñπÊ≥ïËÆæÁΩÆÊï∞ÁªÑÂÖÉÁ¥†ÔºàÊï∞ÁªÑ‰∏ãÊ†á‰∏çËÉΩË∂äÁïåÔºâÔºö 1234shoppingList[0] = "Six eggs"// the first item in the list is now equal to "Six eggs" rather than "Eggs"shoppingList[4...6] = ["Bananas", "Apples"]// shoppingList now contains 6 items ËøôÈáå 4‚Ä¶6 ÊòØÈó≠Âå∫Èó¥ËøêÁÆóÁ¨¶ÔºåË°®Á§∫‰∏â‰∏™ÂÄº„ÄÇËøôÈáåÂè™Ëµã‰∫Ü‰∏§‰∏™ÂÄº [&quot;Bananas&quot;, &quot;Apples&quot;]ÔºåÊâÄ‰ª•4Ôºå5Ë¢´‰øÆÊîπÔºå6 Ë¢´ remove Êéâ„ÄÇÂ¶ÇÊûúËµãÂõõ‰∏™ÂÄº [&quot;Bananas&quot;, &quot;Apples&quot;,&quot;Pear&quot;,&quot;Cherry&quot;] Âë¢Ôºü4Ôºå5Ôºå6Ë¢´‰øÆÊîπÔºåÊúÄÂêé‰∏Ä‰∏™ÊèíÂÖ•Êï∞ÁªÑ‰∏≠Âèò‰∏∫ 7ÔºåÂéüÊù•Êï∞ÁªÑ‰∏≠ÁöÑ 7 Âèä‰ª•ÂêéÈ°∫Âª∂‰∏∫ 8 Âèä‰ª•Âêé„ÄÇ ÈÄöËøá insert(_:at:) Âú®ÊåáÂÆö‰ΩçÁΩÆÊèíÂÖ•Ôºö 123shoppingList.insert("Maple Syrup", at: 0)// shoppingList now contains 7 items// "Maple Syrup" is now the first item in the list ÈÄöËøá remove(at:) Âà†Èô§ÊåáÂÆö‰ΩçÁΩÆÊï∞ÁªÑÂÜÖÂÆπÔºåÂπ∂ËøîÂõûÂà†Èô§ÁöÑÈÇ£‰∏™ÂÜÖÂÆπÔºàÂ¶ÇÊûú‰Ω†Áî®‰∏çÂà∞ËøîÂõûÂÄºÔºåÂèØ‰ª•ÂøΩÁï•ÔºâÔºö 1234let mapleSyrup = shoppingList.remove(at: 0)// the item that was at index 0 has just been removed// shoppingList now contains 6 items, and no Maple Syrup// the mapleSyrup constant is now equal to the removed "Maple Syrup" string ÈÄöËøá removeLast() Âà†Èô§ÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†Ôºö 1234let apples = shoppingList.removeLast()// the last item in the array has just been removed// shoppingList now contains 5 items, and no apples// the apples constant is now equal to the removed "Apples" string Ëø≠‰ª£Êï∞ÁªÑÈÄöËøá for-in Âæ™ÁéØÂèñÂá∫Êï∞ÁªÑÂÖÉÁ¥†Ôºö 12345678for item in shoppingList &#123; print(item)&#125;// Six eggs// Milk// Flour// Baking Powder// Bananas Â¶ÇÊûúËøòÈúÄË¶ÅÊï∞ÁªÑÂÖÉÁ¥†ÂØπÂ∫îÁöÑ‰∏ãÊ†áÔºåÂèØ‰ª•‰ΩøÁî® enumerated() ÊñπÊ≥ï„ÄÇËØ•ÊñπÊ≥ïÂèØ‰ª•ËøîÂõûÊï∞ÁªÑÂÖÉÁ¥†ÂíåÊï∞ÁªÑÂÖÉÁ¥†‰∏ãÊ†áÊâÄÁªÑÊàêÁöÑÂÖÉÁªÑÔºö 12345678for (index, value) in shoppingList.enumerated() &#123; print("Item \(index + 1): \(value)")&#125;// Item 1: Six eggs// Item 2: Milk// Item 3: Flour// Item 4: Baking Powder// Item 5: Bananas Â≠óÂÖ∏ÂíåÊï∞ÁªÑÁ±ª‰ºº„ÄÇÂ≠óÂÖ∏ÁöÑÈîÆÂíåÂÄºÁöÑÁ±ªÂûãÈÉΩÂ∫îËØ•ÊòØÂàÜÂà´Áõ∏ÂêåÁöÑ„ÄÇÈîÆÂøÖÈ°ª‰∏çÈáçÂ§çÔºå‰∏îÊòØÂèØÂìàÂ∏åÁöÑÔºàSwift ÁöÑÊâÄÊúâÂü∫Êú¨Á±ªÂûãÈÉΩÊòØÂèØÂìàÂ∏åÁöÑÔºâ Â≠óÂÖ∏ÁöÑÁÆÄÂÜôËØ≠Ê≥ïSwift Êï∞ÁªÑÁöÑÁ±ªÂûãË¢´ÂÜô‰Ωú Dictionary&lt;Key,Value&gt;ÔºåÂè¶‰∏ÄÁßçÁÆÄÂÜôÊñπÂºèÊòØ [Key:Value]„ÄÇÊõ¥Êé®ËçêÁî®Âêé‰∏ÄÁßçÊñπÂºèÔºö 12var nums1: Dictionary&lt;Int,String&gt; = [12:"123",34:"1234",13:"131"]var nums2: [Int:String] = [12:"123",34:"1234",13:"131"] Ê≥®ÊÑè‰∏Ä‰∏™ÊòØÈÄóÂè∑Ôºå‰∏Ä‰∏™ÊòØÂÜíÂè∑„ÄÇ ÂàõÂª∫‰∏Ä‰∏™Á©∫Â≠óÂÖ∏ÂèØ‰ª•ÈÄöËøá‰∏ãÈù¢ÊñπÊ≥ïÂàùÂßãÂåñ‰∏Ä‰∏™Á©∫Â≠óÂÖ∏Ôºö 12var namesOfIntegers = [Int: String]()// namesOfIntegers is an empty [Int: String] dictionary ÂàùÂßãÂåñÂêéÔºåÂèòÈáèÁöÑÁ±ªÂûãÂ∞±Á°ÆÂÆö‰∫Ü„ÄÇÂç≥‰ΩøÊ∏ÖÁ©∫Â≠óÂÖ∏ÔºåÂ≠óÂÖ∏Á±ªÂûã‰πü‰∏ç‰ºöÂèò: 1234namesOfIntegers[16] = "sixteen"// namesOfIntegers now contains 1 key-value pairnamesOfIntegers = [:]// namesOfIntegers is once again an empty dictionary of type [Int: String] ÂàõÂª∫‰∏Ä‰∏™Â≠óÂÖ∏ÈÄöËøá‰∏ãÈù¢ÊñπÂºèÂàõÂª∫‰∏Ä‰∏™Â≠óÂÖ∏ÔºåÂêåÊ†∑Áî±‰∫éÁ±ªÂûãÊé®Êñ≠Ôºå‰∏çÂÜôÊòéÁ±ªÂûã‰πüÊòØÂèØ‰ª•ÁöÑÔºö 12var airports: [String: String] = ["YYZ": "Toronto Pearson", "DUB": "Dublin"]var airports = ["YYZ": "Toronto Pearson", "DUB": "Dublin"] Â≠òÂèñÂíåÊõ¥ÊîπÊï∞ÁªÑÂÖ∂‰ªñÊ≤°‰ªÄ‰πàÂå∫Âà´ÔºåÂ§ö‰∫Ü‰∏Ä‰∏™ updateValue(_:forKey:) ÊñπÊ≥ïÔºåÂú®ÂØπÁâπÂÆöÈîÆËÆæÁΩÆÊàñÊõ¥Êñ∞ÂÄºÊó∂Ôºå‰πüÂèØ‰ª•‰ΩøÁî®ËØ•ÊñπÊ≥ïÊù•Êõø‰ª£‰∏ãÊ†á„ÄÇ‰ΩÜ‰∏é‰∏ãÊ†á‰∏çÂêåÁöÑÊòØÔºåËØ•ÊñπÊ≥ïÂú®Êõ¥Êñ∞‰∏Ä‰∏™ÂÄº‰πãÂêéÔºå‰ºöËøîÂõûÂéüÊù•ÁöÑËÄÅÂÄº„ÄÇ ËØ•ÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™ÂèØÈÄâÁ±ªÂûãÁöÑÂÄº„ÄÇÂ¶ÇÊûúÂ≠óÂÖ∏ÈáåÂ≠òÁöÑÊòØ String Á±ªÂûãÔºåÈÇ£‰πàËØ•ÊñπÊ≥ïËøîÂõûÁöÑÂ∞±ÊòØ String?„ÄÇËøô‰∏™ÂèØÈÄâÂÄºÂèØ‰ª•Áî®Êù•Âà§Êñ≠ÔºåËøô‰∏™ÊñπÊ≥ïÁöÑÊìç‰ΩúÊòØÊõ¥Êñ∞ËøòÊòØËÆæÁΩÆ„ÄÇÂ¶ÇÊûúÂéüÊù•Â≠òÂú®Â∞±Èùû nilÔºåÂ¶ÇÊûúÂéüÊù•‰∏çÂ≠òÂú®Â∞±ÊòØ nilÔºö 1234if let oldValue = airports.updateValue("Dublin Airport", forKey: "DUB") &#123; print("The old value for DUB was \(oldValue).")&#125;// Prints "The old value for DUB was Dublin." ÂΩìÁÑ∂ÔºåËøòÂèØ‰ª•Áõ¥Êé•Áî®‰∏ãÊ†áÁöÑÊñπÂºèÊù•Ëé∑ÂèñÂÄºÔºåÁî±‰∫éÂèØËÉΩ‰∏∫Á©∫ÔºåÊâÄ‰ª•ËøîÂõûÁöÑ‰πüÊòØÂèØÈÄâÁ±ªÂûãÔºö 123456if let airportName = airports["DUB"] &#123; print("The name of the airport is \(airportName).")&#125; else &#123; print("That airport is not in the airports dictionary.")&#125;// Prints "The name of the airport is Dublin Airport." ÂèØ‰ª•Áõ¥Êé•Êìç‰Ωú‰∏ãÊ†áÔºåÂ∞ÜÈîÆÂØπÂ∫îÁöÑÂÄºËÆæÁΩÆ‰∏∫ nilÔºåÊù•Âà†Èô§Áõ∏Â∫îÈîÆÂÄºÂØπÔºö 1234airports["APL"] = "Apple International"// "Apple International" is not the real airport for APL, so delete itairports["APL"] = nil// APL has now been removed from the dictionary Âà†Èô§ÁöÑËØùËøòÂèØ‰ª•ÈÄöËøá‰∏ìÈó®ÁöÑÊñπÊ≥ï removeValue(forKey:) ÊñπÊ≥ïÂÆûÁé∞ÔºåËØ•ÊñπÊ≥ïÁßªÈô§ÊåáÂÆöÈîÆÁöÑÂÄºÂêéÔºåËøîÂõûÁßªÈô§‰∫ÜÁöÑÂÄºÔºåÂ¶ÇÊûúÊú¨ÁîüÂ∞±Ê≤°ÊúâÈúÄË¶ÅÁßªÈô§ÁöÑÈîÆÂ∞±ËøîÂõû nilÔºö 123456if let removedValue = airports.removeValue(forKey: "DUB") &#123; print("The removed airport's name is \(removedValue).")&#125; else &#123; print("The airports dictionary does not contain a value for DUB.")&#125;// Prints "The removed airport's name is Dublin Airport." Ëø≠‰ª£Â≠óÂÖ∏ÈÄöËøá for-in Âæ™ÁéØËé∑ÂæóÈîÆÂÄºÂØπ„ÄÇÈîÆÂÄºÂØπÁî®ÂÖÉÁªÑÂ≠òÂÇ®Ôºö 12345for (airportCode, airportName) in airports &#123; print("\(airportCode): \(airportName)")&#125;// YYZ: Toronto Pearson// LHR: London Heathrow ‰πüÂèØ‰ª•ÈÄöËøá keys Âíå values Â±ûÊÄßÔºåÂàÜÂà´ÊãøÂà∞ÂØπÂ∫îÈõÜÂêàÔºö 1234567891011for airportCode in airports.keys &#123; print("Airport code: \(airportCode)")&#125;// Airport code: YYZ// Airport code: LHR for airportName in airports.values &#123; print("Airport name: \(airportName)")&#125;// Airport name: Toronto Pearson// Airport name: London Heathrow Â¶ÇÊûúÊÉ≥Ë¶ÅÂæóÂà∞Ëé∑ÂæóÂ≠óÂÖ∏ÁöÑÈîÆÊàñËÄÖÂÄºÁöÑÊï∞ÁªÑÔºåÂèØ‰ª•ÈÄöËøá keys Âíå values Â±ûÊÄßËøõË°åÂàùÂßãÂåñÔºö 12345let airportCodes = [String](airports.keys)// airportCodes is ["YYZ", "LHR"] let airportNames = [String](airports.values)// airportNames is ["Toronto Pearson", "London Heathrow"] ‰∏äÈù¢ËßÅËøáÂàõÂª∫Á©∫Êï∞ÁªÑÁöÑÊñπÂºèÊòØ [String]()ÔºåÊàë‰ª¨‰πüÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÂºèÂàõÂª∫Â∏¶ÂÄºÁöÑÊï∞ÁªÑÔºåÂç≥Âú®Êã¨Âè∑ÂÜÖÊ∑ªÂä†Êï∞ÁªÑ„ÄÇ Êï∞ÁªÑÂíåÂ≠óÂÖ∏ÁöÑÂèØÈÄâÊï∞ÁªÑÁöÑÁ±ªÂûãÊé®Êñ≠Êï∞ÁªÑÊòØÂèØÈÄâÁöÑÔºåÊï∞ÁªÑÂÜÖÁöÑÂÄº‰πüÊòØÂèØÈÄâÁöÑÔºå‰∏ãÈù¢Âàó‰∏æ‰∏Ä‰∫õ‰æãÂ≠êÔºö 123456let arr1 = [1,2,3] //Êï∞ÁªÑ‰∏çÂèØÈÄâÔºåÂÄº‰∏çÂèØÈÄâlet arr2 = [1,2,nil] //Êï∞ÁªÑ‰∏çÂèØÈÄâÔºåÂÄºÂèØÈÄâlet arr3: [Int] = [1,2,3] //Êï∞ÁªÑ‰∏çÂèØÈÄâÔºåÂÄº‰∏çÂèØÈÄâlet arr4: [Int?] = [1,2,nil] //Êï∞ÁªÑ‰∏çÂèØÈÄâÔºåÂÄºÂèØÈÄâlet arr5: [Int]? = [1,2,3] //Êï∞ÁªÑÂèØÈÄâÔºåÂÄº‰∏çÂèØÈÄâlet arr6: [Int?]? = [1,2,nil] //Êï∞ÁªÑÂèØÈÄâÔºåÂÄºÂèØÈÄâ Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ôºö arr1 Áî±‰∫éËµãÁªôÁöÑÂÄºÈÉΩÈùûÁ©∫ÔºåÊâÄ‰ª•Êï∞ÁªÑÂÄºË¢´Á±ªÂûãÊé®Êñ≠‰∏∫‰∏çÂèØÈÄâ„ÄÇËøôÂíå arr3 Âêå‰∏Ä‰∏™ÊÑèÊÄù„ÄÇ arr2 Áî±‰∫éËµãÁªôÁöÑÂÄºÊúâÁ©∫ÔºåÊâÄ‰ª•Êï∞ÁªÑÂÄºË¢´Êé®Êñ≠‰∏∫ÂèØÈÄâ„ÄÇËøôÂíå arr4 Âêå‰∏Ä‰∏™ÊÑèÊÄù„ÄÇ arr5 ÊâãÂä®ËÆæÁΩÆÊï∞ÁªÑÊú¨ÁîüÊòØÂèØÈÄâÁöÑ. arr6 ÊâãÂä®ËÆæÁΩÆÊï∞ÁªÑÂíåÊï∞ÁªÑÂÄº‰∏∫ÂèØÈÄâÁöÑ ‰∏äÈù¢ÂØπÂ∫îÁöÑË∞ÉÁî®ÊñπÂºèÂ¶Ç‰∏ãÔºö 123456var sum1 = arr1[0] + 2var sum2 = arr2[0]! + 2var sum3 = arr3[0] + 2var sum4 = arr4[0]! + 2var sum5 = arr5![0] + 2var sum6 = arr6![0]! + 2 arr1 ‰∏≠ÁöÑÂÄºÊòØÈùûÂèØÈÄâÁöÑÔºåÊâÄ‰ª•Áõ¥Êé•ÂèñÂá∫ËÆ°ÁÆó arr2 ‰∏≠ÁöÑÂÄºÊòØÂèØÈÄâÁöÑÔºåÊâÄ‰ª•ÂèñÂá∫ÂêéË¶ÅÂº∫Âà∂Ëß£ÊûêÁÑ∂ÂêéÊâçËÉΩËÆ°ÁÆó arr3 Âêå arr1,arr4 Âêå arr2 arr5 Áî±‰∫éÊï∞ÁªÑÊòØÂèØÈÄâÁöÑÔºåÊâÄ‰ª•Ë¶ÅÂú® arr ÂêéÂº∫Âà∂Ëß£Êûê‰∏Ä‰∏ã arr6 Áî±‰∫éÊï∞ÁªÑÂíåÂÄºÈÉΩÊòØÂèØÈÄâÁöÑÔºåÊâÄ‰ª• arr ‰ª•Âèä [0] ÂêéÈÉΩË¶ÅÂº∫Âà∂Ëß£Êûê Â≠óÂÖ∏ÁöÑÁ±ªÂûãÊé®Êñ≠Â≠óÂÖ∏‰πüÊòØÂèØ‰ª•ËøõË°åÁ±ªÂûãÊé®Êñ≠ÁöÑÔºö 123let dic1 = [1:1,2:2,3:3]let dic2: [Int:Int] = [1:1,2:2,3:3]let dic3: [Int:Int]? = [1:1,2:2,3:3] ÂèØ‰ª•ÁúãÂà∞Â≠óÂÖ∏‰∏≠Âè™ÊúâËøô‰∏âÁßçÂÜôÊ≥ï„ÄÇËøôÊòØÂõ†‰∏∫ dic ‰∏≠Â¶ÇÊûúÂÄº‰∏∫ nilÔºåÈÇ£‰πàÂ∞±‰ºöÂ∞ÜÈîÆÂà†Èô§ÔºåÊâÄ‰ª•‰∏çÂ≠òÂú®Â≠óÂÖ∏ÂÄºÁöÑÂèØÈÄâÁöÑÊÉÖÂÜµ„ÄÇËôΩÁÑ∂Â≠óÂÖ∏‰∏çÂ≠òÂú®ÂÄºÁöÑÂèØÈÄâÔºå‰ΩÜÊòØ‰ΩøÁî®ÁöÑÊó∂ÂÄôÂèØËÉΩËé∑Âèñ‰∏çÂà∞ÂØπÂ∫îÁöÑÈîÆÂÄºÂØπÔºåÊâÄ‰ª•‰ΩøÁî®ÁöÑÊó∂ÂÄôÈúÄË¶Å‰ΩøÁî®Âº∫Âà∂Ëß£ÊûêÔºö 12var sum1 = dic1[1]! + 2var sum3 = dic3![1]! + 2 ‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåÂèØËÉΩÂ≠óÂÖ∏‰∏≠‰∏çÂåÖÂê´ÈîÆ‰∏∫ 1 ÁöÑÈîÆÂÄºÂØπÔºåÊâÄ‰ª•ÂèñÂá∫ÂèØËÉΩ‰∏∫Á©∫ÔºåËøôÂ∞±ÈúÄË¶ÅÂº∫Âà∂Ëß£Êûê‰∫Ü„ÄÇËøôÂ∞±Ê∂âÂèäÂà∞‰∫Ü‰∏Ä‰∏™ÂÖ≥‰∫éÂèØÈÄâÁöÑÂéüÂàôÔºöÂ¶ÇÊûúË¶ÅÂØπ‰∏Ä‰∏™ÂèØËÉΩ‰∏∫Á©∫ÁöÑÂÄºÊìç‰ΩúÔºåÂÖàÂ∞ÜÂÖ∂Âº∫Âà∂Ëß£Êûê„ÄÇ Ê≥®ÊÑèÂ≠óÂÖ∏ÈáåËé∑Âèñ‰∏çÂ≠òÂú®ÁöÑÈîÆÔºåÊòØËÉΩËøîÂõû nil ÁöÑÔºåÊâÄ‰ª•ËøîÂõûÂÄºÊòØ‰∏™ÂèØÈÄâÁ±ªÂûãÔºåË¶ÅÂº∫Âà∂Ëß£ÊûêÔºõËÄåÂ¶ÇÊûúË∂äÁïåËÆøÈóÆÊï∞ÁªÑÔºå‰∏çÊòØËøîÂõû nilÔºåÁõ¥Êé•ÊäõÂá∫ÂºÇÂ∏∏„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MBProgressHUD Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2017%2F02%2F21%2FMBProgressHUD%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ËØªÈ°πÁõÆÂ∑•Á®ãÁöÑÊó∂ÂÄôËØªÂà∞‰∫Ü MBProgressHUDÔºåÊâÄ‰ª•‰ªîÁªÜÁ†îÁ©∂‰∫Ü‰∏Ä‰∏ãÂÆÉÁöÑÂéüÁêÜÔºå‰ª•ÂèäÈáåÈù¢‰ΩøÁî®Âà∞ÁöÑÂêÑÁßç api„ÄÇÊàëÊâÄÁúãÁöÑÊ∫êÁ†ÅÊòØ MBProgressHUD 1.0.0 ÊûÑÈÄ†‰∏éÊòæÁ§∫ÊñπÊ≥ïÈ¶ñÂÖàÊòØ MBProgressHUD ÁöÑÊûÑÈÄ†ÊòæÁ§∫ÊñπÊ≥ïÔºö 1234567+ (instancetype)showHUDAddedTo:(UIView *)view animated:(BOOL)animated &#123; MBProgressHUD *hud = [[self alloc] initWithView:view]; hud.removeFromSuperViewOnHide = YES; [view addSubview:hud]; [hud showAnimated:animated]; return hud;&#125; ËØ•ÊñπÊ≥ïÂÖàÂàõÂª∫‰∫Ü‰∏Ä‰∏™ MBProgressHUD ÂÆû‰æãÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞ view ‰∏äÔºåÂπ∂Â∞ÜÂÖ∂ÊòæÁ§∫Âá∫Êù•„ÄÇremoveFromSuperViewOnHide ÊòØ‰∏™Ê†áËÆ∞ÔºåÊöÇÊó∂‰∏çÁî®ÁÆ°ÂÆÉ„ÄÇ ÊûÑÈÄ†ÊñπÊ≥ïËøõÂÖ•‰∏äÈù¢ÁöÑ initWithView: ÊñπÊ≥ïÔºå‰∏ÄÂ±ÇÂ±ÇËøõÂÖ•ÔºåÊúÄÁªàÈÄöËøá commonInit ÂÆûÁé∞Ôºö 123456789101112131415161718192021222324- (void)commonInit &#123; // Set default values for properties _animationType = MBProgressHUDAnimationFade; _mode = MBProgressHUDModeIndeterminate; _margin = 20.0f; _opacity = 1.f; _defaultMotionEffectsEnabled = YES; // Default color, depending on the current iOS version BOOL isLegacy = kCFCoreFoundationVersionNumber &lt; kCFCoreFoundationVersionNumber_iOS_7_0; _contentColor = isLegacy ? [UIColor whiteColor] : [UIColor colorWithWhite:0.f alpha:0.7f]; // Transparent background self.opaque = NO; self.backgroundColor = [UIColor clearColor]; // Make it invisible for now self.alpha = 0.0f; self.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; //--- Áà∂Êéß‰ª∂ÁöÑÈÄèÊòéÂ∫¶ÊòØÂê¶Â∫îÁî®Âà∞Â≠êÊéß‰ª∂ self.layer.allowsGroupOpacity = NO; [self setupViews]; [self updateIndicators]; [self registerForNotifications];&#125; Ëøô‰∏™ÊñπÊ≥ïÊûÑÈÄ†‰∫ÜÊï¥‰∏™ view„ÄÇ‰∏äÈÉ®ËÆæÁΩÆ‰∫ÜÂæàÂ§öÈªòËÆ§È°πÔºåËøòÊòØÁ≠âÂà∞Áî®Âà∞ÁöÑÊó∂ÂÄôÂÜçÁªÜËØ¥„ÄÇÂêéÈù¢ÂèàË∞ÉÁî®‰∫Ü‰∏â‰∏™ÊñπÊ≥ï setupViews,updateIndicators,registerForNotifications„ÄÇ ÂàõÂª∫ viewËøõÂÖ• setupVies ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041- (void)setupViews &#123; UIColor *defaultColor = self.contentColor; //---Ëøô‰∏™ÁöÑËÉåÊôØview MBBackgroundView *backgroundView = [[MBBackgroundView alloc] initWithFrame:self.bounds]; backgroundView.style = MBProgressHUDBackgroundStyleSolidColor; backgroundView.backgroundColor = [UIColor clearColor]; backgroundView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; backgroundView.alpha = 0.f; [self addSubview:backgroundView]; _backgroundView = backgroundView; //---ÂÆπÁ∫≥ÊåáÁ§∫Âô®ÁöÑview MBBackgroundView *bezelView = [MBBackgroundView new]; bezelView.translatesAutoresizingMaskIntoConstraints = NO; bezelView.layer.cornerRadius = 5.f; bezelView.alpha = 0.f; [self addSubview:bezelView]; _bezelView = bezelView; //--- Ëøô‰∏™ÊñπÊ≥ïËÆ©viewËÉΩÂ§üË∑üÈöèÈôÄËû∫‰ª™ËøêÂä®„ÄÇ [self updateBezelMotionEffects]; ...ÂàõÂª∫ÂêÑÁßç labelÔºådetailLabelÔºåbutton for (UIView *view in @[label, detailsLabel, button]) &#123; view.translatesAutoresizingMaskIntoConstraints = NO; [view setContentCompressionResistancePriority:998.f forAxis:UILayoutConstraintAxisHorizontal]; [view setContentCompressionResistancePriority:998.f forAxis:UILayoutConstraintAxisVertical]; [bezelView addSubview:view]; &#125; UIView *topSpacer = [UIView new]; topSpacer.translatesAutoresizingMaskIntoConstraints = NO; topSpacer.hidden = YES; [bezelView addSubview:topSpacer]; _topSpacer = topSpacer; UIView *bottomSpacer = [UIView new]; bottomSpacer.translatesAutoresizingMaskIntoConstraints = NO; bottomSpacer.hidden = YES; [bezelView addSubview:bottomSpacer]; _bottomSpacer = bottomSpacer;&#125; Ëøô‰∏™ÊñπÊ≥ïÈáåÂàõÂª∫‰∫Ü HUD ‰∏≠Ë¶ÅÊòæÁ§∫ÁöÑÂêÑ‰∏™ÈÉ®ÂàÜ„ÄÇÈ¶ñÂÖàÂàõÂª∫‰∫Ü‰∏§‰∏™ MBBackgroundViewÔºå‰∏Ä‰∏™ÊòØÊï¥‰∏™ view ÁöÑËÉåÊôØÔºåÂè¶‰∏Ä‰∏™ÂàôÁî®Êù•ÂÆπÁ∫≥ÊåáÁ§∫Âô®„ÄÇËøõÂÖ•ÂÆÉÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºåÂú® updateForBackgroundStyle ‰∏≠Áî®Âà∞‰∫Ü UIBlurEffect„ÄÇËøôÊòØ iOS ‰∏≠Êèê‰æõÁöÑÁî®Êù•ÂÆûÁé∞È´òÊñØÊ®°Á≥äÁöÑ APIÔºå‰∏çÁÜüÊÇâÁöÑÊúãÂèãÂèØ‰ª•ÂèÇËßÅ UIVisualEffectView ÂÆûÁé∞È´òÊñØÊ®°Á≥ä Êé•‰∏ãÊù•ÊòØ updateBezelMotionEffects ÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïËÉΩÂ§üËÆ© view Ë∑üÈöèÂ±èÂπïÂÄæÊñúËÄå‰ΩçÁßª(ÁúãÊ∫êÁ†ÅÂâçËøòÁúüÊ≤°ÂèëÁé∞ÂèØ‰ª•Âä®)„ÄÇËøô‰∏™ÊñπÊ≥ïÈáåÁî®Âà∞ÁöÑÊòØ UIInterpolatingMotionEffect ÁöÑ APIÔºå‰∏çÁÜüÊÇâÁöÑÊúãÂèãÂèØ‰ª•ÂèÇËßÅ UIInterpolatingMotionEffect ËßÜÂõæËøêÂä® ÂêéÈù¢Â∞±ÊòØÂàõÂª∫ÂêÑ‰∏™ÊèêÁ§∫ÂÜÖÂÆπÁöÑ viewÔºå‰πüÂ∞±ÊòØÂêéÈù¢ÁªèÂ∏∏Áî®Âà∞ÁöÑ NSMutableArray *subviews = [NSMutableArray arrayWithObjects:self.topSpacer, self.label, self.detailsLabel, self.button, self.bottomSpacer, nil];ËøôÈáåÂè™ÊòØÂ∞Ü view Âä†ÂÖ•Âà∞ MBBackgroundView ‰∏≠ÔºåÁ∫¶ÊùüËÆæÁΩÆÂú® updateConstraints ÊñπÊ≥ï‰∏≠ÔºåÂ¶ÇÊûú‰Ω†ÂØπËøô‰∏™ÊñπÊ≥ï‰∏çÂ§™ÁÜüÊÇâÔºåÂèØ‰ª•ÂèÇËßÅÂõæÂÉèÊòæÁ§∫ËøáÁ®ã‰∏é‰∏Ä‰∫õÊ≥®ÊÑè‰∫ãÈ°π„ÄÇ ËÆæÁΩÆÊåáÁ§∫Âô®Áé∞Âú®ÊâßË°åÂà∞ setupViews ÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859- (void)updateIndicators &#123; UIView *indicator = self.indicator; BOOL isActivityIndicator = [indicator isKindOfClass:[UIActivityIndicatorView class]]; BOOL isRoundIndicator = [indicator isKindOfClass:[MBRoundProgressView class]]; MBProgressHUDMode mode = self.mode; if (mode == MBProgressHUDModeIndeterminate) &#123; if (!isActivityIndicator) &#123; //--- Á≥ªÁªüËá™Â∏¶ÁöÑÊóãËΩ¨ÁöÑËèäËä±„ÄÇ // Update to indeterminate indicator [indicator removeFromSuperview]; indicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge]; [(UIActivityIndicatorView *)indicator startAnimating]; [self.bezelView addSubview:indicator]; &#125; &#125; else if (mode == MBProgressHUDModeDeterminateHorizontalBar) &#123; // Update to bar determinate indicator //--- Ëá™ÂÆö‰πâÁöÑ‰∏Ä‰∏™ËøõÂ∫¶Êù° Êù°Áä∂ÁöÑ [indicator removeFromSuperview]; indicator = [[MBBarProgressView alloc] init]; [self.bezelView addSubview:indicator]; &#125; else if (mode == MBProgressHUDModeDeterminate || mode == MBProgressHUDModeAnnularDeterminate) &#123; //--- Ëá™ÂÆö‰πâËøõÂõæÊù° Êù°Áä∂ÁöÑËøòÊòØÁéØÁä∂ÁöÑ if (!isRoundIndicator) &#123; // Update to determinante indicator [indicator removeFromSuperview]; indicator = [[MBRoundProgressView alloc] init]; [self.bezelView addSubview:indicator]; &#125; if (mode == MBProgressHUDModeAnnularDeterminate) &#123; [(MBRoundProgressView *)indicator setAnnular:YES]; &#125; &#125; else if (mode == MBProgressHUDModeCustomView &amp;&amp; self.customView != indicator) &#123; //--- ÈÄöËøáÁî®Êà∑ËÆæÁΩÆÁöÑ customView ËÆæÁΩÆËøõÂ∫¶Êù° // Update custom view indicator [indicator removeFromSuperview]; indicator = self.customView; [self.bezelView addSubview:indicator]; &#125; else if (mode == MBProgressHUDModeText) &#123; [indicator removeFromSuperview]; indicator = nil; &#125; indicator.translatesAutoresizingMaskIntoConstraints = NO; self.indicator = indicator; if ([indicator respondsToSelector:@selector(setProgress:)]) &#123; [(id)indicator setValue:@(self.progress) forKey:@"progress"]; &#125; [indicator setContentCompressionResistancePriority:998.f forAxis:UILayoutConstraintAxisHorizontal]; [indicator setContentCompressionResistancePriority:998.f forAxis:UILayoutConstraintAxisVertical]; [self updateViewsForColor:self.contentColor]; [self setNeedsUpdateConstraints];&#125; Ëøô‰∏™ÊñπÊ≥ïËÆæÁΩÆÊåáÁ§∫Âô®Âà∞Â∫ïÊòØ‰ªÄ‰πàÊ†∑ÁöÑÔºåÈÄöËøáÂâçÈù¢ËÆæÁΩÆÁöÑ mode Êù•Âå∫Âà´„ÄÇÂèØ‰ª•ÊòØÁ≥ªÁªüËá™Â∏¶ÁöÑËèäËä±Âûã UIActivityIndicatorViewÔºå‰πüÂèØ‰ª•ÊòØËá™ÂÆö‰πâÁöÑÊù°Áä∂ÊåáÁ§∫Âô® MBBarProgressViewÔºåËøòÂèØ‰ª•ÊòØËá™ÂÆö‰πâÁöÑÁéØÁä∂ÁöÑ MBRoundProgressViewÔºåÂΩìÁÑ∂Ôºå‰πüÂèØ‰ª•ÊòØÁî®Êà∑Ëá™ÂÆö‰πâÁöÑ view ‰Ωú‰∏∫ËßÜÂõæÊåáÁ§∫Âô®„ÄÇ Â¶ÇÊûúÊòØËá™ÂÆö‰πâÁöÑÊåáÁ§∫Âô®ÔºåÂ§ñÈÉ®ÂèØ‰ª•ÈöèÊó∂ÊîπÂèò customViewÔºåËøô‰ºöËß¶ÂèëÂÜÖÈÉ®ÁöÑ set ÊñπÊ≥ïÔºåÊõ¥Êñ∞Á∫¶ÊùüÔºö 12345678- (void)setCustomView:(UIView *)customView &#123; if (customView != _customView) &#123; _customView = customView; if (self.mode == MBProgressHUDModeCustomView) &#123; [self updateIndicators]; &#125; &#125;&#125; ÂèØ‰ª•Êää customView ËÆæÁΩÆ‰∏∫ UIImageView Êù•ÂÆûÁé∞Âä†ËΩΩÊó∂ÁöÑÂä®ÊÄÅÊïàÊûúÔºåËØ¶ÊÉÖÁúãÁî® UIImageView Êí≠ÊîæÂä®Âõæ Âú® MBBarProgressView Âíå MBRoundProgressView ÁöÑ drawRect: ÊñπÊ≥ï‰∏≠ÂÆûÁé∞‰∫ÜÊåáÁ§∫Âô®ÁöÑÁªòÂà∂„ÄÇ‰ΩøÁî®‰∫Ü UIBezierPath Âíå CoreGraphics ÁöÑ APIÔºåÂ¶ÇÊûú‰∏çÁÜüÔºåÂèØ‰ª•ÂèÇËßÅ ÁªòÂà∂ÂõæÂΩ¢„ÄÇËøõÂ∫¶ÊòæÁ§∫ÊòØ‰ª• _progress ÂèòÈáè‰∏∫ÂáÜÁöÑ„ÄÇ Ê≥®ÂÜåÈÄöÁü•ËøôÈáåÁöÑÊ≥®ÂÜåÈÄöÁü•ÂÖ∂ÂÆûÊå∫Êó†ÂÖ≥Á¥ßË¶ÅÁöÑÔºö 12345678- (void)registerForNotifications &#123;#if !TARGET_OS_TV NSNotificationCenter *nc = [NSNotificationCenter defaultCenter]; [nc addObserver:self selector:@selector(statusBarOrientationDidChange:) name:UIApplicationDidChangeStatusBarOrientationNotification object:nil];#endif&#125; ÂÖ∂ÂÆûÂ∞±ÊòØÊ≥®ÂÜå‰∏Ä‰∏™ÁõëÂê¨Â±èÂπïÊóãËΩ¨ÁöÑÈÄöÁü•„ÄÇËÄå‰∏îÁé∞Âú®Â§ßÈÉ®ÂàÜÊú∫ÂûãÈÉΩÊòØ iOS8 ‰πãÂêéÔºåÂü∫Êú¨‰∏çÁî®ËÆæÁΩÆ‰ªÄ‰πà„ÄÇ ÊòæÁ§∫ÊñπÊ≥ïÁúã‰∏Ä‰∏ãÊòæÁ§∫ÊñπÊ≥ï showAnimated:Ôºö 12345678910111213141516- (void)showAnimated:(BOOL)animated &#123; MBMainThreadAssert(); [self.minShowTimer invalidate]; self.useAnimation = animated; self.finished = NO; // If the grace time is set, postpone the HUD display if (self.graceTime &gt; 0.0) &#123; NSTimer *timer = [NSTimer timerWithTimeInterval:self.graceTime target:self selector:@selector(handleGraceTimer:) userInfo:nil repeats:NO]; [[NSRunLoop currentRunLoop] addTimer:timer forMode:NSRunLoopCommonModes]; self.graceTimer = timer; &#125; // ... otherwise show the HUD immediately else &#123; [self showUsingAnimation:self.useAnimation]; &#125;&#125; ÂèØ‰ª•Áúã‰∏Ä‰∏ã graceTime ÊòØ‰∏Ä‰∏™ÊòæÁ§∫ÁöÑÂª∂ËøüÊó∂Èó¥„ÄÇÂ¶ÇÊûúËÆæÁΩÆ‰∫ÜËøô‰∏™Êó∂Èó¥ÔºåÂ∞±‰ºöÂàõÂª∫‰∏Ä‰∏™ NSTimer ÁöÑÂÆöÊó∂Âô®ÔºåÂú® graceTime ‰πãÂêéÂÜçÊâßË°å showUsingAnimation ÊñπÊ≥ïÔºåÂ∞Ü hud ÊòæÁ§∫Âá∫Êù•„ÄÇfinished Â∞±ÊòØÁî®Êù•ÁõëÊéßÂú®ËøôÊÆµÊó∂Èó¥ËøòÊ≤°ÊúâË¢´ÊòæÁ§∫Âá∫Êù•ÁöÑÊó∂Èó¥ÂÜÖÔºåhud ÊòØÂê¶Â∑≤ÁªèË¢´ËÆæÁΩÆÈöêËóè‰∫ÜÁöÑÊ†áËÆ∞„ÄÇ Êé•‰∏ãÊù•Áúã showUsingAnimation: ÊñπÊ≥ïÔºö 12345678910111213141516171819202122232425- (void)showUsingAnimation:(BOOL)animated &#123; // Cancel any previous animations [self.bezelView.layer removeAllAnimations]; [self.backgroundView.layer removeAllAnimations]; // Cancel any scheduled hideDelayed: calls [self.hideDelayTimer invalidate]; //--- ËÆ∞ÂΩïÊòæÁ§∫ÁöÑÊó∂Èó¥ self.showStarted = [NSDate date]; self.alpha = 1.f; // Needed in case we hide and re-show with the same NSProgress object attached. //--- ËÆæÁΩÆ‰ª•CADisplayLink‰∏∫Âü∫ÂáÜÁöÑÂà∑Êñ∞ÔºåÊ≥®ÊÑèËøôÈáåÂπ∂‰∏çÊòØÊâÄÊúâÁöÑËøõÂ∫¶Êù°ÈÉΩÊòØ‰ª•CADÊù•Âà∑Êñ∞ÁöÑÔºåÂè™ÊúâËÆæÁΩÆ‰∫Ü progressObject ÁöÑÊâç‰ºö‰ΩøÁî® [self setNSProgressDisplayLinkEnabled:YES]; if (animated) &#123; [self animateIn:YES withType:self.animationType completion:NULL]; &#125; else &#123;#pragma clang diagnostic push#pragma clang diagnostic ignored "-Wdeprecated-declarations" self.bezelView.alpha = self.opacity;#pragma clang diagnostic pop self.backgroundView.alpha = 1.f; &#125;&#125; ËøôÈáå showStarted Áî®Êù•ËÆ∞ÂΩï‰∏Ä‰∏™ÊòæÁ§∫ÂºÄÂßãÁöÑÊó∂Èó¥ÔºåËøô‰∏™Â∞Ü‰ºöÂú®ÂêéÈù¢Áî®Âà∞ÔºåÂ∞ÜÈÄöËøáËøô‰∏™Êó∂Èó¥Êù•ËÆæÁΩÆ hud ÁöÑÊúÄÁü≠ÊòæÁ§∫Êó∂Èó¥„ÄÇ‰∏ãÈù¢‰∏§‰∏™ÊñπÊ≥ï setNSProgressDisplayLinkEnabled: Âíå animateIn:withType:completion: ÊñπÊ≥ïÔºå‰∏Ä‰∏™Áî®Êù•ËÆæÁΩÆ progressObject ËøõÂ∫¶ÔºàÊ≥®ÊÑèÔºå‰∏çÊòØÊâÄÊúâËøõÂ∫¶ÂèòÂåñÈÉΩ‰ºöÁî®Âà∞Ëøô‰∏™ÊñπÊ≥ïÔºâÔºå‰∏Ä‰∏™Áî®Êù•Ëá™ÂÆö‰πâÂ±ïÁ§∫Âä®Áîª„ÄÇ Êàë‰ª¨Êù•ÁúãÁúãËÆæÁΩÆ progressObject ËøõÂ∫¶ÁöÑÊñπÊ≥ïÔºö 1234567891011121314151617- (void)setNSProgressDisplayLinkEnabled:(BOOL)enabled &#123; // We're using CADisplayLink, because NSProgress can change very quickly and observing it may starve the main thread, // so we're refreshing the progress only every frame draw if (enabled &amp;&amp; self.progressObject) &#123; // Only create if not already active. if (!self.progressObjectDisplayLink) &#123; //--- ËøôÈáåË¶ÅÊ≥®ÊÑèÔºåÈáçÂÜô‰∫Ü progressObjectDisplayLink ÁöÑ set ÊñπÊ≥ï self.progressObjectDisplayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(updateProgressFromProgressObject)]; &#125; &#125; else &#123; self.progressObjectDisplayLink = nil; &#125;&#125;- (void)updateProgressFromProgressObject &#123; self.progress = self.progressObject.fractionCompleted;&#125; ‰πãÊâÄ‰ª•ËØ¥ÊòØËÆæÁΩÆ progressObject ÁöÑËøõÂ∫¶ÔºåÊòØÂõ†‰∏∫ÊòæÁ§∫ÁöÑËøõÂ∫¶ÊòØ‰ª• _progress ‰∏∫ÂáÜÁöÑ„ÄÇÂ¶ÇÊûú‰Ω†‰ªîÁªÜÁúã‰∏äÈù¢ÁöÑ drawRect: ÊñπÊ≥ïÔºåÂ∞±ËÉΩÂèëÁé∞ÊâÄÊúâÁöÑÂõæÂΩ¢ÈÉΩÊòØ‰ª• _progress ÊòæÁ§∫ÁöÑ„ÄÇÈÇ£‰πàËøôÈáåÁöÑ progressObject Êúâ‰ªÄ‰πàÁî®Âë¢Ôºü Â¶ÇÊûú‰ΩøÁî®‰∫Ü progressObjectÔºåÈÇ£‰πàÂ∞±‰ºöÂàõÂª∫‰∏Ä‰∏™ CADisplayLink ÂÆû‰æã„ÄÇCADisplayLink ÈÄÇÂêà‰∫éÈ´òÁ≤æÂ∫¶ÁöÑÂÆöÊó∂Âà∑Êñ∞ÔºåÂÖ∑‰Ωì‰ΩøÁî®ÊñπÊ≥ïÂèØËßÅÔºöCADisplayLink ÊñπÂºèÁöÑÂÆöÊó∂Âô® progressObject ÊòØ‰∏Ä‰∏™ NSProgress ÂØπË±°ÔºåÂ¶ÇÊûúÂØπÂÖ∂‰∏ç‰∫ÜËß£ÂèØ‰ª•ÂèÇËßÅiOSËøõÂ∫¶ÊåáÁ§∫Âô®‚Äî‚ÄîNSProgressÔºåÂÆÉÂ∞ÜËøõÂ∫¶ËÆæÁΩÆÁªô _progress„ÄÇÊàë‰ª¨ÂèØ‰ª•Áúã‰∏Ä‰∏ã _progress ÁöÑ set ÊñπÊ≥ïÔºö 123456789- (void)setProgress:(float)progress &#123; if (progress != _progress) &#123; _progress = progress; UIView *indicator = self.indicator; if ([indicator respondsToSelector:@selector(setProgress:)]) &#123; [(id)indicator setValue:@(self.progress) forKey:@"progress"]; &#125; &#125;&#125; ËøôÊ†∑Â∞±‰ºöËß¶ÂèëÊåáÁ§∫Âô®ÁöÑ progress ÁöÑ set ÊñπÊ≥ïÔºö 123456- (void)setProgress:(float)progress &#123; if (progress != _progress) &#123; _progress = progress; [self setNeedsDisplay]; &#125;&#125; Âè™Ë¶Å progress ÂèòÂåñ‰∫ÜÔºåÂ∞±‰ºöËÆæÁΩÆÈáçÁªòËßÜÂõæ„ÄÇ Ëá≥‰∫éÂä®ÁîªÁöÑÊâßË°åÊñπÊ≥ïÔºåÊ≤°‰ªÄ‰πàÁâπÂà´ÁöÑÂú∞ÊñπÔºå‰∏çÂ§™‰∫ÜËß£ÁöÑËØùÂèØ‰ª•ÂèÇËÄÉ Ê†∏ÂøÉÂä®Áîª ÈöêËóèÊñπÊ≥ïÊù•Áúã‰∏Ä‰∏ãÈöêËóèÊñπÊ≥ïÔºö 123456789+ (BOOL)hideHUDForView:(UIView *)view animated:(BOOL)animated &#123; MBProgressHUD *hud = [self HUDForView:view]; if (hud != nil) &#123; hud.removeFromSuperViewOnHide = YES; [hud hideAnimated:animated]; return YES; &#125; return NO;&#125; ÂÖàÊâæÂà∞ MBProgressHUD Á±ªÔºåÁÑ∂ÂêéË∞ÉÂä® hideAnimated: ÊñπÊ≥ïÔºö 12345678910111213141516171819- (void)hideAnimated:(BOOL)animated &#123; MBMainThreadAssert(); [self.graceTimer invalidate]; self.useAnimation = animated; self.finished = YES; // If the minShow time is set, calculate how long the HUD was shown, // and postpone the hiding operation if necessary if (self.minShowTime &gt; 0.0 &amp;&amp; self.showStarted) &#123; NSTimeInterval interv = [[NSDate date] timeIntervalSinceDate:self.showStarted]; if (interv &lt; self.minShowTime) &#123; NSTimer *timer = [NSTimer timerWithTimeInterval:(self.minShowTime - interv) target:self selector:@selector(handleMinShowTimer:) userInfo:nil repeats:NO]; [[NSRunLoop currentRunLoop] addTimer:timer forMode:NSRunLoopCommonModes]; self.minShowTimer = timer; return; &#125; &#125; // ... otherwise hide the HUD immediately [self hideUsingAnimation:self.useAnimation];&#125; Ëøô‰∏™ÊñπÊ≥ïÁöÑËß£ÊûÑÂíå‰∏äÈù¢ÁöÑ show Á±ª‰ººÔºåÂÖ∂‰∏≠ minShowTime Ë°®Á§∫ÊúÄÂ∞ëÊòæÁ§∫ÁöÑÊó∂Èó¥ÔºåÈÅøÂÖçÂä†ËΩΩÂ§™Âø´Ôºåhud ‰∏ÄÈó™ËÄåËøáÁöÑÊÉÖÂÜµÂá∫Áé∞„ÄÇËøôÈáåÂ∞±Áî®Âà∞‰∫Ü‰∏äÈù¢ËØ¥ËøáÁöÑ showStarted ‰∫Ü„ÄÇÂæÄ‰∏ãËµ∞ÔºåÊù•ÁúãÁúã hideUsingAnimation: ÊñπÊ≥ïÔºö 12345678910111213- (void)hideUsingAnimation:(BOOL)animated &#123; if (animated &amp;&amp; self.showStarted) &#123; self.showStarted = nil; [self animateIn:NO withType:self.animationType completion:^(BOOL finished) &#123; [self done]; &#125;]; &#125; else &#123; self.showStarted = nil; self.bezelView.alpha = 0.f; self.backgroundView.alpha = 1.f; [self done]; &#125;&#125; ÂÖ∂ÂÆû‰πüÂíå show ÁöÑÊó∂ÂÄôÂ∑Æ‰∏çÂ§öÔºåÊúâÂä®ÁîªÊòæÁ§∫ÈöêËóèÂä®ÁîªÔºåÊ≤°ÊúâÂä®ÁîªÁõ¥Êé•Â∞±ÈöêËóèÊéâ„ÄÇÂè™‰∏çËøáËøôÈáåË¶ÅÂÅö‰∏Ä‰∫õÊâ´Â∞æÊìç‰ΩúÔºöÊâßË°å done ÊñπÊ≥ïÔºö 1234567891011121314151617181920- (void)done &#123; // Cancel any scheduled hideDelayed: calls [self.hideDelayTimer invalidate]; [self setNSProgressDisplayLinkEnabled:NO]; if (self.hasFinished) &#123; self.alpha = 0.0f; if (self.removeFromSuperViewOnHide) &#123; [self removeFromSuperview]; &#125; &#125; MBProgressHUDCompletionBlock completionBlock = self.completionBlock; if (completionBlock) &#123; completionBlock(); &#125; id&lt;MBProgressHUDDelegate&gt; delegate = self.delegate; if ([delegate respondsToSelector:@selector(hudWasHidden:)]) &#123; [delegate performSelector:@selector(hudWasHidden:) withObject:self]; &#125;&#125; ËøôÈáåÂ∞±ÊòØÊâßË°å‰∏Ä‰∏ãÂ§ñÈÉ®‰º†ËøõÊù•ÁöÑ completionBlock ÂõûË∞É„ÄÇÂ¶ÇÊûúÂ§ñÈÉ®ËÆæÁΩÆ‰∫Ü‰ª£ÁêÜÊñπÊ≥ïÔºåÂπ∂‰∏îÈáçÂÜô‰∫Ü hudWasHidden ÈÇ£‰πàÂ∞±Ë∞ÉÁî®ÊâßË°å„ÄÇ ÊÄªÁªìMBProgressHUD Á°ÆÂÆûÊòØ‰∏Ä‰∏™ÊØîËæÉÁÆÄÂçïÁöÑÊ°ÜÊû∂„ÄÇÁúãÁöÑÊó∂ÂÄôÊàëËøòÊòØËõÆ‰ªîÁªÜÁöÑÊ≥®ÊÑèÊØè‰∏Ä‰∏™Áü•ËØÜÁÇπÁöÑÔºåËØ∏Â¶Ç view ÁöÑÁªòÂà∂ÊòæÁ§∫ËøáÁ®ã„ÄÅË¥ùÂ°ûÂ∞îÊõ≤Á∫øÁöÑÁªòÂà∂„ÄÅUIInterpolatingMotionEffect ÁöÑ‰ΩøÁî® Á≠âÁ≠âÁ≠âÁ≠â„ÄÇÊâÄ‰ª•ËøòÊòØËä±‰∫Ü‰∏çÂ∞ëÊó∂Èó¥ÂéªÊêûÊáÇÁöÑ„ÄÇÂÜôÂà∞ËøôÈáåÂÜçÊÉ≥ÊÉ≥ÔºåÊï¥‰∏™Ê°ÜÊû∂ÁöÑÁªìÊûÑËøòÊòØÈùûÂ∏∏Ê∏ÖÊô∞ÊòìÊáÇÁöÑ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËÆ∏Â§ö iOS API ÁöÑ‰ΩøÁî®ÊñπÂºè(ÊåÅÁª≠Êõ¥Êñ∞)]]></title>
    <url>%2F2017%2F02%2F13%2FiOS%E4%B8%ADAPI%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[ÂæàÂ§ö‰∏çÂ∏∏Áî®ÁöÑÁÆÄÂçïÁöÑ API ÁöÑ‰ΩøÁî®ÊñπÂºè„ÄÇÂàÜÂºÄÂÜôÁöÑËØùÂ§™Áü≠Â∞èÔºåÂ∞±ÂêàÂú®‰∏ÄËµ∑Âêß„ÄÇÔºàËøôÈáåÈÉΩÊòØÂ≠¶Âà∞ÁöÑÊó∂ÂÄôÔºå‰∏úÊâæ‰∏ÄÁÇπË•øÊâæ‰∏ÄÁÇπÊãºÂáëËµ∑Êù•ÁöÑÔºå‰∏ÄÂºÄÂßãÊ≤°ÊúâËÆ∞ÂΩïÂá∫Â§ÑÂú®Âì™ÔºåÂ¶ÇÊûúÂì™ÈáåÊúâ‰æµÊùÉÁöÑÂú∞ÊñπÔºåËøòËØ∑Â∞ΩÂø´ÂëäÁü•ÂëÄ„ÄÇÊàë‰ºöÁ¨¨‰∏ÄÊó∂Èó¥Ê≥®ÊòéÂá∫Â§ÑÁöÑ„ÄÇË∞¢Ë∞¢Âï¶~Ôºâ NSUndoManagerNSUndoManger ÊòØËãπÊûúÂØπ‰∫éÂëΩ‰ª§Ê®°ÂºèÁöÑ‰∏ÄÁßçÂ∞ÅË£ÖÔºåÁî®Êù•Êí§ÈîÄÂéÜÂè≤ÂëΩ‰ª§„ÄÇÂÖ±Êúâ‰∏§ÁßçÊí§ÈîÄÊìç‰ΩúÔºåÁÆÄÂçïÁöÑ‰ª• selector ‰∏∫Âü∫Á°ÄÁöÑÊí§ÈîÄÂíåÂ§çÊùÇÁöÑ‰ª• NSInvocation ‰∏∫Âü∫Á°ÄÁöÑÊí§ÈîÄ„ÄÇ Êí§ÈîÄÊìç‰ΩúÊ≥®ÂÜå‰∏Ä‰∏™ÁÆÄÂçïÊí§ÈîÄÊìç‰ΩúÊàë‰ª¨ÂèØ‰ª•Áî® registerUndoWithTarget:selector:object: Ê≥®ÂÜå‰∏Ä‰∏™Êí§ÈîÄÊìç‰ΩúÔºå‰øùÂ≠òÊí§ÈîÄÊó∂‰ºöÊâßË°åÁöÑÊñπÊ≥ïÂíåÂèÇÊï∞Ôºö 12345- (void)updateScore:(NSNumber*)score &#123; [undoManager registerUndoWithTarget:self selector:@selector(updateScore:) object:myMovie.score]; [undoManager setActionName:NSLocalizedString(@"actions.update", @"Update Score")]; myMovie.score = score;&#125; ‰∏äÈù¢Â∞ÜÊîπÂèòÂâçÁöÑ myMoview.score ÈÄöËøáÊí§ÈîÄÊñπÊ≥ï‰øùÂ≠ò‰∫ÜËµ∑Êù•„ÄÇÂè¶Â§ñ setActionName: ÊåáÂÆöÊí§ÈîÄÊìç‰ΩúÁöÑÂêçËØç„ÄÇ ‰ΩøÁî® NSInvocation Ê≥®ÂÜåÂ§çÊùÇÊí§ÈîÄÊìç‰ΩúÁÆÄÂçïÊí§ÈîÄ‰∏çËÉΩÂ∫îÂØπÂ§öÂèÇÊï∞ÁöÑÊÉÖÂÜµÔºåÊâÄ‰ª•Ë¶Å‰ΩøÁî® NSInvocation ÔºåË∞ÉÁî® prepareWithInvocationTarget: ËÆ∞ÂΩïÂì™‰∫õÂØπË±°‰ºöÊé•Êî∂Âì™‰∫õÂèëÁîüÊîπÂèòÁöÑÊ∂àÊÅØÔºö 12345678- (void)movePiece:(ChessPiece*)piece toRow:(NSUInteger)row column:(NSUInteger)column &#123; [[undoManager prepareWithInvocationTarget:self] movePiece:piece ToRow:piece.row column:piece.column]; [undoManager setActionName:NSLocalizedString(@"actions.move-piece", @"Move Piece")]; piece.row = row; piece.column = column; [self updateChessboard];&#125; NSUndoManager ÂØπË±°Êú¨Ë∫´Âπ∂Ê≤°Êúâ‰∏äÈù¢ÁöÑ movePiece:ToRow:column: ÊñπÊ≥ï„ÄÇÊòØÈÄöËøá forwardInvocation: Â∞ÜÊ∂àÊÅØËΩ¨ÂèëËá≥Áõ∏Â∫îÂØπË±°ÁöÑ„ÄÇ Â∞ÜÂä®‰ΩúÁªÑÂêàÂú®‰∏ÄËµ∑‰∏äÈù¢Âè™ËÉΩÊí§Ê∂à‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂ¶ÇÊûúË¶ÅÊí§ÈîÄÂ§ö‰∏™Êìç‰ΩúÂë¢Ôºü 12345678910111213141516171819- (void)readAndArchiveEmail:(Email*)email &#123; [undoManager beginUndoGrouping]; [self markEmail:email asRead:YES]; [self archiveEmail:email]; [undoManager setActionName:NSLocalizedString(@"actions.read-archive", @"Mark as Read and Archive")]; [undoManager endUndoGrouping];&#125;- (void)markEmail:(Email*)email asRead:(BOOL)isRead &#123; [[undoManager prepareWithInvocationTarget:self] markEmail:email asRead:[email isRead]]; [undoManager setActionName:NSLocalizedString(@"actions.read", @"Mark as Read")]; email.read = isRead;&#125;- (void)archiveEmail:(Email*)email &#123; [[undoManager prepareWithInvocationTarget:self] moveEmail:email toFolder:@"Inbox"]; [undoManager setActionName:NSLocalizedString(@"actions.archive", @"Archive")]; [self moveEmail:email toFolder:@"All Mail"];&#125; ÈÄöËøá beginUndoGrouping Âíå endUndoGrouping Â∞ÜÂ§ö‰∏™ÂàÜÁ¶ªÁöÑÊí§ÈîÄÊìç‰ΩúÁªÑÂêàÂú®‰∏ÄËµ∑„ÄÇ ÂÆûÁé∞‰∏ÄÊ¨°Êí§ÈîÄiOS ÊëáÊôÉÊâãÂäøÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÁî®Êà∑ÈÄöËøáÊëáÊôÉËÆæÂ§áÊù•Ëß¶ÂèëÊí§ÈîÄÊìç‰Ωú„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™ view controller ÈúÄË¶ÅÂ§ÑÁêÜ‰∏Ä‰∏™Êí§ÈîÄËØ∑Ê±ÇÔºåÈÇ£‰πàËøô‰∏™ view controller ÂøÖÈ°ªÔºö ËÉΩÊàê‰∏∫ first responder ‰∏ÄÊó¶È°µÈù¢ÊòæÁ§∫(view appears)ÔºåÂç≥ÂèòÊàê first responder ‰∏ÄÊó¶È°µÈù¢Ê∂àÂ§±(view disappears)ÔºåÂç≥ÊîæÂºÉ first responder ÂΩì view controller Êé•Êî∂Âà∞ËøêÂä®‰∫ã‰ª∂ÔºåÂΩìÊí§ÈîÄÊàñÈáçÂÅöÂèØÁî®Êó∂ÔºåÁ≥ªÁªü‰ºöÂ±ïÁ§∫ÁªôÁî®Êà∑‰∏Ä‰∏™‰ºöËØùÁïåÈù¢„ÄÇView controller ÁöÑ undoManager Â±ûÊÄß‰∏çÈúÄË¶ÅÂÖ∂‰ªñÊìç‰ΩúÂ∞±ÂèØ‰ª•ÂìçÂ∫îÁî®Êà∑ÁöÑÈÄâÊã©„ÄÇ 1234567891011121314151617@implementation ViewController- (void)viewDidAppear:(BOOL)animated &#123; [super viewDidAppear:animated]; [self becomeFirstResponder];&#125;- (void)viewWillDisappear:(BOOL)animated &#123; [super viewWillDisappear:animated]; [self resignFirstResponder];&#125;- (BOOL)canBecomeFirstResponder &#123; return YES;&#125;@end ÊâßË°åÊí§ÈîÄÊâßË°åÊí§ÈîÄÊìç‰ΩúÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªü‰ºöÂ∞ÜÊí§ÈîÄÊ†à‰∏≠ÁöÑÂØπË±° pop Âá∫Êù•ÔºåÁÑ∂ÂêéÊâßË°å„ÄÇÈÄöËøá undo ÊñπÊ≥ïËß¶ÂèëÔºö 123if ([self.undoManager canUndo]) &#123; [self.undoManager undo];&#125; Ê∏ÖÁ©∫Êí§ÈîÄÊ†àÊúâÊó∂ÂÄôÊàë‰ª¨ÈúÄË¶ÅÊâãÂä®Ê∏ÖÁ©∫Êí§ÈîÄÊ†à„ÄÇÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÂΩì‰∏ä‰∏ãÊñáÂèëÁîüÊàèÂâßÊÄßÂèòÂåñÊó∂ÔºåÊØîÂ¶ÇËØ¥ iOS ‰∏äÊîπÂèò‰∫ÜÊòæÁ§∫ÁöÑ view controller Êàñ‰∏Ä‰∏™ÊâìÂºÄÁöÑÊñáÊ°£Â§ñÈÉ®ÂèëÁîü‰∫ÜÂèòÂåñ„ÄÇÊ≠§Êó∂ÔºåÊí§ÈîÄÁÆ°ÁêÜÂô®ÁöÑÊ†àÂèØ‰ª•ÈÄöËøá removeAllActions Êù•Ê∏ÖÁ©∫Êàñ‰ΩøÁî® removeAllActionsWithTarget: Ê∏ÖÁ©∫Êüê‰∏Ä‰∏™ÂØπË±°ÁöÑÊâÄÊúâÊí§ÈîÄÊñπÊ≥ï„ÄÇ Êí§ÈîÄ‰∏éÊÅ¢Â§çÂ¶ÇÊûúÊúâ‰∏ÄÂØπÁõ∏ÂèçÁöÑÊñπÊ≥ïÈúÄË¶ÅË°®Á§∫Êó¢ËÉΩÊí§ÈîÄ‰πüËÉΩÊÅ¢Â§çÔºåÈúÄË¶ÅËøôÊ†∑‰ΩøÁî®Ôºö 123456789101112131415- (void)addItem:(id)item &#123; [undoManager registerUndoWithTarget:self selector:@selector(removeItem:) object:item]; if (![undoManager isUndoing]) &#123; [undoManager setActionName:NSLocalizedString(@"actions.add-item", @"Add Item")]; &#125; [myArray addObject:item];&#125;- (void)removeItem:(id)item &#123; [undoManager registerUndoWithTarget:self selector:@selector(addItem:) object:item]; if (![undoManager isUndoing]) &#123; [undoManager setActionName:NSLocalizedString(@"actions.remove-item", @"Remove Item")]; &#125; [myArray removeObject:item];&#125; Âú®ÊÅ¢Â§ç‰∏≠Ê≥®ÂÜåÊí§ÈîÄÔºåÂú®Êí§ÈîÄ‰∏≠Ê≥®ÂÜåÊÅ¢Â§ç„ÄÇËøôÈáåÂÖàÂà§Êñ≠ isUndoing ÂÖ∂ÂÆûÊ≤°ÊúâÂ§™Â§ßÂøÖË¶ÅÔºåÂéªÊéâ‰πüÊ≤°‰ªÄ‰πàÈóÆÈ¢ò„ÄÇ NSInvocationÂΩìÊàë‰ª¨ÊÉ≥Ë¶ÅÂä®ÊÄÅË∞ÉÁî®Êüê‰∏Ä‰∏™ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨‰∏ÄËà¨‰ºöÈÄâÊã© performSelector:withObject:withObject ÊñπÊ≥ï„ÄÇ‰ΩÜÊòØËøô‰∏™ÊñπÊ≥ïÊúâ‰∏Ä‰∏™Â±ÄÈôêÂ∞±ÊòØÊúÄÂ§öÂè™ËÉΩË∞ÉÁî®Âê´Êúâ‰∏§‰∏™ÂèÇÊï∞ÁöÑÂáΩÊï∞: 12NSString *sample = [self performSelector:@selector(append:withStr:) withObject:@"a" withObject:@"b"];==&gt; ab ËãπÊûúÊèê‰æõ‰∫ÜÂè¶Â§ñ‰∏ÄÁßçÊñπÊ≥ïÔºöNSInvocation„ÄÇ‰∏ãÈù¢‰ªãÁªç‰∏Ä‰∏ã‰ΩøÁî®Ê≠•È™§Ôºö Êèê‰æõÊñπÊ≥ïÁ≠æÂêçÈ¶ñÂÖàË¶ÅËé∑ÂæóË∞ÉÁî®ÊñπÊ≥ïÁöÑÊñπÊ≥ïÁ≠æÂêçÔºö 1234//NSObjectÁöÑÂØπË±°ÊñπÊ≥ïÔºå‰ªª‰ΩïÁªßÊâøËá™NSObjectÁöÑÂØπË±°ÈÉΩÂèØ‰ª•Ë∞ÉÁî®- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector//NSObjectÁöÑÁ±ªÊñπÊ≥ïÔºå‰ªª‰ΩïÁªßÊâøËá™NSObjectÁöÑÁ±ªÈÉΩÂèØ‰ª•Ë∞ÉÁî®+ (NSMethodSignature *)instanceMethodSignatureForSelector:(SEL)aSelector 12345NSString *methodNameStr = @"test:withArg2:andArg3:"SEL selector = NSSelectorFromString(methodNameStr);NSMethodSignature *signature = [self methodSignatureForSelector:selector];//Êàñ‰ΩøÁî®‰∏ãÈù¢ËøôÁßçÊñπÂºèNSMethodSignature *signature = [[self class] instanceMethodSignatureForSelector:selector]; ‰ΩøÁî®ÊñπÊ≥ïÁ≠æÂêçÂàõÂª∫‰∏Ä‰∏™ NSInvocation ÂØπË±°12NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:signature];//Âè™ËÉΩ‰ΩøÁî®ËØ•ÊñπÊ≥ïÊù•ÂàõÂª∫Ôºå‰∏çËÉΩ‰ΩøÁî®alloc init ËÆæÁΩÆË∞ÉÁî®ÂØπË±°ÂíåË∞ÉÁî®ÊñπÊ≥ïinvocation ÂØπË±°Êúâ‰∏§‰∏™Â±ûÊÄßÔºåÊâßË°åÂØπË±° targetÔºåÊâßË°åÁöÑÊñπÊ≥ï selectorÔºö 12invocation.target = self;invocation.selector = selector; ËÆæÁΩÆÂèÇÊï∞‰ΩøÁî® setArgument:atIndex: ÊñπÊ≥ïËÆæÁΩÆÂèÇÊï∞„ÄÇÂèÇÊï∞‰ªé2ÂºÄÂßãÔºåÂõ†‰∏∫0„ÄÅ1Ë¢´ target Âíå selectorÂç†Áî®‰∫Ü: 123456NSString *arg1 = @"a";NSString *arg2 = @"b";NSString *arg3 = @"c";[invocation setArgument:&amp;arg1 atIndex:2];[invocation setArgument:&amp;arg2 atIndex:3];[invocation setArgument:&amp;arg3 atIndex:4]; Ê≥®ÊÑèÔºåËøôÈáåÊòØ‰ΩøÁî®ÁöÑÊòØÂèÇÊï∞ÁöÑÂºïÁî®Ôºå‰º†ÈÄíÁöÑÊòØÂú∞ÂùÄ„ÄÇ ÊâßË°åÊñπÊ≥ïÁõ¥Êé•ÊâßË°åÊñπÊ≥ïÔºö 1[invocation invoke]; Â¶ÇÊûúÊñπÊ≥ïÊúâËøîÂõûÂÄºÂë¢ÔºüÂú®‰∏äÈù¢ÁöÑËØ≠Âè•ÊâßË°åÊñπÊ≥ïÂêéÔºåÊàë‰ª¨ÈÄöËøá getReturnValue: ÊñπÊ≥ïÊãøÂà∞ËøîÂõûÂÄºÔºö 123456//ÂèØ‰ª•Âú®invokeÊñπÊ≥ïÂâçÊ∑ªÂä†Ôºå‰πüÂèØ‰ª•Âú®invokeÊñπÊ≥ïÂêéÊ∑ªÂä†//ÈÄöËøáÊñπÊ≥ïÁ≠æÂêçÁöÑmethodReturnLengthÂà§Êñ≠ÊòØÂê¶ÊúâËøîÂõûÂÄºif (signature.methodReturnLength &gt; 0) &#123; id *result = nil; [invocation getReturnValue:&amp;result];&#125; ÊñπÊ≥ïÁ≠æÂêçÊúâ‰∏§‰∏™Âè™ËØªÂ±ûÊÄßÔºå‰∏Ä‰∏™ÊòØ numberOfArguments Ë°®Á§∫ÊñπÊ≥ïÂèÇÊï∞ÁöÑ‰∏™Êï∞ÔºõËøòÊúâ‰∏™Â∞±ÊòØ‰∏äÈù¢‰ª£Á†ÅÊ∂âÂèäÁöÑ methodReturnLength Ë°®Á§∫ÊñπÊ≥ïËøîÂõûÂÄºÁ±ªÂûãÁöÑÈïøÂ∫¶ÔºåÂ§ß‰∫é0Ë°®Á§∫ÊúâËøîÂõûÂÄº„ÄÇ NSJSONSerializationJSON(‰πüÂ∞±ÊòØÁâπÂÆöÁ±ªÂûãÁöÑ NSString) Âíå NSDictionary„ÄÅNSArray ‰πãÈó¥ÁöÑËΩ¨Êç¢ÂèØ‰ª•ÈÄöËøá NSJSONSerialization Á±ªËøõË°å JSON(NSString) =&gt; NSDictionary/NSArrayÂÖàÂ∞Ü JSON ÈÄöËøá dataUSingEncoding: ËΩ¨Êç¢‰∏∫ NSDataÔºåÁÑ∂ÂêéÂÜçÁî®ÈÄöËøá NSJSONSerialization Â∞Ü NSData ËΩ¨Êç¢‰∏∫ NSDictionary/NSArray. 12345678910#import "NSString+JSONCategories.h"@implementation NSString(JSONCategories)-(id)JSONValue &#123; NSData *data = [self dataUsingEncoding:NSUTF8StringEncoding]; NSError *error = nil; id result = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&amp;error]; if (error != nil) return nil; return result;&#125;@end ‰ΩøÁî®Ôºö 1234567// Êï∞ÁªÑNSString *str = @"[&#123; \"id\": \"hu\"&#125;,&#123;\"blog\": \"damon\"&#125;]";NSArray *array = (NSArray*)[str JSONValue];// Â≠óÂÖ∏NSString *str = @"&#123; \"id\": \"hu\",\"blog\": \"damon\"&#125;";NSDictionary *array = (NSDictionary *)[str JSONValue]; Êï∞ÁªÑÁöÑ JSON ÊòØÁî® [] ÂåÖË£πËµ∑Êù•ÁöÑ„ÄÇËøô‰∏™‰æãÂ≠ê‰∏≠ÊØè‰∏™ÂÖÉÁ¥†ÈÉΩÊòØÂçïÂÖÉÁ¥†ÁöÑ NSDictionary„ÄÇÂ≠óÂÖ∏ÁöÑ JSON Â∞±ÊòØ {} Êã¨Ëµ∑Êù•ÁöÑÈîÆÂÄºÂØπ„ÄÇÊ≥®ÊÑèÁî±‰∫éËøîÂõûÊó∂ÊòØ id Á±ªÂûãÔºå‰∏çÂå∫ÂàÜÂÖ∑‰ΩìÊòØ NSDictionary ËøòÊòØ NSArrayÔºåÊâÄ‰ª•Ë¶ÅËøõË°åÁ±ªÂûãËΩ¨Êç¢ NSDictionary/NSArray =&gt; JSON(NSString)Âú® NSObject ‰∏≠Ê∑ªÂä†ÂàÜÁ±ªÔºåÂÖàÂ∞Ü NSDictionary/NSArray ËΩ¨Êç¢‰∏∫ NSData„ÄÇÊ≥®ÊÑè‰∏äÈù¢‰ΩøÁî®ÁöÑÊñπÊ≥ïÊòØ JSONObjectWithData:options:error: ËøôÈáåÊòØ dataWithJSONObject:options:error:„ÄÇÁÑ∂ÂêéÈÄöËøá initWithData:encoding: Â∞Ü NSData ËΩ¨‰∏∫ NSString: 12345678910#import "NSObject+JSONCategories.h"@implementation NSObject (JSONCategories)-(NSString *)JSONString &#123; NSError *error = nil; NSData *result = [NSJSONSerialization dataWithJSONObject:self options:kNilOptions error:&amp;error]; if (error != nil) return nil; return [[NSString alloc] initWithData:result encoding:NSUTF8StringEncoding];&#125;@end NSString ‰∏é NSArray ÁöÑ‰∫íËΩ¨‰∏äÈù¢ÁöÑ JSON ÊòØ‰∏ÄÁßçÁâπÊÆäÊ†ºÂºèÁöÑ NSStringÔºåÊâÄ‰ª•Ë¶ÅÂÄüÂä©‰∫é NSJSONSerialization ËøõË°åËß£Êûê„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÁõ¥Êé•ÁöÑ NSString Âíå NSArray ÁöÑ‰∫íÁõ∏ËΩ¨Êç¢Â∞±Ë¶ÅÁÆÄÂçïËÆ∏Â§öÔºå‰ΩÜÊòØËøòÊúâÊ≥®ÊÑèÁÇπ. ‰∏ÄËà¨Êàë‰ª¨Êää NSArray ËΩ¨‰∏∫ NSString ÊòØÁõ¥Êé•ÈÄöËøá stringWithFormat: ÁöÑÂΩ¢ÂºèÔºö 12345NSArray *array = [NSArray arrayWithObjects:@"sss",@"mmm",@"lll",@"kkk",@"ppp",@"ooo", nil];NSString *str1 = [NSString stringWithFormat:@"%@",array];//ËæìÂá∫ str1str1 = @"(\n sss,\n mmm,\n lll,\n kkk,\n ppp,\n ooo\n)" ÂèØ‰ª•ÁúãÂá∫ÔºåËøôÊ†∑ÁöÑËΩ¨Êç¢ÊòØÊúâÈóÆÈ¢òÁöÑÔºå‰∏≠Èó¥ÂºïÂÖ•‰∫ÜÁ©∫Ê†ºÔºåÂπ∂‰∏î‰∏§ËæπËøòÊúâÊã¨Âè∑Ê≤°ÊúâÊ∂àÈô§„ÄÇüëáÊòØÊ≠£Á°ÆÁöÑÊñπÂºèÔºö 12345NSArray *array = [NSArray arrayWithObjects:@"sss",@"mmm",@"lll",@"kkk",@"ppp",@"ooo", nil];NSString *str2 = [array componentsJoinedByString:@","];// ËæìÂá∫ str2 str2 = @"sss,mmm,lll,kkk,ppp,ooo" ÈÄöËøá NSArray ÁöÑÊñπÊ≥ïÔºåÂ∞ÜÊï∞ÁªÑ‰∏≠ÁöÑÂÖÉÁ¥†ÂÆåÂÖ®Êãø‰∫ÜÂá∫Êù•„ÄÇ Âè¶‰∏ÄÊñπÈù¢Ôºå NSString ËΩ¨‰∏∫ NSArray„ÄÇÈÄöËøá NSString ÁöÑ componentsSeparatedByString: ÊñπÊ≥ïÔºåËØÜÂà´ÈÄóÂè∑: 12NSArray *array2 = [str1 componentsSeparatedByString:@","];NSArray *array3 = [str2 componentsSeparatedByString:@","]; ÊØîËæÉËæìÂá∫ÁªìÊûúÂèØ‰ª•ÂèëÁé∞Ôºåstr1 Êó†Ê≥ïÈáçÊñ∞ËΩ¨ÂõûÊúÄÂºÄÂßãÁöÑÊï∞ÁªÑ‰∫ÜÔºåÊâÄ‰ª•‰∏§ËÄÖ‰∫íËΩ¨‰∏ÄÂÆöË¶ÅÁî® str2 ÁöÑÊñπÂºèÔºö UIView ‰∏≠ÁöÑÂùêÊ†áËΩ¨Êç¢‰∏Ä‰∏™ View ÁöÑ frame ÁöÑËµ∑ÁÇπÊòØÁõ∏ÂΩì‰∫éÂÖ∂ÊâÄÂú®ÁöÑ ViewÔºåÂç≥Ë∞ÉÁî® addSubView: ÊñπÊ≥ïÁöÑ View„ÄÇÂ¶ÇÊûúË¶ÅÂà§Êñ≠‰∏§‰∏™ View ÊòØÂê¶ÊòØÂåÖÂê´ÂÖ≥Á≥ªÔºåÁî±‰∫é‰∏§ËÄÖÁöÑËµ∑ÁÇπ‰∏çÂêåÔºåÈÇ£‰πàËÇØÂÆöÊòØÊó†Ê≥ïËøõË°åÊØîËæÉÁöÑ„ÄÇ 123456// rect1Âíårect2ÊòØÂê¶ÊúâÈáçÂè†CGRectContainsRect(&lt;#CGRect rect1#&gt;, &lt;#CGRect rect2#&gt;)// pointÊòØ‰∏çÊòØÂú®rect‰∏äCGRectContainsPoint(&lt;#CGRect rect#&gt;, &lt;#CGPoint point#&gt;)// rect1ÊòØÂê¶ÂåÖÂê´‰∫Ürect2CGRectIntersectsRect(&lt;#CGRect rect1#&gt;, &lt;#CGRect rect2#&gt;) ‰∏∫‰∫ÜÁªü‰∏ÄÂéüÁÇπÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ã‰ª£Á†ÅÔºö 12345- (CGPoint)convertPoint:(CGPoint)point toView:(nullable UIView *)view;- (CGPoint)convertPoint:(CGPoint)point fromView:(nullable UIView *)view;- (CGRect)convertRect:(CGRect)rect toView:(nullable UIView *)view;- (CGRect)convertRect:(CGRect)rect fromView:(nullable UIView *)view; Êù•‰∏æ‰∏§‰∏™‰æãÂ≠êÔºåÊ≥®ÊÑè‰∏çÂêåÊÉÖÂÜµ‰∏ã compareView Âíå outerView ÁöÑÂèÇÊï∞‰ΩçÁΩÆÔºö 12CGRect newRect = [self.compareView convertRect:self.innerFrame fromView:self.outerView];CGRect newRect = [self.outerView convertRect:self.innerFrame toView:self.compareView]; ÂæóÂà∞ÁöÑÂ∞±ÊòØ innerFrame Âú® compareView ‰∏≠ÁöÑ‰ΩçÁΩÆ„ÄÇ UIVisualEffectView ÂÆûÁé∞È´òÊñØÊ®°Á≥äÂ¶ÇÊûúÊÉ≥Ë¶ÅÁªô‰∏Ä‰∏™ view Ê∑ªÂä†‰∏Ä‰∏™È´òÊñØÊ®°Á≥äÁöÑÊïàÊûúÔºåÂè™Ë¶ÅÂú®ÈÇ£‰∏™ view ‰∏äÊ∑ªÂä†‰∏Ä‰∏™ UIVisualEffectView Âç≥ÂèØ„ÄÇ È´òÊñØÊ®°Á≥äÊúâ‰∏âÁßçÊïàÊûúÔºå‰ªéÊµÖÂÖ•Ê∑±ÁöÑ style ‰æùÊ¨°ÊòØÔºö UIBlurEffectStyleExtraLight UIBlurEffectStyleLight UIBlurEffectStyleDark ‰ΩøÁî®ÁöÑÂü∫Êú¨ÂÆû‰æãÔºö 123456789101112131415// Ë¶ÅÊ∑ªÂä†Ê®°Á≥äÁöÑviewUIImageView *imageview = [[UIImageView alloc] init];imageview.frame = CGRectMake(10, 100, 300, 300);imageview.image = [UIImage imageNamed:@"2"];imageview.contentMode = UIViewContentModeScaleAspectFit;imageview.userInteractionEnabled = YES;[self.view addSubview:imageview];// È´òÊñØÊ®°Á≥äÁöÑviewUIBlurEffect *blur = [UIBlurEffect effectWithStyle:UIBlurEffectStyleLight];UIVisualEffectView *effectview = [[UIVisualEffectView alloc] initWithEffect:blur];effectview.frame = CGRectMake(0, 0, imageview.size.width/2, 300);// Ê∑ªÂä†È´òÊñØÊ®°Á≥ä[imageview addSubview:effectview]; UIInterpolatingMotionEffect ËßÜÂõæËøêÂä®UIInterpolatingMotionEffect ÂèØ‰ª•ÈÄöËøáÈôÄËû∫‰ª™ÁõëÊµãÊâãÊú∫ÁöÑÂÄæÊñúÊÉÖÂÜµ„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂÆÉËÆæÁΩÆËßÜÂõæÂìçÂ∫îÁöÑËøêÂä®„ÄÇ ÂÖ∂‰∏≠Êúâ‰∏§‰∏™Â±ûÊÄßÔºöminimumRelativeValue Âíå maximumRelativeValue„ÄÇËøô‰∏§‰∏™Â±ûÊÄßÊéßÂà∂ÂõæÂÉèËøêÂä®ÁöÑÊúÄÂ§ßËåÉÂõ¥„ÄÇ ÂÆû‰æãÔºö 1234567891011121314151617CGFloat effectOffset = 100.f;// ËÆæÁΩÆxÊñπÂêë‰∏äÁöÑÁßªÂä®ÈáèUIInterpolatingMotionEffect *effectX = [[UIInterpolatingMotionEffect alloc] initWithKeyPath:@"center.x" type:UIInterpolatingMotionEffectTypeTiltAlongHorizontalAxis];effectX.maximumRelativeValue = @(effectOffset);effectX.minimumRelativeValue = @(-effectOffset);// ËÆæÁΩÆyÊñπÂêë‰∏äÁöÑÁßªÂä®ÈáèUIInterpolatingMotionEffect *effectY = [[UIInterpolatingMotionEffect alloc] initWithKeyPath:@"center.y" type:UIInterpolatingMotionEffectTypeTiltAlongVerticalAxis];effectY.maximumRelativeValue = @(effectOffset);effectY.minimumRelativeValue = @(-effectOffset);// Â∞ÜÁßªÂä®ÈáèÊ∑ªÂä†Âà∞Êï∞ÁªÑ‰∏≠UIMotionEffectGroup *group = [[UIMotionEffectGroup alloc] init];group.motionEffects = @[effectX, effectY];// ËÆæÁΩÆÁªô view[self.view addMotionEffect:group]; UISearchController ÂÆûÁé∞ÊêúÁ¥¢iOS8 ‰πãÂêéÔºåËãπÊûúÊèê‰æõ‰∫Ü UISearchController Áªü‰∏Ä‰∫ÜÊêúÁ¥¢ÊñπÂºè„ÄÇ È¶ñÂÖàÔºåÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™Áî®Êù•ÊòæÁ§∫ÊêúÁ¥¢ÁªìÊûúÁöÑËßÜÂõæ SearchResultsControllerÔºåÂÆÉÈúÄË¶ÅÂÆûÁé∞ UISearchResultsUpdating ÂçèËÆÆÔºåÂú® UISearchController ‰∏≠ÁöÑÊêúÁ¥¢ÂÖ≥ÈîÆÂ≠óÂèòÂåñÁöÑÊó∂ÂÄôÔºå‰ºöÂõûË∞É UISearchResultsUpdating ‰∏≠ÁöÑ updateSearchResultsForSearchController: ÊñπÊ≥ïÊâßË°åÊï∞ÊçÆÁöÑÁ≠õÈÄâÊêúÁ¥¢„ÄÇÊâÄ‰ª•ÔºåSearchResultController ‰∏≠ËøòÈúÄË¶Å‰∏§‰∏™Â±ûÊÄßÔºåÂæÖÊêúÁ¥¢ÁöÑÊâÄÊúâÊï∞ÊçÆÈõÜÂêàÂíåÊêúÁ¥¢Âá∫ÁöÑÊï∞ÊçÆÈõÜÂêàÔºö 12345678910111213class SearchResultsController: UITableViewController,UISearchResultsUpdating &#123; //ÊêúÁ¥¢Âá∫ÂíåÂæÖÊêúÁ¥¢ÁöÑÊï∞ÊçÆ var names:[String,[String]] = [String:[String]]() var keys: [String] = [] var filteredNames: [String] = [] func updateSearchResultsForSearchController(searchController: UISearchController) &#123; //ÊêúÁ¥¢ËøáÁ®ã ... //Á≠õÈÄâÂá∫Êï∞ÊçÆÂêéÂà∑Êñ∞ÂàóË°® tableView.reloadData() &#125;&#125; Áé∞Âú®Ë¶ÅÂÆö‰πâ‰∏Ä‰∏™Ë∑≥ËΩ¨ÂâçÁöÑÈ°µÈù¢„ÄÇÂú®Êüê‰∏™ ViewController ‰∏≠‰øùÂ≠ò‰∏Ä‰∏™ UISearchController ÁöÑÂÆû‰æã„ÄÇÂú®ÂàùÂßãÂåñ ViewController ÁöÑÂêåÊó∂ÔºåÂàùÂßãÂåñ UISearchController Âπ∂ÊãøÂà∞ UISearchController ‰∏≠ÁöÑ searchBar ÁöÑÂÆû‰æãÔºåÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞ ViewController ÁöÑËßÜÂõæ‰∏≠ÂéªÔºà‰∏∫‰∫ÜÁÇπÂáªÂêéË∑≥ËΩ¨Êó∂ÔºåsearchBar ÁöÑÂä®ÁîªÊïàÊûúÔºâ„ÄÇÂàùÂßãÂåñ UISearchController ÁöÑÊó∂ÂÄôÔºåÂ∞ÜÊêúÁ¥¢ÁªìÊûúÂ±ïÁ§∫È°µ resultsController ‰º†ÂÖ•ÔºåÂπ∂Â∞ÜÂÖ∂ËµãÁªô searchResultsUpdater Â±ûÊÄß(ÈÄöËøáËøô‰∏™Â±ûÊÄßË∞ÉÁî®ÁöÑ updateSearchResultsForSearchController: ÊñπÊ≥ï): 123456789101112131415161718class ViewController: UIViewController &#123; var searchController: UISearchController! ... override func viewDidLoad() &#123; super.viewDidLoad() ... let resultsController = SearchResultsController() resultsController.names = names resultsController.keys = keys searchController = UISearchController(searchResultsController: resultsController) let searchBar = searchController.searchBar searchBar.scopeButtonTitles = ["All","Short"] searchBar.placeholder = "Enter a search item" searchBar.sizeToFit() tableView.tableHeaderView = searchBar searchController.searchResultsUpdater = resultsController &#125;&#125; ÂÖ∂‰∏≠ scopeButtonTitles ÊòØÂèØÈÄâÁöÑÔºåÂú® searchBar ‰∏ãÊòæÁ§∫Áî®Êù•Ëøõ‰∏ÄÊ≠•Á≠õÈÄâÁöÑÔºåÂèØ‰ª•ÈÄöËøá searchController.searchBar.selectedScopeButtonIndex Êù•Ëé∑ÂèñÁ≠õÈÄâ‰ø°ÊÅØ„ÄÇÂè¶Â§ñÔºåsearchController.searchBar Ë¶ÅÁ°ÆÂÆöÈÄöËøá sizeToFit() ÊñπÊ≥ïÁ°ÆÂÆö‰∫ÜÂ§ßÂ∞èÂêéÔºåÂä†ÂÖ•Âà∞ ViewController ‰∏≠„ÄÇ ÂΩìÁÑ∂ÔºåËøôÊòØÊúÄÂü∫Êú¨ÁöÑ‰∏Ä‰∏™ÊµÅÁ®ãÔºåËøòÊúâ‰∏Ä‰∫õËá™ÂÆö‰πâÁöÑÊìç‰Ωú‰ª•Âèä‰∏Ä‰∫õ‰ª£ÁêÜÊñπÊ≥ï]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>ÊåÅÁª≠Êõ¥Êñ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰∏Ä‰∫õ iOS Â∞èÊäÄÂ∑ß‰∏éÊ≥®ÊÑèÁÇπ(ÊåÅÁª≠Êõ¥Êñ∞)]]></title>
    <url>%2F2017%2F02%2F09%2FiOS%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[ËøôÁØá‰∏≠Â∞ÜÊî∂ÈõÜ‰∏Ä‰∫õÂÖ≥‰∫é iOS ÂºÄÂèë‰∏≠ÁöÑ‰∏Ä‰∫õÂ∞èÊäÄÂ∑ß‰ª•ÂèäÊ≥®ÊÑè‰∫ãÈ°πÔºåÂèØËÉΩÊØîËæÉÈõ∂Êï£„ÄÇ ÈöêËóèXcode ÂØπ‰∫é performSelector ÊñπÊ≥ïÁöÑ‚ö†Ô∏è‰ΩøÁî® performSelector ÊñπÊ≥ïÔºåXcode ‰ºöÊèêÁ§∫‰ºöÂèØËÉΩ‰∫ßÁîüÂÜÖÂ≠òÊ≥ÑÊºèÔºåÂèØ‰ª•Ê∑ªÂä†Ëøô‰∏§Âè•ÂÆèÂú®ÊñπÊ≥ï‰∏äÔºåÂ∞±‰∏ç‰ºöÊúâ‚ö†Ô∏è‰∫ÜÔºö 12#pragma clang diagnostic push#pragma clang diagnostic ignored "-Warc-performSelector-leaks" ÂêéÂè∞‰ªªÂä°appËøõÂÖ•ÂêéÂè∞Ôºå‰ºöÂÅúÊ≠¢ÊâÄÊúâÁ∫øÁ®ãÔºõÈúÄË¶ÅÂú® applicationDidEnterBackground ‰∏≠Ë∞ÉÁî® beginBackgroundTaskWithExpirationHandler Áî≥ËØ∑Êõ¥Â§öÁöÑappÊâßË°åÊó∂Èó¥Ôºå‰ª•‰æøÁªìÊùüÊüê‰∫õ‰ªªÂä°: 123456789101112- (void)applicationDidEnterBackground:(UIApplication *)application &#123; _backtaskIdentifier = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^(void)&#123; ... ‰ªª‰ΩïÂêéÂè∞‰ªªÂä°Ë¶ÅÂÅöÁöÑ‰∫ã // ÂèñÊ∂àÂêéÂè∞‰ªªÂä°ÔºåÂú®id‰∏çÊòØUIBackgroundTaskInvalidÁöÑÊÉÖÂÜµ‰∏ãÔºåÈÄöËøá endbackgroundTask ÂÅúÊ≠¢‰ªªÂä°ÔºåÂπ∂Â∞ÜidËÆæÁΩÆÂõûinvalid if (_backtaskIdentifier!=UIBackgroundTaskInvalid) &#123; [[UIApplication sharedApplication] endBackgroundTask:_backtaskIdentifier]; _backtaskIdentifier = UIBackgroundTaskInvalid; &#125; &#125;]; &#125; ÂÖ∂‰∏≠ _backtaskIdentifier ÊòØ UIBackgroundTaskIdentifier Á±ªÂûã ÊµèËßàÂô®ÁºìÂ≠òÁ≠ñÁï•‰ªéÊµèËßàÂô®ÁöÑÁºìÂ≠ò‰∏≠ÂèØ‰ª•Â≠¶Âà∞‰∏Ä‰∫õÊúâÂÖ≥ÂÆ¢Êà∑Á´ØÁºìÂ≠òÊñπÊ°àÁöÑÂÆûÁé∞ÊñπÂºè Cache-ControlCache-Control Êèê‰æõ‰∏Ä‰∏™ max-age Â≠óÊÆµÔºåÁî®‰∫éÊèèËø∞ËøáÊúüÊó∂Èó¥„ÄÇÊµèËßàÂô®ÊòØÂê¶ÂÜçÊ¨°ËØ∑Ê±ÇÊï∞ÊçÆÂÜ≥ÂÆö‰∫é: 1ÊµèËßàÂô®ÂΩìÂâçÊó∂Èó¥ &gt; ÊµèËßàÂô®‰∏äÊ¨°ËØ∑Ê±ÇÊó∂Èó¥ + max-age Last-Modified/If-Modified-SinceÊµèËßàÂô®ÊØèÊ¨°ËØ∑Ê±ÇÂêéÔºåÊúçÂä°Âô®‰ºöËøîÂõû‰∏Ä‰∏™ËµÑÊ∫êÂú®ÊúçÂä°Á´Ø‰∏äÊ¨°Êõ¥Êñ∞ÁöÑÊó∂Èó¥„ÄÇ‰∏ãÊ¨°ËØ∑Ê±ÇÁöÑÊó∂ÂÄô‰ºöÂ∏¶‰∏äËøô‰∏™Êó∂Èó¥„ÄÇÂ¶ÇÊûúÊúçÂä°Á´ØÂèëÁé∞Ëøô‰∏™Êó∂Èó¥‰πãÂêéÊ≤°ÊúâÊõ¥Êñ∞ËøáËµÑÊ∫êÂ∞±‰ºöËøîÂõû 304ÔºåËÆ©ÊµèËßàÂô®Áî®Êú¨Âú∞Êï∞ÊçÆ ‰ΩÜÊòØÂ¶ÇÊûúÁ¢∞Âà∞Êüê‰∫õÊñá‰ª∂‰ºöË¢´ÂÆöÊúüÁîüÊàê, ËÄåÂÜÖÂÆπÂÖ∂ÂÆûÂπ∂Ê≤°ÊúâÂèëÁîü‰ªª‰ΩïÂèòÂåñÁöÑÊÉÖÂÜµÔºåËøôÁßçÊÉÖÂÜµ‰∏ã Last-ModifiedÊîπÂèò‰∫Ü, ‰ΩÜËøôÁßçÊÉÖÂÜµÂÖ∂ÂÆûÂ∫îËØ•ËøîÂõû304„ÄÇÂõ†Ê≠§ËÆæËÆ°‰∫Ü ETag ÊñπÂºè„ÄÇ ETag Áî®‰∫éÂîØ‰∏ÄÁöÑÊ†áËØÜ‰∏Ä‰∏™Êñá‰ª∂„ÄÇÂ¶ÇÊûú‰∏§‰∏™Êñá‰ª∂ ETag Áõ∏ÂêåÔºåÈÇ£‰πàÂ∞±Ë°®Á§∫‰∏§‰∏™Êñá‰ª∂ÊòØ‰∏ÄËá¥ÁöÑÔºå‰∏ç‰ºöÈáçÂ§çËøîÂõû„ÄÇ Ëøô‰∏§ÁßçÊñπÂºèÔºö ‰∏ÄÁßçÊòØÁî®‰∫éÂÆ¢Êà∑Á´ØÊòØÂê¶Ë¶ÅÂéªËØ∑Ê±Ç„ÄÇ ‰∏ÄÁßçÊòØÁî®‰∫éÂÆ¢Êà∑Á´ØËØ∑Ê±Ç‰∫ÜÊúçÂä°Á´ØÊòØÂê¶Ë¶ÅËøîÂõûÊï∞ÊçÆ„ÄÇ atomic ‰∏éÁ∫øÁ®ãÂÆâÂÖ®atomicÁöÑÂéüÂ≠êÁ≤íÂ∫¶ÊòØGetter/SetterÔºå‰ΩÜÂØπÂ§öË°å‰ª£Á†ÅÁöÑÊìç‰Ωú‰∏çËÉΩ‰øùËØÅÂéüÂ≠êÊÄßÔºö 12345678910111213@property (atomic, assign) int num;// thread Afor (int i = 0; i &lt; 10000; i++) &#123; self.num = self.num + 1; NSLog(@"Thread A: %d\d ",self.num);&#125;// thread Bfor (int i = 0; i &lt; 10000; i++) &#123; self.num = self.num + 1; NSLog(@"Thread B: %d\d ",self.num);&#125; ÊúÄÁªàÁöÑÁªìÊûú‰∏ç‰∏ÄÂÆöÊòØ 20000ÔºåÂõ†‰∏∫Ëøô‰∏™ËøáÁ®ãÂåÖÂê´‰∫ÜÔºåËØªÂèñ numÔºåÁªô num Âä†‰∏ÄÔºåÂÜô num ‰∏â‰∏™Êìç‰Ωú„ÄÇËØªÂÜôÊòØÂéüÂ≠êÊÄßÁöÑÔºå‰ΩÜÊòØËøô‰∏â‰∏™Êìç‰Ωú‰∏çÊòØÂéüÂ≠êÊÄßÁöÑ„ÄÇ __attribute__ ÁöÑ‰ΩøÁî®__attribute__ ÊòØÁºñËØëÊåá‰ª§Ôºå‰∏ÄËà¨‰ª•__attribute__(xxx)ÁöÑÂΩ¢ÂºèÂá∫Áé∞Âú®‰ª£Á†Å‰∏≠ÔºåÊñπ‰æøÂºÄÂèëËÄÖÂêëÁºñËØëÂô®Ë°®ËææÊüêÁßçË¶ÅÊ±Ç„ÄÇ constructor__attribute__((constructor)) Âä†‰∏äËøô‰∏™Â±ûÊÄßÁöÑÂáΩÊï∞‰ºöÂú®ÂèØÊâßË°åÊñá‰ª∂ load Êó∂Ë¢´Ë∞ÉÁî®„ÄÇÂèØ‰ª•ÁêÜËß£‰∏∫Âú® main() ÂáΩÊï∞Ë∞ÉÁî®ÂâçÊâßË°åÔºö 123456789101112131415__attribute__((constructor))static void beforeMain(void) &#123; NSLog(@"beforeMain");&#125;__attribute__((destructor))static void afterMain(void) &#123; NSLog(@"afterMain");&#125;int main(int argc, const char * argv[]) &#123; NSLog(@"main"); return 0;&#125;// Console:// "beforeMain" -&gt; "main" -&gt; ‚ÄúafterMain" constructor Âíå +load ÈÉΩÊòØÂú® main ÂáΩÊï∞ÊâßË°åÂâçË∞ÉÁî®Ôºå‰ΩÜ +load ÊØî constructor Êõ¥Âä†Êó©‰∏Ä‰∏¢‰∏¢ÔºåÂõ†‰∏∫ dyldÔºàÂä®ÊÄÅÈìæÊé•Âô®ÔºåÁ®ãÂ∫èÁöÑÊúÄÂàùËµ∑ÁÇπÔºâÂú®Âä†ËΩΩ imageÔºàÂèØ‰ª•ÁêÜËß£Êàê Mach-O Êñá‰ª∂ÔºâÊó∂‰ºöÂÖàÈÄöÁü• objc runtime ÂéªÂä†ËΩΩÂÖ∂‰∏≠ÊâÄÊúâÁöÑÁ±ªÔºåÊØèÂä†ËΩΩ‰∏Ä‰∏™Á±ªÊó∂ÔºåÂÆÉÁöÑ +load Èöè‰πãË∞ÉÁî®ÔºåÂÖ®ÈÉ®Âä†ËΩΩÂÆåÊàêÂêéÔºådyld Êâç‰ºöË∞ÉÁî®Ëøô‰∏™ image ‰∏≠ÊâÄÊúâÁöÑ constructor ÊñπÊ≥ï„ÄÇÊâÄ‰ª• constructor ÊòØ‰∏Ä‰∏™Âπ≤Âùè‰∫ãÁöÑÁªù‰Ω≥Êó∂Êú∫Ôºö ÊâÄÊúâClassÈÉΩÂ∑≤ÁªèÂä†ËΩΩÂÆåÊàê main ÂáΩÊï∞ËøòÊú™ÊâßË°å Êó†ÈúÄÂÉè +load ËøòÂæóÊåÇËΩΩÂú®‰∏Ä‰∏™Class‰∏≠ sectionÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÁºñËØëÂô®‰ºöÂ∞ÜÂØπË±°ÊîæÁΩÆ‰∫éDATAÊÆµÁöÑdataÊàñËÄÖbssËäÇ‰∏≠„ÄÇ‰ΩÜÊòØÔºåÊúâÊó∂Êàë‰ª¨ÈúÄË¶ÅÂ∞ÜÊï∞ÊçÆÊîæÁΩÆ‰∫éÁâπÊÆäÁöÑËá™ÂÆö‰πâ section ‰∏≠ÔºåÊ≠§Êó∂sectionÂèØ‰ª•ËææÂà∞ÁõÆÁöÑ„ÄÇ‰æãÂ¶ÇÔºåBeeHive‰∏≠Â∞±ÊäämoduleÊ≥®ÂÜåÊï∞ÊçÆÂ≠òÂú®__DATAÊï∞ÊçÆÊÆµÈáåÈù¢ÁöÑ‚ÄúBeehiveMods‚Äùsection‰∏≠„ÄÇ 1char * kShopModule_mod __attribute((used, section("__DATA,""BeehiveMods"""))) = """ShopModule"""; ÂÖ∂‰∏≠ used ÂëäËØâÁºñËØëÂô®ÔºåÂç≥‰ΩøÂÆÉÊ≤°ÊúâË¢´‰ΩøÁî®Ôºå‰πü‰∏çË¶Å‰ºòÂåñÊéâ„ÄÇ nil Null Nil NSNull Âå∫Âà´nil ÂÆö‰πâÊüêÂÆû‰æãÂØπË±°‰∏∫Á©∫Ôºö 1NSObject* obj = nil; Nil ÂÆö‰πâÁ±ª‰∏∫Á©∫ 1Class someClass = Nil; NULL Áî®‰∫é c ËØ≠Ë®ÄÊï∞ÊçÆÁ±ªÂûãÁöÑÊåáÈíà‰∏∫Á©∫Ôºö 1char *pointerToChar = NULL; NSNull ÊòØÁ©∫ÂØπË±°ÔºåÊîæÂú® NSArray ‰∏≠ 12NSMutableDictionary *mutableDictionary = [NSMutableDictionary dictionary];mutableDictionary[@"someKey"] = [NSNull null]; SafeAreaiOS11 Êèê‰æõ‰∫Ü safeAreaLayoutGuide Âíå safeAreaInsets Êù•Â∏ÆÂä©ÂàòÊµ∑Â±èÁöÑÈÄÇÈÖç„ÄÇ ÂâçËÄÖ‰Ω†ÂèØ‰ª•ÊääÂÆÉÂΩìÂÅöÊòØ‰∏Ä‰∏™ view„ÄÇÊàë‰ª¨‰∏ÄËà¨ÈÖçÂêà Masonry ‰ΩøÁî®„ÄÇMasonry Êèê‰æõ‰∫Ü mas_safeAreaLayoutGuideÔºåmas_safeAreaLayoutGuideRight/Left/Top/Bottom Êù•ËæÖÂä©Â∏ÉÂ±ÄÔºö 123456789[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.edges.equalTo(self.view.mas_safeAreaLayoutGuide).inset(10.0);&#125;];......[rightTopView mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.right.equalTo(self.view.mas_safeAreaLayoutGuideRight); make.top.equalTo(self.view.mas_safeAreaLayoutGuideTop); make.width.height.equalTo(@(size));&#125;]; ÂêéËÄÖÂàôÊòØ‰∏Ä‰∏™ insetÔºåÈÄÇÂêàÂú® frame Â∏ÉÂ±ÄÁöÑÊó∂ÂÄô‰ΩøÁî®„ÄÇ‰ΩÜÊòØË¶ÅÊ≥®ÊÑèÔºåsafeAreaInsets ÊòØÂú®Á≥ªÁªüÊñπÊ≥ï viewSafeAreaInsetsDidChange ‰πãÂêéÊâç‰ºöÂèò‰∏∫Ê≠£Á°ÆÁöÑÂÄºÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂú®‰πãÂêéÁöÑÁîüÂëΩÂë®ÊúüÊñπÊ≥ïÔºåÊØîÂ¶Ç viewDidLayoutSubviews ÊñπÊ≥ï‰∏≠ËÆæÁΩÆÔºö 123456789101112131415static inline UIEdgeInsets sgm_safeAreaInset(UIView *view) &#123; if (@available(iOS 11.0, *)) &#123; return view.safeAreaInsets; &#125; return UIEdgeInsetsZero;&#125;- (void)viewDidLayoutSubviews &#123; [super viewDidLayoutSubviews]; UIEdgeInsets safeAreaInsets = sgm_safeAreaInset(self.view); CGFloat height = 44.0; // ÂØºËà™Ê†èÂéüÊú¨ÁöÑÈ´òÂ∫¶ÔºåÈÄöÂ∏∏ÊòØ44.0 height += safeAreaInsets.top &gt; 0 ? safeAreaInsets.top : 20.0; // 20.0ÊòØstatusbarÁöÑÈ´òÂ∫¶ÔºåËøôÈáåÂÅáËÆæstatusbar‰∏çÊ∂àÂ§± if (_navigationbar &amp;&amp; _navigationbar.height != height) &#123; _navigationbar.height = height;&#125; UIView ÁöÑÁîüÂëΩÂë®Êúü1234- (void)didAddSubview:(UIView *)subview;- (void)willRemoveSubview:(UIView *)subview;- (void)willMoveToSuperview:(nullable UIView *)newSuperview;- (void)didMoveToSuperview; willMoveToSuperview ‰ºöÂú®Ê∑ªÂä†Âà∞Áà∂ËßÜÂõæÂíå‰ªéÁà∂ËßÜÂõæÁßªÈô§ÁöÑÊó∂ÂÄôË∞ÉÁî®ÔºåÁßªÈô§ÁöÑÊó∂ÂÄôÂèÇÊï∞‰∏∫ nilÔºàÁ±ª‰ºº‰∫é willMoveToParentViewControllerÔºâ didMoveToSuperview ‰πüÊØîËæÉÈáçË¶ÅÔºåÂú®Ëøô‰∏™ÊñπÊ≥ï‰∏≠ÂèØ‰ª•ÊãøÂà∞Áà∂ËßÜÂõæÁöÑÂ§ßÂ∞èÔºåËøõË°åÁõ∏Â∫îÁöÑÂ∏ÉÂ±Ä Âà§Êñ≠ÊòØÂê¶ÁÇπÂáª‰∫ÜÊüê‰∏™ View123456789- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event&#123; UITouch *touch = [touches anyObject]; // Â∞Ü touch ËΩ¨ÂåñÂà∞ View ÁöÑÂùêÊ†áÁ≥ª CGPoint touchPoint = [touch locationInView:self]; if (CGRectContainsPoint(self.bounds, touchPoint)) &#123; // ÁÇπÂú®‰∫Ü View ‰∏≠ &#125;&#125; Áîª‰∏ÄÊù°‰∏Ä‰∏™ÂÉèÁ¥†ÁöÑÁ∫øÊ†πÊçÆÂΩìÂâçÂ±èÂπïÁöÑÁº©ÊîæÂõ†Â≠êËÆ°ÁÆóÂá∫1 ÂÉèÁ¥†Á∫øÂØπÂ∫îÁöÑPointÔºåÁÑ∂ÂêéËÆæÁΩÆÂÅèÁßª 1234#define SINGLE_LINE_WIDTH (1 / [UIScreen mainScreen].scale)#define SINGLE_LINE_ADJUST_OFFSET ((1 / [UIScreen mainScreen].scale) / 2)UIView *view = [[UIView alloc] initWithFrame:CGrect(x - SINGLE_LINE_ADJUST_OFFSET, 0, SINGLE_LINE_WIDTH, 100)]; iOSËÆæÂ§á‰∏äÔºåÊúâÈÄªËæëÂÉèÁ¥†ÔºàpointÔºâÂíå Áâ©ÁêÜÂÉèÁ¥†Ôºàpixel)‰πãÂàÜ„ÄÇpointÂíåpixelÁöÑÊØî‰æãÊòØÈÄöËøá[[UIScreen mainScreen] scale]Êù•Âà∂ÂÆöÁöÑ„ÄÇÂú®Ê≤°ÊúâËßÜÁΩëËÜúÂ±è‰πãÂâçÔºå1point = 1pixelÔºõ‰ΩÜÊòØ2xÂíå3xÁöÑËßÜÁΩëËÜúÂ±èÂá∫Êù•‰πãÂêéÔºå1pointÁ≠â‰∫é2pixelÊàñ3pixel„ÄÇ Âú®UIËÆæËÆ°Â∏àÊèê‰æõÁöÑËÆæËÆ°Á®øÊ†áÊ≥®ÔºåÂíåÂú®‰ª£Á†Å‰∏≠ËÆæÁΩÆframeÔºåÂÖ∂‰∏≠x,y,width,heightÁöÑÂçï‰ΩçÊòØ ÈÄªËæëÂÉèÁ¥†ÔºàpointÔºâÔºõGPUÂú®Ê∏≤ÊüìÂõæÂΩ¢‰πãÂâçÔºåÁ≥ªÁªü‰ºöÂ∞ÜÈÄªËæëÂÉèÁ¥†ÔºàpointÔºâÊç¢ÁÆóÊàê Áâ©ÁêÜÂÉèÁ¥†ÔºàpixelÔºâ„ÄÇ ÁºìÂ≠òË°åÈ´òÂú®cellÁ¶ªÂºÄÂ±èÂπïÂêéÔºå‰øùÂ≠òË°åÈ´òÔºö 1234567- (void)tableView:(UITableView *)tableView didEndDisplayingCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath &#123; NSString *key = [NSString stringWithFormat:@"%ld", (long)indexPath.row]; [self.heightDict setObject:@(cell.height) forKey:key]; DEBUG_LOG(@"Á¨¨%@Ë°åÁöÑËÆ°ÁÆóÁöÑÊúÄÁªàÈ´òÂ∫¶ÊòØ%f",key,cell.height);&#125; Â¶ÇÊûúÂ∑≤ÁªèÁºìÂ≠ò‰∫ÜË°åÈ´òÔºåÈÇ£‰πàÁõ¥Êé•ËøîÂõûÈ´òÂ∫¶ÔºåÂê¶ÂàôËøîÂõûÈ¢Ñ‰º∞Ë°åÈ´òÔºö 12345678910- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath&#123; NSString *key = [NSString stringWithFormat:@"%ld",indexPath.row]; if (self.heightDict[key] != nil) &#123; NSNumber *value = _heightDict[key]; DEBUG_LOG(@"%@Ë°åÁöÑÁºìÂ≠ò‰∏ãÊù•ÁöÑÈ´òÂ∫¶ÊòØ%f",key,value.floatValue); return value.floatValue; &#125; return UITableViewAutomaticDimension;&#125; ÈÉ®ÂàÜÈ°µÈù¢ÊîØÊåÅÊóãËΩ¨Âú®‰∏Ä‰∫õËßÜÈ¢ëÂ∫îÁî®‰∏≠ÔºåÊí≠ÊîæËßÜÈ¢ëÁöÑÊó∂ÂÄôÊòØÊîØÊåÅÂ±èÂπïÊóãËΩ¨ÁöÑÔºå‰ΩÜÊòØÂÖ∂‰ªñÊó∂ÂÄôÂàô‰∏çÊîØÊåÅÔºåiOS Âú® UIViewController ‰∏≠Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ï supportedInterfaceOrientations()„ÄÇ ÂΩì iOS ËÆæÂ§áÊóãËΩ¨Âà∞‰∏Ä‰∏™Êñ∞ÁöÑÊñπÂêëÊó∂ÔºåsupportedInterfaceOrientations() ÊñπÊ≥ïÂ∞±‰ºöË¢´Ë∞ÉÁî®„ÄÇÂ¶ÇÊûúËøô‰∏™ÊñπÊ≥ïÁöÑËøîÂõûÂÄº‰∏≠ÂåÖÂê´Êñ∞ÁöÑÊñπÂêëÔºåÂ∫îÁî®Á®ãÂ∫èÂ∞±‰ºöÊóãËΩ¨ÂΩìÂâçËßÜÂõæÔºåÂê¶Âàô‰∏çÊóãËΩ¨„ÄÇÊØè‰∏™ËßÜÂõæÊéßÂà∂Âô®ÈÉΩÂèØ‰ª•ÈáçÂÜôËøô‰∏™ÊñπÊ≥ïÔºåÂØπ‰∫éÂçï‰∏™ËØïÂõæÊéßÂà∂Âô®ÔºåÂèØ‰ª•Âú®ÁâπÂÆöÊù°‰ª∂‰∏ãÊîØÊåÅÁâπÂÆöÁöÑÊñπÂêë„ÄÇ 123override func supportedInterfaceOrientations)_ -&gt; UIInterfaceOrientationMasl &#123; return UIInterfaceOrientationMask(rawValue:(UIInterfaceOrientationMask.portait.rawValue | UIInterfaceOrientationMask.landscapeLeft.rawValue))&#125; ÈÄöËøá GCD Âà§Êñ≠ÊòØÂê¶ÊòØ‰∏ªÈòüÂàóÂÖàË¶ÅÊòéÁôΩÈòüÂàóÂíåÁ∫øÁ®ãÁöÑÂÖ≥Á≥ª„ÄÇ‰∏ªÁ∫øÁ®ã‰∏≠Èô§‰∫Ü‰∏ªÈòüÂàóËøòÊúâÂèØËÉΩËøêË°åÂÖ∂‰ªñÁöÑÂÖ®Â±ÄÈòüÂàó„ÄÇËÄå‰∏ªÈòüÂàóÂè™‰ºöÂú®‰∏ªÁ∫øÁ®ã‰∏≠ËøêË°å ÂÖ≥‰∫éÂ¶Ç‰ΩïÂà§Êñ≠ÊòØÂê¶ÊòØ‰∏ªÈòüÂàóÔºåÂèØ‰ª•‰ΩøÁî® GCDÔºö 12345678910BOOL RCTIsMainQueue()&#123; static void *mainQueueKey = &amp;mainQueueKey; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; dispatch_queue_set_specific(dispatch_get_main_queue(), mainQueueKey, mainQueueKey, NULL); &#125;); return dispatch_get_specific(mainQueueKey) == mainQueueKey;&#125; ÂÖ∂ÂÆûÂ∞±ÊòØÂú®‰∏ªÁ∫øÁ®ã‰∏≠Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™ key-value Êò†Â∞ÑÔºåÂè™ÊúâÂú®‰∏ªÁ∫øÁ®ãÁöÑÊÉÖÂÜµ‰∏ãÔºåÊâçËÉΩÊãøÂà∞Ëøô‰∏™ key-value ËøòÊúâ‰∏ÄÁßçÊñπÂºèÔºåÈÄöËøáËé∑ÂèñÂΩìÂâçÈòüÂàóÁöÑ label Âíå ‰∏ªÈòüÂàóÁöÑ label ËøõË°åÊØîËæÉÔºö 1dispatch_queue_get_label(DISPATCH_CURRENT_QUEUE_LABEL) == dispatch_queue_get_label(dispatch_get_main_queue()) Ê®°ÊãüÂô®ÂºπÂá∫ÈîÆÁõò‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊ®°ÊãüÂô®ÁöÑËæìÂÖ•Ê°ÜÊòØ‰∏ç‰ºöÂºπÂá∫ÈîÆÁõòÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•ËÆæÁΩÆÂÖ∂‰∏∫ÂºπÂá∫ÈîÆÁõòÔºöcommand+shift+k„ÄÇÂÖ∂ÂÆûÂãæÊéâ‰∫ÜÈÄâÈ°π‰∏≠ÁöÑ connect kardware keyboardÔºö import Â∞ñÊã¨Âè∑ÂíåÂèåÂºïÂè∑ÁöÑÂå∫Âà´import ‚Äúxxx.h‚ÄùÁöÑË∑ØÂæÑÊêúÁ¥¢È°∫Â∫èÔºö USE_HEADERMAP USER_HEADER_SEARCH_PATHS HEADER_SEARCH_PATHS import &lt;xxx.h&gt; ÁöÑË∑ØÂæÑÊêúÁ¥¢È°∫Â∫èÔºö Á≥ªÁªüË∑ØÂæÑ HEADER_SEARCH_PATHS USE_HEADERMAP ÊòØÂú® Build Settings ‰∏≠ÁöÑ Use Header Maps ‰∏≠ËÆæÁΩÆÔºåÈªòËÆ§‰∏∫ YESÔºåË°®Á§∫Á≥ªÁªü‰ºöËá™Âä®‰∏∫ÁºñËØëÊúüÊèê‰æõ‰∏Ä‰∏™Êñá‰ª∂Êò†Â∞Ñ„ÄÇÊàë‰ª¨Ëá™Â∑± new Âá∫Êù•ÁöÑÊñá‰ª∂Â∞±ÊòØÈÄöËøáÂÆÉÊâæÂà∞ÁöÑ„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÂèåÂºïÂè∑ÊòØËá™Â∑±ÂàõÂª∫ÁöÑÊñá‰ª∂ÈáåÊâæÔºåÂ∞ñÊã¨Âè∑ÊòØ‰ªéÁ≥ªÁªüÁöÑÊñá‰ª∂ÈáåÊâæ„ÄÇÊ≤°ÊâæÂà∞ÁöÑËØùÔºåÈÉΩ‰ºöÂà∞ HEADER_SEARCH_PATHS ‰∏≠Êâæ„ÄÇ Framework Search Paths Âíå Header Search Paths‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÁõ¥Êé•ÊääÊñá‰ª∂ÊàñËÄÖ framework ÊãñËøõÂ∑•Á®ãÈáåÔºåÂπ∂‰∏îÂãæ‰∏ä copy if neededÔºå‰∏ç‰ºöÂá∫Áé∞‰ªª‰ΩïÈóÆÈ¢ò„ÄÇ‰ΩÜÊòØÊúâÊó∂ÂÄôÔºåÊàë‰ª¨ÁöÑÂ§¥Êñá‰ª∂ÊàñËÄÖ framework Âπ∂‰∏çËÉΩÁõ¥Êé•ÊîæÂà∞Â∑•Á®ãÈáå„ÄÇÊØîÂ¶Ç‰∏Ä‰∏™ RN Â∫îÁî®Ôºåframework ÊòØ‰øùÂ≠òÂú® RN ÁöÑ src ‰∏≠ÁöÑÊüê‰∏™Êñá‰ª∂Â§πÂÜÖÁöÑ„ÄÇËøô‰∏™Êó∂ÂÄôÂ∞±‰ºöÂá∫Áé∞Â§¥Êñá‰ª∂Êâæ‰∏çÂà∞ÁöÑÈóÆÈ¢ò„ÄÇ Âõ†‰∏∫ÈÄöËøá copy if needed Ê∑ªÂä†ÁöÑÊñá‰ª∂‰ºöË¢´ Xcode Ëá™Âä®Ê∑ªÂä†Âà∞ Framework Search Paths ÊàñËÄÖ Header Search Paths Èáå„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú‰∏çÊòØËøôÁßçÊÉÖÂÜµÔºåÊàë‰ª¨Â∞±ÈúÄË¶ÅÊâãÂä®Ê∑ªÂä† Search Paths ‰∏ªÂ∑•Á®ã‰∏≠ÂºïÂÖ•‰∫ÜÁõÆÊ†áÂ∫ìÔºåÂ≠êtargetÊ≤°ÊúâÂºïÂÖ•ÁõÆÊ†áÂ∫ì„ÄÇÁî±‰∫éÁõÆÊ†áÂ∫ìÂ∑≤ÁªèÂú®Â∑•Á®ã‰∏≠‰∫ÜÔºåÂõ†Ê≠§Âè™Ë¶ÅÂú®Â≠êtargetÂè™Ë¶ÅËÆæÁΩÆÂ§¥Êñá‰ª∂ÊêúÂØªÂú∞ÂùÄÂç≥ÂèØ„ÄÇ ‰ª•‰∏äÈÄÇÁî®‰∫éÈùôÊÄÅÂ∫ìÔºåÂØπ‰∫éÂä®ÊÄÅÂ∫ìÔºå‰∏ªÂ∑•Á®ã‰∏≠ÈúÄË¶ÅÂºïÂÖ•ÁõÆÊ†áÂ∫ìÔºåÂ≠ê target ‰∏≠ËøòÈúÄË¶ÅÂ∞ÜÂä®ÊÄÅÂ∫ìÈÄöËøá Link Binary With Libraries ÂºïÂÖ•Ôºå‰∏çÁî®ËÆæÁΩÆÂ§¥Êñá‰ª∂ÊêúÂØªÂú∞ÂùÄ‰∫Ü„ÄÇ ‰∏∫‰ªÄ‰πà‰∏çÂú® iOS È°πÁõÆ‰∏≠‰ΩøÁî® reduxredux Â∞ÜÊâÄÊúâÁä∂ÊÄÅÁªÑÂêàÂú®‰∏ÄËµ∑ÔºåÈÖçÂêà react È£üÁî®Êõ¥‰Ω≥ÔºåÈÇ£‰πàÊàë‰ª¨‰∏∫‰ªÄ‰πà‰∏çÊää‰ªñ‰ΩøÁî®Â≠êÂïä iOS ‰∏≠Âë¢ÔºüÊàëÊÉ≥Âà∞‰∫Ü‰∏§‰∏™ÁêÜÁî±Ôºö oc ÊàñËÄÖ swift ÊòØÂº∫Á±ªÂûãËØ≠Ë®Ä„ÄÇÂ¶ÇÊûúÊääÁä∂ÊÄÅÈÉΩÊîæÂú® store ÈáåÁª¥Êä§ÔºåÊÑèÂë≥ÁùÄ store ÈáåÈúÄË¶Å import ÂêÑÁßç model Á±ª„ÄÇ‰∫ßÁîüÂº∫ËÄ¶Âêà„ÄÇËÄå js ÂàôÊòØÂº±Á±ªÂûã„ÄÇ‰∏çÁî®Âú®ÊÑè store ÈáåÁöÑÊüê‰∏™Â±ûÊÄßÁ©∂Á´üÊòØ‰ªÄ‰πàÁ±ªÂûãÔºå‰πüÂ∞±‰∏çÈúÄË¶Å import ÈÇ£‰πàÂ§ö model„ÄÇ react ÊòØÁõ∏Â∫îÂºèÁöÑÔºåstore ÈáåÁöÑÂ±ûÊÄß‰øÆÊîπ‰∫ÜÂ∞±ËÉΩÂèçÊò†Âà∞ UI ‰∏äÔºå‰ΩÜÊòØ iOS ÁºñÁ®ã‰∏çÊòØÂìçÂ∫îÂºèÁöÑÔºåÂç≥‰Ωø store ÈáåÁöÑÂÆûË°åÊîπÂèò‰∫ÜÔºå‰Ω†ËøòÊòØË¶Å‰ΩøÁî® setText Á≠âÁ±ª‰ººÊñπÊ≥ïÔºåÂà∑Êñ∞ UI„ÄÇÊâÄ‰ª•Âç≥‰Ωø‰ΩøÁî®‰πüÊúÄÂ•ΩÈÖçÂêà RxSwift Â∞ÅË£ÖÂéüÂàô ÊòéÁ°ÆÁõÆÊ†áÔºöÈ¶ñÂÖàÈù†ËÄÉËôëÂ•ΩÔºåÂ∞ÅË£ÖË¶ÅÂÅö‰ªÄ‰πàÔºå‰∏çË¶ÅÂÜôÁùÄÂÜôÁùÄÊç¢ÁõÆÊ†á„ÄÇ Âçï‰∏ÄÂäüËÉΩÂéüÂàôÔºöÂÖ∂Ê¨°ÔºåË¶ÅÂ∞Ü‰∏Ä‰∏™Â§ßÁõÆÊ†áÂàÜËß£ÊàêËã•Âπ≤Ê≠•Â∞èÁõÆÊ†áÂàÜÂà´ÂÆûÁé∞„ÄÇÁÑ∂Âêé‰∏≤ËÅîËµ∑Êù• Â§ñÁïåÁü•ÈÅìÊúÄÂ∞ëÔºöÊâæÂá∫Â§ñÁïåÂøÖÈ°ªÁü•ÈÅìÁöÑÔºå‰Ωú‰∏∫Â∞ÅË£ÖËæìÂá∫ ÈáçÂ§ç‰ª£Á†ÅÂ§çÁî®ÔºöÊâæÂá∫ÈáçÂ§ç‰ª£Á†ÅÔºåÂ°ûÂà∞Â∞ÅË£ÖÂÜÖ ÂÜô‰º™‰ª£Á†ÅÔºöÈÄªËæëÂ§çÊùÇÔºå‰∏çË¶ÅÊÉ≥ÁùÄ‰∏ÄÊ≠•Âà∞‰Ωç„ÄÇÂÖàÂÜô‰º™‰ª£Á†ÅÔºåÁÑ∂ÂêéÊääÁõ∏ÂêåÁöÑÈÉ®ÂàÜÂΩíÁ±ª„ÄÇ Image.Assets Â≠òÊîæÂõæÁâáÂíåÂú®Êñá‰ª∂Â§πÈáåÂ≠òÊîæÁöÑÂå∫Âà´Assets.xcassets ‰∏ÄËà¨ÊòØ‰ª•ËìùËâ≤Êñá‰ª∂Â§πÂΩ¢ÂºèÂú®Â∑•Á®ã‰∏≠Ôºå‰ª•Image SetÁöÑÂΩ¢ÂºèÁÆ°ÁêÜ„ÄÇÂΩì‰∏ÄÁªÑÂõæÁâáÊîæÂÖ•ÁöÑÊó∂ÂÄôÂêåÊó∂‰ºöÁîüÊàêÊèèËø∞Êñá‰ª∂Contents.json„ÄÇ‰∏îÂú®ÊâìÂåÖÂêé‰ª•Assets.carÁöÑÂΩ¢ÂºèÂ≠òÂú®Ôºå‰ª•Ê≠§ÊñπÂºèÊîæÂÖ•ÁöÑÂõæÁâáÂπ∂‰∏çÂú®mainBundle‰∏≠Ôºå‰∏çËÉΩ‰ΩøÁî® contentOfFile ËøôÊ†∑ÁöÑAPIÊù•Âä†ËΩΩÂõæÁâáÔºàÂõ†‰∏∫Ëøô‰∏™ÊñπÊ≥ïÁõ∏ÂΩì‰∫éÊòØÂéªmainBundleÈáåÈù¢ÊâæÂõæÁâáÔºå‰ΩÜÊòØËøô‰∫õÂõæÁâáÈÉΩË¢´ÊâìÂåÖËøõ‰∫ÜAssets.carÊñá‰ª∂ÔºâÔºåinterface builder‰∏≠‰ΩøÁî®ÂõæÁâáÊó∂‰∏çÈúÄË¶ÅÂêéÁºÄÂíåÂÄçÊï∞Ê†áËØÜÔºà@2xËøôÊ†∑ÁöÑÔºâ‰ºòÁÇπÊòØÊÄßËÉΩÂ•ΩÔºåËäÇÁúÅDisk„ÄÇ Áõ¥Êé•ÊãñÂà∞Êñá‰ª∂Â§πÈáåÁöÑÂõæÁâáÔºåÈÉΩÊòØÂ≠òÂú® mainBundle ‰∏≠ÁöÑ„ÄÇÊâÄ‰ª•ÂèØ‰ª•‰ΩøÁî® contentOfFile Êù•Âä†ËΩΩÂõæÁâá„ÄÇÂè¶Â§ñÊàë‰ª¨‰πüÂèØ‰ª•ÊääËµÑÊ∫êÊñá‰ª∂ÊâìÊàê‰∏Ä‰∏™ bundleÔºåÊîæÂú®‰∏ªÂ∑•Á®ã‰∏ãÔºàmainBundle ‰∏ãÔºâ„ÄÇ copy groups Âíå copy folder reference ÁöÑÂå∫Âà´‰ªÄ‰πàÊòØ GroupGroup ÂÖ∂ÂÆûÊòØ‰ªÖÂú® Xcode ‰∏≠ËôöÊãüÁöÑÁî®Êù•ÁªÑÁªáÊñá‰ª∂ÁöÑ‰∏ÄÁßçÊñπÂºè, ÂÆÉÂØπÊñá‰ª∂Á≥ªÁªüÊ≤°Êúâ‰ªª‰ΩïÂΩ±Âìç, Êó†ËÆ∫‰Ω†ÂàõÂª∫ÊàñËÄÖÂà†Èô§‰∏Ä‰∏™ Group, ÈÉΩ‰∏ç‰ºöÂØºËá¥ÂÆûÈôÖÁöÑÊñá‰ª∂ÁöÑÂ¢ûÂä†ÊàñËÄÖÁßªÈô§„ÄÇ ‰∏§ËÄÖÂå∫Âà´ÊâìÂåÖÁöÑÊó∂ÂÄôÔºå xode ÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂ÔºåÈô§‰∫Ü Image.Assets ‰ª•ÂèäÂä®ÊÄÅÂ∫ìÔºåÈÉΩ‰ºö‰øùÂ≠òÂà∞ mainBundle ‰∏≠ÂéªÔºàÈùôÊÄÅÂ∫ìÊòØÂú® mainBundle ‰∏≠ÁöÑÔºâ„ÄÇ‰ª• copy groups ÂºïÂÖ•ÁöÑÊñá‰ª∂ÔºåÊ≤°ÊúâÊñá‰ª∂Â±ÇÁ∫ßÔºåÂ∞±Áõ∏ÂΩì‰∫éÁõ¥Êé•Êää group ÈáåÁöÑÊñá‰ª∂ÊâîÂà∞‰∫Ü mainBundle ‰∏≠ÂéªÔºåËÄå‰ª• copy folder reference ÂºïÂÖ•ÁöÑÊñá‰ª∂‰ºö‰øùÊåÅÊñá‰ª∂Â±ÇÁ∫ß„ÄÇ Group Âú®Êàë‰ª¨ÁöÑÂ∑•Á®ã‰∏≠Â∞±ÊòØÈªÑËâ≤ÁöÑÊñá‰ª∂Â§π, ËÄå Folder ÊòØËìùËâ≤ÁöÑÊñá‰ª∂Â§π„ÄÇ Âü∫Êú¨Á±ªÂûãÁöÑÊåáÈíàÊàë‰ª¨Áü•ÈÅìÔºåÂü∫Êú¨Á±ªÂûãÁöÑÂèòÈáè‰Ωú‰∏∫ÂÖ•ÂèÇ‰º†ÂÖ•ÂáΩÊï∞‰∫ßÁîüÊîπÂèòÊó∂‰∏ç‰ºöÂΩ±ÂìçÂ§ñÈÉ®ÁöÑÂèòÈáèÂÄº„ÄÇÊâÄ‰ª•Â¶ÇÊûú‰∏çËÉΩËøîÂõûÁöÑËØùÔºåÂ∞±ÈúÄË¶Å‰º†ÂÖ•‰∏Ä‰∏™Âü∫Êú¨Á±ªÂûãÁöÑÊåáÈíàÔºö 1234567BOOL roolback = YES;BOOL *r = &amp;roolback;---// ÂÅáËÆæ‰º†ÂÖ•‰∫ÜÊüê‰∏™ÊñπÊ≥ïÔºåÁÑ∂ÂêéÂú®ÂÖ∂‰∏≠ÊîπÂèò‰∫ÜÂÄº*r = NO;---NSLog(@"%dÔºåroolback ‰ªé1Âèò‰∏∫‰∫Ü0",roolback); ÈùûÂü∫Êú¨Á±ªÂûãÁöÑÊåáÈíàÁöÑËµãÂÄºÁõ¥Êé•Â∞±ÊòØ p = Person() ËøôÁßçÂú∞ÂùÄÁöÑËµãÂÄºÂ∞±Ë°å‰∫ÜÔºå‰∏çÂ≠òÂú® *p ÁöÑÊÉÖÂÜµ„ÄÇÂü∫Êú¨Á±ªÂûãÁöÑÊåáÈíàÂøÖÈ°ªÈÄöËøá *r ÊãøÂà∞Â†Ü‰∏äÁöÑÂÄº `*r = No„ÄÇ ‰∏∫ÊñáÊú¨Âä†‰∏ä‰∏ãÂàíÁ∫øÂü∫Êú¨Â∞±ÊòØÁî® NSMutableAttributedString ‰ª£ÊõøÂéüÊù•ÁöÑ NSStringÔºåÁÑ∂Âêé‰∏∫ÊñáÊú¨ÈïøÂ∫¶ÁöÑ range ÂÜÖÊ∑ªÂä†‰∏Ä‰∏™‰∏ãÂàíÁ∫øÁöÑÂ±ûÊÄß„ÄÇ ‰∏ãÈù¢ÊºîÁ§∫‰∏Ä‰∏™‰∏∫ÊåâÈíÆÊ∑ªÂä†‰∏ãÂàíÁ∫ø: 1234NSMutableAttributedString *string = [[NSMutableAttributedString alloc] initWithString:button.titleLabel.text];NSRange strRange = &#123;0,[string length]&#125;;[string addAttribute:NSUnderlineStyleAttributeName value:[NSNumber numberWithInteger:NSUnderlineStyleSingle] range:strRange];[button setAttributedTitle:string forState:UIControlStateNormal]; Â¶Ç‰ΩïËÆ© xib ‰∏≠ÁöÑ‰∏§‰∏™ËßÜÂõæÂπ≥ÂàÜÁà∂ËßÜÂõæËØ¥ÊòØÂπ≥ÂàÜÔºåÂÖ∂ÂÆûÂ∞±ÊòØ‰∏§‰∏™ËßÜÂõæÁöÑÂÆΩÂ∫¶Áõ∏Âêå„ÄÇÊúÄÂºÄÂßãÁöÑÂäûÊ≥ïÊòØËÆæÁΩÆ‰∏Ä‰∏™Á©∫ÁôΩËßÜÂõæÂ±Ö‰∫éÁà∂ËßÜÂõæÁöÑ‰∏≠Èó¥ÔºåÁÑ∂Âêé‰∏§‰∏™ËßÜÂõæÂàÜÂà´Ë¥¥ÁùÄËøô‰∏™Á©∫ÁôΩËßÜÂõæÁöÑÂ∑¶Âè≥Ôºå‰ΩÜÊòØËøô‰∏™ÊñπÊ≥ïÈùûÂ∏∏ÁöÑË†¢„ÄÇÂÖ∂ÂÆûÂè™Ë¶ÅÈÄâ‰∏≠‰∏§‰∏™ËßÜÂõæÔºåÁÑ∂ÂêéËÆæÁΩÆ‰∏∫ equal width Â∞±Ë°å‰∫ÜÔºåÂ∞±Âú®ËÆæÁΩÆÁ∫¶ÊùüÁöÑÂú∞Êñπ„ÄÇ VC ‰∏≠‰ΩøÁî® self.view Ëé∑ÂèñÂ±èÂπïÂÆΩÈ´òÂá∫ÈîôÈîôËØØÊèèËø∞ÔºöÂú® viewDidLoad ‰∏≠ËßÜÂõæÈÄöËøá self.view Ëé∑ÂèñÂ±èÂπïÂÆΩÈ´òÔºå‰ΩÜÊòØËé∑ÂèñÊï∞ÂÄºÊúâËØØ„ÄÇ ÂéüÂõ†ÔºöËøôÁßçÊÉÖÂÜµ‰∏ÄËà¨ÊòØ‰ΩøÁî® xib ËÆæÁΩÆÈ°µÈù¢ÁöÑÊó∂ÂÄôÂá∫Áé∞„ÄÇ‰ΩøÁî®xibËÆæÁΩÆÈ°µÈù¢ÁöÑÊó∂ÂÄôÔºåÈÄâÊã©ÁöÑÊòØiPhone7ÁöÑÂ∏ÉÂ±ÄÔºåÂÆΩÂ∫¶ÊòØ375.ÂΩì‰ªé xib Âä†ËΩΩÈ°µÈù¢ÂêéÔºåviewDidLoad Êó∂ÔºåÁ∫¶ÊùüÊ≤°ÊúâÊõ¥Êñ∞„ÄÇÊâÄ‰ª• self.view ÁöÑÂÆΩÂ∫¶ÂíåÈ´òÂ∫¶ËøòÊòØ xib ËÆæËÆ°ÁöÑÈ´òÂÆΩ„ÄÇË¶ÅÁ≠âÂà∞ viewDidAppear Êó∂È°µÈù¢Á∫¶ÊùüÂ∞±‰ºöÊõ¥Êñ∞„ÄÇ Âª∫ËÆÆ‰∏çË¶ÅÂú® viewDidLoad ‰∏≠Áõ¥Êé•‰ΩøÁî® self.view.bounds ÁöÑÈ´òÂÆΩÊù•ËÆ°ÁÆóÂÖ∂‰ªñÂ±ûÊÄßÁöÑ frame„ÄÇ ËÄåÊòØ‰ΩøÁî® [UIScreen mainScreen].bounds Ëé∑ÂèñÊâãÊú∫Â±èÂπïÁöÑÁúüÂÆûÈ´òÂÆΩ„ÄÇ Â¶Ç‰ΩïÂú®‰∫åÁ∫ßÈ°µÈù¢ÈöêËóè tabbar‰∏ÄËà¨‰ºöÂú® TabBarController ‰∏≠ËÆæÁΩÆÂ§ö‰∏™ NavigationController ‰Ωú‰∏∫ÂêÑ‰∏™ tab ÁöÑ ViewController„ÄÇÊàë‰ª¨Âè™Ë¶ÅÂÜô‰∏Ä‰∏™ BaseViewControllerÔºåÂú®ÂÖ∂‰∏≠ÈáçÂÜô pushViewController:animated ÊñπÊ≥ïÔºåÂú®ÂÖ∂‰∏≠Âà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅÈöêËóèÂ∞±Ë°å„ÄÇËÆæÁΩÆ hidesBottomBarWhenPushed Â±ûÊÄßÊù•ÊéßÂà∂Âú®Ë∑≥ËΩ¨ÁöÑÊó∂ÂÄôÈöêËóè„ÄÇ123456- (void)pushViewController:(UIViewController *)viewController animated:(BOOL)animated &#123; if (self.viewControllers.count) &#123; viewController.hidesBottomBarWhenPushed = YES; &#125; [super pushViewController:viewController animated:animated];&#125; Â¶Ç‰ΩïÂú® pop ÁöÑÊó∂ÂÄôÊ∏ÖÁêÜËµÑÊ∫ê‰ªçÁÑ∂ÊòØÂú® BaseViewController ‰∏≠ÈáçÂÜô popViewControllerAnimated: ÊñπÊ≥ï„ÄÇÂú®ÂÖ∂‰∏≠Ë∞ÉÁî®ÁâπÂÆöÊñπÊ≥ïÔºåÊù•ÂÅö‰∏Ä‰∫õÊ∏ÖÁêÜËµÑÊ∫êÁöÑÂñÑÂêéÂ∑•‰Ωú„ÄÇ1234567- (UIViewController *)popViewControllerAnimated:(BOOL)animated&#123; if ([[self.viewControllers lastObject] isKindOfClass:[BaseViewController class]]) &#123; BaseViewController *viewController=[self.viewControllers lastObject]; [viewController willPopViewController]; &#125; return [super popViewControllerAnimated:animated];&#125; UIImage ÁöÑÊ∏≤ÊüìÊ®°Âºè imageWithRenderingMode:ËØ•ÊñπÊ≥ïÁî®Êù•ËÆæÁΩÆÂ±ûÊÄß renderingMode„ÄÇÂÆÉ‰ΩøÁî® UIImageRenderingMode Êûö‰∏æÂÄºÊù•ËÆæÁΩÆÂõæÁâáÁöÑ renderingMode Â±ûÊÄß„ÄÇËØ•Êûö‰∏æ‰∏≠ÂåÖÂê´‰∏ãÂàóÂÄºÔºö123UIImageRenderingModeAutomatic // Ê†πÊçÆÂõæÁâáÁöÑ‰ΩøÁî®ÁéØÂ¢ÉÂíåÊâÄÂ§ÑÁöÑÁªòÂõæ‰∏ä‰∏ãÊñáËá™Âä®Ë∞ÉÊï¥Ê∏≤ÊüìÊ®°Âºè„ÄÇUIImageRenderingModeAlwaysOriginal // ÂßãÁªàÁªòÂà∂ÂõæÁâáÂéüÂßãÁä∂ÊÄÅÔºå‰∏ç‰ΩøÁî®Tint Color„ÄÇ UIImageRenderingModeAlwaysTemplate // ÂßãÁªàÊ†πÊçÆTint ColorÁªòÂà∂ÂõæÁâáÔºåÂøΩÁï•ÂõæÁâáÁöÑÈ¢úËâ≤‰ø°ÊÅØ„ÄÇ Â∫îÁî®Âú∫ÊôØÊòØ‰ªÄ‰πàÂë¢ÔºüÊØîÂ¶ÇËÆæÁΩÆ‰∏Ä‰∏™ tabbar ÁöÑ UIImage Â¶ÇÊûú‰∏çÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ UIImageRenderingModeAlwaysOriginal„ÄÇÈÇ£‰πàÂõæÁâáÁöÑÈÄâ‰∏≠Áä∂ÊÄÅÁöÑÈ¢úËâ≤Â∞±‰ºöË∑üÈöèÁ≥ªÁªüÁöÑ tintColor„ÄÇ Â∞ÅË£Ö‰∏Ä‰∏™Ê≤°ÊúâÊï∞ÊçÆÊó∂ÊòæÁ§∫Á©∫ÁôΩÈ°µÊ≤°ÊúâÊï∞ÊçÆÁöÑÊó∂ÂÄôÈÄöÂ∏∏ÈúÄË¶ÅÊòæÁ§∫‰∏Ä‰∏™Á©∫ÁôΩÈ°µ„ÄÇÁ©∫ÁôΩÈ°µÈïøÂæóÈÉΩÂ∑Æ‰∏çÂ§öÔºåÂü∫Êú¨‰∏äÈÉΩÊòØ‰∏ÄÊÆµËØùÂä†‰∏ä‰∏ÄÂº†Âõæ„ÄÇÊàë‰ª¨ÂΩìÁÑ∂‰∏çË¶ÅÊØèÊ¨°ÈÉΩÂÜô‰∏ÄÈÅçËøô‰∏™ËßÜÂõæÔºåÂõ†Ê≠§Â∞±ÈúÄË¶ÅÂ∞ÜËøô‰∫õÊìç‰ΩúÊîæÂà∞ base ‰∏≠Âéª„ÄÇ Âú® BaseViewController ‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ reloadDataWithBlank ÊñπÊ≥ïÔºåÊØèÊ¨°‰ªéÁΩëÁªúËé∑ÂèñÂÆåÊï∞ÊçÆÂêéÔºåË∞ÉÁî®Âç≥ÂèØÔºàÁúÅÂéª‰∫ÜÊØèÊ¨°ÈÉΩË¶ÅÂà§Êñ≠Êï∞ÊçÆÊòØÂê¶‰∏∫Á©∫ÁöÑÈ∫ªÁÉ¶ÔºâÔºö123456789101112131415161718192021222324- (void)reloadDataWithBlank&#123; //Â§öÊÆµÂ∞±ÁúãÊØè‰∏™Êï∞ÁªÑÔºå‰∏ÄÊÆµÂ∞±Áõ¥Êé•ÁúãÂÖÉÁ¥†‰∏™Êï∞ if (_isMultiSection) &#123; BOOL isCountZero=YES; for (NSArray *array in self.dataSource) &#123; if (array.count!=0) &#123; isCountZero=NO; break; &#125; &#125; if (isCountZero) &#123; [_tableView addSubview:self.blankHintView]; &#125;else&#123; [self.blankHintView removeFromSuperview]; &#125; &#125;else&#123; if (self.dataSource.count==0) &#123; [_tableView addSubview:self.blankHintView]; &#125;else&#123; [self.blankHintView removeFromSuperview]; &#125; &#125; [_tableView reloadData];&#125; ÂÖ∂‰∏≠ blankHintView Â∞±ÊòØÁ©∫ÁôΩÊèêÁ§∫ËßÜÂõæÔºö 1234567891011121314151617181920212223242526272829303132-(UIView *)blankHintView&#123; if (!_blankHintView) &#123; [self initBlankHintView]; &#125; return _blankHintView;&#125;-(void)initBlankHintView&#123; _blankHintView=[[UIView alloc]initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)]; UIImageView *imageView=[[UIImageView alloc]initWithFrame:CGRectMake(self.tableView.width/2-40,self.tableView.height/2-40-30,80,80)]; if (_blankHintImage) &#123; imageView.image = _blankHintImage; &#125;else&#123; imageView.image = [UIImage imageNamed:@&quot;nonetworkdefault&quot;]; &#125; imageView.contentMode=UIViewContentModeScaleAspectFit; UILabel *hintLabel = [[UILabel alloc]initWithFrame:CGRectMake(imageView.x-10, imageView.y+imageView.height, 200, 30)]; hintLabel.numberOfLines = 0; hintLabel.lineBreakMode = NSLineBreakByWordWrapping; hintLabel.textColor=[UIColor colorWithHexString:@&quot;9e9e9e&quot;]; hintLabel.backgroundColor = [UIColor clearColor]; hintLabel.textAlignment=NSTextAlignmentLeft; hintLabel.font=FONT(15); hintLabel.text=_blankHintString; [_blankHintView addSubview:hintLabel]; [_blankHintView addSubview:imageView]; [hintLabel mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.top.equalTo(imageView.mas_bottom).offset(0); make.centerX.equalTo(imageView.mas_centerX).offset(0); make.height.equalTo(@30); &#125;];&#125; ÊØèÊ¨°Âú® viewDidLoad ‰∏≠ÔºåÊàñËÄÖÂú®Ëøô‰∏™ÊñπÊ≥ïÂÜÖÂÜçÂàõÂª∫‰∏Ä‰∏™ÂäüËÉΩÊõ¥ÊòéÁ°ÆÁöÑ loadDefaultDataSource ÊñπÊ≥ïÔºåÂú®ÂÖ∂‰∏≠‰∏≠Ê∑ªÂä†ÈªòËÆ§ÁöÑ title Âíå image Âç≥ÂèØ„ÄÇ 12345-(void)loadDefaultDataSource&#123; [super loadDefaultDataSource]; self.blankHintImage = [UIImage imageNamed:@&quot;default_nomessage&quot;]; self.blankHintString=@&quot;ÊöÇÊó†ÈÄöÁü•Ê∂àÊÅØ&quot;;&#125; ËÆæÁΩÆÊâãÂäø‰∫ã‰ª∂ÂÖ≥‰∫éÊâãÂäøÔºåÈÄöÂ∏∏ÈúÄË¶ÅÂÖàÂ£∞Êòé‰∏Ä‰∏™ÊâãÂäøÔºåÂÜçÂú®Âè¶‰∏ÄÂ§ÑÊ∑ªÂä†Ëøô‰∏™ÊâãÂäøÁöÑÂ§ÑÁêÜÊñπÊ≥ïÔºåËøôÊ†∑ËÆæÁΩÆ‰∫ã‰ª∂ÂíåÊñπÊ≥ïÊú¨Ë∫´Â∞±‰ºöÂàÜÈöîÂºÄÊù•ÔºåÂõûÈ°æ‰ª£Á†ÅÁöÑÊó∂ÂÄôÊâæËµ∑Êù•‰ºöÂæàÈ∫ªÁÉ¶„ÄÇÂèØ‰ª•‰∏∫ UIView ËÆæÁΩÆÊ∑ªÂä†‰∏Ä‰∏™Â§ÑÁêÜÊâãÂäøÁöÑËåÉÁï¥(category)ÔºåÂú®ÂÖ∂‰∏≠ÈÄöËøá block ÂõûË∞ÉÁöÑÊñπÂºèÂ∞ÜÊñπÊ≥ï‰øùÂ≠òËµ∑Êù•Ôºö123456789101112131415161718192021@implementation UIView (BlockGesture) - (void)addTapActionWithBlock:(GestureActionBlock)block&#123; UITapGestureRecognizer *gesture = [self associatedValueForKey:_cmd]; if (!gesture)&#123; gesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleActionForTapGesture:)]; [self addGestureRecognizer:gesture]; [self setAssociateValue:gesture withKey:_cmd]; &#125; [self setAssociateCopyValue:block withKey:&amp;kActionHandlerTapBlockKey]; self.userInteractionEnabled = YES;&#125;- (void)handleActionForTapGesture:(UITapGestureRecognizer*)gesture&#123; if (gesture.state == UIGestureRecognizerStateRecognized)&#123; GestureActionBlock block = [self associatedValueForKey:&amp;kActionHandlerTapBlockKey]; if (block)&#123; block(gesture); &#125; &#125;&#125; ÂÖàÊää gesture ‰øùÂ≠òËµ∑Êù•ÔºåÂÜçÊääÊâãÂäøÂØπÂ∫îÁöÑ block ‰øùÂ≠òËµ∑Êù•„ÄÇ‰ΩøÁî®ÁöÑÊó∂ÂÄôË∞ÉÁî®Âç≥ÂèØÔºö123[label addTapActionWithBlock:^(UIGestureRecognizer *gestureRecoginzer) &#123; ...&#125;]; ÂõæÂÉèÊòæÁ§∫ËøáÁ®ã‰∏é‰∏Ä‰∫õÊ≥®ÊÑè‰∫ãÈ°πÊòæÁ§∫ËøáÁ®ãËøôÈáåÈ¶ñÂÖàÂº∫Ë∞ÉÔºåËøôÈáåËØ¥ÁöÑÊâÄÊúâÈÉΩÊòØÈíàÂØπ View ËÄå‰∏çÊòØ Controller„ÄÇ Ëá™Âä®Â∏ÉÂ±ÄÂ∞ÜËßÜÂõæÊòæÁ§∫Âà∞Â±èÂπï‰∏äÁöÑÊ≠•È™§ÊÄªÂÖ±ÂàÜ‰∏∫‰∏âÊ≠•Ôºö Êõ¥Êñ∞Á∫¶Êùü„ÄÇÂÆÉ‰∏∫Â∏ÉÂ±ÄÂáÜÂ§áÂ•ΩÂøÖË¶ÅÁöÑ‰ø°ÊÅØÔºåËÄåËøô‰∫õÂ∏ÉÂ±ÄÂ∞ÜÂú®ÂÆûÈôÖËÆæÁΩÆËßÜÂõæÁöÑ frame Êó∂Ë¢´‰º†ÈÄíËøáÂéªÂπ∂Ë¢´‰ΩøÁî®„ÄÇ‰Ω†ÂèØ‰ª•ÈÄöËøáË∞ÉÁî® setNeedsUpdateConstraints Êù•Ëß¶ÂèëËøô‰∏™Êìç‰Ωú„ÄÇË∞àÂà∞Ëá™ÂÆö‰πâËßÜÂõæÔºåÂèØ‰ª•ÈáçÂÜô updateConstraints Êù•‰∏∫‰Ω†ÁöÑËßÜÂõæÁöÑÊú¨Âú∞Á∫¶ÊùüËøõË°å‰øÆÊîπÔºà‰∏ÄËà¨‰∏ç‰ºöÁî®Âï¶ÔºâÔºå‰ΩÜË¶ÅÁ°Æ‰øùÂú®‰Ω†ÁöÑÂÆûÁé∞‰∏≠‰øÆÊîπ‰∫Ü‰ªª‰Ωï‰Ω†ÈúÄË¶ÅÂ∏ÉÂ±ÄÂ≠êËßÜÂõæÁöÑÁ∫¶ÊùüÊù°‰ª∂‰πãÂêéÔºåË∞ÉÁî®‰∏Ä‰∏ã [super updateConstraints]„ÄÇ Â∏ÉÂ±Ä„ÄÇÂ∞ÜÁ∫¶ÊùüÊù°‰ª∂Â∫îÁî®Âà∞ËßÜÂõæ‰∏ä„ÄÇÂèØ‰ª•ÈÄöËøáÈáçÂÜô layoutSubViews ÂÆûÁé∞Ôºå‰πüÂ∞±ÊòØÂú®Ë∞ÉÁî® [super layoutSubviews] Ââç‰øÆÊîπ‰∏Ä‰∫õÁ∫¶Êùü‰ø°ÊÅØ„ÄÇÂèØ‰ª•ÈÄöËøáË∞ÉÁî® setNeedsLayout Êù•Ëß¶Âèë‰∏Ä‰∏™Êìç‰ΩúËØ∑Ê±ÇÔºåËøôÂπ∂‰∏ç‰ºöÁ´ãÂàªÂ∫îÁî®Â∏ÉÂ±ÄÔºåËÄåÊòØÂú®Á®çÂêéÂÜçËøõË°åÂ§ÑÁêÜ„ÄÇÂõ†‰∏∫ÊâÄÊúâÁöÑÂ∏ÉÂ±ÄËØ∑Ê±ÇÂ∞Ü‰ºöË¢´ÂêàÂπ∂Âà∞‰∏Ä‰∏™Â∏ÉÂ±ÄÊìç‰Ωú‰∏≠Âéª„ÄÇÂèØ‰ª•Ë∞ÉÁî® layoutIfNeeded Êù•Âº∫Âà∂Á≥ªÁªüÁ´ãÂç≥Êõ¥Êñ∞ËßÜÂõæÊ†ëÁöÑÂ∏ÉÂ±Ä„ÄÇ ÊòæÁ§∫„ÄÇÂèØ‰ª•ÈÄöËøáË∞ÉÁî® setNeedsDisplay Êù•Ëß¶ÂèëÔºåËøôÂ∞Ü‰ºöÂØºËá¥ÊâÄÊúâÁöÑË∞ÉÁî®ÈÉΩË¢´ÂêàÂπ∂Âà∞‰∏ÄËµ∑Êé®ËøüÈáçÁªò„ÄÇÈáçÂÜôÁÜüÊÇâÁöÑ drawRect: ÔºåÈÄöËøáËøô‰∏™ÊñπÊ≥ïÊàë‰ª¨ÂèØ‰ª•Âú® UIView ‰∏≠ÁªòÂà∂ÂõæÂΩ¢ÔºåÊØîÂ¶ÇÁªòÂà∂‰∏™ËßíÊ†á‰πãÁ±ªÁöÑ„ÄÇ layoutSubViews ÁöÑÊ≥®ÊÑè‰∫ãÈ°πlayoutSubViews ÊñπÊ≥ïÁªô View Êèê‰æõ‰∫Ü‰∏Ä‰∏™Áªü‰∏ÄËÆæÁΩÆÂ≠êËßÜÂõæÂ§ßÂ∞èÂ∏ÉÂ±ÄÁöÑÂú∞ÊñπÔºå‰∏çËÉΩÂú® init ÊñπÊ≥ï‰∏≠„ÄÇÂõ†‰∏∫ÂΩìÂ§ñÈÉ®ÂàõÂª∫ËØ• view Êó∂ÔºåÂ¶ÇÊûúÂ§ñÈÉ®Ë∞ÉÁî® init ÊñπÊ≥ïËÄå‰∏çÊòØË∞ÉÁî® initWithFrame (Âç≥Ê≤°ÊúâÁªôËøô‰∏™ view ËÆæÁΩÆÂ§ßÂ∞èÔºâÔºåÈÇ£‰πà view ‰∏≠Â≠êËßÜÂõæÂ∞±Êó†Ê≥ïÊ≠£Á°ÆÂàùÂßãÂåñÂá∫Â§ßÂ∞è„ÄÇÂõ†Ê≠§ÔºåÂ≠êËßÜÂõæÁöÑ bounds Á≠âÂ±ûÊÄßÔºà‰æãÂ¶Ç center Á≠âÔºâÁöÑËÆæÁΩÆÂøÖÈ°ªÊîæÂú® layoutSubviews ‰∏≠ÔºåÂç≥Â§ñÈÉ® view Â§ßÂ∞èÂ∑≤ÁªèÁ°ÆÂÆöÔºåÂ∞±Ë¶ÅÊòæÁ§∫ÁöÑÊó∂ÂÄô„ÄÇ ËÆ∞‰∏Ä‰∏™ÈîôËØØÂÆπÊòìÁäØÁöÑÈîôËØØÔºö frameÔºåcenter ÈÉΩÊòØÁõ∏ÂØπ‰∫éÁà∂ View ÁöÑ„ÄÇÊâÄ‰ª•Â¶ÇÊûú‰Ω†Ë¶ÅËÆ©‰∏Ä‰∏™Â≠ê View Âú® Áà∂ View Â±Ö‰∏≠Ôºå‰Ω†ÁªùÂØπ‰∏çËÉΩÂÜô subView.center = parentView.centerÔºåÂõ†‰∏∫ parentView.center ÂèàÊòØÁõ∏ÂØπ‰∫éÂÖ∂Áà∂ View ÁöÑ„ÄÇ‰Ω†Â∫îËØ•ÈÄöËøáÁà∂ View ÁöÑ bounds ËÆ°ÁÆóÂæóÂà∞: 123- (void)layoutSubViews &#123; subView.center = CGPointMake(self.bounds.size.width/2,self.bounds.size.height/2);&#125; ËÆ∞Âè¶‰∏Ä‰∏™ÂÆπÊòìÁäØÁöÑÈîôËØØ ‰∏äÈù¢ÈáçÂÜô‰∫Ü layoutSubViews Ëøô‰∏™ÊñπÊ≥ïÔºåÂπ∂Ê≤°ÊúâË∞ÉÁî®Áà∂Á±ªÊñπÊ≥ï [super layoutSubViews]ÔºåÈÇ£‰πàÂà∞Â∫ïË¶Å‰∏çË¶ÅË∞ÉÁî®Âë¢ÔºüÁ≠îÊ°àÊòØÊúÄÂ•ΩË∞ÉÁî®ÔºåÂê¶ÂàôÂèØËÉΩ‰ºöÂá∫Èîô„ÄÇ‰∏ãÈù¢ÁÆÄËø∞ÂèØËÉΩ‰ºöÂá∫ÈîôÁöÑÊÉÖÂÜµ„ÄÇ ÊØîÂ¶Ç‰∏Ä‰∏™ CollectionViewCellÔºåÂÖ∂‰∏≠Êúâ‰∏ÄÂ±ÇÂõæÂ±Ç contentView„ÄÇÊàë‰ª¨Ê∑ªÂä†ÁöÑËßÜÂõæ‰∏ÄËà¨ÈÉΩÊòØÊ∑ªÂä†Âú® contentView ‰∏ä„ÄÇÂΩì cell ÁöÑ bounds ÂèëÁîüÂèòÂåñÁöÑÊó∂ÂÄôÔºåcontentView ÁöÑÂ§ßÂ∞è‰∏ç‰ºöÁ´ãÂç≥ÂèòÂåñÔºåËÄåÊòØÂú®Ë∞ÉÁî®‰∫ÜÁ≥ªÁªüÁöÑ [super layoutSubViews] ÂêéÊâç‰ºöÂ∞Ü contentView Âèò‰∏∫Âíå cell ‰∏ÄÊ†∑Â§ß„ÄÇÂ¶ÇÊûú‰Ω†‰∏çË∞ÉÁî®Áà∂Á±ªÊñπÊ≥ïÔºåÈÇ£‰πà‰Ω†Â∞±‰∏çËÉΩÂ∞Ü‰Ω†Ê∑ªÂä†ÁöÑÂ≠êËßÜÂõæÁöÑ‰ΩçÁΩÆ‰æùËµñ‰∫é contentView ÁöÑ bounds ÂÖ∂ÂÆûÂ∞±ÊòØÁ≥ªÁªü‰ºöÂú® [super layoutSubViews] ‰∏≠‰øÆÊîπÁ≥ªÁªüËá™Ë∫´Ê∑ªÂä†ÁöÑÂ≠êËßÜÂõæÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØ„ÄÇÂ¶ÇÊûú‰Ω†Ë¶ÅÁî®Âà∞Á≥ªÁªüÁöÑÂ≠êËßÜÂõæÔºå‰Ω†Â∞±ÂøÖÈ°ªË¶ÅÂÖàË∞ÉÁî® [super layoutSubViews] Ê≥®ÊÑèÔºå‰∏çÊòØÊ∑ªÂä†Â≠êËßÜÂõæ„ÄÇÂ≠êËßÜÂõæÂú® init ÊñπÊ≥ï‰∏≠Ê∑ªÂä†„ÄÇ‰∏ÄÂÆö‰∏çË¶ÅÂú® layoutSubviews ÊñπÊ≥ï‰∏≠Ê∑ªÂä†Â≠êËßÜÂõæ„ÄÇÂõ†‰∏∫ layoutSubviews ÊñπÊ≥ï‰ºöË¢´Â§öÊ¨°Ë∞ÉÁî®Ôºå‰∏çÂèØËÉΩÊØèÊ¨°Ë∞ÉÁî®ÈÉΩÊ∑ªÂä†‰∏ÄÈÅçÂ≠êËßÜÂõæÂêß„ÄÇ Âè¶Â§ñÊúÄÂ•Ω‰∏çË¶ÅÂ≠§Á´ãÂú∞ÊîπÂä®Âú® layoutSubviews ‰∏≠ËÆæÁΩÆËøáÁöÑÂ≠êËßÜÂõæÔºàÊØîÂ¶ÇÂ§ßÂ∞èÔºå‰ΩçÁΩÆÁ≠âÔºâ„ÄÇÂõ†‰∏∫ layoutSubviews ‰ºöË¢´Â§öÊ¨°Ë∞ÉÁî®„ÄÇÂú®Ë¢´Ë∞ÉÁî®ÂêéÔºåÊîπÂä®Âèà‰ºöÂèòÂõûÂéª‰∫Ü„ÄÇË¶ÅÊîπÂä®‰πüÊòØË¶ÅÂÖàÂ∞ÜË¶ÅÊîπÂä®ÁöÑÂ±ûÊÄß‰øùÂ≠òËµ∑Êù•ÔºåËÆ© layoutSuibviews Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÈÄöËøáËøô‰∏™Â±ûÊÄßËÆæÁΩÆ View„ÄÇ Ëøô‰∏™ÊñπÊ≥ïÂè™ÊòØÂú®Ë¶ÅËÆæÁΩÆÂ≠êËßÜÂõæ frame ÁöÑÊó∂ÂÄôÈáçÂÜô„ÄÇÂ¶ÇÊûú‰Ω†‰ΩøÁî®ÁöÑÊòØ autolayout Êù•ËÆæÂÆö‰ΩçÁΩÆÔºåÈÇ£‰πàÁõ¥Êé•Âú® init ‰∏≠ËÆæÁΩÆ constraints Â∞±ÂèØ‰ª•‰∫ÜÔºåÂõ†‰∏∫Ëøô‰∏™ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®Â§öÊ¨°ÔºåÂú®Ëøô‰∏™ÊñπÊ≥ïÈáåÊ∑ªÂä†Á∫¶Êùü‰ºöÂØºËá¥Á∫¶ÊùüÈáçÂ§çÊ∑ªÂä†„ÄÇ ‰ªÄ‰πàÊó∂ÂÄôÁî® autolayout ‰ªÄ‰πàÊó∂ÂÄôÁî® frame Â∞±ËßÅ‰ªÅËßÅÊô∫‰∫Ü„ÄÇ‰∏ÄËà¨Êù•ËØ¥Âè™‰∏éÁà∂ËßÜÂõæÊúâÂÖ≥ÁöÑËØùÔºåÈÇ£‰πàÂ∞±Áî® frame ËÆæÁΩÆ‰ΩçÁΩÆÔºåÂ¶ÇÊûú‰∏éÂÖÑÂºüËßÜÂõæÊúâÂÖ≥ÁöÑËØùÔºåËøòÊòØÁî® autolayout ÊïôÂ•Ω‰∏Ä‰∫õ„ÄÇ ÂêåÊ†∑ÁöÑËøòÊúâ ViewController ÁöÑ viewDidLayoutSubviews ÊñπÊ≥ïÔºåËøô‰∏™ÊñπÊ≥ï‰ºöÂú® VC ÁöÑ view Ë∞ÉÁî®ÂÖ∂ layoutSubViews ÂêéË∞ÉÁî®ÔºàÁõ∏ÂΩì‰∫éË∞ÉÁî®‰∫Ü [super layoutSubViews]Ôºâ„ÄÇÂ¶ÇÊûúË¶ÅËÆæÁΩÆ VC ‰∏≠ÁöÑËßÜÂõæÁöÑ frameÔºåÂèØ‰ª•ËÄÉËôëÂú®Ëøô‰∏™ÊñπÊ≥ïÈáåËÆæÁΩÆ„ÄÇ‰ΩÜÊòØ‰∏ÄËà¨Êàë‰ª¨ÈÉΩÊòØÂú® viewDidLoad ÊñπÊ≥ïÈáåËÆæÁΩÆÁöÑÊó†ËÆ∫ÊòØ frame ËøòÊòØ constraint„ÄÇ frame ‰øÆÊîπ AutoLayoutAutoLayout ÊúÄÂêé‰πüÊòØÂ∞ÜÁ∫¶ÊùüËÆæÁΩÆ‰∏∫Ë¶ÅÂ±ïÁ§∫ÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØ„ÄÇÊâÄ‰ª•Êàë‰ª¨‰πüÊòØÂèØ‰ª•‰ΩøÁî® frame Êù•ÊîπÂèò autolayout ‰∫ßÁîüÁöÑ‰ΩçÁΩÆÁöÑ„ÄÇ‰ΩÜÊòØ‰øÆÊîπÁöÑÊó∂Êú∫ÂæàÈáçË¶Å„ÄÇÊØîÂ¶Ç‰Ω†Âú® xib ‰∏≠ËÆæÁΩÆ‰∫ÜÁ∫¶ÊùüÔºåÁÑ∂Âêé‰Ω†ÂÜç viewDidLoad ÊñπÊ≥ï‰∏≠‰øÆÊîπ‰∫ÜÊüê‰∏™Á©∫Èó¥ÁöÑ frame ÈÇ£ÊòØÊ≤°ÊúâÁî®ÁöÑ„ÄÇÂõ†‰∏∫Ôºåautolayout ÁöÑÂ∏ÉÂ±ÄÔºåÊú¨Ë¥®‰∏äËøòÊòØ frame ÁöÑÂΩ¢Âºè„ÄÇÁ≥ªÁªü‰ºöÂú® layout subViews Êó∂Âä†ËΩΩÁ∫¶Êùü‰ø°ÊÅØÔºåÂ∞ÜÂÖ∂ËΩ¨Êç¢‰∏∫ frame„ÄÇÊâÄ‰ª•Â¶ÇÊûú‰Ω†ÊÉ≥ÊîπÂèò autolayout ÁöÑÂ∏ÉÂ±ÄÔºå‰Ω†ÈúÄË¶ÅÂú® viewDidLayoutSubviews ‰∏≠ËÆæÁΩÆ frame ÊîπÂèòÁ∫¶ÊùüÁöÑÊ≥®ÊÑè‰∫ãÈ°π‰ªª‰ΩïÂú∞ÊñπÈÉΩËÉΩÂ§üÊ∑ªÂä†‰øÆÊîπÁ∫¶ÊùüÔºàÂåÖÊã¨ init ÊñπÊ≥ïÔºâ„ÄÇ‰ΩÜÊòØ‰øÆÊîπËøáÁ∫¶ÊùüÂêéÔºåÂπ∂‰∏çËÉΩËß¶ÂèëËßÜÂõæÁöÑÊõ¥Êñ∞ÔºåÊâÄ‰ª•‰∏ÄËà¨Ë¶ÅË∞ÉÁî® layoutIfNeeded ÊñπÊ≥ïÊü•ÁúãÊõ¥Êñ∞Á∫¶ÊùüÂêéÁöÑËßÜÂõæ„ÄÇÊõ¥Êñ∞ËßÜÂõæÁöÑÂä®ÁîªÊñπÊ≥ï‰∏ÄËà¨ËÆæÁΩÆ‰∏∫Ôºö 123[UIView animateWithDuration:1.0f delay:0.0f usingSpringWithDamping:0.5f initialSpringVelocity:1 options:UIViewAnimationOptionCurveEaseInOut animations:^&#123; [self.view layoutIfNeeded];&#125; completion:NULL]; updateConstraints ÁöÑ‰ΩøÁî®Êó∂Êú∫‰∏çË¶ÅÂ∞Ü updateConstraints Áî®‰∫éËßÜÂõæÁöÑÂàùÂßãÂåñËÆæÁΩÆ„ÄÇÂΩì‰Ω†ÈúÄË¶ÅÂú®Âçï‰∏™Â∏ÉÂ±ÄÊµÅÁ®ãÔºàsingle layout passÔºâ‰∏≠Ê∑ªÂä†„ÄÅ‰øÆÊîπÊàñÂà†Èô§Â§ßÈáèÁ∫¶ÊùüÁöÑÊó∂ÂÄôÔºåÁî®ÂÆÉÊù•Ëé∑ÂæóÊúÄ‰Ω≥ÊÄßËÉΩ„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÊÄßËÉΩÈóÆÈ¢òÔºåÁõ¥Êé•Êõ¥Êñ∞Á∫¶ÊùüÊõ¥ÁÆÄÂçï„ÄÇ Â¶ÇÊûú‰∏ÄÂÆöË¶ÅÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÈÇ£‰πàÂú®Êõ¥Êñ∞Á∫¶Êùü‰πãÂâçÔºåËØ∑ÂÖàÁßªÈô§‰πãÂâçËÆæÁΩÆÁöÑÁ∫¶ÊùüÔºåÂê¶ÂàôÁ∫¶ÊùüÈáçÂ§ç‰∫Ü‰ºöÁºñËØë‰∏çËøáÁöÑ„ÄÇ ÁßªÈô§Á∫¶ÊùüÁöÑÊñπÊ≥ïÊòØÔºö[self removeConstraints:self.constraints];„ÄÇ ÂØπ‰∫éÊâãÊí∏‰∏Ä‰∏™ view Êù•ËØ¥Ôºå‰∏ÄËà¨‰∏çÁî®ÈáçÂÜô updateConstraintsÔºåÂè™ÊúâÂú®Êüê‰∫õÊÉÖÂÜµË¶ÅÂ§ßÈáè‰øÆÊîπÁ∫¶ÊùüÁöÑÊó∂ÂÄôÊâçÁî®Âà∞ÔºåËØ∑ÊääÂª∫Á´ã constraints ÁöÑÂ∑•‰ΩúÊîæÂú® init Êàñ viewDidLoad ÈöéÊÆµ„ÄÇ ÂÖ≥‰∫é drawRectdrawRect ÊñπÊ≥ïÈÄöËøá CGContextRef context = UIGraphicsGetCurrentContext(); ÊãøÂà∞‰∏ä‰∏ãÊñáÂè•ÊüÑÔºåÁÑ∂ÂêéÂ∞ÜËá™Â∑±Ë¶ÅÁîªÁöÑÂõæÂΩ¢Ê∑ªÂä†Âà∞Ëøô‰∏™‰∏ä‰∏ãÊñá‰∏ä„ÄÇÂÖ∑‰ΩìÂèØ‰ª•Âú®Ë¶ÅÁî®ÁöÑÊó∂ÂÄôÁúãÁúã‰æãÂ≠ê„ÄÇ ËÆæÁΩÆ view ÁöÑ‰∏Ä‰∫õÊ≥®ÊÑè‰∫ãÈ°π ÈáçÂÜô UIView ÁöÑ initWithFrame: ËÄå‰∏çÊòØ init ÊñπÊ≥ï„ÄÇ Âõ†‰∏∫ÂΩìÂ§ñÈÉ®Ë∞ÉÁî® init ÁöÑÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÂÖ∂ÂÜÖÈÉ®‰πü‰ºöÈªòÈªòÂú∞Ë∞ÉÁî® initWithFrameÔºöÊñπÊ≥ï„ÄÇ ‰∏çË¶ÅÂú®ÊûÑÈÄ†ÊñπÊ≥ïÈáåÈù¢Áõ¥Êé•ÂèñËá™Ë∫´(self,ÊàñËÄÖËØ¥Êú¨ËßÜÂõæ)ÁöÑÂÆΩÈ´ò,ËøôÊó∂ÂÄôÂèñÂà∞ÁöÑÂÆΩÈ´òÊòØ‰∏çÂáÜÁöÑ. ÂΩìÂú®‰ª£Á†Å‰∏≠ËÆæÁΩÆËßÜÂõæÂíåÂÆÉ‰ª¨ÁöÑÁ∫¶ÊùüÊù°‰ª∂Êó∂ÂÄôÔºå‰∏ÄÂÆöË¶ÅËÆ∞ÂæóÂ∞ÜËØ•ËßÜÂõæÁöÑ translatesAutoResizingMaskIntoConstraints Â±ûÊÄßËÆæÁΩÆ‰∏∫ NO„ÄÇÂ¶ÇÊûúÂøòËÆ∞ËÆæÁΩÆËøô‰∏™Â±ûÊÄßÂá†‰πéËÇØÂÆö‰ºöÂØºËá¥‰∏çÂèØÊª°Ë∂≥ÁöÑÁ∫¶ÊùüÊù°‰ª∂ÈîôËØØ„ÄÇ Âú® initWithFrame: ÊñπÊ≥ï‰∏≠Â∞ÜÂ≠êÊéß‰ª∂Âä†Âà∞ view ËÄå‰∏çÊòØËÆæÁΩÆÂ∞∫ÂØ∏„ÄÇÂõ†‰∏∫ view ÊúâÂèØËÉΩÊòØÈÄöËøá init ÊñπÊ≥ïÂàõÂª∫ÁöÑÔºåËøô‰∏™Êó∂ÂÄô view ÁöÑ frame ÂèØËÉΩÊòØ ‰∏çÁ°ÆÂÆöÁöÑ„ÄÇËøôÁßçÊÉÖÂÜµ‰∏ãÂêÑ‰∏™Â≠êÊéß‰ª∂ÁöÑÂ∞∫ÂØ∏ÈÉΩ‰ºöÊòØ0ÔºåÂõ†‰∏∫Ëøô‰∏™ view ÁöÑ frame ËøòÊ≤°ÊúâËÆæÁΩÆ„ÄÇËÆæÁΩÆÂ∞∫ÂØ∏ÁöÑÂ∑•‰ΩúÊîæÂú® layoutSubviews ‰∏≠ÂéªÂÅö„ÄÇ allowsGroupOpacity Â±ûÊÄßÂÖÅËÆ∏Â≠êÊéß‰ª∂ÁöÑ‰∏çÈÄèÊòéÂ∫¶ÁªßÊâø‰∫éÂÖ∂Áà∂Êéß‰ª∂ÔºåÈªòËÆ§ÊòØÂºÄÂêØÁöÑ yes„ÄÇ‰∏çËøáËøô‰ºöÂΩ±ÂìçÊÄßËÉΩÔºåËá™ÂÆö‰πâÊéß‰ª∂ÁöÑÊó∂ÂÄôÊúÄÂ•ΩËÆæÁΩÆ‰∏∫ self.layer.allowsGroupOpacity = NO; clipsToBounds ÊòØ UIView ÁöÑÂ±ûÊÄßÔºåÂ¶ÇÊûúËÆæÁΩÆ‰∏∫ yesÔºåÂàô‰∏çÊòæÁ§∫Ë∂ÖÂá∫Áà∂ View ÁöÑÈÉ®ÂàÜÔºõmasksToBounds ÊòØ CALayer ÁöÑÂ±ûÊÄßÔºåÂ¶ÇÊûúËÆæÁΩÆ‰∏∫ yesÔºåÂàô‰∏çÊòæÁ§∫Ë∂ÖÂá∫Áà∂ View layer ÁöÑÈÉ®ÂàÜ. ËÆæÁΩÆËßÜÂõæÁöÑÊó∂ÂÄô‰∏ÄÂÆöË¶ÅÂÖàËÆæÁΩÆÂ§ßÂ∞èÂÜçËÆæÁΩÆ center Ôºåcenter ÊòØ‰∏∫‰∫ÜÁ°ÆÂÆö CGRect ÁöÑÔºåÂ¶ÇÊûúÂΩìÊó∂CGRect‰∏∫0ÔºåÈÇ£‰πàÊ≠§Êó∂ËÆæÁΩÆ centerÔºåÂ∞±ÂÉèÂΩì‰∫éÁªô CGRect ËÆæÁΩÆ‰∫Ü origin„ÄÇ Áî® UIImageView Êí≠ÊîæÂä®Âõæapp ‰∏≠ÁöÑÂä†ËΩΩÁ≠âÂÄôÁªèÂ∏∏ÈúÄË¶ÅÊí≠Êîæ‰∏Ä‰∏™Âä®ÂõæÔºåÈÇ£‰πàÊÄé‰πàËÆ©ÂõæÁâáÂä®Ëµ∑Êù•Âë¢ÔºüUIImageView Â∞±ËÉΩËß£ÂÜ≥„ÄÇ ÊääÊâÄÈúÄË¶ÅÁöÑ GIF ÊâìÂåÖÂà∞‰∏Ä‰∏™Âè´ÂÅö Loading ÁöÑ Bundle ‰∏≠ÂéªÔºåÂä†ËΩΩ Bundle ‰∏≠ÁöÑÂõæÁâáÔºö 1234567891011121314151617181920212223242526272829- (NSArray *)animationImages&#123; // ÊãøÂà∞ÊâÄÊúâÊñá‰ª∂ÁöÑÊñá‰ª∂ÂêçÁöÑÊï∞ÁªÑ NSFileManager *fielM = [NSFileManager defaultManager]; NSString *path = [[NSBundle mainBundle] pathForResource:@"Loading" ofType:@"bundle"]; NSArray *arrays = [fielM contentsOfDirectoryAtPath:path error:nil]; // ÈÅçÂéÜÊñá‰ª∂ÂêçÔºåÊãøÂà∞Êñá‰ª∂ÂêçÂØπÂ∫îÁöÑ UIImage Âä†ÂÖ•Âà∞ UIImage ÁöÑÊï∞ÁªÑ‰∏≠ NSMutableArray *imagesArr = [NSMutableArray array]; for (NSString *name in arrays) &#123; UIImage *image = [UIImage imageNamed:[(@"Loading.bundle") stringByAppendingPathComponent:name]]; if (image) &#123; [imagesArr addObject:image]; &#125; &#125; return imagesArr;&#125;- (void)viewDidLoad &#123; [super viewDidLoad]; UIImageView *gifImageView = [[UIImageView alloc] initWithFrame:frame]; // Â∞Ü UIImage Êï∞ÁªÑËÆæÁΩÆÁªô UIImageView gifImageView.animationImages = [self animationImages]; //Ëé∑ÂèñGifÂõæÁâáÂàóË°® gifImageView.animationDuration = 5; //ÊâßË°å‰∏ÄÊ¨°ÂÆåÊï¥Âä®ÁîªÊâÄÈúÄÁöÑÊó∂Èïø gifImageView.animationRepeatCount = 1; //Âä®ÁîªÈáçÂ§çÊ¨°Êï∞ [gifImageView startAnimating]; [self.view addSubview:gifImageView];&#125; Ëé∑Âèñ‰∏Ä‰∏™ÊåáÂÆöÁöÑ ViewÊÉ≥Ë¶ÅËé∑Âèñ‰∏Ä‰∏™ÊåáÂÆöÁöÑ view ÁöÑÊñπÊ≥ïÊòØÈÅçÂéÜ‰∏Ä‰∏™ view ÁöÑÊâÄÊúâ subviewÔºåÁÑ∂ÂêéÂà§Êñ≠ view ÁöÑÁ±ªÂûãÊòØÂê¶ÊòØÊåáÂÆöÁöÑ„ÄÇÂú® MBProgressHUD ‰∏≠ÁöÑÊñπÂºèÊòØÔºö 123456789+ (MBProgressHUD *)HUDForView:(UIView *)view &#123; NSEnumerator *subviewsEnum = [view.subviews reverseObjectEnumerator]; for (UIView *subview in subviewsEnum) &#123; if ([subview isKindOfClass:self]) &#123; return (MBProgressHUD *)subview; &#125; &#125; return nil;&#125; Ëøô‰∏™ÊñπÊ≥ïÊòØÊâæÂà∞Âπ∂ÈöêËóèÁõ∏Â∫î hud„ÄÇËøôÈáåÈù¢‰ΩøÁî®‰∫Ü NSEnumerator Ëøô‰∏™Êûö‰∏æÁ±ªÔºåÈÄöËøá reverseObjectEnumerator ÂèçÂêëÊµèËßàÈõÜÂêà„ÄÇ Ëé∑ÂèñÂΩìÂâç ViewControllerÈÄöËøá View‰∏∫‰∫ÜÂÅöÂà∞Êï∞ÊçÆ‰∏éËßÜÂõæÁöÑÂàÜÁ¶ªÔºåÊàë‰ª¨‰∏ÄËà¨‰ºöÂ∞Ü‰∏Ä‰∏™È°µÈù¢ÁöÑÂ±ÄÈÉ®ËßÜÂõæ‰ª•Ëá™ÂÆö‰πâ UIView ÁöÑÊñπÂºèÁã¨Á´ãÂá∫Êù•ÔºåÂ¶ÇÊûúÂú®ËØ•ËßÜÂõæ‰∏≠ÊúâËß¶Âèë‰∫ã‰ª∂(‰∫ã‰ª∂Â§ÑÁêÜ‰∏çÈúÄË¶ÅÁà∂ËßÜÂõæÁöÑ‰∏ä‰∏ãÊñá)ÔºåÂ∞±‰ºöÈÅáÂà∞Âú® UIView ‰∏≠Ëé∑Âèñ UIViewController ÁöÑÊÉÖÂÜµÔºåÂèØ‰ª•ÂÜô‰∏Ä‰∏™ UIView ÁöÑËåÉÁï¥ UIView(UIViewController)Ôºö 12345678910111213#pragma mark - Ëé∑ÂèñÂΩìÂâçviewÁöÑviewcontroller+ (UIViewController *)getCurrentViewController:(UIView *) currentView &#123; for (UIView* next = [currentView superview]; next; next = next.superview) &#123; UIResponder *nextResponder = [next nextResponder]; if ([nextResponder isKindOfClass:[UIViewController class]]) &#123; return (UIViewController *)nextResponder; &#125; &#125; return nil;&#125; ÈÄöËøá rootViewController1234567891011121314151617181920212223242526- (UIViewController *)findCurrentViewController&#123; UIWindow *window = [[UIApplication sharedApplication].delegate window]; UIViewController *topViewController = [window rootViewController]; while (true) &#123; if (topViewController.presentedViewController) &#123; topViewController = topViewController.presentedViewController; &#125; else if ([topViewController isKindOfClass:[UINavigationController class]] &amp;&amp; [(UINavigationController*)topViewController topViewController]) &#123; topViewController = [(UINavigationController *)topViewController topViewController]; &#125; else if ([topViewController isKindOfClass:[UITabBarController class]]) &#123; UITabBarController *tab = (UITabBarController *)topViewController; topViewController = tab.selectedViewController; &#125; else &#123; break; &#125; &#125; return topViewController;&#125; pop Âà∞ÊåáÂÆö ViewControllerUINavigationController Êúâ‰∏™ PropertyÔºåÊòØ‰∏Ä‰∏™Â≠òÂÇ®ÊâÄÊúâ push Ëøõ navigationcontroller ÁöÑËßÜÂõæÁöÑÈõÜÂêàÔºåÊòØ‰∏Ä‰∏™Ê†àÁªìÊûÑÔºåÂΩìÊàë‰ª¨Ë¶Å POP Âà∞Êüê‰∏™ ViewController ÁöÑÊó∂ÂÄôÔºåÁõ¥Êé•Áî® for in ÂéªÈÅçÂéÜ viewControllers Âç≥ÂèØ: 12345for (UIViewController viewController in self.navigationController.viewControllers)&#123; if ([viewController isKindOfClass:[AccountManageViewController class]])&#123; [self.navigationController popToViewController:viewController animated:YES]; &#125;&#125; ‰∏Ä‰∏™ËßÑËåÉÁöÑ ViewController ÁöÑ‰ª£Á†ÅÁªìÊûÑ‰∏Ä‰∏™ ViewController ‰∏≠ÁöÑ‰ª£Á†ÅÂ¶ÇÊûú‰∏çÂàÜÁ±ªÔºåÈÇ£‰πàÊü•ÁúãËµ∑Êù•Â∞±‰ºöÈùûÂ∏∏Ê∑∑‰π±ÔºåÁªèÂ∏∏ÈúÄË¶ÅÂà∞Â§ÑË∑≥ËΩ¨„ÄÇÂõ†Ê≠§ÂÜô‰ª£Á†ÅÁöÑÊó∂ÂÄôÊåâÁÖßÈ°∫Â∫èÊù•ÂàÜÈÖç‰ª£Á†ÅÂùóÁöÑ‰ΩçÁΩÆ„ÄÇÂÖàÊòØ life cycleÔºåÁÑ∂ÂêéÊòØDelegateÊñπÊ≥ïÂÆûÁé∞ÔºåÁÑ∂ÂêéÊòØevent responseÔºåÁÑ∂ÂêéÊâçÊòØgetters and settersÔºåÁî® #pragma mark - ÂàÜÈöîÂºÄ„ÄÇËøôÊ†∑ÂêéÊù•ËÄÖÈòÖËØª‰ª£Á†ÅÊó∂Â∞±ËÉΩÁúÅÂäõÂæàÂ§ö„ÄÇ getterÂíåsetterÂÖ®ÈÉ®ÈÉΩÊîæÂú®ÊúÄÂêé Âõ†‰∏∫‰∏Ä‰∏™ViewControllerÂæàÊúâÂèØËÉΩ‰ºöÊúâÈùûÂ∏∏Â§öÁöÑviewÔºåÂ¶ÇÊûúgetterÂíåsetterÂÜôÂú®ÂâçÈù¢ÔºåÂ∞±‰ºöÊää‰∏ªË¶ÅÈÄªËæëÊâØÂà∞ÂêéÈù¢ÂéªÔºåÂÖ∂‰ªñ‰∫∫ÁúãÁöÑÊó∂ÂÄôÂ∞±Ë¶ÅÂÖàÂàíËøá‰∏ÄÈïø‰∏≤getterÂíåsetterÔºåËøôÊ†∑‰∏çÂ§™Â•Ω„ÄÇ ÊØè‰∏Ä‰∏™delegateÈÉΩÊääÂØπÂ∫îÁöÑprotocolÂêçÂ≠óÂ∏¶‰∏äÔºådelegateÊñπÊ≥ï‰∏çË¶ÅÂà∞Â§Ñ‰π±ÂÜôÔºåÂÜôÂà∞‰∏ÄÂùóÂå∫ÂüüÈáåÈù¢Âéª ÊØîÂ¶ÇUITableViewDelegateÁöÑÊñπÊ≥ïÈõÜÂ∞±ËÄÅËÄÅÂÆûÂÆûÂÜô‰∏ä#pragma mark - UITableViewDelegate„ÄÇËøôÊ†∑Êúâ‰∏™Â•ΩÂ§ÑÂ∞±ÊòØÔºåÂΩìÂÖ∂‰ªñ‰∫∫ÈòÖËØª‰∏Ä‰∏™‰ªñÂπ∂‰∏çÁÜüÊÇâÁöÑDelegateÂÆûÁé∞ÊñπÊ≥ïÊó∂Ôºå‰ªñÂè™Ë¶ÅÊåâ‰ΩècommandÁÑ∂ÂêéÂéªÁÇπËøô‰∏™protocolÂêçÂ≠óÔºåXcodeÂ∞±ËÉΩÂ§üÁ´ãÂàªË∑≥ËΩ¨Âà∞ÂØπÂ∫îËøô‰∏™DelegateÁöÑprotocolÂÆö‰πâÁöÑÈÇ£ÈÉ®ÂàÜ‰ª£Á†ÅÂéªÔºåÂ∞±ÁúÅÂæó‰ªñÂà∞Â§ÑÊâæ‰∫Ü„ÄÇ event response‰∏ìÈó®ÂºÄ‰∏Ä‰∏™‰ª£Á†ÅÂå∫Âüü ÊâÄÊúâbutton„ÄÅgestureRecognizerÁöÑÂìçÂ∫î‰∫ã‰ª∂ÈÉΩÊîæÂú®Ëøô‰∏™Âå∫ÂüüÈáåÈù¢Ôºå‰∏çË¶ÅÂà∞Â§Ñ‰π±Êîæ„ÄÇ ÂÖ≥‰∫éprivate methodsÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãViewControllerÈáåÈù¢‰∏çÂ∫îËØ•ÂÜô ‰∏çÊòØdelegateÊñπÊ≥ïÁöÑÔºå‰∏çÊòØevent responseÊñπÊ≥ïÁöÑÔºå‰∏çÊòØlife cycleÊñπÊ≥ïÁöÑÔºåÂ∞±ÊòØprivate method‰∫Ü„ÄÇÂØπÁöÑÔºåÊ≠£Â∏∏ÊÉÖÂÜµ‰∏ãViewControllerÈáåÈù¢‰∏ÄËà¨ÊòØ‰∏ç‰ºöÂ≠òÂú®private methodsÁöÑÔºåËøô‰∏™private methods‰∏ÄËà¨ÊòØÁî®‰∫éÊó•ÊúüÊç¢ÁÆó„ÄÅÂõæÁâáË£ÅÂâ™Âï•ÁöÑËøôÁßçÂ∞èÂäüËÉΩ„ÄÇËøôÁßçÂ∞èÂäüËÉΩË¶Å‰πàÊääÂÆÉÂÜôÊàê‰∏Ä‰∏™categoryÔºåË¶Å‰πàÊää‰ªñÂÅöÊàê‰∏Ä‰∏™Ê®°ÂùóÔºåÂì™ÊÄïËøô‰∏™Ê®°ÂùóÂè™Êúâ‰∏Ä‰∏™ÂáΩÊï∞‰πüË°å„ÄÇ ViewControllerÂü∫Êú¨‰∏äÊòØÂ§ßÈÉ®ÂàÜ‰∏öÂä°ÁöÑËΩΩ‰ΩìÔºåÊú¨Ë∫´‰ª£Á†ÅÂ∑≤ÁªèÁõ∏ÂΩìÂ§çÊùÇÔºåÊâÄ‰ª•Ë∑ü‰∏öÂä°ÂÖ≥ËÅî‰∏çÂ§ßÁöÑ‰∏úË•øËÉΩ‰∏çÊîæÂú®ViewControllerÈáåÈù¢Â∞±‰∏çË¶ÅÊîæ„ÄÇÂè¶Â§ñ‰∏ÄÁÇπÔºåËøô‰∏™private methodÁöÑÂäüËÉΩËøôÊó∂ÂÄôÂè™ÊòØ‰Ω†Áî®ÂæóÂà∞Ôºå‰ΩÜÊòØÂ∞ÜÊù•ËØ¥‰∏çÂÆöÂà´ÁöÑÂú∞Êñπ‰πü‰ºöÁî®Âà∞Ôºå‰∏ÄÂºÄÂßãÂ∞±Áã¨Á´ãÂá∫Êù•ÔºåÊúâÂà©‰∫éÂ∞ÜÊù•ÁöÑ‰ª£Á†ÅÂ§çÁî®„ÄÇ ‰∏Ä‰∫õÂÆè#define‰∏∫‰∏ÄÊÆµ‰ª£Á†ÅËÆæÁΩÆ‰∏Ä‰∏™Áº©ÂÜôÔºåËøôÊÆµ‰ª£Á†ÅÂèØ‰ª•ÊòØ‰∏Ä‰∏™Êï∞Â≠óÔºå‰πüÂèØ‰ª•ÊòØ‰∏Ä‰∏™ÂáΩÊï∞„ÄÇ 1#define SERVER_ONLINE_DEVELOPMENT #if DEBUGÈÄöËøá Build Configuration ËÆæÁΩÆË∞ÉËØïÁâàÊú¨ÔºåÂàÜ‰∏∫ debug Âíå release„ÄÇÊ≠£ÂºèÂèëË°åÁöÑÁâàÊú¨Âíå release ‰∏ÄËá¥Ôºà‰ΩÜÊòØÁúüÊú∫Ë∞ÉËØïÁöÑÊó∂ÂÄôËøòÊòØÁî®developËØÅ‰π¶Ôºâ„ÄÇÂèØ‰ª•‰ΩøÁî®È¢ÑËÆæÂÆèÊù•‰∏∫ÂºÄÂèëÁéØÂ¢ÉÊ∑ªÂä†‰∏Ä‰∫õÈ¢ùÂ§ñÁöÑÊìç‰ΩúÔºö 12345#if DEBUG#define HttpDefaultURL HttpFormal#else#define HttpDefaultURL HttpSimulation#endif ËøôÊ†∑Â∞±‰∏çÁî®Ëá™Â∑±ËÆæÁΩÆÁéØÂ¢É‰∫Ü„ÄÇ Â¶ÇÊûúË¶ÅËÆæÁΩÆÈùû debugÔºåÈÇ£‰πà‰ΩøÁî® #if !DEBUG #ifdefËØ•ÂÆèÂà§Êñ≠ÂêéÈù¢ÁöÑÂÆèÊòØÂê¶Ë¢´ÂÆö‰πâËøáÔºö 123#ifdef SERVER_ONLINE_DEVELOPMENT ...#endif Â¶Ç‰ΩïÂÆö‰πâ‰∏Ä‰∏™ÁªìÊûÑ‰ΩøÁî®ÁªìÊûÑ‰øùÂ≠òÂ§ö‰∏™Áõ∏ÂÖ≥Êï∞ÊçÆ„ÄÇ 1234struct Person&#123; float heightÔºõ int ageÔºõ&#125;Ôºõ ‰ΩøÁî®Ôºöstruct Person mikeyÔºõ ‰ΩøÁî® typedef ÁÆÄÂåñ„ÄÇtypedef ÂèØ‰ª•‰∏∫ÊüêÁ±ªÂûãÂ£∞Êòé‰∏Ä‰∏™Á≠â‰ª∑ÁöÑÂà´ÂêçÔºåËØ•Âà´ÂêçÁî®Ê≥ïÂíåÂ∏∏ËßÑÊï∞ÊçÆÁ±ªÂûãÊó†ÂºÇ„ÄÇ 1234typedef struct &#123; float heightÔºõ int ageÔºõ&#125; PersonÔºõ ‰ΩøÁî®ÔºåÂ∞±ÂΩìÂÅö‰∏Ä‰∏™ÊôÆÈÄöÁ±ªÂûã‰ΩøÁî®Ôºö 12Person mikeyÔºõmikey.length = 1.45 externÂíåstaticÊàë‰ª¨Áü•ÈÅìÂú® @interface...@end,@implementation...@end ‰πãÂ§ñÁöÑÊòØÂÖ®Â±ÄÂèòÈáè„ÄÇOC Êèê‰æõ‰∫Ü‰∏§‰∏™ÂÖ≥ÈîÆÂ≠ó static Âíå extern ‰øÆÈ•∞„ÄÇ staticÁî® static Â£∞ÊòéÂ±ÄÈÉ®ÂèòÈáèÔºàÂÆö‰πâÂú®ÊñπÊ≥ïÂÜÖÔºâÔºå‰ΩøÂÖ∂Âèò‰∏∫ÈùôÊÄÅÂ≠òÂÇ®ÊñπÂºè(ÈùôÊÄÅÊï∞ÊçÆÂå∫)Ôºå‰ΩúÁî®Âüü‰∏çÂèòÔºàÂÖ∂‰ªñÊñπÊ≥ï‰∏çËÉΩ‰ΩøÁî®ÔºâÔºå‰ΩÜÊòØÂª∂Èïø‰∫ÜÁîüÂëΩÂë®ÊúüÔºàÁ®ãÂ∫èÁªìÊùüÊâçÈîÄÊØÅÔºâ Áî® static Â£∞ÊòéÂ§ñÈÉ®ÂèòÈáèÔºàÂú®ÊñπÊ≥ïÂ§ñÔºâÔºå‰ΩøÂÖ∂Âè™Âú®Êú¨Êñá‰ª∂ÂÜÖÈÉ®ÊúâÊïàÔºåËÄåÂÖ∂‰ªñÊñá‰ª∂‰∏çÂèØËøûÊé•ÊàñÂºïÁî®ËØ•ÂèòÈáè„ÄÇ ÂèòÈáè12// ÊñπÊ≥ï‰∏≠ÊàñËÄÖ @implementation...@end ‰πãÂ§ñstatic int a = 789; static ÂèØ‰ª•Âú®‰ªªÊÑè‰ΩçÁΩÆÂ£∞Êòé„ÄÇ‰∏ÄËà¨Êàë‰ª¨ÈÉΩÂ∞ÜÂÖ∂Â£∞ÊòéÂú® .m Êñá‰ª∂‰∏≠„ÄÇÂèØ‰ª•Â£∞ÊòéÂú®ÊñπÊ≥ï‰∏≠ÔºåÊàñËÄÖ @implementation...@end ‰πãÂ§ñ„ÄÇ ÊñπÊ≥ï123static int method() &#123; return 1;&#125; static ÁöÑÊñπÊ≥ïÂèØ‰ª•ÊîæÂú® @implementation...@end ‰πãÂÜÖÔºå‰πüÂèØ‰ª•ÊîæÂú®‰πãÂ§ñ„ÄÇÊïàÊûúÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ externstatic ‰øÆÈ•∞ÁöÑÂÖ®Â±ÄÂèòÈáèÂè™ËÉΩÂú®ËØ•Êñá‰ª∂ÂÜÖËÆøÈóÆÔºåÈÇ£‰πàÊñá‰ª∂Â¶Ç‰ΩïËÆøÈóÆÂà´ÁöÑÊñá‰ª∂ÂÆö‰πâÁöÑÂÖ®Â±ÄÂèòÈáèÂë¢Ôºü‰ΩøÁî® extern ÂÖ≥ÈîÆÂ≠ó„ÄÇ‰ΩøÁî® extern ÊÑèÂë≥ÁùÄËØ•ÂèòÈáèÊàñËÄÖÊñπÊ≥ïÂú®Âà´Â§ÑÂÆûÁé∞„ÄÇ(‰Ω†ÂøÖÈ°ªÂÖàÁî® extern Â£∞Êòé‰∏Ä‰∏ãÔºåËøôÊòØ‰∏∫‰∫ÜÂëäËØâÁºñËØëÂô®ËøõË°åÂÖ®Â±ÄÂèòÈáèÁöÑÈìæÊé•ÔºåÂê¶ÂàôÁõ¥Êé•ÁºñËØëÁöÑÊó∂ÂÄôÂ∞±‰ºöÊä•Èîô„ÄÇ) Â¶ÇÊûúÂÖ®Â±ÄÂèòÈáèÂíåÂ±ÄÈÉ®ÂèòÈáèÈáçÂêçÔºåÂàôÂú®Â±ÄÈÉ®ÂèòÈáè‰ΩúÁî®ÂüüÂÜÖÔºåÂÖ®Â±ÄÂèòÈáèË¢´Â±èËîΩÔºå‰∏çËµ∑‰ΩúÁî®„ÄÇÁºñÁ®ãÊó∂ÂÄôÂ∞ΩÈáè‰∏ç‰ΩøÁî®ÂÖ®Â±ÄÂèòÈáè„ÄÇ ÂèòÈáè12345// ‰ªªÊÑèÁöÑÊüê‰∏Ä‰∏™ .m ÁöÑ @implementation...@end ‰πãÂ§ñNSString *s = @"global";// Ë¶ÅÁî®Âà∞ÂÖ®Â±ÄÂèòÈáèÁöÑ .h ‰∏≠extern NSString *s; Âú®‰ªªÊÑèÁöÑ‰∏Ä‰∏™ .m ‰∏≠ÂÆö‰πâ‰∏Ä‰∏™ÂÖ®Â±ÄÂèòÈáè„ÄÇÁÑ∂ÂêéË¶ÅÁî®Âà∞Ëøô‰∏™ÂÖ®Â±ÄÂèòÈáèÁöÑÂú∞Êñπ‰ΩøÁî® externÂÖ≥ÈîÆÂ≠óÂç≥ÂèØ„ÄÇÁºñËØëÁöÑÊó∂ÂÄôÂ∞±‰ºöÈìæÊé•Âà∞Ëøô‰∏™ÂÖ®Â±ÄÂèòÈáè„ÄÇ extern ÁöÑÂèòÈáèÂÜôÂú®‰ªªÊÑè‰ΩçÁΩÆÈÉΩÊòØÂèØ‰ª•ÁöÑÔºåÂåÖÊã¨ .h ÁöÑ @interface...@end ‰πãÂÜÖÊàñ‰πãÂ§ñÊàñËÄÖ.m ÁöÑ @implementation...@end ÁöÑ‰πãÂÜÖ‰πãÂ§ñ„ÄÇ‰∏çËøáÊé®ËçêÂÜôÂú® .h ÁöÑ @interface...@end ‰πãÂ§ñ„ÄÇ ÊñπÊ≥ï1234567// ‰ªªÊÑèÁöÑ .m ‰∏≠int method() &#123; return 1;&#125;// Ë¶ÅÁî®Âà∞ÁöÑÂÖ®Â±ÄÂèòÈáèÁöÑ .h ‰∏≠extern method(); ÂÖ®Â±ÄÊñπÊ≥ïÂÜôÂú® .m ÁöÑ @implementation...@end ‰πãÂÜÖËøòÊòØ‰πãÂ§ñÈÉΩË°åÔºåÂõ†‰∏∫ËøôÁßçÊñπÂºèÂÆö‰πâÁöÑÊñπÊ≥ïÂ∞±Â∑≤ÁªèË°®ÊòéÂÆÉÊòØÂÖ®Â±ÄÊñπÊ≥ï‰∫Ü„ÄÇ Ê∑ªÂä† UIGestureRecognizer ÁÇπÂáª‰∫ã‰ª∂‰∏çÂìçÂ∫î ËÆæÁΩÆ UIView ÁöÑ userInteractionEnabled Â±ûÊÄßÂÄº‰∏∫ YESÔºåÂê¶Âàô UIView ‰ºöÂøΩÁï•ÈÇ£‰∫õÂéüÊú¨Â∫îËØ•ÂèëÁîüÂú®ÂÖ∂Ëá™Ë∫´ÁöÑËØ∏Â¶Ç touch Âíå keyboard Á≠âÁî®Êà∑‰∫ã‰ª∂ÔºåÂπ∂Â∞ÜËøô‰∫õ‰∫ã‰ª∂‰ªéÊ∂àÊÅØÈòüÂàó‰∏≠ÁßªÈô§Âá∫Âéª„ÄÇ Âæ™ÁéØÂàõÂª∫ÂØπË±°ÁöÑÊó∂ÂÄôÔºå‰∏çËÉΩÂè™ÂàõÂª∫‰∏Ä‰∏™ UIGestrueRecognizerÔºåËÄåË¶ÅÂú®ÊØè‰∏™Âæ™ÁéØÈáå‰∏∫ÊØè‰∏™ UIView ÂàõÂª∫Âπ∂Ê∑ªÂä† UITapGestureRecognizer „ÄÇ Áà∂view Â§™Â∞èÔºåÂ≠êview ÈÄöËøá addSubView ÁöÑÊñπÂºèÊ∑ªÂä†Âà∞Áà∂view Â§ñÈÉ®ÔºåÂØºËá¥ÂìçÂ∫îÈìæÊó†Ê≥ï‰º†ÈÄíÂà∞Â≠ê view ‰∏≠ÔºåÊó†Ê≥ïÂìçÂ∫î UIGestureRecognizerÔºàË¢´Ëøô‰∏™ÂùëËøáÂæà‰πÖÔºâ ÂÄíËÆ°Êó∂ÊåâÈíÆÔºàÊØèÁßíËß¶ÂèëÔºâÈÄöËøá gcd ËÆæÁΩÆ‰∏Ä‰∏™ÊØèÁßíÈÉΩ‰ºöËß¶ÂèëÊâßË°åÁöÑÈòüÂàóÔºåÁÑ∂ÂêéËá™Â∑±ÊéßÂà∂Êó∂Èó¥Ôºå‰ΩïÊó∂ÈÄÄÂá∫„ÄÇ 1234567891011121314151617181920212223242526272829303132333435363738// ÂºÄÂêØÂÄíËÆ°Êó∂ÊïàÊûú-(void)openCountdown&#123; __block NSInteger time = 59; //ÂÄíËÆ°Êó∂Êó∂Èó¥ dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0); dispatch_source_t _timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, 0, 0, queue); dispatch_source_set_timer(_timer,dispatch_walltime(NULL, 0),1.0*NSEC_PER_SEC, 0); //ÊØèÁßíÊâßË°å dispatch_source_set_event_handler(_timer, ^&#123; if(time &lt;= 0)&#123; //ÂÄíËÆ°Êó∂ÁªìÊùüÔºåÂÖ≥Èó≠ dispatch_source_cancel(_timer); dispatch_async(dispatch_get_main_queue(), ^&#123; //ËÆæÁΩÆÊåâÈíÆÁöÑÊ†∑Âºè [self.authCodeBtn setTitle:@"ÈáçÊñ∞ÂèëÈÄÅ" forState:UIControlStateNormal]; [self.authCodeBtn setTitleColor:[UIColor colorFromHexCode:@"FB8557"] forState:UIControlStateNormal]; self.authCodeBtn.userInteractionEnabled = YES; &#125;); &#125;else&#123; int seconds = time % 60; dispatch_async(dispatch_get_main_queue(), ^&#123; //ËÆæÁΩÆÊåâÈíÆÊòæÁ§∫ËØªÁßíÊïàÊûú [self.authCodeBtn setTitle:[NSString stringWithFormat:@"ÈáçÊñ∞ÂèëÈÄÅ(%.2d)", seconds] forState:UIControlStateNormal]; [self.authCodeBtn setTitleColor:[UIColor colorFromHexCode:@"979797"] forState:UIControlStateNormal]; self.authCodeBtn.userInteractionEnabled = NO; &#125;); time--; &#125; &#125;); dispatch_resume(_timer);&#125; Ê≥®ÊÑèÔºö Êàë‰ª¨Âú®ÂàõÂª∫ButtonÊó∂, Ë¶ÅËÆæÁΩÆButtonÁöÑÊ†∑Âºè:ÂΩìtype‰∏∫: UIButtonTypeCustomÊó∂ , ÊòØËØªÁßíÁöÑÊïàÊûú.ÂΩìtype‰∏∫: ÂÖ∂‰ªñÊó∂, ÊòØ‰∏ÄÈó™‰∏ÄÈó™ÁöÑÊïàÊûú. Ëé∑ÂèñfloatÁöÑÂâç‰∏§‰ΩçÂ∞èÊï∞ÂΩìÊàë‰ª¨Áõ¥Êé•Êää float ËΩ¨‰∏∫ NSString ‰ºöÂèëÁé∞Â∞èÊï∞ÁÇπÂêéÊúâÂæàÂ§öÂ∞èÊï∞ÔºåÂèØ‰ª•ÊåâÁÖßÈúÄÊ±ÇÊà™ÂèñÂá†‰ΩçÂ∞èÊï∞Ôºö 1NSString *strDistance=[NSString stringWithFormat:@"%.xf", kilometers]; //xË°®Á§∫ÂÖ∑‰ΩìÊòæÁ§∫Â§öÂ∞ë‰Ωç ‚Äã]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
        <tag>ÊåÅÁª≠Êõ¥Êñ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UIAlertController ‰ΩøÁî®ÁÆÄ‰ªã]]></title>
    <url>%2F2017%2F02%2F07%2FAlertController%2F</url>
    <content type="text"><![CDATA[UIAlertController ÊòØ iOS 8 ‰∏≠Êé®Âá∫ÁöÑÊñ∞ÁâπÊÄßÔºåÁî®‰ª•‰ª£Êõø UIAlertView Âíå UIActionSheet„ÄÇ‰∏ãÈù¢Â≠¶‰π†‰∏Ä‰∏ãÂÆÉÁöÑ api ÁöÑ‰ΩøÁî®„ÄÇÂÜÖÂÆπÂæàÂü∫Á°ÄÔºåÂè™ÊòØÂΩìÂÅöÂ§áÂøò„ÄÇ UIAlertController ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Êûö‰∏æÁ±ªÂûãÁî®‰ª•Âå∫ÂàÜ UIAlertView Âíå UIActionSheetÔºö 1234typedef NS_ENUM(NSInteger, UIAlertControllerStyle) &#123; UIAlertControllerStyleActionSheet = 0, UIAlertControllerStyleAlert&#125; NS_ENUM_AVAILABLE_IOS(8_0); APIÂàó‰∏æ‰∏Ä‰∏ãÂú® UIAlertController ‰∏≠‰ΩøÁî®ÁöÑ APIÔºö 12345678//Create UIAlertController+ (instancetype)actionWithTitle:(NSString *)title style:(UIAlertActionStyle)style handler:(void (^)(UIAlertAction *action))handler;//Adding an action- (void)addAction:(UIAlertAction *)action; //Adding text filed to UIAlertController.This method is supported only for UIAlertControllerStyleAlert- (void)addTextFieldWithConfigurationHandler:(void (^)(UITextField *textField))configurationHandler; ÂàõÂª∫‰∏Ä‰∏™Âü∫Êú¨ÁöÑÂØπËØùÊ°Ü1234UIAlertController * alert= [UIAlertController alertControllerWithTitle:@"My Title" message:@"Enter User Credentials" preferredStyle:UIAlertControllerStyleAlert];[self presentViewController:alert animated:YES completion:nil]; ÂæàÂÆπÊòìÁêÜËß£ÁöÑÊñπÊ≥ïË∞ÉÁî®„ÄÇÁî±‰∫éÊòØ‰∏Ä‰∏™ ControllerÔºåÊâÄ‰ª•‰ΩøÁî® presentViewController ÊñπÊ≥ïÂ∞Ü View ÊòæÁ§∫Âá∫Êù•„ÄÇÊ≠§Êó∂ÁöÑ View ËøòÊ≤°ÊúâÁÇπÂáªÊåâÈíÆ„ÄÇ ÂàõÂª∫‰∏Ä‰∏™Â∏¶‰∏§‰∏™ÈÄâÈ°πÊåâÈíÆÁöÑÂØπËØùÊ°ÜÂú®‰∏äÈù¢ÁöÑÂü∫Á°Ä‰∏äÔºåÊ∑ªÂä† OK/Cancel ÊåâÈíÆÔºåÂπ∂ËÆæÁΩÆÁÇπÂáªÊñπÊ≥ï„ÄÇËøôÂ∞±ÈúÄË¶ÅÊàë‰ª¨ËÆæÁΩÆ‰∏Ä‰∏™ action ÔºåÁÑ∂ÂêéÊääÂÆÉÊ∑ªÂä†Âà∞ UIAlertController ‰∏≠„ÄÇËøôÈáåÂè™ÊºîÁ§∫‰∫Ü‰∏Ä‰∏ã OK ÁöÑÊÉÖÂÜµÔºåCancel ÂêåÁêÜ„ÄÇËÆ∞ÂæóÂíå‰∏äÈù¢ÂêàÂπ∂ÁöÑÊó∂ÂÄôË¶ÅÊää presentViewController:animated:completion: ÊñπÊ≥ïÂÜôÂú®ÊúÄÂêéÂïä„ÄÇ 1234567UIAlertAction* ok = [UIAlertAction actionWithTitle:@"OK" style:UIAlertActionStyleDefault handler:^(UIAlertAction * action)&#123; //Do some thing here [alert dismissViewControllerAnimated:YES completion:nil]; &#125;];[alert addAction:ok]; // add action to uialertcontroller ËøôÈáåÈù¢ÁöÑ style ÊòØ‰∏Ä‰∏™Êûö‰∏æÁ±ªÂûãÔºö 12345typedef NS_ENUM(NSInteger, UIAlertActionStyle) &#123; UIAlertActionStyleDefault = 0, UIAlertActionStyleCancel, UIAlertActionStyleDestructive &#125; NS_ENUM_AVAILABLE_IOS(8_0); Âú® AlertView ‰∏≠ÁöÑ UIAlertActionStyleCancel ÊòØÁ∫¢Ëâ≤ÔºåUIAlertActionStyleDestructive ÊòØÂä†Á≤ó„ÄÇ ÂàõÂª∫‰∏Ä‰∏™Â∏¶ textInput ÁöÑÂØπËØùÊ°Ü12345678[alert addTextFieldWithConfigurationHandler:^(UITextField *textField) &#123; textField.placeholder = @"Username";&#125;];[alert addTextFieldWithConfigurationHandler:^(UITextField *textField) &#123; textField.placeholder = @"Password"; textField.secureTextEntry = YES;&#125;]; Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™ËæìÂÖ•Ê°ÜÂíå‰∏Ä‰∏™ÂØÜÁ†ÅËæìÂÖ•Ê°Ü„ÄÇÂèØ‰ª•ËÆæÁΩÆ textField ÁöÑ‰∏Ä‰∫õÂ±ûÊÄß„ÄÇ ÂàõÂª∫‰∏Ä‰∏™ ActionSheet123456789101112131415161718UIAlertController * view= [UIAlertController alertControllerWithTitle:@"My Title" message:@"Select you Choice" preferredStyle:UIAlertControllerStyleActionSheet];UIAlertAction* ok = [UIAlertAction actionWithTitle:@"OK" style:UIAlertActionStyleDefault handler:^(UIAlertAction * action)&#123; //Do some thing here [view dismissViewControllerAnimated:YES completion:nil]; &#125;];UIAlertAction* cancel = [UIAlertAction actionWithTitle:@"Cancel" style:UIAlertActionStyleDefault handler:^(UIAlertAction * action)&#123; [view dismissViewControllerAnimated:YES completion:nil]; &#125;];[view addAction:ok];[view addAction:cancel];[self presentViewController:view animated:YES completion:nil]; ËøôÈáåÁöÑ style Â¶ÇÊûúÊòØ UIUIAlertActionStyleCancel ÈÇ£‰πàÂ∞±‰ºöËá™Âä®ÊîæÂú®ÊúÄÂ∫ï‰∏ãÔºõÂ¶ÇÊûúÊòØ UIAlertActionStyleDestructive Â∞±‰ºöÂèòÊàêÁ∫¢Ëâ≤„ÄÇ UIAlertView Âíå UIAlertController ÁöÑÂå∫Âà´ UIAlertView :iOS Á≥ªÁªü‰∏∫‰∫Ü‰øùËØÅ UIAlertView Âú®ÊâÄÊúâÁïåÈù¢‰πã‰∏äÔºåÂÆÉ‰ºö‰∏¥Êó∂ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑ UIWindowÔºåÈÄöËøáÂ∞Ü UIWindow ÁöÑ UIWindowLevel ËÆæÁΩÆÁöÑÊõ¥È´òÔºåËÆ© UIAlertView ÁõñÂú®ÊâÄÊúâÂ∫îÁî®ÁöÑÁïåÈù¢‰πã‰∏ä„ÄÇ UIAlertController:ÁªßÊâøËá™ UIViewControllerÔºåÂÆÉÈááÁî®‰∏Ä‰∏™ UIPopoverPresentationController Á±ªËøõË°åÁÆ°ÁêÜÔºåUIPopoverPresentationController ÂèàÁªßÊâøËá™ UIPresentationControllerÔºåÂÖ∂‰∏≠ÁöÑpresentingViewController Â±ûÊÄßË°®Á§∫Â±ïÁ§∫‰πãÂâçÁöÑ ControllerÔºåpresentedViewController Â±ûÊÄßË°®Á§∫Ë¢´Â±ïÁ§∫ÁöÑController„ÄÇÂè¶Â§ñËøôÁßçÊñπÂºèÔºå‰πüÁªü‰∏Ä‰∫ÜiPhoneÂíåiPadÁöÑ‰ΩøÁî®ÊñπÂºè Ëá™ÂÆö‰πâÁöÑ UIAlertControllerÂ¶ÇÊûúÁ≥ªÁªüÁöÑÊèêÁ§∫Ê°Ü‰∏çËÉΩÊª°Ë∂≥‰∏öÂä°ÈúÄÊ±ÇÔºåÂ∞±ÈúÄË¶ÅËá™ÂÆö‰πâ„ÄÇÊúÄÊñπ‰æøÁöÑÊñπÂºèËøòÊòØÂú®ÂΩìÂâçÁöÑ UIWindow ‰∏äÊ∑ªÂä†ËßÜÂõæ„ÄÇ‰∏çËøáÊàë‰ª¨ËøòÊòØ‰ª• ViewController ÁöÑÊñπÂºèÂàõÂª∫„ÄÇ ‰ΩÜÊòØÂΩì‰Ω†Êää UIViewController ÁöÑËÉåÊôØËâ≤ËÆæ‰∏∫ÈÄèÊòéÔºåÁÑ∂Âêé present ÁöÑÊó∂ÂÄôÔºå‰ºöÂèëÁé∞È°µÈù¢ÊòØÈªëËâ≤ÁöÑ„ÄÇËøôÊòØÂõ†‰∏∫ present Âá∫Êù•ÁöÑ viewController Ë°®Èù¢‰∏äÁúãËµ∑Êù•ÊòØÁõñÂú®‰∫ÜÂéüÊúâÁïåÈù¢ÁöÑ‰∏äÈù¢Ôºå‰ΩÜÈÇ£ÂÖ∂ÂÆûÂè™ÊòØ‰∏™Âä®ÁîªÔºåÊúÄÁªàÂÆûÈôÖ‰∏äÊòØÊõøÊç¢Êéâ‰∫ÜÔºåÊâÄ‰ª•ËÆæÁΩÆÈÄèÊòé‰ª•Âêé‰ºöÂØºËá¥‰∏ãÈù¢Ê≤°Êúâ‰∏úË•øÊâÄ‰ª•Â∞±ÂèòÊàêÈªëËâ≤‰∫Ü„ÄÇ Êàë‰ª¨ÈúÄË¶ÅËÆæÁΩÆ ViewController ÁöÑ modalPresentationStyle Â±ûÊÄß‰∏∫ UIModalPresentationOverCurrentContextÔºåË°®Á§∫ present Âá∫Êù•ÁöÑ ViewController ÊòØÁõñÂú®‰πãÂâçÁöÑ ViewController ‰∏äÁöÑ„ÄÇÊ≥®ÊÑèÔºå‰∏çËÉΩÂÜç viewDidload ‰∏≠ËÆæÁΩÆ, ÂøÖÈ°ªÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôËÆæÁΩÆÂ•Ω,ÁÑ∂ÂêéÂÜç presentÔºö 123MyAlertViewController *alertViewController = [MyAlertViewController alloc] init];modalPresentationStyle = UIModalPresentationOverCurrentContext;[self presentViewController: alertViewController animated: false]; ËøôÁßçÊñπÂºèÁ¶ÅÊéâ‰∫ÜÂä®ÁîªÔºåÂ¶ÇÊûúÈúÄË¶ÅËøáÊ∏°ÊïàÊûúÔºåÂèØ‰ª•Ëá™ÂÆö‰πâ ViewController ÁöÑ modal Âä®ÁîªÂÆûÁé∞„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Âü∫Êú¨Êéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂØåÊñáÊú¨AttributedString ‰ΩøÁî®Â∞èÁªì]]></title>
    <url>%2F2017%2F02%2F07%2F%E5%AF%8C%E6%96%87%E6%9C%AC%2F</url>
    <content type="text"><![CDATA[ÊöÇÊó∂Ê≤°ÊúâÈúÄË¶ÅÊ∑±ÂÖ•Â∫îÁî®Â∞±‰∏çÁªÜÂÜô‰∫Ü AttributedStringÂèØ‰ª•ÂàÜ‰∏∫ NSAttributedString Âíå NSMutableAttributedString ‰∏§Áßç„ÄÇÂú®‰ΩøÁî®‰∏≠ÈÄöËøáÂ∞Ü AttributedString ËµãÂÄºÁªôÊéß‰ª∂ÁöÑ attributedText Â±ûÊÄßÊù•Ê∑ªÂä†ÊñáÂ≠óÊ†∑Âºè„ÄÇÊúâÂ±ûÊÄßÁöÑÊéß‰ª∂Êúâ UILabel„ÄÅUITextField Âíå UITextView„ÄÇ ‰ΩøÁî®ÊñπÂºèÊñπÂºè‰∏ÄÂàùÂßãÂåñ‰∏Ä‰∏™ NSMutableAttributedStringÔºåÁÑ∂ÂêéÂêëÈáåÈù¢Ê∑ªÂä†ÊñáÂ≠óÊ†∑ÂºèÔºåÂ∞ÜÂÖ∂ËµãÁªôÊéß‰ª∂ÁöÑ attributedText Â±ûÊÄß„ÄÇ ‰æãÂ≠êÔºö 12345678910111213141516171819202122NSString *str = @"‰∫∫ÁîüËã•Âè™Â¶ÇÂàùËßÅÔºå‰Ωï‰∫ãÊÇ≤È£éÁßãÁîªÊâá„ÄÇ\nÁ≠âÈó≤ÂèòÂç¥ÊïÖ‰∫∫ÂøÉÔºåÂç¥ÈÅìÊïÖ‰∫∫ÂøÉÊòìÂèò„ÄÇ\nÈ™äÂ±±ËØ≠ÁΩ¢Ê∏ÖÂÆµÂçäÔºåÊ≥™Èõ®ÈúñÈìÉÁªà‰∏çÊÄ®„ÄÇ\n‰ΩïÂ¶ÇËñÑÂπ∏Èî¶Ë°£ÈÉéÔºåÊØîÁøºËøûÊûùÂΩìÊó•ÊÑø„ÄÇ";//ÂàõÂª∫NSMutableAttributedStringNSMutableAttributedString *attrStr = [[NSMutableAttributedString alloc]initWithString:str];//ËÆæÁΩÆÂ≠ó‰ΩìÂíåËÆæÁΩÆÂ≠ó‰ΩìÁöÑËåÉÂõ¥[attrStr addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:30.0f] range:NSMakeRange(0, 3)];//Ê∑ªÂä†ÊñáÂ≠óÈ¢úËâ≤[attrStr addAttribute:NSForegroundColorAttributeName value:[UIColor redColor] range:NSMakeRange(17, 7)];//Ê∑ªÂä†ÊñáÂ≠óËÉåÊôØÈ¢úËâ≤[attrStr addAttribute:NSBackgroundColorAttributeName value:[UIColor orangeColor] range:NSMakeRange(17, 7)];//Ê∑ªÂä†‰∏ãÂàíÁ∫ø[attrStr addAttribute:NSUnderlineStyleAttributeName value:[NSNumber numberWithInteger:NSUnderlineStyleSingle] range:NSMakeRange(8, 7)];UILabel *label = [[UILabel alloc]initWithFrame:CGRectMake(60, 100, 200, 0)];label.backgroundColor = [UIColor greenColor];//Ëá™Âä®Êç¢Ë°ålabel.numberOfLines = 0;//ËÆæÁΩÆlabelÁöÑÂØåÊñáÊú¨label.attributedText = attrStr;//labelÈ´òÂ∫¶Ëá™ÈÄÇÂ∫î[label sizeToFit];[self.view addSubview:label]; ÊñπÂºè‰∫åÂàõÂª∫Â±ûÊÄßÂ≠óÂÖ∏ÔºåÂπ∂Â∞ÜÂêÑÁßçÂ±ûÊÄßÂàùÂßãÂåñ„ÄÇËµãÂÄºÔºåÂπ∂Âà©Áî®ÊñπÊ≥ï appendAttributedString: Ê∑ªÂä†ÂÖ• NSMutableAttributedStringÔºåÂ∞ÜÂÖ∂ËµãÁªôÊéß‰ª∂ÁöÑ attributedText Â±ûÊÄß„ÄÇ ‰æãÂ≠êÔºö 1234NSString *str51 = @"\nËÆæÁΩÆÂà†Èô§Á∫ø‰∏∫ÁªÜÂçïÂÆûÁ∫ø,È¢úËâ≤‰∏∫Á∫¢Ëâ≤";NSDictionary *dictAttr51 = @&#123;NSStrikethroughStyleAttributeName:@(NSUnderlineStyleSingle),NSStrikethroughColorAttributeName:[UIColor redColor]&#125;;NSAttributedString *attr51 = [[NSAttributedString alloc]initWithString:str51 attributes:dictAttr51];[attributedString appendAttributedString:attr51]; ÂØåÊñáÊú¨ÊúâËÆ∏Â§öÂèØ‰ª•ËÆæÁΩÆÁöÑÂ±ûÊÄßÔºåÊàëÂ∞±‰∏ç‰∏Ä‰∏ÄÂàó‰∏æ‰∫Ü„ÄÇÂ¶ÇÊûúÁî®Âà∞ÂÜç google Â∞±ÂèØ‰ª•‰∫Ü„ÄÇËá≥‰∫éÂõæÊñáÊ∑∑Êéí‰πãÁ±ªÁöÑ‰πüÊòØÁî®Âà∞ÂÜçËØ¥Âêß„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[FDFullScreenPopGesture Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2017%2F02%2F06%2FFDFullScreenPopGesture_%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%2F</url>
    <content type="text"><![CDATA[FDFullScreenPopGesture ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Â∞èÂ∑ßÁ≤æÊÇçÔºåÂç¥ÂèàÂäüËÉΩÂº∫Â§ßÁöÑÂºÄÊ∫êÈ°πÁõÆ„ÄÇ‰∏ªË¶ÅÁöÑÂäüËÉΩÊúâÔºöÂÖ®Â±ÄÁöÑÊâãÂäøÂõûÈÄÄÔºõÈÉ®ÂàÜÁïåÈù¢ÁöÑ NavigationBar ÁöÑÈöêËóè„ÄÇ‰ªäÂ§©Ëä±‰∫ÜÂçäÂ§©ÁöÑÊó∂Èó¥ÊêûÊòéÁôΩ‰∫ÜÂÖ∂‰∏≠ÁöÑÂéüÁêÜ„ÄÇ iOS ÂéüÁîüÁöÑËøîÂõûÊâãÂäøÁöÑËµ∑ÂßãÊªëÂä®ÁÇπÂøÖÈ°ªÈù†ËøëÂ±èÂπïÁöÑÂ∑¶ÊñπÔºåÊó†Ê≥ïÂÆûÁé∞ÂÖ®Â±èËøîÂõû„ÄÇÊàë‰ª¨ÂèØ‰ª•ÁªôÊéßÂà∂Âô®ÁöÑ view Ê∑ªÂä†ÊâãÂäøÊù•ÊéßÂà∂ÂÆÉÁöÑ frame„ÄÇ‰ΩÜÊòØÈÇ£Ê†∑ÈúÄË¶ÅËá™Â∑±ÊéßÂà∂Âä®ÁîªÔºåËá™Â∑±ÊéßÂà∂ NavigationBar ÔºåÈùûÂ∏∏È∫ªÁÉ¶„ÄÇFDFullScreenPopGesture ÈÄöËøá‰∏ÄÁßç‰ºòÈõÖÁöÑÊñπÂºèËß£ÂÜ≥‰∫ÜËøô‰∏™ÈóÆÈ¢ò„ÄÇÂπ∂‰∏îÈ°∫Â∏¶ÂÆûÁé∞‰∫ÜÈÉ®ÂàÜÊéßÂà∂Âô®ÈöêËóè NavigationBar ÁöÑÂäüËÉΩ„ÄÇ ÊÄª‰ΩìËß£ÊûÑÊï¥‰∏™ FDFullScreenPopGesture ÊÄªÂÖ±ÂàÜ‰∏∫Âõõ‰∏™ÈÉ®ÂàÜÔºö _FDFullscreenPopGestureRecognizerDelegate UIViewController (FDFullscreenPopGesturePrivate) UIViewController (FDFullscreenPopGesture) UINavigationController (FDFullscreenPopGesture) _FDFullscreenPopGestureRecognizerDelegateËøô‰∏™Á±ªÂè™Êúâ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂ∞±ÊòØÂÆûÁé∞‰∫Ü UIGestureRecognizerDelegate ÁöÑ‰ª£ÁêÜÊñπÊ≥ï gestureRecognizerShouldBegin:„ÄÇÁî®Êù•ÊéßÂà∂ÊòØÂê¶ÂºÄÂßãÊâãÂäøÊìç‰Ωú„ÄÇ 123456789101112131415161718192021222324252627282930313233- (BOOL)gestureRecognizerShouldBegin:(UIPanGestureRecognizer *)gestureRecognizer&#123; // Ignore when no view controller is pushed into the navigation stack. if (self.navigationController.viewControllers.count &lt;= 1) &#123; return NO; &#125; // Ignore when the active view controller doesn't allow interactive pop. UIViewController *topViewController = self.navigationController.viewControllers.lastObject; if (topViewController.fd_interactivePopDisabled) &#123; return NO; &#125; // Ignore when the beginning location is beyond max allowed initial distance to left edge. CGPoint beginningLocation = [gestureRecognizer locationInView:gestureRecognizer.view]; CGFloat maxAllowedInitialDistance = topViewController.fd_interactivePopMaxAllowedInitialDistanceToLeftEdge; if (maxAllowedInitialDistance &gt; 0 &amp;&amp; beginningLocation.x &gt; maxAllowedInitialDistance) &#123; return NO; &#125; // Ignore pan gesture when the navigation controller is currently in transition. if ([[self.navigationController valueForKey:@"_isTransitioning"] boolValue]) &#123; return NO; &#125; // Prevent calling the handler when the gesture begins in an opposite direction. CGPoint translation = [gestureRecognizer translationInView:gestureRecognizer.view]; if (translation.x &lt;= 0) &#123; return NO; &#125; return YES;&#125; ÊÄªÂÖ±Âú®5‰∏≠ÊÉÖÂÜµ‰∏ãÔºå‰∏çËÉΩÂÖ®Â±èÂπïËøîÂõûÔºö Êï¥ÂÑø NavigationController ‰∏≠Âè™Êúâ‰∏Ä‰∏™ ViewController ÁöÑÊó∂ÂÄô ÂΩìÂâçÁöÑ ViewController Á¶ÅÁî®‰∫Ü fd_interactivePopDisabledÔºàËøô‰∏™Âú® UINavigationController (FDFullscreenPopGesture) ‰∏≠ËÆæÁΩÆÁöÑÔºâ ÂΩìÂâçÊâãÂäøÁöÑÂêØÂä®ÁÇπË∑ùÁ¶ªÂ∑¶ËæπÁºòËøúËøá‰∫Ü fd_interactivePopMaxAllowedInitialDistanceToLeftEdgeÔºàÂêå‰∏äÔºå‰πüÊòØËá™Â∑±ËÆæÁΩÆÁöÑÔºâ ÂΩìÂâçÊòØÂê¶Âú®ËΩ¨Âú∫ËøáÁ®ã‰∏≠„ÄÇËøôÈáåÈÄöËøá KVC ÊãøÂà∞‰∫Ü NavigationController ‰∏≠ÁöÑ _isTransitioning Â±ûÊÄß ÊâãÂäøËøêÂä®ÊñπÂêëÊòØÂê¶ÊòØ‰ªéÂè≥ÂæÄÂ∑¶ UIViewController (FDFullscreenPopGesturePrivate)Â¶ÇÊûú‰Ω†ÂØπ runtime ÊØîËæÉÁÜüÊÇâÔºåÈÇ£‰πàÁúãÂà∞Ëøô‰∏™Á±ª‰∏ÄÂÆöÈùûÂ∏∏‰∫≤Âàá„ÄÇËøô‰∏™ÊñπÊ≥ïÂú® load ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÈÄöËøá Method Swizzling Áî® fd_viewWillAppear: ÊñπÊ≥ïÔºåÊõøÊç¢‰∫ÜÂéüÊù•ÁöÑ viewWillAppear: ÊñπÊ≥ï„ÄÇ 123456789- (void)fd_viewWillAppear:(BOOL)animated&#123; // Forward to primary implementation. [self fd_viewWillAppear:animated]; if (self.fd_willAppearInjectBlock) &#123; self.fd_willAppearInjectBlock(self, animated); &#125;&#125; Ëøô‰∏™ÊõøÊç¢ÁöÑÊñπÊ≥ïÊ≤°‰ªÄ‰πàÁâπÂà´ÁöÑÔºåÂ∞±ÊòØÂú®ÂÖ∂‰∏≠ÊèíÂÖ•‰∫ÜËá™Â∑±ÁöÑÂõûË∞ÉÂùó fd_willAppearInjectBlock ÔºåËØ•ÂùóÂú® UINavigationController (FDFullscreenPopGesture) ‰∏≠ÂÆö‰πâÂπ∂ËÆæÁΩÆ„ÄÇËØ•ÂùóÁî®Êù•ËÆæÁΩÆ NavigationBar ÁöÑÊòæÁ§∫‰∏éÈöêËóè„ÄÇ UIViewController (FDFullscreenPopGesture)Ëøô‰∏™Á±ª‰∏≠ÂÆö‰πâ‰∫Ü3‰∏™Â±ûÊÄßÔºå‰∏äÈù¢Áî®Âà∞‰∫Ü‰∏§‰∏™ fd_interactivePopDisabledÔºåfd_interactivePopMaxAllowedInitialDistanceToLeftEdge ËøòÊúâ‰∏Ä‰∏™ fd_prefersNavigationBarHidden Â±ûÊÄßÁî®‰∫éÂà§Êñ≠ÊòØÂê¶ÈöêËóè NavigationBar ‰∏äÈù¢ÁöÑ fd_willAppearInjectBlock ‰∏≠Áî®Âà∞„ÄÇ 12345678910111213141516@interface UIViewController (FDFullscreenPopGesture)/// Whether the interactive pop gesture is disabled when contained in a navigation/// stack.@property (nonatomic, assign) BOOL fd_interactivePopDisabled;/// Indicate this view controller prefers its navigation bar hidden or not,/// checked when view controller based navigation bar's appearance is enabled./// Default to NO, bars are more likely to show.@property (nonatomic, assign) BOOL fd_prefersNavigationBarHidden;/// Max allowed initial distance to left edge when you begin the interactive pop/// gesture. 0 by default, which means it will ignore this limit.@property (nonatomic, assign) CGFloat fd_interactivePopMaxAllowedInitialDistanceToLeftEdge;@end UINavigationController (FDFullscreenPopGesture)Ëøô‰∏™ÊñπÊ≥ïÊòØÊï¥‰∏™È°πÁõÆÁöÑÈÄªËæëÁöÑÊ†∏ÂøÉÔºåÈ¶ñÂÖàËøòÊòØÂú® load ÊñπÊ≥ï‰∏≠Áî® fd_pushViewController:animated: ÊñπÊ≥ïÊõøÊç¢‰∫ÜÁ≥ªÁªüËá™Ë∫´ÁöÑ pushViewController:animated: ÊñπÊ≥ï„ÄÇËØ•ÊñπÊ≥ïÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526- (void)fd_pushViewController:(UIViewController *)viewController animated:(BOOL)animated&#123; if (![self.interactivePopGestureRecognizer.view.gestureRecognizers containsObject:self.fd_fullscreenPopGestureRecognizer]) &#123; // 1. [self.interactivePopGestureRecognizer.view addGestureRecognizer:self.fd_fullscreenPopGestureRecognizer]; // 2. NSArray *internalTargets = [self.interactivePopGestureRecognizer valueForKey:@"targets"]; id internalTarget = [internalTargets.firstObject valueForKey:@"target"]; SEL internalAction = NSSelectorFromString(@"handleNavigationTransition:"); self.fd_fullscreenPopGestureRecognizer.delegate = self.fd_popGestureRecognizerDelegate; [self.fd_fullscreenPopGestureRecognizer addTarget:internalTarget action:internalAction]; // 3. self.interactivePopGestureRecognizer.enabled = NO; &#125; // 4. [self fd_setupViewControllerBasedNavigationBarAppearanceIfNeeded:viewController]; // Forward to primary implementation. if (![self.viewControllers containsObject:viewController]) &#123; [self fd_pushViewController:viewController animated:animated]; &#125;&#125; ÂÖàÁúãÁ¨¨‰∏ÄÊ≠•ÔºåÂú® interactivePopGestureRecognizer ÁöÑ view ‰∏äÊ∑ªÂä†‰∏Ä‰∏™ UIPanGestureRecognizer„ÄÇËøô‰∏™ interactivePopGestureRecognizer ÊòØ‰ªÄ‰πàÂë¢Ôºü ËøôÊòØÊéßÂà∂ÁïåÈù¢Âú®ËæπÁºòÂ§ÑÊªëÂä®ËøîÂõûÁöÑÊâãÂäø„ÄÇËøôÊòØ‰∏Ä‰∏™Âè™ËØªÁöÑÂ±ûÊÄßÔºåÊàë‰ª¨ÂΩìÁÑ∂‰∏çËÉΩÁõ¥Êé•ËÆæÁΩÆÂÆÉÔºåÊãøÂà∞ÂÆÉÊòØ‰∏∫‰∫ÜÈÄöËøáÂÆÉÊãøÂà∞ËØ•ÊâãÂäøÊâÄÂú®ÁöÑ viewÔºåÂú® view ‰∏≠‰øùÂ≠ò‰∫Ü‰∏Ä‰∏™ _gestureRecognizers ÁöÑÊï∞ÁªÑ„ÄÇËØïÊÉ≥‰∏Ä‰∏ãÔºåÂ¶Ç‰ΩïÂà§Êñ≠ÊòØÂê¶ÈúÄË¶Å pop Âë¢ÔºüÂ∞±ÊòØÈÄöËøáÊãøÂà∞ view ‰∏≠ÁöÑ _gestureRecognizers ÔºåÂÜçË∞ÉÁî®ÊØè‰∏™ÊâãÂäøÁöÑ UIGestureRecognizerDelegate ‰∏≠ÁöÑ gestureRecognizerShouldBeginÊñπÊ≥ïÊòØÂê¶ËøîÂõûyes„ÄÇËøôÈáåËãπÊûú‰πãÊâÄ‰ª•Êää_gestureRecognizers` ËÆæÁΩÆ‰∏∫Êï∞ÁªÑÔºåÂèØËÉΩÊòØ‰∏∫‰∫Ü‰ª•ÂêéÊõ¥ÊòìÊãìÂ±ïÂêß„ÄÇÂΩìÁÑ∂ÔºåËøô‰πüÊñπ‰æø‰∫ÜÊàë‰ª¨ÁöÑÊãìÂ±ï„ÄÇ Á¨¨‰∫åÊ≠•Â∞ÜËá™Â∑±Ê∑ªÂä†ÁöÑÊâãÂäøËÆæÁΩÆÊàê‰∏éÂéüÁîüÊâãÂäøÁõ∏ÂêåÔºåÂåÖÊã¨‰∏Ä‰∏™ target Âíå‰∏Ä‰∏™ actionÔºåËøôÊ†∑‰∏§‰∏™ÊâãÂäøÁöÑÂä®Áîª‰ª•ÂèäËß¶ÂèëÊñπÊ≥ïÂ∞±‰∏ÄÊ®°‰∏ÄÊ†∑‰∫Ü„ÄÇ Á¨¨‰∏âÊ≠•Â∞ÜÂéüÊù•ÁöÑÊâãÂäøÁ¶ÅÁî®„ÄÇ Á¨¨ÂõõÊ≠•ËÆæÁΩÆ‰∏äÈù¢ËØ¥ËøáÁöÑ _FDViewControllerWillAppearInjectBlock „ÄÇ‰πüÂ∞±ÊòØÈÄöËøá fd_prefersNavigationBarHidden Êù•ÊòæÁ§∫ÂíåÈöêËóè NavigationBar„ÄÇ ÊÄªÁªì‰∏ªË¶ÅÂ§ç‰π†‰∫Ü‰∏Ä‰∏ã method swizzling ÁöÑ‰ΩøÁî®ÔºåÂèØ‰ª•Âæà‰ºòÈõÖÂú∞‰øÆÊîπÁâπÂÆöÁöÑÊñπÊ≥ï„ÄÇ Âè¶Â§ñÔºåËôΩÁÑ∂ËãπÊûúÊ≤°ÂºÄÊ∫êÔºå‰ΩÜËøòÊòØÈÄöËøáËé∑ÂèñÂà∞‰∫ÜÁ≥ªÁªüÁ±ª‰∏≠ÁöÑÁßÅÊúâÊñπÊ≥ï„ÄÇËøôÁªôÊàë‰ª¨Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÊÄùË∑Ø„ÄÇÊàë‰ª¨‰πüÂèØ‰ª•ÈÄöËøáË∞ÉËØïÔºåÊù•Êü•ÁúãÂêÑ‰∏™ÈöêËóèÁöÑÂèòÈáè„ÄÇ‰∏çËøáÊúâ‰∏ÄÁÇπË¶ÅÂ∞èÂøÉÔºöÁ≥ªÁªüÁ±ªÂÜÖÂÆö‰πâÁöÑ‰∏Ä‰∫õ property Âè™ÊòØÂÆö‰πâÂêåÂêçÁöÑ get set ÊñπÊ≥ïÔºå‰ΩÜÊòØÂÆûÈôÖÂ≠òÂÇ®ÁöÑÂèòÈáèÂêçÂπ∂‰∏çÂíå property ÂêçÁõ∏ÂêåÔºåÂèòÈáèÂ≠òÂÇ®ÁöÑ‰ΩçÁΩÆ‰πü‰∏çËÉΩÂÆåÂÖ®Á°ÆÂÆö„ÄÇÊØîÂ¶Ç‰∏äÈù¢ UINavigationController ÁöÑ interactivePopGestureRecognizer Â±ûÊÄßÔºåË¢´‰øùÂ≠òÂú® UINavigationController ‰∏≠ÁöÑ __cachedInteractionController ‰πã‰∏ãÔºåÂêç‰∏∫ _edgePanRecognizerÔºåÂ¶ÇÊûúËá™Â∑±ÊâæËµ∑Êù•ÁöÑËØùÔºåÁúüÁöÑÂõ∞Èöæ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS ÁöÑÂêÑÁßçÂÆöÊó∂Âô®]]></title>
    <url>%2F2017%2F02%2F03%2FiOS%E5%AE%9A%E6%97%B6%E5%99%A8%2F</url>
    <content type="text"><![CDATA[ËøôÁØáÂ∞ÜÊé¢Á©∂‰∏Ä‰∏ã iOS ‰∏äÁöÑÂõõÁßçÂÆöÊó∂Âô®ÁöÑÂÆûÁé∞ NSTimer‰∏Ä‰∏™ NSTimer Ê≥®ÂÜåÂà∞ RunLoop ÂêéÔºåRunLoop ‰ºö‰∏∫ÂÖ∂ÈáçÂ§çÁöÑÊó∂Èó¥ÁÇπÊ≥®ÂÜåÂ•Ω‰∫ã‰ª∂„ÄÇ‰æãÂ¶Ç 10:00, 10:10, 10:20 ËøôÂá†‰∏™Êó∂Èó¥ÁÇπ„ÄÇRunLoop ‰∏∫‰∫ÜËäÇÁúÅËµÑÊ∫êÔºåÂπ∂‰∏ç‰ºöÂú®ÈùûÂ∏∏ÂáÜÁ°ÆÁöÑÊó∂Èó¥ÁÇπÂõûË∞ÉËøô‰∏™ Timer„ÄÇTimer Êúâ‰∏™Â±ûÊÄßÂè´ÂÅö Tolerance (ÂÆΩÂÆπÂ∫¶)ÔºåÊ†áÁ§∫‰∫ÜÂΩìÊó∂Èó¥ÁÇπÂà∞ÂêéÔºåÂÆπËÆ∏ÊúâÂ§öÂ∞ëÊúÄÂ§ßËØØÂ∑Æ„ÄÇ ÂàõÂª∫Êúâ‰∏§ÁßçÂàõÂª∫ÊñπÂºèÔºåÊñπÊ≥ï‰∏ÄÔºö 12345self.timer = [NSTimer timerWithTimeInterval:5 target:self selector:@selector(showTime) userInfo:nil repeats:YES];// ÂøÖÈ°ªÂä†[[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSRunLoopCommonModes];// Â¶ÇÊûúÊòØÈùû‰∏ªÁ∫øÁ®ãË¶ÅË∞ÉÁî®,‰∏ªÁ∫øÁ®ãÂ∑≤ÁªèËá™Âä®ËøêË°å runloop Â∞±‰∏çÈúÄË¶ÅËá™Â∑± run ‰∫Ü[[NSRunLoop currentRunLoop] run]; Ëøô‰∏™Á±ªÊñπÊ≥ïÂàõÂª∫Âá∫Êù•ÁöÑÂØπË±°Â¶ÇÊûú‰∏çÁî® addTimer: forMode ÊñπÊ≥ïÊâãÂä®Âä†ÂÖ•Âæ™ÁéØÊ±†‰∏≠ÔºåÂ∞Ü‰∏ç‰ºöÂæ™ÁéØÊâßË°å„ÄÇ ËøôÈáåÂ¶ÇÊûú‰∏çÊòØÁî®ÁöÑ NSRunLoopCommonModes ËÄåÊòØ NSDefaultRunLoopMode ÈÇ£‰πàÂΩìÁïåÈù¢ÊªëÂä®Êó∂ÔºåÊó†Ê≥ïÊâßË°å showTime ÊñπÊ≥ïÂõûË∞É„ÄÇÂΩìÊªëÂä®ÂÅúÊ≠¢Êó∂ÔºåÁ´ãÂàªÊâßË°åÊúÄÂàùÁöÑÊ≥®ÂÜåÁöÑÂÆöÊó∂‰∫ã‰ª∂Ôºå‰πãÂêéÁî±‰∫éÊªëÂä®ÂØºËá¥Êú™ËÉΩÊ≥®ÂÜåÁöÑ‰∫ã‰ª∂ÁöÑÂõûË∞É‰∏ÄÂæãÂøΩÁï•„ÄÇ ÊñπÊ≥ï‰∫åÔºö 123456self.timer = [NSTimer scheduledTimerWithTimeInterval:3.0 target:self selector:@selector(run:) userInfo:@"abc" repeats:NO];// ‰∏ãÈù¢Ëøô‰∏§Âè•Áî®Êù•‰øÆÊîπÊ®°ÂºèÔºåÂ¶ÇÊûú‰∏çÊÉ≥‰øÆÊîπÈªòËÆ§Ê®°ÂºèÔºåÂèØ‰ª•‰∏çÂä†[[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSRunLoopCommonModes];// Â¶ÇÊûúÊòØÈùû‰∏ªÁ∫øÁ®ãË¶ÅË∞ÉÁî®,‰∏ªÁ∫øÁ®ãÂ∑≤ÁªèËá™Âä®ËøêË°å runloop Â∞±‰∏çÈúÄË¶ÅËá™Â∑± run ‰∫Ü[[NSRunLoop currentRunLoop] run]; Ëøô‰∏™ÊñπÊ≥ï‰ºöÂ∞ÜÂÆöÊó∂Âô®Ê∑ªÂä†Âà∞ÂΩìÂâçÁöÑËøêË°åÂæ™ÁéØÔºåËøêË°åÂæ™ÁéØÁöÑÊ®°Âºè‰∏∫ÈªòËÆ§Ê®°Âºè„ÄÇËôΩÁÑ∂ÊåáÂÆö‰∫ÜÈªòËÆ§Ê®°ÂºèÔºå‰ΩÜÊòØËøòÊòØÂÖÅËÆ∏‰Ω†‰øÆÊîπÊ®°ÂºèÁöÑ„ÄÇ Âíå CADisplayLink ‰∏ÄÊ†∑ÔºåNSTimer ‰πüÈúÄË¶ÅÊâãÂä®ÂèñÊ∂àÂÆöÊó∂Âô®Ôºö 123//ÂèñÊ∂àÂÆöÊó∂Âô® [self.timer invalidate]; self.timer = nil; NSRunLoop ‰ºöÂº∫ÂºïÁî® NSTimerÔºåÊâÄ‰ª•Â§ñÈÉ®‰∏çÈúÄË¶ÅÂº∫ÂºïÁî® timer„ÄÇ ÊâßË°åNÊ¨°ÂêéÁªìÊùüÂèØ‰ª•Âú®Â§ñÈÉ®ÂàõÂª∫‰∏Ä‰∏™ËÆ°Êï∞Âô®ÔºåÂΩìÊâßË°åÂà∞‰∏ÄÂÆöÊ¨°Êï∞ÂêéÂú®ÂÜÖÈÉ®ÁªìÊùüÔºö 123456789var runCount = 0Timer.scheduledTimer(withTimeInterval: 1.0, repeats: true) &#123; timer in print("Timer fired!") runCount += 1 if runCount == 3 &#123; timer.invalidate() &#125;&#125; ÈôÑÂä† contextÂàõÂª∫ timer Êó∂‰º†ÂÖ•ÁöÑ userInfo ÊòØ‰∏Ä‰∏™ id Á±ªÂûã„ÄÇÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ÈÄöËøá timer ÊãøÂà∞ userInfo ‰ª£Ë°®ÁöÑÂÄºÔºåÈúÄË¶ÅÂº∫ËΩ¨Á±ªÂûãÔºö 123456789101112131415let context = ["user": "@twostraws"]Timer.scheduledTimer(timeInterval: 1.0, target: self, selector: #selector(fireTimer), userInfo: context, repeats: true)@objc func fireTimer(timer: Timer) &#123; guard let context = timer.userInfo as? [String: String] else &#123; return &#125; let user = context["user", default: "Anonymous"] print("Timer fired by \(user)!") runCount += 1 if runCount == 3 &#123; timer.invalidate() &#125;&#125; NSTimer ‰∏çÂáÜÊó∂NSTimer ÊòØÁî± RunLoop ÊéßÂà∂ÊâßË°åÁöÑÔºåÂΩìÂà∞ËææÊó∂Èó¥ÂêéÔºå‰ºöËß¶ÂèëÁù°Áú†ÁöÑ RunLoop ÊâßË°åÂÆöÊó∂Âô®ÊñπÊ≥ï„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÂΩìÂâç RunLoop ‰∏ÄÁõ¥Âú®ËøêË°åÔºåÂàôÊó†Ê≥ïÁ´ãÂàªÊâßË°åÂÆöÊó∂Âô®ÊñπÊ≥ïÔºåÂØºËá¥Âª∂Êó∂ÊâßË°å„ÄÇ CADisplayLinkÂü∫Êú¨Áî®Ê≥ïCADisplayLink ÊòØ‰∏Ä‰∏™ËÉΩËÆ©Êàë‰ª¨‰ª•ÂíåÂ±èÂπïÂà∑Êñ∞ÁéáÂêåÊ≠•ÁöÑÈ¢ëÁéáÂ∞ÜÁâπÂÆöÁöÑÂÜÖÂÆπÁîªÂà∞Â±èÂπï‰∏äÁöÑÂÆöÊó∂Âô®Á±ª„ÄÇCADisplayLink ‰ª•ÁâπÂÆöÊ®°ÂºèÊ≥®ÂÜåÂà∞ runloop ÂêéÔºå ÊØèÂΩìÂ±èÂπïÊòæÁ§∫ÂÜÖÂÆπÂà∑Êñ∞ÁªìÊùüÁöÑÊó∂ÂÄôÔºå runloop Â∞±‰ºöÂêë CADisplayLink ÊåáÂÆöÁöÑ target ÂèëÈÄÅ‰∏ÄÊ¨°ÊåáÂÆöÁöÑ selector Ê∂àÊÅØÔºå CADisplayLink Á±ªÂØπÂ∫îÁöÑ selector Â∞±‰ºöË¢´Ë∞ÉÁî®‰∏ÄÊ¨°„ÄÇ ‰ΩøÁî®ÊñπÂºèÔºö 1234567891011121314151617181920- (void)startDisplayLink&#123; self.displayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(handleDisplayLink:)]; self.displayLink.frameInterval = 3; [self.displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];&#125;- (void)handleDisplayLink:(CADisplayLink *)displayLink&#123; //do something&#125;- (void)stopDisplayLink&#123; // Ê≥®ÊÑèÔºå‰∏ãÈù¢‰∏§Ê≠•ÈÉΩË¶ÅÂÅö„ÄÇÂÖà‰ªé runloop ÈáåÊ≥®ÈîÄ displaylink„ÄÇÂÜçÂ∞Ü displaylink ÁΩÆ‰∏∫ nil,Èò≤Ê≠¢‰Ω†ÂØπÂ∑≤Áªè invalidate ÁöÑÂØπË±°ËøõË°åÊìç‰Ωú„ÄÇ [self.displayLink invalidate]; self.displayLink = nil;&#125; ÂΩìÊää CADisplayLink ÂØπË±° add Âà∞ runloop ‰∏≠ÂêéÔºà‰∏ÄÂÆöË¶ÅÂä†ÂïäÔºåÂê¶ÂàôÊó†ÊïàÔºâÔºåselectorÂ∞±ËÉΩË¢´Âë®ÊúüÊÄßË∞ÉÁî®ÔºåÁ±ª‰ºº‰∫é NSTimer Ë¢´ÂêØÂä®‰∫ÜÔºõÊâßË°å invalidate Êìç‰ΩúÊó∂Ôºå CADisplayLink ÂØπË±°Â∞±‰ºö‰ªé runloop ‰∏≠ÁßªÈô§Ôºåselector Ë∞ÉÁî®‰πüÈöèÂç≥ÂÅúÊ≠¢ÔºåÁ±ª‰ºº‰∫é NSTimer ÁöÑ invalidate ÊñπÊ≥ï„ÄÇ iOS ËÆæÂ§áÁöÑ FPS ÊòØ60HzÔºåÂõ†Ê≠§ CADisplayLink ÁöÑ selector ÈªòËÆ§Ë∞ÉÁî®Âë®ÊúüÊòØÊØèÁßí60Ê¨°ÔºåËøô‰∏™Âë®ÊúüÂèØ‰ª•ÈÄöËøá frameInterval Â±ûÊÄßËÆæÁΩÆÔºå CADisplayLinkÁöÑ selector ÊØèÁßíË∞ÉÁî®Ê¨°Êï∞‰∏∫ 60/ frameInterval„ÄÇÊØîÂ¶ÇÂΩì frameInterval ËÆæ‰∏∫2ÔºåÊØèÁßíË∞ÉÁî®Â∞±ÂèòÊàê30Ê¨°„ÄÇÂõ†Ê≠§Ôºå CADisplayLink Âë®ÊúüÁöÑËÆæÁΩÆÊñπÂºèÁï•Êòæ‰∏ç‰æø„ÄÇ‰∏çËøá CADisplayLink ÈÄÇÂêà‰∫éÈúÄË¶ÅÁ≤æÂ∫¶ËæÉÈ´òÁöÑÂÆöÊó∂„ÄÇ NSRunLoop ‰ºöÂº∫ÂºïÁî® CADisplayLinkÔºåÊâÄ‰ª•Â§ñÈÉ®‰πü‰∏çÈúÄË¶ÅÂº∫ÂºïÁî® CADisplayLink Â∫îÁî®‰πãÊü•Áúã FPSCADisplayLink ÂíåÂ±èÂπïÁöÑÂà∑Êñ∞ÁéáÊòØ‰∏ÄËá¥ÁöÑÔºåÊâÄ‰ª•ÂèØ‰ª•ÈÄöËøáÂà§Êñ≠‰∏ÄÁßíÈíüÂÜÖ CADisplayLink ÊâßË°å‰∫ÜÂ§öÂ∞ëÊ¨°Êù•Èó¥Êé•Áü•ÈÅìÂ±èÂπïÂà∑Êñ∞ÁéáÔºö ‰∏é NSTimer ‰∏çÂêåiOSËÆæÂ§áÁöÑÂ±èÂπïÂà∑Êñ∞È¢ëÁéáÊòØÂõ∫ÂÆöÁöÑÔºåCADisplayLinkÂú®Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ã‰ºöÂú®ÊØèÊ¨°Âà∑Êñ∞ÁªìÊùüÈÉΩË¢´Ë∞ÉÁî®ÔºåÁ≤æÁ°ÆÂ∫¶Áõ∏ÂΩìÈ´ò„ÄÇNSTimerÁöÑÁ≤æÁ°ÆÂ∫¶Â∞±ÊòæÂæó‰Ωé‰∫ÜÁÇπÔºåÊØîÂ¶ÇNSTimerÁöÑËß¶ÂèëÊó∂Èó¥Âà∞ÁöÑÊó∂ÂÄôÔºårunloopÂ¶ÇÊûúÂú®ÈòªÂ°ûÁä∂ÊÄÅÔºåËß¶ÂèëÊó∂Èó¥Â∞±‰ºöÊé®ËøüÂà∞‰∏ã‰∏Ä‰∏™runloopÂë®Êúü„ÄÇÂπ∂‰∏î NSTimerÊñ∞Â¢û‰∫ÜtoleranceÂ±ûÊÄßÔºåËÆ©Áî®Êà∑ÂèØ‰ª•ËÆæÁΩÆÂèØ‰ª•ÂÆπÂøçÁöÑËß¶ÂèëÁöÑÊó∂Èó¥ÁöÑÂª∂ËøüËåÉÂõ¥„ÄÇCADisplayLink‰ΩøÁî®Âú∫ÂêàÁõ∏ÂØπ‰∏ì‰∏ÄÔºåÈÄÇÂêàÂÅöUIÁöÑ‰∏çÂÅúÈáçÁªòÔºåÊØîÂ¶ÇËá™ÂÆö‰πâÂä®ÁîªÂºïÊìéÊàñËÄÖËßÜÈ¢ëÊí≠ÊîæÁöÑÊ∏≤Êüì„ÄÇNSTimerÁöÑ‰ΩøÁî®ËåÉÂõ¥Ë¶ÅÂπøÊ≥õÁöÑÂ§öÔºåÂêÑÁßçÈúÄË¶ÅÂçïÊ¨°ÊàñËÄÖÂæ™ÁéØÂÆöÊó∂Â§ÑÁêÜÁöÑ‰ªªÂä°ÈÉΩÂèØ‰ª•‰ΩøÁî®„ÄÇ ÂèØ‰ª•ÈÄöËøá CADisplayLink Âíå‰∏äÈù¢ÁöÑÁªòÂõæÔºåÂÆåÊàêÂæàÂ§öÂä®ÁîªÊïàÊûú Âª∂ËøüË∞ÉÁî®ÂΩìË∞ÉÁî® NSObject ÁöÑ performSelector:afterDelay: ÂêéÔºåÂÆûÈôÖ‰∏äÂÖ∂ÂÜÖÈÉ®‰ºöÂàõÂª∫‰∏Ä‰∏™ Timer Âπ∂Ê∑ªÂä†Âà∞ÂΩìÂâçÁ∫øÁ®ãÁöÑ Run Loop ‰∏≠„ÄÇÊâÄ‰ª•Â¶ÇÊûúÂΩìÂâçÁ∫øÁ®ãÊ≤°Êúâ Run LoopÔºåÂàôËøô‰∏™ÊñπÊ≥ï‰ºöÂ§±ÊïàÔºàÊ≥®ÊÑèÔºåËøôÊòØ‰∏Ä‰∏™ËÄÉÁÇπÔºåÊâÄ‰ª•Âú®Â≠êÁ∫øÁ®ã‰∏≠Áõ¥Êé•Ë∞ÉÁî®ËØ•ÊñπÊ≥ïÊòØÊó†ÊïàÁöÑÔºâ„ÄÇ ÂΩìË∞ÉÁî® performSelector:onThread: Êó∂ÔºåÂÆûÈôÖ‰∏äÂÖ∂‰ºöÂàõÂª∫‰∏Ä‰∏™ Timer Âä†Âà∞ÂØπÂ∫îÁöÑÁ∫øÁ®ãÂéªÔºåÂêåÊ†∑ÁöÑÔºåÂ¶ÇÊûúÂØπÂ∫îÁ∫øÁ®ãÊ≤°Êúâ Run Loop ËØ•ÊñπÊ≥ï‰πü‰ºöÂ§±Êïà„ÄÇ ÊâÄ‰ª•‰∏ÄËà¨ËøòÊòØÂú®‰∏ªÁ∫øÁ®ãË∞ÉÁî®Ëøô‰∫õÊñπÊ≥ïÔºåÂ¶ÇÊûúÂÆûÂú®Ë¶ÅÂú®Â≠êÁ∫øÁ®ãÈáåË∞ÉÁî®ÔºåÈÇ£‰πàËÆ∞ÂæóÂú®ÂÖ∂ÂêéË∞ÉÁî® [[NSRunLoop currentRunLoop] run]; 1234// 3ÁßíÂêéËá™Âä®Ë∞ÉÁî®selfÁöÑrun:ÊñπÊ≥ïÔºåÂπ∂‰∏î‰º†ÈÄíÂèÇÊï∞Ôºö@"abc"[self performSelector:@selector(run:) withObject:@"abc" afterDelay:3];// Âú®Â≠êÁ∫øÁ®ã‰∏≠ÂàõÂª∫ÁöÑÊó∂ÂÄôÔºåË¶ÅÂºÄÂêØÂ≠êÁ∫øÁ®ãÁöÑ runloop[[NSRunLoop currentRunLoop] run]; Êú¨Ë¥®‰∏äÂ∞±ÊòØ‰∏Ä‰∏™ NSTimer GCD123456789101112131415161718192021222324252627282930/** ÂàõÂª∫ÂÆöÊó∂Âô®ÂØπË±° * para1: DISPATCH_SOURCE_TYPE_TIMER ‰∏∫ÂÆöÊó∂Âô®Á±ªÂûã * para2-3: ‰∏≠Èó¥‰∏§‰∏™ÂèÇÊï∞ÂØπÂÆöÊó∂Âô®Êó†Áî® * para4: ÊúÄÂêé‰∏∫Âú®‰ªÄ‰πàË∞ÉÂ∫¶ÈòüÂàó‰∏≠‰ΩøÁî® */dispatch_source_t _gcdTimer; //(‰∏çÊòØÊåáÈíà)_gcdTimer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, 0, 0, dispatch_get_global_queue(0, 0));/** ËÆæÁΩÆÂÆöÊó∂Âô® * para2: ‰ªªÂä°ÂºÄÂßãÊó∂Èó¥ * para3: ‰ªªÂä°ÁöÑÈó¥Èöî * para4: ÂèØÊé•ÂèóÁöÑËØØÂ∑ÆÊó∂Èó¥ÔºåËÆæÁΩÆ0Âç≥‰∏çÂÖÅËÆ∏Âá∫Áé∞ËØØÂ∑Æ * Tips: Âçï‰ΩçÂùá‰∏∫Á∫≥Áßí */dispatch_source_set_timer(_gcdTimer, DISPATCH_TIME_NOW, 2.0 * NSEC_PER_SEC, 0.0 * NSEC_PER_SEC);/** ËÆæÁΩÆÂÆöÊó∂Âô®‰ªªÂä° * ÂèØ‰ª•ÈÄöËøáblockÊñπÂºè * ‰πüÂèØ‰ª•ÈÄöËøáCÂáΩÊï∞ÊñπÂºè */dispatch_source_set_event_handler(_gcdTimer, ^&#123; static int gcdIdx = 0; NSLog(@"GCD Method: %d", gcdIdx++); NSLog(@"%@", [NSThread currentThread]); if(gcdIdx == 5) &#123; // ÁªàÊ≠¢ÂÆöÊó∂Âô® dispatch_suspend(_gcdTimer); &#125;&#125;);// ÂêØÂä®‰ªªÂä°ÔºåGCDËÆ°Êó∂Âô®ÂàõÂª∫ÂêéÈúÄË¶ÅÊâãÂä®ÂêØÂä®dispatch_resume(_gcdTimer); GCD ÊòØÂáÜÊó∂ÁöÑÂÆöÊó∂Âô® Ê≥®ÊÑè dispatch_source_t Âπ∂‰∏çÊòØ‰∏Ä‰∏™ÊåáÈíà dispatch_source_t Êú¨Ë∫´ÈúÄË¶ÅÂº∫ÂºïÁî®ÔºåÂê¶Âàô‰ºöÁ´ãÂàªÂõûÊî∂ÔºåÊó†Ê≥ïÂÆåÊàêÂÆöÊó∂ ÂÖ≥‰∫é runloopÊàë‰ª¨ÂèØ‰ª•ËßÇÂØüÂà∞ÔºåÈô§‰∫Ü GCDÔºåÂè¶Â§ñ‰∏âÁßçÊñπÊ≥ïÈÉΩÈúÄË¶ÅÊääÂÆöÊó∂Âô®Âä†ÂÖ•ÂΩìÂâç runloop ‰∏≠„ÄÇËøôÈáåË¶ÅÂº∫Ë∞É‰∏ÄÁÇπÔºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºå‰∏çË¶ÅÊääÂÆöÊó∂Âô®Âä†Âà∞Èùû‰∏ªÁ∫øÁ®ã‰∏≠Âéª„ÄÇÂõ†‰∏∫ÂÆöÊó∂Âô®ÈúÄË¶ÅÁ∫øÁ®ãÁöÑ runloop ÂêØÂä®ÔºåÂç≥ [[NSRunLoop currentRunLoop] run];„ÄÇÂØπ‰∫é‰∏ªÁ∫øÁ®ãÔºåËøôÊ≤°Êúâ‰ªª‰ΩïÈóÆÈ¢òÔºå‰∏ªÁ∫øÁ®ãÁöÑ runloop ÈªòËÆ§ÂºÄÂêØ„ÄÇ‰ΩÜÊòØÂØπ‰∫éÂ≠êÁ∫øÁ®ãÔºåÊàë‰ª¨ÊúÄÂ•Ω‰∏çË¶ÅÂêØÂä®ÂÆÉÁöÑ runloopÔºåËøô‰ºöÂØºËá¥Â≠êÁ∫øÁ®ã‰∏ÄÁõ¥Â§Ñ‰∫éÊ¥ªÂä®Áä∂ÊÄÅËÄå‰∏çË¢´ÂõûÊî∂Ôºå‰ªéËÄåÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÊºè„ÄÇÊâÄ‰ª•ÔºåÂÆöÊó∂Âô®ÊúÄÂ•ΩËøòÊòØÂä†Âú®‰∏ªÁ∫øÁ®ãÈáåÂêß„ÄÇÂ¶ÇÊûú‰∏ÄÂÆöË¶ÅÂú®Â≠êÁ∫øÁ®ãÈáåËÆæÁΩÆÔºåÈÇ£‰πà‰∏ÄÂÆöË¶ÅÂú®ÁªìÊùüÁöÑÊó∂ÂÄôÔºåÂÅúÊ≠¢ËøêË°åÂæ™ÁéØ„ÄÇ ÂÖ≥‰∫éÂæ™ÁéØÂºïÁî®ÈóÆÈ¢òÂÆöÊó∂Âô®ÂåÖÊã¨ CADisplayLink Âíå NSTimer ÈÉΩÈúÄË¶ÅÊâãÂä®ÈÄöËøá invalidate ÊñπÊ≥ïÊù•ÈîÄÊØÅ„ÄÇËøôÂ∞±ÂÖ≥Á≥ªÂà∞ÈîÄÊØÅÁöÑÊó∂Êú∫„ÄÇ ÊñπÂºè‰∏ÄÈÄöËøá dealloc ÊñπÊ≥ïÈîÄÊØÅÔºö ÈîôËØØÁöÑÂÅöÊ≥ïÔºö 1234567__weak typeof(self) wself = self;self.displayLink = [CADisplayLink displayLinkWithTarget:wself selector:@selector(selector)];[self.displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];- (void)dealloc &#123; [self.displayLink invalidate];&#125; ‰∏äÈù¢ËøôÁßçÂº±ÂºïÁî®ÊñπÂºèÊòØÊ≤°ÊúâÁî®ÁöÑ„ÄÇÂõ†‰∏∫ÂÆÉ‰ª¨ÂÜÖÈÉ®‰ºöÂº∫ÂºïÁî® target„ÄÇÊâÄ‰ª•ÂÖ∂ÂÆû‰∏ç‰ºöÊâßË°å dealloc ÊñπÊ≥ï„ÄÇ ‰∏∫‰∫ÜÊâìÁ†¥ËøôÁßçÂº∫ÂºïÁî®ÔºåÊàë‰ª¨ÂèØ‰ª•Êñ∞Âª∫‰∏Ä‰∏™ weakTarget ÁöÑÁ±ªÔºåÈÄöËøáËΩ¨ÂèëÂÆûÁé∞Ôºö 1234567891011121314// class WeakTarget@property (nonatomic, weak) id target;- (instancetype)initWithTarget:(id)target &#123; self = [super init]; if (self) &#123; self.target = target; &#125; return self;&#125;- (id)forwardingTargetForSelector:(SEL)aSelector &#123; return self.target;&#125; ‰ΩøÁî®Ôºö 123456self.displayLink = [CADisplayLink displayLinkWithTarget:[[WeakTarget alloc] initWithTarget:self] selector:@selector(selector)];[self.displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];- (void)dealloc &#123; [self.displayLink invalidate];&#125; ËøôÊ†∑Ôºåtimer Âº∫ÂºïÁî®ÁöÑÂ∞±‰∏çÊòØÊàë‰ª¨‰∏öÂä°Áõ∏ÂÖ≥ÁöÑÁ±ª‰∫Ü„ÄÇ ÊñπÂºè‰∫åÈÄöËøá VC ÊàñËÄÖ View ÁöÑÁîüÂëΩÂë®ÊúüÈîÄÊØÅ„ÄÇËôΩÁÑ∂Âº∫ÂºïÁî®‰∫Ü‰∏ç‰ºöË∞ÉÁî® dealloc Ôºå‰ΩÜÊòØÁîüÂëΩÂë®ÊúüËøòÊòØ‰ºöÂõûË∞ÉÁöÑÊØîÂ¶ÇÂú® viewWillDisappear ÊàñËÄÖ removeFromSuperView Á≠âÊñπÊ≥ï‰∏≠„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS ÊåÅ‰πÖÂåñÊñπÂºè]]></title>
    <url>%2F2017%2F02%2F03%2FiOS%E6%8C%81%E4%B9%85%E5%8C%96%2F</url>
    <content type="text"><![CDATA[ÂºÄÂèëÁöÑÊó∂ÂÄôÊÄªÊòØË¶Å‰øùÂ≠ò‰∏Ä‰∫õ‰∏úË•øÂú®Á£ÅÁõò‰∏äÁöÑÔºåÈÇ£‰πàÊúâÂì™‰∫õÊñπÂºèÊù•ÂÆåÊàêÊåÅ‰πÖÂåñÂë¢Ôºü NSUserDefaultsÂØπ‰∫éÂ∫îÁî®Êù•ËØ¥ÔºåÊØè‰∏™Áî®Êà∑ÈÉΩÊúâËá™Â∑±ÁöÑÁã¨ÁâπÂÅèÂ•ΩËÆæÁΩÆÔºåËÄåÂ•ΩÁöÑÂ∫îÁî®‰ºöËÆ©Áî®Êà∑Ê†πÊçÆÂñúÂ•ΩÈÄâÊã©ÂêàÈÄÇÁöÑ‰ΩøÁî®ÊñπÂºèÔºåÊääËøô‰∫õÂÅèÂ•ΩËÆ∞ÂΩïÂú®Â∫îÁî®ÂåÖÁöÑ plist Êñá‰ª∂‰∏≠ÔºåÈÄöËøá NSUserDefaults Á±ªÊù•ËÆøÈóÆÔºåËøôÊòØ NSUserDefaults ÁöÑÂ∏∏Áî®ÂßøÂäø„ÄÇÂ¶ÇÊûúÊúâ‰∏Ä‰∫õËÆæÁΩÆ‰Ω†Â∏åÊúõÁî®Êà∑Âç≥‰ΩøÂçáÁ∫ßÂêéËøòÂèØ‰ª•ÁªßÁª≠‰ΩøÁî®ÔºåÊØîÂ¶ÇÁé©Ê∏∏ÊàèÊó∂ÂæóËøáÁöÑÊúÄÈ´òÂàÜ„ÄÅÂñúÂ•ΩÂíåÈÄöÁü•ËÆæÁΩÆ„ÄÅ‰∏ªÈ¢òÈ¢úËâ≤ÁîöËá≥‰∏Ä‰∏™Áî®Êà∑Â§¥ÂÉèÔºåÈÇ£‰πà‰Ω†ÂèØ‰ª•‰ΩøÁî® NSUserDefaults Êù•Â≠òÂÇ®Ëøô‰∫õ‰ø°ÊÅØ„ÄÇ ‰ΩøÁî®ÊñπÊ≥ïNSUserDefaults ÊòØ iOS Á≥ªÁªüÊèê‰æõÁöÑ‰∏Ä‰∏™Âçï‰æãÁ±ªÔºåÈÄöËøáÁ±ªÊñπÊ≥ï standardUserDefaults ÂèØ‰ª•Ëé∑Âèñ NSUserDefaults Âçï‰æã: 1NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults]; NSUserDefaults Âçï‰æã‰ª• key-value ÁöÑÂΩ¢ÂºèÂ≠òÂÇ®‰∫Ü‰∏ÄÁ≥ªÂàóÂÅèÂ•ΩËÆæÁΩÆÔºåkey ÊòØÂêçÁß∞Ôºåvalue ÊòØÁõ∏Â∫îÁöÑÊï∞ÊçÆ„ÄÇÂ≠ò/ÂèñÊï∞ÊçÆÊó∂ÂèØ‰ª•‰ΩøÁî®ÊñπÊ≥ï objectForKey: Âíå setObject:forKey: Êù•ÊääÂØπË±°Â≠òÂÇ®Âà∞Áõ∏Â∫îÁöÑ plist Êñá‰ª∂‰∏≠ÔºåÊàñËÄÖËØªÂèñÔºåÊó¢ÁÑ∂ÊòØ plist Êñá‰ª∂ÔºåÈÇ£‰πàÂØπË±°ÁöÑÁ±ªÂûãÂàôÂøÖÈ°ªÊòØ plist Êñá‰ª∂ÂèØ‰ª•Â≠òÂÇ®ÁöÑÁ±ªÂûãÔºåÂåÖÊã¨Ôºö NSData NSString NSNumber NSDate NSArray NSDictionary ËÄåÂ¶ÇÊûúÈúÄË¶ÅÂ≠òÂÇ® plist Êñá‰ª∂‰∏çÊîØÊåÅÁöÑÁ±ªÂûãÔºåÊØîÂ¶ÇÂõæÁâáÔºåÂèØ‰ª•ÂÖàÂ∞ÜÂÖ∂ÂΩíÊ°£‰∏∫ NSData Á±ªÂûãÔºåÂÜçÂ≠òÂÖ• plist Êñá‰ª∂ÔºåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂç≥‰ΩøÂØπË±°ÊòØ NSArray Êàñ NSDictionary Ôºå‰ªñ‰ª¨Â≠òÂÇ®ÁöÑÁ±ªÂûã‰πüÂ∫îËØ•ÊòØ‰ª•‰∏äËåÉÂõ¥ÂåÖÊã¨ÁöÑ„ÄÇ ‰∏Ä‰∫õÊñπÊ≥ïNSUserDefaults Êèê‰æõ‰∫ÜËã•Âπ≤ÁÆÄ‰æøÊñπÊ≥ïÂèØ‰ª•Â≠òÂÇ®Êüê‰∫õÂ∏∏Áî®Á±ªÂûãÁöÑÂÄºÔºå‰æãÂ¶ÇÔºö 123456- setBool:forKey:- setFloat:forKey:- setInteger:forKey:- setDouble:forKey:- setURL:forKey:- setObject:forKey: ËøôÈáåÂè™Âàó‰∏æ‰∫ÜÂá†‰∏™ set ÊñπÊ≥ï„ÄÇËØ∏Â¶Ç NSString,NSData,NSArray,NSDictionary Á≠âÈÉΩ‰ΩøÁî® setObject:forKey: ÊñπÊ≥ïËÆæÁΩÆ„ÄÇ 123456789- boolForKey:- floatForKey:- integerForKey:- doubleForKey:- urlForKey:- stringForKey:- dataForKey:- arrayForKey:- dictionaryForKey: ÈúÄË¶ÅÊ≥®ÊÑèÔºåËøôÈáåÊñπÊ≥ï‰∏çÊòØ‰∏Ä‰∏ÄÂØπÂ∫îÁöÑÔºå‰∏äÈù¢‰ΩøÁî® setObject:forKey: ÁöÑÔºåÂú®Ëé∑ÂèñÁöÑÊó∂ÂÄôÔºåÈÉΩ‰ΩøÁî®‰∫ÜÂÖ∑‰ΩìÁöÑÁ±ªÂûãÔºåËØªÂèñÁöÑÊó∂ÂÄôÊúÄÂ•Ω‰ΩøÁî®ÊòéÁ°ÆÁ±ªÂûãÁöÑÊñπÊ≥ïÔºåËÄå‰∏çÊòØ objectForKey:. ‰ΩøÁî®Ëé∑ÂèñÊñπÊ≥ïÁöÑÊó∂ÂÄô‰∏ÄÂÆöË¶ÅÁî®ÊòéÁ°ÆÁ±ªÂûãÁöÑÊñπÊ≥ïÔºåÂê¶Âàô‰ºö‰∫ßÁîü‰∏çÂ∑≤ÊéíÊü•ÁöÑÊÑèÊÉ≥‰∏çÂà∞ÁöÑÈîôËØØÔºÅÔºÅÔºÅ ‰∏æ‰æãÂ≠ò‰∏Ä‰∏™Êï¥Êï∞„ÄÅÂ≠óÁ¨¶‰∏≤Âíå‰∏ÄÂº†ÂõæÁâáÔºö 123456789NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];//Â≠óÁ¨¶‰∏≤[defaults setObject:@"jack" forKey:@"firstName"];//Êï¥Êï∞[defaults setInteger:10 forKey:@"Age"];//ÂõæÁâáUIImage *image =[UIImage imageNamed:@"somename"];NSData *imageData = UIImageJPEGRepresentation(image, 1);//ÊääimageÂΩíÊ°£‰∏∫NSData[defaults setObject:imageData forKey:@"image"]; UIImageJPEGRepresentation Êúâ‰∏§‰∏™ÂÆûÂèÇÔºå‰∏Ä‰∏™ÊòØ UIImageÔºåÂè¶‰∏Ä‰∏™ÊòØÊµÆÁÇπÊï∞ÂèòÈáèÔºå‰ª£Ë°®ÂéãÁº©Ë¥®Èáè„ÄÇÂéãÁº©Ë¥®ÈáèÁöÑÂÄºÂøÖÈ°ªÂú®0Âà∞1‰πãÈó¥Ôºå1‰ª£Ë°®ÊúÄÈ´òË¥®ÈáèÂç≥‰∏çÂéãÁº©„ÄÇ ÂØπÂ∫îÁöÑËØªÂèñÊñπÊ≥ïÔºö 12345678NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];//Â≠óÁ¨¶‰∏≤NSString *firstName = [defaults objectForKey:@"firstName"]//Êï∞Â≠óNSInteger age = [defaults integerForKey:@"Age"];//ÂõæÁâáNSData *imageData = [defaults dataForKey:@"image"];UIImage *image = [UIImage imageWithData:imageData]; plist ÁöÑ‰ΩøÁî®‰∏äÈù¢ÁöÑ NSUserDefaults ÊòØÂü∫‰∫é plist ÁöÑ„ÄÇÂèØ‰ª•Áî®Êù•Â≠òÂÇ®ÂüéÂ∏ÇÂàóË°®Á≠âÁ±ª‰ººÊï∞ÊçÆ„ÄÇÈÇ£‰πàÂ¶Ç‰ΩïÁõ¥Êé•Êìç‰Ωú plist Âë¢Ôºü ÂÜôÂÖ•ÈÄöËøá writeToFile:atomically: ‰∏äÈù¢ÊèêÂà∞ÁöÑ plist ËÉΩÂ§üÂ≠òÂÇ®ÁöÑÁ±ªÂûãÈÉΩÊúâËøô‰∏™ÊñπÊ≥ï„ÄÇ 123456789//Ëé∑ÂèñÂ∫îÁî®Á®ãÂ∫èÊ≤ôÁõíÁöÑDocumentsÁõÆÂΩï NSArray *paths=NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask,YES); NSString *plistPath1 = [paths objectAtIndex:0]; //ÂæóÂà∞ÂÆåÊï¥ÁöÑÊñá‰ª∂Âêç NSString *filename=[plistPath1 stringByAppendingPathComponent:@"test.plist"]; //ËæìÂÖ•ÂÜôÂÖ• data ÊòØ‰∏™ dictionary[data writeToFile:filename atomically:YES]; ËØªÂèñÈÄöËøá initWithContentsOfFile: ÊñπÊ≥ïÂàùÂßãÂåñËØªÂèñÔºå‰∏äÈù¢ÊèêÂà∞ÁöÑÁ±ªÂûãÈÉΩÊúâËØ•ÊñπÊ≥ïÔºö 123//ÈÇ£ÊÄé‰πàËØÅÊòéÊàëÁöÑÊï∞ÊçÆÂÜôÂÖ•‰∫ÜÂë¢ÔºüËØªÂá∫Êù•ÁúãÁúã //ËøôÈáåÁöÑ filename ÊòØÂÆåÊï¥ÁöÑË∑ØÂæÑÂíåÊñá‰ª∂ÂêçNSMutableDictionary *data1 = [[NSMutableDictionary alloc] initWithContentsOfFile:filename]; ÂΩíÊ°£ÂçèËÆÆÂΩíÊ°£ÂèØ‰ª•ÂÆûÁé∞ÂØπÈùû‰∏äËø∞Á±ªÂûãÂØπË±°ÁöÑÂ≠òÂÇ®„ÄÇ‰ΩÜÊòØÂøÖÈ°ªÈÅµÂÆà NSCoding ÂçèËÆÆ„ÄÇËØ•ÂçèËÆÆÊúâ‰∏§‰∏™ÊñπÊ≥ïÔºö 123456@protocol NSCoding- (void)encodeWithCoder:(NSCoder *)aCoder;- (id)initWithCoder:(NSCoder *)aDecoder;@end ÂÆûÁé∞ÂÆû‰æãÔºö 123456789101112131415161718192021222324252627282930313233343536373839//.hÊñá‰ª∂#import &lt;Foundation/Foundation.h&gt;// ÁªôËá™ÂÆö‰πâÁ±ªÂΩíÊ°£ÔºåÈ¶ñÂÖàË¶ÅÈÅµÂÆàNSCodingÂçèËÆÆ„ÄÇ@interface Person : NSObject&lt;NSCoding&gt;@property (nonatomic,strong) NSString *name;@property (nonatomic,assign) NSInteger age;@property (nonatomic,strong) NSString *gender;@end //.mÊñá‰ª∂#import "Person.h"@implementation Person// ÂΩíÊ°£ÊñπÊ≥ï- (void)encodeWithCoder:(NSCoder *)aCoder&#123; [aCoder encodeObject:self.name forKey:@"name"]; [aCoder encodeInteger:self.age forKey:@"age"]; [aCoder encodeObject:self.gender forKey:@"gender"];&#125;// ÂèçÂΩíÊ°£ÊñπÊ≥ï- (instancetype)initWithCoder:(NSCoder *)aDecoder&#123; self = [super init]; if (self != nil) &#123; self.name = [aDecoder decodeObjectForKey:@"name"]; self.age = [aDecoder decodeIntegerForKey:@"age"]; self.gender = [aDecoder decodeObjectForKey:@"gender"]; &#125; return self;&#125;@end ËøôÈáåÂèØ‰ª•Âú®‰ΩøÁî®ÁöÑÊó∂ÂÄôÔºåÈÄöËøá‰ª£Á†ÅÊèêÁ§∫ÈÄâÂèñÂêàÈÄÇÁöÑ encode Âíå decode ÊñπÊ≥ï„ÄÇ Â¶ÇÊ≠§Â∞±ËÉΩÂØπ Person ÂØπË±°ËøõË°åÂΩíÊ°£‰∫Ü„ÄÇÂΩìÁÑ∂ËøôÁßçÂΩíÊ°£ÊñπÊ≥ïÈùûÂ∏∏ÂÇªÁìú„ÄÇÂõ†‰∏∫ÊØè‰∏Ä‰∏™Â±ûÊÄßÈÉΩË¶ÅËÆæÁΩÆ‰∏ÄÊ¨° encode Âíå decode„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá runtimeÔºåÂÆûÁé∞Ëá™Âä®ÂΩíÊ°£„ÄÇÂÖ∑‰ΩìÁöÑÂÆûÁé∞ÊñπÊ≥ïÂú® ‚Äúruntime Â∫îÁî®‚Äù ‰∏ÄÁØáÊúâËØ¥Êòé„ÄÇ ‰ΩøÁî®ÂØπ‰∫éÊâÄÊúâÁ≥ªÁªüÁ±ªÂûãÔºàNSString„ÄÅNSDictionary„ÄÅNSArray„ÄÅNSNumberÁ≠âÔºâ‰ª•ÂèäÊâÄÊúâÂÆûÁé∞‰∫Ü‰∏äÈù¢ÂçèËÆÆÁöÑÁ±ªÂûãÔºåÈÄöËøá‰∏ãÈù¢‰∏§‰∏™ÊñπÊ≥ïÁºñÁ†ÅÔºàNSKeyedArchiverÔºâÂíåËß£Á†ÅÔºàNSKeyedUnarchiverÔºâ 12BOOL success = [NSKeyedArchiver archiveRootObject:data toFile:filePath];id data = [NSKeyedUnarchiver unarchiveObjectWithFile:filePath]; ÂÆûÁé∞ÂÆû‰æãÔºö 1234567891011121314151617181920- (void)viewDidLoad &#123; [super viewDidLoad]; Person *person = [[Person alloc]init]; person.name = @"BigBaby"; person.age = 16; person.gender = @"Áî∑"; // ÂΩíÊ°£ÔºåË∞ÉÁî®ÂΩíÊ°£ÊñπÊ≥ï NSString *filePath = [NSHomeDirectory() stringByAppendingString:@"person.plist"]; BOOL success = [NSKeyedArchiver archiveRootObject:person toFile:filePath]; NSLog(@"%d",success); // ÂèçÂΩíÊ°£ÔºåË∞ÉÁî®ÂèçÂΩíÊ°£ÊñπÊ≥ï Person *per = [NSKeyedUnarchiver unarchiveObjectWithFile:filePath]; NSLog(@"%@",per); // Do any additional setup after loading the view, typically from a nib.&#125; RealmÊúÄÂº∫Â§ßÁöÑË∑®Âπ≥Âè∞ÁßªÂä®Á´ØÊï∞ÊçÆÂ∫ìÔºå‰ΩÜÊòØÊöÇÊó∂Áî®‰∏çÂà∞ÔºåÁî®Âà∞ÂÜçËØ¥„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂÖ≥‰∫é iOS build]]></title>
    <url>%2F2017%2F02%2F03%2F%E5%85%B3%E4%BA%8E%20iOS%20build%2F</url>
    <content type="text"><![CDATA[ÂÖ≥‰∫é Xcode ÊòØÂ¶Ç‰ΩïÁºñËØëÁöÑÔºå‰∏ãÈù¢ÊòØ‰∏Ä‰∫õËæÉ‰∏∫ÊµÖÊòæÁöÑËÆ®ËÆ∫„ÄÇ ÁÇπÂáªrunÂêéÂèëÁîü‰∫Ü‰ªÄ‰πàÁÇπÂáª Run ‰πãÂêé App ËøõË°åÁºñËØë„ÄÅÊ±áÁºñ„ÄÅÈìæÊé•„ÄÅ‰ª£Á†ÅÁ≠æÂêç‰ª•ÂèäÂêØÂä®ÊâßË°åÁ≠âÊìç‰Ωú ÁºñËØëClangÊòØLLVMÁöÑÂâçÁ´ØÔºåÂèØ‰ª•Áî®Êù•ÁºñËØëCÔºåC++ÔºåObjectiveCÁ≠âËØ≠Ë®Ä„ÄÇ‰º†ÁªüÁöÑÁºñËØëÂô®ÈÄöÂ∏∏ÂàÜ‰∏∫‰∏â‰∏™ÈÉ®ÂàÜÔºåÂâçÁ´Ø(frontEnd)Ôºå‰ºòÂåñÂô®(Optimizer)ÂíåÂêéÁ´Ø(backEnd)„ÄÇÂú®ÁºñËØëËøáÁ®ã‰∏≠ÔºåÂâçÁ´Ø‰∏ªË¶ÅË¥üË¥£ËØçÊ≥ïÂíåËØ≠Ê≥ïÂàÜÊûêÔºåÂ∞ÜÊ∫ê‰ª£Á†ÅËΩ¨Âåñ‰∏∫ÊäΩË±°ËØ≠Ê≥ïÊ†ëÔºõ‰ºòÂåñÂô®ÂàôÊòØÂú®ÂâçÁ´ØÁöÑÂü∫Á°Ä‰∏äÔºåÂØπÂæóÂà∞ÁöÑ‰∏≠Èó¥‰ª£Á†ÅËøõË°å‰ºòÂåñÔºå‰Ωø‰ª£Á†ÅÊõ¥Âä†È´òÊïàÔºõÂêéÁ´ØÂàôÊòØÂ∞ÜÂ∑≤Áªè‰ºòÂåñÁöÑ‰∏≠Èó¥‰ª£Á†ÅËΩ¨Âåñ‰∏∫ÈíàÂØπÂêÑËá™Âπ≥Âè∞ÁöÑÊú∫Âô®‰ª£Á†Å„ÄÇClangÂàôÊòØ‰ª•LLVM‰∏∫ÂêéÁ´ØÁöÑ‰∏ÄÊ¨æÈ´òÊïàÊòìÁî®ÔºåÂπ∂‰∏î‰∏éIDEÁªìÂêàÂæàÂ•ΩÁöÑÁºñËØëÂâçÁ´Ø„ÄÇ ÁºñËØëÂô®ÂàÜÂà´ÁºñËØëÂô®ÂâçÁ´ØÔºàclangÔºâÂíåÁºñËØëÂô®ÂêéÁ´ØÔºåÁºñËØëÂô®ÂâçÁ´ØË¥üË¥£‰∫ßÁîüÊú∫Âô®Êó†ÂÖ≥ÁöÑ‰∏≠Èó¥‰ª£Á†ÅÔºåÁºñËØëÂô®ÂêéÁ´ØË¥üË¥£ÂØπ‰∏≠Èó¥‰ª£Á†ÅËøõË°å‰ºòÂåñÂπ∂ËΩ¨Âåñ‰∏∫ÁõÆÊ†áÊú∫Âô®‰ª£Á†ÅÔºåÂØπ‰∫é‰∏∫‰ªÄ‰πàÈúÄË¶Å ‰∏≠Èó¥‰ª£Á†ÅËøô‰∏™‰∏úË•øÔºåÁúã‰∏™ÂõæÂ∞±‰∏ÄÁõÆ‰∫ÜÁÑ∂Âï¶ÔºàIRÔºöintermediate representation‰∏≠Èó¥Ë°®Á§∫Ôºâ Ê±áÁºñÁõÆÊ†á‰ª£Á†ÅÈúÄË¶ÅÁªèËøáÊ±áÁºñÂô®Â§ÑÁêÜÔºåÊâçËÉΩÂèòÊàêÊú∫Âô®‰∏äÂèØ‰ª•ÊâßË°åÁöÑÊåá‰ª§„ÄÇÁîüÊàêÂØπÂ∫îÁöÑ.oÊñá‰ª∂ ÈìæÊé•ÈìæÊé•Âô®ÔºàËøôÈáåÊåáÁöÑÊòØÈùôÊÄÅÈìæÊé•Âô®ÔºâÂ∞ÜÂ§ö‰∏™ÁõÆÊ†áÊñá‰ª∂ÂêàÂπ∂‰∏∫‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂ÔºåÂú® OS X Âíå iOS‰∏≠ÁöÑÂèØÊâßË°åÊñá‰ª∂ÊòØ Mach-O „ÄÇÈìæÊé•Âë¢ÔºåÂèàÂàÜ‰∏∫ÈùôÊÄÅÈìæÊé•ÂíåÂä®ÊÄÅÈìæÊé• ÈùôÊÄÅÈìæÊé•ÔºöÂú®ÁºñËØëÈìæÊé•ÊúüÈó¥ÂèëÊå•‰ΩúÁî®ÔºåÊääÁõÆÊ†áÊñá‰ª∂ÂíåÈùôÊÄÅÂ∫ì‰∏ÄËµ∑ÈìæÊé•ÂΩ¢ÊàêÂèØÊâßË°åÊñá‰ª∂„ÄÇ Âä®ÊÄÅÈìæÊé•ÔºöÈìæÊé•ËøáÁ®ãÊé®ËøüÂà∞ËøêË°åÊó∂ÂÜçËøõË°å„ÄÇÂØπ‰∫éÂä®ÊÄÅÈìæÊé•ÂíåÈùôÊÄÅÈìæÊé•ÔºåÂêÑÊúâÂçÉÁßã„ÄÇ ‰ª£Á†ÅÁ≠æÂêçÊàë‰ª¨ÊØèÊ¨° build ‰πãÂêéÔºåÈÉΩ‰ºöÂèëÁé∞Â∑•Á®ãÁõÆÂΩï‰∏ãÂ§ö‰∫Ü‰∏Ä‰∏™ .app Êñá‰ª∂„ÄÇ Âú® .app ÁõÆÂΩï‰∏≠ÔºåÊúâÂèà‰∏Ä‰∏™Âè´ _CodeSignature ÁöÑÂ≠êÁõÆÂΩïÔºåËøôÊòØ‰∏Ä‰∏™ plist Êñá‰ª∂ÔºåÈáåÈù¢ÂåÖÂê´‰∫ÜÁ®ãÂ∫èÁöÑ‰ª£Á†ÅÁ≠æÂêçÔºå‰Ω†ÁöÑÁ®ãÂ∫è‰∏ÄÊó¶Á≠æÂêçÔºåÂ∞±Ê≤°ÊúâÂäûÊ≥ïÊõ¥ÊîπÂÖ∂‰∏≠ÁöÑ‰ªª‰Ωï‰∏úË•øÔºåÂåÖÊã¨ËµÑÊ∫êÊñá‰ª∂ÔºåÂèØÊâßË°åÊñá‰ª∂Á≠âÔºåiOSÁ≥ªÁªü‰ºöÊ£ÄÊü•Ëøô‰∏™Á≠æÂêç„ÄÇ Á≠æÂêçËøáÁ®ãÊú¨Ë∫´ÊòØÁî±ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ codesign Êù•ÂÆåÊàêÁöÑ„ÄÇÂ¶ÇÊûú‰Ω†Âú® Xcode ‰∏≠build ‰∏Ä‰∏™Â∫îÁî®ÔºåËøô‰∏™Â∫îÁî®ÊûÑÂª∫ÂÆåÊàê‰πãÂêé‰ºöËá™Âä®Ë∞ÉÁî® codesign ÂëΩ‰ª§ËøõË°åÁ≠æÂêçÔºåËøô‰πüÊòØ Link ‰πãÂêéÁöÑ‰∏Ä‰∏™ÂÖ≥ÈîÆÊ≠•È™§„ÄÇ ÂêØÂä®Âú®ÂêØÂä®ËøáÁ®ã‰∏≠ÔºådyldÔºàÂä®ÊÄÅÈìæÊé•Âô®Ôºâ Ëµ∑‰∫ÜÂæàÈáçË¶ÅÁöÑ‰ΩúÁî®ÔºåËøõË°åÂä®ÊÄÅÈìæÊé•ÔºåËøõË°åÁ¨¶Âè∑ÂíåÂú∞ÂùÄÁöÑ‰∏Ä‰∏™ÁªëÂÆö„ÄÇ dyld ‰∏ªË¶ÅÂú®ÂêØÂä®ËøáÁ®ã‰∏≠‰∏ªË¶ÅÂÅö‰∫Ü‰ª•‰∏ã‰∫ãÊÉÖÔºö Âä†ËΩΩÊâÄ‰æùËµñÁöÑ dylibs Fix-upsÔºöRebase ‰øÆÊ≠£Âú∞ÂùÄÂÅèÁßªÔºåÂõ†‰∏∫ OS XÂíå iOS ÈÄöËøá ASLR Êù•ÂÅöÂú∞ÂùÄÂÅèÁßªÔºàÈöèÊú∫ÂåñÔºâÊù•ÈÅøÂÖçÊî∂Âà∞ÊîªÂáª Fix-upsÔºöBindingÁ°ÆÂÆö Non-Lazy Pointer Âú∞ÂùÄÔºåËøõË°åÁ¨¶Âè∑Âú∞ÂùÄÁªëÂÆö„ÄÇ ObjC runtime ÂàùÂßãÂåñÔºöÂä†ËΩΩÊâÄÊúâÁ±ª Initializers ÔºöÊâßË°å load ÊñπÊ≥ïÂíå __attribute__((constructor)) ‰øÆÈ•∞ÁöÑÂáΩÊï∞ BuildËøáÁ®ãÂú®ÈÄâÊã©Â∑•Á®ãÂêé‰ºöÂá∫Áé∞‰∏ãÈù¢ËøôÊ†∑ÁöÑÂá†‰∏™ÈÄâÈ°πÔºö Build PhasesBuild Phases ‰ª£Ë°®ÁùÄÂ∞Ü‰ª£Á†ÅËΩ¨Âèò‰∏∫ÂèØÊâßË°åÊñá‰ª∂ÁöÑÊúÄÈ´òÁ∫ßÂà´ËßÑÂàô„ÄÇÈáåÈù¢ÊèèËø∞‰∫Ü build ËøáÁ®ã‰∏≠ÂøÖÈ°ªÊâßË°åÁöÑ‰∏çÂêåÁ±ªÂûãËßÑÂàô„ÄÇ È¶ñÂÖàÊòØ target ‰æùËµñÈ°πÁöÑÊûÑÂª∫„ÄÇËøôÈáå‰ºöÂëäËØâ build Á≥ªÁªüÔºåbuild ÂΩìÂâçÁöÑ target ‰πãÂâçÔºåÂøÖÈ°ªÂÖàÂØπËøôÈáåÁöÑ‰æùËµñÊÄßËøõË°å build„ÄÇÂÆûÈôÖ‰∏äËøôÂπ∂‰∏çÂ±û‰∫éÁúüÊ≠£ÁöÑ build phaseÔºåÂú®ËøôÈáåÔºåXcode Âè™‰∏çËøáÂ∞ÜÂÖ∂‰∏é build phase ÊòæÁ§∫Âà∞‰∏ÄÂùóÁΩ¢‰∫Ü„ÄÇ Êé•ÁùÄÂú® build phase‰∏≠ÊòØ‰∏Ä‰∏™ CocoaPods Áõ∏ÂÖ≥ÁöÑËÑöÊú¨ script execution „ÄÇÊé•ÁùÄÂú® Compile Sources section ‰∏≠ËßÑÂÆö‰∫ÜÊâÄÊúâÂøÖÈ°ªÂèÇ‰∏éÁºñËØëÁöÑÊñá‰ª∂„ÄÇÊ≠§Â§ÑÂàóÂá∫ÁöÑÊâÄÊúâÊñá‰ª∂Â∞ÜÊ†πÊçÆÁõ∏ÂÖ≥ÁöÑ rules Âíå settings Ë¢´Â§ÑÁêÜ„ÄÇ ÂΩìÁºñËØëÁªìÊùü‰πãÂêéÔºåÊé•‰∏ãÊù•Â∞±ÊòØÂ∞ÜÁºñËØëÊâÄÁîüÊàêÁöÑÁõÆÊ†áÊñá‰ª∂ÈìæÊé•Âà∞‰∏ÄÂùó„ÄÇÊ≥®ÊÑèËßÇÂØüÔºåXcode ‰∏≠ÁöÑ build phase ‰πãÂêéÊòØÔºö‚ÄùLink Binary with Libraries.‚Äù ËøôÈáåÈù¢ÂàóÂá∫‰∫ÜÊâÄÊúâÁöÑÈùôÊÄÅÂ∫ìÂíåÂä®ÊÄÅÂ∫ìÔºåËøô‰∫õÂ∫ì‰ºöÂèÇ‰∏é‰∏äÈù¢ÁºñËØëÈò∂ÊÆµÁîüÊàêÁöÑÁõÆÊ†áÊñá‰ª∂ËøõË°åÈìæÊé•„ÄÇ ÂΩìÈìæÊé•ÂÆåÊàê‰πãÂêéÔºåbuild phase ‰∏≠ÊúÄÂêéÈúÄË¶ÅÂ§ÑÁêÜÁöÑÂ∞±ÊòØÂ∞ÜÈùôÊÄÅËµÑÊ∫êÔºà‰æãÂ¶ÇÂõæÁâáÂíåÂ≠ó‰ΩìÔºâÊã∑Ë¥ùÂà∞ app bundle ‰∏≠„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂ¶ÇÊûúÂõæÁâáËµÑÊ∫êÊòØPNGÊ†ºÂºèÔºåÈÇ£‰πà‰∏ç‰ªÖ‰ªÖÂØπÂÖ∂ËøõË°åÊã∑Ë¥ùÔºåËøò‰ºöÂÅö‰∏Ä‰∫õ‰ºòÂåñÔºàÂÜÖÈÉ®Â∑≤ÁªèÈõÜÊàê‰∫ÜÁ¨¨‰∏âÊñπpng‰ºòÂåñÂ∑•ÂÖ∑pngcrush,ÂÆÉÂèØ‰ª•Âú®ÁºñËØëÊó∂ÂØπpngÊ†ºÂºèÊñá‰ª∂ËøõË°å‰ºòÂåñÂíåÂéãÁº©Ôºâ„ÄÇ ËôΩÁÑ∂ÈùôÊÄÅËµÑÊ∫êÁöÑÊã∑Ë¥ùÊòØ build phase ‰∏≠ÁöÑÊúÄÂêé‰∏ÄÊ≠•Ôºå‰ΩÜ build ËøòÊ≤°ÊúâÂÆåÊàê„ÄÇ‰æãÂ¶ÇÔºåËøòÊ≤°ÊúâËøõË°å code signing ÔºàËøôÂπ∂‰∏çÊòØ build phase ËÄÉËôëÁöÑËåÉÁï¥ÔºâÔºåcode signing Â±û‰∫é build Ê≠•È™§‰∏≠ÁöÑÊúÄÂêé‰∏ÄÊ≠• ‚ÄúPackaging‚Äù„ÄÇ Build RulesBuild rules ÊåáÂÆö‰∫Ü‰∏çÂêåÁöÑÊñá‰ª∂Á±ªÂûãËØ•Â¶Ç‰ΩïÁºñËØë„ÄÇ‰∏ÄËà¨Êù•ËØ¥ÔºåÂºÄÂèëËÄÖÂπ∂‰∏çÈúÄË¶Å‰øÆÊîπËøôÈáåÈù¢ÁöÑÂÜÖÂÆπ„ÄÇÂ¶ÇÊûú‰Ω†ÈúÄË¶ÅÂØπÁâπÂÆöÁ±ªÂûãÁöÑÊñá‰ª∂Ê∑ªÂä†Â§ÑÁêÜÊñπÊ≥ïÔºåÈÇ£‰πàÂèØ‰ª•Âú®Ê≠§Â§ÑÊ∑ªÂä†‰∏ÄÊù°Êñ∞ÁöÑËßÑÂàô„ÄÇ‰∏ÄÊù° build rule ÊåáÂÆö‰∫ÜÂÖ∂Â∫îÁî®‰∫éÂì™ÁßçÁ±ªÂûãÊñá‰ª∂ÔºåËØ•Á±ªÂûãÊñá‰ª∂ÊòØÂ¶Ç‰ΩïË¢´Â§ÑÁêÜÁöÑÔºå‰ª•ÂèäËæìÂá∫ÁöÑÂÜÖÂÆπËØ•Â¶Ç‰ΩïÂ§ÑÁΩÆ„ÄÇ Build SettingsËá≥Ê≠§ÔºåÊàë‰ª¨Â∑≤Áªè‰∫ÜËß£Âà∞Âú® build phases ‰∏≠ÊòØÂ¶Ç‰ΩïÂÆö‰πâ build Â§ÑÁêÜÁöÑËøáÁ®ãÔºå‰ª•Âèä build rules ÊòØÂ¶Ç‰ΩïÊåáÂÆöÂì™‰∫õÊñá‰ª∂Á±ªÂûãÂú®ÁºñËØëÈò∂ÊÆµÈúÄË¶ÅË¢´È¢ÑÂ§ÑÁêÜ„ÄÇÂú® build settings ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÖçÁΩÆÊØè‰∏™‰ªªÂä°ÁöÑËØ¶ÁªÜÂÜÖÂÆπ„ÄÇ ‰Ω†‰ºöÂèëÁé∞ build ËøáÁ®ãÁöÑÊØè‰∏Ä‰∏™Èò∂ÊÆµÔºåÈÉΩÊúâËÆ∏Â§öÈÄâÈ°πÔºö‰ªéÁºñËØë„ÄÅÈìæÊé•‰∏ÄÁõ¥Âà∞ code signing Âíå packaging„ÄÇÊ≥®ÊÑèÔºåsettings ÊòØÂ¶Ç‰ΩïË¢´ÂàÜÂâ≤‰∏∫‰∏çÂêåÁöÑÈÉ®ÂàÜ ‚Äì ÂÖ∂ÂÆûËøôÂ§ßÈÉ®ÂàÜ‰ºö‰∏é build phases ÊúâÂÖ≥ËÅîÔºåÊúâÊó∂ÂÄô‰πü‰ºöÊåáÂÆöÁºñËØëÁöÑÊñá‰ª∂Á±ªÂûã„ÄÇ Â∑•Á®ãÊñá‰ª∂‰∏äÈù¢Êàë‰ª¨‰ªãÁªçÁöÑÊâÄÊúâÂÜÖÂÆπÈÉΩË¢´‰øùÂ≠òÂú®Â∑•Á®ãÊñá‰ª∂Ôºà.pbxprojÔºâ‰∏≠ÔºåÈô§‰∫ÜÂÖ∂ÂÆÉ‰∏Ä‰∫õÂ∑•Á®ãÁõ∏ÂÖ≥‰ø°ÊÅØÔºà‰æãÂ¶Ç file groupsÔºâÔºåÊàë‰ª¨ÂæàÂ∞ë‰ºöÊ∑±ÂÖ•ËØ•Êñá‰ª∂ÂÜÖÈÉ®ÔºåÈô§ÈùûÂú®‰ª£Á†Å merge Êó∂ÂèëÁîüÂÜ≤Á™ÅÔºåÊàñËÆ∏‰ºöËøõÂéªÁúãÁúã„ÄÇ Â¶ÇÊûúÁî®ÊñáÊú¨ÁºñËæëÂô®ÊâìÂºÄ‰∏Ä‰∏™Â∑•Á®ãÊñá‰ª∂Ôºå‰ªéÂ§¥Âà∞Â∞æÁúã‰∏ÄÈÅçÈáåÈù¢ÁöÑÂÜÖÂÆπ„ÄÇÂÆÉÁöÑÂèØËØªÊÄßÈùûÂ∏∏È´òÔºåÈáåÈù¢ÁöÑËÆ∏Â§öÂÜÖÂÆπ‰∏ÄÁúãÂ∞±Áü•ÈÅì‰ªÄ‰πàÊÑèÊÄù‰∫ÜÔºå‰∏ç‰ºöÂ≠òÂú®Â§™Â§ßÁöÑÈóÆÈ¢ò„ÄÇÈÄöËøáÈòÖËØªÂπ∂ÂÆåÂÖ®ÁêÜËß£Â∑•Á®ãÊñá‰ª∂ÔºåËøôÂØπ‰∫éÂêàÂπ∂Â∑•Á®ãÊñá‰ª∂ÁöÑÂÜ≤Á™ÅÈùûÂ∏∏ÊúâÂ∏ÆÂä©„ÄÇ È¶ñÂÖàÔºåÊàë‰ª¨Êù•ÁúãÁúãÊñá‰ª∂‰∏≠Âè´ÂÅö rootObject ÁöÑÊù°ÁõÆ„ÄÇÂú®ÊàëÁöÑÂ∑•Á®ã‰∏≠ÔºåÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö 1rootObject = 1793817C17A9421F0078255E /* Project object */; Ê†πÊçÆËøô‰∏™ IDÔºà1793817C17A9421F0078255EÔºâÔºåÊàë‰ª¨ÂèØ‰ª•ÊâæÂà∞ main Â∑•Á®ãÁöÑÂÆö‰πâÔºö 1234/* Begin PBXProject section */ 1793817C17A9421F0078255E /* Project object */ = &#123; isa = PBXProject;... Âú®ËøôÈÉ®ÂàÜ‰∏≠Êúâ‰∏Ä‰∫õ keysÔºåÈ°∫‰ªéËøô‰∫õ keyÔºåÊàë‰ª¨ÂèØ‰ª•‰∫ÜËß£Âà∞Êõ¥Â§öÂÖ≥‰∫éËøô‰∏™Â∑•Á®ãÊñá‰ª∂ÁöÑÁªÑÊàê„ÄÇ‰æãÂ¶ÇÔºåmainGroup ÊåáÂêë‰∫Ü root file group„ÄÇÂ¶ÇÊûú‰Ω†ÊåâÁÖßËøô‰∏™ÊÄùË∑ØÔºå‰Ω†ÂèØ‰ª•Âø´ÈÄü‰∫ÜËß£Âà∞Âú® .pbxproj Êñá‰ª∂‰∏≠Â∑•Á®ãÁöÑÁªìÊûÑ„ÄÇ 123456789101112131415161718191BC1E1511ACBEFFA0042431B = &#123; isa = PBXGroup; children = ( B62C765C1D9B71D300CB2CD4 /* OKit.framework */, 230935DA1C4F3D9C0070A5B3 /* QiNiuManager.xcodeproj */, 23D1991E1C2B8FF600E1DE8A /* Debug.xcodeproj */, 0DD10D591C28FB4900ADF8E5 /* Track.xcodeproj */, 0D106DDC1BE70BF600C49E7B /* Interface.xcodeproj */, 0D106D761BE7052800C49E7B /* Model.xcodeproj */, 0DC641041C0D427A007025D5 /* Wallet.xcodeproj */, 0DC641A41C0D997C007025D5 /* Tool.xcodeproj */, 0DC641CA1C0D9ADB007025D5 /* Location.xcodeproj */, 1BC1E1631ACBEFFA0042431B /* Mike */, 1BC1E15C1ACBEFFA0042431B /* Frameworks */, 1BC1E15B1ACBEFFA0042431B /* Products */, FF0DD481DA78D64E15039700 /* Pods */, ); sourceTree = "&lt;group&gt;";&#125;; ‰∏ãÈù¢Êù•Áúã‰∏Ä‰∫õ‰∏é build ËøáÁ®ãÁõ∏ÂÖ≥ÁöÑÂÜÖÂÆπ„ÄÇÂÖ∂‰∏≠ target key ÊåáÂêë‰∫Ü build target ÁöÑÂÆö‰πâÔºö 123targets = ( 1BC1E1591ACBEFFA0042431B /* Mike */,); Ê†πÊçÆÁ¨¨‰∏Ä‰∏™ÂÜÖÂÆπÔºåÊàë‰ª¨ÊâæÂà∞‰∏Ä‰∏™ target ÁöÑÂÆö‰πâÔºö 123456789101112131415161718192021222324252627282930313233341BC1E1591ACBEFFA0042431B /* Mike */ = &#123; isa = PBXNativeTarget; buildConfigurationList = 1BC1E1861ACBEFFA0042431B /* Build configuration list for PBXNativeTarget "Mike" */; buildPhases = ( E2E1BAED1E12657500A4F13C /* ShellScript */, D328411202E8C8A158C68A9A /* [CP] Check Pods Manifest.lock */, 32F9C08DAB34C3D77A8CD59E /* [CP] Check Pods Manifest.lock */, 1BC1E1561ACBEFFA0042431B /* Sources */, 1BC1E1571ACBEFFA0042431B /* Frameworks */, 1BC1E1581ACBEFFA0042431B /* Resources */, 7C20CC96F9690C1C11011773 /* [CP] Embed Pods Frameworks */, 1DBEA7A742BF77DA6EC31CEB /* [CP] Copy Pods Resources */, 2337E6001BCDF5EC007659ED /* ShellScript */, 2CA588C55C8E11D9779AABF0 /* üì¶ Embed Pods Frameworks */, 789C695793C24ECAC7D8420E /* üì¶ Copy Pods Resources */, B60684181D9924B00003E3E5 /* Embed Frameworks */, ); buildRules = ( ); dependencies = ( 230935E91C4F55B20070A5B3 /* PBXTargetDependency */, 23D199251C2B918700E1DE8A /* PBXTargetDependency */, 0DD10D601C28FB5D00ADF8E5 /* PBXTargetDependency */, 0DE3C0941C0F103000184463 /* PBXTargetDependency */, 0DE3C0921C0F102D00184463 /* PBXTargetDependency */, 2390C7521C0DB98B008C31B1 /* PBXTargetDependency */, 0D106DE41BE70C2600C49E7B /* PBXTargetDependency */, 0D106D7E1BE7060100C49E7B /* PBXTargetDependency */, ); name = Mike; productName = Mike; productReference = 1BC1E15A1ACBEFFA0042431B /* Mike.app */; productType = "com.apple.product-type.application"; &#125;; ÂÖ∂‰∏≠ buildConfigurationList ÊåáÂêë‰∫ÜÂèØÁî®ÁöÑÈÖçÁΩÆÈ°πÔºå‰∏ÄËà¨ÊòØ Debug Âíå Release„ÄÇ 1234567891BC1E1861ACBEFFA0042431B /* Build configuration list for PBXNativeTarget "Mike" */ = &#123; isa = XCConfigurationList; buildConfigurations = ( 1BC1E1871ACBEFFA0042431B /* Debug */, 1BC1E1881ACBEFFA0042431B /* Release */, ); defaultConfigurationIsVisible = 0; defaultConfigurationName = Release;&#125;; Ê†πÊçÆ debug ÂØπÂ∫îÁöÑ idÔºåÊàë‰ª¨ÂèØ‰ª•ÊâæÂà∞ build setting tab ‰∏≠ÊâÄÊúâÈÄâÈ°πÂ≠òÂÇ®ÁöÑ‰ΩçÁΩÆÔºö 123456789101BC1E1871ACBEFFA0042431B /* Debug */ = &#123; isa = XCBuildConfiguration; baseConfigurationReference = 31FD03C25841C700BD562061 /* Pods-Mike.debug.xcconfig */; buildSettings = &#123; ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon; ASSETCATALOG_COMPILER_LAUNCHIMAGE_NAME = LaunchImage; CLANG_CXX_LANGUAGE_STANDARD = "compiler-default"; CLANG_CXX_LIBRARY = "compiler-default"; CLANG_ENABLE_OBJC_ARC = YES; ... buildPhases Â±ûÊÄßÂàôÁÆÄÂçïÁöÑÂàóÂá∫‰∫ÜÂú® Xcode ‰∏≠ÂÆö‰πâÁöÑÊâÄÊúâ build phases„ÄÇËøôÈùûÂ∏∏ÂÆπÊòìËØÜÂà´Âá∫Êù•ÔºàXcode ‰∏≠ÁöÑÂèÇÊï∞‰ΩøÁî®‰∫ÜÂÆÉ‰ª¨ÂéüÊú¨ÁúüÊ≠£ÁöÑÂêçÂ≠óÔºåÂπ∂‰ª• C È£éÊ†ºËøõË°åÊ≥®ÈáäÔºâ„ÄÇbuildRules Â±ûÊÄßÊòØÁ©∫ÁöÑÔºöÂõ†‰∏∫Âú®ËØ•Â∑•Á®ã‰∏≠ÔºåÊàëÊ≤°ÊúâËá™ÂÆö‰πâ build rules„ÄÇdependencies ÂàóÂá∫‰∫ÜÂú® Xcode build phase tab ‰∏≠ÂàóÂá∫ÁöÑ target ‰æùËµñÈ°π„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Xcode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-Native Â¶Ç‰ΩïÂàõÂª∫ÂéüÁîü View Ê∫êÁ†ÅËß£Êûê]]></title>
    <url>%2F2017%2F01%2F24%2FRN%E6%98%BE%E7%A4%BA%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[Ââç‰∏ÄÁØáÔºå‰∏ªË¶ÅËÆ≤‰∫Ü RN Â¶Ç‰ΩïÂàùÂßãÂåñ‰∏Ä‰∏™ BCTBatchedBridgeÔºåËøô‰∏ÄÁØáÂ∞ÜËøõ‰∏ÄÊ≠•Á†îÁ©∂ RN ÊòØÂ¶Ç‰ΩïÈÄöËøáËøô‰∏™ bridge ÂàõÂª∫Âá∫ÁúüÊ≠£Â±ïÁ§∫Âá∫Êù•ÁöÑ View ÁöÑ„ÄÇ È¶ñÂÖàÊäõÂá∫ÁªìËÆ∫ÔºöÊØè‰∏Ä‰∏™ js render() ÊñπÊ≥ï‰∏≠ÁöÑ component ÈÉΩÂØπÂ∫î‰∫é native ‰∏≠ÁöÑ‰∏Ä‰∏™ RCTView„ÄÇÂú®Ê∏≤ÊüìÂâçÔºåjs ‰ºöÂæ™ÁéØÂèñÂá∫ÂêÑ‰∏™ component „ÄÇÁÑ∂ÂêéÈÄöËøá UIManager ÔºàNativeModules ‰∏≠ÁöÑ‰∏ÄÈ°πÔºâ ÁöÑ createView ÊñπÊ≥ïÔºåÈÄöËøá BatchedBridge Ë∞ÉÁî® native Á´ØÁöÑ RCTUIManager ÁöÑÂêåÂêçÊñπÊ≥ïÔºåÂàõÂª∫‰∏é component Áõ∏ÂØπÂ∫îÁöÑÁ±ª„ÄÇÂØπ‰∫éËß¶Êë∏‰∫ã‰ª∂‰πüÊòØÁ±ª‰ººÁöÑ„ÄÇnative Á´ØÈÄöËøá bridge Â∞ÜËß¶Êë∏‰∫ã‰ª∂‰º†Áªô jsÔºåjs Âú®ÊâæÂà∞ÂØπÂ∫î component ÂêéÔºåÂìçÂ∫îÂêÑ‰∏™Ëß¶Êë∏‰∫ã‰ª∂„ÄÇ ‰∏ãÈù¢Â∞ÜÂàÜÂá†‰∏™Èò∂ÊÆµËß£ËØª RN ÊòØÂ¶Ç‰ΩïÊòæÁ§∫Âá∫Êù•ÁöÑÔºå‰æùÊóßÊòØ 0.39 ÁâàÊú¨„ÄÇÊúÄÂ•ΩÂú®ÁêÜËß£‰∫ÜÂâç‰∏ÄÁØá RN ÈÄö‰ø°ÂéüÁêÜÂêéÂÜçÁúã„ÄÇ native Ë∞ÉÁî® jsËøôÊòØÊï¥‰∏™ËøáÁ®ãÁöÑÁ¨¨‰∏ÄÊ≠•Ôºå‰ªé RCTRootView *rootView = [[RCTRootView alloc] initWithBridge:_bridge moduleName:moduleName initialProperties:param]; ÊñπÊ≥ïÂºÄÂßã„ÄÇnative ÂëäËØâ js ÊàëË¶ÅÂáÜÂ§áÊòæÁ§∫ view ‰∫ÜÔºåÂø´ÁÇπÊää‰Ω†ËøôÈáåÂêÑ‰∏™ view ÁöÑ‰ø°ÊÅØÂëäËØâÊàë„ÄÇÂÖàÊù•Áúã‰∏ÄÂº†Ë∞ÉÁî®ÊµÅÁ®ãÂõæÔºö tag1Ëøô‰∏™ setBridge ÊñπÊ≥ïÊòØÂàùÂßãÂåñÊó∂ÂÄôÊâßË°åÁöÑÊñπÊ≥ï„ÄÇËøòËÆ∞ÂæóÂâç‰∏ÄÁØáÂàùÂßãÂåñÁöÑÊó∂ÂÄôÂÖ∂‰∏≠ÁöÑ‰∏ÄÊ≠•ËÆæÁΩÆÂêÑ‰∏™ RCTModuleData ÁöÑ instance ‰πàÔºüÂÖ∂‰∏≠Â∞±‰ºöË∞ÉÁî® setBridge ÊñπÊ≥ï‰∏∫ÊØè‰∏™ RCTModuleData ÁöÑ instance ËÆæÁΩÆ bridge„ÄÇÂú® RCTUIManager Á±ªÁöÑ setBridge ÊñπÊ≥ï‰∏≠ËøòÂÅö‰∫Ü‰∏Ä‰∫õÂÖ∂‰ªñÊìç‰ΩúÔºö 123456789101112- (void)setBridge:(RCTBridge *)bridge&#123; ... NSMutableDictionary *componentDataByName = [NSMutableDictionary new]; for (Class moduleClass in _bridge.moduleClasses) &#123; if ([moduleClass isSubclassOfClass:[RCTViewManager class]]) &#123; RCTComponentData *componentData = [[RCTComponentData alloc] initWithManagerClass:moduleClass bridge:_bridge]; componentDataByName[componentData.name] = componentData; &#125; &#125; _componentDataByName = [componentDataByName copy]; ...&#125; ËØ•ÊñπÊ≥ïÂæ™ÁéØÈÅçÂéÜ bridge ‰∏≠ÁöÑÊØè‰∏Ä‰∏™Êö¥Èú≤Áªô js ÁöÑÊ®°ÂùóÂêçÔºåÂà§Êñ≠ÊòØÂê¶ÊòØ RCTViewManager ÁöÑÂ≠êÁ±ª„ÄÇÂ¶ÇÊûúÊòØÔºåÂàô‰∏∫ÂÖ∂ÂàõÂª∫‰∏Ä‰∏™ RCTComponentData Âπ∂Â∞ÜÂÖ∂‰øùÂ≠òÂú® _componentDataByName Â≠óÂÖ∏‰∏≠„ÄÇRCTViewManager ÊòØÂêÑ‰∏™ RCTView ÁöÑÊéßÂà∂Âô®ÁöÑÁà∂Á±ªÔºåÊâÄÊúâ RCTView ÁöÑÊñπÊ≥ïÈÉΩÂú® RCTViewManager ÁöÑÂ≠êÁ±ªÈáåÂÆûÁé∞„ÄÇËøôÊ†∑Â∞±ÊääÊâÄÊúâËßÜÂõæÊéßÂà∂Âô®‰øùÂ≠òÂú®‰∫Ü RCTUIManager ‰∏≠„ÄÇ tag2ÁúãÂà∞Ëøô‰∏™ÊñπÊ≥ïÁöÑÂêçÂ≠óÂ∞±Áü•ÈÅìÊòØÂú® bundle Âä†ËΩΩÂÆåÊàêÂêéÊâßË°åÁöÑ„ÄÇ Ëøô‰∏™ÊñπÊ≥ïÂàÜ‰∏∫‰∏§Ê≠•„ÄÇÁ¨¨‰∏ÄÊ≠•ÊòØÂàõÂª∫‰∏Ä‰∏™ _contentView Áî®Êù•ÂÆπÁ∫≥ÂêÑ‰∏™ component„ÄÇÁ¨¨‰∫åÊ≠•Â∞±ÊòØÈÄöËøá BatchedBridge Ë∞ÉÁî® js ÁöÑÊñπÊ≥ï‰∫Ü„ÄÇÈÉ®ÂàÜ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 12345678910- (void)bundleFinishedLoading:(RCTBridge *)bridge&#123; ... _contentView = [[RCTRootContentView alloc] initWithFrame:self.bounds bridge:bridge reactTag:self.reactTag sizeFlexiblity:_sizeFlexibility]; [self runApplication:bridge]; ...&#125; ÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™Âú∞ÊñπÈúÄË¶ÅËØ¥ÊòéÔºåÂ∞±ÊòØËøôÈáåÈù¢ÁöÑ self.reactTag„ÄÇÁ±ª‰ºº‰∫é RN ÈÄö‰ø°ÁöÑÂéüÁêÜÔºåreactTag ÊòØ native Âíå js ËØÜÂà´ÂêÑ‰∏™ component ÁöÑÊ†áËÆ∞„ÄÇÊù•Áúã‰∏Ä‰∏ã reactTag ÁöÑ getter ÊñπÊ≥ïÔºö 123456789101112131415- (NSNumber *)reactTag&#123; RCTAssertMainQueue(); if (!super.reactTag) &#123; self.reactTag = [_bridge.uiManager allocateRootTag]; &#125; return super.reactTag;&#125;- (NSNumber *)allocateRootTag&#123; NSNumber *rootTag = objc_getAssociatedObject(self, _cmd) ?: @1; objc_setAssociatedObject(self, _cmd, @(rootTag.integerValue + 10), OBJC_ASSOCIATION_RETAIN_NONATOMIC); return rootTag;&#125; ÊØè‰∏Ä‰∏™Ê†πËßÜÂõæÈÉΩÂøÖÈ°ªÊúâ‰∏Ä‰∏™Áã¨‰∏ÄÊó†‰∫åÁöÑ ractTag„ÄÇËøô‰∏™ tag ‰ªé1ÂºÄÂßãÔºåÊØèÊ¨°Ëá™Â¢û10Ôºå‰πüÂ∞±ÊòØ 1Ôºå11Ôºå21Ôºå31‚Ä¶ÁöÑÂΩ¢ÂºèÔºå‰ª•Ê≠§Á±ªÊé®„ÄÇ ËøôÈáåË¶ÅÂêêÊßΩ‰∏Ä‰∏ã facebook ÁöÑÁ®ãÂ∫èÂëò„ÄÇÊ≤°ÊÉ≥Âà∞Â§ñÂõΩÁöÑÁ®ãÂ∫èÂëò‰πü‰ºöÊääÂçïËØçÊãºÈîô„ÄÇ‰∏äÈù¢ÊñπÊ≥ï‰∏≠ sizeFlexiblity Â∞ë‰∫Ü‰∏™ i„ÄÇËøôÊòØË¶ÅËæìÂÖ•Ê≥ïËÉåÈîÖ‰πàÔºü tag3ËØ•ÊñπÊ≥ïÈ¶ñÂÖà‰∏∫ rootView Êñ∞Âª∫‰∫Ü RCTTouchHandler ÂÆû‰æãÔºåÂπ∂ËÆæÁΩÆ‰∏∫ÂÖ∂ GestureRecognizer„ÄÇÂÖ∂Ê¨°ÊâßË°å‰∫Ü registerRootView:withSizeFlexibility: ÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïÂ∞Ü rootView ‰øùÂ≠òÂú® RCTUIManager ÁöÑ _viewRegistry Â≠óÂÖ∏‰∏≠ÔºåÂÖ∂‰∏≠ÈîÆÊòØ rootView ÁöÑ reactTag„ÄÇÊ≠§Êó∂ÔºåRCTUIManager ‰∏≠ËÆæÁΩÆÂπ∂‰øùÂ≠òÂ•Ω‰∫Ü‰∏§‰∏™ÊØîËæÉÈáçË¶ÅÁöÑÂ≠óÂÖ∏Ôºö_viewRegistry,_componentDataByName„ÄÇ tag4Ëøô‰∏™ÊñπÊ≥ïÂ∞±ÊØîËæÉÁõ¥ËßÇ‰∫ÜÔºö 1234567891011121314- (void)runApplication:(RCTBridge *)bridge&#123; NSString *moduleName = _moduleName ?: @""; NSDictionary *appParameters = @&#123; @"rootTag": _contentView.reactTag, @"initialProps": _appProperties ?: @&#123;&#125;, &#125;; RCTLogInfo(@"Running application %@ (%@)", moduleName, appParameters); [bridge enqueueJSCall:@"AppRegistry" method:@"runApplication" args:@[moduleName, appParameters] completion:NULL];&#125; Â∞±ÊòØË∞ÉÁî® enqueueJSCall:method:args:completion: ÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÂâç‰∏ÄÁØáÁúãÊáÇ‰∫ÜÁöÑËØùÔºåÂ∞±‰ºöÁü•ÈÅìÔºåËøô‰∏™ÊñπÊ≥ïË∞ÉÁî®ÁöÑÊòØ js Á´Ø AppRegistry.js ÁöÑ runApplication ÊñπÊ≥ïÔºåÈúÄË¶ÅÂàõÂª∫ÁöÑ rootView ‰ª• String ÁöÑÊñπÂºèÈÄöËøá moduleName ‰º†ÂÖ•„ÄÇ Âà∞Ëøô‰∏ÄÊ≠•ÔºåNative Ë∞ÉÁî® JS Â∞±ÁªìÊùü‰∫ÜÔºåÊé•‰∏ãÊù•Â∞±ÊòØ js Á´ØÁöÑÊâßË°å„ÄÇ js Ë∞ÉÁî® nativejs Á´ØÁöÑÊñπÊ≥ïË∞ÉÁî®ËøáÁ®ãËøòÊòØÊØîËæÉÊ∏ÖÊô∞ÁöÑ„ÄÇÊù•Áúã‰∏Ä‰∏ã‰∏ãÈù¢ÁöÑÊµÅÁ®ãÂõæÔºö tag1Âú® native Ë∞ÉÁî® enqueueJSCall:method:args:completion ÂêéÔºåÊàë‰ª¨Êù•ÁúãÁúã AppRegistry ÁöÑ runApplication ÊñπÊ≥ï„ÄÇ 1234 runApplication: function(appKey: string, appParameters: any): void &#123;... runnables[appKey].run(appParameters); &#125;, appKey Â∞±ÊòØ‰∏äÈù¢ÁöÑ moduleNameÔºåÈÄöËøáÂÆÉÊãøÂà∞ runnables Â≠óÂÖ∏‰∏≠ÂØπÂ∫îÁöÑÂØπË±°ÔºåÊâßË°åÂÖ∂ run ÊñπÊ≥ï„ÄÇËøô‰∏™Â≠óÂÖ∏ÊÄé‰πàÊù•ÁöÑÂë¢ÔºüÂæÄ‰∏ãÁúã„ÄÇ tag2RN ÁöÑÂÆòÊñπÊñáÊ°£‰∏≠Á¨¨‰∏ÄÁØáÂ∞±ËØ¥Êòé‰∫ÜÔºåÂú®ÂÆö‰πâÂ•Ω‰∏Ä‰∏™ component ÂêéÔºåÈúÄË¶ÅÂú® index.ios.js ‰∏≠‰ΩøÁî® AppRegistry.registerComponent() ÊñπÊ≥ïÊ≥®ÂÜå: 12import HelloWorldView from './app/view/HelloWorldView';AppRegistry.registerComponent('HelloWorldView', () =&gt; HelloWorldView); ÈÇ£‰πà registerComponent ÂÅö‰∫Ü‰ªÄ‰πàÂë¢Ôºü 1234567registerComponent: function(appKey: string, getComponentFunc: ComponentProvider): string &#123; runnables[appKey] = &#123; run: (appParameters) =&gt; renderApplication(getComponentFunc(), appParameters.initialProps, appParameters.rootTag) &#125;; return appKey;&#125; ËøôÈáåÂ∞±ËÆæÁΩÆ‰∫ÜÂâçÈù¢Áî®Âà∞ÁöÑ runnables Â≠óÂÖ∏ÔºåÂπ∂‰∏î‰∏∫Â≠óÂÖ∏ÂÜÖÂØπË±°ÂàõÂª∫‰∫Ü run ÊñπÊ≥ï„ÄÇÂâçÈù¢ÊâßË°åÁöÑ run ÊñπÊ≥ïÔºåÂÖ∂ÂÆûÂ∞±ÊòØÊâßË°å renderApplication ÊñπÊ≥ï„ÄÇrenderApplication Âú® RootView Â§ñÂ±ÇÂèàÂµåÂ•ó‰∫Ü‰∏ÄÂ±Ç AppContainer„ÄÇ tag3Ëøô‰∏™ÊñπÊ≥ïÂÜÖÈÉ®Â∞±ÊØîËæÉÂ§çÊùÇ‰∫Ü„ÄÇÂÖ∂‰∏≠: 1var instance = instantiateReactComponent(nextWrappedElement, false); ÈÄöËøá instantiateReactComponent ÊñπÊ≥ïÂ∞ÜÊï¥‰∏™ View ÁöÑ JSX ËΩ¨Êç¢‰∏∫ ReactCompositeComponentWrapper ÂÆû‰æã„ÄÇËøô‰πüÂ∞±ÊòØ Reactjs ÁöÑÁ≤æÈ´ì‰πã‰∏Ä„ÄÇÂ•ΩÂêß„ÄÇÂπ∂Ê≤°ÊúâËä±Êó∂Èó¥ÂéªÁªÜËØªÔºåËá£Â¶æÂÅö‰∏çÂà∞Âïä„ÄÇÊúâÂÖ¥Ë∂£ÁöÑËØùÂèØ‰ª•ÊâæÊâæÁ±ª‰ºº‰∫é reactjsÊ∫êÁ†ÅÂàÜÊûê-‰∏äÁØáÔºàÈ¶ñÊ¨°Ê∏≤ÊüìÂÆûÁé∞ÂéüÁêÜÔºâ ÁöÑÊñáÁ´†Â≠¶‰π†‰∏Ä‰∏ã„ÄÇ‰πãÂêéÂ∞±ÊòØÈïøÈïøÁöÑË∞ÉÁî®Ê†à‰∫ÜÔºåÂæ™ÁéØÈÄíÂΩíÊØè‰∏Ä‰∏™ component ÊâßË°å createView„ÄÇ tag4Âú® ReactNativeBaseComponent.js ‰∏≠Ë∞ÉÁî®‰∫Ü UIManager.createView()Ôºå‰ΩÜÊòØËøô‰∏™ÊñπÊ≥ïÁÇπ‰∏çËøõÂéªÔºåUIManager.js ‰∏≠Ê≤°ÊúâËøô‰∏™ÊñπÊ≥ï„ÄÇÂºÄÂßãÊàëÊØîËæÉËø∑ÊÉëÔºåÂêéÊù•ÁªÜËØª‰∫Ü‰∏Ä‰∏ãÂèëÁé∞Ôºö 1const &#123; UIManager &#125; = NativeModules; ‰πüÂ∞±ÊòØËØ¥ÔºåËøô‰∏™ UIManager ÊòØ native ‰∏≠ÁöÑ‰∏Ä‰∏™ moduleÔºåËøô‰∏™ createView() ÊòØ native ‰∏≠Êö¥Èú≤Âá∫Êù•ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ï„ÄÇ 123456UIManager.createView( tag, this.viewConfig.uiViewClassName, nativeTopRootTag, updatePayload); Ëøô‰∏™ÊñπÊ≥ï‰ºöÂ∞ÜÂΩìÂâç component ÁöÑÊ†áËÆ∞ÔºåÂêçÂ≠óÔºåÊ†πÊ†áËÆ∞ÔºåÂ±ûÊÄßÊñπÊ≥ïÁ≠â‰∏ÄËµ∑‰º†Áªô native„ÄÇÂÖ∂‰∏≠ tag ÊòØ ReactNativeTagHandles.allocateTag() ÁîüÊàêÁöÑ„ÄÇÊØèÊ¨°Ë∞ÉÁî®ËØ•ÊñπÊ≥ïÔºåtag ÈÉΩ‰ºöÂä†‰∏ÄÔºà‰ºöÁï•Ëøá1ÁªìÂ∞æÁöÑÔºåÈÇ£‰∫õÊòØÁïôÁªôÊ†π component ÁöÑÔºâ„ÄÇ Ëá≥Ê≠§Ôºåjs Ë∞ÉÁî® native ÁöÑÈÉ®ÂàÜÂ∞±ÁªìÊùü‰∫Ü„ÄÇÂõûÈ°æ‰∏Ä‰∏ãÔºå‰∏ªË¶ÅÂ∞±ÊòØÂæ™ÁéØÊØè‰∏Ä‰∏™ componentÔºå‰∏∫ÊØè‰∏™ component ÂàÜÈÖç‰∏Ä‰∏™Áã¨ÊúâÁöÑ tag ÁÑ∂ÂêéË∞ÉÁî® createView ÊñπÊ≥ï„ÄÇ Native createView ÁöÑËøáÁ®ãÊù•Âà∞ nativeÔºåRCTUIManager Êö¥Èú≤Âá∫‰∫ÜËÆ∏Â§öÊñπÊ≥ï‰æõ js Ë∞ÉÁî®„ÄÇÊù•Áúã‰∏Ä‰∏ãÂàöÊâç js Ë∞ÉÁî®ÁöÑ createView ÊñπÊ≥ïÔºö 123456789101112131415161718192021RCT_EXPORT_METHOD(createView:(nonnull NSNumber *)reactTag viewName:(NSString *)viewName rootTag:(__unused NSNumber *)rootTag props:(NSDictionary *)props)&#123; RCTComponentData *componentData = _componentDataByName[viewName]; ... __weak RCTUIManager *weakManager = self; dispatch_async(dispatch_get_main_queue(), ^&#123; RCTUIManager *uiManager = weakManager; if (!uiManager) &#123; return; &#125; UIView *view = [componentData createViewWithTag:reactTag]; if (view) &#123; [componentData setProps:props forView:view]; // Must be done before bgColor to prevent wrong default ... uiManager-&gt;_viewRegistry[reactTag] = view; &#125; &#125;);&#125; _componentDataByName ‰∏äÈù¢‰ªãÁªçËøá‰∫ÜÔºåÂèØ‰ª•ÊãøÂà∞ÂâçÈù¢‰øùÂ≠òÁöÑ js Â∞ÜË¶ÅÂàõÂª∫ÁöÑ view ÁöÑ RCTComponentData„ÄÇÁÑ∂ÂêéÂú®‰∏ªÁ∫øÁ®ã‰∏≠‰ΩøÁî® createViewWithTag: ÊñπÊ≥ïÂàõÂª∫ View„ÄÇÈÄöËøá RCTComponentData ‰∏≠‰øùÂ≠òÁöÑ _managerClass ÂèØ‰ª•ÊãøÂà∞ÂØπÂ∫î View ÁöÑ managerÔºåÁÑ∂ÂêéË∞ÉÁî®ÂÖ∂ view ÊñπÊ≥ïÂàõÂª∫ view„ÄÇ 123456789101112131415- (UIView *)createViewWithTag:(NSNumber *)tag&#123; UIView *view = [self.manager view]; view.reactTag = tag; ... return view;&#125;- (RCTViewManager *)manager&#123; if (!_manager) &#123; _manager = [_bridge moduleForClass:_managerClass]; &#125; return _manager;&#125; ÈÄöËøá setProps:forView: ÊñπÊ≥ïÂ∞ÜÊØè‰∏™ view ÁöÑ props ‰øùÂ≠ò‰∏ãÊù•„ÄÇËøôÈáåÂèàË¶ÅÁî®Âà∞ÂèçÂ∞ÑÁöÑÊñπÂºèÔºåËøòÊòØÊØîËæÉÂ§çÊùÇÁöÑ„ÄÇÂÖ∑‰ΩìÂ∞±‰∏çËØ¥‰∫Ü„ÄÇÂè™Ë¶ÅÊ∏ÖÊ•öÔºåÂÆÉ‰ºöÁîüÊàê‰∏Ä‰∏™ blockÔºåÊØèÊ¨°ÈÉΩÁî®Ëøô‰∏™ blockÔºåÈÉΩ‰ºöË∞ÉÁî®ÂØπÂ∫îÂ±ûÊÄßÁöÑ setter ÊñπÊ≥ïÂ∞ÜÂÄºËµãÁªôËØ•Â±ûÊÄßÂç≥ÂèØ„ÄÇ ÊúÄÂêéÔºåÊääËÆæÁΩÆÂ•ΩÁöÑ view ‰øùÂ≠òÂà∞ _viewRegistry ‰∏≠„ÄÇjs Âíå native Á´ØÈÉΩ‰ºö‰øùÂ≠òÂ•ΩËøô‰∏™ tag Âíå view ÁöÑÊò†Â∞ÑË°®„ÄÇËøôÈáåÁöÑ _viewRegistry Â∞±ÊòØ native Á´Ø‰øùÂ≠òÁöÑÂ≠óÂÖ∏„ÄÇ ËøôÈáåÂè™ÊòØ‰ªãÁªç‰∫ÜÂ¶Ç‰ΩïÈÄöËøá js ‰º†Êù•ÁöÑ tag Âíå moduleName ÂàõÂª∫Âá∫ÂØπÂ∫îÁöÑ native Á´ØÁöÑ view ÁöÑ„ÄÇÂΩìÁÑ∂ÔºåÂàõÂª∫ÂíåÂ±ïÁ§∫‰∏≠Èó¥ËøòÈöîÁùÄ measure„ÄÅlayout‰πãÁ±ªÁöÑÊ≠•È™§ÔºåËøô‰πüÊòØ React ÈúÄË¶ÅÂÅöÁöÑÔºåËøô‰∏™ÊàëÂ∞±‰∏çËÅä‰∫ÜÔºåÂ§™Ê∑±ÂÖ•‰∫ÜËÅä‰∏çÂä®ÔºåÂÆπÊòìËÅäÁàÜ„ÄÇ Ëá™Âª∫ÁªÑ‰ª∂Áé∞Âú®Êàë‰ª¨Áü•ÈÅì view ÊòØÂ¶Ç‰ΩïÂàõÂª∫Âá∫Êù•ÁöÑ‰∫Ü„ÄÇfacebook Â∞ÅË£ÖÁöÑÁªÑ‰ª∂ÂíåËá™Âª∫ÁöÑÁªÑ‰ª∂ÂéüÁêÜ‰∏äÊòØ‰∏ÄËá¥ÁöÑ„ÄÇÁé∞Âú®Êù•Á†îÁ©∂‰∏Ä‰∏ãËá™Âª∫ÁªÑ‰ª∂ÁöÑÂàõÂª∫ËøáÁ®ã„ÄÇ Âü∫Êú¨ËÆæÁΩÆÂâçÈù¢ËØ¥Âà∞ÊãøÂà∞ view ÁöÑ manager Ë∞ÉÁî®ÂÖ∂ view ÊñπÊ≥ï„ÄÇÈÇ£‰πà manager ÊòØ‰∏™‰ªÄ‰πàÂë¢Ôºümanager Áõ∏ÂΩì‰∫é‰∏Ä‰∏™ ControllerÔºåË¥üË¥£ÂàõÂª∫ÂíåÊéßÂà∂ view„ÄÇÊñáÊ°£‰∏äÂÖ≥‰∫éÂàõÂª∫ RCTViewManager ‰∏ªË¶ÅÊúâ‰∏âÊ≠•Ôºö ÂàõÂª∫‰∏Ä‰∏™Â≠êÁ±ª Ê∑ªÂä† RCT_EXPORT_MODULE() Ê†áËÆ∞ÂÆè ÂÆûÁé∞ -(UIView *)view ÊñπÊ≥ï Ëøô‰∏âÊ≠•ÊòØÊúÄÂü∫Êú¨ÁöÑ‰∏âÊ≠•Ôºå‰ΩúÁî®‰πüÊå∫ÊòéÊòæÁöÑ„ÄÇÁªßÊâø RCTViewManager ‰Ωú‰∏∫‰∏Ä‰∏™Ê†áËÆ∞ÔºåËøôÊ†∑ RCTUIManager Âú®ËÆæÁΩÆ bridge ÁöÑÊó∂ÂÄôÂ∞±ËÉΩÂ§üÂ∞ÜËØ• manager ÊîæÂÖ• _componentDataByName Êï∞ÁªÑ‰∏≠‰∫Ü„ÄÇÊ∑ªÂä† RCT_EXPORT_MODULE() Ê†áËÆ∞ÂÆèÂêéÊâçËÉΩÂ∞ÜËØ•Á±ªÊö¥Èú≤Áªô jsÔºåÊâçËÉΩËÆ© js Ë∞ÉÁî®ËØ•Á±ªÊñπÊ≥ï„ÄÇÂÆûÁé∞ -(UIView *)view ÊñπÊ≥ïÂ∞±ÊòØ‰∏äÈù¢ [self.manager view] Ë∞ÉÁî®ÁöÑÊñπÊ≥ï„ÄÇ ËÆæÁΩÆÂ±ûÊÄß‰∏äÈù¢Âè™ÊòØÂàõÂª∫‰∫Ü‰∏Ä‰∏™ viewÔºåÊõ¥Â§çÊùÇ‰∏ÄÁÇπÁöÑÊÉÖÂÜµÂ∞±ÊòØÈúÄË¶ÅÊéßÂà∂ view ÁöÑÂ±ûÊÄß„ÄÇRN Êèê‰æõ‰∫Ü‰∏§‰∏™ÂÆèÔºö RCT_EXPORT_VIEW_PROPERTY(name,type) RCT_CUSTOM_VIEW_PROPERTY(name,type,viewClass){...} Êù•Áúã‰∏Ä‰∏ãÂÆèÂÆö‰πâÁöÑÂÆûÁé∞Ôºö 12345678910// Â∏∏ËßÑÂØºÂá∫#define RCT_EXPORT_VIEW_PROPERTY(name, type) \+ (NSArray&lt;NSString *&gt; *)propConfig_##name &#123; return @[@#type]; &#125;// Ëá™ÂÆö‰πâÂØºÂá∫#define RCT_CUSTOM_VIEW_PROPERTY(name, type, viewClass) \RCT_REMAP_VIEW_PROPERTY(name, __custom__, type) \- (void)set_##name:(id)json forView:(viewClass *)view withDefaultView:(viewClass *)defaultView#define RCT_REMAP_VIEW_PROPERTY(name, keyPath, type) \+ (NSArray&lt;NSString *&gt; *)propConfig_##name &#123; return @[@#type, @#keyPath]; &#125; ÂÖ≥‰∫é ## Âíå @# Ââç‰∏ÄÁØá‰πüÊúâÊ∂âÂèä„ÄÇÊìç‰ΩúÁ¨¶ ## Áî®Êù•ÂÆûÁé∞ÂÆè‰∏≠ token ÁöÑËøûÊé•Ôºå @# ÂÆûÁé∞Â∞ÜÂÆè‰∏≠ÁöÑÂèÇÊï∞ËΩ¨Âåñ‰∏∫Â≠óÁ¨¶‰∏≤„ÄÇÊØîÂ¶Ç RCT_EXPORT_VIEW_PROPERTY(placeholder, NSString) ËøôÊ†∑‰∏Ä‰∏™Â±ûÊÄßÔºåÂ∞Ü‰ºöË¢´ËΩ¨Âåñ‰∏∫‰∏ãÈù¢Ëøô‰∏™ÊñπÊ≥ïÔºö 1+ (NSArray&lt;NSString *&gt; *)propConfig_placeholder &#123; return @[@"NSString"]; &#125; ‰ΩÜÂ¶ÇÊûúË¶ÅÂØπÂ±ûÊÄßËøõË°å‰πüË∞¢Êìç‰ΩúÁöÑËØùÔºåÊØîÂ¶ÇÔºö 1234RCT_CUSTOM_VIEW_PROPERTY(fontSize, NSNumber, RCTTextView)&#123; view.font = [RCTFont updateFont:view.font withSize:json ?: @(defaultView.font.pointSize)];&#125; ËøôÊ†∑ÁöÑËá™ÂÆö‰πâÂ±ûÊÄßÔºåÂàô‰ºöËΩ¨Âåñ‰∏∫Â¶Ç‰∏ãÊñπÊ≥ïÔºö 1234+ (NSArray&lt;NSString *&gt; *)propConfig_fontSize &#123; return @[@"NSNumber", @"__custom__"]; &#125;- (void)set_fontSize:(id)json forView:(RCTTextView *)view withDefaultView:(RCTTextView *)defaultView&#123; view.font = [RCTFont updateFont:view.font withSize:json ?: @(defaultView.font.pointSize)];&#125; ÂÖ∂‰∏≠ json ‰ª£Ë°®‰∫Ü JS ‰∏≠‰º†ÈÄíÁöÑÂ∞öÊú™Ëß£ÊûêÁöÑÂéüÂßãÂÄº„ÄÇview ‰ª£Ë°®ËÆøÈóÆÁöÑÂØπÂ∫îÁöÑËßÜÂõæÂÆû‰æã„ÄÇdefaultView Âú® JS ÂèëÈÄÅ null ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ÊääËßÜÂõæÁöÑËøô‰∏™Â±ûÊÄßÈáçÁΩÆÂõûÈªòËÆ§ÂÄº„ÄÇ ËøôÈáåËØ¥‰∏Ä‰∏ãËøô‰∏™ defaultViewÔºåËøôÊòØ RCTComponentData ‰∏≠ÁöÑ‰∏Ä‰∏™Â±ûÊÄßÔºå‰∏çÁî®Âú®ÊÑè‰πü‰∏çÁî®Ëá™Â∑±ËÆæÁΩÆÂÆÉ„ÄÇÂú® json ‰∏∫Á©∫ÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÂéªËá™Â∑±ÂàõÂª∫‰∏Ä‰∏™ÂΩìÂâç view ÁöÑÂÆû‰æã‰Ωú‰∏∫ defaultViewÔºö 12345//RCTComponentData.m propBlockForKey:inDictionaryif (!json &amp;&amp; !strongSelf-&gt;_defaultView) &#123; // Only create default view if json is null strongSelf-&gt;_defaultView = [strongSelf createViewWithTag:nil];&#125; ÂÆèÂÆö‰πâÁöÑÊñπÊ≥ïÂú®‰∏äÈù¢ËØ¥ËøáÁöÑ setProps:forView: ÊñπÊ≥ïÈáåË∞ÉÁî®ÔºåÁõÆÁöÑÊòØÈ™åËØÅ‰ªé js Á´Ø‰º†ÈÄíËøáÊù•ÁöÑÂ±ûÊÄßÊòØÂê¶Âú® native ÈáåÊ≥®ÂÜåËøá„ÄÇ Ëá≥‰∫éËøòÊúâ‰∏Ä‰∫õÈùûÂ∏∏ËßÑÁöÑÈúÄË¶ÅÁî®Âà∞ RCTConvert ‰ª•Âèä‰∫ã‰ª∂ÁöÑ‰ΩøÁî®ÊñπÂºèÂèØ‰ª•ÂèÇËÄÉÊñáÊ°£Ôºå‰∏çÊ∑±ÂÖ•‰∫Ü„ÄÇ ÂàõÂª∫ ViewÂâçÈù¢ËØ¥Ëøá‰∫ÜÂ¶Ç‰ΩïÂàõÂª∫ ControllerÔºåÁé∞Âú®ËØ¥‰∏Ä‰∏ãËøô‰∏™ view„ÄÇ 1234- (UIView *)view&#123; return [[MKMapView alloc] init];&#125; ËøôÊòØÂÆòÊñπÊñáÊ°£ÈáåÁöÑ‰æãÂ≠êÔºåÂú® manager ‰∏≠ÁöÑ view ÊñπÊ≥ïÈáåÂàõÂª∫‰∫Ü‰∏Ä‰∏™ MKMapView ÁöÑËßÜÂõæ„ÄÇÈÇ£‰πà RN ÊòØÂ¶Ç‰ΩïËÆæÁΩÆ MKMapView ÁöÑ frame ÁöÑÂë¢Ôºü‰∏çÁî®ÊãÖÂøÉÔºåRN ÂÆûÁé∞‰∫Ü UIView ÁöÑËåÉÁï¥ UIView(React)ÔºåÂÖ∂‰∏≠Â∞±ÂÆûÁé∞‰∫Ü reactSetFrame ÊñπÊ≥ïÔºå‰ºöËá™Â∑±Â∞ÜËÆ°ÁÆóÂ•ΩÁöÑÂ§ßÂ∞èËÆæÁΩÆÁªô viewÔºåÂ¶ÇÊûú‰Ω†ÊÉ≥Âú® view ËÆæÁΩÆÂ•ΩÂ§ßÂ∞èÂêéÂÅö‰ªÄ‰πà‰∫ãÔºå‰Ω†Â∞±ÂèØ‰ª•ÈÄöËøáÈáçÂÜôËøô‰∏™ÊñπÊ≥ï„ÄÇÂè¶Â§ñÔºåÂΩì js Á´ØÁöÑ‰∏Ä‰∫õÂ±ûÊÄßÂèòÂåñÊó∂ÔºåÂ∞±‰ºöËß¶Âèë native Áõ∏Â∫î view ÁöÑÁõ∏Â∫îÂ±ûÊÄßÁöÑ setter ÊñπÊ≥ïÔºåÂèØ‰ª•Ëá™Â∑±ÂÆûÁé∞Ëøô‰∫õ setter ÊñπÊ≥ïÔºåÊù•ÂÅö‰∏Ä‰∫õÂà´ÁöÑÂ§ÑÁêÜÔºåÊØîÂ¶ÇÂú® RCTImageView ÈáåÔºåÂè™Ë¶Å‰ªªÊÑèÂ±ûÊÄßÂèëÁîüÂèòÂåñÔºåÈÉΩ‰ºöËß¶Âèë reloadImage ÊñπÊ≥ï„ÄÇ ÁªàÊÄªÁÆóÈÄöËøáËøô‰∏§ÁØáÂ∞Ü RN Á®çÂæÆÊ¢≥ÁêÜ‰∫Ü‰∏Ä‰∏ãÔºåË∑üËøõËµ∑Êù•‰∏çÂÆπÊòìÂïäÔºåÈÉΩÊòØÊ≥™„ÄÇÊú¨Êù•ÊÉ≥Á†îÁ©∂‰∏Ä‰∏ãÔºåÂÜô‰∏ÄÁØá ‚ÄúRN view ÊòæÁ§∫ÂéüÁêÜ‚Äù ÁöÑ„ÄÇ‰ΩÜÊòØËØªÁùÄËØªÁùÄÂèëÁé∞ Reactjs Âπ∂‰∏çËÉΩÁúãÊáÇÔºåÈÇ£ËøòÂÜô‰∏™ËõãÁöÑÊòæÁ§∫ÂéüÁêÜÂïäÂñÇ„ÄÇÊúÄÁªàÂ∞±ÂøΩÁï•‰∫Ü view ÁöÑÂ±ÇÊ¨°ÂÖ≥Á≥ª‰ª•ÂèäÂ§ßÂ∞è‰ΩçÁΩÆÁ≠âÁ≠âÁöÑËΩ¨Êç¢ÂéüÁêÜÔºåÂÜô‰∫ÜËøô‰πà‰∏ÄÁØá„ÄÇËôΩÁÑ∂ÂÜôÁöÑÊ∞¥Âπ≥‰∏çÈ´òÔºå‰ΩÜÊòØÊàëÁõ∏‰ø°Â¶ÇÊûú‰Ω†ÊÉ≥Êõ¥Ê∑±ÂÖ•ÁöÑ‰∫ÜËß£‰∏Ä‰∏ã react nativeÔºåËØª‰∏Ä‰∏ãÊú¨ÁØáËøòÊòØËÉΩÊúâ‰∫õËÆ∏Â∏ÆÂä©ÁöÑ„ÄÇÊØïÁ´ü‰∏∫‰∫ÜÁúãÊáÇÔºåÊàë‰πüËØª‰∫ÜÂ•Ω‰πÖÂ•Ω‰πÖ~~~ ‰πüËÆ∏‰ºöÊúâ‰∏ã‰∏ÄÁØáÔºå‰πüËÆ∏‰ºöÊåë‰∏Ä‰∏™ RN Â∞ÅË£ÖÁöÑÁªÑ‰ª∂ÂÖ∑‰ΩìÁúãÁúãÂÆÉÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑ~]]></content>
      <categories>
        <category>React-Native</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
        <tag>React-Native</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-Native ÂàùÂßãÂåñ‰∏éÈÄö‰ø°ÂéüÁêÜÊ∫êÁ†ÅÂàÜÊûê]]></title>
    <url>%2F2017%2F01%2F17%2FRN%20Native%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[RN ÊòØÂ¶Ç‰ΩïÂêØÂä®ÁöÑÔºåoc ‰∏é js ÊòØÂ¶Ç‰ΩïÈÄö‰ø°ÁöÑÂ∞ÜÊòØÊú¨ÊñáÊé¢Á©∂ÁöÑÈáçÁÇπ„ÄÇËôΩÁÑ∂ÁΩë‰∏äÂ∑≤ÁªèÊúâ‰∏çÂ∞ëËß£Èáä RN ÂéüÁêÜÁöÑÊñáÁ´†Ôºå‰ΩÜÊòØÂà∞Ëá™Â∑±ËØªËµ∑Ê∫êÁ†ÅÁöÑÊó∂ÂÄôÔºåËøòÊòØÈùûÂ∏∏Á¥Ø‰∫∫ÁöÑ„ÄÇËøôÈáåÔºåÂ∞ÜËæÉ‰∏∫ÁªÜËá¥ÁöÑÊ¢≥ÁêÜ‰∏Ä‰∏ã RN ÁöÑÊñπÊ≥ïË∞ÉÁî®ËøáÁ®ãÔºåÂ∏åÊúõËÉΩÂØπÂêÑ‰ΩçÊúâÊâÄÂ∏ÆÂä©„ÄÇ Êú¨Êñá‰∏ªË¶ÅÈíàÂØπ RN 0.39 ÁâàÊú¨Ôºå‰∏çÂêåÁâàÊú¨ÂèØËÉΩ‰ºöÁï•Êúâ‰∏çÂêå„ÄÇ‰∏çÂ§öbb RN ÁöÑÂü∫Êú¨Ê¶ÇË¶Å‰∫ÜÔºåÁõ¥Êé•ÂºÄÂßãÔºàÂª∫ËÆÆËØªËÄÖËøòÊòØÂÖàËá™Ë°å‰∫ÜËß£‰∏ã RN ÁöÑÂü∫Êú¨ÂéüÁêÜÔºåÊúâÂä©‰∫éÁêÜËß£Ôºâ„ÄÇ Native ÂàùÂßãÂåñËøáÁ®ãÂÖàÊù•‰∏ÄÂº†ÂÆåÊï¥ÁöÑÂàùÂßãÂåñÊµÅÁ®ãÂõæÔºö ‰∏ãÈù¢Â∞ÜÂØπÂÖ∂‰∏≠ÁöÑÈÉ®ÂàÜÊñπÊ≥ïÂÅö‰∏Ä‰∫õÊ≥®Èáä„ÄÇ tag11234RCTRootView *rootView = [[RCTRootView alloc] initWithBundleURL:jsCodeLocation moduleName:@"AwesomeProject" initialProperties:nil launchOptions:launchOptions]; ‰ªª‰Ωï RN ÁöÑ‰ΩøÁî®ËÄÖÈÉΩÂ∫îËØ•ÂØπËøô‰∏™ÊñπÊ≥ï‰∏çÈôåÁîü„ÄÇÂú® js Á´ØÂÜôÁöÑÂêÑ‰∏™ componentÔºåÈÉΩÂ∞ÜÂú® native ËΩ¨Êç¢Êàê RCTRootView ÁöÑÂΩ¢ÂºèÂ±ïÁé∞Âá∫Êù•„ÄÇ Ëøô‰∏™ÊñπÊ≥ïÂàÜ‰∏∫‰∏§Ê≠•ÔºåÁ¨¨‰∏ÄÊ≠•ÂàõÂª∫‰∏Ä‰∏™ RCTBridge ÁöÑÂÆû‰æãÔºåÂÆÉÊòØ oc ‰∏é js ‰∫§‰∫íÁöÑÊ°•Ê¢ÅÔºåÊï¥‰∏™ÂàùÂßãÂåñÁöÑËøáÁ®ãÂ∞±ÊòØÂàõÂª∫Ëøô‰∏™ Bridge„ÄÇÁ¨¨‰∫åÊ≠•ÈÄöËøáËøô‰∏™ Bridge ÂàõÂª∫‰∏Ä‰∏™ RCTRootView„ÄÇ ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑè‰∏Ä‰∏ã„ÄÇÂØπ‰∫é‰∏Ä‰∏™Âçä RN Âçä native ÁöÑÂ∫îÁî®ÔºàÂç≥‰∏çÊòØÈÄöËøá RN ÁöÑ navigator Ë∑≥ËΩ¨ÔºåËÄåÊòØÈÄöËøáÂéüÁîüË∑≥ËΩ¨Â•ΩÂêéÔºåÂÜçÂàÜÂà´ÂàõÂª∫ RN ÁöÑ viewÔºâÔºåÂàõÂª∫È°µÈù¢Êó∂‰∏çÂ∫îËØ•Áõ¥Êé•Ë∞ÉÁî® initWithBundleURL:moduleName:initialProperties:launchOptions: ÊñπÊ≥ï„ÄÇÂõ†‰∏∫ËøôÊ†∑ÊØèÊ¨°ÈÉΩË¶ÅÂàõÂª∫ RCTBridgeÔºåËøôÊòØ‰∏Ä‰∏™ËÄóÊó∂ËÄóËµÑÊ∫êÁöÑËøáÁ®ã„ÄÇÂ∫îËØ•‰∫ãÂÖàÂàõÂª∫Â•Ω RCTBridgeÔºåÂú®Ë¶ÅÂàõÂª∫È°µÈù¢ÁöÑÊó∂ÂÄôË∞ÉÁî® initWithBridge:moduleName:initialProperties: ÊñπÊ≥ï„ÄÇ tag2‰∏ÄÁï™Ë∑≥ËΩ¨Êù•Âà∞ setUp ÊñπÊ≥ïÂÜÖÔºå‰∏Ä‰∫õÊØîËæÉÊ¨°Ë¶ÅÁöÑ‰ª£Á†ÅÊØîÂ¶Ç Logger ÊàëÂ∞±‰∏çÂàÜÊûê‰∫ÜÔºö 1234567- (void)setUp&#123; ... [self createBatchedBridge]; [self.batchedBridge start]; ...&#125; ÂàõÂª∫Âπ∂ÊåÅÊúâ‰∫ÜÂÖ∂Â≠êÁ±ª RCTBatchedBridge ÁöÑÂÆû‰æã„ÄÇRCTBridge ‰∏≠ÂÖ∂ÂÆûÊ≤°ÊúâÂ§™Â§ö‰ª£Á†ÅÔºåÂàùÂßãÂåñÁöÑÂ§ßÈÉ®ÂàÜÈÄªËæëÈÉΩÂú® [self.batchedBridge start] ‰∏≠ÂÆåÊàê„ÄÇ tag3ÂàõÂª∫ RCTBatchedBridge ‰∏≠ÊúÄÈáçË¶ÅÁöÑÊñπÊ≥ïÂ∞±ÊòØ [self.batchedBridge start] ÊñπÊ≥ï„ÄÇËØ•ÊñπÊ≥ï‰∏ªË¶ÅÂåÖÂê´‰ª•‰∏ãÂá†Ê≠•: ËØªÂèñ js Ê∫êÁ†Å ÂàùÂßãÂåñÂêÑ‰∏™ÈúÄË¶ÅÁªô js Ë∞ÉÁî®ÁöÑÊ®°Âùó ÂàõÂª∫‰∏Ä‰∏™ JSContextÔºå‰∏∫ JSContext ËÆæÁΩÆÂ§ö‰∏™ÂõûË∞ÉÊñπÊ≥ï Â∞ÜÊ®°Âùó‰ø°ÊÅØÂÜôÂÖ•‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‰∏≠ Â∞ÜÂ≠óÁ¨¶‰∏≤‰º†ÈÄíÁªô js Á´Ø ÊâßË°å js Ê∫êÁ†Å ÂÖ∂‰∏≠ÂàõÂª∫‰∫Ü‰∏§‰∏™ GCDGroupÔºåÂàÜÂà´‰∏∫ initModulesAndLoadSource Âíå setupJSExecutorAndModuleConfig„ÄÇÂΩì3„ÄÅ4Ê≠•ÂÆåÊàêÂêéÊâçËÉΩÊâßË°åÁ¨¨5Ê≠•ÔºåÂΩì1„ÄÅ2„ÄÅ5ÈÉΩÂÆåÊàêÂêéÊâç‰ºöÊâßË°å6„ÄÇ tag4ÂºÇÊ≠•Âú∞ËØªÂèñ jsBundleÔºå‰º†ÂÖ•Âä†ËΩΩÊàêÂäüÂíåÊ≠£Âú®Âä†ËΩΩ‰∏≠ÁöÑÂõûË∞ÉÊñπÊ≥ï„ÄÇÊ≤°ÊúâÂ§™Â§öÂ•ΩËØ¥ÁöÑÔºåÈÉΩÊòØ‰∏Ä‰∫õÁ≥ªÁªü api ÁöÑË∞ÉÁî®„ÄÇ 123456789101112131415 [self loadSource:^(NSError *error, NSData *source, __unused int64_t sourceLength) &#123; if (error) &#123; RCTLogWarn(@"Failed to load source: %@", error); dispatch_async(dispatch_get_main_queue(), ^&#123; [weakSelf stopLoadingWithError:error]; &#125;); &#125; sourceCode = source; dispatch_group_leave(initModulesAndLoadSource); &#125; onProgress:^(RCTLoadingProgress *progressData) &#123;#ifdef RCT_DEV RCTDevLoadingView *loadingView = [weakSelf moduleForClass:[RCTDevLoadingView class]]; [loadingView updateProgress:progressData];#endif &#125;]; ÂÖ∂‰∏≠Ôºå[weakSelf stopLoadingWithError:error] Â∞±ÊòØÁªèÂ∏∏ÊâÄËßÅÁöÑÁ∫¢Â±èÊä•Èîô„ÄÇonProgress ÁöÑÂõûË∞ÉÊñπÊ≥ïË°®Á§∫ÔºåÂ¶ÇÊûúÂú®ÁúüÊú∫‰∏äÂä†ËΩΩÔºåÈÇ£‰πàÂú®Âä†ËΩΩÊó∂È°µÈù¢‰∏äÈÉ®ÊòæÁ§∫ ‚ÄúLoading from XXXX‚Äù ÁöÑÊèêÁ§∫„ÄÇ tag5initModulesWithDispatchGroup: ÊòØ‰∏Ä‰∏™ÊØîËæÉÂ§çÊùÇÁöÑÊñπÊ≥ïÔºåÁî®Êù•ÂàùÂßãÂåñÊ®°Âùó‰ø°ÊÅØ„ÄÇÊØè‰∏Ä‰∏™Â∞ÜË¶ÅÊö¥Èú≤Áªô js ÁöÑÊ®°ÂùóÈÉΩ‰ºö‰øùÂ≠ò‰∏∫ RCTModuleData ÁöÑÂΩ¢ÂºèÔºåÁÑ∂ÂêéË¢´Â≠òÂÇ®‰∏∫3ÂàÜÈÖçÁΩÆË°®„ÄÇ 1234567NSMutableArray&lt;Class&gt; *moduleClassesByID = [NSMutableArray new];NSMutableArray&lt;RCTModuleData *&gt; *moduleDataByID = [NSMutableArray new];NSMutableDictionary&lt;NSString *, RCTModuleData *&gt; *moduleDataByName = [NSMutableDictionary new];moduleDataByName[moduleName] = moduleData;[moduleClassesByID addObject:moduleClass];[moduleDataByID addObject:moduleData]; RCTRegisterModuleÈÇ£‰πàÔºåÂ¶Ç‰ΩïÊâæÂà∞Êö¥Èú≤Áªô js ÁöÑÊ®°ÂùóÂë¢ÔºüRN Êèê‰æõ‰∫Ü RCTRegisterModule(); ÁöÑÂÆèÔºö 123456789101112131415#define RCT_EXPORT_MODULE(js_name) \RCT_EXTERN void RCTRegisterModule(Class); \+ (NSString *)moduleName &#123; return @#js_name; &#125; \+ (void)load &#123; RCTRegisterModule(self); &#125;void RCTRegisterModule(Class moduleClass)&#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; RCTModuleClasses = [NSMutableArray new]; &#125;); // Register module [RCTModuleClasses addObject:moduleClass];&#125; ËøôÊ†∑Â∞±ÁîüÊàê‰∫Ü‰∏§‰∏™ÊñπÊ≥ïÔºö Âú®Á±ª load ÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöË∞ÉÁî® RCTRegisterModule ÊñπÊ≥ïÔºåÂ∞ÜÁ±ªËá™Âä®Ê≥®ÂÜåÂà∞ RCTModuleClasses Êï∞ÁªÑ‰∏≠„ÄÇÂè™Ë¶ÅÈÅçÂéÜËØ•Êï∞ÁªÑÔºåÂ∞±ËÉΩÂèñÂá∫ÊâÄÊúâÊö¥Èú≤Âá∫ÁöÑÊ®°Âùó„ÄÇ moduleName ÊñπÊ≥ïÔºåËøîÂõû @#js_name„ÄÇËøôÈáåÁöÑ @# ÁöÑ‰∏ÄÊó∂ÊòØÊääÂÆèÂèÇÊï∞ js_name ËΩ¨‰∏∫Â≠óÁ¨¶‰∏≤ÔºåÂï•‰πüÊ≤°ÊúâÔºåËøîÂõûÁöÑÂ∞±ÊòØÁ©∫„ÄÇÂΩìÁÑ∂Âú® RCTBridgeModuleNameForClass() Ëøô‰∏™Ëé∑ÂèñÊ®°ÂùóÂêçÁöÑÊñπÊ≥ïÈáåÔºåÂ¶ÇÊûú moduleName ÈïøÂ∫¶‰∏∫0ÔºåÈÇ£‰πàÂ∞±‰ºöË∞ÉÁî® NSStringFromClass() ÊñπÊ≥ïËé∑ÂèñÁ±ªÂêç„ÄÇ tag6Âú®ÊâÄÊúâË¶ÅÊö¥Èú≤Áªô js ÁöÑÁ±ª‰∏≠ÔºåRCTJSCExecutor ÊòØÊúÄÁâπÊÆäÁöÑ‰∏Ä‰∏™Á±ª„ÄÇÈúÄË¶ÅÁéáÂÖàÂàõÂª∫‰∏Ä‰∏™ÂÆû‰æãÂπ∂‰Ωú‰∏∫instance ‰øùÂ≠òÂú®‰∏Ä‰∏™ RCTModuleData ÁöÑÂÆû‰æã‰∏≠Ôºå‰ª•Èò≤ÂÖ∂‰ªñ module ÂèØËÉΩÈúÄË¶ÅÁî®Âà∞„ÄÇ Âú®ÂàõÂª∫ RCTJSCExecutor ÂÆû‰æãÁöÑÊó∂ÂÄôÔºåÂàõÂª∫‰∫Ü‰∏Ä‰∏™ JSThreadÔºåÊâÄÊúâÁöÑ JS ÈÄö‰ø°ÔºåÈÉΩÊòØÈÄöËøá RCTJSCExecutor ÊâßË°åÔºåÈÉΩÊòØÂú®Ëøô‰∏™ JSThread ÂÜÖ„ÄÇ tag7Èô§‰∫Ü RCTJSCExecutor ÁöÑÂÖ∂‰ªñÊ®°ÂùóÂÆû‰æãÂåñÁöÑËøáÁ®ãÈÉΩÊòØÂú® prepareModulesWithDispatchGroup: ‰∏≠ÂÆåÊàê„ÄÇÂÆû‰æãÂåñÊØè‰∏™Êö¥Èú≤ÁöÑÊ®°ÂùóÔºåÂπ∂Â∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ RCTModuleData ÁöÑ instance Â±ûÊÄß„ÄÇÂú® setUpMethodQueue ÊñπÊ≥ï‰∏≠Ôºå‰∏∫ÊØè‰∏Ä‰∏™Ê®°ÂùóÈÉΩ‰ºöÂàõÂª∫‰∏Ä‰∏™Ëá™Â∑±Áã¨ÊúâÁöÑ‰∏ìÂ±û‰∏≤Ë°åÈòüÂàóÔºå‰øùËØÅÊØè‰∏™Ê®°ÂùóÂÜÖÁöÑÈÄö‰ø°‰∫ã‰ª∂ÈÉΩÊòØ‰∏≤Ë°åÊâßË°åÁöÑ„ÄÇ tag8gatherConstants ÊñπÊ≥ï‰∏ªË¶ÅÂäüËÉΩÔºö 123RCTExecuteOnMainThread(^&#123; self-&gt;_constantsToExport = [self-&gt;_instance constantsToExport] ?: @&#123;&#125;;&#125;, YES); Â∞ÜÊ®°Âùó(instance)ÁöÑ‰∏Ä‰∫õÂ∏∏ÈáèËÆæÁΩÆÁªôÂêÑËá™ÁöÑ RCTModuleData ÂÆû‰æã‰∏≠„ÄÇ tag9Âú® setUp ÊñπÊ≥ï‰∏≠ÔºåJSThread ÂÜÖÂàõÂª∫‰∫Ü‰∏Ä‰∏™ JSContextÔºåÂπ∂‰∏î‰∏∫ Context ËÆæÁΩÆ‰∫Ü‰∏çÂêåÁöÑ blockÔºåÂ¶ÇÔºö 12345678910context[@"nativeFlushQueueImmediate"] = ^(NSArray&lt;NSArray *&gt; *calls)&#123; RCTJSCExecutor *strongSelf = weakSelf; if (!strongSelf.valid || !calls) &#123; return; &#125; RCT_PROFILE_BEGIN_EVENT(RCTProfileTagAlways, @"nativeFlushQueueImmediate", nil); [strongSelf-&gt;_bridge handleBuffer:calls batchEnded:NO]; RCT_PROFILE_END_EVENT(RCTProfileTagAlways, @"js_call");&#125;; Ëøô‰∫õ block ‰ºöÂú®ÁâπÂÆöÁöÑÂú∫ÂêàË∞ÉÁî®„ÄÇ‰πãÂêéÂ∞ÜÊúâ‰ªãÁªç„ÄÇ tag10123456789101112131415- (NSString *)moduleConfig&#123; NSMutableArray&lt;NSArray *&gt; *config = [NSMutableArray new]; for (RCTModuleData *moduleData in _moduleDataByID) &#123; if (self.executorClass == [RCTJSCExecutor class]) &#123; [config addObject:@[moduleData.name]]; &#125; else &#123; [config addObject:RCTNullIfNil(moduleData.config)]; &#125; &#125; return RCTJSONStringify(@&#123; @"remoteModuleConfig": config, &#125;, NULL);&#125; Âú® moduleConfig ÊñπÊ≥ï‰∏≠ÔºåÂêÑ‰∏™Ê®°ÂùóÂêçÂ∞ÜÂÖàË¢´Âä†ÂÖ• config Êï∞ÁªÑ‰∏≠ÔºåÁÑ∂ÂêéË¢´ËΩ¨Êç¢‰∏∫ json Â≠óÁ¨¶‰∏≤ÁöÑÂΩ¢Âºè„ÄÇËøôÈáåÂè™ÊòØÂÜôÂÖ•Ê®°ÂùóÂêçÔºö tag11Ëøô‰∏ÄÊ≠•Â∞Ü‰∏äÈù¢ÁöÑ JSON Â≠óÁ¨¶‰∏≤ÈÄöËøá JSExecutor ‰º†ÂÖ• JS ‰Ωú‰∏∫ÂÖ®Â±ÄÂèòÈáè„ÄÇÂèòÈáèÂêç‰∏∫ __fbBatchedBridgeConfig: 12345678- (void)injectJSONConfiguration:(NSString *)configJSON onComplete:(void (^)(NSError *))onComplete&#123; ... [_javaScriptExecutor injectJSONText:configJSON asGlobalObjectNamed:@"__fbBatchedBridgeConfig" callback:onComplete];&#125; tag 12ÂΩì‰∏äÈù¢ÊâÄÊúâÊ≠•È™§ÂÖ®ÈÉ®ÂÅöÂÆåÂêéÔºåÂ∞±ÂºÄÂßãÈÄöËøá executeSourceCode ÊâßË°å js ‰ª£Á†Å‰∫Ü„ÄÇ JSÂàùÂßãÂåñËøáÁ®ãnative Á´Ø injectJSONConfiguration Âè™ÊääÊ®°ÂùóÁöÑÂêçÁß∞ÁªÑÊàêÁöÑ JSON Â≠óÁ¨¶‰∏≤ÁΩÆÂÖ•‰∫Ü __fbBatchedBridgeConfigÔºåÈÇ£‰πà JS Á´ØÂ¶Ç‰ΩïÊãøÂà∞Ê®°ÂùóÁöÑÊñπÊ≥ï‰ª•Âèä‰∏Ä‰∫õÂ∏∏Èáè‰ø°ÊÅØÂë¢ÔºüÈúÄË¶ÅÊàë‰ª¨Á†îÁ©∂‰∏Ä‰∏ã JS Á´ØÁöÑÂàùÂßãÂåñËøáÁ®ã„ÄÇ NativeModulejs ÁöÑÊâìÂåÖÊñá‰ª∂Â¶Ç‰∏ãÊâÄÁ§∫Ôºö ÂèØ‰ª•ÁúãÂà∞ÔºåÂÖ∂‰∏≠ÂØºÂÖ•‰∫Ü NativeModule„ÄÇÂÆÉÂ∞±ÊòØÁî®Êù•Êé•Êî∂‰øùÂ≠ò native Á´ØÊö¥Èú≤ÁöÑÊ®°ÂùóÁöÑ„ÄÇ ÂÖàÊù•Áúã‰∏ÄÂº†Êï¥‰ΩìÁöÑÂàùÂßãÂåñÊµÅÁ®ãÂõæÔºö tag11234567891011121314151617181920const bridgeConfig = global.__fbBatchedBridgeConfig;invariant(bridgeConfig, '__fbBatchedBridgeConfig is not set, cannot invoke native modules');(bridgeConfig.remoteModuleConfig || []).forEach((config: ModuleConfig, moduleID: number) =&gt; &#123; // Initially this config will only contain the module name when running in JSC. The actual // configuration of the module will be lazily loaded. const info = genModule(config, moduleID); if (!info) &#123; return; &#125; if (info.module) &#123; NativeModules[info.name] = info.module; &#125; // If there's no module config, define a lazy getter else &#123; defineLazyObjectProperty(NativeModules, info.name, &#123; get: () =&gt; loadModule(info.name, moduleID) &#125;); &#125;&#125;); ËøôÈáåÁöÑ global.__fbBatchedBridgeConfig Â∞±ÊòØ native Ê≥®ÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÊòØÂêÑ‰∏™Ê®°ÂùóÂêç„ÄÇËøôÈáåËØ¥‰∏ÄËà¨ÊòØÂõ†‰∏∫Â¶ÇÊûúÊâìÂºÄ‰∫Ü Remote JS DebuggingÔºåÈÇ£‰πàËøôÈáåÂæóÂà∞ÁöÑÊòØÂåÖÊã¨ÊñπÊ≥ïÂêçÁöÑÂÖ®ÈÉ®ÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇÂ¶Ç‰∏ãÂõæÔºö (Ê≥®ÔºöÂºÄ‰∫Ü Remote JS Debugging Âêé js ‰ª£Á†ÅÊòØÂèØ‰ª•Êñ≠ÁÇπÁöÑÔºå‰ΩÜÊòØ Xcode ÁªèÂ∏∏ÊòæÁ§∫ __nw_connection_get_connected_socket_block_invoke xx Connection has no connected handler ÁÑ∂ÂêéÔºåXcode ÁöÑÊñ≠ÁÇπÂ∞±Â§±ÁÅµ‰∫Ü„ÄÇ) ÂÖ≥Èó≠ Remote JS DebuggingÔºåinfo.module ‰∏∫ nilÔºåÂõ†Ê≠§‰∏ÄÂÆö‰ºöËøêË°åÂà∞ get: () =&gt; loadModule(info.name, moduleID) ÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïÊòØ‰∏Ä‰∏™ÊáíÂä†ËΩΩÊñπÊ≥ïÔºå‰ª•Ê≠§Êù•Âä†Âø´ RN ÁöÑÂàùÂßãÂåñÈÄüÂ∫¶„ÄÇ ÁªèËøáËøô‰∏™ÊñπÊ≥ïÔºåÂ∞±Â∞ÜÊâÄÊúâÊö¥Èú≤Âá∫Êù•ÁöÑÊñπÊ≥ïÁöÑÊâßË°å‰ø°ÊÅØ‰øùÂ≠òÂú® NativeModule ÂØπË±°ÔºàÊàñËÄÖËØ¥Â≠óÂÖ∏Ôºå‰∏çÊòØÊï∞ÁªÑ„ÄÇÈîÆÊòØmoduleÂêçÔºåÂÄºÊòØÊ®°ÂùóÂÜÖÁöÑÊñπÊ≥ïÁªÑÊàêÁöÑÂØπË±°ÔºâÈáå‰∫Ü„ÄÇÔºàËøôÈáåÂπ∂‰∏çÊòØÂÖ®ÈÉ® ModuleCinfig ÈÉΩÂèòÊàê‰∫Ü NativeModules ÈáåÁöÑ‰∏ÄÈ°πÔºåÊØîÂ¶Ç‰∏Ä‰∫õÂÖ≥‰∫é view ÁöÑmanagerÔºåÂÆÉ‰ª¨Âπ∂Ê≤°ÊúâË∞ÉÁî®ÂêÑËá™ÁöÑÊáíÂä†ËΩΩÊñπÊ≥ï„ÄÇËøô‰∫õ manager ÁöÑÊñπÊ≥ïÈÉΩÂú®Âä†ËΩΩ RCTUIManager ÁöÑÊó∂ÂÄôÔºå‰Ωú‰∏∫ RCTUIManager ÁöÑ constants ËÆæÁΩÆÂ•Ω‰∫Ü„ÄÇÔºâ tag2ËøõÂÖ• loadModule ÊñπÊ≥ïÔºö 1234567function loadModule(name: string, moduleID: number): ?Object &#123; invariant(global.nativeRequireModuleConfig, 'Can\'t lazily create module without nativeRequireModuleConfig'); const config = global.nativeRequireModuleConfig(name); const info = genModule(config, moduleID); return info &amp;&amp; info.module;&#125; ÂèØ‰ª•ÁúãÂà∞Ë∞ÉÁî®‰∫Ü global.nativeRequireModuleConfig ÊñπÊ≥ïÔºå‰ª•Âèä genModule ÊñπÊ≥ï„ÄÇ tag3global.nativeRequireModuleConfig Â∞±ÊòØ native ÊµÅÁ®ãÂõæÁöÑ tag9ÔºåRCTJSCExecutor ÁöÑ setUp ÊñπÊ≥ï‰∏≠ÔºåÊ≥®ÂÜåÁöÑËØ∏Â§öÂõûË∞É‰∏≠ÁöÑ‰∏Ä‰∏™Ôºö 1234567891011context[@"nativeRequireModuleConfig"] = ^NSArray *(NSString *moduleName) &#123; RCTJSCExecutor *strongSelf = weakSelf; if (!strongSelf.valid) &#123; return nil; &#125; RCT_PROFILE_BEGIN_EVENT(RCTProfileTagAlways, @"nativeRequireModuleConfig", @&#123; @"moduleName": moduleName &#125;); NSArray *result = [strongSelf-&gt;_bridge configForModuleName:moduleName]; RCT_PROFILE_END_EVENT(RCTProfileTagAlways, @"js_call,config"); return RCTNullIfNil(result);&#125;; methods ÊñπÊ≥ï‰ºöÊãøÂà∞ÂØπÂ∫î RCTModuleData ÁöÑÊâÄÊúâÊñπÊ≥ïÔºåÁÑ∂ÂêéÂæ™ÁéØÊâæÂà∞‰ª• __rct_export__ ÂºÄÂ§¥ÁöÑÊñπÊ≥ï(‰∏∫‰ªÄ‰πàÊòØ‰ª• __rct_export__ ÂºÄÂ§¥ÂêéÈù¢ÂÜçËÆ≤)„ÄÇ JSMethodName ÊñπÊ≥ï‰ºöÊãøÂà∞ÊñπÊ≥ïÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂπ∂Êà™ÂèñÁ¨¨‰∏Ä‰∏™ÂÜíÂè∑ÂâçÁöÑÂ≠óÁ¨¶Ôºå‰Ωú‰∏∫ JS ÁÆÄÂÜôÊñπÊ≥ïÂêç„ÄÇ ÊúÄÂêéÂ∞ÜÂêÑ‰∏™ÊñπÊ≥ïÂ∏∏ÈáèÁ≠âÁªÑÊàê‰∏Ä‰∏™Êï∞ÁªÑÔºåÂç≥ÈúÄË¶ÅËøîÂõûÁöÑ config: 1234567NSArray *config = @[ self.name, RCTNullIfNil(constants), RCTNullIfNil(methods), RCTNullIfNil(promiseMethods), RCTNullIfNil(syncMethods)]; tag4Êù•Áúã‰∏Ä‰∏ã genModule ÊñπÊ≥ïÔºö 1234567891011function genModule(config: ?ModuleConfig, moduleID: number): ?&#123;name: string, module?: Object&#125; &#123; ... methods &amp;&amp; methods.forEach((methodName, methodID) =&gt; &#123; const isPromise = promiseMethods &amp;&amp; arrayContains(promiseMethods, methodID); const isSync = syncMethods &amp;&amp; arrayContains(syncMethods, methodID); invariant(!isPromise || !isSync, 'Cannot have a method that is both async and a sync hook'); const methodType = isPromise ? 'promise' : isSync ? 'sync' : 'async'; module[methodName] = genMethod(moduleID, methodID, methodType); &#125;); ...&#125; ÊãøÂà∞‰∫ÜÈÄöËøá global.nativeRequireModuleConfig ÊñπÊ≥ïËé∑ÂæóÁöÑÂÆåÊï¥ config ‰ø°ÊÅØ„ÄÇÂú®ËØ•ÊñπÊ≥ï‰∏≠ÈÄöËøá‰∏Ä‰∏™Âæ™ÁéØÔºåÂ∞ÜÊâÄÊúâ method ÊãøÂá∫ÔºåÂ≠òÂÖ•‰∏Ä‰∏™ module ÂØπË±°‰∏≠ÂéªÔºåÈîÆÊòØ method ÂêçÔºåÂÄºÊòØÈÄöËøá genMethod ÊñπÊ≥ïÁîüÊàêÁöÑ function„ÄÇ tag5ÂÜçË∑üËøõÂà∞ genMethod ÊñπÊ≥ï‰∏≠ÂéªÔºö 123456789101112131415161718192021222324function genMethod(moduleID: number, methodID: number, type: MethodType) &#123; let fn = null; if (type === 'promise') &#123; ... &#125; else &#123; fn = function(...args: Array&lt;any&gt;) &#123; const lastArg = args.length &gt; 0 ? args[args.length - 1] : null; const secondLastArg = args.length &gt; 1 ? args[args.length - 2] : null; const hasSuccessCallback = typeof lastArg === 'function'; const hasErrorCallback = typeof secondLastArg === 'function'; hasErrorCallback &amp;&amp; invariant( hasSuccessCallback, 'Cannot have a non-function arg after a function arg.' ); const onSuccess = hasSuccessCallback ? lastArg : null; const onFail = hasErrorCallback ? secondLastArg : null; const callbackCount = hasSuccessCallback + hasErrorCallback; args = args.slice(0, args.length - callbackCount); BatchedBridge.enqueueNativeCall(moduleID, methodID, args, onFail, onSuccess); &#125;; &#125; fn.type = type; return fn;&#125; Êàë‰ª¨Áé∞Âú®Âè™Áúã else ÁöÑÊÉÖÂÜµ„ÄÇ‰∏ªË¶ÅÂ∞±ÊòØÂ∞Ü moduleIDÔºåmethodIDÔºåÂèÇÊï∞‰ª•ÂèäÂ§±Ë¥•ÂíåÊàêÂäüÁöÑÂõûË∞ÉÂáΩÊï∞‰º†ÂÖ• BatchedBridge ÁöÑ enqueuenativeCall ÊñπÊ≥ï„ÄÇËøôÈáåÁöÑ moduleIDÔºåmethodIDÔºå ‰πüÂ∞±ÊòØ‰∏ÄËà¨ËÆ®ËÆ∫ RN ÂéüÁêÜÊó∂ÁªèÂ∏∏ÁúãÂà∞ÁöÑ ‚ÄúÈÄöËøáÊ®°Âùó„ÄÅÊñπÊ≥ïidÊâæÂà∞ÂØπÂ∫îÊ®°ÂùóÂíåÊñπÊ≥ï‚ÄùÔºåÂÖ∂ÂÆûÂ∞±ÊòØÂØπÂ∫îÊï∞ÁªÑ‰∏≠ÁöÑ‰∏ãÊ†á„ÄÇ Âè¶Â§ñÔºåÂÖ≥‰∫éÂèñÂá∫ÊàêÂäüÂíåÂ§±Ë¥•ÁöÑÂõûË∞ÉÊñπÊ≥ïÔºåÊòØÈÄöËøáÂà§Êñ≠ÊúÄÂêé‰∏§‰∏™ÂèÇÊï∞ÊòØÂê¶ÊòØÊñπÊ≥ïÊù•ÂæóÂà∞ÁöÑÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÊúÄÂêé‰∏Ä‰∏™ÊòØÊàêÂäüÁöÑÂõûË∞ÉÊñπÊ≥ïÔºåÂÄíÊï∞Á¨¨‰∫å‰∏™ÊòØÂ§±Ë¥•ÁöÑÂõûË∞ÉÊñπÊ≥ï„ÄÇÂõ†Ê≠§ÔºåÂ¶ÇÊûúÈúÄË¶ÅËÆæÁΩÆÂõûË∞ÉÊñπÊ≥ïÔºåÈÇ£‰πàÂøÖÈ°ªÊîæÂú®ÊúÄÂêéÔºå‰∏îÂõûË∞ÉÊñπÊ≥ï‰∏çËÉΩË∂ÖËøá‰∏§‰∏™„ÄÇ BatchedBridgeBatchedBridge ÊòØ‰∏™Âï•: 123456789const MessageQueue = require('MessageQueue');const BatchedBridge = new MessageQueue();...Object.defineProperty(global, '__fbBatchedBridge', &#123; configurable: true, value: BatchedBridge,&#125;); BatchedBridge ÊòØ‰∏Ä‰∏™ MessageQueue ÂÆû‰æã„ÄÇÂÖ∂Â∞ÜËá™Ë∫´ÂÜôÂÖ•ÂÖ®Â±ÄÂèòÈáè __fbBatchedBridge ‰∏äÔºåËøôÊ†∑ Native ÂèØ‰ª•ÈÄöËøá __fbBatchedBridge ÔºåËÆøÈóÆ JSBridgeÂØπË±°ÔºåÊØîÂ¶ÇÂú® RCTJSCExecutor.mm ÁöÑ _executeJSCall:arguments:unwrapResult:callback ÊñπÊ≥ï‰∏≠„ÄÇ MessageQueueÂú®ÂâçÈù¢ÁöÑ tag5 ‰∏≠Êàë‰ª¨ÁúãÂà∞ÔºågenModule ÊñπÊ≥ï‰∏≠ÁîüÊàêÁöÑ function Ë∞ÉÁî®‰∫Ü BatchedBridge ÁöÑ enqueuenativeCall„ÄÇËøô‰∏™ÊñπÊ≥ïÂ∞±ÂÆö‰πâÂú® MessageQueue.js ‰∏≠„ÄÇ ‰ª£Á†ÅÂ§™ÈïøÊàëÂ∞±Â∞±Ë¥¥ÈÉ®ÂàÜÂêßÔºåÂ§ßËá¥ÂàÜ‰∏∫ ‰∏™ÈÉ®ÂàÜÔºö È¶ñÂÖàÔºåÂú® MessageQueue ‰∏≠ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™‰ªé0ÂºÄÂßãÁöÑËÆ°Êï∞ÁöÑ _callbackIDÔºåÁî®Êù•Ê†áËØÜ js Á´ØÁöÑÂõûË∞ÉÂáΩÊï∞„ÄÇÂ∞Ü callbackID push ËøõÂèÇÊï∞Êï∞ÁªÑ params Èáå„ÄÇÁÑ∂ÂêéÔºåÂ∞ÜËøô‰∏™ callback ‰øùÂ≠òÂú®Êú¨Âú∞ÁöÑ _callbacks Êï∞ÁªÑ‰∏≠ÁöÑÂØπÂ∫î callbackID ‰ΩçÁΩÆ„ÄÇËøôÊ†∑ÔºåÂΩì native ‰º†Êù•ÂõûË∞ÉÁöÑ callbackID ÁöÑÊó∂ÂÄôÔºåÂ∞±ËÉΩÂú® _callbacks Êï∞ÁªÑ‰∏≠ÊâæÂà∞Âπ∂ÊâßË°åÁõ∏Â∫îÊñπÊ≥ï‰∫Ü„ÄÇ 1234onFail &amp;&amp; params.push(this._callbackID);this._callbacks[this._callbackID++] = onFail;onSucc &amp;&amp; params.push(this._callbackID);this._callbacks[this._callbackID++] = onSucc; ËÆæÁΩÆÂ•ΩÂõûË∞É‰πãÂêéÔºåÂ∞Ü moduleIDÔºåmethodIDÔºåparams ÂàÜÂà´ push Ëøõ _queueËøô‰∏™Êï∞ÁªÑÁöÑÂêÑ‰∏™‰ΩçÁΩÆ„ÄÇ‰∏ãÈù¢ÁöÑ MODULE_IDSÔºåMETHOD_IDSÔºåPARAMSÂàÜÂà´‰ª£Ë°®0Ôºå1Ôºå2„ÄÇ123this._queue[MODULE_IDS].push(moduleID);this._queue[METHOD_IDS].push(methodID);this._queue[PARAMS].push(params); ‰∏∫‰ªÄ‰πàË¶ÅÊääÊñπÊ≥ïÂèÇÊï∞ÊîæËøõ‰∏Ä‰∏™ _queue Êï∞ÁªÑÈáåÂë¢ÔºüÂõ†‰∏∫ js ‰∏çËÉΩ‰∏ªÂä®Ë∞ÉÁî®Èô§‰∫Ü‰∏äÈù¢ËÆæÁΩÆ JSContext ÁöÑÊó∂ÂÄôËÆæÁΩÆÁöÑÈÇ£‰∫õÂõûË∞ÉÊñπÊ≥ïÂ§ñÁöÑ native ÊñπÊ≥ïÔºåÊâÄ‰ª• js Á´ØÊÉ≥Ë∞ÉÁî® native Á´Ø‰ª£Á†ÅÁöÑÊó∂ÂÄôÔºåÂøÖÈ°ªÂ∞ÜÊÉ≥Ë¶ÅË∞ÉÁî®ÁöÑÊ®°Âùó„ÄÅÊñπÊ≥ï„ÄÅÂèÇÊï∞ÊîæÂú®‰∏Ä‰∏™Êï∞ÁªÑÈáåÔºåÁ≠âÂæÖ native Êù•Ëé∑ÂèñËøô‰∏™Êï∞ÁªÑÔºå‰πüÂ∞±ÊòØËøô‰∏™ _queue„ÄÇ‰ªÄ‰πàÊó∂ÂÄô native ÂõûÊù•Ë¶Å‰∏ÄÊ¨°Ëøô‰∏™Êï∞ÁªÑÂë¢ÔºüÊØîÂ¶ÇÂú®ÂÆåÊàê native Ë∞ÉÁî® js ÊñπÊ≥ïÂêéÔºö 123456[_javaScriptExecutor callFunctionOnModule:module method:method arguments:args callback:^(id json, NSError *error) &#123; [weakSelf _processResponse:json error:error]; &#125;]; ‰∏äÈù¢ÁöÑËøô‰∏™ÊñπÊ≥ïÂ∞±ÊòØ native Ë∞ÉÁî® js ÁöÑÊñπÊ≥ïÔºåÂÖ∑‰ΩìÁöÑË∞ÉÁî®ÊµÅÁ®ãÂú®ÂêéÈù¢‰ºöËØ¥Êòé„ÄÇÂèØ‰ª•ÁúãÂà∞ÔºåÂú® callback ÁöÑ block ÂÜÖÔºåÊúâ‰∏Ä‰∏™Âè´ÂÅö json ÁöÑÂÖ•ÂèÇÔºåËøô‰∏™ json Â∞±ÊòØ‰∏äÈù¢ÁöÑ _queue„ÄÇÂú® native Ë∞ÉÁî®ÂÆå js ÁöÑÊñπÊ≥ïÂêéÔºånative Â∞±‰ºöÊù•Â§ÑÁêÜ js ÊòØÂê¶ÈúÄË¶ÅË∞ÉÁî® native ÁöÑ‰ªÄ‰πàÊñπÊ≥ïÔºåÂπ∂‰∏îÂà∑Êñ∞ _queue Êï∞ÁªÑ„ÄÇ ÁªßÁª≠ÂàöÊâçÁöÑ enqueueNativeCall ÊñπÊ≥ïÂæÄ‰∏ãËµ∞ÊâßË°åÂà∞‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºö 12345if (global.nativeFlushQueueImmediate &amp;&amp; now - this._lastFlush &gt;= MIN_TIME_BETWEEN_FLUSHES_MS) &#123; global.nativeFlushQueueImmediate(this._queue); this._queue = [[], [], [], this._callID]; this._lastFlush = now;&#125; ËøôÈáåÁöÑ global.nativeFlushQueueImmediate Â∞±ÊòØ JSContext ËÆæÁΩÆÁöÑÂá†‰∏™ÂõûË∞ÉÊñπÊ≥ï‰∏≠ÁöÑ‰∏Ä‰∏™Ôºå‰æõ JS ‰∏ªÂä®Ë∞ÉÁî®„ÄÇÊù•Áúã‰∏Ä‰∏ãËøô‰∏™ÊñπÊ≥ïÔºö 12345678910context[@"nativeFlushQueueImmediate"] = ^(NSArray&lt;NSArray *&gt; *calls)&#123; RCTJSCExecutor *strongSelf = weakSelf; if (!strongSelf.valid || !calls) &#123; return; &#125; RCT_PROFILE_BEGIN_EVENT(RCTProfileTagAlways, @"nativeFlushQueueImmediate", nil); [strongSelf-&gt;_bridge handleBuffer:calls batchEnded:NO]; RCT_PROFILE_END_EVENT(RCTProfileTagAlways, @"js_call");&#125;; Ë∞ÉÁî®‰∫Ü nativeFlushQueueImmediate ÊñπÊ≥ïÂêéÂ∞±‰ºöÊâßË°å handleBuffer:batcheEnded: ÊñπÊ≥ïÊù•Âº∫Âà∂ native Êù•ÊâßË°å js ÈúÄË¶ÅË∞ÉÁî®ÁöÑ native ÊñπÊ≥ïÔºåÂπ∂‰∏îÂà∑Êñ∞ _queue Êï∞ÁªÑ„ÄÇ Âõ†Ê≠§ÔºåenqueueNativeCall ÊñπÊ≥ï‰∏≠ÁöÑËøôÊÆµ‰ª£Á†ÅË°®Á§∫ÔºåÂΩì‰∏äÊ¨°Âà∑Êñ∞ _queue Êï∞ÁªÑÁöÑÊó∂Èó¥ÂíåÂΩìÂâçÊó∂Èó¥Áõ∏ÊØîË∂ÖËøá‰∫Ü MIN_TIME_BETWEEN_FLUSHES_MS Âç≥5msÔºåÈÇ£‰πàÂ∞±‰ºö‰∏ªÂä®Ë∞ÉÁî® native ÁöÑ nativeFlushQueueImmediate ÊñπÊ≥ïÔºåÂº∫Âà∂ÊâßË°åÔºåÂà∑Êñ∞ _queue„ÄÇ Ê≥®ÊÑèÂà∞ÔºåËøôÈáåÊ∏ÖÁ©∫ÁöÑÊìç‰ΩúÔºöthis._queue = [[], [], [], this._callID];ÔºåÂ∞Ü _queue ÁöÑÁ¨¨ÂõõÈ°πËÆæÁΩÆ‰∏∫ _callID„ÄÇËøô‰∏™ _callID ÊØèÊ¨° enqueueNativeCall ÁöÑÊó∂ÂÄôÈÉΩ‰ºöËá™Â¢û‰∏ÄÊ¨°ÔºåÂ∫îËØ•Âè™ÊòØ‰∏Ä‰∏™Ê†áËÆ∞ÔºåÊöÇÊó∂Ê≤°ÁúãÂá∫Êúâ‰ªÄ‰πàÂ§™ÁâπÂà´ÁöÑÁî®Â§Ñ„ÄÇ RCT_EXPORT_METHOD()RN ÊòØÂ¶Ç‰ΩïÂ∞ÜÊñπÊ≥ïÂâçÂä†‰∏ä __rct_export__ ÁöÑÂë¢ÔºüÈÄöËøá RCT_EXPORT_METHOD() ÊñπÊ≥ï„ÄÇ 123456789101112#define RCT_EXPORT_METHOD(method) \ RCT_REMAP_METHOD(, method)#define RCT_REMAP_METHOD(js_name, method) \ RCT_EXTERN_REMAP_METHOD(js_name, method) \ - (void)method#define RCT_EXTERN_REMAP_METHOD(js_name, method) \ + (NSArray&lt;NSString *&gt; *)RCT_CONCAT(__rct_export__, \ RCT_CONCAT(js_name, RCT_CONCAT(__LINE__, __COUNTER__))) &#123; \ return @[@#js_name, @#method]; \ &#125; ‰∏≠Èó¥ÁöÑÂÆè‰∏∫ÊñπÊ≥ïË°•ÂÖ®‰∫Ü -(void) ÊÅ¢Â§ç‰∫ÜÂÆåÊï¥ OC ÊñπÊ≥ïÁöÑÂÆö‰πâ„ÄÇËøôÊ†∑ÊâçËÉΩ‰ΩøÂæó RCT_EXPORT_METHOD(xxx) ËøôÊ†∑ÁöÑÂÜôÊ≥ïÁºñËØëÂô®‰∏çÊä•Èîô„ÄÇ ‰∏ãÈù¢ÁöÑÂÆè‰∏≠ RCT_CONCAT ÊòØ‰∏Ä‰∏™ÊãºÊé•ÁöÑÂÆè„ÄÇÂ§ßËá¥‰∏∫ÊØè‰∏Ä‰∏™ RCT_EXPORT_METHOD ÁîüÊàê‰∫ÜÂîØ‰∏ÄËØÜÂà´ÁöÑÊï∞Â≠ó tag ‰∏é js_name ÊãºÊé•ÔºåÁÑ∂ÂêéÂú®ÂâçÈù¢Âä†‰∏ä‰∏Ä‰∏™ __rct_export__ÔºåÁîüÊàê‰∫Ü‰∏Ä‰∏™ËøîÂõû‰∏Ä‰∏™Êï∞ÁªÑÁöÑÊñπÊ≥ï„ÄÇ Â•óÁî®RN Ê∫êÁ†ÅËß£ËØªÔºà‰∫åÔºâ‰∏≠ÁöÑ‰∏Ä‰∏™‰æãÂ≠êÔºö ÂÅáËÆæÊàë‰ª¨ÂÜô RCT_EXPORT_METHOD(nativeAlert:xxx) ÁöÑÊó∂ÂÄôÔºå__LINE__ ‰∏é __COUNTER__ ÁªÑÂêàËµ∑Êù•ÁöÑÊï∞Â≠ó tag Â¶ÇÊûúÊòØ 123456ÔºåÈÇ£‰πàËøô‰∏™ÂÜÖ‰∫åÂ±ÇÂÆèËøò‰ºöËá™Âä®ÁîüÊàê‰∏Ä‰∏™ËøôÊ†∑ÁöÑÂáΩÊï∞Ôºö 123+ (NSArray&lt;NSString *&gt; *)__rct_export__123456&#123; return @[@"", @"nativeAlert:xxx"]; &#125; Êç¢Âè•ËØùËØ¥Ôºå‰∏ÄË°å RCT_EXPORT_METHOD(xxxx)ÔºåÁ≠â‰∫éÁîüÊàê‰∫Ü2‰∏™ÂáΩÊï∞ÁöÑÂÆûÁé∞: -(void)nativeAlert:(NSString *)content withButton:(NSString *)name +(NSArray&lt;NSString *&gt; *)__rct_export__123456 Native ‰∏é JS Èó¥ÁöÑÈÄö‰ø°Áé∞Âú®ÂºÄÂßãËÆ≤Âà∞ native Âíå JS ‰πãÈó¥ÁöÑÈÄö‰ø°„ÄÇÈ¶ñÂÖàÊòØ native Ë∞ÉÁî® JS ÊñπÊ≥ï„ÄÇÂú® RCTEventDispatcher.m ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÂêÑÁßçÂêÑÊ†∑ÁöÑË∞ÉÁî®ÊñπÊ≥ïÔºö sendAppEventWithName:body: sendDeviceEventWithName:body: sendInputEventWithName:body: Ëøô‰∫õÊñπÊ≥ïÈÉΩÂú®ÂÜÖÈÉ®Ë∞ÉÂä®‰∫Ü RCTBatchedBridge ÁöÑ enqueueJSCall:method:args:completion: ÊñπÊ≥ïÔºå‰∏ãÈù¢ÊòØÂèÇËÄÉ‰∫ÜReact NativeÈÄö‰ø°ÂéüÁêÜËß£Êûê(IOS)ÁîªÁöÑ‰∏ÄÂº†ÂÆåÊï¥ÁöÑË∞ÉÁî®ÊµÅÁ®ãÂõæÔºö tag11234567891011121314- (void)_actuallyInvokeAndProcessModule:(NSString *)module method:(NSString *)method arguments:(NSArray *)args&#123; RCTAssertJSThread(); __weak __typeof(self) weakSelf = self; [_javaScriptExecutor callFunctionOnModule:module method:method arguments:args callback:^(id json, NSError *error) &#123; [weakSelf _processResponse:json error:error]; &#125;];&#125; Ëøô‰∏™ÊñπÊ≥ïÂÖ∂ÂÆû‰πüÊ≤°‰ªÄ‰πàÁâπÂà´ÁöÑÔºå‰∏ªË¶ÅÁúã‰∏Ä‰∏ã callFunctionOnModule ÊñπÊ≥ïÁöÑ callbackÔºåÂú® callback ‰∏≠Ë∞ÉÁî®‰∫Ü _processResponse ÊñπÊ≥ïÔºåÁî®Êù•Â§ÑÁêÜÊâßË°å js Á´ØË∞ÉÁî® native ÁöÑÊñπÊ≥ï„ÄÇ tag21234567891011- (void)_callFunctionOnModule:(NSString *)module method:(NSString *)method arguments:(NSArray *)args returnValue:(BOOL)returnValue unwrapResult:(BOOL)unwrapResult callback:(RCTJavaScriptCallback)onComplete&#123; // TODO: Make this function handle first class instead of dynamically dispatching it. #9317773 NSString *bridgeMethod = returnValue ? @"callFunctionReturnFlushedQueue" : @"callFunctionReturnResultAndFlushedQueue"; [self _executeJSCall:bridgeMethod arguments:@[module, method, args] unwrapResult:unwrapResult callback:onComplete];&#125; Âú®Ëøô‰∏™ÊñπÊ≥ï‰∏≠ÔºåËÆæÁΩÆ‰∫ÜË∞ÉÁî® js Á´Ø batchedBridge ÁöÑ callFunctionReturnFlushedQueue ÊàñËÄÖ callFunctionReturnResultAndFlushedQueue ÊñπÊ≥ï„ÄÇÂπ∂Â∞Ü moduleÔºåmethodÔºåargs ‰Ωú‰ΩïÊàê‰∏Ä‰∏™Êï∞ÁªÑ‰Ωú‰∏∫ arguments ‰º†ÂÖ•„ÄÇÁî±‰∫é native Á´ØÈúÄË¶Å‰∏ªÂä®Ë∞ÉÁî®ÁöÑ js Á´ØÁöÑÊñπÊ≥ïÈÉΩÊòØ native ÊâÄÁÜüÁü•ÁöÑÊ®°ÂùóÂíåÊñπÊ≥ïÔºåÊâÄ‰ª•ËøôÈáåÁöÑÂêÑ‰∏™ÂèÇÊï∞ÈÉΩÊòØ stringÔºàÂè™ÊúâÈÇ£‰∫õËá™ÂÆö‰πâÁöÑÊ®°ÂùóÊàñËÄÖÊñπÊ≥ïÁöÑË∞ÉÁî®Êâç‰ºöÁî® idÔºâ„ÄÇ tag3Âú®ÊâßË°åÂÆå js Á´ØÁöÑÊñπÊ≥ïÂêéÔºåÂõûÂà∞ RCTJSCExecutor ÂÜÖÊâßË°å onComplete ÂõûË∞É: 1234567891011- (void)_executeJSCall:(NSString *)method arguments:(NSArray *)arguments unwrapResult:(BOOL)unwrapResult callback:(RCTJavaScriptCallback)onComplete&#123; [self executeBlockOnJavaScriptQueue:^&#123; //ÊâßË°åjsÊñπÊ≥ï ... onComplete(objcValue, error); &#125;];&#125; Ëøô‰∏™ onComplete Â∞±ÊòØ‰∏äÈù¢ tag1 ‰∏≠ÁöÑ callback„ÄÇ tag4js Ë∞ÉÁî® oc ÂèØ‰ª•ÊúâÂæàÂ§ö‰∏™ÊñπÊ≥ïÔºå‰ΩÜÊòØÊúÄÂêéÊñπÊ≥ï‰∏ÄÂÆö‰ºöËµ∞Âà∞ handleBuffer: ÊñπÊ≥ï‰∏≠Âéª„ÄÇËøô‰∏™ÊñπÊ≥ïÂú®‰∏äÈù¢ÁöÑ MessageQueue ‰∏≠‰πüÊúâÊèêÂà∞Ëøá„ÄÇÂÖ•ÂèÇÊòØ‰∏Ä‰∏™ÂåÖÂê´Ê®°Âùó„ÄÅÊñπÊ≥ï„ÄÅÂèÇÊï∞ÁöÑÊï∞ÁªÑ„ÄÇ Áé∞Âú®Â∞±Áî®Âà∞‰∫Ü‰πãÂâç‰øùÂ≠òÁöÑ _moduleDataByID Êï∞ÁªÑ„ÄÇ 12RCTModuleData *moduleData = self-&gt;_moduleDataByID[moduleID.integerValue];dispatch_queue_t queue = moduleData.methodQueue; ÈÄöËøá‰º†ÂÖ•ÁöÑ moduleID Â∞±ÂèØ‰ª•Âú®Êï∞ÁªÑ‰∏≠ÊâæÂà∞ÂØπÂ∫îÁöÑ RCTModuleData ÂÆû‰æãÔºåÊãøÂá∫ÊØè‰∏™ RCTModuleData ÁöÑ gcd ÈòüÂàó„ÄÇ‰πãÂêéÂ∞±ÊòØÂú®ÂêÑËá™ÈòüÂàóÈáåÊâßË°å‰∫Ü„ÄÇÁî±‰∫éÊòØ‰∏≤Ë°åÈòüÂàóÔºåÂêå‰∏Ä‰∏™ RCTModuleData ÁöÑÊñπÊ≥ïÂøÖÈ°ªÊòØÈ°∫Â∫èÊâßË°åÁöÑ„ÄÇ tag5Ëøô‰∏™Â∞±ÊòØÊ≠£ÁúüÈÄöËøáÂèçÂ∞ÑÁöÑÊñπÂºèÊâßË°å native ‰ª£Á†ÅÁöÑÊñπÊ≥ï„ÄÇÁî±‰∫é‰πüÊòØ iOS ËèúÈ∏üÔºåÂØπ‰∫é invocation ‰πü‰∏çÊòØÂæà‰∫ÜËß£ÔºåÊâÄ‰ª•ËøôÊÆµ‰ª£Á†Å‰∏çÊòØÂæàËÉΩÁúãÂæóÊáÇÔºåÂ∞±‰∏çÁªÜËÅä‰∫Ü„ÄÇÂêÑ‰ΩçÂ§ßÁ•ûÂèØ‰ª•‰ªîÁªÜË∑üËøõ„ÄÇ ‰∏çËøáË¶ÅÊ≥®ÊÑèÂÖ∂‰∏≠ÁöÑ processMethodSignature ÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ï‰∏≠ÔºåRN ‰ºöÂØπÂèçÂ∞ÑÁöÑ selector ËøõË°åÂàÜÊûêÔºåÂàÜÊûêÊúâÂá†‰∏™ÂèÇÊï∞ÔºåÊòØ‰ªÄ‰πàÁ±ªÂûãÁ≠âÁ≠â„ÄÇÂÖ∂‰∏≠Â∞±Âú® addBlockArgument Ëøô‰∏™ block ‰∏≠ÔºåËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™ËæìÂÖ•ÂèÇÊï∞‰∏∫Êï∞ÁªÑÁöÑÂõûË∞ÉÊñπÊ≥ïÔºö 123RCT_BLOCK_ARGUMENT(^(NSArray *args) &#123; [bridge enqueueCallback:json args:args];&#125;); Ëøô‰∏™ RCT_BLOCK_ARGUMENT ÂÆèÊòØÁî®Êù•‰øùÂ≠òËøô‰∏™ÂõûË∞ÉÊñπÊ≥ïÁöÑ„ÄÇÂõ†‰∏∫ NSInvocation ‰∏ç‰ºöÊåÅÊúâËøô‰∏™ block„ÄÇÂÖ∂‰∏≠ÁöÑ enqueueCallback:args: Â∞±ÊòØÁî®Êù•ÂõûË∞ÉÂâçÈù¢‰øùÂ≠òÁöÑ _callback ÁöÑ„ÄÇ ÂêéÈù¢ÊâÄÊúâÁöÑÊñπÊ≥ïË∞ÉÁî®ÔºåÂ§ßËá¥ËøáÁ®ãÈÉΩÂíå native Ë∞ÉÁî® js ‰∏ÄÊ†∑ÔºåÂè™‰∏çËøáÂâçËÄÖ‰º†ÂÖ•ÁöÑÊòØ callbackIDÔºåÂêéËÄÖ‰º†ÂÖ•ÁöÑÊòØÂêÑ‰∏™Ê®°ÂùóÊñπÊ≥ïÂèÇÊï∞Âêç„ÄÇÊâÄ‰ª•Êàë‰πüÂ∞±‰∏çÂÜçÂ±ïÂºÄ‰∫Ü„ÄÇ ÂèÇËÄÉÊñáÁ´†React Native ‰ªéÂÖ•Èó®Âà∞ÂéüÁêÜ ÁúãÂÆåÂèØ‰ª•ÂØπ RN Êúâ‰∏Ä‰∏™ÂàùÊ≠•ÁöÑËÆ§ËØÜReactNative iOSÊ∫êÁ†ÅËß£Êûê native Á´ØËÆ≤Ëß£ÁöÑÈùûÂ∏∏ËØ¶ÁªÜÔºåÈúÄË¶Å‰ªîÁªÜÂú∞Ë∑üÁùÄËµ∞‰∏ÄÈÅçReact NativeÈÄö‰ø°ÂéüÁêÜËß£Êûê(IOS) native Âíå js ÈÉΩËÆ≤Ëß£ÁöÑËæÉ‰∏∫ËØ¶ÁªÜÔºåÂâçÈù¢ÈÇ£ÁØáÁúãÊáÇ‰∫ÜÔºåÂÜçÊù•ÁúãËøôÁØáÔºåÂèØ‰ª•Âä†Ê∑±ÁêÜËß£„ÄÇ(ÈÉ®ÂàÜÂÜÖÂÆπÊúâ‰∏Ä‰∫õÂå∫Âà´)]]></content>
      <categories>
        <category>React-Native</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
        <tag>React-Native</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ªé setTimeout() ÁúãjsÁöÑ Event Loop ÊâßË°åËøáÁ®ã]]></title>
    <url>%2F2016%2F12%2F28%2FEventLoop%2F</url>
    <content type="text"><![CDATA[ÈÄöËøá setTimeout() ÊñπÊ≥ïÔºåÊù•‰∫ÜËß£ js ‰∏≠ÁöÑ‰ª£Á†ÅÊâßË°å„ÄÇÊú¨ÊñáÂèÇÁÖßÂπ≤Ë¥ß | ÂéüÊù•‰Ω†ÊòØËøôÊ†∑ÁöÑ setTimeout) Event LoopJs ÂºïÊìéÊòØÂçïÁ∫øÁ®ãÁöÑÔºåÂú®Êüê‰∏Ä‰∏™ÁâπÂÆöÁöÑÊó∂Èó¥ÂÜÖÂè™ËÉΩÊâßË°å‰∏Ä‰∏™‰ªªÂä°ÔºåÂπ∂ÈòªÂ°ûÂÖ∂‰ªñ‰ªªÂä°ÁöÑÊâßË°åÔºå‰πüÂ∞±ÊòØËØ¥Ëøô‰∫õ‰ªªÂä°ÊòØ‰∏≤Ë°åÁöÑÔºå‰ΩÜÊòØÂÆûÈôÖÂºÄÂèë‰∏≠Êàë‰ª¨Âç¥ÂèØ‰ª•‰ΩøÁî®ÂºÇÊ≠•‰ª£Á†ÅÊù•Ëß£ÂÜ≥„ÄÇJs ‰∏∫‰∫ÜÂºïÂÖ•ÂºÇÊ≠•ÁöÑÁâπÊÄßÔºåÂºïÁî≥Âá∫‰∏Ä‰∏™ÈáçË¶ÅÁöÑ‰∏úË•øÔºåEvent LoopÔºà‰∫ã‰ª∂Âæ™ÁéØÔºâ„ÄÇ ÂΩìÂºÇÊ≠•ÊñπÊ≥ïÔºåÊØîÂ¶Ç setTimeout() ÊâßË°åÁöÑÊó∂ÂÄôÔºå‰ºö‰∫§Áî±ÊµèËßàÂô®ÂÜÖÊ†∏ÁöÑÂÖ∂‰ªñÊ®°ÂùóÂéªÁÆ°ÁêÜ„ÄÇÂΩìÂºÇÊ≠•ÁöÑÊñπÊ≥ïÊª°Ë∂≥Ëß¶ÂèëÊù°‰ª∂ÂêéÔºåËØ•Ê®°ÂùóÂ∞±‰ºöÂ∞ÜÊñπÊ≥ïÊé®ÂÖ•Âà∞‰∏Ä‰∏™‰ªªÂä°ÈòüÂàóÔºàtask queueÔºâ‰∏≠ÔºåÂΩì‰∏ªÁ∫øÁ®ã‰ª£Á†ÅÊâßË°åÂÆåÊØïÂ§Ñ‰∫éÁ©∫Èó≤Áä∂ÊÄÅÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÂéªÊ£ÄÊü•‰ªªÂä°ÈòüÂàóÔºåÂ∞ÜÈòüÂàó‰∏≠Á¨¨‰∏Ä‰∏™‰ªªÂä°ÂÖ•Ê†àÊâßË°åÔºåÂÆåÊØïÂêéÁªßÁª≠Ê£ÄÊü•‰ªªÂä°ÈòüÂàóÔºåÂ¶ÇÊ≠§Âæ™ÁéØ„ÄÇÂâçÊèêÊù°‰ª∂ÊòØ‰∏ªÁ∫øÁ®ãÂ§Ñ‰∫éÁ©∫Èó≤Áä∂ÊÄÅÔºåËøôÂ∞±ÊòØ‰∫ã‰ª∂Âæ™ÁéØÁöÑÊ®°Âûã„ÄÇ Á¨¨‰∏Ä‰∏™ setTimeout ‰æãÂ≠ê‰æãÂ≠ê1234567891011console.log('start');setTimeout(() =&gt; &#123; console.log('hello');&#125;,300);setTimeout(()=&gt;&#123; console.log('world');&#125;,200);console.log('end'); ËøêË°åÁªìÊûú‰∏∫Ôºö1234startendworldhello ËøáÁ®ãÈ¶ñÂÖàÁ¨¨‰∏Ä‰∏™ console.log() ÂÖ•Ê†àÊâßË°åÔºåÊâßË°åÂÆåÊØïÊéßÂà∂Âè∞ÊâìÂç∞ start ÂêéÂá∫Ê†àÔºåÁ¥ßÊé•ÁùÄÊâßË°åÂà∞ setTimeout ÂÆöÊó∂Âô®ÔºåÊ≠§Êó∂ JS ÂºïÊìé‰ºöÂ∞ÜÂÆöÊó∂Âô®‰∫§ÁªôÊµèËßàÂô®ÁöÑÂè¶‰∏Ä‰∏™Ê®°ÂùóÂéªÁÆ°ÁêÜÔºà‰∏∫Êñπ‰æøÁêÜËß£ËøôÈáåÊääÂÆÉÂè´ÂÅö Timer Ê®°ÂùóÔºâÔºåÁÑ∂Âêé‰∏ªÁ∫øÁ®ãÁªßÁª≠Âêë‰∏ãÊâßË°åÔºåÁ¥ßÊé•ÁùÄÂ∞ÜÁ¨¨‰∫å‰∏™ÂÆöÊó∂Âô®‰πü‰∫§Áªô Timer Ê®°ÂùóÔºåÁÑ∂ÂêéÊâßË°åÂà∞Á¨¨‰∫å‰∏™ console.log()ÔºåÊéßÂà∂Âè∞ÊâìÂç∞ endÔºåÊâßË°åÂÆåÊØïÂêéÊ∏ÖÁ©∫ÊâßË°åÊ†à„ÄÇ‰ΩÜÊòØÂπ∂Ê≤°ÊúâÁªìÊùüÔºåÂú®‰∏ªÁ∫øÁ®ãÊâßË°åÁöÑÂêåÊó∂ÔºåTimer Ê®°Âùó‰ºöÊ£ÄÊü•ÂÖ∂‰∏≠ÁöÑÂºÇÊ≠•‰ª£Á†ÅÔºå‰∏ÄÊó¶Êª°Ë∂≥Ëß¶ÂèëÊù°‰ª∂ÔºåÂ∞±‰ºöÂ∞ÜÂÆÉÊ∑ªÂä†Âà∞‰ªªÂä°ÈòüÂàó‰∏≠(Ê≥®ÊÑèÔºåÊòØÊª°Ë∂≥Ëß¶ÂèëÊù°‰ª∂‰∫ÜÂÜçÊîæÂà∞‰ªªÂä°ÈòüÂàó‰∏≠)„ÄÇTimer2 Âª∂Ëøü 200msÔºåÊâÄ‰ª•‰ºöÊó©‰∫é Timer1 Ë¢´Ê∑ªÂä†Âà∞ÈòüÂàóÊéíÂ§¥„ÄÇËÄå‰∏ªÁ∫øÁ®ãÊ≠§Êó∂Â§Ñ‰∫éÁ©∫Èó≤Áä∂ÊÄÅÔºåÊâÄ‰ª•‰ºöÊ£ÄÊü•‰ªªÂä°ÈòüÂàóÊòØÂê¶ÊúâÂæÖÊâßË°åÁöÑ‰ªªÂä°„ÄÇÊ≠§Êó∂‰ºöÂ∞Ü Timer2 ÂõûË∞É‰∏≠ÁöÑ console.log() ÊâßË°åÔºåÊéßÂà∂Âè∞ÊâìÂç∞ worldÔºåÁÑ∂ÂêéÊâßË°åÊ†àÁ©∫Èó≤ÂêéÁªßÁª≠Ê£ÄÊü•‰ªªÂä°ÈòüÂàóÔºåÂ∞Ü Timer1 ÁöÑ‰ª£Á†ÅÂéãÂÖ•ÊâßË°åÊ†à‰∏≠ÊâßË°åÔºåÊéßÂà∂Âè∞ÊâìÂç∞ helloÔºåÊ∏ÖÁ©∫ÊâßË°åÊ†àÔºåÊ≠§Êó∂‰ªªÂä°ÈòüÂàó‰∏∫Á©∫ÔºåÊâßË°åÁªìÊùü„ÄÇ Á¨¨‰∫å‰∏™ setTimeout ‰æãÂ≠ê‰æãÂ≠ê12345678910111213141516171819console.log('start');setTimeout(() =&gt; &#123; console.log('hello');&#125;,300);setTimeout(()=&gt;&#123; console.log('world');&#125;,200);for (var i=0;i&lt;100000;i++)&#123; console.log(1)&#125;setTimeout(()=&gt;&#123; console.log('i am run');&#125;,100);console.log('end'); ÁªìÊûúÔºö123456start...endhelloworldI am run ËøáÁ®ãTimer3 ‰ªÖ‰ªÖÂª∂Ëøü‰∫Ü 100msÔºåÂèçËÄåÂú®Âè¶Â§ñ‰∏§‰∏™ Timer ‰πãÂêéÊâßË°å‰∫Ü„ÄÇÂÖ∂ÂÆûËøôÈáåÂéüÂõ†ÂæàÁÆÄÂçïÔºåÂõ†‰∏∫Âú® Timer1 Âíå Timer2 Âä†ÂÖ•Âà∞ÊâßË°åÈòüÂàó‰∏≠ÂêéÔºå‰∏ªÁ∫øÁ®ã‰æùÁÑ∂ËøòÂú®ÊâßË°åforÂæ™ÁéØ‰∏≠ÁöÑ‰ª£Á†ÅÔºåÂ§Ñ‰∫éÈòªÂ°ûÁä∂ÊÄÅ„ÄÇÈòüÂàó‰∏≠ÁöÑ Timer1 Âíå Timer2 Âπ∂‰∏ç‰ºöÂæó‰ª•ÊâßË°å„ÄÇÂΩìforÂæ™ÁéØÁªìÊùüÔºåËøôÊó∂ÊâçÂ∞Ü Timer3 ‰∫§Áî± Timer Ê®°ÂùóÂéªÁÆ°ÁêÜ(Ê≥®ÊÑèÔºå‰ª£Á†ÅÈ°∫Â∫èÊâßË°åÔºåforÂæ™ÁéØÁöÑÊó∂ÂÄôÔºå Timer3 ÁöÑ setTimeout() ËøòÊ≤°ÊúâÊâßË°åÔºåÊâÄ‰ª•‰πüÂ∞±ËøòÊ≤°ÊúâË¢´ Timer Ê®°ÂùóÁÆ°ÁêÜ)ÔºåÁªßÁª≠ÊâßË°åÂêéÁª≠‰ª£Á†ÅÊâìÂç∞ endÔºåÊ∏ÖÁ©∫ÊâßË°åÊ†à„ÄÇËôΩÁÑ∂Âú®ËøôÈáå Timer3 ÁöÑÂª∂ËøüÊó∂Èó¥ÊúÄÁü≠Ôºå‰ΩÜÊòØÂä†ÂÖ•‰ªªÂä°ÈòüÂàóÂêéËøòÊòØ‰ºöÊéíÂú® Timer1 Âíå Timer2 ÁöÑÂêéÈù¢ÔºåÊâÄ‰ª•Ê≠§Êó∂ÊåâÈ°∫Â∫èÊâßË°å‰ªªÂä°ÈòüÂàó‰∏≠ÁöÑ‰ª£Á†ÅÔºå‰æùÊ¨°ÊâìÂç∞„ÄÇ ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÊâßË°åÂÆå console.log(&#39;end&#39;); ÂêéÔºåÁ´ãÂàªÊâßË°å‰∫Ü Timer1 Âíå Timer2Ôºå‰ΩÜÊòØ Timer3 ÊâßË°åÊó∂Èó¥Á∫¶Âú®‰πãÂêé 100msÔºåËøôÊòØÂõ†‰∏∫forÂæ™ÁéØÊâßË°åÁöÑÊó∂Èó¥Ë∂ÖËøá‰∫Ü300ms„ÄÇÂ¶ÇÊûúforÂæ™ÁéØÂú®100ms‰ª•ÂÜÖÂÆåÊàêÔºåÈÇ£‰πà console.log(&#39;i am run&#39;); ‰ªçÁÑ∂ÊòØÊúÄÂÖàÊâßË°åÁöÑ„ÄÇÂ¶ÇÊûúforÂæ™ÁéØÂú®100msÂà∞200ms‰πãÈó¥ÔºåÈÇ£‰πà console.log(&#39;i am run&#39;); Âú® console.log(&#39;world&#39;); ‰πãÂêéÔºåconsole.log(&#39;hello&#39;); ‰πãÈó¥ÊâßË°å„ÄÇ]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>NodeJs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HTTPËØ¶Ëß£]]></title>
    <url>%2F2016%2F12%2F24%2FHTTP%E7%9A%84%E6%9E%84%E6%88%90%2F</url>
    <content type="text"><![CDATA[ÁΩëÁªúÂçèËÆÆËøôÂùó‰∏ÄÁõ¥Ê≤°ÊúâÊêûÈÄèÂΩªÔºåË∂ÅÁùÄËãπÊûúÂº∫Âà∂ ATSÔºàApimp Transport SecurityÔºâÊú™ÊûúÔºåÂ≠¶‰π†‰∏Ä‰∏ãËøôÊñπÈù¢ÁöÑÁü•ËØÜ„ÄÇ HTTPÁöÑÊûÑÊàêHTTP Requesthttp ËØ∑Ê±Ç‰∏ªË¶ÅÂàÜ‰∏∫‰∏âÈÉ®ÂàÜÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇrequest lineÔºåheader Âíå bodyÔºå‰∏≠Èó¥ÁöÑCRLF‰∏∫Êç¢Ë°åÁ¨¶„ÄÇ ‰∏ãÈù¢Â∞Ü‰ª•‰∏Ä‰∏™ÂÆûÈôÖÁöÑ http ËØ∑Ê±ÇÊù•ËØ¶ÁªÜÁúãÁúãÂÖ∂ÂÜÖÈÉ®ÊûÑÈÄ†„ÄÇÂÅáËÆæÊàë‰ª¨ÁöÑËØ∑Ê±ÇURL‰∏∫Ôºöhttp://www.baidu.com/res/static/thirdparty/connect.jpg?t=1480992153433 Request LineËØ∑Ê±ÇË°åÁöÑÁªìÊûÑ‰∏∫Ôºö 1Request-Line = Method SP Request-URI SP HTTP-Version CRLF Method:ËØ∑Ê±ÇÁ±ªÂûãÔºå‰æãÂ¶Ç post/get„ÄÇ SP:ÂàÜÈöîÁ¨¶Ôºå‰∏ÄËà¨Â∞±ÊòØÁ©∫Ê†º„ÄÇ Request-URI:ÂØπÂ∫î‰∏äËø∞ËØ∑Ê±Ç‰∏∫Ôºö/res/static/thirdparty/connect.jpg?t=1480992153.564331„ÄÇÊ≥®ÊÑèÔºåRequest-URI ‰πüÂèØ‰ª•ÊòØÂ∏¶ host ÁöÑÂÆåÊï¥ uri„ÄÇ‰∏çÂ∏¶ÁöÑËØùÔºåÂ∞±Ë¶ÅÂú® Header ÈáåÊ∑ªÂä† host„ÄÇ HTTP-Version:‰ª£Ë°®Êàë‰ª¨ÂΩìÂâç‰ΩøÁî®ÁöÑÁâàÊú¨Ôºå‰æãÂ¶Ç HTTP/1.1 CRLF:CR ÂØπÂ∫îÂõûËΩ¶ÈîÆÔºåLFÂØπÂ∫îÊç¢Ë°åÈîÆÔºåÂêàËµ∑Êù•Â∞±ÊòØÊàë‰ª¨Âπ≥Â∏∏ÊâÄËØ¥ÁöÑ \r\n„ÄÇ ÊâÄ‰ª•‰∏äËø∞ËØ∑Ê±ÇÁöÑ Request-Line ÁöÑÊñáÊú¨Â±ïÁ§∫Ôºö GET /res/static/thirdparty/connect.jpg?t=1480992153.564331 HTTP/1.1CRLF Headerheader ÂÖ∂Êú¨Ë¥®‰∏äÊòØ‰∏Ä‰∫õÊñáÊú¨ÈîÆÂÄºÂØπÔºå‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ‰æãÂ≠êÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÁªìÊûÑ‰∏∫Ôºö 1Key:Á©∫Ê†ºValueCRLF ‰∏äÈù¢ËÆ≤Ëø∞ Request-URI ÁöÑÊó∂ÂÄôÔºåÁº∫Â§±ÁöÑ Host Â∞±‰ª•ÈîÆÂÄºÂØπÁöÑÂΩ¢ÂºèÂ≠òÂú®‰∫é header ‰∏≠ÔºåÊØîÂ¶ÇÔºå HostÔºö pan.baidu.com„ÄÇ Â∞ÜËã•Âπ≤‰∏™‰∏äËø∞Ê†ºÂºèÁöÑÈîÆÂÄºÂØπÁªÑÂêàËµ∑Êù•ÔºåÂ∞±Êàê‰∫ÜÊàë‰ª¨ HTTP ËØ∑Ê±ÇÁöÑÂÆåÊï¥ header„ÄÇÊúÄÂêé‰∏Ä‰∏™ÈîÆÂÄºÂØπ‰πãÂêéÂÜçË∑ü‰∏Ä‰∏™ CRLFÔºåÂ∞±Ë°®Á§∫Êàë‰ª¨ÁöÑ header ÁªìÊùü‰∫Ü„ÄÇ Bodybody ÈáåÈù¢ÂåÖÂê´ËØ∑Ê±ÇÁöÑÂÆûÈôÖÊï∞ÊçÆ„ÄÇ ÂØπ‰∫é Method=GET ÁöÑËØ∑Ê±ÇÊù•ËØ¥Ôºåbody ‰ΩìÊòØ‰∏∫Á©∫ÁöÑÔºåHeader ÊúÄÂêéÁöÑ‰∏§‰∏™ CRLF Â∞±Ê†áËØÜÁùÄËØ∑Ê±ÇÁöÑÁªìÂ∞æ„ÄÇÊàë‰ª¨‰∏ÄËà¨Ë∞ÉÁî®ËØ∑Ê±ÇÁöÑ‰∏öÂä°ÂèÇÊï∞ÊòØÈÄöËøá Request Line ÂΩì‰∏≠ÁöÑ Request-URI Êù•‰º†ÈÄíÁöÑÔºåÊØîÂ¶Ç‰∏äËø∞ËØ∑Ê±Ç‰∏≠ÁöÑ ?t=1480992153.564331Ôºå‰πüÂ∞±ÊòØ URI ÁöÑ query string ÈÉ®ÂàÜ„ÄÇËøôÈÉ®ÂàÜÂêåÊ†∑ÊòØ‰ª•ÈîÆÂÄºÂØπÁöÑÂΩ¢ÂºèÂ≠òÂú®Ôºå‰∏çËøáÊòØ‰Ωç‰∫é Request Line ÂΩì‰∏≠„ÄÇ ÂØπ‰∫é Method=POST ÁöÑËØ∑Ê±ÇÊù•ËØ¥ÔºåÂÆûÈôÖÁöÑ‰∏öÂä°Êï∞ÊçÆÈÉΩÂ≠òÊîæ‰∫é body ÂΩì‰∏≠„ÄÇPOST ËØ∑Ê±ÇÂèØ‰ª•Ê†πÊçÆ Header ‰∏≠ÁöÑ Content-Type ÂÄºÔºå‰ª•‰∏çÂêåÁöÑÂΩ¢ÂºèÂ∞ÜÊï∞ÊçÆ‰øùÂ≠òÂú® body ‰Ωì‰∏≠„ÄÇËé∑ÂèñÂà∞ËØ∑Ê±ÇÂêéÔºåÂèØ‰ª•‰ªçÁÑ∂ÈÄöËøá Header ‰∏≠ÁöÑ Content-Length ÂÄºÔºåËØªÂèñÂõ∫ÂÆöÈïøÂ∫¶ÁöÑbody‰ΩìÔºåÁõ¥Êé•‰º†ÈÄíÁªôÂ∫îÁî®Â±Ç HTTP Responseresponse ÁöÑÁªìÊûÑÂíå request Â§ßËá¥Áõ∏‰ººÔºå‰∏çËøáÊòØÂ∞Ü Request Line Êç¢Êàê‰∫Ü Status Line „ÄÇ Status Line ÁöÑÁªìÊûÑÂ¶Ç‰∏ãÔºö1Status-Line = HTTP-Version SP Status-Code SP Reason-Phrase CRLF Content-TypeContent-Type Áî®‰∫éÊåáÂÆöÂÜÖÂÆπÁ±ªÂûãÔºå‰∏ÄËà¨ÊòØÊåáÁΩëÈ°µ‰∏≠Â≠òÂú®ÁöÑ Content-TypeÔºåContent-Type Â±ûÊÄßÊåáÂÆöËØ∑Ê±ÇÂíåÂìçÂ∫îÁöÑ HTTP ÂÜÖÂÆπÁ±ªÂûã„ÄÇÂ¶ÇÊûúÊú™ÊåáÂÆö ContentTypeÔºåÈªòËÆ§‰∏∫ text/html„ÄÇ ‰∏Ä‰∫õÂ∏∏ËßÅÁöÑ Content-Type: text/html text/plain text/css text/javascript application/x-www-form-urlencoded multipart/form-data application/json application/xml ÂâçÈù¢Âá†‰∏™ÈÉΩÂæàÂ•ΩÁêÜËß£ÔºåÈÉΩÊòØ htmlÔºåcssÔºåjavascript ÁöÑÊñá‰ª∂Á±ªÂûãÔºåÂêéÈù¢Âõõ‰∏™ÊòØPOST ÁöÑÂèëÂåÖÊñπÂºè„ÄÇ ÈÇ£Êàë‰ª¨‰ªÄ‰πàÊó∂ÂÄôÁî® application/x-www-form-urlencodedÔºå‰ªÄ‰πàÊó∂ÂÄôÁî® multipart/form-data Âë¢ÔºüÂ§ßÊñá‰ª∂Â¶ÇÊñá‰ª∂ÂõæÁâáÁî®ÂêéËÄÖÔºåÂ∞èÊñá‰ª∂Â¶ÇÈîÆÂÄºÂØπÁî®ÂâçËÄÖ„ÄÇ Cache-Control Âíå ETag Âå∫Âà´Cache-Control Ë°®Á§∫ÊµèËßàÂô®‰ΩøÁî®ÁºìÂ≠òÔºå‰∏çÂÉèÊúçÂä°Âô®ÂèëÈÄÅËØ∑Ê±Ç„ÄÇÂΩì Url ‰∏çÂèòÊó∂ÔºåÂ¶ÇÊûúËµÑÊ∫êÊ≤°ÊúâË∂ÖËøá Expires Êó∂Èó¥ÔºåÂàô‰∏çËøõË°åÊúçÂä°Âô®ËØ∑Ê±ÇÔºåÁõ¥Êé•‰ΩøÁî®ÊµèËßàÂô®ÁºìÂ≠ò„ÄÇ ETag ÊòØËØ∑Ê±ÇËµÑÊ∫êÊñá‰ª∂ÁöÑÂìàÂ∏åÂÄº„ÄÇÂú®ÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÂêéÔºåÊúçÂä°Á´ØÊääËµÑÊ∫êÊñá‰ª∂ÁöÑ md5 ÂÄº‰Ωú‰∏∫ ETag ËøîÂõûÁªôÊµèËßàÂô®„ÄÇÂΩìÊµèËßàÂô®‰∏ãÊ¨°ËØ∑Ê±ÇÁöÑÊó∂ÂÄôÂ∞ÜËøô‰∏™ ETag ÁöÑÂÄº‰Ωú‰∏∫ËØ∑Ê±ÇÂ§¥Â≠óÊÆµ if-none-match ‰º†ÁªôÊúçÂä°Á´ØÔºåÂΩìËµÑÊ∫êÊñá‰ª∂‰∏çÂèòÁöÑÊó∂ÂÄôÔºåÊúçÂä°Á´ØËøîÂõû 304ÔºåÂΩìËµÑÊ∫êÊñá‰ª∂ÂèòÂåñÁöÑÊó∂ÂÄôÔºåÊúçÂä°Á´ØÂ∞ÜÊñ∞ÁöÑËµÑÊ∫êÊñá‰ª∂ÁöÑ md5 ÂÄº‰Ωú‰∏∫ ETagÔºåËøûÂêåËµÑÊ∫êÊñá‰ª∂ËøîÂõûÁªôÊµèËßàÂô®„ÄÇ HTTP2.0 ÁöÑÊîπËøõ headerÂéãÁº©ÔºåÂ¶Ç‰∏äÊñá‰∏≠ÊâÄË®ÄÔºåÂØπÂâçÈù¢ÊèêÂà∞ËøáHTTP1.xÁöÑheaderÂ∏¶ÊúâÂ§ßÈáè‰ø°ÊÅØÔºåËÄå‰∏îÊØèÊ¨°ÈÉΩË¶ÅÈáçÂ§çÂèëÈÄÅÔºåHTTP2.0‰ΩøÁî®encoderÊù•ÂáèÂ∞ëÈúÄË¶Å‰º†ËæìÁöÑheaderÂ§ßÂ∞èÔºåÈÄöËÆØÂèåÊñπÂêÑËá™cache‰∏Ä‰ªΩheader fieldsË°®ÔºåÊó¢ÈÅøÂÖç‰∫ÜÈáçÂ§çheaderÁöÑ‰º†ËæìÔºåÂèàÂáèÂ∞è‰∫ÜÈúÄË¶Å‰º†ËæìÁöÑÂ§ßÂ∞è„ÄÇ ÊúçÂä°Á´ØÊé®ÈÄÅÔºàserver pushÔºâÔºåÂêåSPDY‰∏ÄÊ†∑ÔºåHTTP2.0‰πüÂÖ∑Êúâserver pushÂäüËÉΩ„ÄÇ Â§öË∑ØÂ§çÁî®ÔºàMultiPlexingÔºâÔºåÂç≥ËøûÊé•ÂÖ±‰∫´ÔºåÂç≥ÊØè‰∏Ä‰∏™requestÈÉΩÊòØÊòØÁî®‰ΩúËøûÊé•ÂÖ±‰∫´Êú∫Âà∂ÁöÑ„ÄÇ‰∏Ä‰∏™requestÂØπÂ∫î‰∏Ä‰∏™idÔºåËøôÊ†∑‰∏Ä‰∏™ËøûÊé•‰∏äÂèØ‰ª•ÊúâÂ§ö‰∏™requestÔºåÊØè‰∏™ËøûÊé•ÁöÑrequestÂèØ‰ª•ÈöèÊú∫ÁöÑÊ∑∑ÊùÇÂú®‰∏ÄËµ∑ÔºåÊé•Êî∂ÊñπÂèØ‰ª•Ê†πÊçÆrequestÁöÑ idÂ∞ÜrequestÂÜçÂΩíÂ±ûÂà∞ÂêÑËá™‰∏çÂêåÁöÑÊúçÂä°Á´ØËØ∑Ê±ÇÈáåÈù¢„ÄÇ Êñ∞ÁöÑ‰∫åËøõÂà∂Ê†ºÂºèÔºàBinary FormatÔºâÔºåHTTP1.xÁöÑËß£ÊûêÊòØÂü∫‰∫éÊñáÊú¨„ÄÇHTTP2.0Â∞ÜÊñáÊú¨ËΩ¨‰∏∫‰∫åÁ∫ßÂà∂‰º†Ëæì„ÄÇÂ¶Ç‰∏ãÂõæÔºö HTTPSÂü∫Êú¨‰ªãÁªçHTTP ÂçèËÆÆ‰º†ËæìÁöÑÊï∞ÊçÆÈÉΩÊòØÊú™Âä†ÂØÜÁöÑÔºå‰πüÂ∞±ÊòØÊòéÊñáÁöÑÔºåÂõ†Ê≠§‰ΩøÁî® HTTP ÂçèËÆÆ‰º†ËæìÈöêÁßÅ‰ø°ÊÅØÈùûÂ∏∏‰∏çÂÆâÂÖ®„ÄÇÊØîÂ¶ÇËøêËê•ÂïÜÂèØ‰ª•ËΩªÊòìÂä´ÊåÅ‰Ω†ÁöÑ http ËØ∑Ê±ÇÔºåÂú® response ‰∏≠Ê≥®ÂÖ• js‰ª£Á†ÅÔºàÂ¶ÇÁΩëÈ°µ‰∏äÂºπÁ™óÂπøÂëä„ÄÅÊµÅÈáèÁêÉÁ≠âÔºâÔºåÁîöËá≥ÊòØÈáçÂÆöÂêë„ÄÇ‰∏∫‰∫Ü‰øùËØÅËøô‰∫õÈöêÁßÅÊï∞ÊçÆËÉΩÂä†ÂØÜ‰º†ËæìÔºå‰∫éÊòØÁΩëÊôØÂÖ¨Âè∏ËÆæËÆ°‰∫Ü SSLÔºàSecure Sockets LayerÔºâÂçèËÆÆÁî®‰∫éÂØπ HTTP ÂçèËÆÆ‰º†ËæìÁöÑÊï∞ÊçÆËøõË°åÂä†ÂØÜÔºå‰ªéËÄåÂ∞±ËØûÁîü‰∫Ü HTTPS„ÄÇ‰πãÂêéÂØπ SSL ËøõË°å‰∫ÜÂçáÁ∫ß‰∏∫ TLSÔºàTransport Layer SecurityÔºâ„ÄÇÊàë‰ª¨Áé∞Âú®ÁöÑ HTTPS ÈÉΩÊòØÁî®ÁöÑ TLS ÂçèËÆÆ„ÄÇ ‰∏ÄËà¨Êù•ËØ¥ HTTPS ‰πüÈúÄË¶ÅËøõË°å TCP ÁöÑ‰∏âÊ¨°Êè°ÊâãÔºå‰ΩÜÊòØÂíå HTTP ‰∏çÂêåÁöÑÊòØÔºåHTTPS ËøòÈúÄË¶ÅËøõË°å SSL Êè°Êâã„ÄÇËøô‰πüÂ∞±ÊòØÂÖ∂ÊØî HTTP Âú®Âª∫Á´ãËøûÊé•Êó∂ÊÖ¢ÁöÑ‰∏ªË¶ÅÂéüÂõ†„ÄÇ Â∑•‰ΩúÂéüÁêÜÊÄªÂÖ±ÂàÜ‰∏∫‰ª•‰∏ãÂá†Ê≠•Ôºö ÊµèËßàÂô®Â∞ÜËá™Â∑±ÊîØÊåÅÁöÑ‰∏ÄÂ•óÂä†ÂØÜËßÑÂàôÂèëÈÄÅÁªôÁΩëÁ´ô„ÄÇ ÁΩëÁ´ô‰ªé‰∏≠ÈÄâÂá∫‰∏ÄÁªÑÂä†ÂØÜÁÆóÊ≥ï‰∏é HASH ÁÆóÊ≥ïÔºåÂπ∂Â∞ÜËá™Â∑±ÁöÑË∫´‰ªΩ‰ø°ÊÅØ‰ª•ËØÅ‰π¶ÁöÑÂΩ¢ÂºèÂèëÂõûÁªôÊµèËßàÂô®„ÄÇËØÅ‰π¶ÈáåÈù¢ÂåÖÂê´‰∫ÜÁΩëÁ´ôÂú∞ÂùÄÔºåÂä†ÂØÜÂÖ¨Èí•Ôºå‰ª•ÂèäËØÅ‰π¶ÁöÑÈ¢ÅÂèëÊú∫ÊûÑÁ≠â‰ø°ÊÅØ„ÄÇ Ëé∑ÂæóÁΩëÁ´ôËØÅ‰π¶‰πãÂêéÊµèËßàÂô®Ë¶ÅÂÅö‰ª•‰∏ãÂ∑•‰ΩúÔºö È™åËØÅËØÅ‰π¶ÁöÑÂêàÊ≥ïÊÄßÔºàÈ¢ÅÂèëËØÅ‰π¶ÁöÑÊú∫ÊûÑÊòØÂê¶ÂêàÊ≥ïÔºåËØÅ‰π¶‰∏≠ÂåÖÂê´ÁöÑÁΩëÁ´ôÂú∞ÂùÄÊòØÂê¶‰∏éÊ≠£Âú®ËÆøÈóÆÁöÑÂú∞ÂùÄ‰∏ÄËá¥Á≠âÔºâÔºåÂ¶ÇÊûúËØÅ‰π¶Âèó‰ø°‰ªªÔºåÂàôÊµèËßàÂô®Ê†èÈáåÈù¢‰ºöÊòæÁ§∫‰∏Ä‰∏™Â∞èÈîÅÂ§¥ÔºåÂê¶Âàô‰ºöÁªôÂá∫ËØÅ‰π¶‰∏çÂèó‰ø°ÁöÑÊèêÁ§∫„ÄÇ Â¶ÇÊûúËØÅ‰π¶Âèó‰ø°‰ªªÔºåÊàñËÄÖÊòØÁî®Êà∑Êé•Âèó‰∫Ü‰∏çÂèó‰ø°ÁöÑËØÅ‰π¶ÔºåÊµèËßàÂô®‰ºöÁîüÊàê‰∏Ä‰∏≤ÈöèÊú∫Êï∞ÁöÑÂØÜÁ†ÅÔºåÂπ∂Áî®ËØÅ‰π¶‰∏≠Êèê‰æõÁöÑÂÖ¨Èí•Âä†ÂØÜ„ÄÇ ‰ΩøÁî®Á∫¶ÂÆöÂ•ΩÁöÑHASHËÆ°ÁÆóÊè°ÊâãÊ∂àÊÅØÔºåÂπ∂‰ΩøÁî®ÁîüÊàêÁöÑÈöèÊú∫Êï∞ÂØπÊ∂àÊÅØËøõË°åÂä†ÂØÜÔºåÊúÄÂêéÂ∞Ü‰πãÂâçÁîüÊàêÁöÑÊâÄÊúâ‰ø°ÊÅØÂèëÈÄÅÁªôÁΩëÁ´ô„ÄÇ ÁΩëÁ´ôÊé•Êî∂ÊµèËßàÂô®ÂèëÊù•ÁöÑÊï∞ÊçÆ‰πãÂêéË¶ÅÂÅö‰ª•‰∏ãÁöÑÊìç‰ΩúÔºö ‰ΩøÁî®Ëá™Â∑±ÁöÑÁßÅÈí•Â∞Ü‰ø°ÊÅØËß£ÂØÜÂèñÂá∫ÂØÜÁ†ÅÔºå‰ΩøÁî®ÂØÜÁ†ÅËß£ÂØÜÊµèËßàÂô®ÂèëÊù•ÁöÑÊè°ÊâãÊ∂àÊÅØÔºåÂπ∂È™åËØÅHASHÊòØÂê¶‰∏éÊµèËßàÂô®ÂèëÊù•ÁöÑ‰∏ÄËá¥„ÄÇ ‰ΩøÁî®ÂØÜÁ†ÅÂä†ÂØÜ‰∏ÄÊÆµÊè°ÊâãÊ∂àÊÅØÔºåÂèëÈÄÅÁªôÊµèËßàÂô®„ÄÇ ÊµèËßàÂô®Ëß£ÂØÜÂπ∂ËÆ°ÁÆóÊè°ÊâãÊ∂àÊÅØÁöÑHASHÔºåÂ¶ÇÊûú‰∏éÊúçÂä°Á´ØÂèëÊù•ÁöÑHASH‰∏ÄËá¥ÔºåÊ≠§Êó∂Êè°ÊâãËøáÁ®ãÁªìÊùüÔºå‰πãÂêéÊâÄÊúâÁöÑÈÄö‰ø°Êï∞ÊçÆÂ∞ÜÁî±‰πãÂâçÊµèËßàÂô®ÁîüÊàêÁöÑÈöèÊú∫ÂØÜÁ†ÅÂπ∂Âà©Áî®ÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïËøõË°åÂä†ÂØÜ„ÄÇ ËøôÈáåÊµèËßàÂô®‰∏éÁΩëÁ´ô‰∫íÁõ∏ÂèëÈÄÅÂä†ÂØÜÁöÑÊè°ÊâãÊ∂àÊÅØÂπ∂È™åËØÅÔºåÁõÆÁöÑÊòØ‰∏∫‰∫Ü‰øùËØÅÂèåÊñπÈÉΩËé∑Âæó‰∫Ü‰∏ÄËá¥ÁöÑÂØÜÁ†ÅÔºåÂπ∂‰∏îÂèØ‰ª•Ê≠£Â∏∏ÁöÑÂä†ÂØÜËß£ÂØÜÊï∞ÊçÆÔºå‰∏∫ÂêéÁª≠ÁúüÊ≠£Êï∞ÊçÆÁöÑ‰º†ËæìÂÅö‰∏ÄÊ¨°ÊµãËØï„ÄÇ ÂÖ∂‰∏≠ÈùûÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÁî®‰∫éÂú®Êè°ÊâãËøáÁ®ã‰∏≠Âä†ÂØÜÁîüÊàêÁöÑÂØÜÁ†ÅÔºåÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÁî®‰∫éÂØπÁúüÊ≠£‰º†ËæìÁöÑÊï∞ÊçÆËøõË°åÂä†ÂØÜÔºåËÄå HASH ÁÆóÊ≥ïÁî®‰∫éÈ™åËØÅÊï∞ÊçÆÁöÑÂÆåÊï¥ÊÄß„ÄÇÁî±‰∫éÊµèËßàÂô®ÁîüÊàêÁöÑÂØÜÁ†ÅÊòØÊï¥‰∏™Êï∞ÊçÆÂä†ÂØÜÁöÑÂÖ≥ÈîÆÔºåÂõ†Ê≠§Âú®‰º†ËæìÁöÑÊó∂ÂÄô‰ΩøÁî®‰∫ÜÈùûÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÂØπÂÖ∂Âä†ÂØÜ„ÄÇÈùûÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ï‰ºöÁîüÊàêÂÖ¨Èí•ÂíåÁßÅÈí•ÔºåÂÖ¨Èí•Âè™ËÉΩÁî®‰∫éÂä†ÂØÜÊï∞ÊçÆÔºåÂõ†Ê≠§ÂèØ‰ª•ÈöèÊÑè‰º†ËæìÔºåËÄåÁΩëÁ´ôÁöÑÁßÅÈí•Áî®‰∫éÂØπÊï∞ÊçÆËøõË°åËß£ÂØÜÔºåÊâÄ‰ª•ÁΩëÁ´ôÈÉΩ‰ºöÈùûÂ∏∏Â∞èÂøÉÁöÑ‰øùÁÆ°Ëá™Â∑±ÁöÑÁßÅÈí•ÔºåÈò≤Ê≠¢Ê≥ÑÊºè„ÄÇ ‰∏∫‰ªÄ‰πà‰∏çÁõ¥Êé•ÂÖ®Á®ã‰ΩøÁî®ÈùûÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïËøõË°åÊï∞ÊçÆ‰º†ËæìÔºüËøô‰∏™ÈóÆÈ¢òÁöÑÁ≠îÊ°àÊòØÂõ†‰∏∫ÈùûÂØπÁß∞ÁÆóÊ≥ïÁöÑÊïàÁéáÂØπÊØîËµ∑ÂØπÁß∞ÁÆóÊ≥ïÊù•ËØ¥ÔºåË¶Å‰ΩéÂæóÂ§öÂæóÂ§öÔºõÂõ†Ê≠§ÂæÄÂæÄÂè™Áî®Âú®HTTPSÁöÑÊè°ÊâãÈò∂ÊÆµ„ÄÇ ËØÅ‰π¶ÁöÑÈ™åËØÅËøáÁ®ãËØÅ‰π¶‰ª•ËØÅ‰π¶ÈìæÁöÑÂΩ¢ÂºèÁªÑÁªáÔºåÂú®È¢ÅÂèëËØÅ‰π¶ÁöÑÊó∂ÂÄôÈ¶ñÂÖàË¶ÅÊúâÊ†πCAÊú∫ÊûÑÈ¢ÅÂèëÁöÑÊ†πËØÅ‰π¶ÔºåÂÜçÁî±Ê†πCAÊú∫ÊûÑÈ¢ÅÂèë‰∏Ä‰∏™‰∏≠Á∫ßCAÊú∫ÊûÑÁöÑËØÅ‰π¶ÔºåÊúÄÂêéÁî±‰∏≠Á∫ßCAÊú∫ÊûÑÈ¢ÅÂèëÂÖ∑‰ΩìÁöÑSSLËØÅ‰π¶„ÄÇÊàë‰ª¨ÂèØ‰ª•ËøôÊ†∑ÁêÜËß£ÔºåÊ†πCAÊú∫ÊûÑÂ∞±ÊòØ‰∏Ä‰∏™ÂÖ¨Âè∏ÔºåÊ†πËØÅ‰π¶Â∞±ÊòØ‰ªñÁöÑË∫´‰ªΩÂá≠ËØÅÔºåÊØè‰∏™ÂÖ¨Âè∏Áî±‰∏çÂêåÁöÑÈÉ®Èó®Êù•È¢ÅÂèë‰∏çÂêåÁî®ÈÄîÁöÑËØÅ‰π¶ÔºåËøô‰∫õ‰∏çÂêåÁöÑÈÉ®Èó®Â∞±ÊòØ‰∏≠Á∫ßCAÊú∫ÊûÑÔºåËøô‰∫õ‰∏≠Á∫ßCAÊú∫ÊûÑ‰ΩøÁî®‰∏≠Á∫ßËØÅ‰π¶‰Ωú‰∏∫Ëá™Â∑±ÁöÑË∫´‰ªΩÂá≠ËØÅÔºåÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™ÈÉ®Èó®ÊòØ‰∏ìÈó®È¢ÅÂèëSSLËØÅ‰π¶ÔºåÂΩìÊääÊ†πËØÅ‰π¶Ôºå‰∏≠Á∫ßËØÅ‰π¶Ôºå‰ª•ÂèäÊúÄÂêéÁî≥ËØ∑ÁöÑSSLËØÅ‰π¶ËøûÂú®‰∏ÄËµ∑Â∞±ÂΩ¢Êàê‰∫ÜËØÅ‰π¶ÈìæÔºå‰πüÁß∞‰∏∫ËØÅ‰π¶Ë∑ØÂæÑ„ÄÇÂú®È™åËØÅËØÅ‰π¶ÁöÑÊó∂ÂÄôÔºåÊµèËßàÂô®‰ºöË∞ÉÁî®Á≥ªÁªüÁöÑËØÅ‰π¶ÁÆ°ÁêÜÂô®Êé•Âè£ÂØπËØÅ‰π¶Ë∑ØÂæÑ‰∏≠ÁöÑÊâÄÊúâËØÅ‰π¶‰∏ÄÁ∫ß‰∏ÄÁ∫ßÁöÑËøõË°åÈ™åËØÅÔºåÂè™ÊúâË∑ØÂæÑ‰∏≠ÊâÄÊúâÁöÑËØÅ‰π¶ÈÉΩÊòØÂèó‰ø°ÁöÑÔºåÊï¥‰∏™È™åËØÅÁöÑÁªìÊûúÊâçÊòØÂèó‰ø°„ÄÇÊìç‰ΩúÁ≥ªÁªüÂú®ÂÆâË£ÖËøáÁ®ã‰∏≠‰ºöÈªòËÆ§ÂÆâË£Ö‰∏Ä‰∫õÂèó‰ø°‰ªªÁöÑCAÊú∫ÊûÑÁöÑÊ†πËØÅ‰π¶„ÄÇ SSLÂä´ÊåÅSSL Âä´ÊåÅ‰πüÂ∞±ÊòØ SSL ËØÅ‰π¶Ê¨∫È™óÊîªÂáªÔºåÊîªÂáªËÄÖ‰∏∫‰∫ÜËé∑Âæó HTTPS ‰º†ËæìÁöÑÊòéÊñáÊï∞ÊçÆÔºåÈúÄË¶ÅÂÖàÂ∞ÜËá™Â∑±Êé•ÂÖ•Âà∞ÊµèËßàÂô®‰∏éÁõÆÊ†áÁΩëÁ´ô‰πãÈó¥Ôºà‰∏≠Èó¥‰∫∫ÔºâÔºåÂú®‰º†ËæìÊï∞ÊçÆÁöÑËøáÁ®ã‰∏≠ÔºåÊõøÊç¢ÁõÆÊ†áÁΩëÁ´ôÂèëÁªôÊµèËßàÂô®ÁöÑËØÅ‰π¶Ôºå‰πãÂêéËß£ÂØÜ‰º†Ëæì‰∏≠ÁöÑÊï∞ÊçÆÔºåÁÆÄÂçïÁöÑÂõæÁ§∫Â¶Ç‰∏ãÔºö [ÊµèËßàÂô®] &lt;======&gt; [ÁõÆÊ†áÁΩëÁ´ô] ÔºàÊ≠£Â∏∏ÊÉÖÂÜµÔºâ[ÊµèËßàÂô®] &lt;======&gt; ‰∏≠Èó¥‰∫∫ &lt;======&gt; [ÁõÆÊ†áÁΩëÁ´ô] Ôºà‰∏≠Èó¥‰∫∫ÊîªÂáªÔºâ ‰∏≠Èó¥‰∫∫ÊîªÂáªÊúÄÂ•ΩÁöÑÁéØÂ¢ÉÊòØÂú®Â±ÄÂüüÁΩë‰∏≠ÔºåÂ±ÄÂüüÁΩë‰∏≠ÊâÄÊúâÁöÑËÆ°ÁÆóÊú∫ÈúÄË¶ÅÈÄöËøá‰∏Ä‰∏™Âõ∫ÂÆöÁöÑÂá∫Âè£ÔºàÁΩëÂÖ≥ÔºâÊù•Êé•ÂÖ•‰∫íËÅîÁΩëÔºåÂõ†Ê≠§ÊîªÂáªËÄÖÂè™ÈúÄË¶ÅÂú®Â±ÄÂüüÁΩë‰∏≠ÂÆûÊñΩ‰∏ÄÊ¨°‰∏≠Èó¥‰∫∫ÊîªÂáªÂ∞±ÂèØ‰ª•È°∫Âà©ÁöÑÊà™Ëé∑ÊâÄÊúâËÆ°ÁÆóÊú∫‰∏éÁΩëÂÖ≥‰πãÈó¥‰º†ËæìÁöÑÊï∞ÊçÆ„ÄÇ ‰∏≠Èó¥‰∫∫ÊîªÂáª(Man-in-the-Middle AttackÔºåÁº©ÂÜô MITM)„ÄÇ ÂèÇËÄÉÈìæÊé•:HTTPSÈÇ£‰∫õ‰∫ãÔºà‰∏ÄÔºâHTTPSÂéüÁêÜ ÊäìÂåÖÂ∑•ÂÖ∑ mitmproxy ‰ΩøÁî®mitmproxy ÊòØ‰∏ÄÊ¨æÂëΩ‰ª§Ë°åÊäìÂåÖÂ∑•ÂÖ∑ÔºåÂÆÉÈô§‰∫ÜÂèØ‰ª•ÊäìÂåÖÊü•Áúã http/https ËØ∑Ê±ÇÔºåËøòÂèØ‰ª•Êã¶Êà™Âπ∂‰øÆÊîπ request ÊàñËÄÖ response„ÄÇ ÂÆâË£Ö1brew install mitmproxy ÈÖçÁΩÆÊâãÊú∫ÂíåÁîµËÑëÂú®Âêå‰∏ÄÂ±ÄÂüüÁΩë‰∏ãÔºåËÆæÁΩÆÊâãÊú∫ÁöÑ http ‰ª£ÁêÜ„ÄÇÊúçÂä°Âô®‰∏∫ÁîµËÑëÂΩìÂâçÁöÑ ipÔºåÂ¶Ç 192.168.3.10ÔºõÁ´ØÂè£ÂèØ‰ªªÊÑèËÆæÁΩÆÔºå‰∏ÄËà¨ËÆæÁΩÆ‰∏∫8080„ÄÇÁΩëÁªúÁéØÂ¢ÉÈÖçÁΩÆÂ•ΩÂêéÔºåÂú®ÁªàÁ´ØËæìÂÖ• mitmproxy -p 8080ÔºåËøõÂÖ•ÊäìÂåÖÊ®°Âºè„ÄÇ Â¶ÇÊûúÊÉ≥Ë¶ÅÊäìÂèñ https ÁöÑÂåÖÔºåÈúÄË¶ÅËøõ‰∏ÄÊ≠•ÈÖçÁΩÆ„ÄÇÁî® iPhone ÊâìÂºÄ Safari ÊµèËßàÂô®Âπ∂ËæìÂÖ• mitm.itÔºåËøôÊó∂‰Ω†‰ºöÁúãÂà∞Â¶Ç‰∏ãÈ°µÈù¢ÔºåÈÄâÊã©ÂØπÂ∫îÂπ≥Âè∞Âπ∂ÂÆâË£ÖËØÅ‰π¶ÔºåÂÆâË£ÖÂÆåÊàêÂêéÂ∞±ÂèØ‰ª•Êäì https ÁöÑÂåÖ‰∫Ü„ÄÇÊ≥®ÊÑèÔºåÁî®ÊµèËßàÂô®ÊâìÂºÄÊó∂ÈúÄË¶ÅÂ∑≤ÁªèÂú®ÊäìÂåÖÊ®°ÂºèÔºåÂê¶ÂàôÊòØÊó†Ê≥ïÁúãÂà∞‰∏äËø∞È°µÈù¢ÁöÑ„ÄÇ ÊäìÂåÖËΩØ‰ª∂Áõ∏ÂΩì‰∫éÂú®Áî®Êà∑ÂíåÊúçÂä°Âô®Èó¥Â¢ûÂä†‰∫Ü‰∏Ä‰∏™‰∏≠Èó¥‰∫∫„ÄÇÂÆâË£ÖÊäìÂåÖËΩØ‰ª∂ÁöÑËØÅ‰π¶ÔºåËøôÊ†∑‰∏≠Èó¥‰∫∫Â∞±ÂèØ‰ª•Ëé∑ÂæóÁî®Êà∑Á´ØÁîüÊàêÁöÑÂØÜÈí•ÔºåÂ∞±ËÉΩÂ§üËß£ÂØÜÁî®Êà∑ÂíåÊúçÂä°Âô®Èó¥ÁöÑ‰ø°ÊÅØ„ÄÇÊ≥®ÊÑèÔºå‰∏ÄÂÆö‰∏çÂèØÈöèÊÑè‰∏ãËΩΩ‰ø°‰ªª‰∏çÊòéÁöÑËØÅ‰π¶ ‰ΩøÁî®Èöè‰æøÊâìÂºÄ‰∏Ä‰∏™ appÔºåÂ∞±ÂèØ‰ª•ÁúãÂà∞Â¶Ç‰∏ãÁöÑ‰∏Ä‰∏™ËØ∑Ê±ÇÂàóË°®„ÄÇ Â∏∏Áî®Âø´Êç∑ÈîÆÔºö enter: Êü•ÁúãËØ¶ÁªÜËØ∑Ê±Ç Tab: ÂàáÊç¢È°∂ÈÉ®ÂØºËà™Ê†è z: Ê∏ÖÁ©∫ÂàóË°® f: ËøáÊª§ËØ∑Ê±Ç„ÄÇÂèØ‰ª•ÂèÇÁÖßÂ∏ÆÂä©‰∏≠ÁöÑ Filter expression ÂØπËøáÊª§ÂÖ≥ÈîÆÂ≠óËøõË°åÁºñËæë„ÄÇÂà†Èô§ËøáÊª§Â∞±ÊòØÂ∞ÜËøáÊª§ÂÖ≥ÈîÆÂ≠óÊ∏ÖÁ©∫„ÄÇÂÖ∂ÂÆûËøòÂèØ‰ª•ÊúâÊõ¥Â§öËøáÊª§ÊñπÂºèÔºåÂåÖÊã¨ËøáÊª§ÊåáÂÆöÁöÑ headerÔºåÊåáÂÆöÁöÑ bodyÔºåËøáÊª§ËØ∑Ê±Ç„ÄÅÂõûÂ§çÁ≠â„ÄÇÂÖ∑‰ΩìÂèÇËßÅÊñáÊ°£ d: Âà†Èô§ËØ∑Ê±Ç h: ÊòæÁ§∫ÊâÄÊúâÂ∏ÆÂä© m: ÊîπÂèòËØ∑Ê±ÇËøîÂõûÂÆû‰ΩìÁöÑÁ±ªÂûã„ÄÇÊØîÂ¶ÇÊää raw Êîπ‰∏∫ json Èô§‰∫ÜÂø´Êç∑ÈîÆÔºåÊàë‰ª¨ÂèØ‰ª•Êåâ‰Ωè command ÁÇπÂáª url Êù•Âú®ÊµèËßàÂô®‰∏≠Êü•ÁúãÁΩëÈ°µ‰ø°ÊÅØ„ÄÇÂèØ‰ª•Êåâ‰Ωè command+option+fn ÁÑ∂ÂêéÈÄâ‰∏≠‰ø°ÊÅØ Êã¶Êà™ËæìÂÖ• i ËÆæÁΩÆÊã¶Êà™ÔºåÂÜçËæìÂÖ• ~s ËøõÂÖ• response Êã¶Êà™Ê®°ÂºèÔºå~q ËøõÂÖ• request Êã¶Êà™Ê®°Âºè„ÄÇÂ¶ÇÊûú‰∏çÊÉ≥Êã¶Êà™‰∫Ü„ÄÇÂÜçÊ¨°ËæìÂÖ• i Â∞ÜÂàöÊâçËÆæÁΩÆÁöÑÂèÇÊï∞Ê∏ÖÁ©∫Âç≥ÂèØ„ÄÇ‰πüÂèØ‰ª•ÈîÆÂÖ• I Ë°®Á§∫ÊöÇÂÅúÊã¶Êà™„ÄÇ ËÆæÁΩÆÊã¶Êà™ÂêéÔºåÊã¶Êà™‰∏ãÊù•ÁöÑËØ∑Ê±Ç‰∏∫Á∫¢Ëâ≤„ÄÇËøôÊó∂ Enter ËøõÂÖ•Âêé ÂÜçÊåâ e Â∞±ÂèØ‰ª•‰øÆÊîπ request ÊàñËÄÖ responseÔºå‰ºöÂÖàËÆ©‰Ω†ÈÄâÊã©‰øÆÊîπÂì™‰∏ÄÈÉ®ÂàÜÔºå‰∏ÄËà¨ÈÉΩÊòØ‰øÆÊîπËøîÂõûÁöÑÊï∞ÊçÆÂØπÂ∫î‰∫éÈáåÈù¢ÁöÑ raw„ÄÇ‰øÆÊîπÊó∂ÊòØÁî® vim ËøõË°åÁºñËæëÁöÑÔºå‰øÆÊîπÂÆåÊàêÂêéÊåâ a Â∞ÜËØ∑Ê±ÇÊîæË°åÔºåÂ¶ÇÊûúË¶ÅÊîæË°åÊâÄÊúâËØ∑Ê±ÇËæìÂÖ• A Âç≥ÂèØ„ÄÇ ‰∏≠ÊñáÂ≠óÁ¨¶Êó†Ê≥ïÊòæÁ§∫‰∏≠ÊñáÂ≠óÁ¨¶Êó†Ê≥ïÊòæÁ§∫ÂÖ∂ÂÆûÊòØÁªàÁ´ØÁöÑÈóÆÈ¢ò„ÄÇÊàë‰ª¨Ë¶Å‰øÆÊîπ .zshrcÔºåÂú®ÊúÄÂ∫ïÈÉ®Ê∑ªÂä†‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÔºö 12export LC_ALL=en_US.UTF-8 export LANG=en_US.UTF-8 ÁÑ∂ÂêéÈáçÂêØÔºåÂ∞±ÂèØ‰ª•ÁúãÂà∞‰∏≠ÊñáÂ≠óÁ¨¶‰∫Ü„ÄÇ iOS Ê®°ÊãüÂô®ÊäìÂåÖ‰∏∫Ê®°ÊãüÂô®ÊäìÂåÖÈúÄË¶ÅËÆæÁΩÆÁΩëÁªú‰ª£ÁêÜ‰∏∫Êú¨Êú∫ÔºåÂãæÈÄâ HTTP ‰ª£ÁêÜÂíå HTTPS ‰ª£ÁêÜÔºö ËøòË¶Å‰∏∫Ê®°ÊãüÂô®ÈÖçÁΩÆ SSL ËØÅ‰π¶„ÄÇÈÖçÁΩÆËØÅ‰π¶Áõ∏ÂØπÈ∫ªÁÉ¶„ÄÇÈ¶ñÂÖàËøõÂÖ• ~/.mitmproxyÁõÆÂΩïÔºåËøô‰∏™ÁõÆÂΩï‰∏ãÊúâ‰∫îÂÖ≠‰∏™ËØÅ‰π¶ÔºåÂÖ∂‰∏≠‰∏Ä‰∏™ÊòØÁ¨¶ÂêàË¶ÅÊ±ÇÁöÑ„ÄÇÈúÄË¶Å‰∏ãËΩΩ‰∏Ä‰∏™ python ËÑöÊú¨ Êù•ÂØºÂÖ•ËØÅ‰π¶„ÄÇ‰∏ãËΩΩÂêéÊâßË°åÔºö 1./iosCertTrustManager.py -a mitmproxy-ca-cert.pem Ëøô‰∏™ËÑöÊú¨Âè™ËÉΩÂØºÂÖ• pem Ê†ºÂºèÁöÑËØÅ‰π¶„ÄÇÊâßË°åÊó∂‰ºöÈóÆ‰Ω†ÊòØÂê¶Â∞ÜÂÖ∂Ê∑ªÂä†Âà∞Êüê‰∏™Ê®°ÊãüÂô®‰∏≠ÔºåÊåâ y Âç≥ÂèØ„ÄÇÊ∑ªÂä†ÊàêÂêéÈúÄË¶ÅÈáçÂêØÊ®°ÊãüÂô®Â∞±ËÉΩÂ§üÊäìÂèñ https ÁöÑÂåÖ‰∫Ü„ÄÇ Ê®°ÊãüÂô®ÊäìÂåÖÊèêÁ§∫Certificate Verification Error for www.xxxx.com: unable to get local issuer certificate‰ΩøÁî®Ôºö 1mitmproxy -p 8080 --ssl-insecure --set block_global=false ÂøΩÁï•ÂÆâÂÖ®Ê†°È™å]]></content>
      <categories>
        <category>ËÆ°ÁÆóÊú∫</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[hexo ÈÖçÁΩÆÈÅáÂà∞ÁöÑ‰∏Ä‰∫õÂùë]]></title>
    <url>%2F2016%2F12%2F03%2Fhexo%E7%88%AC%E8%BF%87%E7%9A%84%E5%9D%91%2F</url>
    <content type="text"><![CDATA[ÈÖçÁΩÆ‰∏™‰∫∫ÂçöÂÆ¢ÊúâÊó∂ÂÄôÊòØ‰∏Ä‰ª∂ÂæàËõãÁñºÁöÑ‰∫ãÊÉÖÔºåÁªèÂ∏∏‰ºöÂá∫Áé∞‰∏Ä‰∫õÂ•áÂ•áÊÄ™ÊÄ™ÁöÑÈóÆÈ¢ò„ÄÇËøôÈáåÊàëÂ∞±Â∞ÜÊääÊàëÂ°´‰∏äÁöÑ‰∏Ä‰∫õÂùëÊÄªÁªì‰∏Ä‰∏ã„ÄÇ hexo d Êó†Ê≥ïÊèêÁ§∫ fatal: could not read Username for xxx‰πãÂâç‰∏ÄÁõ¥Ê≤°ÊúâÈóÆÈ¢òÔºåÊúÄËøëÁ™ÅÁÑ∂Êä•‰∫ÜËøô‰∏™Èîô„ÄÇÂéüÂõ†Â∞±ÊòØÊ≤°ÊúâËÆæÁΩÆÂ•ΩÁî®Êà∑ÂêçÂØÜÁ†Å„ÄÇ ÊâìÂºÄ _config.ymlÔºå‰øÆÊîπdeployËäÇÁÇπ: 1234567891011# ÂéüÊù•ÁöÑËÆæÁΩÆdeploy:type: gitrepo: https://github.com/&#123;yourname&#125;/&#123;yourname&#125;.github.io.gitbranch: master# ‰øÆÊîπ‰∏∫deploy:type: gitrepo: https://&#123;yourname&#125;:&#123;yourpassword&#125;@github.com/&#123;yourname&#125;/&#123;yourname&#125;.github.io.gitbranch: master Êõ¥Êñ∞ hexoËá™‰ªéÊääËá™Â∑±ÁöÑÂçöÂÆ¢ÊûÑÂª∫Ëµ∑Êù•ÂêéÂ∞±Ê≤°ÊúâÂçáÁ∫ßËøá hexoÔºåËøôÊ¨°Ë¶ÅËÆæÁΩÆ apple-touch-iconÔºåÊõ¥Êñ∞‰∫Ü hexoÔºå‰πüËä±‰∫ÜÂ∞èÂçäÂ§©Êó∂Èó¥„ÄÇËÆ∞Ëø∞‰∏Ä‰∏ãÔºå‰ª•ÂêéÊõ¥Êñ∞ÊàñËÄÖÊç¢ÁîµËÑëËøÅÁßªÂ∞±ÂÆπÊòì‰∏Ä‰∫õ‰∫Ü„ÄÇ ‰∏ãËΩΩ npmnpm ÊòØÁî± node Êèê‰æõÁöÑ„ÄÇÂõ†Ê≠§ÔºåÂà∞ node ÁöÑÂÆòÁΩë‰∏ãËΩΩÂÆâË£Ö node Âç≥ÂèØËé∑Âæó npm ÂÆâË£Ö hexo‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§ÂÆâË£Ö hexo ÁöÑÊúÄÊñ∞ÁâàÊú¨ 1npm install hexo-cli -g ÂàùÂßãÂåñ hexoÂ¶ÇÊûú‰Ω†ÊòØÊõ¥Êñ∞ hexoÔºåÂèØËÉΩ‰ª•‰∏∫ËøôÊ≠•Ê≤°ÊúâÂøÖË¶ÅÔºåËøô‰πàÊÉ≥Â∞±Èîô‰∫Ü„ÄÇhexo Êõ¥Êñ∞ÁöÑÊó∂ÂÄô‰ºöÊõ¥Êñ∞‰∏Ä‰∫õ node-modulesÔºåËøô‰∫õ node-modules Âπ∂‰∏çÂú® package.json ‰∏≠ËÆ∞ÂΩïÔºåËøô‰∫õ module ÊòØÂæàÈáçË¶ÅÁöÑ„ÄÇÊâÄ‰ª•‰∏çÁÆ°ÊòØÊõ¥Êñ∞ËøòÊòØÊñ∞Âª∫Ôºå‰Ω†ÈÉΩÂøÖÈ°ªË¶ÅÂàùÂßãÂåñ hexo„ÄÇ‰Ω†ÂèØ‰ª•Âú®‰∏Ä‰∏™Á©∫Êñá‰ª∂Â§π‰∏≠ÂàùÂßãÂåñÂ•Ω hexoÔºåÁÑ∂ÂêéÊääËøô‰∫õ module Êã∑Ë¥ùÂà∞‰Ω†ÂΩìÂâçÁöÑ node-module Êñá‰ª∂Â§πÂÜÖ 1hexo init ‰∏ãËΩΩ node-moduleËøôÊ≠•Â∞±‰∏çÂ§öËØ¥‰∫Ü 1npm install ‰∏ãËΩΩ deploy modulehexo3 ÂºÄÂßãÈúÄË¶ÅÂÄüÂä©‰∏Ä‰∏™ deploy module Êù•Êé®ÈÄÅÂçöÂÆ¢Ôºå‰ΩÜËøôÂπ∂Ê≤°ÊúâÂú®ÈªòËÆ§ÁöÑ package.json ‰∏≠ÔºåË¶ÅËá™Â∑±Âä®ÊâãÊ∑ªÂä†Ôºö 1npm install hexo-deployer-git --save Êõ¥Êñ∞ nextnext ËÇØÂÆöË¶ÅÂíå hexo ÂêåÊ≠•Êõ¥Êñ∞ÂëÄÔºåÁé∞Âú® next ‰∏ªÈ¢òÈùûÂ∏∏‰∫∫ÊÄßÂåñ‰∫ÜÔºåÁé∞Âú®ÂèØ‰ª•Ê∑ªÂä† apple-touch-iconÔºåËÄå‰∏î‰πüÊúâ‰∫ÜÈªòËÆ§ÁöÑÊú¨Âú∞ÊêúÁ¥¢„ÄÇÊâÄ‰ª•ËÆ∞ÂæóË¶Å‰ªîÁªÜÁúãÈÖçÁΩÆÊñá‰ª∂Ôºå‰∏çË¶ÅÁõ¥Êé•Êää‰ª•ÂâçÁöÑÈÖçÁΩÆÊñá‰ª∂Áõ¥Êé•Êã∑Ë¥ùËøáÊù•„ÄÇ Êõ¥Êñ∞ nextÊõ¥Êñ∞ next ÁöÑËØùÔºå‰Ω†ÂèØ‰ª•Áõ¥Êé•ÊääÂéüÊù•ÁöÑ next Êñá‰ª∂Â§πÂà†ÊéâÔºåÁÑ∂Âêé‰ΩøÁî®ÁªàÁ´ØÊãâÂèñÔºö 1git clone https://github.com/iissnan/hexo-theme-next themes/next Êõ¥ÊîπÂõæÁâáÂåÖÊã¨ faviconÔºåapple-touch-iconÔºåavatar ÈÉΩÂèØ‰ª•Âú® next ‰∏ªÈ¢ò‰∏≠ÈöèÊÑèÊõøÊç¢„ÄÇË∑ØÂæÑÂú® next ‰∏ªÈ¢òÁöÑ _config.yml ‰∏≠ÈÖçÁΩÆÔºåÈªòËÆ§Ë∑ØÂæÑÂú® themes/next/source/images ÂÜÖ„ÄÇ ÊêúÁ¥¢Âú® _config.yml ‰∏≠Â∑≤ÁªèÊúâ‰∫ÜÊêúÁ¥¢ÁöÑÈÖçÁΩÆÔºå‰Ω†Âè™Ë¶ÅËÆæÁΩÆ enable ‰∏∫ true Âç≥ÂèØ„ÄÇÁÑ∂ÂêéÂ∞±ÊòØ‰∏ãËΩΩÊêúÁ¥¢ÁöÑ moduleÔºåÊâßË°åÔºö 12npm install hexo-generator-search --savenpm install hexo-generator-searchdb --save ÂêÑÁßçÈÉ®ÁΩ≤ÁöÑÂÜÖÂÆπÂíåÊú¨Âú∞‰∏ç‰∏ÄËá¥ÊúâÊó∂ÂÄô hexo ‰ºöÊäΩÈ£éÔºåÊúâ‰∫õÊñá‰ª∂Êó†ËÆ∫ÊÄé‰πà hexo g ÈÉΩ deploy ‰∏ç‰∏äÂéª„ÄÇËøô‰∏™Êó∂ÂÄôÂèØ‰ª•ËæìÂÖ• hexo cleanÔºåÂà†Èô§ database Âíå public Êñá‰ª∂Â§πÔºåÂÜç generate Âíå deploy Â∞±ÂèØ‰ª•ÈÉ®ÁΩ≤ÊàêÂäü‰∫Ü„ÄÇ ÊêúÁ¥¢ÂäüËÉΩÊâì‰∏çÂºÄÂÜô‰∫Ü‰∏ÄÁâáÊñáÁ´†ÂêéÁÇπÂáªÊêúÁ¥¢Êó†ÂìçÂ∫î‰∫Ü„ÄÇ ËøôÂõûÁöÑÂéüÂõ†ÊòØÂú®ÊñáÁ´†‰∏≠ÁöÑÊüê‰∏ÄÂ§ÑÂ§ö‰∫Ü‰∏Ä‰∏™Á©∫ÁôΩÂ≠óÁ¨¶ÔºåÂ∞±ÊòØÈÇ£Áßç‰ªÄ‰πà‰ΩçÁΩÆ‰πü‰∏çÂç†Ôºå‰ΩÜÊòØÊåâ‰∏ÄÊ¨° delete ÊâçËÉΩÂà†Èô§ÁöÑÈÇ£Áßç‰∏úË•ø„ÄÇÊääËøô‰∏™Á©∫ÁôΩÂ≠óÁ¨¶Âà†ÊéâÂ∞±ÂèØ‰ª•Ê≠£Â∏∏ÊêúÁ¥¢‰∫Ü„ÄÇ ‰∫ßÁîüËøôÁßçÂ≠óÁ¨¶ÁöÑÂéüÂõ†‰∏çÂ§™Ê∏ÖÊ•öÔºåÊéíÊü•Ëµ∑Êù•‰πüÂæàÈ∫ªÁÉ¶„ÄÇÊú¨Êù•ÈÉΩÊòØÊØèÊ¨°‰øÆÊîπÂêéÔºåÈÉΩË¶Å hexo g ÂÜç hexo s ÁöÑÔºåÂæàË¥πÂäõ„ÄÇ‰∏çËøáÔºåÂêéÊù•ÊàëÂèëÁé∞Â¶ÇÊûúÂêØÁî®Êú¨Âú∞ÊúçÂä°Âô®ÔºåÂç≥ hexo sÔºåÈÇ£‰πàÁõ¥Êé•‰øÆÊîπÂêéÔºåÂà∑Êñ∞ localhost ÁöÑÁΩëÈ°µ(‰πüÂèØ‰ª•‰∏çÂà∑Êñ∞)ÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•Êü•Áúã‰øÆÊîπÊòØÂê¶ÊúâÊïà‰∫Ü„ÄÇÊâÄ‰ª•ËØ¥Êú¨Âú∞ÊúçÂä°Âô®ÁöÑÊêúÁ¥¢Â∫îËØ•‰∏çËµ∞ search.xml ÔºåËÄåÊòØÁõ¥Êé•ÊãøÂèñÊú¨Âú∞Êñá‰ª∂„ÄÇËøôÊ†∑Ë∞ÉËØïËµ∑Êù•Êñπ‰æøËÆ∏Â§ö„ÄÇ ÊéíÊü•ÁöÑÊñπÊ≥ïÂ∞±ÊòØÂÖàÂà†ÈÉ®ÂàÜÊñá‰ª∂ÔºåÁúãÊòØÂê¶ÂèØ‰ª•ÊâìÂºÄÊêúÁ¥¢ÂäüËÉΩÔºåËøôÊ†∑Â∞±ËÉΩÂÆö‰ΩçÂà∞Êüê‰∏™Êñá‰ª∂ÔºåÁÑ∂ÂêéÂêåÊ†∑ÁöÑÊñπÊ≥ïÂÆö‰ΩçÂà∞Êüê‰∏ÄÊÆµÔºåÊúÄÂêéÂú®Ëøô‰∏ÄÊÆµ‰∏≠‰∏çÂÅúÁöÑÁßªÂä®ÂÖâÊ†áÔºåÂ¶ÇÊûúÊúâÁ©∫ÁôΩÂ≠óÁ¨¶ÔºåÈÇ£‰πà‰ºöÂú®Êüê‰∏™Âú∞ÊñπÁßªÂä®ÂÖâÊ†áÁöÑÊó∂ÂÄôÔºåÂÖâÊ†á‰∏çÂä®„ÄÇËøô‰∏™Êó∂ÂÄôÂà†Èô§Ëøô‰∏™Á©∫ÁôΩÂ≠óÁ¨¶Â∞±Ë°å‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Áà¨Âùë</tag>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-Native ÊäÄÂ∑ß‰∏éÂùëÊÄªÁªì]]></title>
    <url>%2F2016%2F11%2F25%2FRN%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáÂ∞ÜÊî∂ÈõÜÂÖ≥‰∫é React-Native ÁöÑÂêÑÁßçÊäÄÂ∑ß‰∏éÂùëÔºå‰∏çËÆ∫ÊòØÊëòÂΩïÁöÑËøòÊòØËá™Â∑±ÈÅáÂà∞ÁöÑ„ÄÇ ÂáΩÊï∞ÂºèÁªÑ‰ª∂ÂáΩÊï∞ÂºèÁªÑ‰ª∂Âç≥ÈÄöËøáË∞ÉÁî®‰∏Ä‰∏™ÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™ÁªÑ‰ª∂„ÄÇÊØîÂ¶ÇËøîÂõû‰∏Ä‰∏™ classÔºö 123456789101112start (TopLevelNavigator) &#123; let store = this.getStore() return class extends Component &#123; render () &#123; return ( &lt;Provider store=&#123;store&#125;&gt; &lt;TopLevelNavigator /&gt; &lt;/Provider&gt; ) &#125; &#125;&#125; ‰∏äÈù¢ÈÄöËøáË∞ÉÁî®‰∏Ä‰∏™ start ÊñπÊ≥ïÔºåËøîÂõû‰∏Ä‰∏™Êñ∞ÁöÑÁªÑ‰ª∂ÁöÑÁ±ª„ÄÇ‰∏çËøáÂØπ‰∫éÊó†Áä∂ÊÄÅÁöÑÁªÑ‰ª∂Êù•ËØ¥ÔºåÂèØ‰ª•ÊúâÊõ¥Â•ΩÁöÑÂÜôÊ≥ï„ÄÇÂõ†‰∏∫ class ‰πüÊòØ‰∏ÄÁßç functionÔºåÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•ÂÜôÊàêËøîÂõû‰∏Ä‰∏™ function: 12345678910start (TopLevelNavigator) &#123; let store = this.getStore() return (props) =&gt; ( &lt;Provider store=&#123;store&#125;&gt; &lt;TopLevelNavigator &#123;...props&#125;/&gt; &lt;/Provider&gt; ) &#125; &#125;&#125; ËøôÊ†∑ÁöÑÂÜôÊ≥ïÊõ¥Âä†Áõ¥ËßÇ„ÄÇ PureComponent Âíå ComponentPureComponent Âíå Component ÁöÑ‰∏çÂêåÂú®‰∫éÂâçËÄÖÊèê‰æõ‰∫Ü‰∏Ä‰∏™ shouldComponentUpdate ÁöÑÈªòËÆ§ÂÆûÁé∞„ÄÇ ÁªßÊâø‰∫é Component ÁöÑÁªÑ‰ª∂Ê≤°ÊúâÂÆûÁé∞ÈªòËÆ§ÁöÑ shouldComponentUpdate ÊñπÊ≥ïÔºåÊØè‰∏Ä‰∏™ props ÁöÑÂèòÂåñ‰ª•ÂèäÂÜÖÈÉ®ÁöÑ setState ÊñπÊ≥ïÁöÑË∞ÉÁî®ÈÉΩ‰ºöËß¶ÂèëÈáçÁªò„ÄÇ ÁªßÊâø‰∫é PureComponent ÁöÑÁªÑ‰ª∂ÔºåÈªòËÆ§Âú® shouldComponentUpdate ‰∏≠ÊØîËæÉÂ∞Ü props Âíå state ‰∏≠ÁöÑÊØè‰∏ÄÈ°πËøõË°åÊµÖÊØîËæÉ„ÄÇÂ¶ÇÊûúÊúâ‰∏çÂêåÊâçÈáçÁªò„ÄÇÊâÄ‰ª•Â¶ÇÊûúÂú® PureComponent ÂÜÖ setState Â∞±‰∏ÄÂÆöË¶Å‰øùËØÅ setState ÁöÑÂØπË±°Âíå‰πãÂâçÁöÑÂØπË±°ÁöÑÂú∞ÂùÄ‰∏çÂêåÔºåÂê¶ÂàôÊØîÂ¶Ç‰øÆÊîπÂØπË±°‰∏≠ÁöÑÊüê‰∏™Â≠óÊÆµËøôÁßçÂú® PureComponent ‰∏≠ÊòØ‰∏ç‰ºöÈáçÁªòÁöÑ„ÄÇ ÈúáÂä®ÈúáÂä®‰ΩøÁî® RN Ëá™Â∏¶ÁöÑ Vibration Âç≥ÂèØ„ÄÇËøôÈáå‰∏ªË¶ÅÊèêÈÜí‰∏Ä‰∏ãÔºåÂ¶ÇÊûúÊòØÈÇ£ÁßçËøûÁª≠‰ºöËß¶ÂèëÁöÑÈúáÂä®ÔºåÂèØ‰ª•‰ΩøÁî® Vibration.cancel() ÊñπÊ≥ïÂèñÊ∂à‰πãÂâçÁöÑÈúáÂä®ÔºåÁÑ∂ÂêéÂÜç Vibration.vibrate(50) ÁªßÁª≠Áü≠È¢ëÈúáÂä®„ÄÇ Ëé∑ÂèñÊéß‰ª∂ÁöÑframeÊñπÂºè‰∏ÄÁªôÊéß‰ª∂Ê∑ªÂä† onLayout ÊñπÊ≥ïÂõûË∞É 123&lt;TouchableOpacity onLayout=&#123;(e) =&gt; this.rowlayouts= e.nativeEvent.layout&#125;/&gt; Â∞±ÂèØ‰ª•ÈÄöËøá this.rowlayouts ÊãøÂà∞ÁªÑ‰ª∂ÁöÑÂÆΩÈ´ò‰ª•ÂèäËµ∑ÂßãÂùêÊ†á ÊñπÂºè‰∫åÂú®ÂÖ∂ÂÆÉÁÇπÂáª‰∫ã‰ª∂Ëß¶ÂèëÁöÑÊó∂ÂÄôÔºåÈÄöËøá ref Ëé∑ÂèñÔºö 12345678910111213import &#123; UIManager, findNodeHandle&#125; from 'react-native'handleClick = () =&gt; &#123; UIManager.measure(findNodeHandle(this.buttonRef),(x,y,width,height,pageX,pageY)=&gt;&#123; // todo &#125;) &#125;&lt;TouchableButton ref=&#123;(ref)=&gt;this.buttonRef=ref&#125; onPress=&#123;this.handleClick&#125;/&gt; pointerEvents=&quot;none&quot; ÁöÑ‰ΩøÁî®Êó∂Êú∫pointerEvents=&quot;none&quot; ÂèØ‰ª•ËÆ©ËÆæÁΩÆÁöÑËßÜÂõæ‰∏çÂìçÂ∫îÁÇπÂáª‰∫ã‰ª∂„ÄÇÂÆûË∑µ‰∏ãÊù•Êúâ‰∏§‰∏™Â∫îÁî®Âú∫ÊôØÔºö ÊØîÂ¶ÇÊúâ‰∏Ä‰∏™ÁªùÂØπÂ∏ÉÂ±ÄÁöÑËßÜÂõæÁõñ‰Ωè‰∫Ü‰∏ãÈù¢ÁöÑËßÜÂõæÔºåÂú® iOS ‰∏≠ÂèØ‰ª•Áõ¥Êé•Â∞ÜÂÖ∂ userInteraction ÁΩÆ‰∏∫ false„ÄÇRN ‰∏≠Áõ∏Â∫îÁöÑÂ±ûÊÄßÂ∞±ÊòØ pointerEvents ÁõëÂê¨ÊâãÂäø‰∫ã‰ª∂ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Â∏åÊúõËé∑ÂèñÂΩìÂâçÊâãÂäøÁõ∏ÂØπ‰∫éÁà∂ËßÜÂõæÁöÑ‰ΩçÁΩÆÔºåÂç≥ event.nativeEvent.locationY Ôºå‰ΩÜÊòØÂ¶ÇÊûúÁà∂ËßÜÂõæ‰∏≠ÊúâÂ≠êËßÜÂõæÔºåÂπ∂‰∏îÊâãÂäø‰ΩúÁî®ÁöÑËµ∑ÂßãÁÇπÂú®Â≠êËßÜÂõæ‰∏äÔºåÈÇ£‰πà event.nativeEvent.locationY ÊòØ‰ª•Â≠êËßÜÂõæ‰∏∫ÂèÇÁÖßÁöÑÔºåÂΩ±ÂìçÊàë‰ª¨ÂØπ‰∫éÂùêÊ†áÁöÑËÆ°ÁÆó„ÄÇËøôÊó∂ÂÄôÂ∞±ÂèØ‰ª•ÊääÂÆÉÁöÑÂ≠êËßÜÂõæËÆæÁΩÆ pointerEvents=&quot;none&quot; ÂÜçËÆ∞Ëø∞‰∏Ä‰∏ãÈÅáÂà∞ÁöÑÂùëÔºåÂú® android ‰∏äÔºåÂ¶ÇÊûúÁà∂ËßÜÂõæÊ∑ªÂä† panresponserÔºåÂ≠êËßÜÂõæÁõ¥Êé•ËÆæÁΩÆ pointerEvents=&quot;none&quot; ‰ºöËÆ©Â≠êËßÜÂõæÁöÑÂå∫ÂüüÊó†Ê≥ïÂìçÂ∫îÁà∂ËßÜÂõæÁöÑÊâãÂäø„ÄÇÂøÖÈ°ªÂú®Â≠êËßÜÂõæ‰∏äÂÜçÂµåÂ•ó‰∏ÄÂ±Ç View„ÄÇÂπ∂‰∏îËøô‰∏™ View ‰πüÊòØÊúâËÆ≤Á©∂ÁöÑ‰∏çËÉΩÁõ¥Êé•ÂµåÂ•ó„ÄÇÂõ†‰∏∫Âú® Android ‰∏äÔºåÁ©∫ÁöÑ View ‰ºöË¢´Áõ¥Êé•ÁßªÈô§„ÄÇÊâÄ‰ª•ÈúÄË¶ÅËÆæÁΩÆ collapsable={false} ËÆ©Android‰πüÂº∫Âà∂Ê∏≤ÊüìÔºåÊâçËÉΩÊ≠£Á°ÆÂìçÂ∫îÁà∂ËßÜÂõæÁöÑÊâãÂäø Â≠òÂú®ÊâãÂäøÁöÑËßÜÂõæ‰∏≠ÁöÑÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂‰∏çÂìçÂ∫îËøô‰∏™ÈóÆÈ¢ò‰∏ªË¶ÅÊòØÂõ†‰∏∫ÁÇπÂáªÊåâÈíÆÁöÑÊó∂ÂÄôÊâãÊåáÊúâÁï•ÂæÆÁöÑÊªëÂä®ÔºåÂõ†Ê≠§ÔºåÁÇπÂáª‰∫ã‰ª∂Ë¢´ËØÜÂà´‰∏∫‰∫Ü Move ‰∫ã‰ª∂ÔºåËøõËÄåÁõ∏Â∫îÊâãÂäøËÄå‰∏çÁõ∏Â∫îÊåâÈíÆ‰∫Ü„ÄÇ ÂÅöÊ≥ïÊòØÂú®ÁªÜÂæÆÁßªÂä®ÁöÑÊó∂ÂÄô‰∏çËÆ©ÊâãÂäøÁõ∏Â∫îÔºö 1234onMoveShouldSetPanResponder (event, gestureState) &#123; let touchCapture = Math.abs(gestureState.dx) &gt; 5 || Math.abs(gestureState.dy) &gt; 5 return touchCapture&#125; FlatList ÁöÑÊÄßËÉΩ‰ºòÂåñFlatList ÁöÑ data ‰∏≠Êé•Êî∂‰∏Ä‰∏™Êï∞ÁªÑÔºå‰Ωú‰∏∫Ê∏≤ÊüìÁöÑÊï∞ÊçÆÊ∫ê„ÄÇÊúâÊó∂ÂÄôÊàë‰ª¨ÁÇπÂáª‰∫Ü cellÔºåË¶ÅÊîπÂèòÁä∂ÊÄÅÂºïËµ∑ÈáçÁªòÔºå‰ΩÜÊòØÁõ¥Êé•‰øÆÊîπ data ‰∏≠Êüê‰∏ÄÈ°πÁöÑÂÄºÔºåÂπ∂‰∏ç‰ºöÂºïËµ∑ÈáçÁªò„ÄÇÂõ†‰∏∫ React ‰∏≠ÊòØÂà§Êñ≠ data ÁöÑÂú∞ÂùÄÊòØÂê¶ÂèòÂåñÔºåÊòæÁÑ∂Ôºådata Âπ∂Ê≤°ÊúâÂèòÂåñÂú∞ÂùÄ„ÄÇ Â¶ÇÊûúÊàë‰ª¨ data = data.map(item =&gt; item) ËøôÊ†∑Êñ∞Âª∫‰∏Ä‰∏™Êï∞ÊçÆÊ∫êÂ∞±ÊúâÁÇπË¥π‰∫ã‰∫Ü„ÄÇFlatList Êèê‰æõ‰∫Ü‰∏Ä‰∏™Â±ûÊÄß extraDataÔºåÂΩìÈúÄË¶ÅÈáçÁªòÁöÑÊó∂ÂÄôÔºåÊîπÂèò extraData ÁöÑÂÄºÂ∞±Ë°å„ÄÇ Êàë‰ª¨ÂèØ‰ª•Â∞Ü extraData Á≠â‰∫éÊüê‰∏Ä‰∏™ state ‰∏≠ÁöÑÂ∏ÉÂ∞îÂÄºÔºåÊØèÊ¨°ÈúÄË¶ÅÈáçÁªòÁöÑÊó∂ÂÄôÔºåËÆ©Ëøô‰∏™Â∏ÉÂ∞îÂÄºÂèñÂèç„ÄÇËøôÊ†∑ FlatList ÂèëÁé∞Ëøô‰∏™Â∏ÉÂ∞îÂÄºÊîπÂèò‰∫ÜÔºåÂ∞±‰ºöÂºïÂèëÊï¥‰∏™ FlatList ÁöÑÈáçÁªò„ÄÇ Êï¥‰∏™ FlatList ÁöÑÈáçÁªò‰πüÊòØ‰ºöÂºïÂèëÊÄßËÉΩÈóÆÈ¢òÁöÑ„ÄÇÊàë‰ª¨Ë¶ÅÂÅöÁöÑÊòØËá™ÂÆö‰πâ‰∏Ä‰∏™ Cell Á±ªÔºåÁÑ∂ÂêéÂ∞ÜÊï∞ÊçÆÊ∫êÁöÑÊüê‰∏™ item ËÆæÁΩÆ‰∏∫‰∏Ä‰∏™Êñ∞ÁöÑÂØπË±°ÔºöObject.assign({}, item, {someChange: xxx})ËøôÊ†∑Âú® FlatList ÈáçÁªòËß¶ÂèëÊØè‰∏Ä‰∏™ cell renderItem ÁöÑÊó∂ÂÄôÔºåÂ§ßÈÉ®ÂàÜ Cell Âπ∂Ê≤°ÊúâÊî∂Âà∞Êñ∞ÁöÑ Props Â∞±‰ºöÈòªÊ≠¢Êï¥‰∏™ cell ÁöÑÈáçÁªò„ÄÇÂè™ÊúâÊï∞ÊçÆÂèòÂåñÁöÑ cell Êâç‰ºöËß¶ÂèëÈáçÁªò ÁªÑ‰ª∂Âú®Âä®Áîª‰∏ãÁöÑÈöêËóèÂíåÊòæÁ§∫ÁªÑ‰ª∂‰ªéÈöêËóèÂà∞ÊòæÁ§∫ÁöÑÂä®ÁîªÊòØÈùûÂ∏∏Â•ΩÊÉ≥Âà∞ÁöÑÔºåÂ∞±ÊòØËÆæÁΩÆÁªÑ‰ª∂ÁöÑ opacity ÈÄèÊòéÂ∫¶„ÄÇ ËÄå‰ªéÊòæÁ§∫Âà∞ÈöêËóèÁöÑËøáÁ®ãÂ∞±ÊúâÁÇπÂùë‰∫Ü„ÄÇÂ¶ÇÊûúËøòÊòØËÆæÁΩÆÈÄèÊòéÂ∫¶‰∏∫ 0ÔºåÈÇ£‰πàËäÇÁÇπËøòÂú®ÔºåÊó†Ê≥ïÂìçÂ∫îÂêéÈù¢ËßÜÂõæÁöÑÁÇπÂáª‰∫ã‰ª∂„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú render ÁöÑÊó∂ÂÄôËøîÂõû nullÔºåÈÇ£‰πàÁªÑ‰ª∂ËäÇÁÇπÂ∞±Áõ¥Êé•Ê∂àÂ§±‰∫ÜÔºåÊó†Ê≥ïËææÂà∞Âä®ÁîªÁöÑÊïàÊûú„ÄÇ ËøôÈáåÊúâ‰∏§ÁßçÊñπÂºèËÆæÁΩÆÈöêËóèÔºö displayËøôÈáåÊàë‰ª¨Â∫îËØ•ÂÄüÂä©‰∏Ä‰∏™ CSS Â±ûÊÄß display ,ÂΩìÂÆÉ‰∏∫ none ÁöÑÊó∂ÂÄôÔºåËäÇÁÇπËøòÂú®Ôºå‰ΩÜÊòØÁªÑ‰ª∂‰ªéËßÜÂõæ‰∏äÁßªÈô§‰∫ÜÔºå‰∏ç‰ºöÂΩ±ÂìçÂêéÈù¢ÁöÑÁÇπÂáª‰∫ã‰ª∂„ÄÇ ËøôÈáå‰∏æ‰∏Ä‰∏™ÊòæÁ§∫Â§¥ÈÉ®ËßÜÂõæÁöÑ‰æãÂ≠ê„ÄÇÁ§∫‰æã‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526renderHeader () &#123; if (this.props.showHeader) &#123; this.state.showHeader = true Animated.timing(this.headerViewAlpha, &#123; toValue: 1, duration: 700 &#125;).start() &#125; else &#123; Animated.timing(this.headerViewAlpha, &#123; toValue: 0, duration: 700 &#125;).start(() =&gt; &#123; this.setState(&#123; showHeader: false &#125;) &#125;) &#125; // Â§ñÈÉ®ËÆ©ÊòæÁ§∫ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂÜÖÈÉ®‰πüËÆ©ÊòæÁ§∫ÁöÑÊó∂ÂÄôÊâçÊòæÁ§∫ let display = !this.state.showHeader &amp;&amp; !this.props.showHeader ? 'none' : 'flex' return ( &lt;Animated.View style=&#123;&#123;opacity: this.headerViewAlpha, marginBottom: -20, display&#125;&#125;&gt; &#123;this.props.headerView()&#125; &lt;/Animated.View&gt; )&#125; Ëøô‰∏™ÁªÑ‰ª∂ÈÄöËøáÂ§ñÈÉ®‰º†ËøõÊù•ÁöÑ showHeader ÊéßÂà∂ÊòæÁ§∫ÂíåÈöêËóè„ÄÇÂΩìÂ§ñÈÉ®‰º†Êù•ÁöÑ showHeader ‰∏∫ true Êó∂ÔºåÁõ¥Êé•ÈÄöËøáÈÄèÊòéÂ∫¶ÁöÑÂä®ÁîªÊòæÁ§∫ÁªÑ‰ª∂„ÄÇÂΩìÂ§ñÈÉ®‰º†Êù•ÁöÑ showHeader ‰∏∫ false Êó∂ÔºåÂÖàÈÄöËøáÈÄèÊòéÂ∫¶Âä®ÁîªÈöêËóèÁªÑ‰ª∂ÔºåÁÑ∂ÂêéËÆæÁΩÆÂÜÖÈÉ®ÁöÑ showHeader ‰∏∫ falseÔºåÈáçÁªòËßÜÂõæ„ÄÇÈáçÁªòÁöÑÊó∂ÂÄôÂõ†‰∏∫ÂÜÖÂ§ñÈÉ®ÁöÑ showHeader ÈÉΩ‰∏∫ falseÔºåÂ∞±Â∞Ü display ËÆæ‰∏∫ none ‰∫ÜÔºå‰ªéËÄåËææÂà∞Âú®Âä®ÁîªÂÆåÊàêÂêéÈöêËóèËßÜÂõæÁöÑÊïàÊûú„ÄÇ ËøôÁßçÊñπÂºèÂú® render ÊñπÊ≥ï‰∏≠ÂèàËÆæÁΩÆ‰∫Ü state ÂÖ∂ÂÆûÊòØ‰∏çÂ§™Êé®ËçêÁöÑ„ÄÇ heightÂè¶Â§ñ‰∏ÄÁßçÊñπÂºèÂ∞±ÊòØËÆæÁΩÆËßÜÂõæÁöÑÈ´òÂ∫¶Ôºå‰ΩøÂÖ∂È´òÂ∫¶‰∏∫ 0: 123456789101112131415161718192021this.headerViewHeight = new Animated.Value(deviceHeight)if (showCurrentHeader) &#123; Animated.timing(this.headerViewHeight, &#123; toValue: deviceHeight, duration: 0 &#125;).start()&#125; else &#123; Animated.timing(this.headerViewHeight, &#123; toValue: 0, duration: 700 &#125;).start()&#125;renderHeader () &#123; return ( &lt;Animated.View style=&#123;&#123;height: this.headerViewHeight&#125;&#125;&gt; &#123;this.props.headerView()&#125; &lt;/Animated.View&gt; )&#125; ËøôÈáåÂä®ÊÄÅ‰øÆÊîπ‰∫Ü headerViewHeight Ëøô‰∏™È´òÂ∫¶„ÄÇ‰∏çËøáË¶ÅÊ≥®ÊÑèÔºåËøôÈáå‰øÆÊîπ‰∫ÜÈ´òÂ∫¶Âπ∂‰∏çÊòØËØ¥Â≠êËßÜÂõæÂ∞±‰∏ÄÂÆö‰ºöÈöêËóèÁöÑ„ÄÇÊúâ‰∫õÁªÑ‰ª∂ÂèØËÉΩËøòÊòØ‰ºöÂ±ïÁ§∫Âá∫Êù•ÔºåËøô‰∏™Êó∂ÂÄôÂ∞±Ë¶ÅËÆæÁΩÆ style ÁöÑ overflow: &#39;hidden&#39; ‰∏äÈù¢ËøôÁßçÊñπÂºè‰Ω†ÂèØËÉΩ‰ºöÊúâÁñëÈóÆÔºåËøôÊòØÁü•ÈÅìÊéß‰ª∂È´òÂ∫¶ÁöÑÊÉÖÂÜµ‰∏ãÊâçÂèØ‰ª•ËÆæÁΩÆÈ´òÂ∫¶„ÄÇÈÇ£‰πàÂ¶ÇÊûúÊéß‰ª∂ÁöÑÈ´òÂ∫¶ÊòØÂåÖË£πÁöÑÊéß‰ª∂ÁöÑÈ´òÂ∫¶ÔºåÊó†Ê≥ïÁü•ÈÅìÂáÜÁ°ÆÁöÑ heightÔºåËøôÁßçÊÉÖÂÜµÊÄé‰πàÂäûÂë¢Ôºü ÊÄùË∑ØÊòØ‰∏çËøõË°åÂä®Áîª‰πãÂâç‰∏çËÆæÁΩÆ heightÔºåÂú®Ê∏≤ÊüìÂÆåÊàêÁöÑÊó∂ÂÄôÔºåÂ∞ÜËßÜÂõæÁöÑÈ´òÂ∫¶‰øùÂ≠òËµ∑Êù•ÔºåÂæÖÂà∞Â∞ÜË¶ÅÂºÄÂßãÂä®ÁîªÁöÑÊó∂ÂÄôÔºåÁ´ãÂç≥ setStateÔºåÂ∞Ü height ËÆæÁΩÆËøõÂéªÔºåÂú® setState ÁöÑÂõûË∞É‰∏≠ÂºÄÂêØÂä®Áîª„ÄÇ‰∏ãÈù¢ÊòØ‰∏Ä‰∏™Âä®ÁîªÂÆûÁé∞ Cell Âà†Èô§ÁöÑÁ§∫‰æãÔºö 12345678910111213141516171819202122232425262728293031323334353637383940414243export default class CanDeleteCell extends React.PureComponent &#123; constructor (props) &#123; super(props) this.alpha = new Animated.Value(1) this.height = null this.state = &#123; isDelete: false &#125; &#125; deleteCell () &#123; return new Promise((resolve, reject) =&gt; &#123; this.setState(&#123; isDelete: true &#125;, () =&gt; &#123; Animated.timing(this.alpha, &#123; toValue: 0, duration: 500 &#125;).start() Animated.timing(this.height, &#123; toValue: 0, duration: 500 &#125;).start((finished) =&gt; &#123; if (finished) &#123; resolve(this.props.index) &#125; else &#123; reject(this.props.index) &#125; &#125;) &#125;) &#125;) &#125; render () &#123; const innerStyle = this.state.isDelete ? &#123;opacity: this.alpha, height: this.height&#125; : &#123;opacity: this.alpha&#125; return ( &lt;Animated.View onLayout=&#123;e =&gt; &#123; this.height = new Animated.Value(e.nativeEvent.layout.height) &#125;&#125; style=&#123;[...this.props.style, innerStyle]&#125; &gt; &#123;this.props.children&#125; &lt;/Animated.View&gt; ) &#125;&#125; Âú®ÊúÄÂºÄÂßãÊ∏≤ÊüìÁöÑÊó∂ÂÄôÔºå‰ΩøÁî® onLayout ÊãøÂà∞È´òÂ∫¶ÔºåÂæÖÂà∞Â§ñÈÉ®Ë∞ÉÁî® deleteCell ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÁ´ãÂç≥ setState Êää isDelete ÁΩÆ‰∏∫ true„ÄÇÁÑ∂ÂêéÈáçÁªò„ÄÇ Â∏¶Êúâ Gesture ÁöÑÁà∂ÁªÑ‰ª∂‰ºö block Â≠êÁªÑ‰ª∂‰∏≠ TouchableOpacity ÁöÑÁÇπÂáª‰∫ã‰ª∂ÊääÊåâÈíÆÊîæÂà∞Êúâ Move ÊâãÂäøÁöÑÁà∂ÁªÑ‰ª∂ÁöÑÊó∂ÂÄô‰ºöÁªèÂ∏∏Âõ†‰∏∫ÂìçÂ∫î‰∫ÜÁà∂ÁªÑ‰ª∂ÁöÑ Move ÊâãÂäøËÄå‰∏çÂìçÂ∫îÊåâÈíÆÁöÑÁÇπÂáª‰∫ã‰ª∂„ÄÇËøô‰∏™Êó∂ÂÄôÈúÄË¶ÅÁªô Move ÊâãÂäøÁöÑÊ∑ªÂä†Ë°å‰∏∫ÂÅö‰∏Ä‰∏™ÈôêÂà∂Ôºö 1onMoveShouldSetPanResponder: (evt, gestureState) =&gt; Math.abs(gestureState.dx) &gt; 5 || Math.abs(gestureState.dy) &gt; 5 ÂΩìÁßªÂä®ÁöÑË∑ùÁ¶ªË∂ÖËøá5‰πãÂêéÔºåÊâçÂìçÂ∫îÊªöÂä®‰∫ã‰ª∂„ÄÇ ‰ΩøÁî®ÁªùÂØπË∑ØÂæÑÊõø‰ª£Áõ∏ÂØπË∑ØÂæÑÂ¶ÇÊûúÂú® import ÁöÑÊó∂ÂÄô‰ΩøÁî®Áõ∏ÂØπË∑ØÂæÑÔºåÈÇ£‰πàÊúâ‰∫õÂ±ÇÁ∫ßËæÉÊ∑±ÁöÑÊó∂ÂÄô‰ºöÈùûÂ∏∏ÈöæÁúãÔºåÂèØ‰ª•‰ΩøÁî®devdependency ‰∏≠ÂÆâË£Ö npm Êèí‰ª∂Ôºöbabel-plugin-root-import ÁÑ∂ÂêéÂú®.babelrc ‰∏≠Âä†ÂÖ•Ôºö 12345678910&#123; "plugins": [ [ "babel-plugin-root-import", &#123; "rootPathSuffix": "src", "rootPathPrefix": "@" &#125; ] ]&#125; ËøôÊ†∑Â∞±ÂèØ‰ª•‰ΩøÁî® @ Êù•‰ª£ÊõøÁõÆÂΩï src. Ê∂àÈô§ console.logÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá babel Êèí‰ª∂Â∞Ü console ÂéªÈô§„ÄÇ È¶ñÂÖàÂú® devdependency ‰∏≠ÂÆâË£Ö npm Êèí‰ª∂Ôºöbabel-plugin-transform-remove-console ÁÑ∂ÂêéÂú®Êõ¥ÁõÆÂΩï‰∏ãÊñ∞Âª∫‰∏Ä‰∏™Âêç‰∏∫ .babelrc ÁöÑÊñá‰ª∂ÔºåÂú®ÂÖ∂‰∏≠Âä†ÂÖ•Ôºö 1234567&#123; "env": &#123; "production": &#123; "plugins": ["transform-remove-console"] &#125; &#125;&#125; ‰∏∫ FlatList ËÆæÁΩÆ ListEmptyComponentÂ¶ÇÊûúÁõ¥Êé•ËÆæÁΩÆ ListEmptyComponent Âç†‰ΩçÁ¨¶‰Ω†‰ºöÂèëÁé∞ÔºåÂç≥‰ΩøÂ∞Ü ListEmptyComponent ÁöÑ style ËÆæÁΩÆ‰∏∫ {flex:1} ÂÆÉ‰πüÂπ∂‰∏ç‰ºöÂ°´ÂÖÖÊª° flatList„ÄÇËøôÊòØÂõ†‰∏∫ÂåÖË£πÂÆÉÁöÑÂ§ñÂ±Ç View Ê≤°ÊúâËÆæÁΩÆÈ´òÂ∫¶„ÄÇËøôÂ∞±ÈúÄË¶ÅÊàë‰ª¨Ëá™Â∑±Â∞Ü FlatList ÁöÑÈ´òÂ∫¶ËÆæÁΩÆÁªô ListEmptyComponent„ÄÇÂèØ‰ª•‰ΩøÁî® onLayout ÊñπÊ≥ïÔºö 1234567&lt;FlatList onLayout=&#123;e =&gt; &#123; this.setState(&#123; fHeight: e.nativeEvent.layout.height &#125;) &#125;&#125;/&gt; Êàë‰ª¨Âú® FlatList Â∏ÉÂ±ÄÁöÑÊó∂ÂÄôËé∑ÂèñÂà∞ÂÆÉÁöÑÈ´òÂ∫¶ËÆæÁΩÆ‰∏∫ state Âç≥ÂèØ„ÄÇ standard ËøõË°å‰ª£Á†ÅÊ†°È™å‰ΩøÁî® standard ËøõË°å‰ª£Á†ÅËßÑËåÉÊ†°È™åÔºö 1npm install --save-dev standard ÁÑ∂ÂêéÂú® package.json ‰∏≠ÈÖçÁΩÆ: 123456789&#123; "standard": &#123; "parser": "babel-eslint", "globals": [ "fetch" ], "ignore": [] &#125;&#125; ÂèØ‰ª•Âú® globals ‰∏≠ËÆæÁΩÆÈúÄË¶ÅÂøΩÁï•ÁöÑÂÖ®Â±ÄÂØπË±°ÊàñËÄÖÊñπÊ≥ï husky hook git commitÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® husky hook git ÁöÑÊèê‰∫§ÊñπÊ≥ï„ÄÇÂÆâË£ÖÊñπÂºèÂ¶Ç‰∏ãÔºö 1npm install husky --save-dev ÁÑ∂ÂêéÂú® package.json ‰∏≠ÈÖçÁΩÆÔºö 12345678910&#123; "scripts": &#123; "lint": "standard --verbose | snazzy", &#125;, "husky": &#123; "hooks": &#123; "pre-commit": "npm run lint", &#125; &#125;&#125; ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåhusky ÂÆâË£ÖÁöÑÊó∂ÂÄô‰ºöÂú® .git Êñá‰ª∂Â§π‰∏ãÁîüÊàê hook Êñá‰ª∂Â§πÔºåÂ¶ÇÊûúÊòØÊã∑Ë¥ùÁöÑÂà´‰∫∫ÁöÑ node_modulesÔºå‰∏ç‰ºöÁîüÊàê hook Êñá‰ª∂Â§πÔºåÊâÄ‰ª•ÈúÄË¶ÅÂÖà uninstall ÂÜç install ‰∏ÄÈÅç Ê∏ÖÈô§ RN package ÁºìÂ≠ò‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊàë‰ª¨‰∏çÈúÄË¶ÅÊ∏ÖÈô§ package ÁöÑÁºìÂ≠òÔºåÊ∏ÖÈô§ÁºìÂ≠òÂêéÂÜçÊâìÂºÄ‰ºöÈùûÂ∏∏ËÄóÊó∂„ÄÇ‰ΩÜÊòØÊàëÈÅáÂà∞‰∫Ü‰∏ÄÁßçÊÉÖÂÜµÂ∞±ÊòØ‰ΩøÁî® babel-plugin-root-import ‰ΩøÁî® @ Êõø‰ª£ src ÁõÆÂΩïÁöÑÊó∂ÂÄôÔºå@ ÁöÑÊåáÂêëÊÄªÊòØ‰∏çÂØπ„ÄÇÊâÄ‰ª•ÊàëÊÄÄÁñëÂèØËÉΩÊòØÁºìÂ≠òÁöÑÈóÆÈ¢ò„ÄÇ Ê∏ÖÈô§ÁºìÂ≠ò‰ΩøÁî®ÂëΩ‰ª§Ôºö 1npm start -- --reset-cache Ê≥®ÊÑè‰∏≠Èó¥Ë¶ÅÂä†‰∏ä -- Immutable.js ÁöÑ‰ΩøÁî®Âä®Êú∫‰∏ÄËà¨ËØ¥Âà∞ React ÊÄßËÉΩ‰ºòÂåñÂ∞±‰ºöÊèêÂà∞ Immutable Ëøô‰∏™Â∫ì„ÄÇËøôÈáå‰ªãÁªç‰∏Ä‰∏ãÂÆÉÁöÑ‰ΩøÁî®Âú∫ÊôØ„ÄÇ ÂΩì‰∏Ä‰∏™È°µÈù¢ÁöÑÁä∂ÊÄÅÊ†ëÂæàÂ§ßÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Êõ¥Êñ∞Âè∂ËäÇÁÇπÁöÑÊó∂ÂÄôÂè™Â∏åÊúõÊõ¥Êñ∞‰∏é‰πãÁõ∏ÂÖ≥ÁöÑËäÇÁÇπÔºåÊØîÂ¶Ç‰∏ãÂõæÔºö Â¶ÇÊûúÊîπÂèò‰∫ÜÂÖ∂‰ªñËäÇÁÇπÁöÑÂºïÁî®ÔºåÂèØËÉΩ‰ºöÂØºËá¥Áî®Âà∞ÂÖ∂‰ªñËäÇÁÇπÊï∞ÊçÆÁöÑËßÜÂõæÈáçÁªòÔºåÊµ™Ë¥πÊÄßËÉΩ„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÂΩìËäÇÁÇπÂ±ÇÊï∞ËæÉÊµÖÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨‰ºö‰ΩøÁî®Â±ïÂºÄËøêÁÆóÁ¨¶ÔºåÂè™ÊîπÂèòÂìçÂ∫îËäÇÁÇπÁöÑÂÄºÔºåÂÖ∂‰ΩôËäÇÁÇπÈÉΩ‰ΩøÁî®ÂéüÊù•ÁöÑÂºïÁî®„ÄÇ‰ΩÜÊòØËäÇÁÇπÂ±ÇÊï∞Ê∑±ÁöÑÊó∂ÂÄôÔºå‰πü‰ºöÂèòÂæóÂæàÈ∫ªÁÉ¶„ÄÇÊâÄ‰ª•Â∞±ÂèØ‰ª•‰ΩøÁî® Immutable.js Ëøô‰∏™Â∫ì„ÄÇÂΩì‰Ω†ÊîπÂèòÊüê‰∏™Âè∂ËäÇÁÇπÁöÑÂÄºÁöÑÊó∂ÂÄôÔºåÂÆÉ‰ºöËá™Âä®Â∞ÜÂÖ∂Áõ∏ÂÖ≥ÁöÑÊ†πËäÇÁÇπÊõ¥Êñ∞‰∏∫Êñ∞ÁöÑÂºïÁî®ÔºåËÄåÂÖ∂‰ªñÊó†ÂÖ≥ÁöÑËäÇÁÇπËøò‰øùÊåÅÂéüÊúâÂºïÁî®„ÄÇ ÂΩìÁÑ∂ÔºåImmutable Êèê‰æõÁöÑÁ±ªÂûãÊØïÁ´ü‰∏çÊòØÂéüÁîüÁ±ªÂûãÔºå‰ΩøÁî®Ëµ∑Êù•ÈúÄË¶ÅÊ≥®ÊÑè‰∏Ä‰∫õÂú∞ÊñπÔºåÊâÄ‰ª•ÊúÄÂ•ΩËøòÊòØÊääÁä∂ÊÄÅÊ†ëËÆæËÆ°ÁöÑÊâÅÂπ≥‰∏Ä‰∫õ„ÄÇ react-native linkreact-native link ÊñπÊ≥ïÂèØ‰ª•Êää node_module ‰∏≠ÁöÑ RN Â∫ìÈìæÊé•Âà∞ iOS ‰ª•Âèä Android Â∑•Á®ã‰∏≠„ÄÇ‰ΩÜÊòØÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™ÂùëÁÇπÔºåÂ∞±ÊòØÂú® iOS Á´ØÔºåreact-native link Âè™‰ºöÂ∞Ü RN Â∫ìÈìæÊé•Âà∞ default target ‰∏≠ÔºåËÄåËá™Â∑±Âè¶Â§ñÊñ∞Âª∫ÁöÑ target ÈúÄË¶ÅËá™Â∑±Âä®ÊâãÈìæÊé•Âà∞ Link Binary with Libraries ‰∏≠ ÈªÑËâ≤Ë≠¶ÂëäÈªÑËâ≤Ë≠¶Âëä‰ª•ÂèäÁ∫¢Â±èÊä•ÈîôÂèØ‰ª•ÊâãÂä®Ëß¶ÂèëÔºö 12console.error('Á∫¢Â±èÈîôËØØ')console.warn('ÈªÑÂ±èË≠¶Âëä') Êàë‰ª¨ÂºÄÂèëÁöÑÊó∂ÂÄôÔºåÂ∫îËØ•Â∞ΩÂèØËÉΩÈÅøÂÖçÈªÑËâ≤Ë≠¶Âëä„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúËøô‰∏™Ë≠¶ÂëäÊòØÁ¨¨‰∏âÊñπÂºïÂÖ•ÁöÑÂë¢ÔºüÊàë‰ª¨ÂèØ‰ª•ÈöêËóèÁâπÂà´Á±ªÂûãÁöÑË≠¶ÂëäÔºåÊØîÂ¶Ç ant-design ÂºïÂÖ•ÁöÑÂ¶Ç‰∏ãË≠¶ÂëäÔºö Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÈöêËóèÔºö 1234567import &#123;YellowBox&#125; from 'react-native'const ignoreCase = [ // ant design ÂºïÂÖ•ÁöÑ 'Warning: NativeButton: prop type `background` is invalid;']YellowBox.ignoreWarnings(ignoreCase) ‰ΩïÊó∂ÈáçÁªòËß¶ÂèëÈáçÁªòÊúâ‰∏§ÁßçÊñπÂºèÔºö setState Ë∞ÉÁî®ÁöÑÊó∂ÂÄô„ÄÇ props ÂèòÂåñÁöÑÊó∂ÂÄô Áé∞ÊúâÁöÑ‰æãÂ≠êÂºÄÁúãÔºå setState Âè™ÊòØÁî®Êù•Ê†áËÆ∞ÈáçÁªòÁöÑÔºåÊ†áËÆ∞‰∫ÜÈáçÁªòÂêé„ÄÇReact ÁöÑ render ÊñπÊ≥ïÁîüÊàêÁöÑÊñ∞ÁöÑ JSX ÂØπË±°ÂíåËÄÅÁöÑ JSX ÂØπË±°ÊØîËæÉÔºåÁúãÁúã‰∏§‰∏™ JSX ÂØπË±°ÁöÑÂêÑ‰∏™ÈÉ®ÂàÜÊúâÂì™‰∫õÂú∞Êñπ‰∏çÂêå„ÄÇÁÑ∂ÂêéÊ∏≤Êüì‰∏çÂêåÁöÑÈÉ®ÂàÜ Áî±‰∫é componentWillReceiveProps ÂêéÈù¢Êé•ÁùÄÁöÑÂ∞±ÊòØ render ÊñπÊ≥ïÔºåÊâÄ‰ª• componentWillReceiveProps ‰∏≠‰∏çÈúÄË¶Å‰ΩøÁî® this.setState „ÄÇÁõ¥Êé•‰øÆÊîπ this ‰∏äÁöÑÂ±ûÊÄß‰πüÊòØÂèØ‰ª•ÁöÑÊØîÂ¶ÇÔºö 12345678910componentWillReceiveProps (nextProps) &#123; this.count = nextProps.count&#125;render () &#123; return ( &lt;View&gt; &lt;Text&gt;&#123;this.count&#125;&lt;/Text&gt; &lt;/View&gt; )&#125; ËøôÊ†∑‰πüÊòØÂèØ‰ª•Ê≠£Á°ÆÊ∏≤ÊüìÂá∫ this.count ÁöÑ„ÄÇ ÊÄßËÉΩ‰ºòÂåñÂà©Áî® shouldComponentUpdateÈíàÂØπÊúâÂ≠êÁªÑ‰ª∂ÁöÑËßÜÂõæÔºåÊØèÊ¨°Áà∂ÁªÑ‰ª∂ render ÁöÑÊó∂ÂÄôÔºåÈÉΩ‰ºöËß¶ÂèëÂ≠êÁªÑ‰ª∂ÁöÑ componentWillReceiveProps Âíå render ÊñπÊ≥ï„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂàõÂª∫Â≠êÁªÑ‰ª∂ÁöÑÊó∂ÂÄôÔºåÊúÄÂ•ΩÈáçÂÜô shouldComponentUpdate ÊñπÊ≥ïÔºåÂéªÂà§Êñ≠ props ‰∏≠ÁöÑÂêÑ‰∏™Â±ûÊÄßÊòØÂê¶ÂèòÂåñ„ÄÇ‰∏ÄËà¨Âá∫‰∫éÊÄßËÉΩÂéüÂõ†ÔºåshouldComponentUpdate ÊñπÊ≥ïÈÉΩÊòØËøõË°åÊµÖÂ±ÇÂà§Á≠âÔºåÂç≥Âà§Êñ≠‰πãÂâçÁöÑÂ±ûÊÄßÂíåÁé∞Âú®ÁöÑÂ±ûÊÄßÊòØÂê¶ÊòØÂêå‰∏Ä‰∏™ÂØπË±°: 123shouldComponentUpdate(nextProps, nextState) &#123; return (nextProps.completed !== this.props.completed) || (nextProps.text !== this.props.text)&#125; style ‰∏çË¶ÅÂÜôÂú® JSX ‰∏≠ËøôÈáåÊúâ‰∏Ä‰∏™Ê≥®ÊÑèÁÇπÔºåÂ¶Ç‰∏ã‰ª£Á†ÅÂç≥‰ΩøÈáçÂÜô‰∫Ü shouldComponentUpadate ÊñπÊ≥ï‰πüÊòØ‰∏ÄÁõ¥‰ºöÈáçÁªòÁöÑÔºö 1&lt;Foo style=&#123;&#123;color: 'red'&#125;&#125; /&gt; ËøôÊòØÂõ†‰∏∫Ôºå{color: &#39;red&#39;} Áõ∏ÂΩì‰∫éÊØèÊ¨°ÈÉΩ‰º†ÂÖ•‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÂØπË±°„ÄÇÊâÄ‰ª•‰º† styleÁöÑÊó∂ÂÄôÔºå‰∏çË¶ÅÁõ¥Êé•ÂÜôÂú® JSX ‰∏≠ ÂÖ∂ÂÆû‰ªª‰ΩïÂ±ûÊÄßÔºåÂåÖÊã¨‰º†‰∏Ä‰∏™ÊñπÊ≥ïÈÉΩ‰∏çÂ∫îËØ•Áõ¥Êé•ÂÜôÂú® jsx ‰∏≠ÔºåÂ¶ÇÊûúÈÉΩ‰∏çÂÜôÂú® jsx ‰∏≠ÔºåÂ∞±‰ºö‰∫ßÁîüÂæàÂ§öÂÜó‰Ωô‰ª£Á†Å„ÄÇÊâÄ‰ª•Ê≥®ÊÑè style ÂÜôÂú® styleSheet ‰∏≠ËøôÁÇπÂç≥ÂèØ„ÄÇ render Êó∂‰∏çË¶Å‰ΩøÁî®ÁÆ≠Â§¥ÂáΩÊï∞Êàë‰ª¨Âú® render ‰∏Ä‰∏™ button ÁöÑÊó∂ÂÄôÁªèÂ∏∏Ëøô‰πàÂÜôÔºö 12&lt;Button onClick=&#123;()=&gt; this.doClick()&#125;&gt;&lt;/Button&gt; ËøôÊ†∑‰ºöÂØºËá¥ÁªÑ‰ª∂ÁöÑÈáçÁªò„ÄÇÂõ†‰∏∫ÊØèÊ¨°Ê∏≤ÊüìÁöÑÊó∂ÂÄô‰ºöÈáçÊñ∞ÂàõÂª∫Ëøô‰∏™ÁÆ≠Â§¥ÂáΩÊï∞ÔºåÂØºËá¥‰º†ÂÖ•‰∫ÜÊñ∞ÁöÑ props„ÄÇÊ≠£Á°ÆÁöÑÂÅöÊ≥ïÂ∫îËØ•ÊòØÊääËøô‰∏ÄËøáÁ®ãÊèêÂâçÔºö 12doClick = () =&gt; &#123;&#125; 12&lt;Button onClick=&#123;this.doClick()&#125;&gt;&lt;/Button&gt; ËøôÊ†∑ doClick ÊñπÊ≥ï‰º†ÈÄíÁöÑÂ∞±ÊòØ‰∏Ä‰∏™ÂºïÁî®‰∫Ü„ÄÇÔºàÂ¶ÇÊûúÊúâ‰∫õÊñπÊ≥ïÈúÄË¶ÅÂèÇÊï∞ÔºåÈÇ£‰πàÊääÂèÇÊï∞‰Ωú‰∏∫ props ‰º†ÂÖ•Ôºâ Âπ∂‰∏çÊòØËØ¥‰ΩøÁî®ÁÆ≠Â§¥ÂáΩÊï∞‰∏ÄÂÆö‰ºö‰∫ßÁîüÈáçÁªòÔºåÊúâ‰∫õÁªÑ‰ª∂ÂÜÖÈÉ®‰ºöÈáçÂÜô shouldComponentUpdate ÊñπÊ≥ïÔºå‰ºöÊó†ËßÜËøôÁßç onClick ‰∫ã‰ª∂„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÁªÑ‰ª∂ÂÜÖÈÉ®Ê≤°ÊúâËøô‰πàÂÅö„ÄÇÂ∞±ÈúÄË¶ÅËá™Â∑±Ê≥®ÊÑèÁÆ≠Â§¥ÂáΩÊï∞ÂºïËµ∑ÁöÑÈáçÁªò‰∫Ü„ÄÇ ‰ΩøÁî® react-redux ÁöÑ connect ÊñπÊ≥ïÊàë‰ª¨ÂÜôÁªÑ‰ª∂ÁöÑÊó∂ÂÄôÂÜô shouldComponentUpdate Âà§Êñ≠‰∏Ä‰∏™‰∏™ props ÊòØÂê¶ÂèòÂåñÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™ËõÆÁÉ¶ÁöÑ‰∫ã„ÄÇreact-redux ÂÖ∂ÂÆûÂ∏ÆÊàë‰ª¨ÂÅö‰∫ÜËøô‰ª∂‰∫ã„ÄÇ‰ΩøÁî®ÂÆÉÊèê‰æõÁöÑ connect ÊñπÊ≥ïÔºå‰∏çÈúÄË¶ÅÂÅö‰ªª‰ΩïÂÖ∂‰ªñÁöÑ‰∫ãÊÉÖÔºåÂè™Ë¶ÅÂú® export ÁªÑ‰ª∂ÁöÑÊó∂ÂÄôÂÅö‰∏Ä‰∫õÊîπÂèòÂç≥ÂèØÔºö 123export default TodoItem=&gt; Êîπ‰∏∫export default connect()(TodoItem) connect() ÂèÇÊï∞‰∏∫Á©∫ÔºåË°®Á§∫‰∏ç‰ªé store ‰∏≠Ëé∑Âèñ‰ªª‰ΩïÁä∂ÊÄÅ‰∏éÊñπÊ≥ï keykey ÊòØ‰∏Ä‰∏™ËÄÅÁîüÂ∏∏Ë∞àÁöÑ‰∏úË•ø„ÄÇÂØπ‰∫é‰∏Ä‰∏™ÂàóË°®ÁöÑÊØè‰∏ÄÈ°πÔºåÈúÄË¶ÅÂîØ‰∏ÄÁöÑ key ÂÄº„ÄÇÊñ∞ËÄÅÂàóË°®Ôºåkey ÂÄº‰∏çÂêåÁöÑÈ°πÔºåËßÜÂõæÂ∞Ü‰ºöË¢´ Unmount ‰ª•Âèä mountÔºåÂØπ‰∫é key ÂÄºÁõ∏ÂêåÁöÑÈ°πÔºåËßÜÂõæÂè™‰ºöË¢´Êõ¥Êñ∞„ÄÇ ÂØπ‰∫é‰∏Ä‰∏™ÂàóË°®ÔºåÂ¶ÇÊûúÊàë‰ª¨‰∏çËÆæÁΩÆ key ÂÄºÔºåÈªòËÆ§ÊòØ‰ΩøÁî®ÂàóË°®Êï∞ÁªÑÁöÑÁ¥¢Âºï index ‰Ωú‰∏∫ key„ÄÇ‰ΩÜÊòØËøôÊ†∑‰ºö‰∫ßÁîüÊÄßËÉΩÈóÆÈ¢ò„ÄÇÊØîÂ¶ÇÂà†Èô§‰∫ÜÂàóË°®ÁöÑÁ¨¨‰∏ÄÈ°πÔºåÊï¥‰∏™ÂàóË°®ÁöÑÊØè‰∏ÄÈ°πÈÉΩ‰ºöÊõ¥Êñ∞ ÈÇ£Â¶ÇÊûúÊàë‰ª¨Âú®ÂàóË°®‰∏≠Ê∑ªÂä†‰∏ÄÈ°πÁöÑÊó∂ÂÄôÔºå‰ªÄ‰πàÂÄºËÉΩ‰Ωú‰∏∫Ëøô‰∏™ÂîØ‰∏ÄÁöÑ key Âë¢ÔºüÂèØ‰ª•‰æùÈù†Êó∂Èó¥ÔºöData.now()„ÄÇ ÊØîÊñπËØ¥Âú® add ÁöÑÊó∂ÂÄôÔºå‰∏∫Ê∑ªÂä†ÁöÑÈ°πÂàõÂª∫‰∏Ä‰∏™ key Â≠óÊÆµÔºö 1234567891011121314addItem: function(e) &#123; var itemArray = this.state.items; itemArray.push( &#123; text: this._inputElement.value, key: Date.now() &#125; ); this.setState(&#123; items: itemArray &#125;);&#125; ËøôÊ†∑ÊØèÊ¨°Ê∑ªÂä†ÁöÑÊó∂ÂÄôÔºåkey Â∞±Ëé∑Âæó‰∫ÜÂîØ‰∏ÄÂÄº„ÄÇ Reselect‰ΩøÁî® react-redux ÁöÑÊó∂ÂÄôÔºåËøòÁªèÂ∏∏Êê≠ÈÖçÂè¶‰∏Ä‰∏™Â∏∏Áî®ÁöÑÂ∫ì Reselect„ÄÇÊàë‰ª¨Â≠òÂú® redux ‰∏≠ÁöÑ state ÂèØËÉΩÈúÄË¶ÅÁªèËøá‰∏Ä‰∫õÂ§ÑÁêÜ„ÄÇ ÊØîÂ¶Ç state.a Âíå state.b ÂèØËÉΩÈÄöËøá g(a,b) Ë°çÁîüÂá∫ c„ÄÇËøô‰∏™ c Â¶ÇÊûúÊîæÂú® redux ‰∏≠ÔºåÈÇ£‰πàÊØè‰∏™ state.a Âíå state.b ÂèòÂåñÁöÑÂú∞ÊñπÈÉΩË¶ÅËÆ°ÁÆó g(a,b)ÔºåÂæàÂÆπÊòìÈÅóÊºèÂá∫Èîô„ÄÇÂ¶ÇÊûúÊää c ÊîæÂú® render ÊñπÊ≥ï‰∏≠ÔºåÂç≥ÊØèÊ¨° render ÁöÑÊó∂ÂÄôËÆ°ÁÆó g(a,b)ÔºåÂèà‰ºöÈÄ†ÊàêÈáçÂ§çËÆ°ÁÆó„ÄÇ Âõ†Ê≠§ÔºåÊØîËæÉÂ•ΩÁöÑÂÅöÊ≥ïÂ∞±ÊòØÂú® state.a state.b ÂèòÂåñÁöÑÊó∂ÂÄôËÆ°ÁÆó g(a,b)ÔºåÂπ∂‰∏îÂç≥‰∏çÊääg(a,b) ÊîæÂú® redux ‰∏≠Ôºå‰πü‰∏çÊîæÂú® render ‰∏≠„ÄÇÊâÄ‰ª•ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá redux ÊääÊï∞ÊçÆ‰º†ÁªôÁªÑ‰ª∂ÁöÑÊó∂ÂÄôÊ∑ªÂä†ËÆ°ÁÆóÂ±ûÊÄßÁöÑÊñπÂºèÊù•ËææÂà∞ÁõÆÁöÑÔºåÂç≥ÈÄöËøá mapStateToProps ÊñπÊ≥ï„ÄÇ ÊòØ‰∏çÊòØÂæàÂÉè vuex ‰∏≠ÁöÑ getter„ÄÇVue ÁúüÊòØÂ§™‰∫∫ÊÄßÂåñ‰∫Ü 12345678910111213141516171819202122232425262728293031323334353637import &#123; createSelector &#125; from 'reselect'fSelector = createSelector( [state =&gt; state.a, state =&gt; state.b], (a, b) =&gt; f(a, b))hSelector = createSelector( [state =&gt; state.b, state =&gt; state.c], (b, c) =&gt; h(b, c))gSelector = createSelector( [state =&gt; state.a, state =&gt; state.c], (a, c) =&gt; g(a, c))uSelector = createSelector( [state =&gt; state.a, state =&gt; state.b, state =&gt; state.c], (a, b, c) =&gt; u(a, b, c))...function mapStateToProps(state) &#123; const &#123; a, b, c &#125; = state return &#123; a, b, c, fab: fSelector(state), hbc: hSelector(state), gac: gSelector(state), uabc: uSelector(state) &#125;&#125; ÊØîÂ¶Ç‰∏äÈù¢ÁöÑ‰æãÂ≠êÔºåfab ÊòØÈÄöËøá ab ËÆ°ÁÆóÂæóÂà∞ÔºåÈÄöËøá createSelectorÊñπÊ≥ïÔºåÊ≥®ÂÜå‰∫Ü abÔºå‰ª•ÂèäËÆ°ÁÆóÊñπÊ≥ï f(a,b)„ÄÇÈÇ£‰πàÂè™ÊúâÂú® a || b ÂèòÂåñÁöÑÊó∂ÂÄôÔºåÊâç‰ºöÈáçÊñ∞ËÆ°ÁÆó fab setTimeoutÊØîËæÉÁÆÄÂçïÁöÑ‰∏Ä‰∏™ js ÁöÑÊñπÊ≥ïÔºå‰ΩÜÊòØË¶ÅËÆ∞‰ΩèÔºåÂú®Êüê‰∏™ÁªÑ‰ª∂Ë¢´Âç∏ËΩΩÔºàunmountÔºâ‰πãÂêéÔºåËÆ°Êó∂Âô®Âç¥‰ªçÁÑ∂Âú®ËøêË°åÔºåË¶ÅËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåÂè™ÈúÄÈì≠ËÆ∞Âú®unmountÁªÑ‰ª∂Êó∂Ê∏ÖÈô§ÔºàclearTimeout/clearIntervalÔºâÊâÄÊúâÁî®Âà∞ÁöÑÂÆöÊó∂Âô®Ôºö 12345678910111213141516171819import React,&#123; Component&#125; from 'react';export default class Hello extends Component &#123; componentDidMount() &#123; this.timer = setTimeout( () =&gt; &#123; console.log('Êää‰∏Ä‰∏™ÂÆöÊó∂Âô®ÁöÑÂºïÁî®ÊåÇÂú®this‰∏ä'); &#125;, 500 ); &#125; componentWillUnmount() &#123; // ËØ∑Ê≥®ÊÑèUn"m"ountÁöÑmÊòØÂ∞èÂÜô // Â¶ÇÊûúÂ≠òÂú®this.timerÔºåÂàô‰ΩøÁî®clearTimeoutÊ∏ÖÁ©∫„ÄÇ // Â¶ÇÊûú‰Ω†‰ΩøÁî®Â§ö‰∏™timerÔºåÈÇ£‰πàÁî®Â§ö‰∏™ÂèòÈáèÔºåÊàñËÄÖÁî®‰∏™Êï∞ÁªÑÊù•‰øùÂ≠òÂºïÁî®ÔºåÁÑ∂ÂêéÈÄê‰∏™clear this.timer &amp;&amp; clearTimeout(this.timer); &#125;&#125;; ‰∏ªÁ∫øÁ®ãÊ∏≤ÊüìiOS ‰∏≠Ê∏≤ÊüìËßÜÂõæË¶ÅÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÔºåÊâÄ‰ª• RN ‰∏≠Ë¶ÅË∞ÉÁî®ÂéüÁîüÊñπÊ≥ïÔºåÂπ∂‰∏îÊ∏≤ÊüìËßÜÂõæÁöÑÊó∂ÂÄôË¶ÅÈÄöËøá dispatch_async Âà∞‰∏ªÁ∫øÁ®ãËøõË°å„ÄÇ ÊØîÂ¶Ç present ‰∏Ä‰∏™È°µÈù¢ÁöÑÊó∂ÂÄôÂ∞±Ë¶ÅÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÔºåÂê¶Âàô [self.retryBtn setTitle:@&quot;ÈáçËØï&quot; forState:UIControlStateNormal]; ËøôÁßçËÆæÁΩÆÊåâÈíÆ title ÁöÑÊñπÊ≥ïÂú®Èùû‰∏ªÁ∫øÁ®ã‰∏≠ÊâßË°åÂ∞±Êó†Ê≥ïÊ∏≤ÊüìÂá∫ button ÁöÑ title Â¶Ç‰ΩïÂ∞ÜÂõæÁâáÂ≠ó‰ΩìËµÑÊ∫êËá™Âä®Ê∑ªÂä†Âà∞Â∑•Á®ãRN È°πÁõÆ‰∏≠Ôºå‰ºöÁî®Âà∞ÂæàÂ§öÁ¨¨‰∏âÊñπÁöÑÁªÑ‰ª∂„ÄÇËøô‰∫õÁªÑ‰ª∂Âú® react-native link ÁöÑÊó∂ÂÄô‰ºö‰Ωú‰∏∫ library ÈìæÊé•Âà∞‰∏ªÂ∑•Á®ã‰∏ã„ÄÇ‰ΩÜÊòØÂ≠òÂú®‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂ¶ÇÊûúÁªÑ‰ª∂‰∏≠ÂåÖÂê´‰∫Ü‰∏Ä‰∫õÂõæÁâáÊàñËÄÖÂ≠ó‰ΩìËµÑÊ∫êÔºåËøô‰∫õËµÑÊ∫ê‰∏ç‰ºöÂú® link ÁöÑËøáÁ®ã‰∏≠Ë¢´‰∏ªÂä®Ê∑ªÂä†Âà∞Â∑•Á®ã‰∏≠„ÄÇÈÇ£‰πàÊàë‰ª¨ÈúÄË¶ÅÊâãÂä®Ê∑ªÂä†„ÄÇËøôÊòØÈùûÂ∏∏È∫ªÁÉ¶ÁöÑ‰∏Ä‰ª∂‰∫ã„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶Å‰∏Ä‰∏™Ëá™Âä®ÂåñÁöÑÂ∞ÜËµÑÊ∫êÊñá‰ª∂Ê∑ªÂä†Âà∞Â∑•Á®ãÁöÑÊñπÊ≥ïÔºörnpm„ÄÇrnpm ÊòØ‰∏Ä‰∏™ RN ÂåÖÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºåÁé∞Âú®Â∑≤ÁªèË¢´Á∫≥ÂÖ•Âà∞ RN ‰∏≠„ÄÇ Ê∑ªÂä† Â∞ÜË¶ÅÂä†ÂÖ•Âà∞ iOS ‰ª•Âèä Android ÁöÑËµÑÊ∫êÊñá‰ª∂ÁöÑË∑ØÂæÑÁ°ÆËÆ§„ÄÇÊØîÊñπËØ¥Âú® ./assets Êñá‰ª∂Â§π‰∏ã„ÄÇ Âú® package.json ‰∏≠Ê∑ªÂä†ÈÖçÁΩÆÔºö 123"rnpm": &#123; ‚Äúassets‚Äù: ["./assets"]&#125; ËøôÈáåÂ∞±ÊòØËµÑÊ∫êÊñá‰ª∂ÊîæÁΩÆÁöÑË∑ØÂæÑ„ÄÇËøôÈáåÊòØ‰∏Ä‰∏™Ë∑ØÂæÑÁöÑÊï∞ÁªÑÔºåÂèØ‰ª•Êîæ‰ªªÊÑèÂ§ö‰∏™Ë∑ØÂæÑ„ÄÇ ÁªàÁ´Ø‰∏≠ËæìÂÖ• react-native link„ÄÇÈÄöËøá link ÂëΩ‰ª§Â∞±ÊääÁõ∏ÂÖ≥ËµÑÊ∫êÈìæÊé•Âà∞Â∑•Á®ã‰∏≠Âéª‰∫Ü„ÄÇ‰Ω†‰ºöÁúãÂà∞Â¶Ç‰∏ãÊèêÁ§∫‰ø°ÊÅØÔºö Âà†Èô§Ê≤°ÊúâÂëΩ‰ª§ÂèØ‰ª•Áõ¥Êé•Âà†Èô§„ÄÇÈúÄË¶ÅÊâãÂä®ÊâßË°å„ÄÇ AndroidÂÆâÂçìÁõ¥Êé•Â∞ÜËµÑÊ∫êÊñá‰ª∂Âà†Èô§Âç≥ÂèØ„ÄÇÔºàÊàë‰∏çÊòØÂçÅÂàÜÁ°ÆÂÆöÔºâ iOSÂú® Build Phases &gt; Copy Bundle Resources ‰∏≠Âà†Èô§Áõ∏ÂÖ≥Êñá‰ª∂Á¥¢ÂºïÂç≥ÂèØ„ÄÇ setState ÁöÑÂùëÂùë1setState ÂèØ‰ª•Â∞ÜÊéß‰ª∂Âà∑Êñ∞„ÄÇ‰ΩÜÊòØËøô‰∏™Êìç‰Ωú‰∏çÊòØÁ´ãÂàªÊâßË°åÁöÑËÄå‰∏îÂú®Êüê‰∏™Êó∂Èó¥‰∏ÄÂπ∂ÊâßË°åÁöÑ„ÄÇÊâÄ‰ª•ÂΩì‰Ω†Â¶ÇÊûúÊîπÂèò‰∫Ü state Âπ∂‰∏îË¶ÅÁî®Ëøô‰∏™ state ‰Ωú‰∏∫ÂèÇÊï∞ËøõË°åÁΩëÁªúËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºå‰∏çËÉΩÁõ¥Êé•‰ΩøÁî® setState ÁªôÂá∫ÁöÑÂÄºÔºåËÄåË¶ÅÂÖàÂ∞Ü state ÊîπÂèòÔºåÁÑ∂ÂêéÂÜç setState: 1234this.state.a = '1'this.setState(&#123; a: this.state.a&#125;) Âùë2‰∏ÄÂÆö‰∏çËÉΩÂú® setState ÁöÑÊó∂ÂÄôÊîπÂèò state ÁöÑÂéüÊù•ÂÄº„ÄÇÂê¶Âàô state ‰ºöÂèòÊàêÊÑèÊÉ≥‰∏çÂà∞ÁöÑÂÄº„ÄÇÊØîÂ¶Ç‰∏Ä‰∏™Êï∞ÁªÑÔºå‰Ω†‰∏çËÉΩÁõ¥Êé•Âú® setState ÁöÑÊó∂ÂÄôÂæÄÈáå pushÂÄº„ÄÇ‰Ω†ÂèØ‰ª•Â∞ÜÊï∞ÁªÑÂ§çÂà∂ÔºåÁÑ∂Âêépush Â•Ω‰πãÂêéÂÜç setStateÔºåÊàñËÄÖÂÖàËÆæÁΩÆÂ•Ω stateÔºåÁÑ∂ÂêéÂÜç setState„ÄÇ Âùë3Âêå‰∏Ä‰∏™ÂáΩÊï∞‰∏≠ÁöÑÂ§ö‰∏™ setState ‰∏çÊòØÂàÜÂà´Ë∞ÉÁî®ÁöÑÔºåËÄåÊòØÁ≠âÂà∞Êüê‰∏™Êó∂ÂàªÂêàÂπ∂ÊâßË°åÁöÑ„ÄÇÊâÄ‰ª•Â¶ÇÊûú setState Â§öÊ¨°ËÆæÁΩÆ state ‰∏≠ÁöÑÊüê‰∏™ÂÄºÔºåÂâçÈù¢ÁöÑÂÄºÁöÑËÆæÁΩÆ‰ºöË¢´ÂêéÈù¢ÁöÑË¶ÜÁõñÊéâ„ÄÇ ÊØîÂ¶ÇÔºö 123456789101112setState(&#123; obj: &#123; ...this.state.obj key1: value1 &#125;&#125;)setState(&#123; obj: &#123; ...this.state.obj key2: value2 &#125;&#125;) Ê≥®ÊÑèÔºåËøôÈáåËôΩÁÑ∂ËÆæÁΩÆÁöÑÊòØ‰∏çÂêåÁöÑ key1 Âíå key2,Áúã‰ººÊ≤°ÊúâÈóÆÈ¢ò„ÄÇÂÖ∂ÂÆûÊàë‰ª¨ËÆæÁΩÆÁöÑÊòØ obj„ÄÇkey1 Ë¢´Ë¶ÜÁõñÊó†Ê≥ïËÆæÁΩÆÊàêÂäü„ÄÇ ÂèØ‰ª•ÊîπÊàêÂÖàÊîπÂèò stateÔºåÁÑ∂ÂêéÂÜç setState Âà∑Êñ∞ËßÜÂõæÔºö 12345this.state.obj.key1 = value1this.state.obj.key2 = value2setState(&#123; obj&#125;) ÂΩìÁÑ∂ÊúÄÊé®ËçêÁöÑËøòÊòØÂú®ËÆæÁΩÆ state ‰∏≠Âêå‰∏Ä‰∏™ÂÄºÊó∂ÔºåÂú®‰∏ÄËµ∑ËÆæÁΩÆ„ÄÇ setState ÂéüÁêÜÂú®React‰∏≠ÔºåÂ¶ÇÊûúÊòØÁî±ReactÂºïÂèëÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÔºàÊØîÂ¶ÇÈÄöËøáonClickÂºïÂèëÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÔºâÔºåË∞ÉÁî®setState‰∏ç‰ºöÂêåÊ≠•Êõ¥Êñ∞this.stateÔºåÈô§Ê≠§‰πãÂ§ñÁöÑsetStateË∞ÉÁî®‰ºöÂêåÊ≠•ÊâßË°åthis.state„ÄÇÊâÄË∞ì‚ÄúÈô§Ê≠§‰πãÂ§ñ‚ÄùÔºåÊåáÁöÑÊòØÁªïËøáReactÈÄöËøáaddEventListenerÁõ¥Êé•Ê∑ªÂä†ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÂáΩÊï∞ÔºåËøòÊúâÈÄöËøásetTimeout/setInterval‰∫ßÁîüÁöÑÂºÇÊ≠•Ë∞ÉÁî®„ÄÇ ‰∏∫‰ªÄ‰πà‰ºöËøôÊ†∑Ôºü Âú®ReactÁöÑ setState ÂáΩÊï∞ÂÆûÁé∞‰∏≠Ôºå‰ºöÊ†πÊçÆ‰∏Ä‰∏™ÂèòÈáè isBatchingUpdates Âà§Êñ≠ÊòØÁõ¥Êé•Êõ¥Êñ∞this.state ËøòÊòØÊîæÂà∞ÈòüÂàó‰∏≠ÂõûÂ§¥ÂÜçËØ¥ÔºåËÄåisBatchingUpdatesÈªòËÆ§ÊòØ falseÔºå‰πüÂ∞±Ë°®Á§∫ setState ‰ºöÂêåÊ≠•Êõ¥Êñ∞ this.stateÔºå‰ΩÜÊòØÔºåÊúâ‰∏Ä‰∏™ÂáΩÊï∞batchedUpdatesÔºåËøô‰∏™ÂáΩÊï∞‰ºöÊääisBatchingUpdates‰øÆÊîπ‰∏∫ trueÔºåËÄåÂΩìReactÂú®Ë∞ÉÁî®‰∫ã‰ª∂Â§ÑÁêÜÂáΩÊï∞‰πãÂâçÂ∞±‰ºöË∞ÉÁî®Ëøô‰∏™batchedUpdatesÔºåÈÄ†ÊàêÁöÑÂêéÊûúÔºåÂ∞±ÊòØÁî±ReactÊéßÂà∂ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜËøáÁ®ã setState ‰∏ç‰ºöÂêåÊ≠•Êõ¥Êñ∞ this.state„ÄÇ Text Êéß‰ª∂ÂØπÈΩêËÆæÁΩÆ‰∫ÜÂÆΩÈ´òÁöÑ Text Êéß‰ª∂Âè™‰ºöÂú®Â∑¶‰∏äËßíÊòæÁ§∫„ÄÇÂèØ‰ª•‰ΩøÁî® text-align ËÆæÁΩÆÊñáÂ≠óÁöÑ‰ΩçÁΩÆÔºåÊØîÂ¶Ç center„ÄÇ‰ΩÜÊòØÊòæÁ§∫ÁöÑÊó∂ÂÄô‰Ω†‰ºöÂèëÁé∞Âè™ÊòØÊ∞¥Âπ≥Â±Ö‰∏≠„ÄÇ‰Ω†ÂøÖÈ°ªÂÜç‰ΩøÁî® line-height ËÆæÁΩÆÈ´òÂ∫¶‰∏∫Êéß‰ª∂È´òÂ∫¶ÊâçËÉΩÂ§üÁ´ñÁõ¥Â±Ö‰∏≠„ÄÇ ÂØπ‰∫é text Êéß‰ª∂ÔºåËÆæÁΩÆ height ÊòØÊ≤°Áî®ÁöÑÔºåÈªòËÆ§ÊòØ text ÁöÑÈ´òÂ∫¶„ÄÇÂøÖÈ°ªË¶ÅËÆæÁΩÆ line-height ÂÆΩÈ´òText Êéß‰ª∂ÁöÑÈªòËÆ§ÂÆΩÈ´òÊòØÊ≠£Â•ΩÂåÖË£πÊñáÂ≠óÁöÑÔºåÂõ†Ê≠§ÂèØ‰ª•‰∏çËÆæÁΩÆÂÆΩÈ´ò„ÄÇ‰ΩÜÊòØËøôÊ†∑ÁöÑ Text ÊòØ‰∏ç‰ºöÊäòË°åÁöÑÔºåÂ¶ÇÊûúÊÉ≥Ë¶Å Text ÊäòË°åÔºåÂøÖÈ°ªÊ∑ªÂä†ÂÆΩÂ∫¶„ÄÇÊâÄ‰ª•ÂåÖÂê´ Text ÁöÑÊéß‰ª∂ÊúÄÂ•Ω‰∏çË¶ÅËÆæÁΩÆ flex Êù•Ëá™ÈÄÇÂ∫îÔºåËÄåÊòØËÆæÁΩÆÂÖ∑‰ΩìÁöÑÂÆΩÂ∫¶„ÄÇ React/RCTBridgeModule.h file not found Ëß£ÂÜ≥ÊñπÂºèËøô‰∏™ÈóÆÈ¢òÂá∫Áé∞Âú® RN ‰ªé 0.40 ÁâàÊú¨ÂâçÂçáÁ∫ßÂà∞ 0.40 ÁâàÊú¨ÂêéÁöÑÊÉÖÂÜµ‰∏ã„ÄÇ0.40 Ââç react ÁöÑÂ§¥Êñá‰ª∂ÈÉΩÊòØ‰ª• Header Search Paths Âä†ÂÖ•ÁöÑ„ÄÇ‰ΩøÁî® React ÁöÑÁªÑ‰ª∂ÈÉΩÈúÄË¶ÅÊ∑ªÂä†Â§¥Êñá‰ª∂Êü•ÊâæË∑ØÂæÑ„ÄÇÂΩìÁªÑ‰ª∂ÈúÄË¶Å‰ΩøÁî® React ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÂú®ÁªÑ‰ª∂ÊâÄÂú®ÁöÑÁõÆÂΩï‰∏ãÊ≤°ÊúâÊâæÂà∞ÔºåÈÇ£‰πàÂ∞±‰ºöÂà∞ Header Search Paths ÊåáÂÆöÁöÑË∑ØÂæÑ‰∏≠Êü•ÊâæÔºö ËøôÊ†∑Â∏¶Êù•‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂ∞±ÊòØÊØè‰∏Ä‰∏™Á¨¨‰∏âÊñπÁöÑÁªÑ‰ª∂ÈÉΩÈúÄË¶ÅËÆæÁΩÆ‰∏Ä‰∏ã Header Search Paths ÁöÑË∑ØÂæÑ„ÄÇ‰ΩøÁî®ËÄÖ‰ºöÈùûÂ∏∏‰∏çÊñπ‰æø„ÄÇ ÊâÄ‰ª• FB ÊÉ≥Ë¶ÅÊää React Â§¥Êñá‰ª∂ÁöÑÈìæÊé•Áªü‰∏ÄËµ∑Êù•„ÄÇ‰∫éÊòØÂ∞±Êúâ‰∫Ü 0.40 ÁâàÊú¨ÁöÑÂèòÂåñÔºöÈÄöËøá Edit Scheme ÁÑ∂ÂêéÊ∑ªÂä† React Ëøô‰∏™ TargetÔºåÁÑ∂ÂêéÂèñÊ∂à Parallelize Build„ÄÇ ËøôÊ†∑ÔºåÂú®ÁºñËØëÈ°πÁõÆ‰πãÂâçÔºåÂ∞±ÂÖàÊää React ÁºñËØëÂ•Ω‰∫Ü„ÄÇ‰πüÂ∞±‰∏çÂÜçÈúÄË¶ÅÂú® Header Search Paths ‰∏≠ËÆæÁΩÆ‰∫Ü„ÄÇ ËøôÊ†∑Â∏¶Êù•ÁöÑÊîπÂèòÂ∞±ÊòØÂéüÊù•ÂºïÂÖ•Â§¥Êñá‰ª∂ÊòØÁõ∏ÂΩì‰∫éÂ§¥Êñá‰ª∂Âú®È°πÁõÆ‰∏≠‰∫ÜÔºå‰ΩøÁî®Ôºö 1#import &quot;RCTBridgeModule.h&quot; Áé∞Âú®ÂºïÂÖ•Â§¥Êñá‰ª∂ÊòØÂºïÂÖ•ÁöÑÂ§ñÈÉ®ÁöÑÂ§¥Êñá‰ª∂ÔºåÊâÄ‰ª•Ë¶Å‰ΩøÁî®Â∞ñÊã¨Âè∑Ôºö 1#import &lt;React/RCTBridgeModule.h&gt; keyboardShouldPersistTaps ÁöÑ‰ΩøÁî®keyboardShouldPersistTaps ËøôÊòØ scrollview ‰∏≠ÁöÑ‰∏Ä‰∏™Â±ûÊÄß„ÄÇ ÈÇ£‰πàÂú∫ÊôØ‰ºöÁî®Âà∞Ëøô‰∏™Â±ûÊÄßÂë¢ÔºüÂ∞±ÊòØÂú®‰∏Ä‰∏™ scrollview ‰∏≠Êúâ‰∏§‰∏™ textinput a,bÔºåÂΩì a ËæìÂÖ•ÂÆå‰πãÂêéÁÇπÂáª bÔºåËøô‰∏™Êó∂ÂÄôÂ¶ÇÊûú‰Ω†‰∏çËÆæÁΩÆ keyboardShouldPersistTaps Â±ûÊÄßÔºåÈÇ£‰πàÁÇπÂáª b ÂêéÔºåËôöÊãüÈîÆÁõòÊ∂àÂ§±Ôºå‰Ω†ÈúÄË¶ÅÂÜçÁÇπ‰∏ÄÊ¨° b ÊâçËÉΩÂ∞ÜËôöÊãüÈîÆÁõòÂÜçÊâìÂºÄÔºå‰πüÂ∞±ÊòØËØ¥ scrollview Âπ∂Ê≤°ÊúâÁõ∏Â∫î b Êéß‰ª∂ÁöÑÁÇπÂáª‰∫ã‰ª∂„ÄÇÊ≠£Â∏∏ÁöÑÈúÄÊ±ÇÂ∫îËØ•ÊòØÔºåÁÇπÂáª b ÂêéÔºåÈîÆÁõò‰ªçÁÑ∂‰ª£ÂºÄÁä∂ÊÄÅÔºåÂè™‰∏çËøáËæìÂÖ•Ê°ÜÂèò‰∏∫ b„ÄÇÊâÄ‰ª•Ë¶ÅÁî®ËØ•Â±ûÊÄßÊéßÂà∂„ÄÇ ËØ•Â±ûÊÄßÊúâ‰∏â‰∏™Êûö‰∏æÂÄºÔºö never: ÈªòËÆ§ÊÉÖÂÜµÔºåÁÇπÂáª TextInput ‰ª•Â§ñÁöÑÂ≠êÁªÑ‰ª∂‰ºö‰ΩøÂΩìÂâçÁöÑËΩØÈîÆÁõòÊî∂Ëµ∑„ÄÇÊ≠§Êó∂Â≠êÂÖÉÁ¥†‰∏ç‰ºöÊî∂Âà∞ÁÇπÂáª‰∫ã‰ª∂„ÄÇ always: ÈîÆÁõò‰∏ç‰ºöËá™Âä®Êî∂Ëµ∑ÔºåScrollView ‰πü‰∏ç‰ºöÊçïÊçâÁÇπÂáª‰∫ã‰ª∂Ôºå‰ΩÜÂ≠êÁªÑ‰ª∂ÂèØ‰ª•ÊçïËé∑„ÄÇ handled:ÂΩìÁÇπÂáª‰∫ã‰ª∂Ë¢´Â≠êÁªÑ‰ª∂ÊçïËé∑Êó∂ÔºåÈîÆÁõò‰∏ç‰ºöËá™Âä®Êî∂Ëµ∑„ÄÇËøôÊ†∑ÂàáÊç¢ TextInput Êó∂ÈîÆÁõòÂèØ‰ª•‰øùÊåÅÁä∂ÊÄÅ„ÄÇÂ§öÊï∞Â∏¶ÊúâTextInputÁöÑÊÉÖÂÜµ‰∏ã‰Ω†Â∫îËØ•ÈÄâÊã©Ê≠§È°π„ÄÇ ListView ‰ΩøÁî®ÁöÑÈóÆÈ¢òListView ÁöÑÂÆΩÈ´òListView Âú®Áà∂ËßÜÂõæÁöÑ flex ÊñπÂêë‰∏äÈªòËÆ§ÊòØÈì∫Êª°ÁöÑ„ÄÇflex ÊñπÂêë‰∏äËÆæÁΩÆÁöÑÂÆΩÊàñËÄÖÈ´òÊòØÊó†ÊïàÁöÑÔºåÈùû flex ÊñπÂêë‰∏äËÆæÁΩÆÁöÑÂÆΩÊàñËÄÖÈ´òÊòØÊúâÊïàÁöÑ„ÄÇ ÊâÄ‰ª•ÊúÄÂ•ΩÂú® ListView Â§ñÈù¢Â•ó‰∏Ä‰∏™ ViewÔºå‰øùËØÅ ListView Â°´ÂÖÖÊª°Êï¥‰∏™Áà∂ View renderRow ÊñπÊ≥ïÁöÑÂùërenderRow ÊñπÊ≥ïÁöÑÂá†‰∏™ÂèÇÊï∞‰∏∫ÔºårowData, sectionID, rowID ËøôÂá†‰∏™ÂÄº‰∏∫Â≠óÁ¨¶‰∏≤Á±ªÂûã„ÄÇ ÊâÄ‰ª•Ê†πÊçÆ id ÈááÂèñ‰∏çÂêåË°å‰∏∫ÁöÑÊó∂ÂÄôÔºåË¶ÅÊää id ËΩ¨Âåñ‰∏∫ number ÂÜçÊØîËæÉ„ÄÇÊàñËÄÖ‰∏çË¶ÅÁî® === ÔºåÂê¶ÂàôËÇØÂÆöËøîÂõûÁöÑÊòØ false„ÄÇ ÂàùÂßãÊ∏≤ÊüìÊï∞ÈáèListView ‰∏∫‰∫Ü‰øùËØÅÊ∏≤ÊüìÁöÑÊÄßËÉΩÔºåÂú®ÊúÄÂºÄÂßãÁöÑÊó∂ÂÄôÂè™‰ºöÈÉ®ÂàÜÊ∏≤ÊüìÔºåÊâÄ‰ª•ÈúÄË¶ÅËÆæÁΩÆ initialListSize Â±ûÊÄßÔºåËÆæÁΩÆÈ¶ñÂ±èÁöÑÊ∏≤Êüì‰∏™Êï∞„ÄÇÂê¶ÂàôÂæàÂèØËÉΩÈ¶ñÂ±èÈúÄË¶ÅÂä†ËΩΩÁöÑÂÖÉÁ¥†ÂæàÂ§öÔºå‰ΩÜÊòØÂÆûÈôÖÊ∏≤ÊüìÂá∫Êù•ÁöÑÂÖÉÁ¥†ÂæàÂ∞ë„ÄÇ cloneWithRows ‰ΩøÁî®ÁöÑÊ≥®ÊÑè‰∫ãÈ°πÊàë‰ª¨Áü•ÈÅì cloneWithRows ÊòØÂú® listview ‰∏≠‰øùÂ≠òÂàóË°®Êï∞ÁªÑÊó∂‰ΩøÁî®ÁöÑÊñπÊ≥ï„ÄÇ‰ΩøÁî®ÁöÑÊó∂ÂÄôË¶ÅÊ≥®ÊÑè‰∏ÄÁÇπÔºöÊï∞ÁªÑÂú® cloneWithRows ‰πãÂêé‰ºöÂèòÊàê‰∏Ä‰∏™ÁâπÊÆäÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÊï∞ÊçÆÊï∞ÁªÑÂè™ÊòØËøô‰∏™Êï∞ÊçÆÁªìÊûÑ‰∏≠ÁöÑ‰∏Ä‰∏™Â±ûÊÄß„ÄÇ ÈÇ£‰πà‰ªÄ‰πàÊó∂ÂÄôÈúÄË¶ÅÊ≥®ÊÑèÂë¢Ôºü‰∏Ä‰∏™Áà∂Êéß‰ª∂ÂÜÖÁöÑÂ≠êÊéß‰ª∂ÈáåÊúâ‰∏Ä‰∏™ listviewÔºåÈÇ£‰πàË¶Å‰πà‰º†ÂÖ•Êï∞ÊçÆÂú®ÈáåÈù¢ cloneWithRowsÔºåË¶Å‰πàÂú®Â§ñÈù¢ cloneWithRows Â•ΩÂêéÁõ¥Êé•‰º†ÂÖ•Ôºå‰∏çËÉΩÂ§ñÈÉ® cloneWithRows ‰∏ÄÊ¨°ÂêéÂÜçÂú®ÈáåÈù¢ cloneWithRows ‰∏ÄÊ¨°„ÄÇÊé®ËçêÊòØÂú®Â§ñÈù¢ cloneWithRows Â•ΩÂêé‰º†ÂÖ•ÔºåËøôÊ†∑Êõ¥Á¨¶ÂêàÂ∞ÅË£ÖÊÄß„ÄÇ View ËÆæÁΩÆÂÆΩÈ´ò‰∏Ä‰∏™ËßÜÂõæÁöÑÊòæÁ§∫ÂøÖÈ°ªË¶ÅÊúâÂÆΩÈ´ò„ÄÇ‰ª•‰∏ãÊòØÂá†‰∏™Ê≥®ÊÑèÁÇπÔºö Áà∂Êéß‰ª∂ËÆæÁΩÆÁªùÂØπÂÆΩÈ´òÔºåÂ≠êÊéß‰ª∂‰πüËÆæÁΩÆ‰∫ÜÁªùÂØπÂÆΩÈ´ò„ÄÇËøôÁßçÊÉÖÂÜµÊòØÊúÄÁÆÄÂçïÁöÑÊÉÖÂÜµÔºåÊ≥®ÊÑèÂ≠êÊéß‰ª∂ÂèØËÉΩ‰ºöË∂ÖËøáÁà∂Êéß‰ª∂„ÄÇ Áà∂ËßÜÂõæËÆæÁΩÆ‰∫ÜÁªùÂØπÂÆΩÈ´òÔºåÂ≠êÊéß‰ª∂ÊòØ flex Â∏ÉÂ±ÄÔºö flex-direction ÊñπÂêë‰∏äÁöÑÂ≠êËßÜÂõæÂøÖÈ°ªËÆæÁΩÆÊòéÁ°ÆÁöÑÈïøÂ∫¶ÔºåÂç≥‰∏ªËΩ¥ÂøÖÈ°ªÊòéÁ°ÆËÆæÁΩÆÂ§öÈïø„ÄÇÂê¶ÂàôÂ∞±ÈªòËÆ§‰∏∫ 0 Èùû flex-direction ÊñπÂêë‰∏äÁöÑÂ≠êËßÜÂõæÈªòËÆ§‰∏∫Â°´ÂÖÖÊª°Áà∂ËßÜÂõæÔºåÂç≥ align-items ÈªòËÆ§‰∏∫ sketch„ÄÇÊâÄ‰ª•ËøôÈáåÊúâ‰∏Ä‰∏™ÂùëÁÇπÔºåÂ¶ÇÊûú‰Ω†Âú®Áà∂ËßÜÂõæ‰∏≠ËÆæÁΩÆ align-items: center Â±Ö‰∏≠ÂØπÈΩêÔºåÈÇ£‰πàÂ∞±ÂèñÊ∂à‰∫ÜÈªòËÆ§Â°´ÂÖÖÊª°Áà∂ËßÜÂõæÊ¨°ËΩ¥Ëøô‰∏ÄËÆæÂÆöÔºåÂ≠êËßÜÂõæ‰∏ÄÂÆöË¶ÅËÆæÁΩÆÊ¨°ËΩ¥‰∏äÁõ∏Â∫îÁöÑÈïøÂ∫¶ÔºåÂê¶ÂàôÂ∞±ÊòØ 0ÔºåÊòæÁ§∫‰∏çÂá∫‰∫Ü„ÄÇ Â≠êÊéß‰ª∂ËÆæÁΩÆ‰∫ÜÁªùÂØπÂÆΩÈ´òÔºåÁà∂Êéß‰ª∂ÂèØ‰ª•‰∏çËÆæÁΩÆÂÆΩÈ´òÔºåÁà∂Êéß‰ª∂Ê≠£Â•ΩÂåÖË£πÂ≠êÊéß‰ª∂„ÄÇ Áà∂Â≠êÊéß‰ª∂ÈÉΩÊòØ flex Â∏ÉÂ±ÄÔºåÈÉΩÊ≤°ÊúâËÆæÁΩÆÂÆΩÈ´ò„ÄÇÈÇ£‰πàËøôÁßçÊÉÖÂÜµ‰∏ãÂæàÊúâÂèØËÉΩÊòæÁ§∫‰∏çÂá∫„ÄÇÂõ†‰∏∫Áà∂Êéß‰ª∂ÈúÄË¶Å‰∏Ä‰∏™ flex-direction ÊñπÂêë‰∏äÁöÑÈïøÂ∫¶Ôºå‰ΩÜÊòØÂπ∂‰∏çËÉΩÈÄöËøáÂ≠êÊéß‰ª∂Êé®ÊµãÂá∫„ÄÇÈÇ£‰πàÂ∞±‰ºö‰∏çÊòæÁ§∫‰∫Ü„ÄÇ Â∏ÉÂ±ÄÊñπÂºè‰∏ÄËà¨Â∏ÉÂ±ÄÂ¶ÇÊûúÊòØ‰∏Ä‰∏™ÁªôÂÆöÁöÑÂ∏ÉÂ±ÄÔºå‰ΩøÁî® flex Â∏ÉÂ±ÄÈùûÂ∏∏ÁöÑÁõ¥ËßÇ„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÂ∏ÉÂ±Ä‰∏≠ÁöÑÂÖÉÁ¥†‰∏™Êï∞‰ºöÂèòÂåñÁöÑÊó∂ÂÄôÔºåÂ∞±ÈúÄË¶ÅËÄÉËôë‰∏Ä‰∏ã‰∫Ü„ÄÇÊØîÂ¶Ç‰∏ãÈù¢Ëøô‰∏™Âõæ„ÄÇ‰∏≠Èó¥ÁöÑÈÉ®ÂàÜÂèØËÉΩÊåâÊÉÖÂÜµ‰∏çÂêå‰ºöÊúâÂ¢ûÂáèÔºö ‰∏ÄËà¨Êúâ‰∏§ÁßçÊñπÂºèÔºö ËÄÉËôëÁà∂Á∫ß align-items ËÆæÁΩÆ‰∏∫ sketchÔºåÂùó1Ê≠§Êó∂ÂíåÁà∂Á∫ß‰∏ÄÊ†∑È´ò„ÄÇËøô‰∏™ÁÑ∂ÂêéËÆæÁΩÆÂùó1Ôºåflex-direction ‰∏∫ space-between„ÄÇËøôÊ†∑Âùó1ÁöÑÂ≠êÁ∫ßÂ∞±‰ºöÂùáÂåÄÁöÑÂàÜÂ∏ÉÂú®Âùó1ÂÜÖ‰∫ÜÔºå‰∏çËÆ∫ÊúâÂ§öÂ∞ëÂÖÉÁ¥†„ÄÇÊâÄ‰ª•‰Ω†ÈúÄË¶ÅËÆæÁΩÆÁ¨¨‰∏Ä‰∏™Â≠êÂÖÉÁ¥†ÂíåÊúÄÂêé‰∏Ä‰∏™Â≠êÂÖÉÁ¥†Áõ∏ÂØπ‰∫éÂùó1ÁöÑ‰∏äËæπÂíå‰∏ãËæπÁöÑË∑ùÁ¶ª„ÄÇ ËÄÉËôëÁà∂Á∫ß align-items ËÆæÁΩÆ‰∏∫ centerÔºåÂùó1ÁöÑÈ´òÂ∫¶ÂèñÂÜ≥‰∫éÂÜÖÈÉ®ÂÖÉÁ¥†ÁöÑÈ´òÂ∫¶ÔºåÂùó1ÂÜÖÁöÑÂÖÉÁ¥†‰ºöÂ±Ö‰∏≠„ÄÇÊâÄ‰ª•ÈúÄË¶ÅËÆæÁΩÆÂ≠êÂÖÉÁ¥†‰πãÈó¥ÁöÑË∑ùÁ¶ª„ÄÇ ‰∏ÄËà¨Êù•ËØ¥Áî® center ‰ºöÊØîËæÉÂ•Ω‰∏Ä‰∫õ ËÆæÁΩÆ ImageImage ÂõæÁâá‰∏ÄÂÆöË¶ÅËÆæÁΩÆÂÆΩÈ´òÔºåÂõ†‰∏∫Â¶ÇÊûúÂõæÁâáÈªòËÆ§Â§ßÂ∞èÊòØ0ÔºåÂä†ËΩΩÂÆåÂõæÁâáÂêéÔºå‰ºöÊúâ‰∏™Èó™ÁÉÅÔºåÂèØ‰ª•ËÆæÁΩÆ‰∏ªÈ¢òÁöÑÂõæÁâáÊ®°ÂºèÊòØ resizeMode = ‚Äòcontain‚Äô ËøôÊ†∑ÂõæÁâáÂ∞±ËÉΩÂú®ÊåáÂÆöÂ§ßÂ∞èÂÜÖÈÄÇÂ∫îÁº©Êîæ„ÄÇ Âè¶Â§ñÔºåÂ¶ÇÊûúÊãø‰∏Ä‰∏™Á™ÅÁ†¥‰Ωú‰∏∫ËÉåÊôØÁöÑÊó∂ÂÄôÔºå‰∏ÄÂÆöË¶ÅÂêåÊó∂ËÆæÁΩÆ Image ÁöÑÂÆΩÈ´òÔºå‰ª•Âèä Image ÂåÖÂê´ÁöÑ View ÁöÑÂÆΩÈ´ò„ÄÇÊ≥®ÊÑèÔºåÂåÖÂê´ÁöÑ View ‰∏ç‰ºöËá™Âä®Â°´ÂÖÖÊª° Image„ÄÇ ‰ΩøÁî® JSXJSX ‰∏≠ÁöÑ thisÂú® JSX ‰∏≠Ë∞ÉÁî®Â§ñÈÉ®ÁöÑ jsÊñπÊ≥ïÔºåÂ¶ÇÊûúË¶ÅÁî®Âà∞ thisÔºå ÂàôÂøÖÈ°ª bind(this) ÊàñËÄÖ‰ΩøÁî®ÁÆ≠Â§¥ÂáΩÊï∞ÔºåÂê¶ÂàôÊó†Ê≥ïËØÜÂà´„ÄÇ JSX Ê†áÁ≠æÈáå‰∏ÄÂÆö‰∏çËÉΩÊúâ {}ÔºåÂ∞±ÊØîÂ¶Ç‰Ω†Ë¶ÅÊää View ÈáåÁöÑ style Ê≥®ÈáäÊéâÔºå ‰∏ÄÂÆö‰∏çËÉΩÁõ¥Êé•Áî® cmd+/ ËøôÊ†∑‰ºöÂú® &lt;&gt;ÈáåÂä†ÂÖ• {}Ôºå‰∫ßÁîü SyntaxError xxx.js Unexpected token,expected ...ÁöÑÈîôËØØ &lt;View &gt; Ê†áÁ≠æÈáåÁöÑÂ±ûÊÄßÂøÖÈ°ªË¶ÅË¶ÅÈÅµÂÆàÂ¶Ç‰∏ãÁöÑÂΩ¢ÂºèÔºåÂç≥ÂøÖÈ°ªË¶ÅÁî®Á≠âÂè∑ÔºåÂπ∂‰∏îË¶ÅÁî® {} ÊääÂØπË±°ÊàñËÄÖËøîÂõûÂØπË±°ÁöÑÊñπÊ≥ïÂåÖË£πËµ∑Êù•: 123&lt;View style = &#123;&#123;margin&#125;&#125;&gt;&lt;/View&gt; JSX ‰∏≠ÁöÑ‰ª£Á†ÅJSX ‰∏≠ÂèØ‰ª•ÈÄöËøá {} ÊèíÂÖ•‰ª£Á†Å„ÄÇ‰ΩÜÊòØ‰Ω†‰∏çËÉΩÁõ¥Êé•Êää‰ª£Á†ÅÂÜôÂú®ÈáåÈù¢„ÄÇ{} ÂÜÖÂÖÅËÆ∏‰Ω†Ë∞ÉÁî®‰∏Ä‰∏™ËøîÂõû JSX ËäÇÁÇπÊàñËÄÖ‰ª• JSX ËäÇÁÇπ‰∏∫ÂÖÉÁ¥†ÁöÑÊï∞ÁªÑÁöÑÊñπÊ≥ï„ÄÇ ËøôÈáåÊâÄËØ¥ÁöÑÊñπÊ≥ïÂèØ‰ª•ÊòØ‰∏Ä‰∏™Â§ñÈÉ®ÁöÑÊñπÊ≥ïÔºåÊàñËÄÖÊòØ‰∏Ä‰∏™‰∏âÂÖÉËøêÁÆóÁ¨¶ÔºåÊàñËÄÖÊòØ‰∏Ä‰∏™ÁîüÊàêÊï∞ÁªÑÁöÑÊñπÊ≥ïÔºåÂ¶Ç map Á≠â„ÄÇ Â¶Ç‰ΩïÈöêËóè‰∏Ä‰∏™ÁªÑ‰ª∂Â¶ÇÊûúËÆ©‰∏Ä‰∏™ÁªÑ‰ª∂ÈöêËóèÔºåÊàñËÄÖÊ†πÊçÆ‰∏çÂêåÊÉÖÂÜµÊîπÂèòÁªÑ‰ª∂Â±ïÁ§∫„ÄÇÂè™ÈúÄË¶ÅÂú®ÂøÖË¶ÅÁöÑÊó∂ÂÄôÈÄöËøá state ÁöÑÂèòÂåñÔºåÂ∞ÜÂéüÊù• return ÁöÑ view ÂèòÊàê return null Â∞±ÂèØ‰ª•‰∫Ü 12345678910_render() &#123; return( ... &#123; this.state.drawerOpen ? &lt;TouchableOpacity style=&#123;styles.modalContainer&#125; /&gt; : null &#125; ... )&#125; Ê≥®ÊÑèÁî® {} ÂåÖË£πÁöÑÈÉ®ÂàÜÔºåË¶Å‰πàÂ∞±ÂÉè‰∏äÈù¢ÈÇ£Ê†∑ÁöÑ‰∏Ä‰∏™‰∫åÂÖÉÈÄâÊã©ÊàñËÄÖÊòØÁõ¥Êé•ÁöÑ‰∏Ä‰∏™ JSX ÂØπË±°ÔºåË¶Å‰πàÂ∞±ÊòØ‰∏ãÈù¢ËøôÊ†∑ÁöÑË∞ÉÁî®‰∏Ä‰∏™ËøîÂõû JSX ÁöÑÊñπÊ≥ïÔºö 123456789101112131415161718192021_render() &#123; return( ... &#123; this._renderContent(name, type) &#125; ... )&#125;_renderContent(name, type) &#123; if (type === 1) &#123; return( &lt;View/&gt; ) &#125; else &#123; return( &lt;Image/&gt; ) &#125;&#125; ‰∏çËÉΩÁõ¥Êé•ÂÜô js ÁöÑÈÄªËæëËØ≠Âè•Ôºå‰∏ÄÂÆö‰ºöÊä•Èîô padding Âíå margin ‰ΩøÁî®Âå∫Âà´Ëøô‰∏§ËÄÖ android Á®ãÂ∫èÂëò‰ΩøÁî®Ëµ∑Êù•ÊÅêÊÄïÊ≤°Êúâ‰ªª‰ΩïÈóÆÈ¢ò„ÄÇiOS Á®ãÂ∫èÂëòÂ¶ÇÊûú‰ΩøÁî®ÊÉØ‰∫Ü autoLayout ÂèØËÉΩ‰∏ÄÊó∂ÂèçÂ∫î‰∏çËøáÊù•„ÄÇ style Á©∂Á´üÊòØÂú®Áà∂Êéß‰ª∂ÈáåÁî® padding ËøòÊòØÂú®Â≠êÊéß‰ª∂ÈáåÁî® margin„ÄÇÂÖ∂ÂÆûÂü∫Êú¨Ê≤°ÊúâÂ§™Â§ßÂ∑ÆÂà´Ôºå‰∏ÄËà¨Áî® marginÔºåËÉΩËÆ©Â≠êÊéß‰ª∂ÁöÑÂ∏ÉÂ±ÄÊõ¥ÁÅµÊ¥ª‰∏Ä‰∫õ„ÄÇÂΩìÁÑ∂ÔºåÂ¶ÇÊûúÁà∂Êéß‰ª∂ÁöÑÊ†∑ÂºèÈúÄË¶ÅÂ§çÁî®Â§öÊ¨°ÔºåËÄåÂ≠êÊéß‰ª∂ÂêÑ‰∏çÁõ∏ÂêåÊó∂ÔºåÁõ¥Êé•Âú®Áà∂Êéß‰ª∂ËÆæÁΩÆ paddingÔºåÂèØ‰ª•ÂáèÂ∞ëÊØèÊ¨°ËÆæÁΩÆÂ≠êÊéß‰ª∂ margin ÁöÑÊ¨°Êï∞„ÄÇ ÁªÑ‰ª∂‰πãÈó¥ÁöÑÈÄö‰ø°Â≠êÁªÑ‰ª∂Ë∞ÉÁî®Áà∂ÁªÑ‰ª∂ÊñπÊ≥ïÁà∂ÁªÑ‰ª∂Â∞ÜÊñπÊ≥ï‰ª•Â±ûÊÄßÁöÑÊñπÂºè‰º†ÂÖ•Â≠êÁªÑ‰ª∂ÔºåÂ≠êÁªÑ‰ª∂ÈÄöËøá this.props.ÊñπÊ≥ïÂêç ÊãøÂà∞Ëøô‰∏™ÊñπÊ≥ï„ÄÇ Áà∂ÁªÑ‰ª∂Ë∞ÉÁî®Â≠êÁªÑ‰ª∂ÊñπÊ≥ïÁà∂ÁªÑ‰ª∂Ë∞ÉÁî®Â≠êÁªÑ‰ª∂ÁöÑÊù°‰ª∂ÊòØÊãøÂà∞Â≠êÁªÑ‰ª∂ÁöÑÂÆû‰æã„ÄÇÂõ†Ê≠§ÂèØ‰ª•‰∏∫Â≠êÁªÑ‰ª∂Âä†‰∏ä ref Â±ûÊÄß„ÄÇÊØîÂ¶ÇÔºö 1&lt;Child ref='child'&gt;haha&lt;/Child&gt; ËøôÊ†∑Áà∂ÁªÑ‰ª∂Â∞±ÂèØ‰ª•ÈÄöËøá this.refs.child Êù•Ëé∑Âèñ Child ÁªÑ‰ª∂ÁöÑÂÆû‰æãÔºåÂπ∂Ë∞ÉÁî®ÂÖ∂ÂÜÖÈÉ®ÊñπÊ≥ï‰∫Ü„ÄÇ ÊØîËæÉÂÖ∏ÂûãÁöÑÁî®Ê≥ïÂú®‰∫é‰∏Ä‰∏™ View ÈáåÂµå‰∫Ü‰∏Ä‰∏™ ListViewÔºåÁé∞Âú®Ë¶ÅË∞ÉÁî® ListView ÁöÑÂà∑Êñ∞ÊñπÊ≥ï„ÄÇÂ∞±ÂèØ‰ª•ÈÄöËøá ref ÁöÑÊñπÂºè‰ªéÂ§ñÈÉ®ÊãøÂà∞„ÄÇ ref Â±ûÊÄß‰∏äÈù¢ÊºîÁ§∫ÁöÑÊòØ ref Êé•Âèó‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÁöÑ‰ΩøÁî®ÊñπÂºèÔºåref Â±ûÊÄßËøòÂèØ‰ª•ÊòØ‰∏Ä‰∏™ÂõûË∞ÉÂáΩÊï∞ÔºåËøô‰∏™ÂõûË∞ÉÂáΩÊï∞‰ºöÂú®ÁªÑ‰ª∂Ë¢´ÊåÇËΩΩÂêéÁ´ãÂç≥ÊâßË°å„ÄÇË¢´ÂºïÁî®ÁöÑÁªÑ‰ª∂‰ºöË¢´‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄíÔºåÂõûË∞ÉÂáΩÊï∞ÂèØ‰ª•Áî®Á´ãÂç≥‰ΩøÁî®Ëøô‰∏™ÁªÑ‰ª∂ÔºåÊàñËÄÖ‰øùÂ≠òÂºïÁî®‰ª•Âêé‰ΩøÁî®Ôºö 123456render () &#123; return &lt;TextInput ref=&#123;(element) =&gt; this._input = element&#125; /&gt;;&#125;,componentDidMount () &#123; this._input.focus();&#125;, ‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåÂú® ref ÂõûË∞ÉÊñπÊ≥ï‰∏≠ÊääËäÇÁÇπ TextInput ‰øùÂ≠ò‰∏∫ _input Â±ûÊÄß„ÄÇÂèØ‰ª•Âú®ÂøÖË¶ÅÁöÑÊó∂ÂÄôË∞ÉÁî®„ÄÇ ÊàëËÆ§‰∏∫ÊúÄÂ•ΩËøòÊòØÁî®ÂõûË∞ÉÂáΩÊï∞ÔºåÈÄöËøáÂõûË∞ÉÂáΩÊï∞ÂèØ‰ª•ÊääË¶Å‰ΩøÁî®ÁöÑÁªÑ‰ª∂ÊèêÂâçÂ£∞ÊòéÂá∫Êù•ÔºåÊñπ‰æøË∞ÉÁî®„ÄÇ Ë∑®Á∫ßÁªÑ‰ª∂ÈÄö‰ø°Ë∑®Á∫ßÁªÑ‰ª∂ÔºåÂ¶ÇÊûúËøòÊòØ‰∏ÄÂ±ÇÂ±Ç‰º†ÈÄí props ÈùûÂ∏∏ÁöÑ‰∏ç‰ºòÈõÖ„ÄÇReact Êèê‰æõ‰∫Ü‰∏Ä‰∏™ context Â±ûÊÄß„ÄÇ‰∏çËøáËøôÂπ∂‰∏çÊé®Ëçê‰ΩøÁî®„ÄÇ‰∏ÄËà¨Êàë‰ª¨‰ΩøÁî® react-redux Â∫ìÁöÑÊó∂ÂÄôÔºåstore Â∞±ÊòØÈÄöËøá context ‰º†ÈÄíÁöÑ„ÄÇ Ê≤°ÊúâÂµåÂ•óÂÖ≥Á≥ªÁöÑÁªÑ‰ª∂ÈÄö‰ø°Ê≤°ÊúâÂµåÂ•óÂÖ≥Á≥ªÂèØ‰ª•‰ΩøÁî® EventEmitter ÂÆûÁé∞„ÄÇÂú®‰∏Ä‰∏™Âú∞ÊñπÊ≥®ÂÜåÔºåÂè¶‰∏Ä‰∏™Âú∞ÊñπÁõëÂê¨„ÄÇ‰∏çËøá‰πüÊòØ‰∏çÊé®ËçêÁöÑ„ÄÇÊâÄ‰ª•Áî®Ê≥ï‰πüÂ∞±‰∏çÁªÜËØ¥‰∫Ü„ÄÇ Statestate ‰∏≠Â≠òÊîæ‰∏Ä‰∫õ‰∏éËßÜÂõæÊúâÂÖ≥ÁöÑÂèòÈáè„ÄÇ‰∏éËßÜÂõæÊó†ÂÖ≥ÁöÑÂèòÈáèÔºåÁõ¥Êé•Âú®ÊûÑÈÄ†Âô®Èáå‰Ωú‰∏∫Ëá™Ë∫´Â±ûÊÄßÂàõÂª∫„ÄÇÂèØ‰ª•Êúâ‰∏§ÁßçÊñπÂºè‰æø‰æø stateÔºö 1234// ÊñπÂºè‰∏Äthis.state.someProp = 1// ÊñπÂºè‰∫åthis.setState(&#123; someProp : 1 &#125;) ÂÖ∂‰∏≠ÔºåÊñπÂºè‰∫åËÉΩÂú®ÊîπÂèò State ÁöÑÂêåÊó∂Âà∑Êñ∞ËßÜÂõæ„ÄÇ PropsÁÆÄ‰ªãÁªÑ‰ª∂Âú®ÂàõÂª∫ÁöÑÊó∂ÂÄô‰º†ÂÖ• Props Êù•ÂÆåÊàêÂÆöÂà∂Ôºå‰æãÂ¶ÇÔºö 1&lt;Image source=&#123;pic&#125; style=&#123;&#123;width: 193, height: 110&#125;&#125; /&gt; ÂÖ∂‰∏≠ source,style ÈÉΩÊòØ‰º†ÂÖ• image ÁöÑ Props„ÄÇÂÖ∂‰∏≠ pic Ë°®Á§∫‰∏Ä‰∏™jsÂØπË±°ÔºåÁ±ª‰ººÂêéÈù¢ÁöÑ {width: 193, height: 110}„ÄÇ {pic} Â§ñÈù¢Êúâ‰∏™Êã¨Âè∑ÔºåË°®Á§∫Êã¨Âè∑ÂÜÖÊòØ‰∏Ä‰∏™jsÂèòÈáèÊàñËÄÖË°®ËææÂºèÔºåÈúÄË¶ÅÊâßË°åÂêéÂèñÂÄºÔºå‰ª•Ê≠§Âú®JSX‰∏≠ÂµåÂÖ•ÂçïÊù°jsËØ≠Âè•„ÄÇ Â≠êÁªÑ‰ª∂ÂÜÖËé∑Âèñ propsÊúâÊó∂ÂÄôÔºåÊàë‰ª¨ÊÉ≥Ë¶ÅÂ∞ÅË£Ö‰∏Ä‰∏™ÁªÑ‰ª∂ÔºåÂú®ÂÆπÂô®ÁªÑ‰ª∂ÂÜÖÂ§öÂÆö‰πâÂá†‰∏™ propsÔºå‰ΩÜÊòØÂπ∂‰∏çÂ∏åÊúõËøô‰∫õ props ‰º†Âà∞Â≠êÁªÑ‰ª∂ÂÜÖÔºåÊØîÂ¶ÇÂÆπÂô®ÁªÑ‰ª∂ÁöÑ children Â±ûÊÄß„ÄÇÊàë‰ª¨ÂèØ‰ª•ËøôÊ†∑ÂÅöÔºö 1234567891011121314151617181920212223242526render () &#123; const &#123; style, children, ...restProps, &#125; = this.props; // Âà†Èô§Â§ö‰ΩôÂ±ûÊÄß [ 'onOpenChange', 'onDrawerOpen', 'onDrawerClose', 'drawerPosition', 'renderNavigationView', ].forEach(prop =&gt; &#123; if (restProps.hasOwnProperty(prop)) &#123; delete restProps[prop]; &#125; &#125;); return ( &lt;View style=&#123;style&#125;&gt; &lt;SomeView &#123;...restProps&#125;/&gt; &#123;...children&#125; &lt;/View&gt; )&#125; Ê≥®ÊÑèÔºö ÈÄöËøáÂØπË±°Â±ïÂºÄÁ¨¶ÔºåÂèØ‰ª•Ëé∑ÂèñÂà∞ props ‰∏≠Ââ©‰ΩôÁöÑÂ±ûÊÄß„ÄÇ Â∞Ü‰∏Ä‰∏™ÂØπË±°‰Ωú‰∏∫ÁªÑ‰ª∂ÁöÑÂ±ûÊÄß‰º†ÂÖ•ÁöÑÊó∂ÂÄôË¶ÅÈÄöËøá {...obj} ÁöÑÊñπÂºè ÈÄöËøá hasOwnProperty Ëøõ‰∏ÄÊ≠•Âà†Èô§‰∏çÊÉ≥‰º†ÈÄíÁªôÂ≠êÁªÑ‰ª∂ÁöÑÂ±ûÊÄß this.props ÁöÑÂ±ïÂºÄË¶ÅÊîæÂú® render ÊñπÊ≥ïÈáåÔºåÂõ†‰∏∫ props ÂèØËÉΩ‰ºöÂèòÂåñËß¶ÂèëÈáçÁªòÔºåÊâÄ‰ª•Ë¶ÅÊØèÊ¨°ÈáçÁªòÁöÑÊó∂ÂÄôÈÉΩËøõË°åÂØπË±°Â±ïÂºÄ Props ‰ΩøÁî®ÁöÑÊ≥®ÊÑèÁÇπÈÄöÂ∏∏Êàë‰ª¨Áõ¥Êé•‰ºöÊää props ÊîæÂà∞ render ÊñπÊ≥ï‰∏≠ÔºåÊØîÂ¶Ç‰∏äÈù¢ÁöÑ‰æãÂ≠ê„ÄÇ‰ΩÜÊòØËøôÊ†∑ÂÖ∂ÂÆû‰∏çÂ§™Â•ΩÔºåÊØîÂ¶Ç‰∏Ä‰∏™È°µÈù¢Ë∑≥ËΩ¨ÁöÑÊó∂ÂÄôÔºå‰ºöÂ∏¶‰∏Ä‰∫õ props ËøáÊù•ÔºåÊàë‰ª¨ÈúÄË¶Å‰øÆÊîπ props ‰∏≠ÁöÑ‰∏Ä‰∫õÂ±ûÊÄß„ÄÇ‰ΩÜÊòØÊàë‰ª¨Âπ∂‰∏çÂ∏åÊúõÊääËøô‰∫õ‰øÆÊîπÂ∏¶ÂõûÂà∞ÂÖ∂‰ªñÈ°µÈù¢„ÄÇ ËøôÁßçÊó∂ÂÄôÊàë‰ª¨Â∞±‰∏çËÉΩÁõ¥Êé•‰øÆÊîπ props ‰∏≠ÁöÑÂ±ûÊÄß‰∫Ü„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂú® render ÁöÑÊó∂ÂÄôÔºåÊ∑±Êã∑Ë¥ùÊàñËÄÖ‰∏çÊµÖ‰∏çÊ∑±ÁöÑÊã∑Ë¥ù props ÁöÑÂÄºÔºö 1234567render () &#123; this.props1 = this.props.props1 this.props2 = this.props.props2 return ( &lt;View/&gt; )&#125; Âõ†‰∏∫Â§öÂä†‰∫Ü‰∏ÄÂ±Ç this.props1 Êàë‰ª¨Â∞±‰∏çÈúÄË¶ÅÊãÖÂøÉÔºåÂà∞Â∫ïËÉΩ‰∏çËÉΩ‰øÆÊîπ props ‰∫ÜÔºåÂ¶ÇÊûú‰∏çËÉΩ‰øÆÊîπ propsÔºåÈÇ£‰πàÁõ¥Êé•Ê∑±Êã∑Ë¥ù‰∏Ä‰∏ãÂç≥ÂèØ„ÄÇ Êõ¥Ëøõ‰∏ÄÊ≠•ÔºåÂÖ∂ÂÆûÊàë‰ª¨Âè™ÊúâÂú®‰∏çÂ∏åÊúõ‰øÆÊîπÊï∞ÊçÆÂ∏¶Âà∞ÂÖ∂‰ªñÈ°µÈù¢ÁöÑÊó∂ÂÄôÊâç‰ºö‰ΩøÁî® this ÊåÇËΩΩÔºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨Áõ¥Êé•‰ΩøÁî®ÁªìÊûÑËµãÂÄºÂç≥ÂèØÔºö 123456render () &#123; const &#123;prop1, prop2&#125; = this.props return ( &lt;View/&gt; )&#125; Â¶ÇÊûúÈ°πÁõÆÂèòÂåñÈúÄÊ±ÇÂèòÂåñ‰∫ÜÔºåÂÜçËΩ¨Âà∞Êää props ÁöÑÂ±ûÊÄßÊåÇÂú®Âà∞ this ‰∏ãÔºö 12345678render () &#123; this.props1 = this.props.props1 this.props2 = this.props.props2 const &#123;prop1, prop2&#125; = this return ( &lt;View/&gt; )&#125; Â∞±‰∏çÈúÄË¶ÅÂÜçÊõ¥Êç¢ View ÈáåÁöÑÂèÇÊï∞‰∫Ü propTypesÁªÑ‰ª∂ÁöÑÂ±ûÊÄßÂèØ‰ª•Êé•Âèó‰ªªÊÑèÂÄºÔºåÂ≠óÁ¨¶‰∏≤„ÄÅÂØπË±°„ÄÅÂáΩÊï∞Á≠âÁ≠âÈÉΩÂèØ‰ª•„ÄÇÊúâÊó∂ÔºåÊàë‰ª¨ÈúÄË¶Å‰∏ÄÁßçÊú∫Âà∂ÔºåÈ™åËØÅÂà´‰∫∫‰ΩøÁî®ÁªÑ‰ª∂Êó∂ÔºåÊèê‰æõÁöÑÂèÇÊï∞ÊòØÂê¶Á¨¶ÂêàË¶ÅÊ±Ç„ÄÇÁªÑ‰ª∂Á±ªÁöÑ PropTypes Â±ûÊÄßÔºåÂ∞±ÊòØÁî®Êù•È™åËØÅÁªÑ‰ª∂ÂÆû‰æãÁöÑÂ±ûÊÄßÊòØÂê¶Á¨¶ÂêàË¶ÅÊ±Ç„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂºïÂÖ•‰∏Ä‰∏™ prop-types Â∫ìÔºö 12345678910111213import PropTypes from 'prop-types';class Greeting extends React.Component &#123; render() &#123; return ( &lt;Text&gt;&#123;this.props.name&#125;&lt;/Text&gt; ); &#125;&#125;Greeting.propTypes = &#123; name: PropTypes.string&#125;; ‰∏äÈù¢‰æãÂ≠ê‰∏≠ÔºåÂ¶ÇÊûú name ‰∏çÊòØ string Á±ªÂûãÔºåÈÇ£‰πàÂ∞±‰ºö‰∫ßÁîü‰∏Ä‰∏™Ë≠¶Âëä„ÄÇËøòÂèØ‰ª•ËÆæÁΩÆ name: PropTypes.string.isRequired Ë°®Á§∫ÂøÖÈ°ª‰º†ÂÖ•Â±ûÊÄß name„ÄÇ Èô§‰∫Ü string Â§ñÔºåËøòÊúâËÆ∏Â§öÁ±ªÂûãÁöÑ PropTypes ÂèØ‰ª•ËÆæÁΩÆ: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950MyComponent.propTypes = &#123; // ÂèØ‰ª•Â£∞ÊòépropÊòØÁâπÂÆöÁöÑJSÂü∫Êú¨Á±ªÂûã // ÈªòËÆ§ÊÉÖÂÜµ‰∏ãËøô‰∫õpropÈÉΩÊòØÂèØÈÄâÁöÑ optionalArray:PropTypes.array, optionalBool: PropTypes.bool, optionalFunc: PropTypes.func, optionalNumber: PropTypes.number, optionalObject: PropTypes.object, optionalString: PropTypes.string, optionalSymbol: PropTypes.symbol, // ‰ªª‰ΩïÂèØ‰ª•Ë¢´Ê∏≤ÊüìÁöÑ‰∫ãÁâ©Ôºönumbers, strings, elements or an array // (or fragment) containing these types. optionalNode: PropTypes.node, // A React element. optionalElement: PropTypes.element, // Â£∞Êòé‰∏Ä‰∏™propÊòØÊüê‰∏™Á±ªÁöÑÂÆû‰æãÔºåÁî®Âà∞‰∫ÜJSÁöÑinstanceofËøêÁÆóÁ¨¶ optionalMessage: PropTypes.instanceOf(Message), // Áî®enumÊù•ÈôêÂà∂propÂè™Êé•ÂèóÁâπÂÆöÁöÑÂÄº optionalEnum: PropTypes.oneOf(['News', 'Photos']), // ÊåáÂÆöÁöÑÂ§ö‰∏™ÂØπË±°Á±ªÂûã‰∏≠ÁöÑ‰∏Ä‰∏™ optionalUnion: PropTypes.oneOfType([ PropTypes.string, PropTypes.number, PropTypes.instanceOf(Message) ]), // ÊåáÂÆöÁ±ªÂûãÁªÑÊàêÁöÑÊï∞ÁªÑ optionalArrayOf: PropTypes.arrayOf(PropTypes.number), // ÊåáÂÆöÁ±ªÂûãÁöÑÂ±ûÊÄßÊûÑÊàêÁöÑÂØπË±° optionalObjectOf: PropTypes.objectOf(PropTypes.number), // ‰∏Ä‰∏™ÊåáÂÆöÂΩ¢ÂºèÁöÑÂØπË±° optionalObjectWithShape: PropTypes.shape(&#123; color: PropTypes.string, fontSize: PropTypes.number &#125;), // ‰Ω†ÂèØ‰ª•Áî®‰ª•‰∏ä‰ªª‰ΩïÈ™åËØÅÂô®ÈìæÊé•‚ÄòisRequired‚ÄôÔºåÊù•Á°Æ‰øùprop‰∏ç‰∏∫Á©∫ requiredFunc: PropTypes.func.isRequired, // ‰∏çÂèØÁ©∫ÁöÑ‰ªªÊÑèÁ±ªÂûã requiredAny: PropTypes.any.isRequired, // PropTypes.elementÊåáÂÆö‰ªÖÂèØ‰ª•Â∞ÜÂçï‰∏ÄÂ≠êÂÖÉÁ¥†‰Ωú‰∏∫Â≠êËäÇÁÇπ‰º†ÈÄíÁªôÁªÑ‰ª∂ children: PropTypes.element.isRequired defaultPropsÂèØ‰ª•Âú® defaultProps ‰∏≠Ê≥®ÂÜåËÆæÁΩÆÈªòËÆ§Â±ûÊÄßÂÄº„ÄÇ 1234567891011class Greeting extends React.Component &#123; render() &#123; return ( &lt;Text&gt;&#123;this.props.name&#125;&lt;/Text&gt; ); &#125;&#125;Greeting.defaultProps = &#123; name: 'hahaha'&#125;; ÁªìÂêà‰∏äÈù¢Ëøô‰∏§‰∏™Â±ûÊÄßÔºåÂ∞±‰∏çÂøÖÂÜçÂú®ÊûÑÈÄ†ÂáΩÊï∞ÈáåËÆæÁΩÆÂêÑÁßçÂÄº‰∫Ü„ÄÇ this.props.childrenthis.props ÂØπË±°ÁöÑÂ±ûÊÄß‰∏éÁªÑ‰ª∂ÁöÑÂ±ûÊÄß‰∏Ä‰∏ÄÂØπÂ∫îÔºå‰ΩÜÊòØÊúâ‰∏Ä‰∏™‰æãÂ§ñÔºåÂ∞±ÊòØ this.props.children Â±ûÊÄß„ÄÇÂÆÉË°®Á§∫ÁªÑ‰ª∂ÁöÑÊâÄÊúâÂ≠êËäÇÁÇπ„ÄÇÁ±ª‰ºº‰∫é TouchableOpaque ÈáåÂµåÂÖ• TextÔºåÈÄöËøáËøôÁßçÊñπÂºèÂèØ‰ª•ÂæàÊñπ‰æøÁöÑÂµåÂ•óÂ∞ÅË£ÖÊéß‰ª∂„ÄÇ 123456789101112class NewComponent extends React.Component&#123; render()&#123; return( &#123;this.props.children&#125; ); &#125;&#125;//Ë∞ÉÁî®Ôºö&lt;NewComponent&gt; &lt;Text&gt;haha&lt;/Text&gt;&lt;/NewComponent&gt; this.props.children ÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåÂ≠êËäÇÁÇπ‰Ωú‰∏∫Êï∞ÁªÑÂÖÉÁ¥†‰º†ÂÖ•„ÄÇ TextInput ÈöêËóèÈîÆÁõòNative ‰∏≠ÁöÑ UITextField ÂèØ‰ª•ÈÄöËøá resignFirstResponder ÊàñËÄÖ endEditing ÁöÑÊñπÂºèÂèñÊ∂àÁ¨¨‰∏ÄÂìçÂ∫îËÄÖÔºå‰ªéËÄåÈöêËóèËôöÊãüÈîÆÁõò„ÄÇÈÇ£‰πàÔºåreact ‰∏≠Â¶Ç‰ΩïÂÅöÂà∞ÈöêËóèÈîÆÁõòÂë¢Ôºü ÂèØ‰ª•‰ΩøÁî® ScrollView ÂåÖË£ÖÊàë‰ª¨ÁöÑ View„ÄÇScrollView ÂèØ‰ª•ËÆæÁΩÆ keyboardDismissModeÔºåkeyboardShouldPersistTaps Êù•ÊéßÂà∂ËæìÂÖ•Ê≥ïÁöÑË°å‰∏∫„ÄÇ 123456&lt;ScrollView contentContainerStyle=&#123;&#123;flex:1&#125;&#125;//ÈùûÂ∏∏ÈáçË¶ÅÔºåËÆ©ScrollViewÁöÑÂ≠êÂÖÉÁ¥†Âç†Êª°Êï¥‰∏™Âå∫Âüü keyboardDismissMode='on-drag' //ÊãñÂä®ÁïåÈù¢ËæìÂÖ•Ê≥ïÈÄÄÂá∫ keyboardShouldPersistTaps=&#123;false&#125; //ÁÇπÂáªËæìÂÖ•Ê≥ïÊÑèÂ§ñÁöÑÂå∫ÂüüÔºåËæìÂÖ•Ê≥ïÈÄÄÂá∫ &gt;....&lt;/ScrollView&gt; ÁîüÂëΩÂë®ÊúüÂõûË∞ÉÂáΩÊï∞ÊÄªÁªìcomponentWillMount()componentWillMount ‰ºöÂú®ÁªÑ‰ª∂ render ‰πãÂâçÊâßË°åÔºåÂπ∂‰∏îÊ∞∏ËøúÈÉΩÂè™ÊâßË°å‰∏ÄÊ¨°„ÄÇ componentDidMount()componentDidMount ‰ºöÂú®ÁªÑ‰ª∂Âä†ËΩΩÂÆåÊØï‰πãÂêéÁ´ãÂç≥ÊâßË°å„ÄÇ componentWillReceiveProps(object nextProps)Âú®ÁªÑ‰ª∂Êé•Êî∂Âà∞‰∏Ä‰∏™Êñ∞ÁöÑ prop Êó∂Ë¢´ÊâßË°å„ÄÇËøô‰∏™ÊñπÊ≥ïÂú®ÂàùÂßãÂåñ render Êó∂‰∏ç‰ºöË¢´Ë∞ÉÁî®„ÄÇ Ëøô‰∏™ÊñπÊ≥ïÂæàÈáçË¶Å„ÄÇÁªÑ‰ª∂ÂÜÖÈÉ®Â±ûÊÄßÁöÑÂàùÂßãÂåñËÆæÁΩÆÂè™Êúâ‰∏ÄÊ¨°ÔºåÊâÄ‰ª•ÂΩìÁªÑ‰ª∂ÂàùÂßãÂåñÂÆåÊàêÂêéÔºåÂ§ñÈÉ®‰º†ÂÖ•ÁöÑÂ±ûÊÄßÂÄºÁöÑÂèòÂåñ‰∏ç‰ºöÁõ¥Êé•ÂºïËµ∑ÁªÑ‰ª∂ÂÜÖÈÉ®Â±ûÊÄßÂÄºÁöÑÂèòÂåñÔºåËÄåÊòØ‰ºöÂõûË∞ÉËøô‰∏™ÊñπÊ≥ï„ÄÇ Â¶ÇÊûú‰Ω†Âú®ÁªÑ‰ª∂ÂÜÖÈÉ®Áî®‰∏Ä‰∏™ÂèòÈáèÂéªÊé• propsÔºåÈÇ£‰πàÈô§‰∫ÜÂú® constructor ÈáåÂ∞Ü props ËµãÂÄºÁªôÂèòÈáèÂ§ñÔºåËøòÈúÄË¶ÅÂú®Ëøô‰∏™ÊñπÊ≥ïÈáåÂ∞Ü props ËµãÂÄºÁªôÂèòÈáè„ÄÇ boolean shouldComponentUpdate(object nextProps, object nextState)ËøîÂõû‰∏Ä‰∏™Â∏ÉÂ∞îÂÄº„ÄÇÂú®ÁªÑ‰ª∂ÁöÑ props ÊàñËÄÖ state ÊîπÂèòÊó∂Ë¢´ÊâßË°å„ÄÇÂú®ÂàùÂßãÂåñÊó∂ÊàñËÄÖ‰ΩøÁî® forceUpdate Êó∂‰∏çË¢´ÊâßË°å„ÄÇ Â¶ÇÊûú shouldComponentUpdate ËøîÂõû false,render() Âàô‰ºöÂú®‰∏ã‰∏Ä‰∏™ state change ‰πãÂâçË¢´ÂÆåÂÖ®Ë∑≥Ëøá„ÄÇ(Âè¶Â§ñ componentWillUpdate Âíå componentDidUpdate ‰πü‰∏ç‰ºöË¢´ÊâßË°å)ÈªòËÆ§ÊÉÖÂÜµ‰∏ã shouldComponentUpdate ‰ºöËøîÂõû true. componentWillUpdate(object nextProps, object nextState)ÁªÑ‰ª∂Êé•Êî∂Âà∞Êñ∞ÁöÑ props ÊàñËÄÖ state ‰ΩÜËøòÊ≤°Êúâ render Êó∂Ë¢´ÊâßË°å„ÄÇÂú®ÂàùÂßãÂåñÊó∂‰∏ç‰ºöË¢´ÊâßË°å„ÄÇ‰∏ÄËà¨Áî®Âú®ÁªÑ‰ª∂ÂèëÁîüÊõ¥Êñ∞‰πãÂâç„ÄÇ componentDidUpdate(object prevProps, object prevState)Âú®ÁªÑ‰ª∂ÂÆåÊàêÊõ¥Êñ∞ÂêéÁ´ãÂç≥ÊâßË°å„ÄÇÂú®ÂàùÂßãÂåñÊó∂‰∏ç‰ºöË¢´ÊâßË°å„ÄÇ‰∏ÄËà¨‰ºöÂú®ÁªÑ‰ª∂ÂÆåÊàêÊõ¥Êñ∞ÂêéË¢´‰ΩøÁî®„ÄÇ‰æãÂ¶ÇÊ∏ÖÈô§ notification ÊñáÂ≠óÁ≠âÊìç‰Ωú„ÄÇ componentWillUnmount()‰∏ªË¶ÅÁî®Êù•ÊâßË°å‰∏Ä‰∫õÂøÖË¶ÅÁöÑÊ∏ÖÁêÜ‰ªªÂä°„ÄÇÊ≥®ÊÑèÔºåUnmount ÁöÑÂ§ßÂ∞èÂÜô„ÄÇÂÜôÈîôÂ∞±Êó†Ê≥ïË∞ÉÁî®‰∫ÜÔºÅÔºÅÔºÅ ‰ºòÂåñÂàáÊç¢Âä®ÁîªÂç°È°øÁöÑÈóÆÈ¢ò‰ΩøÁî®API InteractionManagerÔºåÂÆÉÁöÑ‰ΩúÁî®Â∞±ÊòØÂèØ‰ª•‰ΩøÊú¨Êù• JS ÁöÑ‰∏Ä‰∫õÊìç‰ΩúÂú®Âä®ÁîªÂÆåÊàê‰πãÂêéÊâßË°åÔºåËøôÊ†∑Â∞±ÂèØÁ°Æ‰øùÂä®ÁîªÁöÑÊµÅÁ®ãÊÄß„ÄÇÂΩìÁÑ∂ËøôÊòØÂú®Âª∂ËøüÊâßË°å‰∏∫‰ª£‰ª∑‰∏äÊù•Ëé∑ÂæóÂ∏ßÊï∞ÁöÑÊèêÈ´ò„ÄÇ123456789InteractionManager.runAfterInteractions(()=&gt;&#123; //...ËÄóÊó∂ËæÉÈïøÁöÑÂêåÊ≠•‰ªªÂä°... //Êõ¥Êñ∞state‰πüÈúÄË¶ÅÊó∂Èó¥ this.setState(&#123; ... &#125;) //Ëé∑ÂèñÊüê‰∫õÊï∞ÊçÆÔºåÈúÄË¶ÅÈïøÊó∂Èó¥Á≠âÂæÖ this.fetchData(arguements)&#125;) ‰∏ÄËà¨Ëøô‰∏™ÊñπÊ≥ïÈÉΩÊîæÂú® componentDidMount Èáå„ÄÇ React-Native ÂéüÁîüÊ®°ÂùóË∞ÉÁî®(iOS)Âú®È°πÁõÆ‰∏≠ÈÅáÂà∞Âú∞Âõæ,Êã®ÊâìÁîµËØù,Ê∏ÖÈô§ÁºìÂ≠òÁ≠âiOS‰∏éAndioridÊú∫Âà∂‰∏çÂêåÁöÑÂäüËÉΩ,Â∞±ÈúÄË¶ÅË∞ÉÁî®ÂéüÁîüÁöÑÁïåÈù¢ÊàñÊ®°Âùó„ÄÇ ÂàõÂª∫ÂéüÁîüÊ®°ÂùóÔºåÂÆûÁé∞‚ÄúRCTBridgeModule‚ÄùÂçèËÆÆ123456#import &lt;UIKit/UIKit.h&gt;#import &quot;RCTBridgeModule.h&quot;@interface LoginViewController : UIViewController&lt;RCTBridgeModule&gt;@end ÂØºÂá∫Ê®°ÂùóÔºåÂØºÂá∫ÊñπÊ≥ï‰∏ç‰ªÖÂèØ‰ª•ËÆ©ÂØºÂá∫ native ÁöÑÊñπÊ≥ïÔºåËÄå‰∏îËøòÂèØ‰ª•Âú® js ‰∏≠Ê∑ªÂä†ÂõûË∞ÉÂáΩÊï∞Ôºå‰æõ native Ë∞ÉÁî®ÔºåËøôÊ†∑ native Â∞±ÂèØ‰ª•Â∞ÜÂâçÈù¢ÁöÑÊï∞ÊçÆÂõûÂ°ûÁªô js ‰∫Ü„ÄÇ12345678910111213141516@implementation LoginViewController//ÂØºÂá∫Ê®°ÂùóRCT_EXPORT_MODULE()- (void)viewDidLoad &#123; [super viewDidLoad];&#125;RCT_EXPORT_METHOD(showSVProgressHUDErrorWithStatus:(NSString *)state callBack:(RCTResponseSenderBlock)callback)&#123; NSLog(@&quot;state is %@&quot;,state); NSArray *events = [[NSArray alloc] initWithObjects:@&quot;hello&quot;, nil]; // ËøôÈáåcallbackÂøÖÈ°ªÊòØÊï∞ÁªÑ callback(events); [SVProgressHUD showErrorWithStatus:state];&#125;@end jsÊñá‰ª∂‰∏≠Ë∞ÉÁî®12345//ÂàõÂª∫ÂéüÁîüÊ®°ÂùóÂÆû‰æãlet LoginViewController = NativeModules.LoginViewController;//ÊñπÊ≥ïË∞ÉÁî®LoginViewController.showSVProgressHUDErrorWithStatus('ËØ∑ËæìÂÖ•Ê≠£Á°ÆÁöÑÊâãÊú∫Âè∑',(callbackString) =&gt; &#123;console.log(callbackString);&#125;); React Native Ë∞ÉËØïÈ¶ñÂÖàÔºåÂøÖÈ°ª ‰øùËØÅË∞ÉËØïÁî®ÁîµËÑëÁöÑÂíå‰Ω†ÁöÑËÆæÂ§áÂ§Ñ‰∫éÁõ∏ÂêåÁöÑ WiFi ÁΩëÁªúÁéØÂ¢É‰∏≠‰∏ã„ÄÇÁÑ∂Âêé‰øÆÊîπAppDelegate.m Êñá‰ª∂ÔºåËÆæÁΩÆ ip ‰∏∫ÁîµËÑë ip Âç≥ÂèØ„ÄÇ ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÈÄöËøá Chrome ÂºÄÂèëÂ∑•ÂÖ∑ËøõË°åË∞ÉËØï„ÄÇÊúÄÂ•Ω‰∏çË¶Å‰ΩøÁî® VSCode Êèê‰æõÁöÑÊµãËØïÂ∑•ÂÖ∑„ÄÇ‰∏çÂ•ΩÁî®„ÄÇ Â¶ÇÊûúÊÉ≥Ë¶ÅÂø´ÈÄüË∞ÉÊ†∑ÂºèÔºåÂª∫ËÆÆÈÄâ‰∏ä Enable Hot Reloading „ÄÇÂèØ‰ª•Âú®‰Ω†ÊØèÊ¨°‰øùÂ≠òÁöÑÊó∂ÂÄôÂú®Êú¨È°µÈù¢ÈáçÊñ∞Âä†ËΩΩ„ÄÇ ‰ΩøÁî® xcode run ‰∏ÄÈÅç‰πãÂêéÔºåÂ¶ÇÊûúÊ≤°Êúâ native ‰ª£Á†ÅÁöÑÊîπÂä®ÔºåÊâãÊú∫Â∞±ÂèØ‰ª•‰∏çÁî®ÂÜçËøûÁùÄÁîµËÑë‰∫ÜÔºåÂú®È°πÁõÆÂú∞ÂùÄ‰∏ãÔºå‰ΩøÁî® npm start ÂºÄÂêØÊú¨Âú∞ÊúçÂä°„ÄÇ React Native ËØªÂèñÊú¨Âú∞ÁöÑjsonÊñá‰ª∂ÂèØ‰ª•‰ª•ÂØºÂÖ•ÁöÑÂΩ¢ÂºèÔºåÊù•ËØªÂèñÊú¨Âú∞ÁöÑjsonÊñá‰ª∂ÔºåÂØºÂÖ•ÁöÑÊñá‰ª∂ÂèØ‰ª•‰Ωú‰∏∫‰∏Ä‰∏™jsÂØπË±°‰ΩøÁî®ÔºåËøôÊ†∑Êñπ‰æøË∞ÉËØïÁöÑÊó∂ÂÄôÂä†ËΩΩÊï∞ÊçÆ„ÄÇ ÂØºÂÖ•jsonÊñá‰ª∂Ôºö1var langsData = require('./json/langs.json'); Áé∞Âú®‰Ω†ÂèØ‰ª•Êìç‰ΩúlangsDataÂØπË±°‰∫Ü„ÄÇ jsonÊ†ºÂºè1234567891011121314151617[ &#123; "path":"", "name":"123", "checked":false &#125;, &#123; "path":"aa", "name":"1234", "checked":false &#125;, &#123; "path":"ddd", "name":"123123123", "checked":true &#125;] ‰ΩøÁî®123for (var i=0,l=langsData.length;i&lt;l;i++)&#123; console.log(langsData[i]);&#125;]]></content>
      <categories>
        <category>React-Native</category>
      </categories>
      <tags>
        <tag>React-Native</tag>
        <tag>Áà¨Âùë</tag>
        <tag>ÊåÅÁª≠Êõ¥Êñ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[KVO ÂÆûË∑µÂèä FBKVOController ÂéüÁêÜ]]></title>
    <url>%2F2016%2F11%2F17%2FKVO%2F</url>
    <content type="text"><![CDATA[Êú¨ÁØáÁÆÄÂçïÂ≠¶‰π†‰∏ãÂ¶Ç‰Ωï‰ΩøÁî® KVO KVOÊòØ‰ªÄ‰πàÔºüKVO ÊòØ Object-C ‰∏≠ÂÆö‰πâÁöÑ‰∏Ä‰∏™ÈÄöÁü•Êú∫Âà∂ÔºåÂÖ∂ÂÆö‰πâ‰∫Ü‰∏ÄÁßçÂØπË±°Èó¥ÁõëÊéßÂØπÊñπÁä∂ÊÄÅÁöÑÊîπÂèòÔºåÂπ∂ÂÅöÂá∫ÂèçÂ∫îÁöÑÊú∫Âà∂„ÄÇÂØπË±°ÂèØ‰ª•‰∏∫Ëá™Â∑±ÁöÑÂ±ûÊÄßÊ≥®ÂÜåËßÇÂØüËÄÖÔºåÂΩìËøô‰∏™Â±ûÊÄßÁöÑÂÄºÂèëÁîü‰∫ÜÊîπÂèòÔºåÁ≥ªÁªü‰ºöÂØπËøô‰∫õÊ≥®ÂÜåÁöÑËßÇÂØüËÄÖÂÅöÂá∫ÈÄöÁü•„ÄÇÂÖ∂Áî®ÈÄîÂçÅÂàÜÂπøÊ≥õÔºåÊØîÊñπËØ¥Ôºå‰Ω†ÁöÑ‰∏ãËΩΩËøõÂ∫¶Êù°ÊòØÊ†πÊçÆ‰∏ãËΩΩÁôæÂàÜÊØîÂÜ≥ÂÆöÁöÑÔºåÈÇ£‰πàÔºåÂèØ‰ª•ÈÄöËøáËßÇÂØü‰∏ãËΩΩÁôæÂàÜÊØîÁöÑÊîπÂèòÔºåÂà∑Êñ∞ËøõÂ∫¶Êù°ÁöÑÊ†∑ÂºèÔºåÊù•Áõ¥ËßÇÁöÑÂèçÂ∫î‰∏ãËΩΩËøõÂ∫¶Á≠âÁ≠â„ÄÇ KVOÁöÑÁî®Ê≥ï‰∏∫ÂØπË±°ÁöÑÂ±ûÊÄßÊ≥®ÂÜåËßÇÂØüËÄÖ1234- (void)addObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options context:(void *)context observer: ËßÇÂØüËÄÖÂØπË±°. ÂÖ∂ÂøÖÈ°ªÂÆûÁé∞ÊñπÊ≥ï observeValueForKeyPath:ofObject:change:context:. keyPath: Ë¢´ËßÇÂØüÁöÑÂ±ûÊÄßÔºåÂÖ∂‰∏çËÉΩ‰∏∫ nil. options: ËÆæÂÆöÈÄöÁü•ËßÇÂØüËÄÖÊó∂‰º†ÈÄíÁöÑÂ±ûÊÄßÂÄºÔºåÊòØ‰º†ÊîπÂèòÂâçÁöÑÂë¢ÔºåËøòÊòØÊîπÂèòÂêéÁöÑÔºåÈÄöÂ∏∏ËÆæÁΩÆ‰∏∫ NSKeyValueObservingOptionNew„ÄÇ context: ‰∏Ä‰∫õÂÖ∂‰ªñÁöÑÈúÄË¶Å‰º†ÈÄíÁªôËßÇÂØüËÄÖÁöÑ‰∏ä‰∏ãÊñá‰ø°ÊÅØÔºåÈÄöÂ∏∏ËÆæÁΩÆ‰∏∫ nil„ÄÇ ËßÇÂØüËÄÖÊé•Êî∂ÈÄöÁü•1234- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context keyPath: Ë¢´ËßÇÂØüÁöÑÂ±ûÊÄßÔºåÂÖ∂‰∏çËÉΩ‰∏∫ nil. object: Ë¢´ËßÇÂØüËÄÖÁöÑÂØπË±°. change: Â±ûÊÄßÂÄºÔºåÊ†πÊçÆ‰∏äÈù¢ÊèêÂà∞ÁöÑ Options ËÆæÁΩÆÔºåÁªôÂá∫ÂØπÂ∫îÁöÑÂ±ûÊÄßÂÄº„ÄÇ context: ‰∏äÈù¢‰º†ÈÄíÁöÑ context ÂØπË±°„ÄÇ Ê∏ÖÈô§ËßÇÂØüËÄÖ1- (void)removeObserver:(NSObject *)anObserver forKeyPath:(NSString *)keyPath Ê≥®ÊÑè‰∫ãÈ°π‰ΩøÁî®KVOÊ∂àÊÅØ‰º†ÈÄíÊú∫Âà∂Êúâ‰∏§‰∏™Ë¶ÅÊ±ÇÔºö ËßÇÂØüËÄÖÂøÖÈ°ªÁü•ÈÅìË¢´ËßÇÂØüÂØπË±°ÔºåÂç≥Âú®Âêå‰∏Ä‰ΩúÁî®Âüü„ÄÇ ËßÇÂØüËÄÖËøòÈúÄË¶ÅÁü•ÈÅìË¢´ËßÇÂØüÂØπË±°ÁöÑÁîüÂëΩÂë®ÊúüÔºåÂõ†‰∏∫Âú®ÈîÄÊØÅÂèëÈÄÅËÄÖÂØπË±°‰πãÂâçÔºåÈúÄË¶ÅÂèñÊ∂àËßÇÂØüËÄÖÁöÑÊ≥®ÂÜå„ÄÇ KVO ÂéüÁêÜÂÆûÁé∞ÂéüÁêÜÂΩì‰∏Ä‰∏™ÂØπË±°‰ΩøÁî® KVO ÁõëÂê¨ÔºåiOS ‰ºö‰øÆÊîπÂØπË±°ÁöÑ isa ÊåáÈíàÔºåÊîπ‰∏∫ÊåáÂêë‰∏Ä‰∏™Áî± runtime ÂàõÂª∫ÁöÑÁ±ªÔºåËøô‰∏™Á±ªÁöÑ superclass ‰∏∫ÂéüÊù•ÁöÑ class ÂØπË±°„ÄÇÂä®ÊÄÅÂàõÂª∫ÁöÑÁ±ªÊã•ÊúâËá™Â∑±ÁöÑ set ÊñπÊ≥ïÂÆûÁé∞ÔºåÂÜÖÈÉ®‰ºö‰æùÊ¨°Ë∞ÉÁî®Ôºö 1231. - (void)willChangeValueForKey:(NSString *)key;2. ÂéüÊù•ÁöÑ setter ÊñπÊ≥ï3. - (void)didChangeValueForKey:(NSString *)key; Âú® didChangeValueForKey ‰∏≠‰ºöË∞ÉÁî®ÁõëÂê¨Âô®ÁöÑÁõëÂê¨ÊñπÊ≥ï„ÄÇÊâÄ‰ª•Áõ¥Êé•‰øÆÊîπÊàêÂëòÂèòÈáè‰∏ç‰ºöËß¶Âèë KVO„ÄÇ ÈÇ£‰πà didChangeValueForKey ÊòØÂ¶Ç‰ΩïÊâæÂà∞ËßÇÂØüËÄÖÁöÑÂë¢ÔºüÊ∑ªÂä†ËßÇÂØüËÄÖÁöÑÊó∂ÂÄôÔºå‰ºö‰ª•Ë¢´ËßÇÂØüÁöÑÂ±ûÊÄßÂêç‰Ωú‰∏∫ÈîÆÔºåËßÇÂØüËÄÖÁöÑÂàóË°®‰Ωú‰∏∫ÂÄºÂ∞ÜËßÇÂØüÁöÑ‰ø°ÊÅØ‰øùÂ≠òÂú®‰∏Ä‰∏™ hashMap ‰∏≠ÔºåÈÄöËøáÂÖ≥ËÅîÂØπË±°ÁöÑÊñπÂºèÊåÇËΩΩÂú®Ë¢´ËßÇÂØüÂØπË±°‰∏ä„ÄÇÂΩì didChangeValueForKey Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÂú®Ëøô‰∏™ hashMap ‰∏≠ÊâæÂà∞ÂØπÂ∫îÁöÑËßÇÂØüËÄÖÂàóË°®Ôºå‰æùÊ¨°Ë∞ÉÁî®ËßÇÂØüËÄÖÁöÑ observeValueForKeyPath:ofObject:change:context: ÊñπÊ≥ï„ÄÇ ÈÇ£‰πàÂ§öÁ∫ß keypath ÂèàÊòØÂ¶Ç‰ΩïËßÇÂØüÂà∞ÁöÑÂë¢ÔºüÊ∑ªÂä†ËßÇÂØüËÄÖÁöÑÊó∂ÂÄôÔºåÂ∞ÜÈÄíÂΩíÂàõÂª∫Â≠êÂØπË±°ÁõëÂê¨ÔºåÂ≠êÂØπË±°Âú®Â∞ÜÁõëÂê¨Âà∞ÁöÑÂèòÂåñËΩ¨ÂèëÂà∞‰∏äÂ±Ç„ÄÇÊúÄ‰∏äÂ±ÇÂàôÈÄöÁü•Â§ñÈÉ®ÁöÑËßÇÂØüËÄÖ„ÄÇ Â¶Ç‰ΩïÊâãÂä®Ëß¶Âèë KVOÊúâÊó∂ÂÄô‰∏∫‰∫ÜÂú®‰∏çÊîπÂèòÂ±ûÊÄßÂÄºÁöÑÊÉÖÂÜµ‰∏ãÔºåËß¶ÂèëÁõëÂê¨ÊñπÊ≥ïÔºåÊâÄ‰ª•Ë¶ÅÊâãÂä®Ëß¶Âèë KVO„ÄÇÊâãÂä®Ë∞ÉÁî®Ôºö 12- (void)willChangeValueForKey:(NSString *)key;- (void)didChangeValueForKey:(NSString *)key; KVC Ëß¶Âèë KVOKVC ‰ºöËß¶Âèë KVO„ÄÇÂç≥‰ΩøÊàêÂëòÂèòÈáèÊ≤°Êúâ get set ÊñπÊ≥ïÔºåKVC ÊâãÂä®Ë∞ÉÁî® willChangeValueForKey: Âíå didChangeValueForKey:„ÄÇ Âõ†‰∏∫Êñ∞ÁöÑÁ±ªÂÜÖÈÉ®ÈáçÂÜô‰∫Ü setValue:forKey: ÊñπÊ≥ï„ÄÇ KVOControllerKVO Â≠òÂú®ÁöÑÈóÆÈ¢òKVO Êú¨Ë∫´ÂÜôËµ∑Êù•Âπ∂‰∏çÂèãÂ•ΩÔºåÂ≠òÂú®‰∏Ä‰∫õÈóÆÈ¢òÔºö ÈúÄË¶ÅÊâãÂä®ÁßªÈô§ËßÇÂØüËÄÖ Â§ÑÁêÜËßÇÂØü‰∫ã‰ª∂ÈúÄË¶ÅÂíåÊ≥®ÂÜåËßÇÂØü‰∫ã‰ª∂Ââ≤Ë£ÇÂºÄ ÈÇ£‰πàÂ¶Ç‰ΩïËß£ÂÜ≥Âë¢Ôºü Ê≤°Êúâ‰ªÄ‰πàÊòØ‰∏Ä‰∏™‰∏≠Èó¥ÂèòÈáè‰∏çËÉΩËß£ÂÜ≥ÁöÑ„ÄÇÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ÂÆû‰æãÔºåËßÇÂØüÁöÑ‰∫ã‰ª∂Áî±ÂÆÉÂàÜÂèëÔºåÂú®ÂÖ∂ dealloc ÊñπÊ≥ï‰∏≠ÁßªÈô§ËßÇÂØüËÄÖ„ÄÇËøôÊ†∑Â∞±‰∏çÁî®Âú®Â§ñÈÉ®‰∏öÂä°ÊñπÊ≥ï‰∏≠ÁßªÈô§‰∫Ü„ÄÇKVOController ‰πüÊòØËøô‰πàÂÅöÁöÑ„ÄÇ ‰ΩøÁî®ÊñπÂºè‰ΩøÁî®ÊñπÂºèÂæàÁÆÄÂçïÔºåÈ¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™ KVOController ÂÆû‰æãÔºåÁÑ∂ÂêéÊâßË°å observe:keyPath:options:block: ÊñπÊ≥ïÊ≥®ÂÜåËßÇÂØüËÄÖÔºö 12345678// Âú® ClockView Á±ª‰∏≠FBKVOController *KVOController = [FBKVOController controllerWithObserver:self];self.KVOController = KVOController;// clock ÊòØ ClockView ÂÆû‰æãÁöÑ‰∏Ä‰∏™Â±ûÊÄßÔºådata ÊòØ clock ÂÆû‰æãÁöÑ‰∏Ä‰∏™Â±ûÊÄß[self.KVOController observe:clock keyPath:@"date" options:NSKeyValueObservingOptionInitial|NSKeyValueObservingOptionNew block:^(ClockView *clockView, Clock *clock, NSDictionary *change) &#123; clockView.date = change[NSKeyValueChangeNewKey];&#125;]; ÂÖ∂‰∏≠Ôºå block ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ ClockView ‰∏∫ observerÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ Clock ‰∏∫ targetÔºåÁ¨¨‰∏â‰∏™ÂèÇÊï∞‰∏∫ÂèòÂåñÁöÑ keypath ÁöÑÂèòÂåñÂâçÂêéÂÄºÁöÑÂ≠óÂÖ∏„ÄÇ Êï¥‰ΩìÁªìÊûÑ Êï¥‰ΩìÁªìÊûÑÂ¶Ç‰∏äÂõæÊâÄÁ§∫ÔºåKVOController ÂØπË±°Êúâ‰∏Ä‰∏™ËßÇÂØüËÄÖ observer ËøòÊúâ‰∏Ä‰∏™ NSMapTable ÁöÑ _objectInfosMapÔºåÂÆÉÁöÑÈîÆÊòØË¢´ËßÇÂØüÁöÑÂØπË±° objectÔºåÂÄºÊòØË¢´ËßÇÂØüÂØπË±°ÁöÑÂêÑ‰∏™Â±ûÊÄßÁöÑÂ∞ÅË£ÖÁöÑ NSMutableSetÔºåSet ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩ‰øùÂ≠ò‰∫ÜË¶ÅÊâßË°åÁöÑ block Ê∫êÁ†ÅËß£ÊûêÂàõÂª∫ KVOController ÂÆû‰æãÂêÑ‰∏™ÂàùÂßãÂåñÊñπÊ≥ïÈÉΩ‰ºöÊù•Âà∞Ëøô‰∏™ÊñπÊ≥ïÔºö 12345678910111213- (instancetype)initWithObserver:(nullable id)observer retainObserved:(BOOL)retainObserved&#123; self = [super init]; if (nil != self) &#123; _observer = observer; // ÂàõÂª∫ NSMapTable ÈúÄË¶ÅÊèê‰æõ‰∏Ä‰∏™ÈÄâÈ°πÊù•ÂÜ≥ÂÆö key ‰ª•Âèä value ÊòØÂº∫ÂºïÁî®ËøòÊòØÂº±ÂºïÁî® NSPointerFunctionsOptions keyOptions = retainObserved ? NSPointerFunctionsStrongMemory|NSPointerFunctionsObjectPointerPersonality : NSPointerFunctionsWeakMemory|NSPointerFunctionsObjectPointerPersonality; _objectInfosMap = [[NSMapTable alloc] initWithKeyOptions:keyOptions valueOptions:NSPointerFunctionsStrongMemory|NSPointerFunctionsObjectPersonality capacity:0]; pthread_mutex_init(&amp;_lock, NULL); &#125; return self;&#125; ËøôÈáåÈù¢ÁöÑ observer Âú®Â§ñÈÉ®‰ºöÂº∫ÂºïÁî®Ëøô‰∏™ KVOControllerÔºåÊâÄ‰ª•ÂàùÂßãÂåñÊñπÊ≥ï‰∏≠ÁöÑ _observer ÈªòËÆ§ÊòØÂº±ÂºïÁî®ÁöÑÔºå‰∏çÁî®ÊãÖÂøÉÂæ™ÁéØÂºïÁî®ÁöÑÈóÆÈ¢ò„ÄÇ Áî±‰∫éÂèÇÊï∞ retainObserverd ÈªòËÆ§ÊòØ YESÔºåÊâÄ‰ª•ÂàõÂª∫ÁöÑ NSMapTable ÁöÑ key ÁöÑÈÄâÈ°πÈªòËÆ§ÊòØÔºö 1NSPointerFunctionsStrongMemory|NSPointerFunctionsObjectPointerPersonality ÈÄâÈ°πÁöÑÂÖ∑‰ΩìÂê´‰πâÂú®‰∏ãÈù¢‰ªãÁªç NSMapTable ÁöÑÊó∂ÂÄô‰ºöÊèêÂèä„ÄÇÊÄª‰πãÔºåËøôÈáåÂàõÂª∫ÁöÑ NSMapTable ÈªòËÆ§ÈîÆÂíåÂÄºÈÉΩÊòØÂº∫ÂºïÁî®ÁöÑÔºåÊâÄ‰ª•Â¶ÇÊûúË¢´ËßÇÂØüÁöÑÂØπË±°ÊòØËßÇÂØüËÄÖ observer Êú¨Ë∫´ÔºåÂ∞±Ë¶ÅÊ≥®ÊÑèË¶Å‰º†ÂÖ•Âº±ÂºïÁî®ÔºåÂê¶Âàô‰ºö‰∫ßÁîüÂæ™ÁéØÂºïÁî®„ÄÇ ÊúÄÂêéÂàõÂª∫‰∫Ü‰∏Ä‰∏™ pthread_mutex_t Ê≥®ÂÜåËßÇÂØüÊñπÊ≥ïÊ≥®ÂÜåËßÇÂØüÊñπÊ≥ïÂ§ñÈÉ®Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÔºö 1234567- (void)observe:(nullable id)object keyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options context:(nullable void *)context &#123; // create info _FBKVOInfo *info = [[_FBKVOInfo alloc] initWithController:self keyPath:keyPath options:options context:context]; // observe object with info [self _observe:object info:info];&#125; Â§ñÈÉ®Ë∞ÉÁî®ÁöÑÊó∂ÂÄô‰ºöÂàõÂª∫‰∏Ä‰∏™ FBKVOInfo ÂØπË±°ÔºåËøô‰∏™ÂØπË±°‰øùÂ≠ò‰∫ÜËßÇÂØüÂõûË∞ÉÊâÄÈúÄÁöÑÂêÑÁßçË¶ÅÁ¥†ÔºåÈöèÂêéÊâßË°åÂÜÖÈÉ®ÁöÑÊ≥®ÂÜåÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829- (void)_observe:(id)object info:(_FBKVOInfo *)info &#123; // lock pthread_mutex_lock(&amp;_lock); /// ÊãøÂà∞ KVOController ‰∏≠ÊâÄÊúâÁöÑ object ÁöÑ KVOInfo ÁöÑÈõÜÂêà NSMutableSet *infos = [_objectInfosMap objectForKey:object]; /// Â¶ÇÊûúÂ≠òÂú®Ëøô‰∏™ info ÈÇ£‰πàÂ∞±Áõ¥Êé•ËøîÂõû„ÄÇ Info ‰∏ªË¶ÅÊòØÁõëÂê¨ÁöÑ keyPath ÂíåË¶ÅÊâßË°åÁöÑ block ‰ø°ÊÅØÔºåInfos Â∞±ÊòØÊâÄÊúâË¶ÅÁõëÂê¨ÁöÑ keyPath ÁöÑÈõÜÂêà _FBKVOInfo *existingInfo = [infos member:info]; if (nil != existingInfo) &#123; // unlock and return pthread_mutex_unlock(&amp;_lock); return; &#125; /// Â¶ÇÊûúÊ≤°ÊúâËøô‰∏™ infosÔºåÈÇ£‰πàÂ∞±Ëá™Â∑±ÂàõÂª∫‰∏Ä‰∏™ if (nil == infos) &#123; infos = [NSMutableSet set]; [_objectInfosMap setObject:infos forKey:object]; &#125; // add info and oberve [infos addObject:info]; // unlock prior to callout pthread_mutex_unlock(&amp;_lock); [[_FBKVOSharedController sharedController] observe:object info:info];&#125; ÂèØ‰ª•ÁúãÂà∞ÔºåËøôÈáåÊääË¶ÅËßÇÂØüÁöÑÂØπË±° object ÂíåÂàöÂàöÂàõÂª∫ÁöÑ‰øùÂ≠òÂõûË∞ÉË¶ÅÁ¥†ÁöÑ KVOInfo ÂØπË±°‰øùÂ≠òÂú®‰∫Ü _onjectInfosMap Ëøô‰∏™ NSMapTable ‰∏≠„ÄÇ ÊâÄ‰ª•Ôºå‰∏Ä‰∏™Ë¢´ËßÇÂØüÁöÑÂØπË±° object ÁöÑÊâÄÊúâÊ≥®ÂÜåËßÇÂØüÁöÑ keyPath ÈÉΩ‰ºö‰øùÂ≠òÂú®‰∏Ä‰∏™ NSMutableSet ‰∏≠ÔºåÂÜçÊää object Âíå NSMutableSet ‰Ωú‰∏∫ÈîÆÂÄºÂØπÔºå‰øùÂ≠òÂú® NSMapTable ‰∏≠„ÄÇ ÊúÄÂêéË∞ÉÁî®ÁöÑ _FBKVOSharedController ÊâçÊòØÁúüÊ≠£Ê≥®ÂÜåËßÇÂØüËÄÖÁöÑÂú∞Êñπ„ÄÇ ÁúüÊ≠£Áî®Êù•Ê≥®ÂÜåËßÇÂØüËÄÖÁöÑ KVOSharedControllerKVOSharedController ‰∏≠ËøòÁî®Âà∞‰∫Ü NSHashTableÔºå‰ΩÜÊòØÂíå KVOController ‰∏≠ NSMapTable ‰∏çÂêåÁöÑÊòØÔºåËøôÈáåÈÉΩÊòØÈÄöËøáÂº±ÂºïÁî®‰øùÂ≠òÁöÑ„ÄÇÂéüÂõ†ÊòØÂõ†‰∏∫Â§ñÈÉ®ÁöÑ KVOController ÈÉΩ‰øùÂ≠òÁ°Æ‰øù‰∏ç‰ºöË¢´ÂõûÊî∂‰∫ÜÔºåËøôÈáåÂ∞±‰∏çÈúÄË¶ÅÂÜçÂº∫ÂºïÁî®‰∫Ü„ÄÇ 1234567891011121314151617181920212223242526@implementation _FBKVOSharedController&#123; NSHashTable&lt;_FBKVOInfo *&gt; *_infos; pthread_mutex_t _mutex;&#125;+ (instancetype)sharedController&#123; static _FBKVOSharedController *_controller = nil; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; _controller = [[_FBKVOSharedController alloc] init]; &#125;); return _controller;&#125;- (instancetype)init&#123; self = [super init]; if (nil != self) &#123; NSHashTable *infos = [NSHashTable alloc]; _infos = [infos initWithOptions:NSPointerFunctionsWeakMemory|NSPointerFunctionsObjectPointerPersonality capacity:0]; pthread_mutex_init(&amp;_mutex, NULL); &#125; return self;&#125; KVOSharedController ÊòØ‰∏™Âçï‰æãÔºåÊâÄÊúâÁöÑÊ≥®ÂÜåÂíåÂõûË∞ÉÈÄªËæëÈÉΩÊòØÈÄöËøáËøô‰∏™ÂÆû‰æãÂÆåÊàêÁöÑ. Ê≥®ÂÜåÊñπÊ≥ïÔºö 1234567891011121314- (void)observe:(id)object info:(nullable _FBKVOInfo *)info&#123; if (nil == info) &#123; return; &#125; // register info pthread_mutex_lock(&amp;_mutex); [_infos addObject:info]; pthread_mutex_unlock(&amp;_mutex); // add observer [object addObserver:self forKeyPath:info-&gt;_keyPath options:info-&gt;_options context:(void *)info];&#125; ËøòÊòØËÉΩÊØîËæÉÂÆπÊòìÊÉ≥Âà∞Ëøô‰∏™ÊñπÊ≥ïÂÅö‰∫Ü‰ªÄ‰πàÁöÑ„ÄÇÊ≥®ÊÑèËøôÈáåÊää KVOInfo ÂÆû‰æã‰Ωú‰∏∫ context ‰º†‰∫ÜËøõÂéª„ÄÇ ÂõûË∞ÉÊñπÊ≥ïÔºö 1234567891011121314151617181920212223242526272829303132333435363738- (void)observeValueForKeyPath:(nullable NSString *)keyPath ofObject:(nullable id)object change:(nullable NSDictionary&lt;NSKeyValueChangeKey, id&gt; *)change context:(nullable void *)context&#123; _FBKVOInfo *info; &#123; pthread_mutex_lock(&amp;_mutex); /// ‰πãÂâç info = [_infos member:(__bridge id)context]; pthread_mutex_unlock(&amp;_mutex); &#125; if (nil != info) &#123; // take strong reference to controller FBKVOController *controller = info-&gt;_controller; if (nil != controller) &#123; // take strong reference to observer id observer = controller.observer; if (nil != observer) &#123; if (info-&gt;_block) &#123; NSDictionary&lt;NSKeyValueChangeKey, id&gt; *changeWithKeyPath = change; // add the keyPath to the change dictionary for clarity when mulitple keyPaths are being observed if (keyPath) &#123; /// Êää Keypath ‰πüÂä†ÂÖ•Âà∞‰∫ÜÂ≠óÂÖ∏‰∏≠Âéª„ÄÇ NSMutableDictionary&lt;NSString *, id&gt; *mChange = [NSMutableDictionary dictionaryWithObject:keyPath forKey:FBKVONotificationKeyPathKey]; [mChange addEntriesFromDictionary:change]; changeWithKeyPath = [mChange copy]; &#125; info-&gt;_block(observer, object, changeWithKeyPath); &#125; &#125; &#125; &#125;&#125; ‰πüÊòØÈ°∫Âà©ÊàêÁ´†ÁöÑÔºåÊé•Êî∂Âà∞ÂõûË∞É‰∫ã‰ª∂ÂêéÔºåÊâßË°å block ÈáåÈù¢ÁöÑÂÜÖÂÆπ„ÄÇÂàöÊâçÈÄöËøá context Êää KVOInfo ‰º†ÂÖ•ÔºåÁé∞Âú®ÂÜçÈÄöËøá contextÔºåÊää KVOInfo ÂèñÂá∫Êù•„ÄÇ(ËØ¥ÂÆûËØùÔºåËøôÈáåÁöÑÊìç‰ΩúÔºåÂåÖÊã¨‰∏ãÈù¢ÁöÑÂêÑÁßçÂà§Á©∫ÔºåÂÖ∂ÂÆûÊúâÁÇπÂ§ö‰Ωô„ÄÇÂõ†‰∏∫Êú¨Ë∫´Â§ñÈÉ®ÊòØÂº∫ÂºïÁî®ÁöÑÔºå‰∏ç‰ºöÂá∫Áé∞‰∏∫Á©∫ÁöÑÊÉÖÂÜµ) ÂèñÊ∂àÊ≥®ÂÜåÂèñÊ∂àÊ≥®ÂÜåÂú® KVOController ‰∏≠Â≠òÂú®‰∏âÁßçÊÉÖÂÜµÔºö ÂèñÊ∂àÊâÄÊúâÁöÑÁõëÂê¨ ÂèñÊ∂àÂÖ≥‰∫éÊüê‰∏Ä‰∏™ object ÁöÑÊâÄÊúâÁöÑÁõëÂê¨ ÂèñÊ∂àÊüê‰∏Ä‰∏™ object ÂÜÖÁöÑÊüê‰∏™ keypath ÁöÑÁõëÂê¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768// ÂØπÂ∫îÁ¨¨‰∏âÁßçÊÉÖÂÜµ- (void)_unobserve:(id)object info:(_FBKVOInfo *)info&#123; // lock pthread_mutex_lock(&amp;_lock); // get observation infos NSMutableSet *infos = [_objectInfosMap objectForKey:object]; // lookup registered info instance _FBKVOInfo *registeredInfo = [infos member:info]; if (nil != registeredInfo) &#123; [infos removeObject:registeredInfo]; // remove no longer used infos if (0 == infos.count) &#123; [_objectInfosMap removeObjectForKey:object]; &#125; &#125; // unlock pthread_mutex_unlock(&amp;_lock); // unobserve [[_FBKVOSharedController sharedController] unobserve:object info:registeredInfo];&#125;// ÂØπÂ∫îÁ¨¨‰∫åÁßçÊÉÖÂÜµ- (void)_unobserve:(id)object&#123; // lock pthread_mutex_lock(&amp;_lock); NSMutableSet *infos = [_objectInfosMap objectForKey:object]; // remove infos [_objectInfosMap removeObjectForKey:object]; // unlock pthread_mutex_unlock(&amp;_lock); // unobserve [[_FBKVOSharedController sharedController] unobserve:object infos:infos];&#125;// ÂØπÂ∫îÁ¨¨‰∏ÄÁßçÊÉÖÂÜµ- (void)_unobserveAll&#123; // lock pthread_mutex_lock(&amp;_lock); NSMapTable *objectInfoMaps = [_objectInfosMap copy]; // clear table and map [_objectInfosMap removeAllObjects]; // unlock pthread_mutex_unlock(&amp;_lock); _FBKVOSharedController *shareController = [_FBKVOSharedController sharedController]; for (id object in objectInfoMaps) &#123; // unobserve each registered object and infos NSSet *infos = [objectInfoMaps objectForKey:object]; [shareController unobserve:object infos:infos]; &#125;&#125; Ëøô‰∏âÁßçÊÉÖÂÜµ‰∏≠ÔºåÁ¨¨‰∏ÄÁßçÂà†Èô§ÊâÄÊúâ Object ÊòØÁ¨¨‰∫åÁßçÂà†Èô§Êüê‰∏Ä‰∏™ Object ÁöÑÁâπÊÆäÊÉÖÂÜµÔºåÁ¨¨‰∫åÁßçÂèàÊòØÁ¨¨‰∏ÄÁßçÂà†Èô§Êüê‰∏Ä‰∏™ Object ÁöÑÊüê‰∏™ keyPath ÁöÑÁâπÊÆäÊÉÖÂÜµ„ÄÇÊÄªÁöÑÊù•ËØ¥ÔºåÈÉΩÊòØÊìç‰Ωú _objectInfosMapÔºåÂ∞ÜÂº∫ÂºïÁî®ÁöÑÂØπË±°Âà†Èô§ÔºåÁÑ∂Âêé‰∫§Áªô KVOSharedController Êìç‰Ωú„ÄÇ Ëøô‰∏âÁßçÊÉÖÂÜµÊúÄÂêéÈÉΩÂΩíÁªìÂà∞ KVOSharedController ‰∏≠ÂéªÔºö 12345678910- (void)unobserve:(id)object info:(nullable _FBKVOInfo *)info &#123; if (nil == info) &#123; return; &#125; // unregister info pthread_mutex_lock(&amp;_mutex); [_infos removeObject:info]; pthread_mutex_unlock(&amp;_mutex); [object removeObserver:self forKeyPath:info-&gt;_keyPath context:(void *)info];&#125; dealloc Êó∂ÂÄôÁöÑËá™Âä®ÂèñÊ∂àÊ≥®ÂÜåÁî±‰∫éËßÇÂØüËÄÖÊääÊï¥‰∏™ËøáÁ®ã‰∫§Áªô‰∫Ü KVOControllerÔºåÊâÄ‰ª•Âú®ËßÇÂØüËÄÖÈîÄÊØÅÁöÑÊó∂ÂÄôÔºåKVOController ‰πü‰ºö‰∏ÄËµ∑ÊâßË°å dealloc ÊñπÊ≥ïÔºåÊù•Ê∏ÖÈô§ÊâÄÊúâÁöÑÁõëÂê¨„ÄÇ 12345- (void)dealloc&#123; [self unobserveAll]; pthread_mutex_destroy(&amp;_lock);&#125; ÊÄªÁªìÊï¥‰∏™Â∫ìÁöÑÊµÅÁ®ãÊòØÔºöKVOController ÊääËßÇÂØüÁöÑÂØπË±°‰Ωú‰∏∫ÂÖ∂ NSMapTable Â±ûÊÄß _objectInfomap ÁöÑÈîÆÔºåÊääÊï¥‰∏™ÂõûË∞ÉÁéØÂ¢ÉÁªÑÊàêÁöÑÂØπË±° KVOInfo ‰Ωú‰∏∫ÂÄº‰øùÂ≠òËµ∑Êù•„ÄÇÂêåÊó∂ÈÄöËøá‰∏Ä‰∏™Âçï‰æãÁöÑ KVOSharedController ÊâßË°åÂÖ∑‰ΩìÁöÑÊ≥®ÂÜå‰∫éÁõëÂê¨ÊñπÊ≥ï„ÄÇ Âú®ÊàëÁúãÊù•ÔºåÊú¨Ë∫´ KVOSharedController Ëøô‰∏™Âçï‰æãÂÖ∂ÂÆûÊòØÊ≤°ÊúâÂ§öÂ§ßÊÑè‰πâÁöÑÔºåÂú®ÊØè‰∏™ KVOController ‰∏≠ÂÖ∂ÂÆûÂ∞±ÂèØ‰ª•Â§ÑÁêÜËøô‰∫õÁõëÂê¨‰∏éÂõûË∞É‰∫Ü„ÄÇ‰∏çËøáËøô‰πàÂÜôÂèØËÉΩÊòØ‰∏∫‰∫ÜÊõ¥Â•ΩÁöÑËÅåË¥£ÂàÜÁ¶ªÂêß„ÄÇ ÊúÄÂêéËøòË¶ÅÂº∫Ë∞É‰∏ÄÁÇπÔºåÊàëËÆ§‰∏∫ KVO Ëá™Âä®ÂèñÊ∂àÁõëÂê¨ÁöÑÊ†∏ÂøÉÂú®‰∫éËÆ© KVOController ËøôÁ±ªÁöÑ‰∏≠Èó¥Á±ªÁöÑÁîüÂëΩÂë®ÊúüÂíåË¢´ÁõëÂê¨ÁöÑ object ÂêåÊ≠•ÔºåËÄå‰∏çÊòØÂíå Observer ÂêåÊ≠•„ÄÇÂõ†‰∏∫ÔºåÂè™ÊúâÂú®Ë¢´ÁõëÂê¨ÂØπË±°ÂõûÊî∂ÁöÑÊó∂ÂÄôÂèñÊ∂àÁõëÂê¨ÊâçËÉΩÁúüÊ≠£ÈÅøÂÖç crash ÁöÑÂç±Èô©„ÄÇ ‰∫ãÂÆû‰∏äÔºåÊàë‰ª¨‰∏ÄËà¨Âú® VC Âíå VM ‰∏≠ÂÅöÁõëÂê¨ÔºåÁõëÂê¨ÁöÑÂØπË±°ÊòØ VC ÊàñËÄÖ VM ÁöÑÂ±ûÊÄßÔºåËøôÁßçÂèòÁõ∏ÁöÑÊääËßÇÂØüËÄÖ Observer ÂíåË¢´ËßÇÂØüÂØπË±° object ÁöÑÁîüÂëΩÂë®ÊúüÂêåÊ≠•‰∫ÜÔºåÂõ†ËÄåÊää KVOController ‰Ωú‰∏∫ÁõëÂê¨ËÄÖÁöÑÂ±ûÊÄß‰πü‰∏ç‰ºöÊúâÈóÆÈ¢ò„ÄÇ‰ΩÜÊòØËøô‰ºöÈÄ†Êàê‰ΩøÁî®ËÄÖÁöÑËØØËß£„ÄÇ ÊâÄ‰ª•ÊàëËÆ§‰∏∫ KVOController ËøôÁßç‰∏Ä‰∏™ KVOController ÁõëÂê¨Â§ö‰∏™ÂØπË±°ÁöÑÂÅöÊ≥ïÂÖ∂ÂÆûÊòØÊúâÈóÆÈ¢òÁöÑÔºå‰πüÊòØ‰∏çÂ∫îËØ•Ë¢´ÈºìÂä±ÁöÑ„ÄÇÁúüÊ≠£Â∫îËØ•ÁöÑÊòØÂÉèÊàëÂõæ‰∏äÁîªÁöÑÔºåÁªôÊØè‰∏™Ë¢´ËßÇÂØüÁöÑÂØπË±°ÁªëÂÆö‰∏Ä‰∏™ KVOController ÂÆû‰æã„ÄÇ NSMapTableNSMapTable Áõ∏ÊØîËæÉ NSDictionary ÁöÑ‰ºòÂäøÊúâÔºö NSDictionary ÂøÖÈ°ªÊòØ key-obj ÁöÑÂΩ¢ÂºèÔºåkey ÂøÖÈ°ªÊòØÊª°Ë∂≥ NSCopying ÂçèËÆÆÁöÑÔºõNSMapTable ÂàôÊòØ obj-obj ÁöÑÂΩ¢Âºè NSDictionary ÁöÑ obj ÊòØÂº∫ÂºïÁî®ÔºõNSMapTable ÁöÑ key Âíå value ÈÉΩÂèØ‰ª•Ëá™Â∑±ÂÜ≥ÂÆöÊòØÂº∫ÂºïÁî®ËøòÊòØÂº±ÂºïÁî®„ÄÇÂ¶ÇÊûúÂº±ÂºïÁî®ÂõûÊî∂ÂêéÔºå‰ºöËá™Âä®Âà†Èô§„ÄÇ ÂàõÂª∫ÂàõÂª∫ NSMapTable ÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÊåáÂÆöÈîÆÂíåÂÄºÁöÑÈÄâÈ°πÔºö 1NSMapTable *keyToObjectMapping = [NSMapTable mapTableWithKeyOptions:NSMapTableCopyIn valueOptions:NSMapTableStrongMemory]; ‰∏äÈù¢ÂàõÂª∫ÁöÑ NSMapTable Â∞ÜÂíå NSDictionary ‰∏ÄÊ®°‰∏ÄÊ†∑ÔºåÂ§çÂà∂ keyÔºåÂπ∂ÂØπÂÆÉÁöÑ object ÂºïÁî®ËÆ°Êï∞ +1„ÄÇ NSMapTable ÁöÑÈÄâÈ°π NSMapTableStrongMemory (a ‚Äúmemory option‚Äù) NSMapTableWeakMemory (a ‚Äúmemory option‚Äù) NSMapTableObjectPointerPersonality (a ‚Äúpersonality option‚Äù) NSMapTableCopyIn (a ‚Äúcopy option‚Äù) ÂÖ∂‰∏≠Ââç‰∏§‰∏™ memory option Â∞±ÊòØÊéßÂà∂ÊòØÂØπ obj ËøõË°åÂº∫ÂºïÁî®ËøòÊòØÂº±ÂºïÁî®„ÄÇ personality option Âú®ÊàëÁöÑÁêÜËß£‰∏≠ÊòØÈíàÂØπ key ÁöÑÔºåÂÆÉÂÜ≥ÂÆöÊòØÂê¶‰ΩøÁî®ÂØπË±°ÁöÑÊåáÈíàÊù•ËøõË°å hash ÔºàNSDictionary ‰∏≠‰ΩøÁî® NSString Êù•ËøõË°å hashÔºåÂÜ≥ÂÆö object ÁöÑÂ≠òÂÇ®‰ΩçÁΩÆÔºâ„ÄÇÂ¶ÇÊûú‰∏çÊåáÂÆöËøô‰∏™ÈÄâÈ°πÔºåÈªòËÆ§ÊòØ‰ΩøÁî®Êï¥‰∏™ÂØπË±°ËøõË°å hashÔºåÈÇ£‰πàÂú®Â≠òÂÇ®ÁöÑËøáÁ®ã‰∏≠Ôºå‰Ωú‰∏∫ key ÁöÑËøô‰∏™ÂØπË±°ÊòØ‰∏çËÉΩË¢´ÊîπÂèòÁöÑÔºàÂØπË±°Âèò‰∫ÜÔºåhash ÂÄºÂèò‰∫ÜÔºåËá™ÁÑ∂Â∞±Êâæ‰∏çÂà∞ object ‰∫ÜÔºâ„ÄÇ copy option ÈÄâÈ°πË°®ÊòéÊòØÂê¶ÊâßË°åÂØπË±°ÁöÑ copy ÊñπÊ≥ïÔºåÊ∑±Êã∑Ë¥ù‰∏Ä‰∏™Êñ∞ÁöÑÂØπË±°ËøõË°åÂ≠òÂÇ®„ÄÇ NSArray Âíå NSPointerArray ÁöÑÂå∫Âà´NSPointerArray ÂèØ‰ª•‰øùÂ≠ò NULLÔºåÂõ†Ê≠§ÔºåNSPointerArray ‰∏≠ÁöÑÂØπË±°ÂèØ‰ª•ÊòØ weak ÁöÑÔºåÈîÄÊØÅÁõ¥Êé•Â∞ÜËØ•‰ΩçÁΩÆËÅå‰Ωç null NSHashTable Âíå NSSet Âå∫Âà´NSHashTable ÊòØÂèØÂèòÁöÑÔºå‰∏î NSHashTable ÂèØ‰ª•ÊîæÂº±ÂºïÁî®ÂØπË±° ÂèÇËÄÉÂ¶Ç‰Ωï‰ºòÈõÖÁöÑ‰ΩøÁî®KVO]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Ê∫êÁ†ÅËß£Êûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Effective Objective-C Â≠¶‰π†Á¨îËÆ∞]]></title>
    <url>%2F2016%2F11%2F11%2FEffective_oc2%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[ÊãúËØª‰∏Ä‰∏ã Effective Objective-C ËøôÊú¨‰π¶ÔºåÂÅö‰∏Ä‰∫õÁ¨îËÆ∞ ÁÜüÊÇâOCÁ¨¨1Êù°Ôºö‰∫ÜËß£Objective-CÁöÑËµ∑Ê∫êÂØπ‰∫éÊ∂àÊÅØÁªìÊûÑÁöÑËØ≠Ë®ÄÔºåËøêË°åÊó∂ÊâÄÊâßË°åÁöÑ‰ª£Á†ÅÁî±ËøêË°åÁéØÂ¢ÉÊù•ÂÜ≥ÂÆö,Âú®ËøêË°åÊó∂ÊâçÂõûÂéªÊü•ÊâæÁ¥¢Ë¶ÅÊâßË°åÁöÑÊñπÊ≥ï;ËÄå‰ΩøÁî®ÂáΩÊï∞Ë∞ÉÁî®ÁöÑËØ≠Ë®ÄÔºåÂàôÁî±ÁºñËØëÂô®ÂÜ≥ÂÆöÔºåÂè™ÊúâÂáΩÊï∞ÊòØÂ§öÊÄÅÁöÑÔºåÊâç‰ºöÂú®ËøêË°åÁöÑÊó∂ÂÄôÊåâÁÖß‚ÄúËôöÊñπÊ≥ïË°®‚ÄùÊü•Âá∫Âà∞Â∫ïÂ∫îËØ•ÊâßË°åÂì™‰∏™ÂáΩÊï∞„ÄÇ oc ÁöÑÂ∑•‰ΩúÁöÑÂÆûÁé∞ÂéüÁêÜÊòØÁî±ËøêË°åÊúüÁªÑ‰ª∂Ôºàruntime componentÔºâÂÆåÊàêÔºåËÄå‰∏çÊòØÁºñËØëÂô®„ÄÇ‰ΩøÁî® Objective-C ÁöÑÈù¢ÂêëÂØπË±°ÁâπÊÄßÊâÄÈúÄÁöÑÂÖ®ÈÉ®Êï∞ÊçÆÁªìÊûÑ‰ª•ÂèäÂáΩÊï∞ÈÉΩÂú®ËøêË°åÊúüÁªÑ‰ª∂ÈáåÈù¢„ÄÇ ËøêË°åÊúüÁªÑ‰ª∂Êú¨Ë¥®‰∏äÊòØ‰∏ÄÁßç‰∏éÂºÄÂèëËÄÖÊâÄÁºñÂÜôÁöÑ‰ª£Á†ÅÁõ∏ÈìæÊé•ÁöÑÂä®ÊÄÅÂ∫ìÔºàdynamic libraryÔºâÔºåÂÖ∂‰ª£Á†ÅËÉΩÊääÂºÄÂèëËÄÖÊâÄÁºñÂÜôÁöÑÊâÄÊúâÁ®ãÂ∫èÁ≤òÂêàËµ∑Êù•„ÄÇËøôÊ†∑ÁöÑËØùÔºåÂè™Ë¶ÅÊõ¥Êñ∞ËøêË°åÊúüÁªÑ‰ª∂ÔºåÂ∞±ÂèØ‰ª•ÊèêÂçáÁ®ãÂ∫èÊÄßËÉΩ„ÄÇËÄåÈÇ£ÁßçÂ∑•‰ΩúÈÉΩÂú® ‚ÄúÁºñËØëÊúü‚Äù ÂÆåÊàêÁöÑËØ≠Ë®ÄÔºåËã•ÊÉ≥Ëé∑ÂæóÁ±ª‰ººÁöÑÊÄßËÉΩÊèêÂçáÔºåÂ∞±Ë¶ÅÈáçÊñ∞ÁºñËØëÂ∫îÁî®Á®ãÂ∫è‰ª£Á†Å„ÄÇ Á¨¨2Êù°Ôºö Âú®Á±ªÁöÑÂ§¥Êñá‰ª∂‰∏≠Â∞ΩÈáèÂ∞ëÂºïÁî®ÂÖ∂‰ªñÂ§¥Êñá‰ª∂ÊúâÊó∂ÔºåÁ±ªAÈúÄË¶ÅÂ∞ÜÁ±ªBÁöÑÂÆû‰æãÂèòÈáè‰Ωú‰∏∫ÂÆÉÂÖ¨ÂÖ± API ÁöÑÂ±ûÊÄß„ÄÇËøô‰∏™Êó∂ÂÄôÔºåÊàë‰ª¨‰∏çÂ∫îËØ•ÂºïÂÖ•Á±ªBÁöÑÂ§¥Êñá‰ª∂ÔºåËÄåÂ∫îËØ•‰ΩøÁî®ÂêëÂâçÂ£∞ÊòéÔºàforward declaringÔºâ ‰ΩøÁî® @class ÂÖ≥ÈîÆÂ≠óÔºåÂπ∂‰∏îÂú® A ÁöÑÂÆûÁé∞Êñá‰ª∂ÂºïÁî® B ÁöÑÂ§¥Êñá‰ª∂„ÄÇ(ÁªßÊâøÊàñËÄÖÂçèËÆÆÂøÖÈ°ªÂºïÂÖ•ÂÆåÊï¥Â§¥Êñá‰ª∂Ôºå‰∏çËÉΩ‰ΩøÁî®ÂêëÂâçÂ£∞Êòé) 123456789101112131415// EOCPerson.h#import &lt;Foundation/Foundation.h&gt;@class EOCEmployer;@interface EOCPerson : NSObject@property (nonatomic, copy) NSString *firstName;@property (nonatomic, copy) NSString *lastName;@property (nonatomic, strong) EOCEmployer *employer;//Â∞ÜEOCEmployer‰Ωú‰∏∫Â±ûÊÄß@end// EOCPerson.m#import "EOCEmployer.h" ËøôÊ†∑ÂÅöÊúâ‰ªÄ‰πà‰ºòÁÇπÂë¢Ôºö ‰∏çÂú®AÁöÑÂ§¥Êñá‰ª∂‰∏≠ÂºïÂÖ•BÁöÑÂ§¥Êñá‰ª∂ÔºåÈÇ£‰πàAÁöÑÂÆûÁé∞Êñá‰ª∂ÂºïÂÖ•AÁöÑÂ§¥Êñá‰ª∂Êó∂ÔºåÂ∞±‰∏ç‰ºö‰∏ÄÂπ∂ÂºïÂÖ•BÁöÑÂÖ®ÈÉ®ÂÜÖÂÆπÔºåËøôÊ†∑Â∞±ÂáèÂ∞ë‰∫ÜÁºñËØëÊó∂Èó¥„ÄÇÂè™ÊúâÂú®AÁöÑÂÆûÁé∞ÈáåÈúÄË¶ÅÁî®Âà∞BÊó∂ÔºåÂÜçÂú®AÁöÑÂÆûÁé∞ÈáåÂºïÁî®BÁöÑÂ§¥Êñá‰ª∂„ÄÇ ‰ΩøÁî® #import ËÄå‰∏çÊòØ #include ÂèØ‰ª•ÈÅøÂÖçÊ≠ªÂæ™ÁéØÔºå‰ΩÜ‰ªç‰ºöÂØºËá¥Áõ∏‰∫íÂºïÁî®ÁöÑ‰∏§‰∏™Á±ª‰∏≠ÁöÑ‰∏ÄÂì•Êó†Ê≥ïÊ≠£Á°ÆÁºñËØë„ÄÇ‰ΩøÁî® @class ÂèØ‰ª•ÈÅøÂÖçÂæ™ÁéØÂºïÁî®ÔºöÂõ†‰∏∫Â¶ÇÊûú‰∏§‰∏™Á±ªÂú®Ëá™Â∑±ÁöÑÂ§¥Êñá‰ª∂‰∏≠ÈÉΩÂºïÂÖ•‰∫ÜÂØπÊñπÁöÑÂ§¥Êñá‰ª∂ÔºåÈÇ£‰πàÂ∞±‰ºöÂØºËá¥ÂÖ∂‰∏≠‰∏Ä‰∏™Á±ªÊó†Ê≥ïË¢´Ê≠£Á°ÆÁºñËØë„ÄÇ Á¨¨3Êù°ÔºöÂ§öÁî®Â≠óÈù¢ÈáèËØ≠Ê≥ïÔºåÂ∞ëÁî®‰∏é‰πãÁ≠â‰ª∑ÁöÑÊñπÊ≥ïÂ£∞ÊòéÊó∂Â§öÁî®Â≠óÈù¢ÈáèÔºö 1234567NSNumber *intNumber = @1;NSNumber *floatNumber = @2.5f;NSArray *animals =@[@"cat", @"dog",@"mouse", @"badger"];Dictionary *dict = @&#123;@"animal":@"tiger",@"phone":@"iPhone 6"&#125;;NSString *cat = animals[0];NSString *iphone = dict[@"phone"]; Â∞ëÁî® alloc„ÄÅinit ÁöÑÊñπÂºèÂàõÂª∫Ôºå‰ª•Âèä objectAtIndex„ÄÅobjectForKey ÁöÑÊñπÂºèÂèñÊï∞ÁªÑÂ≠óÂÖ∏„ÄÇ ‰ºòÁÇπÔºö ÁÆÄÊ¥Å NSArray ‰ª• nil ÁªìÂ∞æÔºåÊâÄ‰ª•‰∏ÄËà¨‰∏çÂÖÅËÆ∏Êï∞ÁªÑ‰∏≠ÁöÑÂÖÉÁ¥†‰∏∫ nilÔºåÂ¶ÇÊûú‰ΩøÁî®Á≠â‰ª∑ÊñπÊ≥ïÔºåÈÇ£‰πàÊï∞ÁªÑÂÖÉÁ¥†‰∏∫ nil ‰∏çÊä•ÈîôÔºå‰ºöÂá∫Áé∞Èöæ‰ª•ÊéíÊü•ÁöÑÈîôËØØÔºõËÄåÂêåÊ†∑ÁöÑÊÉÖÂÜµÔºåÂ≠óÈù¢ÈáèËØ≠Ê≥ï‰ºöÊäõÂá∫ÂºÇÂ∏∏„ÄÇ Á¨¨4Êù°ÔºöÂ§öÁî®Á±ªÂûãÂ∏∏ÈáèÔºåÂ∞ëÁî®#defineÈ¢ÑÂ§ÑÁêÜÂëΩ‰ª§È¢ÑÂ§ÑÁêÜ‰∏éÁ±ªÂûãÂ∏∏ÈáèÁöÑ‰ºòÁº∫ÁÇπÔºö È¢ÑÂ§ÑÁêÜÂëΩ‰ª§ÔºöÁÆÄÂçïÁöÑÊñáÊú¨ÊõøÊç¢Ôºå‰∏çÂåÖÊã¨Á±ªÂûã‰ø°ÊÅØÔºåÂπ∂‰∏îÂèØË¢´‰ªªÊÑè‰øÆÊîπ„ÄÇ Á±ªÂûãÂ∏∏ÈáèÔºöÂåÖÊã¨Á±ªÂûã‰ø°ÊÅØÔºåÂπ∂‰∏îÂèØ‰ª•ËÆæÁΩÆÂÖ∂‰ΩøÁî®ËåÉÂõ¥ÔºåËÄå‰∏î‰∏çÂèØË¢´‰øÆÊîπ„ÄÇ È¢ÑÂ§ÑÁêÜÂëΩ‰ª§1#define W_LABEL (W_SCREEN - 2*GAP) ËøôÈáåÔºå(W_SCREEN - 2*GAP) ÊõøÊç¢‰∫Ü W_LABELÔºåÂÆÉ‰∏çÂÖ∑Â§á W_LABEL ÁöÑÁ±ªÂûã‰ø°ÊÅØ„ÄÇËÄå‰∏îË¶ÅÊ≥®ÊÑè‰∏Ä‰∏ãÔºöÂ¶ÇÊûúÊõøÊç¢Âºè‰∏≠Â≠òÂú®ËøêÁÆóÁ¨¶Âè∑Ôºå‰ª•Á¨îËÄÖÁöÑÁªèÈ™åÊúÄÂ•ΩÁî®Êã¨Âè∑Êã¨Ëµ∑Êù•Ôºå‰∏çÁÑ∂ÂÆπÊòìÂá∫Áé∞ÈîôËØØÔºàÊúâ‰Ωì‰ºöÔºâ„ÄÇ Á±ªÂûãÂ∏∏Èáè1static const NSTimeIntervalDuration = 0.3; const Â∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫Â∏∏ÈáèÔºå‰∏çÂèØÊõ¥Êîπ„ÄÇstatic ÊÑèÂë≥ÁùÄËØ•ÂèòÈáè‰ªÖ‰ªÖÂú®ÂÆö‰πâÊ≠§ÂèòÈáèÁöÑÁºñËØëÂçïÂÖÉ(.m ÂÆûÁé∞Êñá‰ª∂)‰∏≠ÂèØËßÅ„ÄÇÂ¶ÇÊûú‰∏çÂ£∞Êòé static,ÁºñËØëÂô®‰ºö‰∏∫ÂÆÉÂàõÂª∫‰∏Ä‰∏™Â§ñÈÉ®Á¨¶Âè∑Ôºàexternal symbolÔºâ„ÄÇ‰ºöÂá∫Áé∞‰ªÄ‰πàÈóÆÈ¢òÂë¢ÔºüÂ¶ÇÊûúÂú®ÂÖ∂‰ªñÁ±ª‰∏≠‰πüÂ£∞Êòé‰∫ÜÂêåÂêçÂèòÈáèÔºåÂç≥‰ΩøÊ≤°ÊúâÁõ∏‰∫íÂºïÁî®ÔºåÁºñËØëÂô®‰πü‰ºöÊäõÂá∫‰∏Ä‰∏™ÂºÇÂ∏∏„ÄÇ ÂÖ®Â±ÄÂ∏∏ÈáèÂ¶ÇÊûúÊàë‰ª¨ÈúÄË¶ÅÂèëÈÄÅÈÄöÁü•ÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÂú®‰∏çÂêåÁöÑÂú∞ÊñπÊãøÂà∞ÈÄöÁü•ÁöÑ‚ÄúÈ¢ëÈÅì‚ÄùÂ≠óÁ¨¶‰∏≤ÔºåÈÇ£‰πàÊòæÁÑ∂Ëøô‰∏™Â≠óÁ¨¶‰∏≤ÊòØ‰∏çËÉΩË¢´ËΩªÊòìÊõ¥ÊîπÔºåËÄå‰∏îÂèØ‰ª•Âú®‰∏çÂêåÁöÑÂú∞ÊñπËé∑Âèñ„ÄÇËøô‰∏™Êó∂ÂÄôÂ∞±ÈúÄË¶ÅÂÆö‰πâ‰∏Ä‰∏™Â§ñÁïåÂèØËßÅÁöÑÂ≠óÁ¨¶‰∏≤Â∏∏ÈáèÔºåÂç≥ÂÖ®Â±ÄÂ∏∏Èáè„ÄÇÂú®Â§¥Êñá‰ª∂‰∏≠Â£∞ÊòéÂ§ñÈÉ®Â∏∏ÈáèÔºåÂú®ÂÆûÁé∞Êñá‰ª∂‰∏≠ÂÆåÊàêÂèòÈáèÁöÑËµãÂÄº„ÄÇ 12345//header fileextern NSString *const NotificationString;//implementation fileNSString *const NotificationString = @"Finish Download"; Ê≥®ÊÑèËøôÈáåÁöÑ const, Â¶ÇÊûúÂú® * ÂâçÈù¢ÔºåË°®Á§∫ÊåáÈíàÊåáÂêëÁöÑÂ†Ü‰∏äÁöÑÂÜÖÂÆπ‰∏çËÉΩÊîπÂèòÔºåÂ¶ÇÊûúÂú® * ÂêéÈù¢ÔºåË°®Á§∫ÊåáÈíàÊåáÂêëÁöÑÂú∞ÂùÄÊòØ‰∏çËÉΩÊîπÂèòÁöÑ„ÄÇÔºàËøôÈáåÊúâ‰∏™Âä©ËÆ∞ÊñπÊ≥ïÔºå‰ª• * ‰∏∫ÂàÜËß£Ôºåconst Âú®Â∑¶ËæπÂ∞±ÊòØ‰øÆÈ•∞ * NotificationStringÔºåË°®Á§∫‰∏çËÉΩ‰øÆÊîπÂÄºÔºåÂú®Âè≥ËæπÂ∞±Ë°®Á§∫‰øÆÈ•∞ NotificationString ÊåáÈíàÂØπË±°ÔºåË°®Á§∫‰∏çËÉΩ‰øÆÊîπÊåáÈíàÊåáÂêëÁöÑÂú∞ÂùÄ„ÄÇÔºâ ‰∏çË¶ÅÁî®È¢ÑÂ§ÑÁêÜÊåá‰ª§ÂÆö‰πâÂ∏∏Èáè„ÄÇËøôÊ†∑ÂÆö‰πâÂá∫Êù•ÁöÑÂ∏∏Èáè‰∏çÂê´Á±ªÂûã‰ø°ÊÅØÔºåÁºñËØëÂô®Âè™‰ºöÂú®ÁôæÂπ¥‰ª•ÂâçÊâßË°åÊü•ÊâæÂíåÊõøÊç¢Êìç‰Ωú„ÄÇÂç≥‰ΩøÊúâ‰∫∫ÈáçÊñ∞ÂÆö‰πâ‰∫ÜÂ∏∏ÈáèÂÄºÔºåÁºñËØëÂô®‰πü‰∏ç‰ºö‰∫ßÁîüË≠¶Âëä‰ø°ÊÅØÔºåËøôÂõûÂØºËá¥Â∫îÁî®Á®ãÂ∫è‰∏≠ÁöÑÂ∏∏ÈáèÂÄº‰∏ç‰∏ÄËá¥„ÄÇ Á¨¨5Êù°ÔºöÁî®Êûö‰∏æË°®Á§∫Áä∂ÊÄÅÔºåÈÄâÈ°πÔºåÁä∂ÊÄÅÁ†ÅÊàë‰ª¨ÁªèÂ∏∏ÈúÄË¶ÅÁªôÁ±ªÂÆö‰πâÂá†‰∏™Áä∂ÊÄÅÔºåËøô‰∫õÁä∂ÊÄÅÁ†ÅÂèØ‰ª•Áî®Êûö‰∏æÊù•ÁÆ°ÁêÜÔºö 123456789101112typedef NS_ENUM(NSUInteger, EOCConnectionState) &#123; EOCConnectionStateDisconnected, EOCConnectionStateConnecting, EOCConnectionStateConnected,&#125;;typedef NS_OPTION(NSUInteger, EOCPermittedDirection) &#123; EOCPermittedDirectionUp = 1 &lt;&lt; 0, EOCPermittedDirectionDown = 1 &lt;&lt; 1, EOCPermittedDirectionLeft = 1 &lt;&lt; 2, EOCPermittedDirectionRight = 1 &lt;&lt; 3&#125; NS_ENUM Âíå NS_OPTION ÊòØ Foundation Ê°ÜÊû∂‰∏≠ÂÆö‰πâÁöÑËæÖÂä©ÂÆè„ÄÇÈúÄË¶ÅÊ≥®ÊÑèËøô‰∏§ËÄÖ‰ΩøÁî®Âú∫ÊôØÁöÑ‰∏çÂêå„ÄÇ Ëøô‰∏§ËÄÖÁöÑÂ∑ÆÂà´Âú®‰∫é‰∏Ä‰∏™‰ΩçÁßªÊûö‰∏æÂç≥ÊòØÂú®‰Ω†ÈúÄË¶ÅÁöÑÂú∞ÊñπÂèØ‰ª•ÂêåÊó∂Â≠òÂú®Â§ö‰∏™Êûö‰∏æÂÄº„ÄÇËÄåNS_ENUMÂÆö‰πâÁöÑÊûö‰∏æ‰∏çËÉΩÂá†‰∏™Êûö‰∏æÈ°πÂêåÊó∂Â≠òÂú®ÔºåÂè™ËÉΩÈÄâÊã©ÂÖ∂‰∏≠‰∏ÄÈ°π„ÄÇ Âú®Êûö‰∏æÁ±ªÂûãÁöÑ switch ËØ≠Âè•‰∏≠‰∏çË¶ÅÂÆûÁé∞ default ÂàÜÊîØ„ÄÇÂÆÉÁöÑÂ•ΩÂ§ÑÊòØÔºåÂΩìÊàë‰ª¨ÁªôÊûö‰∏æÂ¢ûÂä†ÊàêÂëòÊó∂ÔºåÁºñËØëÂô®Â∞±‰ºöÊèêÁ§∫ÂºÄÂèëËÄÖÔºöswitch ËØ≠Âè•Âπ∂Êú™Â§ÑÁêÜÊâÄÊúâÁöÑÊûö‰∏æ„ÄÇÂê¶ÂàôÊ∑ªÂä†‰∫ÜÊûö‰∏æÂç¥Ê≤°ÊúâÂÆûÁé∞ switch Â∞ÜÂèØËÉΩÂØºËá¥‰∏•ÈáçÁöÑÂ¥©Ê∫É„ÄÇ Ê≥®ÊÑèÔºåswitch ÁöÑ case‰∏≠Â¶ÇÊûúÂ£∞Êòé‰∫ÜÂèòÈáèÔºåÂøÖÈ°ªË¶ÅÁî®{}ÂåÖ‰ΩèÔºåËøôÊòØÁºñËØëÂô®Âº∫Âà∂ÁöÑÔºå‰∏çÁÑ∂‰ºöÊä•ÈîôÔºå‰æãÂ≠êÔºö 1234567891011121314- (void)startAnimationInitialWithType:(NSInteger)type&#123; switch (type) &#123; case BaseAnimation:&#123; CALayer *myLayer=[CALayer layer]; //Ê∑ªÂä†layer [self.view.layer addSublayer:myLayer]; self.myLayer=myLayer; &#125; break; default: break; &#125;&#125; ÂØπË±°„ÄÅÊ∂àÊÅØ„ÄÅËøêË°åÊúüÁ¨¨6Êù°ÔºöÁêÜËß£‚ÄúÂ±ûÊÄß‚ÄùËøô‰∏ÄÊ¶ÇÂøµÂ±ûÊÄßÂú® Java ‰ª•Âèä C++ ‰∏≠ÔºåÂØπË±°Â∏ÉÂ±ÄÂú®ÁºñËØëÊúüÂ∞±Â∑≤ÁªèÂõ∫ÂÆö‰∫Ü„ÄÇÂè™Ë¶ÅËÆøÈóÆÂèòÈáèÁöÑ‰ª£Á†ÅÔºåÁºñËØëÂô®Â∞±‰ºöÊääÂÖ∂ÊõøÊç¢Êàê‰∏∫‚ÄúÂÅèÁßªÈáè‚Äù„ÄÇËøô‰∏™ÂÅèÁßªÈáèÊòØÁ°¨ÁºñÁ†ÅÔºàhardcodeÔºâÔºåË°®Á§∫ËØ•ÂØπË±°Ë∑ùÁ¶ªÂ≠òÊîæÂØπË±°ÁöÑÂÜÖÂ≠òÂå∫ÂüüÁöÑËµ∑ÂßãÂú∞ÂùÄÊúâÂ§öËøú„ÄÇËøôÊ†∑ÂÅöÁöÑÈóÆÈ¢òÊòØÔºåÂ¶ÇÊûúÂÜçÊ∑ªÂä†‰∏Ä‰∏™ÂÆû‰æãÂèòÈáèÔºåÈÇ£‰πàÂÖ∂‰ªñÂÆû‰æãÂèòÈáèÁöÑÂ∞±Ë¶ÅÂèòÂåñ‰∫ÜÔºåÈÇ£‰πàÂ∞±Ë¶ÅÈáçÊñ∞ÁºñËØëÔºåÂê¶ÂàôÂ∞±‰ºöÂá∫Èîô„ÄÇ Objective-C ÁöÑÂÅöÊ≥ïÊòØÔºåÊääÂÆû‰æãÂèòÈáèÂΩìÂÅö‰∏ÄÁßçÂ≠òÂÇ®ÂÅèÁßªÈáèÊâÄÁî®ÁöÑ‚ÄúÁâπÊÆäÂèòÈáè‚ÄùÔºàspecial variableÔºâÔºå‰∫§Áî±‚ÄúÁ±ªÂØπË±°‚ÄùÔºàclass objectÔºâ‰øùÁÆ°„ÄÇÂÅèÁßªÈáè‰ºöÂú®ËøêË°åÊúüÊü•ÊâæÔºåÈÇ£‰πàÁ±ªÁöÑÂÆö‰πâÂèò‰∫ÜÔºåÂ≠òÂÇ®ÁöÑÂÅèÁßªÈáè‰πüÂ∞±Âèò‰∫ÜÔºåËøôÊ†∑ÁöÑËØùÔºåÊó†ËÆ∫‰ΩïÊó∂ËÆøÈóÆÂÆû‰æãÂèòÈáèÔºåÊÄªËÉΩ‰ΩøÁî®Ê≠£Á°ÆÁöÑÂÅèÁßªÈáè„ÄÇÁîöËá≥ÂèØ‰ª•Âú®ËøêË°åÊúüÂêëÁ±ª‰∏≠Êñ∞Â¢ûÂÆû‰æãÂèòÈáèÔºåËøôÂ∞±ÊòØÁ®≥Âõ∫ÁöÑ ‚ÄúÂ∫îÁî®Á®ãÂ∫è‰∫åËøõÂà∂Êé•Âè£(ABI)‚Äù„ÄÇABI ÂÆö‰πâ‰∫ÜËÆ∏Â§öÂÜÖÂÆπÔºåÂÖ∂‰∏≠‰∏ÄÈ°πÂ∞±ÊòØÁîüÊàê‰ª£Á†ÅÊó∂ÊâÄÂ∫îÈÅµÂæ™ÁöÑËßÑËåÉ(Ëøô‰πüÂ∞±ÊòØ swift ÊâÄÊ≤°ÊúâÁöÑ‰∏úË•ø)„ÄÇ Â≠òÂèñÊñπÊ≥ïÂú®ËÆæÁΩÆÂÆåÂ±ûÊÄßÂêéÔºåÁºñËØëÂô®‰ºöËá™Âä®ÂêëÁ±ª‰∏≠Ê∑ªÂä†ÈÄÇÂΩìÁ±ªÂûãÁöÑÂÆû‰æãÂèòÈáèÔºåÂπ∂‰∏î‰∏∫ÂÖ∂ÂÜôÂá∫‰∏ÄÂ•óÂ≠òÂèñÊñπÊ≥ï„ÄÇ‰∏ÄËà¨‰ºöÂú®Â±ûÊÄßÂêçÂâçÂä†‰∏Ä‰∏™‰∏ãÂàíÁ∫ø‰Ωú‰∏∫ÂÆû‰æãÂèòÈáèÂêç„ÄÇ Â¶ÇÊûú‰∏çÊÉ≥‰ª§ÁºñËæëÂô®Ëá™Âä®ÂêàÊàêÂ≠òÂèñÊñπÊ≥ïÔºåÂèØ‰ª•Ëá™Â∑±ÂÆûÁé∞Ôºå‰πüÂèØ‰ª•‰ΩøÁî® @dynamic ÂÖ≥ÈîÆÂ≠ó„ÄÇÂÆÉ‰ºöÂëäËØâÁºñËØëÂô®‰∏çË¶ÅËá™Âä®ÂàõÂª∫ÂÆûÁé∞Â±ûÊÄßÊâÄÁî®ÁöÑÂÆû‰æãÂèòÈáèÔºå‰πü‰∏çË¶Å‰∏∫ÂÖ∂ÂàõÂª∫Â≠òÂèñÊñπÊ≥ïÔºåÈúÄË¶ÅËá™Â∑±ÂÆûÁé∞Â≠òÂèñÊñπÊ≥ï„ÄÇËÄå‰∏îÔºåÂú®ÁºñËØëËÆøÈóÆÂ±ûÊÄßÁöÑ‰ª£Á†ÅÊó∂ÔºåÂç≥‰ΩøÁºñËØëÂô®ÂèëÁé∞Ê≤°ÊúâÂÆö‰πâÂ≠òÂèñÊñπÊ≥ïÔºå‰πü‰∏ç‰ºöÊä•ÈîôÔºåÂÆÉÁõ∏‰ø°Ëøô‰∫õÊñπÊ≥ïËÉΩÂú®ËøêË°åÊúüÊâæÂà∞„ÄÇ ËÆøÈóÆÂ±ûÊÄßÔºåÂèØ‰ª•‰ΩøÁî®ÁÇπËØ≠Ê≥ïÔºåÁºñËØëÂô®‰ºöÊääÁÇπËØ≠Ê≥ïËΩ¨Êç¢‰∏∫ÂØπÂ≠òÂèñÊñπÊ≥ïÁöÑË∞ÉÁî®Ôºõ‰πüÂèØÁõ¥Êé•‰ΩøÁî®ÂÆû‰æãÂèòÈáèÔºå‰ΩøÁî®ÂÆû‰æãÂèòÈáèÁöÑÊñπÂºèÊõ¥Âø´„ÄÇ 1234//Â≠òÂèñÊñπÊ≥ïËÆæÁΩÆÂ±ûÊÄßself.firstName = @"Zachary";//ÂÆû‰æãÂèòÈáèËÆæÁΩÆÂ±ûÊÄß_firstName = @"Zachary"; @synthesize ‰∏é @dynamic@dynamic ÊòØÁõ∏ÂØπ‰∫é @synthesize ÁöÑÔºåÂÆÉ‰ª¨ÂêåÊ†∑Áî®‰∫é‰øÆÈ•∞ @property„ÄÇ @property Áî®‰∫éÂ£∞ÊòéÂ±ûÊÄßÁöÑ get/set ÊñπÊ≥ï„ÄÇËÄå @synthesize ÂàôÂèØ‰ª•Áî®Êù•ÂàõÂª∫ÂÆû‰æãÂèòÈáèÔºåÂπ∂‰∏îÂÆûÁé∞Â±ûÊÄßÁöÑ get/set ÊñπÊ≥ï„ÄÇ‰ΩøÁî®Â¶Ç‰∏ãÔºö 1234567891011//.h@interface CYLPerson : NSObject @property NSString *firstName; @property NSString *lastName; @end //.m@implementation CYLPerson @synthesize firstName = _myFirstName; @synthesize lastName = _myLastName; @end @property Â∞Ü‰ºöËá™Âä®ÂêàÊàê setFirstName: Âíå firstName,setLastName,lastName ËøôÂá†‰∏™ÊñπÊ≥ïÁöÑÂ£∞Êòé„ÄÇ@synthesize ‰∏∫ @property ÁîüÊàê‰∏§‰∏™ÂÆû‰æãÂèòÈáèÔºåÂêç‰∏∫ _myFirstName ‰∏é _myLastName ÔºåÂπ∂‰∏îÂú®‰Ω†Ê≤°ÊúâÂÆûÁé∞ get/set ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÈªòËÆ§ÂÆûÁé∞‰∫ÜËøô‰∏§‰∏™ÂèòÈáèÁöÑ get/set ÊñπÊ≥ïÔºö 1234567- (NSString *)getFirstName() &#123; return _firstName;&#125;- (void)firstName:(NSString *)firstName &#123; _firstName = firstName;&#125;// lastName Á±ª‰ºº Â¶ÇÊûúÊòØ @synthesize foo;ÔºåÁ≠âÊïà‰∫é @synthesize foo = fooÔºåÁõ∏ÂΩì‰∫éÁîüÊàêÂêç‰∏∫ foo ÁöÑÂÆû‰æãÂèòÈáèÔºåÁîüÊàêÁöÑ get/set ÊñπÊ≥ïÈáå‰ΩøÁî®Âà∞ÁöÑÂÆû‰æãÂèòÈáè‰πüÁõ∏Â∫îÊîπÂèò„ÄÇ ‰∏äËø∞ËØ≠Ê≥ïÊòØ Xcode 6 ÂâçÁöÑ‰ΩøÁî®ÊñπÂºè„ÄÇÂú®ÈÇ£‰πãÂêéÔºåXcode ‰ºöÈªòËÆ§Ê∑ªÂä† @synthesize foo = _foo; ÁöÑËØ≠Âè•„ÄÇ‰πüÂ∞±ÊòØËØ¥ÈªòËÆ§ÊÉÖÂÜµÊòØ‰ºöÂ∏Æ‰Ω†ÁîüÊàê get/set ÊñπÊ≥ï‰ª•ÂèäÂÆû‰æãÂèòÈáèÁöÑ„ÄÇ‰ΩÜÊòØÊúâ‰∏ÄÁßçÊÉÖÂÜµ@synthesize ‰∏ç‰ºöËá™Âä®Ê∑ªÂä†ÔºåÈÇ£Â∞±ÊòØÂ¶ÇÊûúËá™Â∑±ÂêåÊó∂ÂÆûÁé∞‰∫Ü get/set ÊñπÊ≥ïÁöÑÊó∂ÂÄô„ÄÇÂõ†‰∏∫Ëá™Â∑±ÂÆûÁé∞‰∫ÜÂ≠òÂèñÊñπÊ≥ïÂ∞±ËøùËÉå‰∫Ü @synthesize Ëá™Âä®ÂêàÊàêÁöÑÂàùË°∑„ÄÇÊâÄ‰ª•Ëøô‰∏™Êó∂ÂÄôÔºå‰Ω†ÈúÄË¶ÅËá™Â∑±Ê∑ªÂä†ÂÆû‰æãÂèòÈáèÔºåÊàñËÄÖÊâãÂä®Ê∑ªÂä† @synthesize foo = _foo; @dynamic ÁöÑ‰ΩøÁî®ÊñπÂºèÂΩ¢Â¶Ç @dynamic foo;ÔºåÂÆÉÂíå @synthesize Ê≠£Â•ΩÁõ∏ÂèçÔºåÂÆÉÂëäËØâÁºñËØëÂô®Ôºå‰∏çËá™Âä®ÁîüÊàêgetter/setterÊñπÊ≥ïÔºåÁÑ∂ÂêéÁî±Ëá™Â∑±ÂÆûÁé∞Â≠òÂèñÊñπÊ≥ïÊàñÂú®ËøêË°åÊó∂Âä®ÊÄÅÁªëÂÆö„ÄÇ‰πüÂ∞±ÊòØËØ¥ @dynamic Â≠òÂú®Â∞±‰∏ç‰ºöËá™Âä®ÊèíÂÖ• @synthesizeÔºå‰πüÂ∞±‰∏ç‰ºöËá™Âä®ÁîüÊàêÂÆû‰æãÂèòÈáè _foo„ÄÇ Â±ûÁõ∏ÁâπË¥®ÂéüÂ≠êÊÄßÔºö nonatomicÔºö‰∏ç‰ΩøÁî®ÂêåÊ≠•ÈîÅ atomicÔºöÂä†ÂêåÊ≠•ÈîÅÔºåÁ°Æ‰øùÂÖ∂ÂéüÂ≠êÊÄß ËØªÂÜô: readwrite:ÂêåÊó∂Â≠òÂú®Â≠òÂèñÊñπÊ≥ï readonly:Âè™ÊúâËé∑ÂèñÊñπÊ≥ï ÂÜÖÂ≠òÁÆ°ÁêÜ: assign:Á∫ØÈáèÁ±ªÂûã(scalar type)ÁöÑÁÆÄÂçïËµãÂÄºÊìç‰Ωú strong:Êã•ÊúâÂÖ≥Á≥ª‰øùÁïôÊñ∞ÂÄºÔºåÈáäÊîæÊóßÂÄºÔºåÂÜçËÆæÁΩÆÊñ∞ÂÄº weak:ÈùûÊã•ÊúâÂÖ≥Á≥ª(nonowning relationship)ÔºåÂ±ûÊÄßÊâÄÊåáÁöÑÂØπË±°ÈÅ≠Âà∞ÊëßÊØÅÊó∂ÔºåÂ±ûÊÄß‰πü‰ºöÊ∏ÖÁ©∫ copyÔºöÂΩìËµãÁªôÂÖ∂ÂèØÂèòÂØπË±°ÔºåËøîÂõû‰∏çÂèØÂèòÂØπË±°ÔºõÂΩìËµãÁªôÂÖ∂‰∏çÂèØÂèòÂØπË±°ÔºåËøîÂõûÂéüÂØπË±°„ÄÇ ÂùóË¶ÅÁî® copy ÊúÄÂ•Ω‰∏çË¶ÅÁî® strong„ÄÇ ÂèØËÉΩÂá∫Áé∞ÁöÑ retain ÂÖ≥ÈîÆÂ≠ó‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÁ≠âÂêå‰∫é strong weakÁöÑÂÆûÁé∞ËøôÈáåÊèí‰∏ÄÊù° weak ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑ„ÄÇ‰∏ÄËà¨ÂÜÖÂ≠òÊòØÈÄöËøá ARC ÁÆ°ÁêÜÁöÑ„ÄÇ‰ΩøÁî® weak ‰∏çÂ¢ûÂä†ÂØπË±°ÁöÑÂºïÁî®Ê¨°Êï∞„ÄÇÂΩìÊ†à‰∏≠ÁöÑÂèòÈáè‰∏çÊåáÂêëÂ†Ü‰∏≠ÁöÑÂØπË±°Êó∂ÔºåÂ†Ü‰∏≠ÂØπË±°ÈîÄÊØÅ„ÄÇËøô‰∏™Êó∂ÂÄôË¶ÅÊää weak ÊåáÂêëÁöÑÂú∞ÂùÄÁΩÆ‰∏∫ nilÔºåÂõ†‰∏∫Â¶ÇÊûú‰∏çËøô‰πàÂÅöÔºåÈÇ£‰πàÂ∞±‰ºö‰∫ßÁîüÈáéÊåáÈíà„ÄÇÈÇ£‰πàËøôÊòØÂ¶Ç‰ΩïÂÅöÂà∞ÁöÑÔºü ÂÜÖÂ≠ò‰∏≠Â≠òÂú®‰∏ÄÁßçÊï∞ÊçÆÁªìÊûÑËÉ∂ SideTableÔºåÂÆÉÊÄªÂÖ±Êúâ64‰∏™„ÄÇÂÆÉÂÜÖÈÉ®ÂåÖÂê´ÂØπË±°ÁöÑÂºïÁî®ËÆ°Êï∞Ë°®ÔºåÂíå weak Ë°®„ÄÇÂºïÁî®ËÆ°Êï∞Ë°®ÈîÆÊòØÂØπË±°ÁöÑÂú∞ÂùÄÔºåÂÄºÊòØÂºïÁî®ËÆ°Êï∞Êï∞Èáè„ÄÇÂΩìÂºïÁî®ËÆ°Êï∞‰∏∫0ÁöÑÊó∂ÂÄôÂ∞±ÊääÂØπË±°ÈáäÊîæ„ÄÇ weak Ë°®ÈîÆÊòØÂØπË±°ÁöÑÂú∞ÂùÄÔºåÂÄºÊòØÂº±ÂºïÁî®ÂØπË±°ÁöÑÊåáÈíàÊï∞ÁªÑ„ÄÇÂ¶ÇÊûúÂØπË±°ÈáäÊîæ‰∫ÜÔºåÂ∞±Ë¶ÅÈÅçÂéÜÊåáÈíàÊï∞ÁªÑÊääÊâÄÊúâÁöÑÊåáÈíàÁΩÆ‰∏∫ nil„ÄÇ Á¨¨7Êù°Ôºö Âú®ÂØπË±°ÂÜÖÈÉ®Â∞ΩÈáèÁõ¥Êé•ËÆøÈóÆÂÆû‰æãÂèòÈáèÂÖ≥‰∫éÂÆû‰æãÂèòÈáèÁöÑËÆøÈóÆÔºåÂèØ‰ª•Áõ¥Êé•ËÆøÈóÆ _firstNameÔºå‰πüÂèØ‰ª•ÈÄöËøáÂ±ûÊÄßÁöÑÊñπÂºè(ÁÇπËØ≠Ê≥ï) self.firstName Êù•ËÆøÈóÆ„ÄÇ‰π¶‰∏≠‰ΩúËÄÖÂª∫ËÆÆÂú®ËØªÂèñÂÆû‰æãÂèòÈáèÊó∂ÈááÁî®Áõ¥Êé•ËÆøÈóÆÁöÑÂΩ¢ÂºèÔºåËÄåÂú®ËÆæÁΩÆÂÆû‰æãÂèòÈáèÁöÑÊó∂ÂÄôÈÄöËøáÂ±ûÊÄßÊù•ÂÅö„ÄÇÔºàËøôÈÉ®ÂàÜÊØîËæÉÈáçË¶ÅÔºâ Áõ¥Êé•ËÆøÈóÆÂÆû‰æãÂèòÈáèÁöÑÁâπÁÇπÔºö ‰∏çÁªèËøá‚ÄúÊñπÊ≥ïÊ¥æÂèë‚Äù(method dispatch)Ôºå‰ºöÁõ¥Êé•ËÆøÈóÆ‰øùÂ≠òÂØπË±°ÂÆû‰æãÂèòÈáèÁöÑÈÇ£ÂùóÂÜÖÂ≠òÔºåÈÄüÂ∫¶Âø´„ÄÇ ÈÄöËøáÂ±ûÊÄßËÆøÈóÆÂÆû‰æãÂèòÈáèÁöÑÁâπÁÇπÔºö ‰∏ç‰ºöÁªïËøáÂ±ûÊÄßÂÆö‰πâÁöÑÂÜÖÂ≠òÁÆ°ÁêÜËØ≠‰πâ„ÄÇÂÖ∂ÂÆû‰πüÂ∞±ÊòØËØ¥ÔºåÁºñËØëÊúüÂú®ËÆæÁΩÆ set ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºå‰ºöÊ†πÊçÆÂ±ûÊÄßÁâπË¥®ÂÅö‰∏Ä‰∫õÊìç‰Ωú„ÄÇÊØîÂ¶Ç‰∏Ä‰∏™Â£∞Êòé‰∏∫ copy ÁöÑÂ±ûÊÄßÔºåÂ¶ÇÊûúÁõ¥Êé•ËÆøÈóÆÂÆû‰æãÂèòÈáèÔºåÈÇ£‰πàËøô‰∏™ÂÆû‰æãÂèòÈáèÂ∞±‰ºöÁõ¥Êé•ÊåáÂêëÂ†Ü‰∏≠ÁöÑÂØπË±°ÔºõËÄåÂ¶ÇÊûúÈÄöËøáÂ±ûÊÄßÊù•Êìç‰ΩúÔºåÂ∞±‰ºöÂÖàÂ∞ÜÂ†Ü‰∏≠ÁöÑÂØπË±° copy ‰∏Ä‰ªΩÔºåÁÑ∂ÂêéÂ∞ÜÂÆû‰æãÂèòÈáèÊåáÂêë copy Âá∫Êù•ÁöÑÂØπË±°„ÄÇ ÂèØ‰ª•Ëß¶ÂèëKVO( KVO ÊòØÈÄöËøá aop Âú®ËÆæÁΩÆÊñπÊ≥ï‰∏≠Âä†ÁöÑÈÄöÁü• ) ‰∏çËøáÊúâ‰∏§‰∏™Áâπ‰æãÔºö init ÊñπÊ≥ïÂíå dealloc ÊñπÊ≥ï‰∏≠ÔºåÈúÄË¶ÅÁõ¥Êé•ËÆøÈóÆÂÆû‰æãÂèòÈáèÊù•ËøõË°åËÆæÁΩÆÂ±ûÊÄßÊìç‰Ωú„ÄÇÂõ†‰∏∫Â¶ÇÊûúÂú®ËøôÈáåÊ≤°ÊúâÁªïËøásetÊñπÊ≥ïÔºåÂ∞±ÊúâÂèØËÉΩËß¶ÂèëÂÖ∂‰ªñ‰∏çÂøÖË¶ÅÁöÑÊìç‰Ωú(ÊØîÂ¶Ç‰∏äÈù¢ËØ¥ÁöÑÂÜÖÂ≠òÁÆ°ÁêÜËØ≠‰πâÊâÄË¶ÅËøõË°åÁöÑÊìç‰Ωú)„ÄÇ Â¶ÇÊûú‰ΩøÁî®ÊáíÂä†ËΩΩÁöÑËé∑ÂèñÊñπÊ≥ïË¶ÅÁî®Â±ûÊÄßÁöÑÊñπÂºèËé∑Âèñ„ÄÇ ÂÖ∂ÂÆûÔºåÂà∞Â∫ïÁî®‰ªÄ‰πàÂæàÁÆÄÂçïÔºåÂ¶ÇÊûú getÔºåset ÊñπÊ≥ïÈáåÊ≤°ÊúâÂÖ∂‰ªñÁöÑ‰π±‰∏ÉÂÖ´Á≥üÁöÑ‰∏úË•øÔºåÊØîÂ¶Ç: 1234567- (NSString *)firstName&#123; return _firstName;&#125;- (void) setFirstName:(NSString *)firstName&#123; _firstName = firstName;&#125; ‰∏äÈù¢ËøôÁßçÔºåÈÇ£Â∞±Áõ¥Êé•Áî®ÂÆû‰æãÂèòÈáèÊìç‰Ωú‰∫ÜÔºåÁî®Â±ûÊÄßÂ∞±ÊòØÂ§öÊ≠§‰∏Ä‰∏æÔºõÂ¶ÇÊûúÊúâ‰π±‰∏ÉÂÖ´Á≥üÁöÑ‰∏úË•øÔºåÈÇ£‰πàÂ∞±Ë¶ÅÁî®Â±ûÊÄßÁöÑÊñπÂºè„ÄÇ Á¨¨8Êù°ÔºöÁêÜËß£‚ÄúÂØπË±°Á≠âÂêåÊÄß‚ÄùËøô‰∏ÄÊ¶ÇÂøµNSObject Á±ª‰∏≠Êúâ‰∏§‰∏™Áî®‰∫éÂà§Êñ≠Á≠âÂêåÊÄßÁöÑÊñπÊ≥ïÔºö - (BOOL)isEqual:(id)object; - (NSUInteger)hash; NSObject Á±ª‰∏≠ÈªòËÆ§ÁöÑÂÆûÁé∞ÊòØÔºöÂΩì‰∏î‰ªÖÂΩìÂÖ∂ÂÜÖÂ≠òÂú∞ÂùÄÂÆåÂÖ®Áõ∏Á≠âÊó∂Ôºå‰∏§‰∏™ÂØπË±°ÊâçÁõ∏Á≠â„ÄÇËá™ÂÆö‰πâÂØπË±°‰∏≠ÂèØ‰ª•Ë¶ÜÂÜôËøô‰∏§‰∏™ÊñπÊ≥ïÔºàÂÖ∂ÂÆûÂ•ΩÂÉèÊ≤°ÂøÖË¶ÅÈáçÂÜô hash ÊñπÊ≥ïÔºåÂõ†‰∏∫Êàë‰ª¨ÈáçÂÜôÁöÑ isEqual: ÊñπÊ≥ïÈáåÊ†πÊú¨Ê≤°ÊúâÁî®Âà∞ hash ÊñπÊ≥ïÔºåÈáçÂÜô‰∫Ü‰πüÊ≤°Âï•Áî®ÔºâÔºåÂÆåÊàêËá™Â∑±ÁöÑÁõ∏Á≠âÂà§Êñ≠„ÄÇÂ¶ÇÊûú isEqual: ÊñπÊ≥ïÂà§Êñ≠ÂØπË±°Áõ∏Á≠âÔºåÈÇ£‰πàÂÖ∂ hash ÊñπÊ≥ï‰πüÂøÖÈ°ªËøîÂõûÂêå‰∏Ä‰∏™ÂÄºÔºõÂèç‰πãÔºåÂ¶ÇÊûú hash ÊñπÊ≥ïËøîÂõû‰∫ÜÂêå‰∏Ä‰∏™ÂÄºÔºåisEqual: ÊñπÊ≥ïÊú™ÂøÖËÆ§‰∏∫‰∏§ËÄÖÁõ∏Á≠â„ÄÇ Â¶ÇÊûúÂ∑≤Áü•‰∏§‰∏™ÂØπË±°ÊòØÂ≠óÁ¨¶‰∏≤ÔºåÊúÄÂ•ΩÈÄöËøá isEqualToString: ÊñπÊ≥ïÊù•ÊØîËæÉ„ÄÇÂØπ‰∫éÊï∞ÁªÑÂíåÂ≠óÂÖ∏Ôºå‰πüÊúâ isEqualToArray: ÊñπÊ≥ïÂíå isEqualToDictionary:ÊñπÊ≥ï„ÄÇ Â¶ÇÊûúÊØîËæÉÁöÑÂØπË±°Á±ªÂûãÂíåÂΩìÂâçÂØπË±°Á±ªÂûãÁõ∏ÂêåÔºåÂ∞±ÂèØ‰ª•ÈááÁî®Ëá™Â∑±ÁºñÂÜôÁöÑÂà§ÂÆöÊñπÊ≥ïÔºåÂê¶ÂàôË∞ÉÁî®Áà∂Á±ªÁöÑ isEqual: ÊñπÊ≥ïÔºö12345678910111213141516171819202122- (BOOL)isEqualToPerson:(EOCPerson*)otherPerson &#123; //ÂÖàÊØîËæÉÂØπË±°Á±ªÂûãÔºåÁÑ∂ÂêéÊØîËæÉÊØè‰∏™Â±ûÊÄß if (self == object) return YES; if (![_firstName isEqualToString:otherPerson.firstName]) return NO; if (![_lastName isEqualToString:otherPerson.lastName]) return NO; if (_age != otherPerson.age) return NO; return YES;&#125;- (BOOL)isEqual:(id)object &#123; //Â¶ÇÊûúÂØπË±°ÊâÄÂ±ûÁ±ªÂûãÁõ∏ÂêåÔºåÂ∞±Ë∞ÉÁî®Ëá™Â∑±ÁºñÂÜôÁöÑÂà§ÂÆöÊñπÊ≥ïÔºåÂ¶ÇÊûú‰∏çÂêåÔºåË∞ÉÁî®Áà∂Á±ªÁöÑisEqual:ÊñπÊ≥ï if ([self class] == [object class]) &#123; return [self isEqualToPerson:(EOCPerson*)object]; &#125; else &#123; return [super isEqual:object]; &#125;&#125; Á¨¨9Êù° ‰ª•‚ÄúÁ±ªÊóèÊ®°Âºè‚ÄúÈöêËóèÂÆûÁé∞ÁªÜËäÇÂÖ∂ÂÆûÂ∞±ÊòØÈÄöËøáÊäΩË±°Á±ªÂÆåÊàêÂ∑•ÂéÇÊ®°Âºè„ÄÇ ‰æãÂ¶Ç,ÂØπ‰∫é‚ÄúÂëòÂ∑•‚ÄùËøô‰∏™Á±ªÔºåÂèØ‰ª•ÊúâÂêÑÁßç‰∏çÂêåÁöÑ‚ÄúÂ≠êÁ±ªÂûã‚ÄùÔºöÂºÄÂèëÂëòÂ∑•ÔºåËÆæËÆ°ÂëòÂ∑•ÂíåË¥¢ÊîøÂëòÂ∑•„ÄÇËøô‰∫õ‚ÄúÂÆû‰ΩìÁ±ª‚ÄùÂèØ‰ª•Áî±‚ÄúÂëòÂ∑•‚ÄùËøô‰∏™ÊäΩË±°Âü∫Á±ªÊù•Ëé∑ÂæóÔºö 123456789101112131415161718192021//EOCEmployee.htypedef NS_ENUM(NSUInteger, EOCEmployeeType) &#123; EOCEmployeeTypeDeveloper, EOCEmployeeTypeDesigner, EOCEmployeeTypeFinance,&#125;;@interface EOCEmployee : NSObject@property (copy) NSString *name;@property NSUInteger salary;// Helper for creating Employee objects+ (EOCEmployee*)employeeWithType:(EOCEmployeeType)type;// Make Employees do their respective day's work- (void)doADaysWork;@end 12345678910111213141516171819202122232425//EOCEmployee.m@implementation EOCEmployee+ (EOCEmployee*)employeeWithType:(EOCEmployeeType)type &#123; switch (type) &#123; case EOCEmployeeTypeDeveloper: return [EOCEmployeeDeveloper new]; break; case EOCEmployeeTypeDesigner: return [EOCEmployeeDesigner new]; break; case EOCEmployeeTypeFinance: return [EOCEmployeeFinance new]; break; &#125;&#125;- (void)doADaysWork &#123; // ÈúÄË¶ÅÂ≠êÁ±ªÊù•ÂÆûÁé∞&#125;@end 12345678910@interface EOCEmployeeDeveloper : EOCEmployee@end@implementation EOCEmployeeDeveloper- (void)doADaysWork &#123; [self writeCode];&#125;@end ËøôÊ†∑ÔºåË°®Èù¢‰∏äÂØπË±°ÊòØ EOCEmployeeÔºå‰ΩÜÊòØÂÆûÈôÖ‰∏äÊìç‰ΩúÁöÑÊòØ EOCEmployeeDeveloper„ÄÇ ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑè‰∏ÄÁÇπÔºöÂØπ‰∫éËøôÁßçÁ±ªÊóèÔºå‰∏çËÉΩÈÄöËøá‰ª•‰∏ãÊñπÂºèÂà§Êñ≠Ôºö 123if ([employeeDeveloper class] == [EOCEmployee class])&#123; // will do&#125; Âõ†‰∏∫ employeeDeveloper ÂØπË±°ÊòØ EOCEmployee Á±ªÁöÑ‰∏Ä‰∏™Â≠êÈõÜÔºåÈúÄË¶Å‰ΩøÁî® isKindOfClass: ÊñπÊ≥ïÔºö 123if ([employeeDeveloper isKindOfClass:[EOCEmployee class]])&#123; // will do&#125; Á¨¨10Êù°ÔºöÂú®Êó¢ÊúâÁ±ª‰∏≠‰ΩøÁî®ÂÖ≥ËÅîÂØπË±°Â≠òÊîæËá™ÂÆö‰πâÊï∞ÊçÆËøô‰∏ÄÊù°Âíå runtime ÊÅØÊÅØÁõ∏ÂÖ≥„ÄÇËÉåÊôØÊòØÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá category ‰∏∫Á≥ªÁªüÁ±ªÊ∑ªÂä†ÊñπÊ≥ïÔºå‰ΩÜÊòØÊó†Ê≥ïÊ∑ªÂä†Â±ûÊÄß„ÄÇÂΩìÈúÄË¶Å‰∏∫Á≥ªÁªüÁ±ªÊ∑ªÂä†Â±ûÊÄßÊó∂ÔºåÂèØ‰ª•‰ΩøÁî®‰∏ãÈù¢ÁöÑÊñπÊ≥ïÔºö 12345678//‰∏∫Êüê‰∏™ÂØπË±°ËÆæÁΩÆÂÖ≥ËÅîÂØπË±°ÁöÑÂÄºÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØ‰∏ªÂØπË±°ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÈîÆÔºåÁ¨¨‰∏â‰∏™ÂèÇÊï∞ÊòØÂÖ≥ËÅîÁöÑÂØπË±°ÔºåÁ¨¨Âõõ‰∏™ÂèÇÊï∞ÊòØÂ≠òÂÇ®Á≠ñÁï•:ÊòØÊûö‰∏æÔºåÂÆö‰πâ‰∫ÜÂÜÖÂ≠òÁÆ°ÁêÜËØ≠‰πâvoid objc_setAssociatedObject(id object, void *key, id value, objc_AssociationPolicy policy)//Ê†πÊçÆÁªôÂÆöÁöÑÈîÆ‰ªéÊüêÂØπË±°‰∏≠Ëé∑ÂèñÁõ∏Â∫îÁöÑÂÖ≥ËÅîÂØπË±°ÂÄºid objc_getAssociatedObject(id object, void *key)//ÁßªÈô§ÊåáÂÆöÂØπË±°ÁöÑÂÖ≥ËÅîÂØπË±°void objc_removeAssociatedObjects(id object) ÂØπË±°ÂÖ≥ËÅîÁ±ªÂûã objec_AssociationPolicy ÂåÖÊã¨Ôºö 12345OBJC_ASSOCIATION_ASSIGN //assignOBJC_ASSOCIATION_RETAIN_NONATOMIC //nonatomic,retainOBJC_ASSOCIATION_COPY_NONATOMIC //nonatomic,copyOBJC_ASSOCIATION_RETAIN //retain OBJC_ASSOCIATION_COPY //copy ËøôÈáåÂº∫Ë∞É‰∏Ä‰∏™Âú∞ÊñπÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞Á±ªÂûã‰∏∫ void * ËøôÊòØ‰∏Ä‰∏™ÂèØ‰ª•ÊåáÂêë‰ªªÊÑèÁ±ªÂûãÁöÑÊåáÈíàÔºåÁ±ª‰ºº‰∫é oc ‰∏≠ÁöÑ id„ÄÇ‰ΩÜÊòØËøô‰∏§ËÄÖÂπ∂‰∏çÁõ∏Á≠âÔºåÈúÄË¶ÅËøõË°åËΩ¨Êç¢„ÄÇÊàë‰ª¨Áúã‰ª£Á†ÅÁöÑÊó∂ÂÄôÁªèÂ∏∏‰ºöÁúãÂà∞‰ª•‰∏ãÂá†Áßç: 1234567891011121314151617181920212223// ÊñπÂºè1static const void * const s = @"type1";objc_setAssociatedObject(self, s, @"value", OBJC_ASSOCIATION_COPY_NONATOMIC);// ÊñπÂºè2static const NSString * const s = @"type2";objc_setAssociatedObject(self, (__bridge void *)s, @"value", OBJC_ASSOCIATION_COPY_NONATOMIC);// ÊñπÂºè3static const NSString * const s = @"type3";objc_setAssociatedObject(self, &amp;s, @"value", OBJC_ASSOCIATION_COPY_NONATOMIC);// ÊñπÂºè4static const void * const s;objc_setAssociatedObject(self, &amp;s, @"value", OBJC_ASSOCIATION_COPY_NONATOMIC);// ÊñπÂºè5static const void * const s;objc_setAssociatedObject(self, s, @"value", OBJC_ASSOCIATION_COPY_NONATOMIC);// ÊñπÂºè6static const void * const s = &amp;s;objc_setAssociatedObject(self, s, @"value", OBJC_ASSOCIATION_COPY_NONATOMIC); Áî±‰∫éÈúÄË¶ÅÁöÑÊòØ void * Á±ªÂûãÔºåÊâÄ‰ª•ÊñπÂºè1ÊòØÊúÄÊ≠£Â∏∏ÁöÑ‰∫Ü„ÄÇ ÊñπÂºè2‰ΩøÁî®‰∫ÜÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºåÊâÄ‰ª•ÈúÄË¶ÅÂ∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫ void *ÔºåÂ∞±Ë¶Å‰ΩøÁî® __bridge void *„ÄÇ Èô§‰∫Ü‰ΩøÁî® bridgeÔºåËøòÂèØ‰ª•‰ΩøÁî® &amp; ÂèñÂæóÊåáÈíàÁöÑÂú∞ÂùÄÔºåËøôÂ∞±ÊòØÊñπÂºè3ÁöÑÂ§ÑÁêÜÊñπÂºè„ÄÇÊ≥®ÊÑè &amp;s Âíå s ËøòÊòØÊúâÂæàÂ§ßÁöÑÂå∫Âà´ÁöÑÔºåÂâçËÄÖË°®Á§∫ÊåáÈíàÂú®Ê†à‰∏≠ÁöÑÂú∞ÂùÄÔºåÂêéËÄÖË°®Á§∫ÊåáÈíàÊåáÂêëÁöÑÂÄºÂú®Â†Ü‰∏≠Âú∞ÂùÄ„ÄÇÊâÄ‰ª•ÂÖ∂ÂÆûÊñπÂºè3ÊòØ‰ª• s ÁöÑÂú∞ÂùÄ‰∏∫Á¥¢ÂºïÁöÑÔºåËÄå‰∏çÊòØ‰ª•ËµãÁöÑÂÄº‰∏∫Á¥¢ÂºïÁöÑ„ÄÇÊâÄ‰ª•Âíå @&quot;type3&quot; Ê≤°ÊúâÂ§™Â§ßÂÖ≥Á≥ª‰∫ÜÔºå‰πüÂ∞±‰∏çÁî®ËÄÉËôë __bridge ËΩ¨Êç¢‰∫Ü„ÄÇ Ê†πÊçÆÂâç‰∏ÄÊù°ÂèØÁü•ÔºåÂéªÊéâ @type3 ‰πüÊòØÊ≤°ÊúâÈóÆÈ¢òÁöÑ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÊñπÂºè4‰πüÊòØÂØπÁöÑ„ÄÇ ‰∏ÄÂÆöÊ≥®ÊÑèÔºåÊñπÂºè5ÊòØÈîôËØØÁöÑÔºåÊàë‰ª¨‰∏çËÉΩËøô‰πàÂÜô„ÄÇÂõ†‰∏∫Êàë‰ª¨Ê≤°ÊúâÂØπ s ËµãÂÄºÔºåÊâÄ‰ª• s ÊåáÂêëÁöÑÊòØÁ©∫Âú∞ÂùÄÔºåÂ¶ÇÊûúÊàë‰ª¨Ë¶ÅÂú®ÂÆö‰πâ‰∏Ä‰∏™ÂÖ≥ËÅîÂ±ûÊÄßÔºåÂèàÂàõÂª∫‰∫Ü‰∏Ä‰∏™ static const void * const j;ÔºåËøô‰∏™ j ‰πüÊåáÂêëÁ©∫Âú∞ÂùÄÔºåÂ∞±‰ºöË¶ÜÁõñ s ÂÖ≥ËÅîÁöÑÂ±ûÊÄß‰∫Ü„ÄÇÂõ†‰∏∫ s Âíå j ‰∏çÂÖ∑ÊúâÂîØ‰∏ÄÊÄß„ÄÇ ÊñπÂºè4ÊØèÊ¨°‰ΩøÁî®ÁöÑ‰ΩøÁî®ÈÉΩË¶ÅËæìÂÖ• &amp;sÔºåÊñπÂºè6ÊòØÂÖ∂ÊîπËøõÁöÑÊñπÊ≥ï„ÄÇ void *s = &amp;s Ë°®Á§∫ÁöÑÊÑèÊÄùÊòØÊåáÈíà s ÊåáÂêëËá™Â∑±ÔºåËøôÊ†∑ s Â∞±ÂíåÂÖ∂ÂÆÉÊåáÈíàÂå∫ÂàÜÂºÄ‰∫ÜÔºåÂ∞±‰∏çÈúÄË¶ÅÂÖ∑‰ΩìËÄÉËôëËµã‰∏™‰ªÄ‰πàÂÄºÔºå‰πü‰∏çÈúÄË¶ÅÂú®ÊØèÊ¨°‰ΩøÁî®ÁöÑÊó∂ÂÄôÁî® &amp; Ëé∑ÂèñËá™Â∑±ÁöÑÂú∞ÂùÄ‰∫Ü„ÄÇ ÊâÄ‰ª•Áõ∏ÊØîËæÉÊù•ËØ¥ÔºåÊñπÂºè4Ôºå6‰ºöÁÆÄÂçï‰∫õÔºåÊñπÂºè6 Â∞§‰∏∫ÁÆÄ‰æø„ÄÇ ÂÖ≥‰∫é *s, &amp;s, s ‰πãÈó¥ÁöÑÂÖ≥Á≥ªÔºö s Ë°®Á§∫ÁöÑÊòØÂΩìÂâçÊåáÂêëÁöÑÂú∞ÂùÄ‰∏äÁöÑÂÄº *s ÂèØ‰ª•ÊãÜÂàÜ‰∏∫‰∏§ÈÉ®ÂàÜÔºås ÂèñÂΩìÂâçÊåáÂêëÁöÑÂú∞ÂùÄ‰∏äÁöÑÂÄºÔºå* ÂèñÂêéÈù¢Ë∑üÁùÄÁöÑÂú∞ÂùÄ‰∏äÁöÑÂÄº„ÄÇÊâÄ‰ª• *s Â∞±ÊòØ‰ª•ÂΩìÂâçÊåáÂêëÁöÑÂú∞ÂùÄ‰∏äÁöÑÂÄº‰∏∫Âú∞ÂùÄÔºåÂÜçÂèñÂÄº &amp;s ÂèñÂΩìÂâçÊåáÈíàÁöÑÂú∞ÂùÄÂÄº ÂÖ≥‰∫é‰∫åÁ∫ßÊåáÈíàÁöÑÊåáÂêëÈóÆÈ¢òÊºîÁ§∫Â¶Ç‰∏ãÔºö Á¨¨11Êù°ÔºöÁêÜËß£objc_msgSendÁöÑ‰ΩúÁî®ËøôÈÉ®ÂàÜÂåÖÊã¨‰∏ãÈù¢Âá†‰∏™Âú®runtime‰∏≠Â∑≤ÁªèÂÜôÂæóÂæàËØ¶ÁªÜ‰∫Ü„ÄÇ Á¨¨12Êù°ÔºöÁêÜËß£Ê∂àÊÅØËΩ¨ÂèëÊú∫Âà∂Á¨¨13Êù°ÔºöÁî®‚ÄúÊñπÊ≥ïË∞ÉÈÖçÊäÄÊúØ‚ÄùË∞ÉËØï‚ÄúÈªëÁõíÊñπÊ≥ï‚ÄùÁ¨¨14Êù°ÔºöÁêÜËß£‚ÄúÁ±ªÂØπË±°‚ÄùÁöÑÁî®ÊÑèÊé•Âè£‰∏éAPIËÆæËÆ°Á¨¨15Êù°ÔºöÁî®ÂâçÁºÄ ÈÅøÂÖçÂëΩÂêçÁ©∫Èó¥ÂÜ≤Á™ÅApple ÂÆ£Áß∞ÂÖ∂‰øùÁïô‰ΩøÁî®ÊâÄÊúâ‚Äù‰∏§Â≠óÊØçÂâçÁºÄ‚ÄùÁöÑÊùÉÂà©ÔºåÊâÄ‰ª•Êàë‰ª¨ÈÄâÁî®ÁöÑÂâçÁºÄÂ∫îËØ•ÊòØ‰∏â‰∏™Â≠óÊØçÁöÑ„ÄÇËÄå‰∏îÔºåÂ¶ÇÊûúËá™Â∑±ÂºÄÂèëÁöÑÁ®ãÂ∫è‰ΩøÁî®Âà∞‰∫ÜÁ¨¨‰∏âÊñπÂ∫ìÔºå‰πüÂ∫îËØ•Âä†‰∏äÂâçÁºÄ„ÄÇ Ëá™Â∑±ÂºÄÂèëÁöÑÁ®ãÂ∫èÂ∫ìÁî®Âà∞‰∫ÜÁ¨¨‰∏âÊñπÂ∫ìÔºåÂàôÂ∫î‰∏∫ÂÖ∂‰∏≠ÁöÑÂêçÁß∞Âä†‰∏äÂâçÁºÄ„ÄÇ(Áî® cocoapods ÂèØ‰ª•Ëá™Âä®Âä†‰∏äÂâçÁºÄÔºåËá™Â∑±ÂºÄÂèëÁöÑÂ∫ìÁöÑËØùË¶ÅÊâãÂä®ÊîπÂêç„ÄÇ) Á¨¨16Êù°ÔºöÊèê‰æõ‚ÄùÂÖ®ËÉΩÂàùÂßãÂåñÊñπÊ≥ï‚ÄùÊâÄË∞ìÂÖ®ËÉΩÂàùÂßãÂåñÊñπÊ≥ïÔºåÂ∞±ÊòØÊâÄÊúâÂàùÂßãÂåñÊñπÊ≥ïÈÉΩË¶ÅË∞ÉÁî®ÁöÑÂàùÂßãÂåñÊñπÊ≥ï„ÄÇËøô‰∏™ÂàùÂßãÂåñÊñπÊ≥ïÂàùÂßãÂåñÊñπÊ≥ïÊòØÂàùÂßãÂåñÊñπÊ≥ïÈáåÂèÇÊï∞ÊúÄÂ§öÁöÑ‰∏Ä‰∏™ÔºåÂõ†‰∏∫ÂÆÉ‰ΩøÁî®‰∫ÜÂ∞ΩÂèØËÉΩÂ§öÁöÑÂàùÂßãÂåñÊâÄÈúÄË¶ÅÁöÑÂèÇÊï∞Ôºå‰ª•‰æøÂÖ∂‰ªñÁöÑÊñπÊ≥ïÊù•Ë∞ÉÁî®Ëá™Â∑±„ÄÇ ÁÆóÊòØ‰∏ÄÁßçÂÜô‰ª£Á†ÅÁöÑÊäÄÂ∑ßÂêß„ÄÇÂπ≥Êó∂ÂÜô‰ª£Á†ÅÁöÑÊó∂ÂÄô‰πüÈÉΩÊòØËøôÊ†∑ÁöÑÔºå‰∏çÂÖ∑‰ΩìËØ¥Êòé‰∫Ü„ÄÇ Á¨¨17Êù°ÔºöÂÆûÁé∞descriptionÊñπÊ≥ïËá™ÂÆö‰πâÁöÑÁ±ªË∞ÉÁî® NSLog(); ÁöÑÊó∂ÂÄôÔºåÂæÄÂæÄ‰∏çËÉΩËøîÂõûÊÉ≥Ë¶ÅÁöÑÁªìÊûú„ÄÇÈúÄË¶ÅÈáçÂÜô NSObject Á±ª‰∏≠ÁöÑ description ÊñπÊ≥ïÔºåËøîÂõûÈúÄË¶ÅÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ123- (NSString*)description &#123; return [NSString stringWithFormat:@"&lt;%@: %p, %@ %@&gt;", [self class], self, firstName, lastName];&#125; ÂÖ∂‰∏≠Ôºå%p Ë°®Á§∫ÂØπË±°ÁöÑÂÜÖÂ≠òÂú∞ÂùÄ„ÄÇ Á¨¨18Êù°ÔºöÂ∞ΩÈáè‰ΩøÁî®‰∏çÂèØÂèòÂØπË±°Â∞ΩÈáè‰ΩøÁî®‰∏çÂèØÂèòÂØπË±°„ÄÇÊ≤°Âï•ÂèØËØ¥ÁöÑ„ÄÇÈáåÈù¢Êé®ËçêÁöÑÊñπÊ≥ïÊ≤°Áî®ËøáÔºåÊÑüËßâÂπ∂‰∏çÂ•ΩÔºåÂ∞±‰∏çÂÜô‰∫Ü„ÄÇ Á¨¨19Êù°Ôºö‰ΩøÁî®Ê∏ÖÊô∞ËÄåÂçèË∞ÉÁöÑÂëΩÂêçÊñπÂºèÊ≤°Âï•Â•ΩËØ¥ÁöÑÔºåÊ≥®ÊÑèÂ∞±Â•Ω Á¨¨20Êù°Ôºö‰∏∫ÁßÅÊúâÊñπÊ≥ïÂêçÂä†ÂâçÁºÄÂª∫ËÆÆÂú®ÂÆûÁé∞Êñá‰ª∂ÈáåÂ∞ÜÈùûÂÖ¨ÂºÄÁöÑÊñπÊ≥ïÈÉΩÂä†‰∏äÂâçÁºÄÔºå‰æø‰∫éË∞ÉËØïÔºåËÄå‰∏îËøôÊ†∑‰∏ÄÊù•‰πüÂæàÂÆπÊòìÂå∫ÂàÜÂì™‰∫õÊòØÂÖ¨ÂÖ±ÊñπÊ≥ïÔºåÂì™‰∫õÊòØÁßÅÊúâÊñπÊ≥ï„ÄÇÂõ†‰∏∫ÂæÄÂæÄÂÖ¨ÂÖ±ÊñπÊ≥ïÊòØ‰∏ç‰æø‰∫é‰ªªÊÑè‰øÆÊîπÁöÑ„ÄÇ 1234567891011121314151617181920#import &lt;Foundation/Foundation.h&gt;@interface EOCObject : NSObject- (void)publicMethod;@end@implementation EOCObject- (void)publicMethod &#123; /* ... */&#125;- (void)p_privateMethod &#123; /* ... */&#125;@end ÂæàÊúâÁî®ÁöÑÂª∫ËÆÆÔºåÂ∞±ÂÉè‰∏äÈù¢‰∏ÄÊ†∑Âú®ÁßÅÊúâÊñπÊ≥ïÂâçÈù¢Âä†‰∏ä p_ Êå∫Â•ΩÁöÑ„ÄÇÊ≥®ÊÑè‰∏çË¶ÅÂçïÁî®‰∏ãÂàíÁ∫øÊù•Âå∫ÂàÜÁßÅÊúâÊñπÊ≥ïÂíåÂÖ¨ÂÖ±ÊñπÊ≥ïÔºåÂõ†‰∏∫‰ºöÂíåËãπÊûúÂÖ¨Âè∏ÁöÑAPIÈáçÂ§ç„ÄÇ Á¨¨21Êù°ÔºöÁêÜËß£Objective-CÈîôËØØÁ±ªÂûãOC ‰∏≠‰ªÖÂú®ÂèäÂÖ∂‰∏•ÈáçÁöÑÈîôËØØÊÉÖÂÜµ‰∏ãÊäõÂá∫ÂºÇÂ∏∏„ÄÇÊØîÂ¶Ç‰∏Ä‰∏™ÊäΩË±°Âü∫Á±ª„ÄÇÁî±‰∫é OC ‰∏≠Ê≤°ÂäûÊ≥ïÂ∞ÜÊüê‰∏™Á±ªÊ†áËØÜ‰∏∫ÊäΩË±°Á±ª„ÄÇÂ¶ÇÊûúÊÉ≥Ë¶ÅÂÆûÁé∞ÊäΩË±°Á±ªÁöÑÂäüËÉΩÔºåÈÇ£‰πàÂ∞±Ë¶ÅÂú®ÂøÖÈ°ªË¶ÅË¶ÜÂÜôÁöÑÊñπÊ≥ïÈáåÊäõÂá∫ÂºÇÂ∏∏Ôºö 123456- (void)mustOverrideMethod&#123; NSString *reason = [NSString stringWithFormat:@"%@ must be overridden", NSStringFromeSelector(_cmd)]; @throw [NSException exceptionWithName:NSInternalInconsistencyException reason:reason userInfo:nil];&#125; ÂØπ‰∫é‰∏ç‰∏•ÈáçÁöÑÂºÇÂ∏∏ÔºåÂèØ‰ª•‰ΩøÁî®ÂõûË∞ÉÂùóÁöÑÊñπÂºèËøîÂõû nil ÊàñËÄÖ NSError ÊäõÁªôÊñπÊ≥ïÁöÑË∞ÉÁî®ËÄÖÂ§ÑÁêÜÔºåÊØîÂ¶ÇÂêÑÁßçÁΩëÁªúÂ∫ìÈÉΩÊòØËøô‰πàÂÅöÁöÑÔºåËæìÂÖ•‰∏Ä‰∏™ÊàêÂäüÂõûË∞ÉÔºåÂíå‰∏Ä‰∏™Â§±Ë¥•ÂõûË∞É„ÄÇ Á¨¨22Êù°ÔºöÁêÜËß£NSCopyingÂçèËÆÆËá™ÂÆö‰πâÊã∑Ë¥ùÂ¶ÇÊûúÊàë‰ª¨ÊÉ≥‰ª§Ëá™Â∑±ÁöÑÁ±ªÊîØÊåÅÊã∑Ë¥ùÊìç‰ΩúÔºåÈÇ£Â∞±Ë¶ÅÂÆûÁé∞ NSCopying ÂçèËÆÆÔºåËØ•ÂçèËÆÆÂè™Êúâ‰∏Ä‰∏™ÊñπÊ≥ïÔºö 1- (id)copyWithZone:(NSZone*)zone ÊØîÂ¶ÇË¶ÅÊã∑Ë¥ù‰∏Ä‰∏™ EOCPerson ÂØπË±°Ôºö 12345- (id)copyWithZone:(NSZone*)zone &#123; EOCPerson *copy = [[[self class] allocWithZone:zone] initWithFirstName:_firstName andLastName:_lastName]; copy-&gt;_friends = [_friends mutableCopy]; return copy;&#125; ËøôÈáåÈù¢ÁöÑ NSZone *zone ÂØπË±°ÊòØ‰ª•ÂâçÂºÄÂèëÁ®ãÂ∫èÊó∂Ôºå‰ºöÊ†πÊçÆÊ≠§ÂêßÂÜÖÂ≠òÂàÜÊàê‰∏çÂêåÁöÑÂå∫(zone)ÔºåÂØπË±°‰ºöË¢´ÂàõÂª∫Âú®Êüê‰∏™Âå∫ÈáåÈù¢„ÄÇÁé∞Âú®‰∏çÁî®‰∫ÜÔºåÊØè‰∏™Á®ãÂ∫èÈÉΩÂè™Êúâ‰∏Ä‰∏™Âå∫Ôºö‚ÄùÈªòËÆ§Âå∫‚ÄùÔºåÊâÄ‰ª•Áé∞Âú®‰∏çÂøÖÂú®ÊÑèËøô‰∏™ÂØπË±°„ÄÇËøô‰∏™ÊñπÊ≥ïÂ∞±ÊòØÊñ∞Âª∫‰∏Ä‰∏™ EOCPerson ÂØπË±°ÔºåÁÑ∂ÂêéË∞ÉÁî®ÂÆÉÁöÑÊûÑÈÄ†ÂáΩÊï∞Êää‰∏úË•øÂÖ®ÈÉΩÂ°ûËøõÂéª„ÄÇËøôÈáåÁöÑ -&gt; Áî®ÁÆ≠Â§¥ÊòØÂõ†‰∏∫ÂÆö‰πâÁöÑÊó∂ÂÄôËøô‰∏™ _friends ‰∏çÊòØ‰∏Ä‰∏™Â±ûÊÄß(‰ª£Á†ÅÊ≤°ÊúâË¥¥Âá∫Êù•ÔºåËØ¶ËßÅ‰π¶)ÔºåËÄåÂè™ÊòØÂú®ÂÆûÁé∞Êñá‰ª∂‰∏≠ÂÆö‰πâÁöÑ‰∏Ä‰∏™ÂÆû‰æãÂèòÈáèÔºåÊ≤°Êúâ get/set ÊñπÊ≥ïÔºåÊâÄ‰ª•‰∏çËÉΩÁî® .Ôºå‰∏ÄËà¨ÊÉÖÂÜµÁî®ÁÇπËØ≠Ê≥ïÂ∞±Ë°å‰∫Ü„ÄÇ ËøôÈáåÁöÑ mutableCopy ÊñπÊ≥ï‰πüÂèØ‰ª•Ëá™ÂÆö‰πâÔºåÂ∞±ÊòØ‰∏ãÈù¢ÊñπÊ≥ïÁöÑÂÆûÁé∞Ôºö 1-(id)mutableCopyWithZone:(NSZone*)zoneÔºõ ÊµÖÊã∑Ë¥ù‰∏éÊ∑±Êã∑Ë¥ùÊµÖÊã∑Ë¥ùÂíåÊ∑±Êã∑Ë¥ùÂ∫îËØ•Âπ∂‰∏çÈôåÁîü„ÄÇÊµÖÊã∑Ë¥ùÂè™Â¢ûÂä†ÂºïÁî®ËÆ°Êï∞ÔºåÊ∑±Êã∑Ë¥ùÂ∞ÜÂàõÂª∫Âè¶‰∏Ä‰∏™‰∏ÄÊ®°‰∏ÄÊ†∑ÁöÑÂØπË±°„ÄÇ ‰∏çÂèØÂèòÂØπË±°ÁöÑ copy ÊòØÊµÖÊã∑Ë¥ù„ÄÇ ÂèØÂèòÂØπË±°ÁöÑ copy ÊòØÊ∑±Êã∑Ë¥ùÔºåËøîÂõû‰∏çÂèØÂèòÂØπË±°„ÄÇ ‰∏çÂèØÂèòÂØπË±°ÁöÑ mutableCopy ÊòØÊ∑±Êã∑Ë¥ùÔºåËøîÂõûÂèØÂèòÂØπË±°„ÄÇ ÂèØÂèòÂØπË±°ÁöÑ mutableCopy ÊòØÊ∑±Êã∑Ë¥ù„ÄÇ ÂÆπÂô®ÂØπË±°(NSArray)Êú¨Ë∫´‰πüÈÅµÂæ™‰∏äÈù¢ÁöÑËßÑÂàô„ÄÇ‰ΩÜÊòØÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂÆπÂô®ÂØπË±°ÂÜÖÁöÑÂÖÉÁ¥†ÊòØÊµÖÊã∑Ë¥ùÔºà‰Ω†ÂèØËÉΩÈÄöËøáÊ∑±Êã∑Ë¥ùÊñ∞Âª∫‰∫Ü‰∏Ä‰∏™ NSArrayÔºå‰ΩÜÊòØ NSArray ÈáåÈù¢Â≠òÁöÑËøòÊòØÂØπË±°ÁöÑÊåáÈíàÔºåËøòÊòØÂèØ‰ª•‰øÆÊîπ NSArray ÈáåÁöÑÂØπË±°ÁöÑÔºå‰∏§‰∏™ NSArray ÈáåÁöÑÂØπË±°ÈÉΩ‰ºöË¢´‰øÆÊîπÔºâ„ÄÇÂõ†Ê≠§‰∏äÈù¢ÁöÑËá™ÂÆö‰πâ copy ÊñπÊ≥ïÂ¶ÇÊûúÊÉ≥ËÆ© _friends ÂÜÖÁöÑÂÖÉÁ¥†Ê∑±Êã∑Ë¥ùÔºåÂ∞±‰∏çËÉΩÁî® [_friends mutableCopy] ÊñπÊ≥ïÔºåÈúÄË¶ÅÊñ∞Âª∫‰∏Ä‰∏™ Set: 12345- (id)deepCopy &#123; EOCPerson *copy = [[[self class] alloc] initWithFirstName:_firstName andLastName:_lastName]; copy-&gt;_friends = [[NSMutableSet alloc] initWithSet:_friends copyItems:YES]; return copy;&#125; ÂçèËÆÆ‰∏éÂàÜÁ±ªÁ¨¨23Êù°ÔºöÈÄöËøáÂßîÊâò‰∏éÊï∞ÊçÆÊ∫êÂçèËÆÆËøõË°åÂØπË±°Èó¥ÈÄö‰ø°ÂÖ∂ÂÆû‰πüÊòØËÄÅÁîüÂ∏∏Ë∞àÁöÑ‰∏úË•ø‰∫ÜÔºå‰∏çËøá‰πüÊúâ‰∏Ä‰∫õÊ≥®ÊÑèÁÇπ„ÄÇ Âèó‰ª£ÁêÜÂØπË±°ÂÜÖÊåÅÊúâ‰ª£ÁêÜÂØπË±°ÁöÑÂÆû‰æãÊó∂Ë¶ÅÂÜôÊàêËøôÊ†∑Ôºö 1@property (nonatomic, weak) id &lt;NetworkDelegate&gt; delegate; ËøôÈáå‰π¶‰∏≠ÊåáÊòé‰∫ÜË¶ÅÁî® weakÔºå‰∏çËÉΩÁî® strongÔºåÂê¶Âàô‰ºöÂºïËµ∑ÂºïÁî®Âæ™ÁéØ„ÄÇÊØîÂ¶ÇÁ≥ªÁªü‰∏≠ÁöÑ TableViewCellDelegateÔºåÂú® TableViewController ‰Ωú‰∏∫‰ª£ÁêÜÁ±ªÁ°ÆÂÆûÊã•ÊúâË¢´‰ª£ÁêÜÂØπË±° TableViewCellÔºåÁî® weak Á°ÆÂÆûÊòØÂêàÁêÜÁöÑÔºå‰ΩÜÊòØÊâÄÊúâÊÉÖÂÜµÈÉΩËøôÊ†∑ÂêóÔºü‰∏çÁü•ÈÅìÔºå‰∏çËøáÁ°ÆÂÆûÂü∫Êú¨‰∏äÁöÑ‰ª£ÁêÜÂØπË±°ÈÉΩÊòØ ViewControllerÔºåÊâÄ‰ª•Áî® weak ËÇØÂÆöÊòØ‰∏ç‰ºöÊúâÈóÆÈ¢òÁöÑ„ÄÇ ÂÆûÁé∞ÂßîÊâòÂØπË±°ÁöÑÊñπÊ≥ïÊòØÂ£∞ÊòéÊüê‰∏™Á±ªÈÅµ‰ªéÂßîÊâòÂçèËÆÆÔºö 12345@implementation EOCDataModel () &lt;EOCNetworkFetcherDelegate&gt;@end@implementation EOCDataModel// ÂêÑ‰∏™ÂÆûÁé∞ÊñπÊ≥ï@end Âü∫Êú¨ÊâÄÊúâÁöÑ Delegate ÈÉΩÂú® .m Êñá‰ª∂‰∏≠ÁöÑÁ±ªÊãìÂ±ï‰∏≠Â£∞ÊòéÔºå‰πãÂâç‰∏ÄÁõ¥Ê≤°ÊúâÁïôÊÑèÔºåÁúã‰∫Ü‰π¶ÂêéÊâçÈóÆËá™Â∑±Ôºå‰∏∫‰ªÄ‰πà‰∏çÂú® .h ‰∏≠Â£∞ÊòéÔºü‰∏§ËÄÖÊúâ‰ªÄ‰πàÂ∑ÆÂà´ÂêóÔºüÂÖ∂ÂÆû‰πüÊ≤°‰ªÄ‰πàÂ∑ÆÂà´ÔºåÂú®ÂÆûÁé∞Êñá‰ª∂‰∏≠Â£∞ÊòéÁöÑÂ•ΩÂ§ÑÊòØËÉΩÈöêËóèÁªÜËäÇ„ÄÇÂ¶ÇÊûúÂè™ÊòØËá™Â∑±Áî®ÂèØËÉΩÊ≤°‰ªÄ‰πàÂå∫Âà´Ôºå‰ΩÜÊòØÂ¶ÇÊûúÊâìÂåÖÁªôÂà´‰∫∫Áî®ÔºåÈÇ£‰πàÂ∞±‰∏çÂ∫îËØ•ËÆ©Âà´‰∫∫ÁúãÂà∞‰Ω†ÁöÑÂÆûÁé∞ÁªÜËäÇ‰∫ÜÔºåÂõ†Ê≠§ÔºåÂ∞±ÊääËøô‰∏™ Delegate ÁöÑÂ£∞ÊòéÊîæÂà∞‰∫ÜÂÆûÁé∞Êñá‰ª∂‰∏≠„ÄÇ Âè¶Â§ñËØ¥ËØ¥ÈÄöËøá delegate ‰º†ÂÄºÂíåÁõ¥Êé•‰º†ÂÄºÁöÑÂå∫Âà´„ÄÇÁõ¥Êé•‰º†ÂÄºÊòØ‰∏ÄÁßçËá™Â∑±ÁöÑ‰∏ªÂä®ÁöÑË°å‰∏∫Ôºådelegate ‰º†ÂÄºÊòØ‰∏ÄÁßçË¢´Âä®ÁöÑÂà´‰∫∫Âêë‰Ω†ËÆ®Ë¶ÅÁöÑË°å‰∏∫„ÄÇ‰∏ÄËà¨Êàë‰ª¨ËÆæÁΩÆÊüê‰∏™Á±ªÁöÑ delegate ÁöÑÊó∂ÂÄôÔºåË¶Å‰πàÊòØËÆæÁΩÆÂÖ∂‰ªñÁ±ªÁöÑ delegate ‰∏∫Ëá™Â∑± xxx.delegate = selfÔºåË¶Å‰πàÊòØËÆæÁΩÆÂÖ∂‰ªñÁ±ªÁöÑ delegate ‰∏∫ÂÖ∂‰ªñÁ±ª xxx.delegate = xxxxÔºåÁªù‰∏ç‰ºöÂ∞ÜËá™Â∑±ÁöÑ delegate ËÆæÁΩÆ‰∏∫ÂÖ∂‰ªñÁ±ªÁöÑÔºåÂç≥Ê≤°ÊúâËøôÊ†∑ÁöÑ self.delegate = xxx„ÄÇÂõ†‰∏∫‰Ω†Â∑≤ÁªèÁü•ÈÅìÈÇ£‰∏™Á±ªÊòØ‰ªÄ‰πàÁöÑÔºå‰∏∫‰ªÄ‰πà‰∏çÁõ¥Êé•Ë∞ÉÁî®ÈÇ£‰∏™Á±ªÁöÑÊñπÊ≥ïÂë¢Ôºü Á¨¨24Êù°ÔºöÂ∞ÜÁ±ªÁöÑÂÆûÁé∞‰ª£Á†ÅÂàÜÊï£Âà∞‰æø‰∫éÁÆ°ÁêÜÁöÑÊï∞‰∏™ÂàÜÁ±ª‰∏≠ÂΩì‰∏Ä‰∏™Á±ªË∂äÊù•Ë∂äÂ§ßÊó∂ÔºåÂ∞±ÂèòÂæó‰∏çÂà©‰∫éÁÆ°ÁêÜÔºåÂõ†Ê≠§ÈúÄË¶ÅÂ∞ÜÁ±ª‰ª£Á†ÅÊåâÁÖßÈÄªËæëÂàíÂàÜÂÖ•Âá†‰∏™ÂàÜÂå∫‰∏≠ÔºåÂèØ‰ª•ÈÄöËøáËåÉÁï¥ÁöÑÊñπÂºèÂÆûÁé∞„ÄÇ‰π¶‰∏≠Êúâ‰∏Ä‰∏™‰æãÂ≠êÔºö Êó†ÂàÜÁ±ª:123456789101112131415161718192021222324252627#import &lt;Foundation/Foundation.h&gt;@interface EOCPerson : NSObject@property (nonatomic, copy, readonly) NSString *firstName;@property (nonatomic, copy, readonly) NSString *lastName;@property (nonatomic, strong, readonly) NSArray *friends;- (id)initWithFirstName:(NSString*)firstName andLastName:(NSString*)lastName;/* Friendship methods */- (void)addFriend:(EOCPerson*)person;- (void)removeFriend:(EOCPerson*)person;- (BOOL)isFriendsWith:(EOCPerson*)person;/* Work methods */- (void)performDaysWork;- (void)takeVacationFromWork;/* Play methods */- (void)goToTheCinema;- (void)goToSportsGame;@end ÂàÜÁ±ªÂêé:123456789101112131415161718192021222324252627282930313233343536373839404142434445#import &lt;Foundation/Foundation.h&gt;@interface EOCPerson : NSObject@property (nonatomic, copy, readonly) NSString *firstName;@property (nonatomic, copy, readonly) NSString *lastName;@property (nonatomic, strong, readonly) NSArray *friends;- (id)initWithFirstName:(NSString*)firstNameandLastName:(NSString*)lastName;@end@interface EOCPerson (Friendship)- (void)addFriend:(EOCPerson*)person;- (void)removeFriend:(EOCPerson*)person;- (BOOL)isFriendsWith:(EOCPerson*)person;@end@interface EOCPerson (Work)- (void)performDaysWork;- (void)takeVacationFromWork;@end@interface EOCPerson (Play)- (void)goToTheCinema;- (void)goToSportsGame;@end Â¶ÇÊûúËßâÂæóÂÜôÂú®‰∏Ä‰∏™ÂÆûÁé∞Êñá‰ª∂‰∏≠Â§™Èïø‰∫ÜÔºåÂèØ‰ª•ÊãÜÂºÄÔºåÊØîÂ¶ÇÂ∞ÜÂÖ∂‰∏≠ÁöÑ Friendship ÊãÜÂºÄ„ÄÇ 1234567891011121314151617181920212223242526272829303132// EOCPerson+Friendship.h#import "EOCPerson.h"@interface EOCPerson (Friendship)- (void)addFriend:(EOCPerson*)person;- (void)removeFriend:(EOCPerson*)person;- (BOOL)isFriendsWith:(EOCPerson*)person;@end// EOCPerson+Friendship.m#import "EOCPerson+Friendship.h"@implementation EOCPerson (Friendship)- (void)addFriend:(EOCPerson*)person &#123; /* ... */&#125;- (void)removeFriend:(EOCPerson*)person &#123; /* ... */&#125;- (BOOL)isFriendsWith:(EOCPerson*)person &#123; /* ... */&#125;@end ‰∏çËøáË¶ÅÊ≥®ÊÑèÔºåÂú®Êñ∞Âª∫ÂàÜÁ±ªÊñá‰ª∂Êó∂Ôºå‰∏ÄÂÆöË¶ÅÂºïÂÖ•Ë¢´ÂàÜÁ±ªÁöÑÁ±ªÊñá‰ª∂„ÄÇ ËøôÊòØ‰∏Ä‰∏™ÂæàÊúâÁî®ÁöÑÂ∞ÜÂ§ßÊñá‰ª∂ÊãÜÂàÜÁöÑÊäÄÂ∑ßÂïä„ÄÇ ÂàÜÁ±ªÂíåÂçèËÆÆÈÉΩÂèØ‰ª•Áî® @property ÂÆö‰πâÂ±ûÊÄßÔºå‰ΩÜÊòØÈÉΩÂè™ÊòØÂ£∞Êòé‰∫ÜÊñπÊ≥ïÔºåÊ≤°ÊúâÂÆö‰πâÊàêÂëòÂèòÈáè Á¨¨25Êù°ÔºöÊÄªÊòØ‰∏∫Á¨¨‰∏âÊñπÁ±ªÁöÑÂàÜÁ±ªÂêçÁß∞Âä†ÂâçÁºÄÂ¶ÇÊûúÊàë‰ª¨ÊÉ≥ÁªôÁ¨¨‰∏âÊñπÂ∫ìÊàñËÄÖiOSÊ°ÜÊû∂ÈáåÁöÑÁ±ªÊ∑ªÂä†ÂàÜÁ±ªÊó∂ÔºåÊúÄÂ•ΩÂ∞ÜÂàÜÁ±ªÂêçÂíåÊñπÊ≥ïÂêçÂä†‰∏äÂâçÁºÄ„ÄÇÂê¶ÂàôÂèØËÉΩ‰ºöÊõøÊç¢ÊéâÁ≥ªÁªüÁöÑÊñπÊ≥ï„ÄÇ Á¨¨26Êù°:ÂãøÂú®ÂàÜÁ±ª‰∏≠Â£∞ÊòéÂ±ûÊÄßËøôÊú¨‰π¶Ë¶ÅÊòØÊó©ÁÇπÁúãÂà∞Â∞±Â•Ω‰∫ÜÔºåÂΩìÊó∂Á∫†ÁªìËøô‰∏™Âæà‰πÖÔºåËµ∞‰∫ÜÂæàÂ§öÂºØË∑Ø„ÄÇ ÂàÜÁ±ªÊú∫Âà∂ÔºåÁõÆÊ†áÂú®‰∫éÊâ©Â±ïÁ±ªÁöÑÂäüËÉΩÔºåËÄå‰∏çÊòØÂ∞ÅË£ÖÊï∞ÊçÆ„ÄÇ Á¨¨27Êù°Ôºö‰ΩøÁî®class-continuationÂàÜÁ±ª ÈöêËóèÂÆûÁé∞ÁªÜËäÇÈÄöÂ∏∏ÔºåÊàë‰ª¨ÈúÄË¶ÅÂáèÂ∞ëÂú®ÂÖ¨ÂÖ±Êé•Âè£‰∏≠ÂêëÂ§ñÊö¥Èú≤ÁöÑÈÉ®ÂàÜ(ÂåÖÊã¨Â±ûÊÄßÂíåÊñπÊ≥ï)ÔºåËÄåÂõ†Ê≠§Â∏¶ÁªôÊàë‰ª¨ÁöÑÂ±ÄÈôêÊÄßÂèØ‰ª•Âà©Áî® class-continuation ÂàÜÁ±ªÁöÑÁâπÊÄßÊù•Ë°•ÂÅøÔºö ÂèØ‰ª•Âú® class-continuation ÂàÜÁ±ª‰∏≠Â¢ûÂä†ÂÆû‰æãÂèòÈáè„ÄÇ ÂèØ‰ª•Âú® class-continuation ÂàÜÁ±ª‰∏≠Â∞ÜÂÖ¨ÂÖ±Êé•Âè£ÁöÑÂè™ËØªÂ±ûÊÄßËÆæÁΩÆ‰∏∫ËØªÂÜô„ÄÇ(Ëøô‰∏™ÁúãËµ∑Êù•‰πüÊå∫ÊúâÁî®ÁöÑÔºåÂ§ñÈÉ®Êó†Ê≥ï‰øÆÊîπÔºåÂÜÖÈÉ®Âç¥ËÉΩÊõ¥Êîπ) ÂèØ‰ª•Âú® class-continuation ÂàÜÁ±ª‰∏≠ÈÅµÂæ™ÂçèËÆÆÔºå‰ΩøÂÖ∂‰∏ç‰∏∫‰∫∫Áü•„ÄÇ ‰æãÂ≠ê‰∏ÄÔºö 123@interface EOCPerson()&lt;EOCPersonDelegate&gt;// method@end ‰æãÂ≠ê‰∫åÔºö 1234567891011//.h@interface EOCPerson:NSObject@property (nonatomic,copy,readonly) NSString *firstName;@property (nonatomic,copy,readonly) NSString *lastName;- (id)initWithFirstName:(NSString *)firstName lastName:(NSString *)lastName;//.m@interface EOCPerson()@property (nonatomic,copy,readwrite) NSString *firstName;@property (nonatomic,copy,readwrite) NSString *lastName; Á¨¨28Êù°:ÈÄöËøáÂçèËÆÆÊèê‰æõÂåøÂêçÂØπË±°OC ÈáåÁöÑÂåøÂêçÂØπË±°Âíå Java ÈáåÁöÑÂåøÂêçÂØπË±°‰∏çÂêåÔºåËøôÈáåÁöÑÂåøÂêçÂØπË±°Ê≤°ÊúâÁ±ªÂûã„ÄÇÊúâÊó∂Êàë‰ª¨Áî®ÂçèËÆÆÊù•Êèê‰æõÂåøÂêçÂØπË±°ÔºåÁõÆÁöÑÂú®‰∫éËØ¥ÊòéÂÆÉ‰ªÖ‰ªÖË°®Á§∫‚ÄúÈÅµ‰ªéÊüê‰∏™ÂçèËÆÆÁöÑÂØπË±°‚ÄùÔºåËÄå‰∏çÊòØ‚ÄúÂ±û‰∫éÊüê‰∏™Á±ªÁöÑÂØπË±°‚Äù„ÄÇÂÆÉÁöÑË°®Á§∫ÊñπÊ≥ï‰∏∫Ôºöid&lt;protocol&gt;„ÄÇ ÈÄöËøáÂçèËÆÆÊèê‰æõÂåøÂêçÂØπË±°ÁöÑ‰∏ªË¶Å‰ΩøÁî®Âú∫ÊôØÊúâ‰∏§‰∏™Ôºö ‰Ωú‰∏∫Â±ûÊÄß ‰Ωú‰∏∫ÊñπÊ≥ïÂèÇÊï∞ ÂåøÂêçÂØπË±°‰Ωú‰∏∫Â±ûÊÄßÂú®ËÆæÂÆöÊüê‰∏™Á±ª‰∏∫Ëá™Â∑±ÁöÑ‰ª£ÁêÜÂ±ûÊÄßÊó∂ÔºåÂèØ‰ª•‰∏çÂ£∞Êòé‰ª£ÁêÜÁöÑÁ±ªÔºåËÄåÊòØÁî® id&lt;protocol&gt;ÔºåÂõ†‰∏∫Êàê‰∏∫‰ª£ÁêÜÁöÑÁªàÁÇπÂπ∂‰∏çÊòØÊüê‰∏™Á±ªÁöÑÂÆû‰æãÔºåËÄåÊòØÈÅµÂæ™‰∫ÜÊüê‰∏™ÂçèËÆÆ„ÄÇ 1@property (nonatomic, weak) id &lt;EOCDelegate&gt; delegate; Âú®ËøôÈáå‰ΩøÁî®ÂåøÂêçÂØπË±°ÁöÑÂéüÂõ†Êúâ‰∏§‰∏™Ôºö Â∞ÜÊù•ÂèØËÉΩ‰ºöÊúâÂæàÂ§ö‰∏çÂêåÁ±ªÁöÑÂÆû‰æãÂØπË±°‰Ωú‰∏∫ËØ•Á±ªÁöÑ‰ª£ÁêÜ„ÄÇ Êàë‰ª¨‰∏çÊÉ≥ÊåáÊòéÂÖ∑‰ΩìË¶Å‰ΩøÁî®Âì™‰∏™Á±ªÊù•‰Ωú‰∏∫Ëøô‰∏™Á±ªÁöÑ‰ª£ÁêÜ„ÄÇ ‰πüÂ∞±ÊòØËØ¥ÔºåËÉΩ‰Ωú‰∏∫ËØ•Á±ªÁöÑ‰ª£ÁêÜÁöÑÊù°‰ª∂Âè™Êúâ‰∏Ä‰∏™ÔºöÂÆÉÈÅµ‰ªé‰∫Ü &lt;EOCDelegate&gt; ÂçèËÆÆ„ÄÇ ÂåøÂêçÂØπË±°‰Ωú‰∏∫ÊñπÊ≥ïÂèÇÊï∞ÊúâÊó∂ÔºåÊàë‰ª¨‰∏ç‰ºöÂú®ÊÑèÊñπÊ≥ïÈáåÊüê‰∏™ÂèÇÊï∞ÁöÑÂÖ∑‰ΩìÁ±ªÂûãÔºåËÄåÊòØÈÅµÂæ™‰∫ÜÊüêÁßçÂçèËÆÆÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÂèØ‰ª•‰ΩøÁî®ÂåøÂêçÂØπË±°Êù•‰Ωú‰∏∫ÊñπÊ≥ïÂèÇÊï∞„ÄÇ 1- (void)setObject:(id)object forKey:(id&lt;NSCopying&gt;)key; Ëøô‰∏™ÊñπÊ≥ïÊòØ NSDictionary ÁöÑËÆæÂÄºÊñπÊ≥ïÔºåÂÆÉÁöÑÂèÇÊï∞Âè™Ë¶ÅÈÅµ‰ªé‰∫Ü &lt;NSCopying&gt; ÂçèËÆÆÔºåÂ∞±ÂèØ‰ª•‰Ωú‰∏∫ÂèÇÊï∞‰º†ËøõÂéª,‰Ωú‰∏∫ NSDictionary ÁöÑÈîÆ„ÄÇ ÂÜÖÂ≠òÁÆ°ÁêÜÁ¨¨29Êù°ÔºöÁêÜËß£ÂºïÁî®ËÆ°Êï∞NSObject ÂçèËÆÆÂ£∞Êòé‰∫Ü‰∏ãÈù¢‰∏â‰∏™ÊñπÊ≥ïÁî®‰∫éÊìç‰ΩúËÆ°Êï∞Âô®Ôºå‰ª•ÈÄíÂ¢ûÊàñÈÄíÂáèÂÖ∂ÂÄºÔºö retain: ÈÄíÂ¢û‰øùÁïôËÆ°Êï∞ releaseÔºö ÈÄíÂáè‰øùÁïôËÆ°Êï∞ autoreleaseÔºö ÂæÖÁ®çÂêéÊ∏ÖÁêÜ‚ÄúËá™Âä®ÈáäÊîæÊ±†‚ÄùÊó∂ÔºåÂÜçÈÄíÂáè‰øùÁïôËÆ°Êï∞„ÄÇ ÂØπË±°ÂàõÂª∫Âá∫Êù•Êó∂ÔºåÂÖ∂‰øùÁïôËÆ°Êï∞Ëá≥Â∞ë‰∏∫1„ÄÇËã•ÊÉ≥‰ª§ÂÖ∂ÁªßÁª≠Â≠òÊ¥ªÔºåÂàôË∞ÉÁî® retaion ÊñπÊ≥ï„ÄÇË¶ÅÊòØÊüêÈÉ®ÂàÜ‰ª£Á†Å‰∏çÂú®‰ΩøÁî®ËØ•ÂØπË±°ÔºåÂàôË∞ÉÁî® release Êàñ autorelease„ÄÇÊúÄÁªàÂΩì‰øùÁïôËÆ°Êï∞ÂΩíÈõ∂Êó∂ÔºåÂØπË±°Â∞±ÂõûÊî∂‰∫Ü(dealloced)„ÄÇ Â¶ÇÊûúÊåâÁÖßÂºïÁî®Ê†ëÂõûÊ∫ØÔºåÈÇ£‰πàÊúÄÁªà‰ºöÂèëÁé∞‰∏Ä‰∏™Ê†πÂØπË±°„ÄÇÂú® iOS ‰∏≠ÊòØ UIApplication „ÄÇ‰∏§ËÄÖÈÉΩÊòØÂ∫îÁî®Á®ãÂ∫èÂêØÂä®Êó∂ÂàõÂª∫ÁöÑÂçï‰æã„ÄÇ Ë∞ÉÁî® autorelease ‰ºöÂú®Á®çÂêéÈÄíÂáèËÆ°Êï∞ÔºåÈÄöÂ∏∏ÊòØ‰∏ã‰∏Ä‰∏™‰∫ã‰ª∂Âæ™ÁéØ„ÄÇËøô‰∏™ÁâπÊÄßÂèØ‰ª•Âú®ÊñπÊ≥ïËøîÂõûÂØπË±°Êó∂Áî®Âà∞Ôºö 1234- (NSString *)stringValue&#123; NSString *str = [[NSString alloc] initWithFormat:@"I am this: %@",self]; return [str autorelease];&#125; Âú® alloc ÁöÑÊó∂ÂÄôÔºåÂºïÁî®ËÆ°Êï∞Âä†‰∏ÄÔºåËøîÂõûÁöÑÊó∂ÂÄôË¶ÅÂ∞ÜËøôÊ¨°ÂºïÁî®ÊäµÊ∂àÔºåÊâÄ‰ª•‰ΩøÁî® autorelease„ÄÇ‰øÆÊîπÂêéÔºåstringValue ÊñπÊ≥ïÊää NSString ÂØπË±°ËøîÂõûÁªôË∞ÉÁî®ËÄÖÁöÑÊó∂ÂÄôÔºåÊ≠§ÂØπË±°ÂøÖÁÑ∂Â≠òÊ¥ª„ÄÇÊâÄ‰ª•Êàë‰ª¨ËÉΩÁî®‰∏ãÈù¢ËøôÊ†∑‰ΩøÁî®Ôºö 12NSString *str = [self stringValue];NSLog(@"The string is: %@",str); Áî±‰∫éËøîÂõûÁöÑ str Â∞Ü‰∫éÁ®çÂêéËá™Âä®ÈáäÊîæÔºåÊâÄ‰ª•Â§öÂá∫Êù•ÁöÑÈÇ£‰∏ÄÊ¨°‰øùÁïôÊìç‰ΩúÂà∞Êó∂ÂÄô‰ºöËá™ÁÑ∂ÊäµÊ∂àÔºåÊó†È°ªÊâßË°å‰ªª‰ΩïÂÜÖÂ≠òÁÆ°ÁêÜÊìç‰Ωú„ÄÇÂõ†‰∏∫Ëá™Âä®ÈáäÊîæÊ±†‰∏≠ÁöÑÈáäÊîæÊìç‰ΩúË¶ÅÁ≠âÂà∞‰∏ã‰∏Ä‰∏™‰∫ã‰ª∂Âæ™ÁéØÊâçËÉΩÊâßË°åÔºåÊâÄ‰ª• NSLog ËØ≠Âè•Âú®‰ΩøÁî® str ÂØπË±°Ââç‰∏çÈúÄË¶ÅÊâãÂä®ÊâßË°å‰øùÁïôÊìç‰Ωú„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúË¶ÅÊåÅÊúâÊ≠§ÂØπË±°ÁöÑËØùÔºåÈÇ£Â∞±ÈúÄË¶Å‰øùÁïôÔºåÁÑ∂ÂêéÊâãÂä®ÈáäÊîæ‰∫ÜÔºö 123_instanceVariable = [[self stringValue] retain];//...[_instanceVariable release]; Áî±Ê≠§ÂèØËßÅÔºåautorelease ÂèØ‰ª•Âª∂ÈïøÂØπË±°ÁîüÂëΩÊúüÔºå‰ΩøÂÖ∂Âú®Ë∑®Ë∂äÊñπÊ≥ïË∞ÉÁî®ËæπÁïåÂêé‰æùÁÑ∂ÂèØ‰ª•Â≠òÊ¥ª‰∏ÄÊÆµÊó∂Èó¥„ÄÇ Á¨¨30Êù°Ôºö‰ª•ARCÁÆÄÂåñÂºïÁî®ËÆ°Êï∞ÂºïÁî®ËÆ°Êï∞ËøòÊòØË¶ÅÊâßË°åÁöÑÔºåÂè™‰∏çËøá‰øùÁïôÂíåÈáäÊîæÊìç‰ΩúÁé∞Âú®Áî± ARC Ëá™Âä®Ê∑ªÂä†ÔºåÂèØ‰ª•ÁúÅÁï•ÂØπ‰∫éÂºïÁî®ËÆ°Êï∞ÁöÑÊìç‰Ωú„ÄÇÁî±‰∫é ARC ‰ºöÊâßË°å retain release autorelease deallocÔºåÊâÄ‰ª•Áõ¥Êé•Ë∞ÉÁî®Ëøô‰∫õÊñπÊ≥ïÊòØÈùûÊ≥ïÁöÑ„ÄÇ ÈúÄË¶Å‰∫ÜËß£‰∏Ä‰∏™‰øÆÈ•∞Á¨¶ __weak„ÄÇÂùóÂÜÖÂºïÁî®Â§ñÈÉ®ÂèòÈáèÊó∂Ôºå‰ºöËá™Âä®‰øùÁïôÂÖ∂ÊâÄÊçïËé∑ÁöÑÂÖ®ÈÉ®ÂØπË±°ÔºåÂ¶ÇÊûúËøôÂÖ∂‰∏≠ÊúâÊüê‰∏™ÂØπË±°‰øùÁïô‰∫ÜÂùóÊú¨Ë∫´ÔºàÂ¶ÇÂ∞Ü ViewController ‰º†ÂÖ•ÔºâÔºåÂ∞Ü‰ºöÂΩ¢Êàê‚Äú‰øùÁïôÁéØ‚Äù„ÄÇÊâÄ‰ª•Ë¶ÅÁî® __weak Â±ÄÈÉ®ÂèòÈáèÊù•ÊâìÁ†¥ËøôÁßç‰øùÁïôÁéØ„ÄÇ 1EOCNetwork * __weak weakFetcher = fetcher; Êàë‰ª¨Âú®‰ΩøÁî® block ÁöÑËøáÁ®ã‰∏≠ÔºåÁªèÂ∏∏‰ºöÈúÄË¶ÅÂºïÁî® selfÔºå‰∏∫‰∫ÜÊâìÁ†¥ÂºïÁî®Âæ™ÁéØÔºåÊàë‰ª¨ÈúÄË¶ÅËøô‰πàÂÅöÔºö 1234567// block Â§ñ__weak typeof(self) wself = self;// block ÂÜÖ// ÂÖàÂà§Êñ≠ self ÊòØÂê¶Â∑≤Ë¢´ÂõûÊî∂ÔºåÁÑ∂ÂêéÂÜçÂº∫ÂºïÁî® wselfÔºå‰Ωø‰πã‰∏ç‰ºöÂú® block ÊâßË°åÁöÑÊó∂ÂÄôË¢´ÂõûÊî∂if (!wself) return;__strong typeof(wself) sself = wself Á¨¨31Êù°ÔºöÂú®deallocÊñπÊ≥ï‰∏≠Âè™ÈáäÊîæÂºïÁî®Âπ∂Ëß£Èô§ÁõëÂê¨ÂØπË±°Âú®ÁªèÂéÜÁîüÂëΩÊúüÂêéÔºåÊúÄÁªà‰ºöË¢´Á≥ªÁªüÂõûÊî∂ÔºåËøôÈáåÂ∞±ÊòØÊâßË°å dealloc ÊñπÊ≥ï‰∫Ü„ÄÇÊ∞∏Ëøú‰∏çË¶ÅËá™Â∑±Ë∞ÉÁî® dealloc ÊñπÊ≥ïÔºåËøêË°åÊúüÁ≥ªÁªü‰ºöÂú®ÈÄÇÂΩìÁöÑÊó∂ÂÄôË∞ÉÁî®ÂÆÉ„ÄÇÊ†πÊçÆÊÄßËÉΩÈúÄÊ±ÇÊàë‰ª¨ÊúâÊó∂ÈúÄË¶ÅÂú® dealloc ÊñπÊ≥ï‰∏≠ÂÅö‰∏Ä‰∫õÊìç‰Ωú„ÄÇÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•Âú® dealloc ÊñπÊ≥ïÈáåÂÅö‰ªÄ‰πàÂë¢Ôºü ÈáäÊîæÂØπË±°ÊâÄÊã•ÊúâÁöÑÊâÄÊúâÂºïÁî®Ôºå‰∏çËøáARC‰ºöËá™Âä®Ê∑ªÂä†Ëøô‰∫õÈáäÊîæ‰ª£Á†ÅÔºåÂèØ‰ª•‰∏çÂøÖÊìçÂøÉ„ÄÇ ÂØπË±°Êã•ÊúâÁöÑÂÖ∂‰ªñÈùûOCÂØπË±°‰πüË¶ÅÈáäÊîæÔºàCoreFoundation ÂØπË±°Â∞±ÂøÖÈ°ªÊâãÂä®ÈáäÊîæÔºâ ÈáäÊîæÂéüÊù•ÁöÑËßÇÊµãË°å‰∏∫ÔºöÊ≥®ÈîÄÈÄöÁü•„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÂèäÊó∂Ê≥®ÈîÄÔºåÂ∞±‰ºöÂêëÂÖ∂ÂèëÈÄÅÈÄöÁü•Ôºå‰ΩøÂæóÁ®ãÂ∫èÂ¥©Ê∫É„ÄÇ ‰æãÂ¶ÇÔºö1234- (void)dealloc &#123; CFRelease(coreFoundationObject); [[NSNotificationCenter defaultCenter] removeObserver:self];&#125; Èô§‰∫ÜÈáäÊîæÂºïÁî®ÂíåÊ≥®ÈîÄÈÄöÁü•Ôºå‰∏çË¶ÅÂú® dealloc ‰∏≠ÂÅöÂÖ∂‰ªñ‰ªª‰Ωï‰∫ãÔºàÊØîÂ¶ÇË∞ÉÁî®Â±ûÊÄßÁöÑÂ≠òÂèñÊñπÊ≥ïÔºå‰ª•ÂèäÂºÇÊ≠•Êìç‰ΩúÔºâ„ÄÇÂ¶ÇÊûúÂØπË±°ÊåÅÊúâÊñá‰ª∂ÊèèËø∞Á¨¶Á≠âÁ≥ªÁªüËµÑÊ∫êÔºåÈÇ£‰πàÂ∫îËØ•‰∏ìÈó®ÁºñÂÜô‰∏Ä‰∏™ÊñπÊ≥ïÊù•ÈáäÊîæËØ•ËµÑÊ∫ê„ÄÇËøôÊ†∑ÁöÑÁ±ªË¶ÅÂíå‰ΩøÁî®ËÄÖÁ∫¶ÂÆöÔºåÁî®ÂÆåËµÑÊ∫êÂêéÂøÖÈ°ªË∞ÉÁî® close ÊñπÊ≥ï„ÄÇ Á¨¨32Êù°ÔºöÁºñÂÜô‚ÄúÂºÇÂ∏∏ÂÆâÂÖ®‰ª£Á†Å‚ÄùÊó∂ÁïôÊÑèÂÜÖÂ≠òÁÆ°ÁêÜÈóÆÈ¢òÂú®ÂèëÁîüÂºÇÂ∏∏Êó∂ÁöÑÂÜÖÂ≠òÁÆ°ÁêÜÈúÄË¶Å‰ªîÁªÜËÄÉËôëÂÜÖÂ≠òÁÆ°ÁêÜÁöÑÈóÆÈ¢òÔºöÂú® try Âùó‰∏≠ÔºåÂ¶ÇÊûúÂÖà‰øùÁïô‰∫ÜÊüê‰∏™ÂØπË±°ÔºåÁÑ∂ÂêéÂú®ÈáäÊîæÂÆÉ‰πãÂâçÂèàÊäõÂá∫‰∫ÜÂºÇÂ∏∏ÔºåÈÇ£‰πàÈô§ÈùûÂú® catch Âùó‰∏≠ËÉΩÂ§ÑÁêÜÊ≠§ÈóÆÈ¢òÔºåÂê¶ÂàôÂØπË±°ÊâÄÂç†ÂÜÖÂ≠òÂ∞±Â∞ÜÊ≥ÑÊºè„ÄÇ 1234567@try &#123; EOCSomeClass *object = [[EOCSomeClass alloc] init]; [object doSomethingThatMayThrow];&#125;@catch (...) &#123; NSLog(@"Whoops, there was an error. Oh well...");&#125; ÊâÄ‰ª•‰∏ÄÂÆöË¶ÅÊ≥®ÊÑèÂ∞Ü try ÂùóÂÜÖÊâÄÂàõÂª∫ÁöÑÂØπË±°Â§ÑÁêÜÂπ≤ÂáÄ„ÄÇ Á¨¨33Êù°Ôºö‰ª•Âº±ÂºïÁî®ÈÅøÂÖç‰øùÁïôÁéØÂØπË±°‰πãÈó¥ÈÉΩÁî®Âº∫ÊåáÈíàÂºïÁî®ÂØπÊñπÁöÑËØù‰ºöÈÄ†Êàê‰øùÁïôÁéØ„ÄÇÂ¶ÇÊûú‰øùÁïôÁéØËøûÊé•‰∫ÜÂ§ö‰∏™ÂØπË±°ÔºåËÄåËøôÈáåÂÖ∂‰∏≠‰∏Ä‰∏™ÂØπË±°Ë¢´Â§ñÁïåÂºïÁî®ÔºåÈÇ£‰πàÂΩìËøô‰∏™ÂºïÁî®Ë¢´ÁßªÈô§ÂêéÔºåÊï¥‰∏™‰øùÁïôÁéØÂ∞±Ê≥ÑÊºè‰∫Ü„ÄÇ‰∏çÂÉè Java ÈÇ£ÁßçÂ§ÑÁêÜÊñπÂºèÔºåOC ‰∏≠Â≠§Á´ãÁöÑ‰øùÁïôÁéØ‰∏çËÉΩË¢´Ëá™Âä®ÈáäÊîæ„ÄÇ ÈÇ£‰πàÂ∞±Ë¶ÅÁî®Âº±ÂºïÁî®ÁöÑÊñπÂºèÔºö 1234567//EOCClassB.m//Á¨¨‰∏ÄÁßçÂº±ÂºïÁî®Ôºöunsafe_unretained@property (nonatomic, unsafe_unretained) EOCClassA *other;//Á¨¨‰∫åÁßçÂº±ÂºïÁî®Ôºöweak@property (nonatomic, weak) EOCClassA *other; Ëøô‰∏§ÁßçÂº±ÂºïÁî®Êúâ‰ªÄ‰πàÂå∫Âà´Âë¢ÔºüÂΩìÊåáÂêë EOCClassA ÂÆû‰æãÁöÑÂºïÁî®ÁßªÈô§ÂêéÔºåunsafe_unretained Â±ûÊÄß‰ªçÁÑ∂ÊåáÂêëÈÇ£‰∏™Â∑≤ÁªèÂõûÊî∂ÁöÑÂÆû‰æãÔºåËÄå weak ÊåáÂêë nil„ÄÇÊòæÁÑ∂ÔºåÁî® weak Â≠óÊÆµÂ∫îËØ•ÊòØÊõ¥ÂÆâÂÖ®ÁöÑÔºåÂõ†‰∏∫‰∏çÂÜç‰ΩøÁî®ÁöÑÂØπË±°ÊåâÁêÜËØ¥Â∫îËØ•ËÆæÁΩÆ‰∏∫ nil,ËÄå‰∏çÂ∫îËØ•‰∫ßÁîü‰æùËµñ„ÄÇ ÊâÄ‰ª•Âè™Ë¶ÅÁî® weak Â∞±Ë°å‰∫Ü„ÄÇ Á¨¨34Êù°Ôºö‰ª•‚ÄúËá™Âä®ÈáäÊîæÊ±†Âø´‚ÄùÈôç‰ΩéÂÜÖÂ≠òÂ≥∞ÂÄºËøô‰∏™ÈÉ®ÂàÜÂú® runloop Áõ∏ÂÖ≥ÊñáÁ´†‰∏≠ÊúâÂ≠¶‰π†Ëøá„ÄÇ‰∏ªË¶ÅÁî®ÁöÑÊòØËøôÊ†∑‰∏Ä‰∏™‰æãÂ≠êÔºö 123for (int i = 0; i &lt; 100000; i++) &#123; [self doSomethingWithInt:i];&#125; Áî±‰∫éÁ∫øÁ®ãËá™Âä®ÈáäÊîæÊ±†Âú® event loop Êó∂ÔºåËøõË°åÊ∏ÖÁ©∫Ôºå‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂ∞ÜÂèØËÉΩÈÄ†ÊàêÂÜÖÂ≠òÂ≥∞ÂÄº„ÄÇÂõ†Ê≠§ÔºåÂèØ‰ª•ÊâãÂä®Ê∑ªÂä†‰∏Ä‰∏™Ëá™Âä®ÈáäÊîæÊ±†ÔºåÊääÂæ™ÁéØÂÜÖÁöÑ‰ª£Á†ÅÂåÖË£πÂú®ÂÜÖÔºåÈÇ£‰πàÂæ™ÁéØ‰∏≠Ëá™Âä®ÈáäÊîæÁöÑÁã¨‰∫´Â∞±‰ºöÂú®Ëøô‰∏™Ê±†‰∏≠ÔºåËÄå‰∏çÊòØÂú®Á∫øÁ®ãÁöÑ‰∏ªÊ±†‰∏≠„ÄÇ 12345678NSArray *databaseRecords = /* ... */;NSMutableArray *people = [NSMutableArray new];for (NSDictionary *record in databaseRecords) &#123; @autoreleasepool &#123; EOCPerson *person = [[EOCPerson alloc] initWithRecord:record]; [people addObject:person]; &#125;&#125; Á¨¨35Êù°ÔºöÁî®‚ÄúÂÉµÂ∞∏ÂØπË±°‚ÄùË∞ÉËØïÂÜÖÂ≠òÁÆ°ÁêÜÈóÆÈ¢òÊüê‰∏™ÂØπË±°Ë¢´ÂõûÊî∂ÂêéÔºåÂÜçÂêëÂÆÉÂèëÈÄÅÊ∂àÊÅØÊòØ‰∏çÂÆâÂÖ®ÁöÑÔºåËøôÂπ∂‰∏ç‰∏ÄÂÆö‰ºöÂºïËµ∑Á®ãÂ∫èÂ¥©Ê∫É„ÄÇÂ¶ÇÊûúÁ®ãÂ∫èÊ≤°ÊúâÂ¥©Ê∫ÉÔºåÂèØËÉΩÊòØÂõ†‰∏∫Ôºö ËØ•ÂÜÖÂ≠òÁöÑÈÉ®ÂàÜÂéüÊï∞ÊçÆÊ≤°ÊúâË¢´Ë¶ÜÂÜô„ÄÇ ËØ•ÂÜÖÂ≠òÊÅ∞Â•ΩË¢´Âè¶‰∏Ä‰∏™ÂØπË±°Âç†ÊçÆÔºåËÄåËøô‰∏™ÂØπË±°ÂèØ‰ª•Â∫îÁ≠îËøô‰∏™ÊñπÊ≥ï„ÄÇ Â¶ÇÊûúË¢´ÂõûÊî∂ÁöÑÂØπË±°Âç†Áî®ÁöÑÂéüÂÜÖÂ≠òË¢´Êñ∞ÁöÑÂØπË±°Âç†ÊçÆÔºåÈÇ£‰πàÊî∂Âà∞Ê∂àÊÅØÁöÑÂØπË±°Â∞±‰∏ç‰ºöÊòØÊàë‰ª¨È¢ÑÊÉ≥ÁöÑÈÇ£‰∏™ÂØπË±°„ÄÇÂú®ËøôÊ†∑ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ¶ÇÊûúËøô‰∏™ÂØπË±°Êó†Ê≥ïÂìçÂ∫îÈÇ£‰∏™ÊñπÊ≥ïÁöÑËØùÔºåÁ®ãÂ∫è‰æùÊóß‰ºöÂ¥©Ê∫É„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨Â∏åÊúõÂèØ‰ª•ÈÄöËøá‰∏ÄÁßçÊñπÊ≥ïÊçïÊçâÂà∞ÂØπË±°Ë¢´ÈáäÊîæÂêéÊî∂Âà∞Ê∂àÊÅØÁöÑÊÉÖÂÜµ„ÄÇËøôÁßçÊñπÊ≥ïÂ∞±ÊòØÂà©Áî®ÂÉµÂ∞∏ÂØπË±°ÔºÅ Cocoa Êèê‰æõ‰∫Ü‚ÄúÂÉµÂ∞∏ÂØπË±°‚ÄùÁöÑÂäüËÉΩ„ÄÇÂ¶ÇÊûúÂºÄÂêØ‰∫ÜËøô‰∏™ÂäüËÉΩÔºåËøêË°åÊúüÁ≥ªÁªü‰ºöÊääÊâÄÊúâÂ∑≤ÁªèÂõûÊî∂ÁöÑÂÆû‰æãËΩ¨ÂåñÊàêÁâπÊÆäÁöÑ‚ÄúÂÉµÂ∞∏ÂØπË±°‚ÄùÔºàÈÄöËøá‰øÆÊîπ isa ÊåáÈíàÔºå‰ª§ÂÖ∂ÊåáÂêëÁâπÊÆäÁöÑÂÉµÂ∞∏Á±ªÔºâÔºåËÄå‰∏ç‰ºöÁúüÊ≠£ÂõûÊî∂ÂÆÉ‰ª¨ÔºåËÄå‰∏îÂÆÉ‰ª¨ÊâÄÂç†ÊçÆÁöÑÊ†∏ÂøÉÂÜÖÂ≠òÂ∞ÜÊó†Ê≥ïË¢´ÈáçÁî®ÔºåËøôÊ†∑‰πüÂ∞±ÈÅøÂÖç‰∫ÜË¶ÜÂÜôÁöÑÊÉÖÂÜµ„ÄÇÂú®ÂÉµÂ∞∏ÂØπË±°Êî∂Âà∞Ê∂àÊÅØÂêéÔºå‰ºöÊäõÂá∫ÂºÇÂ∏∏ÔºåÂÆÉ‰ºöËØ¥ÊòéÂèëÈÄÅËøáÊù•ÁöÑÊ∂àÊÅØÔºå‰πü‰ºöÊèèËø∞ÂõûÊî∂‰πãÂâçÁöÑÈÇ£‰∏™ÂØπË±°„ÄÇ (ÊÑüËßâÂ•ΩÂÉèÁî®Â§Ñ‰∏çÂ§™Â§ßÁöÑÊ†∑Â≠ê„ÄÇ) Á¨¨36Êù°Ôºö‰∏çË¶Å‰ΩøÁî®retainCountARC ÂêéÔºåËøô‰∏™ retainCount ÊñπÊ≥ïÂ∞±Â∫üÂºÉ‰∫Ü„ÄÇÂèçÊ≠£‰ªéÊù•Ê≤°Áî®ËøáÔºå‰πüÂ∞±Ê≤°Âï•Â•ΩÁúãÁöÑ‰∫Ü„ÄÇ Âùó‰∏éÂ§ßÂ∞èÊû¢Ê¥æÂèëÁ¨¨37Êù°ÔºöÁêÜËß£‚ÄúÂùó‚ÄùËøô‰∏ÄÊ¶ÇÂøµÂü∫Êú¨Ê¶ÇÂøµÊó†ÈúÄÂ§öËØ¥ÔºåËøôÈáåÂº∫Ë∞É‰∏Ä‰∏ãÂùóÁöÑÁßçÁ±ª„ÄÇ ÂùóÂàÜ‰∏∫‰∏âÁ±ªÔºö Ê†àÂùó Â†ÜÂùó ÂÖ®Â±ÄÂùó Ê†àÂùóËøôÊòØÊØîËæÉÂÆπÊòìË¢´ÂøΩÁï•ÁöÑ‰∏ÄÂùó„ÄÇÂÆö‰πâÂùóÁöÑÊó∂ÂÄôÔºåÂÖ∂ÊâÄÂç†ÂÜÖÂ≠òÂå∫ÂüüÊòØÂàÜÈÖçÂú®Ê†à‰∏≠ÁöÑÔºåËÄå‰∏îÂè™Âú®ÂÆö‰πâÂÆÉÁöÑÈÇ£‰∏™ËåÉÂõ¥ÂÜÖÊúâÊïàÔºö 1234567891011121314void (^block)();if ( /* some condition */ ) &#123; block = ^&#123; NSLog(@"Block A"); &#125;;&#125; else &#123; block = ^&#123; NSLog(@"Block B"); &#125;;&#125;block(); ‰∏äÈù¢ÂÆö‰πâÁöÑ‰∏§‰∏™ÂùóÂè™Âú® if else ËØ≠Âè•ËåÉÂõ¥ÂÜÖÊúâÊïàÔºå‰∏ÄÊó¶Á¶ªÂºÄ‰∫ÜÊúÄÂêé‰∏Ä‰∏™Âè≥Êã¨Âè∑ÔºåÂ¶ÇÊûúÁºñËØëÂô®Ë¶ÜÂÜô‰∫ÜÂàÜÈÖçÁªôÂùóÁöÑÂÜÖÂ≠òÔºåÈÇ£‰πàÂ∞±‰ºöÈÄ†ÊàêÁ®ãÂ∫èÂ¥©Ê∫É„ÄÇ Âπ∂‰∏çÊòéÁôΩÊääÂùó‰øùÂ≠òÂú®Ê†à‰∏äÊòØ‰∏™‰ªÄ‰πàÊú∫Âà∂„ÄÇÂ∫îËØ•ÂèØ‰ª•Ëøô‰πàÁêÜËß£Âêß:block ÊòØ‰∏Ä‰∏™ÊåáÂêëÊ†à‰∏äÂÜÖÂ≠òÁöÑÊåáÈíàÔºåÊ†àÂíåÂ†ÜÁöÑÂºïÁî®Êú∫Âà∂‰∏çÂêåÔºåÂú®‰ª£Á†ÅÂùóËøêË°åÁªìÊùüÂêéÂ∞±‰ºöÂ∞Ü‰ª£Á†ÅÂùó‰∏≠ÁöÑÂ±ÄÈÉ®ÂèòÈáèÂá∫Ê†àÔºåËøô‰∏™Êó∂ÂÄô block ÊåáÂêëÁöÑÂú∞ÊñπÂ∞±Ë¢´ÂõûÊî∂Ôºåblock Â∞±Êàê‰∫ÜÈáéÊåáÈíàÔºåÂõ†Ê≠§Â∞±‰ºö crash ‰∫Ü„ÄÇ ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨Âπ≥Êó∂Ë¶Å‰πàÂ∞±ÂÆö‰πâÂÆåÂ∞±‰º†Âá∫Âéª‰∫ÜÔºåË¶Å‰πàÂ∞±Êää block ÂÆö‰πâÊàê‰∫ÜÁ±ªÁöÑÂ±ûÊÄßÔºåÊâÄ‰ª•Â∞±Ê≤°ÊúâÂèëÁîüËøáËøôÁßçÊÉÖÂÜµ„ÄÇ Â†ÜÂùóÂπ≥Êó∂ÂØπÂùóÁöÑÊìç‰ΩúËÇØÂÆö‰∏çËÉΩ‰ª•Ê†àÂùóÁöÑÂΩ¢ÂºèÊù•Â≠òÂÇ®Âïä„ÄÇÂ†ÜÂùóÔºåË¶ÅÂú®ÂéüÊù•ÁöÑÂü∫Á°Ä‰∏äÊâßË°å copyÔºåËÆ©‰ª£Á†Å‰øùÂ≠òÂú®Â†Ü‰∏ä„ÄÇ 12345678910111213void (^block)();if ( /* some condition */ ) &#123; block = [^&#123; NSLog(@"Block A"); &#125; copy];&#125; else &#123; block = [^&#123; NSLog(@"Block B"); &#125; copy];&#125;block(); ÁÑ∂Âêé block Â∞±ËÉΩÊåáÂêëÂ†Ü‰∏äÁöÑÂú∞ÂùÄ‰∫Ü„ÄÇ Âπ≥Êó∂Êàë‰ª¨Áî®Â±ûÊÄßÊñπÂºè‰øùÂ≠òÂùóÁöÑÊó∂ÂÄôÈÉΩÊòØËøôÊ†∑Â£∞ÊòéÁöÑÔºö 1@property (nonatomic,copy) Block block; Ëøô‰∏™Â±ûÊÄßÈáåÊöóÂê´‰∫Ü copy Êìç‰Ωú‰∫Ü„ÄÇ block ‰ºöÊçïËé∑Â§ñÈÉ®ÁöÑÂèòÈáèÁöÑÂÄºÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂Â§çÂà∂‰∏∫Ëá™Â∑±ÁßÅÊúâÁöÑ const ÂèòÈáè„ÄÇÊâÄ‰ª•‰∏ÄËà¨‰∏çËÆ©Âú® block ÂÜÖÈÉ®ÊîπÂèòÂ§ñÈÉ®ÂèòÈáèÁöÑÂÄº„ÄÇ‰ΩÜÊòØÂèØ‰ª•Âú®Â§ñÈÉ®ÂèòÈáèÂâçÂä†‰∏ä __block ‰øÆÈ•∞ÔºåËøôÊ†∑Â∞±‰ºöÂ∞ÜÂ§ñÈÉ®ÂèòÈáèÁöÑÂÜÖÂ≠òÊçïËé∑ÔºåËøõËÄå‰∏çÁÆ°Âú® block ÂÜÖÈÉ®ËøòÊòØÂ§ñÈÉ®ÈÉΩÂèØ‰ª•‰øÆÊîπÂèòÈáèÁöÑÂÄº„ÄÇ ÂÖ®Â±ÄÂùóÂú®ÂÖ®Â±ÄÂÜÖÂ≠òÈáåÂ£∞ÊòéÁöÑÂ∞±ÊòØÂÖ®Â±ÄÂùóÔºåÊ≤°Áî®Ëøá„ÄÇ‰∏çÁü•ÈÅìÊúâ‰ªÄ‰πàÂ•ΩÂ§Ñ„ÄÇ Á¨¨38Êù°Ôºö‰∏∫Â∏∏Áî®ÁöÑÂùóÁ±ªÂûãÂàõÂª∫typedefÂ¶ÇÊûúÊàë‰ª¨ÈúÄË¶ÅÈáçÂ§çÂàõÂª∫ÊüêÁßçÂùóÔºàÁõ∏ÂêåÂèÇÊï∞ÔºåËøîÂõûÂÄºÔºâÁöÑÂèòÈáèÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøátypedefÊù•ÁªôÊüê‰∏ÄÁßçÂùóÂÆö‰πâÂ±û‰∫éÂÆÉËá™Â∑±ÁöÑÊñ∞Á±ªÂûãÔºö 123456int (^variableName)(BOOL flag, int value) =^(BOOL flag, int value)&#123; // Implementation return someInt;&#125;- (void)startWithCompletionHandler: (void(^)(NSData *data, NSError *error))completion; Ëøô‰∏™ÂùóÊúâ‰∏Ä‰∏™ bool ÂèÇÊï∞Âíå‰∏Ä‰∏™ int ÂèÇÊï∞ÔºåÂπ∂ËøîÂõû int Á±ªÂûã„ÄÇÊàë‰ª¨ÂèØ‰ª•ÁªôÂÆÉÂÆö‰πâÁ±ªÂûãÔºö 12345678typedef int(^EOCSomeBlock)(BOOL flag, int value);typedef void(^EOCCompletionHandler)(NSData *data, NSError *error);EOCSomeBlock block = ^(BOOL flag, int value)&#123; // Implementation&#125;;- (void)startWithCompletionHandler:(EOCCompletionHandler)completion; Á¨¨39Êù°ÔºöÁî®handlerÂùóÈôç‰Ωé‰ª£Á†ÅÂàÜÊï£Á®ãÂ∫¶ÂèØ‰ª•ÈÄöËøáÂùóÁöÑÊñπÂºè‰ª£Êõø‰ª£ÁêÜÊ®°Âºè„ÄÇ ‰ª£ÁêÜÊ®°Âºè‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜËÆ©ÂÖ∂‰ªñÁ±ªÂú®ÂøÖË¶ÅÊó∂ÂÄôË∞ÉÁî®Ëá™Â∑±Á±ªÁöÑÊñπÊ≥ï„ÄÇËÄå‰ΩøÁî®ÂùóÁöÑÊñπÂºèÂèØ‰ª•Áõ¥Êé•Â∞ÜÊñπÊ≥ïÂÜÖÂÆπ‰Ωú‰∏∫ÂèÇÊï∞ÊàñËÄÖÂ±ûÊÄß‰º†ÂÖ•Ë∞ÉÁî®Âùó„ÄÇËøôÊ†∑ËÆæËÆ°‰∏öÂä°ÈÄªËæëÊõ¥Âä†Áõ¥ËßÇÊ∏ÖÊô∞„ÄÇ Á¨¨40Êù°ÔºöÁî®ÂùóÂºïÁî®ÂÖ∂ÊâÄÂ±ûÂØπË±°Êó∂‰∏çË¶ÅÂá∫Áé∞‰øùÁïôÁéØÊ≥®ÊÑè‰ΩøÁî®ÂùóÁöÑÊó∂ÂÄô‰∏çË¶Å‰∫ßÁîü‰øùÁïôÁéØÔºåË¶ÅÂú®ÂùóÊâßË°åÂÆåÊàêÂêéÔºåÂ∞ÜÂùóÁΩÆ‰∏∫ nil„ÄÇ ‰∏ÄÁßçÊòØ‰º†ÂÖ• weak ÂØπË±°Ôºå‰∏ÄÁßçÊòØÊâßË°åÂÆåÁΩÆ nil„ÄÇÊàëËßâÂæóËøòÊòØ‰º†ÂÖ• weak ÂØπË±°ÊØîËæÉÂ•Ω„ÄÇÂõ†‰∏∫Êàë‰∏çÁü•ÈÅìËøô‰∏™Âùó‰ºö‰∏ç‰ºöÊâßË°å„ÄÇÂ¶ÇÊûú‰∏çÊâßË°åÔºåÈÇ£‰∏çÊòØ‰∏ÄÁõ¥ÈáäÊîæ‰∏ç‰∫Ü‰∫ÜÔºü Á¨¨41Êù°ÔºöÂ§öÁî®Ê¥æÂèëÈòüÂàóÔºåÂ∞ëÁî®ÂêåÊ≠•ÈîÅÂ§ö‰∏™Á∫øÁ®ãÊâßË°åÂêå‰∏Ä‰ªΩ‰ª£Á†ÅÊó∂ÔºåÂæàÂèØËÉΩ‰ºöÈÄ†ÊàêÊï∞ÊçÆ‰∏çÂêåÊ≠•„ÄÇ‰ΩúËÄÖÂª∫ËÆÆ‰ΩøÁî® GCD Êù•‰∏∫‰ª£Á†ÅÂä†ÈîÅÁöÑÊñπÂºèËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ ÊñπÊ°à‰∏ÄÔºö‰ΩøÁî®‰∏≤Ë°åÂêåÊ≠•ÈòüÂàóÊù•Â∞ÜËØªÂÜôÊìç‰ΩúÈÉΩÂÆâÊéíÂà∞Âêå‰∏Ä‰∏™ÈòüÂàóÈáåÔºö1234567891011121314151617_syncQueue = dispatch_queue_create("com.effectiveobjectivec.syncQueue", NULL);//ËØªÂèñÂ≠óÁ¨¶‰∏≤- (NSString*)someString &#123; __block NSString *localSomeString; dispatch_sync(_syncQueue, ^&#123; localSomeString = _someString; &#125;); return localSomeString;&#125;//ËÆæÁΩÆÂ≠óÁ¨¶‰∏≤- (void)setSomeString:(NSString*)someString &#123; dispatch_sync(_syncQueue, ^&#123; _someString = someString; &#125;);&#125; ËøôÈáåÔºåÁî®‰∫Ü‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàóÔºå‰øùËØÅ‰∫ÜËØªÂÜôÊìç‰ΩúÈÉΩÂä†‰∫ÜÈîÅÔºåÊòØ‰∏ÄÁßçËß£ÂÜ≥ÊñπÂºè„ÄÇ‰ΩÜÊòØÔºåÊàë‰ª¨Ë¶ÅÊòéÁ°Æ‰∏ÄÁÇπÔºåÊï∞ÊçÆÁöÑÊ≠£Á°ÆÊÄß‰∏ªË¶ÅÂèñÂÜ≥‰∫éÂÜôÂÖ•Êìç‰ΩúÔºåÂè™Ë¶Å‰øùËØÅÂÜôÂÖ•Êó∂ÔºåÁ∫øÁ®ãÊòØÂÆâÂÖ®ÁöÑÔºåÈÇ£‰πàÂç≥‰æøËØªÂèñÊìç‰ΩúÊòØÂπ∂ÂèëÁöÑÔºå‰πüÂèØ‰ª•‰øùËØÅÊï∞ÊçÆÊòØÂêåÊ≠•ÁöÑ„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨Ë¶ÅÂä†‰ª•ÊîπËøõÔºåËØªÊìç‰ΩúÂπ∂Ë°åÔºåÂÜôÊìç‰Ωú‰∏≤Ë°å„ÄÇÂèØ‰ª•ÈÄöËøá dispatch_barrier_async„ÄÅdispatch_barrier_sync ÂÆåÊàê„ÄÇ Â∞ÜÂÜôÊìç‰ΩúÊîæÂÖ•Ê†ÖÊ†èÂùó‰∏≠ÔºåËÆ©‰ªñ‰ª¨ÂçïÁã¨ÊâßË°åÔºõÂ∞ÜËØªÂèñÊìç‰ΩúÂπ∂ÂèëÊâßË°åÂú®ÈòüÂàó‰∏≠ÔºåÊ†ÖÊ†èÂùóÂøÖÈ°ªÂçïÁã¨ÊâßË°åÔºå‰∏çËÉΩ‰∏éÂÖ∂‰ªñÂùóÂπ∂Ë°å„ÄÇËøôÂè™ÂØπÂπ∂ÂèëÈòüÂàóÊúâÊÑè‰πâÔºåÂõ†‰∏∫‰∏≤Ë°åÈòüÂàó‰∏≠ÁöÑÂùóÊÄªÊòØÊåâÁÖßÈ°∫Â∫èÈÄê‰∏™ÊâßË°å„ÄÇÂπ∂ÂèëÈòüÂàóÂ¶ÇÊûúÂèëÁé∞Êé•‰∏ãÊù•Ë¶ÅÂ§ÑÁêÜÁöÑÂùóÊòØ‰∏™Ê†ÖÊ†èÂùóÔºåÈÇ£‰πàÂ∞±‰∏ÄÁõ¥Á≠âÂà∞ÂΩìÂâçÊâÄÊúâÂπ∂ÂèëÂùóÈÉΩÊâßË°åÂÆåÊØïÔºåÊâç‰ºöÂçïÁã¨ÊâßË°åËøô‰∏™Ê†ÖÊ†èÂùó„ÄÇÂæÖÊ†ÖÊ†èÂùóÊâßË°åËøáÂêéÔºåÂÜçÊåâÊ≠£Â∏∏ÊñπÂºèÁªßÁª≠Âêë‰∏ãÂ§ÑÁêÜ„ÄÇÁõ∏ÂΩì‰∫éÁªôÂπ∂Ë°åÈòüÂàóÈáåÂä†‰∏™ÈîÅ 123456789101112131415161718_syncQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);//ËØªÂèñÂ≠óÁ¨¶‰∏≤- (NSString*)someString &#123; __block NSString *localSomeString; dispatch_sync(_syncQueue, ^&#123; localSomeString = _someString; &#125;); return localSomeString;&#125;//ËÆæÁΩÆÂ≠óÁ¨¶‰∏≤- (void)setSomeString:(NSString*)someString &#123; dispatch_barrier_async(_syncQueue, ^&#123; _someString = someString; &#125;);&#125; ËøôÈáåËß£Èáä‰∏ã‰∏∫‰ªÄ‰πàËØªÂèñÁî®ÁöÑÊòØ syncÔºåÂÜôÂÖ•Áî®ÁöÑÊòØ asyncÔºåÂõ†‰∏∫ËØªÂèñÊòØË¶ÅÊúâËøîÂõûÂÄºÁöÑÔºåË¶ÅÂ∞ÜÂÄºËøîÂõûÁªôË∞ÉÁî®ÁöÑÂØπË±°ÔºåÊÄª‰∏çËÉΩËøòÊ≤°ÊúâÊãøÂà∞ÂÄºÔºåÂ∞±Â∑≤Áªè return ‰∫ÜÂêßÔºõËÄåÂÜôÂÖ•Êìç‰ΩúÊ≤°ÊúâËøîÂõûÂÄºÔºåÈÇ£‰πàÂ∞±ËÆ©ÂÆÉÁ´ãÂç≥ return ÊâßË°åÂêéÈù¢ÁöÑ‰ª£Á†ÅÔºåÂè¶ÂºÄÁ∫øÁ®ãÂÜôÂÖ•„ÄÇ Á¨¨42Êù°ÔºöÂ§öÁî®GCDÔºåÂ∞ëÁî®performSelectorÁ≥ªÂàóÊñπÊ≥ïÂú®iOSÂºÄÂèë‰∏≠ÔºåÊúâÊó∂‰ºö‰ΩøÁî® performSelector Êù•ÊâßË°åÊüê‰∏™ÊñπÊ≥ïÔºå‰ΩÜÊòØ performSelector Á≥ªÂàóÁöÑÊñπÊ≥ïËÉΩÂ§ÑÁêÜÁöÑÈÄâÊã©Â≠êÂæàÂ±ÄÈôêÔºåÊúÄÂ•Ω‰ΩøÁî® GCDÔºö ÂÆÉÊó†Ê≥ïÂ§ÑÁêÜÂ∏¶ÊúâÂ§ö‰∏™ÂèÇÊï∞ÁöÑÈÄâÊã©Â≠êÔºàÊúâÊúÄÂ§öÊîØÊåÅ‰∏§‰∏™ÈÄâÊã©Â≠êÁöÑÊñπÊ≥ïÔºâ ËøîÂõûÂÄºÂè™ËÉΩÊòØvoidÊàñËÄÖÂØπË±°Á±ªÂûã ‰ºöÂºïËµ∑ÂÜÖÂ≠òÊ≥ÑÈú≤ ‰ΩÜÊòØÂ¶ÇÊûúÂ∞ÜÊñπÊ≥ïÊîæÂú®Âùó‰∏≠ÔºåÈÄöËøá GCD Êù•Êìç‰ΩúÂ∞±ËÉΩÂæàÂ•ΩÂú∞Ëß£ÂÜ≥Ëøô‰∫õÈóÆÈ¢ò„ÄÇÂ∞§ÂÖ∂ÊòØÊàë‰ª¨Â¶ÇÊûúÊÉ≥Ë¶ÅËÆ©‰∏Ä‰∏™‰ªªÂä°Âú®Âè¶‰∏Ä‰∏™Á∫øÁ®ã‰∏äÊâßË°åÔºåÊúÄÂ•ΩÂ∫îËØ•Â∞Ü‰ªªÂä°ÊîæÂà∞ÂùóÈáåÔºå‰∫§Áªô GCD Êù•ÂÆûÁé∞ÔºåËÄå‰∏çÊòØÈÄöËøá performSelector ÊñπÊ≥ï„ÄÇ Âª∂ÂêéÊâßË°åÊüê‰∏™‰ªªÂä°ÁöÑÊñπÊ≥ï123456789// ‰ΩøÁî® performSelector:withObject:afterDelay:[self performSelector:@selector(doSomething) withObject:nil afterDelay:5.0];// ‰ΩøÁî® dispatch_afterdispatch_time_t time = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(5.0 * NSEC_PER_SEC));dispatch_after(time, dispatch_get_main_queue(), ^(void)&#123; [self doSomething];&#125;); Â∞Ü‰ªªÂä°ÊîæÂú®‰∏ªÁ∫øÁ®ãÊâßË°å123456789// ‰ΩøÁî® performSelectorOnMainThread:withObject:waitUntilDone:[self performSelectorOnMainThread:@selector(doSomething) withObject:nil waitUntilDone:NO];// ‰ΩøÁî® dispatch_async// (or if waitUntilDone is YES, then dispatch_sync)dispatch_async(dispatch_get_main_queue(), ^&#123; [self doSomething];&#125;); Â¶ÇÊûú waitUntilDone ÁöÑÂèÇÊï∞ÊòØ YesÔºåÈÇ£‰πàÂ∞±ÂØπÂ∫î GCD ÁöÑ dispatch_sync ÊñπÊ≥ï„ÄÇÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ôºå‰ΩøÁî® GCD ÁöÑÊñπÂºèÂèØ‰ª•Â∞ÜÁ∫øÁ®ãÊìç‰Ωú‰ª£Á†ÅÂíåÊñπÊ≥ïË∞ÉÁî®‰ª£Á†ÅÂÜôÂú®Âêå‰∏ÄÂ§ÑÔºå‰∏ÄÁõÆ‰∫ÜÁÑ∂ÔºõËÄå‰∏îÂÆåÂÖ®‰∏çÂèóË∞ÉÁî®ÊñπÊ≥ïÁöÑÈÄâÊã©Â≠êÂíåÊñπÊ≥ïÂèÇÊï∞‰∏™Êï∞ÁöÑÈôêÂà∂„ÄÇ Á¨¨43Êù°ÔºöÊéåÊè°GCDÂèäÊìç‰ΩúÈòüÂàóÁöÑ‰ΩøÁî®Êó∂Êú∫Èô§‰∫Ü GCDÔºåÊìç‰ΩúÈòüÂàóÔºàNSOperationQueueÔºâ‰πüÊòØËß£ÂÜ≥Â§öÁ∫øÁ®ã‰ªªÂä°ÁÆ°ÁêÜÈóÆÈ¢òÁöÑ‰∏Ä‰∏™ÊñπÊ°à„ÄÇÂØπ‰∫é‰∏çÂêåÁöÑÁéØÂ¢ÉÔºåÊàë‰ª¨Ë¶ÅÈááÂèñ‰∏çÂêåÁöÑÁ≠ñÁï•Êù•Ëß£ÂÜ≥ÈóÆÈ¢òÔºöÊúâÊó∂ÂÄô‰ΩøÁî® GCD Â•Ω‰∫õÔºåÊúâÊó∂ÂàôÊòØ‰ΩøÁî®Êìç‰ΩúÈòüÂàóÊõ¥Âä†ÂêàÁêÜ„ÄÇÔºàÂπ∂‰∏çÊ∏ÖÊ•öÊìç‰ΩúÈòüÂàóÊÄé‰πàÁî®ÁöÑÔºåÂèçÊ≠£Â∞±ÊäÑ‰∏Ä‰∏ãÂì™ÈáåÂ•ΩÔºâ ÂèØ‰ª•ÂèñÊ∂àÊìç‰ΩúÔºöÂú®ËøêË°å‰ªªÂä°ÂâçÔºåÂèØ‰ª•Âú®NSOperationÂØπË±°Ë∞ÉÁî® cancel ÊñπÊ≥ïÔºåÊ†áÊòéÊ≠§‰ªªÂä°‰∏çÈúÄË¶ÅÊâßË°å„ÄÇ‰ΩÜÊòØ GCD ÈòüÂàóÊòØÊó†Ê≥ïÂèñÊ∂àÁöÑÔºåÂõ†‰∏∫ÂÆÉÈÅµÂæ™‚ÄúÂÆâÊéíÂ•Ω‰πãÂêéÂ∞±‰∏çÁÆ°‰∫ÜÔºàfire and forgetÔºâ‚ÄùÁöÑÂéüÂàô„ÄÇ ÂèØ‰ª•ÊåáÂÆöÊìç‰ΩúÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ªÔºö‰æãÂ¶Ç‰ªéÊúçÂä°Âô®‰∏ãËΩΩÂπ∂Â§ÑÁêÜÊñá‰ª∂ÁöÑÂä®‰ΩúÂèØ‰ª•Áî®Êìç‰ΩúÊù•Ë°®Á§∫„ÄÇËÄåÂú®Â§ÑÁêÜÂÖ∂‰ªñÊñá‰ª∂‰πãÂâçÂøÖÈ°ªÂÖà‰∏ãËΩΩ‚ÄúÊ∏ÖÂçïÊñá‰ª∂‚Äù„ÄÇËÄåÂêéÁª≠ÁöÑ‰∏ãËΩΩÂ∑•‰ΩúÔºåÈÉΩË¶Å‰æùËµñ‰∫éÂÖà‰∏ãËΩΩÁöÑÊ∏ÖÂçïÊñá‰ª∂Ëøô‰∏ÄÊìç‰Ωú„ÄÇ ÁõëÊéß NSOperation ÂØπË±°ÁöÑÂ±ûÊÄßÔºöÂèØ‰ª•ÈÄöËøá KVO Êù•ÁõëÂê¨ NSOperation ÁöÑÂ±ûÊÄßÔºöÂèØ‰ª•ÈÄöËøá isCancelled Â±ûÊÄßÊù•Âà§Êñ≠‰ªªÂä°ÊòØÂê¶Â∑≤ÂèñÊ∂àÔºõÈÄöËøá isFinished Â±ûÊÄßÊù•Âà§Êñ≠‰ªªÂä°ÊòØÂê¶Â∑≤ÁªèÂÆåÊàê„ÄÇ ÂèØ‰ª•ÊåáÂÆöÊìç‰ΩúÁöÑ‰ºòÂÖàÁ∫ßÔºöÊìç‰ΩúÁöÑ‰ºòÂÖàÁ∫ßË°®Á§∫Ê≠§Êìç‰Ωú‰∏éÈòüÂàó‰∏≠ÂÖ∂‰ªñÊìç‰Ωú‰πãÈó¥ÁöÑ‰ºòÂÖàÂÖ≥Á≥ªÔºåÊàë‰ª¨ÂèØ‰ª•ÊåáÂÆöÂÆÉ„ÄÇ Á¨¨44Êù°ÔºöÈÄöËøáDispath GroupÊú∫Âà∂ÔºåÊ†πÊçÆÁ≥ªÁªüËµÑÊ∫êÁä∂ÂÜµÊù•ÊâßË°å‰ªªÂä°ÊúâÊó∂ÈúÄË¶ÅÁ≠âÂæÖÂ§ö‰∏™Âπ∂Ë°å‰ªªÂä°ÁªìÊùüÁöÑÈÇ£‰∏ÄÂàªÊâßË°åÊüê‰∏™‰ªªÂä°ÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÂèØ‰ª•‰ΩøÁî® dispath group ÂáΩÊï∞Êù•ÂÆûÁé∞Ëøô‰∏™ÈúÄÊ±ÇÔºö ÈÄöËøá dispath group ÂáΩÊï∞ÔºåÂèØ‰ª•ÊääÂπ∂ÂèëÊâßË°åÁöÑÂ§ö‰∏™‰ªªÂä°Âêà‰∏∫‰∏ÄÁªÑÔºå‰∫éÊòØË∞ÉÁî®ËÄÖÂ∞±ÂèØ‰ª•Áü•ÈÅìËøô‰∫õ‰ªªÂä°‰ΩïÊó∂ÊâçËÉΩÂÖ®ÈÉ®ÊâßË°åÂÆåÊØï„ÄÇ 123456789101112131415161718192021222324//‰∏Ä‰∏™‰ºòÂÖàÁ∫ß‰ΩéÁöÑÂπ∂ÂèëÈòüÂàódispatch_queue_t lowPriorityQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0);//‰∏Ä‰∏™‰ºòÂÖàÁ∫ßÈ´òÁöÑÂπ∂ÂèëÈòüÂàódispatch_queue_t highPriorityQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0);//ÂàõÂª∫dispatch_groupdispatch_group_t dispatchGroup = dispatch_group_create();//Â∞Ü‰ºòÂÖàÁ∫ß‰ΩéÁöÑÈòüÂàóÊîæÂÖ•dispatch_groupfor (id object in lowPriorityObjects) &#123; dispatch_group_async(dispatchGroup,lowPriorityQueue,^&#123; [object performTask]; &#125;);&#125;//Â∞Ü‰ºòÂÖàÁ∫ßÈ´òÁöÑÈòüÂàóÊîæÂÖ•dispatch_groupfor (id object in highPriorityObjects) &#123; dispatch_group_async(dispatchGroup,highPriorityQueue,^&#123; [object performTask]; &#125;);&#125;//dispatch_groupÈáåÁöÑ‰ªªÂä°ÈÉΩÁªìÊùüÂêéË∞ÉÁî®Âùó‰∏≠ÁöÑ‰ª£Á†Ådispatch_queue_t notifyQueue = dispatch_get_main_queue();dispatch_group_notify(dispatchGroup,notifyQueue,^&#123; // Continue processing after completing tasks&#125;); ÊÉ≥Ë¶ÅÊõ¥ËØ¶ÁªÜÁöÑ‰∫ÜËß£ÔºåËøòÊòØÁúã‰πãÂâçÁöÑ GCD ‰ªãÁªçÊñáÁ´†Âêß„ÄÇ Á¨¨45Êù°Ôºö‰ΩøÁî®dispatch_onceÊù•ÊâßË°åÂè™ÈúÄËøêË°å‰∏ÄÊ¨°ÁöÑÁ∫øÁ®ãÂÆâÂÖ®‰ª£Á†ÅÊúâÊó∂Êàë‰ª¨ÂèØËÉΩÂè™ÈúÄË¶ÅÂ∞ÜÊüêÊÆµ‰ª£Á†ÅÊâßË°å‰∏ÄÊ¨°ÔºåËøôÊó∂ÂèØ‰ª•ÈÄöËøá dispatch_once ÂáΩÊï∞Êù•Ëß£ÂÜ≥„ÄÇ dispatch_once ÂáΩÊï∞ÊØîËæÉÈáçË¶ÅÁöÑ‰ΩøÁî®‰æãÂ≠êÊòØÂçï‰æãÊ®°ÂºèÔºöÊàë‰ª¨Âú®ÂàõÂª∫Âçï‰æãÊ®°ÂºèÁöÑÂÆû‰æãÊó∂ÔºåÂèØ‰ª•‰ΩøÁî® dispatch_once ÂáΩÊï∞Êù•‰ª§ÂàùÂßãÂåñ‰ª£Á†ÅÂè™ÊâßË°å‰∏ÄÊ¨°ÔºåÂπ∂‰∏îÂÜÖÈÉ®ÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ ËÄå‰∏îÔºåÂØπ‰∫éÊâßË°å‰∏ÄÊ¨°ÁöÑ block Êù•ËØ¥ÔºåÊØèÊ¨°Ë∞ÉÁî®ÂáΩÊï∞Êó∂‰º†ÂÖ•ÁöÑÊ†áËÆ∞ÈÉΩÂøÖÈ°ªÂÆåÂÖ®Áõ∏ÂêåÔºåÈÄöÂ∏∏Ê†áËÆ∞ÂèòÈáèÂ£∞ÊòéÂú® static Êàñ global ‰ΩúÁî®ÂüüÈáå„ÄÇ 12345678+ (id)sharedInstance &#123; static EOCClass *sharedInstance = nil; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; sharedInstance = [[self alloc] init]; &#125;); return sharedInstance;&#125; Á¨¨46Êù°Ôºö‰∏çË¶Å‰ΩøÁî®dispatch_get_current_queueÂõ†‰∏∫Â¶ÇÊûúÊòØÂêåÊ≠•Êìç‰ΩúÁöÑÊó∂ÂÄôÂÜç‰ΩøÁî® dispatch_get_current_queue ‰ºöÈÄ†ÊàêÊ≠ªÈîÅ„ÄÇÊâÄ‰ª• iOS Â∑≤ÁªèÂ∫üÈô§‰∫ÜËøô‰∏™ API„ÄÇ ‰∏ÄËà¨Êàë‰ª¨Áî®ÂÖ∂Âà§Êñ≠ÂΩìÂâçÁ∫øÁ®ãÊòØÂê¶‰∏∫ÁâπÂÆöÁ∫øÁ®ã„ÄÇÊØîÂ¶ÇÔºö 12345678void func(dispatch_queue_t queue, dispatch_block_t block) &#123; if (dispatch_get_current_queue() == queue) &#123; block(); &#125;else&#123; dispatch_sync(queue, block); &#125; &#125; ‰ΩÜÊòØËøôÊ†∑ÊòØÈîôËØØÁöÑ„ÄÇÂõ†‰∏∫Â¶ÇÊûú queue Â∞±ÊòØ current_queue ÁöÑÊó∂ÂÄôÔºåÂπ∂‰∏çÊòØÊâßË°å blockÔºåËÄåÊòØÂèëÁîüÊ≠ªÈîÅ„ÄÇ ÈÇ£‰πàÊàë‰ª¨Â¶Ç‰ΩïËé∑ÂèñÂΩìÂâçÈòüÂàóÂë¢Ôºü‰ΩøÁî® dispatch_queue_set_specific Âèä dispatch_queue_set_specific„ÄÇÊØîÂ¶Ç‰Ω†Âú®Êüê‰∏Ä‰∏™Á±ª‰∏≠ÁöÑÊüê‰∏Ä‰∏™ÊñπÊ≥ïÈáåÈúÄË¶ÅÂà§Êñ≠ÂΩìÂâçÈòüÂàóÊòØ‰∏çÊòØÈòüÂàóÔºå‰∏æ‰∏Ä‰∏™ FMDB ‰∏≠ÁöÑ‰æãÂ≠ê: 123456789static const void * const kDispatchQueueSpecificKey = &amp;kDispatchQueueSpecificKey;// FMDatabaseQueue Êüê‰∏™ÊñπÊ≥ïÂÜÖ_queue = dispatch_queue_create(@"someQueue", NULL);dispatch_queue_set_specific(_queue, kDispatchQueueSpecificKey, (__bridge void *)self, NULL);// Âè¶‰∏Ä‰∏™ÊñπÊ≥ïÂÜÖFMDatabaseQueue *currentSyncQueue = (__bridge id)dispatch_get_specific(kDispatchQueueSpecificKey);assert(currentSyncQueue == nil); ÂÖàÂàõÂª∫‰∫Ü‰∏Ä‰∏™ queue ÁÑ∂ÂêéÈÄöËøá dispatch_queue_set_specific Â∞ÜÁ¨¨‰∏Ä‰∏™ÂÖ•ÂèÇ queue ÂíåÁ¨¨‰∫å‰∏™ÂÖ≥ÈîÆÂ≠ó kDispatchQueueSpecificKey ËøõË°åÂÖ≥ËÅî„ÄÇÊï¥‰∏™ËøáÁ®ãÁöÑ‰∏ä‰∏ãÊñá context ÊòØ selfÔºå‰πüÂ∞±ÊòØËØ¥Â∞ÜËøô‰∏™ÈòüÂàóÂíåÂ≠óÁ¨¶‰∏≤ÁöÑÂÖ≥ËÅîÁªëÂÆöÁªô‰∫ÜÁ¨¨‰∏â‰∏™ÂèÇÊï∞ÔºåËøô‰∏™‰∏ä‰∏ãÊñáÂÆû‰æã‰∏ä‰∫Ü„ÄÇÊ≥®ÊÑèÊòØÁªëÂÆöÁªôÂÆû‰æãÔºåËÄå‰∏çÊòØÁªôÁ±ªÁöÑÔºå‰∏çÂêåÁöÑ context ÂèØ‰ª•‰ΩøÁî®Áõ∏ÂêåÁöÑÂÖ≥ÈîÆÂ≠óÁªëÂÆöÈòüÂàó„ÄÇ ÁÑ∂ÂêéÂú®Ë¶ÅÂà§Êñ≠ÁöÑÊó∂ÂÄôÔºåÂú®ÂéüÂÖàÁöÑ context ‰∏ãÔºå‰ΩøÁî® dispatch_get_specificÔºåÂÖ•ÂèÇ‰∏∫‰πãÂâçËÆæÁΩÆÁöÑÂÖ≥ÈîÆÂ≠ó„ÄÇÂ¶ÇÊûúÂΩìÂâçÈòüÂàó‰∏∫ÁªëÂÆöÁöÑÈòüÂàóÔºåÈÇ£‰πàÂ∞Ü‰∏äÈù¢ÁöÑÁ¨¨‰∏â‰∏™ÂèÇÊï∞ context ÂÆû‰æãËøîÂõûÔºåÂê¶ÂàôËøîÂõû nil„ÄÇ Á≥ªÁªüÊ°ÜÊû∂Á¨¨47Êù°ÔºöÁÜüÊÇâÁ≥ªÁªüÊ°ÜÊû∂‰∏ªË¶ÅÁöÑÁ≥ªÁªüÊ°ÜÊû∂Ôºö Foundation :NSObject,NSArray,NSDictionary Á≠â CFoundation :C ËØ≠Ë®Ä APIÔºåFoundation Ê°ÜÊû∂‰∏≠ÁöÑËÆ∏Â§öÂäüËÉΩÔºåÈÉΩÂèØ‰ª•Âú®ËøôÈáåÊâæÂà∞ÂØπÂ∫îÁöÑ C ËØ≠Ë®Ä API CFNetwork :C ËØ≠Ë®Ä APIÔºåÊèê‰æõ‰∫Ü C ËØ≠Ë®ÄÁ∫ßÂà´ÁöÑÁΩëÁªúÈÄö‰ø°ËÉΩÂäõ CoreAudio :C ËØ≠Ë®Ä APIÔºåÊìç‰ΩúËÆæÂ§á‰∏äÁöÑÈü≥È¢ëÁ°¨‰ª∂ AVFoundation:Êèê‰æõÁöÑ OC ÂØπË±°ÂèØ‰ª•ÂõûÊîæÂπ∂ÂΩïÂà∂Èü≥È¢ëÂíåËßÜÈ¢ë CoreData :OC ÁöÑ APIÔºåÂ∞ÜÂØπË±°ÂÜôÂÖ•Êï∞ÊçÆÂ∫ì CoreText :C ËØ≠Ë®Ä APIÔºåÈ´òÊïàÊâßË°åÊñáÂ≠óÊéíÁâàÂíåÊ∏≤ÊüìÊìç‰Ωú Á¨¨48Êù°ÔºöÂ§öÁî®ÂùóÊûö‰∏æÔºåÂ∞ëÁî®forÂæ™ÁéØ‰º†ÁªüÁöÑforÈÅçÂéÜ1234567891011121314151617181920212223242526NSArray *anArray = /* ... */;for (int i = 0; i &lt; anArray.count; i++) &#123; id object = anArray[i]; // Do something with 'object'&#125;// DictionaryNSDictionary *aDictionary = /* ... */;NSArray *keys = [aDictionary allKeys];for (int i = 0; i &lt; keys.count; i++) &#123; id key = keys[i]; id value = aDictionary[key]; // Do something with 'key' and 'value'&#125;// SetNSSet *aSet = /* ... */;NSArray *objects = [aSet allObjects];for (int i = 0; i &lt; objects.count; i++) &#123; id object = objects[i]; // Do something with 'object'&#125; Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÂú®ÈÅçÂéÜ NSDictionary,Âíå NSet Êó∂ÔºåÊàë‰ª¨ÂèàÊñ∞ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êï∞ÁªÑ„ÄÇËôΩÁÑ∂ÈÅçÂéÜÁöÑÁõÆÁöÑËææÊàê‰∫ÜÔºå‰ΩÜÊòØÂç¥Âä†Â§ß‰∫ÜÁ≥ªÁªüÁöÑÂºÄÈîÄ„ÄÇ Âà©Áî®Âø´ÈÄüÈÅçÂéÜ123456789101112131415161718NSArray *anArray = /* ... */;for (id object in anArray) &#123; // Do something with 'object'&#125;// DictionaryNSDictionary *aDictionary = /* ... */;for (id key in aDictionary) &#123; id value = aDictionary[key]; // Do something with 'key' and 'value'&#125;NSSet *aSet = /* ... */;for (id object in aSet) &#123; // Do something with 'object'&#125; ËøôÁßçÂø´ÈÄüÈÅçÂéÜÁöÑÊñπÊ≥ïË¶ÅÊØî‰º†ÁªüÁöÑÈÅçÂéÜÊñπÊ≥ïÊõ¥Âä†ÁÆÄÊ¥ÅÊòìÊáÇÔºå‰ΩÜÊòØÁº∫ÁÇπÊòØÊó†Ê≥ïÊñπ‰æøËé∑ÂèñÂÖÉÁ¥†ÁöÑ‰∏ãÊ†á„ÄÇ Âà©Áî®Âü∫‰∫éÂùóÔºàblockÔºâÁöÑÈÅçÂéÜoc Êèê‰æõ‰∫ÜÊñ∞ÁöÑÈÅçÂéÜÊñπÂºèÔºå‰∏é for Âæ™ÁéØÁõ∏ÊØîÔºåËÉΩÂ§ü‰ºòÈõÖÁöÑËé∑ÂæóÂÖÉÁ¥†ÁöÑ‰∏ãÊ†áÔºö 123456// array- (void)enumerateObjectsUsingBlock:(void(^)(id object,NSUInteger idx,BOOL *stop))block// set- (void)enumerateObjectsUsingBlock:(void(^)(id object,BOOL *stop))block// dic- (void)enumerateObjectsUsingBlock:(void(^)(id key,id object,BOOL *stop))block ÂÖ∂‰∏≠ÂèØ‰ª•ÈÄöËøá *stop = YES Êù•‰∏≠ÈÄîÁªàÊ≠¢ÈÅçÂéÜ„ÄÇÊ≥®ÊÑè‰∏ÄÂÆöË¶ÅÂ∏¶ *„ÄÇ ÂêéÈù¢Âá†‰∏™Ê≤°Âï•ÊÑèÊÄù„ÄÇÁî®ÁöÑ‰∏çÂ§öÔºå‰∏çÂÜô‰∫Ü„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Objective-C</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS‰∏≠ÁöÑÂ§öÁ∫øÁ®ãÂ≠¶‰π†Á¨îËÆ∞]]></title>
    <url>%2F2016%2F11%2F01%2FiOS%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[Âú®Â≠¶‰π† RunLoop ÁöÑÊó∂ÂÄôÔºåÁ¢∞Âà∞‰∫Ü‰∏Ä‰∫õ‰∏çÂ§™ÁêÜËß£ÁöÑ‰∏úË•øÔºåÊü•ÈòÖËµÑÊñôÂêéÂèëÁé∞ÊòØÂ§öÁ∫øÁ®ãÁöÑÁõ∏ÂÖ≥ÊñπÊ≥ï„ÄÇÂõ†Ê≠§Âú®ÂÆåÊàê RunLoop ÁöÑÁ¨îËÆ∞ÂâçÔºåÂÖàÂ≠¶‰π†‰∏ãÂ§öÁ∫øÁ®ãÁöÑ‰ΩøÁî®ÊñπÊ≥ï„ÄÇ ÂèØ‰ª•ÈÄöËøá‰∏âÁßçÊñπÂºèÂÆûÁé∞ iOS ÁöÑÂ§öÁ∫øÁ®ãÔºö NSThread GCD NSOperation&amp;NSOperationQueue NSThreadÂàõÂª∫Âπ∂ÂêØÂä®ÂÖàÂàõÂª∫Á∫øÁ®ãÁ±ªÔºåÂÜçÂêØÂä®1234// ÂàõÂª∫NSThread *thread = [[NSThread alloc] initWithTarget:self selector:@selector(run:) object:nil];// ÂêØÂä®[thread start]; ÂÖ∂‰∏≠Ôºårun: ÊòØÂç≥Â∞ÜÊâßË°åÁöÑÊñπÊ≥ïÔºåobject ÊòØ run: ÊñπÊ≥ïÁöÑÂèÇÊï∞„ÄÇËßÑÂÆö run: ÊñπÊ≥ïÊúÄÂ§öÂèØÊúâ‰∏Ä‰∏™ÂèÇÊï∞Ôºå‰∏îËøîÂõûÁ±ªÂûãÂøÖÈ°ªÊòØ void„ÄÇ ÂàõÂª∫Âπ∂Ëá™Âä®ÂêØÂä®1[NSThread detachNewThreadSelector:@selector(run:) toTarget:self withObject:nil]; ‰ΩøÁî® NSObject ÁöÑÊñπÊ≥ïÂàõÂª∫Âπ∂Ëá™Âä®ÂêØÂä®1[self performSelectorInBackground:@selector(run:) withObject:nil]; ÂÖ∂‰ªñÊñπÊ≥ïÈô§‰∫ÜÂàõÂª∫ÂêØÂä®Â§ñÔºåNSThread Ëøò‰ª•ÂæàÂ§öÊñπÊ≥ïÔºå‰∏ãÈù¢ÊàëÂàó‰∏æ‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÊñπÊ≥ïÔºåÂΩìÁÑ∂ÊàëÂàó‰∏æÁöÑÂπ∂‰∏çÂÆåÊï¥ÔºåÊõ¥Â§öÊñπÊ≥ïÂèØ‰ª•ÂéªÁ±ªÁöÑÂÆö‰πâÈáåÂéªÁúã„ÄÇ 123456789101112131415161718192021222324//ÂèñÊ∂àÁ∫øÁ®ã- (void)cancel;//ÂêØÂä®Á∫øÁ®ã- (void)start;//Âà§Êñ≠Êüê‰∏™Á∫øÁ®ãÁöÑÁä∂ÊÄÅÁöÑÂ±ûÊÄß@property (readonly, getter=isExecuting) BOOL executing;@property (readonly, getter=isFinished) BOOL finished;@property (readonly, getter=isCancelled) BOOL cancelled;//ËÆæÁΩÆÂíåËé∑ÂèñÁ∫øÁ®ãÂêçÂ≠ó-(void)setName:(NSString *)n;-(NSString *)name;//Ëé∑ÂèñÂΩìÂâçÁ∫øÁ®ã‰ø°ÊÅØ+ (NSThread *)currentThread;//Ëé∑Âèñ‰∏ªÁ∫øÁ®ã‰ø°ÊÅØ+ (NSThread *)mainThread;//‰ΩøÂΩìÂâçÁ∫øÁ®ãÊöÇÂÅú‰∏ÄÊÆµÊó∂Èó¥ÔºåÊàñËÄÖÊöÇÂÅúÂà∞Êüê‰∏™Êó∂Âàª+ (void)sleepForTimeInterval:(NSTimeInterval)time;+ (void)sleepUntilDate:(NSDate *)date; GCDËØ•ÈÉ®ÂàÜÂâç‰∏ÄÁØáÂÖ≥‰∫é GCD ÁöÑÊñáÁ´†Â∑≤ÁªèËæÉ‰∏∫ËØ¶ÁªÜÁöÑÁ†îÁ©∂Ëøá‰∫Ü„ÄÇ NSOperationÂàõÂª∫NSOperation ÊòØ‰∏™ÊäΩË±°Á±ªÔºå‰∏çËÉΩÁî®Êù•Â∞ÅË£ÖÊìç‰Ωú„ÄÇÊàë‰ª¨Âè™Êúâ‰ΩøÁî®ÂÆÉÁöÑÂ≠êÁ±ªÊù•Â∞ÅË£ÖÊìç‰Ωú„ÄÇÊàë‰ª¨Êúâ‰∏âÁßçÊñπÂºèÊù•Â∞ÅË£ÖÊìç‰Ωú„ÄÇ ‰ΩøÁî®Â≠êÁ±ª NSInvocationOperation ‰ΩøÁî®Â≠êÁ±ª NSBlockOperation Ëá™ÂÆö‰πâÁªßÊâøËá™ NSOperation ÁöÑÂ≠êÁ±ªÔºåÈÄöËøáÂÆûÁé∞ÂÜÖÈÉ®Áõ∏Â∫îÁöÑÊñπÊ≥ïÊù•Â∞ÅË£ÖÊìç‰Ωú„ÄÇ Âú®‰∏ç‰ΩøÁî® NSOperationQueueÔºåÂçïÁã¨‰ΩøÁî® NSOperation ÁöÑÊÉÖÂÜµ‰∏ãÁ≥ªÁªüÂêåÊ≠•ÊâßË°åÊìç‰ΩúÔºå‰∏ãÈù¢Êàë‰ª¨Â≠¶‰π†‰ª•‰∏ãÊìç‰ΩúÁöÑ‰∏§ÁßçÂàõÂª∫ÊñπÂºè„ÄÇ NSOperation ‰∏ÄÂ§ß‰ºòÁÇπÂ∞±ÊòØÂèØ‰ª•ÈÄöËøá cancel ÊñπÊ≥ïÂèñÊ∂à NSOperation ËøòÂèØ‰ª•ÈÄöËøá KVO ÁõëÂê¨ finished ‰ª•Âèä executing Áä∂ÊÄÅ NSInvocationOperation 123456789101112131415161718192021/** * ‰ΩøÁî®Â≠êÁ±ª NSInvocationOperation */- (void)useInvocationOperation &#123; // 1.ÂàõÂª∫ NSInvocationOperation ÂØπË±° NSInvocationOperation *op = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(task1) object:nil]; // 2.Ë∞ÉÁî® start ÊñπÊ≥ïÂºÄÂßãÊâßË°åÊìç‰Ωú [op start];&#125;/** * ‰ªªÂä°1 */- (void)task1 &#123; for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"1---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125;&#125; Âú®Ê≤°Êúâ‰ΩøÁî® NSOperationQueue„ÄÅÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÂçïÁã¨‰ΩøÁî®‰ΩøÁî®Â≠êÁ±ª NSInvocationOperation ÊâßË°å‰∏Ä‰∏™Êìç‰ΩúÁöÑÊÉÖÂÜµ‰∏ãÔºåÊìç‰ΩúÊòØÂú®ÂΩìÂâçÁ∫øÁ®ãÊâßË°åÁöÑÔºåÂπ∂Ê≤°ÊúâÂºÄÂêØÊñ∞Á∫øÁ®ã„ÄÇ NSBlockOperation12345678910111213141516/** * ‰ΩøÁî®Â≠êÁ±ª NSBlockOperation */- (void)useBlockOperation &#123; // 1.ÂàõÂª∫ NSBlockOperation ÂØπË±° NSBlockOperation *op = [NSBlockOperation blockOperationWithBlock:^&#123; for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"1---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125; &#125;]; // 2.Ë∞ÉÁî® start ÊñπÊ≥ïÂºÄÂßãÊâßË°åÊìç‰Ωú [op start];&#125; Âú®Ê≤°Êúâ‰ΩøÁî® NSOperationQueue„ÄÅÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÂçïÁã¨‰ΩøÁî® NSBlockOperation ÊâßË°å‰∏Ä‰∏™Êìç‰ΩúÁöÑÊÉÖÂÜµ‰∏ãÔºåÊìç‰ΩúÊòØÂú®ÂΩìÂâçÁ∫øÁ®ãÊâßË°åÁöÑÔºåÂπ∂Ê≤°ÊúâÂºÄÂêØÊñ∞Á∫øÁ®ã„ÄÇ ‰ΩÜÊòØÔºåNSBlockOperation ËøòÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÊñπÊ≥ï addExecutionBlock:ÔºåÈÄöËøá addExecutionBlock: Â∞±ÂèØ‰ª•‰∏∫ NSBlockOperation Ê∑ªÂä†È¢ùÂ§ñÁöÑÊìç‰Ωú„ÄÇËøô‰∫õÊìç‰ΩúÔºàÂåÖÊã¨ blockOperationWithBlock ‰∏≠ÁöÑÊìç‰ΩúÔºâÂèØ‰ª•Âú®‰∏çÂêåÁöÑÁ∫øÁ®ã‰∏≠ÂêåÊó∂ÔºàÂπ∂ÂèëÔºâÊâßË°å„ÄÇÂè™ÊúâÂΩìÊâÄÊúâÁõ∏ÂÖ≥ÁöÑÊìç‰ΩúÂ∑≤ÁªèÂÆåÊàêÊâßË°åÊó∂ÔºåÊâçËßÜ‰∏∫ÂÆåÊàê„ÄÇ ‰ΩøÁî®Â≠êÁ±ª NSBlockOperationÔºåÂπ∂Ë∞ÉÁî®ÊñπÊ≥ï AddExecutionBlock: ÁöÑÊÉÖÂÜµ‰∏ãÔºåblockOperationWithBlock:ÊñπÊ≥ï‰∏≠ÁöÑÊìç‰Ωú Âíå addExecutionBlock: ‰∏≠ÁöÑÊìç‰ΩúÊòØÂú®‰∏çÂêåÁöÑÁ∫øÁ®ã‰∏≠ÂºÇÊ≠•ÊâßË°åÁöÑ„ÄÇËÄå‰∏îÔºåËøôÊ¨°ÊâßË°åÁªìÊûú‰∏≠ blockOperationWithBlock:ÊñπÊ≥ï‰∏≠ÁöÑÊìç‰Ωú‰πü‰∏çÊòØÂú®ÂΩìÂâçÁ∫øÁ®ãÔºà‰∏ªÁ∫øÁ®ãÔºâ‰∏≠ÊâßË°åÁöÑ„ÄÇ‰ªéËÄåÂç∞ËØÅ‰∫ÜblockOperationWithBlock: ‰∏≠ÁöÑÊìç‰Ωú‰πüÂèØËÉΩ‰ºöÂú®ÂÖ∂‰ªñÁ∫øÁ®ãÔºàÈùûÂΩìÂâçÁ∫øÁ®ãÔºâ‰∏≠ÊâßË°å„ÄÇ ÂàõÂª∫ÈòüÂàóNSOperationQueue ‰∏ÄÂÖ±Êúâ‰∏§ÁßçÈòüÂàóÔºö‰∏ªÈòüÂàó„ÄÅËá™ÂÆö‰πâÈòüÂàó„ÄÇÂÖ∂‰∏≠Ëá™ÂÆö‰πâÈòüÂàóÂêåÊó∂ÂåÖÂê´‰∫Ü‰∏≤Ë°å„ÄÅÂπ∂ÂèëÂäüËÉΩ„ÄÇ‰∏ãËæπÊòØ‰∏ªÈòüÂàó„ÄÅËá™ÂÆö‰πâÈòüÂàóÁöÑÂü∫Êú¨ÂàõÂª∫ÊñπÊ≥ïÂíåÁâπÁÇπ„ÄÇ ‰∏ªÈòüÂàó Âá°ÊòØÊ∑ªÂä†Âà∞‰∏ªÈòüÂàó‰∏≠ÁöÑÊìç‰ΩúÔºåÈÉΩ‰ºöÊîæÂà∞‰∏ªÁ∫øÁ®ã‰∏≠ÊâßË°å„ÄÇ 12// ‰∏ªÈòüÂàóËé∑ÂèñÊñπÊ≥ïNSOperationQueue *queue = [NSOperationQueue mainQueue]; Ëá™ÂÆö‰πâÈòüÂàóÔºàÈùû‰∏ªÈòüÂàóÔºâ Ê∑ªÂä†Âà∞ËøôÁßçÈòüÂàó‰∏≠ÁöÑÊìç‰ΩúÔºåÂ∞±‰ºöËá™Âä®ÊîæÂà∞Â≠êÁ∫øÁ®ã‰∏≠ÊâßË°å„ÄÇ ÂêåÊó∂ÂåÖÂê´‰∫ÜÔºö‰∏≤Ë°å„ÄÅÂπ∂ÂèëÂäüËÉΩ„ÄÇ 12// Ëá™ÂÆö‰πâÈòüÂàóÂàõÂª∫ÊñπÊ≥ïNSOperationQueue *queue = [[NSOperationQueue alloc] init]; Â∞ÜÊìç‰ΩúÂä†ÂÖ•Âà∞ÈòüÂàó‰∏≠‰∏äËæπÊàë‰ª¨ËØ¥Âà∞ NSOperation ÈúÄË¶ÅÈÖçÂêà NSOperationQueue Êù•ÂÆûÁé∞Â§öÁ∫øÁ®ã„ÄÇ ÈÇ£‰πàÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂàõÂª∫Â•ΩÁöÑÊìç‰ΩúÂä†ÂÖ•Âà∞ÈòüÂàó‰∏≠Âéª„ÄÇÊÄªÂÖ±Êúâ‰∏§ÁßçÊñπÊ≥ï„ÄÇ - (void)addOperation:(NSOperation *)op;ÈúÄË¶ÅÂÖàÂàõÂª∫Êìç‰ΩúÔºåÂÜçÂ∞ÜÂàõÂª∫Â•ΩÁöÑÊìç‰ΩúÂä†ÂÖ•Âà∞ÂàõÂª∫Â•ΩÁöÑÈòüÂàó‰∏≠Âéª„ÄÇ 12345678910111213141516171819202122232425262728293031323334/** * ‰ΩøÁî® addOperation: Â∞ÜÊìç‰ΩúÂä†ÂÖ•Âà∞Êìç‰ΩúÈòüÂàó‰∏≠ */- (void)addOperationToQueue &#123; // 1.ÂàõÂª∫ÈòüÂàó NSOperationQueue *queue = [[NSOperationQueue alloc] init]; // 2.ÂàõÂª∫Êìç‰Ωú // ‰ΩøÁî® NSInvocationOperation ÂàõÂª∫Êìç‰Ωú1 NSInvocationOperation *op1 = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(task1) object:nil]; // ‰ΩøÁî® NSInvocationOperation ÂàõÂª∫Êìç‰Ωú2 NSInvocationOperation *op2 = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(task2) object:nil]; // ‰ΩøÁî® NSBlockOperation ÂàõÂª∫Êìç‰Ωú3 NSBlockOperation *op3 = [NSBlockOperation blockOperationWithBlock:^&#123; for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"3---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125; &#125;]; [op3 addExecutionBlock:^&#123; for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"4---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125; &#125;]; // 3.‰ΩøÁî® addOperation: Ê∑ªÂä†ÊâÄÊúâÊìç‰ΩúÂà∞ÈòüÂàó‰∏≠ [queue addOperation:op1]; // [op1 start] [queue addOperation:op2]; // [op2 start] [queue addOperation:op3]; // [op3 start]&#125; ‰ΩøÁî® NSOperation Â≠êÁ±ªÂàõÂª∫Êìç‰ΩúÔºåÂπ∂‰ΩøÁî® addOperation: Â∞ÜÊìç‰ΩúÂä†ÂÖ•Âà∞Êìç‰ΩúÈòüÂàóÂêéËÉΩÂ§üÂºÄÂêØÊñ∞Á∫øÁ®ãÔºåËøõË°åÂπ∂ÂèëÊâßË°å„ÄÇ - (void)addOperationWithBlock:(void (^)(void))block;Êó†ÈúÄÂÖàÂàõÂª∫Êìç‰ΩúÔºåÂú® block ‰∏≠Ê∑ªÂä†Êìç‰ΩúÔºåÁõ¥Êé•Â∞ÜÂåÖÂê´Êìç‰ΩúÁöÑ block Âä†ÂÖ•Âà∞ÈòüÂàó‰∏≠ 12345678910111213141516171819202122232425262728/** * ‰ΩøÁî® addOperationWithBlock: Â∞ÜÊìç‰ΩúÂä†ÂÖ•Âà∞Êìç‰ΩúÈòüÂàó‰∏≠ */- (void)addOperationWithBlockToQueue &#123; // 1.ÂàõÂª∫ÈòüÂàó NSOperationQueue *queue = [[NSOperationQueue alloc] init]; // 2.‰ΩøÁî® addOperationWithBlock: Ê∑ªÂä†Êìç‰ΩúÂà∞ÈòüÂàó‰∏≠ [queue addOperationWithBlock:^&#123; for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"1---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125; &#125;]; [queue addOperationWithBlock:^&#123; for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"2---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125; &#125;]; [queue addOperationWithBlock:^&#123; for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"3---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125; &#125;];&#125; ‰ΩøÁî® addOperationWithBlock: Â∞ÜÊìç‰ΩúÂä†ÂÖ•Âà∞Êìç‰ΩúÈòüÂàóÂêéËÉΩÂ§üÂºÄÂêØÊñ∞Á∫øÁ®ãÔºåËøõË°åÂπ∂ÂèëÊâßË°å. NSOperationQueue ÊéßÂà∂‰∏≤Ë°åÊâßË°å„ÄÅÂπ∂ÂèëÊâßË°åËøôÈáåÊúâ‰∏™ÂÖ≥ÈîÆÂ±ûÊÄß maxConcurrentOperationCountÔºåÂè´ÂÅöÊúÄÂ§ßÂπ∂ÂèëÊìç‰ΩúÊï∞„ÄÇÁî®Êù•ÊéßÂà∂‰∏Ä‰∏™ÁâπÂÆöÈòüÂàó‰∏≠ÂèØ‰ª•ÊúâÂ§öÂ∞ë‰∏™Êìç‰ΩúÂêåÊó∂ÂèÇ‰∏éÂπ∂ÂèëÊâßË°å„ÄÇ Ê≥®ÊÑèÔºöËøôÈáå maxConcurrentOperationCount ÊéßÂà∂ÁöÑ‰∏çÊòØÂπ∂ÂèëÁ∫øÁ®ãÁöÑÊï∞ÈáèÔºåËÄåÊòØ‰∏Ä‰∏™ÈòüÂàó‰∏≠ÂêåÊó∂ËÉΩÂπ∂ÂèëÊâßË°åÁöÑÊúÄÂ§ßÊìç‰ΩúÊï∞„ÄÇËÄå‰∏î‰∏Ä‰∏™Êìç‰Ωú‰πüÂπ∂ÈùûÂè™ËÉΩÂú®‰∏Ä‰∏™Á∫øÁ®ã‰∏≠ËøêË°å„ÄÇ ÊúÄÂ§ßÂπ∂ÂèëÊìç‰ΩúÊï∞Ôºö 1maxConcurrentOperationCount maxConcurrentOperationCount ÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏∫-1ÔºåË°®Á§∫‰∏çËøõË°åÈôêÂà∂ÔºåÂèØËøõË°åÂπ∂ÂèëÊâßË°å„ÄÇ maxConcurrentOperationCount ‰∏∫1Êó∂ÔºåÈòüÂàó‰∏∫‰∏≤Ë°åÈòüÂàó„ÄÇÂè™ËÉΩ‰∏≤Ë°åÊâßË°å„ÄÇ maxConcurrentOperationCount Â§ß‰∫é1Êó∂ÔºåÈòüÂàó‰∏∫Âπ∂ÂèëÈòüÂàó„ÄÇÊìç‰ΩúÂπ∂ÂèëÊâßË°åÔºåÂΩìÁÑ∂Ëøô‰∏™ÂÄº‰∏çÂ∫îË∂ÖËøáÁ≥ªÁªüÈôêÂà∂ÔºåÂç≥‰ΩøËá™Â∑±ËÆæÁΩÆ‰∏Ä‰∏™ÂæàÂ§ßÁöÑÂÄºÔºåÁ≥ªÁªü‰πü‰ºöËá™Âä®Ë∞ÉÊï¥‰∏∫ min{Ëá™Â∑±ËÆæÂÆöÁöÑÂÄºÔºåÁ≥ªÁªüËÆæÂÆöÁöÑÈªòËÆ§ÊúÄÂ§ßÂÄº}„ÄÇ NSOperationÊìç‰Ωú‰æùËµñNSOperation„ÄÅNSOperationQueue ÊúÄÂê∏Âºï‰∫∫ÁöÑÂú∞ÊñπÊòØÂÆÉËÉΩÊ∑ªÂä†Êìç‰Ωú‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ª„ÄÇÈÄöËøáÊìç‰Ωú‰æùËµñÔºåÊàë‰ª¨ÂèØ‰ª•ÂæàÊñπ‰æøÁöÑÊéßÂà∂Êìç‰Ωú‰πãÈó¥ÁöÑÊâßË°åÂÖàÂêéÈ°∫Â∫è„ÄÇNSOperation Êèê‰æõ‰∫Ü3‰∏™Êé•Âè£‰æõÊàë‰ª¨ÁÆ°ÁêÜÂíåÊü•Áúã‰æùËµñ„ÄÇ - (void)addDependency:(NSOperation *)op; Ê∑ªÂä†‰æùËµñÔºå‰ΩøÂΩìÂâçÊìç‰Ωú‰æùËµñ‰∫éÊìç‰Ωú op ÁöÑÂÆåÊàê„ÄÇ - (void)removeDependency:(NSOperation *)op; ÁßªÈô§‰æùËµñÔºåÂèñÊ∂àÂΩìÂâçÊìç‰ΩúÂØπÊìç‰Ωú op ÁöÑ‰æùËµñ„ÄÇ @property (readonly, copy) NSArray&lt;NSOperation *&gt; *dependencies; Âú®ÂΩìÂâçÊìç‰ΩúÂºÄÂßãÊâßË°å‰πãÂâçÂÆåÊàêÊâßË°åÁöÑÊâÄÊúâÊìç‰ΩúÂØπË±°Êï∞ÁªÑ„ÄÇ ÂΩìÁÑ∂ÔºåÊàë‰ª¨ÁªèÂ∏∏Áî®Âà∞ÁöÑËøòÊòØÊ∑ªÂä†‰æùËµñÊìç‰Ωú„ÄÇÁé∞Âú®ËÄÉËôëËøôÊ†∑ÁöÑÈúÄÊ±ÇÔºåÊØîÂ¶ÇËØ¥Êúâ A„ÄÅB ‰∏§‰∏™Êìç‰ΩúÔºåÂÖ∂‰∏≠ A ÊâßË°åÂÆåÊìç‰ΩúÔºåB ÊâçËÉΩÊâßË°åÊìç‰Ωú„ÄÇ Â¶ÇÊûú‰ΩøÁî®‰æùËµñÊù•Â§ÑÁêÜÁöÑËØùÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅËÆ©Êìç‰Ωú B ‰æùËµñ‰∫éÊìç‰Ωú A„ÄÇÂÖ∑‰Ωì‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930/** * Êìç‰Ωú‰æùËµñ * ‰ΩøÁî®ÊñπÊ≥ïÔºöaddDependency: */- (void)addDependency &#123; // 1.ÂàõÂª∫ÈòüÂàó NSOperationQueue *queue = [[NSOperationQueue alloc] init]; // 2.ÂàõÂª∫Êìç‰Ωú NSBlockOperation *op1 = [NSBlockOperation blockOperationWithBlock:^&#123; for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"1---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125; &#125;]; NSBlockOperation *op2 = [NSBlockOperation blockOperationWithBlock:^&#123; for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"2---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125; &#125;]; // 3.Ê∑ªÂä†‰æùËµñ [op2 addDependency:op1]; // ËÆ©op2 ‰æùËµñ‰∫é op1ÔºåÂàôÂÖàÊâßË°åop1ÔºåÂú®ÊâßË°åop2 // 4.Ê∑ªÂä†Êìç‰ΩúÂà∞ÈòüÂàó‰∏≠ [queue addOperation:op1]; [queue addOperation:op2];&#125; ÈÄöËøáÊ∑ªÂä†Êìç‰Ωú‰æùËµñÔºåÊó†ËÆ∫ËøêË°åÂá†Ê¨°ÔºåÂÖ∂ÁªìÊûúÈÉΩÊòØ op1 ÂÖàÊâßË°åÔºåop2 ÂêéÊâßË°å„ÄÇ NSOperation ‰ºòÂÖàÁ∫ßNSOperation Êèê‰æõ‰∫ÜqueuePriorityÔºà‰ºòÂÖàÁ∫ßÔºâÂ±ûÊÄßÔºåqueuePriorityÂ±ûÊÄßÈÄÇÁî®‰∫éÂêå‰∏ÄÊìç‰ΩúÈòüÂàó‰∏≠ÁöÑÊìç‰ΩúÔºå‰∏çÈÄÇÁî®‰∫é‰∏çÂêåÊìç‰ΩúÈòüÂàó‰∏≠ÁöÑÊìç‰Ωú„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÊâÄÊúâÊñ∞ÂàõÂª∫ÁöÑÊìç‰ΩúÂØπË±°‰ºòÂÖàÁ∫ßÈÉΩÊòØNSOperationQueuePriorityNormal„ÄÇ‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•ÈÄöËøásetQueuePriority:ÊñπÊ≥ïÊù•ÊîπÂèòÂΩìÂâçÊìç‰ΩúÂú®Âêå‰∏ÄÈòüÂàó‰∏≠ÁöÑÊâßË°å‰ºòÂÖàÁ∫ß„ÄÇ ÂÖ∂‰ªñNSNotification ‰∏é Â§öÁ∫øÁ®ãNSNotification Âú®Âì™‰∏™Á∫øÁ®ã postÔºåÊúÄÁªàÂ∞±‰ºöÂú®Âì™‰∏™Á∫øÁ®ãÊâßË°å„ÄÇÂ¶ÇÊûúÊàë‰ª¨‰∏çÊòØÂú®‰∏ªÁ∫øÁ®ã post ÁöÑÔºå‰ΩÜÊòØÂç¥Âú®‰∏ªÁ∫øÁ®ãÊé•Êî∂ÁöÑÔºåËÄå‰∏îÊàë‰ª¨ÊúüÊúõ selector Âú®‰∏ªÁ∫øÁ®ãÊâßË°å„ÄÇËøôÊó∂ÂÄôÊàë‰ª¨ÈúÄË¶ÅÊ≥®ÊÑè‰∏ãÔºåÂú® selector ÈúÄË¶Å dispatch Âà∞‰∏ªÁ∫øÁ®ãÊâçÂèØ‰ª• 12345678910111213141516171819202122232425@implementation BLPostNotification- (void)postNotification &#123; dispatch_queue_t queue = dispatch_queue_create("com.bool.post.notification", DISPATCH_QUEUE_SERIAL); dispatch_async(queue, ^&#123; // ‰ªéÈùû‰∏ªÁ∫øÁ®ãÂèëÈÄÅÈÄöÁü• ÔºàÈÄöÁü•ÂêçÂ≠óÊúÄÂ•ΩÂÆö‰πâÊàê‰∏Ä‰∏™Â∏∏ÈáèÔºâ [[NSNotificationCenter defaultCenter] postNotificationName:@"downloadImage" object:nil]; &#125;);&#125;@end@implementation ImageViewController- (void)viewDidLoad &#123; [super viewDidLoad]; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(show) name:@"downloadImage" object:nil];&#125;- (void)showImage &#123; // ÈúÄË¶Å dispatch Âà∞‰∏ªÁ∫øÁ®ãÊõ¥Êñ∞ UI dispatch_async(dispatch_get_main_queue(), ^&#123; // update UI &#125;);&#125;@end Á∫øÁ®ãÂêåÊ≠•‰∫íÊñ•ÈîÅ‰ΩøÁî® @synchronized: 123@synchronized(self) &#123; //ÈúÄË¶ÅÊâßË°åÁöÑ‰ª£Á†ÅÂùó&#125; ÂêåÊ≠•ÊâßË°åÊääÂ§ö‰∏™Á∫øÁ®ãÈÉΩË¶ÅÊâßË°åÊ≠§ÊÆµ‰ª£Á†ÅÊ∑ªÂä†Âà∞Âêå‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàóÔºåËøôÊ†∑Â∞±ÂÆûÁé∞‰∫ÜÁ∫øÁ®ãÂêåÊ≠•ÁöÑÊ¶ÇÂøµ„ÄÇ ‰ªéÂÖ∂‰ªñÁ∫øÁ®ãÂõûÂà∞‰∏ªÁ∫øÁ®ãÁöÑÊñπÊ≥ïÂú®ÂÖ∂‰ªñÁ∫øÁ®ãÊìç‰ΩúÂÆåÊàêÂêéÂøÖÈ°ªÂà∞‰∏ªÁ∫øÁ®ãÊõ¥Êñ∞UI NSThread1[self performSelectorOnMainThread:@selector(run) withObject:nil waitUntilDone:NO]; GCD123dispatch_async(dispatch_get_main_queue(), ^&#123; ...&#125;); NSOperation1234567891011121314151617181920212223242526/** * Á∫øÁ®ãÈó¥ÈÄö‰ø° */- (void)communication &#123; // 1.ÂàõÂª∫ÈòüÂàó NSOperationQueue *queue = [[NSOperationQueue alloc]init]; // 2.Ê∑ªÂä†Êìç‰Ωú [queue addOperationWithBlock:^&#123; // ÂºÇÊ≠•ËøõË°åËÄóÊó∂Êìç‰Ωú for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"1---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125; // ÂõûÂà∞‰∏ªÁ∫øÁ®ã [[NSOperationQueue mainQueue] addOperationWithBlock:^&#123; // ËøõË°å‰∏Ä‰∫õ UI Âà∑Êñ∞Á≠âÊìç‰Ωú for (int i = 0; i &lt; 2; i++) &#123; [NSThread sleepForTimeInterval:2]; // Ê®°ÊãüËÄóÊó∂Êìç‰Ωú NSLog(@"2---%@", [NSThread currentThread]); // ÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ã &#125; &#125;]; &#125;];&#125; ÈîÅËá™ÊóãÈîÅÂÆö‰πâËá™ÊóãÈîÅ‰∏ç‰ºöÂºïËµ∑Ë∞ÉÁî®ËÄÖÁù°Áú†ÔºåËÄåÊòØ‰∏çÂÅúÁöÑÂæ™ÁéØÔºåÁõ¥Âà∞ÈîÅË¢´ÈáäÊîæ„ÄÇÈÄÇÁî®‰∫éÂ§öÊ†∏„ÄÇ OSSpinLockiOS ‰∏≠ÁöÑËá™ÊóãÈîÅ‰∏∫ OSSpinLock„ÄÇ‰ΩÜÊòØ‰∏çÂª∫ËÆÆ‰ΩøÁî®„ÄÇÂõ†‰∏∫‰ºö‰∫ßÁîü‰ºòÂÖàÁ∫ßÂèçËΩ¨ÁöÑÁé∞Ë±°„ÄÇ ‰ºòÂÖàÁ∫ßÂèçËΩ¨Áî±‰∫éÁ∫øÁ®ãÂ≠òÂú®‰ºòÂÖàÁ∫ßÔºåÂç≥Ê†πÊçÆ‰ºòÂÖàÁ∫ßÊù•ÂàÜÈÖç CPU ÊâßË°åÊó∂Èó¥„ÄÇ‰ΩÜÊòØ‰ºö‰∫ßÁîüÈóÆÈ¢òÔºöÂ¶ÇÊûú‰∏Ä‰∏™‰Ωé‰ºòÂÖàÁ∫ßÁöÑÁ∫øÁ®ãËé∑ÂæóÈîÅÂπ∂ËÆøÈóÆÂÖ±‰∫´ËµÑÊ∫êÔºåËøôÊó∂‰∏Ä‰∏™È´ò‰ºòÂÖàÁ∫ßÁöÑÁ∫øÁ®ã‰πüÂ∞ùËØïËé∑ÂæóËøô‰∏™ÈîÅÔºåÂÆÉ‰ºöÂ§Ñ‰∫é spin lock ÁöÑÂøôÁ≠âÁä∂ÊÄÅ‰ªéËÄåÂç†Áî®Â§ßÈáè CPU„ÄÇÊ≠§Êó∂‰Ωé‰ºòÂÖàÁ∫ßÁ∫øÁ®ãÊó†Ê≥ï‰∏éÈ´ò‰ºòÂÖàÁ∫ßÁ∫øÁ®ã‰∫âÂ§∫ CPU Êó∂Èó¥Ôºå‰ªéËÄåÂØºËá¥‰ªªÂä°ËøüËøüÂÆå‰∏çÊàê„ÄÅÊó†Ê≥ïÈáäÊîæ lock„ÄÇ ÁâπÁÇπÁî±‰∫é‰∏çÂÅúÂæ™ÁéØÔºåÈÅøÂÖç‰∫ÜÁ∫øÁ®ã‰∏ä‰∏ãÊñáÂàáÊç¢ÁöÑÊó∂Èó¥ÊçüËÄó„ÄÇÂú®ËÉΩÂø´ÈÄüËé∑ÂèñËµÑÊ∫êÁöÑÂ§öÁ∫øÁ®ãÁéØÂ¢É‰∏≠ÈÄüÂ∫¶ÊúÄÂø´„ÄÇ ‰∫íÊñ•ÈîÅÂÆö‰πâÈ°æÂêçÊÄù‰πâÔºåÁ≠âÂæÖÈîÅÁöÑÁ∫øÁ®ã‰ºöÂ§Ñ‰∫é‰ºëÁú†Áä∂ÊÄÅ„ÄÇ Â∏∏ËßÅÁ±ªÂûã iOS ‰ΩøÁî®‰ª• pthread_mutex ‰∏∫Âü∫Á°ÄÁöÑÂêÑÁßçÂ∞ÅË£Ö„ÄÇÂ∏∏ËßÅ‰∏âÁßçÁ±ªÂûãÔºö PTHREAD_MUTEX_NORMAL PTHREAD_MUTEX_ERRORCHECK PTHREAD_MUTEX_RECURSIVE NSLockÈíàÂØπÁ¨¨‰∫åÁßçÁ±ªÂûãÔºåiOS Â∞ÅË£Ö‰∫Ü NSLock„ÄÇÂÆÉ‰ºöÊçüÂ§±‰∏ÄÂÆöÊÄßËÉΩÊç¢Êù•ÈîôËØØÊèêÁ§∫„ÄÇÂπ∂ÁÆÄÂåñÁõ¥Êé•‰ΩøÁî® pthread_mutex ÁöÑÂÆö‰πâ„ÄÇ 1234567891011121314151617181920212223//‰∏ªÁ∫øÁ®ã‰∏≠NSLock *lock = [[NSLock alloc] init]; //Á∫øÁ®ã1 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; [lock lock]; NSLog(@"Á∫øÁ®ã1"); sleep(2); [lock unlock]; NSLog(@"Á∫øÁ®ã1Ëß£ÈîÅÊàêÂäü"); &#125;); //Á∫øÁ®ã2 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; sleep(1);//‰ª•‰øùËØÅËÆ©Á∫øÁ®ã2ÁöÑ‰ª£Á†ÅÂêéÊâßË°å [lock lock]; NSLog(@"Á∫øÁ®ã2"); [lock unlock]; &#125;);2016-08-19 14:23:09.659 ThreadLockControlDemo[1754:129663] Á∫øÁ®ã12016-08-19 14:23:11.663 ThreadLockControlDemo[1754:129663] Á∫øÁ®ã1Ëß£ÈîÅÊàêÂäü2016-08-19 14:23:11.665 ThreadLockControlDemo[1754:129659] Á∫øÁ®ã2 NSReursiveLock Âíå @synchronizedÈíàÂØπÁ¨¨‰∏âÁßçÁ±ªÂûãÔºåiOS Â∞ÅË£Ö‰∫Ü NSRecursiveLock Âíå @synchronized„ÄÇÂÆÉ‰ª¨ÊòØÈÄíÂΩíÈîÅÔºå‰πüÂ∞±ÊòØËØ¥Âêå‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•ÈáçÂ§çËé∑ÂèñÈÄíÂΩíÈîÅÔºå‰∏ç‰ºöÊ≠ªÈîÅ„ÄÇNSRecursiveLock Âíå NSLock ‰ΩøÁî®Á±ª‰ºº„ÄÇ @synchronized ÂÆûÁé∞ÂéüÁêÜ@synchronized ‰∏≠‰º†ÂÖ•ÁöÑobjectÁöÑÂÜÖÂ≠òÂú∞ÂùÄÔºåË¢´Áî®‰ΩúkeyÔºåÁ≥ªÁªüÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÈÄíÂΩíÈîÅÔºå‰Ωú‰∏∫ÂÄºÔºå‰øùÂ≠òÂú®‰∏Ä‰∏™ hash map ‰∏≠„ÄÇÊØèÂΩìÂÜçÊ¨°ÈÅáÂà∞ @synchronized ÂÖ≥ÈîÆÂ≠óÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÂà∞ hash map ‰∏≠ÂæóÂà∞Ëøô‰∏™ÈîÅÔºåÂπ∂‰∏îÂ∞ùËØïËé∑ÂèñËøô‰∏™ÈîÅÔºåÂ§±Ë¥•ÂàôÊåÇËµ∑„ÄÇ ÊâÄ‰ª•ÔºåÂ¶ÇÊûúobject Ë¢´Â§ñÈÉ®ËÆøÈóÆÂèòÂåñÔºå@synchronized Â∞±Â§±Âéª‰∫ÜÈîÅÁöÑ‰ΩúÁî®„ÄÇÂõ†Ê≠§‰∏ÄÂÆöË¶ÅÊ≥®ÊÑèÔºå‰∏çËÉΩÊîπÂèò object ÁöÑÂú∞ÂùÄ„ÄÇ ËøôÊòØ‰∏Ä‰∏™ËÄÉÁÇπÔºå@synchronized Â¶Ç‰ΩïÂÆûÁé∞ÁöÑ NSConditionLockÂè¶Â§ñËøòÊúâ‰∏ÄÁßçÊù°‰ª∂ÈîÅNSConditionLock„ÄÇÂü∫‰∫é pthread_cond_t ÂÆûÁé∞„ÄÇÂè™Êúâ condition ÂèÇÊï∞‰∏éÂàùÂßãÂåñÊó∂ÂÄôÁöÑ condition Áõ∏Á≠âÔºålock ÊâçËÉΩÊ≠£Á°ÆËøõË°åÂä†ÈîÅÊìç‰Ωú„ÄÇ 123456789101112131415161718192021//‰∏ªÁ∫øÁ®ã‰∏≠NSConditionLock *lock = [[NSConditionLock alloc] initWithCondition:0];//Á∫øÁ®ã1dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; [lock lockWhenCondition:1]; NSLog(@"Á∫øÁ®ã1"); sleep(2); [lock unlock];&#125;);//Á∫øÁ®ã2dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; if ([lock lockWhenCondition:0]) &#123; NSLog(@"Á∫øÁ®ã2"); [lock unlockWithCondition:1]; NSLog(@"Á∫øÁ®ã2Ëß£ÈîÅÊàêÂäü"); &#125; else &#123; NSLog(@"Á∫øÁ®ã2Â∞ùËØïÂä†ÈîÅÂ§±Ë¥•"); &#125;&#125;); NSConditionLock Â∞±ÈíàÂØπ‰∫éÂ§ö‰∏™Á∫øÁ®ãÂú®Â§çÂà∂Âú∫ÊôØ‰∏ãÁöÑÂêåÊ≠•„ÄÇ ‰ø°Âè∑ÈáèÂÆö‰πâ‰ø°Âè∑ÈáèÁöÑÂàùÂßãÂÄºÔºåÂèØ‰ª•Áî®Êù•ÊéßÂà∂Á∫øÁ®ãÂπ∂ÂèëËÆøÈóÆÁöÑÊúÄÂ§ßÊï∞Èáè„ÄÇ‰ø°Âè∑ÈáèÁöÑÂàùÂßãÂÄº‰∏∫1Ôºå‰ª£Ë°®ÂêåÊó∂Âè™ÂÖÅËÆ∏1Êù°Á∫øÁ®ãËÆøÈóÆËµÑÊ∫êÔºå‰øùËØÅÁ∫øÁ®ãÂêåÊ≠•„ÄÇ ‰ø°Âè∑ÈáèÊòØË¥üÂá†ÔºåÂ∞±Ë°®Á§∫ÊúâÂá†‰∏™Á∫øÁ®ãÂú®Á≠âÂæÖËµÑÊ∫ê„ÄÇ dispatch_semaphore123456dispatch_semaphore_t signal = dispatch_semaphore_create(1);// Â¶ÇÊûú‰ø°Âè∑ÈáèÁöÑÂÄº &gt; 0ÔºåÂ∞±ËÆ©‰ø°Âè∑ÈáèÁöÑÂÄºÂáè1ÔºåÁÑ∂ÂêéÁªßÁª≠ÂæÄ‰∏ãÊâßË°å‰ª£Á†Å// Â¶ÇÊûú‰ø°Âè∑ÈáèÁöÑÂÄº &lt;= 0ÔºåÂ∞±‰ºö‰ºëÁú†Á≠âÂæÖÔºåÁõ¥Âà∞‰ø°Âè∑ÈáèÁöÑÂÄºÂèòÊàê&gt;0ÔºåÂ∞±ËÆ©‰ø°Âè∑ÈáèÁöÑÂÄºÂáè1ÔºåÁÑ∂ÂêéÁªßÁª≠ÂæÄ‰∏ãÊâßË°å‰ª£Á†Ådispatch_semaphore_wait(signal, DISPATCH_TIME_FOREVER);// ËÆ©‰ø°Âè∑ÈáèÁöÑÂÄº+1dispatch_semaphore_signal(signal); ‰ø°Âè∑ÈáèÂíå‰∫íÊñ•ÈîÅÁöÑÂå∫Âà´ËôΩÁÑ∂ Semaphore=1Êó∂ÂèØ‰ª•ÁúãÊàê‰∫íÊñ•ÈîÅÔºå‰ΩÜÊòØÂÆÉ‰ª¨ÁúüÊ≠£ÁöÑ‰ΩøÁî®Âú∫ÊôØÊòØÊúâÂ∑ÆÂà´ÁöÑ„ÄÇ ÈîÅÊòØÊúçÂä°‰∫éÂÖ±‰∫´ËµÑÊ∫êÁöÑÔºõËÄåsemaphoreÊòØÊúçÂä°‰∫éÂ§ö‰∏™Á∫øÁ®ãÈó¥ÁöÑÊâßË°åÁöÑÈÄªËæëÈ°∫Â∫èÁöÑ„ÄÇÊØîÂ¶ÇÔºåa Âíå b ÊâßË°åÂÆå‰∫ÜÂÜçÊâßË°å cÔºåÂ∞±ÂèØ‰ª•ÈÄöËøá‰ø°Âè∑ÈáèÂÆûÁé∞Ôºå‰ΩÜÊòØÊó†Ê≥ïÈÄöËøá‰∫íÊñ•ÈîÅÂÆûÁé∞„ÄÇ ‰∫åÂÖÉ‰ø°Âè∑ÈáèÂíå‰∫íÊñ•ÈîÅÁöÑÂå∫Âà´Âú®„ÄäÁ®ãÂ∫èÂëòÁöÑËá™Êàë‰øÆÂÖª„Äã‰∏≠ÊèêÂèäÔºå‰ø°Âè∑Èáè‰Ωú‰∏∫ IPC ÁöÑ‰∏ÄÁßçÊñπÂºèÔºåÂèØ‰ª•Âú®ÈùûÂΩìÂâçËøõÁ®ãÈáäÊîæÔºåËÄå‰∫íÊñ•ÈîÅÂè™ËÉΩÂú®ÂΩìÂâçËøõÁ®ã‰∏≠ÈáäÊîæ„ÄÇ ‰ª•‰∏äËØ¥Ê≥ïÊòØÂÖ≥‰∫éËøõÁ®ãÁöÑÔºåÂú®Á∫øÁ®ã‰∏≠ÁöÑËØïÈ™åÁªìÊûúÊòØÈÉΩÂèØ‰ª•ÈáäÊîæ„ÄÇ Êù°‰ª∂ÂèòÈáèÂíå‰ø°Âè∑ÈáèÂå∫Âà´ÊØè‰∏™‰ø°Âè∑ÈáèÊúâ‰∏Ä‰∏™‰∏é‰πãÂÖ≥ËÅîÁöÑÂÄºÔºåÂèëÂá∫Êó∂+1ÔºåÁ≠âÂæÖÊó∂-1Ôºå‰ªª‰ΩïÁ∫øÁ®ãÈÉΩÂèØ‰ª•ÂèëÂá∫‰∏Ä‰∏™‰ø°Âè∑ÔºåÂç≥‰ΩøÊ≤°ÊúâÁ∫øÁ®ãÂú®Á≠âÂæÖËØ•‰ø°Âè∑ÈáèÁöÑÂÄº„ÄÇ ÂèØÊòØÂØπ‰∫éÊù°‰ª∂ÂèòÈáèÔºå‰æãÂ¶Ç pthread_cond_signal ÂèëÂá∫‰ø°Âè∑ÂêéÔºåÊ≤°Êúâ‰ªª‰ΩïÁ∫øÁ®ãÈòªÂ°ûÂú® pthread_cond_wait ‰∏äÔºåÈÇ£Ëøô‰∏™Êù°‰ª∂ÂèòÈáè‰∏äÁöÑ‰ø°Âè∑‰ºöÁõ¥Êé•‰∏¢Â§±Êéâ„ÄÇ ÈÄüÂ∫¶ÊØîËæÉOSSpinLock &gt; dispatch_semaphore &gt; pthread_mutex &gt; NSLock &gt; NSRecursiveLock &gt; NSConditionLock &gt; @synchronized Â¶Ç‰Ωï‰ΩøÁî®‰∫íÊñ•ÈîÅÂÆûÁé∞ËØªÂÜôÈîÅÔºü1234567891011121314151617181920212223242526272829303132333435363738394041class readwrite_lock&#123;public: readwrite_lock() : read_cnt(0) &#123; &#125; void readLock() &#123; read_mtx.lock(); if (++read_cnt == 1) write_mtx.lock(); read_mtx.unlock(); &#125; void readUnlock() &#123; read_mtx.lock(); if (--read_cnt == 0) write_mtx.unlock(); read_mtx.unlock(); &#125; void writeLock() &#123; write_mtx.lock(); &#125; void writeUnlock() &#123; write_mtx.unlock(); &#125;private: mutex read_mtx; mutex write_mtx; int read_cnt; // Â∑≤Âä†ËØªÈîÅ‰∏™Êï∞&#125;; ÂÖ∂‰ªñÈóÆÈ¢ò i++ Âú®‰∏§‰∏™Á∫øÁ®ã‰∏≠ÂàÜÂà´ÊâßË°å100Ê¨°Ôºå‰∏çÂä†ÈîÅÔºåÊúÄÂêé i ÁöÑÂèñÂÄºËåÉÂõ¥Ôºü 2-200Ôºå200 ÁöÑÊÉÖÂÜµ‰∏çÁî®Â§öËØ¥Ôºå2 ÁöÑÊÉÖÂÜµÊòØÔºö ‰∏§‰∏™Á∫øÁ®ãÂêåÊó∂ËØªÂèñ‰∫ÜÂàùÂßãÂÄº 0„ÄÇ Á∫øÁ®ã1ÊâßË°å‰∫Ü 99 Ê¨°ÔºåÂÜôÂõû„ÄÇÊ≠§Êó∂ÂÜÖÂ≠ò‰∏∫ 99„ÄÇ Á∫øÁ®ã2ÊâßË°å‰∫Ü‰∏ÄÊ¨°ÔºåÂÜôÂõû„ÄÇÊ≠§Êó∂ÂÜÖÂ≠ò‰∏∫ 1„ÄÇ ‰∏§‰∏™Á∫øÁ®ãÂêåÊó∂ËØªÂèñÂÄº 1„ÄÇ Á∫øÁ®ã2ÊâßË°å 99 Ê¨°ÔºåÂÜôÂõû„ÄÇÊ≠§Êó∂ÂÜÖÂ≠ò‰∏∫ 99 Á∫øÁ®ã1ÊâßË°å1Ê¨°ÔºåÂÜôÂõû„ÄÇÊ≠§Êó∂ÂÜÖÂ≠ò‰∏∫ 2 ÈóÆÈ¢òÁöÑÂÖ≥ÈîÆÂú®‰∫éÔºå‰∏Ä‰∏™Á∫øÁ®ãÁöÑÂÜôÂÖ•‰∏éËØªÂèñËøô‰∏§‰∏™Êìç‰Ωú‰πãÈó¥ÔºåÂèØ‰ª•Á©øÊèíÂà´ÁöÑÁ∫øÁ®ãÁöÑÂÜôÂÖ•Êìç‰Ωú„ÄÇ ÂèÇËÄÉË∞à iOS ÁöÑÈîÅ iOSÂ§öÁ∫øÁ®ãÔºö„ÄéNSOperation„ÄÅNSOperationQueue„ÄèËØ¶Â∞ΩÊÄªÁªì]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[runLoopÂ≠¶‰π†Á¨îËÆ∞]]></title>
    <url>%2F2016%2F11%2F01%2Frunloop%2F</url>
    <content type="text"><![CDATA[runLoop ËôΩÁÑ∂Âπ≥Êó∂ÂæàÂ∞ëÁî®Âà∞Ôºå‰ΩÜÊòØÈù¢ËØïÁöÑÊó∂ÂÄôÈóÆÁöÑÂ§öÂïä„ÄÇÈÇ£Êàë‰πüÂ∞±Êù•‰∫ÜËß£‰∏Ä‰∏ã runLoop ÁöÑÂéüÁêÜ„ÄÇ Ê¶ÇÂøµ‰ªÄ‰πàÊòØRunLoop‰ª•‰∏ãÊòØ‰∏Ä‰∏™ iOS Á®ãÂ∫èÁöÑ main ÂáΩÊï∞Ôºö 12345int main(int argc, char * argv[]) &#123; @autoreleasepool &#123; return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class])); &#125;&#125; main ÂáΩÊï∞ÊòØÁ®ãÂ∫èÁöÑÂÖ•Âè£ÔºåÈÇ£‰πà‰∏∫‰ªÄ‰πàÁ®ãÂ∫èÊâßË°åÂÆåÊØïÂêéÊ≤°ÊúâÈÄÄÂá∫Âë¢ÔºüÂõ†‰∏∫ RunLoopÔºå‰ΩøÁ∫øÁ®ãÂæ™ÁéØÔºåËÉΩÂ§üÈöèÊó∂Â§ÑÁêÜ‰∫ã‰ª∂‰ΩÜÂπ∂‰∏çÈÄÄÂá∫„ÄÇËøôÁßçÊñπÂºèÂú®ÂêÑ‰∏™Ê°ÜÊû∂‰∏≠ÈÉΩÊúâÂÆûÁé∞ÔºåÊØîÂ¶Ç Node.js ÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÔºåÊØîÂ¶Ç Windows Á®ãÂ∫èÁöÑÊ∂àÊÅØÂæ™ÁéØÔºåÂÖ≥ÈîÆÁÇπÂú®‰∫éÔºöÂ¶Ç‰ΩïÁÆ°ÁêÜ‰∫ã‰ª∂/Ê∂àÊÅØÔºåÂ¶Ç‰ΩïËÆ©Á∫øÁ®ãÂú®Ê≤°ÊúâÂ§ÑÁêÜÊ∂àÊÅØÊó∂‰ºëÁú†‰ª•ÈÅøÂÖçËµÑÊ∫êÂç†Áî®„ÄÅÂú®ÊúâÊ∂àÊÅØÂà∞Êù•Êó∂Á´ãÂàªË¢´Âî§ÈÜí„ÄÇ ‰∏äÈù¢‰ª£Á†Å‰∏≠ UIApplicationMain() ÊñπÊ≥ïÂú®ËøôÈáå‰∏ç‰ªÖÂÆåÊàê‰∫ÜÂàùÂßãÂåñÊàë‰ª¨ÁöÑÁ®ãÂ∫èÂπ∂ËÆæÁΩÆÁ®ãÂ∫è Delegate ÁöÑ‰ªªÂä°ÔºåËÄå‰∏îÈöè‰πãÂºÄÂêØ‰∫Ü‰∏ªÁ∫øÁ®ãÁöÑ RunLoopÔºåÂºÄÂßãÊé•ÂèóÂ§ÑÁêÜ‰∫ã‰ª∂„ÄÇËøôÊ†∑Êàë‰ª¨ÁöÑÂ∫îÁî®Â∞±ÂèØ‰ª•Âú®Êó†‰∫∫Êìç‰ΩúÁöÑÊó∂ÂÄô‰ºëÊÅØÔºåÈúÄË¶ÅËÆ©ÂÆÉÂπ≤Ê¥ªÁöÑÊó∂ÂÄôÂèàËÉΩÁ´ãÈ©¨ÂìçÂ∫î„ÄÇÊµÅÁ®ãÂõæÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö Âú® OS X/iOS Á≥ªÁªü‰∏≠ÔºåÊèê‰æõ‰∫Ü‰∏§‰∏™ËøôÊ†∑ÁöÑÂØπË±°Ôºö CFRunLoopRefÔºöÊòØÂú® CoreFoundation Ê°ÜÊû∂ÂÜÖÁöÑÔºåÂÆÉÊèê‰æõ‰∫ÜÁ∫Ø C ÂáΩÊï∞ÁöÑ APIÔºåÊâÄÊúâËøô‰∫õ API ÈÉΩÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ NSRunLoopÔºöÊòØÂü∫‰∫é CFRunLoopRef ÁöÑÂ∞ÅË£ÖÔºåÊèê‰æõ‰∫ÜÈù¢ÂêëÂØπË±°ÁöÑ APIÔºå‰ΩÜÊòØËøô‰∫õ API ‰∏çÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ ÂÖàÊù•‰∏ÄÂº† RunLoop Êú∫Âà∂ÂÖ≥Á≥ªÂõæÊÄªËßàÔºö RunLoop‰∏éÁ∫øÁ®ãÁöÑÂÖ≥Á≥ªËãπÊûú‰∏çÂÖÅËÆ∏Áõ¥Êé•ÂàõÂª∫ RunLoopÔºåÊèê‰æõ‰∫Ü‰∏§‰∏™Ëé∑ÂèñÂáΩÊï∞ÔºåCFRunLoopRef ÁöÑËé∑ÂèñÊñπÊ≥ï‰∏∫ CFRunLoopGetMain()Ôºå CFRunLoopGetCurrent()„ÄÇNSRunLoop ÁöÑËé∑ÂèñÊñπÊ≥ïÊòØ currentRunLoop,mainRunLoop„ÄÇNSRunLoop ÂØπË±°ÂèØ‰ª•ÈÄöËøá getCFRunLoop ÊñπÊ≥ïËé∑Âæó CFRunLoopRef ÂØπË±°„ÄÇCFRunLoopRef ÁöÑÂÜÖÈÉ®ÈÄªËæëÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738/// ÂÖ®Â±ÄÁöÑ DictionaryÔºåkey ÊòØ pthread_tÔºå value ÊòØ CFRunLoopRefstatic CFMutableDictionaryRef loopsDic;/// ËÆøÈóÆ loopsDic Êó∂ÁöÑÈîÅstatic CFSpinLock_t loopsLock; /// Ëé∑Âèñ‰∏Ä‰∏™ pthread ÂØπÂ∫îÁöÑ Run Loop„ÄÇCFRunLoopRef _CFRunLoopGet(pthread_t thread) &#123; OSSpinLockLock(&amp;loopsLock); if (!loopsDic) &#123; // Á¨¨‰∏ÄÊ¨°ËøõÂÖ•Êó∂ÔºåÂàùÂßãÂåñÂÖ®Â±ÄDicÔºåÂπ∂ÂÖà‰∏∫‰∏ªÁ∫øÁ®ãÂàõÂª∫‰∏Ä‰∏™ Run Loop„ÄÇ loopsDic = CFDictionaryCreateMutable(); CFRunLoopRef mainLoop = _CFRunLoopCreate(); CFDictionarySetValue(loopsDic, pthread_main_thread_np(), mainLoop); &#125; /// Áõ¥Êé•‰ªé Dictionary ÈáåËé∑Âèñ„ÄÇ CFRunLoopRef loop = CFDictionaryGetValue(loopsDic, thread)); if (!loop) &#123; /// Âèñ‰∏çÂà∞Êó∂ÔºåÂàõÂª∫‰∏Ä‰∏™ loop = _CFRunLoopCreate(); CFDictionarySetValue(loopsDic, thread, loop); /// Ê≥®ÂÜå‰∏Ä‰∏™ÂõûË∞ÉÔºåÂΩìÁ∫øÁ®ãÈîÄÊØÅÊó∂ÔºåÈ°∫‰æø‰πüÈîÄÊØÅÂÖ∂ÂØπÂ∫îÁöÑ Run Loop„ÄÇ _CFSetTSD(..., thread, loop, __CFFinalizeRunLoop); &#125; OSSpinLockUnLock(&amp;loopsLock); return loop;&#125; CFRunLoopRef CFRunLoopGetMain() &#123; return _CFRunLoopGet(pthread_main_thread_np());&#125; CFRunLoopRef CFRunLoopGetCurrent() &#123; return _CFRunLoopGet(pthread_self());&#125; ‰ªé‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂèØ‰ª•ÁúãÂá∫ÔºåÁ∫øÁ®ãÂíå RunLoop ‰πãÈó¥ÊòØ‰∏Ä‰∏ÄÂØπÂ∫îÁöÑ(Ëøô‰πüÂ∞±Ëß£Èáä‰∫ÜÂâçÈù¢ÂÖ≥Á≥ªÂõæ‰∏≠ CFRunLoop Âíå Thread ËøûÁ∫ø‰∏≠ÁöÑ‰∏§‰∏™1ÁöÑÊÑè‰πâ)ÔºåÂÖ∂ÂÖ≥Á≥ªÊòØ‰øùÂ≠òÂú®‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑ Dictionary Èáå„ÄÇÁ∫øÁ®ãÂàöÂàõÂª∫Êó∂Âπ∂Ê≤°Êúâ RunLoopÔºåÂ¶ÇÊûú‰Ω†‰∏ç‰∏ªÂä®Ëé∑ÂèñÔºåÈÇ£ÂÆÉ‰∏ÄÁõ¥ÈÉΩ‰∏ç‰ºöÊúâÔºåÊâÄ‰ª•‰∏Ä‰∏™Â≠êÁ∫øÁ®ãÔºå‰Ω†ÊÉ≥Ë¶ÅÂÆÉÊúâ RunLoop Â∞±ÂøÖÈ°ªÂú®ËØ•Á∫øÁ®ãÂÜÖË∞ÉÁî® NSRunLoop *runLoop =[NSRunLoop currentRunLoop]„ÄÇÂ¶ÇÊûú‰Ω†ÊÉ≥ÂêØÂä®Ëøô‰∏™ RunLoopÔºåÂàôË¶ÅÁªßÁª≠Ë∞ÉÁî® [runLoop run]„ÄÇ‰ΩÜÊòØÊ≥®ÊÑèÔºå‰∏ÄËà¨‰∏çÈúÄË¶ÅÂºÄÂêØÂ≠êÁ∫øÁ®ãÁöÑ runLoopÔºåÂõ†‰∏∫Ëøô‰ºöËÆ©Â≠êÁ∫øÁ®ã‰∏ÄÁõ¥Â≠òÂú®Ôºå‰∏ç‰ºöÂõûÊî∂„ÄÇRunLoop ÁöÑÂàõÂª∫ÊòØÂèëÁîüÂú®Á¨¨‰∏ÄÊ¨°Ëé∑ÂèñÊó∂ÔºåRunLoop ÁöÑÈîÄÊØÅÊòØÂèëÁîüÂú®Á∫øÁ®ãÁªìÊùüÊó∂„ÄÇ‰Ω†Âè™ËÉΩÂú®‰∏Ä‰∏™Á∫øÁ®ãÁöÑÂÜÖÈÉ®Ëé∑ÂèñÂÖ∂ RunLoopÔºà‰∏ªÁ∫øÁ®ãÈô§Â§ñÔºâ„ÄÇ RunLoopÂØπÂ§ñÊé•Âè£Âú® CoreFoundation ÈáåÈù¢ÂÖ≥‰∫é RunLoop Êúâ5‰∏™Á±ª: CFRunLoopRef CFRunLoopModeRef CFRunLoopSourceRef CFRunLoopTimerRef CFRunLoopObserverRef ÂÖ∂‰∏≠ÔºåCFRunLoopModeRef Á±ªÂπ∂Ê≤°ÊúâÂØπÂ§ñÊö¥Èú≤Ôºå‰∏çËÉΩÁõ¥Êé•ÂæóÂà∞ÂÖ∂ÂØπË±°ÔºåÂè™ÊòØÈÄöËøá CFRunLoopRef ÁöÑÊé•Âè£ËøõË°å‰∫ÜÂ∞ÅË£Ö„ÄÇ‰ªñ‰ª¨ÁöÑÂÖ≥Á≥ªÂ¶Ç‰∏ã: ‰∏Ä‰∏™ RunLoop ÂåÖÂê´Ëã•Âπ≤‰∏™ ModeÔºåÊØè‰∏™ Mode ÂèàÂåÖÂê´Ëã•Âπ≤‰∏™ Source/Timer/Observer„ÄÇÊØèÊ¨°Ë∞ÉÁî® RunLoop ÁöÑ‰∏ªÂáΩÊï∞Êó∂ÔºåÂè™ËÉΩÊåáÂÆöÂÖ∂‰∏≠‰∏Ä‰∏™ ModeÔºåËøô‰∏™ModeË¢´Áß∞‰Ωú CurrentMode„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÂàáÊç¢ ModeÔºåÂè™ËÉΩÈÄÄÂá∫ LoopÔºåÂÜçÈáçÊñ∞ÊåáÂÆö‰∏Ä‰∏™ Mode ËøõÂÖ•„ÄÇËøôÊ†∑ÂÅö‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÂàÜÈöîÂºÄ‰∏çÂêåÁªÑÁöÑ Source/Timer/ObserverÔºåËÆ©ÂÖ∂‰∫í‰∏çÂΩ±Âìç„ÄÇ Êé•Âè£Á±ªÂûãRunLoopÁöÑSourceRunLoop ÂØπË±°Â§ÑÁêÜÁöÑ‰∫ã‰ª∂Ê∫êÂàÜ‰∏∫‰∏§ÁßçÔºöInput sources Âíå Timer sourcesÔºàÂàÜÂà´ÂØπÂ∫î‰∏äÈù¢ÁöÑ CFRunLoopSourceRef Âíå CFRunLoopTimerRefÔºåÁªüÁß∞‰∏∫‰∫ã‰ª∂Ê∫êÔºâÔºö Input sourcesÔºöÁî®ÂàÜÂèëÂºÇÊ≠•‰∫ã‰ª∂ÔºåÈÄöÂ∏∏ÊòØÁî®‰∫éÂÖ∂‰ªñÁ∫øÁ®ãÊàñÁ®ãÂ∫èÁöÑÊ∂àÊÅØÔºåÊØîÂ¶ÇÔºöperformSelector:onThread: Timer sourcesÔºöÁî®ÂàÜÂèëÂêåÊ≠•‰∫ã‰ª∂ÔºåÈÄöÂ∏∏Ëøô‰∫õ‰∫ã‰ª∂ÂèëÁîüÂú®ÁâπÂÆöÊó∂Èó¥ÊàñËÄÖÈáçÂ§çÁöÑÊó∂Èó¥Èó¥Èöî‰∏äÔºåÊØîÂ¶ÇÔºö[NSTimer scheduledTimerWithTimeInterval:target:selector:] ‰∏ãÂõæÊòØËãπÊûúÂÆòÊñπÁöÑ‰∏ÄÂº†ÂõæÔºåÂ±ïÁ§∫‰∫Ü RunLoop ÁöÑÊ¶ÇÂøµÁªìÊûÑÂèäÂêÑÁßç‰∫ã‰ª∂Ê∫ê Input SourceInput Source ‰πüÂ∞±ÊòØ CFRunLoopSourceRef Êúâ‰∏§‰∏™ÁâàÊú¨:Source0(Custom Input Sources)Âíå Source1(Port-Based Sources)Ôºö Source0 Âè™ÂåÖÂê´‰∫Ü‰∏Ä‰∏™ÂõûË∞ÉÔºàÂáΩÊï∞ÊåáÈíàÔºâÔºåÈùûÂü∫‰∫éPortÁöÑÔºåÂÆÉÂπ∂‰∏çËÉΩ‰∏ªÂä®Ëß¶Âèë‰∫ã‰ª∂„ÄÇ‰∏ªË¶ÅÂ§ÑÁêÜËß¶Êë∏‰∫ã‰ª∂ÔºåperformSelectors Á≠â Source1 ÂåÖÂê´‰∫Ü‰∏Ä‰∏™ mach_port Âíå‰∏Ä‰∏™ÂõûË∞ÉÔºàÂáΩÊï∞ÊåáÈíàÔºâÔºåÂü∫‰∫éPortÁöÑÔºåË¢´Áî®‰∫éÈÄöËøáÂÜÖÊ†∏ÂíåÂÖ∂‰ªñÁ∫øÁ®ãÁõ∏‰∫íÂèëÈÄÅÊ∂àÊÅØ„ÄÇËøôÁßç Source ËÉΩ‰∏ªÂä®Âî§ÈÜí RunLoop ÁöÑÁ∫øÁ®ã„ÄÇ Time SourceÂü∫‰∫éÊó∂Èó¥ÁöÑËß¶ÂèëÂô®ÔºåÂÆÉÂíå NSTimer ÊòØ Toll-Free Bridging ÁöÑÔºåÂèØ‰ª•Ê∑∑Áî®„ÄÇÂÖ∂ÂåÖÂê´‰∏Ä‰∏™Êó∂Èó¥ÈïøÂ∫¶Âíå‰∏Ä‰∏™ÂõûË∞ÉÔºàÂáΩÊï∞ÊåáÈíàÔºâ„ÄÇÂΩìÂÖ∂Âä†ÂÖ•Âà∞ RunLoop Êó∂ÔºåRunLoop ‰ºöÊ≥®ÂÜåÂØπÂ∫îÁöÑÊó∂Èó¥ÁÇπÔºåÂΩìÊó∂Èó¥ÁÇπÂà∞Êó∂ÔºåRunLoop ‰ºöË¢´Âî§ÈÜí‰ª•ÊâßË°åÈÇ£‰∏™ÂõûË∞É„ÄÇ Foundation ‰∏≠ NSTimer Class Êèê‰æõ‰∫ÜÁõ∏ÂÖ≥ÊñπÊ≥ïÊù•ËÆæÁΩÆ Timer sources„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÈô§‰∫Ü scheduledTimerWithTimeInterval ÂºÄÂ§¥ÁöÑÊñπÊ≥ïÂàõÂª∫ÁöÑ Timer ÈÉΩÈúÄË¶ÅÊâãÂä®Ê∑ªÂä†Âà∞ÂΩìÂâç RunLoop ‰∏≠„ÄÇÔºàscheduledTimerWithTimeInterval ÂàõÂª∫ÁöÑ Timer ‰ºöËá™Âä®‰ª• Default Mode Âä†ËΩΩÂà∞ÂΩìÂâç RunLoop‰∏≠„ÄÇÔºâ RunLoopÁöÑModeRunLoop Mode ÊòØÊåáË¶ÅË¢´ÁõëÂê¨ÁöÑ‰∫ã‰ª∂Ê∫êÔºàÂåÖÊã¨ Input sources Âíå Timer sourcesÔºâÁöÑÈõÜÂêà + Ë¶ÅË¢´ÈÄöÁü•ÁöÑ run-loop observers ÁöÑÈõÜÂêà„ÄÇÊØè‰∏ÄÊ¨°ËøêË°åËá™Â∑±ÁöÑ RunLoop Êó∂ÔºåÈÉΩÈúÄË¶ÅÊòæÁ§∫ÊàñËÄÖÈöêÁ§∫ÁöÑÊåáÂÆöÂÖ∂ËøêË°å‰∫éÂì™‰∏ÄÁßç Mode„ÄÇÂú®ËÆæÁΩÆ RunLoop Mode ÂêéÔºå‰Ω†ÁöÑ RunLoop ‰ºöËá™Âä®ËøáÊª§ÂíåÂÖ∂‰ªñ Mode Áõ∏ÂÖ≥ÁöÑ‰∫ã‰ª∂Ê∫êÔºåËÄåÂè™ÁõëËßÜÂíåÂΩìÂâçËÆæÁΩÆ Mode Áõ∏ÂÖ≥ÁöÑÊ∫êÔºàÈÄöÁü•Áõ∏ÂÖ≥ÁöÑËßÇÂØüËÄÖÔºâ„ÄÇÂ§ßÂ§öÊï∞Êó∂ÂÄôÔºåRunLoop ÈÉΩÊòØËøêË°åÂú®Á≥ªÁªüÂÆö‰πâÁöÑÈªòËÆ§Ê®°Âºè‰∏ä„ÄÇ Á≥ªÁªüÈªòËÆ§ÂÆö‰∫Ü‰∏Ä‰∏ãÂá†‰∏™ modeÔºö kCFRunLoopDefaultModeÔºöAppÔºöAppÁöÑÈªòËÆ§ ModeÔºåÈÄöÂ∏∏‰∏ªÁ∫øÁ®ãÊòØÂú®Ëøô‰∏™ Mode ‰∏ãËøêË°åÁöÑ UITrackingRunLoopModeÔºöÁïåÈù¢Ë∑üË∏™ ModeÔºåÁî®‰∫é ScrollView ËøΩË∏™Ëß¶Êë∏ÊªëÂä®Ôºå‰øùËØÅÁïåÈù¢ÊªëÂä®Êó∂‰∏çÂèóÂÖ∂‰ªñ Mode ÂΩ±Âìç UIInitializationRunLoopModeÔºöÂú®ÂàöÂêØÂä® App Êó∂Á¨¨ËøõÂÖ•ÁöÑÁ¨¨‰∏Ä‰∏™ ModeÔºåÂêØÂä®ÂÆåÊàêÂêéÂ∞±‰∏çÂÜç‰ΩøÁî®ÔºàÁßÅÊúâÔºâ GSEventReceiveRunLoopModeÔºöÊé•ÂèóÁ≥ªÁªü‰∫ã‰ª∂ÁöÑÂÜÖÈÉ® ModeÔºåÈÄöÂ∏∏Áî®‰∏çÂà∞ kCFRunLoopCommonModesÔºöËøôÊòØ‰∏Ä‰∏™Âç†‰ΩçÁöÑ ModeÔºåÂåÖÂê´‰∏äÈù¢ÁöÑ kCFRunLoopDefaultMode ‰ª•Âèä UITrackingRunLoopMode Â∫îÁî®Âú∫ÊôØ‰∏æ‰æãÔºö‰∏ªÁ∫øÁ®ãÁöÑ RunLoop ÈáåÊúâ‰∏§‰∏™È¢ÑÁΩÆÁöÑ ModeÔºökCFRunLoopDefaultMode Âíå UITrackingRunLoopMode„ÄÇËøô‰∏§‰∏™ Mode ÈÉΩÂ∑≤ÁªèË¢´Ê†áËÆ∞‰∏∫‚ÄùCommon‚ÄùÂ±ûÊÄß„ÄÇDefaultMode ÊòØ App Âπ≥Êó∂ÊâÄÂ§ÑÁöÑÁä∂ÊÄÅÔºåTrackingRunLoopMode ÊòØËøΩË∏™ ScrollView ÊªëÂä®Êó∂ÁöÑÁä∂ÊÄÅ„ÄÇÂΩì‰Ω†ÂàõÂª∫‰∏Ä‰∏™ Timer Âπ∂Âä†Âà∞ DefaultMode Êó∂ÔºåTimer ‰ºöÂæóÂà∞ÈáçÂ§çÂõûË∞ÉÔºå‰ΩÜÊ≠§Êó∂ÊªëÂä®‰∏Ä‰∏™TableViewÊó∂ÔºåRunLoop ‰ºöÂ∞Ü mode ÂàáÊç¢‰∏∫ TrackingRunLoopModeÔºåËøôÊó∂ Timer Â∞±‰∏ç‰ºöË¢´ÂõûË∞ÉÔºåÂπ∂‰∏î‰πü‰∏ç‰ºöÂΩ±ÂìçÂà∞ÊªëÂä®Êìç‰Ωú„ÄÇÊúâÊó∂‰Ω†ÈúÄË¶Å‰∏Ä‰∏™ TimerÔºåÂú®‰∏§‰∏™ Mode ‰∏≠ÈÉΩËÉΩÂæóÂà∞ÂõûË∞ÉÔºå‰∏ÄÁßçÂäûÊ≥ïÂ∞±ÊòØÂ∞ÜËøô‰∏™ Timer ÂàÜÂà´Âä†ÂÖ•Ëøô‰∏§‰∏™ Mode„ÄÇËøòÊúâ‰∏ÄÁßçÊñπÂºèÔºåÂ∞±ÊòØÂ∞Ü Timer Âä†ÂÖ• CommonModes ‰∏≠„ÄÇ Mode Êö¥Èú≤ÁöÑÁÆ°ÁêÜ mode item ÁöÑÊé•Âè£Êúâ‰∏ãÈù¢Âá†‰∏™Ôºö 123456CFRunLoopAddSource(CFRunLoopRef rl, CFRunLoopSourceRef source, CFStringRef modeName);CFRunLoopAddObserver(CFRunLoopRef rl, CFRunLoopObserverRef observer, CFStringRef modeName);CFRunLoopAddTimer(CFRunLoopRef rl, CFRunLoopTimerRef timer, CFStringRef mode);CFRunLoopRemoveSource(CFRunLoopRef rl, CFRunLoopSourceRef source, CFStringRef modeName);CFRunLoopRemoveObserver(CFRunLoopRef rl, CFRunLoopObserverRef observer, CFStringRef modeName);CFRunLoopRemoveTimer(CFRunLoopRef rl, CFRunLoopTimerRef timer, CFStringRef mode); RunLoopÁöÑObserversÂØπÊØî‰∏äÈù¢ËØ¥ÁöÑ‰∫ã‰ª∂Ê∫êÔºåÂÆÉ‰ª¨ÊòØÂú®ÁâπÂÆöÁöÑÂêåÊ≠•‰∫ã‰ª∂ÊàñÂºÇÊ≠•‰∫ã‰ª∂ÂèëÁîüÊó∂Ë¢´Ëß¶ÂèëÔºåRunLoop Observers Â∞±‰∏ç‰∏ÄÊ†∑‰∫ÜÔºåÂÆÉÊòØÂú® RunLoop ÊâßË°åËá™Â∑±ÁöÑ‰ª£Á†ÅÂà∞Êüê‰∏Ä‰∏™ÊåáÂÆö‰ΩçÁΩÆÊó∂Ë¢´Ëß¶Âèë„ÄÇÊàë‰ª¨ÂèØ‰ª•Áî® RunLoop Observers Êù•Ë∑üË∏™Âà∞Ëøô‰∫õ‰∫ã‰ª∂Ôºö ËøõÂÖ• RunLoop ÁöÑÊó∂ÂÄô RunLoop Â∞ÜË¶ÅÂ§ÑÁêÜ‰∏Ä‰∏™ Timer source ÁöÑÊó∂ÂÄô RunLoop Â∞ÜË¶ÅÂ§ÑÁêÜ‰∏Ä‰∏™ Input source ÁöÑÊó∂ÂÄô RunLoop Â∞ÜË¶Å‰ºëÁú†ÁöÑÊó∂ÂÄô RunLoop Ë¢´Âî§ÈÜíÔºåÂπ∂ÂáÜÂ§áÂ§ÑÁêÜÂî§ÈÜíÂÆÉÁöÑ‰∫ã‰ª∂ÁöÑÊó∂ÂÄô RunLoop Â∞ÜË¶ÅÈÄÄÂá∫ÁöÑÊó∂ÂÄô ‰ΩøÁî®ÊñπÂºèInput SourceTimer SourceObserversËøôÂá†‰∏™ÊñπÈù¢ÁúãËµ∑Êù•Â§™È∫ªÁÉ¶‰∫ÜÔºåËÄå‰∏îÁúüÁöÑÁî®‰∏çÂà∞ÔºåÊâÄ‰ª•‰∏çÊÉ≥Áúã‰∫Ü„ÄÇ=„ÄÇ=55555„ÄÇË¥¥Âá†‰∏™‰ªãÁªçÂ¶Ç‰Ωï‰ΩøÁî®ÁöÑÂçöÂÆ¢ÂêßÔºåÂ¶ÇÊûúÁúüÁöÑË¶ÅÁî®Âà∞‰∫ÜÂÜçÁúã„ÄÇRunLoopÊ∑±Â∫¶Êé¢Á©∂Ôºà‰∫îÔºâRunLoopËµ∞ËøõRun LoopÁöÑ‰∏ñÁïå (‰∏Ä)Ôºö‰ªÄ‰πàÊòØRun LoopÔºüiOSÂ§öÁ∫øÁ®ãÁºñÁ®ãÊåáÂçóÔºà‰∏âÔºâRun LoopÁõ∏ÂÖ≥‰ΩøÁî® Demo ‰πüÊîæÂà∞ github ‰∏ä‰∫Ü„ÄÇ ÂÆûÁé∞Â§ÑÁêÜËøáÁ®ã ÂèØ‰ª•ÁúãÂà∞ÔºåÂÆûÈôÖ‰∏ä RunLoop Â∞±ÊòØËøôÊ†∑‰∏Ä‰∏™ÂáΩÊï∞ÔºåÂÖ∂ÂÜÖÈÉ®ÊòØ‰∏Ä‰∏™ do-while Âæ™ÁéØ„ÄÇÂΩì‰Ω†Ë∞ÉÁî® CFRunLoopRun() Êó∂ÔºåÁ∫øÁ®ãÂ∞±‰ºö‰∏ÄÁõ¥ÂÅúÁïôÂú®Ëøô‰∏™Âæ™ÁéØÈáåÔºõÁõ¥Âà∞Ë∂ÖÊó∂ÊàñË¢´ÊâãÂä®ÂÅúÊ≠¢ÔºåËØ•ÂáΩÊï∞Êâç‰ºöËøîÂõû„ÄÇ RunLoop ÁöÑÂ∫ïÂ±ÇÂÆûÁé∞‰ªé‰∏äÈù¢‰ª£Á†ÅÂèØ‰ª•ÁúãÂà∞ÔºåRunLoop ÁöÑÊ†∏ÂøÉÊòØÂü∫‰∫é mach port ÁöÑÔºåÂÖ∂ËøõÂÖ•‰ºëÁú†Êó∂Ë∞ÉÁî®ÁöÑÂáΩÊï∞ÊòØ mach_msg()„ÄÇ‰∏∫‰∫ÜÂÆûÁé∞Ê∂àÊÅØÁöÑÂèëÈÄÅÂíåÊé•Êî∂Ôºåmach_msg() ÂáΩÊï∞ÂÆûÈôÖ‰∏äÊòØË∞ÉÁî®‰∫Ü‰∏Ä‰∏™ Mach Èô∑Èò± (trap)ÔºåÂç≥ÂáΩÊï∞ mach_msg_trap()ÔºåÈô∑Èò±Ëøô‰∏™Ê¶ÇÂøµÂú® Mach ‰∏≠Á≠âÂêå‰∫éÁ≥ªÁªüË∞ÉÁî®„ÄÇÂΩì‰Ω†Âú®Áî®Êà∑ÊÄÅË∞ÉÁî® mach_msg_trap() Êó∂‰ºöËß¶ÂèëÈô∑Èò±Êú∫Âà∂ÔºåÂàáÊç¢Âà∞ÂÜÖÊ†∏ÊÄÅÔºõÂÜÖÊ†∏ÊÄÅ‰∏≠ÂÜÖÊ†∏ÂÆûÁé∞ÁöÑ mach_msg() ÂáΩÊï∞‰ºöÂÆåÊàêÂÆûÈôÖÁöÑÂ∑•‰ΩúÔºåÂ¶Ç‰∏ãÂõæÔºö RunLoop ÁöÑÊ†∏ÂøÉÂ∞±ÊòØ‰∏Ä‰∏™ mach_msg()ÔºåRunLoop Ë∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞ÂéªÊé•Êî∂Ê∂àÊÅØÔºåÂ¶ÇÊûúÊ≤°ÊúâÂà´‰∫∫ÂèëÈÄÅ port Ê∂àÊÅØËøáÊù•ÔºåÂÜÖÊ†∏‰ºöÂ∞ÜÁ∫øÁ®ãÁΩÆ‰∫éÁ≠âÂæÖÁä∂ÊÄÅ„ÄÇ‰æãÂ¶Ç‰Ω†Âú®Ê®°ÊãüÂô®ÈáåË∑ëËµ∑‰∏Ä‰∏™ iOS ÁöÑ AppÔºåÁÑ∂ÂêéÂú® App ÈùôÊ≠¢Êó∂ÁÇπÂáªÊöÇÂÅúÔºå‰Ω†‰ºöÁúãÂà∞‰∏ªÁ∫øÁ®ãË∞ÉÁî®Ê†àÊòØÂÅúÁïôÂú® mach_msg_trap() Ëøô‰∏™Âú∞Êñπ„ÄÇ ÂÖ≥‰∫éÂÖ∑‰ΩìÁöÑÂ¶Ç‰ΩïÂà©Áî® mach port ÂèëÈÄÅ‰ø°ÊÅØÔºåÂìàÂìàÔºåËøô‰∏™Â∞±‰∏çÊòØÊàëÁ†îÁ©∂ÁöÑ‰∏úË•ø‰∫Ü„ÄÇ Â∫îÁî®ËãπÊûú‰ΩøÁî® RunLoop ÂÆûÁé∞‰∫ÜËØ∏Â§öÂäüËÉΩ AutoreleasePoolAutorelease ÂØπË±°‰ªÄ‰πàÊó∂ÂÄôÈáäÊîæÔºüÁ≠îÊ°àÂΩìÁÑ∂‰∏çÊòØ‚ÄúÂΩìÂâç‰ΩúÁî®ÂüüÂ§ßÊã¨Âè∑ÁªìÊùüÊó∂ÈáäÊîæ‚Äù„ÄÇÂú®Ê≤°ÊúâÊâãÂä† Autorelease Pool ÁöÑÊÉÖÂÜµ‰∏ãÔºåAutorelease ÂØπË±°ÊòØÂú®ÂΩìÂâçÁöÑ runloop Ëø≠‰ª£ÁªìÊùüÊó∂ÊàñËÄÖÁ∫øÁ®ãÈîÄÊØÅÊó∂ÈáäÊîæÁöÑÔºåÂΩìÊúâ runloop ÁöÑÊÉÖÂÜµ‰∏ãÔºåÁ≥ªÁªüÂú®ÊØè‰∏™ runloop Âæ™ÁéØ‰∏≠ÈÉΩÂä†ÂÖ•‰∫ÜËá™Âä®ÈáäÊîæÊ±† Push Âíå Pop„ÄÇ ‰ªÄ‰πàÊÉÖÂÜµ‰∏ã‰ºöËá™Âä®ÂàõÂª∫ autoreleasepoolÔºü ÊâãÂä®Ë∞ÉÁî®‰∫Ü autorelease ÊñπÊ≥ïÁöÑÂØπË±°ÔºåÊØîÂ¶Ç __autorelease Person *p = [[Person alloc] init]Ôºå‰ºöÂú®ÂΩìÂâçÁ∫øÁ®ãÊèíÂÖ•ÂàõÂª∫‰∏Ä‰∏™ AutoreleasePool„ÄÇ Ë∞ÉÁî®Èùû allocÔºånew ÂºÄÂ§¥ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÊØîÂ¶Ç NSString *str = [NSString stringwithForamt:@&quot;&amp;ld&quot;, 123123123123123],‰ºöÂ∞ÜÂØπË±°Âä†ÂÖ• AutoreleasePool Â¶ÇÊûúÊòØ ARC ‰∏ãÁºñËØëÂô®Ëá™Âä®ÊèíÂÖ•ÁöÑ [person release]ÔºåÂàô‰ºöÁõ¥Êé•ÂáèÂ∞ëÂºïÁî®ËÆ°Êï∞„ÄÇËÄå‰∏ç‰ºöÂª∂ËøüÈáäÊîæ ÂéüÁêÜARC‰∏ãÔºåÊàë‰ª¨‰ΩøÁî® @autoreleasepool{} Êù•‰ΩøÁî®‰∏Ä‰∏™ AutoreleasePoolÔºåÈöèÂêéÁºñËØëÂô®Â∞ÜÂÖ∂ÊîπÂÜôÊàê‰∏ãÈù¢ÁöÑÊ†∑Â≠êÔºö 123void *context = objc_autoreleasePoolPush();&#123;&#125;‰∏≠ÁöÑ‰ª£Á†Åobjc_autoreleasePoolPop(context); ËÄåËøô‰∏§‰∏™ÂáΩÊï∞ÈÉΩÊòØÂØπ AutoreleasePoolPage ÁöÑÁÆÄÂçïÂ∞ÅË£ÖÔºåÊâÄ‰ª•Ëá™Âä®ÈáäÊîæÊú∫Âà∂ÁöÑÊ†∏ÂøÉÂ∞±Âú®‰∫éËøô‰∏™Á±ª„ÄÇ AutoreleasePoolPage ÊòØ‰∏Ä‰∏™ C++ ÂÆûÁé∞ÁöÑÁ±ª AutoreleasePool Âπ∂Ê≤°ÊúâÂçïÁã¨ÁöÑÁªìÊûÑÔºåËÄåÊòØÁî±Ëã•Âπ≤‰∏™ AutoreleasePoolPage ‰ª•ÂèåÂêëÈìæË°®ÁöÑÂΩ¢ÂºèÁªÑÂêàËÄåÊàêÔºàÂàÜÂà´ÂØπÂ∫îÁªìÊûÑ‰∏≠ÁöÑ parent ÊåáÈíàÂíå child ÊåáÈíàÔºâ AutoreleasePool ÊòØÊåâÁ∫øÁ®ã‰∏Ä‰∏ÄÂØπÂ∫îÁöÑÔºàÁªìÊûÑ‰∏≠ÁöÑ thread ÊåáÈíàÊåáÂêëÂΩìÂâçÁ∫øÁ®ãÔºâ AutoreleasePoolPage ÊØè‰∏™ÂØπË±°‰ºöÂºÄËæü4096Â≠óËäÇÂÜÖÂ≠òÔºà‰πüÂ∞±ÊòØËôöÊãüÂÜÖÂ≠ò‰∏ÄÈ°µÁöÑÂ§ßÂ∞èÔºâÔºåÈô§‰∫Ü‰∏äÈù¢ÁöÑÂÆû‰æãÂèòÈáèÊâÄÂç†Á©∫Èó¥ÔºåÂâ©‰∏ãÁöÑÁ©∫Èó¥ÂÖ®ÈÉ®Áî®Êù•ÂÇ®Â≠ò autorelease ÂØπË±°ÁöÑÂú∞ÂùÄ ‰∏äÈù¢ÁöÑ id *next ÊåáÈíà‰Ωú‰∏∫Ê∏∏Ê†áÊåáÂêëÊ†àÈ°∂ÊúÄÊñ∞ add ËøõÊù•ÁöÑ autorelease ÂØπË±°ÁöÑ‰∏ã‰∏Ä‰∏™‰ΩçÁΩÆ ‰∏Ä‰∏™ AutoreleasePoolPage ÁöÑÁ©∫Èó¥Ë¢´Âç†Êª°Êó∂Ôºå‰ºöÊñ∞Âª∫‰∏Ä‰∏™ AutoreleasePoolPage ÂØπË±°ÔºåËøûÊé•ÈìæË°®ÔºåÂêéÊù•ÁöÑ autorelease ÂØπË±°Âú®Êñ∞ÁöÑ page Âä†ÂÖ• ÊâÄ‰ª•ÔºåËã•ÂΩìÂâçÁ∫øÁ®ã‰∏≠Âè™Êúâ‰∏Ä‰∏™ AutoreleasePoolPage ÂØπË±°ÔºåÂπ∂ËÆ∞ÂΩï‰∫ÜÂæàÂ§ö autorelease ÂØπË±°Âú∞ÂùÄÊó∂ÂÜÖÂ≠òÂ¶Ç‰∏ãÂõæÔºö Âõæ‰∏≠ÁöÑÊÉÖÂÜµÔºåËøô‰∏ÄÈ°µÂÜçÂä†ÂÖ•‰∏Ä‰∏™ autorelease ÂØπË±°Â∞±Ë¶ÅÊª°‰∫ÜÔºà‰πüÂ∞±ÊòØ next ÊåáÈíàÈ©¨‰∏äÊåáÂêëÊ†àÈ°∂ÔºâÔºåËøôÊó∂Â∞±Ë¶ÅÊâßË°å‰∏äÈù¢ËØ¥ÁöÑÊìç‰ΩúÔºåÂª∫Á´ã‰∏ã‰∏ÄÈ°µ page ÂØπË±°Ôºå‰∏éËøô‰∏ÄÈ°µÈìæË°®ËøûÊé•ÂÆåÊàêÂêéÔºåÊñ∞pageÁöÑnextÊåáÈíàË¢´ÂàùÂßãÂåñÂú®Ê†àÂ∫ïÔºàbeginÁöÑ‰ΩçÁΩÆÔºâÔºåÁÑ∂ÂêéÁªßÁª≠ÂêëÊ†àÈ°∂Ê∑ªÂä†Êñ∞ÂØπË±°„ÄÇÊâÄ‰ª•ÔºåÂêë‰∏Ä‰∏™ÂØπË±°ÂèëÈÄÅ autorelease Ê∂àÊÅØÔºåÂ∞±ÊòØÂ∞ÜËøô‰∏™ÂØπË±°Âä†ÂÖ•Âà∞ÂΩìÂâç AutoreleasePoolPage ÁöÑÊ†àÈ°∂ next ÊåáÈíàÊåáÂêëÁöÑ‰ΩçÁΩÆ„ÄÇ ÊØèÂΩìËøõË°å‰∏ÄÊ¨° objc_autoreleasePoolPush Ë∞ÉÁî®Êó∂Ôºåruntime ÂêëÂΩìÂâçÁöÑ AutoreleasePoolPage ‰∏≠ add Ëøõ‰∏Ä‰∏™Âì®ÂÖµÂØπË±°ÔºåÂÄº‰∏∫0Ôºà‰πüÂ∞±ÊòØ‰∏™ nilÔºâÔºåÈÇ£‰πàËøô‰∏Ä‰∏™ page Â∞±ÂèòÊàê‰∫Ü‰∏ãÈù¢ÁöÑÊ†∑Â≠êÔºö objc_autoreleasePoolPush ÁöÑËøîÂõûÂÄºÊ≠£ÊòØËøô‰∏™Âì®ÂÖµÂØπË±°ÁöÑÂú∞ÂùÄÔºåË¢´ objc_autoreleasePoolPop (Âì®ÂÖµÂØπË±°)‰Ωú‰∏∫ÂÖ•ÂèÇÔºå‰∫éÊòØÔºö Ê†πÊçÆ‰º†ÂÖ•ÁöÑÂì®ÂÖµÂØπË±°Âú∞ÂùÄÊâæÂà∞Âì®ÂÖµÂØπË±°ÊâÄÂ§ÑÁöÑ page Âú®ÂΩìÂâç page ‰∏≠ÔºåÂ∞ÜÊôö‰∫éÂì®ÂÖµÂØπË±°ÊèíÂÖ•ÁöÑÊâÄÊúâ autorelease ÂØπË±°ÈÉΩÂèëÈÄÅ‰∏ÄÊ¨° - release Ê∂àÊÅØÔºåÂπ∂ÂêëÂõûÁßªÂä® next ÊåáÈíàÂà∞Ê≠£Á°Æ‰ΩçÁΩÆ Ë°•ÂÖÖ2Ôºö‰ªéÊúÄÊñ∞Âä†ÂÖ•ÁöÑÂØπË±°‰∏ÄÁõ¥ÂêëÂâçÊ∏ÖÁêÜÔºåÂèØ‰ª•ÂêëÂâçË∑®Ë∂äËã•Âπ≤‰∏™ pageÔºåÁõ¥Âà∞Âì®ÂÖµÊâÄÂú®ÁöÑ page ÂàöÊâçÁöÑ objc_autoreleasePoolPop ÊâßË°åÂêéÔºåÊúÄÁªàÂèòÊàê‰∫Ü‰∏ãÈù¢ÁöÑÊ†∑Â≠êÔºö ‰∫ã‰ª∂ÂìçÂ∫îËãπÊûúÊ≥®ÂÜå‰∫Ü‰∏Ä‰∏™ Source1 (Âü∫‰∫é mach port ÁöÑ) Áî®Êù•Êé•Êî∂Á≥ªÁªü‰∫ã‰ª∂ÔºåÂÖ∂ÂõûË∞ÉÂáΩÊï∞‰∏∫ __IOHIDEventSystemClientQueueCallback()„ÄÇ ÂΩì‰∏Ä‰∏™Á°¨‰ª∂‰∫ã‰ª∂(Ëß¶Êë∏/ÈîÅÂ±è/ÊëáÊôÉÁ≠â)ÂèëÁîüÂêéÔºåÈ¶ñÂÖàÁî± IOKit.framework ÁîüÊàê‰∏Ä‰∏™ IOHIDEvent ‰∫ã‰ª∂Âπ∂Áî± SpringBoard Êé•Êî∂„ÄÇ SpringBoard Âè™Êé•Êî∂ÊåâÈîÆ(ÈîÅÂ±è/ÈùôÈü≥Á≠â)ÔºåËß¶Êë∏ÔºåÂä†ÈÄüÔºåÊé•Ëøë‰º†ÊÑüÂô®Á≠âÂá†Áßç EventÔºåÈöèÂêéÁî® mach port ËΩ¨ÂèëÁªôÈúÄË¶ÅÁöÑ App ËøõÁ®ã„ÄÇÈöèÂêéËãπÊûúÊ≥®ÂÜåÁöÑÈÇ£‰∏™ Source1 Â∞±‰ºöËß¶Âèë__IOHIDEventSystemClientQueueCallback() ÂõûË∞ÉÔºåÂπ∂Ë∞ÉÁî® _UIApplicationHandleEventQueue() ËøõË°åÂ∫îÁî®ÂÜÖÈÉ®ÁöÑÂàÜÂèë„ÄÇ _UIApplicationHandleEventQueue() ‰ºöÊää IOHIDEvent Â§ÑÁêÜÂπ∂ÂåÖË£ÖÊàê UIEvent ËøõË°åÂ§ÑÁêÜÊàñÂàÜÂèëÔºåÂÖ∂‰∏≠ÂåÖÊã¨ËØÜÂà´ UIGesture/Â§ÑÁêÜÂ±èÂπïÊóãËΩ¨/ÂèëÈÄÅÁªô UIWindow Á≠â„ÄÇÈÄöÂ∏∏‰∫ã‰ª∂ÊØîÂ¶Ç UIButton ÁÇπÂáª„ÄÅtouchesBegin/Move/End/Cancel ‰∫ã‰ª∂ÈÉΩÊòØÂú®Ëøô‰∏™ÂõûË∞É‰∏≠ÂÆåÊàêÁöÑ„ÄÇ ÊâãÂäøËØÜÂà´ÂΩì‰∏äÈù¢ÁöÑ _UIApplicationHandleEventQueue() ËØÜÂà´‰∫Ü‰∏Ä‰∏™ÊâãÂäøÊó∂ÔºåÂÖ∂È¶ñÂÖà‰ºöË∞ÉÁî® Cancel Â∞ÜÂΩìÂâçÁöÑ touchesBegin/Move/End Á≥ªÂàóÂõûË∞ÉÊâìÊñ≠„ÄÇÈöèÂêéÁ≥ªÁªüÂ∞ÜÂØπÂ∫îÁöÑ UIGestureRecognizer Ê†áËÆ∞‰∏∫ÂæÖÂ§ÑÁêÜ„ÄÇ ËãπÊûúÊ≥®ÂÜå‰∫Ü‰∏Ä‰∏™ Observer ÁõëÊµã BeforeWaiting (Loop Âç≥Â∞ÜËøõÂÖ•‰ºëÁú†) ‰∫ã‰ª∂ÔºåËøô‰∏™ Observer ÁöÑÂõûË∞ÉÂáΩÊï∞ÊòØ _UIGestureRecognizerUpdateObserver()ÔºåÂÖ∂ÂÜÖÈÉ®‰ºöËé∑ÂèñÊâÄÊúâÂàöË¢´Ê†áËÆ∞‰∏∫ÂæÖÂ§ÑÁêÜÁöÑ GestureRecognizerÔºåÂπ∂ÊâßË°å GestureRecognizer ÁöÑÂõûË∞É„ÄÇ ÂΩìÊúâ UIGestureRecognizer ÁöÑÂèòÂåñ(ÂàõÂª∫/ÈîÄÊØÅ/Áä∂ÊÄÅÊîπÂèò)Êó∂ÔºåËøô‰∏™ÂõûË∞ÉÈÉΩ‰ºöËøõË°åÁõ∏Â∫îÂ§ÑÁêÜ„ÄÇ ÁïåÈù¢Êõ¥Êñ∞ÂΩìÂú®Êìç‰Ωú UI Êó∂ÔºåÊØîÂ¶ÇÊîπÂèò‰∫Ü Frame„ÄÅÊõ¥Êñ∞‰∫Ü UIView/CALayer ÁöÑÂ±ÇÊ¨°Êó∂ÔºåÊàñËÄÖÊâãÂä®Ë∞ÉÁî®‰∫Ü UIView/CALayer ÁöÑ setNeedsLayout/setNeedsDisplay ÊñπÊ≥ïÂêéÔºåËøô‰∏™ UIView/CALayer Â∞±Ë¢´Ê†áËÆ∞‰∏∫ÂæÖÂ§ÑÁêÜÔºåÂπ∂Ë¢´Êèê‰∫§Âà∞‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑÂÆπÂô®Âéª„ÄÇ ËãπÊûúÊ≥®ÂÜå‰∫Ü‰∏Ä‰∏™ Observer ÁõëÂê¨ BeforeWaiting(Âç≥Â∞ÜËøõÂÖ•‰ºëÁú†) Âíå Exit (Âç≥Â∞ÜÈÄÄÂá∫Loop) ‰∫ã‰ª∂ÔºåÂõûË∞ÉÂéªÊâßË°å‰∏Ä‰∏™ÂæàÈïøÁöÑÂáΩÊï∞Ôºö_ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv() „ÄÇËøô‰∏™ÂáΩÊï∞Èáå‰ºöÈÅçÂéÜÊâÄÊúâÂæÖÂ§ÑÁêÜÁöÑ UIView/CAlayer ‰ª•ÊâßË°åÂÆûÈôÖÁöÑÁªòÂà∂ÂíåË∞ÉÊï¥ÔºåÂπ∂Êõ¥Êñ∞ UI ÁïåÈù¢„ÄÇ Ëøô‰∏™ÂáΩÊï∞ÂÜÖÈÉ®ÁöÑË∞ÉÁî®Ê†àÂ§ßÊ¶ÇÊòØËøôÊ†∑ÁöÑÔºö 1234567891011ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv() QuartzCore:CA::Transaction::observer_callback: CA::Transaction::commit(); CA::Context::commit_transaction(); CA::Layer::layout_and_display_if_needed(); CA::Layer::layout_if_needed(); [CALayer layoutSublayers]; [UIView layoutSubviews]; CA::Layer::display_if_needed(); [CALayer display]; [UIView drawRect]; ÂÆöÊó∂Âô®ÂèÇËßÅ iOS ÂÆöÊó∂Âô® Ëøô‰∏ÄÁØá„ÄÇÂá†‰πéÊâÄÊúâÂÆöÊó∂Âô®ÈÉΩË¶ÅÊ±Ç runloop ÂºÄÂêØÔºå‰∏îÂ∞ÜËá™Ë∫´Âä†ÂÖ•Âà∞ runloop ‰∏≠„ÄÇ ÂÖ≥‰∫éÁΩëÁªúËØ∑Ê±ÇiOS ‰∏≠ÔºåÂÖ≥‰∫éÁΩëÁªúËØ∑Ê±ÇÁöÑÊé•Âè£Ëá™‰∏ãËá≥‰∏äÊúâÂ¶Ç‰∏ãÂá†Â±Ç: CFSocket CFNetwork -&gt;ASIHttpRequest NSURLConnection -&gt;AFNetworking NSURLSession -&gt;AFNetworking2, Alamofire NSURLConnectionLoader ‰∏≠ÁöÑ RunLoop ÈÄöËøá‰∏Ä‰∫õÂü∫‰∫é mach port ÁöÑ Source Êé•Êî∂Êù•Ëá™Â∫ïÂ±Ç CFSocket ÁöÑÈÄöÁü•„ÄÇÂΩìÊî∂Âà∞ÈÄöÁü•ÂêéÔºåÂÖ∂‰ºöÂú®ÂêàÈÄÇÁöÑÊó∂Êú∫Âêë CFMultiplexerSource Á≠â Source0 ÂèëÈÄÅÈÄöÁü•ÔºåÂêåÊó∂Âî§ÈÜí Delegate Á∫øÁ®ãÁöÑ RunLoop Êù•ËÆ©ÂÖ∂Â§ÑÁêÜËøô‰∫õÈÄöÁü•„ÄÇCFMultiplexerSource ‰ºöÂú® Delegate Á∫øÁ®ãÁöÑ RunLoop ÂØπ Delegate ÊâßË°åÂÆûÈôÖÁöÑÂõûË∞É„ÄÇ AFNetworkingAFURLConnectionOperation Ëøô‰∏™Á±ªÊòØÂü∫‰∫é NSURLConnection ÊûÑÂª∫ÁöÑÔºåÂÖ∂Â∏åÊúõËÉΩÂú®ÂêéÂè∞Á∫øÁ®ãÊé•Êî∂ Delegate ÂõûË∞É„ÄÇ‰∏∫Ê≠§ AFNetworking ÂçïÁã¨ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Á∫øÁ®ãÔºåÂπ∂Âú®Ëøô‰∏™Á∫øÁ®ã‰∏≠ÂêØÂä®‰∫Ü‰∏Ä‰∏™ RunLoopÔºö 123456789101112131415161718+ (void)networkRequestThreadEntryPoint:(id)__unused object &#123; @autoreleasepool &#123; [[NSThread currentThread] setName:@"AFNetworking"]; NSRunLoop *runLoop = [NSRunLoop currentRunLoop]; [runLoop addPort:[NSMachPort port] forMode:NSDefaultRunLoopMode]; [runLoop run]; &#125;&#125; + (NSThread *)networkRequestThread &#123; static NSThread *_networkRequestThread = nil; static dispatch_once_t oncePredicate; dispatch_once(&amp;oncePredicate, ^&#123; _networkRequestThread = [[NSThread alloc] initWithTarget:self selector:@selector(networkRequestThreadEntryPoint:) object:nil]; [_networkRequestThread start]; &#125;); return _networkRequestThread;&#125; RunLoop ÂêØÂä®ÂâçÂÜÖÈÉ®ÂøÖÈ°ªË¶ÅÊúâËá≥Â∞ë‰∏Ä‰∏™ Timer/Observer/SourceÔºåÊâÄ‰ª• AFNetworking Âú® [runLoop run] ‰πãÂâçÂÖàÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑ NSMachPort Ê∑ªÂä†ËøõÂéª‰∫Ü„ÄÇÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåË∞ÉÁî®ËÄÖÈúÄË¶ÅÊåÅÊúâËøô‰∏™ NSMachPort (mach_port) Âπ∂Âú®Â§ñÈÉ®Á∫øÁ®ãÈÄöËøáËøô‰∏™ port ÂèëÈÄÅÊ∂àÊÅØÂà∞ loop ÂÜÖÔºõ‰ΩÜÊ≠§Â§ÑÊ∑ªÂä† port Âè™ÊòØ‰∏∫‰∫ÜËÆ© RunLoop ‰∏çËá≥‰∫éÈÄÄÂá∫ÔºåÂπ∂Ê≤°ÊúâÁî®‰∫éÂÆûÈôÖÁöÑÂèëÈÄÅÊ∂àÊÅØ„ÄÇ 12345678910- (void)start &#123; [self.lock lock]; if ([self isCancelled]) &#123; [self performSelector:@selector(cancelConnection) onThread:[[self class] networkRequestThread] withObject:nil waitUntilDone:NO modes:[self.runLoopModes allObjects]]; &#125; else if ([self isReady]) &#123; self.state = AFOperationExecutingState; [self performSelector:@selector(operationDidStart) onThread:[[self class] networkRequestThread] withObject:nil waitUntilDone:NO modes:[self.runLoopModes allObjects]]; &#125; [self.lock unlock];&#125; ÂΩìÈúÄË¶ÅËøô‰∏™ÂêéÂè∞Á∫øÁ®ãÊâßË°å‰ªªÂä°Êó∂ÔºåAFNetworking ÈÄöËøáË∞ÉÁî® [NSObject performSelector:onThread:..] Â∞ÜËøô‰∏™‰ªªÂä°ÊâîÂà∞‰∫ÜÂêéÂè∞Á∫øÁ®ãÁöÑ RunLoop ‰∏≠„ÄÇ RN ‰∏≠ÁöÑÁ∫øÁ®ã‰øùÊ¥ªRN ‰ºöÂºÄÂêØ‰∏Ä‰∏™ jsThreadÔºåÁî®‰∫éÈÄöËøá performSelector:onThread:withObject:waitUntilDone: ÊñπÊ≥ïÂ∞ÜÂºÇÊ≠•ÊâßË°å‰ªªÂä°„ÄÇ RN ‰∏≠ÂºÄÂêØrunloopÁöÑÊñπÂºèÂíå AF ‰∏≠ÁöÑ‰∏çÂêåÔºö 123456789101112131415161718192021222324252627282930// in some func_jsThread = [[NSThread alloc] initWithTarget:[self class] selector:@selector(runRunLoop) object:nil];_jsThread.name = RCTJSThreadName;_jsThread.qualityOfService = NSOperationQualityOfServiceUserInteractive;[_jsThread start];+ (void)runRunLoop&#123; @autoreleasepool &#123; RCT_PROFILE_BEGIN_EVENT(RCTProfileTagAlways, @"-[RCTCxxBridge runJSRunLoop] setup", nil); // copy thread name to pthread name pthread_setname_np([NSThread currentThread].name.UTF8String); // Set up a dummy runloop source to avoid spinning CFRunLoopSourceContext noSpinCtx = &#123;0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL&#125;; CFRunLoopSourceRef noSpinSource = CFRunLoopSourceCreate(NULL, 0, &amp;noSpinCtx); CFRunLoopAddSource(CFRunLoopGetCurrent(), noSpinSource, kCFRunLoopDefaultMode); CFRelease(noSpinSource); RCT_PROFILE_END_EVENT(RCTProfileTagAlways, @""); // run the run loop while (kCFRunLoopRunStopped != CFRunLoopRunInMode(kCFRunLoopDefaultMode, ((NSDate *)[NSDate distantFuture]).timeIntervalSinceReferenceDate, NO)) &#123; RCTAssert(NO, @"not reached assertion"); // runloop spun. that's bad. &#125; &#125;&#125; ÈÄöËøáÊ∑ªÂä† source Áªô runloop ÁöÑÊñπÂºè‰ΩøÁ∫øÁ®ã‰øùÊ¥ª„ÄÇÈÄöËøá CFRunLoopRunInMode() ÊñπÊ≥ïÂºÄÂêØ runloop Âæ™ÁéØ„ÄÇrunloop ÂºÄÂêØÂêéÔºå‰πãÂêéÁöÑ‰ª£Á†ÅÊó∂‰∏ç‰ºöÊâßË°åÁöÑÔºåÊâÄ‰ª•Âè™ÊúâÂΩì runloop ÂÅú‰∏ãÊù•‰πãÂêéÊâç‰ºöËøõË°å while Âà§Êñ≠„ÄÇ RN ËøôÁßçÊñπÂºèÊòØÂèØ‰ª•ÂèñÊ∂à runloop Âæ™ÁéØÁöÑÔºåËÄå AF ÁöÑÂàô‰∏çË°åÔºåÂõ†‰∏∫ RN ‰∏∫ Runloop ËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™Êó†Á©∑Â§ßÁöÑËøáÊúüÊó∂Èó¥ÔºåËÄå AF ÁöÑ runloop ÂàôÊòØ‰ºöÂæ™ÁéØË∞ÉÁî®ÔºåÂèñÊ∂à‰∏ÄÊ¨°‰∏ãÊ¨°Ëøò‰ºöÂºÄÂêØ„ÄÇÂÖ∑‰ΩìÂèØËßÅÊ∑±ÂÖ•Á†îÁ©∂ Runloop ‰∏éÁ∫øÁ®ã‰øùÊ¥ª Ê£ÄÊµãÂç°È°øÂç°È°øÁöÑÂèëÁîüÂèØ‰ª•ÈÄöËøá‰∏ÄÊ¨° runloop ‰ªéÂºÄÂßãÂà∞ÁªìÊùüÁöÑÊó∂Èó¥Èó¥ÈöîÊù•Èó¥Êé•Âà§Êñ≠„ÄÇ Ê≥®ÂÜå observer ËÆ∞ÂΩï runloop ÂºÄÂêØÁöÑÊó∂Èó¥ÔºåÂπ∂‰∏îÂú® runloop ÁªìÊùüÁöÑÊó∂ÂÄôÊ∏ÖÁ©∫ÔºåÁÑ∂ÂêéÂàõÂª∫‰∏Ä‰∏™Â≠êÁ∫øÁ®ãÔºåÊØèÈöî‰∏ÄÂÆöÊó∂Èó¥ÂéªÊ£ÄÊµãÂΩìÂâçÊó∂Èó¥Âíå runloop ÂºÄÂêØÊó∂ËÆ∞ÂΩïÁöÑÊó∂Èó¥ÊòØÂê¶Â§ß‰∫éÊüê‰∏Ä‰∏™ÈòàÂÄº„ÄÇ ÂΩìÂ§ß‰∫éÊüê‰∏™ÈòàÂÄºÁöÑÊó∂ÂÄôË°®Êòé‰∫ßÁîü‰∫ÜÂç°È°øÔºåËÆ∞ÂΩï‰∏ãÂç°È°øÊó∂ÂÄôÁöÑÂ†ÜÊ†à ÈóÆÈ¢ò runloop Êúâ‰ªÄ‰πàÁî®Ôºü runloop Âíå Á∫øÁ®ãÁöÑÂÖ≥Á≥ªÊòØ‰ªÄ‰πàÔºürunloop ÊòØÂ¶Ç‰ΩïËé∑ÂèñÁöÑÔºü runloop ‰∏éÂÖ∂ mode „ÄÅSource/Timer/Observer ÁöÑÂÖ≥Á≥ªÔºü runloop ÊúâÂì™Âá†ÁßçsourceÔºü runloop ÁöÑ input Source Êúâ‰ªÄ‰πàÁî®ÔºüÊúâÂì™‰∏§‰∏™ÁâàÊú¨ÔºüÂå∫Âà´ÊòØ‰ªÄ‰πàÔºü runloop ÊúâÂì™Âá†Áßç modeÔºüÂå∫Âà´ÊòØ‰ªÄ‰πàÔºü runloop ÁöÑ observer ÊòØÂπ≤ÂòõÁöÑÔºü runloop ÁöÑÂ§ÑÁêÜËøáÁ®ãÊòØ‰ªÄ‰πàÔºü autoreleasepool ‰∏é Á∫øÁ®ãÁöÑÂÖ≥Á≥ªÔºü autoreleasepool ÁöÑÂÆûÁé∞ÂéüÁêÜÔºü ÊâãÂäøËØÜÂà´„ÄÅÁïåÈù¢Êõ¥Êñ∞ÁöÑÂü∫Êú¨ËøáÁ®ãÊòØ‰ªÄ‰πàÔºü ÂèÇËÄÉÈªëÂπïËÉåÂêéÁöÑAutorelease ÂàùËØÜ Run Loop Ê∑±ÂÖ•ÁêÜËß£RunLoop runloopÈÄÄÂá∫]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ios‰∏≠Â∫ìÁöÑ‰ªãÁªç‰∏é‰ΩøÁî®]]></title>
    <url>%2F2016%2F10%2F17%2F%E6%89%93%E5%8C%85%E9%9D%99%E6%80%81%E5%BA%93%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÁî±‰∫éË¶ÅÊé•ÂÖ•Á¨¨‰∏âÊñπÂ∫ìÔºåÂõ†Ê≠§ÊÉ≥Ë¶Å‰∫ÜËß£Â∫ìÁöÑÁõ∏ÂÖ≥Áü•ËØÜ„ÄÇÁΩë‰∏äÊü•ÈòÖ‰∫ÜËÆ∏Â§öËµÑÊñôÔºå‰ªçÁÑ∂ÊØîËæÉÁñëÊÉë„ÄÇÊØîÂ¶ÇÔºåÈùôÊÄÅÂ∫ìËÉΩÂê¶‰ª•ÂèäÂ¶Ç‰ΩïÂºïÂÖ•Âä®ÊÄÅÂ∫ìÔºüÂä®ÊÄÅÂ∫ìËÉΩÂê¶‰ª•ÂèäÂ¶Ç‰ΩïÂºïÂÖ•ÈùôÊÄÅÂ∫ìÔºüËá™Âª∫Âä®ÊÄÅÂ∫ì(ÈùûÁ≥ªÁªüÂä®ÊÄÅÂ∫ì)ÁöÑÂ•ΩÂ§Ñ‰ΩìÁé∞Âú®Âì™ÔºåÊÄé‰πàÂÆûÁé∞ÔºüÁ≠âÁ≠â„ÄÇÂú®‰∏ÄÁï™Êé¢Á¥¢‰πãÂêéÔºåÊÄªÁªì‰∫Ü‰∏ÄÁØáËæÉ‰∏∫ËØ¶Â∞ΩÂÖ®Èù¢ÁöÑÂ∫ìÁöÑ‰ΩøÁî®ÊñπÊ≥ï„ÄÇ ÂÖàÊù•Áúã‰∏ÄÂº†ÊÄùÁª¥ÂØºÂõæÔºö Ê¶ÇÂøµ‰ªÄ‰πàÊòØÂ∫ìÂ∫ìÊòØÂÖ±‰∫´Á®ãÂ∫è‰ª£Á†ÅÁöÑÊñπÂºè„ÄÇÂ∫ì‰ªéÊú¨Ë¥®‰∏äÊù•ËØ¥ÊòØ‰∏ÄÁßçÂèØÊâßË°å‰ª£Á†ÅÁöÑ‰∫åËøõÂà∂Ê†ºÂºèÔºåÂèØ‰ª•Ë¢´ËΩΩÂÖ•ÂÜÖÂ≠ò‰∏≠ÊâßË°å„ÄÇÂú®ÂºÄÂèëËøáÁ®ã‰∏≠Ôºå‰∏Ä‰∫õÊ†∏ÂøÉÊäÄÊúØÊàñËÄÖÂ∏∏Áî®Ê°ÜÊû∂ÔºåÂá∫‰∫éÂÆâÂÖ®ÊÄßÂíåÁ®≥ÂÆöÊÄßÁöÑËÄÉËôëÔºå‰∏çÊÉ≥Ë¢´Â§ñÁïåÁü•ÈÅìÔºåÊâÄ‰ª•‰ºöÊääÊ†∏ÂøÉ‰ª£Á†ÅÊâìÂåÖÊàêÂ∫ìÔºåÂè™Êö¥Èú≤Âá∫Â§¥Êñá‰ª∂‰ª•‰æõ‰ΩøÁî®„ÄÇÂ∫ìÂàÜÈùôÊÄÅÂ∫ìÂíåÂä®ÊÄÅÂ∫ì‰∏§Áßç„ÄÇ Â∫ìÁöÑÂàÜÁ±ªÈùôÊÄÅÂ∫ìÂ≠òÂú® .a Âíå .framework ‰∏§ÁßçÂΩ¢Âºè„ÄÇ .a ÊòØ‰∏Ä‰∏™Á∫Ø‰∫åËøõÂà∂Êñá‰ª∂Ôºå.framework ‰∏≠Èô§‰∫ÜÊúâ‰∫åËøõÂà∂Êñá‰ª∂‰πãÂ§ñËøòÊúâËµÑÊ∫êÊñá‰ª∂„ÄÇ .a ÔºåË¶ÅÊúâ .h Êñá‰ª∂‰ª•ÂèäËµÑÊ∫êÊñá‰ª∂ÈÖçÂêàÔºå .framework Êñá‰ª∂ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®„ÄÇÊÄªÁöÑÊù•ËØ¥Ôºå.a + .h + sourceFile = .framework„ÄÇÊâÄ‰ª•ÂàõÂª∫ÈùôÊÄÅÂ∫ìÊúÄÂ•ΩËøòÊòØÁî®.frameworkÁöÑÂΩ¢Âºè„ÄÇ ÂØπ‰∫éÈùôÊÄÅÂ∫ìËÄåË®ÄÔºåÁ±ª‰ºº‰∫é‰∏Ä‰∏™ÁºñËØëÂ•ΩÁöÑ .o ÁöÑÈõÜÂêà„ÄÇÂú®buildÁöÑËøáÁ®ã‰∏≠ÔºåÂè™‰ºöÂèÇ‰∏éÈìæÊé•ÁöÑÊìç‰ΩúÔºåÈìæÊé•Âô®‰ºöÂ∞ÜÈùôÊÄÅÂ∫ì‰∏≠Ë¢´‰ΩøÁî®ÁöÑÈÉ®ÂàÜÂêàÂπ∂Âà∞ÂèØÊâßË°åÊñá‰ª∂‰∏≠ÂéªÔºåÁî®ÂáΩÊï∞ÁöÑÂÆûÈôÖÂú∞ÂùÄÊù•‰ª£ÊõøÂáΩÊï∞ÂºïÁî®„ÄÇÈìæÊé•ÊµÅÁ®ãÂ¶Ç‰∏ãÂõæÔºö Âä®ÊÄÅÂ∫ìÂ≠òÂú®.frameworkÂíå.tbd‰∏§ÁßçÂΩ¢Âºè„ÄÇ Âú® iOS8 ‰πãÂâçÔºåËãπÊûú‰∏çÂÖÅËÆ∏Á¨¨‰∏âÊñπÊ°ÜÊû∂‰ΩøÁî®Âä®ÊÄÅÊñπÂºèÂä†ËΩΩÔºå‰ªé iOS8 ÂºÄÂßãÂÖÅËÆ∏ÂºÄÂèëËÄÖÊúâÊù°‰ª∂Âú∞ÂàõÂª∫Âíå‰ΩøÁî®Âä®ÊÄÅÊ°ÜÊû∂ÔºåËøôÁßçÊ°ÜÊû∂Âè´ÂÅö Cocoa Touch Framework„ÄÇËôΩÁÑ∂ÂêåÊ†∑ÊòØÂä®ÊÄÅÊ°ÜÊû∂Ôºå‰ΩÜÊòØÂíåÁ≥ªÁªü framework ‰∏çÂêåÔºåapp ‰∏≠ÁöÑ‰ΩøÁî®ÁöÑ Cocoa Touch Framework Âú®ÊâìÂåÖÂíåÊèê‰∫§ app Êó∂‰ºöË¢´ÊîæÂà∞ app bundle ‰∏≠ÔºåËøêË°åÂú®Ê≤ôÁõíÈáåÔºåËÄå‰∏çÊòØÁ≥ªÁªü‰∏≠„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå‰∏çÂêåÁöÑ app Â∞±ÁÆó‰ΩøÁî®‰∫ÜÂêåÊ†∑ÁöÑ frameworkÔºå‰ΩÜËøòÊòØ‰ºöÊúâÂ§ö‰ªΩÁöÑÊ°ÜÊû∂Ë¢´ÂàÜÂà´Á≠æÂêçÔºåÊâìÂåÖÂíåÂä†ËΩΩ„ÄÇ‰∏çËøá iOS8 ‰∏äÂºÄÊîæ‰∫Ü App Extension ÂäüËÉΩÔºåÂèØ‰ª•‰∏∫‰∏Ä‰∏™Â∫îÁî®ÂàõÂª∫Êèí‰ª∂ÔºåËøôÊ†∑‰∏ªappÂíåÊèí‰ª∂‰πãÈó¥ÂÖ±‰∫´Âä®ÊÄÅÂ∫ìËøòÊòØÂèØË°åÁöÑ„ÄÇ Âä®ÊÄÅÈìæÊé•ÊòØ‰ΩøÁî®‰∫Ü Procedure Linkage Table (PLT)„ÄÇÈ¶ñÂÖàËøô‰∏™ PLT ÂàóÂá∫‰∫ÜÁ®ãÂ∫è‰∏≠ÊØè‰∏Ä‰∏™ÂáΩÊï∞ÁöÑË∞ÉÁî®ÔºåÂΩìÁ®ãÂ∫èÂºÄÂßãËøêË°åÔºåÂ¶ÇÊûúÂä®ÊÄÅÂ∫ìË¢´Âä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠ÔºåPLT ‰ºöÂéªÂØªÊâæÂä®ÊÄÅÁöÑÂú∞ÂùÄÂπ∂ËÆ∞ÂΩï‰∏ãÊù•ÔºåÂ¶ÇÊûúÂáΩÊï∞Ë¢´Ë∞ÉÁî®ËøáÁöÑËØùÔºå‰∏ã‰∏ÄÊ¨°Ë∞ÉÁî®Â∞±ÂèØ‰ª•ÈÄöËøá PLT Áõ¥Êé•Ë∑≥ËΩ¨‰∫Ü„ÄÇ ‰ºòÂä£ÈùôÊÄÅÂ∫ìÔºåÂú®ÈìæÊé•Êó∂‰ºöË¢´ÂÆåÊï¥Âú∞Â§çÂà∂Âà∞ÂèØÊâßË°åÊñá‰ª∂‰∏≠ÔºåË¢´Â§öÊ¨°‰ΩøÁî®Â∞±ÊúâÂ§ö‰ªΩÂÜó‰ΩôÊã∑Ë¥ù„ÄÇÂ•ΩÂ§ÑÂæàÊòéÊòæÔºåÁºñËØëÂÆåÊàê‰πãÂêéÔºåÂ∫ìÊñá‰ª∂ÂÆûÈôÖ‰∏äÂ∞±Ê≤°Êúâ‰ΩúÁî®‰∫Ü„ÄÇÁõÆÊ†áÁ®ãÂ∫èÊ≤°ÊúâÂ§ñÈÉ®‰æùËµñÔºåÁõ¥Êé•Â∞±ÂèØ‰ª•ËøêË°å„ÄÇÂΩìÁÑ∂ÂÖ∂Áº∫ÁÇπ‰πüÂæàÊòéÊòæÔºåÂ∞±ÊòØ‰ºö‰ΩøÁî®ÁõÆÊ†áÁ®ãÂ∫èÁöÑ‰ΩìÁßØÂ¢ûÂ§ß„ÄÇ Âä®ÊÄÅÂ∫ìÔºå‰∏éÈùôÊÄÅÂ∫ìÁõ∏ÂèçÔºåÂä®ÊÄÅÂ∫ìÂú®ÁºñËØëÊó∂Âπ∂‰∏ç‰ºöË¢´Êã∑Ë¥ùÂà∞ÁõÆÊ†áÁ®ãÂ∫è‰∏≠ÔºåÁõÆÊ†áÁ®ãÂ∫è‰∏≠Âè™‰ºöÂ≠òÂÇ®ÊåáÂêëÂä®ÊÄÅÂ∫ìÁöÑÂºïÁî®„ÄÇÁ≠âÂà∞Á®ãÂ∫èËøêË°åÊó∂ÔºåÂä®ÊÄÅÂ∫ìÊâç‰ºöË¢´ÁúüÊ≠£Âä†ËΩΩËøõÊù•„ÄÇÁ≥ªÁªüÁöÑÂä®ÊÄÅÂ∫ì‰∏çÈúÄË¶ÅÊã∑Ë¥ùÂà∞ÁõÆÊ†áÁ®ãÂ∫è‰∏≠ÔºåËá™Âª∫ÁöÑÂä®ÊÄÅÂ∫ìÂèØ‰ª•Áî±Â∑•Á®ãÂÜÖÁöÑÂ§ö‰∏™Â∫ìÂÖ±‰∫´ÔºåÂõ†Ê≠§ÂèØ‰ª•ÂáèÂ∞èÁõÆÊ†áÁ®ãÂ∫èÁöÑ‰ΩìÁßØ„ÄÇ‰ΩÜÊòØÔºåÁî±‰∫éÂÖ∂ÊääÈùôÊÄÅÈìæÊé•ÂÅöÁöÑ‰∫ãÊÉÖÈÉΩÊê¨Âà∞ËøêË°åÊó∂Êù•ÂÅöÔºåÁ®ãÂ∫èÁöÑÂêØÂä®‰ºöÂèòÊÖ¢„ÄÇ Â∫ìÁöÑÂàõÂª∫.aÈùôÊÄÅÂ∫ìÁöÑÂàõÂª∫ÂàõÂª∫‰∏Ä‰∏™ .a ÈùôÊÄÅÂ∫ìÈ°πÁõÆÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºöÈùôÊÄÅÂ∫ìÁöÑÊñá‰ª∂ÂàóË°®Â¶Ç‰∏ãÔºåÂú® products Êñá‰ª∂Â§πÂÜÖÁöÑÂ∞±ÊòØË¶ÅÁîüÊàêÁöÑÈùôÊÄÅÂ∫ì„ÄÇÊ≠§ÂàªÊòØÁ∫¢Ëâ≤ÁöÑÔºåÁ≠âÂà∞ÁîüÊàêÊàêÂäüÂ∞±‰ºöÂèòÊàêÈªëËâ≤„ÄÇÁé∞Âú®Êñ∞Âª∫Ëá™Â∑±ÁöÑÁ±ªPrintString.hÔºåÂ£∞ÊòéÂíåÂÆûÁé∞‰∏Ä‰∏™Á¨¨‰∏âÊñπÂ∫ìÁöÑÊñπÊ≥ï„ÄÇÁé∞Âú®ÂèØ‰ª•ÊâìÂåÖËøô‰∏™ÈùôÊÄÅÂ∫ì‰∫Ü„ÄÇÁî±‰∫éÊ®°ÊãüÂô®ÂíåÁúüÊú∫Êû∂ÊûÑ‰∏çÂêåÔºåÈúÄË¶ÅÈÄâÊã©ËØ•ÂåÖÂ∞ÜËøêË°åÂú®Âì™‰∏™ÁéØÂ¢É‰∏ãÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÈÄâÊã©ËøêË°åÂú®ÁúüÊú∫‰∏äÔºöÊâìÂåÖÁîüÊàê‰∫ÜÈùôÊÄÅÂ∫ìÂú® products Êñá‰ª∂Â§πÂÜÖÔºöÊâìÂºÄ products Êñá‰ª∂Â§πÔºå ‰ΩÜÊòØÊ≠§Êó∂Êö¥Èú≤Âá∫Êù•ÁöÑÂ§¥Êñá‰ª∂Âπ∂Ê≤°ÊúâPrintString.h„ÄÇÈúÄË¶ÅÂØπÊö¥Èú≤ÁöÑÂ§¥Êñá‰ª∂ËøõË°åËÆæÁΩÆ„ÄÇÂ¶Ç‰∏ãÂõæÔºåÂú® Build Phase ÔºåÁöÑ Copy Files ÁõÆÂΩï‰∏ãÂä†ÂÖ•ÊÉ≥Ë¶ÅÂÖ¨ÂºÄÁöÑÂ§¥Êñá‰ª∂ÔºöÁé∞Âú®ÂÜç run ‰∏ÄÊ¨°ÔºåÂ∞±ÂæóÂà∞‰∫ÜÊ≠£Á°ÆÁöÑÈùôÊÄÅÂ∫ì„ÄÇ ÂÆûË∑µËØÅÊòéÔºåÂç≥‰Ωø‰∏çÂú® CopyFiles ‰∏≠ËÆæÁΩÆÔºåÂè™Ë¶ÅÊääÊÉ≥Êö¥Èú≤ÁöÑÂ§¥Êñá‰ª∂Êèê‰æõÁªô‰ΩøÁî®ËÄÖÔºåÁÖßÊ†∑ËÉΩÂ§ü‰ΩøÁî®„ÄÇËøôÈáåÂè™ÊòØÊää‰Ω†ÊÉ≥Ë¶ÅÊö¥Èú≤ÁöÑÂ§¥Êñá‰ª∂ÂçïÁã¨Ê±áÈõÜÂú®‰∏Ä‰∏™ÁõÆÂΩï‰∏≠ Áé∞Âú®ÔºåÂèØ‰ª•ÊµãËØï‰∏Ä‰∏ãËøô‰∏™ÈùôÊÄÅÂ∫ì„ÄÇÂèØ‰ª•ÂÜçÂàõÂª∫‰∏Ä‰∏™Â∑•Á®ãÔºåÊääÂ∫ìËøûÂêåË¶ÅÊö¥Èú≤ÁöÑÂ§¥Êñá‰ª∂‰∏ÄËµ∑ÊãñËøõÂéª„ÄÇËøôÈáåÊàëÊñ∞Âª∫‰∫Ü‰∏Ä‰∏™ target ÔºöÂÖàË¶ÅÂú®Â∑•Á®ãÂíåÂ∫ìÈó¥Âª∫Á´ãÂÖ≥ËÅî„ÄÇÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÂú® Link Binary With Libraries ‰∏≠Ê∑ªÂä†Â∫ìÔºöÂú® ViewController.m ‰∏≠Ë∞ÉÁî®Â∫ìÁöÑÊñπÊ≥ïÔºöÁé∞Âú®ÂèØ‰ª•ËøêË°å‰∫ÜÔºå‰∏çËøáËøêË°åÂâçË¶ÅÈÄâÊã©ÂØπ target ÔºöÂèØ‰ª•Âú®ÊéßÂà∂Âè∞ÁúãÂà∞Â∫ì‰∏≠ÁöÑÊñπÊ≥ïË¢´Ë∞ÉÁî®‰∫ÜÔºö .frameworkÁöÑÂàõÂª∫Âä®ÊÄÅframeworkÂàõÂª∫‰∏Ä‰∏™frameworkÔºöÂàõÂª∫ÂêéÁöÑÊñá‰ª∂ÂàóË°®Â¶Ç‰∏ãÔºåÂèØ‰ª•ÁúãÂà∞Âè™Êúâ‰∏Ä‰∏™ framework.h Â§¥Êñá‰ª∂„ÄÇÈÄöËøáÊ≥®ÈáäÔºåÊàë‰ª¨ÂèØ‰ª•ÁêÜËß£ÔºåËøô‰∏™Â§¥Êñá‰ª∂ÊòØÊâÄÊúâ public Â§¥Êñá‰ª∂ÁöÑÈõÜÂêàÔºö ÂÆûË∑µËØÅÊòéÔºåÂç≥‰Ωø‰Ω†‰∏çÊåâÁÖß‰ªñÁöÑË¶ÅÊ±ÇËøôÊ†∑ #import &lt;Frameworks/PublicHeader.h&gt; ËÄåÊòØ #import &quot;PublicHeader.h&quot; ‰πüÊòØÊ≤°ÈóÆÈ¢òÁöÑ Â∞ÜÂâçÈù¢ÂàõÂª∫ÁöÑ PrintString.h Âíå PrintString.m ÂØºÂÖ•ÔºåÂπ∂‰∏î import Âà∞ framework.h ‰∏≠ÂéªÔºöËÆæÁΩÆÈúÄË¶ÅÊö¥Èú≤ÁöÑÂ§¥Êñá‰ª∂ÔºåÂ§¥Êñá‰ª∂ÈªòËÆ§Âú® project header ‰∏≠ÔºåÂ∞ÜÈúÄË¶ÅÊö¥Èú≤Âá∫Êù•ÁöÑÊãñÂà∞ public header ‰∏≠Âéª„ÄÇ ÂÆûË∑µËØÅÊòéÔºå‰∏çÊÉ≥Êö¥Èú≤ÁöÑÂ§¥Êñá‰ª∂‰∏çË¶ÅÂ§öÊ¨°‰∏Ä‰∏æÁöÑÊîæÂà∞ Private ‰∏≠Âéª„ÄÇÂ¶ÇÊûúÂú® Private ‰∏≠Ê∑ªÂä†‰∫ÜÊñá‰ª∂ÔºåÁîüÊàêÁöÑ Framework ‰∏≠ÊòØ‰ºöÊúâ‰∏Ä‰∏™ PrivateHeaders Êñá‰ª∂Â§πÁöÑÔºåÂπ∂‰∏îËøô‰∫õ PrivateHeaders ÊòØËÉΩË¢´Â∫îÁî®Êñπ‰ΩøÁî®ÁöÑ„ÄÇÊâÄ‰ª• Private ÁöÑÁõ¥Êé•‰∏çÁêÜÔºåËÆ©ÂÆÉ‰ª¨ÁïôÂú® Project ‰∏≠Â∞±Ë°å‰∫Ü„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ê≠§Â§ÑÊúâ‰∏âÁßçÂ§¥Êñá‰ª∂ÔºåÂàÜÂà´ÊòØ project header Ôºå public header Ôºå private header „ÄÇÂå∫Âà´Â¶Ç‰∏ãÔºå‰∏çÊÉ≥ËÆ©Âà´‰∫∫Áü•ÈÅìÁöÑÊîæÂú® Project ‰∏ãÂ∞±Ë°å‰∫ÜÔºö Public: The interface is finalized and meant to be used by your product‚Äôs clients. A public header is included in the product as readable source code without restriction. Private: The interface isn‚Äôt intended for your clients or it‚Äôs in early stages of development. A private header is included in the product, but it‚Äôs marked ‚Äúprivate‚Äù. Thus the symbols are visible to all clients, but clients should understand that they‚Äôre not supposed to use them. Project: The interface is for use only by implementation files in the current project. A project header is not included in the target, except in object code. The symbols are not visible to clients at all, only to you. ÂàáËÆ∞ÂàáËÆ∞ Ë¶ÅÊö¥Èú≤ÁöÑÂ§¥Êñá‰ª∂‰∏ÄÂÆöË¶ÅÊîæÂú® Public ‰∏ãÔºåÂê¶ÂàôÂà∞Êó∂ÂÄôÂºïÂÖ•ÁöÑÊó∂ÂÄô‰ºöÂá∫Áé∞Â¶Ç‰∏ãÈîôËØØ(ÂèçÊ≠£ÊàëÊòØËÄÅÊòØÂøòËÆ∞Ëøô‰∏™)Ôºö Ëøô‰∏™ÈîôËØØÊòØÂõ†‰∏∫ÔºåÊàëÂú® DynamicWithStatic.h ‰∏≠ import ÁöÑÂ§¥Êñá‰ª∂Âπ∂Ê≤°ÊúâË¢´Ë¢´ËÆæÁΩÆ‰∏∫ Public ÂØºËá¥ÁöÑ„ÄÇ ÁîüÊàêÁöÑ framework Êñá‰ª∂ÁõÆÂΩïÂ¶Ç‰∏ãÔºö Â∞ÜÁîüÊàêÁöÑ framework ÊîæÂÖ•Â∑•Á®ã‰∏≠ÊµãËØï„ÄÇÂíå .aÁõ¥Êé• #import &quot;Êñá‰ª∂Âêç.h&quot; ‰∏çÂêåÔºåframework ÂºïÂÖ•Â§¥Êñá‰ª∂ÁöÑÊó∂ÂÄôË¶ÅÊåâÁÖß #import &lt;frameworkÂêç/Â§¥Êñá‰ª∂Âêç.h&gt; ÁöÑÊñπÂºèÂºïÂÖ•ÔºåÈùôÊÄÅÁöÑ Framework ‰πüË¶ÅÂ¶ÇÊ≠§„ÄÇ Áé∞Âú®ÁºñËØëÂèØ‰ª•ÈÄöËøáÔºåËøêË°åÊó∂Âá∫Áé∞Â¶Ç‰∏ãÈîôËØØÔºö ÈúÄË¶ÅÂ∞ÜÂä®ÊÄÅÂ∫ìÂµåÂÖ•Â∑•Á®ãÁöÑ bundle ‰∏≠„ÄÇÂõ†Ê≠§ÔºåÈúÄË¶ÅÂú® General ‰∏≠ÁöÑ Embedded Binary ‰∏ÄÈ°π‰∏≠Âä†ÂÖ•Áõ∏Â∫îÂä®ÊÄÅÂ∫ìÔºö Áé∞Âú®Â∞±ÂèØ‰ª•Ê≠£Á°ÆËøêË°å‰∫Ü ÈùôÊÄÅframeworkÈùôÊÄÅframeworkÂíåÂä®ÊÄÅframeworkÂàõÂª∫ÁöÑÂü∫Êú¨ÊµÅÁ®ã‰∏ÄËá¥ÔºåÂîØ‰∏ÄÁöÑÂå∫Âà´ÈúÄË¶ÅËÆæÁΩÆ Mach-O Type ‰∏∫ Static Library Ôºö Bundle ÁöÑÂàõÂª∫‰∏é‰ΩøÁî®ÊúâÊó∂ÂÄôÔºåÊàë‰ª¨ÈúÄË¶ÅËá™Â∑±ÂàõÂª∫‰∏Ä‰∏™ BundleÔºåÂåÖÂê´‰∏Ä‰∫õÂõæÁâáÊàñËÄÖ xib Êñá‰ª∂„ÄÇÈÇ£‰πàÂ¶Ç‰ΩïÂàõÂª∫‰ª•Âèä‰ΩøÁî® Bundle Âë¢Ôºü Êñ∞Âª∫ TargetÔºåÂú® iOS ÈÄâÈ°π‰∏≠Êâæ‰∏çÂà∞ BundleÔºåÈÇ£‰πàÊàë‰ª¨Â∞±Âú® macOS ‰∏ãÈÄâÂèñÂàõÂª∫ BundleÔºö Ëøô‰∏™ÂàõÂª∫ÁöÑÊòØ macOS ‰ΩøÁî®ÁöÑ BundleÔºåÈúÄË¶Å‰øÆÊîπÂÖ∂ Base SDK ‰∏∫ iOS ‰ΩøÁî®Ôºö Êàë‰ª¨Âú®Ëøô‰∏™ Bundle ÈáåÊ∑ªÂä†‰∏ÄÂº†ÂõæÁâáÔºåÁé∞Âú®ËøêË°åÁîüÊàê Bundle„ÄÇÂ∞ÜÁîüÊàêÂ•ΩÁöÑ BundleÊîæÂà∞ÊµãËØïÂ∑•Á®ã‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞ÂõæÁâáÊ∑ªÂä†‰∫ÜËøõÂéª„ÄÇ ‰ΩøÁî®ÁöÑÊó∂ÂÄôÁî±‰∫é‰∏çÊòØÁõ¥Êé•Âú® mainBundle ‰∏ãÔºåÊâÄ‰ª•‰∏çËÉΩÁõ¥Êé•‰ΩøÁî® [UIImage imageNamed:@&quot;author&quot;]„ÄÇÈúÄË¶ÅÊâæÂà∞ Bundle ÊâÄÂú®ÁöÑË∑ØÂæÑÔºö 1[UIImage imageNamed:[[[NSBundle mainBundle] pathForResource:@"NewBundle" ofType:@"bundle"] stringByAppendingString:@"/author.png"]] ÈÄöËøáË∑ØÂæÑÊãºÊé•Â∞±ËÉΩÊâæÂà∞Ê≠£Á°ÆÁöÑÂõæÁâáË∑ØÂæÑ„ÄÇÔºàÂØπ‰∫éÊúâ‰∫õ‰∏çÂú® mainBundle ‰∏≠ÁöÑ bundleÔºåÊØîÂ¶ÇÂä®ÊÄÅÂ∫ìÁöÑ bundleÔºåÂ∞ÜÂú®Áî® Cocoapods ÂàõÂª∫‰∏Ä‰∏™Â∫ì‰∏≠‰ªãÁªçÔºâ ÈùôÊÄÅÂ∫ì‰∏éÂä®ÊÄÅÂ∫ìÁöÑÂºïÁî®‰∏Ä‰∏™Â∫ìÁöÑÂºÄÂèëÁªèÂ∏∏‰ºöÈúÄË¶ÅÁî®Âà∞ÂÖ∂‰ªñÁöÑÂ∫ì(Â¶Ç AFNetWorking )ÁöÑÈÖçÂêàÔºåÂõ†Ê≠§ÔºåÈúÄË¶ÅÂú®Â∫ì‰∏≠ÂµåÂÖ•ÂÖ∂‰ªñÁöÑÂ∫ì„ÄÇÂ¶Ç‰ΩïÂú®Ëá™Â∑±ÁöÑÈùôÊÄÅ/Âä®ÊÄÅÂ∫ì‰∏≠ÈõÜÊàêÁ¨¨‰∏âÊñπÁöÑÈùôÊÄÅ/Âä®ÊÄÅÂ∫ìÔºå‰ª•ÂèäÂ¶Ç‰ΩïÈÖçÂêà‰ΩøÁî® cocoapods ÊòØÊàëÊØîËæÉÂõ∞ÊÉëÁöÑÁÇπ„ÄÇ‰∏ãÈù¢ÊàëÂ∞±ÂØπÂÖ∂ËøõË°åÊé¢„ÄÇ ÁΩë‰∏äÊ≤°ÊúâÊâæÂà∞Áõ∏ÂÖ≥ÊïôÁ®ãÔºå‰ª•‰∏ãÊòØÊàë‰∏çÊñ≠Â∞ùËØïÂêéÂæóÂá∫ÁöÑÁªìËÆ∫ÔºåÂ¶ÇÊûúÊúâÈîôËØØËøòËØ∑ÊåáÊ≠£„ÄÇ ÂáÜÂ§áÊú¨Ê¨°ÊàëÂ∞Ü‰ΩøÁî® SVProgressHUD ‰Ωú‰∏∫ÊµãËØïÁöÑÁ¨¨‰∏âÊñπÂ∫ì„ÄÇÊàë‰∏ãËΩΩ‰∫ÜÂÖ∂ 2.1.2 ÁöÑ‰ª£Á†ÅÔºåÂπ∂ÊâãÂä®ÂàÜÂà´ÊâìÊàê‰∫ÜÈùôÊÄÅÂ∫ì StaticSVProgressHUD‰ª•ÂèäÂä®ÊÄÅÂ∫ì DynamicSVProgressHUD ËøôÈáåÂº∫Ë∞É‰∏ÄÁÇπÔºöÈùôÊÄÅÂ∫ìÊó†ËÆ∫ÊòØ .a ËøòÊòØ .frameworkÔºåÈÉΩÊòØÊó†Ê≥ïÊääÂõæÁâáÁ≠âËµÑÊ∫êÊñá‰ª∂ÊâìËøõÂéªÁöÑÔºàÂåÖÊã¨Âú®Â∑•Á®ã‰∏≠ÂºïÂÖ•ÂÖ∂‰ªñÁöÑ xcodeproj ÊúÄÂêé‰πüÊòØÁîüÊàê‰∏Ä‰∏™ .a ÁöÑÈùôÊÄÅÂ∫ìÔºâ„ÄÇÂ¶ÇÊûúÊúâ‰∏éÈùôÊÄÅÂ∫ìÁõ∏ÂåπÈÖçÁöÑËµÑÊ∫êÊñá‰ª∂ÔºåÈúÄË¶ÅÊâì‰∏Ä‰∏™ bundle ÂíåÈùôÊÄÅÂ∫ì‰∏ÄËµ∑Ê∑ªÂä†Âà∞Â∑•Á®ã‰∏≠ÔºåÁÑ∂ÂêéÂ∞±ÂèØ‰ª•Áî®‰ª£Á†ÅÂà∞ mainBundle ‰∏≠Ëé∑Âèñ„ÄÇÂä®ÊÄÅÂ∫ìÊ≤°ÊúâËøô‰∏™ÈóÆÈ¢ò„ÄÇ Âä®ÊÄÅÂ∫ìÂºïÁî®ÈùôÊÄÅÂ∫ìÂàõÂª∫È¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™Âä®ÊÄÅÂ∫ì DynamicWithStaticÔºåÁÑ∂ÂêéÈìæÊé•ÂàöÊâçÁîüÊàêÁöÑ StaticSVProgressHUD Ôºö ÂêëÂÖ∂‰∏≠Ê∑ªÂä†Ëá™Â∑±ÁöÑÊòæÁ§∫ HUD ÁöÑÁ±ª DWSShowPicÔºåÂπ∂‰∏îÂ∞ÜËµÑÊ∫êÊñá‰ª∂ SVProgressHUD.bundle Âä†ÂÖ•Â∫ì‰∏≠„ÄÇ‰πãÂêéËÆæÁΩÆÂ•ΩÂ§¥Êñá‰ª∂Â∞±ÂèØ‰ª•Áõ¥Êé•ËøêË°å‰∫Ü„ÄÇÂõ†‰∏∫Âä®ÊÄÅÂ∫ìÂºïÁî®ÈùôÊÄÅÂ∫ìÂ∞±Áõ∏ÂΩì‰∫éÂ∞Ü‰ª£Á†ÅÁõ¥Êé•Ê∑ªÂä†Âú®‰∫ÜÂä®ÊÄÅÂ∫ìÈáåÔºåÊâÄ‰ª•ÂíåÊôÆÈÄöÂä®ÊÄÅÂ∫ìÊ≤°Êúâ‰ªÄ‰πàÂ∑ÆÂà´ÔºåÂÖ∑‰ΩìÂèØ‰ª•ÁúãÊàëÁöÑ Demo„ÄÇËÆ∞Âæó‰∏ÄÂÆöË¶ÅÂú®ÊµãËØïÂ∑•Á®ã‰∏≠ Embedded Binaries Ëøô‰∏™Âä®ÊÄÅÂ∫ì„ÄÇ ÂºïÂÖ• CocoapodsÁé∞Âú®Ê®°Êãü‰∏äÈù¢ÂàõÂª∫ÁöÑÂ∫ìÊòØÂ∑•‰Ωú‰∏≠Ë¶ÅÂºïÂÖ•ÁöÑÔºåÁÑ∂Âêé‰Ω†Êú¨Ë∫´‰ΩøÁî® Cocoapods ÁÆ°ÁêÜÁ¨¨‰∏âÊñπÂ∫ìÁöÑÔºåÂπ∂‰∏î‰πüÁî®Âà∞‰∫Ü SVProgressHUD„ÄÇÈÇ£‰πàËøô‰ºö‰∫ßÁîü‰ªÄ‰πàÂÜ≤Á™ÅÂêóÔºüÊàë‰ª¨ÂÆûÈ™å‰∏Ä‰∏ã„ÄÇ Êàë‰ª¨Â∞ÜÊµãËØïÂ∑•Á®ã‰∏≠ÂºïÂÖ• CocoapodsÔºö Â•ΩÁöÑÔºåËøêË°åÈ°πÁõÆÔºåÁúãÁúã‰ºöÂèëÁîü‰ªÄ‰πàÔºö ËøêË°åÊó∂Ê≤°ÊúâÈóÆÈ¢òÁöÑÔºå‰ΩÜÊòØÂá∫Áé∞‰∫Ü‰∏Ä‰∫õË≠¶Âëä„ÄÇËøôÊòØÂõ†‰∏∫‰Ω†Âú®Âä®ÊÄÅÂ∫ì‰∏≠ÂºïÂÖ•‰∫ÜÈùôÊÄÅÂ∫ì SVProgressHUDÔºåÂπ∂‰∏îÂèàÁî® Cocoapods ÂºïÂÖ•‰∫Ü‰∏ÄÈÅçÈùôÊÄÅÂ∫ì SVProgressHUD„ÄÇËøôÂ∞±‰∫ßÁîü‰∫ÜÂÜ≤Á™ÅÔºåÊâßË°åÁöÑÊó∂ÂÄô‰ºöÈÄâÊã©ÂÖ∂‰∏≠‰∏Ä‰∏™ÊâßË°å„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂØπÂä®ÊÄÅÂ∫ì‰∏≠ÂºïÂÖ•ÁöÑÈùôÊÄÅÂ∫ìÁöÑÊñá‰ª∂ËøõË°åÊîπÂêçÔºåÊØîÂ¶ÇÂä†‰∏äÂâçÁºÄ„ÄÇ Â¶ÇÊûúÂú® Cocoapods ‰∏≠ÂºïÂÖ•ÁöÑÊòØÂä®ÊÄÅÂ∫ì SVProgressHUD Âë¢ÔºüÁªìÊûú‰πüÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ‰ºöÂá∫Áé∞‰∏äÈù¢ÁöÑË≠¶ÂëäÔºå‰ΩÜÊòØ‰∏çÂΩ±ÂìçËøêË°å„ÄÇ Âä®ÊÄÅÂ∫ìÂºïÁî®Âä®ÊÄÅÂ∫ìÂàõÂª∫ÂàõÂª∫‰∏Ä‰∏™Âä®ÊÄÅÂ∫ì DynamicWithDynamicÔºåÁÑ∂ÂêéÈìæÊé•‰πãÂâçÁöÑÂä®ÊÄÅÂ∫ì DynamicSVProgressHUD: Âíå‰πãÂâç‰∏ÄÊ†∑ÁöÑÔºåÊ∑ªÂä†Ëá™Â∑±ÁöÑÊòæÁ§∫Á±ª DWDShowPic„ÄÇÁî±‰∫é DynamicSVProgressHUD ‰∏≠Ëá™Â∏¶‰∫ÜËµÑÊ∫ê bundleÔºåÊâÄ‰ª•ËøôÈáåÂ∞±‰∏çÈúÄË¶ÅÂÜçÊ∑ªÂä†‰∫Ü„ÄÇÊ≤°Êúâ‰ªÄ‰πàÁâπÂà´ÁöÑÁõ¥Êé•ËøêË°åÁîüÊàêÂä®ÊÄÅÂ∫ì„ÄÇÁé∞Âú®ÊîæÂà∞ÊµãËØïÂ∑•Á®ãÈáåËøêË°å„ÄÇÂêåÊ†∑ÁöÑÔºåË¶Å Embedded Binaries ‰∏≠Ê∑ªÂä†Ëøô‰∏™Âä®ÊÄÅÂ∫ì„ÄÇ ‰∏çÂá∫ÊÑèÂ§ñÁöÑÔºåÁ®ãÂ∫èÂ¥©‰∫ÜÔºö Ëøô‰∏™ÈóÆÈ¢ò‰∏äÈù¢ÁúãÂà∞Ëøá„ÄÇÊòØÂõ†‰∏∫Ê≤°ÊúâÈìæÊé•‰∏äÂä®ÊÄÅÂ∫ì„ÄÇ‰∏çËøáËøôÈáå‰∏çÊòØÊ≤°ÊúâÈìæÊé•‰∏ä DynamicWithDynamic ËÄåÊòØÊ≤°ÊúâÈìæÊé•‰∏ä DynamicSVProgressHUD„ÄÇÂä®ÊÄÅÂ∫ì‰∏ç‰ºöË¢´ÊâìÂåÖËøõÂä®ÊÄÅÂ∫ì‰∏≠ÔºåÂÆÉÂè™‰ºöÂàõÂª∫‰∏Ä‰∏™ÂºïÁî®ÔºåÈúÄË¶ÅÂú®È°πÁõÆ‰∏≠ÊâãÂä®Ê∑ªÂä†Ë¢´ÂºïÁî®ÁöÑÂä®ÊÄÅÂ∫ì„ÄÇÁé∞Âú®Êàë‰ª¨Âú®ÊµãËØïÂ∑•Á®ãÁöÑ Embedded Binaries ‰∏≠Ê∑ªÂä†ÊâÄÈúÄÁöÑÂä®ÊÄÅÂ∫ìÔºö ÂèØ‰ª•È°∫Âà©ËøêË°å„ÄÇ ÂºïÂÖ• CocoapodsÁé∞Âú®Ê®°ÊãüÁöÑÊòØ‰Ω†ÁöÑÂ∑•Á®ãÈáå‰ΩøÁî® Cocoapods ‰ΩøÁî®‰∫ÜÊüê‰∏™Âä®ÊÄÅÂ∫ìÔºåÊØîÂ¶Ç DynamicSVProgressHUDÔºåÁÑ∂Âêé SDK Êèê‰æõËÄÖÁªô‰Ω†Êèê‰æõ‰∫Ü‰∏Ä‰∏™‰ΩøÁî® DynamicSVProgressHUD ÁöÑÂä®ÊÄÅÂ∫ì DynamicWithDynamic„ÄÇÈÇ£‰πàÂºïÂÖ•‰ºöÊúâ‰ªÄ‰πàÈóÆÈ¢òÂêóÔºü Áî±‰∫éÊàë‰πãÂâçÁî®ÁöÑÈÉΩÊòØÂØπ SVProgressHUD ÁöÑÂ∞ÅË£Ö DynamicSVProgressHUDÔºåÁé∞Âú®ÁúãÊù•ÊòØÂ§öÊ≠§‰∏Ä‰∏æ‰∫ÜÔºåÂõ†‰∏∫ÊàëËøòÂæóËá™Â∑±ÂàõÂª∫‰∏Ä‰∏™ËÉΩË¢´ Cocoapods ÂºïÂÖ•ÁöÑ DynamicSVprogressHUD„ÄÇÂ¶ÇÊûúÁõ¥Êé•Áî® SVProgressHUD Â∞±ÂæàÂºÄÂøÉ‰∫Ü„ÄÇÁé∞Âú®‰øÆÊîπ PodfileÔºö ÈÄöËøá use_frameworks ‰Ωø Cocoapods ÂàõÂª∫Âä®ÊÄÅÂ∫ìÔºåÁÑ∂ÂêéËá™Â∑±ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êú¨Âú∞ÁöÑ DynamicSVProgressHUD„ÄÇ Áé∞Âú®Êàë‰ª¨ÊääÂàöÊâçÊâãÂä®Âä†ÂÖ•ÁöÑ DynamicSVProgressHUD Âà†ÂéªÔºåÁÑ∂Âêé pod install ÔºåËøêË°å„ÄÇÁªìÊûúÊ≠£Â∏∏ÔºåËøêË°åÊ≤°ÊúâÈóÆÈ¢ò„ÄÇ Â¶ÇÊûúÊàë‰ª¨ pod Âä†ËΩΩÁöÑÊòØ‰∏™ÈùôÊÄÅÁöÑ DynamicSVProgressHUDÔºå‰ΩÜÊòØÈúÄË¶ÅÁöÑÊòØ‰∏™Âä®ÊÄÅÁöÑ DynamicSVProgressHUD ‰ºöËøôÊ†∑Ôºü‰ºö‰∫ßÁîüÂíå‰∏äÈù¢Ê≤°ÊúâÂú® Embedded Binaries ‰∏≠Ê∑ªÂä†Âä®ÊÄÅÂ∫ìÁõ∏ÂêåÂéüÂõ†ÁöÑÂ¥©Ê∫É„ÄÇ Áé∞Âú®ËøòÊúâ‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂ¶ÇÊûúÊàë‰∏çÂ∞Ü‰πãÂâçÂä†ÂÖ•ÁöÑ DynamicSVProgressHUD Âà†ÂéªÂë¢ÔºüÂç≥Â∑•Á®ã‰∏≠‰øùÁïô‰∫Ü‰∏§‰∏™ÂêåÂêçÁöÑÂä®ÊÄÅÂ∫ì DynamicSVProgressHUD„ÄÇ‰ºöÂèëÁîü‰ªÄ‰πàÊ†∑ÁöÑÊÉÖÂÜµÔºü ËøêË°åÔºåÊ≤°Êúâ‰ªª‰ΩïÈóÆÈ¢òÔºå‰πü‰∏ç‰ºö‰∫ßÁîü‰ªª‰Ωï warning„ÄÇ‰∏∫‰∫ÜÂå∫ÂàÜÂà∞Â∫ïÊòØÂì™‰∏™Ë¢´ÊâßË°å‰∫ÜÔºåÊàëÂú® pod Ê∑ªÂä†ÁöÑÂ∫ìÁöÑ‰ª£Á†Å‰∏≠Ê∑ªÂä†‰∫Ü log„ÄÇËøêË°åÊó∂ÊâìÂç∞Âá∫‰∫Ü logÔºåËØÅÊòéËøêË°åÁöÑÊòØ pod ÁöÑÂ∫ì„ÄÇÂΩìÁÑ∂Ëøô‰∏çÁªùÂØπÔºå‰πüÊúâÂèØËÉΩ‰∏çÊâßË°å pod ÁöÑÂ∫ìÁöÑÊñπÊ≥ï„ÄÇÈóÆÈ¢òÁöÑÊ†∏ÂøÉÂú®‰∫é‰Ω†Âú® Linked Frameworks and Libraries Êó∂Âì™‰∏™Â∫ìÊòØÂÖàË¢´Ê∑ªÂä†ÁöÑ„ÄÇ‰∏äÈù¢ÁöÑ‰πãÊâÄ‰ª•ÊÄªÊòØÊâßË°å pod ÁöÑÂ∫ìÔºåÂ∞±ÊòØÂõ†‰∏∫Âú® Linked Frameworks and Libraries ‰∏≠ÔºåÂÖàÊ∑ªÂä†ÁöÑÊòØ pod ÁöÑÂ∫ì„ÄÇpod ÁöÑÂ∫ìÊâßË°åÊó∂Ë¢´Âä†ËΩΩÂêéÔºåÊâãÂä®Ê∑ªÂä†ÁöÑÂêåÂêçÂ∫ìÂ∞±‰∏ç‰ºöË¢´Âä†ËΩΩ‰∫Ü„ÄÇ Âä®ÊÄÅÂ∫ìÂºïÂÖ•Âä®ÊÄÅÂ∫ìÔºå‰∏ç‰ºöÂ∞ÜË¶ÅÂºïÂÖ•ÁöÑÂä®ÊÄÅÂ∫ìÊâìÂåÖÂà∞Ëá™Ë∫´‰∏≠ÔºåÂç≥Âè™ÊòØ link ‰∫ßÁîüÂÖ≥ËÅîÔºåËÄå‰∏çÊòØÂíåÈùôÊÄÅÂ∫ì‰∏ÄÊ†∑ÂÆåÂÖ®ÂÜôÂÖ•„ÄÇ ÈúÄË¶ÅÂú®Â§ñÈÉ®‰ΩøÁî®ËØ•Âä®ÊÄÅÂ∫ìÊó∂ÔºåÊâãÂä® embed Âä®ÊÄÅÂ∫ìÂÜÖË¶Å‰ΩøÁî®ÁöÑÂä®ÊÄÅÂ∫ì„ÄÇËøôÊ†∑ÁöÑÂÅöÊ≥ïÂæàÈ∫ªÁÉ¶ÔºåÈÇ£‰πàÊúâ‰ªÄ‰πàÊÑè‰πâÂë¢ÔºüÊ≠£Â¶ÇÂä®ÊÄÅÂ∫ìÊú¨Ë∫´ÁöÑ‰ΩúÁî®ÔºåÂ¶ÇÊûúÂ∑•Á®ãÊú¨Ë∫´‰πüË¶ÅÁî®Âà∞ËØ• SVProgressHUD Âä®ÊÄÅÂ∫ìÊó∂ÔºåÈÇ£‰πà‰ªÖÈúÄÂØºÂÖ•‰∏Ä‰ªΩÔºåÂ∞±‰∏ç‰ºö‰∫ßÁîüÈáçÂ§ç‰ª£Á†Å‰∫Ü„ÄÇ ÈùôÊÄÅÂ∫ìÂºïÁî®ÈùôÊÄÅÂ∫ìÂàõÂª∫Áé∞Âú®Êù•Âà∞ÈùôÊÄÅÂ∫ìÂºïÁî®ÈùôÊÄÅÂ∫ìÁöÑÂÆûÈ™åÁéØËäÇ„ÄÇÊàë‰ª¨ËøòÊòØÂÖàÂàõÂª∫‰∏Ä‰∏™ StaticWithStatic ÁöÑÈùôÊÄÅÂ∫ìÔºåÂú®ÂÖ∂‰∏≠ÂºïÂÖ• StaticSVProgressHUD„ÄÇÁÑ∂ÂêéÂàõÂª∫‰∏Ä‰∏™Á±ª SWSShowPic Áî®Êù•Ë∞ÉÁî®ÈùôÊÄÅÂ∫ì„ÄÇÁî±‰∫é‰∏äÈù¢ËØ¥Âà∞ÈùôÊÄÅÂ∫ìÁöÑËµÑÊ∫êÊñá‰ª∂Êó†Ê≥ïÊâìÂåÖÂú®ÈùôÊÄÅÂ∫ì‰∏≠ÔºåÂõ†Ê≠§ÔºåËµÑÊ∫êÊñá‰ª∂Â∞ÜÁõ¥Êé•ÊîæÂà∞ÊµãËØïÂ∑•Á®ã‰∏≠ÂéªÔºö ÊääÁîüÊàêÁöÑÈùôÊÄÅÂ∫ìÊîæÂà∞ÊµãËØïÂ∑•Á®ã‰∏≠ÂéªÊâßË°å„ÄÇÁºñËØëÊó∂‰∫ßÁîüÈîôËØØÔºö Ëøô‰∏™ÈîôËØØËØ¥ÊòéÈùôÊÄÅÂ∫ì StaticWithStatic Âπ∂Ê≤°ÊúâÊää StaticSVProgressHUD ÂµåÂÖ•ÂÖ∂‰∏≠ÔºåÂç≥ÈùôÊÄÅÂ∫ìÊó†Ê≥ïÂµåÂÖ•ÈùôÊÄÅÂ∫ì‰∏≠„ÄÇÂä®ÊÄÅÂ∫ìÁ°ÆÂÆûÊòØÊääÈùôÊÄÅÂ∫ìÊâìÂú®‰∫ÜËá™Â∑±ÁöÑÂ∫ì‰∏≠Ôºå‰ΩÜÊòØÈùôÊÄÅÂ∫ìÊó†Ê≥ïÂÅöÂà∞Ëøô‰∏ÄÁÇπ„ÄÇÊàëÊÉ≥ËøôÂ∫îËØ•ÂíåËµÑÊ∫êÊñá‰ª∂Êó†Ê≥ïÊâìËøõÈùôÊÄÅÂ∫ìÁ±ª‰ºº„ÄÇ ÊâÄ‰ª•Ôºå‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂú®ÊµãËØïÂ∑•Á®ã‰∏≠Ê∑ªÂä†ÊâÄÈúÄÁöÑÈùôÊÄÅÂ∫ì StaticSVProgressHUD: Áé∞Âú®ÂÜçÁºñËØëËøêË°åÔºå‰∏ÄÂàáÊ≠£Â∏∏„ÄÇ ÂºïÂÖ• CocoapodsÂêåÊ†∑Áî® Cocoapods Ê®°Êãü‰∏Ä‰∏ãÈÄöËøá Cocoapods ÊòØÂê¶ÂèØ‰ª•‰∏∫ÈùôÊÄÅÂ∫ìÊèê‰æõÈùôÊÄÅÂ∫ìÁöÑÈìæÊé•„ÄÇÊåâÁÖß‰∏äÈù¢ÁöÑÊñπÂºèÔºåÂàõÂª∫‰∏Ä‰∏™‰æõÈùôÊÄÅÂ∫ìÂºïÂÖ•ÁöÑ StaticSVProgressHUD„ÄÇÊ≥®ÊÑèË¶Å‰øÆÊîπ PodfileÔºåÊää use_frameworks! Ê≥®ÈáäÊéâÔºö Â∞ÜÂéüÊù•ÊâãÂä®ÂºïÂÖ•ÁöÑ StaticSVProgressHUD Âà†Èô§ÔºåÁÑ∂ÂêéÁõ¥Êé•ËøêË°åÔºåÊ≤°Êúâ‰ªª‰ΩïÈóÆÈ¢ò„ÄÇ ÈÇ£‰πàÂÜçÊù•ÊÄùËÄÉ‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂ¶ÇÊûúÊàë‰∏çÊääÊâãÂä®ÂºïÂÖ•ÁöÑÂ∫ìÂà†Èô§ÔºåÂç≥Êúâ‰∏§‰∏™Áõ∏ÂêåÁöÑÈùôÊÄÅÂ∫ì‰ºöÊÄéÊ†∑Ôºü ÂèØ‰ª•ÁúãÂà∞ÔºåÁºñËØëÁöÑÊó∂ÂÄôÁõ¥Êé•Êä• duplicate symbol ÁöÑÈîô„ÄÇÂÖ∂ÂÆûÂ∞±ÊòØ‰∏§‰∏™ÈùôÊÄÅÂ∫ì‰∏≠Ôºå‰∏çËÉΩÊúâÁõ∏ÂêåÁöÑÊñá‰ª∂ÂêçÔºåÂê¶ÂàôÁºñËØë‰∏çÈÄöËøá„ÄÇ‰∏çËøá‰πãÂâçÂØπ‰∫éÂä®ÊÄÅÂ∫ìÂåÖÂê´ÈùôÊÄÅÂ∫ì‰∏≠ÁöÑÊñá‰ª∂ÂíåÂ∑•Á®ã‰∏≠Êñá‰ª∂ÈáçÂêçÁöÑÊÉÖÂÜµÂ∞±Âè™Êä•‰∫Ü‰∏™ warning„ÄÇÔºàÁâπÊåá‰∏çËÉΩÊúâÂêåÂêçÊñá‰ª∂ÔºåÂíåÂ∫ìÂêåÂêçÊ≤°ÊúâÂÖ≥Á≥ª -.-Ôºâ ÈùôÊÄÅÂ∫ìÂºïÁî®Âä®ÊÄÅÂ∫ìÂàõÂª∫ÊúÄÂêéÊàë‰ª¨ËØïÈ™å‰∏Ä‰∏ãÈùôÊÄÅÂ∫ìÂ¶Ç‰ΩïÂºïÁî®Âä®ÊÄÅÂ∫ì„ÄÇËøòÊòØÂ¶ÇÊ≥ïÁÇÆÂà∂„ÄÇÂàõÂª∫‰∏Ä‰∏™ÈùôÊÄÅÂ∫ì StaticWithDynamicÔºåÁÑ∂ÂêéÂú® Link FrameWorks and Libraries ‰∏≠Ê∑ªÂä†Âä®ÊÄÅÂ∫ì DynamicSVProgressHUD„ÄÇÁé∞Âú®ÊääÁîüÊàêÁöÑÈùôÊÄÅÂ∫ìÊãñÂà∞ÊµãËØïÂ∑•Á®ã‰∏≠ÔºåËøêË°åÔºåÁºñËØëÊó∂Âá∫Èîô„ÄÇËøòÊòØÈÇ£‰∏™Áî±‰∫éÊ≤°ÊúâÈìæÊé•Âä®ÊÄÅÂ∫ì‰∫ßÁîüÁöÑ image not found ÈîôËØØÔºåÊàëÂ∞±‰∏çË¥¥ÂõæÁâá‰∫Ü„ÄÇ Ëß£ÂÜ≥ÊñπÂºè‰πüÊòØ‰∏äÈù¢ËØ¥ÁöÑÔºåË¶ÅÊääÂä®ÊÄÅÂ∫ì DynamicSVProgressHUD ÂçïÁã¨Ê∑ªÂä†Âà∞ EMbedded Binaries‰∏≠Âéª„ÄÇËøôÊ†∑ËøêË°å‰∏ÄÂàáÊ≠£Â∏∏„ÄÇ ÂºïÂÖ• CocoapodsÈÄöËøá‰πãÂâçÁöÑÂ≠¶‰π†ÔºåÂà∞ËøôÈáåÔºå‰∏çÁî®ËØï‰πüÂ∫îËØ•Áü•ÈÅì‰ºöÂèëÁîü‰ªÄ‰πà‰∫Ü„ÄÇËøêË°åÊ≠£Â∏∏ÔºåÂ¶ÇÊûúÈ°πÁõÆÈáåÊúâÂ§ö‰∏™ÂêåÂêçÂä®ÊÄÅÂ∫ìÔºåÂÖàÊ∑ªÂä†ÁöÑ‰ºöË¢´ÊâßË°å„ÄÇ ÊÄªÁªìÂà∞ËøôÈáåÈùôÊÄÅÂ∫ìÂä®ÊÄÅÂ∫ìÁõ∏‰∫íÂºïÁî®Ôºå‰ª•ÂèäÈÖçÂêà Cocoapods ÁöÑÊâÄÊúâÊÉÖÂÜµÊàëÈÉΩÂ∑≤ÁªèÂàó‰∏æÂÆåÊØï‰∫Ü„ÄÇÁ¥Ø„ÄÇÂ∫îËØ•ÊâÄÊúâÊé•ÂÖ• SDK Êó∂ÂÄô‰ºöÈÅáÂà∞ÁöÑÊÉÖÂÜµÈÉΩÂ∑≤ÁªèÊûö‰∏æËøá‰∏ÄÈÅç‰∫Ü„ÄÇ ‰∏Ä‰∫õÈúÄË¶ÅÁü•ÈÅìÁöÑÁÇπdebug‰∏éreleaseÂ∫ìÂàÜ‰∏∫ debug Âíå release ‰∏§ÁßçÁâàÊú¨„ÄÇ‰∏ÄËà¨Êù•ËØ¥, Êàë‰ª¨Â∫îËØ•ÂèëÂ∏ÉÁöÑÊòØ release ÁâàÊú¨„ÄÇ debug :Ë∞ÉËØïÁâàÊú¨, Á≥ªÁªüÊú¨Ë∫´‰πü‰ºöÊúâ‰∏Ä‰∫õË∞ÉËØï‰ª£Á†Å. Ê≠§ÁâàÊú¨‰ΩìÁßØ‰ºöÁ®çÂ§ß, ËøêË°å‰ºöÁ®çÊÖ¢„ÄÇ release : ÂèëÂ∏ÉÁâàÊú¨, Á≥ªÁªü‰ºöÂéªÈô§Ë∞ÉËØï‰ª£Á†Å, ‰ΩìÁßØÂèòÂ∞è, ËøêË°åÈÄüÂ∫¶ÂèòÂø´. ÂØπÁî®Êà∑Êù•ËØ¥Ê≤°ÊúâÊòéÊòæÁöÑÊÑüËßâ„ÄÇ debug ‰∏é release ÁöÑËÆæÁΩÆÊñπÂºèÂ¶Ç‰∏ãÂõæÔºö ÂØπ‰∫éÂà´‰∫∫ÁªôÁöÑÂ∫ìÔºåË≤å‰ººÂπ∂‰∏çËÉΩÂå∫ÂàÜÊòØ debug ËøòÊòØ release ÁâàÊú¨ÁöÑ„ÄÇ Â§öÊû∂ÊûÑÁºñËØëÂ∫ì‰∏ç‰ªÖÊåâ debug Âíå release ÂàÜÁ±ªÔºåËøò‰ºöÂõ†‰∏∫ËøêË°åÁ≥ªÁªüÁöÑ‰∏çÂêåËÄåÁºñËØëÂá∫‰∏çÂêåÊ°ÜÊû∂ÁöÑÁâàÊú¨„ÄÇ‰∏äÈù¢ÁöÑ‰æãÂ≠êÈÉΩÊòØÂú®ÁúüÊú∫‰∏ãÁöÑÁºñËØëÔºå‰∏∫ arm64 ÁâàÊú¨ÔºåÂú®ÂÖ∂‰ªñÁöÑÊ°ÜÊû∂‰∏ã‰∏çËÉΩÊ≠£Á°ÆËøêË°å„ÄÇ Ê°ÜÊû∂ÂàÜÁ±ªÔºö Ê®°ÊãüÂô®Êû∂ÊûÑ: i386 : 32‰ΩçÊû∂ÊûÑ 4S ~ 5 x86_64 : 64‰ΩçÊû∂ÊûÑ 5S ~ Áé∞Âú®ÁöÑÊú∫Âûã ÁúüÊú∫Êû∂ÊûÑ: arm7: Âú®ÊúÄËÄÅÁöÑÊîØÊåÅiOS7ÁöÑËÆæÂ§á‰∏ä‰ΩøÁî® arm7s: Âú®iPhone5Âíå5C‰∏ä‰ΩøÁî® arm64: ËøêË°å‰∫éiPhone5SÁöÑ64‰Ωç ARM Â§ÑÁêÜÂô® ‰∏ä ‰øÆÊîπÊ°ÜÊû∂ÁöÑÊñπÂºèÂ¶Ç‰∏ãÂõæÔºö debug È°πÈªòËÆ§‰∏∫ YES ÔºåË°®Á§∫‰ªÖÁîüÊàêÂΩìÂâçÈÄâÊã©ÁöÑÊ°ÜÊû∂ÁöÑÂ∫ìÔºõ release È°πÈªòËÆ§‰∏∫ NO ÔºåË°®Á§∫ÁîüÊàêÊîØÊåÅÊâÄÊúâÊ®°ÊãüÂô®ÊàñÁúüÊú∫ÁöÑÂ∫ì„ÄÇÁîüÊàêÁöÑÂ∫ìÂ∞Ü‰ºö‰øùÂ≠òÂú® products ÁõÆÂΩï‰∏ãÁöÑ‰∏çÂêåÂàÜÁ±ªÁõÆÂΩïÂÜÖÔºö lipolipo ÊòØ‰∏™ÂæàÊúâÁî®ÁöÑÂëΩ‰ª§Ôºå‰∏ªË¶ÅÁî®Êù•Êü•ÁúãÂ∫ìÊîØÊåÅÁöÑÊû∂ÊûÑ‰ª•ÂèäÂêàÂπ∂ÊãÜÂàÜÂ∫ì„ÄÇ -infoÊü•ÁúãÂàöÊâçÁºñËØëÁöÑ Framework Â∫ìÂú® debug Âíå release ‰∏ãÊîØÊåÅÁöÑÊ°ÜÊû∂ÔºöÂèØ‰ª•ÁúãÂà∞Ê≠£Â¶Ç‰∏äÈù¢ÊâÄËØ¥ debug ‰∏ã‰∏çÊòØ fat file ÔºåÂè™ÊîØÊåÅ arm64 Ôºå release ‰∏ãÊòØ fat file Ôºå ÊîØÊåÅ arm7 Âíå arm64„ÄÇ -create‰∏äÈù¢ÁîüÊàêÁöÑÂ∫ìÔºåË¶Å‰πàÊòØÂè™ÊîØÊåÅÊ®°ÊãüÂô®ÁöÑÔºåË¶Å‰πàÊòØÂè™ÊîØÊåÅÁúüÊú∫ÁöÑÔºåÈÇ£‰πàÂ¶Ç‰ΩïÊâçËÉΩÂèàËÉΩÂÖºÈ°æÁúüÊú∫ÂíåÊ®°ÊãüÂô®Âë¢Ôºü -create ‰ΩøÁî®ÊñπÂºèÔºö 1lipo -create Â∫ì1 Â∫ì2 -output Êñ∞Â∫ì ‰ΩøÁî®ÁªìÊûúÂ¶Ç‰∏ãÂõæÔºö -thinÂ¶ÇÊûúÊúâ‰∏Ä‰∏™ fat file ‰ΩÜÊòØ‰Ω†‰∏çÈúÄË¶ÅÊîØÊåÅÈÇ£‰πàÂ§öÊ°ÜÊû∂Ôºå‰πüÂèØ‰ª•ÈÄöËøáÊãÜÂàÜÔºå‰∏∫Â∫ìÁò¶Ë∫´Ôºå -thin ‰ΩøÁî®ÊñπÂºèÔºö 1lipo ÊóßÂ∫ì -thin ÈúÄÊãÜÂàÜÊ°ÜÊû∂ -output Êñ∞Â∫ì ‰ΩøÁî®ÁªìÊûúÂ¶Ç‰∏ãÂõæÔºö ÂèÇËÄÉÈìæÊé•WWDC2014‰πãiOS‰ΩøÁî®Âä®ÊÄÅÂ∫ìÊâãÊääÊâãÊïô‰Ω†‰ΩøÁî®CocoaPodsÊâìÂåÖÈùôÊÄÅÂ∫ìiOS ÈùôÊÄÅÂ∫ìÂºÄÂèë‰ΩøÁî®CocoaPodsÂºÄÂèëÂπ∂ÊâìÂåÖÈùôÊÄÅÂ∫ì‰ΩøÁî®CocoapodsÂàõÂª∫ÁßÅÊúâpodspeciOSÈùôÊÄÅÂ∫ì „Äê.a Âíåframework„Äë„ÄêË∂ÖËØ¶ÁªÜ„ÄëÂàõÂª∫‰∏Ä‰∏™ iOS Framework È°πÁõÆiOSÂºÄÂèë‚Äî‚ÄîÂàõÂª∫‰Ω†Ëá™Â∑±ÁöÑFrameworkiOS‰∏≠workspace‰∏éÈùôÊÄÅÂ∫ìCocoapods Â∫îÁî®Á¨¨‰∏ÄÈÉ®ÂàÜ - Xcode ÂàõÂª∫ .framework Áõ∏ÂÖ≥iosÊâìÂåÖ‚ÄìÊâìÂåÖÈùôÊÄÅÂ∫ì(‰∫î) Âëº~ÊÄªÁÆóÊääÂ∫ìÁöÑÁõ∏ÂÖ≥Áü•ËØÜÁúãÂÆå‰∫ÜÔºåÂÜôÊàêËøôÁ¨¨‰∫åÁØá„ÄÇËä±‰∫ÜÂçä‰∏™ÊúàÊâçÂÜôÂÆå„ÄÇÊúüÈó¥ÂêÑÁßçÈóÆÈ¢òÔºåÂêÑÁßçÈîôËØØ‰∏çÁü•ÈÅìÊÄé‰πàËß£ÂÜ≥ÔºåÁúüÁöÑÁ¥Ø„ÄÇ‰ª•ÂêéËøòÊòØÁ†îÁ©∂‰∫õÁªèÂ∏∏ËÉΩÁî®ÂæóÂà∞ÁöÑ‰∏úË•øÂêß„ÄÇËá™Â∑±Âü∫Êú¨‰∏çÈúÄË¶ÅÊâìÂåÖÂ∫ì~ ÊàëÁöÑdemoÂú∞ÂùÄÔºåÊ¨¢ËøéÂèÇËÄÉ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Xcode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Storyboard ‰ΩøÁî®ÊñπÊ≥ï]]></title>
    <url>%2F2016%2F10%2F13%2Fstoryboard%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[StoryboardÊòØËãπÊûúÂÆòÊñπ‰∏ªÊé®ÁöÑ‰∏Ä‰∏™‰ª£ÊõøxibÁöÑÁ≠ñÁï•„ÄÇÊúâÂøÖË¶ÅËØ¶ÁªÜÂ≠¶‰π†‰∏ãÂÆÉÁöÑ‰ΩøÁî®ÊñπÊ≥ï„ÄÇ ÂÖàÊù•Áúã‰∏Ä‰∏ãÊÄùÁª¥ÂØºÂõæ storyboardÂü∫Á°Ästoryboard‰ºòÂäøstoryboardËÉΩ‰ª£ÊõønibËá™ÁÑ∂ÊúâÂÖ∂‰ºòÂäøÔºå‰∏ÄËà¨Êù•ËØ¥storyboardÂÖ∑Êúâ‰ª•‰∏ãÂá†Áßç‰ºòÁÇπÔºö storyboardËÉΩÂ∞ÜnibÊ±áÊÄªÁªü‰∏ÄÁÆ°ÁêÜ storyboardÂèØ‰ª•ÊèèËø∞ÂêÑÁßçÂú∫ÊôØ‰πãÈó¥ÁöÑËøáÊ∏°ÔºåËøôÁßçËøáÊ∏°Ë¢´Áß∞‰ΩúsegueÔºåstoryboard Êää view controllerÂè´ÂÅöÔºösceneÔºåÂèØ‰ª•ÈÄöËøáÊãñÊãΩÂÆûÁé∞ËøáÂ∫¶ÔºåÂáèÂ∞ë‰ª£Á†Å ÊîØÊåÅtableviewÁöÑprototype cellÔºåÂèØ‰ª•Âú®storyboard‰∏≠ÁºñËæëcellÔºåÂáèÂ∞ë‰ª£Á†ÅÈáè storyboardÁöÑÂü∫Êú¨‰ΩøÁî®ÂêØÂä®storyboardÂä†ËΩΩstoryboardËÇØÂÆöÊòØÈúÄË¶Å‰∏Ä‰∏™‰∏ªÂÖ•Âè£ÁöÑÔºåËøô‰∏™‰∏ªÂÖ•Âè£Âú®info.plist‰∏≠Ôºö ÂàùÂßãÂåñViewControllerÁ°ÆÂÆö‰∫ÜÂì™‰∏™storyboardÊòØ‰∏ªÂÖ•Âè£ÔºåÈÇ£ÊòæÁÑ∂‰πüË¶ÅÁ°ÆÂÆöÂì™‰∏™ViewControllerÊòØstoryboardÁöÑ‰∏ªÂÖ•Âè£„ÄÇÈúÄË¶ÅÈÄâ‰∏≠Áõ∏Â∫îViewControllerÔºåÂãæÈÄâIs Initial View ControllerÊ≠§Êó∂ÔºåÂØπÂ∫îViewControllerÂâçÂá∫Áé∞‰∏Ä‰∏™ÁÆ≠Â§¥ ÂàõÂª∫relationship segueÂØπ‰∫é‰∏âÂ§ßcontainer view controllerÔºåÂç≥Tab Bar ControllerÔºåNavigation ControllerÔºåSplit View Controller ÔºåÂèØ‰ª•ÈÄöËøáÊãñÊãΩÂàõÂª∫ËÆæÁΩÆrelationship segue„ÄÇ Â¶Ç‰∏ãÂõæÁöÑ popup menu ÊòØ‰ªétab bar controller ËøûÂà∞navigation controller,ÊùæÊâãÂêéÁöÑÂºπÂá∫ÔºöËøûÊé•ÂêéÁöÑÂõæÊ†áÂ¶Ç‰∏ãÂõæÔºåË°®Á§∫relationship segue ÂëΩÂêçtabbar controllerÁöÑtabbarÂπ∂ÈùûÂú®tabbar controllerÈáåÔºåËÄåÊòØÂú®‰∏éÂÖ∂Áõ∏Ëøû„ÄÅÂØπÂ∫îÁöÑcontrollerÈáåÊîπÂä®ÔºåÂ¶ÇÂõæÔºönavigation bar ÁöÑ title ‰πüÊòØÂêåÁêÜ„ÄÇ‰ΩÜÊòØÔºåÂº∫ÁÉà‰∏çÂª∫ËÆÆÂú®storyboardÈáåËÆæÁΩÆnavigationbarÔºåÂõ†‰∏∫storyboardÊòØ‰∏∫‰∫ÜÁÆÄÂåñÊìç‰ΩúÁöÑÔºå‰ΩÜÊòØËÆæÁΩÆnavigationbarÂ§™È∫ªÁÉ¶‰∫ÜÔºåËøò‰∏çÂ¶Ç‰ª£Á†ÅÊñπ‰æøÂÆûÁî®„ÄÇ ËÆæÁΩÆViewControllerÂØπÂ∫îÁöÑÁ±ªÈÄâ‰∏≠Áõ∏Â∫îViewControllerÔºåÁÑ∂ÂêéÂú® Custom Class ÂÜÖÂÜô‰∏äÁõ∏Â∫îÁ±ªÂêçÂç≥ÂèØ„ÄÇÊ≥®ÊÑèÔºåË¶ÅÈÄâ‰∏≠ ViewController ËÄå‰∏çÊòØÂÖ∂‰∏≠ÁöÑ ViewÔºåË¶ÅÁÇπÂáªÂõæ‰∏≠ÁöÑÈªÑËâ≤ÂúÜÂΩ¢ÊåâÈíÆ„ÄÇ Ëé∑ÂèñËßÜÂõæÊéßÂà∂Âô®Â∞±ÊòØÈÄöËøáUITableViewControllerÂíåUINavigationController‰∏≠ÁöÑviewControllersËé∑ÂèñÔºö 123UITabBarController *tabBarController = (UITabBarController *)self.window.rootViewController;UINavigationController *navigationController = [tabBarController viewControllers][0];PlayersViewController *playersViewController = [navigationController viewControllers][0]; Prototype cellsÈÄâ‰∏≠tableviewÔºåËÆæÁΩÆtableviewÁöÑ cotent ‰∏∫ Dynamic Propotype‰∏ÄËà¨Âú®tableView: cellForRowAtIndexPath:ÊñπÊ≥ï‰∏≠ÈÉΩÂÉè‰∏ãÈù¢Ôºö 123456789101112- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath&#123; static NSString *CellIdentifier = @"Cell"; UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier]; if (cell == nil) &#123; cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier]; &#125; // Configure the cell... return cell;&#125; ‰ΩÜÊòØÔºåÁî±‰∫éÂú®storyboard‰∏≠Â∑≤ÁªèÂàõÂª∫‰∫ÜcellÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®‰∫ÜÔºö 12345678- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath&#123; UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"PlayerCell"]; // Configure the cell... return cell;&#125; ÂΩìÁÑ∂Ôºå‰∏Ä‰∏™tableviewÈáåËÇØÂÆö‰∏çÂ∫îËØ•Âè™Êúâ‰∏Ä‰∏™ÔºåÂèØ‰ª•Êää‰∏äÈù¢ÁöÑ Content ‰∏ãÈù¢ÁöÑ Prototype Cells Â¢ûÂä†cellÔºåÁÑ∂ÂêéÈÄâÊã©‰ªªÊÑècellÔºåÂ¶ÇÂõæÔºöËÆæÁΩÆ‰∏çÂêåÁöÑ identifier Êù•Ê†áËØÜ‰∏çÂêåÁöÑcell„ÄÇ Èô§‰∫ÜÂú®viewcontrollerÈáåÁõ¥Êé•ÂàõÂª∫cellÔºå‰∏çÈúÄË¶ÅÂè¶‰∏Ä‰∏™cellÁöÑxibÁöÑÂå∫Âà´Â§ñÔºåÂÖ∂‰ªñÊñπÈù¢ÂíåxibÊó†ÂºÇ„ÄÇ‰πüÂèØ‰ª•ÈÄâ‰∏≠cellÔºåÂú®Âè≥ËæπÊ†èÊåáÂÆöÂØπÂ∫îÁöÑControllerÁöÑcustom classÁî®Êù•ÊéßÂà∂cell„ÄÇÂêåÊ†∑ÁöÑÔºå‰πü‰∏çËÉΩÁõ¥Êé•Êääcell‰∏≠ÁöÑviewËøûÁ∫øÂà∞cellÊâÄÂ±ûÁöÑviewController‰∏≠„ÄÇ Static cells‰ΩøÁî®ÈùôÊÄÅÁöÑcellÔºåÈÄÇÁî®Âú®‰ªÖÊúâÂá†‰∏™Á°ÆÂÆöcellÁöÑtableview‰∏≠Ôºå‰∏çËÉΩÈáçÁî®ÔºåËÆæÁΩÆ‰∫ÜÂá†‰∏™cellÔºåÂ∞±ÊòæÁ§∫Âá†‰∏™cell„ÄÇstatic cellsÁöÑËÆæÁΩÆÂ¶Ç‰∏ãÂõæÔºöÂõ†‰∏∫prototype cellsÁ©∂Á´üÊÄé‰πàÊòæÁ§∫ÂèØ‰ª•Âú®‰ª£Á†Å‰∏≠ËÆæÁΩÆÔºåÊâÄ‰ª•Âè™ÈúÄË¶ÅËÆæÁΩÆÊúâÂá†‰∏™ÂèØÈáçÁî®ÁöÑcellÂ∞±Ë°å‰∫ÜÔºåËÄåstatic cellsÂõ†‰∏∫‰∏çÂèØÈáçÁî®ÔºåÈÇ£‰πàËøôÈáåÁöÑËÆæÁΩÆÈÄâÈ°πÂ∞±ÂèòÊàê‰∫Ü Sections ËÆæÁΩÆÂ§öÂ∞ëÊÆµ„ÄÇ ÈÇ£‰πàÊÄé‰πàËÆæÁΩÆÊØè‰∏™sectionÊúâÂ§öÂ∞ë‰∏™cellÂë¢ÔºüÈÄâ‰∏≠Â¶Ç‰∏ãÂõæÊâÄÁ§∫ÁöÑÂè™Êúâstatic cellsÊâçÊúâÁöÑËìùËâ≤Á´ãÊñπ‰ΩìÔºöÊ≠§Êó∂Âè≥ËæπÊ†èÂá∫Áé∞Â¶ÇÂõæÊâÄÁ§∫ Table View SectionÂèØ‰ª•ËÆæÁΩÆÊï∞ÈáèÔºåË°®Â§¥Ë°®Â∞æÁöÑtitle Âíå prototype cell ‰∏ÄÊ†∑Ôºåstatic cellÂèØ‰ª•ÊåáÂÆö‰∏Ä‰∏™‰∏ìÈó®ÁöÑController„ÄÇ‰ΩÜÊòØ‰∏çÂêåÁöÑÊòØÔºåstatic cell ÁöÑcell‰ª•Âèäcell‰∏≠ÁöÑÊéß‰ª∂ÈÉΩÁõ∏ÂΩì‰∫éÁ°ÆÂÆöÁöÑviewÔºåÂõ†Ê≠§Ôºåstatic cellÂèØ‰ª•Êääcell‰ª•Âèäcell‰∏≠ÁöÑÊéß‰ª∂ËøûÁ∫øÂà∞cellÊâÄÂ±ûÁöÑviewController‰∏≠„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂ¶ÇÊûúÂú®cellÁöÑController‰∏≠ËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™buttonÁöÑÁÇπÂáª‰∫ã‰ª∂ÔºåÁÑ∂ÂêéÂèàÂú®cellÊâÄÂ±ûviewController‰∏≠ÂèàËÆæÁΩÆ‰∫Ü‰∏ÄÊ¨°ËØ•buttonÁöÑÁÇπÂáª‰∫ã‰ª∂Ôºå‰∏ç‰ºöÊä•ÈîôÔºå‰∏§‰∏™ÁÇπÂáª‰∫ã‰ª∂ÈÉΩ‰ºöËß¶Âèë„ÄÇ ÊâÄ‰ª•ÔºåÊñπ‰æøËµ∑ËßÅÔºåstatic cell Áõ¥Êé•Âú®viewController‰∏≠ËøûÁ∫øËÆæÁΩÆÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ ‰ΩøÁî®segueÁÆÄ‰ªã‰ªÄ‰πàÊòØSegueStoryboard‰∏äÊØè‰∏ÄÊ†πÁî®Êù•ÁïåÈù¢Ë∑≥ËΩ¨ÁöÑÁ∫øÔºåÈÉΩÊòØ‰∏Ä‰∏™UIStoryboardSegueÂØπË±°ÔºàÁÆÄÁß∞SegueÔºâ SegueÁöÑÂ±ûÊÄßÊØè‰∏Ä‰∏™SegueÂØπË±°ÔºåÈÉΩÊúâ3‰∏™Â±ûÊÄß 123456// ÂîØ‰∏ÄÊ†áËØÜ@property (nonatomic, readonly) NSString *identifier;// Êù•Ê∫êÊéßÂà∂Âô®@property (nonatomic, readonly) id sourceViewController;// ÁõÆÊ†áÊéßÂà∂Âô®@property (nonatomic, readonly) id destinationViewController; SegueÁöÑÁ±ªÂûãÊ†πÊçÆSegueÁöÑÊâßË°åÔºàË∑≥ËΩ¨ÔºâÊó∂ÂàªÔºåSegueÂèØ‰ª•ÂàÜ‰∏∫2Â§ßÁ±ªÂûã: Ëá™Âä®Âûã(Action segue)ÔºöÁÇπÂáªÊüê‰∏™Êéß‰ª∂ÂêéÔºàÊØîÂ¶ÇÊåâÈíÆÔºâÔºåËá™Âä®ÊâßË°åSegueÔºåËá™Âä®ÂÆåÊàêÁïåÈù¢Ë∑≥ËΩ¨„ÄÇ ÊâãÂä®Âûã(Manual segue)ÔºöÈúÄË¶ÅÈÄöËøáÂÜô‰ª£Á†ÅÊâãÂä®ÊâßË°åSegueÔºåÊâçËÉΩÂÆåÊàêÁïåÈù¢Ë∑≥ËΩ¨„ÄÇ segueÊâßË°åËøáÁ®ãÊâãÂä®Ë∞ÉÁî®performSegueWithIdentifier:sender:ÊñπÊ≥ïÂÆûÁé∞Ë∑≥ËΩ¨„ÄÇÈÇ£‰πàËøôÊúüÈó¥ÂèëÁîü‰∫Ü‰ªÄ‰πàÂë¢ÔºüÂ§ßËá¥ÂàÜ‰∏∫‰∏â‰∏™ÈÉ®ÂàÜ„ÄÇ Ê†πÊçÆidentifierÂéªstoryboard‰∏≠ÊâæÂà∞ÂØπÂ∫îÁöÑÁ∫øÔºåÊñ∞Âª∫UIStoryboardSegueÂØπË±° 1- (instancetype)initWithIdentifier:(NSString *)identifier source:(UIViewController *)source destination:(UIViewController *)destination; // Designated initializer ÂÖ∂ÂÆûÂ∞±ÊòØÊâßË°å‰∫ÜUIStoryboardSegue‰∏≠initWithIdentifier:source:destination:ÊñπÊ≥ï,Âπ∂‰∏îidentifierÂ∞±ÊòØÂú®Storyboard‰∏≠SegueÂ±ûÊÄßËÆæÁΩÆÁöÑÊ†áËØÜ. Êù•Ê∫êÂ∞±ÊòØËøûÁ∫øÁöÑÂ§¥ÈÉ®. ÁõÆÊ†áÂ∞±ÊòØËøûÁ∫øÂ∞æ Ë∞ÉÁî®sourceViewControllerÁöÑ‰∏ãÈù¢ÊñπÊ≥ïÔºåÂÅö‰∏Ä‰∫õË∑≥ËΩ¨ÂâçÁöÑÂáÜÂ§áÂ∑•‰ΩúÂπ∂‰∏î‰º†ÂÖ•ÂàõÂª∫Â•ΩÁöÑSegueÂØπË±° 1- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender; ÊâÄË∞ìË∑≥ËΩ¨ÂâçÁöÑÂáÜÂ§áÔºåÂõ†‰∏∫ÂèØ‰ª•ÊãøÂà∞Segue(Êù•Ê∫êÊéßÂà∂Âô®,ÁõÆÊ†áÊéßÂà∂Âô®)ÔºåÊâÄ‰ª•Â∞±ÂèØ‰ª•Âú®ËøôÈáåÁªô‰∏ã‰∏Ä‰∏™ÊéßÂà∂Âô®‰º†ÈÄíÊï∞ÊçÆ„ÄÇËøô‰∏™ÊñπÊ≥ïÊòØÁ≥ªÁªüÈªòËÆ§Ë∞ÉÁî®ÔºåÊâÄ‰ª•Âè™ÈúÄË¶ÅÂÆûÁé∞Âç≥ÂèØ„ÄÇÂè¶Â§ñÔºåÂè™ËÉΩÁî±Êù•Ê∫êÊéßÂà∂Âô®Ë∞ÉÁî®,Êù•ÊãøÂà∞ÁõÆÊ†áÊéßÂà∂Âô®„ÄÇ Ë∞ÉÁî®SegueÂØπË±°ÁöÑperformÊñπÊ≥ïÂºÄÂßãÊâßË°åÁïåÈù¢Ë∑≥ËΩ¨Êìç‰Ωú„ÄÇ È°µÈù¢Ë∑≥ËΩ¨segueÂèØ‰ª•ÂÆûÁé∞È°µÈù¢Èó¥Ë∑≥ËΩ¨ÔºåÈô§‰∫Ü‰∏äÈù¢ÁöÑ relationship segue ËøòÊúâ Action segue Âíå Manual segueÔºåÂàÜÂà´ÂØπÂ∫îbuttonË∑≥ËΩ¨ÂíåviewControllerË∑≥ËΩ¨„ÄÇ Ë∑≥Ëøõ‰ΩøÁî®storyboardAction segue ÊØîËæÉÁÆÄÂçïÔºåÂ∞±ÊòØÂ∞ÜbuttonËøûÂà∞Ë¶ÅÂ±ïÁ§∫ÁöÑviewController‰∏äÔºåÂΩìÁÇπÂáªÊó∂ÔºåÂ∞±‰ºöËß¶Âèë„ÄÇManual segue Áõ∏ÂØπÊØîËæÉÈ∫ªÁÉ¶Ôºå‰ΩÜÊòØÊØîËæÉÁÅµÊ¥ª„ÄÇÂÆÉËÆæÁΩÆ‰∫Ü‰∏§‰∏™viewControllerÁöÑË∑≥ËΩ¨ÂÖ≥Á≥ªÔºåÂú®‰Ω†ÈúÄË¶ÅÁöÑÊó∂ÂÄôÂá∫ÂèëË∑≥ËΩ¨„ÄÇ È¶ñÂÖàÔºåÂÖàÂØπ‰∏§‰∏™viewControllerËøõË°åËøûÁ∫øÔºö‰πãÂêéÁÇπÂáªËøûÁ∫øÂêé‰∏§‰∏™viewController‰πãÈó¥‰∫ßÁîüÁöÑÁÆ≠Â§¥ÔºåÂú®Âè≥ËæπÊ†èÂèØ‰ª•ÁúãÂà∞Â¶Ç‰∏ãÔºöÂÖ∂‰∏≠ÂèÇÊï∞ identifier Â∞±ÊòØË∑≥ËΩ¨ÁöÑÊ†áËØÜÁ¨¶ÔºåÊ†πÊçÆËøô‰∏™Ê†áËØÜÁ¨¶Êù•Á°ÆÂÆöË∑≥ËΩ¨Âà∞ÊòØÈÇ£‰∏™È°µÈù¢„ÄÇ‰∏ãÈù¢Âá†‰∏™ÂèÇÊï∞Ôºå‰∏ãÈù¢ÂÜçËØ¥„ÄÇ Êé•‰∏ãÊù•Â∞±ÂèØ‰ª•Ë∞ÉÁî®ÊñπÊ≥ïÔºåÂú®ÂêàÈÄÇÁöÑÊó∂Êú∫Âä†ËΩΩ‰∫Ü 12//Ê†πÊçÆ segue IdentifierË∑≥ËΩ¨ÁïåÈù¢[self performSegueWithIdentifier:@"GotoTwo" sender:self]; ÂÖ∂‰∏≠ÁöÑidentiferËá™ÁÑ∂‰∏çÁî®Â§öËØ¥ÔºåÈÇ£‰πàsenderÊòØ‰ªÄ‰πàÂë¢ÔºüsenderÊòØÂèÇÊï∞ÂêçÁß∞ÔºåÁêÜËÆ∫‰∏äÂèØ‰ª•Êåá‰ª£‰ªª‰ΩïÂØπË±°ÔºåÁî®Êù•Âå∫ÂàÜÊòØÂì™‰∏™Êéß‰ª∂Ëß¶Âèë‰∫Üsegue„ÄÇÊØîÂ¶ÇÊúâ‰∏§‰∏™buttonÈÉΩË∑≥ËΩ¨Âà∞‰∏Ä‰∏™È°µÈù¢ÔºåÈÇ£‰πàËøôÊó∂Â∞±ÂèØ‰ª•ËÆæÁΩÆsenderÂå∫ÂàÜ‰∫Ü„ÄÇÂºïÁî≥ÂºÄÊù•ÔºåÂú®ËÆæÁΩÆbuttonÁÇπÂáª‰∫ã‰ª∂Êó∂ÁöÑ-(IBAction)click:(id)sender;ÊñπÊ≥ï‰∏≠ÁöÑsenderÂíåËøôÈáåÁöÑsenderÊòØ‰∏Ä‰∏™‰ΩúÁî®„ÄÇ ‰ΩøÁî®Á∫Ø‰ª£Á†Å‰∏äÈù¢ÁöÑÊñπÊ≥ïÂÆûÁé∞ÊïàÊûúÂíåÂπ≥Êó∂Áî®ÁöÑ‰∏ãÈù¢‰∏§‰∏™ÊñπÊ≥ïÁõ∏ÂêåÔºö 1234//‰ª•modal ÊñπÂºèË∑≥ËΩ¨[self presentViewController:ViewController animated:YES completion:nil];//ÂéãËøõ‰∏Ä‰∏™viewcontroller[self.navigationController pushViewController:ViewController animated:YES completion:nil]; ‰∏çËøáÔºåÊó¢ÁÑ∂Áî®‰∫Üstoryboard‰∫ÜÔºåÈÇ£‰πàÂÆû‰æãÂåñviewControllerÊó∂Â∞±‰∏çËÉΩÁî®initWithNibName‰∫Ü„ÄÇÂú®storyboard‰∏≠ÔºåË¶ÅÈÄöËøástoryboardÊâæÂà∞viewControllerÁöÑÂ∏ÉÂ±Ä„ÄÇÈ¶ñÂÖàË¶ÅËÆæÁΩÆviewcontrollerÁöÑ storyboardIDÔºöÈÇ£‰∏™use storyboardIdÁöÑÂãæ‰∏çÊâì‰πüË°åÔºå‰∏çÁü•ÈÅìÂπ≤‰ªÄ‰πàÁî®ÁöÑÔºå Áé∞Âú®Â∞±ÂèØ‰ª•Âú®‰ª£Á†Å‰∏≠ÊâæÂà∞ÁâπÂÆöstoryboardÁöÑviewcontroller‰∫ÜÔºö 12345678- (IBAction)tapButton:(id)sender &#123; //Ëé∑Âèñstoryboard: ÈÄöËøábundleÊ†πÊçÆstoryboardÁöÑÂêçÂ≠óÊù•Ëé∑ÂèñÊàë‰ª¨ÁöÑstoryboard, UIStoryboard *story = [UIStoryboard storyboardWithName:@"Main" bundle:nil]; //Áî±storyboardÊ†πÊçÆmyViewÁöÑstoryBoardIDÊù•Ëé∑ÂèñÊàë‰ª¨Ë¶ÅÂàáÊç¢ÁöÑËßÜÂõæ UIViewController *myView = [story instantiateViewControllerWithIdentifier:@"myView"]; //ÊòæÁ§∫ViewController [self presentViewController:myView animated:YES completion:nil];&#125; Ë∑≥Âá∫ËÉΩË∑≥ËøõÂΩìÁÑ∂‰πüË¶ÅËÉΩË∑≥Âá∫ÔºåÂèØ‰ª•‰ΩøÁî® exit segue Ë∑≥ËΩ¨Ëá≥‰ªªÊÑèËøûÁ∫øÁöÑ‰ΩçÁΩÆÔºå‰πüÂèØ‰ª•‰ΩøÁî®‰ª£Á†ÅË∑≥ËΩ¨„ÄÇ exit segueË∑≥Âá∫ÂíåË∑≥ËøõÁöÑÊñπÊ≥ïÁ±ª‰ººÔºåÁï•ÊúâÂå∫Âà´ÔºåÊØîÂ¶ÇË¶Å‰ªéÁïåÈù¢2Ë∑≥ËΩ¨ÂõûÁïåÈù¢1Ôºö ÂÖàÊâìÂºÄÈúÄË¶ÅËøîÂõûÂà∞ÁöÑÁïåÈù¢ViewController1.m,Âä†‰∏ä‰∏ãÈù¢ÊñπÊ≥ïÔºåËøîÂõûÁ±ªÂûã‰∏ÄÂÆöÊòØIBActionÔºåÂèÇÊï∞Á±ªÂûã‰∏ÄÂÆöÊòØUIStoryboardSegueÔºåÂêçÁß∞Èöè‰æøÔºàËøô‰∏™ÊñπÊ≥ï‰∏ÄÂÆöË¶ÅÂä†ÔºåËøîÂõûÊó∂Ë∞ÉÁî®ÁöÑÔºâ 123//ÂÖ∂‰ªñÁïåÈù¢ËøîÂõûÂà∞Ê≠§ÁïåÈù¢Ë∞ÉÁî®ÁöÑÊñπÊ≥ï- (IBAction)ViewController1UnwindSegue:(UIStoryboardSegue *)unwindSegue &#123;&#125; Âè≥ÈîÆ2ÁïåÈù¢‰∏äÊñπÁöÑExitÔºà‰∏ãÂõæ‰∏≠ÁîªÁªøÂúàÁöÑÔºâÂºπÂá∫ËèúÂçï‰∏≠ÂèØ‰ª•ÁúãÂà∞ÂàöÊâçÂú®1ÁïåÈù¢‰∏≠Âä†ÁöÑÈÇ£‰∏™ÊñπÊ≥ïÁöÑÂêçÁß∞Ôºà‰∏ãÂõæ‰∏≠Á∫¢Ëâ≤ÂúàÈáåÔºâÔºåÁÑ∂ÂêéÂ¶Ç‰∏ãÂõæ‰∏ÄÊ†∑ËøûÁ∫øÔºåÂºπÂá∫ËèúÂçïÈÄâÊã©manualÔºåËøôÈáåËøûÊé•Ëá™Â∑±Ë°®Á§∫Ë¶ÅÂú®ÂΩìÂâçviewcontroller‰∏≠Áî®‰ª£Á†ÅÁöÑÊñπÂºèÂõûÈÄÄ„ÄÇ Áªô2ËßÜÂõæÁöÑunwind segueÂèñ‰∏Ä‰∏™ÂêçÂ≠óÂè´from2to1ÁöÑidentifierÂ¶Ç‰∏ãÂõæ: Áé∞Âú®Â∞±ÂèØ‰ª•Âú®ÁïåÈù¢2‰∏≠ÁöÑ‰ªªÊÑèÊó∂ÂÄôË∞ÉÁî®ÊñπÊ≥ïÂõûÈÄÄ‰∫ÜÔºö 1234- (IBAction)back:(id)sender &#123; //ÊâßË°åsegueË∑≥È°µÁöÑÊñπÊ≥ï [self performSegueWithIdentifier:@"from2to1" sender:nil];&#125; ‰ΩøÁî®ÁöÑ‰ªçÊòØË∑≥ËøõÊó∂Áî®ÁöÑÊñπÊ≥ïÔºå‰∏çËøáÁ¨¨‰∏ÄÊ≠•ÁöÑÊìç‰ΩúÂ∑≤ÁªèÂëäËØâxcodeËøôÊòØ‰∏Ä‰∏™ÂõûÈÄÄÊìç‰Ωú‰∫Ü„ÄÇÂèØ‰ª•‰ªé‰∏äÂõæÁúãÂà∞ÔºåËøô‰∏™ Unwind Segue ÁªëÂÆö‰∫ÜÂõûÈÄÄÂà∞ÁöÑÁïåÈù¢ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂõ†Ê≠§ÔºåÊâßË°åË∑≥ËΩ¨Âêé‰ºöÊâßË°åÁªëÂÆöÁöÑÊñπÊ≥ïÔºö 12345678//ÂÖ∂‰ªñÁïåÈù¢ËøîÂõûÂà∞Ê≠§ÁïåÈù¢Ë∞ÉÁî®ÁöÑÊñπÊ≥ï- (IBAction)ViewController1UnwindSegue:(UIStoryboardSegue *)unwindSegue &#123; if ([unwindSegue.identifier isEqualToString:@"from2to1"]) &#123; _lbShowMessage.text = @"‰ªé2ÈÄÄÂà∞1"; &#125; else if ([unwindSegue.identifier isEqualToString:@"from3to1"]) &#123; _lbShowMessage.text = @"‰ªé3ÈÄÄÂà∞1"; &#125;&#125; ËøôÈáåÂ∞±ÁúãÂá∫‰∏äÈù¢‰∏∫‰ªÄ‰πàËØ¥Á±ªÂûã‰∏ÄÂÆöÊòØUIStoryboardSegue‰∫ÜÔºåÂõ†‰∏∫ÂèØ‰ª•Êé•Êî∂‰∏Ä‰∏™ËØ•Á±ªÂûãÁöÑÂØπË±°Ôºå‰ª•Ê≠§Âà§Êñ≠ÊòØ‰ªéÂì™‰∏™È°µÈù¢ÁöÑÂõûÈÄÄ„ÄÇ ‰ΩøÁî® exit segue ÁöÑÂ•ΩÂ§ÑÊòØÂèØ‰ª•Ë∑≥ËΩ¨Âà∞‰ªªÊÑèÊâìÂºÄËøáÁöÑÁïåÈù¢ÊØîÂ¶Ç‰ªé3-&gt;1ÔºåËÄå‰∏çÊòØÂè™ËÉΩËøîÂõû‰∏äÁ∫ßÁïåÈù¢‰ªé2-&gt;1„ÄÇ ‰∏ÄËà¨Ë∑≥Âá∫ÊñπÊ≥ï‰πüÂèØ‰ª•‰ΩøÁî®‰ª£Á†ÅÊ†πÊçÆÊòØmodelÁ±ªÂûãËøòÊòØpushÁ±ªÂûãÈÄâÊã©Ôºö 1234//ÂºπÂá∫‰∏Ä‰∏™viewcontroller Áõ∏ÂΩì‰∏éËøîÂõû‰∏ä‰∏Ä‰∏™ÁïåÈù¢[self.navigationController popViewControllerAnimated:YES]; // ‰ª• modalË∑≥ËΩ¨ÁöÑËøîÂõûÊñπÊ≥ï[self dismissViewControllerAnimated:YES]; Ë∑≥ËΩ¨ÁöÑÊñπÂºèÂú®ËøõË°åË∑≥ËΩ¨ËøûÁ∫øÂêé‰ºöÂá∫Áé∞Â¶Ç‰∏ãÁ™óÂè£ÔºöÂÖ±Êúâ‰∏âÁßçË∑≥ËΩ¨ÊñπÂºèÔºå‰πüÂ∞±ÊòØ‰∏äÈù¢Âè≥ËæπÊ†èÁöÑKindÂ±ûÊÄß pushPushÁ±ªÂûãÂøÖÈ°ªÁî®Âú®NavigationController‰∏≠ÔºåÂê¶ÂàôÊä•Èîô„ÄÇÊòØÂú®navigation View Controller‰∏≠‰∏ã‰∏ÄÁ∫ßÊó∂‰ΩøÁî®ÁöÑÈÇ£Áßç‰ªéÂè≥‰æßÂàíÂÖ•ÁöÑÊñπÂºè„ÄÇ modelÊúÄÂ∏∏Áî®ÁöÑÂú∫ÊôØÔºåÊñ∞ÁöÑÂú∫ÊôØÂÆåÂÖ®Áõñ‰Ωè‰∫ÜÊóßÁöÑÈÇ£‰∏™„ÄÇÁî®Êà∑Êó†Ê≥ïÂÜç‰∏é‰∏ä‰∏Ä‰∏™Âú∫ÊôØ‰∫§‰∫íÔºåÈô§Èùû‰ªñ‰ª¨ÂÖàÂÖ≥Èó≠Ëøô‰∏™Âú∫ÊôØ„ÄÇÂèØ‰ª•Âú®Âè≥ËæπÊ†èÁöÑPresentationÈÄâÊã©ÈúÄË¶ÅÂ±ïÁ§∫ÁöÑÂä®ÁîªÊïàÊûú„ÄÇ customËá™ÂÆö‰πâÁ±ªÂûãÔºåÈúÄË¶ÅÁªßÊâøUIStoryboardSegueÁ±ªÔºåÁÑ∂ÂêéÈáçÂÜôPerformÊñπÊ≥ï,ÁÑ∂ÂêéÂú®Storyboard‰∏äÂ∞ÜÁ±ªËÆæÁΩÆ‰∏∫Ëá™ÂÆö‰πâÁöÑÁ±ª„ÄÇËøôÊÆµ‰ª£Á†ÅÁöÑ‰ΩúÁî®ÊòØÂàõÂª∫‰ªé‰∏≠ÂøÉÊ∏êÂèòÂÖÖÊª°Â±èÂπïÁöÑÂä®Áîª: 12345678910111213141516-(void)perform&#123; UIViewController * svc = self.sourceViewController; UIViewController * dvc = self.destinationViewController; [svc.view addSubview:dvc.view]; [dvc.view setFrame:svc.view.frame]; [dvc.view setTransform:CGAffineTransformMakeScale(0.5, 0.5)]; [dvc.view setAlpha:0.0]; [UIView animateWithDuration:1.0 animations:^&#123; [dvc.view setTransform:CGAffineTransformMakeScale(1.0, 1.0)]; [dvc.view setAlpha:1.0]; &#125; completion:^(BOOL finished) &#123; [svc presentViewController:dvc animated:NO completion:nil]; &#125;];&#125; ÂÖ∂ÂÆûÂÆûË¥®ËøòÊòØpresentViewControllerÔºå‰ΩÜÊòØ‰∏çÁî®Á≥ªÁªüÂ∏¶ÁöÑanimationÔºåËÄåÊòØÂÖàÂ∞ÜdestinationViewControllerÁöÑÈ°µÈù¢Áî®Âä®ÁîªÂä†ËΩΩÂêéÔºåÁõ¥Êé•present„ÄÇ Ë∑≥ËΩ¨‰º†ÂÄºÂâçÈù¢ËØ¥Âà∞Ôºå- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)senderÊñπÊ≥ï‰ºöÂú®Ë∑≥ËΩ¨Êó∂Ëá™Âä®Ëß¶Âèë„ÄÇË∑≥ËΩ¨‰º†ÂÄºÂ∞±Âú®Ëøô‰∏™ÊñπÊ≥ïÂÜÖÂÆåÊàê„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÂØπSegueÁöÑÊ†áËØÜËøõË°åÂà§Êñ≠Ôºå‰∏ÄËà¨Êúâ‰ª•‰∏ã‰∏§ÁßçÊñπÊ≥ïÔºö 123456- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender&#123; if ([segue.identifier isEqual: @"login2index"]) &#123; // ÈúÄË¶ÅÊâßË°åÁöÑ‰ª£Á†Å &#125;&#125; 123456- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender&#123; if ([segue.destinationViewController isKindOfClass:[IndexTableViewController class]]) &#123; // ÊâßË°å‰ª£Á†Å &#125;&#125; Á¨¨‰∏ÄÁßçÈúÄË¶ÅÂú®ËÆæÁΩÆÊ†áËØÜÁöÑÂÄº,Âπ∂‰∏îÂåπÈÖç„ÄÇÁ¨¨‰∫åÁßçÂç¥ÊòØÈÄöËøáÁõÆÊ†áÊéßÂà∂Âô®Âà§Êñ≠„ÄÇ‰∏™‰∫∫ÊÑüËßâËøòÊòØÁ¨¨‰∏ÄÁßçÈù†Ë∞±‰∏Ä‰∫õ„ÄÇ Êé•‰∏ãÊù•Â∞±ÂèØ‰ª•ÂØπdestinationËøõË°åËµãÂÄº‰∫ÜÔºö 12345678910111213- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender&#123; NSLog(@"Ëß¶ÂèëËØ•Âú∫ÊôØÂàáÊç¢ÁöÑsenderÂØπË±°ÁöÑÁ±ªÂûãÊòØ:%@",[sender class]); //ÊñπÊ≥ï‰∏Ä,‰ΩøÁî®KVCÁªôB ‰πüÂ∞±ÊòØÁõÆÊ†áÂú∫ÊôØ‰º†ÂÄº UIViewController *destinationController=[segue destinationViewController]; [destinationController setValue:@"119" forKey:@"number"]; //ÊñπÊ≥ï2,‰ΩøÁî®Â±ûÊÄß‰º†ÂÄº,ÈúÄÂØºÂÖ•Áõ∏ÂÖ≥ÁöÑÁ±ª.h //BViewController *bController=[segue destinationViewController]; //bController.number=@188;&#125; Ë∑≥ËΩ¨‰º†ÂÄº‰∏ç‰ªÖÂèØ‰ª•Áî®prepareForSegue:sender:ÂÆûÁé∞Ôºå‰πüÂèØ‰ª•ÈÄöËøá‰ª£ÁêÜ„ÄÅÈÄöÁü•ÁöÑÊñπÂºèÔºå‰∏çËøáËøôÊ†∑Êå∫È∫ªÁÉ¶ÁöÑÔºå‰∏çÊé®Ëçê„ÄÇÂÖ∑‰ΩìÂèÇËßÅ‰ΩøÁî®storyboardÂÆûÁé∞È°µÈù¢Ë∑≥ËΩ¨ÔºåÁÆÄÂçïÁöÑÊï∞ÊçÆ‰º†ÈÄí storyboard referenceiOS9‰∏≠ÔºåËãπÊûúÂºïÂÖ•‰∫Ü storyboard reference Áî®‰ª•ÂáèÂ∞èstoryboardÁöÑ‰ΩìÁßØÔºåÊñπ‰æøÁÆ°ÁêÜÔºàÂπ∂‰∏çÁü•ÈÅìiOS9‰πãÂâçÊÄé‰πàÁî®Â§ö‰∏™storyboardÔºâ„ÄÇ ÁÆÄÂåñÁé∞ÊúâstoryboardÂ¶Ç‰∏ãÂõæÔºåÊòØÂÅö‰∏äÈù¢ÁªÉ‰π†Êó∂ÂàõÂª∫ÁöÑ‰∏Ä‰∏™storyboardÔºåÁïåÈù¢Â∑≤ÁªèÊúâÁÇπÂ§ö‰∫Ü„ÄÇÂèØ‰ª•‰ΩøÁî®storyboard referenceÁÆÄÂåñÔºåÂ∞Ü‰∏ÄÈÉ®ÂàÜviewcontrollerÊãÜÂàÜÂà∞ÂÖ∂‰ªñstoryboardÈáå„ÄÇ ÂÅöÊ≥ïÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºåÈÄâ‰∏≠ÊÉ≥Ë¶ÅÊãÜÂàÜÁöÑviewcontrollerÔºåÁÑ∂ÂêéÂú®ËèúÂçïÊ†èÂπ≤‰∏≠‚ÄúEditor-&gt;Refactor to Storyboard‚ÄùÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇÁÑ∂ÂêéÂëΩÂêçÊñ∞ÁöÑstoryboardÂç≥ÂèØ„ÄÇ Âä†ËΩΩstoryboard‰∏≠‰∏Ä‰∏™ÁâπÂÆöviewControllerÂíåÊãñÊãΩÂÖ∂‰ªñÊéß‰ª∂‰∏ÄÊ†∑ÔºåÊâæÂà∞storyboardÊéß‰ª∂ÔºåÊãñÊãΩÂà∞storyboard‰∏äÔºö ÁÑ∂ÂêéËÆæÁΩÆstoryboardÔºöËøôÈáåÈù¢storyboardÂ°´ÁöÑÊòØÁõÆÊ†ástorboardÁöÑÊñá‰ª∂ÂêçÔºõReference IDÊòØÂï•Ôºü‰ªéÂÆÉÁöÑÊèêÁ§∫‰πüÂ∞±ÊâçÂá∫Êù•‰∫ÜÔºåÁî®Êù•Á°ÆÂÆöËÅîÁªìÁöÑÊòØÈÇ£‰∏™viewControllerÔºåÂ°´ÁöÑÊòØÁõÆÊ†ástoryboard‰∏≠ÁõÆÊ†áviewControllerÁöÑStoryboard IDÔºåÂÖ∑‰ΩìÂú®Âì™ËÆæÔºå‰∏äÈù¢‰πüËØ¥Ëøá„ÄÇ ËøôÊ†∑Ôºå‰∏Ä‰∏™ÁÆÄÊ¥ÅÁöÑstoryboardÂ∞±ËÉΩÂàõÂª∫Âá∫Êù•‰∫Ü„ÄÇ ÂèÇËÄÉÈìæÊé•„ÄêStoryboard„ÄëStoryboard‰ªãÁªçÂèä‰ΩøÁî® UIStoryboardSegueËÆ≤Ëß£; iOS-prepareForSegueÂú∫ÊôØÂàáÊç¢,KVC‰º†ÂÄº; (4.4.1)‰ΩøÁî®storyboardÂÆûÁé∞È°µÈù¢Ë∑≥ËΩ¨ÔºåÁÆÄÂçïÁöÑÊï∞ÊçÆ‰º†ÈÄí; „ÄêiOSÁïåÈù¢Â§ÑÁêÜ„Äë‰ΩøÁî®storyboardÂÆûÁé∞È°µÈù¢Ë∑≥ËΩ¨ÔºåÁÆÄÂçïÁöÑÊï∞ÊçÆ‰º†ÈÄí iOS9 Day-by-Day :: Day 3 :: Storyboard References; Âü∫‰∫éStoryboardÁöÑÂàõÂª∫Â§öÂàÜÊîØNavigationControllerÁöÑÊñπÊ≥ï; iOS 9 Storyboard ÊïôÁ®ã(‰∏Ä‰∏ã); 10 Practical Tips for iOS Developers Using Storyboards; ËøòÊúâ‰∏Ä‰∫õÁúãÂÆåÈöèÊâãÂ∞±ÂÖ≥‰∫ÜÔºåÊ≤°ÊúâËÆ∞ÂΩï„ÄÇ Ê∞¥Âπ≥ÊúâÈôêÔºåÂ¶ÇÊúâÈîôËØØÔºåÂ§öÂ§öÊåáÊ≠£~]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Xcode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[oc ‰∏≠ÁöÑÊ≥õÂûã‰∏énullability]]></title>
    <url>%2F2016%2F09%2F28%2Foc%E6%96%B0%E7%89%B9%E6%80%A7%2F</url>
    <content type="text"><![CDATA[oc‰∏≠Ê∑ªÂä†‰∫Ü‰∏Ä‰∫õÂÖ≥ÈîÆÂ≠óÔºå‰∏ªË¶Å‰ΩúÁî®‰∫éÁºñËØëÊúüÔºåÂØπÁ®ãÂ∫èÊ≤°Êúâ‰ªª‰ΩïÂΩ±ÂìçÔºåÁõ∏ÂΩì‰∫éÊòØ‰∏Ä‰∏™ÊèêÁ§∫„ÄÇ‰∏ãÈù¢Â∞ÜÁªìÂêàObjective‚ÄîCËØ≠Ë®ÄÁöÑÊñ∞È≠ÖÂäõ‚Äî‚ÄîNullability„ÄÅÊ≥õÂûãÈõÜÂêà‰∏éÁ±ªÂûãÂª∂ÊãìÂØπocÁöÑËøô‰∫õÊñ∞ÁâπÊÄßËøõË°åÁ†îÁ©∂„ÄÇ NullabilityÊ£ÄÊµãÁöÑÊîØÊåÅÂèØ‰ª•‰ΩøÁî®nullableÂÖ≥ÈîÆÂ≠óÔºåË°®ÊòéËØ•ÂØπË±°ÂèØ‰ª•ÊòØÁ©∫ÂÄº;‰ΩøÁî®nonnullÂÖ≥ÈîÆÂ≠óË°®Êòé‰∏çÂèØ‰ª•ÊòØÁ©∫ÂØπË±°„ÄÇ 12@property (nullable, nonatomic, strong) ObjectType firstObject;@property (nullable, nonatomic, strong) ObjectType lastObject; ËøôÊòØNSArray‰∏≠ÁöÑ‰∏§‰∏™Â±ûÊÄßÔºåÂÖ∂‰∏≠nullableÂÖ≥ÈîÆÂ≠óËØ¥Êòé‰∫ÜËøôÈáåÂèØËÉΩËøîÂõûÁ©∫ÁöÑÂÄº„ÄÇ Â¶ÇÊûú‰ªÖ‰ªÖÊòØÂú®ËøîÂõûÂÄº‰∏≠ÁªôÂºÄÂèëËÄÖ‰∏Ä‰∫õÊèêÁ§∫Ôºå‰Ω†ÂèØËÉΩËßâÂæóÂ∫îÁî®Âπ∂‰∏çÂ§ßÔºåÊòØÁöÑÔºåÂØπÂºÄÂèëËÄÖÊúÄÂ§ßÁöÑÂ∏ÆÂä©ÊòØËøô‰∏ÄÁâπÊÄßÂèØ‰ª•Áî®‰∫éÂáΩÊï∞ÁöÑÂèÇÊï∞‰∏≠ÔºåËøôÊ†∑Êàë‰ª¨Âú®Ë∞ÉÁî®ÂáΩÊï∞Êó∂Ëµ∑Âà∞ÁöÑÊèêÁ§∫‰ΩúÁî®ÔºåÂ∞ÜÊòØÈùûÂ∏∏ÈáçË¶ÅÁöÑ,‰æãÂ¶ÇÔºö 123-(void)setValue:(NSNumber * _Nonnull )number&#123; &#125; Â¶ÇÊûú‰º†ÂÖ•‰∫ÜÁ©∫ÂÄºÔºåÁºñËØëÂô®‰ºöË≠¶ÂëäÔºö Ê≥õÂûãÁöÑ‰ΩøÁî®Ëøô‰∏ÄÁâπÊÄßÂíåNullability‰∏ÄÊ†∑ÔºåÂè™‰ΩúÁî®‰∫éÁºñËØëÊúüÔºåÊòØ‰∏∫Êàë‰ª¨ÂºÄÂèëËÄÖÊúçÂä°ÁöÑÂè¶‰∏ÄÈáçË¶ÅÁâπÊÄß„ÄÇ ÊúâÁ±ªÂûãÁ∫¶ÂÆöÁöÑÈõÜÂêàÂú®Xcode7‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁªôÈõÜÂêàÁ±ªÂûãÊ∑ªÂä†‰∏Ä‰∏™Ê≥õÂûãÁöÑÁ∫¶ÂÆöÔºåÂ¶Ç‰∏ãÔºö 1NSMutableArray&lt;NSString *&gt; *array = [[NSMutableArray alloc]init]; Â£∞Êòé‰∫ÜËøôÊ†∑‰∏Ä‰∏™Êï∞ÁªÑÂêéÔºåÂ∞±ÂëäËØâ‰∫ÜÁºñËØëÂô®ÔºåËøô‰∏™Êï∞ÁªÑ‰∏≠ÁöÑÊï∞ÊçÆÁ±ªÂûãÈÉΩÊòØNSString*Á±ªÂûãÁöÑÔºåÂèØ‰ª•‰ΩøÁî®ËØ•Á±ªÂûãÁöÑÊñπÊ≥ïÔºåÂ¶ÇÔºö Âú®Êàë‰ª¨ÂêëËøô‰∏™Êï∞ÁªÑ‰∏≠ËøΩÂä†ÂÖÉÁ¥†ÁöÑÊó∂ÂÄôÔºåÁºñËØëÂô®Â∞ÜÂÖÉÁ¥†ÁöÑÁ±ªÂûãÊèêÁ§∫‰∫ÜÂá∫Êù•ÔºåÂπ∂‰∏îÂ∞ÜFromArrayÊñπÊ≥ï‰∏≠ÈúÄË¶ÅÁöÑÂÖÉÁ¥†Á±ªÂûã‰πüÊèêÁ§∫‰∫ÜÂá∫Êù•: Â¶ÇÊûúÊàë‰ª¨ÂêëËøô‰∏™Êï∞ÁªÑ‰∏≠ËøΩÂä†Á±ªÂûã‰∏çÂåπÈÖçÁöÑÂÖÉÁ¥†,ÁºñËØëÂô®‰ºöÁªôÊàë‰ª¨‰∏Ä‰∏™ËøôÊ†∑ÁöÑË≠¶ÂëäÔºö Á±ªÂûãÈÄöÈÖçÁ¨¶iOSÁöÑÁ≥ªÁªüÁ±ª‰∏≠ÔºåÂ§ßÈáè‰ΩøÁî®‰∫ÜObjectTypeÂÖ≥ÈîÆÂ≠óÔºåÂ¶Ç‰∏ãÊòØÁ≥ªÁªüÁöÑNSMutableArrayÁöÑÂ§¥Êñá‰ª∂Ôºö 12345678910@interface NSMutableArray&lt;ObjectType&gt; : NSArray&lt;ObjectType&gt;- (void)addObject:(ObjectType)anObject;- (void)insertObject:(ObjectType)anObject atIndex:(NSUInteger)index;- (void)removeLastObject;- (void)removeObjectAtIndex:(NSUInteger)index;- (void)replaceObjectAtIndex:(NSUInteger)index withObject:(ObjectType)anObject;- (instancetype)init NS_DESIGNATED_INITIALIZER;- (instancetype)initWithCapacity:(NSUInteger)numItems NS_DESIGNATED_INITIALIZER;- (nullable instancetype)initWithCoder:(NSCoder *)aDecoder NS_DESIGNATED_INITIALIZER;@end Ëøô‰∏™ObjectTypeÂ∞±ÊòØÊ≥õÂûãÁöÑÁ±ªÂûãÊ†áËØÜÁ¨¶,Êàë‰ª¨ÂèØ‰ª•Áî®ÂÆÉËá™Â∑±ÂÆö‰πâ‰∏Ä‰∏™ÈõÜÂêàÁ±ªÔºåÂ¶ÇÂåÖË£Ö‰∏Ä‰∏™NSSarrayÔºö 1234@interface MyArray&lt;Type&gt; : NSObject@property(nonatomic,strong,nonnull)NSMutableArray&lt;Type&gt; *array;-(void)addObject:(nonnull Type)obj;@end ÂÆûÁé∞Â¶Ç‰∏ãÔºö 1234567891011- (instancetype)init&#123; self = [super init]; if (self) &#123; _array = [[NSMutableArray alloc]init]; &#125; return self;&#125;- (void)addObject:(id)obj&#123; [_array addObject:obj];&#125; Ê≥®ÊÑèÔºö Ëøô‰∏™Á±ªÂûãÈÄöÈÖçÁ¨¶Âè™ËÉΩÂú®interfaveÈáå‰ΩøÁî®Ôºå‰ΩúÁî®Âüü‰∏∫@interfaceÂà∞@end‰πãÈó¥„ÄÇ ÂÆûÁé∞Êó∂ÔºåÂØπ‰∫éÂÆö‰πâÁöÑTypeÁ±ªÂûãÁöÑÂèÇÊï∞Ôºå‰ΩøÁî®id‰ª£Êõø„ÄÇ Ê≥õÂûãType‰∏çÁî®ÂÜôÊàêType *„ÄÇ ÂØπ‰∫éÂ§öÂèÇÁöÑÈõÜÂêàÔºåÂ∞ÜÂèÇÊï∞Á±ªÂûãÁî®‚Äú,‚ÄùÈöîÂºÄÂç≥ÂèØÔºåÂ¶ÇNSMultableDictionary&lt;NSString * ,NSString *&gt; *dic = [[NSMultableDictionary alloc] init]; Ê≥õÂûãÂíåÂçèËÆÆÂ£∞ÊòéÊ≥õÂûãÂíåÂçèËÆÆÈÉΩÊòØÁî®Â∞ñÊã¨Âè∑Êã¨Ëµ∑Êù•ÁöÑÔºåÂèØËÉΩ‰ºöÂæàÂõ∞Êâ∞ÔºåÁºñËØëÂô®Â¶Ç‰ΩïÁü•ÈÅìÂì™‰∏™ÊòØÊ≥õÂûãÂì™‰∏™ÊòØÂçèËÆÆ„ÄÇÂÖ∂ÂÆûÂÆÉ‰ª¨ÊòØÊúâËßÑÂàôÁöÑ„ÄÇÁÆÄÂçïÁúã‰∏Ä‰∏ã‰æãÂ≠êÔºö 123456@protocol proc@end// .h@interface Test&lt;ObjectClass&gt; : NSObject&lt;Proc&gt;@property (nonatomic,strong) ObjectClass param;@end Êàë‰ª¨ÁúãÂà∞ÔºåÊâÄÊúâÁöÑÁ±ªÈÉΩÊòØË¶ÅÊúâ‰∏Ä‰∏™Âü∫Á±ªÔºåÊâÄ‰ª•Ê≥õÂûãÁöÑÂ∞ñÊã¨Âè∑ÊòØÂú®Âü∫Á±ª‰πãÂâçÁöÑÔºåÂü∫Á±ª‰πãÂêéÂèØ‰ª•ÂÜô‰∏äÂçèËÆÆÔºå‰ΩøÁî®ÁöÑÊó∂ÂÄôÂ∞±ÂèØ‰ª• Test&lt;SomeType *&gt; test ËøôÊ†∑Áî®Âï¶„ÄÇÈÇ£Â¶ÇÊûúÂü∫Á±ª‰πüÊúâÊ≥õÂûãÈúÄË¶ÅÂ£∞ÊòéÂë¢ÔºüÊØîÂ¶Ç NSMutableArray: 1@interface NSMutableArray&lt;ObjectType&gt; : NSArray&lt;ObjectType&gt; Á±ª‰ºº‰∫éËøôÁßçÁöÑÊ≥õÂûãÔºåÊàë‰ª¨Â∞±‰∏çËÉΩÁõ¥Êé•Áî≥ÊòéÂçèËÆÆ‰∫Ü„ÄÇ‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•ÂèòÈÄö‰∏Ä‰∏ãÔºåÂèØ‰ª•‰∏∫Ëøô‰∏™Á±ªÂàõÂª∫‰∏Ä‰∏™ÂàÜÁ±ªÔºåÂú®ÂàÜÁ±ª‰∏≠Â£∞ÊòéÂçèËÆÆÂïä„ÄÇ Âè¶Â§ñËøòÊúâ‰∏ÄÁÇπÔºåÂçèËÆÆ‰∏≠ÊòØ‰∏çËÉΩ‰ΩøÁî®Ê≥õÂûãÁöÑÔºåÂ¶ÇÊûúÂÆûÂú®ÊÉ≥Áî®ÔºåÊã•Êä± Swift Âêß„ÄÇ ‰ΩøÁî®‰ΩøÁî®ÁöÑÊó∂ÂÄô‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÈÉΩÊòØË°®Á§∫Ê≥õÂûãÔºåÊØîÂ¶ÇÔºö 1Test&lt;NSString *&gt; test = [[Test alloc] init]; ‰ΩÜÊòØ‰πüÊúâË°®Á§∫ÂçèËÆÆÁöÑÔºå‰∏çËøáÂ±ÄÈôêÂú® id Á±ªÂûãÔºåÊØîÂ¶ÇÔºö 1id&lt;SomeProtocol&gt; prop; Ë°®Á§∫‰ªªÊÑè‰∏Ä‰∏™ÂÆûÁé∞‰∫ÜÊüê‰∏™ÂçèËÆÆÁöÑÁ±ªÂûã„ÄÇ __kindofÂú®Â∞èÁ±ªÂêëÂ§ßÁ±ªËµãÂÄºÊó∂ÔºåÂæÄÂæÄÊ≤°Êúâ‰ªª‰ΩïÈóÆÈ¢ò„ÄÇ‰ΩÜÊòØÂ§ßÁ±ªÂêëÂ∞èÁ±ªËµãÂÄºÊó∂ÔºåÂ∞±‰ºö‰∫ßÁîüË≠¶Âëä„ÄÇË≠¨Â¶ÇUIViewÁöÑÂÆû‰æãviewÂíåUIButtonÁöÑÂÆû‰æãbutton,ÂèØ‰ª•view = buttonÔºå‰ΩÜÊòØÊúÄÂ•Ω‰∏çË¶Åbutton = view„ÄÇÂ¶ÇÊûúÊÉ≥Ë¶Å‰ΩøÁî®ÔºåÂèà‰∏çÂ∏åÊúõ‰∫ßÁîüË≠¶ÂëäÊÄé‰πàÂäûÔºü‰ΩøÁî®__kindof„ÄÇ123UIButton *b = [[UIButton alloc] init];__kindof UIView *view = [[UIButton alloc]init];b = view; ËøôÈáåÔºåÁî±‰∫éview‰ΩøÁî®__kindofË°®Á§∫UIViewÁöÑÂ≠êÁ±ªÔºå‰∏ç‰ºö‰∫ßÁîüË≠¶Âëä„ÄÇÂê¶ÂàôË¶ÅËøõË°åÂº∫ËΩ¨b = (UIButton *)view;]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Objective-C</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSÂºÄÂèëÂ∑•ÂÖ∑Â∫îÁî®‰∏≠ÁöÑÂùë]]></title>
    <url>%2F2016%2F09%2F23%2FXcode%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[ËøôÈáå‰∏ªË¶ÅÊÄªÁªì‰∏Ä‰∏ãÂºÄÂèë iOS ‰ΩøÁî®Â∑•ÂÖ∑‰∏äÈÅáÂà∞ÁöÑ‰∏Ä‰∫õÈóÆÈ¢ò„ÄÇ Â¶Ç‰Ωï‰∏∫‰∏Ä‰∏™ workspace ‰∏≠ÁöÑÂ§ö‰∏™ project ‰ΩøÁî® cocoapods‰∏ÄËà¨‰∏Ä‰∏™ app Âè™Êúâ‰∏Ä‰∏™ projectÔºà‰πüÂèØ‰ª•ÊúâÂ§ö‰∏™ÔºåÂÖ∂ÂÆû project ‰∏çÊòØÂÖ≥ÈîÆÔºåÂÆÉÂè™ÊòØÂåÖÂê´‰∫Ü‰∏Ä‰∫õÈÖçÁΩÆ‰ø°ÊÅØÔºåÁúüÊ≠£Ëµ∑‰ΩúÁî®ÁöÑÊòØ targetÔºåproject Âè™ÊòØ target ÁöÑÂÆπÂô®ÔºåÊúâÁõ∏‰∫í‰æùËµñÂÖ≥Á≥ªÁöÑÊòØ targetÔºâÔºåÂú®Ëøô‰∏™ project ‰∏≠ÂèØ‰ª•ÊúâÂ§ö‰∏™ target ÊØîÂ¶Ç Myapp„ÄÅMyapptest Á≠âÔºåÂ¶Ç‰∏ãÂõæÔºö Ëøô‰∫õ target ÂèØ‰ª•Áõ∏‰∫í‰æùËµñÔºå‰πüÂèØ‰ª•‰æùËµñËÆ∏Â§öÂ≠ê targetÔºåÈúÄË¶ÅÂú® Target Dependencied ‰∏≠Ê≥®ÂÜåÔºö ÈÇ£‰πàÂ¶Ç‰Ωï‰∏∫Â§ö‰∏™ project ‰∏≠ÁöÑÂêÑ‰∏™ target ÈõÜÊàê pod Âë¢ÔºüÂ∞±ÂÉè‰∏äÈù¢ËØ¥ÁöÑ project ‰∏çÈáçË¶ÅÔºåÊàë‰ª¨Âè™Ë¶ÅÂú®ËÆæÁΩÆtarget ÁöÑÊó∂ÂÄôÔºåÂºïÂÖ• project ÁöÑË∑ØÂæÑÂç≥ÂèØÔºö 1234567891011121314151617181920212223242526272829303132333435# ÊåáÂÆö workspace # ÊåáÂÆöÂêé‰∏ç‰ºöÁîüÊàêÈªòËÆ§ÁöÑ workspace Êñá‰ª∂workspace 'TheApp.xcworkspace'# ÊåáÂÆö xcodeprojxcodeproj 'TheApp.xcodeproj'# cocoapods ‰ºöÁî®Âú® swift È°πÁõÆuse_frameworks!# ÊåáÂÆö targettarget 'aProject' do # Áî±‰∫é Podfile Âíå .xcodeproj ‰∏çÂú®Âêå‰∏ÄÊñá‰ª∂Â§π‰∏ã # ÈúÄË¶ÅÊåáÂÆöË∑ØÂæÑ # xcode È°πÁõÆÂèØ‰ª•Â≠òÂú®‰ªª‰ΩïÁöÑÂ≠êË∑ØË∑ØÂæÑ‰∏≠ÔºåÂè™ÈúÄË¶ÅÊåáÂÆöÊ≠£Á°ÆÁöÑË∑ØÂæÑÂ∞±ÂèØ‰ª• project ‚ÄòaProject/aProject.xcodeproj‚Äô # Âú®ÊØè‰∏Ä‰∏™ project ‰∏ãÈÉΩÂØºÂÖ• SnapKit ËøõË°åÊµãËØï pod "SnapKit"endtarget 'bProject' do project 'bProject/bProject.xcodeproj‚Äô pod "SnapKit"endtarget 'aFramework' do project ‚ÄòaFramework/aFramework.xcodeproj‚Äô pod "SnapKit"endtarget 'bFramework' do project ‚ÄòbFramework/bFramework.xcodeproj‚Äô pod "SnapKit"end ÂèØ‰ª•ÁúãÂà∞ÔºåÂØπ‰∫é‰∏çÂêå project ‰∏≠ÁöÑ targetÔºåÂè™Ë¶ÅÊåáÂÆöÂÖ∂‰∏é Podfile ÁöÑÁõ∏ÂØπ‰ΩçÁΩÆÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ ÂÅáÂ¶Ç target aProject ‰∏ãËøòÊúâÂÖ∂‰ªñÂ≠ê targetÔºåËøô‰∫õÂ≠ê target ÊòØÂèØ‰ª•Áõ¥Êé•ÂºïÁî®Áà∂ target ÂºïÂÖ•ÁöÑ SnapKit ÁªÑ‰ª∂ÁöÑ„ÄÇ CocoaPods ‰ΩøÁî® iOS Â¶Ç‰ΩïÂú®‰∏Ä‰∏™Â≠òÂú®Â§ö‰∏™projectÁöÑworkspace‰∏≠ÂºïÂÖ•cocoapodsÁÆ°ÁêÜÁ¨¨‰∏âÊñπÁ±ªÂ∫ì ÂÆâË£Ö XVimÊÖïÂêç‰∏ãËΩΩ‰∫ÜXVimÔºå‰ΩÜÊòØÂÆâË£ÖËµ∑Êù•ÊúâÁÇπÊõ≤Êäò„ÄÇ Áé∞Âú®Áªü‰∏Ä‰ΩøÁî® XVim2 ‰∫Ü Ê≥®ÊÑèÔºåÂàõÂª∫Ëá™Á≠æÂêçËØÅ‰π¶ÁöÑÊó∂ÂÄôË¶ÅÈÄâÂØπËØÅ‰π¶Á±ªÂûãÔºåË¶ÅÈÄâ‰∏∫‚Äù‰ª£Á†ÅÁ≠æÂêç‚Äù ÂàõÂª∫Â•ΩËá™Á≠æÂêçËØÅ‰π¶ÂêéÔºåË¶ÅÂØπ Xcode ËøõË°åÈáçÊñ∞Á≠æÂêçÔºö 1$ sudo codesign -f -s zachary /Applications/Xcode.app ÊØèÊ¨°Êõ¥Êñ∞ Xcode ÂêéÔºåÈÉΩË¶ÅÂÖàÂØπ Xcode ËøõË°åÈáçÊñ∞Á≠æÂêçÔºÅ Ëøô‰∏™Ë¶ÅÁ≠â‰∏ÄÊÆµËõÆÈïø‰∏ÄÊÆµÊó∂Èó¥ÔºåËøôÊÆµÊó∂Èó¥ÂèØ‰ª•ÂÖàÊää‰ª£Á†ÅÁ†ÅËµ∑Êù•„ÄÇ ÈáçÊñ∞Á≠æÂêçÂêéÔºåÂ∞±ÂèØ‰ª•Âú® clone ‰∏ãÊù•ÁöÑ XVim Êñá‰ª∂Â§π‰∏ãÁºñËØë‰∫ÜÔºåÈúÄË¶Å cd XVim/Ôºö 1$ make Ëá≥‰∫éÂÆâË£ÖÊåáÂçó‰∏äÁöÑËøô‰∏™Êåá‰ª§ÔºåÂÖ∂ÂÆû‰∏çÁî®Â§™Âú®ÊÑè: 1$ xcode-select -p Ëøô‰∏™Êåá‰ª§‰∏ªË¶ÅÊòØÁúãÁúã Xcode ÁöÑÁâàÊú¨ÊòØÂê¶ÊåáÂÆöÂú® /Applications/Xcode.app/Contents/Developer ÁõÆÂΩï‰∏ãÔºå‰∏çÊòØÁöÑËØùË¶ÅÊâãÂä®ÊåáÂÆö„ÄÇ ÈáçÂêØxcodeÔºå‰ºöÊèêÁ§∫ÊòØÂê¶‰ΩøÁî®XvimÔºåÈÄâÊã©loadÂ∞±OK‰∫Ü„ÄÇ ‰ΩøÁî®Èô§‰∫ÜVimËá™Ë∫´ÁöÑÂëΩ‰ª§Â§ñ,XVimËøòÊúâÂá†‰∏™XcodeÂëΩ‰ª§: ÈôÑÂ∏¶Vim‰ΩøÁî®ËØ¶Ëß£Ôºö Podfile.lockÂú®ÂçèÂêåÂºÄÂèëÊó∂ÔºåÁªèÂ∏∏‰ºöÈÅáÂà∞ÔºåPodfile.lock ‰∏ç‰∏ÄËá¥ÔºåÂØºËá¥ÁºñËØëÂ§±Ë¥•ÔºåÈúÄË¶ÅÈáçÊñ∞ pod install ÁöÑÊÉÖÂÜµ„ÄÇËøôÈáåÂ∞ÜÁÆÄÂçï‰ªãÁªç‰∏ã Podfile.lock Podfile.lockÁöÑ‰ΩúÁî®Podfile.lockPodfile.lock ÊòØÂú®Á¨¨‰∏ÄÊ¨°ËøêË°å pod install Êó∂ÂÄôËá™Âä®ÁîüÊàêÁöÑ„ÄÇPodfile.lock ‰∏≠‰ºöÊ†áÊ≥®È°πÁõÆÂΩìÂâç‰æùËµñÂ∫ìÁöÑÂáÜÁ°ÆÁâàÊú¨ÔºåÂÖ∂‰∏≠ÂåÖÊã¨‰∫ÜÈ°πÁõÆÂú® Podfile ‰∏≠Áõ¥Êé•Ê†áÊ≥®‰ΩøÁî®ÁöÑÂ∫ìÔºå‰ª•ÂèäËøô‰∫õÂ∫ì‰æùËµñÁöÑÂÖ∂‰ªñÂ∫ì„ÄÇËøôÊ†∑ÁöÑÂ•ΩÂ§ÑÊòØÂΩì‰Ω†Ë∑üÂ∞è‰ºô‰º¥ÂçèÂêåÂºÄÂèëÊó∂Ôºå‰Ω†ÁöÑÂ∞è‰ºô‰º¥ÂêåÊ≠•‰∫Ü‰Ω†ÁöÑ Podfile.lock Êñá‰ª∂ÂêéÔºå‰ªñÊâßË°å pod install ‰ºöÂÆâË£Ö Podfile.lock ÊåáÂÆöÁâàÊú¨ÁöÑ‰æùËµñÂ∫ìÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Èò≤Ê≠¢Â§ßÂÆ∂ÁöÑ‰æùËµñÂ∫ì‰∏ç‰∏ÄËá¥ËÄåÈÄ†ÊàêÈóÆÈ¢ò„ÄÇÂõ†Ê≠§ÔºåCocoaPods ÂÆòÊñπÂº∫ÁÉàÊé®ËçêÊää Podfile.lock Á∫≥ÂÖ•ÁâàÊú¨ÊéßÂà∂‰πã‰∏ã„ÄÇ ‰ΩÜÊòØÔºåPodfile.lock Âπ∂‰∏çÊòØ‰∏ÄÊàê‰∏çÂèòÁöÑÔºåÂΩì‰Ω†‰øÆÊîπ‰∫Ü Podfile Êñá‰ª∂Èáå‰ΩøÁî®ÁöÑ‰æùËµñÂ∫ìÊàñËÄÖËøêË°å pod update ÂëΩ‰ª§Êó∂ÔºåÂ∞±‰ºöÁîüÊàêÊñ∞ÁöÑ Podfile.lock Êñá‰ª∂„ÄÇÊâÄ‰ª•ÔºåÂçèÂêåÂºÄÂèëÊó∂ÈúÄË¶ÅÊ≥®ÊÑè‰ΩøÁî® pod install Âíå pod update ÁöÑÂå∫Âà´: ‰ΩøÁî® pod installÔºå‰Ω†Âè™‰ºöÂÆâË£Ö Podfile ‰∏≠Êñ∞ÊîπÂèòÁöÑ‰∏úË•øÔºåÂπ∂‰∏î‰ºöÔºö‰ºòÂÖàÈÅµÂæ™ Podfile ÈáåÊåáÂÆöÁöÑÁâàÊú¨‰ø°ÊÅØÔºõÂÖ∂Ê¨°ÈÅµÂæ™ Podfile.lock ÈáåÊåáÂÆöÁöÑÁâàÊú¨‰ø°ÊÅØÊù•ÂÆâË£ÖÂØπÂ∫îÁöÑ‰æùËµñÂ∫ì„ÄÇÊØîÂ¶ÇÔºö‰∏ãÈù¢Âú® Podfile ÈáåÊ≤°ÊåáÂÆö iRate ÁöÑÁâàÊú¨Ôºå‰ΩÜÊòØ Podfile.lock ÈáåÊåáÂÆö‰∫Ü iRate ÁöÑÁâàÊú¨ÊòØ 1.11.1ÔºåÈÇ£‰πàÂç≥‰ΩøÁé∞Âú®ÊúâÊúÄÊñ∞ÁöÑ 1.11.4ÔºåÊúÄÁªà‰πü‰ºöÂÆâË£Ö 1.11.1„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú Podfile ÈáåÊåáÂÆö‰∫Ü iRate ÁâàÊú¨ÊòØ 1.11.3ÔºåÈÇ£‰πàÂàô‰ºöÂÆâË£Ö 1.11.3ÔºåÂπ∂Êõ¥Êñ∞ Podfile.lock ÈáåÁöÑ‰ø°ÊÅØ„ÄÇ ‰ΩøÁî® pod updateÔºå‰Ω†‰ºöÊ†πÊçÆ Podfile ÁöÑËßÑÂàôÊõ¥Êñ∞ÊâÄÊúâ‰æùËµñÂ∫ìÔºå‰∏ç‰ºöÁêÜÁù¨Áé∞ÊúâÁöÑ Podfile.lockÔºåËÄåÊòØÊ†πÊçÆÂÆâË£Ö‰æùËµñÂ∫ìÁöÑÊÉÖÂÜµÁîüÊàêÊñ∞ÁöÑ Podfile.lock Êñá‰ª∂„ÄÇ Manifest.lockÈÇ£‰πàÊòØÂ¶Ç‰ΩïÁü•ÈÅìÊãâÂèñÁöÑ Podfile.lock Âíå Pod ÂÜÖÔºåÂ∫ìÁöÑÁâàÊú¨‰∏ç‰∏ÄËá¥ÁöÑÂë¢ÔºüÂú®ÊØèÊ¨°ÁîüÊàê Podfile.lock ÁöÑÊó∂ÂÄôÔºåÈÉΩ‰ºöÂú® PodÂÜÖÁîüÊàê‰∏Ä‰∏™ Podfile.lock ÁöÑÂâØÊú¨Manifest.lock„ÄÇÁî±‰∫é Pod ‰∏ÄËà¨‰∏ç‰ºö‰∏ä‰º†ÁâàÊú¨ÊéßÂà∂ÔºåManifest.lock Â∞±‰ª£Ë°®‰∫ÜÊú¨Âú∞ÁöÑ Pod ÁâàÊú¨„ÄÇÂ¶ÇÊûúÊãâÂèñ‰∫ÜÂà´‰∫∫ÁöÑ Podfile.lockÔºåÈÇ£‰πà Podfile.lock Âíå Manifest.lock Â∞±‰ºö‰∫ßÁîü‰∏ç‰∏ÄËá¥ÔºåÂ∞±‰ºöÂØºËá¥ÁºñËØëÂ§±Ë¥•„ÄÇ ÁõÆÁöÑÊúâ‰∫ÜËøô‰∏™Ê£ÄÊü•Êú∫Âà∂Â∞±ËÉΩ‰øùËØÅÂºÄÂèëÂõ¢ÈòüÁöÑÂêÑ‰∏™Â∞è‰ºô‰º¥ËÉΩÂú®ËøêË°åÈ°πÁõÆÂâçÊõ¥Êñ∞‰ªñ‰ª¨ÁöÑ‰æùËµñÂ∫ìÔºåÂπ∂‰øùÊåÅËøô‰∫õ‰æùËµñÂ∫ìÁöÑÁâàÊú¨‰∏ÄËá¥Ôºå‰ªéËÄåÈò≤Ê≠¢Âú®‰æùËµñÂ∫ìÁöÑÁâàÊú¨‰∏çÁªü‰∏ÄÈÄ†ÊàêÁ®ãÂ∫èÂú®‰∏Ä‰∫õ‰∏çÊòéÊòæÁöÑÂú∞ÊñπÁºñËØëÂ§±Ë¥•ÊàñËøêË°åÂ¥©Ê∫É„ÄÇ Podfile.lock ‰∏çÂêåÁöÑÂèØËÉΩÂéüÂõ†ÊúâÊó∂ÂèØËÉΩ Podfile ÊòØÁõ∏ÂêåÁöÑÔºå‰ΩÜÊòØ‰Ω†‰ª¨ÁöÑ Podfile.lock Ëøò‰ºö‰∏çÂêå„ÄÇ‰∏ãÈù¢ Podfile.lock ÁöÑÂºïÂè∑ÈóÆÈ¢òÂ∞±ÊòØÂÖ∂‰∏≠‰πã‰∏Ä„ÄÇ Èô§‰∫Ü gemÔºårubyÁ≠âÂ∫ìÁöÑÁâàÊú¨‰∏çÂêåÂØºËá¥‰πãÂ§ñÔºåËøòÊúâÂèØËÉΩÊòØÂõ†‰∏∫Êú¨Âú∞ÁöÑ Podspec Êñá‰ª∂‰∏çÂêåÂØºËá¥ÁöÑ„ÄÇÊâÄÊúâÁöÑÈ°πÁõÆÁöÑ Podspec Êñá‰ª∂ÈÉΩÊâòÁÆ°Âú® https://github.com/CocoaPods/Specs„ÄÇÁ¨¨‰∏ÄÊ¨°ÊâßË°åÊó∂ÔºåCocoaPods ‰ºöÂ∞ÜËøô‰∫õ podspec Á¥¢ÂºïÊñá‰ª∂Êõ¥Êñ∞Âà∞Êú¨Âú∞ÁöÑ ~/.cocoapods/ ÁõÆÂΩï‰∏ã„ÄÇÂ¶ÇÊûúÈïøÊó∂Èó¥‰∏çÊõ¥Êñ∞ podspecÔºåÈÇ£‰πàÊâÄË¶Å‰∏ãËΩΩÁöÑÁõ¥Êé•‰æùËµñÂ∫ìÊàñÈó¥Êé•‰æùËµñÂ∫ìÁöÑÊúÄÊñ∞ÁâàÊú¨ÂèØËÉΩÂèëÁîü‰∫ÜÂèòÂåñÔºåÂ∞±‰ºöÂØºËá¥ÂÆâË£Ö‰∫Ü‰∏ç‰∏ÄÊ†∑ÁöÑ‰æùËµñÁâàÊú¨ÔºåÈÇ£‰πà Podfile.lock ÁöÑËÆ∞ÂΩïÂ∞±‰∏ç‰∏ÄÊ†∑‰∫Ü„ÄÇÂª∫ËÆÆÂèØ‰ª•ÊâßË°å pod repo update Êõ¥Êñ∞‰∏Ä‰∏ã spec repo(‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊâßË°å pod install Êó∂‰ºöÂÖàËá™Âä®Êõ¥Êñ∞ spec ÁöÑÔºåÈô§ÈùûÂêë‰∏äÈù¢ËØ¥ÁöÑ‰ΩøÁî® pod install --no-repo-updateÔºåÂΩìÁÑ∂ÔºåÁé∞Âú®Âè™ÊòØËÆ∞ÂΩï‰∏ãÂèØËÉΩÂØºËá¥ Podfile.lock ‰∏ç‰∏ÄËá¥ÁöÑÂéüÂõ†Ôºå‰∏á‰∏ÄÁúüÁöÑÂèëÁîü‰∫ÜÂë¢Ôºü) Podfile.lock ÁöÑÂºïÂè∑ÈóÆÈ¢òÊúÄËøëÂú®Âçè‰ΩúÁöÑÊó∂ÂÄôÈÅáÂà∞‰∫ÜËøôÊ†∑ÁöÑÈóÆÈ¢òÔºåÊàëÁöÑ pod lock ÊÄªÊòØÂíåÂêå‰∫ãÁöÑ‰∏ç‰∏ÄËá¥ÔºåÂ∑ÆÂà´Âú®‰∫éÊòØÂê¶ÊúâÂºïÂè∑„ÄÇËøôÂ∞±ÂØºËá¥‰∫ÜÊØèÊ¨°ÊãâÂèñÂà´‰∫∫ÁöÑ‰ª£Á†ÅÊàëÈÉΩË¶Å pod install ‰∏ÄÈÅçÔºåÂà´‰∫∫‰πüÊòØ‰∏ÄÊ†∑„ÄÇ Êü•‰∫Ü‰∏Ä‰∫õËµÑÊñôInconsistent Podfile.lock files between Ruby versions,Strange quotes in Podfile.lock?! ÂèëÁé∞Â§ßËá¥ÊòØÂõ†‰∏∫ gem ÁöÑ‰∏Ä‰∏™ YAML Ëß£ÊûêÂ∑•ÂÖ∑ psych ÁâàÊú¨‰∏çÂêåÂØºËá¥ÁöÑ„ÄÇÊâÄ‰ª•ÔºåËß£ÂÜ≥ÈóÆÈ¢òÁöÑÂÖ≥ÈîÆ‰∏çÊòØÊõ¥Êñ∞ cocoapods ËÄåÊòØÊõ¥Êñ∞ psych (Êõ¥Êñ∞ psych ÂâçÔºåÂÖàÊää rubyÔºågem‰πüÂÖàÊõ¥Êñ∞‰∫ÜÔºå‰ª•Èò≤Êúâ‰ªÄ‰πàÂ∑ÆÈîô). Ê≥®ÈáäÊñπÊ≥ïÂíåÂ±ûÊÄßÁöÑÂø´Êç∑Ê≥®ÈáäÂú® Xcode8 ‰πãÂâçÔºåÊÉ≥Ë¶Å‰∏ÄÈîÆ‰∏∫Â±ûÊÄßÂíåÊñπÊ≥ïÊ≥®ÈáäÈÉΩÈúÄË¶ÅÈÄöËøáÊèí‰ª∂ÂÆåÊàê„ÄÇÁé∞Âú® Xcode8 ‰∏≠Êúâ‰∫ÜÂÜÖÁΩÆÁöÑÊ≥®ÈáäÊñπÂºèÔºö alt+command+/ÔºåÂè™Ë¶ÅÂ∞ÜÂÖâÊ†áÁßªÂä®Âà∞ÊÉ≥Ë¶ÅÊ≥®ÈáäÁöÑÊñπÊ≥ï‰∏äÔºåÂ∞±‰ºöËá™Âä®ËØÜÂà´ÊñπÊ≥ïÁöÑÂèÇÊï∞ÂíåËøîÂõûÂÄºÔºåÊèê‰æõÊ≥®ÈáäÊ®°ÊùøÔºåÈùûÂ∏∏Êñπ‰æø„ÄÇ XcodeÊñ≠ÁÇπË∞ÉËØïÂÄºÈÉΩ‰∏∫nilÁöÑÈóÆÈ¢òÂú®Build Settings‰∏≠ Optimization Level ËÆæÁΩÆÊàê NoneÔºö #pragma markÂ•ΩÁöÑ‰π†ÊÉØ‰ªé#pragma markÂºÄÂßã„ÄÇÂ∞±ÂÉèËøôÊ†∑Ôºö 1234567891011121314151617181920212223242526272829@implementation ViewController- (id)init &#123; ...&#125;#pragma mark - UIViewController- (void)viewDidLoad &#123; ...&#125;#pragma mark - IBAction- (IBAction)cancel:(id)sender &#123; ...&#125;#pragma mark - UITableViewDataSource- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section &#123; ...&#125;#pragma mark - UITableViewDelegate- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath &#123; ...&#125; Âú®‰Ω†ÁöÑ @implementation ‰∏≠‰ΩøÁî® #pragma mark Êù•Â∞Ü‰ª£Á†ÅÂàÜÂâ≤ÊàêÈÄªËæëÂå∫Âùó„ÄÇËøô‰∫õÈÄªËæëÂå∫Âùó‰∏ç‰ªÖ‰ªÖ‰ΩøÂæóÈòÖËØª‰ª£Á†ÅÊú¨Ë∫´ÂÆπÊòìËÆ∏Â§öÔºå‰πü‰∏∫XcodeÊ∫êÂØºËà™Â¢ûÂä†‰∫ÜËßÜËßâÁ∫øÁ¥¢Ôºà#pragma mark Â£∞ÊòéÂâçÊúâ‰∏Ä‰∏™Ê∞¥Âπ≥ÂàÜÂâ≤Âπ∂Áî±Á†¥ÊäòÂè∑ÔºàÔºçÔºâÂºÄÂßãÔºâ„ÄÇ Xcode Âπ∂ÊéíÊü•Áúã‰ª£Á†ÅÂ¶ÇÊûúÊÉ≥Ë¶ÅÂçïÁ∫ØÂàÜ‰∏∫Â∑¶Âè≥‰∏§Â±èÔºåÊåâ‰Ωè alt ÂÜçÁÇπÂáªÊñá‰ª∂ÔºåÂç≥ÂèØÂú®ËæÖÂä©Á™óÂè£Êü•Áúã„ÄÇ ÂèØ‰ª•ÁÇπÂáªÂâØ‰∏ªÁ™óÂè£Âè≥‰∏äËßíÁöÑ ‚Äú+‚ÄùÔºåÊ∑ªÂä†Êõ¥Â§öËæÖÂä©Á™óÂè£ÔºåÊ≠§Êó∂Êåâ‰Ωè alt Â∞±‰ºöËÆ©‰Ω†ÈÄâÊã©Âú®Âì™‰∏™ËæÖÂä©Á™óÂè£Êü•ÁúãÊñá‰ª∂‰ª£Á†Å„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Áà¨Âùë</tag>
        <tag>Cocoapods</tag>
        <tag>Vim</tag>
        <tag>Xcode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[lldb Ë∞ÉËØïÊñπÊ≥ï]]></title>
    <url>%2F2016%2F09%2F21%2Flldb%E8%B0%83%E8%AF%95%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[ÂÅ∂ÁÑ∂ÁúãÂà∞‰ΩøÁî® lldb ÈáåÁöÑ watchpoint Ë∞ÉËØïÔºåÊÑüËßâÂæàÁ•ûÂ•áÔºåÂ∞±ËØ¶ÁªÜ‰∫ÜËß£‰∫Ü‰∏ã lldb Ë∞ÉËØïÁöÑ‰ΩøÁî®ÊñπÊ≥ï„ÄÇ Êü•ÈòÖ‰∫ÜËÆ∏Â§öÊñáÁ´†‰∏éË∞ÉËØïÂô®ÂÖ±Ëàû - LLDB ÁöÑÂçéÂ∞îÂÖπËøôÁØáÊñáÁ´†Â∏ÆÂä©ÊúÄÂ§ß„ÄÇ Xcode‰∏≠ÂÜÖÂµå‰∫ÜLLDBÊéßÂà∂Âè∞ÔºåÂú®Xcode‰∏≠‰ª£Á†ÅÁöÑ‰∏ãÊñπÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞LLDBÊéßÂà∂Âè∞„ÄÇ LLDBÊéßÂà∂Âè∞Âπ≥Êó∂‰ºöËæìÂá∫‰∏Ä‰∫õlog‰ø°ÊÅØ(Debugger output‰∏≠)„ÄÇÂ¶ÇÊûúÊàë‰ª¨ÊÉ≥ËæìÂÖ•ÂëΩ‰ª§Ë∞ÉËØïÔºåÂøÖÈ°ªËÆ©Á®ãÂ∫èËøõÂÖ•ÊöÇÂÅúÁä∂ÊÄÅ„ÄÇËÆ©Á®ãÂ∫èËøõÂÖ•ÊöÇÂÅúÁä∂ÊÄÅÁöÑÊñπÂºè‰∏ªË¶ÅÊúâ2ÁßçÔºö Êñ≠ÁÇπÊàñËÄÖwatchpoint: Âú®‰ª£Á†Å‰∏≠ËÆæÁΩÆ‰∏Ä‰∏™Êñ≠ÁÇπÔºàwatchpointÔºâÔºåÂΩìÁ®ãÂ∫èËøêË°åÂà∞Êñ≠ÁÇπ‰ΩçÁΩÆÁöÑÊó∂ÂÄôÔºå‰ºöËøõÂÖ•stopÁä∂ÊÄÅ Áõ¥Êé•ÊöÇÂÅúÔºåÊéßÂà∂Âè∞‰∏äÊñπÊúâ‰∏Ä‰∏™ÊöÇÂÅúÊåâÈíÆÔºå‰∏äÂõæÁ∫¢Ê°ÜÂ∑≤Ê†áÂá∫ÔºåÁÇπÂáªÂç≥ÂèØÊöÇÂÅúÁ®ãÂ∫è ‰∏çËøáÊúÄÂ•ΩËøòÊòØ‰∏çË¶ÅÁõ¥Êé•ÊöÇÂÅúÔºåÂõ†‰∏∫ËøôÁßçÊÉÖÂÜµ‰∏ãÁöÑÂΩìÂâç‰ΩúÁî®ÂüüÊ≤°Êúâ‰ªª‰ΩïÂèòÈáèÔºåÂç≥‰ΩøËøõÂÖ•‰∫Ü lldb ‰πüÂÅö‰∏ç‰∫Ü‰ªÄ‰πà‰∫ã„ÄÇ expressionexpressionÁöÑÂá†‰∏™ÂëΩ‰ª§ÊòØÊúÄÂ∏∏Áî®ÁöÑÔºåËÉΩÊèêÂçádebugÊïàÁéáÁöÑÂëΩ‰ª§„ÄÇ printÊâìÂç∞‰∏Ä‰∏™ÂØπË±°:ÂèØ‰ª•Áõ¥Êé•Áº©ÂÜôpËææÂà∞ÂêåÊ†∑ÁöÑÊïàÊûú„ÄÇ ÁªìÊûú‰∏≠Êúâ‰∏™$0ÔºåÂèØ‰ª•‰ΩøÁî®ÂÆÉÊåáÂêëËøô‰∏™ÁªìÊûú„ÄÇlldb ‰∏≠ÂèØ‰ª•ÂàõÂª∫ÂØπË±°Ôºå‰ΩÜÊòØËøô‰∏™ÂØπË±°ÁöÑÂëΩÂêçÂøÖÈ°ªË¶Å‰ª•$ÂºÄÂ§¥,Ë°®Á§∫ÂëΩÂêçÁ©∫Èó¥ÊòØlldbÔºå‰ª•ÂÖçÂíåÂ§ñÈÉ®‰ª£Á†Å‰∏≠ÁöÑÂêçÂ≠óÂÜ≤Á™ÅÔºåÂ¶ÇÔºö expression‰ΩøÁî®Â¶ÇÊûúÊÉ≥Ë¶ÅÊîπÂèò‰∏Ä‰∏™ÂÄºÔºåÊàñËÄÖÊâßË°å‰∏Ä‰∏™ÊñπÊ≥ï„ÄÇÂèØ‰ª•‰ΩøÁî®expressionÊàñËÄÖeÔºö printÂÖ∂ÂÆûÊòØÁâπÊÆäÁöÑexpressionÔºåÊØîÂ¶Çp count =18ÂÖ∂ÁªìÊûúÂíåexpression count = 18ÁªìÊûú‰∏ÄÊ†∑„ÄÇ‰∫ãÂÆû‰∏äÔºåprintÊòØ expression -- ÁöÑÁº©ÂÜô„ÄÇ Â∫îÁî®Áî±‰∫éexpressionÂèØ‰ª•ÊîπÂèòÂÄºÔºåÊàë‰ª¨ÂèØ‰ª•Âä®ÊÄÅÁöÑÊîπÂèòViewÁöÑÈ¢úËâ≤ÔºåËÄå‰∏çÈúÄË¶ÅÈáçÊñ∞ÁºñËØëÔºö1234// ÊîπÂèòÈ¢úËâ≤(lldb) expression self.view.backgroundColor = [UIColor redColor]// Âà∑Êñ∞ÁïåÈù¢(lldb) expression [CATransaction flush] ‰∏çÂè™ÊòØÊîπÂèòÈ¢úËâ≤ÔºåframeÔºåanimationÁ≠âÈÉΩËÉΩÊîπÂèòÔºåÈùûÂ∏∏ÊúâÁî®„ÄÇ Â¶ÇÊúÄÂºÄÂßãÊâÄËØ¥Ôºå‰∏çËÉΩÁõ¥Êé•ÊöÇÂÅúÔºåÂøÖÈ°ªË¶ÅÂú®ÂΩìÂâçÁïåÈù¢‰∏≠Ëß¶ÂèëÊñ≠ÁÇπÔºåÊØîÂ¶ÇÈáçÂÜôtouchÊñπÊ≥ïÊ∑ªÂä†Êñ≠ÁÇπÁ≠â„ÄÇ poprintËæìÂá∫ÊØîËæÉÂï∞Âó¶ÔºåËÄå‰∏îÂΩìÂ∞ùËØïÊâìÂç∞Â§çÊùÇÂØπË±°ÁöÑÊó∂ÂÄôÔºåÊúâÊó∂ÂÄô‰ºöÂæàËõãÁñºÔºö123(lldb) p @[ @"foo", @"bar" ](NSArray *) $8 = 0x00007fdb9b71b3e0 @"2 objects" Ëøô‰∏™Êó∂ÂÄôÂèØ‰ª•‰ΩøÁî®po(print object ÁöÑÁº©ÂÜô)ÔºåÁõ∏ÂΩì‰∫éË∞ÉÁî®ÂØπË±°ÁöÑdescriptionÊñπÊ≥ï„ÄÇ1234567(lldb) po $8&lt;__NSArrayI 0x7fdb9b71b3e0&gt;(foo,bar)(lldb) po @"lunar"lunar threadbtÂèØ‰ª•ÊâìÊ†à‰∏≠ÁöÑÊâÄÊúâÂ∏ß(frame)„ÄÇËøô‰∫õframeÂíåÂ∑¶ËæπÁ∫¢Ê°ÜÈáåÁöÑÂ†ÜÊ†àÊòØ‰∏ÄËá¥ÁöÑ„ÄÇÂπ≥Êó∂Êàë‰ª¨ÁúãÂà∞ÁöÑÂ∑¶ËæπÁöÑÂ†ÜÊ†àÂ∞±ÊòØframe: thread returnËøô‰πüÊòØÊØîËæÉÊúâÁî®ÁöÑ‰∏Ä‰∏™ÂëΩ‰ª§„ÄÇDebugÁöÑÊó∂ÂÄôÔºå‰πüËÆ∏‰ºöÂõ†‰∏∫ÂêÑÁßçÂéüÂõ†ÔºåÊàë‰ª¨‰∏çÊÉ≥ËÆ©‰ª£Á†ÅÊâßË°åÊüê‰∏™ÊñπÊ≥ïÔºåÊàñËÄÖË¶ÅÁõ¥Êé•ËøîÂõû‰∏Ä‰∏™ÊÉ≥Ë¶ÅÁöÑÂÄº„ÄÇËøôÊó∂ÂÄôÂ∞±ËØ•thread return‰∏äÂú∫‰∫Ü„ÄÇ ÂÆÉÊúâ‰∏Ä‰∏™ÂèØÈÄâÂèÇÊï∞ÔºåÂú®ÊâßË°åÊó∂ÂÆÉ‰ºöÊääÂèØÈÄâÂèÇÊï∞Âä†ËΩΩËøõËøîÂõûÂØÑÂ≠òÂô®ÈáåÔºåÁÑ∂ÂêéÁ´ãÂàªÊâßË°åËøîÂõûÂëΩ‰ª§ÔºåË∑≥Âá∫ÂΩìÂâçÊ†àÂ∏ß„ÄÇËøôÊÑèÂë≥ËøôÂáΩÊï∞Ââ©‰ΩôÁöÑÈÉ®ÂàÜ‰∏ç‰ºöË¢´ÊâßË°å„ÄÇËøô‰ºöÁªô ARC ÁöÑÂºïÁî®ËÆ°Êï∞ÈÄ†Êàê‰∏Ä‰∫õÈóÆÈ¢òÔºåÊàñËÄÖ‰ºö‰ΩøÂáΩÊï∞ÂÜÖÁöÑÊ∏ÖÁêÜÈÉ®ÂàÜÂ§±Êïà„ÄÇ‰ΩÜÊòØÂú®ÂáΩÊï∞ÁöÑÂºÄÂ§¥ÊâßË°åËøô‰∏™ÂëΩ‰ª§ÔºåÊòØ‰∏™ÈùûÂ∏∏Â•ΩÁöÑÈöîÁ¶ªËøô‰∏™ÂáΩÊï∞Ôºå‰º™ÈÄ†ËøîÂõûÂÄºÁöÑÊñπÂºè „ÄÇ ÊØîÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºöÊ≠£Â∏∏ÈÄöËøáisOddÊñπÊ≥ïÔºå‰∏ÄÂÆöÊòØreturn NOÁöÑÔºå‰ΩÜÊòØÈÄöËøá(lldb) thread return YESÔºåË∑≥Ëøá‰∫ÜisOddÊñπÊ≥ïÈáåÁöÑÊñπÊ≥ïÂùóÔºåÁõ¥Êé•return YES Ê≠£Â¶Ç‰∏äÈù¢ÊâÄËø∞ÔºåÂøÖÈ°ªË¶ÅÂú®Êñ≠ÁÇπËøõË°åÂà∞Â¶ÇÂõæÊâÄÁ§∫ÁöÑÂú∞ÊñπÊâçÂèØ‰ª•‰ΩøÁî®thread returnÔºåÂõ†‰∏∫: Ê≠§Êó∂ÂΩìÂâçÊ†àÂ∏ßÊòØisOdd ‰∏ç‰ºöÈÄ†ÊàêÂºïÁî®ÈóÆÈ¢ò breakpointÊñ≠ÁÇπÂΩìÁÑ∂ÊòØË∞ÉËØïÂøÖ‰∏çÂèØÂ∞ëÁöÑ‰∏úË•øÔºå‰∏ãÈù¢‰∏ç‰ºöËØ¥ÊòéÊÄéÊ†∑Ê∑ªÂä†Êñ≠ÁÇπÔºåËÄåÊòØÂ∞ÜÂàó‰∏æ‰∏Ä‰∫õÊñ≠ÁÇπÁöÑ‰ΩøÁî®ÊäÄÂ∑ß. ÊµÅÁ®ãÊéßÂà∂ÂΩìÊèíÂÖ•Êñ≠ÁÇπÂêéÔºåÁ®ãÂ∫èÂà∞ËææÊñ≠ÁÇπÊó∂‰ºöÂ∞±‰ºöÂÅúÊ≠¢ËøêË°å„ÄÇË∞ÉËØïÊù°‰∏ä‰ºöÂá∫Áé∞Â¶Ç‰∏ãÂõõ‰∏™ÊåâÈíÆ:ÊÑè‰πâÈÉΩÂæàÊòéÁ°ÆÔºå‰∏çÂ§öËØ¥‰∫ÜÔºåÂàó‰∏æ‰∏ãÂØπÂ∫îÁöÑÂëΩ‰ª§Ôºö continueÊåâÈíÆ =&gt; continue,Áº©ÂÜôc step overÊåâÈíÆ =&gt; nextÔºåÁº©ÂÜôn step inÊåâÈíÆ =&gt; step,Áº©ÂÜôs step outÊåâÈíÆ =&gt; finish ËÆæÁΩÆÊñ≠ÁÇπÂú®Êñ≠ÁÇπÂ§ÑÂè≥ÂáªÔºåÈÄâÊã©Edit BreakpointÂºπÂá∫Â¶Ç‰∏ãËÆæÁΩÆÊ°ÜÔºö ËìùËâ≤ÁöÑÂãæË°®Á§∫enableÂíådisableÊñ≠ÁÇπ„ÄÇ ConditionÊåáÁöÑÊòØÊù°‰ª∂Ë°®ËææÂºèÔºåËØ•È°πÂÖÅËÆ∏Êàë‰ª¨ÂØπÊñ≠ÁÇπÁîüÊïàËÆæÁΩÆÊù°‰ª∂ÔºåË°®Á§∫ÂΩìÊª°Ë∂≥Êüê‰∏ÄÁâπÂÆöÊù°‰ª∂ÁöÑÂâçÊèê‰∏ãÔºåËØ•Êñ≠ÁÇπÊâçÁîüÊïà„ÄÇÔºàËØ•Êù°‰ª∂ÁöÑÂΩïÂÖ•Ôºå‰∏çËÉΩÂ§üËØÜÂà´È¢ÑÂ§ÑÁêÜÁöÑÂÆèÂÆö‰πâÔºå‰πü‰∏çËÉΩËØÜÂà´Êñ≠ÁÇπ‰ΩúÁî®Âüü‰πãÂ§ñÁöÑÂèòÈáèÂíåÊñπÊ≥ïÔºâ„ÄÇ IgnoreÂøΩÁï•Ê¨°Êï∞„ÄÇÂÆÉÊåáÂÆö‰∫ÜÂú®Êñ≠ÁÇπÁîüÊïàÔºåÂ∫îÁî®ÊöÇÂÅú‰πãÂâçÔºå‰ª£Á†ÅÂøΩÁï•Êñ≠ÁÇπÁöÑÊ¨°Êï∞„ÄÇ‰Ω†Â¶ÇÊûúÂ∏åÊúõÂ∫îÁî®ËøêË°å‰∏ÄÊÆµÊó∂Èó¥ÂêéÊñ≠ÁÇπÊâçÁîüÊïàÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™ÈÄâÈ°π„ÄÇÊØîÂ¶ÇËØ¥Âú®Ë∞ÉËØïÊüê‰∏ÄÂæ™ÁéØ‰ΩìÁöÑÊó∂ÂÄô„ÄÇ ActionÂÆÉË°®Á§∫ÂΩìÊñ≠ÁÇπÁîüÊïàÊó∂ÔºåXcode‰ΩúÂá∫ÂèçÂ∫îÂêéÁöÑË°å‰∏∫Âä®‰Ωú„ÄÇÁÇπÂáªÂè≥ËæπÁöÑAdd ActionÈÄâÈ°π‰ºöÂºπÂá∫Â¶Ç‰∏ãËèúÂçïÔºöÈªòËÆ§ÁöÑÊòØDebugger Command„ÄÇËøòÊúâ‰ª•‰∏ãÂá†ÁßçÂä®‰Ωú‰æõÈÄâÊã©Ôºå‰∏ãÈù¢Â∞Ü‰ªãÁªç‰∏§‰∏™Â∏∏Áî®ÁöÑÔºö Debugger CommandÔºöÈªòËÆ§ÁöÑÈÄâÈ°πÔºåÂèØ‰ª•ËÆ©Êñ≠ÁÇπÊâßË°åLLDBË∞ÉËØïÂëΩ‰ª§„ÄÇ Log MessageÔºöÂèØ‰ª•ÁîüÊàêÊ∂àÊÅØÈòüÂàóÔºåÂ∞ÜÁõ∏ÂÖ≥ÁöÑÊ∂àÊÅØËæìÂá∫Âà∞ÊéßÂà∂Âè∞‰∏ä.Èöè‰æøÂÜô‰ªÄ‰πàÈÉΩËÉΩËæìÂá∫ÔºåËæìÂá∫ÁöÑÂØπË±°ÈúÄË¶Å‰ΩøÁî®@exp@ÂΩ¢Âºè„ÄÇ Options‰∏Ä‰∏™ÈÄâÈ°πÔºåÂãæ‰∏äÂèØ‰ª•Âú®ËøêË°åÂà∞Êñ≠ÁÇπÂêé‰∏çÊöÇÂÅúÔºåËá™Âä®Âêë‰∏ãËøêË°åÔºåÈÖçÂêàActionÁõ∏ÂΩì‰∫éÊâì‰∫ÜÊñ≠ÁÇπ„ÄÇ Êñ≠ÁÇπÁ±ªÂûãÂºÇÂ∏∏Êñ≠ÁÇπÂºÇÂ∏∏Êñ≠ÁÇπÊòØ‰ª£Á†ÅÂá∫Áé∞ÈóÆÈ¢òÂØºËá¥ÁºñËØëÂô®ÊäõÂá∫ÂºÇÂ∏∏Êó∂Ëß¶ÂèëÁöÑÊñ≠ÁÇπ„ÄÇÂÆÉÂú®Êñ≠ÁÇπÂØºËà™Âô®‰∏≠ËÆæÁΩÆ„ÄÇÁÇπÂáªÔºãÂè∑ÔºåÈÄâÊã©Exception BreakpointÈÄâÈ°π„ÄÇÂ¶Ç‰∏ãÂõæÔºö Á¨¶Âè∑Êñ≠ÁÇπ‰ªñÂèØ‰ª•‰∏≠Êñ≠Êüê‰∏™ÊñπÊ≥ïÁöÑË∞ÉÁî®ÔºåÂèØË∞ìÊòØÂºÇÂ∏∏Âº∫Â§ßÔºåÂú®Êñ≠ÁÇπÂØºËà™Âô®ÁïåÈù¢ÔºåÁÇπÂáªÔºãÂè∑ÔºåÈÄâÊã©Add Symbolic BreakpointÈÄâÈ°πÔºåÁÑ∂Âêé‰ºöÂºπÂá∫Â¶ÇÂõæÊâÄÁ§∫ÁöÑÂØπËØùÊ°Ü: ÂÆÉÊØîÊôÆÈÄöÊñ≠ÁÇπÁöÑËá™ÂÆö‰πâËÆæÁΩÆÁïåÈù¢Â§öÂá∫‰∫Ü‰∏§‰∏™ÂÜÖÂÆπ SymbolÔºöÁî®Êù•ËÆæÁΩÆÂΩìÂâçÊñ≠ÁÇπ‰ΩúÁî®ÂüüÊâÄËÉΩËØÜÂà´ÁöÑÊñπÊ≥ïÔºåËøôÈáåÈù¢Êó¢ÂèØ‰ª•ÊòØËá™ÂÆö‰πâÁöÑÊñπÊ≥ïÔºå‰πüÂèØ‰ª•ÊòØÁ≥ªÁªüÁöÑAPIÊñπÊ≥ï„ÄÇÔºàÊ≥®ÊÑèÂøÖÈ°ªË°®ÊòéÊòØÁ±ªÊñπÊ≥ïËøòÊòØÊàêÂëòÊñπÊ≥ïÔºâ‰æãÂ¶Ç: 12-[MyViewController viewDidAppear:]+[MyViewController sharedInstance] ModuleÔºöÊ®°ÁªÑÁöÑÊÑèÊÄùÔºåÁî®Êù•ÈôêÂà∂Êª°Ë∂≥Á¨¶Âè∑ÁöÑÊñπÊ≥ïÔºåÁºñËØëÂô®Â∞ÜÂè™‰ºöÂú®Êñ≠ÁÇπÊª°Ë∂≥Ëøô‰∏™Ê®°ÁªÑÁöÑÁ¨¶Âè∑ÁöÑÊó∂ÂÄôÊâçÂõûÊöÇÂÅú„ÄÇ ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂ¶ÇÊûú‰∏Ä‰∏™Â≠êÁ±ªÊ≤°ÊúâÈáçÂÜôÁà∂Á±ªÁöÑÊñπÊ≥ïÔºåÈÇ£‰πàËÆæÁΩÆÂ≠êÁ±ªËøô‰∏™ÊñπÊ≥ïÁöÑÁ¨¶Âè∑Êñ≠ÁÇπÊòØ‰∏ç‰ºöË¢´Ëß¶ÂèëÁöÑ„ÄÇ watchpoint‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÂèØ‰ª•Âú®Â±ûÊÄßÁöÑ set ÊñπÊ≥ï‰∏≠Ê∑ªÂä†Êñ≠ÁÇπÔºåËøôÊ†∑Â∞±ËÉΩÁõëÊéßÂ±ûÊÄßÁöÑËÆæÁΩÆ„ÄÇ‰ΩÜÊòØÊúâÊó∂ÂÄôÔºåÁî±‰∫é‰∏çÊ∂âÂèäÂà∞ÊñπÊ≥ïÔºåËÄåÊòØÁõ¥Êé•Êìç‰ΩúÂÜÖÂ≠òÔºåÊó†Ê≥ï‰ΩøÁî®Êñ≠ÁÇπÔºå‰ΩÜÊòØÊàë‰ª¨‰ªçË¶ÅÁõëËßÜÊüê‰∏Ä‰∏™ÂÄºÊòØÂê¶ÂèòÂåñÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ÂèØ‰ª•Áî®watchpointÊù•ÁõëËßÜ„ÄÇ ÂΩìÊåáÈíàÊåáÂêëÂèòÂåñÊó∂Ôºåwatchpoint‰ºöËß¶Âèë: setÊ∑ªÂä†watchpointÁöÑÊñπÂºèÂ¶Ç‰∏äÂõæÊâÄÁ§∫1(lldb) watchpoint set variable xxx Ê≥®ÊÑèÔºåË≤å‰ºº‰∏çËÉΩÁî® self-&gt;xxx ÁöÑÂΩ¢ÂºèÔºåËÄåË¶ÅÁõ¥Êé•Áî® _xxx ÁöÑÂΩ¢ÂºèÔºåÂê¶Âàô‰∏ÄÁõ¥ÈÉΩÊòØ‰∏ãÈù¢ÁöÑÈîôËØØÔºö watchpoint ‰∏çÂè™ÊòØÁõëÂê¨ÊåáÈíàÂèòÂåñÔºåËøòËÉΩÁõëÂê¨ÂèòÈáèÂèòÂåñ„ÄÇÂè™Ë¶ÅËØ•ÊåáÈíàÊàñÂèòÈáèËøõË°å‰∫ÜËµãÂÄºÔºåÊó†ËÆ∫ÊòØÂê¶ÊîπÂèò‰∫ÜÂÄºÔºåÈÉΩ‰ºö‰Ωø watchpoint ÂëΩ‰∏≠„ÄÇ disable/delete/enablewatchpointËµÑÊ∫ê‰πüÊòØÊØîËæÉÊúâÈôêÁöÑÔºåÂØπ‰∫é‰∏çÈúÄË¶ÅÁõëÂê¨ÁöÑÂØπË±°Ë¶ÅÂèäÊó∂ÈáäÊîæ„ÄÇÊØè‰∏™watchpointÈÉΩÊúâ‰∏Ä‰∏™Â∫èÂè∑ÔºåÊìç‰ΩúÂØπÂ∫îÁöÑÈúÄË¶ÅÂç≥ÂèØÔºö ÂÖ∂‰ªñÊäÄÂ∑ßrunËøôÊòØÊàëÊØîËæÉÂñúÊ¨¢ÁöÑÊñπÊ≥ïÔºåÊâÄ‰ª•ÂçïÁã¨ÂàóÂá∫Êù•„ÄÇ Ë∞ÉËØïÁöÑÊó∂ÂÄôÁªèÂ∏∏ÈúÄË¶ÅÈáçÊñ∞ÂêØÂä®Á®ãÂ∫è„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÈáçÊñ∞RunÁ®ãÂ∫èÔºåÈúÄË¶ÅÈáçÊñ∞ÁºñËØëÔºåÈùûÂ∏∏Êµ™Ë¥πÊó∂Èó¥„ÄÇÂèØ‰ª•Âú® lldb ‰∏≠ËæìÂÖ•runÂ∞±ËÉΩÁõ¥Êé•ËÆ©Á®ãÂ∫èÈáçÊñ∞Âä†ËΩΩ‰∫Ü„ÄÇ ‰ª£ÊõøNSLogÁúãNSLogÁöÑÊñáÊ°£ÔºåÁ¨¨‰∏ÄÂè•ËØùÂ∞±ËØ¥ÔºöLogs an error message to the Apple System Log facility.ÔºåÊâÄ‰ª•È¶ñÂÖàÔºåNSLogÂ∞±‰∏çÊòØËÆæËÆ°‰Ωú‰∏∫ÊôÆÈÄöÁöÑdebug logÁöÑÔºåËÄåÊòØerror logÔºõÊØèÊ¨°NSLogÈÉΩ‰ºöËøõË°åÂæàÂ§öËÄóÊó∂Â∑•‰ΩúÔºåÂõ†Ê≠§ÔºåÈùûÈáçË¶ÅÂèÇÊï∞Â∞ΩÈáè‰∏çË¶ÅÁî®Ôºå‰ΩøÁî®Ë∞ÉËØï‰ª£Êõø„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Debug</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UIScrollViewËØ¶ÁªÜ‰ªãÁªç]]></title>
    <url>%2F2016%2F09%2F18%2FScrollview%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[Êú¨Ê¨°Â∞ÜÂèÇËÄÉiOS ÊÄßËÉΩ‰ºòÂåñ‰πã UIScrollView ÂÆûË∑µÁªèÈ™åÂØπUIScrollViewÁöÑ‰ΩøÁî®ÊñπÂºèËøõË°åËØ¶ÁªÜ‰ªãÁªç ScrollViewÂíåAuto LayoutUIScrollView Âú® Auto Layout ÊòØ‰∏Ä‰∏™ÂæàÁâπÊÆäÁöÑ viewÔºåÂØπ‰∫é UIScrollView ÁöÑ subview Êù•ËØ¥ÔºåÂÆÉÁöÑ leading/trailing/top/bottom space ÊòØÁõ∏ÂØπ‰∫é UIScrollViewÁöÑ contentSize ËÄå‰∏çÊòØ bounds (Ëá™Ë∫´Âú®Â±èÂπï‰∏äÊòæÁ§∫ÁöÑËæπÁïåÔºå‰∏çÊòéÁôΩÁöÑÂèØ‰ª•Êü•‰∏Ä‰∏ã bounds Âíå frame ÁöÑÂå∫Âà´)Êù•Á°ÆÂÆöÁöÑ„ÄÇ ÊâÄ‰ª•Ôºå‰∏ÄËà¨ÁöÑÂÅöÊ≥ïÊòØÂú®UIScrollVIewÂíåÂÆÉÁöÑsubViews‰πãÈó¥Â¢ûÂä†‰∏Ä‰∏™content view„ÄÇËøôÊ†∑ÂèØ‰ª•Êñπ‰æøÂú∞Áªô subview Êèê‰æõ leading/trailing/top/bottomÔºåÊñπ‰æø subview ÁöÑÂ∏ÉÂ±ÄÔºåÂπ∂‰∏îÂèØ‰ª• ÈÄöËøáË∞ÉÊï¥content view ÁöÑ sizeÔºàË∞ÉÊï¥constraint ÁöÑ IBOutletÔºâÊù•Ë∞ÉÊï¥ contentSize„ÄÇ Ê∑ªÂä†ContentViewÁöÑÊ≥®ÊÑèÁÇπscrollview‰∏≠Ê∑ªÂä†ÁöÑcontentviewÂíåÊ∑ªÂä†‰∏ÄËà¨ÁöÑËßÜÂõæ‰∏çÂêåÔºå‰∏ÄËà¨ÁöÑËßÜÂõæÂè™Ë¶ÅÊèê‰æõleading/trailing/top/bottom spaceÂ∞±ËÉΩÂîØ‰∏ÄÁ°ÆÂÆöÈïøÂÆΩÔºå‰ΩçÁΩÆ„ÄÇËÄåScrollViewÁöÑcontentViewÈô§‰∫Ü‰∏äËø∞Âõõ‰∏™Á∫¶ÊùüÔºåËøòÈúÄË¶ÅËÆæÁΩÆÈïøÂÆΩÔºå‰Ωú‰∏∫ÊªöÂä®ÁöÑËåÉÂõ¥ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ ÊâÄ‰ª•Êï¥‰∏™scrollviewÁöÑcontentSizeÁöÑÁ≠âÂºèÂ∫îËØ•ÊòØÔºö1scrollView.contentSize.width = (scrollview‰∏écontentview‰πãÈó¥leadingÁöÑconstant)+ÔºàcontentViewÁöÑwidthÔºâ+Ôºàscrollview‰∏écontentview‰πãÈó¥trailingÁöÑconstantÔºâ Âè¶Â§ñ‰∏ÄÁÇπÈúÄË¶ÅÂº∫Ë∞É‰∏§ÁÇπÔºö ScrollViewÁöÑboundsÊó©Â∞±Á°ÆÂÆö‰∫Ü‰∏ãÊù•ÔºåÂú®ËÆæÁΩÆcontentviewÁöÑÂÆΩÂ∫¶ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúËÆæÁΩÆcontentview.width = superview.width + constantËøôÈáåÁöÑsuperview.widthÊòØÊåáScrollView.boundsËÄå‰∏çÊòØcontentSize Âú®ËÆæÁΩÆcontentviewÁöÑ‰∏ä‰∏ãÂ∑¶Âè≥Á∫¶ÊùüÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúËÆæÁΩÆcontentview.trailing = superview.trailing + constant,ËøôÈáåÁöÑsuperview.trailingÊåáÁöÑÊòØcontentSize.trailingËÄå‰∏çÊòØbounds„ÄÇÊ≠§Êó∂Â∞±ÂèØ‰ª•ÈÄöËøá‰∏äÈù¢ÁöÑÂÖ¨ÂºèËÆ°ÁÆócontentSizeÁöÑÂÆΩÂ∫¶‰∫Ü„ÄÇ DemoÂèÇËßÅAutoLayout UIScrollViewÈÉ®ÂàÜÂ±ûÊÄßcontentSize„ÄÅcontentInsetÂíåcontentOffset contentSize: Â∞±ÊòØscrollviewÂèØ‰ª•ÊªöÂä®ÁöÑÂå∫Âüü.ÊØîÂ¶Çframe = (0 ,0 ,320 ,480) contentSize = (320 ,960)Ôºå‰ª£Ë°®‰Ω†ÁöÑscrollviewÂèØ‰ª•‰∏ä‰∏ãÊªöÂä®ÔºåÊªöÂä®Âå∫Âüü‰∏∫frameÂ§ßÂ∞èÁöÑ‰∏§ÂÄç„ÄÇ contentOffset:Â∞±ÊòØscrollviewÂΩìÂâçÊòæÁ§∫Âå∫ÂüüÈ°∂ÁÇπÁõ∏ÂØπ‰∫éframeÈ°∂ÁÇπÁöÑÂÅèÁßªÈáè„ÄÇÊØîÂ¶Ç‰∏ä‰∏™‰æãÂ≠ê‰Ω†ÊãâÂà∞ÊúÄ‰∏ãÈù¢ÔºåcontentoffsetÂ∞±ÊòØ(0 ,480)Ôºå‰πüÂ∞±ÊòØyÂÅèÁßª‰∫Ü480 contentInset:Â∞±ÊòØscrollviewÁöÑcontentviewÁöÑÈ°∂ÁÇπÁõ∏ÂØπ‰∫éscrollviewÁöÑ‰ΩçÁΩÆ„ÄÇ‰æãÂ¶Ç‰Ω†ÁöÑcontentInset = (0 ,100)ÔºåÈÇ£‰πà‰Ω†ÁöÑcontentviewÂ∞±ÊòØ‰ªéscrollviewÁöÑ(0 ,100)ÂºÄÂßãÊòæÁ§∫ / ‰∏äÊãâÂà∑Êñ∞‰∏ÄËà¨ÂÆûÁé∞‰ª£Á†ÅÂ¶Ç‰∏ã /123456789- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate&#123; [_refreshHeaderView egoRefreshScrollViewDidEndDragging:scrollView]; float offset=scrollView.contentOffset.y; float contentHeight=scrollView.contentSize.height; float sub=contentHeight-offset; if ((scrollView.height-sub)&gt;20) &#123;//Â¶ÇÊûú‰∏äÊãâË∑ùÁ¶ªË∂ÖËøá20pÔºåÂàôÂä†ËΩΩÊõ¥Â§öÊï∞ÊçÆ //[self loadMoreData];//Ê≠§Â§ÑÂú®viewÂ∫ïÈÉ®Âä†ËΩΩÊõ¥Â§öÊï∞ÊçÆ &#125; &#125; UIScrollViewDelegateUIScrollViewDelegate ÊòØ UIScrollView ÁöÑ delegate protocolÔºåUIScrollView ÊúâÊÑèÊÄùÁöÑÂäüËÉΩÈÉΩÊòØÈÄöËøáÂÆÉÁöÑ delegate ÊñπÊ≥ïÂÆûÁé∞ÁöÑ„ÄÇ - (void)scrollViewDidScroll:(UIScrollView *)scrollViewËøô‰∏™ÊñπÊ≥ïÂú®‰ªª‰ΩïÊñπÂºèËß¶Âèë contentOffset ÂèòÂåñÁöÑÊó∂ÂÄôÈÉΩ‰ºöË¢´Ë∞ÉÁî®ÔºàÂåÖÊã¨Áî®Êà∑ÊãñÂä®ÔºåÂáèÈÄüËøáÁ®ãÔºåÁõ¥Êé•ÈÄöËøá‰ª£Á†ÅËÆæÁΩÆÁ≠âÔºâÔºåÂèØ‰ª•Áî®‰∫éÁõëÊéß contentOffset ÁöÑÂèòÂåñÔºåÂπ∂Ê†πÊçÆÂΩìÂâçÁöÑ contentOffset ÂØπÂÖ∂‰ªñ view ÂÅöÂá∫ÈöèÂä®Ë∞ÉÊï¥„ÄÇ - (void)scrollViewWillBeginDragging:(UIScrollView *)scrollViewÁî®Êà∑ÂºÄÂßãÊãñÂä® scroll view ÁöÑÊó∂ÂÄôË¢´Ë∞ÉÁî®„ÄÇ - (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffsetÂú® didEndDragging ÂâçË¢´Ë∞ÉÁî®ÔºåÂΩì willEndDragging ÊñπÊ≥ï‰∏≠ velocity ‰∏∫ CGPointZeroÔºàÁªìÊùüÊãñÂä®Êó∂‰∏§‰∏™ÊñπÂêëÈÉΩÊ≤°ÊúâÈÄüÂ∫¶ÔºâÊó∂ÔºådidEndDragging ‰∏≠ÁöÑ decelerate ‰∏∫ NOÔºåÂç≥Ê≤°ÊúâÂáèÈÄüËøáÁ®ãÔºåwillBeginDecelerating Âíå didEndDecelerating ‰πüÂ∞±‰∏ç‰ºöË¢´Ë∞ÉÁî®„ÄÇÂèç‰πãÔºåÂΩì velocity ‰∏ç‰∏∫ CGPointZero Êó∂Ôºåscroll view ‰ºö‰ª• velocity ‰∏∫ÂàùÈÄüÂ∫¶ÔºåÂáèÈÄüÁõ¥Âà∞ targetContentOffset„ÄÇÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåËøôÈáåÁöÑ targetContentOffset ÊòØ‰∏™ÊåáÈíàÔºåÂèØ‰ª•ÊîπÂèòÂáèÈÄüËøêÂä®ÁöÑÁõÆÁöÑÂú∞ÔºåËøôÂú®‰∏Ä‰∫õÊïàÊûúÁöÑÂÆûÁé∞Êó∂ÂçÅÂàÜÊúâÁî®„ÄÇ - (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerateÂú®Áî®Êà∑ÁªìÊùüÊãñÂä®ÂêéË¢´Ë∞ÉÁî®Ôºådecelerate ‰∏∫ YES Êó∂ÔºåÁªìÊùüÊãñÂä®Âêé‰ºöÊúâÂáèÈÄüËøáÁ®ã„ÄÇÊ≥®ÔºåÂú® didEndDragging ‰πãÂêéÔºåÂ¶ÇÊûúÊúâÂáèÈÄüËøáÁ®ãÔºåscroll view ÁöÑ dragging Âπ∂‰∏ç‰ºöÁ´ãÂç≥ÁΩÆ‰∏∫ NOÔºåËÄåÊòØË¶ÅÁ≠âÂà∞ÂáèÈÄüÁªìÊùü‰πãÂêéÔºåÊâÄ‰ª•Ëøô‰∏™ dragging Â±ûÊÄßÁöÑÂÆûÈôÖËØ≠‰πâÊõ¥Êé•Ëøë scrolling„ÄÇ - (void)scrollViewWillBeginDecelerating:(UIScrollView *)scrollViewÂáèÈÄüÂä®ÁîªÂºÄÂßãÂâçË¢´Ë∞ÉÁî®„ÄÇ - (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollViewÂáèÈÄüÂä®ÁîªÁªìÊùüÊó∂Ë¢´Ë∞ÉÁî®„ÄÇ ËøôÈáåÊúâ‰∏ÄÁßçÁâπÊÆäÊÉÖÂÜµÔºöÂΩì‰∏ÄÊ¨°ÂáèÈÄüÂä®ÁîªÂ∞öÊú™ÁªìÊùüÁöÑÊó∂ÂÄôÂÜçÊ¨° drag scroll viewÔºådidEndDecelerating ‰∏ç‰ºöË¢´Ë∞ÉÁî®ÔºåÂπ∂‰∏îËøôÊó∂ scroll view ÁöÑ dragging Âíå decelerating Â±ûÊÄßÈÉΩÊòØ YES(Âõ†‰∏∫ÔºåÊ≠§Êó∂ScrollViewËøòÂú®ÊªöÂä®ÔºåÂπ∂‰∏îËøòÂú®ÂáèÈÄü)„ÄÇÊñ∞ÁöÑ dragging Â¶ÇÊûúÊúâÂä†ÈÄüÂ∫¶ÔºåÈÇ£‰πà willBeginDecelerating ‰ºöÂÜç‰∏ÄÊ¨°Ë¢´Ë∞ÉÁî®ÔºåÁÑ∂ÂêéÊâçÊòØ didEndDeceleratingÔºõÂ¶ÇÊûúÊ≤°ÊúâÂä†ÈÄüÂ∫¶ÔºåËôΩÁÑ∂ willBeginDecelerating ‰∏ç‰ºöË¢´Ë∞ÉÁî®Ôºå‰ΩÜÂâç‰∏ÄÊ¨°Áïô‰∏ãÁöÑ didEndDecelerating ‰ºöË¢´Ë∞ÉÁî®„ÄÇ DemoÂèÇËßÅDelegate ÂÆû‰æãTable View ‰∏≠ÂõæÁâáÂä†ËΩΩÈÄªËæëÁöÑ‰ºòÂåñ‰ºòÂåñÁõÆÁöÑÔºöÊªëÂä®Êó∂‰∏çÂä†ËΩΩÂõæÁâáÔºåÂú®ÊªëÂä®ÂÅúÊ≠¢Êó∂Âä†ËΩΩÂõæÁâá ‰ºòÂåñÈöæÁÇπÔºöÂâçÈù¢ÊèêÂà∞ÔºåÂàöÂºÄÂßãÊãñÂä®ÁöÑÊó∂ÂÄôÔºådragging ‰∏∫ YESÔºådecelerating ‰∏∫ NOÔºõdecelerate ËøáÁ®ã‰∏≠Ôºådragging Âíå decelerating ÈÉΩ‰∏∫ YESÔºõdecelerate Êú™ÁªìÊùüÊó∂ÂºÄÂßã‰∏ã‰∏ÄÊ¨°ÊãñÂä®Ôºådragging Âíå decelerating ‰æùÁÑ∂ÈÉΩ‰∏∫ YES„ÄÇÊâÄ‰ª•Êó†Ê≥ïÁÆÄÂçïÈÄöËøá table view ÁöÑ dragging Âíå decelerating Âà§Êñ≠ÊòØÂú®Áî®Êà∑ÊãñÂä®ËøòÊòØÂáèÈÄüËøáÁ®ã„ÄÇ ÊâÄ‰ª•‰∏çËÉΩ‰ªÖÈÄöËøádeceleratingÊù•Âà§Êñ≠ÊòØÂê¶Âä†ËΩΩÂõæÁâáÔºåËøòÈúÄË¶ÅËá™Â∑±ËÆ∞ÂΩïÁî®Êà∑ÊãñÂä®Áä∂ÊÄÅÔºåÂú®ÊãñÂä®Êó∂‰πüË¶ÅÂä†ËΩΩÂõæÁâá„ÄÇÔºàÊ∂âÂèäÂà∞ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÁÇπÂæàÂ§öÔºåËøòÊòØÁõ¥Êé•ÁúãÂéüÊñáÊØîËæÉÂ•ΩÔºâ ‰ºòÂåñÊñπÊ≥ïÔºö ÊØèÊ¨°ÂºÄÂßãÊãñÂä®Êó∂scrollViewWillBeginDraggingÔºåÈÄöËøáNSArray *cells = [self.tableView visibleCells];Ëé∑ÂèñÂ±èÂπï‰∏äÊâÄÊúâÊòæÁ§∫ÁöÑCellÔºåÂÖ®ÈÉ®Âä†ËΩΩ‰∏ÄÈÅçÂõæÁâáÔºàËß£ÂÜ≥ÈóÆÈ¢ò‰∏âÔºâ Âà©Áî®scrollViewWillEndDragging: withVelocity: targetContentOffset:ÊñπÊ≥ïÔºåÂ∞ÜtargetContentOffsetÂç≥ÊúÄÂêéÂáèÈÄüÁªìÊùüÂêéÂú®Â±èÂπï‰∏äÊòæÁ§∫ÁöÑ‰ΩçÁΩÆÔºåËΩ¨Êç¢‰∏∫‰∏Ä‰∏™CGRectÔºåÂú®CGRectËåÉÂõ¥ÈáåÁöÑCellÊâçÂú®CellForRowAtIndex‰∏≠Âä†ËΩΩ„ÄÇ DemoËØ¶ËßÅLazyLoad ÂàÜÈ°µÁöÑÂá†ÁßçÂÆûÁé∞ÊñπÊ≥ïÂàÜÈ°µÁ±ª‰ºº‰∫é android ‰∏≠ÁöÑ viewpager ÔºåÂà©Áî® UIScrollView ÊúâÂ§öÁßçÊñπÊ≥ïÂÆûÁé∞ÂàÜÈ°µÔºå‰ΩÜÊòØÂêÑËá™ÁöÑÊïàÊûúÂíåÁî®ÈÄî‰∏çÂ∞ΩÁõ∏Âêå„ÄÇ pagingEnabledÁ≥ªÁªüÊèê‰æõÁöÑÂàÜÈ°µÊñπÂºèÔºåÂÆûÁé∞ÁÆÄÂçïÔºåÂè™ÈúÄË¶Å_scrollView.pagingEnabled = YESÂç≥ÂèØÔºå‰ΩÜÊòØÊúâÂ±ÄÈôêÊÄßÔºö Âè™ËÉΩ‰ª• ScrollView ÁöÑ frame size ‰∏∫Âçï‰ΩçÁøªÈ°µÔºåÂáèÈÄüÂä®ÁîªÈòªÂ∞ºÂ§ßÔºåÂáèÈÄüËøáÁ®ã‰∏çË∂ÖËøá‰∏ÄÈ°µ„ÄÇ ÈúÄË¶Å‰∏Ä‰∫õ hacking ÂÆûÁé∞ bleeding Âíå paddingÔºàÂç≥È°µ‰∏éÈ°µ‰πãÈó¥Êúâ paddingÔºåÂú®ÂΩìÂâçÈ°µÂèØ‰ª•ÁúãÂà∞ÂâçÂêéÈ°µÁöÑÈÉ®ÂàÜÂÜÖÂÆπÔºâ Sample ‰∏≠ Pagination ÊúâÁÆÄÂçïÂÆûÁé∞ bleeding Âíå padding ÊïàÊûúÁöÑ‰ª£Á†ÅÔºå‰∏ªË¶ÅÁöÑÊÄùË∑ØÊòØÔºö ËÆ© scroll view ÁöÑÂÆΩÂ∫¶‰∏∫ page ÂÆΩÂ∫¶ + paddingÔºåÂπ∂‰∏îËÆæÁΩÆ clipsToBounds ‰∏∫ NO,ËøôÊ†∑ÂâçÂêé‰∏çÂú® scrollView ‰∏≠ÁöÑÈÉ®ÂàÜÂ∞±ËÉΩÊòæÁ§∫‰∏ÄÈÉ®ÂàÜÂá∫Êù•„ÄÇËßÅ‰∏ãÂõæ: ËøôÊ†∑ËôΩÁÑ∂ËÉΩÁúãÂà∞ÂâçÂêéÈ°µÁöÑÂÜÖÂÆπÔºå‰ΩÜÊòØÊó†Ê≥ïÂìçÂ∫î touchÔºåÊâÄ‰ª•ÈúÄË¶ÅÂè¶‰∏Ä‰∏™Ë¶ÜÁõñÊúüÊúõÁöÑÂèØËß¶Êë∏Âå∫ÂüüÁöÑ view Êù•ÂÆûÁé∞Á±ª‰ºº touch bridging ÁöÑÂäüËÉΩ ÈÄÇÁî®Âú∫ÊôØÔºö‰∏äËø∞Â±ÄÈôêÊÄßÂêåÊó∂‰πüÊòØËøôÁßçÂÆûÁé∞ÊñπÂºèÁöÑ‰ºòÁÇπÔºåÊØîÂ¶Ç‰∏ÄËà¨ App ÁöÑÂºïÂØºÈ°µÔºàÊïôÁ®ãÔºâÔºåCalendar ÈáåÁöÑÊúàËßÜÂõæÔºåÈÉΩÂèØ‰ª•Áî®ËøôÁßçÊñπÊ≥ïÂÆûÁé∞„ÄÇ SnapÊ†∏ÂøÉÁÆóÊ≥ïÊòØÂú® didEndDragging ÊñπÊ≥ï‰∏≠ÔºåÈÄöËøáÂΩìÂâç contentOffset ËÆ°ÁÆóÊúÄËøëÁöÑÊï¥Êï∞È°µÂèäÂÖ∂ÂØπÂ∫îÁöÑ contentOffsetÔºåÈÄöËøáÂä®Áîª snap Âà∞ËØ•È°µ„ÄÇËøô‰∏™ÊñπÊ≥ïÂÆûÁé∞ÁöÑÊïàÊûúÈÉΩÊúâ‰∏™ÈÄöÁóÖÔºåÂ∞±ÊòØÊúÄÂêéÁöÑ snap ‰ºöÂú® decelerate ÁªìÊùü‰ª•ÂêéÊâçÂèëÁîüÔºåÊÄªÊÑüËßâÂæàÁ™ÅÂÖÄ„ÄÇ‰ΩøÁî®‰ΩìÈ™å‰∏çÂ¶Ç‰∏ãÈù¢ÁöÑÊñπÊ≥ï„ÄÇ ‰øÆÊîπtargetContentOffsetÈÄöËøá‰øÆÊîπ scrollViewWillEndDragging: withVelocity: targetContentOffset: ÊñπÊ≥ï‰∏≠ÁöÑ targetContentOffset Áõ¥Êé•‰øÆÊîπÁõÆÊ†á offset ‰∏∫Êï¥Êï∞È°µ‰ΩçÁΩÆ„ÄÇÂÖ∂‰∏≠Ê†∏ÂøÉ‰ª£Á†ÅÔºö123456789- (CGPoint)nearestTargetOffsetForOffset:(CGPoint)offset&#123; CGFloat pageSize = BUBBLE_DIAMETER + BUBBLE_PADDING; NSInteger page = roundf(offset.x / pageSize); CGFloat targetX = pageSize * page; return CGPointMake(targetX, offset.y);&#125;- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset&#123; CGPoint targetOffset = [self nearestTargetOffsetForOffset:*targetContentOffset]; targetContentOffset-&gt;x = targetOffset.x; targetContentOffset-&gt;y = targetOffset.y;&#125; ÈÄÇÁî®Âú∫ÊôØÔºöÊñπÊ≥ï 2 Âíå ÊñπÊ≥ï 3 ÁöÑÂéüÁêÜËøë‰ººÔºåÊïàÊûú‰πüÁõ∏ËøëÔºåÈÄÇÁî®Âú∫ÊôØ‰πüÂü∫Êú¨Áõ∏ÂêåÔºå‰ΩÜÊñπÊ≥ï 3 ÁöÑ‰ΩìÈ™å‰ºöÂ•ΩÂæàÂ§öÔºåsnap Âà∞Êï¥Êï∞È°µÁöÑËøáÁ®ãÂæàËá™ÁÑ∂ÔºåÊàñËÄÖËØ¥Áî®Êà∑ÂÆåÂÖ®ÊÑüÁü•‰∏çÂà∞ snap ËøáÁ®ãÁöÑÂ≠òÂú®„ÄÇËøô‰∏§ÁßçÊñπÊ≥ïÁöÑÂáèÈÄüËøáÁ®ãÊµÅÁïÖÔºåÈÄÇÁî®‰∫é‰∏ÄÂ±èÊúâÂ§öÈ°µÔºå‰ΩÜÈúÄË¶ÅÊåâÊï¥Êï∞È°µÊªëÂä®ÁöÑÂú∫ÊôØÔºõ‰πüÈÄÇÁî®‰∫éÂ¶ÇÂõæË°®‰∏≠Ëá™Âä® snap Âà∞Êï¥Êï∞Â§©ÁöÑÂú∫ÊôØÔºõËøòÈÄÇÁî®‰∫éÊØèÈ°µÂ§ßÂ∞è‰∏çÂêåÁöÑÊÉÖÂÜµ‰∏ã snap Âà∞Êï¥Êï∞È°µÁöÑÂú∫ÊôØÔºà‰∏çÂÅö‰∏æ‰æãÔºåËá™Ë°åÂèëÊå•ÔºåÂÖ∂ÂÆûÂè™ÈúÄË¶Å‰øÆÊîπËÆ°ÁÆóÁõÆÊ†á offset ÁöÑÊñπÊ≥ïÔºâ„ÄÇ DemoËØ¶ËßÅPagination UIPageControlÈ¶ñÂÖàÂ£∞ÊòéËøô‰∏™Âíå ScrollView Â¶Ç‰ΩïËÆæÁΩÆÂàÜÈ°µÊ≤°ÊúâÂÖ≥Á≥ª„ÄÇËøô‰∏™ÁªÑ‰ª∂ÊòØ iOS Âú®ÂàÜÈ°µ‰∏≠ÁªèÂ∏∏Áî®ÁöÑË°®Á§∫È°µÊï∞ÁöÑÂ∞èÁôΩÁÇπ„ÄÇÁÆÄÂçïËÆ∞ÂΩï‰∏Ä‰∏ãÊÄé‰πà‰ΩøÁî®„ÄÇ ‰ΩøÁî®Ëµ∑Êù•ÂÖ∂ÂÆûËõÆÁÆÄÂçïÁöÑÔºåÂ∞±ÂΩì‰∏Ä‰∏™ View Êù•‰ΩøÁî®Â∞±Ë°å‰∫ÜÔºö 123456_pageControl = [[UIPageControl alloc]initWithFrame:CGRectMake(SCREEN_WIDTH/2-75, SCREEN_HEIGHT-30-20, 150, 20)];_pageControl.numberOfPages = 3;_pageControl.currentPage = 0;_pageControl.pageIndicatorTintColor = [UIColor colorWithHexString:@"E1E1E1"];_pageControl.currentPageIndicatorTintColor = COLOR_MAINRED;[self.view addSubview:_pageControl]; Âá†‰∏™Â±ûÊÄß‰πüÊØîËæÉÊòìÊáÇÔºåÂü∫Êú¨‰∏äÂ∞±ËÆæÁΩÆÂ•Ω‰∫ÜÔºåÂΩìÁÑ∂ËøôÈáåËøòÊ≤°ÊúâËÆæÁΩÆÂíå Scrollview ÁöÑËÅîÂä®Ôºö 12345//ÁõëÂê¨scrollViewÊªöÂä®‰∫ã‰ª∂- (void)scrollViewDidScroll:(UIScrollView *)scrollView &#123; int page = scrollView.contentOffset.x / SCREEN_WIDTH; _pageControl.currentPage = page;&#125; ÁõëÂê¨ Scrollview ÁöÑÊªöÂä®‰∫ã‰ª∂Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ ÈáçÁî®Â§ßÈÉ®ÂàÜÁöÑ iOS ÂºÄÂèëÂ∫îËØ•ÈÉΩÊ∏ÖÊ•ö UITableView ÁöÑ cell ÈáçÁî®Êú∫Âà∂ÔºåËøôÁßçÈáçÁî®Êú∫Âà∂ÂáèÂ∞ë‰∫ÜÂÜÖÂ≠òÂºÄÈîÄ‰πüÊèêÈ´ò‰∫Ü performanceÔºåUIScrollView ‰Ωú‰∏∫ UITableView ÁöÑÁà∂Á±ªÔºåÂú®ÂæàÂ§öÂú∫ÊôØ‰∏≠‰πüÂæàÈÄÇÂêàÂ∫îÁî®ÈáçÁî®Êú∫Âà∂„ÄÇ ÂèØ‰ª•ÂèÇÁÖß UITableView ÁöÑ cell ÈáçÁî®Êú∫Âà∂ÔºåÊÄªÁªìÈáçÁî®Êú∫Âà∂Â¶Ç‰∏ãÔºö Áª¥Êä§‰∏Ä‰∏™ÈáçÁî®ÈòüÂàó ÂΩìÂÖÉÁ¥†Á¶ªÂºÄÂèØËßÅËåÉÂõ¥Êó∂ÔºåremoveFromSuperview Âπ∂Âä†ÂÖ•ÈáçÁî®ÈòüÂàóÔºàenqueueÔºâ ÂΩìÈúÄË¶ÅÂä†ÂÖ•Êñ∞ÁöÑÂÖÉÁ¥†Êó∂ÔºåÂÖàÂ∞ùËØï‰ªéÈáçÁî®ÈòüÂàóËé∑ÂèñÂèØÈáçÁî®ÂÖÉÁ¥†ÔºàdequeueÔºâÂπ∂‰∏î‰ªéÈáçÁî®ÈòüÂàóÁßªÈô§ Â¶ÇÊûúÈòüÂàó‰∏∫Á©∫ÔºåÊñ∞Âª∫ÂÖÉÁ¥† Â∞ÜÊñ∞Âª∫ÂÖÉÁ¥†ÁöÑviewÈÄöËøáaddSubViewÊ∑ªÂä†Ëá≥ contentView‰∏ä Ëøô‰∫õ‰∏ÄËà¨ÈÉΩÂú® scrollViewDidScroll: ÊñπÊ≥ï‰∏≠ÂÆåÊàê Demo‰∏≠ÊºîÁ§∫‰∫Ü‰∏Ä‰∏™Âú®scrollView‰∏≠Ê∑ªÂä†Â§ö‰∏™ÈáçÁî®ViewControllerÁöÑÂú∫ÊôØÔºåÂÖ∑‰ΩìÈáçÁî®ÊñπÊ≥ïÂèÇËßÅDemo ËøôÈáåË¶ÅËØ¥Êòé‰∏Ä‰∏ãDemo‰∏≠Áî®Âà∞ÁöÑaddChildViewController„ÄÇ ËãπÊûúÂú®iOS 5 Ê∑ªÂä†‰∫Ü‰∏ÄÁ≥ªÂàóÁöÑÊñπÊ≥ïÔºåÂ∏åÊúõÊàë‰ª¨Âú®‰ΩøÁî®addSubViewÊó∂ÔºåÂêåÊó∂Ë∞ÉÁî®[self addChildViewController:child]ÊñπÊ≥ïÂ∞Üsub viewÂØπÂ∫îÁöÑviewController‰πüÂä†Âà∞ÂΩìÂâçViewControllerÁöÑÁÆ°ÁêÜ‰∏≠„ÄÇ ÂØπ‰∫éÈÇ£‰∫õÂΩìÂâçÊöÇÊó∂‰∏çÈúÄË¶ÅÊòæÁ§∫ÁöÑsubviewÔºåÂè™ÈÄöËøáaddChildViewControllerÊääsubViewControllerÂä†ËøõÂéªÔºõÈúÄË¶ÅÊòæÁ§∫Êó∂ÂÜçË∞ÉÁî®transitionFromViewControllerÊñπÊ≥ï„ÄÇÂ∞ÜÂÖ∂Ê∑ªÂä†ËøõÂÖ•Â∫ïÂ±ÇÁöÑViewController‰∏≠„ÄÇ ËøôÊ†∑ÂÅöÁöÑÂ•ΩÂ§ÑÔºö ÂØπÈ°µÈù¢‰∏≠ÁöÑÈÄªËæëÊõ¥Âä†ÂàÜÊòé‰∫Ü„ÄÇÁõ∏Â∫îÁöÑViewÂØπÂ∫îÁõ∏Â∫îÁöÑViewController„ÄÇ ÂΩìÊüê‰∏™Â≠êViewÊ≤°ÊúâÊòæÁ§∫Êó∂ÔºåÂ∞Ü‰∏ç‰ºöË¢´LoadÔºåÂáèÂ∞ë‰∫ÜÂÜÖÂ≠òÁöÑ‰ΩøÁî®„ÄÇ ÂΩìÂÜÖÂ≠òÁ¥ßÂº†Êó∂ÔºåÊ≤°ÊúâLoadÁöÑViewÂ∞ÜË¢´È¶ñÂÖàÈáäÊîæÔºå‰ºòÂåñ‰∫ÜÁ®ãÂ∫èÁöÑÂÜÖÂ≠òÈáäÊîæÊú∫Âà∂„ÄÇ ÂèØ‰ª•Ë∞ÉÁî®transitionFromViewControllerÁ≠âÁ≥ªÁªüÊñπÊ≥ïÔºåiosÂØπ‰∫éÊòæÁ§∫‰ª•ÂèäÂä®ÁîªÂÅö‰∫ÜÊØîËæÉÂ•ΩÁöÑÂ∞ÅË£Ö Áõ∏ÂΩì‰∫éÂØπ‰∫é ViewController ÂÆû‰æãÁöÑ‰øùÂ≠ò„ÄÇÂÆû‰æãÈÉΩ‰øùÂ≠òÂú®self.childViewControllers‰∏≠ÔºåÈúÄË¶Å‰ΩøÁî®ÁöÑÊó∂ÂÄô‰ªé‰∏≠ÂèñÂá∫Âç≥ÂèØ„ÄÇ ÂΩìÁÑ∂ÔºåÂÉèÊú¨‰æã‰∏≠Âú® ScrollView ‰∏≠Ê∑ªÂä† ViewController ÔºåÂè™ÈúÄË¶ÅÂØπ ViewController ËøõË°åÂ§çÁî®Ôºå‰ΩÜÊòØÁî®‰∏çÂà∞ÂÖ∂Êèê‰æõÁöÑÁ≥ªÁªüÊñπÊ≥ïÊó∂ÔºåÂÖ∂ÂÆûÂè™Ë¶Å‰ΩøÁî®‰∏Ä‰∏™Êï∞ÁªÑÂ∞ÜÂêÑ‰∏™ ViewController ‰øùÂ≠òËµ∑Êù•Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ ÂÖ∂ÂÆûËøô‰∫õÈÉΩ‰∏çÈáçË¶ÅÔºåÂ¶ÇÊûú‰∏çÈúÄË¶ÅÂØπ ViewController ÂÅöÂ§çÁî®ÊàñËÄÖ‰∏Ä‰∫õÂÖ∂‰ªñÊìç‰ΩúÔºåÊàë‰ª¨ËøûViewControllerÁöÑÂÆû‰æãÈÉΩ‰∏çÂøÖ‰øùÂ≠ò„ÄÇÊàë‰ª¨Âè™ÈúÄË¶ÅÂú®ÈúÄË¶ÅÊòæÁ§∫ÁöÑÊó∂ÂÄô[self.contentView addSubview:vc.view];,‰∏çÈúÄË¶ÅÊòæÁ§∫ÁöÑÊó∂ÂÄô[vc.view removeFromSuperview];ÔºåÂ∞±ÂèØ‰ª•ËææÂà∞ÊòæÁ§∫ÂíåÁõ∏Â∫î‰∫ã‰ª∂ÁöÑÈúÄÊ±Ç‰∫Ü„ÄÇ DemoËØ¶ËßÅReuse ËÅîÂä®ÊâÄË∞ìËÅîÂä®ÔºåÂ∞±ÊòØÂΩì A ÊªöÂä®ÁöÑÊó∂ÂÄôÔºåÂú® scrollViewDidScroll: ÈáåÊ†πÊçÆ A ÁöÑ contentOffset Âä®ÊÄÅËÆ°ÁÆó B ÁöÑ contentOffset Âπ∂ËÆæÁªô B„ÄÇÂêåÊ†∑ÂØπ‰∫éÈùû scroll view ÁöÑ CÔºå‰πüÂèØ‰ª•Âä®ÊÄÅËÆ°ÁÆó C ÁöÑ frame ÊàñÊòØ transformÂÆûÁé∞ËßÜÂ∑ÆÊªöÂä®ÊàñËÄÖÂÖ∂‰ªñÈ´òÁ∫ßÂä®ÁîªÔºåËøôÂú®Áé∞Âú®ËÆ∏Â§öÂ∫îÁî®ÁöÑÂºïÂØºÈ°µÈù¢Èáå‰ºöË¢´Áî®Âà∞„ÄÇ Demo‰∏≠ÁöÑÊ†∏ÂøÉ‰ª£Á†Å:12345678910- (void)scrollViewDidScroll:(UIScrollView *)scrollView&#123; if (scrollView == self.titleScrollView) &#123; CGFloat contentX = self.titleScrollView.contentOffset.x / self.titleScrollView.frame.size.width * self.contentScrollView.frame.size.width; self.contentScrollView.contentOffset = CGPointMake(contentX, 0.0); CGFloat transX = self.titleScrollView.contentOffset.x / (self.titleScrollView.contentSize.width - self.titleScrollView.frame.size.width) * (self.backgroundImage.frame.size.width - self.view.frame.size.width); transX = MAX(0.0, transX); transX = MIN(self.backgroundImage.frame.size.width - self.view.frame.size.width, transX); self.backgroundImage.transform = CGAffineTransformMakeTranslation(-transX, 0.0); &#125;&#125; ÈÄöËøátitleScrollViewËÆ°ÁÆócontentXÂíåtransXÊù•ÂàÜÂà´ÊéßÂà∂contentScrollView‰ª•ÂèäbackgroundImageËøô‰∏§‰∏™ViewÁöÑ‰ΩçÁΩÆÂèòÂåñ„ÄÇ DemoÂèÇËßÅParallax ÊÄªÁªìScrollViewÁúã‰ººÁÆÄÂçïÔºåÂÖ∂ÂÆûËøòÊòØÊúâÈùûÂ∏∏Â§öÁöÑÂú∞ÊñπÂÄºÂæóÂéªÊåñÊéòÁöÑ„ÄÇ‰ΩøÁî®Â•ΩÔºåËÉΩÂ§üÂÆûÁé∞ÂæàÂ§öÈùûÂ∏∏ÈÖ∑ÁÇ´ÁöÑÊïàÊûú„ÄÇ‰∏äÈù¢ÁöÑÂéüÁêÜÂíåÂ∫îÁî®Ê∂âÂèäÂà∞ÁöÑÁÇπÂæàÂ§öÔºåËøòÈúÄË¶ÅÁªÜÁªÜÁê¢Á£®ÔºåÂ≠¶‰ª•Ëá¥Áî®. ‰∏äËø∞ÊâÄÊúâDemoÂùáÂú®UIScrollViewDemoÊñá‰ª∂Â§π‰∏≠]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Âü∫Êú¨Êéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NSNotificationÁöÑ‰ΩøÁî®]]></title>
    <url>%2F2016%2F09%2F13%2FNSNotification%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[Êú¨ÁØáÊòØÂØπiosÁöÑÈÄöÁü•‰ΩøÁî®ÊñπÊ≥ïÁöÑ‰∏Ä‰∏™ÁÆÄÂçïÁΩóÂàó„ÄÇ NSNotificationCenterNSNotificationCenterÂ∞±ÊòØ‰∏Ä‰∏™Ê∂àÊÅØÈÄöÁü•Êú∫Âà∂ÔºåÁ±ª‰ººÂπøÊí≠„ÄÇËßÇÂØüËÄÖÂè™ÈúÄË¶ÅÂêëÊ∂àÊÅØ‰∏≠ÂøÉÊ≥®ÂÜåÊÑüÂÖ¥Ë∂£ÁöÑ‰∏úË•øÔºåÂΩìÊúâÂú∞ÊñπÂèëÂá∫Ëøô‰∏™Ê∂àÊÅØÁöÑÊó∂ÂÄôÔºåÈÄöÁü•‰∏≠ÂøÉ‰ºöÂèëÈÄÅÁªôÊ≥®ÂÜåËøô‰∏™Ê∂àÊÅØÁöÑÂØπË±°„ÄÇËøôÊ†∑‰πüËµ∑Âà∞‰∫ÜÂ§ö‰∏™ÂØπË±°‰πãÈó¥Ëß£ËÄ¶ÁöÑ‰ΩúÁî®„ÄÇËãπÊûúÁªôÊàë‰ª¨Â∞ÅË£Ö‰∫ÜËøô‰∏™NSNotificationCenterÔºåËÆ©Êàë‰ª¨ÂèØ‰ª•ÂæàÊñπ‰æøÁöÑËøõË°åÈÄöÁü•ÁöÑÊ≥®ÂÜåÂíåÁßªÈô§„ÄÇ Ê≥®ÂÜåaddObserver:selector:name:object:1[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(test) name:@"test" object:nil]; ÂèÇÊï∞Ôºö addObserver:Ë≤å‰ººÈÉΩÊòØcontrollerÂõ†‰∏∫ËøòÈúÄË¶ÅselectorÊù•ÊâßË°å name:ÈÄöÁü•Âêç„ÄÇÂΩìÂèëÈÄÅËØ•ÈÄöÁü•ÂêçÁöÑÈÄöÁü•ÊòØÔºåËßÇÂØüËÄÖÊî∂Âà∞Ê∂àÊÅØ„ÄÇ object:Áº©Â∞èÊé•ÂèóÈÄöÁü•ÁöÑËåÉÂõ¥ÔºåÂè™Êé•ÂèóÁõ∏ÂØπÂ∫îÁöÑobjectÂØπË±°ÂèëÊù•ÁöÑÈÄöÁü•„ÄÇnilÂàôÂÖ®ÈÉ®Êé•Êî∂„ÄÇ addObserverForName:object:queue:usingBlock:NSNotificationCenterÊ∂àÊÅØÁöÑÊé•ÂèóÁ∫øÁ®ãÊòØÂü∫‰∫éÂèëÈÄÅÊ∂àÊÅØÁöÑÁ∫øÁ®ãÁöÑ,‰πüÂ∞±ÊòØÂêåÊ≠•ÁöÑÔºåÂõ†Ê≠§ÔºåÊúâÊó∂ÂÄôÔºå‰Ω†ÂèëÈÄÅÁöÑÊ∂àÊÅØÂèØËÉΩ‰∏çÂú®‰∏ªÁ∫øÁ®ãÔºåËÄåÂ§ßÂÆ∂ÈÉΩÁü•ÈÅìÊìç‰ΩúUIÂøÖÈ°ªÂú®‰∏ªÁ∫øÁ®ãÔºå‰∏çÁÑ∂‰ºöÂá∫Áé∞‰∏çÂìçÂ∫îÁöÑÊÉÖÂÜµ„ÄÇÊâÄ‰ª•ÔºåÂú®‰Ω†Êî∂Âà∞Ê∂àÊÅØÈÄöÁü•ÁöÑÊó∂ÂÄôÔºåÊ≥®ÊÑèÈÄâÊã©‰Ω†Ë¶ÅÊâßË°åÁöÑÁ∫øÁ®ã„ÄÇ1id observer = [[NSNotificationCenter defaultCenter] addObserverForName:notification object:nil queue:[NSOperationQueue mainQueue] usingBlock:^(NSNotification *note)&#123;...&#125;]; ÂèÇÊï∞Ôºö queue:blockÊâßË°åÊâÄÂú®ÁöÑÁ∫øÁ®ã„ÄÇÂ¶ÇÊûúÊòØnilÈÇ£‰πàÂ∞±Âú®ÂΩìÂâçÁ∫øÁ®ã(posting thread) block:ËØ•ÁßçÊñπÂºè‰∏çÁî®selectorËÄå‰ΩøÁî®blockÂõûË∞É„ÄÇ Âà†Èô§Âè™Ë¶ÅÂæÄNSNotificationCenterÊ≥®ÂÜå‰∫ÜÔºåÂ∞±ÂøÖÈ°ªÊúâremoveÁöÑÂ≠òÂú®„ÄÇ removeObserver:1- (void)removeObserver:(id)notificationObserver ÂØπÂ∫îaddObserverForNameÊñπÂºèÔºåÁõ¥Êé•Êää‰∏äÈù¢ÁöÑid observer‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•Âç≥ÂèØ„ÄÇÂØπÂ∫îaddObserverÊñπÂºèÔºåÂà†Èô§controller‰∏≠ÂÖ®ÈÉ®ÈÄöÁü•. removeObserver:name:object:1[[NSNotificationCenter defaultCenter] removeObserver:self name:NotificationCitySelect object:nil] Âà†Èô§ÊåáÂÆönameÁöÑÈÄöÁü•„ÄÇ ÂèëÈÄÅÊúâ‰∏âÁßçÂèëÈÄÅÊñπÂºèÔºö 123- (void)postNotification:(NSNotification *)notification;- (void)postNotificationName:(NSNotificationName)aName object:(nullable id)anObject;- (void)postNotificationName:(NSNotificationName)aName object:(nullable id)anObject userInfo:(nullable NSDictionary *)aUserInfo; ÂÖ∂‰∏≠ aUserInfo ÊòØÂèëÈÄÅÁöÑÈÄöÁü•ÈúÄË¶Å‰º†ÈÄíÁªôÊé•ÂèóËÄÖÁöÑ‰ø°ÊÅØ„ÄÇÈÇ£‰πàËøô‰∏™‰ø°ÊÅØÊÄé‰πàÂèñÂæóÂë¢ÔºüÊàë‰ª¨Áúã‰∏Ä‰∏ã NSNotification ÁöÑÊï∞ÊçÆÁªìÊûÑÔºö 12345@interface NSNotification : NSObject @property (readonly, copy) NSNotificationName name;@property (nullable, readonly, retain) id object;@property (nullable, readonly, copy) NSDictionary *userInfo; ‰∏äÈù¢ addObserver ÁöÑÊó∂ÂÄôÔºåÊó†ËÆ∫ÊòØÁî® selector ËøòÊòØ blockÔºåÈÉΩÂ∞Ü NSNotification ÂÆû‰æã‰º†ÂÖ•‰∫ÜÔºåÂèØ‰ª•Áõ¥Êé•Ëé∑Âèñ userInfo ‰ø°ÊÅØ„ÄÇ 1[[NSNotificationCenter defaultCenter] postNotificationName:NotificationCitySelectChanged object:@&#123;NotificationCitySelect_ObjectLocationChange:@(YES)&#125;] ÂèëÈÄÅÊåáÂÆöobjcetÁöÑÈÄöÁü•ÔºåÂè™ÊúâÊ≥®ÂÜåÊó∂Ê≥®ÂÜå‰∫ÜËØ•ÂØπË±°ÁöÑÈÄöÁü•ÊâçÂèØ‰ª•Êé•Êî∂ÔºàÂç≥Ê≥®ÂÜåÁöÑÊó∂ÂÄôÁöÑ object Ë¶ÅÂÜôÁöÑÂíåËøôÈáåÁöÑ‰∏ÄÊ†∑„ÄÇname Âíå object ÈÉΩÊòØÁî®Êù•ÂèñÂå∫ÂàÜÈÄöÁü•ÁöÑÔºâ„ÄÇ ÂÖ≥‰∫é Notification Âú®Âì™ËÆæÁΩÆNotification ÊúÄÂ•ΩÂú® viewDidAppear ‰∏≠Ê≥®ÂÜåÔºåÂú® viewDidDisappear ‰∏≠ÁßªÈô§ÔºåÂç≥Âú®È°µÈù¢ÊòæÁ§∫ÁöÑÊó∂ÂÄôÊé•Êî∂ÈÄöÁü•„ÄÇÂÆûÂú®ÈúÄË¶ÅÈ°µÈù¢‰∏çÊòæÁ§∫ÁöÑÊó∂ÂÄô‰πüËÉΩÊé•Âà∞ÈÄöÁü•ÁöÑËØùÂ∞±Âè™ËÉΩÂú® init Âíå dealloc ‰∏≠ÂÅöÊ∑ªÂä†Âà†Èô§‰∫ÜÔºàdealloc ‰∏≠ remove ‰∏ç‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊ≥ÑÊºèÔºåNotification ‰∏≠ÁöÑ Observer ‰∏çÊòØ strongÔºåÊâÄ‰ª•‰∏ç‰ºöËÆ©ÂºïÁî®+1Ôºå‰ΩÜÊòØÂøÖÈ°ª remove ‰∏çÁÑ∂‰ºö‰∫ßÁîüÈáéÊåáÈíàÂØºËá¥Â¥©Ê∫ÉÔºâÁî±‰∫é viewDidAppear Âíå viewDidDisappear ‰∏çÊòØÊàêÂØπÂá∫Áé∞ÁöÑÔºåÈúÄË¶ÅÂú® viewDidAppear Ê≥®ÂÜåÈÄöÁü•ÂâçÂÖàÁßªÈô§‰∏Ä‰∏ãËØ•ÈÄöÁü•„ÄÇ ÈÄöËøáÊâãÂäøÊìç‰Ωú VC ÂèØ‰ª•ËÆ© viewDidAppear Ë∞ÉÁî®Êó†Êï∞Ê¨°Ôºå‰ΩÜ viewDidDisappear ‰∏ÄÊ¨°‰πü‰∏çËß¶Âèë„ÄÇ NSNotificationCenterÁöÑÂÆûÁé∞NSNotificationCenter ÁöÑÂÆûÁé∞ÂéüÁêÜÊòØËßÇÂØüËÄÖÊ®°ÂºèÔºåÁî®‰∫éÁõëÂê¨Êìç‰Ωú„ÄÇÊàë‰ª¨ÂèØ‰ª•ÁÆÄÂçïÂú∞ËÆ§‰∏∫ NSNotificationCenter Â∞±ÊòØÁª¥Êä§‰∏Ä‰∏™ NSMutableDictionaryÔºåkey ÊòØÁî± name Âíå sender ÁîüÊàêÁöÑ notification objectÔºåÊØîÂ¶Ç NSNotificationÔºåvalue ÊòØÂêë observer ÂèëÈÄÅÁöÑ selector„ÄÇÂèëÈÄÅÈÄöÁü•Â∞±ÊòØÂú®Â≠óÂÖ∏‰∏≠ÊâæÂà∞Áõ∏Â∫îÊñπÊ≥ïÊâßË°å„ÄÇ ËøôÂ∞±Ëß£Èáä‰∫Ü‰∏∫‰ªÄ‰πà‰∏ÄÂÆöË¶ÅÂú®ÂØπË±°ÂõûÊî∂Êó∂ removeObserver„ÄÇÂõ†‰∏∫Âú® notificationCenter ‰∏≠ÔºåÂØπË±°ÈÉΩÊòØÂº±ÂºïÁî®ÁöÑ„ÄÇÂΩìÂØπË±°ÂõûÊî∂ÂêéÔºånotificationCenter ‰∏≠‰øùÂ≠òÁöÑÂºïÁî®Â∞±‰ºöÁΩÆ‰∏∫ nilÔºåÂ∞±‰ºöÂèëÁîüÈÄöÁü•ÂèëÂêë‰∏Ä‰∏™ nil Á±ªÁöÑÊÉÖÂÜµÔºåÂØºËá¥ App Â¥©Ê∫É„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>NSNotification</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UILabelÈ´òÂ∫¶ÊéßÂà∂]]></title>
    <url>%2F2016%2F09%2F12%2FUILabel%E7%9A%84%E9%AB%98%E5%BA%A6%E8%AE%A1%E7%AE%97%2F</url>
    <content type="text"><![CDATA[Âú®tableviewËá™ÈÄÇÂ∫îÈ´òÂ∫¶‰∏ÄÁØá‰∏≠Â≠¶‰π†‰∫ÜÂ¶Ç‰ΩïÁî®systemLayoutSizeFittingSize:ÊñπÊ≥ïÂæóÂà∞UITableViewÁöÑCellÁöÑÈ´òÂ∫¶„ÄÇÊú¨ÊñáÂ∞ÜÊé¢Á©∂‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÂ¶Ç‰ΩïÂæóÂà∞UILabelÁöÑÈ´òÂ∫¶„ÄÇ sizeThatFitsÁöÑ‰ΩøÁî®sizeThatFitsÊòØUIView‰∏≠ÁöÑÊñπÊ≥ïÔºö1- (CGSize)sizeThatFits:(CGSize)size; ÂÆòÊñπÊñáÊ°£ÁöÑÊ≥®ÈáäÔºö return ‚Äòbest‚Äô size to fit given size. does not actually resize view. Default is return existing view size‰πüÂ∞±ÊòØËØ¥ÔºåËØ•ÊñπÊ≥ïÂ∞Ü‰ºöÊ†πÊçÆ‰º†ÂÖ•ÁöÑsize,ËÆ°ÁÆóÂæóÂà∞ÊúÄ‰Ω≥ÁöÑUIViewÁöÑÂÆΩÈ´òÔºåÁõ¥Êé•ËøîÂõûÔºå‰∏çÂØπViewÂÅö‰ªª‰Ωï‰øÆÊîπ„ÄÇ UILabel‰ºöÊ†πÊçÆ‰º†ÂÖ•ÁöÑsizeÁöÑwidthËá™Âä®Êç¢Ë°åÔºåÂæóÂà∞heightÂêéÔºåÂ∞ÜËøô‰∏§‰∏™ÂÄº‰Ωú‰∏∫‰º∞ÁÆóÂá∫ÁöÑCGSizeËøîÂõû„ÄÇÂ¶ÇÊûú‰º†ÂÖ•ÁöÑÊòØCGSizeZeroÁõ∏ÂΩì‰∫é‰∏çËÆæÁΩÆÊç¢Ë°åÂÆΩÂ∫¶Ôºå‰∏ÄË°åÂà∞Â∫ï„ÄÇ Áî±‰∫éSizeThatFitsÂè™‰º∞ÁÆóÔºå‰∏ç‰øÆÊîπ„ÄÇÂú®ÂæóÂà∞‰º∞ÁÆóÂÄºÂêéÔºåÈúÄË¶ÅÊâãÂä®ËÆæÁΩÆUILabelÁöÑframeÊàñËÄÖconstraintÔºö1234567891011- (void) useSizeThatFitsZeroWithLabel:(UILabel *)label&#123; //‰ΩøÁî®CGSizeZeroÁõ∏ÂΩì‰∫é‰∏çËÆæÁΩÆÊç¢Ë°åÂÆΩÂ∫¶Ôºå‰∏ÄË°åÂà∞Â∫ï CGSize size = [label sizeThatFits:CGSizeZero]; label.frame = CGRectMake(label.frame.origin.x, label.frame.origin.y, size.width, size.height);&#125;- (void) useSizeThatFitsCustomWithLabel:(UILabel *)label&#123; //‰ΩøÁî®Ëá™ÂÆö‰πâÁöÑCGSizeÔºå‰ºöÊ†πÊçÆsizeÁöÑÂÆΩÂ∫¶ËøõË°åÊç¢Ë°å CGSize size = [label sizeThatFits:CGSizeMake(50, 50)]; label.frame = CGRectMake(label.frame.origin.x, label.frame.origin.y, size.width, size.height);&#125; SizeToFitSizeToFitÁöÑÊñπÊ≥ïÔºö1- (void)sizeToFit; SizeToFitÁöÑÊñáÊ°£Ê≥®ÈáäÔºö calls sizeThatFits: with current view bounds and changes bounds size.‰πüÂ∞±ÊòØËØ¥ÔºåÂÆÉ‰ºöË∞ÉÁî®SizeThatFits,Âπ∂‰∏îÁõ¥Êé•ËÆæÁΩÆViewÁöÑbounds„ÄÇ Êó¢ÁÑ∂Ë¶ÅË∞ÉÁî®sizeThatFitsÈÇ£Â∞±ÈúÄË¶Å‰º†ÂÖ•‰∏Ä‰∏™CGSize„ÄÇËøô‰∏™CGSizeÂ∞±ÊòØËÆæÁΩÆViewÁöÑframeÊó∂‰º†ÂÖ•ÁöÑheight,width„ÄÇ boundingRectWithSizeboundingRectWithSize ÂÖ∂ÂÆûÂíå‰∏äÈù¢ÁöÑÊñπÊ≥ïÂ∑Æ‰∏çÂ§öÔºå‰ΩÜÊòØÂâçÈù¢ÁöÑÊñπÊ≥ïÈúÄË¶ÅÊãøÂà∞ label ÁöÑÂÆû‰æã„ÄÇ‰∏ãÈù¢Ëøô‰∏™ÊñπÊ≥ïÂàôÊòØÈÄöËøá String Áõ¥Êé•ËÆ°ÁÆóÁöÑÔºö 1234NSString *text = @"Today is a fine day";UIFont *font = [UIFont systemFontOfSize:30];CGRect suggestedRect = [text boundingRectWithSize:CGSizeMake(800, MAXFLOAT) options:NSStringDrawingUsesFontLeading attributes:@&#123; NSFontAttributeName : font &#125; context:nil];NSLog(@"size = %@", NSStringFromCGSize(suggestedRect.size));]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>UI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptÂü∫Êú¨ËØ≠Ê≥ï]]></title>
    <url>%2F2016%2F09%2F09%2FJavaScript%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%2F</url>
    <content type="text"><![CDATA[JS ÁöÑËØ≠Ê≥ïÔºåÂèÇËÄÉ‰∫ÜÂªñÈõ™Â≥∞ÁöÑÂçöÂÆ¢‰ª•ÂèäÈòÆ‰∏ÄÂ≥∞ÁöÑES6 Âü∫Á°ÄËØ≠Ê≥ïÊï∞ÊçÆÁ±ªÂûãÂíåÂèòÈáèNumberJS‰∏çÂå∫ÂàÜÊï¥Êï∞ÊµÆÁÇπÊï∞ÔºåÁªü‰∏ÄÁî®NumberË°®Á§∫Ôºö1231.2345e3; // ÁßëÂ≠¶ËÆ°Êï∞Ê≥ïË°®Á§∫1.2345x1000ÔºåÁ≠âÂêå‰∫é1234.5NaN; // NaNË°®Á§∫Not a NumberÔºåÂΩìÊó†Ê≥ïËÆ°ÁÆóÁªìÊûúÊó∂Áî®NaNË°®Á§∫Infinity; // InfinityË°®Á§∫Êó†ÈôêÂ§ßÔºåÂΩìÊï∞ÂÄºË∂ÖËøá‰∫ÜJavaScriptÁöÑNumberÊâÄËÉΩË°®Á§∫ÁöÑÊúÄÂ§ßÂÄºÊó∂ÔºåÂ∞±Ë°®Á§∫‰∏∫Infinity NumberÂèØ‰ª•Áõ¥Êé•ËøêÁÆóÔºö12345(1 + 2) * 5 / 2; // 7.52 / 0; // Infinity0 / 0; // NaN10 % 3; // 1 (Âèñ‰Ωô)10.5 % 3; // 1.5 Â≠óÁ¨¶‰∏≤‰ª•ÂçïÂºïÂè∑&#39;ÊàñÂèåÂºïÂè∑&quot;Êã¨Ëµ∑Êù•ÁöÑ‰ªªÊÑèÊñáÊú¨.Â¶Ç&#39;abc&#39; Â∏ÉÂ∞îÂÄºÁî®trueÂíåfalseË°®Á§∫„ÄÇ ÊØîËæÉËøêÁÆóÁ¨¶JavaScriptÂú®ËÆæËÆ°Êó∂ÔºåÊúâ‰∏§ÁßçÊØîËæÉËøêÁÆóÁ¨¶ÔºöÁ¨¨‰∏ÄÁßçÊòØ==ÊØîËæÉÔºåÂÆÉ‰ºöËá™Âä®ËΩ¨Êç¢Êï∞ÊçÆÁ±ªÂûãÂÜçÊØîËæÉ.Á¨¨‰∫åÁßçÊòØ===ÊØîËæÉÔºåÂÆÉ‰∏ç‰ºöËá™Âä®ËΩ¨Êç¢Êï∞ÊçÆÁ±ªÂûãÔºåÂ¶ÇÊûúÊï∞ÊçÆÁ±ªÂûã‰∏ç‰∏ÄËá¥ÔºåËøîÂõûfalseÔºåÂ¶ÇÊûú‰∏ÄËá¥ÔºåÂÜçÊØîËæÉ„ÄÇ Â¶ÇÊûúÊòØÊØîËæÉÁ±ªÂØπË±°ÔºåÂ∞±ÊòØÊØîËæÉ‰∏§ËÄÖÁöÑÂú∞ÂùÄ„ÄÇÂ¶ÇÊûúÂú∞ÂùÄ‰∏çÂêåÔºå== Âíå === ÈÉΩËøîÂõû false„ÄÇ NaNËøô‰∏™ÁâπÊÆäÁöÑNumber‰∏éÊâÄÊúâÂÖ∂‰ªñÂÄºÈÉΩ‰∏çÁõ∏Á≠âÔºåÂåÖÊã¨ÂÆÉËá™Â∑±Ôºö12NaN == NaN; // falseNaN === NaN; // false ÂîØ‰∏ÄËÉΩÂà§Êñ≠NaNÁöÑÊñπÊ≥ïÊòØÈÄöËøáisNaN()ÂáΩÊï∞Ôºö1isNaN(NaN); // true ÊµÆÁÇπÊï∞Âú®ËøêÁÆóËøáÁ®ã‰∏≠‰ºö‰∫ßÁîüËØØÂ∑ÆÔºåÂõ†‰∏∫ËÆ°ÁÆóÊú∫Êó†Ê≥ïÁ≤æÁ°ÆË°®Á§∫Êó†ÈôêÂæ™ÁéØÂ∞èÊï∞„ÄÇË¶ÅÊØîËæÉ‰∏§‰∏™ÊµÆÁÇπÊï∞ÊòØÂê¶Áõ∏Á≠âÔºåÂè™ËÉΩËÆ°ÁÆóÂÆÉ‰ª¨‰πãÂ∑ÆÁöÑÁªùÂØπÂÄºÔºåÁúãÊòØÂê¶Â∞è‰∫éÊüê‰∏™ÈòàÂÄºÔºö1Math.abs(1 / 3 - (1 - 2 / 3)) &lt; 0.0000001; // true Êï∞ÁªÑJavaScriptÁöÑÊï∞ÁªÑÂèØ‰ª•ÂåÖÊã¨‰ªªÊÑèÊï∞ÊçÆÁ±ªÂûã„ÄÇ‰æãÂ¶ÇÔºö1[1, 2, 3.14, 'Hello', null, true]; Âè¶‰∏ÄÁßçÂàõÂª∫Êï∞ÁªÑÁöÑÊñπÊ≥ïÊòØÈÄöËøáArray()ÂáΩÊï∞ÂÆûÁé∞Ôºö1new Array(1, 2, 3); // ÂàõÂª∫‰∫ÜÊï∞ÁªÑ[1, 2, 3] ÁÑ∂ËÄåÔºåÂá∫‰∫é‰ª£Á†ÅÁöÑÂèØËØªÊÄßËÄÉËôëÔºåÂº∫ÁÉàÂª∫ËÆÆÁõ¥Êé•‰ΩøÁî®[]„ÄÇ Êï∞ÁªÑÁöÑÂÖÉÁ¥†ÂèØ‰ª•ÈÄöËøáÁ¥¢ÂºïÊù•ËÆøÈóÆ„ÄÇÁ¥¢ÂºïÁöÑËµ∑ÂßãÂÄº‰∏∫0Ôºö1234var arr = [1, 2, 3.14, 'Hello', null, true];arr[0]; // ËøîÂõûÁ¥¢Âºï‰∏∫0ÁöÑÂÖÉÁ¥†ÔºåÂç≥1arr[5]; // ËøîÂõûÁ¥¢Âºï‰∏∫5ÁöÑÂÖÉÁ¥†ÔºåÂç≥truearr[6]; // Á¥¢ÂºïË∂ÖÂá∫‰∫ÜËåÉÂõ¥ÔºåËøîÂõûundefined ÂØπË±°JavaScriptÁöÑÂØπË±°ÊòØ‰∏ÄÁªÑÁî±ÈîÆ-ÂÄºÁªÑÊàêÁöÑÊó†Â∫èÈõÜÂêàÔºå‰æãÂ¶ÇÔºö12345678var person = &#123; name: 'Bob', age: 20, tags: ['js', 'web', 'mobile'], city: 'Beijing', hasCar: true, zipcode: null&#125;; JavaScriptÂØπË±°ÁöÑÈîÆÈÉΩÊòØÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºåÂÄºÂèØ‰ª•ÊòØ‰ªªÊÑèÊï∞ÊçÆÁ±ªÂûã„ÄÇ Ë¶ÅËé∑Âèñ‰∏Ä‰∏™ÂØπË±°ÁöÑÂ±ûÊÄßÔºåÂèØ‰ª•Áî®‰∏Ä‰∏ã‰∏§ÁßçÊñπÂºèÔºö1234567person.name; // 'Bob'person.zipcode; // nullfunction getName() &#123; return 'name'&#125;person[getName()] ÂèòÈáè‰∏éÂ∏∏ÈáèES6 ‰πãÂâçÔºåÂèòÈáèÁî® var ‰øÆÈ•∞Ôºå‰ΩÜÊòØ‰ºöÂºïËµ∑ÈóÆÈ¢òÔºåÂåÖÊã¨‰ΩúÁî®ÂüüÈóÆÈ¢ò‰∏éÂèòÈáèÊèêÂçáÈóÆÈ¢ò„ÄÇ‰ΩøÁî® let ‰ª£Êõø„ÄÇ1let b = 1; // Áî≥Êòé‰∫ÜÂèòÈáè$bÔºåÂêåÊó∂Áªô$bËµãÂÄºÔºåÊ≠§Êó∂$bÁöÑÂÄº‰∏∫1 ES6 ‰πãÂêéÔºåÂ∏∏ÈáèÁî® const ‰øÆÈ•∞ÔºåË°®Á§∫‰∏ç‰ºöÂÜçÊîπÂèòÁöÑÂÄºÔºö 1const b = '234' Swift ‰∏≠ÂèòÈáè‰∏∫ var Â∏∏Èáè‰∏∫ let Áï•Êúâ‰∏çÂêå„ÄÇ Â≠óÁ¨¶‰∏≤Ê®°ÊùøÂ≠óÁ¨¶‰∏≤Ë¶ÅÊääÂ§ö‰∏™Â≠óÁ¨¶‰∏≤ËøûÊé•Ëµ∑Êù•ÔºåÂèØ‰ª•Áî®+Âè∑ËøûÊé•Ôºö1234var name = 'Â∞èÊòé';var age = 20;var message = '‰Ω†Â•Ω, ' + name + ', ‰Ω†‰ªäÂπ¥' + age + 'Â≤Å‰∫Ü!';alert(message); Â¶ÇÊûúÊúâÂæàÂ§öÂèòÈáèÈúÄË¶ÅËøûÊé•ÔºåÁî®+Âè∑Â∞±ÊØîËæÉÈ∫ªÁÉ¶„ÄÇES6Êñ∞Â¢û‰∫Ü‰∏ÄÁßçÊ®°ÊùøÂ≠óÁ¨¶‰∏≤ÔºåË°®Á§∫ÊñπÊ≥ïÂíå‰∏äÈù¢ÁöÑÂ§öË°åÂ≠óÁ¨¶‰∏≤‰∏ÄÊ†∑Ôºå‰ΩÜÊòØÂÆÉ‰ºöËá™Âä®ÊõøÊç¢Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂèòÈáèÔºö1234var name = 'Â∞èÊòé';var age = 20;var message = `‰Ω†Â•Ω, $&#123;name&#125;, ‰Ω†‰ªäÂπ¥$&#123;age&#125;Â≤Å‰∫Ü!`;alert(message); Ê≥®ÊÑèËøôÈáå‰∏çÂè™ÊòØ ${} Â§ñËæπÁöÑ‰∏çÂÜçÊòØÂçïÂºïÂè∑‰∫ÜÔºåËÄåÊòØ ` `„ÄÇ Âú® Swift ‰∏≠ÊúâÁ±ª‰ººÁöÑÊ®°ÊùøÂ≠óÁ¨¶‰∏≤Ôºö\(Ë¶ÅÊâìÂç∞ÁöÑÂØπË±°)ÔºåÁ±ª‰ºº‰∫éËøôÈáåÁöÑ${}„ÄÇ‰∏çËøá Swift ÂÜôËµ∑Êù•ÊØîËøô‰∏™Â•ΩÁÆÄÂçïÂ•ΩËÆ∞Â§ö‰∫Ü„ÄÇ Êìç‰ΩúÂ≠óÁ¨¶‰∏≤Â≠óÁ¨¶‰∏≤Â∏∏ËßÅÁöÑÊìç‰ΩúÂ¶Ç‰∏ãÔºö1234var s = 'Hello, world!';s.length; // 13s[7]; // 'w's[12]; // '!' Â≠óÁ¨¶‰∏≤Áõ∏ÂΩì‰∫éÊòØ‰∏Ä‰∏™‰∏çËÉΩÊîπÂèòÁöÑÊï∞ÁªÑ„ÄÇ indexOfindexOf()‰ºöÊêúÁ¥¢ÊåáÂÆöÂ≠óÁ¨¶‰∏≤Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ:123var s = 'hello, world';s.indexOf('world'); // ËøîÂõû7s.indexOf('World'); // Ê≤°ÊúâÊâæÂà∞ÊåáÂÆöÁöÑÂ≠ê‰∏≤ÔºåËøîÂõû-1 substringsubstring()ËøîÂõûÊåáÂÆöÁ¥¢ÂºïÂå∫Èó¥ÁöÑÂ≠ê‰∏≤Ôºö123var s = 'hello, world's.substring(0, 5); // ‰ªéÁ¥¢Âºï0ÂºÄÂßãÂà∞5Ôºà‰∏çÂåÖÊã¨5ÔºâÔºåËøîÂõû'hello's.substring(7); // ‰ªéÁ¥¢Âºï7ÂºÄÂßãÂà∞ÁªìÊùüÔºåËøîÂõû'world' Êï∞ÁªÑÂ±ïÂºÄËøêÁÆóÁ¨¶Â±ïÂºÄËøêÁÆóÁ¨¶‰ΩøÁî® ... Â∞Ü‰∏Ä‰∏™Êï∞ÁªÑËΩ¨‰∏∫Áî®ÈÄóÂè∑ÂàÜÈöîÁöÑÂèÇÊï∞Â∫èÂàóÔºö 123console.log(1, ...[2, 3, 4], 5)// Áõ∏ÂΩì‰∫é =&gt;// console.log(1, 2, 3, 4, 5) lengthË¶ÅÂèñÂæóArrayÁöÑÈïøÂ∫¶ÔºåÁõ¥Êé•ËÆøÈóÆlengthÂ±ûÊÄßÔºö12var arr = [1, 2, 3.14, 'Hello', null, true];arr.length; // 6 indexOf‰∏éStringÁ±ª‰ººÔºåArray‰πüÂèØ‰ª•ÈÄöËøáindexOf()Êù•ÊêúÁ¥¢‰∏Ä‰∏™ÊåáÂÆöÁöÑÂÖÉÁ¥†ÁöÑ‰ΩçÁΩÆÔºö12345var arr = [10, 20, '30', 'xyz'];arr.indexOf(10); // ÂÖÉÁ¥†10ÁöÑÁ¥¢Âºï‰∏∫0arr.indexOf(20); // ÂÖÉÁ¥†20ÁöÑÁ¥¢Âºï‰∏∫1arr.indexOf(30); // ÂÖÉÁ¥†30Ê≤°ÊúâÊâæÂà∞ÔºåËøîÂõû-1arr.indexOf('30'); // ÂÖÉÁ¥†'30'ÁöÑÁ¥¢Âºï‰∏∫2 ‰∏áËÉΩÊñπÊ≥ï splice‰∏∫Êï∞ÁªÑÊ∑ªÂä†ÂíåÂà†Èô§ÂÖÉÁ¥†ÊúâÂæàÂ§öÊñπÊ≥ïÔºåÂåÖÊã¨ pushÔºåpopÔºåunshiftÔºåshiftÔºåsliceÔºåconcat„ÄÇËøô‰∫õÈÉΩÂèØ‰ª•‰ΩøÁî® splice ‰ª£ÊõøÔºö 12345678910var arr = ['Microsoft', 'Apple', 'Yahoo', 'AOL', 'Excite', 'Oracle'];// ‰ªéÁ¥¢Âºï2ÂºÄÂßãÂà†Èô§3‰∏™ÂÖÉÁ¥†,ÁÑ∂ÂêéÂÜçÊ∑ªÂä†‰∏§‰∏™ÂÖÉÁ¥†:arr.splice(2, 3, 'Google', 'Facebook'); // ËøîÂõûÂà†Èô§ÁöÑÂÖÉÁ¥† ['Yahoo', 'AOL', 'Excite']arr; // ['Microsoft', 'Apple', 'Google', 'Facebook', 'Oracle']// Âè™Âà†Èô§,‰∏çÊ∑ªÂä†:arr.splice(2, 2); // ['Google', 'Facebook']arr; // ['Microsoft', 'Apple', 'Oracle']// Âè™Ê∑ªÂä†,‰∏çÂà†Èô§:arr.splice(2, 0, 'Google', 'Facebook'); // ËøîÂõû[],Âõ†‰∏∫Ê≤°ÊúâÂà†Èô§‰ªª‰ΩïÂÖÉÁ¥†arr; // ['Microsoft', 'Apple', 'Google', 'Facebook', 'Oracle'] Á¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØËµ∑ÂßãÁ¥¢Âºï(‰ªé0ÂºÄÂßã)ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÂà†Èô§ÂÖÉÁ¥†‰∏™Êï∞„ÄÇÂêéÈù¢ÁöÑÂèÇÊï∞ÊòØË¶ÅÊ∑ªÂä†ÁöÑÂÖÉÁ¥†„ÄÇ joinjoin ÊñπÊ≥ïÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÂÆûÁî®ÁöÑÊñπÊ≥ïÔºåÁî®‰∫éÂΩìÂâçArrayÁöÑÊØè‰∏™ÂÖÉÁ¥†ÈÉΩÁî®ÊåáÂÆöÁöÑÂ≠óÁ¨¶‰∏≤ËøûÊé•Ëµ∑Êù•ÔºåÁÑ∂ÂêéËøîÂõûËøûÊé•ÂêéÁöÑÂ≠óÁ¨¶‰∏≤Ôºö 12var arr = ['A', 'B', 'C', 1, 2, 3];arr.join('-'); // 'A-B-C-1-2-3' Êï∞ÁªÑÁöÑÈ´òÈò∂ÂáΩÊï∞mapmap()ÊñπÊ≥ïÂÆö‰πâÂú®JavaScriptÁöÑArray‰∏≠ÔºåÊàë‰ª¨Ë∞ÉÁî®ArrayÁöÑmap()ÊñπÊ≥ïÔºå‰º†ÂÖ•Êàë‰ª¨Ëá™Â∑±ÁöÑÂáΩÊï∞ÔºåÂ∞±ÂæóÂà∞‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑArray‰Ωú‰∏∫ÁªìÊûúÔºö 123456function pow(x) &#123; return x * x;&#125;var arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];arr.map(pow); // [1, 4, 9, 16, 25, 36, 49, 64, 81] map()Â∞Ü‰º†ÂÖ•ÁöÑÂáΩÊï∞‰∏Ä‰∏Ä‰ΩúÁî®Âú®Êï∞ÁªÑÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†‰∏ä„ÄÇ reduceArrayÁöÑreduce()Êää‰∏Ä‰∏™ÂáΩÊï∞‰ΩúÁî®Âú®Ëøô‰∏™ArrayÁöÑ[x1, x2, x3...]‰∏äÔºåËøô‰∏™ÂáΩÊï∞ÂøÖÈ°ªÊé•Êî∂‰∏§‰∏™ÂèÇÊï∞Ôºåreduce()ÊääÁªìÊûúÁªßÁª≠ÂíåÂ∫èÂàóÁöÑ‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†ÂÅöÁ¥ØÁßØËÆ°ÁÆóÔºåÂÖ∂ÊïàÊûúÂ∞±ÊòØÔºö 1[x1, x2, x3, x4].reduce(f) = f(f(f(x1, x2), x3), x4) ÊØîÂ¶ÇÂØπArrayÊ±ÇÂíåÔºö 1234var arr = [1, 3, 5, 7, 9];arr.reduce(function (x, y) &#123; return x + y;&#125;); // 25 filterÁî®‰∫éÊääArrayÁöÑÊüê‰∫õÂÖÉÁ¥†ËøáÊª§ÊéâÔºåÁÑ∂ÂêéËøîÂõûÂâ©‰∏ãÁöÑÂÖÉÁ¥†ArrayÁöÑfilter()Êé•Êî∂‰∏Ä‰∏™ÂáΩÊï∞,Êää‰º†ÂÖ•ÁöÑÂáΩÊï∞‰æùÊ¨°‰ΩúÁî®‰∫éÊØè‰∏™ÂÖÉÁ¥†ÔºåÁÑ∂ÂêéÊ†πÊçÆËøîÂõûÂÄºÊòØtrueËøòÊòØfalseÂÜ≥ÂÆö‰øùÁïôËøòÊòØ‰∏¢ÂºÉËØ•ÂÖÉÁ¥†„ÄÇ ‰æãÂ¶ÇÔºåÂú®‰∏Ä‰∏™Array‰∏≠ÔºåÂà†ÊéâÂÅ∂Êï∞ÔºåÂè™‰øùÁïôÂ•áÊï∞ÔºåÂèØ‰ª•Ëøô‰πàÂÜôÔºö 12345var arr = [1, 2, 4, 5, 6, 9, 10, 15];var r = arr.filter(function (x) &#123; return x % 2 !== 0;&#125;);r; // [1, 5, 9, 15] sortÂèØ‰ª•Êé•Êî∂‰∏Ä‰∏™ÊØîËæÉÂáΩÊï∞Êù•ÂÆûÁé∞Ëá™ÂÆö‰πâÁöÑÊéíÂ∫èË¶ÅÊåâÊï∞Â≠óÂ§ßÂ∞èÊéíÂ∫èÔºåÊàë‰ª¨ÂèØ‰ª•Ëøô‰πàÂÜôÔºö 12345678910var arr = [10, 20, 1, 2];arr.sort(function (x, y) &#123; if (x &lt; y) &#123; return -1; &#125; if (x &gt; y) &#123; return 1; &#125; return 0;&#125;); // [1, 2, 10, 20] Ê≥®ÊÑèÔºösort()ÊñπÊ≥ï‰ºöÁõ¥Êé•ÂØπArrayËøõË°å‰øÆÊîπÔºåÂÆÉËøîÂõûÁöÑÁªìÊûú‰ªçÊòØÂΩìÂâçArray ÂØπË±°Âü∫Êú¨‰ΩøÁî®Áé∞Âú® ES6 ‰∏≠Êúâ‰∫Ü classÔºåÊàëËßâÂæóÁé∞Âú®ÂØπË±°Êõ¥ÂÉèÊòØÁªìÊûÑ‰Ωì„ÄÇ ÂÆö‰πâÊñπÂºèÂ¶Ç‰∏ãÔºö 123var xiaohong = &#123; name: 'Â∞èÁ∫¢',&#125;; Ëé∑ÂèñÂàÜ‰∏∫‰∏§ÁßçÂΩ¢ÂºèÔºåÁÇπËØ≠Ê≥ïÂíå[]ËØ≠Ê≥ïÔºö12xiaohong.name; // 'Â∞èÁ∫¢'xiaohong['name']; // 'Â∞èÁ∫¢' Áî±‰∫éJavaScriptÁöÑÂØπË±°ÊòØÂä®ÊÄÅÁ±ªÂûãÔºå‰Ω†ÂèØ‰ª•Ëá™Áî±Âú∞Áªô‰∏Ä‰∏™ÂØπË±°Ê∑ªÂä†ÊàñÂà†Èô§Â±ûÊÄßÔºö1234567891011var xiaoming = &#123; name: 'Â∞èÊòé'&#125;;xiaoming.age; // undefinedxiaoming.age = 18; // Êñ∞Â¢û‰∏Ä‰∏™ageÂ±ûÊÄßxiaoming.age; // 18delete xiaoming.age; // Âà†Èô§ageÂ±ûÊÄßxiaoming.age; // undefineddelete xiaoming['name']; // Âà†Èô§nameÂ±ûÊÄßxiaoming.name; // undefineddelete xiaoming.school; // Âà†Èô§‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑschoolÂ±ûÊÄß‰πü‰∏ç‰ºöÊä•Èîô Â¶ÇÊûúÊàë‰ª¨Ë¶ÅÊ£ÄÊµãxiaomingÊòØÂê¶Êã•ÊúâÊüê‰∏ÄÂ±ûÊÄßÔºåÂèØ‰ª•Áî®inÊìç‰ΩúÁ¨¶ÔºåËá™Â∑±ÁöÑÂíåÁªßÊâøÁöÑÈÉΩ‰ºöËøîÂõû trueÔºö12'name' in xiaoming; // true'toString' in xiaoming; // true Ë¶ÅÂà§Êñ≠‰∏Ä‰∏™Â±ûÊÄßÊòØÂê¶ÊòØxiaomingËá™Ë∫´Êã•ÊúâÁöÑÔºåËÄå‰∏çÊòØÁªßÊâøÂæóÂà∞ÁöÑÔºåÂèØ‰ª•Áî®hasOwnProperty()ÊñπÊ≥ïÔºö12345var xiaoming = &#123; name: 'Â∞èÊòé'&#125;;xiaoming.hasOwnProperty('name'); // truexiaoming.hasOwnProperty('toString'); // false ÂØπË±°ÁöÑÂ±ûÊÄßÂêçÂ±ûÊÄßÂêç‰∏∫ÊñπÊ≥ïËøîÂõûÂÄºJS ‰∏≠Â±ûÊÄßÂøÖÈ°ªË¶ÅÊòØÂ≠óÁ¨¶‰∏≤ÂûãÁöÑÔºå‰∏çËøá‰Ω†‰πüÂèØ‰ª•‰ΩøÁî®ÊñπÊ≥ïÁöÑËøîÂõûÂÄºÂä®ÊÄÅÁöÑËÆæÁΩÆÂ±ûÊÄßÂêçÔºö 123456789101112131415const Birth = &#123; birth: 'birth'&#125;const Person = &#123; name: 'Âº†‰∏â', //Á≠âÂêå‰∫ébirth: birth [Birth.birth]: '94-4-15', // Á≠âÂêå‰∫éhello: function ()... hello() &#123; console.log('ÊàëÁöÑÂêçÂ≠óÊòØ', this.name); &#125;&#125;; Â±ûÊÄßÁöÑÁÆÄÂÜôES6 ‰∏≠ÂÖÅËÆ∏ÂàõÂª∫ÂØπË±°ÁöÑÊó∂ÂÄôÔºåÁÆÄÂÜôÂ±ûÊÄßÔºåÁõ¥Êé•‰ª•ÂèòÈáèÂêçÁß∞‰Ωú‰∏∫Â±ûÊÄßÂêç„ÄÇÊØîÂ¶ÇÔºö 12345678910111213let birth = '2000/01/01';const Person = &#123; name: 'Âº†‰∏â', //Á≠âÂêå‰∫ébirth: birth birth, // Á≠âÂêå‰∫éhello: function ()... hello() &#123; console.log('ÊàëÁöÑÂêçÂ≠óÊòØ', this.name); &#125;&#125;; prototypeÂú® ES6 ‰πãÂâçÔºåÊ≤°ÊúâÁ±ªÁöÑÊ¶ÇÂøµÔºåÂè™Êúâ‰∏Ä‰∏™‰∏™ÂáΩÊï∞ÔºåÈÄöËøá prototypeÂÆûÁé∞„ÄÇ prototype ÊòØÂáΩÊï∞ÁöÑÂ±ûÊÄßÔºåËøô‰∏™Â±ûÊÄßÊòØÊåáÂêë‰∏Ä‰∏™ÂØπË±°ÁöÑÂºïÁî®ÔºåËøô‰∏™ÂØπË±°Áß∞‰∏∫ÂéüÂûãÂØπË±°ÔºåÂéüÂûãÂØπË±°ÂåÖÂê´ÂáΩÊï∞ÂÆû‰æãÂÖ±‰∫´ÁöÑÊñπÊ≥ïÂíåÂ±ûÊÄßÔºå‰πüÂ∞±ÊòØËØ¥Â∞ÜÂáΩÊï∞Áî®‰ΩúÊûÑÈÄ†ÂáΩÊï∞Ë∞ÉÁî®Ôºà‰ΩøÁî®newÊìç‰ΩúÁ¨¶Ë∞ÉÁî®ÔºâÁöÑÊó∂ÂÄôÔºåÊñ∞ÂàõÂª∫ÁöÑÂØπË±°‰ºö‰ªéÂéüÂûãÂØπË±°‰∏äÁªßÊâøÂ±ûÊÄßÂíåÊñπÊ≥ï„ÄÇ ÊâÄ‰ª•ÔºåÂ¶ÇÊûúÊàë‰ª¨ÊÉ≥Ë¶Å new Âá∫Êù•ÁöÑÂØπË±°ËÉΩÂ§ü‰ΩøÁî®ÁöÑÂ±ûÊÄßÊàñËÄÖÊñπÊ≥ïÔºåÂ∞±Â∞ÜÂÆÉ‰ª¨ËµãÁªô prototype„ÄÇ Âè¶‰∏ÄÊñπÈù¢ÔºåÊúâ‰∏Ä‰∫õÂ±ûÊÄßÂíåÊñπÊ≥ïÂ∫îËØ•ÊòØÂ±û‰∫éÁ±ªÁöÑÔºåES6 ‰∏≠Áî® static Ê†áËØÜÔºåES6 ‰πãÂâçÂàôÁõ¥Êé•Â∞ÜÂÖ∂ËµãÂÄºÁªôÂáΩÊï∞ÔºåÂÆÉ‰ºöË¢´Âä†ËΩΩÂà∞ constructor ‰∏≠„ÄÇconstructor Êú¨Ë∫´‰πüÊòØ prototype ÁöÑ‰∏Ä‰∏™ÈªòËÆ§Â±ûÊÄß„ÄÇÂÖ∑‰Ωì‰æãÂ≠êÂ¶Ç‰∏ãÔºö new Person() ÂêéÁöÑÂÆû‰æãÂØπË±°ÔºåÈÉΩÂèØ‰ª•Ëé∑Âæó prototype ‰∏äÁöÑÂ±ûÊÄßÔºå‰ΩÜÊòØÂÖ∂‰∏≠‰∏Ä‰∏™ÂØπË±°ÊîπÂèòÂÖ∂ÂÄºÁöÑÊó∂ÂÄôÔºåÂè¶‰∏Ä‰∏™ÂØπË±°Áõ∏Â∫îÂ±ûÊÄßÂÄº‰∏çÂèò„ÄÇ prototype ‰∏≠ÁöÑÂ±ûÊÄßËÉΩÈöèÁùÄÂéüÂûãÈìæË¢´ÁªßÊâø‰∏ãÂéª„ÄÇ Object.assign()Ëøô‰∏™ÊñπÊ≥ïÊòØÈùûÂ∏∏ÊúâÁî®ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ï„ÄÇÁî®‰∫é‰∏∫ÂØπË±°Ê∑ªÂä†Â±ûÊÄßÔºåÊñπÊ≥ïÔºåÂÖãÈöÜÂØπË±°ÔºåÂêàÂπ∂ÂØπË±°„ÄÇÁ¨¨‰∏Ä‰∏™ÊòØÁõÆÊ†áÂØπË±°ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®Á©∫ÂØπË±°ÔºåÂêéÈù¢ÂØπË±°ÁöÑÂ±ûÊÄß‰ºöË¶ÜÁõñÂâçÈù¢ÂØπË±°ÁöÑÂ±ûÊÄßÔºö 1234567const target = &#123;&#125;;const source1 = &#123; b: 2, c: 2 &#125;;const source2 = &#123; c: 3 &#125;;Object.assign(target, source1, source2);target // &#123;b:2, c:3&#125; Ëøô‰∏™ÂíåÈó≠ÂåÖ‰∏ÄÊ†∑Ôºå‰πüÊòØÊåáÈíà‰º†ÈÄíÔºåÁîüÊàêÁöÑ target ÂØπË±°ÊàñËÄÖÊ∫ê source ÂØπË±°Ôºå‰∏§ËÄÖ‰ªª‰∏ÄÊîπÂä®ÈÉΩ‰ºöËß¶ÂèëÂè¶Â§ñÂØπË±°ÁöÑÊîπÂä®„ÄÇ Èô§‰∫ÜÊñπÊ≥ïÊòØÂü∫Êú¨Á±ªÂûãÊòØÂÄº‰º†ÈÄíÔºåÂØπË±°Á±ªÂûãÊòØÂºïÁî®‰º†ÈÄí„ÄÇÂÖ∂‰ªñÈÉΩÊòØÊåáÈíà‰º†ÈÄí„ÄÇ ÔºàÁΩë‰∏äÁ∫†ÁªìÁöÑ‰ªÄ‰πà‰º†ÈÄíÂú∞ÂùÄ‰πüÊòØÂÄº‰º†ÈÄíÔºåÂ∞±ÂΩìÊòØÊâØÊ∑°ÂêßÔºåÁêÜËß£ÊÑèÊÄùÂ∞±Ë°åÔºâ Object.entries()ËøîÂõû‰∏Ä‰∏™Êï∞ÁªÑÔºåÊàêÂëòÊòØÂèÇÊï∞ÂØπË±°Ëá™Ë∫´ÁöÑÔºà‰∏çÂê´ÁªßÊâøÁöÑÔºâÊâÄÊúâÂèØÈÅçÂéÜÂ±ûÊÄßÁöÑÈîÆÂÄºÂØπÊï∞ÁªÑÔºö 123const obj = &#123; foo: 'bar', baz: 42 &#125;;Object.entries(obj)// [ ["foo", "bar"], ["baz", 42] ] ÈÖçÂêà for...of... ÂèØ‰ª•ÊãøÂà∞ÊâÄÊúâÈîÆÂÄº„ÄÇ ÂèØ‰ª•Áî®ÂÆÉÊù•Â∞ÜÂØπË±°ËΩ¨Âåñ‰∏∫ Map JSON.stringify()‰∏Ä‰∏™ÂØπË±°‰Ω†Âú®ÊâìÂç∞logÁöÑÊó∂ÂÄôÔºåÂèØËÉΩ‰ºöÁªô‰Ω†ËøîÂõû [object object]„ÄÇÊ≠§Êó∂Ôºå‰Ω†ÈúÄË¶ÅÂ∞ÜÂØπË±°Â±ïÂºÄÔºåÂèØ‰ª•‰ΩøÁî® JSON.stringify() ÊñπÊ≥ï„ÄÇ MapÂíåSetJS‰∏≠ÈªòËÆ§ÂØπË±°Ë°®ËææÊñπÂºè{}ÂèØ‰ª•ËßÜ‰∏∫ÂÖ∂‰ªñËØ≠Ë®Ä‰∏≠ÁöÑMapÊàñDictionaryÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÂç≥‰∏ÄÁªÑÈîÆÂÄºÂØπ„ÄÇ‰ΩÜÊòØJavaScriptÁöÑÂØπË±°Êúâ‰∏™Â∞èÈóÆÈ¢òÔºåÂ∞±ÊòØÈîÆÂøÖÈ°ªÊòØÂ≠óÁ¨¶‰∏≤„ÄÇ‰ΩÜÂÆûÈôÖ‰∏äNumberÊàñËÄÖÂÖ∂‰ªñÊï∞ÊçÆÁ±ªÂûã‰Ωú‰∏∫ÈîÆ‰πüÊòØÈùûÂ∏∏ÂêàÁêÜÁöÑ„ÄÇ‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåÊúÄÊñ∞ÁöÑES6ËßÑËåÉÂºïÂÖ•‰∫ÜÊñ∞ÁöÑÊï∞ÊçÆÁ±ªÂûãMap„ÄÇ MapMap ÂèØ‰ª•Êé•Âèó‰∏Ä‰∏™Êï∞ÁªÑÔºåÊï∞ÁªÑÂÖÉÁ¥†ÊòØÈîÆÂÄºÂØπÁöÑÊï∞ÁªÑÔºö 1234var m = new Map([['Michael', 95], ['Bob', 75], ['Tracy', 85]]);m.delete('Adam'); // Âà†Èô§key 'Adam'm.get('Michael'); // 95m.set('Zachary', 100); Ëøô‰∏™ÁªìÊûÑÊòØ‰∏çÊòØÂæàÁÜüÊÇâÔºüObject.entries() ËøîÂõûÁöÑÂ∞±ÊòØËøôÊ†∑ÁöÑÊï∞ÁªÑ‰∏≠ÂåÖÂê´‰∫ÜÈîÆÂÄºÂØπÊï∞ÁªÑÁöÑÂΩ¢Âºè„ÄÇÊâÄ‰ª•ËØ¥ÔºåÂèØ‰ª•Áî® Object.entries() ÂàõÂª∫ Map„ÄÇÂõ†‰∏∫Áõ¥Êé•ÊääËøîÂõûÂÄº‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ• Map Âç≥ÂèØ„ÄÇ ÂØπË±°ÂèØ‰ª•Âèò‰∏∫ MapÔºå‰ΩÜÊòØ Map ‰∏ç‰∏ÄÂÆöËÉΩÂèò‰∏∫ÂØπË±°„ÄÇÊâÄ‰ª•ÂàõÂª∫ Map ÁöÑÊó∂ÂÄôÁöÑÂÖ•ÂèÇ‰∏çËÉΩ‰ª•ÂØπË±°ÁöÑÂΩ¢Âºè„ÄÇ ÊñπÊ≥ï size Â±ûÊÄßËøîÂõû Map ÁªìÊûÑÁöÑÊàêÂëòÊÄªÊï∞ÔºåÁ±ª‰ººÊï∞ÁªÑÁöÑ length set(key, value)ÔºöËÆæÁΩÆÈîÆÂêçkeyÂØπÂ∫îÁöÑÈîÆÂÄº‰∏∫valueÔºåÁÑ∂ÂêéËøîÂõûÊï¥‰∏™ Map ÁªìÊûÑ get(key): ËØªÂèñkeyÂØπÂ∫îÁöÑÈîÆÂÄºÔºåÂ¶ÇÊûúÊâæ‰∏çÂà∞keyÔºåËøîÂõûundefined„ÄÇ has(key):ËøîÂõû‰∏Ä‰∏™Â∏ÉÂ∞îÂÄºÔºåË°®Á§∫Êüê‰∏™ÈîÆÊòØÂê¶Âú®ÂΩìÂâç Map ÂØπË±°‰πã‰∏≠„ÄÇ delete(key):deleteÊñπÊ≥ïÂà†Èô§Êüê‰∏™ÈîÆÔºåËøîÂõûtrue„ÄÇÂ¶ÇÊûúÂà†Èô§Â§±Ë¥•ÔºåËøîÂõûfalse„ÄÇ clear():Ê∏ÖÈô§ÊâÄÊúâÊàêÂëòÔºåÊ≤°ÊúâËøîÂõûÂÄº„ÄÇ entries():ËøîÂõûÊâÄÊúâÊàêÂëòÁöÑÈÅçÂéÜÂô®„ÄÇÈÖçÂêà for...of... WeakMapWeakMap ÁöÑÈîÆÊòØÂØπË±°Á±ªÂûã„ÄÇÂ¶ÇÊûú‰Ω†Ë¶ÅÂæÄÂØπË±°‰∏äÊ∑ªÂä†Êï∞ÊçÆÔºåÂèà‰∏çÊÉ≥Âπ≤Êâ∞ÂûÉÂúæÂõûÊî∂Êú∫Âà∂ÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî® WeakMap„ÄÇ Ê≥®ÊÑèÂº±ÂºïÁî®ÁöÑÊòØÈîÆÔºåËÄå‰∏çÊòØÂÄº SetÈáçÂ§çÂÖÉÁ¥†Âú®Set‰∏≠Ëá™Âä®Ë¢´ËøáÊª§Ôºö12var s = new Set([1, 2, 3, 3, '3']);s; // Set &#123;1, 2, 3, "3"&#125; Ê≥®ÊÑèÊï∞Â≠ó3ÂíåÂ≠óÁ¨¶‰∏≤&#39;3&#39;ÊòØ‰∏çÂêåÁöÑÂÖÉÁ¥†„ÄÇ ÊñπÊ≥ï add(value)ÔºöÊ∑ªÂä†Êüê‰∏™ÂÄº„ÄÇ delete(value)ÔºöÂà†Èô§Êüê‰∏™ÂÄºÔºåËøîÂõû‰∏Ä‰∏™Â∏ÉÂ∞îÂÄº has(value)ÔºöËøîÂõû‰∏Ä‰∏™Â∏ÉÂ∞îÂÄºÔºåË°®Á§∫ËØ•ÂÄºÊòØÂê¶‰∏∫SetÁöÑÊàêÂëò„ÄÇ clear()ÔºöÊ∏ÖÈô§ÊâÄÊúâÊàêÂëò„ÄÇ WeakSetWeakSet ‰∏≠Âè™ËÉΩÂ≠òÂØπË±°„ÄÇÂπ∂‰∏îÈÉΩÊòØÂº±ÂºïÁî®„ÄÇ WeakSet ‰∏çËÉΩÈÅçÂéÜ„ÄÇÂõ†‰∏∫ÊâÄÊúâÂØπË±°ÈÉΩÊòØÂº±ÂºïÁî®ÔºåÈöèÊó∂ÂèØËÉΩÊ∂àÂ§±„ÄÇ iterableES6Ê†áÂáÜÂºïÂÖ•‰∫ÜÊñ∞ÁöÑiterableÁ±ªÂûãÔºåArray„ÄÅMapÂíåSetÈÉΩÂ±û‰∫éiterableÁ±ªÂûã„ÄÇiterable Á±ªÂûãÂÖ∂ÂÆûÂ∞±ÊòØ ÂÖ∑ÊúâiterableÁ±ªÂûãÁöÑÈõÜÂêàÂèØ‰ª•ÈÄöËøáÊñ∞ÁöÑfor ... ofÂæ™ÁéØÊù•ÈÅçÂéÜ„ÄÇÁî®Ê≥ïÂ¶Ç‰∏ãÔºö 123456789101112var a = ['A', 'B', 'C'];var s = new Set(['A', 'B', 'C']);var m = new Map([[1, 'x'], [2, 'y'], [3, 'z']]);for (var x of a) &#123; // ÈÅçÂéÜArray alert(x);&#125;for (var x of s) &#123; // ÈÅçÂéÜSet alert(x);&#125;for (var x of m) &#123; // ÈÅçÂéÜMap alert(x[0] + '=' + x[1]);&#125; for ... ofÂæ™ÁéØÂíåfor ... inÂæ™ÁéØÊúâ‰ΩïÂå∫Âà´Ôºüfor ... inÂÆûÈôÖ‰∏äÊòØÂØπË±°ÁöÑÂ±ûÊÄßÂêçÁß∞(Ê≥®ÊÑèÔºåÊòØÈîÆÔºå‰∏çÊòØÂÄº)„ÄÇ‰∏çË¶ÅÁî®Âú®Array,Set,Map‰∏äÔºå‰ºöÂá∫Áé∞Â•áÊÄ™ÁöÑÈóÆÈ¢ò„ÄÇfor ... ofÂæ™ÁéØÂàôÂÆåÂÖ®‰øÆÂ§ç‰∫ÜËøô‰∫õÈóÆÈ¢òÔºåÂÆÉÂè™Âæ™ÁéØÂæóÂà∞ÈõÜÂêàÂÜÖËØ•Âá∫Áé∞ÁöÑÂÖÉÁ¥†(Ê≥®ÊÑèÔºåÊòØÂÄºÔºå‰∏çÊòØÈîÆ)Ôºå‰æãÂ¶ÇÔºö1234567891011121314var a = ['A', 'B', 'C'];a.name = 'Hello';a['4'] = 'D';console.log(a);for (var num of a)&#123; console.log(num)&#125;ËæìÂá∫Ôºö[ 'A', 'B', 'C', , 'D', name: 'Hello' ]ABCundefinedD nameÁî±‰∫é‰∏çÊòØÊ≠£Â∏∏ArrayËØ•ÊúâÁöÑÔºåÊâÄ‰ª•Âú®for ... ofÂæ™ÁéØÊó∂ÔºåÂÖ∂ÂØπÂ∫îÁöÑÂÄº‰∏ç‰ºöË¢´ËæìÂá∫„ÄÇ ÂèòÈáèÁöÑËß£ÊûÑËµãÂÄºÊúâ‰∏§ÁßçËß£ÊûÑËµãÂÄºÔºåÂàÜÂà´‰∏∫Êï∞ÁªÑÁöÑËß£ÊûÑËµãÂÄºÂíåÂØπË±°ÁöÑËß£ÊûÑËµãÂÄº Êï∞ÁªÑÁöÑËß£ÊûÑËµãÂÄºÂ§öÂá∫ÁöÑÈÉ®ÂàÜ‰∏∫ undefinedÔºåÂèØ‰ª•‰ΩøÁî®Â±ïÂºÄËøêÁÆóÁ¨¶„ÄÇ 12let [a, b, c] = [1, 2]; // a = 1, b = 2, c = undefinedlet [x, ...y] = [1, 2, 3, 4]; // x = 1, y = [2, 3, 4] Ëß£ÊûÑËµãÂÄºÂÖÅËÆ∏ÊåáÂÆöÈªòËÆ§ÂÄºÔºåÂΩìÂØπÂ∫îÁöÑÂÄº‰∏∫ undefined Êó∂ÔºåÁ≠â‰∫éÈªòËÆ§ÂÄºÔºö 1let [x, y = 'b'] = ['a']; // x='a', y='b' ÂØπË±°ÁöÑËß£ÊûÑËµãÂÄº1let &#123; foo, bar &#125; = &#123; foo: "aaa", bar: "bbb" &#125;; ÊÉ≥Ë¶ÅÊîπÂèòÂèòÈáèÁöÑÂêçÂ≠ó‰πüÊòØÂèØ‰ª•ÁöÑÔºå‰∏äÈù¢ÂÖ∂ÂÆûÁ≠âÊïà‰∫éÔºö 1let &#123; foo: foo, bar: bar &#125; = &#123; foo: "aaa", bar: "bbb" &#125;; ÊâÄ‰ª•Â¶ÇÊûúÊàë‰ª¨Ë¶ÅÊîπÂèòÂèòÈáèÂêçÔºåÂèØ‰ª•ËøôÊ†∑Ôºö 12let &#123; foo: param1, bar: param2 &#125; = &#123; foo: "aaa", bar: "bbb" &#125;;// param1 = aaa, param2 = bbb ÂØπË±°‰πüÊòØÂèØ‰ª•ÊåáÂÆöÈªòËÆ§ÂÄºÁöÑÔºö 123var &#123;x, y: z = 5&#125; = &#123;x: 1&#125;;x // 1z // 5 ÂáΩÊï∞ÂáΩÊï∞ÂÆö‰πâÂíåË∞ÉÁî®ÂÆö‰πâÂáΩÊï∞ÊñπÂºè‰∏ÄÔºö1234567function abs(x) &#123; if (x &gt;= 0) &#123; return x; &#125; else &#123; return -x; &#125;&#125; Áî±‰∫éJavaScriptÁöÑÂáΩÊï∞‰πüÊòØ‰∏Ä‰∏™ÂØπË±°Ôºå‰∏äËø∞ÂÆö‰πâÁöÑabs()ÂáΩÊï∞ÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÂØπË±°ÔºåËÄåÂáΩÊï∞ÂêçabsÂèØ‰ª•ËßÜ‰∏∫ÊåáÂêëËØ•ÂáΩÊï∞ÁöÑÂèòÈáè„ÄÇ ÊñπÂºè‰∫åÔºö1234567var abs = function (x) &#123; if (x &gt;= 0) &#123; return x; &#125; else &#123; return -x; &#125;&#125;; Âú®ËøôÁßçÊñπÂºè‰∏ãÔºåfunction (x) { ... }ÊòØ‰∏Ä‰∏™ÂåøÂêçÂáΩÊï∞ÔºåÂÆÉÊ≤°ÊúâÂáΩÊï∞Âêç„ÄÇ‰ΩÜÊòØÔºåËøô‰∏™ÂåøÂêçÂáΩÊï∞ËµãÂÄºÁªô‰∫ÜÂèòÈáèabsÔºåÊâÄ‰ª•ÔºåÈÄöËøáÂèòÈáèabsÂ∞±ÂèØ‰ª•Ë∞ÉÁî®ËØ•ÂáΩÊï∞„ÄÇ ‰∏äËø∞‰∏§ÁßçÂÆö‰πâÂÆåÂÖ®Á≠â‰ª∑ÔºåÊ≥®ÊÑèÁ¨¨‰∫åÁßçÊñπÂºèÊåâÁÖßÂÆåÊï¥ËØ≠Ê≥ïÈúÄË¶ÅÂú®ÂáΩÊï∞‰ΩìÊú´Â∞æÂä†‰∏Ä‰∏™;ÔºåË°®Á§∫ËµãÂÄºËØ≠Âè•ÁªìÊùü„ÄÇ Swift ‰∏≠‰ΩøÁî® func ÂÆö‰πâÂáΩÊï∞ Ë∞ÉÁî®ÂáΩÊï∞Áî±‰∫éJavaScriptÂÖÅËÆ∏‰º†ÂÖ•‰ªªÊÑè‰∏™ÂèÇÊï∞ËÄå‰∏çÂΩ±ÂìçË∞ÉÁî®ÔºåÂõ†Ê≠§‰º†ÂÖ•ÁöÑÂèÇÊï∞ÊØîÂÆö‰πâÁöÑÂèÇÊï∞Â§ö‰πüÊ≤°ÊúâÈóÆÈ¢òÔºåËôΩÁÑ∂ÂáΩÊï∞ÂÜÖÈÉ®Âπ∂‰∏çÈúÄË¶ÅËøô‰∫õÂèÇÊï∞Ôºö12abs(10, 'blablabla'); // ËøîÂõû10abs(-9, 'haha', 'hehe', null); // ËøîÂõû9 ‰º†ÂÖ•ÁöÑÂèÇÊï∞ÊØîÂÆö‰πâÁöÑÂ∞ë‰πüÊ≤°ÊúâÈóÆÈ¢òÔºö1abs(); // ËøîÂõûNaN Ê≠§Êó∂abs(x)ÂáΩÊï∞ÁöÑÂèÇÊï∞xÂ∞ÜÊî∂Âà∞undefinedÔºåËÆ°ÁÆóÁªìÊûú‰∏∫NaN„ÄÇ Ë¶ÅÈÅøÂÖçÊî∂Âà∞undefinedÔºåÂèØ‰ª•ÂØπÂèÇÊï∞ËøõË°åÊ£ÄÊü•Ôºö12345678910function abs(x) &#123; if ((typeof x) !== 'number') &#123; throw 'Not a number'; &#125; if (x &gt;= 0) &#123; return x; &#125; else &#123; return -x; &#125;&#125; restÂèÇÊï∞Áî±‰∫éJavaScriptÂáΩÊï∞ÂÖÅËÆ∏Êé•Êî∂‰ªªÊÑè‰∏™ÂèÇÊï∞ÔºåES6Ê†áÂáÜÂºïÂÖ•‰∫ÜrestÂèÇÊï∞ÔºåÂèØ‰ª•Â∞ÜÂâ©‰ΩôÁöÑÂèÇÊï∞ÊîæÂú®rest‰∏≠Ôºårest ÊòØ‰∏™Êï∞ÁªÑÔºà‰∏çÊòØ‰∏ÄÂÆöË¶ÅÂè´ restÔºå‰ªª‰ΩïÂêçÁß∞ÈÉΩÂèØ‰ª•ÔºâÔºö1234567891011121314151617function foo(a, b, ...rest) &#123; console.log('a = ' + a); console.log('b = ' + b); console.log(rest);&#125;foo(1, 2, 3, 4, 5);// ÁªìÊûú:// a = 1// b = 2// Array [ 3, 4, 5 ]foo(1);// ÁªìÊûú:// a = 1// b = undefined// Array [] ÂÖ∂ÂÆûÁõ∏ÂΩì‰∫éÊää rest Â±ïÂºÄÔºåÁÑ∂ÂêéÂíåÂÖ•ÂèÇÂØπÂ∫î Â¶ÇÊûú‰º†ÂÖ•ÁöÑÂèÇÊï∞ËøûÊ≠£Â∏∏ÂÆö‰πâÁöÑÂèÇÊï∞ÈÉΩÊ≤°Â°´Êª°ÔºårestÂèÇÊï∞‰ºöÊé•Êî∂‰∏Ä‰∏™Á©∫Êï∞ÁªÑÔºàÊ≥®ÊÑè‰∏çÊòØundefinedÔºâ„ÄÇ ÂèÇÊï∞ÈªòËÆ§ÂÄºES6 Áªô js ÁöÑÂáΩÊï∞Êèê‰æõ‰∫ÜÈªòËÆ§ÂÄºÔºö 1234567function Point(x = 0, y = 0) &#123; this.x = x; this.y = y;&#125;const p = new Point();p // &#123; x: 0, y: 0 &#125; Â∏¶ÈªòËÆ§ÂÄºÁöÑÂèÇÊï∞ÈúÄË¶ÅÂÜôÂú®Êú´Â∞æ„ÄÇ ÁâπÊÄßname Â±ûÊÄßÂáΩÊï∞ÁöÑ nameÂ±ûÊÄßÔºåËøîÂõûÂáΩÊï∞ÁöÑÂáΩÊï∞ÂêçÔºö 12function foo() &#123;&#125;foo.name // "foo" ÁÆ≠Â§¥ÂáΩÊï∞ES6Ê†áÂáÜÊñ∞Â¢û‰∫Ü‰∏ÄÁßçÊñ∞ÁöÑÂáΩÊï∞ÔºöArrow FunctionÔºàÁÆ≠Â§¥ÂáΩÊï∞Ôºâ„ÄÇ 1x =&gt; x*x Áõ∏ÂΩì‰∫é‰∏Ä‰∏™ËæìÂÖ•‰∏∫xËæìÂá∫‰∏∫x*xÁöÑÂåøÂêçÂáΩÊï∞ 123function (x) &#123; return x * x;&#125; Â¶ÇÊûúÂèÇÊï∞‰∏çÊòØ‰∏Ä‰∏™ÔºåÂ∞±ÈúÄË¶ÅÁî®Êã¨Âè∑()Êã¨Ëµ∑Êù•Ôºö 1234567891011121314// ‰∏§‰∏™ÂèÇÊï∞:(x, y) =&gt; x * x + y * y// Êó†ÂèÇÊï∞:() =&gt; 3.14// ÂèØÂèòÂèÇÊï∞:(x, y, ...rest) =&gt; &#123; var i, sum = x + y; for (i=0; i&lt;rest.length; i++) &#123; sum += rest[i]; &#125; return sum;&#125; ËØ≠Ê≥ïÁ≥ñÔºåÁ±ª‰ºº‰∫épython‰∏≠ÁöÑlambdaÂáΩÊï∞ ÂΩìÁÑ∂ÔºåÁÆ≠Â§¥ÂáΩÊï∞ËøòÊòØÊúâÁÇπÁî®Â§ÑÁöÑÔºåÁî±‰∫éÊòØes6ÁöÑÊñ∞ÁâπÊÄßÔºåÁÆ≠Â§¥ÂáΩÊï∞ÂÜÖÈÉ®ÁöÑthisÊòØËØçÊ≥ï‰ΩúÁî®ÂüüÔºåÁî±‰∏ä‰∏ãÊñáÁ°ÆÂÆö„ÄÇËØïÂÅöÊØîËæÉÔºö 123456789101112131415161718192021//Áî±‰∫éJavaScriptÂáΩÊï∞ÂØπthisÁªëÂÆöÁöÑÈîôËØØÂ§ÑÁêÜÔºå‰∏ãÈù¢ÁöÑ‰æãÂ≠êÊó†Ê≥ïÂæóÂà∞È¢ÑÊúüÁªìÊûúvar obj = &#123; birth: 1990, getAge: function () &#123; var b = this.birth; // 1990 var fn = function () &#123; return new Date().getFullYear() - this.birth; // thisÊåáÂêëwindowÊàñundefined &#125;; return fn(); &#125;&#125;;//ÁÆ≠Â§¥ÂáΩÊï∞ÂÆåÂÖ®‰øÆÂ§ç‰∫ÜthisÁöÑÊåáÂêëÔºåthisÊÄªÊòØÂíåÂáΩÊï∞Â§ñÈÉ®ÁöÑ this Êåá‰ª£Áõ∏ÂêåÁöÑ‰∏úË•øÔºövar obj = &#123; birth: 1990, getAge: function () &#123; var b = this.birth; // 1990 var fn = () =&gt; new Date().getFullYear() - this.birth; // this Âíå this.birth ÊåáÁöÑÊòØ‰∏Ä‰∏™‰∏úË•ø return fn(); &#125;&#125;;obj.getAge(); // 25 Â¶ÇÊûú‰ΩøÁî®ÁÆ≠Â§¥ÂáΩÊï∞,‰ª•Ââç var that = this; ‰ª•Âèä .apply() Âíå .call() ËøôÁßçÂÜôÊ≥ïÂ∞±‰∏çÈúÄË¶Å‰∫Ü„ÄÇ ÁÆ≠Â§¥ÂáΩÊï∞Âπ∂‰∏çÂàõÂª∫ÂÆÉËá™Ë∫´ÊâßË°åÁöÑ‰∏ä‰∏ãÊñáÔºå‰ΩøÂæó this ÂèñÂÜ≥‰∫éÂÆÉÂú®ÂÆö‰πâÊó∂ÁöÑÂ§ñÈÉ®ÂáΩÊï∞„ÄÇ ÁÆ≠Â§¥ÂáΩÊï∞Áî®Âú®ÂµåÂ•óÂáΩÊï∞ÈáåÔºå‰∏çËÉΩ‰Ωú‰∏∫Êüê‰∏Ä‰∏™Â±ûÊÄßÁöÑÂÄºÔºåÊØîÂ¶ÇÁî®ÊàêËøôÊ†∑Ôºö 1234567&gt; var obj = &#123;&gt; birth: 1990,&gt; getAge: () =&gt; &#123;&gt; var b = this.birth; // this ÊòØ undefined&gt; &#125;&gt; &#125;&gt; ËøôÈáåÂπ∂Ê≤°ÊúâÂ§ñÈÉ®ÂáΩÊï∞ÔºåÊâÄ‰ª•ÁÆ≠Â§¥ÂáΩÊï∞ÈáåÁöÑ this Ê∞∏ËøúÊòØ undefined Ë£ÖÈ•∞Âô®Âà©Áî®apply()ÔºåÊàë‰ª¨ÂèØ‰ª•Âä®ÊÄÅÊîπÂèòÂáΩÊï∞ÁöÑË°å‰∏∫„ÄÇ JavaScriptÁöÑÊâÄÊúâÂØπË±°ÈÉΩÊòØÂä®ÊÄÅÁöÑÔºåÂç≥‰ΩøÂÜÖÁΩÆÁöÑÂáΩÊï∞ÔºåÊàë‰ª¨‰πüÂèØ‰ª•ÈáçÊñ∞ÊåáÂêëÊñ∞ÁöÑÂáΩÊï∞„ÄÇ Áé∞Âú®ÂÅáÂÆöÊàë‰ª¨ÊÉ≥ÁªüËÆ°‰∏Ä‰∏ã‰ª£Á†Å‰∏ÄÂÖ±Ë∞ÉÁî®‰∫ÜÂ§öÂ∞ëÊ¨°parseInt()ÔºåÂèØ‰ª•ÊääÊâÄÊúâÁöÑË∞ÉÁî®ÈÉΩÊâæÂá∫Êù•ÔºåÁÑ∂ÂêéÊâãÂä®Âä†‰∏äcount += 1Ôºå‰∏çËøáËøôÊ†∑ÂÅöÂ§™ÂÇª‰∫Ü„ÄÇÊúÄ‰Ω≥ÊñπÊ°àÊòØÁî®Êàë‰ª¨Ëá™Â∑±ÁöÑÂáΩÊï∞ÊõøÊç¢ÊéâÈªòËÆ§ÁöÑparseInt()Ôºö12345678910111213var count = 0;var oldParseInt = parseInt; // ‰øùÂ≠òÂéüÂáΩÊï∞window.parseInt = function () &#123; count += 1; return oldParseInt.apply(null, arguments); // Ë∞ÉÁî®ÂéüÂáΩÊï∞&#125;;// ÊµãËØï:parseInt('10');parseInt('20');parseInt('30');count; // 3 apply() Êé•Êî∂‰∏§‰∏™ÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Ë°®Á§∫Ë∞ÉÁî®ÁöÑÂØπË±°ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÂÖ•ÂèÇÊï∞ÁªÑ„ÄÇÊ≠§Â§ÑÁöÑ arguments Ë°®Á§∫ÁöÑÊòØÂ§ñÈÉ® function ÁöÑÂÖ•ÂèÇÔºåÊòØ js Êèê‰æõÁöÑ‰∏Ä‰∏™ÂèÇÊï∞„ÄÇ Èó≠ÂåÖËøôÊòØÂõ†‰∏∫ JS ‰∏≠ÁöÑÈó≠ÂåÖÂØπÂ§ñÈÉ®ÂèòÈáèÈÉΩÊòØÊåáÈíà‰º†ÈÄíÔºåËÄå‰∏çÊòØÂºïÁî®‰º†ÈÄí„ÄÇ„ÄÇ iOS ‰∏≠ÁöÑÈó≠ÂåÖÈÉΩÊòØÂºïÁî®‰º†ÈÄíÔºåÂ§ñÈÉ®ÂèòÈáèÁõ∏ÂΩì‰∫éÊòØ‰ª•ÂèÇÊï∞ÁöÑÂΩ¢Âºè‰º†ÂÖ•ÁöÑÔºå‰πüÂ∞±ÊòØËØ¥ÔºåÈó≠ÂåÖÂÜÖÊîπÂèòÂ§ñÈÉ®ÂèòÈáèÁöÑÂÄºÔºåÂ§ñÈÉ®ÂèòÈáè‰∏ç‰ºöÂèòÂåñ„ÄÇ js ‰∏≠ÁöÑÈó≠ÂåÖÔºåÁõ∏ÂΩì‰∫éÂ§ñÈÉ®ÂèòÈáèÁöÑÂú∞ÂùÄÈÉΩËé∑Âæó‰∫Ü„ÄÇÈó≠ÂåÖÂÜÖÊîπÂèòÂ§ñÈÉ®ÂèòÈáèÁöÑÂÄºÔºåÂ§ñÈÉ®ÂèòÈáèÁöÑÂÄºÁõ∏Â∫îÊîπÂèò„ÄÇ PromiseES6 Êèê‰æõ‰∫ÜÂéüÁîüÁöÑ Promise ÂØπË±°„ÄÇÂèØ‰ª•Â∞ÜÂºÇÊ≠•Êìç‰Ωú‰ª•ÂêåÊ≠•ÁöÑÂΩ¢ÂºèË°®ËææÂá∫Êù•„ÄÇ Âü∫Êú¨Áî®Ê≥ï123456789const promise = new Promise(function(resolve, reject) &#123; asyncFunc((success) =&gt; &#123; if (success)&#123; resolve(value); &#125; else &#123; reject(error); &#125; &#125;)&#125;); Â¶Ç‰∏äÊâÄÁ§∫ÔºåPromise Êé•Âèó‰∏Ä‰∏™ÂáΩÊï∞ÔºåÂÖ•ÂèÇ‰∏∫ÊàêÂäüÂíåÂ§±Ë¥•ÂõûË∞ÉÔºåÂáΩÊï∞ÂÜÖÊâßË°åÂºÇÊ≠•Êìç‰ΩúÔºåÂú®ÂøÖË¶ÅÊó∂ÊâßË°åÊàêÂäüÂíåÂ§±Ë¥•ÂõûË∞É„ÄÇPromise ‰∏çÈúÄË¶ÅËøîÂõûÂÄº„ÄÇ Promise ÂÆû‰æãÁîüÊàêÂêéÔºåÂèØ‰ª•‰ΩøÁî® then ÊñπÊ≥ïÊåáÂÆö resolve Âíå reject ÁöÑÂõûË∞ÉÂáΩÊï∞Ôºö 12345promise.then(function(value) &#123; // success&#125;, function(error) &#123; // failure&#125;); Promise ÁöÑÂ§ßËá¥ÂéüÁêÜÊòØÈÄöËøá then Âú® Promise ÈáåÊ≥®ÂÜåÂõûË∞ÉÔºåÁÑ∂ÂêéÂàõÂª∫ Promise Êó∂‰º†ÂÖ•ÁöÑÂáΩÊï∞‰ºöË∞ÉÁî®Ê≥®ÂÜåÁöÑÂõûË∞ÉÂáΩÊï∞„ÄÇ Ê≥®ÊÑèÔºåÂàõÂª∫ Promise ÁöÑÊó∂ÂÄôÔºåÂáΩÊï∞Â∞±Ë¢´ÊâßË°å‰∫Ü„ÄÇ‰ΩÜÊòØÊâßË°åÂà∞ resolve ÊàñËÄÖ reject ÊñπÊ≥ïÊó∂Âπ∂‰∏çÁ´ãÂàªÊâßË°åÔºåËÄåÊòØÁ≠âÂà∞ÊúÄÂêéÔºö 12345678new Promise((resolve, reject) =&gt; &#123; resolve(1); console.log(2);&#125;).then(r =&gt; &#123; console.log(r);&#125;);// 2// 1 ËøôÊòØÂõ†‰∏∫ÔºåPromise Â∞Ü then Ê≥®ÂÜåÁöÑÂõûË∞ÉÂáΩÊï∞ÈÉΩÂåÖË£π‰∏ä‰∫Ü setTimeoutÔºàresolvedÔºå0ÔºâÔºåÂ∞ÜÂõûË∞ÉÂáΩÊï∞ÊîæÁΩÆÂà∞ JS ‰ªªÂä°ÈòüÂàóÊú´Â∞æ„ÄÇ ÈìæÂºèË∞ÉÁî®then()ÊØè‰∏Ä‰∏™ promise Â∞±ÊòØ‰∏Ä‰∏™ÂºÇÊ≠•Ë∞ÉÁî®„ÄÇÂ§ö‰∏™ÂºÇÊ≠•Ë∞ÉÁî®‰∏≤Ë°åÂèØ‰ª•‰ΩøÁî®ÈìæÂºè .then() ÁöÑÊñπÂºè„ÄÇ Ëøô‰∏™Êó∂ÂÄô then ÊñπÊ≥ïÂêëË∞ÉÁî®ÁöÑ Promise Ê≥®ÂÖ•ÊàêÂäüÂõûË∞ÉÁöÑÊó∂ÂÄôÈúÄË¶ÅËøîÂõû‰∏Ä‰∏™Êñ∞ÁöÑ Promise 123456789101112131415new Promise((resolve, reject) =&gt; &#123; ...ÂºÇÊ≠•Êìç‰ΩúÂõûË∞É &#123; let data = xxx resolve(data) &#125;&#125;.then((res) =&gt; &#123; return Promise((resolve, reject) =&gt; &#123; ...ÂºÇÊ≠•Êìç‰ΩúÂõûË∞É &#123; let data = xxx resolve(data) &#125; &#125;)&#125;).then((res) =&gt; &#123; ...ÊúÄÁªàÂØπ res Â§ÑÁêÜ„ÄÇ&#125;) Âπ∂‰∏çÊòØËØ¥ .then ËøîÂõû‰∏Ä‰∏™ promiseÔºå‰ΩøÁî®ËÄÖÂ∞±ÂøÖÈ°ªË¶ÅËá™Â∑±ÂàõÂª∫‰∏Ä‰∏™ promise„ÄÇÂ¶ÇÊûú .then ËøîÂõûÁöÑÊòØÊüê‰∏™ÂÄº someObjectÔºåÈÇ£‰πà‰ºöË¢´ÈªòËÆ§ÂåÖË£Ö‰∏∫‰∏Ä‰∏™ promiseÔºåÂπ∂‰∏îÁ´ãÂàªË∞ÉÁî® resolve(someObject)ÔºåÂç≥ÊâßË°åÂêé‰∏Ä‰∏™ .then ÁöÑËÄåÊñπÊ≥ï„ÄÇ ###Â§±Ë¥•Ë∞ÉÁî® catch() catch() ÊñπÊ≥ïÊòØ.then(null, rejection)ÁöÑÂà´ÂêçÔºåÁî®‰∫éÊåáÂÆöÂèëÁîüÈîôËØØÊó∂ÁöÑÂõûË∞ÉÂáΩÊï∞Ôºö 123456getJSON('/posts.json').then(function(posts) &#123; // ...&#125;).catch(function(error) &#123; // Â§ÑÁêÜ getJSON Âíå Ââç‰∏Ä‰∏™ÂõûË∞ÉÂáΩÊï∞ËøêË°åÊó∂ÂèëÁîüÁöÑÈîôËØØ console.log('ÂèëÁîüÈîôËØØÔºÅ', error);&#125;); Ê≥®ÊÑèÔºåPromise ÂØπË±°ÁöÑÈîôËØØÂÖ∑Êúâ‚ÄúÂÜíÊ≥°‚ÄùÊÄßË¥®Ôºå‰ºö‰∏ÄÁõ¥ÂêëÂêé‰º†ÈÄíÔºåÁõ¥Âà∞Ë¢´ÊçïËé∑‰∏∫Ê≠¢„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÈîôËØØÊÄªÊòØ‰ºöË¢´‰∏ã‰∏Ä‰∏™catchËØ≠Âè•ÊçïËé∑„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÊú¨‰æã‰∏≠ÔºåÊó†ËÆ∫ÊòØ getJSON ËøòÊòØ .then() ÁîüÊàêÁöÑ Promise ‰∫ßÁîüÁöÑÈîôËØØÈÉΩ‰ºöË¢´ catch() ÊçïËé∑„ÄÇ ‰∏ÄËà¨Êù•ËØ¥‰∏çË¶ÅÂú® then() ÊñπÊ≥ï‰∏≠ÂÆö‰πâÂ§±Ë¥•ÂõûË∞É„ÄÇÊÄªÊòØ‰ΩøÁî® catch() ÊñπÊ≥ï„ÄÇ catch() ÊñπÊ≥ïËøîÂõûÁöÑËøòÊòØ Promise ÂØπË±°Ôºå‰ºöÊé•ÁùÄËøêË°åÂêéÈù¢ÁöÑ then() ÊñπÊ≥ï„ÄÇ Ê∞∏ËøúÊâßË°å finally()1234promise.then(result =&gt; &#123;¬∑¬∑¬∑&#125;).catch(error =&gt; &#123;¬∑¬∑¬∑&#125;).finally(() =&gt; &#123;¬∑¬∑¬∑&#125;); ‰∏äÈù¢‰ª£Á†Å‰∏≠Ôºå‰∏çÁÆ°promiseÊúÄÂêéÁöÑÁä∂ÊÄÅÔºåÂú®ÊâßË°åÂÆåthenÊàñcatchÊåáÂÆöÁöÑÂõûË∞ÉÂáΩÊï∞‰ª•ÂêéÔºåÈÉΩ‰ºöÊâßË°åfinallyÊñπÊ≥ïÊåáÂÆöÁöÑÂõûË∞ÉÂáΩÊï∞„ÄÇ ÂêàÂπ∂Â§ö‰∏™Promise all()Promise.allÊñπÊ≥ïÊé•Âèó‰∏Ä‰∏™ Promise Êï∞ÁªÑÔºåÁî®‰∫éÂ∞ÜÂ§ö‰∏™ Promise ÂÆû‰æãÔºåÂåÖË£ÖÊàê‰∏Ä‰∏™Êñ∞ÁöÑ Promise ÂÆû‰æãÔºö 123456const p = Promise.all([p1, p2, p3]);p.then(function (posts) &#123; // ...&#125;).catch(function(reason)&#123; // ...&#125;); pÁöÑÁä∂ÊÄÅÁî±p1„ÄÅp2„ÄÅp3ÂÜ≥ÂÆöÔºåÂàÜÊàê‰∏§ÁßçÊÉÖÂÜµ„ÄÇ Ôºà1ÔºâÂè™Êúâp1„ÄÅp2„ÄÅp3ÁöÑÁä∂ÊÄÅÈÉΩÂèòÊàêfulfilledÔºåpÁöÑÁä∂ÊÄÅÊâç‰ºöÂèòÊàêfulfilledÔºåÊ≠§Êó∂p1„ÄÅp2„ÄÅp3ÁöÑËøîÂõûÂÄºÁªÑÊàê‰∏Ä‰∏™Êï∞ÁªÑÔºå‰º†ÈÄíÁªôpÁöÑÂõûË∞ÉÂáΩÊï∞„ÄÇ Ôºà2ÔºâÂè™Ë¶Åp1„ÄÅp2„ÄÅp3‰πã‰∏≠Êúâ‰∏Ä‰∏™Ë¢´rejectedÔºåpÁöÑÁä∂ÊÄÅÂ∞±ÂèòÊàêrejectedÔºåÊ≠§Êó∂Á¨¨‰∏Ä‰∏™Ë¢´rejectÁöÑÂÆû‰æãÁöÑËøîÂõûÂÄºÔºå‰ºö‰º†ÈÄíÁªôpÁöÑÂõûË∞ÉÂáΩÊï∞„ÄÇ ÂêàÂπ∂Â§ö‰∏™Promise race()Promise.raceÊñπÊ≥ïÂêåÊ†∑ÊòØÂ∞ÜÂ§ö‰∏™ Promise ÂÆû‰æãÔºåÂåÖË£ÖÊàê‰∏Ä‰∏™Êñ∞ÁöÑ Promise ÂÆû‰æãÔºö 1const p = Promise.race([p1, p2, p3]); ‰∏äÈù¢‰ª£Á†Å‰∏≠ÔºåÂè™Ë¶Åp1„ÄÅp2„ÄÅp3‰πã‰∏≠Êúâ‰∏Ä‰∏™ÂÆû‰æãÁéáÂÖàÊîπÂèòÁä∂ÊÄÅÔºåpÁöÑÁä∂ÊÄÅÂ∞±Ë∑üÁùÄÊîπÂèò„ÄÇÈÇ£‰∏™ÁéáÂÖàÊîπÂèòÁöÑ Promise ÂÆû‰æãÁöÑËøîÂõûÂÄºÔºåÂ∞±‰º†ÈÄíÁªôpÁöÑÂõûË∞ÉÂáΩÊï∞„ÄÇ async ÂáΩÊï∞async ÂáΩÊï∞Âºè Generator ÂáΩÊï∞ÁöÑËØ≠Ê≥ïÁ≥ñ. asyncÂáΩÊï∞ËøîÂõû‰∏Ä‰∏™ Promise ÂØπË±°ÔºåÂèØ‰ª•‰ΩøÁî®thenÊñπÊ≥ïÊ∑ªÂä†ÂõûË∞ÉÂáΩÊï∞„ÄÇ ÂΩìÂáΩÊï∞ÊâßË°åÁöÑÊó∂ÂÄôÔºå‰∏ÄÊó¶ÈÅáÂà∞awaitÂ∞±‰ºöÂÖàËøîÂõûÔºåÁ≠âÂà∞ÂºÇÊ≠•Êìç‰ΩúÂÆåÊàêÔºåÂÜçÊé•ÁùÄÊâßË°åÂáΩÊï∞‰ΩìÂÜÖÂêéÈù¢ÁöÑËØ≠Âè•: 123456789async function getStockPriceByName(name) &#123; const symbol = await getStockSymbol(name); const stockPrice = await getStockPrice(symbol); return stockPrice;&#125;getStockPriceByName('goog').then(function (result) &#123; console.log(result);&#125;); ‰∏äÈù¢‰ª£Á†ÅÊòØ‰∏Ä‰∏™Ëé∑ÂèñËÇ°Á•®Êä•‰ª∑ÁöÑÂáΩÊï∞ÔºåÂáΩÊï∞ÂâçÈù¢ÁöÑasyncÂÖ≥ÈîÆÂ≠óÔºåË°®ÊòéËØ•ÂáΩÊï∞ÂÜÖÈÉ®ÊúâÂºÇÊ≠•Êìç‰Ωú„ÄÇË∞ÉÁî®ËØ•ÂáΩÊï∞Êó∂Ôºå‰ºöÁ´ãÂç≥ËøîÂõû‰∏Ä‰∏™PromiseÂØπË±°‰∏çÊòØËØ¥ stockPrice ÊòØ‰∏Ä‰∏™ Promise ËÄåÊòØËØ¥ async ‰øÆÈ•∞ÁöÑËøô‰∏™ÊñπÊ≥ïÊúÄÁªàËøîÂõû‰∏Ä‰∏™ PromiseÔºåstockPrice Âè™ÊòØ‰Ωú‰∏∫ resolve ÁöÑ input ËÄåÂ∑≤„ÄÇ Â¶ÇÊûúÁ°ÆÂÆûÂ∏åÊúõÂ§ö‰∏™ËØ∑Ê±ÇÂπ∂ÂèëÊâßË°åÔºåÂèØ‰ª•‰ΩøÁî®Promise.allÊñπÊ≥ï: 1234567async function dbFuc(db) &#123; let docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;]; let promises = docs.map((doc) =&gt; db.post(doc)); let results = await Promise.all(promises); console.log(results);&#125; async Áõ∏ÂΩì‰∫éÂëäËØâÂ§ñÁïåÔºåËøô‰∏™ÊñπÊ≥ï‰ºöËøîÂõû‰∏Ä‰∏™ promise await ÂøÖÈ°ªÂú® async ‰∏≠ÊâçËÉΩ‰ΩøÁî® await ÂêéÈù¢ÁöÑÊñπÊ≥ï‰ºöÂª∂ËøüÂà∞ await ÊñπÊ≥ïÊâßË°åÂÆåÂêéÊâßË°åÔºåÁõ∏ÂΩì‰∫é then Êìç‰Ωú await ÁöÑÈîôËØØÊçïËé∑ÈúÄË¶Å‰ΩøÁî® try‚Ä¶catch ÁöÑÊñπÂºè ProxyProxy Â∞±Â¶ÇÂ≠óÈù¢ÊâÄËØ¥ÁöÑÔºåÊòØ ES6 Êèê‰æõÁöÑ‰ª£ÁêÜÊ®°ÂºèÁöÑÂ∞ÅË£Ö„ÄÇES6 ÂéüÁîüÊèê‰æõ Proxy ÊûÑÈÄ†ÂáΩÊï∞ÔºåÁî®Êù•ÁîüÊàê Proxy ÂÆû‰æã: 1var proxy = new Proxy(target, handler); Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØË¢´‰ª£ÁêÜÂØπË±°ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØË¶ÅÊã¶Êà™ÁöÑË°å‰∏∫ÂØπË±°„ÄÇÂΩìË∞ÉÁî®‰ª£ÁêÜÂØπË±°ÁöÑË¢´Êã¶Êà™Ë°å‰∏∫Êó∂ÔºåËß¶Âèë‰ª£ÁêÜÊñπÊ≥ï„ÄÇÂ∏∏Áî®ÁöÑÊã¶Êà™Ë°å‰∏∫Êúâ‰ª•‰∏ãÂá†ÁßçÔºö get(),set()1234567891011121314151617var obj = new Proxy(&#123;&#125;, &#123; get: function (target, key, receiver) &#123; console.log(`getting $&#123;key&#125;!`); return Reflect.get(target, key, receiver); &#125;, set: function (target, key, value, receiver) &#123; console.log(`setting $&#123;key&#125;!`); return Reflect.set(target, key, value, receiver); &#125;&#125;);obj.count = 1// setting count!++obj.count// getting count!// setting count!// 2 ÂÖ∂‰∏≠Ôºå‰ª£ÁêÜÂØπË±°ÊòØ objÔºåË¢´‰ª£ÁêÜÁöÑÂØπË±°ÊòØ {} Á©∫ÂØπË±°ÔºåÊã¶Êà™ÁöÑË°å‰∏∫ÊòØ getÔºåset ÊñπÊ≥ï„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå‰ªª‰ΩïÂØπ‰∫é obj ÁöÑËØªÂèñÂÜôÂÖ•Êìç‰ΩúÈÉΩÂ∞ÜÊâßË°å‰ª£ÁêÜÊñπÊ≥ï„ÄÇ getÔºåset ÊñπÊ≥ïÁöÑÂèÇÊï∞‰πüÂæàÂ•ΩÁêÜËß£„ÄÇtarget Ë°®Á§∫Ë¢´‰ª£ÁêÜÂØπË±°Ôºåkey Ë°®Á§∫Ë¶ÅËøõË°åËØªÂÜôÊìç‰ΩúÁöÑÂ±ûÊÄßÔºåvalue Â∞±ÊòØÂÜôÊìç‰ΩúÁöÑÂÄº„ÄÇreceiver Â∞±ÊòØ‰ª£ÁêÜÂØπË±° obj„ÄÇÔºàÂÖà‰∏çÁî®ÂÖ≥ ReflectÔºâ„ÄÇ Â¶ÇÊûúhandlerÊ≤°ÊúâËÆæÁΩÆ‰ªª‰ΩïÊã¶Êà™ÔºåÈÇ£Â∞±Á≠âÂêå‰∫éÁõ¥Êé•ÈÄöÂêëÂéüÂØπË±°Ôºö 12345var target = &#123;&#125;;var handler = &#123;&#125;;var proxy = new Proxy(target, handler);proxy.a = 'b';target.a // "b" apply()apply ÊñπÊ≥ïÊã¶Êà™ÂáΩÊï∞ÁöÑË∞ÉÁî®„ÄÅcallÂíå apply Êìç‰Ωú„ÄÇÂèØ‰ª•Êé•Âèó‰∏â‰∏™ÂèÇÊï∞ÔºöÁõÆÊ†áÂØπË±°(ÂáΩÊï∞Ôºâ„ÄÅÁõÆÊ†áÂØπË±°‰∏ä‰∏ãÊñáÂØπË±°(this)„ÄÅÁõÆÊ†áÂØπË±°ÁöÑÂèÇÊï∞Êï∞ÁªÑ„ÄÇ 123456789101112var twice = &#123; apply (target, context, args) &#123; return Reflect.apply(...arguments) * 2; &#125;&#125;;function sum (left, right) &#123; return left + right;&#125;;var proxy = new Proxy(sum, twice);proxy(1, 2) // 6proxy.call(null, 5, 6) // 22proxy.apply(null, [7, 8]) // 30 Ê≥®ÊÑèËøôÈáåÁöÑ ...arguments Ë°®Á§∫ÁöÑÊòØ target,context‰ª•ÂèäargsÁöÑÂÖ®ÈÉ®„ÄÇ construct()construct ÊñπÊ≥ïÁî®‰∫éÊã¶Êà™ new ÂëΩ‰ª§„ÄÇÊé•Âèó‰∏§‰∏™ÂèÇÊï∞ÔºöÁõÆÊ†áÂØπË±°(Á±ªÂØπË±°)ÔºåÊûÑÂª∫ÂáΩÊï∞ÁöÑÂèÇÊï∞ÂØπË±°„ÄÇ 1234567891011121314class A &#123; constructor() &#123; this.a = 1 &#125;&#125;let Aproxy = new Proxy(A, &#123; construct: function(target, args)&#123; return new target(...args) &#125;&#125;);let a = new Aproxy()console.log(a.a) //1 Ê≥®ÊÑèÔºåÊã¶Êà™ÁöÑÊòØ new ÂëΩ‰ª§Ôºå‰∏çÊòØÊã¶Êà™ÁöÑ constructor ÂëΩ‰ª§ÔºåÊâÄ‰ª•ÔºåÊã¶Êà™ÊñπÊ≥ïË¶ÅËøîÂõû‰∏Ä‰∏™ target ÂàõÂª∫ÁöÑÊñ∞ÂØπË±°„ÄÇ classÂü∫Êú¨Áî®Ê≥ïÂàõÂª∫Âíå‰ΩøÁî®Êñ∞ÁöÑÂÖ≥ÈîÆÂ≠óclass‰ªéES6ÂºÄÂßãÊ≠£ÂºèË¢´ÂºïÂÖ•Âà∞JavaScript‰∏≠„ÄÇclassÁöÑÁõÆÁöÑÂ∞±ÊòØËÆ©ÂÆö‰πâÁ±ªÊõ¥ÁÆÄÂçï„ÄÇ Â¶ÇÊûúÁî®Êñ∞ÁöÑclassÂÖ≥ÈîÆÂ≠óÊù•ÁºñÂÜôStudentÔºåÂèØ‰ª•ËøôÊ†∑ÂÜôÔºö123456789101112class Student &#123; constructor(name) &#123; this.name = name; &#125; hello() &#123; alert('Hello, ' + this.name + '!'); &#125;&#125;var xiaoming = new Student('Â∞èÊòé');xiaoming.hello(); name Â±ûÊÄß‰∏äÈù¢ËØ¥Âà∞ÔºåÂáΩÊï∞Êúâ name Â±ûÊÄßÔºåÂèØ‰ª•ËøîÂõûÂáΩÊï∞ÁöÑÂêçÂ≠ó„ÄÇES6 ÁöÑ class ÂÖ∂ÂÆûÂ∞±ÊòØ ES5 ÂáΩÊï∞ÁöÑÂåÖË£Ö„ÄÇÊâÄ‰ª• Class ‰πüÂåÖÂê´ name Â±ûÊÄßÔºö 12class Point &#123;&#125;Point.name // "Point" get set ÊñπÊ≥ïÂú®‚ÄúÁ±ª‚ÄùÁöÑÂÜÖÈÉ®ÂèØ‰ª•‰ΩøÁî®getÂíåsetÂÖ≥ÈîÆÂ≠óÔºåÂØπÊüê‰∏™Â±ûÊÄßËÆæÁΩÆÂ≠òÂÄºÂáΩÊï∞ÂíåÂèñÂÄºÂáΩÊï∞ÔºåÊã¶Êà™ËØ•Â±ûÊÄßÁöÑÂ≠òÂèñË°å‰∏∫Ôºö 12345678910111213141516171819class MyClass &#123; constructor() &#123; // ... &#125; get prop() &#123; return 'getter'; &#125; set prop(value) &#123; console.log('setter: '+value); &#125;&#125;let inst = new MyClass();inst.prop = 123;// setter: 123inst.prop// 'getter' static ÊñπÊ≥ïÂ¶ÇÊûúÂú®‰∏Ä‰∏™ÊñπÊ≥ïÂâçÔºåÂä†‰∏ästaticÂÖ≥ÈîÆÂ≠óÔºåË°®Á§∫Á±ªÊñπÊ≥ï: 1234567891011class Foo &#123; static classMethod() &#123; return 'hello'; &#125;&#125;Foo.classMethod() // 'hello'var foo = new Foo();foo.classMethod()// TypeError: foo.classMethod is not a function ES6 ÊòéÁ°ÆËßÑÂÆöÔºåClass ÂÜÖÈÉ®Âè™ÊúâÈùôÊÄÅÊñπÊ≥ïÔºåÊ≤°ÊúâÈùôÊÄÅÂ±ûÊÄß„ÄÇ new.target Â±ûÊÄßES6 ‰∏∫newÂëΩ‰ª§ÂºïÂÖ•‰∫Ü‰∏Ä‰∏™new.targetÂ±ûÊÄßÔºåËØ•Â±ûÊÄß‰∏ÄËà¨Áî®Âú®ÊûÑÈÄ†ÂáΩÊï∞‰πã‰∏≠ÔºåËøîÂõûnewÂëΩ‰ª§‰ΩúÁî®‰∫éÁöÑÈÇ£‰∏™ÊûÑÈÄ†ÂáΩÊï∞„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂ≠êÁ±ªÁªßÊâøÁà∂Á±ªÊó∂Ôºånew.target‰ºöËøîÂõûÂ≠êÁ±ª„ÄÇÂà©Áî®Ëøô‰∏™ÁâπÁÇπÔºåÂèØ‰ª•ÂÜôÂá∫‰∏çËÉΩÁã¨Á´ã‰ΩøÁî®„ÄÅÂøÖÈ°ªÁªßÊâøÂêéÊâçËÉΩ‰ΩøÁî®ÁöÑÊé•Âè£Ôºö 1234567891011121314151617class Shape &#123; constructor() &#123; if (new.target === Shape) &#123; throw new Error('Êú¨Á±ª‰∏çËÉΩÂÆû‰æãÂåñ'); &#125; &#125;&#125;class Rectangle extends Shape &#123; constructor(length, width) &#123; super(); // ... &#125;&#125;var x = new Shape(); // Êä•Èîôvar y = new Rectangle(3, 4); // Ê≠£Á°Æ classÁªßÊâøÁî®classÂÆö‰πâÂØπË±°ÁöÑÂè¶‰∏Ä‰∏™Â∑®Â§ßÁöÑÂ•ΩÂ§ÑÊòØÁªßÊâøÊõ¥Êñπ‰æø‰∫Ü,Áõ¥Êé•ÈÄöËøáextendsÊù•ÂÆûÁé∞Ôºö12345678910class PrimaryStudent extends Student &#123; constructor(name, grade) &#123; super(name); // ËÆ∞ÂæóÁî®superË∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ï! this.grade = grade; &#125; myGrade() &#123; alert('I am at grade ' + this.grade); &#125;&#125; ÈÄöËøásuper(name)Êù•Ë∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†ÂáΩÊï∞„ÄÇPrimaryStudentÂ∑≤ÁªèËá™Âä®Ëé∑Âæó‰∫ÜÁà∂Á±ªStudentÁöÑhelloÊñπÊ≥ïÔºåÊàë‰ª¨ÂèàÂú®Â≠êÁ±ª‰∏≠ÂÆö‰πâ‰∫ÜÊñ∞ÁöÑmyGradeÊñπÊ≥ï„ÄÇ export ‰∏é importÂü∫Êú¨Áî®Ê≥ï123456export let name = 'zachary'export function getName() &#123; return 'zachary'&#125;Á≠â‰ª∑‰∫é=&gt; export &#123;name, getName&#125; Ê≥®ÊÑèÔºå‰∏çËÉΩÁõ¥Êé•ÂÜôexport name,Ë¶ÅÂÜô‰πüË¶ÅÂÜôÊàê export {name}„ÄÇ‰∏∫‰ªÄ‰πàÂë¢ÔºüÂÖ∂ÂÆûÂ∞±Áõ∏ÂΩì‰∫éÁªô export ÁöÑÂØπË±°Ëµ∑‰∏Ä‰∏™ÂêçÂ≠óÔºåexport name Â∞±Áõ∏ÂΩì‰∫é export &#39;zachary&#39; ÔºåËøôÊ†∑Âà´‰∫∫Â∞±Êó†Ê≥ïÁü•ÈÅìÂ¶Ç‰ΩïÂºïÂÖ•‰∫ÜÔºåÊâÄ‰ª•Â∞±ÈúÄË¶ÅËµ∑‰∏Ä‰∏™ÂêçÂ≠óÔºöexport let name = &#39;zachary&#39; .ÂºïÂÖ•ÊñπÂºèÂ¶Ç‰∏ãÔºö 1import &#123;name, getName&#125; from './myName' import Âíå require ÈÉΩ‰∏çÈúÄË¶ÅÂÜô .js ÂêéÁºÄÔºÅÔºÅÔºÅ ÈáçÂëΩÂêç asÂØºÂá∫ÂØºÂÖ•ÁöÑÂêçÂ≠óÊúâÊó∂ÂÄôÂèØËÉΩÈúÄË¶ÅÊîπÂèòÔºåÊâÄ‰ª•Êèê‰æõ‰∫Ü as Ëøô‰∏™ÂÖ≥ÈîÆÂ≠óÔºö 12export &#123;name as yourName, getName as getYourName&#125;import &#123;yourName as myName, getYourName as getMyName&#125; from './myName' ÂØºÂá∫ÁöÑÊó∂ÂÄôÁî® yourName ‰Ωú‰∏∫ÂÜÖÈÉ® name ÁöÑÂà´Âêç„ÄÇÂØºÂÖ•ÁöÑÊó∂ÂÄôÁî® myName ‰Ωú‰∏∫ youName ÁöÑÂà´Âêç„ÄÇ defaultÊúâÊó∂ÂÄôÔºåÊàë‰ª¨‰∏çÈúÄË¶ÅÁü•ÈÅìÂØºÂá∫ÁöÑÂè´‰ªÄ‰πàÔºåÂèØ‰ª•‰ΩøÁî® default Ôºö 123456export default nameimport myName from './myName'Áõ∏ÂΩì‰∫é =&gt;export &#123;name as default&#125;import &#123;default as myName&#125; from './myName' ÂÖ∂ÂÆûÂ∞±ÊòØ as ÁöÑËØ≠Ê≥ïÁ≥ñ„ÄÇÊ≥®ÊÑèÔºåimport ÁöÑÊó∂ÂÄôÂ∞±‰∏çÈúÄË¶ÅÂ§ßÊã¨Âè∑‰∫Ü„ÄÇ ES6 Âíå CommonJs Âú®ÂºïÁî®ÊñπÂºèÁöÑÂ∑ÆÂºÇCommonJSÁöÑ‰∏Ä‰∏™Ê®°ÂùóÔºåÂ∞±ÊòØ‰∏Ä‰∏™ËÑöÊú¨Êñá‰ª∂„ÄÇrequireÂëΩ‰ª§Á¨¨‰∏ÄÊ¨°ÊâßË°åÁöÑÊó∂ÂÄôÔºåÂä†ËΩΩËØ•ËÑöÊú¨ÔºåÁÑ∂ÂêéÊâßË°åÊï¥‰∏™ËÑöÊú¨ ES6Ê®°ÂùóÁöÑËøêË°åÊú∫Âà∂‰∏éCommonJS‰∏ç‰∏ÄÊ†∑ÔºåÂÆÉÈÅáÂà∞Ê®°ÂùóÂä†ËΩΩÂëΩ‰ª§importÊó∂ÔºåÁõ¥Êé•ÊâßË°åÁõ∏Â∫îÁöÑÊñá‰ª∂ require ÁöÑÂ•ΩÂ§ÑÊòØÂèØ‰ª•Âú®‰ª£Á†Å‰∏≠‰ΩøÁî®ÔºåËÄå import Âè™ËÉΩÂú®Â§¥ÈÉ®„ÄÇËøôÊ†∑ require Â∞±ÂèØ‰ª•Âú®ÊâßË°åÂà∞ÂΩìÂâç‰ª£Á†ÅÁöÑÊó∂ÂÄôÔºåÊ†πÊçÆ‰ª£Á†ÅÁöÑ‰∏ä‰∏ãÊñáÂä®ÊÄÅÁöÑÂºïÂÖ•ÊÉ≥Ë¶ÅÁöÑÊ®°Âùó„ÄÇ ËÄå import ÊòØÂº∫Âà∂ÈùôÊÄÅÂåñÁöÑ Ê∑∑Áî®‰∫ßÁîüÁöÑÈóÆÈ¢òexport Âíå module.exports ÈÉΩÊòØÂØºÂá∫Ê®°ÂùóÔºå‰ΩÜÊòØÊúÄÂ•Ω‰∏çË¶ÅÂú®‰∏Ä‰∏™Êñá‰ª∂‰∏≠‰∏ÄËµ∑‰ΩøÁî®„ÄÇÊ∑∑Áî®‰ºö‰∫ßÁîü‰∏ÄÂÆöÁöÑÈóÆÈ¢ò„ÄÇ È¶ñÂÖàÔºåES6 ÁöÑ export Âú® webpack ÊâìÂåÖÂêéÈÉΩ‰ºöÂèòÊàê CommonJS ÁöÑËØ≠Ê≥ï„ÄÇÂõ†Ê≠§ export ÊúÄÁªà‰ºöÂèò‰∏∫ CommonJS ÁöÑ exports„ÄÇÂΩì exports Âíå module.exports ÂêåÊó∂Â≠òÂú®ÁöÑÊó∂ÂÄôÔºåÊúÄÁªàÂØºÂá∫ÁöÑÂ∞Ü‰ºöÊòØ module.exports ÁöÑÂØπË±°„ÄÇexports ÂØºÂá∫ÁöÑÂØπË±°‰ºöË¢´Ë¶ÜÁõñ„ÄÇ Ëøô‰∏™ÁªìËÆ∫ÈùûÂ∏∏ÈáçË¶Å„ÄÇÁâ¢ËÆ∞Ëøô‰∏™ÁªìËÆ∫Âú®Ê∑∑Áî®ÁöÑÊó∂ÂÄôÂ∞±ËÉΩÊòéÁôΩ‰∏∫‰ªÄ‰πàÂæàÂ§öÊó∂ÂÄô import ÁöÑÊó∂ÂÄôÊòØ undefined ÁöÑ‰∫Ü„ÄÇ ÂΩíÁ±ª‚Ä¶ ÁöÑ‰ΩøÁî®Âú∫ÊôØ‚Ä¶ ‰∏ÄËà¨Áî®Âú®Êï∞ÁªÑÂâçÔºåÊääÊï∞ÁªÑËΩ¨‰∏∫Áî®ÈÄóÂè∑ÈöîÂºÄÁöÑ‰∏Ä‰∏™‰∏™ÂÄº„ÄÇÂèØ‰ª•Ê≠£Áî®ÈÄÜÁî®ÈÉΩÊòØÁ≠â‰ª∑ÁöÑÔºö 12...[a, b, c] =&gt; a, b, ca, b, c =&gt; ...[a, b, c] ‰∏ÄËà¨Áî®‰∫éÔºö Â∞ÜÊï∞ÁªÑÊãÜÂºÄ‰Ωú‰∏∫ÂÖ•ÂèÇ Â∞ÜÂÖ•ÂèÇÂêàÂπ∂‰∏∫Êï∞ÁªÑ Êï∞ÁªÑËß£ÊûÑËµãÂÄº 123456// 1. ÂÅöÂÖ•ÂèÇsomeFunc(1, ...[2, 3, 4]) =&gt; someFunc(1, 2, 3, 4)// 2. ÂêàÂπ∂ÂÖ•ÂèÇfunction someFunc(1, ...args) &#123;&#125; =&gt; args = [2, 3, 4]// 3. Êï∞ÁªÑËß£ÊûÑ Á±ª‰ºº‰∫éÂêàÂπ∂ÂÖ•ÂèÇlet [1, ...args] = [1, 2, 3, 4] =&gt; args = [2, 3, 4] Âè¶Â§ñÔºåÂú® JSX ‰∏≠Ôºå... ÂèØ‰ª•ÊääÂØπË±°‰∏≠ÁöÑÈîÆÂÄºÂØπÊãøÂá∫Êù•Ôºå‰ª•Á≠âÂè∑ËøûÊé•„ÄÇ ÂØπË±°Âíå MapÂØπË±°Âíå Map ÂàùÊ≠•ÁöÑ‰∏çÂêåÂ∞±Âú®‰∫éÈîÆÊòØÂê¶ÊòØÂ≠óÁ¨¶‰∏≤„ÄÇ ÂàõÂª∫‰∏éÂ¢ûÂáèÈîÆÂÄºÂØπÂØπË±°Ôºö 123let obj = &#123;&#125;obj.haha = '123'delete obj.haha MapÔºö 1234let map = new Map()map.set('haha','123')map.get('haha')map.delete('haha') ÈÅçÂéÜÂØπË±°Ôºö 1Object.entries(obj) =&gt; [['haha', '123'], ['lala', '234']] MapÔºö 1map.entries() =&gt; [['haha', '123'], ['lala', '234']] Ê≤°ÊúâÁúãÁöÑ symbol ÈÉ®ÂàÜ reflect ÈÉ®ÂàÜ(ÊÑüËßâÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®Ôºå‰∏çÈúÄË¶Å‰ΩøÁî® reflect) generator ÈÉ®ÂàÜ(‰π†ÊÉØ‰∫éÁî®promiseÁöÑÂõûË∞ÉÂÜôÊ≥ïÔºå‰∏ç‰π†ÊÉØËøôÁßçÂÜôÊ≥ï) async ÈÉ®ÂàÜ(Âêå generator) port]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSÊâãÂäø‰∏éÂìçÂ∫îÊú∫Âà∂]]></title>
    <url>%2F2016%2F09%2F03%2Fios%E5%93%8D%E5%BA%94%E4%BA%8B%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[‰ªéÁÇπÂáªÂ±èÂπïÂà∞Á≥ªÁªüÂÅöÂá∫ÂìçÂ∫îÔºåÁªèÂéÜ‰∫ÜÂì™‰∫õËøáÁ®ãÔºüÈúÄË¶ÅËØ¶ÁªÜÊé¢Á©∂‰∏ãiosÁöÑÂìçÂ∫îÊú∫Âà∂„ÄÇ UIResponderÁÇπÂáª‰∫ã‰ª∂ÂìçÂ∫îÊµÅÁ®ã Á≥ªÁªüÂìçÂ∫îÈò∂ÊÆµ ÊâãÊåáËß¶Á¢∞Â±èÂπïÔºå‰∫ã‰ª∂‰∫§Áî± IOKit Â§ÑÁêÜ IOKit Â∞ÜËß¶Êë∏‰∫ã‰ª∂Â∞ÅË£Ö‰∏∫‰∏Ä‰∏™ Event ÂØπË±°ÔºåÈÄöËøá march port ‰º†ÈÄíÁªô SpringBoard Ê°åÈù¢ËøõÁ®ã„ÄÇ SpringBoard ËøõÁ®ãÂõ†Êé•Êî∂Âà∞Ëß¶Êë∏‰∫ã‰ª∂ÔºåËß¶Âèë‰∫ÜÂÖ∂‰∏ªÁ∫øÁ®ã runloop ÁöÑ source1 ‰∫ã‰ª∂Ê∫êÁöÑÂõûË∞É„ÄÇËã•ÂâçÂè∞Êó†Â∫îÁî®ÔºåÂàôËß¶Âèë SpringBoard Êú¨Ë∫´‰∏ªÁ∫øÁ®ã runloop ÁöÑ source0 ‰∫ã‰ª∂Ê∫êÁöÑÂõûË∞ÉÔºåÂ∞Ü‰∫ã‰ª∂‰∫§Áî±Ê°åÈù¢Á≥ªÁªüÂéªÊ∂àËÄóÔºõËã•ÂâçÂè∞ÊúâÂ∫îÁî®ÔºåÂàôÂ∞ÜËß¶Êë∏‰∫ã‰ª∂ÈÄöËøáIPC‰º†ÈÄíÁªôÂâçÂè∞APPËøõÁ®ã„ÄÇ APPÂìçÂ∫îÈò∂ÊÆµ APPËøõÁ®ãÁöÑ mach port Êé•ÂèóÂà∞ SpringBoard ËøõÁ®ã‰º†ÈÄíÊù•ÁöÑËß¶Êë∏‰∫ã‰ª∂Ôºå‰∏ªÁ∫øÁ®ãÁöÑ runloop Ë¢´Âî§ÈÜíÔºåËß¶Âèë‰∫Ü source1 ÂõûË∞É„ÄÇ source1 ÂõûË∞ÉÂèàËß¶Âèë‰∫Ü‰∏Ä‰∏™ source0 ÂõûË∞ÉÔºåÂ∞ÜÊé•Êî∂Âà∞ÁöÑ Event ÂØπË±°Â∞ÅË£ÖÊàê UIEvent ÂØπË±°ÔºåÊ≠§Êó∂APPÂ∞ÜÊ≠£ÂºèÂºÄÂßãÂØπ‰∫éËß¶Êë∏‰∫ã‰ª∂ÁöÑÂìçÂ∫î„ÄÇ source0 ÂõûË∞ÉÂÜÖÈÉ®Â∞ÜËß¶Êë∏‰∫ã‰ª∂Ê∑ªÂä†Âà∞ UIApplication ÂØπË±°ÁöÑ‰∫ã‰ª∂ÈòüÂàó‰∏≠„ÄÇ‰∫ã‰ª∂Âá∫ÈòüÂêéÔºåUIApplication ÂºÄÂßãÈÄöËøá‰∏çÊñ≠ hit-testing ÂØªÊâæÊúÄ‰Ω≥ÂìçÂ∫îËÄÖ„ÄÇ ÊâæÂà∞ÂìçÂ∫îËÄÖÂêéÔºå‰∫ã‰ª∂‰æøÂú®ÂìçÂ∫îÈìæ‰∏ä‰º†Êí≠„ÄÇ‰∫ãÂÆû‰∏äÔºå‰∫ã‰ª∂Èô§‰∫ÜË¢´ÂìçÂ∫îËÄÖÊ∂àËÄóÔºåËøòËÉΩË¢´ÊâãÂäøËØÜÂà´Âô®ÊàñÊòØ target-action Ê®°ÂºèÊçïÊçâÂπ∂Ê∂àËÄóÊéâ„ÄÇ ‰∫ã‰ª∂Â§ÑÁêÜÂÆåÊØïÂêéÔºårunloop ËøõÂÖ•‰ºëÁú†„ÄÇÁ≠âÂæÖÂÜçÊ¨°Ë¢´Âî§ÈÜí„ÄÇ Âá†‰∏™ÂêçËØçÔºöÂìçÂ∫îËÄÖ„ÄÅËß¶Êë∏„ÄÅ‰∫ã‰ª∂UIResponderÂú®iOS‰∏≠‰∏çÊòØ‰ªª‰ΩïÂØπË±°ÈÉΩËÉΩÂ§ÑÁêÜ‰∫ã‰ª∂ÔºåÂè™ÊúâÁªßÊâø‰∫ÜUIResponderÁöÑÂØπË±°ÊâçËÉΩÊé•ÂèóÂπ∂Â§ÑÁêÜ‰∫ã‰ª∂ÔºåÊàë‰ª¨Áß∞‰πã‰∏∫‚ÄúÂìçÂ∫îËÄÖÂØπË±°‚Äù„ÄÇ ‰ª•‰∏ãÈÉΩÊòØÁªßÊâøËá™UIResponderÁöÑÔºåÊâÄ‰ª•ÈÉΩËÉΩÊé•Êî∂Âπ∂Â§ÑÁêÜ‰∫ã‰ª∂: UIApplication UIViewController UIView ÈÇ£‰πà‰∏∫‰ªÄ‰πàÁªßÊâøËá™UIResponderÁöÑÁ±ªÂ∞±ËÉΩÂ§üÊé•Êî∂Âπ∂Â§ÑÁêÜ‰∫ã‰ª∂Âë¢ÔºüÂõ†‰∏∫UIResponder‰∏≠Êèê‰æõ‰∫Ü‰ª•‰∏ã4‰∏™ÂØπË±°ÊñπÊ≥ïÊù•Â§ÑÁêÜËß¶Êë∏‰∫ã‰ª∂„ÄÇ1234- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event;- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event;- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event;- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event; UITouch ‰∏Ä‰∏™ÊâãÊåá‰∏ÄÊ¨°Ëß¶Êë∏Â±èÂπïÔºåÂ∞±ÂØπÂ∫îÁîüÊàê‰∏Ä‰∏™UITouchÂØπË±°„ÄÇÂ§ö‰∏™ÊâãÊåáÂêåÊó∂Ëß¶Êë∏ÔºåÁîüÊàêÂ§ö‰∏™UITouchÂØπË±°„ÄÇ ÊØè‰∏™UITouchÂØπË±°ËÆ∞ÂΩï‰∫ÜËß¶Êë∏ÁöÑ‰∏Ä‰∫õ‰ø°ÊÅØÔºåÂåÖÊã¨Ëß¶Êë∏Êó∂Èó¥„ÄÅ‰ΩçÁΩÆ„ÄÅÈò∂ÊÆµ„ÄÅÊâÄÂ§ÑÁöÑËßÜÂõæ„ÄÅÁ™óÂè£Á≠â‰ø°ÊÅØ„ÄÇ UITouch Êèê‰æõ‰∫ÜËé∑ÂèñÁõ∏ÂØπ‰∫éËßÜÂõæÁöÑÂùêÊ†áÁöÑÊñπÊ≥ïÔºö 1- (CGPoint)locationInView:(UIView *)view; UIEvent Ëß¶Êë∏ÁöÑÁõÆÁöÑÊòØÁîüÊàêËß¶Êë∏‰∫ã‰ª∂‰æõÂìçÂ∫îËÄÖÂìçÂ∫îÔºå‰∏Ä‰∏™Ëß¶Êë∏‰∫ã‰ª∂ÂØπÂ∫î‰∏Ä‰∏™UIEventÂØπË±° UIEventÂØπË±°‰∏≠ÂåÖÂê´‰∫ÜËß¶ÂèëËØ•‰∫ã‰ª∂ÁöÑËß¶Êë∏ÂØπË±°ÁöÑÈõÜÂêàÔºåÂèØ‰ª•ÈÄöËøáallTouches Â±ûÊÄßËé∑Âèñ„ÄÇ ‰æã1Ôºö‰ΩøÁî® UITouch ÂÆûÁé∞ UIView ÁöÑÊãñÊãΩÈÄöËøá UIResponder Âíå UITouch ÁöÑËßÜÂõæÂÆö‰ΩçÔºåÂèØ‰ª•ÂÆûÁé∞ÊãñÊãΩ UI ÁöÑÂäüËÉΩ 1234567891011121314151617181920- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event&#123; // ÊÉ≥ËÆ©Êéß‰ª∂ÈöèÁùÄÊâãÊåáÁßªÂä®ËÄåÁßªÂä®,ÁõëÂê¨ÊâãÊåáÁßªÂä® // Ëé∑ÂèñUITouchÂØπË±° UITouch *touch = [touches anyObject]; // Ëé∑ÂèñÂΩìÂâçÁÇπÁöÑ‰ΩçÁΩÆ CGPoint curP = [touch locationInView:self]; // Ëé∑Âèñ‰∏ä‰∏Ä‰∏™ÁÇπÁöÑ‰ΩçÁΩÆ CGPoint preP = [touch previousLocationInView:self]; // Ëé∑ÂèñÂÆÉ‰ª¨xËΩ¥ÁöÑÂÅèÁßªÈáè,ÊØèÊ¨°ÈÉΩÊòØÁõ∏ÂØπ‰∏ä‰∏ÄÊ¨° CGFloat offsetX = curP.x - preP.x; // Ëé∑ÂèñyËΩ¥ÁöÑÂÅèÁßªÈáè CGFloat offsetY = curP.y - preP.y; // ‰øÆÊîπÊéß‰ª∂ÁöÑÂΩ¢ÂèòÊàñËÄÖframe,center,Â∞±ÂèØ‰ª•ÊéßÂà∂Êéß‰ª∂ÁöÑ‰ΩçÁΩÆ // ÂΩ¢Âèò‰πüÊòØÁõ∏ÂØπ‰∏ä‰∏ÄÊ¨°ÂΩ¢Âèò(Âπ≥Áßª) // CGAffineTransformMakeTranslation:‰ºöÊää‰πãÂâçÂΩ¢ÂèòÁªôÊ∏ÖÁ©∫,ÈáçÊñ∞ÂºÄÂßãËÆæÁΩÆÂΩ¢ÂèòÂèÇÊï∞ // make:Áõ∏ÂØπ‰∫éÊúÄÂéüÂßãÁöÑ‰ΩçÁΩÆÂΩ¢Âèò // CGAffineTransform t:Áõ∏ÂØπËøô‰∏™tÁöÑÂΩ¢ÂèòÁöÑÂü∫Á°Ä‰∏äÂÜçÂéªÂΩ¢Âèò // Â¶ÇÊûúÁõ∏ÂØπÂì™‰∏™ÂΩ¢ÂèòÂÜçÊ¨°ÂΩ¢Âèò,Â∞±‰º†ÂÖ•ÂÆÉÁöÑÂΩ¢Âèò self.transform = CGAffineTransformTranslate(self.transform, offsetX, offsetY);&#125; ‰æã2ÔºöÈÖçÂêà CAShapeLayer ÂÆûÁé∞‰∏Ä‰∏™ÁîªÊùøÁÆÄÂçïËØ¥Â∞±ÊòØËÆ∞ÂΩï‰∏ãÊî∂ÊãæÁöÑË¥ùÂ°ûÂ∞îÊõ≤Á∫øÔºåÁÑ∂ÂêéÂ∞ÜËøô‰∏™Êõ≤Á∫øÁöÑ path ËÆæÁΩÆÁªô CAShapeLayerÔºö 1234567891011121314151617181920212223242526272829303132333435363738- (CAShapeLayer *)shapeLayer&#123; if (_shapeLayer == nil) &#123; _shapeLayer = [CAShapeLayer layer]; _shapeLayer.strokeColor = [UIColor blackColor].CGColor; _shapeLayer.fillColor = [UIColor clearColor].CGColor; _shapeLayer.lineJoin = kCALineJoinRound; _shapeLayer.lineCap = kCALineCapRound; _shapeLayer.lineWidth = 10; [self.layer addSublayer:_shapeLayer]; &#125; return _shapeLayer; &#125;- (UIBezierPath *)path&#123; if (_path == nil) &#123; _path = [UIBezierPath bezierPath]; _path.lineWidth = 10; &#125; return _path;&#125;- (void)touchesMoved:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123; UITouch *touch = [touches anyObject]; CGPoint point = [touch locationInView:self]; [self.path addLineToPoint:point]; self.shapeLayer.path = self.path.CGPath;&#125;- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123; UITouch *touch = [touches anyObject]; CGPoint point = [touch locationInView:self]; [self.path moveToPoint:point];&#125;- (void)touchesEnded:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123; self.shapeLayer = nil; self.path = nil;&#125; Âêë‰∏ãÂØªÊâæÂìçÂ∫îËÄÖÁöÑËøáÁ®ãËá™‰∏äËÄå‰∏ãÁöÑÂØªÊâæËøáÁ®ã UIApplicationÈ¶ñÂÖàÂ∞Ü‰∫ã‰ª∂‰º†ÈÄíÁªô UIWindowÔºåÂ§ö‰∏™Á™óÂè£‰ºòÂÖàÊúÄ‰∏äÂ±ÇÁöÑÁ™óÂè£„ÄÇ Ë∞ÉÁî® hitTest ÊñπÊ≥ïÔºåËØ¢ÈóÆÊòØÂê¶ÂèØ‰ª•ÂìçÂ∫î„ÄÇËßÜÂõæËã•‰∏çËÉΩÂìçÂ∫îÔºåÂàôÂ∞Ü‰∫ã‰ª∂‰º†ÈÄíÁªô‰∏ä‰∏Ä‰∏™ÂêåÁ∫ßÂ≠êËßÜÂõæÔºõËã•ËÉΩÂìçÂ∫îÔºåÂàô‰ªéÂêéÂæÄÂâçËØ¢ÈóÆÂΩìÂâçËßÜÂõæÁöÑÂ≠êËßÜÂõæ„ÄÇ ÈáçÂ§çÊ≠•È™§2„ÄÇËßÜÂõæËã•Ê≤°ÊúâËÉΩÂìçÂ∫îÁöÑÂ≠êËßÜÂõæ‰∫ÜÔºåÂàôËá™Ë∫´Â∞±ÊòØÊúÄÂêàÈÄÇÁöÑÂìçÂ∫îËÄÖ„ÄÇ Êó†Ê≥ïÂìçÂ∫îÁöÑÊÉÖÂÜµ ‰∏çÂÖÅËÆ∏‰∫§‰∫íÔºöuserInteractionEnabled = NO ÈöêËóèÔºöÂ¶ÇÊûúÊääÁà∂Êéß‰ª∂ÈöêËóèÔºåÈÇ£‰πàÂ≠êÊéß‰ª∂‰πü‰ºöÈöêËóèÔºåÈöêËóèÁöÑÊéß‰ª∂‰∏çËÉΩÊé•Âèó‰∫ã‰ª∂ ÈÄèÊòéÂ∫¶ÔºöÂ¶ÇÊûúËÆæÁΩÆ‰∏Ä‰∏™Êéß‰ª∂ÁöÑÈÄèÊòéÂ∫¶&lt;0.01Ôºå‰ºöÁõ¥Êé•ÂΩ±ÂìçÂ≠êÊéß‰ª∂ÁöÑÈÄèÊòéÂ∫¶„ÄÇalphaÔºö0.0~0.01‰∏∫ÈÄèÊòé„ÄÇ Ê≥®ÊÑè: ÈªòËÆ§UIImageView‰∏çËÉΩÊé•ÂèóËß¶Êë∏‰∫ã‰ª∂ÔºåÂõ†‰∏∫‰∏çÂÖÅËÆ∏‰∫§‰∫íÔºåÂç≥userInteractionEnabled = NOÔºåÊâÄ‰ª•Â¶ÇÊûúÂ∏åÊúõUIImageViewÂèØ‰ª•‰∫§‰∫íÔºåÈúÄË¶ÅuserInteractionEnabled = YES„ÄÇ Âà§Êñ≠ÊòØÂê¶ÂèØ‰ª•ÂìçÂ∫îÁöÑÈÄªËæë12345678910111213141516171819202122- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event&#123; //3ÁßçÁä∂ÊÄÅÊó†Ê≥ïÂìçÂ∫î‰∫ã‰ª∂ if (self.userInteractionEnabled == NO || self.hidden == YES || self.alpha &lt;= 0.01) return nil; //Ëß¶Êë∏ÁÇπËã•‰∏çÂú®ÂΩìÂâçËßÜÂõæ‰∏äÂàôÊó†Ê≥ïÂìçÂ∫î‰∫ã‰ª∂ if ([self pointInside:point withEvent:event] == NO) return nil; //‰ªéÂêéÂæÄÂâçÈÅçÂéÜÂ≠êËßÜÂõæÊï∞ÁªÑ int count = (int)self.subviews.count; for (int i = count - 1; i &gt;= 0; i--) &#123; // Ëé∑ÂèñÂ≠êËßÜÂõæ UIView *childView = self.subviews[i]; // ÂùêÊ†áÁ≥ªÁöÑËΩ¨Êç¢,ÊääËß¶Êë∏ÁÇπÂú®ÂΩìÂâçËßÜÂõæ‰∏äÂùêÊ†áËΩ¨Êç¢‰∏∫Âú®Â≠êËßÜÂõæ‰∏äÁöÑÂùêÊ†á CGPoint childP = [self convertPoint:point toView:childView]; //ËØ¢ÈóÆÂ≠êËßÜÂõæÂ±ÇÁ∫ß‰∏≠ÁöÑÊúÄ‰Ω≥ÂìçÂ∫îËßÜÂõæ UIView *fitView = [childView hitTest:childP withEvent:event]; if (fitView) &#123; //Â¶ÇÊûúÂ≠êËßÜÂõæ‰∏≠ÊúâÊõ¥ÂêàÈÄÇÁöÑÂ∞±ËøîÂõû return fitView; &#125; &#125; //Ê≤°ÊúâÂú®Â≠êËßÜÂõæ‰∏≠ÊâæÂà∞Êõ¥ÂêàÈÄÇÁöÑÂìçÂ∫îËßÜÂõæÔºåÈÇ£‰πàËá™Ë∫´Â∞±ÊòØÊúÄÂêàÈÄÇÁöÑ return self;&#125; pointInside:withEvent: Ëøô‰∏™ÊñπÊ≥ïÔºåÁî®‰∫éÂà§Êñ≠Ëß¶Êë∏ÁÇπÊòØÂê¶Âú®Ëá™Ë∫´ÂùêÊ†áËåÉÂõ¥ÂÜÖ ‰æã1ÔºöË∂ÖÂá∫Áà∂ËßÜÂõæÂå∫ÂüüÁöÑÁÇπÂáªÂìçÂ∫îÂºÄÂèë‰∏≠ÂèØËÉΩ‰ºöÈÅáÂà∞‰∏ÄÁßçÊÉÖÂÜµÔºöTabbar ‰∏≠ÁöÑ‰∏Ä‰∏™ÊåâÈíÆË∂ÖÂá∫‰∫Ü tabbar ÊòæÁ§∫ÁöÑÂå∫Âüü„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÁÇπÂáªË∂ÖÂá∫ÈÉ®ÂàÜÊòØÊó†Ê≥ïÂìçÂ∫îÁÇπÂáª‰∫ã‰ª∂ÁöÑ„ÄÇ Âõ†‰∏∫Ëß¶Êë∏ÁÇπ‰∏çÂú®TabBarÁöÑÂùêÊ†áËåÉÂõ¥ÂÜÖÔºåÂõ†Ê≠§TabBarÊó†Ê≥ïÂìçÂ∫îËØ•Ëß¶Êë∏‰∫ã‰ª∂ÔºåhitTest:withEvent: Áõ¥Êé•ËøîÂõû‰∫Ünil„ÄÇÊï¥‰∏™ËøáÁ®ãÔºå‰∫ã‰ª∂Ê†πÊú¨Ê≤°Êúâ‰º†ÈÄíÂà∞ÂúÜÂΩ¢ÊåâÈíÆ„ÄÇÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂÅöÁöÑÊòØÊâ©Â§ß tabbar ÁöÑÁÇπÂáªËåÉÂõ¥„ÄÇ Êàë‰ª¨ÈúÄË¶ÅÈáçÂÜô tabbar ÁöÑ pointInside:withEvent: ÊñπÊ≥ïÔºåÂÖàÊää‰ΩçÁΩÆËΩ¨Êç¢Âà∞ÊåâÈíÆ‰∏äÂà§Êñ≠‰∏Ä‰∏ãÊòØÂê¶ÁÇπÂáª‰∫ÜÊåâÈíÆÔºö 1234567891011//TabBar- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event &#123; //Â∞ÜËß¶Êë∏ÁÇπÂùêÊ†áËΩ¨Êç¢Âà∞Âú®CircleButton‰∏äÁöÑÂùêÊ†á CGPoint pointTemp = [self convertPoint:point toView:_CircleButton]; //Ëã•Ëß¶Êë∏ÁÇπÂú®CricleButton‰∏äÂàôËøîÂõûYES if ([_CircleButton pointInside:pointTemp withEvent:event]) &#123; return YES; &#125; //Âê¶ÂàôËøîÂõûÈªòËÆ§ÁöÑÊìç‰Ωú return [super pointInside:point withEvent:event];&#125; ‰æã2ÔºöÊåâÈíÆÊâ©Â§ßÂìçÂ∫îÂå∫ÂüüÂíå‰∏äÈù¢Á±ª‰ººÔºåËøòÊòØÈáçÂÜô pointInside:withEvent: ÊñπÊ≥ïÔºö 12345- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event &#123; // Â∞Ü‰∏Ä‰∏™ 100*100 ÁöÑÊåâÈíÆÊâ©Â§ß‰∏∫ 300*300 ÁöÑÊåâÈíÆ CGRect rect = CGRectMake(-100, -100, 300, 300); return CGRectContainsPoint(rect, point) ? YES : NO;&#125; ‰∫ã‰ª∂ÂìçÂ∫îÁöÑÂêë‰∏ä‰º†ÈÄíÂú®ÊâæÂà∞ÊúÄ‰Ω≥ÂìçÂ∫îËÄÖ‰πãÂêéÔºåUIApplicationÂ∞Ü‰∫ã‰ª∂ÈÄöËøá sendEvent: ‰º†ÈÄíÁªô‰∫ã‰ª∂ÊâÄÂ±ûÁöÑwindowÔºåwindowÂêåÊ†∑ÈÄöËøá sendEvent: ÂÜçÂ∞Ü‰∫ã‰ª∂‰º†ÈÄíÁªôÊúÄ‰Ω≥ÂìçÂ∫îËÄÖÔºö 1UIApplication ‚Äî‚Äî&gt; UIWindow ‚Äî‚Äî&gt; hit-tested view ÂìçÂ∫îËÄÖÊé•Êî∂Âà∞Êó∂Èó¥‰πãÂêéÔºå‰ºöÂõûË∞É UIResponder ‰∏≠ÁöÑ touchesBegan:withEvent: ÊñπÊ≥ï„ÄÇÂìçÂ∫îËÄÖÂØπ‰∫éÊé•Êî∂Âà∞ÁöÑ‰∫ã‰ª∂Êúâ3ÁßçÊìç‰ΩúÔºö ‰∏çÊã¶Êà™ÔºåÈªòËÆ§Êìç‰Ωú‰∫ã‰ª∂‰ºöËá™Âä®Ê≤øÁùÄÈªòËÆ§ÁöÑÂìçÂ∫îÈìæÂæÄ‰∏ã‰º†ÈÄí Êã¶Êà™Ôºå‰∏çÂÜçÂæÄ‰∏ãÂàÜÂèë‰∫ã‰ª∂„ÄÇÈáçÂÜô touchesBegan:withEvent: ËøõË°å‰∫ã‰ª∂Â§ÑÁêÜÔºå‰∏çË∞ÉÁî®Áà∂Á±ªÁöÑ touchesBegan:withEvent: Êã¶Êà™ÔºåÁªßÁª≠ÂæÄ‰∏ãÂàÜÂèë‰∫ã‰ª∂„ÄÇÈáçÂÜô touchesBegan:withEvent: ËøõË°å‰∫ã‰ª∂Â§ÑÁêÜÔºåÂêåÊó∂Ë∞ÉÁî®Áà∂Á±ªÁöÑ touchesBegan:withEvent: Â∞Ü‰∫ã‰ª∂ÂæÄ‰∏ã‰º†ÈÄí ÊØè‰∏Ä‰∏™ÂìçÂ∫îËÄÖÂØπË±°ÔºàUIResponderÂØπË±°ÔºâÈÉΩÊúâ‰∏Ä‰∏™ nextResponder ÊñπÊ≥ïÔºåÁî®‰∫éËé∑ÂèñÂìçÂ∫îÈìæ‰∏≠ÂΩìÂâçÂØπË±°ÁöÑ‰∏ã‰∏Ä‰∏™ÂìçÂ∫îËÄÖ„ÄÇË∞ÉÁî®Áà∂Á±ªÁöÑ touchesBegan:withEvent: ‰ºöÈªòËÆ§Ë∞ÉÁî® nextResponder ÁöÑ touchesBegan:withEvent:„ÄÇÂõ†Ê≠§ÔºåÂ∞±ÊääÂìçÂ∫î‰∫ã‰ª∂Âêë‰∏ä‰º†ÈÄí‰∫Ü„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂìçÂ∫îÈìæ nextResponder ÊâæÂà∞‰∏ã‰∏ÄÁ∫ßÂìçÂ∫îËÄÖÔºåÁõ¥Âà∞ÊâæÂà∞ UIViewController ÁöÑÂ≠êÁ±ª UIGestureRecognizerÊâãÂäøÁÆÄ‰ªãUIGestureRecognizer ÊòØÊâãÂäøÁöÑÂü∫Á±ªÔºåÂèØ‰ª•ÂàõÂª∫ÂÖ∂Ê¥æÁîüÁ±ªÂÆû‰æãÊù•Êª°Ë∂≥‰∏çÂêåÈúÄÊ±Ç„ÄÇ ÂàùÂßãÂåñÊñπÊ≥ïUIGestureRecognizerÁ±ª‰∏∫ÂÖ∂Â≠êÁ±ªÂáÜÂ§áÂ•Ω‰∫Ü‰∏Ä‰∏™Áªü‰∏ÄÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºö 1- (instancetype)initWithTarget:(nullable id)target action:(nullable SEL)action; ÊâãÂäøÁä∂ÊÄÅUIgestureRecognizerÁ±ª‰∏≠ÊúâÂ¶Ç‰∏ã‰∏Ä‰∏™Â±ûÊÄßÔºåÈáåÈù¢Êûö‰∏æ‰∫Ü‰∏Ä‰∫õÊâãÂäøÁöÑÂΩìÂâçÁä∂ÊÄÅ: 1@property(nonatomic,readonly) UIGestureRecognizerState state; Êûö‰∏æÂÄºÂ¶Ç‰∏ãÔºö 123456789typedef NS_ENUM(NSInteger, UIGestureRecognizerState) &#123; UIGestureRecognizerStatePossible, // ÈªòËÆ§ÁöÑÁä∂ÊÄÅÔºåËøô‰∏™Êó∂ÂÄôÁöÑÊâãÂäøÂπ∂Ê≤°ÊúâÂÖ∑‰ΩìÁöÑÊÉÖÂΩ¢Áä∂ÊÄÅ UIGestureRecognizerStateBegan, // ÊâãÂäøÂºÄÂßãË¢´ËØÜÂà´ÁöÑÁä∂ÊÄÅ UIGestureRecognizerStateChanged, // ÊâãÂäøËØÜÂà´ÂèëÁîüÊîπÂèòÁöÑÁä∂ÊÄÅ(ÊâãÂäøÊ≠£Âú®ÁßªÂä®ÁöÑÁä∂ÊÄÅ) UIGestureRecognizerStateEnded, // ÊâãÂäøËØÜÂà´ÁªìÊùüÔºåÂ∞Ü‰ºöÊâßË°åËß¶ÂèëÁöÑÊñπÊ≥ï UIGestureRecognizerStateCancelled, // ÊâãÂäøËØÜÂà´ÂèñÊ∂à UIGestureRecognizerStateFailed, // ËØÜÂà´Â§±Ë¥•ÔºåÊñπÊ≥ïÂ∞Ü‰∏ç‰ºöË¢´Ë∞ÉÁî® UIGestureRecognizerStateRecognized&#125;; ÂèØ‰ª•Âú®ÊâãÂäøÁöÑÂ§ÑÁêÜÊñπÊ≥ï‰∏≠ÔºåÂà§Êñ≠ÊâãÂäøÁöÑÁä∂ÊÄÅÔºåÂå∫ÂàÜ‰∏çÂêåÁöÑÂ§ÑÁêÜÊñπÂºè„ÄÇ Â∏∏Áî®Â±ûÊÄßÂíåÊñπÊ≥ï123456789101112//ËÆæÁΩÆ‰ª£ÁêÜÔºåÂÖ∑‰ΩìÁöÑÂçèËÆÆÂêéÈù¢‰ºöËØ¥@property(nullable,nonatomic,weak) id &lt;UIGestureRecognizerDelegate&gt; delegate; //ËÆæÁΩÆÊâãÂäøÊòØÂê¶ÊúâÊïà@property(nonatomic, getter=isEnabled) BOOL enabled;//Ëé∑ÂèñÊâãÂäøÊâÄÂú®ÁöÑview@property(nullable, nonatomic,readonly) UIView *view; //Ëé∑ÂèñËß¶ÂèëËß¶Êë∏ÁöÑÁÇπ- (CGPoint)locationInView:(nullable UIView*)view; //ËÆæÁΩÆËß¶Êë∏ÁÇπÊï∞- (NSUInteger)numberOfTouches; //Ëé∑ÂèñÊüê‰∏Ä‰∏™Ëß¶Êë∏ÁÇπÁöÑËß¶Êë∏‰ΩçÁΩÆ- (CGPoint)locationOfTouch:(NSUInteger)touchIndex inView:(nullable UIView*)view; ÂÖ∂‰∏≠ÔºåUITouch‰πüÊúâ‰∏Ä‰∏™ÊñπÊ≥ïÊòØlocationInView:ÂèØ‰ª•Ëé∑ÂèñËß¶Êë∏ÁÇπÂú®view‰∏≠ÁöÑ‰ΩçÁΩÆ„ÄÇ ‰ª£ÁêÜÊñπÊ≥ï UIGestureRecognizerDelegate1234567891011//ÊâãÊåáËß¶Êë∏Â±èÂπïÂêéÂõûË∞ÉÁöÑÊñπÊ≥ïÔºåËøîÂõûNOÂàô‰∏çÂÜçËøõË°åÊâãÂäøËØÜÂà´ÔºåÊñπÊ≥ïËß¶ÂèëÁ≠â- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch;//ÂºÄÂßãËøõË°åÊâãÂäøËØÜÂà´Êó∂Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÔºåËøîÂõûNOÂàôÁªìÊùüÔºå‰∏çÂÜçËß¶ÂèëÊâãÂäø- (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer;//ÊòØÂê¶ÊîØÊåÅÂ§öÊó∂ÂÄôËß¶ÂèëÔºåËøîÂõûYESÔºåÂàôÂèØ‰ª•Â§ö‰∏™ÊâãÂäø‰∏ÄËµ∑Ëß¶ÂèëÊñπÊ≥ïÔºåËøîÂõûNOÂàô‰∏∫‰∫íÊñ•- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer;//‰∏ãÈù¢Ëøô‰∏™‰∏§‰∏™ÊñπÊ≥ï‰πüÊòØÁî®Êù•ÊéßÂà∂ÊâãÂäøÁöÑ‰∫íÊñ•ÊâßË°åÁöÑ//Ëøô‰∏™ÊñπÊ≥ïËøîÂõûYESÔºåÁ¨¨‰∏Ä‰∏™ÊâãÂäøÂíåÁ¨¨‰∫å‰∏™‰∫íÊñ•Êó∂ÔºåÁ¨¨‰∏Ä‰∏™‰ºöÂ§±Êïà- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRequireFailureOfGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer//Ëøô‰∏™ÊñπÊ≥ïËøîÂõûYESÔºåÁ¨¨‰∏Ä‰∏™ÂíåÁ¨¨‰∫å‰∏™‰∫íÊñ•Êó∂ÔºåÁ¨¨‰∫å‰∏™‰ºöÂ§±Êïà- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldBeRequiredToFailByGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer ÊâãÂäø‰∫íÊñ•Âêå‰∏Ä‰∏™View‰∏äÊòØÂèØ‰ª•Ê∑ªÂä†Â§ö‰∏™ÊâãÂäøÂØπË±°ÁöÑÔºåÈªòËÆ§Ëøô‰∏™ÊâãÂäøÊòØ‰∫íÊñ•ÁöÑÔºåÂπ∂‰∏îËß¶ÂèëÊòØÈöèÊú∫ÁöÑÔºå‰∏Ä‰∏™ÊâãÂäøËß¶Âèë‰∫ÜÂ∞±‰ºöÈªòËÆ§Â±èËîΩÂÖ∂‰ªñÁõ∏‰ººÁöÑÊâãÂäøÂä®‰Ωú„ÄÇ Â¶ÇÊûúÊàë‰ª¨ÊÉ≥ËÆæÁΩÆ‰∏Ä‰∏ãÂΩìÊâãÂäø‰∫íÊñ•Êó∂Ë¶Å‰ºòÂÖàËß¶ÂèëÁöÑÊâãÂäøÔºåÂèØ‰ª•‰ΩøÁî®Â¶Ç‰∏ãÁöÑÊñπÊ≥ïÔºö 1[ges requireGestureRecognizerToFail:ges2]; Ë°®Á§∫Â¶ÇÊûúges2ÂåπÈÖçÔºåÈÇ£‰πà‰∏ç‰ºöÊâßË°åges„ÄÇÂè™ÊúâÂΩìges2‰∏çÂåπÈÖçÁöÑÊó∂ÂÄôÔºåÊâç‰ºöÊâßË°åges„ÄÇËøô‰∏™ÊñπÊ≥ïËøòÈÄÇÁî®‰∫éËØÜÂà´ÂèåÂáªÊâãÂäøÊó∂Â±èËîΩÂçïÂáªÊâãÂäø„ÄÇÂè™ÊúâÁ°ÆÂÆö‰∏çÊòØÂèåÂáªÊâãÂäøÂêéÂÜçËØÜÂà´‰∏∫ÂçïÂáªÊâãÂäø UIGestureRecoginzer Â≠êÁ±ªÁÇπÂáªÊâãÂäø‚Äî‚ÄîUITapGestureRecognizer1234//ËÆæÁΩÆÁÇπÂáªÊ¨°Êï∞ÔºåÈªòËÆ§‰∏∫ÂçïÂáª@property (nonatomic) NSUInteger numberOfTapsRequired; //ËÆæÁΩÆÂêåÊó∂ÁÇπÂáªÁöÑÊâãÊåáÊï∞@property (nonatomic) NSUInteger numberOfTouchesRequired; ÊçèÂêàÊâãÂäø‚Äî‚ÄîUIPinchGestureRecognizer1234//ËÆæÁΩÆÁº©ÊîæÊØî‰æã@property (nonatomic) CGFloat scale; //ËÆæÁΩÆÊçèÂêàÈÄüÂ∫¶@property (nonatomic,readonly) CGFloat velocity; Âú®ËÆæÁΩÆÂÆåÁº©ÊîæÂêéÔºå‰∏ÄÂÆöË¶ÅÊäärecognizer.scaleËÆæÁΩÆ‰∏∫1 123456- (void)handlePinch:(UIPinchGestureRecognizer*)recognizer&#123; NSLog(@"Áº©ÊîæÊìç‰Ωú");//Â§ÑÁêÜÁº©ÊîæÊìç‰Ωú //ÂØπimageviewÁº©Êîæ _imageView.transform = CGAffineTransformScale(_imageView.transform, recognizer.scale, recognizer.scale); recognizer.scale = 1;&#125; ÊãñÊãΩÊâãÂäø‚Äî‚ÄîUIPanGestureRecognzer12345678//ËÆæÁΩÆËß¶ÂèëÊãñÊãΩÁöÑÊúÄÂ∞ëËß¶Êë∏ÁÇπÔºåÈªòËÆ§‰∏∫1@property (nonatomic) NSUInteger minimumNumberOfTouches; //ËÆæÁΩÆËß¶ÂèëÊãñÊãΩÁöÑÊúÄÂ§öËß¶Êë∏ÁÇπ@property (nonatomic) NSUInteger maximumNumberOfTouches; //Ëé∑ÂèñÊâãÂäøÁöÑÂΩìÂâç‰ΩçÁΩÆ- (CGPoint)translationInView:(nullable UIView *)view; //ËÆæÁΩÆÊâãÂäøÁöÑÂΩìÂâç‰ΩçÁΩÆ- (void)setTranslation:(CGPoint)translation inView:(nullable UIView *)view; ÊãñÂä®ËøáÁ®ã‰∏≠Â§ÑÁêÜÊñπÊ≥ï‰ºöË¢´Â§öÊ¨°Ë∞ÉÁî®Ôºå‰ΩÜÊòØÂú®‰∏ÄÊ¨°ÊãñÊãΩÁªìÂâçÔºåtranslationInView: ÊñπÊ≥ïÂèÇÁÖßÁöÑÁÇπÈÉΩÊòØÊúÄÂºÄÂßãÊåâ‰∏ãÁöÑÁÇπ„ÄÇËøôÂ∞±ÂØºËá¥Â¢ûÈáèÁöÑÊãñÂä®ÔºåË∂äÊãñË∂äÂø´„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂøÖÈ°ª‰ΩøÁî®setTranslationËÆæÁΩÆ‰∏∫CGPointZeroÔºåÂ∞±ËÉΩÂ∞ÜÊâãÊåáÁöÑÂΩìÂâç‰ΩçÁΩÆËÆæÁΩÆ‰∏∫ÊãñÁßªÊâãÂäøÁöÑËµ∑Âßã‰ΩçÁΩÆÔºö 12345678910-(void)handlePan:(UIPanGestureRecognizer*)recognizer&#123; NSLog(@"ÊãñÂä®Êìç‰Ωú"); //Â§ÑÁêÜÊãñÂä®Êìç‰Ωú,ÊãñÂä®ÊòØÂü∫‰∫éimageviewÔºåÂ¶ÇÊûúÁªèËøáÊóãËΩ¨ÔºåÊãñÂä®ÊñπÂêë‰πüÊòØÁõ∏ÂØπimageview‰∏ä‰∏ãÂ∑¶Âè≥ÁßªÂä®ÔºåËÄå‰∏çÊòØÂ±èÂπïÂØπ‰∏ä‰∏ãÂ∑¶Âè≥ // ÊãñÂä®ËøáÁ®ã‰∏≠ÂèØ‰ª•Âà§Êñ≠ÊòØÂê¶‰∏∫ UIGestureRecognizerStateChanged if (recognizer.state == UIGestureRecognizerStateChanged)&#123; CGPoint translation = [recognizer translationInView:_imageView]; recognizer.view.center = CGPointMake(recognizer.view.center.x + translation.x, recognizer.view.center.y + translation.y); [recognizer setTranslation:CGPointZero inView:_imageView]; &#125;&#125; ÊªëÂä®ÊâãÂäø‚Äî‚ÄîUISwipeGestureRecognizerÊªëÂä®ÊâãÂäøÂíåÊãñÊãΩÊâãÂäøÁöÑ‰∏çÂêå‰πãÂ§ÑÂú®‰∫éÊªëÂä®ÊâãÂäøÊõ¥Âø´ÔºåÊãñÊãΩÊØîËæÉÊÖ¢ 1234//ËÆæÁΩÆËß¶ÂèëÊªëÂä®ÊâãÂäøÁöÑËß¶Êë∏ÁÇπÊï∞@property(nonatomic) NSUInteger numberOfTouchesRequired; //ËÆæÁΩÆÊªëÂä®ÊñπÂêë@property(nonatomic) UISwipeGestureRecognizerDirection direction; ÊóãËΩ¨ÊâãÂäø‚Äî‚ÄîUIRotationGestureRecognizer1234//ËÆæÁΩÆÊóãËΩ¨ËßíÂ∫¶@property (nonatomic) CGFloat rotation;//ËÆæÁΩÆÊóãËΩ¨ÈÄüÂ∫¶ @property (nonatomic,readonly) CGFloat velocity; Âú®ËÆæÁΩÆÂÆåÊóãËΩ¨ÂêéÔºårecognizer.rotation‰∏ÄÂÆöË¶ÅÊ∏ÖÈõ∂. 123456- (void)handleRotate:(UIRotationGestureRecognizer*) recognizer&#123; NSLog(@"ÊóãËΩ¨Êìç‰Ωú");//Â§ÑÁêÜÊóãËΩ¨Êìç‰Ωú //ÂØπimageviewÊóãËΩ¨ _imageView.transform = CGAffineTransformRotate(_imageView.transform, recognizer.rotation); recognizer.rotation = 0; //‰∏ÄÂÆöË¶ÅÊ∏ÖÈõ∂&#125; ÈïøÊåâÊâãÂäø‚Äî‚ÄîUILongPressGestureRecognizer12345678//ËÆæÁΩÆËß¶ÂèëÂâçÁöÑÁÇπÂáªÊ¨°Êï∞@property (nonatomic) NSUInteger numberOfTapsRequired; //ËÆæÁΩÆËß¶ÂèëÁöÑËß¶Êë∏ÁÇπÊï∞@property (nonatomic) NSUInteger numberOfTouchesRequired; //ËÆæÁΩÆÊúÄÁü≠ÁöÑÈïøÊåâÊó∂Èó¥@property (nonatomic) CFTimeInterval minimumPressDuration; //ËÆæÁΩÆÂú®ÊåâËß¶Êó∂Êó∂ÂÖÅËÆ∏ÁßªÂä®ÁöÑÊúÄÂ§ßË∑ùÁ¶ª ÈªòËÆ§‰∏∫10ÂÉèÁ¥†@property (nonatomic) CGFloat allowableMovemen ÊâãÂäø‰∏éÂìçÂ∫îÈìæÁªìËÆ∫event ÁªëÂÆöÁöÑ touch ÂØπË±°‰∏äÁª¥Êä§‰∫Ü‰∏Ä‰∏™ÊâãÂäøËØÜÂà´Âô®Êï∞ÁªÑ„ÄÇÂú®ÂìçÂ∫îÈìæÈÄöËøá hit-test ÂØªÊâæÊúÄ‰Ω≥ÂìçÂ∫îËßÜÂõæÁöÑÊó∂ÂÄôÔºå‰ºöÊî∂ÈõÜÂìçÂ∫îÈìæ‰∏äÊØè‰∏Ä‰∏™ËßÜÂõæ‰∏äÊñΩÂä†ÁöÑÊâãÂäøÔºö WindowÂÖàÂ∞Ü‰∫ã‰ª∂‰º†ÈÄíÁªôËøô‰∫õÊâãÂäøËØÜÂà´Âô®ÔºåÂÜç‰º†Áªôhit-tested view„ÄÇ‰∏ÄÊó¶ÊúâÊâãÂäøËØÜÂà´Âô®ÊàêÂäüËØÜÂà´‰∫ÜÊâãÂäøÔºåApplicationÂ∞±‰ºöÂèñÊ∂àhit-tested viewÂØπ‰∫ã‰ª∂ÁöÑÂìçÂ∫î„ÄÇÂõ†Ê≠§ÂèØ‰ª•ÁêÜËß£‰∏∫ÊâãÂäøËØÜÂà´Âô®ÊØîUIResponderÂÖ∑ÊúâÊõ¥È´òÁöÑ‰∫ã‰ª∂ÂìçÂ∫î‰ºòÂÖàÁ∫ß„ÄÇ ‰ΩÜÊòØÔºåËØÜÂà´ÊâãÂäøÊòØÈúÄË¶ÅÊó∂Èó¥ÁöÑÔºåÊâÄ‰ª•ÂÖ∑‰ΩìÁöÑË°®Áé∞Â∞±ÊòØÂΩìÊúâÁÇπÂáª‰∫ã‰ª∂ÁöÑÊó∂ÂÄôÔºå‰ºöÂÖàËß¶Âèë touchBegan:withEvent: ÊñπÊ≥ïÔºåÁÑ∂ÂêéÂΩìÊâãÂäøËØÜÂà´Âà∞ÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöËß¶Âèë touchCancelled:withEvent: ÊØîÂ¶ÇÂú®ËßÜÂõæ‰∏äÊ∑ªÂä†‰∏Ä‰∏™ UIPanGestureRecognizer ÊâãÂäø„ÄÇÊâìÂç∞Êó•ÂøóÂèØ‰ª•ÁúãÂà∞Ôºå‰ºöÂÖàËß¶Âèë UIResponder ÁöÑÂõûË∞ÉÔºåÁõ¥Âà∞ UIPanGestureRecognizer ËØÜÂà´ÊàêÂäüÔºö ÊâãÂäøËØÜÂà´Âô®ÁöÑ‰∏§‰∏™Â±ûÊÄß12@property(nonatomic) BOOL cancelsTouchesInView;@property(nonatomic) BOOL delaysTouchesBegan; cancelsTouchesInViewÈªòËÆ§‰∏∫YES„ÄÇË°®Á§∫ÂΩìÊâãÂäøËØÜÂà´Âô®ÊàêÂäüËØÜÂà´‰∫ÜÊâãÂäø‰πãÂêéÔºå‰ºöÈÄöÁü•ApplicationÂèñÊ∂àÂìçÂ∫îÈìæÂØπ‰∫ã‰ª∂ÁöÑÂìçÂ∫îÔºåÂπ∂‰∏çÂÜç‰º†ÈÄí‰∫ã‰ª∂Áªôhit-test view„ÄÇËã•ËÆæÁΩÆÊàêNOÔºåË°®Á§∫ÊâãÂäøËØÜÂà´ÊàêÂäüÂêé‰∏çÂèñÊ∂àÂìçÂ∫îÈìæÂØπ‰∫ã‰ª∂ÁöÑÂìçÂ∫îÔºå‰∫ã‰ª∂‰æùÊóß‰ºö‰º†ÈÄíÁªôhit-test view„ÄÇ Â¶ÇÊûúËÆæÁΩÆ pan.cancelsTouchesInView = NOÔºåÈÇ£‰πà‰∏äÈù¢ÁöÑ UIPanGestureRecognizer ÁöÑÊó•Âøó‰ºöÂèò‰∏∫Ôºö delaysTouchesBeganÈªòËÆ§‰∏∫NO„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÊâãÂäøËØÜÂà´Âô®Âú®ËØÜÂà´ÊâãÂäøÊúüÈó¥ÔºåÂΩìËß¶Êë∏Áä∂ÊÄÅÂèëÁîüÊîπÂèòÊó∂ÔºåApplicationÈÉΩ‰ºöÂ∞Ü‰∫ã‰ª∂‰º†ÈÄíÁªôÊâãÂäøËØÜÂà´Âô®Âíåhit-tested viewÔºõËã•ËÆæÁΩÆÊàêYESÔºåÂàôË°®Á§∫ÊâãÂäøËØÜÂà´Âô®Âú®ËØÜÂà´ÊâãÂäøÊúüÈó¥ÔºåÊà™Êñ≠‰∫ã‰ª∂ÔºåÂç≥‰∏ç‰ºöÂ∞Ü‰∫ã‰ª∂ÂèëÈÄÅÁªôhit-tested view„ÄÇ Â¶ÇÊûúËÆæÁΩÆ pan.delaysTouchesBegan = NOÔºåÈÇ£‰πà‰∏äÈù¢ÁöÑ UIPanGestureRecognizer ÁöÑÊó•Âøó‰ºöÂèò‰∏∫Ôºö UITableView ÁöÑÁÇπÂáªÂíåÊâãÂäøÁöÑÂÜ≤Á™ÅUIScrollView ÁöÑÊªëÂä®ÂÖ∂ÂÆûÊòØÂõ†‰∏∫Á≥ªÁªüÂä†‰∫Ü‰∏Ä‰∏™ UIPanGestureÁöÑÁºòÊïÖ„ÄÇUITableView ÁÇπÂáª Cell ÂÖ∂ÂÆûÊòØË∞ÉÁî®‰∫Ü touchBegan:withEvent: ÊñπÊ≥ï„ÄÇ Âõ†Ê≠§ÔºåÂΩìÊúâËøôÊ†∑‰∏Ä‰∏™ÈúÄÊ±ÇÔºöcell ÊîØÊåÅÂ∑¶ÊªëÔºåÂπ∂‰∏îÂΩì‰∏Ä‰∏™ cell Â∑¶ÊªëÂõ∫ÂÆöÁöÑÊó∂ÂÄôÔºåÁÇπÂáª UITableView ‰ªªÊÑè‰ΩçÁΩÆ‰ºöÂÖ≥Èó≠ cell„ÄÇËøôÁßçÊó∂ÂÄôÔºåÈúÄË¶ÅÁªô UITableView Ê∑ªÂä†‰∏Ä‰∏™ UITapGesture„ÄÇËÄåËøô‰∏™ UITapGesture Â∞±‰ºöÂØºËá¥ UITableView Êú¨Ë∫´ Cell ÁÇπÂáªÁöÑ‰∏çÂìçÂ∫î„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶ÅÂú®ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãËÆæÁΩÆËøô‰∏™ tapGesture.enabled = NO;„ÄÇÂè™ÊúâÂú® Cell Â±ïÂºÄÁöÑÊÉÖÂÜµ‰∏ãÔºåËÆæÁΩÆ tapGesture.enabled = YES ÊâãÂäø‰∏éUIControlUIControl ÁªßÊâø‰∫é UIResponder„ÄÇÂÉè UIButton Â∞±ÊòØÁªßÊâø‰∫é UIControl ÁªìËÆ∫Á≥ªÁªüÊ¥æÁîü‰∫é UIControl ÁöÑÁ±ªÂÉè UIButton ‰πãÁ±ªÔºåÂ§ÑÁêÜ‰∫ã‰ª∂ÁöÑ‰ºòÂÖàÁ∫ßÊØîÁà∂ËßÜÂõæ‰∏äÁöÑ UIGestureRecognizerÈ´ò„ÄÇUIControl‰ºöÈòªÊ≠¢Áà∂ËßÜÂõæ‰∏äÁöÑÊâãÂäøËØÜÂà´Âô®Ë°å‰∏∫„ÄÇ Ê≥®ÊÑèÔºåËá™Â∑±ÁªßÊâø‰∫é UIControl ÂÆûÁé∞ÁöÑÁ±ª‰∏çÂ≠òÂú®‰ºòÂÖàÁ∫ßÊØîÊâãÂäøÈ´òÁöÑÊÉÖÂÜµ„ÄÇ Âè¶Â§ñÔºåUIControl ÁöÑ‰ºòÂÖàÁ∫ßÊòØÊØîÁà∂ËßÜÂõæ‰∏äÁöÑÊâãÂäøÈ´òÔºåÂ¶ÇÊûúÂΩìÂâçËßÜÂõæ‰πüÊúâÊâãÂäøÔºåÈÇ£‰πà UIControl Êó†Ê≥ïÈòªÊ≠¢ÊâãÂäøÂìçÂ∫î„ÄÇ ‰∏Ä‰∫õÊäÄÂ∑ßÂá†‰∏™ÂùêÊ†áËΩ¨Êç¢ÁöÑÊñπÊ≥ïUITouch123456// ËøîÂõûÂÄºË°®Á§∫Ëß¶Êë∏Âú®view‰∏äÁöÑ‰ΩçÁΩÆ// ËøôÈáåËøîÂõûÁöÑ‰ΩçÁΩÆÊòØÈíàÂØπviewÁöÑÂùêÊ†áÁ≥ªÁöÑÔºà‰ª•viewÁöÑÂ∑¶‰∏äËßí‰∏∫ÂéüÁÇπ(0, 0)Ôºâ// Ë∞ÉÁî®Êó∂‰º†ÂÖ•ÁöÑviewÂèÇÊï∞‰∏∫nilÁöÑËØùÔºåËøîÂõûÁöÑÊòØËß¶Êë∏ÁÇπÂú®UIWindowÁöÑ‰ΩçÁΩÆ- (CGPoint)locationInView:(UIView *)view; // ËØ•ÊñπÊ≥ïËÆ∞ÂΩï‰∫ÜÂâç‰∏Ä‰∏™Ëß¶Êë∏ÁÇπÁöÑ‰ΩçÁΩÆ- (CGPoint)previousLocationInView:(UIView *)view; UIGestureRecognizer12345// ËøîÂõûÂùêÊ†áÁÇπ,Á¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫tauchÊï∞ÁªÑÁöÑÁ¥¢ÂºïCGPoint point= [pan locationOfTouch:0 inView:self.view];// ÊâãÊåáÁßªÂä®‰∫ÜÂ§öÂ∞ëÔºå‰∏äÈù¢ÊòØÁõ∏ÂØπ‰∫éÂùêÊ†áÂéüÁÇπÔºåËøô‰∏™ÊòØÁõ∏ÂØπ‰∫éÊãñÊãΩÁöÑËµ∑ÂßãÁÇπÔºåÁî®‰∫é ÊãñÊãΩ View Êó∂ÂÄô‰øÆÊîπ View ‰ΩçÁΩÆÁöÑ// ÈÖçÂêà [pan setTranslation:CGPointZero inView: someView] ‰ΩøÁî®ÔºåÊØèÊ¨°ÊãñÊãΩÊñπÊ≥ïÂõûË∞ÉÁöÑÊó∂ÂÄôÔºåÈÉΩË¶ÅÂ∞Ü‰∏äÊ¨°ÁöÑÊãñÊãΩ‰ΩçÁßªÊ∏ÖÈõ∂CGPoint point = [pan translationInView:self.view]; UIView12// UIView ËΩ¨Êç¢Âà∞Âè¶‰∏Ä‰∏™ UIView ÂùêÊ†áÁ≥ªÔºåÂú® hittest ‰∏≠Âà§Êñ≠Â≠êÊéß‰ª∂ÊòØÂê¶ÊòØ responder ÁöÑÊó∂ÂÄô‰ºö‰ΩøÁî®- (CGPoint)convertPoint:(CGPoint)point toView:(UIView *)view; ÂèÇËÄÉiOSËß¶Êë∏‰∫ã‰ª∂ÂÖ®ÂÆ∂Ê°∂ Âè≤‰∏äÊúÄËØ¶ÁªÜÁöÑiOS‰πã‰∫ã‰ª∂ÁöÑ‰º†ÈÄíÂíåÂìçÂ∫îÊú∫Âà∂]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>UIResponder</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Block ÁöÑ‰ΩøÁî®]]></title>
    <url>%2F2016%2F09%2F01%2FBlock%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[Á±ª‰ºº‰∫éÂåøÂêçÂáΩÊï∞Ôºåoc‰∏≠Êèê‰æõblock,ÂèØ‰ª•Â∞Ü‰∏ÄÊÆµ‰ª£Á†ÅÂùóÂÉèÂØπË±°‰∏ÄÊ†∑‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄí„ÄÅÊâßË°å„ÄÇ BlockÁöÑ‰ΩøÁî®BlockÂÆû‰æã1234^(double dividend)&#123; double quotient = dividend / divisor; return quotient;&#125; BlockÂØπË±°ÂèØ‰ª•Ë¢´ÂΩìÂÅö‰∏Ä‰∏™ÂÆûÂèÇÊù•‰º†ÈÄíÁªôÂèØ‰ª•Êé•Êî∂blockÁöÑÊñπÊ≥ï„ÄÇ Â£∞ÊòéblockÂèòÈáè:1void (^devowelizer)(id, NSUInteger, BOOL*); void Ë°®Á§∫ËøîÂõûÁ±ªÂûã^ Ë°®Á§∫ÊòØ‰∏Ä‰∏™blockÂØπË±°devowelizer Ë°®Á§∫blockÂèòÈáèÁöÑÂêçÁß∞ÂêéÈù¢ÁöÑÊòØÂÆûÂèÇÁ±ªÂûãÊñπÊ≥ïÁöÑË∞ÉÁî®ÂèÇÊï∞Á±ªÂûã‰∏∫^(id string, NSUInteger i, BOOL *stop)block ÁºñÂÜôBlockÂØπË±°123devowelizer = ^(id string,NSUInteger i, BOOL *stop)&#123; ‚Ä¶‚Ä¶&#125;; Ë∞ÉÁî®blockÂèòÈáè1devowelizer(string,i,stop); typedef‰∏çËÉΩÂú®ÊñπÊ≥ïÁöÑÂÆûÁé∞‰ª£Á†Å‰∏≠‰ΩøÁî®typedefÔºåÈúÄË¶ÅÂú®ÂÆûÁé∞Êñá‰ª∂ÁöÑÈ°∂ÈÉ®ÔºåÊàñËÄÖÂ§¥Êñá‰ª∂ÂÜÖ‰ΩøÁî®typedef„ÄÇ1typedef void(^ArrayEnumerationBlock)(id,NSUInteger,BOOL *); ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåËøôÈáåÂÆö‰πâÁöÑÊòØ‰∏Ä‰∏™Êñ∞ÁöÑÁ±ªÂûãÔºå‰∏çÊòØÂèòÈáè„ÄÇË∑üÂú®^ÂêéÈù¢ÁöÑÊòØÁ±ªÂûãÂêçÁß∞„ÄÇÂàõÂª∫Ëøô‰∏™Êñ∞Á±ªÂûãÂêéÔºåÂèØ‰ª•ÁÆÄÂåñÁõ∏Â∫îBlockÁöÑÂ£∞Êòé„ÄÇ1ArrayEnumerationBlock devowelizerÔºõ Â§ñÈÉ®ÂèòÈáèÂú®ÊâßË°åBlockÂØπË±°Êó∂Ôºå‰∏∫‰∫ÜÁ°Æ‰øùÂÖ∂‰∏ãÁöÑÂ§ñÈÉ®ÂèòÈáèËÉΩÂ§üÂßãÁªàÂ≠òÂú®ÔºåÁõ∏Â∫îÁöÑBlockÂØπË±°‰ºöÊçïËé∑Ëøô‰∫õÂèòÈáèÔºåÊÑèÂë≥ÁùÄÁ®ãÂ∫è‰ºöÊã∑Ë¥ùÂèòÈáèÁöÑÂÄº„ÄÇ ÂΩìÂ§ñÈÉ®ÂØπË±°ÊòØÂºïÁî®Êó∂Ôºåblock‰ºöÂ§çÂà∂ÂÖ∂ÂºïÁî®ÁöÑÂú∞ÂùÄ(ÊåáÈíàÊåáÂêëÁöÑÂ†Ü‰∏äÁöÑÂú∞ÂùÄ)ÔºåÂè™ËÉΩÊîπÂèòÂú∞ÂùÄÊåáÂêëÁöÑÂØπË±°ÁöÑÂ±ûÊÄßÔºå‰∏çËÉΩÂ∞ÜÂ§ñÈÉ®ÂØπË±°ÊåáÂêëÊñ∞ÁöÑÂú∞ÂùÄ. ‰øÆÊîπÂ§ñÈÉ®ÂèòÈáèÂ¶ÇÊûúÈúÄË¶ÅÂú®BlockÂØπË±°ÂÜÖ‰øÆÊîπÊüê‰∏™Â§ñÈÉ®ÂèòÈáèÔºåÂàôÂèØ‰ª•Â£∞ÊòéÁõ∏Â∫îÁöÑÂ§ñÈÉ®ÂèòÈáèÊó∂ÔºåÂú®ÂâçÈù¢Âä†‰∏ä__blockÂÖ≥ÈîÆÂ≠ó„ÄÇ Âú®Block‰∏≠‰ΩøÁî®selfÂ¶ÇÊûúË¶ÅÂÜô‰∏Ä‰∏™‰ΩøÁî®selfÁöÑBlockÂØπË±°ÔºåÈúÄË¶ÅÈÅøÂÖçÂº∫ÂºïÁî®Âæ™ÁéØ„ÄÇÂú®BlockÂ§ñÂ£∞Êòé‰∏Ä‰∏™_weakÊåáÊ≠£ÔºåÁÑ∂ÂêéÂ∞ÜËøô‰∏™ÊåáÈíàÊåáÂêëBlockÂØπË±°‰ΩøÁî®ÁöÑselfÔºåÊúÄÂêéÂú®BlockÂØπË±°‰∏≠‰ΩøÁî®Ëøô‰∏™Êñ∞ÁöÑÊåáÈíà„ÄÇ1234_weak typeof(self) weakSelf = self; //Âº±ÂºïÁî®ÊåáÈíà myBlock = ^&#123; NSLog(@‚ÄúEmployee:%@‚Äù,weakSelf); &#125;; blockÁöÑÂÆûÁé∞block ÁªìÊûÑblockÊú¨Ë¥®‰∏ä‰πüÊòØ‰∏Ä‰∏™ocÂØπË±°Ôºå‰ªñÂÜÖÈÉ®‰πüÊúâ‰∏Ä‰∏™isaÊåáÈíà„ÄÇblockÊòØÂ∞ÅË£Ö‰∫ÜÂáΩÊï∞Ë∞ÉÁî®‰ª•ÂèäÂáΩÊï∞Ë∞ÉÁî®ÁéØÂ¢ÉÁöÑOCÂØπË±°„ÄÇ Â∞Ü‰∏äÂõæÂíå‰∏ãÂõæÂÅöÂØπÁÖßÔºåÂèØ‰ª•ÂèëÁé∞Ôºå‰∏§ËÄÖÁöÑÁªìÊûÑÂü∫Êú¨‰∏ÄËá¥Ôºö Ê≥®ÊÑèÁúã‰∏äÈù¢ÁöÑ block ÁªìÊûÑ‰ΩìÔºåÂú®ÁªìÊûÑ‰ΩìÂÜÖÈÉ®‰πüÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂêåÂêçÁöÑÂèòÈáè ageÔºåÂÆÉÁöÑÂÄºÂíåÂ§ñÈÉ®ÁöÑ age Áõ∏Âêå„ÄÇÂõ†Ê≠§ÔºåÂÜÖÈÉ® age ‰øÆÊîπ‰∫ÜÂπ∂‰∏ç‰ºöÂΩ±ÂìçÂ§ñÈÉ® age„ÄÇ block ÂèòÈáèÊçïËé∑ÂèòÈáèÊúâ‰∫îÁßçÂΩ¢ÂºèÔºåauto Â±ÄÈÉ®ÂèòÈáè„ÄÅstatic Â±ÄÈÉ®ÂèòÈáè„ÄÅauto ÂÖ®Â±ÄÂèòÈáè„ÄÅstatic ÂÖ®Â±ÄÂèòÈáè„ÄÅÊàêÂëòÂèòÈáè„ÄÇ ‰∏∫‰ªÄ‰πàË¶ÅÊúâÂèòÈáèÁöÑÊçïËé∑Âõ†‰∏∫Â¶ÇÊûúÊòØÂºïÁî®Â§ñÈÉ®Â±ÄÈÉ®ÂèòÈáèÔºåÂ±ÄÈÉ®ÂèòÈáè‰ºöÂú®‰ΩúÁî®ÂüüÁªìÊùüÂêéÂõûÊî∂„ÄÇÂ±ÄÈÉ®ÂèòÈáèÂõûÊî∂‰∫ÜÔºåÈó≠ÂåÖËÇØÂÆöÂ∞± crash ‰∫Ü„ÄÇÂõ†Ê≠§ÈúÄË¶ÅËøõË°åÂèòÈáèÁöÑÊçïËé∑„ÄÇ ÂèòÈáèÂ¶Ç‰ΩïÊçïËé∑ÁöÑÊçïËé∑ÊñπÂºèÊòØÂú®ÂÜÖÈÉ®ÂàõÂª∫‰∏Ä‰∏™ÂêåÂêçÁöÑÂèòÈáèÔºåËµãÁªôÂÆÉÁõ∏ÂêåÁöÑÂÄºÊàñËÄÖÊåáÂêëÁõ∏ÂêåÁöÑÂú∞ÂùÄ„ÄÇËøôÊ†∑ËôΩÁÑ∂‰ª£Á†Å‰∏äÁúãËµ∑Êù•ÊòØÂêå‰∏Ä‰∏™ÂèòÈáèÔºå‰ΩÜÊòØÂÖ∂ÂÆûÊòØ‰∏§‰∏™ÂèòÈáè„ÄÇ ‰∏∫‰ªÄ‰πà‰∏çËÆ©‰ΩøÁî®ËÄÖÁõ¥Êé•‰øÆÊîπ‰ΩøÁî®Âà∞ÁöÑÂ§ñÈÉ®ÂèòÈáè‰∏äÈù¢ËØ¥Âà∞Ôºåblock ‰∏≠‰ΩøÁî®ÁöÑÂ§ñÈÉ®ÂèòÈáèÂÖ∂ÂÆû‰∏çÊòØÊ≠£ÁúüÁöÑÂ§ñÈÉ®ÂèòÈáèÔºåËÄåÊòØÊñ∞ÂàõÂª∫ÁöÑÂíåÂ§ñÈÉ®ÂêåÂêçÁöÑÂèòÈáè„ÄÇÂõ†Ê≠§ÔºåÂ∞±ÁÆóÂèØ‰ª•ÊîπÔºåÊîπÁöÑ‰πüÂè™ÊòØÂÜÖÈÉ®ÁöÑÂêåÂêçÂèòÈáèÁöÑÊåáÂêë„ÄÇÂõ†Ê≠§ÔºåÁºñËØëÂô®Á¥¢ÊÄßÂ∞±‰∏çËÆ©Êîπ‰∫Ü„ÄÇ Â±ÄÈÉ®ÂèòÈáèÂØπ‰∫éÂ±ÄÈÉ®ÂèòÈáèÊù•ËØ¥Ôºåauto Â±ÄÈÉ®ÂèòÈáèÊçïËé∑ÁöÑÊòØÂÄºÔºåstatic Â±ÄÈÉ®ÂèòÈáèÊçïËé∑ÁöÑÊòØÂú∞ÂùÄ„ÄÇËøôÊòØÂõ†‰∏∫ auto Â±ÄÈÉ®ÂèòÈáèÂèØËÉΩ‰ºöÈîÄÊØÅÔºåÊâÄ‰ª•Ë¶ÅÊçïËé∑ÂÄºÔºåÂê¶Âàô‰ºöËÆøÈóÆÂ∑≤ÂõûÊî∂ÁöÑÂú∞ÂùÄ„ÄÇËÄå static Â±ÄÈÉ®ÂèòÈáèÂàô‰∏çÁî®ÊãÖÂøÉÂèòÈáèÂõûÊî∂ÔºåÊâÄ‰ª•ÊçïËé∑ÁöÑÊòØÂú∞ÂùÄ„ÄÇÊâÄ‰ª•ÔºåÂú®blockË∞ÉÁî®‰πãÂâç‰øÆÊîπÂú∞ÂùÄ‰∏≠‰øùÂ≠òÁöÑÂÄºÔºåblock‰∏≠ÁöÑ static ÂèòÈáè‰ºöÈöè‰πãÊîπÂèò„ÄÇ‰æãÔºö ÂÖ®Â±ÄÂèòÈáèblock‰∏çÈúÄË¶ÅÊçïËé∑ÂÖ®Â±ÄÂèòÈáèÔºåÂõ†‰∏∫ÂÖ®Â±ÄÂèòÈáèÊó†ËÆ∫Âú®Âì™ÈáåÈÉΩÂèØ‰ª•ËÆøÈóÆ„ÄÇÂ±ÄÈÉ®ÂèòÈáèÂõ†‰∏∫Ë∑®ÂáΩÊï∞ËÆøÈóÆÊâÄ‰ª•ÈúÄË¶ÅÊçïËé∑ÔºåÂÖ®Â±ÄÂèòÈáèÂú®Âì™ÈáåÈÉΩÂèØ‰ª•ËÆøÈóÆ ÔºåÊâÄ‰ª•‰∏çÁî®ÊçïËé∑„ÄÇ ÊàêÂëòÂèòÈáèÊàêÂëòÂèòÈáèÊòØÊØîËæÉÁâπÊÆäÁöÑÔºåÂç≥‰Ωøblock‰∏≠‰ΩøÁî®ÁöÑÊòØÂÆû‰æãÂØπË±°ÁöÑÂ±ûÊÄßÔºåblock‰∏≠ÊçïËé∑ÁöÑ‰ªçÁÑ∂ÊòØÂÆû‰æãÂØπË±°ÔºåÂπ∂ÈÄöËøáÂÆû‰æãÂØπË±° get ÊñπÊ≥ïÂéªËé∑Âèñ‰ΩøÁî®Âà∞ÁöÑÂ±ûÊÄß Âõ†‰∏∫ÁÇπËØ≠Ê≥ïÂÆûË¥®ÊòØË∞ÉÁî®ÊñπÊ≥ïÔºåÊâÄ‰ª•ÊçïËé∑ÁöÑÊòØ self block ÁöÑÁ±ªÂûã‰∏âÁßçÁ±ªÂûãblock Â≠òÂú®‰∏âÁßçÁ±ªÂûãÔºö 123__NSGlobalBlock__ Ôºà _NSConcreteGlobalBlock Ôºâ__NSStackBlock__ Ôºà _NSConcreteStackBlock Ôºâ__NSMallocBlock__ Ôºà _NSConcreteMallocBlock Ôºâ Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰ª£Á†ÅÊü•Áúã‰ªñ‰ª¨ÁöÑÁ±ªÂûãÔºö ‰∏âÁßçÁ±ªÂûãÁöÑÂÆö‰πâÊ≤°ÊúâËÆøÈóÆautoÂèòÈáèÁöÑblockÊòØ__NSGlobalBlock__Á±ªÂûãÁöÑÔºåÂ≠òÊîæÂú®Êï∞ÊçÆÊÆµ‰∏≠„ÄÇËÆøÈóÆ‰∫ÜautoÂèòÈáèÁöÑblockÊòØ__NSStackBlock__Á±ªÂûãÁöÑÔºåÂ≠òÊîæÂú®Ê†à‰∏≠„ÄÇ__NSStackBlock__Á±ªÂûãÁöÑblockË∞ÉÁî®copyÊàê‰∏∫*__NSMallocBlock__Á±ªÂûãÂπ∂Ë¢´Â§çÂà∂Â≠òÊîæÂú®Â†Ü‰∏≠„ÄÇ Ê†à block Áõ∏ÂΩì‰∫é‰∏Ä‰∏™Â±ÄÈÉ®ÂèòÈáèÔºåÂΩìË∂ÖÂá∫‰ΩúÁî®ÂüüÔºåÂ∞±Èù¢‰∏¥ÁùÄË¢´ÂõûÊî∂ÁöÑÈ£éÈô©„ÄÇARC ‰∏ãÔºåÂæàÂ§öÊÉÖÂÜµ‰∏≠Ôºå‰ºöËá™Âä®Â∏ÆÊàë‰ª¨ÊâßË°å‰∏ÄÊ¨° copyÔºåÊØîÂ¶ÇËµãÂÄº„ÄÇ Âõ†Ê≠§Ôºåblock ÁöÑÂ±ûÊÄß‰øÆÈ•∞ËØçÈúÄË¶Å‰ΩøÁî® copy„ÄÇÂΩìÁÑ∂ ARC ÁéØÂ¢É‰∏ãÔºå‰ΩøÁî® strongÔºåÁºñËØëÂô®‰πü‰ºöËá™Âä®Â∏ÆÊàë‰ª¨ copy„ÄÇ __weak ÂÖ≥ÈîÆÂ≠ó__weak ÂÖ≥ÈîÆÂ≠ó‰øÆÈ•∞ÁöÑÂèòÈáè‰ºöÂØπÂºïÁî®ÂØπË±°ËøõË°åÂº±ÂºïÁî®„ÄÇÂú® block ‰∏≠‰ΩøÁî®Ë¢´Âº±ÂºïÁî®ÁöÑÂèòÈáèÔºåblock ÂÜÖÈÉ®‰πü‰ºöÊçïËé∑Âº±ÂºïÁî®ÁöÑÂØπË±°Ôºö __block ÂÖ≥ÈîÆÂ≠ó‰∏äÈù¢ËØ¥Âà∞Ôºåblock ÂÜÖÈÉ®‰ºöÂàõÂª∫‰∏Ä‰∏™ÂíåÂ§ñÈÉ®ÂêåÂêçÁöÑÂèòÈáèÂÖ∑ÊúâÁõ∏ÂêåÁöÑÂÄºÔºåÊàñËÄÖÊåáÂêëÁõ∏ÂêåÁöÑÂú∞ÂùÄ„ÄÇÈÇ£‰πàËøôÊ†∑Â∞±Êó†Ê≥ïÂÅöÂà∞Â§ñÈÉ®‰øÆÊîπÂ§ñÈÉ®ÂèòÈáèÁöÑÂÄºÔºåblock ÂÜÖÈÉ®ÂÅöÁõ∏Â∫îÁöÑÂèòÂåñÔºõblock ÂÜÖÈÉ®‰øÆÊîπÂèòÈáèÁöÑÂÄºÔºåÂ§ñÈÉ®ÂèòÈáèÂÅöÁõ∏Â∫îÁöÑÂèòÂåñ„ÄÇ ÈÇ£‰πàÂ¶Ç‰ΩïÊâçËÉΩÂÅöÂà∞ÂÜÖÂ§ñÁöÑ‰øÆÊîπËÉΩÂ§üÂêåÊ≠•Âë¢ÔºüËßÅ‰∏ãÂõæÔºö ËµãÂÄºÊìç‰ΩúÈÉΩ‰ºöÂºïËµ∑Â§ñÈÉ®ÂèòÈáèÂíåÂÜÖÈÉ®ÂèòÈáèÁöÑË°®Á§∫ÁöÑÂÄºÊàñÂú∞ÂùÄÁöÑ‰∏çÂêå„ÄÇË¶ÅËß£ÂÜ≥ËøôÁßç‰∏çÂêåÂè™ÊúâÈÄöËøá‰∏ÄÂ±Ç‰∏≠Èó¥Â±ÇÊù•Ëß£ÂÜ≥„ÄÇÂ§ñÈÉ®ÂèòÈáèÂíåÂÜÖÈÉ®ÂèòÈáèÈÉΩÊåáÂêëÁõ∏ÂêåÁöÑÂú∞ÂùÄ„ÄÇËÄåÂØπ‰∫éÂ§ñÈÉ®ÂèòÈáèÊàñËÄÖÂÜÖÈÉ®ÂèòÈáèÁöÑ‰øÆÊîπÈÉΩËΩ¨‰∏∫ÂØπÂåÖË£πÁöÑÂØπË±°ÁöÑ‰øÆÊîπÔºåËÄå‰∏çÊòØÂàáÊç¢Â§ñÈÉ®ÂèòÈáèÊàñËÄÖÂÜÖÈÉ®ÂèòÈáèÁöÑÊåáÂêë„ÄÇ iOS Êèê‰æõ‰∫Ü __block Êù•ËææÂà∞Ëøô‰∏™ÁõÆÁöÑ„ÄÇ__block ‰øÆÈ•∞ÁöÑÂèòÈáèÔºåÁºñËØëÂô®‰ºöËá™Âä®Â∞ÜÂÖ∂ÂåÖË£Ö‰∏∫‰∏Ä‰∏™ÂØπË±°ÔºåÂéüÊú¨Ë¢´‰øÆÈ•∞ÁöÑÂèòÈáè‰ºö‰Ωú‰∏∫ÂØπË±°ÁöÑ‰∏Ä‰∏™Â±ûÊÄß„ÄÇ Âè™ÊúâË¶Å‰øÆÊîπÂèòÈáèÁöÑÂÄºÊàñËÄÖÂú∞ÂùÄÁöÑÊó∂ÂÄôÊâç‰ΩøÁî®__blockÔºåÊØîÂ¶Ç‰øÆÊîπ NSMutableArray ËøôÁßçÂàô‰∏çÈúÄË¶Å‰ΩøÁî® __block block ÁöÑÂµåÂ•óÂØπ‰∫é block ÁöÑÂµåÂ•óÔºåÊØîÂ¶Ç‰ª•‰∏ãÂú∫ÊôØÔºåblockB‰ºöÊçïËé∑selfÔºåËøôÊòØÂ§ßÂÆ∂ÈÉΩ‰∫ÜËß£ÁöÑÔºå‰ΩÜÊòØblockA‰ºöÊçïËé∑self‰πàÔºü‰∏∫‰ªÄ‰πàÔºü 12345678- (void)embeddedBlock&#123; void (^blockA)() = ^&#123; void (^blockB)() = ^&#123; NSLog(@"%@",self); &#125;; &#125;;&#125; Á≠îÊ°àÊòØ‰ºöÔºåÂÖàÂ∞Üself‰ªéÂ§ñÁïå‰º†ÂÖ•Âà∞blockA‰∏≠„ÄÇÂÜç‰ªéblockAÁöÑ‰∏≠‰º†ÂÖ•Âà∞blockB‰∏≠„ÄÇblockBÂè™ËÉΩ‰ªéblockAÁöÑ‰ΩúÁî®ÂüüÈáåÊçïËé∑ÂèòÈáè„ÄÇÂõ†Ê≠§blockB‰∏≠ÊçïËé∑ÁöÑ‰ªª‰Ωï‰∏úË•øÔºåblockAÂøÖÈ°ª‰πüÊçïËé∑‰∏Ä‰ªΩ„ÄÇ ÂèÇËÄÉiOSÂ∫ïÂ±ÇÂéüÁêÜÊÄªÁªì - Êé¢ÂØªblockÁöÑÊú¨Ë¥®Ôºà‰∏ÄÔºâ iOSÂ∫ïÂ±ÇÂéüÁêÜÊÄªÁªì - Êé¢ÂØªblockÁöÑÊú¨Ë¥®Ôºà‰∫åÔºâ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Objective-C</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UITableView Âü∫Á°Ä]]></title>
    <url>%2F2016%2F08%2F30%2FUITableView%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[UITableViewÊòØÊúÄÂ∏∏Áî®ÁöÑÂü∫Êú¨Êéß‰ª∂„ÄÇÊ≠§Â§ÑÂØπÂÖ∂‰∏ÄËà¨Áî®Ê≥ïËøõË°åÊÄªÁªì„ÄÇ UITableViewÂü∫Á°ÄUITableView ÁöÑÊ†∑Âºè UITableViewStylePlain Â∞Ü‰ºö‰øùÊåÅÂú®È°∂ÈÉ®Áõ¥Âà∞Ë¢´È°∂Êéâ UITableViewStyleGroupedÂ∞Ü‰ºöÈöèÁùÄcell‰∏ÄËµ∑ÊªöÂä® 1UITableView *tableView = [[UITableView alloc] initWithFrame:CGRectZero style:UITableViewStyle]; ÂÖ∂‰∏≠CGRectZeroË°®Á§∫equivalent to CGRectMake(0, 0, 0, 0).‰πãÂêé‰ª£Á†Å‰ºöÊîπUITableViewÁöÑFrameÔºåÊâÄ‰ª•ÊöÇ‰∏îÈÉΩÊòØ0„ÄÇ UITableViewÂØπË±°Êèê‰æõÊï∞ÊçÆUITableView‰∏çÂåÖÂê´‰ªª‰ΩïÊï∞ÊçÆÔºåÈúÄË¶ÅÊèê‰æõ‰∏Ä‰∏™Êï∞ÊçÆÊ∫ê.Êàë‰ª¨Â∞ÜBNRAppDelegateÂÆû‰æãËÆæÁΩÆ‰∏∫UITableViewÂØπË±°ÁöÑÊï∞ÊçÆÊ∫ê„ÄÇBNRAPPDelegateÂøÖÈ°ªÈÅµÂæ™UITableViewDataSourceÂçèËÆÆ„ÄÇÂú®BNRAPPDelegate.hÊñá‰ª∂‰∏≠ÔºåÂ£∞ÊòéBNRAPPDelegateÈÅµÂæ™UITableViewDataSourceÂçèËÆÆ1234@interface BNRAppDelegate: UIResponder &lt;UIApplicationDelegate,UITableViewDataSource&gt;@property (nonatomic) UITableView *taskTable;@property (nonatomic) NSMutable Array *tasks;@end Âú®.m‰∏≠ÂêëUITableViewÂèëÈÄÅsetDataSourceÊ∂àÊÅØÔºåÂ∞ÜBNRAPPDelegateÂÆû‰æãËÆæÁΩÆ‰∏∫Êï∞ÊçÆÊ∫ê 1self.taskTable.dataSource = self; UITableViewDataSourceËÆæÁΩÆ‰∫Ü‰∏§‰∏™ÂøÖÈ°ªÊñπÊ≥ïÔºö Ê†πÊçÆÊåáÂÆöÁöÑË°®Ê†ºÁ¥¢ÂºïÁªôÂá∫Áõ∏Â∫îË°®Ê†ºÊÆµÂåÖÂê´ÁöÑË°åÊï∞ÔºàtableViewÔºönumberOfRowsInSectionÔºöÔºâ Ê†πÊçÆÊåáÂÆöË°®Ê†ºÊÆµÁ¥¢ÂºïÂíåË°åÁ¥¢ÂºïÁªôÂá∫Áõ∏Â∫îÁöÑUITableViewCellÂØπË±°ÔºàtableViewÔºöcellForRowAtIndexPathÔºöÔºâ1234567891011@implementation BNRAppDelegate-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section&#123; return [self.tasks count];&#125;-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath&#123; UITableViewCell *c = [self.taskTable dequeueReusableCellWithIdentifier:@‚Äúcell‚Äù forIndexPath:indexPath]; //ÈáçÁî®cell NSString *item = [self.tasks objectAtIndex:indexPath.row]; c.textLabel.text = item; return c;&#125; Âà∑Êñ∞Ë°®Ê†ºÔºö[self.taskTable reloadData]; ‰ΩøÁî® dequeueReuseableCellWithIdentifier:forIndexPath: ÂøÖÈ°ªË¶ÅÊ≥®ÂÜå registerClass Ôºå‰ΩÜÊòØ‰∏çÁî®Âà§Êñ≠ÊòØÂê¶ÈùûÁ©∫‰ª•ÂèäÊâãÂä®ÂàõÂª∫„ÄÇ ‰ΩøÁî® dequeueReuseableCellWithIdentifier: ÂèØ‰ª•ÂÖçÂéªÊ≥®ÂÜåÔºå‰ΩÜÊòØÈúÄË¶ÅÊâãÂä®Âà§Êñ≠ÊòØÂê¶‰∏∫Á©∫Ôºå‰∏∫Á©∫ÁöÑËØùËøòË¶ÅÊâãÂä®ÂàõÂª∫ ÈáçÁî®UITableViewCellÂØπË±°ÈúÄË¶ÅÂ∞ÜËá™ÂÆö‰πâÁöÑcellÁ±ªÂíåidentifierËøõË°åÂÖ≥ËÅî„ÄÇÂú®ViewController.m‰∏≠Ë¶ÜÁõñviewDidLoadÊñπÊ≥ïÔºåÂêëË°®ËßÜÂõæÊ≥®ÂÜåÂ∫îËØ•‰ΩøÁî®ÁöÑUITabeViewCell1234-(void)viewDidLoad&#123; [super viewDidLoad]; [self.tableView registerClass:[UITableViewCell class] forCellReuseIdentifier:@‚ÄúUITableViewCell‚Äù];&#125; ËøôÊ†∑UITableViewCellÁ±ªÂ∞±ÂíåËøô‰∏™stringÂÖ≥ËÅîËµ∑Êù•‰∫Ü„ÄÇ‰πüÂèØ‰ª•‰ΩøÁî®nibÊñá‰ª∂ÂÖ≥ËÅî1[self.tableView registerNib:[UINib nibWithNibName:@"MineUserInfoCell" bundle:nil] forCellReuseIdentifier:@"MineUserInfoCellIdentifier"]; Á∫Ø‰ª£Á†ÅÁî® registerClassÔºåÊúâ xib Áî® registerNib. ‰ª£Á†ÅÂàõÂª∫Ôºå‰ΩøÁî® registerClass: Ê≥®ÂÜå, dequeueÊó∂‰ºöË∞ÉÁî® cell ÁöÑ - (id)initWithStyle:withReuseableCellIdentifier: Ëã•‰ΩøÁî®nibÔºå‰ΩøÁî® registerNib: Ê≥®ÂÜåÔºådequeueÊó∂‰ºöË∞ÉÁî® cell ÁöÑ-(void)awakeFromNib ‰ΩøÁî®UIViewControllerÂàõÂª∫tabeViewÈúÄË¶ÅËá™Â∑±ÂàõÂª∫tableviewÂ±ûÊÄßÔºö1@property (nonatomic, strong) UITableView *tableView; ËøôÈáåË¶ÅÁî®strong ÔºåÂõ†‰∏∫Ëøô‰∏™tableviewÊòØËá™Â∑±ÂàõÂª∫ÁöÑ„ÄÇÂ¶ÇÊûúÊòØweakÈÇ£‰πàÊåáÂêëÁöÑÂú∞ÊñπÂú®ÂàõÂª∫ÂêéÂ∞±Ë¢´ARCÂõûÊî∂‰∫Ü,ÈÇ£‰πàËøô‰∏™tableviewÊåáÈíàÂ∞±Êàê‰∫ÜÈáéÊåáÈíà‰∫Ü„ÄÇÂ¶ÇÊûúÊòØËøûÁ∫øÁöÑÂ∞±ÂèØ‰ª•Áî®weakÔºåweakÂ±ûÊÄß‰∏ÄËà¨Áî®Âú®ÂΩìÂâçÂ±ûÊÄßÊòØÂÖ∂‰ªñÁ±ªÂàõÂª∫ÔºåÂè™Â≠ò‰∏Ä‰∏™ËØ•Â±ûÊÄßÁöÑÂºïÁî®ÁöÑÊó∂ÂÄôÔºå‰∏∫‰∫ÜÂº∫ÂºïÁî®ÈÇ£‰∏™Á±ª„ÄÇ ÂàõÂª∫Â§ö‰∏™sectionÁöÑtableviewÂàõÂª∫Â§ö‰∏™sectionÁöÑtableviewÈúÄË¶ÅÂÆûÁé∞ÊñπÊ≥ïnumberOfSectionsInTableView:ËøîÂõûtableview‰∏≠sectionÁöÑ‰∏™Êï∞„ÄÇÂÖ∂‰Ωô‰ΩøÁî®ÂíåÂçï‰∏™section‰∏ÄÊ†∑„ÄÇ Âú®cellForRowAtIndexPath:ÊñπÊ≥ï‰∏≠ÔºåÈúÄË¶ÅÂå∫ÂàÜ‰∏çÂêåsectionËøîÂõû‰∏çÂêåcell„ÄÇÂå∫ÂàÜsectionÁöÑÊñπÂºèÂú®‰∫éËØ•ÊñπÊ≥ï‰º†ÂÖ•ÁöÑÂèÇÊï∞(NSIndexPath *)indexPath„ÄÇ NSIndexPathÊòØ‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÔºåÂÖ∑Êúâ‰∏§‰∏™Â±ûÊÄßrowÂíåsection„ÄÇË°®Á§∫ÊâÄÂú®sectionÂíåsectionÂÜÖrow„ÄÇNSIndexPath‰∏≠ÁöÑÂ±ûÊÄßÊòØÂè™ËØªÁöÑÔºå‰∏çËÉΩÁõ¥Êé•‰øÆÊîπ„ÄÇÂè™ËÉΩÈÄöËøáÈáçÊñ∞ÂàõÂª∫ÁöÑÂΩ¢ÂºèÔºåËææÂà∞‰øÆÊîπÂ±ûÊÄßÁöÑÁõÆÁöÑ„ÄÇÂàõÂª∫ÊñπÂºè:1NSIndexPath *indexPath = [NSIndexPath indexPathForRow:1 inSection:1]; TableViewË°®Â§¥ËßÜÂõæË°®Â§¥ËßÜÂõæÊòØÊåáUITableViewÂØπË±°ÂèØ‰ª•Âú®ÂÖ∂Ë°®Ê†º‰∏äÊñπÊòæÁ§∫ÁöÑÁâπÂÆöËßÜÂõæÔºåÊòØÂíåÊîæÁΩÆÈíàÂØπÊüê‰∏™Ë°®Ê†ºÊÆµÊàñÊï¥Âº†Ë°®Ê†ºÁöÑÊ†áÈ¢òÂíåÊéß‰ª∂„ÄÇË°®Â§¥ËßÜÂõæÂèØ‰ª•ÊòØ‰ªªÊÑèUIViewÂØπË±°„ÄÇË°®Ê†ºËßÜÂõæÊúâ‰∏§ÁßçÔºåÂàÜÂà´ÈíàÂØπË°®Ê†ºÊÆµÂíåË°®Ê†º„ÄÇÁ±ª‰ººÁöÑÔºåËøòÊúâË°®Â∞æËßÜÂõæ„ÄÇ1UIView *headerView = [[[NSBundle mainBundle] loadNibNamed:@"HotelReviewsHeaderView" owner:nil options:nil]lastObject]; loadNibNamed:owner:options:ËøîÂõûÁöÑÊòØ‰∏™Êï∞ÁªÑÔºå‰øùÂ≠ò‰∫Üxib‰∏≠ÁöÑÂêÑ‰∏™view„ÄÇxib‰∏≠ÊúâÂá†‰∏™viewÔºåÊï∞ÁªÑÂÖÉÁ¥†Â∞±ÊòØÂá†„ÄÇÂõ†Ê≠§ÔºåÂèØ‰ª•Â∞ÜÂ§ö‰∏™Ëá™ÂÆö‰πâÁöÑviewÊàñËÄÖcellÊîæÂú®‰∏Ä‰∏™xib‰∏≠ÔºåÈÄöËøáÊï∞ÁªÑÁöÑÊñπÂºèËé∑ÂèñÊÉ≥Ë¶ÅÁöÑview„ÄÇinitWithNibNameÁöÑÂÆûÁé∞ÂíåËØ•ÊñπÊ≥ïÁ±ª‰ººÔºåÂÖ∂‰∏≠‰πü‰ºöÁî®Âà∞ËØ•ÊñπÊ≥ï„ÄÇ‰∏çËøáinitWithNibNameÁî®Âú®Ëé∑ÂèñControllerÁöÑxib‰∏≠„ÄÇ 1234- (void)viewDidLoad&#123; UIView *header = self.headerView; [self.tableView setTableHeaderView:header];&#125; Âä†ËΩΩÂÆåheaderViewÂêéÔºåÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫UITableViewÂØπË±°ÁöÑË°®Â§¥ËßÜÂõæ„ÄÇ‰πüÂèØ‰ª•Âú® (UIView *)tableView:viewForHeaderInSection:ÊñπÊ≥ï‰∏≠ËÆæÁΩÆÔºåÂΩìÂè™Êúâ‰∏Ä‰∏™sectionÊó∂ÊïàÊûúÁõ∏Âêå„ÄÇ1234- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section&#123; UIView *view = [[[NSBundle mainBundle] loadNibNamed:@"HeaderView" owner:nil options:nil] lastObject]; return view;&#125; tableviewÁöÑÂ≠óÊØçÁ¥¢ÂºïÂÆûÁé∞sectionIndexTitlesForTableViewÊñπÊ≥ïÔºåËøîÂõû‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑÔºö123456- (NSArray&lt;NSString *&gt; *)sectionIndexTitlesForTableView:(UITableView *)tableView&#123; NSMutableArray *indexs = [[NSMutableArray alloc]init]; [indexs addObject:@"Êàë"]; [indexs addObject:@"ÊòØ"]; return indexs;&#125; Ëøô‰∏™ËøîÂõûÊï∞ÁªÑÁöÑÂÜÖÂÆπÂíåÂêÑ‰∏™sectionÂØπÂ∫îÔºåÁÇπÂáªÁ¥¢ÂºïÔºåÂ∞±ËÉΩË∑≥ËΩ¨Âà∞ÂØπÂ∫îsection„ÄÇ ÁÇπÂáªcell‰∏≠buttonËé∑ÂèñÊâÄÂ±ûindexpathbuttonÁÇπÂáª‰∫ã‰ª∂‰∏≠Êúâ‰∏Ä‰∏™eventÂØπË±°ÔºåËÆ∞ÂΩï‰∫ÜÂΩìÂâçÁÇπÂáªÂùêÊ†áÔºåÁÑ∂ÂêéÈÄöËøáÂùêÊ†áËÉΩÂ§üÊâæÂà∞ÊâÄÂ±ûÁöÑcell„ÄÇÂèØ‰ª•Âú®cell‰∏≠‰∏∫ÁÇπÂáª‰∫ã‰ª∂ËÆæÁΩÆ‰ª£ÁêÜÔºåÁÑ∂ÂêéÂú®viewcontroller‰∏≠ÂÆûÁé∞„ÄÇÂΩìÁÑ∂ÔºåÊõ¥Êé®ËçêÁöÑÊòØÁõ¥Êé•Âú®viewcontroller‰∏≠Ê∑ªÂä†ÂíåÂÆûÁé∞ÁÇπÂáª‰∫ã‰ª∂„ÄÇ12345678910111213[cell.btn addTarget:self action:@selector(cellBtnClicked:event:) forControlEvents:UIControlEventTouchUpInside];- (void)cellBtnClicked:(id)sender event:(id)event&#123; NSSet *touches =[event allTouches]; UITouch *touch =[touches anyObject]; CGPoint currentTouchPosition = [touch locationInView:_tableView]; NSIndexPath *indexPath= [_tableView indexPathForRowAtPoint:currentTouchPosition]; if (indexPath!= nil) &#123; // do something &#125;&#125; ÂèØ‰ª•ÈÄöËøáeventÊãøÂà∞Âú®tableView‰∏≠ÁöÑ‰ΩçÁΩÆcureÔºåÂÜçÈÄöËøáindexPathForRowAtPoint:ÊñπÊ≥ïËé∑ÂèñNSIndexPath„ÄÇ Âè¶Â§ñ‰∏ÄÁßçÊñπÊ≥ïÊòØÔºåÂú®cell‰∏≠‰ΩøÁî®‰ª£ÁêÜÔºåÁõ¥Êé•Â∞Ücell‰º†ÁªôviewcontrollerÔºö12345678910111213//cell.h‰∏≠ÁöÑÂ£∞Êòé- (IBAction)buttonPressed :(id)Ôºõ//cell.m‰∏≠ÁöÑÂÆûÁé∞ÔºåËÆæÁΩÆ‰ª£ÁêÜ- (void)buttonPressed:(id)sender&#123; [self.delegate buttonPressed:self event:event];&#125;//viewcontroller‰∏≠ÁöÑÂÆûÁé∞- (void)buttonPressed:(TableViewCell1 *)cell&#123; NSIndexPath *indexPath2 = [_tableView indexPathForCell:cell]; NSLog(@"ÊâÄÂ±ûË°åÊï∞Ôºö%ld",(long)indexPath2.row+1);&#125; ÈÄöËøáËÆæÁΩÆdelegateÔºåÂ∞ÜbuttonÁöÑÁÇπÂáª‰∫ã‰ª∂‰∫§ÁªôviewControllerÂÆåÊàê„ÄÇ Ê≥®ÊÑèÔºåÂ¶ÇÊûúÊòØÈÇ£ÁßçÁÇπÂáª button ÂêéÂà†Èô§ÁöÑÈúÄÊ±ÇÔºåÂú®Ë∞ÉÁî® deleteItemsAtIndexPaths: ‰πãÂâçÔºå‰∏ÄÂÆöË¶ÅÂÖàÂà†Èô§Êï∞ÊçÆÊ∫êÈáåÁöÑÊï∞ÊçÆÔºåÂõ†‰∏∫deleteItemsAtIndexPaths: Ë∞ÉÁî®ÂêéÔºå‰ºöÂà∑Êñ∞ÈÉ®ÂàÜÊï∞ÊçÆ„ÄÇ iOSÈ´òÁ∫ßÂºÄÂèë‚Äî‚ÄîCollectionViewÁöÑÂä®ÊÄÅÂ¢ûÂà†cellÂèä‰ΩøÁî®Ê®°ÂûãÈáçÊûÑ ÁºñËæëUITableViewÁºñËæëÊ®°Âºè‰∏ãÁöÑUITableViewËøõÂÖ•ÁºñËæëÊ®°ÂºèÈÄöËøáË∞ÉÁî®[_tableView setEditing:!_tableView.isEditing animated:true]ËøõÂÖ•ÁºñËæëÊ®°Âºè,ÂèØÂÆûÁé∞Ê∑ªÂä†ÔºåÂà†Èô§ÔºåÁßªÂä®Êìç‰Ωú„ÄÇÈªòËÆ§ÊòØÂà†Èô§ÔºåÂç≥cellÂ∑¶ËæπÂá∫Áé∞‰∏Ä‰∏™Á∫¢Ëâ≤ÁöÑÂáèÂè∑ÔºåÁÇπÂáªÂèØ‰ª•Âà†Èô§ËØ•Ë°å„ÄÇ ËÆæÁΩÆÂèØ‰ª•ÁºñËæëÁöÑË°å‰ΩøÁî®setEditing:animated:ÊñπÊ≥ïËÆ©tableViewËøõÂÖ•ÁºñËæëÊ®°Âºè.ÂèØ‰ª•‰ΩøÁî®tableView:canEditRowAtIndexPathÊñπÊ≥ïÁ≠õÈÄâËÉΩËøõÂÖ•ÁºñËæëÊ®°ÂºèÁöÑË°åÔºö1234567- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath &#123; if(indexPath.row == (10 | 12 | 14))&#123; return NO; &#125;else&#123; return YES; &#125;&#125; Â¶ÇÊûú‰∏çÂÆûÁé∞ËØ•ÊñπÊ≥ïÔºåÈªòËÆ§‰∏∫YES„ÄÇ ËÆæÁΩÆÁºñËæëÊ®°ÂºèÈÄöËøáËÆæÁΩÆUITableViewCellEditingStyleÂèØ‰ª•ÂàáÊç¢ËøõÂÖ•ÁöÑÁºñËæëÊ®°ÂºèÊòØÂÆûÁé∞ÊèíÂÖ•ËøòÊòØÂà†Èô§Êìç‰Ωú„ÄÇËøô‰∏™ËøîÂõûÂÄºÂ∞Ü‰Ωú‰∏∫‰∏ãÈù¢ÁöÑcommitEditingStyle:forRowAtIndexPath:ÊñπÊ≥ïÁöÑÂÖ•ÂèÇ‰º†ÂÖ•„ÄÇ1234567-(UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath&#123; if (ÂÖ∑‰ΩìÊÉÖÂÜµ) &#123; return UITableViewCellEditingStyleInsert; &#125;else&#123; return UITableViewCellEditingStyleDelete; &#125;&#125; ËÆæÁΩÆÁºñËæëÊ®°Âºè‰∏ãÁöÑÊìç‰ΩúÂÆûÁé∞tableView:commitEditingStyle:forRowAtIndexPath:Ëøô‰∏™Áªü‰∏ÄÁöÑÂõûË∞ÉÊñπÊ≥ïÔºåÊó†ËÆ∫ÊòØÊ∑ªÂä†ËøòÊòØÂà†Èô§ÈÉΩ‰ºöÊâßË°åÔºåÈúÄË¶ÅËá™Â∑±Ê†πÊçÆÂÖ•ÂèÇÂå∫ÂàÜÂºÄ„ÄÇÁ¨¨‰∫å‰∏™ÂÆûÂèÇÊòØUITableViewCellEditingStyleÁ±ªÂûãÁöÑÂ∏∏Êï∞(Âà†Èô§Ë°®Ê†ºË°åÊó∂Ôºå‰º†ÂÖ•ÁöÑÊòØUITableViewCellEditingStyleDelete;ÊèíÂÖ•Ë°®Ê†ºË°åÊó∂Ôºå‰º†ÂÖ•ÁöÑÊòØUITableViewCellEditingStyleInsert)„ÄÇ123456789- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath &#123; if (editingStyle == UITableViewCellEditingStyleDelete) &#123; [self.dataSource removeObjectAtIndex:indexPath.row]; [self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade]; &#125;else if (editingStyle == UITableViewCellEditingStyleInsert)&#123; [self.dataSource insertObject:@"ÊàëÊòØÊñ∞Êù•ÁöÑ" atIndex:indexPath.row]; [_tableView insertRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationBottom]; &#125;&#125; ‰ΩøÁî®deleteRowsAtIndexPathsÂíåinsertRowsAtIndexPathsÂèØ‰ª•ËøõË°åÂ±ÄÈÉ®Âà∑Êñ∞ÔºåËäÇÁúÅËµÑÊ∫êÔºåÂπ∂‰∏îËøòËÉΩÊ∑ªÂä†ÊåáÂÆöÂä®Áîª„ÄÇ cellÁöÑÁßªÂä®ËøõÂÖ•ÁºñËæëÊ®°ÂºèÂêéÂÆûÁé∞tableView:moveRowAtIndexPath:ÊñπÊ≥ï123456789- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath&#123; if(sourceIndexPath == destinationIndexPath)&#123; return ; &#125;else&#123; Comment *comment = [self.dataSource objectAtIndex:sourceIndexPath.row]; [self.dataSource removeObjectAtIndex:sourceIndexPath.row]; [self.dataSource insertObject:comment atIndex:destinationIndexPath.row]; &#125;&#125; ‰∏ÄÂÆöË¶ÅÂØπÊï∞ÊçÆÊ∫êËøõË°åÊ≠£Á°ÆÊìç‰Ωú„ÄÇ ‰æßÊªëËèúÂçïËÆ∏Â§ö app Êèê‰æõ‰æßÊªëÊüê‰∏ÄÊ†èÂ±ïÁ§∫ËèúÂçïÁöÑÂäüËÉΩ„ÄÇËøôÂú® iOS8 ‰∏≠Êúâ‰∫ÜÈªòËÆ§ÁöÑÂÆûÁé∞Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051//ËÆæÁΩÆcellÂèØÁºñËæëÁä∂ÊÄÅ-(BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath&#123; return YES;&#125;//ÂÆö‰πâÁºñËæëÊ†∑Âºè‰∏∫Âà†Èô§Ê†∑Âºè-(UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath&#123; return UITableViewCellEditingStyleDelete;&#125;//ËÆæÁΩÆËøîÂõûÂ≠òÊîæ‰æßÊªëÊåâÈíÆÊï∞ÁªÑ-(NSArray&lt;UITableViewRowAction *&gt; *)tableView:(UITableView *)tableView editActionsForRowAtIndexPath:(NSIndexPath *)indexPath&#123; //ËøôÊòØiOS8‰ª•ÂêéÁöÑÊñπÊ≥ï UITableViewRowAction *deleBtn = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDestructive title:@"Âà†Èô§" handler:^(UITableViewRowAction * _Nonnull action, NSIndexPath * _Nonnull indexPath) &#123; [_messageData removeObjectAtIndex:indexPath.row]; [tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationBottom]; &#125;]; UITableViewRowAction *moreBtn = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDestructive title:@"Êõ¥Â§öÊõ¥Â§ö" handler:^(UITableViewRowAction * _Nonnull action, NSIndexPath * _Nonnull indexPath) &#123; NSLog(@"Êõ¥Â§öÔºåÔºåÁÇπ‰∫Ü"); &#125;]; UITableViewRowAction *upBtn = [UITableViewRowAction rowActionWithStyle:UITableViewRowActionStyleDestructive title:@"ÁΩÆÈ°∂" handler:^(UITableViewRowAction * _Nonnull action, NSIndexPath * _Nonnull indexPath) &#123; [_messageData exchangeObjectAtIndex:indexPath.row withObjectAtIndex:0]; NSIndexPath *firstIndexPath = [NSIndexPath indexPathForRow:0 inSection:indexPath.section]; [tableView moveRowAtIndexPath:indexPath toIndexPath:firstIndexPath]; &#125;]; //ËÆæÁΩÆËÉåÊôØÈ¢úËâ≤Ôºå‰ªñ‰ª¨ÁöÑÂ§ßÂ∞è‰ºöÂàÜÂ±ÄÊñáÂ≠óÂÜÖÂÆπËá™ÈÄÇÂ∫îÔºåÊâÄ‰ª•‰∏çÁî®ÊãÖÂøÉ deleBtn.backgroundColor = [UIColor redColor]; moreBtn.backgroundColor = [UIColor orangeColor]; upBtn.backgroundColor = [UIColor grayColor]; return @[deleBtn,moreBtn,upBtn]; &#125; ËøòÊòØËÆæÁΩÆ‰∏∫ÂèØÁºñËæëÔºåÁÑ∂ÂêéËÆæÁΩÆÁºñËæëÊ†∑Âºè‰∏∫Âà†Èô§Ê†∑Âºè„ÄÇ‰∏çÂêåÁöÑÊòØÔºåÈúÄË¶ÅÂÆûÁé∞‰∏Ä‰∏™‰æßÊªëÁöÑ‰∏ìÁî®ÂõûË∞ÉÊñπÊ≥ï„ÄÇÈúÄË¶ÅÂàõÂª∫Â§ö‰∏™ UITableViewRowAction ÂØπË±°Ôºå‰Ω†ÂèØ‰ª•ÂÉè button ‰∏ÄÊ†∑ËÆæÁΩÆÂÆÉ‰ª¨Ôºå‰∏çËøáÂú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÈúÄË¶Å‰∫ãÂÖàËÆæÁΩÆÂ•ΩÊØÅÊéâÊñπÊ≥ï„ÄÇ ‰ª£Á†ÅÊéßÂà∂ÁöÑÁºñËæëÊñπÂºè‰∏äÈù¢ËØ¥ÁöÑÈÉΩÊòØ‰∫§‰∫íÊÉÖÂÜµ‰∏ãÁöÑÁºñËæëÊñπÂºè„ÄÇÊàë‰ª¨ÂèØ‰ª•Ëá™Â∑±ÈÄöËøá‰ª£Á†ÅÊéßÂà∂Âà∑Êñ∞ËßÜÂõæÔºå‰∏çÈúÄË¶Å‰∫§‰∫í„ÄÇ Âà∑Êñ∞ÊñπÂºèÁÆÄÂçïÊÄªÁªì‰∏Ä‰∫õUITableViewÁöÑÂà∑Êñ∞ÊñπÊ≥ïÔºö reloadData Âà∑Êñ∞Êï¥‰∏™Ë°®Ê†º reloadRowsAtIndexPaths:withRowAnimation:Âà∑Êñ∞indexPathÊåáÂêëÁöÑcell reloadSections:withRowAnimation: Âà∑Êñ∞NSIndexSetÂÜÖÂåÖÂê´ÁöÑSection Ëøô‰∏â‰∏™ÂàÜÂà´Âà∑Êñ∞tableviewÁöÑÂêÑ‰∏™ÈÉ®ÂàÜÁ¨¨‰∏Ä‰∏™Ê≤°ÊúâÂä®ÁîªÊïàÊûú„ÄÇÁ¨¨‰∫å‰∏™ÂèØ‰ª•‰º†ÂÖ•‰∏Ä‰∏™Êï∞ÁªÑ1[_tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationTop]; Á¨¨‰∏â‰∏™ÂèØ‰ª•‰º†ÂÖ•‰∏Ä‰∏™NSIndexSetÈõÜÂêà12[self.tableView reloadSections:[NSIndexSet indexSetWithIndexesInRange:NSMakeRange(0, 2)] withRowAnimation:UITableViewRowAnimationFade];[_tableView reloadSections:[NSIndexSet indexSetWithIndex:indexPath.section]withRowAnimation:UITableViewRowAnimationLeft]; ÊèíÂÖ•Âà†Èô§Âú®ÁºñËæëÊ®°Âºè‰∏ãÁöÑÊèíÂÖ•Âà†Èô§ÊñπÂºèÔºåÂèØ‰ª•Áõ¥Êé•Áî®Âú®‰ªª‰ΩïÊÉ≥Áî®ÁöÑÂú∫ÊôØ‰∏ãÔºåÂè™ÈúÄË¶ÅË∞ÉÁî®‰∏Ä‰∏ãÊñπÊ≥ïÔºåÂπ∂‰∏î‰øùÊåÅdataSourceÊ≠£Á°ÆÂç≥ÂèØ„ÄÇ deleteRowsAtIndexPaths:withRowAnimation: insertRowsAtIndexPaths:withRowAnimation: Â∞±‰∏ç‰∏æ‰æã‰∫Ü„ÄÇÂêå‰∏äÈù¢‰∏ÄÊ†∑„ÄÇ beginUpdatesÂíåendUpdatesÂ¶ÇÊûúË¶ÅÂêåÊó∂ËøõË°åÂà∑Êñ∞ÊàñËÄÖÊèíÂÖ•Âà†Èô§ÁßªÂä®Á≠âÊìç‰ΩúÔºåÈúÄË¶Å‰ΩøÁî® beginUpdates Âíå endUpdates ÂåÖË£πÔºå‰Ωú‰∏∫‰∏Ä‰∏™Âä®ÁîªÁªÑËøõË°å„ÄÇ Â¶ÇÊûúË¶ÅËá™Â∑±ÊéßÂà∂Âä®ÁîªÁöÑÊó∂Èó¥ÂèØ‰ª•ÈÄöËøáÂä®ÁîªÁöÑÊñπÂºèÔºö 123456789101112131415[UIView animateKeyframesWithDuration:1 delay:0 options:UIViewKeyframeAnimationOptionAutoreverse animations:^&#123; &#125; completion:^(BOOL finished) &#123; // Ê∑ªÂä†Transaction‰∫ãÂä° [CATransaction begin]; [CATransaction setCompletionBlock:^&#123; NSLog(@"Âä®ÁîªÂÆåÊàê") &#125;]; [self.tableView beginUpdates]; [self.tableView moveRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0] toIndexPath:[NSIndexPath indexPathForRow:2 inSection:0]]; NSString *str = self.arrayData[0]; [self.arrayData removeObjectAtIndex:0]; [self.arrayData insertObject:str atIndex:2]; [self.tableView endUpdates]; [CATransaction commit]; &#125;]; beginUpdates Âíå endUpdates Êúâ‰∏Ä‰∏™Â•ΩÂ§ÑÂ∞±ÊòØ‰ºöË∞ÉÁî® heightForRow ÊîπÂèòÈ´òÂ∫¶Ôºå‰ΩÜÊòØ‰∏ç‰ºöË∞ÉÁî® cellForRow Âà∑Êñ∞ËßÜÂõæ„ÄÇÊâÄ‰ª•ÔºåÂΩì tableView ÁöÑÊüê‰∏ÄÈ°πÈ´òÂ∫¶ÊîπÂèòÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®ËØ•ÊñπÊ≥ïÂà∑Êñ∞È´òÂ∫¶„ÄÇ 123// Âà∑Êñ∞ tableView ‰∏≠ cell ÁöÑÈ´òÂ∫¶self.tableView.beginUpdates()self.tableView.endUpdates() Â∞èÊäÄÂ∑ßÂΩìcellÊú™ËÉΩÂ°´Êª°tableviewÊó∂ÔºåÊÄé‰πàÂìçÂ∫îÁ©∫ÁôΩÈÉ®ÂàÜÁÇπÂáª‰∫ã‰ª∂ÂΩì tableview Â§™Â§ßÔºåcell Â§™Â∞ëÔºå‰ª•Ëá≥‰∫é‰∏çËÉΩÂ°´Êª°tableviewÁöÑÊó∂ÂÄôÔºåÈÇ£‰πàÁ©∫ÁôΩÈÉ®ÂàÜÁöÑÁÇπÂáª‰∫ã‰ª∂ËØ•ÊÄé‰πàËÆæÁΩÆÂë¢ÔºüÂè™Ë¶ÅÁªô tableview Ê∑ªÂä†‰∏Ä‰∏™ footerviewÔºåËøô‰∏™ footerview ÁöÑÂ§ßÂ∞èÊòØÊï¥‰∏™ tableview ÁöÑÂ§ßÂ∞èÔºåÁÑ∂ÂêéËÆæÁΩÆËøô‰∏™ footerview ÁöÑÁÇπÂáª‰∫ã‰ª∂Âç≥ÂèØ„ÄÇ ‰∏∫‰ªÄ‰πàËÉΩËøôÊ†∑Âë¢ÔºüÂõ†‰∏∫ cell Ê≤°ÊúâÂ°´ÂÖÖÊª°ÁöÑÈÉ®ÂàÜÈÉΩÁî® footerview Â°´ÂÖÖ‰∫Ü„ÄÇ UITableView ÂèñÊ∂àÁÇπÂáªcellÁöÑÈÄâ‰∏≠ËÉåÊôØÈ¢úËâ≤ÊñπÊ≥ï‰∏ÄÂú®ÈÄâ‰∏≠ÁöÑÂõûË∞ÉÊñπÊ≥ï‰∏≠ÂèñÊ∂àÈÄâ‰∏≠Ôºö 123- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath &#123; [tableView deselectRowAtIndexPath:indexPath animated:NO];&#125; ÊñπÊ≥ï‰∫åËÆæÁΩÆ cell ÁöÑÈÄâ‰∏≠Â±ûÊÄßÔºö 12345-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath&#123; ... cell.selectionStyle = UITableViewCellSelectionStyleNone; ...&#125; cell ÁöÑÁÇπÂáª‰∫ã‰ª∂‰∏çÂìçÂ∫îÊúâÂèØËÉΩÊòØÂú® cell ÈáåËÆæÁΩÆ‰∫Ü UIButtonÔºåÁî±‰∫éÂìçÂ∫îÊú∫Âà∂ÔºåÂÖàÂìçÂ∫î UIButton ÁöÑÁÇπÂáª‰∫ã‰ª∂„ÄÇÊâÄ‰ª•Â∞±ÂøΩÁï•‰∫Ü cell ÁöÑ didSelect ÊñπÊ≥ï„ÄÇ ÊâÄ‰ª•Ë¶ÅÂÅöÁöÑÂ∞±ÊòØÂ∞Ü UIButton ÁöÑ UserInteractionEnabled ËÆæÁΩÆ‰∏∫ No„ÄÇ ‰ΩøÁî® UILocalizedIndexedCollation ÂØπÊï∞ÊçÆÊ∫êÂàÜÁªÑÊØîÂ¶Ç‰∏Ä‰∏™ËÅîÁ≥ª‰∫∫ÁöÑ tableViewÔºåÊàë‰ª¨ÈúÄË¶ÅÊääËÅîÁ≥ª‰∫∫ÊåâÁÖßÈ¶ñÂ≠óÊØçÂàÜÁªÑÊòæÁ§∫„ÄÇiOS Â∞±Êèê‰æõ‰∫Ü‰∏Ä‰∏™ UILocalizedIndexedCollation Â∏ÆÂä©Êàë‰ª¨ËøõË°åÂàÜÁªÑ„ÄÇ Â±ûÊÄß‰∏éÊñπÊ≥ïUILocalizedIndexedCollation ÈúÄË¶ÅË¢´ËÆ∞‰ΩèÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ïÂ∞±Ëøô‰πàÂá†‰∏™Ôºö 12345678// Ëé∑ÂæóÂçï‰æã UILocalizedIndexedCollation ÁöÑÂÆû‰æã+ (instancetype)currentCollation;// Â≠óÁ¨¶Á¥¢ÂºïÊï∞ÁªÑ(ÂÖ∂ÂÆûÂÜÖÂÆπÊòØÂõ∫ÂÆöÁöÑÂ∞±ÊòØ A-Z,Âä†‰∏ä‰∏Ä‰∏™‰ª£Ë°®ÂÖ∂‰ªñÁöÑ #)@property(nonatomic, readonly) NSArray&lt;NSString *&gt; * sectionTitles;// ËæìÂÖ•ÂØπË±°‰ª•Âèä‰∏Ä‰∏™ËøîÂõûÂ≠óÁ¨¶‰∏≤ÁöÑÂØπË±°ÊñπÊ≥ïÔºåÊ†πÊçÆËøîÂõûÁöÑ int Âà§Êñ≠Â≠óÁ¨¶‰∏≤Ë¶ÅÂä†ÂÖ•Âì™‰∏™ÂàÜÁªÑ- (NSInteger)sectionForObject:(id)object collationStringSelector:(SEL)selector;// Êï∞ÁªÑÂÜÖÂØπË±°ÊéíÂ∫è- (NSArray *)sortedArrayFromArray:(NSArray *)array collationStringSelector:(SEL)selector; Èô§‰∫Ü‰∏äÈù¢ÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ïËøòÊúâ‰∏Ä‰∏™Â±ûÊÄßÂíå‰∏Ä‰∏™ÊñπÊ≥ïÁî®‰∏çÂà∞Ôºå‰∏çÁî®ÁÆ°ÂÆÉ„ÄÇ ÂÆû‰æãÊØîÂ¶ÇË¶ÅÂÆûÁé∞‰∏Ä‰∏™ÈúÄÊ±ÇÊòØÂØπËÅîÁ≥ª‰∫∫ËøõË°åÂΩíÁ±ªÔºåÁÑ∂Âêé‰ª• tableView ÁöÑÂΩ¢ÂºèÂ±ïÁ§∫„ÄÇÁâπÊÆäÁöÑÂú∞ÊñπÊó∂ÔºåÂè™Â±ïÁ§∫ÊúâÂÄºÁöÑÂàÜÁªÑ„ÄÇ ÂàùÂßãÂåñÊï∞ÁªÑ12345678910111213// Âçï‰æãÂØπË±° UILocalizedIndexedCollation *localIndex = [UILocalizedIndexedCollation curre ntCollation]; // Ëé∑ÂæóÂΩìÂâçËØ≠Ë®Ä‰∏ãÁöÑÊâÄÊúâÁöÑindexTitles _allIndexTitles = localIndex.sectionTitles; // ÂàùÂßãÂåñÊâÄÊúâÊï∞ÊçÆÁöÑÊï∞ÁªÑ (‰πãÂêéÁöÑÊâÄÊúâËøõËøáÂàÜÁªÑÁöÑÊï∞ÊçÆÈÉΩ‰øùÂ≠òÂú®Ëøô‰∏™ _data Èáå)_data = [NSMutableArray arrayWithCapacity:_allIndexTitles.count]; // ‰∏∫ÊØè‰∏Ä‰∏™indexTitle ÁîüÊàê‰∏Ä‰∏™ÂèØÂèòÁöÑÊï∞ÁªÑ for (int i = 0; i&lt;_allIndexTitles.count; i++) &#123; // ÂàùÂßãÂåñÊï∞ÁªÑ (_data ÈáåÁöÑÂÖÉÁ¥†ÊòØÂêÑ‰∏™ÂàÜÁªÑÔºåÊâÄ‰ª•‰πüÊòØÊï∞ÁªÑ) [_data addObject:[NSMutableArray array]]; &#125; // ÂàùÂßãÂåñÊúâÊïàÁöÑsectionIndexs (‰πãÂêéÊúâÂÄºÁöÑÂàÜÁªÑÁöÑÁ¥¢Âºï‰ºöË¢´‰øùÂ≠òÂú®ËøôÈáå)_sectionIndexs = [NSMutableArray arrayWithCapacity:_allIndexTitles.count]; ËøôÈáåË¶ÅÂº∫Ë∞ÉÁöÑÊòØ _data ÊòØ‰∏çÁÆ°ÂàÜÁªÑÊúâÊ≤°ÊúâÊï∞ÊçÆÔºåÈÉΩÂàõÂª∫Âπ∂‰øùÂ≠òÂà∞ÂÖ∂‰∏≠‰∫Ü„ÄÇËÄå _sectionIndexs Âè™‰øùÂ≠òÊúâÊï∞ÊçÆÁöÑÂàÜÁªÑÁöÑÁ¥¢Âºï„ÄÇ ÂàÜÁªÑ1234567891011121314151617SEL nameSelector = @selector(name); for (Person *person in persons) &#123; if (person == nil) continue; // Ëé∑ÂèñÂà∞Ëøô‰∏™contactÁöÑnameÁöÑÈ¶ñÂ≠óÊØçÂØπÂ∫îÁöÑindexTitle // Ê≥®ÊÑèËøôÈáåÂøÖÈ°ª‰ΩøÁî®ÂØπË±°ÔºåËøô‰∏™selector‰πüÊòØÊúâË¶ÅÊ±ÇÁöÑ // ÂøÖÈ°ªÊòØËøô‰∏™ÂØπË±°‰∏≠ÁöÑselector, Âπ∂‰∏î‰∏çËÉΩÊúâÂèÇÊï∞ÔºåÂøÖÈ°ªËøîÂõûÂ≠óÁ¨¶‰∏≤ // ÊâÄ‰ª•ËøôÈáåÁõ¥Êé•‰ΩøÁî® name Â±ûÊÄßÁöÑgetÊñπÊ≥ïÂ∞±ÂèØ‰ª• NSInteger index = [localIndex sectionForObject:person collationStringSe lector:nameSelector]; // Â§ÑÁêÜÂ§öÈü≥Â≠ó ‰æãÂ¶Ç "Êõæ" --&gt;&gt; ‰ºöË¢´ÂΩìÂÅö ceng Êù•Â§ÑÁêÜÔºåÂÖ∂‰ªñÈúÄË¶ÅÂ§ÑÁêÜÁöÑÂ§öÈü≥Â≠óÁ±ª‰ºº if ([person.name hasPrefix:@"Êõæ"]) &#123; index = [_allIndexTitles indexOfObject:@"Z"]; &#125; // Â∞ÜËøô‰∏™contactÊ∑ªÂä†Âà∞ÂØπÂ∫îindexTitleÁöÑÊï∞ÁªÑ‰∏≠Âéª [_data[index] addObject:person];&#125; ËøôÈáåÂ∞±ÈÄöËøá UILocalizedIndexedCollation Êèê‰æõÁöÑÊñπÊ≥ïÂ∞ÜÊï∞ÊçÆÊ∫êÂàÜÁªÑ‰∫Ü„ÄÇ‰∏äÈù¢ÁöÑÊ≥®Èáä‰πüÂÜôÂà∞‰∫ÜÔºå‰º†ÂÖ•‰∏Ä‰∏™ÂØπË±°‰ª•ÂèäÂØπË±°ÁöÑÊñπÊ≥ïÔºåÈÄöËøáÊñπÊ≥ïËøîÂõûÁöÑÂ≠óÁ¨¶‰∏≤Ëé∑ÂèñÊâÄÂú®ÂàÜÁªÑÁöÑÁ¥¢Âºï„ÄÇËé∑ÂèñÂà∞ÁöÑÁ¥¢Âºï‰Ω†ÂèØ‰ª•ÂÅöËøõ‰∏ÄÊ≠•Âà§Êñ≠‰øÆÊîπ„ÄÇÁÑ∂ÂêéÈÄöËøáËøô‰∏™Á¥¢ÂºïÂ∞ÜÂÖ∂ÊîæÂà∞ _data ÁöÑÂØπÂ∫îÂàÜÁªÑÂÜÖ„ÄÇ ÈÅçÂéÜÂàÜÁªÑ123456789for (int i=0; i&lt;_data.count; i++) &#123; NSArray *temp = _data[i]; if (temp.count != 0) &#123; // ÂèñÂá∫‰∏ç‰∏∫Á©∫ÁöÑÈÉ®ÂàÜÂØπÂ∫îÁöÑindexTitle [_sectionIndexs addObject:[NSNumber numberWithInt:i]]; &#125; // ÊéíÂ∫èÊØè‰∏Ä‰∏™Êï∞ÁªÑ _data[i] = [localIndex sortedArrayFromArray:temp collationStringSelecto r:nameSelector]; &#125; ‰∏ä‰∏ÄËäÇÂ∞ÜÊï∞ÊçÆÊ∫êÂÖ®ÈÉΩÂ°ûÂà∞‰∫ÜÂØπÂ∫îÁöÑÂàÜÁªÑÈáå„ÄÇÁé∞Âú®Â∞±Ë¶ÅÂ∞ÜÂàÜÁªÑÈáåÁöÑÊï∞ÊçÆÊéíÂ∫èÔºåÂπ∂‰∏îÂâîÈô§Ê≤°ÊúâÊï∞ÊçÆÁöÑÂàÜÁªÑ‰∫Ü„ÄÇ Âà§Êñ≠ _data ‰∏≠ÊúâÊï∞ÊçÆÁöÑÂàÜÁªÑÁöÑÁ¥¢Âºï‰øùÂ≠òÂà∞ _sectionIndexs ‰∏≠„ÄÇËøôÊ†∑‰ª•ÂêéÊãøÁùÄ _sectionIndexs ‰∏≠‰øùÂ≠òÁöÑÁ¥¢ÂºïÂ∞±ÂèØ‰ª•Âà∞ sectionTitles ‰∏≠ÔºåÊâæÂà∞Á¥¢ÂºïÂØπÂ∫îÁöÑÂÄº„ÄÇ ÁªìÂêàÂ≠óÊØçÁ¥¢ÂºïÂ±ïÁ§∫Áé∞Âú®Êàë‰ª¨Â∑≤ÁªèËé∑Âæó‰∫ÜÂÆåÊï¥ÁöÑ _data Âíå _sectionIndexs„ÄÇÂè™ÈúÄË¶ÅÈÄöËøá _sectionIndexs ‰∏≠‰øùÂ≠òÁöÑÁ¥¢ÂºïÊâæÂà∞ _data ‰∏≠Áõ∏Â∫îÁöÑÂàÜÁªÑÂç≥ÂèØÂÆåÊàêÂ±ïÁ§∫„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Âü∫Êú¨Êéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UIButton ÁÆÄ‰ªã]]></title>
    <url>%2F2016%2F08%2F29%2FUIButton%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[‰ªéÊúÄÂü∫Á°ÄÁöÑÊéß‰ª∂ÂºÄÂßã‰∏ÄÁÇπÁÇπÂ≠¶‰π†„ÄÇÂÖàÊù•ÊÄªÁªì‰∏ãUIButton„ÄÇ Âü∫Á°ÄÂàõÂª∫ÂàõÂª∫‰∏Ä‰∏™Ëá™ÂÆö‰πâÁ±ªÂûãÁöÑ button 1234UIButton *btn1 = [[UIButton buttonWithType:UIButtonTypeCustom];CGRect btn1Frame = CGRectMake(50, 50, 200, 100);btn1.frame = btn1Frame;[self.view addSubview:btn1]; ÁÇπÂáª‰∫ã‰ª∂ÈÄöËøáxibÂÖ≥ËÅî123- (IBAction)btn2Pressed:(id)sender&#123; NSLog(@"ÁÇπÂáªÊìç‰Ωú");&#125; ‰∏éxibÂÖ≥ËÅîÂç≥ÂèØÔºåÂÖ∂‰∏≠(id)senderÂ∞±Ë°®Á§∫ÁöÑÊòØËøô‰∏™Button ÈÄöËøá‰ª£Á†Å1234//Ê∑ªÂä†[btn1 addTarget:self action:@selector(btn1Pressed:) forControlEvents:UIControlEventTouchUpInside];//ÁßªÈô§[btn1 removeTarget:self action:@selector(btn1Pressed:) forControlEvents:UIControlEventTouchUpInside]; ‰∏∫btn1Ê∑ªÂä†ÂíåÂà†Èô§‰∏Ä‰∏™btn1PressedÁöÑÁÇπÂáª‰∫ã‰ª∂„ÄÇ ËÆæÁΩÆtitleÂíåimagebuttonÊúâimageViewÂíåtitleLabel‰∏§‰∏™Â±ûÊÄßÔºåÈªòËÆ§imageÂú®Â∑¶ÔºålabelÂú®Âè≥„ÄÇ Ê∑ªÂä†titleÂíåimage12[btn1 setImage:[UIImage imageNamed:@&quot;Image&quot;] forState:UIControlStateNormal];[btn1 setTitle:@&quot;BTN1&quot; forState:UIControlStateNormal]; ËøôÈáåforStateÂ∏∏Áî®ÁöÑÊúâ‰∏Ä‰∏ãÂá†ÁßçÔºö UIControlStateNormal Â∏∏ÊÄÅ UIControlStateHighlighted È´ò‰∫Æ UIControlStateDisabled Á¶ÅÁî® UIControlStateSelected ÈÄâ‰∏≠ ÂÖ∂‰∏≠ÈúÄË¶ÅËØ¥ÊòéÁöÑÊòØÔºåÈ´ò‰∫ÆÂ∞±ÊòØÁÇπÂáªÊó∂ÁöÑÁä∂ÊÄÅ„ÄÇÂÖ∂ÂÆûËøòÊúâ‰∏ÄÁßçUIControlStateSelected | UIControlStateHighlightedËøô‰∏™ÁªÑÂêàÊòØÈÄâ‰∏≠Êó∂ÂÄôÁöÑÈ´ò‰∫ÆÁä∂ÊÄÅÔºå‰πüÊòØÊØîËæÉÊúâÁî®ÁöÑ„ÄÇ ËÆæÁΩÆbuttonÈÄâ‰∏≠ÂõæÁâábuttonÈÄâ‰∏≠‰∏éÂê¶ÊòØÁî±UIControlStateSelectedÊéßÂà∂ÁöÑ„ÄÇ ÂèØËÉΩ‰ºöÈÅáÂà∞ËøôÊ†∑ÁöÑÊÉÖÊôØÔºöÁÇπÂáª‰∏Ä‰∏ãbuttonÂàáÊç¢ÊàêÂè¶Â§ñ‰∏Ä‰∏™ÂõæÔºåÂÜçÁÇπ‰∏Ä‰∏ãÂàáÊç¢ÂõûÂéªÔºåÂÆûÈôÖ‰∏äÂ∞±ÊòØÁ±ª‰ºº‰∫éÁÇπËµû„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµÊàë‰ª¨ÂÆûÁé∞ÊñπÂºèÊòØËøôÊ†∑ÁöÑÔºö12345678- (void)buttonClick:(UIButton *)button &#123; if ([button.currentImage isEqual:[UIImage imageNamed:@"like"]]) &#123; [button setImage:[UIImage imageNamed:@"like_selected"] forState:UIControlStateNormal]; &#125; else &#123; [button setImage:[UIImage imageNamed:@"like"] forState:UIControlStateNormal]; &#125;&#125; ‰ΩÜÊòØÊúÄÂ•Ω‰∏çË¶ÅËøôÊ†∑ÂÆûÁé∞„ÄÇÂèØ‰ª•‰ΩøÁî®UIControlStateSelectedÊù•ÊéßÂà∂Ôºö12345678[btn1 setImage:[UIImage imageNamed:@"Image"] forState:UIControlStateNormal];[btn1 setImage:[UIImage imageNamed:@"Image2"] forState:UIControlStateSelected];//ÁÇπÂáª‰∫ã‰ª∂- (void)btn1Pressed:(UIButton *)button&#123; //button.enabled ËÆæÁΩÆÊòØÂê¶ÂèØÁÇπÂáª„ÄÇ button.selected = !button.selected;&#125; ËøôÊ†∑ÔºåÊØèÊ¨°ÁÇπÂáªÁöÑÊó∂ÂÄôÂàáÊç¢ÈÄâ‰∏≠Áä∂ÊÄÅËææÂà∞ÊïàÊûú„ÄÇ ‰ΩÜÊòØÔºåËøôÊ†∑Â§ÑÁêÜ‰ºöÈÅáÂà∞ËøôÊ†∑‰∏Ä‰∏™ÈóÆÈ¢ò:‰∏çÁÆ°ÊåâÈíÆ‰ªénormalÁä∂ÊÄÅËΩ¨‰∏∫selectedÁä∂ÊÄÅ,ËøòÊòØÂèçËøáÊù•,‰∏≠Èó¥ÈÉΩ‰ºöÁªèÂéÜ‰∏Ä‰∏™highLightedÁä∂ÊÄÅ,ËøôÂ∞±ÂØºËá¥Âú®Áä∂ÊÄÅÂàáÊç¢ÁöÑËøáÁ®ã‰∏≠Êúâ‰∏ÄÊ¨°ÂõæÁâáÁöÑË∑≥Âèò„ÄÇ Âõ†Ê≠§ÔºåÈúÄË¶ÅÂ∞Ünormal-&gt;selected‰ª•Âèäselected-&gt;normal‰πãÈó¥ÁöÑhighlightÈÉΩËÆæÁΩÆ‰∏Ä‰∏ã:1234//normal-&gt;selected[btn1 setImage:[UIImage imageNamed:@"Image"] forState:UIControlStateHighlighted];//selected-&gt;normal[btn1 setImage:[UIImage imageNamed:@"Image2"] forState:UIControlStateSelected | UIControlStateHighlighted]; Â•ΩÁöÑÔºåËøôÊ†∑Â∞±ÂÆåÊàê‰∫ÜÂàáÊç¢Áä∂ÊÄÅÁöÑËøáÁ®ã„ÄÇÔºà‰∏äÈù¢ËØ¥ÁöÑÊòØ‰∏§ÁßçÈ´ò‰∫ÆÁä∂ÊÄÅ‰∏ãÁöÑËÆæÁΩÆ„ÄÇÂÆåÊï¥ÁöÑ‰ª£Á†ÅÂ∫îËØ•ÊòØËøôÊ†∑ÁöÑÔºö 12345678// Êú™ÈÄâ‰∏≠Áä∂ÊÄÅ[button setImage:[UIImage imageNamed:@"like"] forState:UIControlStateNormal];// ÈÄâ‰∏≠Áä∂ÊÄÅ[button setImage:[UIImage imageNamed:@"like"] forState: UIControlStateHighlighted];// ‰ªéÊú™ÈÄâ‰∏≠Âà∞ÈÄâ‰∏≠ÁöÑÈ´ò‰∫ÆÁä∂ÊÄÅ[button setImage:[UIImage imageNamed:@"like_selected"] forState:UIControlStateSelected];// ‰ªéÈÄâ‰∏≠Âà∞Êú™ÈÄâ‰∏≠ÁöÑÈ´ò‰∫ÆÁä∂ÊÄÅ[button setImage:[UIImage imageNamed:@"like_selected"] forState:UIControlStateSelected | UIControlStateHighlighted]; ÂèñÊ∂àÂõæÁâáÁöÑÁÇπÂáªÈ´ò‰∫ÆÂõæÁâáÁöÑÁÇπÂáª‰ºöÊúâ‰∏Ä‰∏™È´ò‰∫ÆÁä∂ÊÄÅÔºåÂ¶ÇÊûú‰Ω†‰∏çÊÉ≥Ë¶ÅÊúâËøô‰∏™Áä∂ÊÄÅÔºåÈÇ£‰πàÈúÄË¶ÅÂèñÊ∂àÁÇπÂáªÈ´ò‰∫ÆÔºåÂèØ‰ª•Ôºö 1btn.adjustsImageWhenHighlighted = NO; ËÆæÁΩÆtitle Âíå image ÁöÑ‰ΩçÁΩÆÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá UIEdgeInserts ÁöÑÊñπÂºè‰øÆÊîπ‰ΩçÁΩÆÔºå‰ΩÜÊòØËøôÁßçÊñπÂºèÁªèÂ∏∏‰ºöÂéãÁº©ÊãâÈïø imageÔºåÊâÄ‰ª•Êõ¥Â•ΩÁöÑÊñπÂºèÊòØÈÄöËøáÁªßÊâø UIButtonÔºåÂπ∂‰∏îÈáçÂÜô layoutSubViews ÊñπÊ≥ïÁöÑÊñπÂºèÔºö 12345override func layoutSubviews() &#123; super.layoutSubviews() imageView?.bounds = CGRect(x: 0, y: 0, width: 50, height: 50) titleLabel?.bounds = CGRect(x: 0, y: 0, width: 50, height: 50)&#125; ËÆæÁΩÆ button ÂúÜËßíÊôÆÈÄöÁöÑ‰ΩøÁî® cornerRadius ÁöÑÊñπÂºèËÆæÁΩÆÂúÜËßí‰ºö‰∫ßÁîüÁ¶ªÂ±èÊ∏≤Êüì„ÄÇÂèØ‰ª•‰ΩøÁî®CAShapeLayerÂíåUIBezierPathËÆæÁΩÆÂúÜËßíÔºö 12345678910let w = button.frame.size.widthlet h = button.frame.size.heightlet rect = CGRect(x: 0, y: 0, width: w, height: h)let path = UIBezierPath(roundedRect: rect, cornerRadius: 15)let layer = CAShapeLayer()layer.frame = rectlayer.path = path.cgPathbutton.layer.mask = layerbutton.backgroundColor = UIColor.red Â∞±ÊòØËøôÊ†∑O(‚à©_‚à©)O]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Âü∫Êú¨Êéß‰ª∂</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GitÊäÄÂ∑ß]]></title>
    <url>%2F2016%2F08%2F27%2Fgit%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[ËôΩÁÑ∂‰∏ÄÁõ¥‰ΩøÁî®sourcetreeÔºåËøòÊòØÂ∫îËØ•ÂØπgitÊåá‰ª§ÂÅö‰∏Ä‰∫õ‰∫ÜËß£ÁöÑ„ÄÇÊú¨ÁØáÂ∞ÜÂàó‰∏æ‰ΩøÁî®‰∏≠ÈÅáÂà∞ÁöÑÂÖ≥‰∫égitÁöÑ‰∏Ä‰∫õ‰ΩøÁî®ÊäÄÂ∑ß„ÄÇ‰∏çÂÆöÊúüÊõ¥Êñ∞„ÄÇ Ëá™ÂÆö‰πâ git configÁªôËá™Â∑±ÁöÑÈ°πÁõÆÊèê‰∫§‰ª£Á†ÅÁöÑÊó∂ÂÄôÔºåÊúâ‰∫õÊó∂ÂÄôËôΩÁÑ∂Êèê‰∫§ÊàêÂäüÔºå‰ΩÜÊòØ github Êèê‰∫§ËÆ∞ÂΩïÁöÑÂ∞èÁªøÂùó‰∏äÂπ∂Ê≤°ÊúâËÆ∞ÂΩï„ÄÇËøôÊòØÂõ†‰∏∫‰Ω†ÁöÑÈ°πÁõÆÂèØËÉΩÊúâÂæàÂ§ö‰∫∫ËÉΩÊèê‰∫§‰ª£Á†ÅÔºågithub Âå∫ÂàÜ‰∏çÂêåÁöÑ‰∫∫ÈúÄË¶ÅÈù†Êèê‰∫§‰ª£Á†ÅÁöÑ‰∫∫ÁöÑÈÇÆÁÆ±ÔºåËÄåËøô‰∏™ÈÇÆÁÆ±‰Ω†ÂèØËÉΩÊ≤°ÊúâÈÖçÁΩÆÊàñËÄÖÈÖçÁΩÆÈîô‰∫Ü„ÄÇ ÊØîÂ¶Ç sourcetree ‰ºöÊúâ‰∏Ä‰∏™Áªü‰∏ÄÁöÑÈÖçÁΩÆÔºö ‰πüÂ∞±ÊòØËØ¥ÊâÄÊúâ‰ΩøÁî® sourcetree ÁöÑÊèê‰∫§ÔºåÁî®Êà∑ÂêçÂíåÈÇÆÁÆ±ÈÉΩÊòØËøô‰∏™„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú‰Ω†ÂÖ¨Âè∏ÊúâÂè¶Â§ñ‰∏Ä‰∏™ gitlab ÁöÑË¥¶Âè∑Âë¢ÔºüËøòÊòØ‰ΩøÁî®Ëøô‰∏™Ë¥¶Âè∑ÁöÑÈÇÆÁÆ±Êèê‰∫§Â∞±‰∏ç‰ºöËÆ∞ÂÖ•‰Ω† gitlab Ë¥¶Âè∑ÁöÑÊèê‰∫§ËÆ∞ÂΩï‰∏ä„ÄÇÊâÄ‰ª•‰Ω†ÈúÄË¶ÅÈÖçÁΩÆ git config„ÄÇ ÈÖçÁΩÆÈùûÂ∏∏ÁÆÄÂçïÔºö 12$ git config user.name "zachary"$ git config user.email 759740844@qq.com git rmios‰∏≠podÁöÑÁ¨¨‰∏âÊñπÂ∫ìÁªèÂ∏∏‰ºöË¢´gitignoreÊéâÔºåËÆ©‰ΩøÁî®ËÄÖËá™Â∑±‰∏ãËΩΩ„ÄÇ ÊÉ≥Ë¶ÅËææÂà∞‰∏Ä‰∏™ÊïàÊûúÔºö‰ΩøÊñá‰ª∂ËÑ±Á¶ªgitÁöÑÁâàÊú¨ÁÆ°ÁêÜÔºå‰ΩÜ‰∏çÊòØ‰ºöÂà†Èô§ÂÆÉ. ‰ΩøÁî®ÂëΩ‰ª§Ë°åÂèØ‰ª•‰ΩøÁî®git rm --cached fileGit Â∞Ü‰∏çÂÜçË∑üË∏™Ê≠§Êñá‰ª∂ÔºåÂ∞ΩÁÆ°ÂÆÉ‰ªçÁÑ∂ÊòØÂú®ÊÇ®ÁöÑÁ°¨Áõò‰∏ä.ÂØπ‰∫éÊñá‰ª∂Â§πÔºåÂèØ‰ª•‰ΩøÁî®git rm -r --cached fileÂèñÊ∂àÂÖ≥ËÅîÊï¥‰∏™Êñá‰ª∂Â§π„ÄÇ ‰ΩøÁî®sourcetreeÂú®sourcetree‰∏≠Êìç‰ΩúË¶ÅÈ∫ªÁÉ¶‰∏Ä‰∫õ„ÄÇÂú®Ê∑ªÂä†ÂÆågitignoreÂêéÔºåÂ∞ÜÊÉ≥Ë¶ÅignoreÁöÑÊñá‰ª∂ÁßªÂá∫gitÁõÆÂΩïÔºåÁÑ∂ÂêécommitËØ•Êìç‰ΩúÔºåÂÜçÂ∞ÜÊñá‰ª∂ÁßªÂõûÊù•„ÄÇËøô‰∏™Êó∂ÂÄôÊñá‰ª∂Â∞±Ë¢´ignore‰∫Ü„ÄÇ ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºå‰∏ÄÂÆöË¶ÅÂÖàÊâßË°åcommitÊìç‰Ωú„ÄÇÂõ†‰∏∫ÔºåÂú®.git‰∏≠Â≠òÂú®‰∫ÜpodÁöÑÁâàÊú¨ÊéßÂà∂ÁöÑÊñá‰ª∂ÂÖ≥ËÅîÔºåÊ∑ªÂä†‰∫ÜgitignoreÂêéÔºågitÂπ∂‰∏ç‰ºö‰∏ªÂä®Â∞ÜpodÊñá‰ª∂ÂÖ≥ËÅîÂà†Êéâ„ÄÇÂõ†Ê≠§ÔºåÈúÄË¶ÅÂÖàÁî®commitÂ∞ÜËØ•Êñá‰ª∂ÂÖ≥ËÅîÂà†Èô§ÔºåÊâçËÉΩÊ≠£Á°ÆignoreËØ•Êñá‰ª∂Â§π„ÄÇ ÊÄªÁªìËøôÈáåÁöÑÁßªÈô§Áõ∏ÂΩì‰∫éÊâßË°å‰∫Ü rm Êñá‰ª∂ÁöÑÊìç‰ΩúÔºåÂõ†ËÄåÈúÄË¶Å‰ΩøÁî®commit,ËÄå‰ΩøÁî®ÂëΩ‰ª§Ë°åÁöÑgit rm Êñá‰ª∂ÂàôÊòØÈÄöËøágitÊåá‰ª§ÔºåÁõ¥Êé•ÁßªÈô§‰∫ÜÂÖ≥ËÅî„ÄÇ git add‰∏çÁÆ°ÊòØ‰ªÄ‰πàÈ°πÁõÆÊÄªÊòØÈúÄË¶ÅÊ∑ªÂä†Êñ∞Êñá‰ª∂ÁöÑ„ÄÇÊ∑ªÂä†Êñ∞Êñá‰ª∂Âç≥addÔºå‰ΩÜÊòØ‰ªégithub‰∏äcloneÁöÑÊ°ÜÊû∂ÊÄªÊòØ‰∏çËÉΩËá™Âä®Ê∑ªÂä†Âà∞Êú¨Âú∞ÁöÑgitÁâàÊú¨Èáå„ÄÇÂèØËÉΩÊòØÁî±‰∫écloneÁöÑÊ°ÜÊû∂Êú¨ÁîüÂ∏¶Êúâ.gitÁöÑÁºòÊïÖÂêß„ÄÇ Âõ†Ê≠§ÔºåÂ¶ÇÊûúÂΩìgit‰∏çËÉΩËá™Âä®Ê∑ªÂä†Êñá‰ª∂ÂÖ≥ËÅîÁöÑÊó∂ÂÄôÔºåÈúÄË¶Å‰ΩøÁî®git add Êñá‰ª∂ÁöÑÊñπÂºèÊâãÂä®Ê∑ªÂä†„ÄÇ ‰ΩøÁî®sourcetreeÊó∂Ôºå‰πüÂèØ‰ª•Â∞ÜË¶ÅÊ∑ªÂä†ÁöÑÈÉ®ÂàÜÂÖà‰øùÂ≠òÂú®ÂÖ∂‰ªñÂú∞ÊñπÔºåÁÑ∂ÂêéÂ∞ÜÊñá‰ª∂Â§πÂÜÖÁöÑÊñá‰ª∂Â§çÂà∂Âà∞ÊÉ≥Ë¶ÅÊîæÁöÑÂú∞Êñπ„ÄÇËøôÊ†∑ÈöêËóèÁöÑ.git‰∏ç‰ºöË¢´Â§çÂà∂ÔºåÊñá‰ª∂‰πüÂ∞±ËÉΩÊ∑ªÂä†Ëøõsourcetree‰∫Ü„ÄÇ mergemergeÂèØ‰ª•ËØ¥ÊòØÂæàÂ∏∏Áî®ÁöÑ‰∏Ä‰∏™ÂäüËÉΩÔºåÁî®‰∫é‰ª£Á†ÅÂêàÂπ∂„ÄÇÂè™Ë¶ÅÊòØÂÖ≥‰πé‰∫é‰∏çÂêåbranchÁöÑ‰ª£Á†ÅËøõË°åÂêàÂπ∂ÈÉΩÂèØ‰ª•Áî®mergeÂïä„ÄÇ ÂêàÂπ∂ÂàÜÊîØmerge Êúâ‰∏Ä‰∏™ÂêçËØçÂè´‚ÄúÂø´ËøõÂºèÂêàÂπ∂‚ÄùÔºåÂêàÂπ∂ÁöÑÊó∂ÂÄô‰ºöÁõ¥Êé•Â∞Ü‰ºöÁõ¥Êé•Â∞Ü‰∏Ä‰∏™ÂàÜÊîØÂàÜÊîØÊåáÂêëÂè¶‰∏Ä‰∏™ÂàÜÊîØÔºö‰ΩÜÊòØÊúâÁöÑÊó∂ÂÄôÔºå‰∏∫‰∫Ü‰øùËØÅÁâàÊú¨ÊºîËøõÁöÑÊ∏ÖÊô∞ÔºåÊàë‰ª¨Â∏åÊúõÂú®ÂêàÂπ∂ÁöÑÂàÜÊîØ‰∏äÁîüÊàê‰∏Ä‰∏™Êñ∞ËäÇÁÇπË°®Á§∫ÂÅöËøáÂêàÂπ∂Êìç‰ΩúÔºåÂ∞±Ë¶ÅÈááÁî®‚ÄúÈùûÂø´ËøõÂºèÂêàÂπ∂‚ÄùÔºöÈÇ£‰πàÂú® sourcetree ÊÄé‰πàÂÅöÂë¢ÔºüÂãæÈÄâ‚ÄúÊó†ËÆ∫ÊòØÂê¶ÂèØ‰ª•Âø´ËøõÊõ¥Êñ∞ÈÉΩÂàõÂª∫Êñ∞ÁöÑÊèê‰∫§‚ÄùÊúÄÂêéÊèê‰∫§ÂêàÂπ∂ÁöÑËÆ∞ÂΩïÂç≥ÂèØÔºö ‰∏¥Êó∂ÊÄßÂàÜÊîØÈô§‰∫ÜMasterÂíåDevelop„ÄÇÂâçËÄÖÁî®‰∫éÊ≠£ÂºèÂèëÂ∏ÉÔºåÂêéËÄÖÁî®‰∫éÊó•Â∏∏ÂºÄÂèë„ÄÇÂÖ∂ÂÆûÔºåÂ∏∏ËÆæÂàÜÊîØÂè™ÈúÄË¶ÅËøô‰∏§Êù°Â∞±Â§ü‰∫ÜÔºå‰∏çÈúÄË¶ÅÂÖ∂‰ªñ‰∫Ü„ÄÇ ‰ΩÜÊòØÔºåÈô§‰∫ÜÂ∏∏ËÆæÂàÜÊîØ‰ª•Â§ñÔºåËøòÊúâ‰∏Ä‰∫õ‰∏¥Êó∂ÊÄßÂàÜÊîØÔºåÁî®‰∫éÂ∫îÂØπ‰∏Ä‰∫õÁâπÂÆöÁõÆÁöÑÁöÑÁâàÊú¨ÂºÄÂèë„ÄÇ‰∏¥Êó∂ÊÄßÂàÜÊîØ‰∏ªË¶ÅÊúâ‰∏âÁßçÔºö ÂäüËÉΩÔºàfeatureÔºâÂàÜÊîØ È¢ÑÂèëÂ∏ÉÔºàreleaseÔºâÂàÜÊîØ ‰øÆË°•bugÔºàfixbugÔºâÂàÜÊîØ Ëøô‰∏âÁßçÂàÜÊîØÈÉΩÂ±û‰∫é‰∏¥Êó∂ÊÄßÈúÄË¶ÅÔºå‰ΩøÁî®ÂÆå‰ª•ÂêéÔºåÂ∫îËØ•Âà†Èô§Ôºå‰ΩøÂæó‰ª£Á†ÅÂ∫ìÁöÑÂ∏∏ËÆæÂàÜÊîØÂßãÁªàÂè™ÊúâMasterÂíåDevelop„ÄÇ ÂäüËÉΩÂàÜÊîØÔºåÂÆÉÊòØ‰∏∫‰∫ÜÂºÄÂèëÊüêÁßçÁâπÂÆöÂäüËÉΩÔºå‰ªéDevelopÂàÜÊîØ‰∏äÈù¢ÂàÜÂá∫Êù•ÁöÑ„ÄÇÂºÄÂèëÂÆåÊàêÂêéÔºåË¶ÅÂÜçÂπ∂ÂÖ•Develop„ÄÇ È¢ÑÂèëÂ∏ÉÂàÜÊîØÔºåÂÆÉÊòØÊåáÂèëÂ∏ÉÊ≠£ÂºèÁâàÊú¨‰πãÂâçÔºàÂç≥ÂêàÂπ∂Âà∞MasterÂàÜÊîØ‰πãÂâçÔºâÔºåÊàë‰ª¨ÂèØËÉΩÈúÄË¶ÅÊúâ‰∏Ä‰∏™È¢ÑÂèëÂ∏ÉÁöÑÁâàÊú¨ËøõË°åÊµãËØï„ÄÇÈ¢ÑÂèëÂ∏ÉÂàÜÊîØÊòØ‰ªéDevelopÂàÜÊîØ‰∏äÈù¢ÂàÜÂá∫Êù•ÁöÑÔºåÈ¢ÑÂèëÂ∏ÉÁªìÊùü‰ª•ÂêéÔºåÂøÖÈ°ªÂêàÂπ∂ËøõDevelopÂíåMasterÂàÜÊîØ„ÄÇ ËΩØ‰ª∂Ê≠£ÂºèÂèëÂ∏É‰ª•ÂêéÔºåÈöæÂÖç‰ºöÂá∫Áé∞bug„ÄÇËøôÊó∂Â∞±ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™ÂàÜÊîØÔºåËøõË°åbug‰øÆË°•„ÄÇ‰øÆË°•bugÂàÜÊîØÊòØ‰ªéMasterÂàÜÊîØ‰∏äÈù¢ÂàÜÂá∫Êù•ÁöÑ„ÄÇ‰øÆË°•ÁªìÊùü‰ª•ÂêéÔºåÂÜçÂêàÂπ∂ËøõMasterÂíåDevelopÂàÜÊîØ„ÄÇ Âá†ÁßçÂàÜÊîØÁöÑÂëΩÂêçÊñπÂºèÂàÜÂà´‰∏∫ feature-*,release-*,fixbug-* ÁöÑÂΩ¢Âºè„ÄÇ rebaseÂèòÂü∫Êìç‰ΩúÊòØgitÂ∏∏Áî®ÁöÑ‰∏Ä‰∏™ÂäüËÉΩÔºåËøôÈáå‰∏çÂÜçËØ¥ÊòéÂÖ∂‰ΩúÁî®ÔºåËÄåÊòØÂº∫Ë∞É‰∏Ä‰∏ã‰ªñÁöÑÈ£éÈô©„ÄÇ ÂèòÂü∫Êìç‰ΩúÁöÑ‰∏ÄÊù°ÂáÜÂàôÊòØÔºö‰∏çË¶ÅÂØπÂú®‰Ω†ÁöÑ‰ªìÂ∫ìÂ§ñÊúâÂâØÊú¨ÁöÑÂàÜÊîØÊâßË°åÂèòÂü∫„ÄÇ ÂèòÂü∫Êìç‰ΩúÁöÑÂÆûË¥®ÊòØ‰∏¢ÂºÉ‰∏Ä‰∫õÁé∞ÊúâÁöÑÊèê‰∫§ÔºåÁÑ∂ÂêéÁõ∏Â∫îÂú∞Êñ∞Âª∫‰∏Ä‰∫õÂÜÖÂÆπ‰∏ÄÊ†∑‰ΩÜÂÆûÈôÖ‰∏ä‰∏çÂêåÁöÑÊèê‰∫§„ÄÇ ‰πüÂ∞±ÊòØËØ¥ÔºöÂèòÂü∫Êìç‰ΩúÂ∞ÜÂº∫Ë°åÊîπÂèò‰ªìÂ∫ìÁöÑÊèê‰∫§ÊÉÖÂÜµ„ÄÇÊ≥®ÊÑèÔºåÊòØ‰∏¢ÂºÉ‰∏çÊòØÂà†Èô§ÔºågitÂØπ‰∫éËøôÁßç‰∏¢ÂºÉÊ≤°Êúâ‰ªª‰ΩïËÆ∞ÂΩï„ÄÇ Â¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåC5ÊòØÂÖ∂‰ªñÂàÜÊîØÁöÑÂêàÂπ∂„ÄÇÂÖàÂ∞ÜmasterÈáçÁΩÆÂà∞C1ÁöÑÊèê‰∫§ÔºåÁÑ∂ÂêérebaseC5ÊâÄÂú®ÂàÜÊîØÔºåÂæóÂà∞Êñ∞ÁöÑÊèê‰∫§C4&#39;„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºågitÊòØ‰∏çÂÖÅËÆ∏ËøôÊ†∑ÁöÑÊèê‰∫§Âà∞remoteÁöÑÔºå‰ΩÜÊòØÂèØ‰ª•‰ΩøÁî®git push --forceÂº∫Âà∂Ë¶ÜÁõñremoteÁöÑ‰ªìÂ∫ì„ÄÇËøôÊ†∑C4 C6Â∞±‰∏çÂ§çÂ≠òÂú®‰∫Ü„ÄÇ ËØùÂàÜ‰∏§Â§¥ÔºåÂà´‰∫∫‰πüÊúâËá™Â∑±ÁöÑÊú¨Âú∞masterÔºåÂπ∂‰∏îÂà´‰∫∫Â∑≤ÁªèÂêàÂπ∂‰∫Ü‰πãÂâçÁöÑÊèê‰∫§C6Âà∞C7ÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö Áî±‰∫éÂà´‰∫∫ÁöÑÊú¨Âú∞gitÂπ∂‰∏çÁü•ÈÅìC4 C6Â∑≤ÁªèÁî±‰∫érebaseË¢´Âà†Èô§„ÄÇÊØîÂØπ‰ªìÂ∫ì‰ø°ÊÅØÂêéÔºåÂú®ÂÆÉÁúãÊù•ÔºåÂ∞±ÊòØremoteÁöÑmasterÊúâ‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÊèê‰∫§C4&#39;Ôºå‰∫éÊòØÂ∞±ÊãâÂèñÔºå‰ΩÜÊòØÊú¨Âú∞git‰∏ÄÁúãËøúÁ´ØÊèê‰∫§C4&#39;ÂíåÊú¨Âú∞Êèê‰∫§C4 C6ÈÉΩ‰øÆÊîπ‰∫ÜÁõ∏ÂêåÁöÑÊñá‰ª∂ÔºåÈÇ£Â∞±‰∫ßÁîüÂÜ≤Á™Å‰∫ÜÂïä„ÄÇÈÇ£‰πàÂà´‰∫∫Â∞±ÂøÖÈ°ªË¶ÅÂêàÂπ∂Ëøô‰∏§Êù°Êèê‰∫§ÂéÜÂè≤ÁöÑÂÜÖÂÆπÔºåÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑÂêàÂπ∂Êèê‰∫§ÔºåÊúÄÁªà‰ªìÂ∫ì‰ºöÂ¶ÇÂõæÊâÄÁ§∫Ôºö ËøôÊ†∑Â∞±ÊØîËæÉÂ∞¥Â∞¨‰∫ÜÔºåÂõ†‰∏∫ÂΩìÊó∂‰ΩøÁî®rebaseÂ∞±ÊòØ‰∏∫‰∫ÜÂà†ÊéâC4 C6Ôºå‰ΩÜÊòØÂà´‰∫∫Ëøô‰πà‰∏ÄÂêàÂπ∂‰∏ÄÊèê‰∫§ÔºåC4 C6ÂèàÂÖ®ÂõûÊù•‰∫Ü„ÄÇ Â¶ÇÊûúÂè™ÊòØÂçï‰∫∫ÂºÄÂèëÔºåÂèòÂü∫Êìç‰ΩúÊ≤°Êúâ‰ªª‰ΩïÂç±Èô©ÔºåÊÉ≥ÊÄé‰πàÂèòÊÄé‰πàÂèò„ÄÇ‰ΩÜÊòØÂú®Â§ö‰∫∫ÂºÄÂèëÔºåÂàáËÆ∞Âè™ÊääÂèòÂü∫ÂëΩ‰ª§ÂΩì‰ΩúÊòØÂú®Êé®ÈÄÅÂâçÊ∏ÖÁêÜÊèê‰∫§‰Ωø‰πãÊï¥Ê¥ÅÁöÑÂ∑•ÂÖ∑ÔºåÂπ∂‰∏îÂè™Âú®‰ªéÊú™Êé®ÈÄÅËá≥ÂÖ±Áî®‰ªìÂ∫ìÁöÑÊèê‰∫§‰∏äÊâßË°åÂèòÂü∫ÂëΩ‰ª§„ÄÇÂÅáÂ¶Ç‰Ω†Âú®ÈÇ£‰∫õÂ∑≤ÁªèË¢´Êé®ÈÄÅËá≥ÂÖ±Áî®‰ªìÂ∫ìÁöÑÊèê‰∫§‰∏äÊâßË°åÂèòÂü∫ÂëΩ‰ª§ÔºåÂπ∂Âõ†Ê≠§‰∏¢ÂºÉ‰∫Ü‰∏Ä‰∫õÂà´‰∫∫ÁöÑÂºÄÂèëÊâÄÂü∫‰∫éÁöÑÊèê‰∫§ÔºåÈÇ£‰πàÈóÆÈ¢òÂ∞±Â§ß‰∫Ü„ÄÇ sourcetree Êó†Ê≥ïÁúãÂà∞Êèê‰∫§ËÆ∞ÂΩïÁÇπÂáª sourcetree ‰∏≠Êèê‰∫§ËÆ∞ÂΩïÔºåÂèØ‰ª•ÁúãÂà∞ËØ¶ÁªÜÁöÑÊèê‰∫§‰ø°ÊÅØ„ÄÇ‰ΩÜÊòØÊúâ‰∫õÊó∂ÂÄôÁÇπÂáªÊèê‰∫§È°πÁöÑÊó∂ÂÄôÁúã‰∏çÂà∞ËØ¶ÁªÜÁöÑÊèê‰∫§‰ø°ÊÅØ„ÄÇ ÂèØ‰ª•Âú®ÁªàÁ´ØÂÜÖËæìÂÖ•‰ª•‰∏ãÂëΩ‰ª§ÔºåÁÑ∂ÂêéÈáçÂêØ sourcetree Ëß£ÂÜ≥Ôºö 1defaults delete com.torusknot.SourceTreeNotMAS &quot;NSSplitView Subview Frames repowindow_LogViewDescSplitter&quot; commit message ËßÑËåÉÂü∫Êú¨ËßÑËåÉÁ¨¨‰∏ÄË°å‰∏∫ÂØπÊîπÂä®ÁöÑÁÆÄË¶ÅÊÄªÁªìÔºåÂª∫ËÆÆÈïøÂ∫¶‰∏çË∂ÖËøá 50 ‰∏™Â≠óÁ¨¶ÔºåÁî®ËØ≠ÈááÁî®ÂëΩ‰ª§ÂºèËÄåÈùûËøáÂéªÂºè„ÄÇÁ¨¨‰∏ÄË°åÁªìÂ∞æ‰∏çË¶ÅÁïôÂè•Âè∑„ÄÇÁ¨¨‰∏Ä‰∏™ÂçïËØçÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÊØçË¶ÅÂ§ßÂÜô„ÄÇ Á¨¨‰∫åË°å‰∏∫Á©∫Ë°å„ÄÇ Á¨¨‰∏âË°åÂºÄÂßãÔºåÊòØÂØπÊîπÂä®ÁöÑËØ¶ÁªÜ‰ªãÁªçÔºåÂèØ‰ª•ÊòØÂ§öË°åÂÜÖÂÆπÔºåÂª∫ËÆÆÊØèË°åÈïøÂ∫¶‰∏çË∂ÖËøá 72 ‰∏™Â≠óÁ¨¶„ÄÇ‰∏ªË¶ÅÁî®Êù•ÂÜôÊòéÁôΩ‰∏∫‰ªÄ‰πàË¶ÅËøôÊ†∑Êîπ ÈÅøÂÖçÊ≥®Èáä‰∏çÊ∏ÖÊô∞„ÄÇÊØîÂ¶ÇÂè™Êúâ„Äå‰øÆÊ≠£ BUG„Äç„ÄÅ„ÄåÊîπÈîô„Äç„ÄÅ„ÄåÂçáÁ∫ß„Äç„ÄÅ„ÄåÊ∑ªÂä†ÊüêÊñá‰ª∂„ÄçÁ≠âÔºåÊ≤°ÊúâÂÖ∂‰ªñÂÜÖÂÆπÔºåÁ≠â‰∫éÊ≤°ËØ¥„ÄÇ 6.„ÄåÊèê‰∫§„ÄçÁöÑÊ¶ÇÂøµÊòØÂÖ∑ÊúâÁã¨Á´ãÁöÑÂäüËÉΩ„ÄÅ‰øÆÊ≠£Á≠â‰ΩúÁî®„ÄÇÂ∞èÂèØ‰ª•Â∞èÂà∞Âè™‰øÆÊîπ‰∏ÄË°åÔºåÂ§ßÂèØ‰ª•Âà∞ÊîπÂä®ÂæàÂ§öÊñá‰ª∂Ôºå‰ΩÜÂàíÂàÜÁöÑÊ†áÂáÜ‰∏çÂèòÔºå‰∏Ä‰∏™Êèê‰∫§Â∞±ÊòØËß£ÂÜ≥‰∏Ä‰∏™ÈóÆÈ¢òÁöÑ„ÄÇ Ê≥®ÊÑèÔºåÊØèÊ¨°Êèê‰∫§‰πãÂêé‰∏ÄÂÆöÊòØË¶ÅËÉΩÊ≠£Â∏∏ËøêË°åÁöÑ„ÄÇ‰∏çËÉΩÊää‰∏çËÉΩÈÄöËøáÁºñËØëÁöÑ‰ª£Á†ÅÊèê‰∫§‰∏äÂéª„ÄÇ ‰∏ªË¶ÅÂâçÁºÄ Add Êñ∞Âä†ÂÖ•ÁöÑÈúÄÊ±Ç Fix ‰øÆÊ≠£bug Change ‰øÆÊîπÂäüËÉΩ Update ÂÆåÊàê‰ªªÂä°ÊàñËÄÖÊ®°ÂùóÂêéÁöÑÊõ¥Êñ∞ Remove ÁßªÈô§ÂäüËÉΩ Refactor ÈáçÊûÑÂäüËÉΩ ÊÄùË∑ØÊúâ‰∫õÊó∂ÂÄôÂèëÁé∞‰∏çÁü•ÈÅìËØ•Â¶Ç‰ΩïÂÜô„ÄÇÈÇ£‰πàÈÅµÂæ™ what-why-how ÁöÑÂΩ¢Âºè„ÄÇÂÜôÁ¨¨‰∏ÄË°åÁöÑÊó∂ÂÄôÈóÆËá™Â∑±Ëøô‰∏™ commit ÊòØÂÅö‰∫Ü‰ªÄ‰πà‰∫ãÔºåÂêéÈù¢ËØ¶ÁªÜÂÜôÊ∏ÖÊ•ö‰∏∫‰ªÄ‰πàËøô‰πàÂÅöÂíåÊÄé‰πàÂÅöÂà∞ÁöÑ„ÄÇ]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂàùËØÜProvisioning Profile]]></title>
    <url>%2F2016%2F08%2F26%2F%E5%88%9D%E8%AF%86Provisioning_Profile%2F</url>
    <content type="text"><![CDATA[ÁúüÊú∫Ë∞ÉËØïÁöÑÊó∂ÂÄôÈÅáÂà∞‰∫Üprovisioning profileÂç≥Â∞ÜËøáÊúüÁöÑË≠¶ÂëäÔºå‰∫éÊòØÊêúÁ¥¢Âπ∂ÂØπprovisioning profile‰Ωú‰∫Ü‰∏ÄÂÆö‰∫ÜËß£„ÄÇÁªìÂêàÂÖ≥‰∫éCertificate„ÄÅProvisioning Profile„ÄÅApp IDÁöÑ‰ªãÁªçÂèäÂÖ∂‰πãÈó¥ÁöÑÂÖ≥Á≥ªËøõË°åÊ¢≥ÁêÜ„ÄÇ Âü∫Êú¨Ê¶ÇÂøµCertificateËØÅ‰π¶ÊòØÁî®Êù•ÁªôÂ∫îÁî®Á®ãÂ∫èÁ≠æÂêçÁöÑÔºåÂè™ÊúâÁªèËøáÁ≠æÂêçÁöÑÂ∫îÁî®Á®ãÂ∫èÊâçËÉΩ‰øùËØÅ‰ªñÁöÑÊù•Ê∫êÊòØÂèØ‰ø°‰ªªÁöÑÔºåÂπ∂‰∏î‰ª£Á†ÅÊòØÂÆåÊï¥ÁöÑÔºå Êú™Áªè‰øÆÊîπÁöÑ„ÄÇÂú®Xcode Build Setting(ÁÇπÂáªÂ∑•Á®ãÊñá‰ª∂)ÁöÑCode Signing Identity‰∏≠Ôºå‰Ω†ÂèØ‰ª•ËÆæÁΩÆÁî®‰∫é‰∏∫‰ª£Á†ÅÁ≠æÂêçÁöÑËØÅ‰π¶„ÄÇ ‰ºóÊâÄÂë®Áü•ÔºåÊàë‰ª¨Áî≥ËØ∑‰∏Ä‰∏™Certificate‰πãÂâçÔºåÈúÄË¶ÅÂÖàÁî≥ËØ∑‰∏Ä‰∏™Certificate Signing Request (CSR) Êñá‰ª∂ÔºåËÄåËøô‰∏™ËøáÁ®ã‰∏≠ÂÆûÈôÖ‰∏äÊòØÁîüÊàê‰∫Ü‰∏ÄÂØπÂÖ¨Èí•ÂíåÁßÅÈí•Ôºå‰øùÂ≠òÂú®‰Ω†MacÁöÑKeychain‰∏≠„ÄÇ‰ª£Á†ÅÁ≠æÂêçÊ≠£ÊòØ‰ΩøÁî®ËøôÁßçÂü∫‰∫éÈùûÂØπÁß∞ÁßòÈí•ÁöÑÂä†ÂØÜÊñπÂºèÔºåÁî®ÁßÅÈí•ËøõË°åÁ≠æÂêçÔºåÁî®ÂÖ¨Èí•ËøõË°åÈ™åËØÅ„ÄÇÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÂú®‰Ω†MacÁöÑkeychainÁöÑlogin‰∏≠Â≠òÂÇ®ÁùÄÁõ∏ÂÖ≥ÁöÑÂÖ¨Èí•ÂíåÁßÅÈí•ÔºåËÄåËØÅ‰π¶‰∏≠ÂåÖÂê´‰∫ÜÂÖ¨Èí•„ÄÇ‰Ω†Âè™ËÉΩÁî®ÁßÅÈí•Êù•ËøõË°åÁ≠æÂêçÔºåÊâÄ‰ª•Â¶ÇÊûúÊ≤°Êúâ‰∫ÜÁßÅÈí•ÔºåÂ∞±ÊÑèÂë≥ÁùÄ‰Ω†‰∏çËÉΩËøõË°åÁ≠æÂêç‰∫ÜÔºåÊâÄ‰ª•Â∞±Êó†Ê≥ï‰ΩøÁî®Ëøô‰∏™ËØÅ‰π¶‰∫ÜÔºåÊ≠§Êó∂‰Ω†Âè™ËÉΩrevoke‰πãÂâçÁöÑËØÅ‰π¶ÂÜçÁî≥ËØ∑‰∏Ä‰∏™„ÄÇÂõ†Ê≠§Âú®Áî≥ËØ∑ÂÆåËØÅ‰π¶Êó∂ÔºåÊúÄÂ•ΩÂØºÂá∫Âπ∂‰øùÂ≠òÂ•Ω‰Ω†ÁöÑÁßÅÈí•„ÄÇÂΩì‰Ω†ÊÉ≥‰∏éÂÖ∂‰ªñ‰∫∫ÊàñÂÖ∂‰ªñËÆæÂ§áÂÖ±‰∫´ËØÅ‰π¶Êó∂ÔºåÊääÁßÅÈí•‰º†ÁªôÂÆÉÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇÁßÅÈí•‰øùÂ≠òÂú®‰Ω†ÁöÑMac‰∏≠ÔºåËÄåËãπÊûúÁîüÊàêÁöÑCertificate‰∏≠ÂåÖÂê´‰∫ÜÂÖ¨Èí•„ÄÇÂΩì‰Ω†Áî®Ëá™Â∑±ÁöÑÁßÅÈí•ÂØπ‰ª£Á†ÅÁ≠æÂêçÂêéÔºåËãπÊûúÂ∞±ÂèØ‰ª•Áî®ËØÅ‰π¶‰∏≠ÁöÑÂÖ¨Èí•Êù•ËøõË°åÈ™åËØÅÔºåÁ°Æ‰øùÊòØ‰Ω†ÂØπ‰ª£Á†ÅËøõË°å‰∫ÜÁ≠æÂêçÔºåËÄå‰∏çÊòØÂà´‰∫∫ÂÜíÂÖÖ‰Ω†ÔºåÂêåÊó∂‰πüÁ°Æ‰øù‰ª£Á†ÅÁöÑÂÆåÊï¥ÊÄßÁ≠â„ÄÇ ËØÅ‰π¶‰∏ªË¶ÅÂàÜ‰∏∫‰∏§Á±ªÔºöDevelopmentÂíåProductionÔºåDevelopmentËØÅ‰π¶Áî®Êù•ÂºÄÂèëÂíåË∞ÉËØïÂ∫îÁî®Á®ãÂ∫èÔºåProduction‰∏ªË¶ÅÁî®Êù•ÂàÜÂèëÔºàÁîü‰∫ßÔºå‰∏äÊû∂AppstoreÔºâÂ∫îÁî®Á®ãÂ∫èÔºàÊ†πÊçÆËØÅ‰π¶ÁßçÁ±ªÊúâ‰∏çÂêå‰ΩúÁî®Ôºâ APP IDApp IDÁî®‰∫éÊ†áËØÜ‰∏Ä‰∏™ÊàñËÄÖ‰∏ÄÁªÑAppÔºåApp IDÂ∫îËØ•ÊòØÂíåXcode‰∏≠ÁöÑBundle IDÊòØ‰∏ÄËá¥ÁöÑÊàñËÄÖÂåπÈÖçÁöÑ„ÄÇApp ID‰∏ªË¶ÅÊúâ‰ª•‰∏ã‰∏§ÁßçÔºö Explicit App IDÔºöÂîØ‰∏ÄÁöÑApp IDÔºåËøôÁßçApp IDÁî®‰∫éÂîØ‰∏ÄÊ†áËØÜ‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èÔºå‰æãÂ¶Çcom.ABC.demo1ÔºåÊ†áËØÜBundle ID‰∏∫com.ABC.demo1ÁöÑÁ®ãÂ∫è„ÄÇ Wildcard App IDÔºöÈÄöÈÖçÁ¨¶App IDÔºåÁî®‰∫éÊ†áËØÜ‰∏ÄÁªÑÂ∫îÁî®Á®ãÂ∫è„ÄÇ‰æãÂ¶Ç*ÂèØ‰ª•Ë°®Á§∫ÊâÄÊúâÂ∫îÁî®Á®ãÂ∫èÔºåËÄåcom.ABC.*ÂèØ‰ª•Ë°®Á§∫‰ª•com.ABCÂºÄÂ§¥ÁöÑÊâÄÊúâÂ∫îÁî®Á®ãÂ∫è„ÄÇ ÊØèÂàõÂª∫‰∏Ä‰∏™App IDÔºåÊàë‰ª¨ÈÉΩÂèØ‰ª•ËÆæÁΩÆËØ•App IDÊâÄ‰ΩøÁî®ÁöÑAPP ServicesÔºå‰πüÂ∞±ÊòØÂÖ∂ÊâÄ‰ΩøÁî®ÁöÑÈ¢ùÂ§ñÊúçÂä°„ÄÇÊØèÁßçÈ¢ùÂ§ñÊúçÂä°ÈÉΩÊúâÁùÄ‰∏çÂêåÁöÑË¶ÅÊ±ÇÔºå‰æãÂ¶ÇÔºåÂ¶ÇÊûúË¶Å‰ΩøÁî®Apple Push Notification ServicesÔºåÂàôÂøÖÈ°ªÊòØ‰∏Ä‰∏™explicit App IDÔºå‰ª•‰æøËÉΩÂîØ‰∏ÄÊ†áËØÜ‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫è„ÄÇ DeviceDeviceÊúÄÁÆÄÂçï‰∫ÜÔºåÂ∞±ÊòØiOSËÆæÂ§á„ÄÇDevices‰∏≠ÂåÖÂê´‰∫ÜËØ•Ë¥¶Êà∑‰∏≠ÊâÄÊúâÂèØÁî®‰∫éÂºÄÂèëÂíåÊµãËØïÁöÑËÆæÂ§á„ÄÇ ÊØèÂè∞ËÆæÂ§á‰ΩøÁî®UDIDÊù•ÂîØ‰∏ÄÊ†áËØÜ„ÄÇ ÊØè‰∏™Ë¥¶Êà∑‰∏≠ÁöÑËÆæÂ§áÊï∞ÈáèÈôêÂà∂ÊòØ100‰∏™„ÄÇDisable ‰∏ÄÂè∞ËÆæÂ§á‰πü‰∏ç‰ºöÂ¢ûÂä†ÂêçÈ¢ùÔºåÂè™ËÉΩÂú®membership year ÂºÄÂßãÁöÑÊó∂ÂÄôÊâçËÉΩÈÄöËøáÂà†Èô§ËÆæÂ§áÊù•Â¢ûÂä†ÂêçÈ¢ù„ÄÇ Provisioning Profile‰∏Ä‰∏™Provisioning ProfileÊñá‰ª∂ÂåÖÂê´‰∫Ü‰∏äËø∞ÁöÑÊâÄÊúâÂÜÖÂÆπÔºöËØÅ‰π¶„ÄÅApp ID„ÄÅËÆæÂ§á„ÄÇ ËØïÊÉ≥‰∏Ä‰∏ãÔºåÂ¶ÇÊûúÊàë‰ª¨Ë¶ÅÊâìÂåÖÊàñËÄÖÂú®ÁúüÊú∫‰∏äËøêË°å‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èÔºåÊàë‰ª¨È¶ñÂÖàÈúÄË¶ÅËØÅ‰π¶Êù•ËøõË°åÁ≠æÂêçÔºåÁî®Êù•Ê†áËØÜËøô‰∏™Â∫îÁî®Á®ãÂ∫èÊòØÂêàÊ≥ïÁöÑ„ÄÅÂÆâÂÖ®ÁöÑ„ÄÅÂÆåÊï¥ÁöÑÁ≠âÁ≠âÔºõÁÑ∂ÂêéÈúÄË¶ÅÊåáÊòéÂÆÉÁöÑApp IDÔºåÂπ∂‰∏îÈ™åËØÅBundle IDÊòØÂê¶‰∏éÂÖ∂‰∏ÄËá¥ÔºõÂÜçÊ¨°ÔºåÂ¶ÇÊûúÊòØÁúüÊú∫Ë∞ÉËØïÔºåÈúÄË¶ÅÁ°ÆËÆ§ËøôÂè∞ËÆæÂ§áËÉΩÂê¶Áî®Êù•ËøêË°åÁ®ãÂ∫è„ÄÇËÄåProvisioning ProfileÂ∞±ÊääËøô‰∫õ‰ø°ÊÅØÂÖ®ÈÉ®ÊâìÂåÖÂú®‰∏ÄËµ∑ÔºåÊñπ‰æøÊàë‰ª¨Âú®Ë∞ÉËØïÂíåÂèëÂ∏ÉÁ®ãÂ∫èÊâìÂåÖÊó∂‰ΩøÁî®ÔºåËøôÊ†∑Êàë‰ª¨Âè™Ë¶ÅÂú®‰∏çÂêåÁöÑÊÉÖÂÜµ‰∏ãÈÄâÊã©‰∏çÂêåÁöÑprofileÊñá‰ª∂Â∞±ÂèØ‰ª•‰∫Ü„ÄÇËÄå‰∏îËøô‰∏™Provisioning ProfileÊñá‰ª∂‰ºöÂú®ÊâìÂåÖÊó∂ÂµåÂÖ•.ipaÁöÑÂåÖÈáå„ÄÇ ‰æãÂ¶ÇÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºå‰∏Ä‰∏™Áî®‰∫éDevelopmentÁöÑProvisioning Profile‰∏≠ÂåÖÂê´‰∫ÜËØ•Provisioning ProfileÂØπÂ∫îÁöÑApp IDÔºåÂèØ‰ΩøÁî®ÁöÑËØÅ‰π¶ÂíåËÆæÂ§á„ÄÇËøôÊÑèÂë≥ÁùÄ‰ΩøÁî®Ëøô‰∏™Provisioning ProfileÊâìÂåÖÁ®ãÂ∫èÂøÖÈ°ªÊã•ÊúâÁõ∏Â∫îÁöÑËØÅ‰π¶ÔºåÂπ∂‰∏îÊòØÂ∞ÜApp IDÂØπÂ∫îÁöÑÁ®ãÂ∫èËøêË°åÂà∞Devices‰∏≠ÂåÖÂê´ÁöÑËÆæÂ§á‰∏äÂéª„ÄÇ Â¶Ç‰∏äÊâÄËø∞ÔºåÂú®‰∏ÄÂè∞ËÆæÂ§á‰∏äËøêË°åÂ∫îÁî®Á®ãÂ∫èÁöÑËøáÁ®ãÂ¶Ç‰∏ãÔºö ‰∏éËØÅ‰π¶‰∏ÄÊ†∑ÔºåProvisioning Profile‰πüÂàÜ‰∏∫DevelopmentÂíåDistribution‰∏§Áßç Xcode 7+ ÂÖçËØÅ‰π¶ÁúüÊú∫Ë∞ÉËØïÂú®Xcode 7+ ‰∏≠ÔºåËãπÊûúÊîπÂèò‰∫ÜËá™Â∑±Âú®ËÆ∏ÂèØÊùÉÈôê‰∏äÁöÑÁ≠ñÁï•ÔºåÊ≠§ÂâçXcodeÂè™ÂºÄÊîæÁªôÊ≥®ÂÜåÂºÄÂèëËÄÖ‰∏ãËΩΩÔºå‰ΩÜXcode 7ÊîπÂèò‰∫ÜËøôÁßçÊÉØÊúâÁöÑÂÅöÊ≥ïÔºåÊó†ÈúÄÊ≥®ÂÜåÂºÄÂèëËÄÖË¥¶Âè∑Ôºå‰ªÖ‰ΩøÁî®ÊôÆÈÄöÁöÑApple IDÂ∞±ËÉΩ‰∏ãËΩΩÂíå‰∏äÊâã‰ΩìÈ™å„ÄÇÊ≠§ÂâçÂºÄÂèëËÄÖÈúÄÊØèÂπ¥ÊîØ‰ªò99ÁæéÂÖÉÁöÑË¥πÁî®Êàê‰∏∫Ê≥®ÂÜåÂºÄÂèëËÄÖÊâçËÉΩÂú®iPhone„ÄÅiPad„ÄÅApple WatchÁ≠âÁúüÊú∫‰∏äËøêË°å‰ª£Á†ÅÔºåËãπÊûúÊñ∞ÁöÑÂºÄÂèëËÄÖËÆ°ÂàíÂàôÊîæÂÆΩË¶ÅÊ±ÇÔºåÊó†ÈúÄË¥≠‰π∞ÔºåÂè™Ë¶Å‰Ω†ÊÑüÂÖ¥Ë∂£ÂêåÊ†∑ÂèØ‰ª•Âú®ÁúüÊú∫ËÆæÂ§á‰∏äÊµãËØïapp ‰ΩøÁî®ÊñπÊ≥ï ÊâìÂºÄËá™Â∑±Â∑≤ÊúâÁöÑÂ∑•Á®ãÊàñËÄÖÊâìÂºÄXcodeÊñ∞Âª∫‰∏Ä‰∏™ÁÆÄÂçïÂ∑•Á®ã ËèúÂçïÊ†èÈÄâÊã©Xcode,‰∏ãÊãâËèúÂçï‰∏≠ÈÄâÊã©Preferences‚Ä¶(Âø´Êç∑ÈîÆ command + , ) Âú®AccountsÈÄâÈ°πÂç°Ê∑ªÂä†Ëá™Â∑±ÁöÑApple ID„ÄÇÊ∑ªÂä†ÂÆåÊàêÂêé‰Ω†‰ºöÁúãÂà∞ËøôÊ†∑ÁöÑ‰ø°ÊÅØ„ÄÇÂèØ‰ª•ÁúãÂà∞‰∏ãÈù¢ÊòæÁ§∫‰∫ÜiOSÂíåMacÁöÑFreeÊ†áËÆ∞‰∫ÜÔºåÂú®Ëøô‰πãÂâçÊòØÊ≤°ÊúâËøô‰∫õÊ†áËÆ∞ÁöÑ„ÄÇ Â∞ÜÊµãËØïÁöÑiPhoneÊàñËÄÖÂÖ∂‰ªñÁúüÊú∫ÊµãËØïËÆæÂ§áËøûÊé•MacÔºåXcodeÈÄâ‰∏≠ÁúüÊú∫ÊµãËØïËÆæÂ§áÔºåÁõ¥Êé•ÁÇπÂáªËøêË°å„ÄÇ XcodeÊä•ÈîôÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÁõ¥Êé•ÁÇπÂáªFix Issue„ÄÇ Ë≠¶Âëä‰πüÊ≤°‰∫ÜÔºåËØÅ‰π¶‰πüÁîüÊàê‰∫ÜÔºåÈáçÊñ∞ÁÇπÂáªrunÊåâÈíÆÔºåÂèØ‰ª•ÂºÄÂßãÊÑâÂø´ÁöÑÁé©ËÄç‰∫ÜüòÅ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Xcode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[runtimeÂ∫îÁî®Á¨îËÆ∞]]></title>
    <url>%2F2016%2F08%2F23%2Fruntime%E5%BA%94%E7%94%A8%2F</url>
    <content type="text"><![CDATA[‰∫ÜËß£‰∫ÜruntimeÁöÑÂü∫Êú¨ÂéüÁêÜÔºåÈÇ£‰πàruntimeÁ©∂Á´üÊúâ‰ªÄ‰πàÁî®Â§ÑÂë¢ÔºüÂèÇËÄÉRuntimeÂÖ®Êñπ‰ΩçË£ÖÈÄºÊåáÂçóÔºåÊÄªÁªì‰∫Ü‰ª•‰∏ãÂá†ÁÇπÂ∫îÁî®Âú∫ÊôØ„ÄÇ ÁªôcategoryÊ∑ªÂä†Â±ûÊÄßÂéüÁêÜÂØπË±°ÂÖ≥ËÅîÂÖÅËÆ∏ÂºÄÂèëËÄÖÂØπÂ∑≤ÁªèÂ≠òÂú®ÁöÑÁ±ªÂú® Category ‰∏≠Ê∑ªÂä†Ëá™ÂÆö‰πâÁöÑÂ±ûÊÄßÔºö 1OBJC_EXPORT void objc_setAssociatedObject(id object, const void *key, id value, objc_AssociationPolicy policy) __OSX_AVAILABLE_STARTING(__MAC_10_6, __IPHONE_3_1); object ÊòØÊ∫êÂØπË±°. value ÊòØË¢´ÂÖ≥ËÅîÁöÑÂØπË±°. key ÊòØÂÖ≥ËÅîÁöÑÈîÆÔºåobjc_getAssociatedObject ÊñπÊ≥ïÈÄöËøá‰∏çÂêåÁöÑ key Âç≥ÂèØÂèñÂá∫ÂØπÂ∫îÁöÑË¢´ÂÖ≥ËÅîÂØπË±°. policy ÊòØ‰∏Ä‰∏™Êûö‰∏æÂÄºÔºåË°®Á§∫ÂÖ≥ËÅîÂØπË±°ÁöÑË°å‰∏∫Ôºå‰ªéÂëΩÂêçÂ∞±ËÉΩÁúãÂá∫ÂêÑ‰∏™Êûö‰∏æÂÄºÁöÑÂê´‰πâÔºö1234567891011typedef OBJC_ENUM(uintptr_t, objc_AssociationPolicy) &#123; OBJC_ASSOCIATION_ASSIGN = 0, /**&lt; Specifies a weak reference to the associated object. */ OBJC_ASSOCIATION_RETAIN_NONATOMIC = 1, /**&lt; Specifies a strong reference to the associated object. * The association is not made atomically. */ OBJC_ASSOCIATION_COPY_NONATOMIC = 3, /**&lt; Specifies that the associated object is copied. * The association is not made atomically. */ OBJC_ASSOCIATION_RETAIN = 01401, /**&lt; Specifies a strong reference to the associated object. * The association is made atomically. */ OBJC_ASSOCIATION_COPY = 01403 /**&lt; Specifies that the associated object is copied. * The association is made atomically. */&#125;; Ë¶ÅÂèñÂá∫Ë¢´ÂÖ≥ËÅîÁöÑÂØπË±°‰ΩøÁî® objc_getAssociatedObject ÊñπÊ≥ïÂç≥ÂèØÔºåË¶ÅÂà†Èô§‰∏Ä‰∏™Ë¢´ÂÖ≥ËÅîÁöÑÂØπË±°Ôºå‰ΩøÁî® objc_setAssociatedObject ÊñπÊ≥ïÂ∞ÜÂØπÂ∫îÁöÑ key ËÆæÁΩÆÊàê nil Âç≥ÂèØÔºö1objc_setAssociatedObject(self, associatedKey, nil, OBJC_ASSOCIATION_COPY_NONATOMIC); objc_removeAssociatedObjects ÊñπÊ≥ïÂ∞Ü‰ºöÁßªÈô§Ê∫êÂØπË±°‰∏≠ÊâÄÊúâÁöÑÂÖ≥ËÅîÂØπË±°. ÂÖ≥ËÅîÂØπË±°Âπ∂‰∏çÊòØÂ≠òÂÇ®Âú®Ë¢´ÂÖ≥ËÅîÂØπË±°Êú¨Ë∫´ÂÜÖÂ≠ò‰∏≠ÔºåËÄåÊòØÂ≠òÂÇ®Âú®ÂÖ®Â±ÄÁöÑÁªü‰∏ÄÁöÑ‰∏Ä‰∏™AssociationsManager‰∏≠„ÄÇÂÖ∂‰∏≠ÁÆ°ÁêÜÁùÄ‰∏Ä‰∏™ AssociationsHashMap„ÄÇÈîÆÊòØËÆæÁΩÆÂÖ≥ËÅîÂØπË±°ÁöÑ objectÔºåÂÄºÊòØ‰øùÂ≠òËøô‰∏™ object ÁöÑÊâÄÊúâÂÖ≥ËÅîÂØπË±°ÁöÑÂè¶‰∏Ä‰∏™ hashMap Á§∫‰æãÔºöÊñ∞Âª∫ UIButton ÁöÑ CategoryÔºåÂú®ÂÖ∂‰∏≠ËÆæÁΩÆclickBlockÂ±ûÊÄß(UIButton+ClickBlock.h):12345typedef void(^clickBlock)(void);@interface UIButton (ClickBlock)@property (nonatomic,copy) clickBlock click;@end Âú®.m‰∏≠ËÆæÁΩÆclickÁöÑsetÔºågetÊñπÊ≥ï(UIButton+ClickBlock.m):12345678910111213141516171819202122232425262728#import "UIButton+ClickBlock.h"#import &lt;objc/runtime.h&gt;static const void *associatedKey = "associatedKey";@implementation UIButton (ClickBlock)//Category‰∏≠ÁöÑÂ±ûÊÄßÔºåÂè™‰ºöÁîüÊàêsetterÂíågetterÊñπÊ≥ïÔºå‰∏ç‰ºöÁîüÊàêÊàêÂëòÂèòÈáè-(void)setClick:(clickBlock)click&#123; objc_setAssociatedObject(self, associatedKey, click, OBJC_ASSOCIATION_COPY_NONATOMIC); [self removeTarget:self action:@selector(buttonClick) forControlEvents:UIControlEventTouchUpInside]; if (click) &#123; [self addTarget:self action:@selector(buttonClick) forControlEvents:UIControlEventTouchUpInside]; &#125;&#125;-(clickBlock)click&#123; return objc_getAssociatedObject(self, associatedKey);&#125;-(void)buttonClick&#123; if (self.click) &#123; self.click(); &#125;&#125;@end Category‰∏≠ÁöÑÂ±ûÊÄßÔºåÂè™‰ºöÁîüÊàêsetterÂíågetterÊñπÊ≥ïÁöÑÂ£∞ÊòéÔºå‰∏ç‰ºöÁîüÊàêÊàêÂëòÂèòÈáèÔºåËÄå‰∏îÈúÄË¶ÅËá™Â∑±ÂÆûÁé∞ÊñπÊ≥ï„ÄÇ ÂÖ∂‰∏≠ÔºåÂú®setÊñπÊ≥ï‰∏≠‰ΩøÁî®addTarget:action:forControlEvents:ÁªôbuttonËÆæÁΩÆ‰∫ÜÁÇπÂáª‰∫ã‰ª∂„ÄÇ self.click()Ë°®Á§∫‰ΩøÁî®self.clickËé∑ÂæóblockÔºåÂÜçÈÄöËøáblock()ÊâßË°åÂùó„ÄÇ ‰∏∫‰ªÄ‰πà‰∏çÁõ¥Êé•ÁªôclickËµãÂÄºÔºåËÄåÊòØÈÄöËøáruntimeÁöÑobjc_setAssociatedObjectÊñπÊ≥ïÂë¢Ôºü@propertyÂ±ûÊÄß‰ºöÂú®ÁºñËØëÊó∂Ëá™Âä®ÁîüÊàê‰∏Ä‰∏™ÂÆû‰æãÂèòÈáè_click‰ª•ÂèäÂÖ∂setÔºågetÊñπÊ≥ï„ÄÇ‰ΩÜÊòØÁî±‰∫éruntimeÂè™ËÉΩÊ∑ªÂä†ÊñπÊ≥ïÔºå‰∏çËÉΩÊ∑ªÂä†ÂÆû‰æãÂèòÈáè„ÄÇÂõ†Ê≠§Ôºå_clickÂπ∂Ê≤°ÊúâÊ∑ªÂä†ËøõUIButtonÁöÑivar‰∏≠ÔºåÂõ†ËÄå‰∏çËÉΩ‰ΩøÁî®„ÄÇÂè™ËÉΩÈÄöËøáruntimeÁöÑÊñπÊ≥ïÔºåÊ∑ªÂä†ÂØπÂ∫îÈîÆÂÄºÂØπ„ÄÇ @propertyÂú®Êú¨‰æã‰∏≠Âè™ÊòØ‰∏∫‰∫ÜÂú®.hÈáåÂ£∞Êòé‰∏Ä‰∏™getsetÊñπÊ≥ï„ÄÇÂèØÊõøÊç¢ÊàêÔºö1234567typedef void(^clickBlock)(void);@interface UIButton (ClickBlock)//@property (nonatomic,copy) clickBlock click;- (clickBlock)click;- (void)setClick:(clickBlock)click;@end ÂÖ≥ËÅîÂØπË±°Áõ∏ÂΩì‰∫éÊää‰∏Ä‰∏™ÂØπË±°ÂÖ≥ËÅîÂà∞Âè¶Â§ñ‰∏Ä‰∏™ÂØπË±°‰∏ä„ÄÇÂú®ÂÖ≥ËÅîÂêéÂèØ‰ª•ÈöèÊó∂Ëé∑ÂèñËØ•ÂÖ≥ËÅîÁöÑÂØπË±°ÔºåÂú®ÂØπË±°Ë¢´ÈîÄÊØÅÊó∂‰ºöÁßªÈô§ÊâÄÊúâÂÖ≥ËÅîÁöÑÂØπË±°„ÄÇ Â≠óÂÖ∏‰∏éÊ®°ÂûãËΩ¨Êç¢ÂéüÁêÜÂ≠óÂÖ∏ËΩ¨Ê®°ÂûãÁöÑÊó∂ÂÄôÔºö Ê†πÊçÆÂ≠óÂÖ∏ÁöÑ key ÁîüÊàê setter ÊñπÊ≥ï. ‰ΩøÁî® objc_msgSend Ë∞ÉÁî® setter ÊñπÊ≥ï‰∏∫ Model ÁöÑÂ±ûÊÄßËµãÂÄºÔºàÊàñËÄÖ KVCÔºâ. Ê®°ÂûãËΩ¨Â≠óÂÖ∏ÁöÑÊó∂ÂÄôÔºö Ë∞ÉÁî® class_copyPropertyList ÊñπÊ≥ïËé∑ÂèñÂΩìÂâç Model ÁöÑÊâÄÊúâÂ±ûÊÄß. Ë∞ÉÁî® property_getName Ëé∑ÂèñÂ±ûÊÄßÂêçÁß∞. Ê†πÊçÆÂ±ûÊÄßÂêçÁß∞ÁîüÊàê getter ÊñπÊ≥ï. ‰ΩøÁî® objc_msgSend Ë∞ÉÁî® getter ÊñπÊ≥ïËé∑ÂèñÂ±ûÊÄßÂÄºÔºàÊàñËÄÖ KVCÔºâ. Á§∫‰æã1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374@interface NSObject (KeyValues)+(id)objectWithKeyValues:(NSDictionary *)aDictionary;-(NSDictionary *)keyValuesWithObject;@end#import "NSObject+KeyValues.h"#import &lt;objc/runtime.h&gt;#import &lt;objc/message.h&gt;@implementation NSObject (KeyValues)//Â≠óÂÖ∏ËΩ¨Ê®°Âûã+(id)objectWithKeyValues:(NSDictionary *)aDictionary&#123; id objc = [[self alloc] init]; for (NSString *key in aDictionary.allKeys) &#123; id value = aDictionary[key]; /*Âà§Êñ≠ÂΩìÂâçÂ±ûÊÄßÊòØ‰∏çÊòØModel*/ objc_property_t property = class_getProperty(self, key.UTF8String); unsigned int outCount = 0; objc_property_attribute_t *attributeList = property_copyAttributeList(property, &amp;outCount); objc_property_attribute_t attribute = attributeList[0]; NSString *typeString = [NSString stringWithUTF8String:attribute.value]; if ([typeString isEqualToString:@"@\"TestModel\""]) &#123; value = [self objectWithKeyValues:value]; &#125; /**********************/ //ÁîüÊàêsetterÊñπÊ≥ïÔºåÂπ∂Áî®objc_msgSendË∞ÉÁî® NSString *methodName = [NSString stringWithFormat:@"set%@%@:",[key substringToIndex:1].uppercaseString,[key substringFromIndex:1]]; SEL setter = sel_registerName(methodName.UTF8String); if ([objc respondsToSelector:setter]) &#123; ((void (*) (id,SEL,id)) objc_msgSend) (objc,setter,value); &#125; free(attributeList); &#125; return objc;&#125;//Ê®°ÂûãËΩ¨Â≠óÂÖ∏-(NSDictionary *)keyValuesWithObject&#123; unsigned int outCount = 0; objc_property_t *propertyList = class_copyPropertyList([self class], &amp;outCount); NSMutableDictionary *dict = [NSMutableDictionary dictionary]; for (int i = 0; i &lt; outCount; i ++) &#123; objc_property_t property = propertyList[i]; //ÁîüÊàêgetterÊñπÊ≥ïÔºåÂπ∂Áî®objc_msgSendË∞ÉÁî® const char *propertyName = property_getName(property); SEL getter = sel_registerName(propertyName); if ([self respondsToSelector:getter]) &#123; id value = ((id (*) (id,SEL)) objc_msgSend) (self,getter); /*Âà§Êñ≠ÂΩìÂâçÂ±ûÊÄßÊòØ‰∏çÊòØModel*/ if ([value isKindOfClass:[self class]] &amp;&amp; value) &#123; value = [value keyValuesWithObject]; &#125; /**********************/ if (value) &#123; NSString *key = [NSString stringWithUTF8String:propertyName]; [dict setObject:value forKey:key]; &#125; &#125; &#125; free(propertyList); return dict;&#125;@end ‰ΩøÁî®Ôºö123456789-(void)keyValuesTest&#123; TestModel *model = [TestModel objectWithKeyValues:dictionary]; NSLog(@"name is %@",model.name); NSLog(@"son name is %@",model.son.name); NSDictionary *dict = [model keyValuesWithObject]; NSLog(@"dict is %@",dict);&#125; Ê≥®ÊÑèÔºö Âú®NSObject‰∏≠Ê∑ªÂä†Á±ªÊñπÊ≥ïÔºåÂÖ∂‰∏≠ÁöÑselfÊåáÁöÑÊòØTestModelËøô‰∏™Á±ª„ÄÇ objc_property_tÂÖ∑Êúâ‰∏§‰∏™Â±ûÊÄßÔºånameÂíåattribute„ÄÇË∞ÉÁî®property_getAttributeÂ∞ÜËøîÂõûattributeÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇË∞ÉÁî®property_copyAttributeListÂàôÂ∞ÜÂ≠óÁ¨¶‰∏≤ÂàáÂàÜÔºåËøîÂõû‰∏Ä‰∏™objc_property_attribute_tÁ±ªÂûãÁöÑÊåáÈíàÔºåoutCountËøîÂõû‰∫ÜÂ±ûÊÄßÁöÑÊï∞Èáè„ÄÇ outCount‰ΩøÁî®‰∫ÜÊåáÂêëÊåáÈíàÁöÑÊåáÈíàÁöÑÊñπÂºèÔºå‰ΩøÊ≤°ÊúâËøîÂõûoutCountÁöÑÊÉÖÂÜµ‰∏ãÔºå‰øÆÊîπ‰∫ÜoutCountÁöÑÂÄº„ÄÇ ‰æãÔºö1234567891011121314151617181920- (NSArray *)scanBeginStr:(NSString *)beginstr endStr:(NSString *)endstr inText:(NSMutableString * *)textPointer&#123; NSRange range1,range2; NSUInteger location =0,length=0; range1.location = 0; NSMutableString *text = *textPointer; NSMutableArray *rangeArray = [NSMutableArray array]; while (range1.location != NSNotFound) &#123; range1 = [text rangeOfString:beginstr]; range2 = [text rangeOfString:endstr]; if (range1.location != NSNotFound) &#123; location = range1.location; length = range2.location - range1.location - 1; if (length &gt; 5000)break; [text replaceOccurrencesOfString:beginstr withString:@"" options:NSCaseInsensitiveSearch range:NSMakeRange(0, range1.location + range1.length)]; [text replaceOccurrencesOfString:endstr withString:@"" options:NSCaseInsensitiveSearch range:NSMakeRange(0, range2.location + range2.length - 1)]; &#125; [rangeArray addObject:@&#123;@"location":@(location),@"length":@(length)&#125;]; &#125; return rangeArray;&#125; ‰ΩøÁî®ÔºöÈÄöËøá&amp;ÂèñÊåáÈíàÁöÑÂú∞ÂùÄ1NSArray *rangeArray = [self scanBegin3Str:@&quot;&lt;&quot; endStr:@&quot;&gt;&quot; inText:&amp;mutableText]; Ëá™Âä®ÂΩíÊ°£ÂéüÁêÜÂΩíÊ°£ÊòØ‰∏ÄÁßçÂæàÂ∏∏Áî®ÁöÑÊñá‰ª∂ÂÇ®Â≠òÊñπÊ≥ïÔºåÂá†‰πé‰ªª‰ΩïÁ±ªÂûãÁöÑÂØπË±°ÈÉΩËÉΩÂ§üË¢´ÂΩíÊ°£ÂÇ®Â≠ò„ÄÇËá™Âä®ÂΩíÊ°£Â∞±ÊòØÂä®ÊÄÅËé∑ÂèñmodelÁöÑÂêÑ‰∏™Â±ûÊÄßÔºåËøõË°å‰øùÂ≠òÔºö123456789101112- (void)encodeWithCoder:(NSCoder *)aCoder&#123; [aCoder encodeObject:self.name forKey:@"name"]; [aCoder encodeObject:self.ID forKey:@"ID"];&#125;- (id)initWithCoder:(NSCoder *)aDecoder&#123; if (self = [super init]) &#123; self.ID = [aDecoder decodeObjectForKey:@"ID"]; self.name = [aDecoder decodeObjectForKey:@"name"]; &#125; return self;&#125; Â¶ÇÊûúÂΩìÂâç Model Êúâ100‰∏™Â±ûÊÄßÁöÑËØùÔºåÂ∞±ÈúÄË¶ÅÂÜô100Ë°åËøôÁßç‰ª£Á†Å.ÈÄöËøá Runtime Êàë‰ª¨Â∞±ÂèØ‰ª•ËΩªÊùæËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºö ‰ΩøÁî® class_copyIvarList ÊñπÊ≥ïËé∑ÂèñÂΩìÂâç Model ÁöÑÊâÄÊúâÊàêÂëòÂèòÈáè. ‰ΩøÁî® ivar_getName ÊñπÊ≥ïËé∑ÂèñÊàêÂëòÂèòÈáèÁöÑÂêçÁß∞. ÈÄöËøá KVC Êù•ËØªÂèñ Model ÁöÑÂ±ûÊÄßÂÄºÔºàencodeWithCoder:ÔºâÔºå‰ª•ÂèäÁªô Model ÁöÑÂ±ûÊÄßËµãÂÄºÔºàinitWithCoder:Ôºâ. Á§∫‰æãÔºö123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051// TestModel Â§¥Êñá‰ª∂@interface TestModel : NSObject&lt;NSCoding&gt;@property (nonatomic, copy) NSString *name;@property (nonatomic, strong) NSNumber *age;@property (nonatomic, copy) NSNumber *phoneNumber;@property (nonatomic, copy) NSNumber *height;@property (nonatomic, strong) NSDictionary *info;@property (nonatomic, strong) TestModel *son;@end#import "TestModel.h"#import &lt;objc/runtime.h&gt;#import &lt;objc/message.h&gt;@implementation TestModel- (void)encodeWithCoder:(NSCoder *)aCoder&#123; unsigned int outCount = 0; Ivar *vars = class_copyIvarList([self class], &amp;outCount); for (int i = 0; i &lt; outCount; i ++) &#123; Ivar var = vars[i]; const char *name = ivar_getName(var); NSString *key = [NSString stringWithUTF8String:name]; // Ê≥®ÊÑèkvcÁöÑÁâπÊÄßÊòØÔºåÂ¶ÇÊûúËÉΩÊâæÂà∞keyËøô‰∏™Â±ûÊÄßÁöÑsetterÊñπÊ≥ïÔºåÂàôË∞ÉÁî®setterÊñπÊ≥ï // Â¶ÇÊûúÊâæ‰∏çÂà∞setterÊñπÊ≥ïÔºåÂàôÊü•ÊâæÊàêÂëòÂèòÈáèkeyÊàñËÄÖÊàêÂëòÂèòÈáè_keyÔºåÂπ∂‰∏î‰∏∫ÂÖ∂ËµãÂÄº // ÊâÄ‰ª•ËøôÈáå‰∏çÈúÄË¶ÅÂÜçÂè¶Â§ñÂ§ÑÁêÜÊàêÂëòÂèòÈáèÂêçÁß∞ÁöÑ‚Äú_‚ÄùÂâçÁºÄ id value = [self valueForKey:key]; [aCoder encodeObject:value forKey:key]; &#125; free(vars);&#125;- (nullable instancetype)initWithCoder:(NSCoder *)aDecoder&#123; if (self = [super init]) &#123; unsigned int outCount = 0; Ivar *vars = class_copyIvarList([self class], &amp;outCount); for (int i = 0; i &lt; outCount; i ++) &#123; Ivar var = vars[i]; const char *name = ivar_getName(var); NSString *key = [NSString stringWithUTF8String:name]; id value = [aDecoder decodeObjectForKey:key]; [self setValue:value forKey:key]; &#125; free(vars); &#125; return self;&#125;@end Ê≥®ÊÑèËá™Âä®ÂΩíÊ°£Áî±‰∫éÁî®Âà∞ÁöÑÈÉΩÊòØ‰∏é object ÊúâÂÖ≥ÁöÑ encode ,decode ÊñπÊ≥ï„ÄÇÂõ†Ê≠§ model ‰∏≠Â∞±‰∏çËÉΩÂ≠òÂú®Èùû object Á±ªÂûãÔºåÊØîÂ¶Ç int Â∞±Ë¶ÅÂèò‰∏∫ NSNumber ÔºàÊ≥®ÊÑèÔºåNSNumber Á±ªÂûã‰∏çËÉΩÁõ¥Êé•ÂÅöÂä†ÂáèËøêÁÆóÔºâ„ÄÇ ‰ΩøÁî®Ôºö 123456789101112-(void)keyedArchiverTest&#123; TestModel *model = [TestModel objectWithKeyValues:dictionary]; NSString *path = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES).lastObject; path = [path stringByAppendingPathComponent:@"test"]; [NSKeyedArchiver archiveRootObject:model toFile:path]; TestModel *m = [NSKeyedUnarchiver unarchiveObjectWithFile:path]; NSLog(@"m.name is %@",m.name); NSLog(@"m.son name is %@",m.son.name);&#125; Âä®ÊÄÅÊñπÊ≥ïËß£Êûê‰∏éÊ∂àÊÅØËΩ¨ÂèëÂéüÁêÜÊ∂àÊÅØËΩ¨ÂèëÁöÑÂ§ßËá¥ËøáÁ®ãÂ¶ÇÂõæÔºö ÂΩì Runtime Á≥ªÁªüÂú®CacheÂíåÊñπÊ≥ïÂàÜÂèëË°®‰∏≠ÔºàÂåÖÊã¨Ë∂ÖÁ±ªÔºâÊâæ‰∏çÂà∞Ë¶ÅÊâßË°åÁöÑÊñπÊ≥ïÊó∂ÔºåRuntime‰ºöË∞ÉÁî®resolveInstanceMethod:ÊàñresolveClassMethod:(Ê∑ªÂä†ÂÆû‰æãÊñπÊ≥ïÂÆûÁé∞ÂíåÁ±ªÊñπÊ≥ïÂÆûÁé∞)Êù•ÁªôÁ®ãÂ∫èÂëò‰∏ÄÊ¨°Âä®ÊÄÅÊ∑ªÂä†ÊñπÊ≥ïÂÆûÁé∞ÁöÑÊú∫‰ºöÔºåÊåáÂÆöÊòØÂê¶Âä®ÊÄÅÊ∑ªÂä†ÊñπÊ≥ï„ÄÇËã•ËøîÂõûNOÔºåÂàôËøõÂÖ•‰∏ã‰∏ÄÊ≠•ÔºåËã•ËøîÂõûYESÔºåÂàôÈÄöËøá class_addMethod ÂáΩÊï∞Âä®ÊÄÅÂú∞Ê∑ªÂä†ÊñπÊ≥ïÔºåÊ∂àÊÅØÂæóÂà∞Â§ÑÁêÜÔºåÊ≠§ÊµÅÁ®ãÂÆåÊØï. resolveInstanceMethod: ÊñπÊ≥ïËøîÂõû NO Êó∂ÔºåÂ∞±‰ºöËøõÂÖ• forwardingTargetForSelector: ÊñπÊ≥ïÔºåËøôÊòØ Runtime ÁªôÊàë‰ª¨ÁöÑÁ¨¨‰∫åÊ¨°Êú∫‰ºöÔºåÁî®‰∫éÊåáÂÆöÂìçÂ∫îËøô‰∏™ selector ÁöÑÂØπË±°„ÄÇËøîÂõûnilÔºåËøõÂÖ•‰∏ã‰∏ÄÊ≠•ÔºõËøîÂõûÊüê‰∏™ÂØπË±°ÔºåÂàô‰ºöË∞ÉÁî®ËØ•ÂØπË±°ÁöÑÊñπÊ≥ï. Ëã• forwardingTargetForSelector: ËøîÂõûÁöÑÊòØnilÔºåÂàôÊàë‰ª¨È¶ñÂÖàË¶ÅÈÄöËøá methodSignatureForSelector: Êù•ÊåáÂÆöÊñπÊ≥ïÁ≠æÂêç„ÄÇ methodSignatureForSelector ÊñπÊ≥ïËøîÂõûnilÔºåË°®Á§∫‰∏çÂ§ÑÁêÜÔºåËã•ËøîÂõûÊñπÊ≥ïÁ≠æÂêçÔºåÂàô‰ºöËøõÂÖ•‰∏ã‰∏ÄÊ≠•. ÂΩì methodSignatureForSelector: ÊñπÊ≥ïËøîÂõûÊñπÊ≥ïÁ≠æÂêçÂêéÔºåÂ∞±‰ºöË∞ÉÁî® forwardInvocation: ÊñπÊ≥ïÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá NSInvocation ÂØπË±°ÂÅöÂæàÂ§öÂ§ÑÁêÜÔºåÊØîÂ¶Ç‰øÆÊîπÂÆûÁé∞ÊñπÊ≥ïÔºå‰øÆÊîπÂìçÂ∫îÂØπË±°Á≠â. Â¶ÇÊûúÂà∞ÊúÄÂêéÔºåÊ∂àÊÅØËøòÊòØÊ≤°ÊúâÂæóÂà∞ÂìçÂ∫îÔºåÁ®ãÂ∫èÂ∞±‰ºöcrash. ‰∏âÊ≠•ÁöÑÊµÅÁ®ã‰∏∫ Â¢ûÂä†Ëøô‰∏™ÊñπÊ≥ï ‰ΩøÁî®ÂÖ∂‰ªñÂØπË±°Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ï ‰ªªÊÑèÂØπË±°Ë∞ÉÁî®‰ªªÊÑèÊñπÊ≥ï Á§∫‰æãÔºö123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960#import "Monkey.h"#import "Bird.h"#import &lt;objc/runtime.h&gt;@implementation Monkey-(void)jump&#123; NSLog(@"monkey can not fly, but! monkey can jump");&#125;+(BOOL)resolveInstanceMethod:(SEL)sel&#123; /* Â¶ÇÊûúÂΩìÂâçÂØπË±°Ë∞ÉÁî®‰∫Ü‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ï Runtime‰ºöË∞ÉÁî®resolveInstanceMethod:Êù•ËøõË°åÂä®ÊÄÅÊñπÊ≥ïËß£Êûê Êàë‰ª¨ÈúÄË¶ÅÁî®class_addMethodÂáΩÊï∞ÂÆåÊàêÂêëÁâπÂÆöÁ±ªÊ∑ªÂä†ÁâπÂÆöÊñπÊ≥ïÂÆûÁé∞ÁöÑÊìç‰Ωú ËøîÂõûNOÔºåÂàôËøõÂÖ•‰∏ã‰∏ÄÊ≠•forwardingTargetForSelector: */ if(sel == @selector(fly))&#123; class_addMethod(self, sel, class_getMethodImplementation(self, sel_registerName("jump")), "v@:"); return YES; &#125; return [super resolveInstanceMethod:sel];&#125;-(id)forwardingTargetForSelector:(SEL)aSelector&#123; /* Âú®Ê∂àÊÅØËΩ¨ÂèëÊú∫Âà∂ÊâßË°åÂâçÔºåRuntime Á≥ªÁªü‰ºöÂÜçÁªôÊàë‰ª¨‰∏ÄÊ¨°ÈáçÂÆöÂêëÁöÑÊú∫‰ºö ÈÄöËøáÈáçËΩΩforwardingTargetForSelector:ÊñπÊ≥ïÊù•ÊõøÊç¢Ê∂àÊÅØÁöÑÊé•ÂèóËÄÖ‰∏∫ÂÖ∂‰ªñÂØπË±° ËøîÂõûnilÂàôËøõÊ≠•‰∏ã‰∏ÄÊ≠•forwardInvocation: */ #if 0 return nil;#else return [[Bird alloc] init];#endif&#125;-(NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector&#123; /* Ëé∑ÂèñÊñπÊ≥ïÁ≠æÂêçËøõÂÖ•‰∏ã‰∏ÄÊ≠•ÔºåËøõË°åÊ∂àÊÅØËΩ¨Âèë */ return [NSMethodSignature signatureWithObjCTypes:"v@:"];&#125;-(void)forwardInvocation:(NSInvocation *)anInvocation&#123; /* Ê∂àÊÅØËΩ¨Âèë */ return [anInvocation invokeWithTarget:[[Bird alloc] init]];&#125;@end ÂÖ∂‰∏≠ &quot;v@:&quot; Ë°®Á§∫ËøîÂõûÂÄºÂíåÂèÇÊï∞,Ëøô‰∏™Á¨¶Âè∑Ê∂âÂèäType Encoding‰ª•ÂèäÂÖ≥‰∫étype encodingsÁöÑÁêÜËß£‚Äìruntime programming guide„ÄÇÂÖ∂‰∏≠ class_addMethod ÂÖ∑‰ΩìÁöÑ‰ΩøÁî®ÊñπÂºèÂèØ‰ª•ÂèÇËßÅ‰∏ãÈù¢‰∏ÄËäÇ„ÄÇ ‰∏ÄËà¨Êù•ËØ¥ÂèØ‰ª•‰ΩøÁî®method_getTypeEncoding()Ëé∑ÂèñÊõ¥ËØ¶ÁªÜÁöÑType_EncodingÔºå‰ª£ÊõøÊâãÂä®ÁöÑ ËæìÂÖ•ÁöÑ v@:„ÄÇ‰∏ãÈù¢‰æãÂ≠ê‰∏≠‰πü‰ºöÁî®Âà∞„ÄÇ ÂÖ∂‰∏≠vË°®Á§∫voidËøîÂõûÁ±ªÂûãÔºå@Ë°®Á§∫ÂèÇÊï∞id(self)ÔºåÔºöË°®Á§∫SEL(_cmd)„ÄÇ@:ÊòØÂøÖÈ°ªË¶ÅÊúâÁöÑ„ÄÇÂêéÈù¢ÂèØ‰ª•Êé•ÂÖ•ÂèÇÁ±ªÂûã„ÄÇ ‰∏æ‰∏™‰æãÂ≠êÔºö&quot;i@:@&quot;iË°®Á§∫ËøîÂõûÂÄºÁ±ªÂûãint@ÔºöÂíå‰∏äÈù¢ÊÑè‰πâÁõ∏Âêå@ÊúÄÂêé‰∏Ä‰∏™@Ë°®Á§∫Êúâ‰∏Ä‰∏™ÂÖ•ÂèÇÔºåÊòØidÁ±ªÂûã„ÄÇ NSInvocation ‰ΩøÁî®ËØ¶ËßÅ API‰ΩøÁî® ËΩ¨Âèë‰∏éÂ§öÁªßÊâøËΩ¨ÂèëÂíåÁªßÊâøÁõ∏‰ººÔºåÂèØ‰ª•Áî®‰∫é‰∏∫ObjcÁºñÁ®ãÊ∑ªÂä†‰∏Ä‰∫õÂ§öÁªßÊâøÁöÑÊïàÊûú„ÄÇÂ∞±ÂÉè‰∏ãÂõæÈÇ£Ê†∑Ôºå‰∏Ä‰∏™ÂØπË±°ÊääÊ∂àÊÅØËΩ¨ÂèëÂá∫ÂéªÔºåÂ∞±Â•Ω‰ººÂÆÉÊääÂè¶‰∏Ä‰∏™ÂØπË±°‰∏≠ÁöÑÊñπÊ≥ïÂÄüËøáÊù•ÊàñÊòØ‚ÄúÁªßÊâø‚ÄùËøáÊù•‰∏ÄÊ†∑„ÄÇ Ëøô‰ΩøÂæó‰∏çÂêåÁªßÊâø‰ΩìÁ≥ªÂàÜÊîØ‰∏ãÁöÑ‰∏§‰∏™Á±ªÂèØ‰ª•‚ÄúÁªßÊâø‚ÄùÂØπÊñπÁöÑÊñπÊ≥ïÔºåÂú®‰∏äÂõæ‰∏≠WarriorÂíåDiplomatÊ≤°ÊúâÁªßÊâøÂÖ≥Á≥ªÔºå‰ΩÜÊòØWarriorÂ∞ÜnegotiateÊ∂àÊÅØËΩ¨ÂèëÁªô‰∫ÜDiplomatÂêéÔºåÂ∞±Â•Ω‰ººDiplomatÊòØWarriorÁöÑË∂ÖÁ±ª‰∏ÄÊ†∑„ÄÇ Ê∂àÊÅØËΩ¨ÂèëÂº•Ë°•‰∫Ü Objc ‰∏çÊîØÊåÅÂ§öÁªßÊâøÁöÑÊÄßË¥®Ôºå‰πüÈÅøÂÖç‰∫ÜÂõ†‰∏∫Â§öÁªßÊâøÂØºËá¥Âçï‰∏™Á±ªÂèòÂæóËáÉËÇøÂ§çÊùÇ„ÄÇÂÆÉÂ∞ÜÈóÆÈ¢òÂàÜËß£ÂæóÂæàÁªÜÔºåÂè™ÈíàÂØπÊÉ≥Ë¶ÅÂÄüÈâ¥ÁöÑÊñπÊ≥ïÊâçËΩ¨ÂèëÔºåËÄå‰∏îËΩ¨ÂèëÊú∫Âà∂ÊòØÈÄèÊòéÁöÑ„ÄÇ Runtime-Âä®ÊÄÅÂàõÂª∫Á±ªÊ∑ªÂä†Â±ûÊÄßÂíåÊñπÊ≥ï12345678910111213141516171819202122232425262728293031323334353637- (void)createClass&#123; Class MyClass = objc_allocateClassPair([NSObject class], "myclass", 0); //Ê∑ªÂä†‰∏Ä‰∏™NSStringÁöÑÂèòÈáèÔºåÁ¨¨Âõõ‰∏™ÂèÇÊï∞ÊòØÂØπÈΩêÊñπÂºèÔºåÁ¨¨‰∫î‰∏™ÂèÇÊï∞ÊòØÂèÇÊï∞Á±ªÂûã if (class_addIvar(MyClass, "itest", sizeof(NSString *), log2(sizeof(NSString *)), @encode(NSString *))) &#123; NSLog(@"add ivar success"); &#125; //myclasstestÊòØÂ∑≤ÁªèÂÆûÁé∞ÁöÑÂáΩÊï∞Ôºå"v@:"ËøôÁßçÂÜôÊ≥ïËßÅtype encoding class_addMethod(MyClass, @selector(myclasstest:), (IMP)myclasstest, "v@:"); //Ê≥®ÂÜåËøô‰∏™Á±ªÂà∞runtimeÁ≥ªÁªü‰∏≠Â∞±ÂèØ‰ª•‰ΩøÁî®‰ªñ‰∫Ü objc_registerClassPair(MyClass); //ÁîüÊàê‰∫Ü‰∏Ä‰∏™ÂÆû‰æãÂåñÂØπË±° id myobj = [[MyClass alloc] init]; NSString *str = @"asdb"; //ÁªôÂàöÂàöÊ∑ªÂä†ÁöÑÂèòÈáèËµãÂÄº // object_setInstanceVariable(myobj, "itest", (void *)&amp;str);Âú®ARC‰∏ã‰∏çÂÖÅËÆ∏‰ΩøÁî® [myobj setValue:str forKey:@"itest"]; //Ë∞ÉÁî®myclasstestÊñπÊ≥ïÔºå‰πüÂ∞±ÊòØÁªômyobjËøô‰∏™Êé•ÂèóËÄÖÂèëÈÄÅmyclasstestËøô‰∏™Ê∂àÊÅØ [myobj myclasstest:10];&#125;//Ëøô‰∏™ÊñπÊ≥ïÂÆûÈôÖ‰∏äÊ≤°ÊúâË¢´Ë∞ÉÁî®,‰ΩÜÊòØÂøÖÈ°ªÂÆûÁé∞Âê¶ÂàôÁºñËØëÈÉΩ‰∏çËÉΩÈÄöËøá- (void)myclasstest:(int)a&#123; &#125;//Ë∞ÉÁî®ÁöÑÊòØËøô‰∏™ÊñπÊ≥ïstatic void myclasstest(id self, SEL _cmd, int a) //selfÂíå_cmdÊòØÂøÖÈ°ªÁöÑÔºåÂú®‰πãÂêéÂèØ‰ª•ÈöèÊÑèÊ∑ªÂä†ÂÖ∂‰ªñÂèÇÊï∞&#123; Ivar v = class_getInstanceVariable([self class], "itest"); //ËøîÂõûÂêç‰∏∫itestÁöÑivarÁöÑÂèòÈáèÁöÑÂÄº id o = object_getIvar(self, v); //ÊàêÂäüÊâìÂç∞Âá∫ÁªìÊûú NSLog(@"%@", o); NSLog(@"int a is %d", a);&#125; Method SwizzlingÊ≠§ÈÉ®ÂàÜÂèÇËÄÉËá™Objective-CÁöÑÊñπÊ≥ïÊõøÊç¢„ÄÅObjective-C RuntimeÁ≠âÁ≥ªÂàóÊñáÁ´† ‰æãÂ≠ê12345678910111213141516171819202122232425262728293031323334353637383940414243444546#import &lt;objc/runtime.h&gt; @implementation UIViewController (Tracking) + (void)load &#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; Class aClass = [self class]; SEL originalSelector = @selector(viewWillAppear:); SEL swizzledSelector = @selector(xxx_viewWillAppear:); Method originalMethod = class_getInstanceMethod(aClass, originalSelector); Method swizzledMethod = class_getInstanceMethod(aClass, swizzledSelector); // When swizzling a class method, use the following: // Class aClass = object_getClass((id)self); // ... // Method originalMethod = class_getClassMethod(aClass, originalSelector); // Method swizzledMethod = class_getClassMethod(aClass, swizzledSelector); BOOL didAddMethod = class_addMethod(aClass, originalSelector, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod)); if (didAddMethod) &#123; class_replaceMethod(aClass, swizzledSelector, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod)); &#125; else &#123; method_exchangeImplementations(originalMethod, swizzledMethod); &#125; &#125;); &#125; #pragma mark - Method Swizzling - (void)xxx_viewWillAppear:(BOOL)animated &#123; [self xxx_viewWillAppear:animated]; NSLog(@"viewWillAppear: %@", self); &#125; @end ÂéüÁêÜÊ¶ÇËø∞Âú®Objective-C‰∏≠Ë∞ÉÁî®‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂÖ∂ÂÆûÊòØÂêë‰∏Ä‰∏™ÂØπË±°ÂèëÈÄÅÊ∂àÊÅØÔºåÊü•ÊâæÊ∂àÊÅØÁöÑÂîØ‰∏Ä‰æùÊçÆÊòØselectorÁöÑÂêçÂ≠ó„ÄÇÂà©Áî®Objective-CÁöÑÂä®ÊÄÅÁâπÊÄßÔºåÂèØ‰ª•ÂÆûÁé∞Âú®ËøêË°åÊó∂ÂÅ∑Êç¢selectorÂØπÂ∫îÁöÑÊñπÊ≥ïÂÆûÁé∞ÔºåËææÂà∞ÁªôÊñπÊ≥ïÊåÇÈí©ÁöÑÁõÆÁöÑ„ÄÇ ÊØè‰∏™Á±ªÈÉΩÊúâ‰∏Ä‰∏™ÊñπÊ≥ïÂàóË°®ÔºåÂ≠òÊîæÁùÄselectorÁöÑÂêçÂ≠óÂíåÊñπÊ≥ïÂÆûÁé∞ÁöÑÊò†Â∞ÑÂÖ≥Á≥ª„ÄÇIMPÊúâÁÇπÁ±ª‰ººÂáΩÊï∞ÊåáÈíàÔºåÊåáÂêëÂÖ∑‰ΩìÁöÑMethodÂÆûÁé∞„ÄÇÂ¶Ç‰∏ãÂõæ ÈÄöËøáSwizzlingÈúÄË¶ÅÂÆûÁé∞ÁöÑÊòØÂÅ∑Êç¢selectorÁöÑIMPÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÂÆûÁé∞ËøáÁ®ã‰∏äÈù¢ÁöÑ‰ª£Á†ÅÈÄöËøáÊ∑ªÂä†‰∏Ä‰∏™TrackingÁ±ªÂà´Âà∞UIViewControllerÁ±ª‰∏≠ÔºåÂ∞ÜUIViewControllerÁ±ªÁöÑviewWillAppear:ÊñπÊ≥ïÂíåTrackingÁ±ªÂà´‰∏≠xxx_viewWillAppear:ÊñπÊ≥ïÁöÑÂÆûÁé∞Áõ∏‰∫íË∞ÉÊç¢„ÄÇSwizzling Â∫îËØ•Âú®+loadÊñπÊ≥ï‰∏≠ÂÆûÁé∞ÔºåÂõ†‰∏∫+loadÊòØÂú®‰∏Ä‰∏™Á±ªÊúÄÂºÄÂßãÂä†ËΩΩÊó∂Ë∞ÉÁî®„ÄÇdispatch_onceÊòØGCD‰∏≠ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂÆÉ‰øùËØÅ‰∫Ü‰ª£Á†ÅÂùóÂè™ÊâßË°å‰∏ÄÊ¨°ÔºåÂπ∂ËÆ©ÂÖ∂‰∏∫‰∏Ä‰∏™ÂéüÂ≠êÊìç‰ΩúÔºåÁ∫øÁ®ãÂÆâÂÖ®ÊòØÂæàÈáçË¶ÅÁöÑ„ÄÇ ÂÆûÁé∞SwizzlingÈúÄË¶ÅËÄÉËôë‰∏§ÁßçÊÉÖÂÜµÔºåÁ¨¨‰∏ÄÁßçÊòØË¢´ÊõøÊç¢ÊñπÊ≥ïÊ≤°ÊúâÂú®ÂΩìÂâçÁ±ª‰∏≠ÈáçÂÜôËøáÔºåËÄåÊòØÂè™Âú®ÂÖ∂Áà∂Á±ª‰∏≠ÂÆûÁé∞‰∫Ü;Á¨¨‰∫åÁßçÊÉÖÂÜµÊòØËøô‰∏™ÊñπÊ≥ïÂ∑≤ÁªèÂ≠òÂú®‰∫éÂΩìÂâçÁ±ª‰∏≠ÔºåÂ∞±Â¶ÇÊú¨‰æã‰∏≠ÊÉ≥Ë¶ÅÊõøÊç¢ÊéâUIViewController‰∏≠ÁöÑviewWillAppear:ÊñπÊ≥ï„ÄÇËøô‰∏§ÁßçÊÉÖÂÜµË¶ÅÂå∫Âà´ÂØπÂæÖ„ÄÇ ÂØπ‰∫éÁ¨¨‰∏ÄÁßçÊÉÖÂÜµÔºåÁî±‰∫éÂΩìÂâçÁ±ªÂÜÖÊ≤°ÊúâËøô‰∏™ÊñπÊ≥ïÔºåÂ∫îÂΩìÁé∞Âú®ÂΩìÂâçÁ±ª‰∏≠Ê∑ªÂä†‰∏Ä‰∏™Êñ∞ÁöÑÂÆûÁé∞ÊñπÊ≥ï(xxx_viewWillAppear:)ÔºåÁÑ∂ÂêéÂ∞ÜÂ§çÂÜôÁöÑÊñπÊ≥ïÊõøÊç¢‰∏∫ÂéüÂÖàÁöÑÂÆûÁé∞(viewWillAppear:). 12345BOOL didAddMethod = class_addMethod(aClass, originalSelector, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod)); class_addMethodÂ∞ÜÊú¨Êù•‰∏çÂ≠òÂú®‰∫éË¢´Êìç‰ΩúÁöÑClassÈáåÁöÑswizzledMethodÁöÑÂÆûÁé∞Ê∑ªÂä†Âú®Ë¢´Êìç‰ΩúÁöÑClassÈáå,Âπ∂‰ΩøÁî®originalSelector‰Ωú‰∏∫ÂÖ∂ÈÄâÊã©Â≠ê„ÄÇÂ¶ÇÊûúÂèëÁé∞ÊñπÊ≥ïÂ∑≤ÁªèÂ≠òÂú®Ôºå‰ºöÂ§±Ë¥•ËøîÂõû„ÄÇ ÈÄöËøá‰∏ä‰∏ÄÁØáruntimeÂéüÁêÜÁöÑÂàÜÊûêÔºåclass_addMethodÂ∫îËØ•ÊòØÂÖàÂú®Á±ªÁöÑmethodÊï∞ÁªÑÈáåÊâæÊòØÂê¶ÊúâËøô‰∏™SEL,Â¶ÇÊûúÊ≤°ÊúâÂ∞±Ê∑ªÂä†‰∏Ä‰∏™method_t„ÄÇ Â¶ÇÊûúÊ∑ªÂä†ÊàêÂäü(ÂΩìÂâçÁ±ª‰∏≠Ê≤°ÊúâÈáçÂÜôËøáÁà∂Á±ªÁöÑËØ•ÊñπÊ≥ï)ÔºåÂÜçÊääÁõÆÊ†áÁ±ª‰∏≠ÁöÑÊñπÊ≥ïÊõøÊç¢‰∏∫ÊóßÊúâÁöÑÂÆûÁé∞:12345if (didAddMethod) &#123; class_replaceMethod(aClass, swizzledSelector, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod)); addMethod‰ºöËÆ©ÂΩìÂâçÁ±ªÁöÑÊñπÊ≥ï(IMP)ÊåáÂêëÊñ∞ÁöÑÂÆûÁé∞(SEL)Ôºå‰ΩøÁî®replaceMethodÂÜçÂ∞ÜÊñ∞ÁöÑÊñπÊ≥ï(IMP)ÊåáÂêëÂéüÂÖàÁöÑÂÆûÁé∞(SEL)„ÄÇÁé∞Âú®ÈÄöËøáÊóßÊñπÊ≥ïSELÊù•Ë∞ÉÁî®ÔºåÂ∞±‰ºöÂÆûÁé∞Êñ∞ÊñπÊ≥ïÁöÑIMPÔºåÈÄöËøáÊñ∞ÊñπÊ≥ïÁöÑSELÊù•Ë∞ÉÁî®ÔºåÂ∞±‰ºöÂÆûÁé∞ÊóßÊñπÊ≥ïÁöÑIMP„ÄÇ Â¶ÇÊûúÊ∑ªÂä†Â§±Ë¥•‰∫ÜÔºåÂ∞±ÊòØÁ¨¨‰∫åÊÉÖÂÜµ(ÊñπÊ≥ïÂ∑≤ÁªèÂú®ÂΩìÂâçÁ±ª‰∏≠ÂÆûÁé∞Ëøá‰∫Ü)„ÄÇËøôÊó∂ÂèØ‰ª•ÈÄöËøámethod_exchangeImplementationsÁõ¥Êé•‰∫§Êç¢‰∏§‰∏™method_tÁöÑIMP:123else &#123; method_exchangeImplementations(originalMethod, overrideMethod);&#125; ÊâÄ‰ª•Êú¨‰æã‰∏≠Áî±‰∫éviewWillAppear:Â∑≤ÁªèÂú®UIViewController‰∏≠ÂÆûÁé∞Ëøá‰∫ÜÔºåÊâÄ‰ª•Ôºåclass_addMethodÂ§±Ë¥•ÔºåÈÄöËøámethod_exchangeImplementationsËææÂà∞‰∫§Êç¢ÂÆûÁé∞„ÄÇÂ¶ÇÊûúË¶ÅÈÄöËøáclass_addMethodÊ∑ªÂä†ÔºåÈúÄË¶ÅËá™ÂÆö‰πâ‰∏Ä‰∏™ViewÁªßÊâøUIViewControllerÔºåÂÜçÂú®Ëøô‰∏™Á±ª‰∏≠ÊõøÊç¢viewWillAppear:„ÄÇ Â¶ÇÊûúÁ±ª‰∏≠Ê≤°ÊúâÊÉ≥Ë¢´ÊõøÊç¢ÂÆûÁé∞ÁöÑÂéüÊñπÊ≥ïÊó∂Ôºåclass_replaceMethodÁõ∏ÂΩì‰∫éÁõ¥Êé•Ë∞ÉÁî®class_addMethodÂêëÁ±ª‰∏≠Ê∑ªÂä†ËØ•ÊñπÊ≥ïÁöÑÂÆûÁé∞„ÄÇ method_exchangeImplementationsÊñπÊ≥ïÂÅöÁöÑ‰∫ãÊÉÖ‰∏éÂ¶Ç‰∏ãÁöÑÂéüÂ≠êÊìç‰ΩúÁ≠â‰ª∑Ôºö1234IMP imp1 = method_getImplementation(m1);IMP imp2 = method_getImplementation(m2);method_setImplementation(m1, imp2);method_setImplementation(m2, imp1); Áõ¥Êé•ËÆæÁΩÆ‰∫Ümethod:m1,m2ÁöÑIMPÔºåÁÆÄÂçïÊö¥Âäõ„ÄÇ ÂØπ‰∫éÊ≥®Èáä‰∫ÜÁöÑËøôÂá†Ë°å:12345// When swizzling a class method, use the following:// Class aClass = object_getClass((id)self);// ...// Method originalMethod = class_getClassMethod(aClass, originalSelector);// Method swizzledMethod = class_getClassMethod(aClass, swizzledSelector); object_getClass((id)self) ‰∏é [self class] ËøîÂõûÁöÑÁªìÊûúÁ±ªÂûãÈÉΩÊòØ Class,‰ΩÜÂâçËÄÖ‰∏∫ÂÖÉÁ±ª,ÂêéËÄÖ‰∏∫ÂÖ∂Êú¨Ë∫´,Âõ†‰∏∫Ê≠§Êó∂ self ‰∏∫ Class ËÄå‰∏çÊòØÂÆû‰æã.Ê≥®ÊÑè [NSObject class] ‰∏é [objectÂÆû‰æã class] ÁöÑÂå∫Âà´Ôºö 1234567+ (Class)class &#123; return self;&#125;- (Class)class &#123; return object_getClass(self);&#125; object_getClass()ÊñπÊ≥ïËøîÂõûÂØπË±°ÁöÑisa„ÄÇ ÊúÄÂêéÔºåxxx_viewWillAppear:ÊñπÊ≥ïÁöÑÂÆö‰πâÁúã‰ººÊòØÈÄíÂΩíË∞ÉÁî®ÂºïÂèëÊ≠ªÂæ™ÁéØÔºåÂÖ∂ÂÆû‰∏ç‰ºöÁöÑ„ÄÇÂõ†‰∏∫[self xxx_viewWillAppear:animated]Ê∂àÊÅØ‰ºöÂä®ÊÄÅÊâæÂà∞xxx_viewWillAppear:ÊñπÊ≥ïÁöÑÂÆûÁé∞ÔºåËÄåÂÆÉÁöÑÂÆûÁé∞Â∑≤ÁªèË¢´Êàë‰ª¨‰∏éviewWillAppear:ÊñπÊ≥ïÂÆûÁé∞ËøõË°å‰∫Ü‰∫íÊç¢ÔºåÊâÄ‰ª•ËøôÊÆµ‰ª£Á†Å‰∏ç‰ªÖ‰∏ç‰ºöÊ≠ªÂæ™ÁéØÔºåÂ¶ÇÊûú‰Ω†Êää[self xxx_viewWillAppear:animated]Êç¢Êàê[self viewWillAppear:animated]ÂèçËÄå‰ºöÂºïÂèëÊ≠ªÂæ™ÁéØ„ÄÇ Demo ËØ¶ËßÅRuntimeLearn Âç±Èô©ÊÄßË¶ÅÂú® load ÊñπÊ≥ï‰∏≠Method swizzling‰∏çÊòØÂéüÂ≠êÊÄßÊìç‰Ωú„ÄÇÂ¶ÇÊûúÂú®+loadÊñπÊ≥ïÈáåÈù¢ÂÜôÔºåÊòØÊ≤°ÊúâÈóÆÈ¢òÁöÑÔºå‰ΩÜÊòØÂ¶ÇÊûúÂÜôÂú®+initializeÊñπÊ≥ï‰∏≠Â∞±‰ºöÂá∫Áé∞‰∏Ä‰∫õÂ•áÊÄ™ÁöÑÈóÆÈ¢ò„ÄÇÂπ∂‰∏îÂú® +initialize ‰∏≠ÂÜô‰πüÊúâÂèØËÉΩË¢´Ë¶ÜÁõñ„ÄÇ Â¶ÇÊûú‰∏çÂÜôÂú® +load ‰∏≠ÂèØËÉΩ‰ºöÂõ†‰∏∫Â§öÁ∫øÁ®ãÈöæ‰ª•‰øùËØÅÂè¶‰∏Ä‰∏™Á∫øÁ®ã‰∏≠‰∏ç‰ºöÂêåÊó∂Ë∞ÉÁî®‰∫§Êç¢ÊñπÊ≥ïÔºå‰ªéËÄåÂØºËá¥Á®ãÂ∫è‰∏çÊåâÈ¢ÑÊúüÊâßË°å„ÄÇ CopyÁà∂Á±ªÁöÑÊñπÊ≥ïÂ∏¶Êù• hook Áà∂Á±ªÂ§±ÊïàÁöÑÈóÆÈ¢òÂ¶ÇÊûú hook ‰∫Ü‰∏∫ÈáçÂÜôÁà∂Á±ªÊñπÊ≥ïÁöÑÂ≠êÁ±ªÁöÑÊñπÊ≥ï„ÄÇÈÇ£‰πà‰ºöÊ∑ªÂä†Áà∂Á±ªÁöÑÊñπÊ≥ïÂà∞Â≠êÁ±ª‰∏≠„ÄÇÂ¶ÇÊûúÁà∂Á±ª‰∏≠‰πühook‰∫ÜËØ•ÊñπÊ≥ïÔºåÂ∞±ÂèØËÉΩ‰ºö‰∫ßÁîüÈóÆÈ¢ò„ÄÇ Â¶ÇÊûúÁà∂Á±ªÁöÑÂàÜÁ±ªÁöÑ load ÊñπÊ≥ïÁöÑÂÖàÊâßË°åÁöÑÊó∂ÂÄôÔºåÂÖàÂèëÁîüÊõøÊç¢ÔºåÂ≠êÁ±ªÂÜçÊõøÊç¢ÔºåÈÇ£‰πàÊ≤°ÊúâÈóÆÈ¢ò„ÄÇ ‰ΩÜÊòØÂ¶ÇÊûúÂ≠êÁ±ªÁöÑÂàÜÁ±ªÁöÑ load ÊñπÊ≥ïÂÖàÊâßË°åÁöÑÊó∂ÂÄôÔºåÈÇ£‰πàÂ≠êÁ±ªÂÖà hook ‰∫ÜÁà∂Á±ªÊñπÊ≥ïÔºåÁà∂Á±ªÂÜç hook Ëá™Â∑±ÁöÑÊñπÊ≥ï„ÄÇÈÇ£‰πàÂ≠êÁ±ªË∞ÉÁî®ÁöÑÊó∂ÂÄôÂ∞±‰∏ç‰ºöËµ∞Áà∂Á±ªÂÆûÁé∞ hook Ê∑ªÂä†ÁöÑÂêÑÁßçÂ§ÑÁêÜ‰∫Ü„ÄÇ ‰∏ªË¶ÅÂéüÂõ†Â∞±ÊòØÊàë‰ª¨ËÉΩ‰øùËØÅÁà∂Á±ªÁöÑ load ÊñπÊ≥ïÂÖà‰∫éÂ≠êÁ±ªÁöÑ load ÊñπÊ≥ïÊâßË°å„ÄÇ‰ΩÜÊòØ‰∏çËÉΩ‰øùËØÅÁà∂Á±ªÁöÑÂàÜÁ±ªÁöÑ load ÊñπÊ≥ïÂÖà‰∫éÂ≠êÁ±ªÁöÑÂàÜÁ±ªÁöÑ load ÊñπÊ≥ïÂÖàÊâßË°å„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Runtime</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[runtimeÂéüÁêÜÁ¨îËÆ∞]]></title>
    <url>%2F2016%2F08%2F22%2Fruntime%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÂ∞ùËØïÂæÄcategory‰∏≠Ê∑ªÂä†ÂÆû‰æãÂèòÈáèÂ§±Ë¥•Ôºå‰ΩÜÊòØÂèØ‰ª•Ê∑ªÂä†ÊñπÊ≥ï„ÄÇ‰∫éÊòØÔºåÁ†îÁ©∂‰∫Ü‰∏Ä‰∏ãruntimeÁöÑÂÆûÁé∞Âíå‰ΩøÁî®„ÄÇruntimeÁöÑÂéüÁêÜÂ±ïÂºÄÊù•ÂàÜÊûêÁöÑËØùËøòÊòØÊå∫Â§çÊùÇÁöÑ„ÄÇ‰∏ãËΩΩ‰∫ÜÊúÄÊñ∞ÁöÑÊ∫êÁ†ÅÔºàobjc4-680Ôºâ,ÂèëÁé∞ÂíåÁé∞Âú®ÁΩë‰∏äÁöÑÂ§öÊï∞ÊïôÁ®ãËøòÊòØÊúâÂá∫ÂÖ•ÁöÑÔºåË∑üËøõËµ∑Êù•ÂæàÂõ∞Èöæ„ÄÇÊâÄ‰ª•Â∞ùËØïËá™Â∑±Êï¥ÁêÜ‰∫Ü‰∏Ä‰∏ãÔºåÂä†‰∫Ü‰∏Ä‰∫õËá™Â∑±ÁöÑÁêÜËß£ÔºåÂÖ∑‰ΩìÁªÜËäÇÂèØËÉΩÊúâ‰∫õÂ∞èÂá∫ÂÖ•„ÄÇÂèÇËÄÉÊñáÁ´†ÔºöObjective-C Runtime RuntimeÂü∫Á°ÄÂú®Objective-C‰∏≠Ôºå‰ΩøÁî®[receiver message]ËØ≠Ê≥ïÂπ∂‰∏ç‰ºöÈ©¨‰∏äÊâßË°åreceiverÂØπË±°ÁöÑmessageÊñπÊ≥ïÁöÑ‰ª£Á†ÅÔºåËÄåÊòØÂêëreceiverÂèëÈÄÅ‰∏ÄÊù°messageÊ∂àÊÅØ„ÄÇÂÖ∂ÂÆû[receiver message]Ë¢´ÁºñËØëÂô®ËΩ¨Âåñ‰∏∫: 1id objc_msgSend ( id self, SEL op, ... ); Áé∞Âú®ÂèØ‰ª•ÁúãÂá∫[receiver message]ÁúüÁöÑ‰∏çÊòØ‰∏Ä‰∏™ÁÆÄÁÆÄÂçïÂçïÁöÑÊñπÊ≥ïË∞ÉÁî®„ÄÇÂõ†‰∏∫ËøôÂè™ÊòØÂú®ÁºñËØëÈò∂ÊÆµÁ°ÆÂÆö‰∫ÜË¶ÅÂêëÊé•Êî∂ËÄÖÂèëÈÄÅmessageËøôÊù°Ê∂àÊÅØÔºåËÄåreceiveÂ∞ÜË¶ÅÂ¶Ç‰ΩïÂìçÂ∫îËøôÊù°Ê∂àÊÅØÔºåÈÇ£Â∞±Ë¶ÅÁúãËøêË°åÊó∂ÂèëÁîüÁöÑÊÉÖÂÜµÊù•ÂÜ≥ÂÆö‰∫Ü„ÄÇÂ¶ÇÊûúÊ∂àÊÅØÁöÑÊé•Êî∂ËÄÖËÉΩÂ§üÊâæÂà∞ÂØπÂ∫îÁöÑselectorÔºåÈÇ£‰πàÂ∞±Áõ∏ÂΩì‰∫éÁõ¥Êé•ÊâßË°å‰∫ÜÊé•Êî∂ËÄÖËøô‰∏™ÂØπË±°ÁöÑÁâπÂÆöÊñπÊ≥ïÔºõÂê¶ÂàôÔºåÊ∂àÊÅØË¶Å‰πàË¢´ËΩ¨ÂèëÔºåÊàñÊòØ‰∏¥Êó∂ÂêëÊé•Êî∂ËÄÖÂä®ÊÄÅÊ∑ªÂä†Ëøô‰∏™selectorÂØπÂ∫îÁöÑÂÆûÁé∞ÂÜÖÂÆπÔºåË¶Å‰πàÂ∞±Âπ≤ËÑÜÁé©ÂÆåÂ¥©Ê∫ÉÊéâ„ÄÇ idobjc_msgSendÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Á±ªÂûã‰∏∫id,ÂÆÉÊòØ‰∏Ä‰∏™ÊåáÂêëobjc_objectÁªìÊûÑ‰ΩìÊåáÈíà,ÂÆÉÂåÖÂê´‰∏Ä‰∏™Class isaÊåáÈíà(ÂÆåÊï¥ÁöÑÂÆö‰πâÂú®objc_private.h‰∏≠)Ôºö12345typedef struct objc_object *id;struct objc_object &#123; Class isa OBJC_ISA_AVAILABILITY;&#125;; ÊâÄÊúâÂØπË±°ÈÉΩÊòØÁªßÊâø‰∫é objc_object ÁöÑÔºåÊâÄ‰ª•ÊâÄÊúâÂØπË±°ÈÉΩÊúâ isa ÊåáÈíàÔºåÂç≥ÈÉΩÊúâ‰∏Ä‰∏™ objc_class ÁªìÊûÑ‰ΩìÁöÑÊåáÈíà„ÄÇÔºàÊ≥®ÊÑèÔºåËøôÂíå superclass ÊòØ‰∏çÂêåÁöÑÔºâ SELobjc_msgSendÂáΩÊï∞Á¨¨‰∫å‰∏™ÂèÇÊï∞Á±ªÂûã‰∏∫SELÔºåÂÆÉÊòØselectorÂú®Objc‰∏≠ÁöÑË°®Á§∫Á±ªÂûã.selectorÊòØÊñπÊ≥ïÈÄâÊã©Âô®ÔºåÂèØ‰ª•ÁêÜËß£‰∏∫Âå∫ÂàÜÊñπÊ≥ïÁöÑ IDÔºåËÄåËøô‰∏™ ID ÁöÑÊï∞ÊçÆÁªìÊûÑÊòØSEL:1typedef struct objc_selector *SEL; Class‰πãÊâÄ‰ª•ËØ¥isaÊòØÊåáÈíàÊòØÂõ†‰∏∫ClassÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™ÊåáÂêëobjc_classÁªìÊûÑ‰ΩìÁöÑÊåáÈíàÔºö1typedef struct objc_class *Class; Ëøô‰∏™ÁªìÊûÑ‰ΩìÂú®runtime.h‰∏≠ÊúâÂÆö‰πâ:1234567891011121314struct objc_class &#123; Class isa OBJC_ISA_AVAILABILITY;#if !__OBJC2__ Class super_class OBJC2_UNAVAILABLE; const char *name OBJC2_UNAVAILABLE; long version OBJC2_UNAVAILABLE; long info OBJC2_UNAVAILABLE; long instance_size OBJC2_UNAVAILABLE; struct objc_ivar_list *ivars OBJC2_UNAVAILABLE; struct objc_method_list **methodLists OBJC2_UNAVAILABLE; struct objc_cache *cache OBJC2_UNAVAILABLE; struct objc_protocol_list *protocols OBJC2_UNAVAILABLE;#endif&#125; OBJC2_UNAVAILABLE; ÂÖ∂‰∏≠OBJC2_UNAVAILABLEË°®Á§∫ÔºöÂú®objc2‰∏≠Ëøô‰∫õÂ±ûÊÄßÂ∑≤Áªè‰∏çÂú®Ê≠§ÂÆö‰πâ„ÄÇ Âú®objc2‰∏≠Ôºåobjc_classÁöÑÂÆåÊï¥ÂÆö‰πâÂú®objc-runtime-new.h‰∏≠Ôºö12345678910111213struct objc_object &#123; Class isa OBJC_ISA_AVAILABILITY;&#125;;struct objc_class : objc_object &#123; Class superclass; cache_t cache; // formerly cache pointer and vtable class_data_bits_t bits; // class_rw_t * plus custom rr/alloc flags class_rw_t *data() &#123; return bits.data(); &#125;&#125;; Âíåruntime.h‰∏≠ÁöÑÂÆö‰πâÂØπÊØîÔºåÂ∞ë‰∫ÜËÆ∏Â§öÂ±ûÊÄßÔºåÂ§öÂá∫‰∏Ä‰∏™bitsÂ±ûÊÄß„ÄÇËøô‰∫õÂ±ûÊÄßÈÉΩÂåÖÂê´Âú®‰∫Üclass_rw_tÁöÑdataÂØπË±°‰∏≠„ÄÇ Ê≥®ÊÑèÂà∞objc_class‰∏≠‰πüÊúâ‰∏Ä‰∏™isaÂØπË±°(ÁªßÊâøËá™objc_object)ÔºåËøôÊòØÂõ†‰∏∫‰∏Ä‰∏™ObjCÁ±ªÊú¨Ë∫´ÂêåÊó∂‰πüÊòØ‰∏Ä‰∏™ÂØπË±°Ôºå‰∏∫‰∫ÜÂ§ÑÁêÜÁ±ªÂíåÂØπË±°ÁöÑÂÖ≥Á≥ªÔºåruntimeÂ∫ìÂàõÂª∫‰∫Ü‰∏ÄÁßçÂè´ÂÅö ÂÖÉÁ±ª (Meta Class)ÁöÑ‰∏úË•øÔºåÁ±ªÂØπË±°ÊâÄÂ±ûÁ±ªÂûãÂ∞±Âè´ÂÅöÂÖÉÁ±ªÔºåÂÆÉÁî®Êù•Ë°®Ëø∞Á±ªÂØπË±°Êú¨Ë∫´ÊâÄÂÖ∑Â§áÁöÑÂÖÉÊï∞ÊçÆ„ÄÇÁ±ªÊñπÊ≥ïÂ∞±ÂÆö‰πâ‰∫éÊ≠§Â§ÑÔºåÂõ†‰∏∫Ëøô‰∫õÊñπÊ≥ïÂèØ‰ª•ÁêÜËß£ÊàêÁ±ªÂØπË±°ÁöÑÂÆû‰æãÊñπÊ≥ï„ÄÇÊØè‰∏™Á±ª‰ªÖÊúâ‰∏Ä‰∏™Á±ªÂØπË±°ÔºåËÄåÊØè‰∏™Á±ªÂØπË±°‰ªÖÊúâ‰∏Ä‰∏™‰∏é‰πãÁõ∏ÂÖ≥ÁöÑÂÖÉÁ±ª„ÄÇÂΩì‰Ω†ÂèëÂá∫‰∏Ä‰∏™Á±ª‰ºº[NSObject alloc]ÁöÑÊ∂àÊÅØÊó∂Ôºå‰Ω†‰∫ãÂÆû‰∏äÊòØÊääËøô‰∏™Ê∂àÊÅØÂèëÁªô‰∫Ü‰∏Ä‰∏™Á±ªÂØπË±° (Class Object) ÔºåËøô‰∏™Á±ªÂØπË±°ÂøÖÈ°ªÊòØ‰∏Ä‰∏™ÂÖÉÁ±ªÁöÑÂÆû‰æãÔºåËÄåËøô‰∏™ÂÖÉÁ±ªÂêåÊó∂‰πüÊòØ‰∏Ä‰∏™Ê†πÂÖÉÁ±ª (root meta class)ÁöÑÂÆû‰æã„ÄÇÊâÄÊúâÁöÑÂÖÉÁ±ªÊúÄÁªàÈÉΩÊåáÂêëÊ†πÂÖÉÁ±ª‰∏∫ÂÖ∂Ë∂ÖÁ±ª„ÄÇÊâÄÊúâÁöÑÂÖÉÁ±ªÁöÑÊñπÊ≥ïÂàóË°®ÈÉΩÊúâËÉΩÂ§üÂìçÂ∫îÊ∂àÊÅØÁöÑÁ±ªÊñπÊ≥ï„ÄÇÊâÄ‰ª•ÂΩì [NSObject alloc]ËøôÊù°Ê∂àÊÅØÂèëÁªôÁ±ªÂØπË±°ÁöÑÊó∂ÂÄôÔºåobjc_msgSend()‰ºöÂéªÂÆÉÁöÑÂÖÉÁ±ªÈáåÈù¢ÂéªÊü•ÊâæËÉΩÂ§üÂìçÂ∫îÊ∂àÊÅØÁöÑÊñπÊ≥ïÔºåÂ¶ÇÊûúÊâæÂà∞‰∫ÜÔºåÁÑ∂ÂêéÂØπËøô‰∏™Á±ªÂØπË±°ÊâßË°åÊñπÊ≥ïË∞ÉÁî®„ÄÇ ÁúãÊòéÁôΩËøô‰∏™Âõæ‰∏äÈù¢Â∞±ÈÉΩÊòéÁôΩ‰∫Ü„ÄÇ class_rw_tbits ‰∏≠ÂåÖÂê´‰∫Ü‰∏Ä‰∏™ÊåáÂêë class_rw_t ÁªìÊûÑ‰ΩìÁöÑÊåáÈíàÔºåÂÆÉÁöÑÂÆö‰πâÂ¶Ç‰∏ã:12345678910struct class_rw_t &#123; uint32_t flags; uint32_t version; const class_ro_t *ro; method_array_t methods; property_array_t properties; protocol_array_t protocols;&#125; ÂÖ∂‰∏≠Ôºåconst class_ro_t *roÂåÖÂê´‰∫ÜÊâÄÊúâÊàêÂëòÂèòÈáèÁöÑ‰∏ÄÁª¥Êï∞ÁªÑ‰ª•ÂèäÂêÑ‰∏™Âü∫Á°ÄÁöÑ(base)Â±ûÊÄß„ÄÅÊñπÊ≥ïÂíåÂçèËÆÆmethod_array_t methods„ÄÅproperty_array_t properties„ÄÅprotocol_array_t protocolsÂàôÂåÖÂê´‰∫ÜÊâÄÊúâÊãìÂ±ïÁöÑÂ±ûÊÄßÊñπÊ≥ïÂíåÂçèËÆÆ„ÄÇÊ≥®ÊÑèÔºöËøôÈáåÁöÑÂ±ûÊÄßÂè™ÊòØgetsetÊñπÊ≥ïÔºå‰∏çÂåÖÂê´ÊàêÂëòÂèòÈáè„ÄÇ Âü∫Á°ÄÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ïÂíåÊãìÂ±ïÁöÑÊñπÊ≥ïÊ≤°ÊúâÂ≠òÂú®‰∏Ä‰∏™ÂØπË±°‰∏≠ÔºåÊâÄ‰ª•‰∏çËÉΩÂú® category ‰∏≠Ê∑ªÂä†ÊàêÂëòÂèòÈáè„ÄÇ‰ΩÜÊòØÂÆåÂÖ®Áî® runtime ÂàõÂª∫ÁöÑÁ±ªÊòØÂèØ‰ª•Âä®ÊÄÅÊ∑ªÂä†ÁöÑ„ÄÇ ÂÖ∑‰ΩìÂ¶Ç‰ΩïÂ∫îÁî®ÂèØÁúã‰∏ã‰∏ÄÁØá„ÄÇ ÈÉ®ÂàÜÁ±ªÁöÑÂ£∞ÊòéËøôÈÉ®ÂàÜÂ∞Ü‰∏äÈù¢Ê∂âÂèäÁöÑÁ±ªÁöÑÂ£∞ÊòéË¥¥Âá∫‰ª•‰æõÂèÇÁÖßÔºåÂèØ‰ª•Áõ¥Êé•Ë∑≥Ëøá„ÄÇ class_ro_t:12345678struct class_ro_t &#123; ... method_list_t * baseMethodList; protocol_list_t * baseProtocols; const ivar_list_t * ivars; property_list_t *baseProperties; ...&#125;; method_tmethod_list_tÂíåmethod_array_tÂÜÖÈÉΩÊòØmethod_tÁ±ªÂûã: 12345struct method_t &#123; SEL name; const char *types; IMP imp;&#125; ÊñπÊ≥ïÂêçÁ±ªÂûã‰∏∫SEL ÊñπÊ≥ïÁ±ªÂûãtypesÊòØ‰∏™charÊåáÈíàÔºåÂÖ∂ÂÆûÂ≠òÂÇ®ÁùÄÊñπÊ≥ïÁöÑÂèÇÊï∞Á±ªÂûãÂíåËøîÂõûÂÄºÁ±ªÂûã„ÄÇ impÊåáÂêë‰∫ÜÊñπÊ≥ïÁöÑÂÆûÁé∞ÔºåÊú¨Ë¥®‰∏äÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÊåáÈíà ivar_tivar_list_t ÂÜÖÊòØivar_tÁ±ªÂûã: 12345struct ivar_t &#123; int32_t *offset; const char *name; const char *type;&#125; ËÆøÈóÆÁßÅÊúâÂèòÈáèÂèØ‰ª•ÈÄöËøá kvc Âíå runtime ÁöÑ class_getInstanceVariableÔºå‰∏§ÁßçÊñπÂºèËé∑Âèñ„ÄÇ property_tproperty_list_tÂíåproperty_array_tÂÜÖÈÉΩÊòØproperty_tÁ±ªÂûã: 1234struct property_t &#123; const char *name; const char *attributes;&#125;; protocol_tprotocol_list_tÂíåprotocol_array_tÂÜÖÈÉΩÊòØprotocol_tÁ±ªÂûã:1234567891011struct protocol_t : objc_object &#123; const char *mangledName; struct protocol_list_t *protocols; method_list_t *instanceMethods; method_list_t *classMethods; method_list_t *optionalInstanceMethods; method_list_t *optionalClassMethods; property_list_t *instanceProperties; uint32_t size; // sizeof(protocol_t) uint32_t flags;&#125;; Ivar,Method,Category,objc_property_tÂ§ñÈÉ®ÂèØ‰ª•ÈÄöËøá‰∏ÄÁ≥ªÂàóÁöÑÊñπÊ≥ïËé∑ÂæóÁ±ªÁöÑ‰ø°ÊÅØÔºåËØ∏Â¶ÇÔºöclass_copyIvarList,class_copyPropertyListÁ≠âÊñπÊ≥ïÔºåÂèØ‰ª•Ëé∑ÂæóÁ±ªÁöÑÂÆû‰æãÂèòÈáèÂíåÂ±ûÊÄßÔºåÂØπÂ∫îÁöÑÁ±ªÂûãÊòØIvar„ÄÅobjc_property_tÔºåÂÆÉ‰ª¨ÂàÜÂà´ÊòØivar_t,property_tÁ±ªÂûãÁöÑÊåáÈíà„ÄÇ 1234typedef struct method_t *Method;typedef struct ivar_t *Ivar;typedef struct category_t *Category;typedef struct property_t *objc_property_t; Ê∂àÊÅØÂá†ÁßçÂáΩÊï∞Ê¥æÂèëÊñπÂºèÂáΩÊï∞ÁöÑÊ¥æÂèëÊñπÂºèÔºåÂ∏∏ËßÅÁöÑÊúâ‰∏âÁßçÔºö Áõ¥Êé•Ê¥æÂèë ÂáΩÊï∞Ë°®Ê¥æÂèë Ê∂àÊÅØÊ¥æÂèë Áõ¥Êé•Ê¥æÂèëÈÄüÂ∫¶ÊúÄÂø´Ôºå‰æãÂ¶Ç c++ ‰∏≠ÁöÑÂáΩÊï∞Ë∞ÉÁî®ÔºåÁºñËØëÊó∂Áõ¥Êé•ÊãøÂà∞ÂáΩÊï∞ÁöÑÂú∞ÂùÄ„ÄÇ ÂáΩÊï∞Ë°®Ê¥æÂèëÂõûÂë≥ÊØè‰∏Ä‰∏™Á±ªÁª¥Êä§‰∏Ä‰∏™ÂáΩÊï∞Ë°®ÔºåÂ§ßÈÉ®ÂàÜËØ≠Ë®ÄÁß∞‰πã‰∏∫ËôöÂáΩÊï∞Ë°®ÔºåÈáåÈù¢ËÆ∞ÂΩïÁùÄÊâÄÊúâÁöÑÂáΩÊï∞ÔºåÂ¶ÇÊûúÁà∂Á±ªÂáΩÊï∞Ë¢´ override ÁöÑËØùÔºåË°®ÈáåÈù¢Âè™‰øùÂ≠òË¢´ override ‰πãÂêéÁöÑÂáΩÊï∞„ÄÇËøêË°åÊó∂‰ºöÊ†πÊçÆËøô‰∏™Ë°®ÂéªÂÜ≥ÂÆöË¶ÅË∞ÉÁî®ÁöÑÂáΩÊï∞„ÄÇÂ¶Ç Java„ÄÇ c++ ‰∏≠Ë¶ÅÂú®Áà∂Á±ªÊñπÊ≥ï‰∏≠Áî® virtual ‰øÆÈ•∞ÔºåÊâç‰ºöÂ∞ÜÁõ¥Êé•Ê¥æÂèëËΩ¨‰∏∫ÂáΩÊï∞Ë°®Ê¥æÂèëÔºåÂÆûÁé∞Â§öÊÄÅ„ÄÇJava ÂèØ‰ª•ÈÄöËøá final ‰øÆÈ•∞ÊåáÂÆö‰∏∫Áõ¥Êé•Ê¥æÂèë„ÄÇ Ê∂àÊÅØÊ¥æÂèëÂ∞±ÊòØ OC ÁöÑÂÆûÁé∞ÊñπÂºè„ÄÇ objc_msgSendÂáΩÊï∞ÁúãËµ∑Êù•ÂÉèÊòØobjc_msgSendËøîÂõû‰∫ÜÊï∞ÊçÆÔºåÂÖ∂ÂÆûobjc_msgSend‰ªé‰∏çËøîÂõûÊï∞ÊçÆËÄåÊòØ‰Ω†ÁöÑÊñπÊ≥ïË¢´Ë∞ÉÁî®ÂêéËøîÂõû‰∫ÜÊï∞ÊçÆ„ÄÇ‰∏ãÈù¢ËØ¶ÁªÜÂèôËø∞‰∏ãÊ∂àÊÅØÂèëÈÄÅÊ≠•È™§Ôºö Ê£ÄÊµãËøô‰∏™ selector ÊòØ‰∏çÊòØË¶ÅÂøΩÁï•ÁöÑ„ÄÇÊØîÂ¶ÇÊúâ‰∫ÜÂûÉÂúæÂõûÊî∂Â∞±‰∏çÁêÜ‰ºö retain, release Ëøô‰∫õÂáΩÊï∞‰∫Ü„ÄÇ Ê£ÄÊµãËøô‰∏™ target ÊòØ‰∏çÊòØ nil ÂØπË±°„ÄÇObjC ÁöÑÁâπÊÄßÊòØÂÖÅËÆ∏ÂØπ‰∏Ä‰∏™ nilÂØπË±°ÊâßË°å‰ªª‰Ωï‰∏Ä‰∏™ÊñπÊ≥ï‰∏ç‰ºö CrashÔºåÂõ†‰∏∫‰ºöË¢´ÂøΩÁï•Êéâ„ÄÇ Â¶ÇÊûú‰∏äÈù¢‰∏§‰∏™ÈÉΩËøá‰∫ÜÔºåÈÇ£Â∞±ÂºÄÂßãÊü•ÊâæËøô‰∏™Á±ªÁöÑ IMPÔºåÂÖà‰ªé cache ÈáåÈù¢ÊâæÔºåÂÆå‰∫ÜÊâæÂæóÂà∞Â∞±Ë∑≥Âà∞ÂØπÂ∫îÁöÑÂáΩÊï∞ÂéªÊâßË°å„ÄÇ Â¶ÇÊûú cache Êâæ‰∏çÂà∞Â∞±Êâæ‰∏Ä‰∏ãÊñπÊ≥ïÂàÜÂèëË°®„ÄÇ Â¶ÇÊûúÂàÜÂèëË°®Êâæ‰∏çÂà∞Â∞±Âà∞Ë∂ÖÁ±ªÁöÑÂàÜÂèëË°®ÂéªÊâæÔºå‰∏ÄÁõ¥ÊâæÔºåÁõ¥Âà∞ÊâæÂà∞NSObjectÁ±ª‰∏∫Ê≠¢„ÄÇ Â¶ÇÊûúËøòÊâæ‰∏çÂà∞Â∞±Ë¶ÅÂºÄÂßãËøõÂÖ•Âä®ÊÄÅÊñπÊ≥ïËß£Êûê‰∫Ü. ÁºñËØëÂô®‰ºöÊ†πÊçÆÊÉÖÂÜµÂú®objc_msgSend, objc_msgSend_stret, objc_msgSendSuper, Êàñ objc_msgSendSuper_stretÂõõ‰∏™ÊñπÊ≥ï‰∏≠ÈÄâÊã©‰∏Ä‰∏™Êù•Ë∞ÉÁî®„ÄÇÂ¶ÇÊûúÊ∂àÊÅØÊòØ‰º†ÈÄíÁªôË∂ÖÁ±ªÔºåÈÇ£‰πà‰ºöË∞ÉÁî®ÂêçÂ≠óÂ∏¶ÊúâSuperÁöÑÂáΩÊï∞ÔºõÂ¶ÇÊûúÊ∂àÊÅØËøîÂõûÂÄºÊòØÊï∞ÊçÆÁªìÊûÑËÄå‰∏çÊòØÁÆÄÂçïÂÄºÊó∂ÔºåÈÇ£‰πà‰ºöË∞ÉÁî®ÂêçÂ≠óÂ∏¶ÊúâstretÁöÑÂáΩÊï∞„ÄÇ ÂΩìÊàë‰ª¨Ë∞ÉÁî®[super selector] Êó∂ÔºåRuntime ‰ºöË∞ÉÁî® objc_msgSendSuperÊñπÊ≥ïÔºåobjc_msgSendSuper ÊñπÊ≥ïÊúâ‰∏§‰∏™ÂèÇÊï∞Ôºåsuper Âíå opÔºåRuntime ‰ºöÊää selector ÊñπÊ≥ïÈÄâÊã©Âô®ËµãÂÄºÁªô op„ÄÇËÄå super ÊòØ‰∏Ä‰∏™ objc_super ÁªìÊûÑ‰ΩìÊåáÈíàÔºåobjc_super ÁªìÊûÑ‰ΩìÂÆö‰πâÂ¶Ç‰∏ãÔºö1struct objc_super &#123; id receiver; Class class; &#125;; ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºöËøôÈáåÁöÑreceiver‰ªçÁÑ∂ÊòØselfÊú¨Ë∫´„ÄÇÂΩìÊàë‰ª¨ÊÉ≥ÈÄöËøá[super class]Ëé∑ÂèñË∂ÖÁ±ªÊó∂ÔºåÁºñËØëÂô®Âè™ÊòØÂ∞ÜÊåáÂêëselfÁöÑidÊåáÈíàÂíåclassÁöÑSEL‰º†ÈÄíÁªô‰∫Üobjc_msgSendSuperÂáΩÊï∞ÔºåÂõ†‰∏∫Âè™ÊúâÂú®NSObjectÁ±ªÊâçËÉΩÊâæÂà∞classÊñπÊ≥ïÔºåÁÑ∂ÂêéclassÊñπÊ≥ïË∞ÉÁî®object_getClass()ÔºåÊé•ÁùÄË∞ÉÁî®objc_msgSend(objc_super-&gt;receiver, @selector(class))Ôºå‰º†ÂÖ•ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÊåáÂêëselfÁöÑidÊåáÈíàÔºå‰∏éË∞ÉÁî®[self class]Áõ∏ÂêåÔºåÊâÄ‰ª•Êàë‰ª¨ÂæóÂà∞ÁöÑÊ∞∏ËøúÈÉΩÊòØselfÁöÑÁ±ªÂûã„ÄÇ ‰∏æ‰∏™Ê†óÂ≠êÔºåÈóÆ‰∏ãÈù¢ÁöÑ‰ª£Á†ÅËæìÂá∫‰ªÄ‰πàÔºö 123456789101112@implementation Son : Father- (id)init&#123; self = [super init]; if (self) &#123; NSLog(@"%@", NSStringFromClass([self class])); NSLog(@"%@", NSStringFromClass([super class])); &#125; return self;&#125;@end Á≠îÊ°àÊòØÂÖ®ÈÉ®ËæìÂá∫ Son. ÂΩìË∞ÉÁî® [super class] Êó∂Ôºå‰ºöËΩ¨Êç¢Êàê objc_msgSendSuper ÂáΩÊï∞Ôºö ÂÖàÊûÑÈÄ† objc_super ÁªìÊûÑ‰ΩìÔºåÁªìÊûÑ‰ΩìÁ¨¨‰∏Ä‰∏™ÊàêÂëòÂ∞±ÊòØ self„ÄÇÁ¨¨‰∫å‰∏™ÊàêÂëòÊòØ (id)class_getSuperclass(objc_getClass(‚ÄúSon‚Äù)). Âéª Father Ëøô‰∏™Á±ªÈáåÂéªÊâæ - (Class)classÔºåÊ≤°ÊúâÔºåÁÑ∂ÂêéÂéª NSObject Á±ªÂéªÊâæÔºåÊâæÂà∞‰∫Ü„ÄÇÊúÄÂêéÂÜÖÈÉ®ÊòØ‰ΩøÁî® objc_msgSend(objc_super-&gt;receiver, @selector(class)) ÂéªË∞ÉÁî®ÔºåÊ≠§Êó∂Â∑≤ÁªèÂíå [self class] Ë∞ÉÁî®Áõ∏Âêå‰∫ÜÔºåÊâÄ‰ª•‰∏§‰∏™ËæìÂá∫ÁªìÊûúÈÉΩÊòØ Son„ÄÇ ËøôÈáåË∞ÉÁî®classÂè™ÊòØ‰∏æ‰æãÔºåÊâÄÊúâË∞ÉÁî®superÁöÑÊñπÊ≥ïÔºåÊúÄÂêéÈÉΩÂèòÊàê‰∫ÜselfÁöÑË∞ÉÁî®„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÂç≥‰ΩøÊòØ [super class] Ë∞ÉÁî®ÁöÑÊòØÁà∂Á±ªÁöÑ class ÊñπÊ≥ïÔºå‰ΩÜÊòØÊé•Êî∂ÂØπË±°Ê∞∏ËøúËøòÊòØ self objc_super -&gt; receiver Ê∞∏ËøúÊòØÂ≠êÁ±ª Category ÁöÑÂÆûÁé∞ÂéüÁêÜÊ¶ÇËø∞runtime ‰æùËµñ‰∫é dyld Âä®ÊÄÅÂä†ËΩΩÔºåÂú® objc-os.mm Êñá‰ª∂‰∏≠ÂèØ‰ª•ÊâæÂà∞ÂÖ•Âè£ÔºåÂÆÉÁöÑË∞ÉÁî®Ê†àÁÆÄÂçïÊï¥ÁêÜÂ¶Ç‰∏ã:123456void _objc_init(void)‚îî‚îÄ‚îÄconst char \*map_2_images(...) ‚îî‚îÄ‚îÄconst char \*map_images_nolock(...) ‚îî‚îÄ‚îÄvoid _read_images(header_info **hList, uint32_t hCount) ‚îî‚îÄ‚îÄstatic void remethodizeClass(Class cls) ‚îî‚îÄ‚îÄstatic void attachCategories(Class cls, category_list *cats, bool flush_caches) Category Áõ∏ÂÖ≥ÁöÑÊï∞ÊçÆÁªìÊûÑÈ¶ñÂÖàÊù•‰∫ÜËß£‰∏Ä‰∏ã‰∏Ä‰∏™ Category ÊòØÂ¶Ç‰ΩïÂ≠òÂÇ®ÁöÑÔºåÂú® objc-runtime-new.h ‰∏≠ÂèØ‰ª•ÁúãÂà∞Â¶Ç‰∏ãÂÆö‰πâÔºö12345678struct category_t &#123; const char *name; classref_t cls; struct method_list_t *instanceMethods; struct method_list_t *classMethods; struct protocol_list_t *protocols; struct property_list_t *instanceProperties;&#125;; ‰ªécategoryÁöÑÂÆö‰πâ‰πüÂèØ‰ª•ÁúãÂá∫categoryÁöÑÂèØ‰∏∫ÔºàÂèØ‰ª•Ê∑ªÂä†ÂÆû‰æãÊñπÊ≥ïÔºåÁ±ªÊñπÊ≥ïÔºåÁîöËá≥ÂèØ‰ª•ÂÆûÁé∞ÂçèËÆÆÔºåÊ∑ªÂä†Â±ûÊÄßÔºâÂíå‰∏çÂèØ‰∏∫ÔºàÊó†Ê≥ïÊ∑ªÂä†ÂÆû‰æãÂèòÈáèÔºâ„ÄÇ Â§ÑÁêÜ CategoryÂØπ Category ‰∏≠ÊñπÊ≥ïÁöÑËß£ÊûêÂπ∂‰∏çÂ§çÊùÇÔºåÈ¶ñÂÖàÊù•Áúã‰∏Ä‰∏ã attachCategories ÁöÑÁÆÄÂåñÁâà‰ª£Á†Å:123456789101112131415161718192021222324static void attachCategories(Class cls, category_list *cats, bool flush_caches) &#123; if (!cats) return; bool isMeta = cls-&gt;isMetaClass(); method_list_t **mlists = (method_list_t **)malloc(cats-&gt;count * sizeof(*mlists)); // Count backwards through cats to get newest categories first int mcount = 0; int i = cats-&gt;count; while (i--) &#123; auto&amp; entry = cats-&gt;list[i]; method_list_t *mlist = entry.cat-&gt;methodsForMeta(isMeta); if (mlist) &#123; mlists[mcount++] = mlist; &#125; &#125; auto rw = cls-&gt;data(); prepareMethodLists(cls, mlists, mcount, NO, fromBundle); rw-&gt;methods.attachLists(mlists, mcount); free(mlists); if (flush_caches &amp;&amp; mcount &gt; 0) flushCaches(cls);&#125; È¶ñÂÖàÔºåÈÄöËøá while Âæ™ÁéØÔºåÊàë‰ª¨ÈÅçÂéÜÊâÄÊúâÁöÑ categoryÔºå‰πüÂ∞±ÊòØÂèÇÊï∞ cats ‰∏≠ÁöÑ list Â±ûÊÄß„ÄÇÂØπ‰∫éÊØè‰∏Ä‰∏™ categoryÔºåÂæóÂà∞ÂÆÉÁöÑÊñπÊ≥ïÂàóË°® mlist Âπ∂Â≠òÂÖ• mlists ‰∏≠„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÊàë‰ª¨Â∞ÜÊâÄÊúâ category ‰∏≠ÁöÑÊñπÊ≥ïÊãºÊé•Âà∞‰∫Ü‰∏Ä‰∏™Â§ßÁöÑ‰∫åÁª¥Êï∞ÁªÑ‰∏≠ÔºåÊï∞ÁªÑÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÈÉΩÊòØË£ÖÊúâ‰∏Ä‰∏™ category ÊâÄÊúâÊñπÊ≥ïÁöÑÂÆπÂô®„ÄÇ ÁºñËØëÂ•Ω‰πãÂêé ivar ÁöÑÁªìÊûÑÂ∞±Â∑≤ÁªèÂõ∫ÂÆö‰∫ÜÔºåÂèØ‰ª•ÈÄöËøáÂÅèÁßªÂú∞ÂùÄÊù•Áõ¥Êé•Ëé∑ÂèñÊàêÂëòÂèòÈáè„ÄÇ‰ΩÜÊòØÂØπ‰∫éÊñπÊ≥ïÔºåÂÆÉÂú® Macho-O ‰∏≠Âè™‰øùÂ≠ò‰∫Ü class_ro_t ÁöÑÈÉ®ÂàÜÔºåÂú® runtime ÂàùÂßãÂåñÁöÑÊó∂ÂÄôÔºå‰ºöÈÄöËøá runtime Âà∞ mach-o ‰∏≠ÁöÑ __data,_objc_catlist ‰∏≠ÂèñÂá∫ÊâÄÊúâÁöÑÂàÜÁ±ª‰ø°ÊÅØÔºåÁÑ∂ÂêéÂ∞ÜÂàÜÁ±ª‰∏≠ÁöÑÊñπÊ≥ïÂ±ûÊÄßÂíåÂçèËÆÆÊèíÂà∞ class_rw_t ÁöÑÊï∞ÁªÑ‰∏≠Ôºàclass_rw_t Â∫îËØ•ÊòØ‰øùÂ≠òÂú®Â†Ü‰∏äÁöÑÔºâÔºåÂÆÉÁöÑÂêÑ‰∏™Â±ûÊÄßÊòØÊåáÂêë data ÊÆµÁöÑ„ÄÇ Âõ†‰∏∫ class_rw_t ÊòØÂ†Ü‰∏äÁöÑÔºåÂÆÉÁöÑÂ±ûÊÄßÊñπÊ≥ïÂàóË°®ÊòØ‰∏Ä‰∏™‰∫åÁª¥Êï∞ÁªÑÔºåÂèØ‰ª•Â∞Ü data ÊÆµ‰∏≠ÁöÑÂêÑ‰∏™ÊñπÊ≥ïÊï∞ÁªÑÊ∑ªÂä†Âà∞Ëøô‰∏™‰∫åÁª¥Êï∞ÁªÑ‰∏≠ÔºåÂπ∂‰∏î class_addMethod ‰πüÂèØ‰ª•Áî®Áõ∏ÂêåÁöÑÊñπÊ≥ïÊ∑ªÂä†Âà∞‰∫åÁª¥Êï∞ÁªÑÈáåÔºåÊâÄ‰ª•ÊñπÊ≥ïÊòØÂèØ‰ª•Âä®ÊÄÅÊ∑ªÂä†ÁöÑ„ÄÇ ‰ΩÜÊòØÊàêÂëòÂèòÈáèÊòØ‰øùÂ≠òÂú® class_ro_t ‰∏≠ÁöÑÔºåÂÆÉÊòØ‰øùÂ≠òÂú® data ÊÆµ‰∏≠ÊúâÂõ∫ÂÆöÁöÑÁ©∫Èó¥ÁöÑÔºåÊó†Ê≥ïÊâ©Â§ß„ÄÇÂõ†Ê≠§ÊàêÂëòÂèòÈáèÊó†Ê≥ïÂä®ÊÄÅÊ∑ªÂä†„ÄÇ Âè¶Â§ñÈúÄË¶ÅÊ≥®ÊÑè‰∏ÄÁÇπÔºå‰∏çÊòØÊâÄÊúâÂàÜÁ±ªÈÉΩÊòØÊîæÂà∞ __data,_objc_catlist ‰∏≠ÁöÑ„ÄÇÂ¶ÇÊûúÊòØËá™Â∑±ÁöÑÁ±ªÁöÑÂàÜÁ±ªÔºåÁºñËØëÂêéÁõ¥Êé•Â∞±ÊääÊñπÊ≥ïÂíåÂéüÂßãÁ±ªÁöÑÊñπÊ≥ï‰∏¢Âú®‰∏ÄËµ∑‰∫Ü„ÄÇÂ¶ÇÊûúÊòØÂÖ∂‰ªñÂä®ÊÄÅÂ∫ìÁöÑÂàÜÁ±ªÔºåÊØîÂ¶ÇÁªô UIViewController ÂàõÂª∫‰∏Ä‰∏™ÂàÜÁ±ªÔºåÈÇ£‰πàÊòØ‰ºö‰øùÂ≠òÂú® __data,_objc_catlist ÊÆµ‰∏≠ÔºåÈÄöËøá runtime Âä®ÊÄÅÊ∑ªÂä†Áªô UIViewControllerÁöÑ„ÄÇ Âú® while Âæ™ÁéØÂ§ñÔºåÊàë‰ª¨ÂæóÂà∞‰∫ÜÊãºÊé•ÊàêÁöÑÊñπÊ≥ïÔºåÊ≠§Êó∂ÈúÄË¶Å‰∏éÁ±ªÂéüÊù•ÁöÑÊñπÊ≥ïÂêàÂπ∂:12auto rw = cls-&gt;data();rw-&gt;methods.attachLists(mlists, mcount); rw ÊòØ‰∏Ä‰∏™ class_rw_tÁ±ªÂûãÁöÑÁªìÊûÑ‰ΩìÊåáÈíà„ÄÇÊ†πÊçÆ runtime ‰∏≠ÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÂÆÉÊúâ‰∏Ä‰∏™ methods ÁªìÊûÑ‰ΩìÊàêÂëòÔºåÂπ∂‰ªéÁà∂Á±ªÁªßÊâø‰∫Ü attachLists ÊñπÊ≥ïÔºåÁî®Êù•ÂêàÂπ∂ category ‰∏≠ÁöÑÊñπÊ≥ï:123456789void attachLists(List* const * addedLists, uint32_t addedCount) &#123; if (addedCount == 0) return; uint32_t oldCount = array()-&gt;count; uint32_t newCount = oldCount + addedCount; setArray((array_t *)realloc(array(), array_t::byteSize(newCount))); array()-&gt;count = newCount; memmove(array()-&gt;lists + addedCount, array()-&gt;lists, oldCount * sizeof(array()-&gt;lists[0])); memcpy(array()-&gt;lists, addedLists, addedCount * sizeof(array()-&gt;lists[0]));&#125; ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÊó†ËÆ∫ÊâßË°åÂì™ÁßçÈÄªËæëÔºåÂèÇÊï∞ÂàóË°®‰∏≠ÁöÑÊñπÊ≥ïÈÉΩ‰ºöË¢´Ê∑ªÂä†Âà∞‰∫åÁª¥Êï∞ÁªÑÁöÑÂâçÈù¢„ÄÇÂõ†Ê≠§ category ‰∏≠ÂÆö‰πâÁöÑÂêåÂêçÊñπÊ≥ï‰∏ç‰ºöÊõøÊç¢Á±ª‰∏≠ÂéüÊúâÁöÑÊñπÊ≥ïÔºå‰ΩÜÊòØÂØπÂéüÊñπÊ≥ïÁöÑË∞ÉÁî®ÂÆûÈôÖ‰∏ä‰ºöË∞ÉÁî® category ‰∏≠ÁöÑÊñπÊ≥ï„ÄÇ load ÊñπÊ≥ïÁöÑÊâßË°å+load ÊñπÊ≥ïÂú® Class Âíå Category ‰∏≠ÈÉΩ‰ºöÊúâ‰∏Ä‰∏™Êï∞ÁªÑ‰øùÂ≠ò„ÄÇÂú® runtime load_image ÁöÑÊó∂ÂÄôÔºå‰ºö‰∏ÄÊ¨°Ë∞ÉÁî® Class Âíå Category ÁöÑ load ÊñπÊ≥ï„ÄÇ load ÊñπÊ≥ïÁöÑË∞ÉÁî®È°∫Â∫èÊòØÂÖàË∞ÉÁî®Áà∂Á±ªÁöÑÂÜçË∞ÉÁî®Â≠êÁ±ªÁöÑÔºåÂÖàË∞ÉÁî® Class ÁöÑÔºåÂÜçË∞ÉÁî® Category ÁöÑ„ÄÇ Âíå +initialize ÊñπÊ≥ïÁöÑÂºÇÂêå +load ÊñπÊ≥ï‰ºöË¢´ÁâπÊÆäÂØπÂæÖÂÖ®ÈÉ®ÊâßË°åÔºåËÄå +initialize ÊñπÊ≥ïÂàôÂè™‰ºöÂÉèÊôÆÈÄöÊñπÊ≥ï‰∏ÄÊ†∑‰ºöË¢´ÂàÜÁ±ªË¶ÜÁõñ„ÄÇ +initialize ÊñπÊ≥ïÂú®Á±ª‰º†ÈÄíÁ¨¨‰∏Ä‰∏™Ê∂àÊÅØ‰πãÂâçÊâßË°å„ÄÇ+load Âú®ÂàÜÁ±ªÊ∑ªÂä†Âà∞ runtime Êó∂ÊâßË°å„ÄÇ +initialize ÊñπÊ≥ïÂÖàÊâßË°åÁà∂Á±ªÊñπÊ≥ïÔºåÂÜçÊâßË°åÂ≠êÁ±ªÊñπÊ≥ï„ÄÇ+load ‰πüÊòØËøôÊ†∑ ÈóÆÈ¢ò ‰ªÄ‰πàÊòØÊ∂àÊÅØÊú∫Âà∂Ôºü id ÊòØ‰∏™‰ªÄ‰πàÁ±ªÂûãÔºü isa ÊòØ‰∏™‰ªÄ‰πàÁ±ªÂûãÔºü objc_class ‰∏≠ÁöÑ isa ÊåáÂêë‰ªÄ‰πàÔºüÊúâ‰ªÄ‰πàÁî®Ôºü Â≠êÁ±ªÔºåÁà∂Á±ªÔºåNSObjectÔºå‰πãÈó¥ super class ‰∏é isa ÊåáÂêëÁöÑÂÖ≥Á≥ªÂõæÊòØÊÄéÊ†∑Ôºü objc_msgSend ÁöÑÊâßË°åËøáÁ®ãÔºü ‰∏∫‰ªÄ‰πàË∞ÉÁî® [super class] ËøòÊòØËøîÂõûÁöÑËøòÊòØ self ÁöÑÁ±ªÂêçÔºü category ‰∏∫‰ªÄ‰πàÂè™ËÉΩÂ≠òÊñπÊ≥ïÔºå‰∏çËÉΩÂ≠òÂÆû‰æãÂèòÈáèÔºü category ‰ºöÊõøÊç¢ÂéüÊù•ÁöÑÊñπÊ≥ïÂêóÔºü Âä®ÊÄÅÊñπÊ≥ïËß£Êûê‰∏éÊ∂àÊÅØËΩ¨ÂèëÁöÑ‰∏âÊ≠•ÂêÑÊòØ‰ªÄ‰πà‰ΩúÁî®Ôºü ËΩ¨ÂèëÂíåÂ§öÁªßÊâøÊúâ‰ªÄ‰πàÂÖ≥Á≥ªÔºü runtimeÁöÑ‰∏ÄÁØáËæÉÂ•ΩÁöÑÂèÇËÄÉËµÑÊñô]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Runtime</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iosÊ†∏ÂøÉÂä®Áîª]]></title>
    <url>%2F2016%2F08%2F16%2Fios%E5%8A%A8%E7%94%BB%2F</url>
    <content type="text"><![CDATA[Âä®ÁîªÁõ∏ÂÖ≥ÁöÑÊÄªÁªì ËßÜÂõæÂä®ÁîªUIViewÂä®ÁîªÈ¶ñÂ∞æÂºèÂä®ÁîªÊâßË°åÂä®ÁîªÊâÄÈúÄË¶ÅÁöÑÂ∑•‰ΩúÁî±UIViewÁ±ªËá™Âä®ÂÆåÊàêÔºå‰ΩÜ‰ªçË¶ÅÂú®Â∏åÊúõÊâßË°åÂä®ÁîªÊó∂ÈÄöÁü•ËßÜÂõæÔºå‰∏∫Ê≠§ÈúÄË¶ÅÂ∞ÜÊîπÂèòÂ±ûÊÄßÁöÑ‰ª£Á†ÅÊîæÂú® [UIView beginAnimations:nil context:nil] Âíå [UIView commitAnimations] ‰πãÈó¥„ÄÇ Â∏∏ËßÅÊñπÊ≥ïÔºö 1234567891011121314// Âä®ÁîªÂºÄÂßãÊó∂Ë∞ÉÁî®+ (void)setAnimationWillStartSelector:(SEL)selector// Âä®ÁîªÁªìÊùüÊó∂Ë∞ÉÁî®+ (void)setAnimationDidStopSelector:(SEL)selector// Âä®ÁîªÁöÑÊåÅÁª≠Êó∂Èó¥+ (void)setAnimationDuration:(NSTimeInterval)duration// Âä®ÁîªÂª∂ËøüdelayÁßíÂêéÂÜçÂºÄÂßã+ (void)setAnimationDelay:(NSTimeInterval)delay// Âä®ÁîªÂä†ÈÄüÂáèÈÄüÊïàÊûú+ (void)setAnimationCurve:(UIViewAnimationCurve)curve// Âä®ÁîªËá™Âä®ÂèçÂêëÂõûÂà∞ÂéüÊù•‰ΩçÁΩÆ+ (void)setAnimationRepeatAutoreverses:(BOOL)repeatAutoreverses// Âä®ÁîªÈáçÂ§çÊ¨°Êï∞+ (void)setAnimationRepeatCount:(float)repeatCount block Âä®Áîª1234// ÊôÆÈÄöÁöÑÂä®Áîª+ (void)animateWithDuration:(NSTimeInterval)duration animations:(void (^)(void))animations completion:(void (^)(BOOL finished))completion;// Â∏¶ÈòªÂ∞ºÁöÑÂä®Áîª+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay usingSpringWithDamping:(CGFloat)dampingRatio initialSpringVelocity:(CGFloat)velocity options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^)(BOOL finished))completion; Á§∫‰æã12345678//È¶ñÂ∞æÂºèÂä®Áîª[UIView beginAnimations:nil context:nil];//ËÆæÁΩÆÂä®ÁîªÊâßË°åÊó∂Èó¥[UIView setAnimationDuration:2.0];//ËÆæÁΩÆÂä®ÁîªÊâßË°åÂÆåÊØïË∞ÉÁî®ÁöÑ‰∫ã‰ª∂[UIView setAnimationDidStopSelector:@selector(didStopAnimation)];self.customView.center=CGPointMake(200, 300);[UIView commitAnimations]; Ê≥®ÊÑèÁÇπÔºö UIView ÁöÑÂä®ÁîªÂú®ÂºÄÂßãÁöÑÊó∂ÂÄôÔºåÂÆÉÁöÑ frame Â∞±Â∑≤ÁªèÂà∞‰∫ÜÁõÆÁöÑ‰ΩçÁΩÆÔºåËøêÂä®ÁöÑÂè™ÊòØ UIView ÁöÑ layer„ÄÇÂõ†Ê≠§ÔºåÂú® UIView ÊâßË°åÂä®ÁîªÁöÑÊó∂ÂÄôÔºåËøêÂä®‰∏≠ÁöÑËßÜÂõæÊòØÊó†Ê≥ïÁõ∏Â∫îÁÇπÂáª‰∫ã‰ª∂ÁöÑ„ÄÇÂõ†Ê≠§ÔºåÂ¶ÇÊûúË¶ÅËßÜÂõæËÉΩÂ§üÁõ∏Â∫îÁÇπÂáª‰∫ã‰ª∂ÔºåÂ∞±ÈúÄË¶ÅÂú®ÂØªÊâæÁÇπÂáªÂìçÂ∫îËÄÖÁöÑÊó∂ÂÄôÔºåÂà§Êñ≠ÁÇπÂáªÁöÑÁÇπÊòØÂê¶Âú® UIView ÁöÑ layer ÁöÑ frame Èáå„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718// ËÆæÁΩÆÂä®Áîª[UIView animateKeyframesWithDuration:20 delay:0 options:UIViewKeyframeAnimationOptionAllowUserInteraction animations:^&#123; self.btn.frame = CGRectMake(100, 300, 100, 100); &#125; completion:^(BOOL finished) &#123; NSLog(@"xly--%@",@"finished"); ret = YES; &#125;];// ÁÇπÂáª‰∫ã‰ª∂ÂØªÊâæÁ¨¨‰∏ÄÂìçÂ∫îËÄÖÁöÑÊñπÊ≥ï„ÄÇÂà§Êñ≠ÁÇπÂáªÂùêÊ†á p ÊòØÂê¶Âú® self.layer.presentationLayer ‰∏≠- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event &#123; if (self.animationAllowUserInteraction) &#123; CGPoint p = [self convertPoint:point toView:self.superview]; if ([self.layer.presentationLayer hitTest:p]) &#123; return YES; &#125; &#125; return [super pointInside:point withEvent:event];&#125; UIView ÂÖ≥ÈîÆÂ∏ßÂä®ÁîªÂÖ≥ÈîÆÂ∏ßÂä®Áîª‰ΩøÁî® block ÊâßË°å„ÄÇÂåÖÂê´‰∫ÜÂá†‰∏™ÂøÖË¶ÅÂ±ûÊÄßÔºö 12345[UIView animateKeyframesWithDuration:1 delay:0.5 options:UIViewKeyframeAnimationOptionCalculationModeLinear animations:^&#123; self.imageView.frame = CGRectMake(0, 0, 100, 100);&#125; completion:^(BOOL finished) &#123; NSLog(@"ÁªìÊùü‰∫Ü");&#125;]; Êó¢ÁÑ∂ÊòØÂÖ≥ÈîÆÂ∏ßÂä®ÁîªÔºåÈÇ£‰πàËÇØÂÆöÊòØËÉΩÂ¢ûÂä†Â∏ßÁöÑ„ÄÇÂú®ÂéüÊú¨ÊâßË°åÂä®ÁîªÁöÑÊñπÊ≥ï‰∏≠ÈÄöËøáÂ¢ûÂä†Â∏ßÔºö 12345678910111213[UIView animateKeyframesWithDuration:1 delay:0.5 options:UIViewKeyframeAnimationOptionCalculationModeLinear animations:^&#123; [UIView addKeyframeWithRelativeStartTime:0.3 relativeDuration:0.3 animations:^&#123; self.imageView.frame = CGRectMake(0, 0, 100, 100); &#125;]; [UIView addKeyframeWithRelativeStartTime:0.3 relativeDuration:0.3 animations:^&#123; self.imageView.frame = CGRectMake(100, 100, 200, 200); &#125;]; &#125; completion:^(BOOL finished) &#123; NSLog(@"ÁªìÊùü‰∫Ü");&#125;]; CALayer ÂÖ≥ÈîÆÂ∏ßÂä®ÁîªCALayer ÁöÑÂä®ÁîªÂÖ∂ÂÆûÂèØ‰ª•Áî® UIView ÁöÑÂä®ÁîªÊù•‰ª£Êõø„ÄÇ‰∏çËøá CALayer ÁöÑÂÖ≥ÈîÆÂ∏ßÂä®ÁîªÂèØ‰ª•ËÆ©ËßÜÂõæÊ≤øÁùÄÊåáÂÆöË∑ØÂæÑÁßªÂä® ÂèÇÊï∞ÂΩ¢Âºè123456789101112131415//Ê†πÊçÆvaluesÁßªÂä®ÁöÑÂä®ÁîªCAKeyframeAnimation *catKeyAnimation = [CAKeyframeAnimation animationWithKeyPath:@"position"];CGPoint originalPoint = self.catImageView.layer.frame.origin;CGFloat distance = 50;NSValue *value1 = [NSValue valueWithCGPoint:CGPointMake(originalPoint.x + distance, originalPoint.y + distance)];NSValue *value2 = [NSValue valueWithCGPoint:CGPointMake(originalPoint.x + 2 * distance, originalPoint.y + distance)];NSValue *value3 = [NSValue valueWithCGPoint:CGPointMake(originalPoint.x + 2 * distance, originalPoint.y + 2 * distance)];NSValue *value4 = [NSValue valueWithCGPoint:originalPoint];catKeyAnimation.values = @[value4, value1, value2, value3, value4];catKeyAnimation.duration = 2;catKeyAnimation.repeatCount = MAXFLOAT;catKeyAnimation.removedOnCompletion = NO;[self.catImageView.layer addAnimation:catKeyAnimation forKey:nil]; Ë∑ØÂæÑÂΩ¢Âºè1234567891011121314151617181920212223242526-(void)pathAnimation2 &#123; //ÂàõÂª∫path UIBezierPath *path = [UIBezierPath bezierPath]; //ËÆæÁΩÆÁ∫øÂÆΩ path.lineWidth = 3; //Á∫øÊù°ÊãêËßí path.lineCapStyle = kCGLineCapRound; //ÁªàÁÇπÂ§ÑÁêÜ path.lineJoinStyle = kCGLineJoinRound; //Â§öÊù°Áõ¥Á∫ø [path moveToPoint:(CGPoint)&#123;0, SCREEN_HEIGHT/2-50&#125;]; [path addLineToPoint:(CGPoint)&#123;SCREEN_WIDTH/3, SCREEN_HEIGHT/2-50&#125;]; [path addLineToPoint:(CGPoint)&#123;SCREEN_WIDTH/3, SCREEN_HEIGHT/2+50&#125;]; [path addLineToPoint:(CGPoint)&#123;SCREEN_WIDTH*2/3, SCREEN_HEIGHT/2+50&#125;]; [path addLineToPoint:(CGPoint)&#123;SCREEN_WIDTH*2/3, SCREEN_HEIGHT/2-50&#125;]; [path addLineToPoint:(CGPoint)&#123;SCREEN_WIDTH, SCREEN_HEIGHT/2-50&#125;];// [path closePath]; CAKeyframeAnimation *anima = [CAKeyframeAnimation animationWithKeyPath:@"position"]; anima.path = path.CGPath; anima.duration = 2.0f; anima.fillMode = kCAFillModeForwards; anima.removedOnCompletion = NO; anima.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]; [_demoView.layer addAnimation:anima forKey:@"pathAnimation"];&#125; ËΩ¨Âú∫Âä®Áîª ËΩ¨Âú∫Âä®ÁîªÂ∞±ÊòØÂ∞±ÊòØÊää‰∏ã‰∏Ä‰∏™ÊòæÁ§∫ÁöÑÊó∂ÂàªÁöÑÁïåÈù¢Êà™‰∫Ü‰∏™ÂõæÔºåÁÑ∂ÂêéÂÅöËΩ¨Âú∫„ÄÇ Á§∫‰æãÔºö 1234567891011121314// ÂÖàËÆæÁΩÆ‰∏ã‰∏Ä‰∏™Âú∫ÊôØself.iconView.image=[UIImage imageNamed: [NSString stringWithFormat:@"%d.jpg",self.index]];//ÂàõÂª∫Ê†∏ÂøÉÂä®ÁîªCATransition *ca=[CATransition animation];//ÂëäËØâË¶ÅÊâßË°å‰ªÄ‰πàÂä®Áîª//ËÆæÁΩÆËøáÂ∫¶ÊïàÊûúca.type=@"cube";//ËÆæÁΩÆÂä®ÁîªÁöÑËøáÂ∫¶ÊñπÂêëÔºàÂêëÂ∑¶Ôºâca.subtype=kCATransitionFromLeft;//ËÆæÁΩÆÂä®ÁîªÁöÑÊó∂Èó¥ca.duration=2.0;//Ê∑ªÂä†Âä®Áîª[self.iconView.layer addAnimation:ca forKey:nil];]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Animation</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CALayerÂ≠¶‰π†Â∞èÁªì]]></title>
    <url>%2F2016%2F08%2F12%2FCALayer%E5%AD%A6%E4%B9%A0%E5%B0%8F%E7%BB%93%2F</url>
    <content type="text"><![CDATA[Ëøô‰∏§Â§©ÊÉ≥Â§ßËá¥Â≠¶‰π†‰∏ãanimationÁöÑ‰ΩøÁî®ÊñπÊ≥ï„ÄÇÁúã‰∫ÜÊñáÈ°∂È°∂ÁöÑiosÂºÄÂèëUIÁØá‰∏ìÈ¢òÔºåÂÜôÁöÑÂæàÂ•ΩÔºåÂ≠¶‰π†‰∫ÜÂæàÂ§ö„ÄÇÂÜçÊëòÂΩïÈÉ®ÂàÜÔºå‰ª•‰ΩúÂ§áÂøò„ÄÇ CALayerÁÆÄ‰ªãÁÆÄ‰ªãUIView‰πãÊâÄ‰ª•ËÉΩÊòæÁ§∫Âú®Â±èÂπï‰∏äÔºåÂõ†‰∏∫ÂÜÖÈÉ®ÁöÑlayer„ÄÇÂàõÂª∫UIViewÁöÑÊó∂ÂÄôËá™Âä®ÂàõÂª∫CALayerÂØπË±°„ÄÇUIViewÊú¨Ë∫´‰∏çÂÖ∑Â§áÊòæÁ§∫ÁöÑÂäüËÉΩÔºåÊã•ÊúâÊòæÁ§∫ÂäüËÉΩÁöÑÊòØÂÆÉÂÜÖÈÉ®ÁöÑÂõæÂ±Ç„ÄÇ Âü∫Êú¨Â±ûÊÄßÈÄöËøáÊìç‰ΩúËøô‰∏™CALayerÂØπË±°ÔºåÂèØ‰ª•ÂæàÊñπ‰æøÂú∞Ë∞ÉÊï¥UIViewÁöÑ‰∏Ä‰∫õÁïåÈù¢Â±ûÊÄßÔºåÊØîÂ¶ÇÔºöÈò¥ÂΩ±„ÄÅÂúÜËßíÂ§ßÂ∞è„ÄÅËæπÊ°ÜÂÆΩÂ∫¶ÂíåÈ¢úËâ≤Á≠â„ÄÇ1234567891011121314151617181920212223242526//ËÆæÁΩÆËæπÊ°ÜÁöÑÂÆΩÂ∫¶‰∏∫20self.customView.layer.borderWidth=20;//ËÆæÁΩÆËæπÊ°ÜÁöÑÈ¢úËâ≤(borderColorÊòØCGColorÁ±ªÂûã)self.customView.layer.borderColor=[UIColor greenColor].CGColor;//ËÆæÁΩÆlayerÁöÑÂúÜËßíself.customView.layer.cornerRadius=20;//ËÆæÁΩÆË∂ÖËøáÂ≠êÂõæÂ±ÇÁöÑÈÉ®ÂàÜË£ÅÂáèÊéâself.iconView.layer.masksToBounds=YES;//Âú®viewÁöÑÂõæÂ±Ç‰∏äÊ∑ªÂä†‰∏Ä‰∏™imageÔºåcontentsË°®Á§∫Êé•ÂèóÂÜÖÂÆπself.customView.layer.contents=(id)[UIImage imageNamed:@"cat"].CGImage;//ËÆæÁΩÆÈò¥ÂΩ±ÁöÑÈ¢úËâ≤self.customView.layer.shadowColor=[UIColor blackColor].CGColor;//ËÆæÁΩÆÈò¥ÂΩ±ÁöÑÂÅèÁßªÈáèÔºåÂ¶ÇÊûú‰∏∫Ê≠£Êï∞ÔºåÂàô‰ª£Ë°®‰∏∫ÂæÄÂè≥ËæπÂÅèÁßªself.customView.layer.shadowOffset=CGSizeMake(15, 5);//ËÆæÁΩÆÈò¥ÂΩ±ÁöÑÈÄèÊòéÂ∫¶(0~1‰πãÈó¥Ôºå0Ë°®Á§∫ÂÆåÂÖ®ÈÄèÊòé)self.customView.layer.shadowOpacity=0.6;//ÈÄöËøáuiviewËÆæÁΩÆÔºà2DÊïàÊûúÔºâself.customView.transform=CGAffineTransformMakeTranslation(0, -100);//ÈÄöËøálayerÊù•ËÆæÁΩÆÔºà3DÊïàÊûú,xÔºåyÔºåz‰∏â‰∏™ÊñπÂêëÔºâself.iconView.layer.transform=CATransform3DMakeTranslation(100, 20, 0);//ÊóãËΩ¨self.iconView.layer.transform=CATransform3DMakeRotation(M_PI_4, 1, 1, 0.5); Ê≥®ÊÑèÔºåËøôÈáåÁöÑÈ¢úËâ≤‰∏çÊòØ UIColor Á±ªÂûãÔºåËÄåÊòØ CGColor Á±ªÂûã„ÄÇÈúÄË¶Å‰ΩøÁî® [UIColor redColor].CGColor ÁöÑÊñπÂºèËé∑ÂèñÔºåËÄå‰∏çÊòØ‰ΩøÁî®Âº∫Âà∂ËΩ¨ÂûãÊää UIColor ËΩ¨‰∏∫ CGColor„ÄÇ positionÔºåanchorPointÔºåbounds ‰ª•Âèä frame ÁöÑÊ¶ÇÂøµ frame: Áî®Êù•ÊèèËø∞Ëá™Â∑±Âú®Áà∂ËßÜÂõæÁöÑ‰ΩçÁΩÆÔºåÂç≥ x y ÊòØÁõ∏ÂØπ‰∫éÁà∂ËßÜÂõæÁöÑËµ∑ÁÇπÁöÑ„ÄÇ bounds: ÊèèËø∞ÂΩìÂâçËßÜÂõæÁöÑÂ∑¶‰∏äËßíÁöÑÁõ∏ÂØπÂ≠êËßÜÂõæÁöÑÂùêÊ†áÔºå‰ª•ÂèäËßÜÂõæÂ§ßÂ∞èÁöÑ„ÄÇ‰∏ÄËà¨ bounds.origin ‰∏∫ (0, 0) ÔºåÂ¶ÇÊûúÊääÂÆÉÊîπ‰∏∫ (-50, 0)ÔºåÂ∞±Ë°®Á§∫Â∑¶‰∏äËßíÁöÑÂùêÊ†á‰∏∫ (-50, 0)ÔºåÁé∞Âú®Â≠êËßÜÂõæÁõ∏ÂØπÁöÑÂéüÁÇπÂùêÊ†áÂ∞±Âú®Â∑¶‰∏äËßíÂè≥Ëæπ 50 ÁöÑÂú∞Êñπ„ÄÇÊâÄ‰ª•Áõ∏ÂΩì‰∫éÊääÊâÄÊúâÂ≠êËßÜÂõæÂêëÂè≥ÁßªÂä® 50. position:ËÆæÁΩÆCALayerÂú®Áà∂Â±Ç‰∏≠ÁöÑ‰ΩçÁΩÆÔºåËøô‰∏™‰ΩçÁΩÆ‰ºöÂíåÈîöÁÇπÈáçÂêà„ÄÇ anchorPoint:ÂÜ≥ÂÆöÁùÄCALayerË∫´‰∏äÁöÑÂì™‰∏™ÁÇπ‰ºöÂú®positionÂ±ûÊÄßÊâÄÊåáÁöÑ‰ΩçÁΩÆ„ÄÇ‰ª•Ëá™Â∑±ÁöÑÂ∑¶‰∏äËßí‰∏∫ÂéüÁÇπ(0, 0)ÔºåÂÆÉÁöÑx„ÄÅyÂèñÂÄºËåÉÂõ¥ÈÉΩÊòØ0~1ÔºåÈªòËÆ§ÂÄº‰∏∫Ôºà0.5, 0.5Ôºâ„ÄÇlayer ÁöÑÁº©ÊîæÂíåÊóãËΩ¨ÔºåÈÉΩÊòØ‰ª• anchorPoint ‰∏∫ÂéüÁÇπÁöÑ„ÄÇ positionÔºåanchorpoint Âíå bounds ÂÖ±ÂêåÂÜ≥ÂÆö‰∫ÜËßÜÂõæÁöÑ frame„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåframe ÁöÑÂ§ßÂ∞èÁ≠â‰∫é bounds ÁöÑÂ§ßÂ∞èÔºå‰ΩÜÊòØÂ¶ÇÊûúËßÜÂõæÊóãËΩ¨‰∫ÜÔºåframe ‰ºöÂèò‰∏∫ÊóãËΩ¨ËßÜÂõæÁöÑÂ§ñÁïåÁü©ÂΩ¢ÁöÑÂ§ßÂ∞è„ÄÇ Â¶ÇÊûúÊàë‰ª¨ÊÉ≥ÁßªÂä®‰∏Ä‰∏™ËßÜÂõæÁöÑÊâÄÊúâÂ≠êËßÜÂõæÔºåÂèØ‰ª•‰øÆÊîπ bonuds.orgin„ÄÇ‰∏çËøáÊàë‰ª¨‰πüÂèØ‰ª•Âú®ËßÜÂõæ‰∏äÊ∑ªÂä†‰∏Ä‰∏™ contentViewÔºåÁÑ∂ÂêéÁßªÂä®ÂÆÉÁöÑ frame„ÄÇ ÈöêÂºèÂä®ÁîªÊØè‰∏™ViewÂÜÖÈÉ®ÈÉΩÂÖ≥ËÅîÁùÄ‰∏Ä‰∏™Root Layer„ÄÇÊâÄÊúâÈùûrootlayerÈÉΩÂ≠òÂú®ÁùÄÈöêÂºèÂä®Áîª„ÄÇÈöêÂºèÂä®ÁîªÂ∞±ÊòØÂØπ‰∫élayerÁöÑÈÉ®ÂàÜÂ±ûÊÄßËøõË°å‰øÆÊîπÊó∂ÔºåÈªòËÆ§‰ºö‰∫ßÁîüÁöÑ‰∏Ä‰∫õÂä®Áîª„ÄÇ Â∏∏ËßÅÁöÑÂä®ÁîªÂ±ûÊÄßÔºö boundsÔºöÁî®‰∫éËÆæÁΩÆCALayerÁöÑÂÆΩÂ∫¶ÂíåÈ´òÂ∫¶„ÄÇ‰øÆÊîπËøô‰∏™Â±ûÊÄß‰ºö‰∫ßÁîüÁº©ÊîæÂä®Áîª backgroundColorÔºöÁî®‰∫éËÆæÁΩÆCALayerÁöÑËÉåÊôØËâ≤„ÄÇ‰øÆÊîπËøô‰∏™Â±ûÊÄß‰ºö‰∫ßÁîüËÉåÊôØËâ≤ÁöÑÊ∏êÂèòÂä®Áîª positionÔºöÁî®‰∫éËÆæÁΩÆCALayerÁöÑ‰ΩçÁΩÆ„ÄÇ‰øÆÊîπËøô‰∏™Â±ûÊÄß‰ºö‰∫ßÁîüÂπ≥ÁßªÂä®Áîª ÂàõÂª∫ÂõæÂ±Ç12345678910111213141516171819202122- (void)viewDidLoad&#123; [super viewDidLoad]; //ÂàõÂª∫‰∏Ä‰∏™layer CALayer *Mylayer=[CALayer layer]; //ËÆæÁΩÆlayerÁöÑÂ±ûÊÄß Mylayer.bounds=CGRectMake(100, 100, 100, 100); Mylayer.position=CGPointMake(100, 100); //ËÆæÁΩÆÈúÄË¶ÅÊòæÁ§∫ÁöÑÂõæÁâá Mylayer.contents=(id)[UIImage imageNamed:@"me"].CGImage; //ËÆæÁΩÆÂúÜËßíÂçäÂæÑ‰∏∫10 Mylayer.cornerRadius=10; //Â¶ÇÊûúËÆæÁΩÆ‰∫ÜÂõæÁâáÔºåÈÇ£‰πàÈúÄË¶ÅËÆæÁΩÆËøô‰∏™Â±ûÊÄß‰∏∫YESÊâçËÉΩÊòæÁ§∫ÂúÜËßíÊïàÊûú Mylayer.masksToBounds=YES; //ËÆæÁΩÆËæπÊ°Ü Mylayer.borderWidth=3; Mylayer.borderColor=[UIColor brownColor].CGColor; //ÊäälayerÊ∑ªÂä†Âà∞ÁïåÈù¢‰∏ä [self.view.layer addSublayer:Mylayer];&#125; ÊÄªÁªìÂØπÊØîCALayerÔºåUIViewÂ§ö‰∫Ü‰∏Ä‰∏™‰∫ã‰ª∂Â§ÑÁêÜÁöÑÂäüËÉΩ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåCALayer‰∏çËÉΩÂ§ÑÁêÜÁî®Êà∑ÁöÑËß¶Êë∏‰∫ã‰ª∂ÔºåËÄåUIViewÂèØ‰ª•„ÄÇÂ¶ÇÊûúÊòæÁ§∫Âá∫Êù•ÁöÑ‰∏úË•øÈúÄË¶ÅË∑üÁî®Êà∑ËøõË°å‰∫§‰∫íÁöÑËØùÔºåÁî®UIViewÔºõÂ¶ÇÊûú‰∏çÈúÄË¶ÅË∑üÁî®Êà∑ËøõË°å‰∫§‰∫íÔºåÁî®UIViewÊàñËÄÖCALayerÈÉΩÂèØ‰ª• UIViewÁöÑtransformÂ±ûÊÄßtransformÊòØviewÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÂ±ûÊÄß,ÂÆÉÂú®Áü©ÈòµÂ±ÇÈù¢‰∏äÊîπÂèòviewÁöÑÊòæ‚Ω∞Áä∂ÊÄÅ,ËÉΩÂÆûÁé∞viewÁöÑÁº©Êîæ„ÄÅÊóãËΩ¨„ÄÅÂπ≥ÁßªÁ≠âÂäüËÉΩ„ÄÇtransformÊòØCGAffineTransformÁ±ªÂûãÁöÑ„ÄÇ transformÁªìÊûÑtransformÊòØ‰∏Ä‰∏™CGAffineTransformÁ±ªÂûãÔºåÁªìÊûÑÂ¶Ç‰∏ãÔºö 1234struct CGAffineTransform &#123; CGFloat a, b, c, d; CGFloat tx, ty;&#125;; CGAffineTransformÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™Áü©Èòµ 123| a, b, 0 || c, d, 0 || tx, ty, 1 | Áî±‰∫étransformÂè™Êúâ‰∏§Áª¥ÔºåÈúÄË¶Å‰∏Ä‰∏™3Èò∂Áü©ÈòµÊù•Ë°®Á§∫ÂÖ∂Áº©Êîæ‰ª•ÂèäÂπ≥ÁßªÁöÑÂèòÂåñ„ÄÇ ÂùêÊ†áÂèòÊç¢ËøáÁ®ãÔºö 12345678 | a, b, 0 |&#123;x',y',1&#125;=&#123;x,y,1&#125; x | c, d, 0 | | tx, ty, 1 | ==&gt;xn=ax+cy+tx;yn=bx+dy+ty; Ëøô‰∏™Áü©ÈòµÁöÑÁ¨¨‰∏âÂàóÊòØÂõ∫ÂÆöÁöÑÔºåÊâÄ‰ª•ÊØèÊ¨°ÂèòÊç¢Êó∂ÔºåÂè™ÈúÄ‰º†ÂÖ•Ââç‰∏§ÂàóÁöÑÂÖ≠‰∏™ÂèÇÊï∞[a,b,c,d,tx,ty]Âç≥ÂèØ„ÄÇ transformÊñπÊ≥ïÂú®CGAffineTransformÁöÑÁîüÊàêÂáΩÊï∞‰∏≠ÔºåÂ§ßÂ§öÊòØ‰∏§‰∏§ÂØπÂ∫îÁöÑÔºå‰∏Ä‰∏™Â∏¶makeÂ≠óÊ†∑Ôºå‰∏Ä‰∏™‰∏çÂ∏¶„ÄÇÂ∏¶makeÂ≠óÊ†∑ÁöÑÊòØÁõ¥Êé•ÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑCGAffineTransformÔºå‰∏çÂ∏¶makeÂ≠óÊ†∑ÁöÑÂàôÊòØÂú®‰∏Ä‰∏™CGAffineTransformÁöÑÂü∫Á°Ä‰∏äÁîüÊàêÊñ∞ÁöÑ„ÄÇÂáΩÊï∞ËøîÂõûÂÄºÂùáÊòØCGAffineTransformÁ±ªÂûã„ÄÇ Â§ö‰∏™CGAffineTransformÂØπË±°ËµãÁªôviewÔºåÊúÄÁªàÂè™ÊâßË°åÊúÄÂêé‰∏Ä‰∏™Âä®ÁîªÔºåÂ§ö‰∏™Âä®ÁîªÈúÄË¶ÅÁªÑÂêàÂú®‰∏ÄËµ∑„ÄÇ scaleÂÆûÁé∞ÁöÑÊòØÊîæÂ§ßÂíåÁº©Â∞è: 123CGAffineTransformScale(CGAffineTransform t, CGFloat sx, CGFloat sy)ÔºõCGAffineTransformMakeScale(CGFloat sx, CGFloat sy)Ôºõ ÁîüÊàêÊñ∞ÁöÑtransformÁõ∏ÂΩì‰∫éÂ∞Üt&#39; = [sx Ôºå0 Ôºå0Ôºåsy Ôºå0Ôºå 0]ËøôÂÖ≠‰∏™ÂèÇÊï∞‰ª£ÂÖ•Áü©Èòµ‰∏≠,Âç≥ÊîπÂèòaÂíåd„ÄÇ rotateÂÆûÁé∞ÁöÑÊòØÊóãËΩ¨Ôºö 123CGAffineTransformRotate(CGAffineTransform t, CGFloat angle)CGAffineTransformMakeRotation(CGFloat angle)Ôºõ angle‰∏∫ËßíÂ∫¶Ôºåangle=œÄÂàôÊóãËΩ¨180Â∫¶„ÄÇÁü©ÈòµÁöÑÂÖ≠‰∏™ÂèÇÊï∞‰∏∫t&#39; = [ cos(angle)Ôºåsin(angle)Ôºå-sin(angle)Ôºåcos(angle) 0Ôºå0]Ôºõ translateÂÆûÁé∞ÁöÑÊòØÂπ≥ÁßªÔºö 1234CGAffineTransformTranslate(CGAffineTransform t, CGFloat tx, CGFloat ty)ÔºõCGAffineTransformMakeTranslation(CGFloat tx, CGFloat ty)Ôºõ Áü©ÈòµÁöÑÂÖ≠‰∏™ÂèÇÊï∞‰∏∫t&#39; = [1Ôºå0Ôºå0Ôºå1ÔºåtxÔºåty] Ôºõ‰ª£ÂÖ•ÂÖ¨ÂºèÔºåxn=x+tx,yn=y+ty Â§çÂéü1view.transformÔºùCGAffineTransformIdentity; ‰∏äËø∞ÁöÑÂêÑÁßçÂä®ÁîªÁöÑÂèòÂåñÈÉΩÊòØ‰ª•ÂéüÂßãÂõæÂÉè‰∏∫Âü∫ÂáÜÁöÑÔºåËÄå‰∏çÊòØÂú®ÂèòÂåñÂêéÁªßÁª≠ÂèòÂåñ„ÄÇCGAffineTransformIdentityÂ∞Üview‰ªéÂΩìÂâçÁä∂ÊÄÅÂ§çÂéüÂõûviewÊúÄÂàùÂßãÁöÑÁä∂ÊÄÅ„ÄÇ ‰∏Ä‰∏™ÊäÄÂ∑ß„ÄÇÂ¶ÇÊûú‰ΩøÁî® AutoLayout ÁöÑËßÜÂõæË¶ÅÊ∑ªÂä†Âä®ÁîªÔºå‰∏ÄËà¨Êàë‰ª¨‰ºöÊääÁ∫¶ÊùüÊãñÂà∞‰ª£Á†Å‰∏≠ÔºåÁÑ∂ÂêéÂú®Âä®ÁîªÂâç‰øÆÊîπÁ∫¶ÊùüÔºåÂú®Âä®ÁîªÁöÑ block ‰∏≠Ë∞ÉÁî®ÂÖ∂Áà∂Êéß‰ª∂ÁöÑ layoutIfNeeded„ÄÇ ËøòÊúâ‰∏ÄÁßçÊõ¥Â•ΩÁöÑÂäûÊ≥ïÔºåÂú®Âä®ÁîªÁöÑ block ‰∏≠Áõ¥Êé•Áî® view ÁöÑ transform Â±ûÊÄß„ÄÇ ËÆæÁΩÆ transform ËøõË°åÂä®ÁîªÂíå ËÆæÁΩÆ frame Âä®ÁîªÁöÑÂå∫Âà´ËßÜÂõæÁöÑ frame ÂÖ∂ÂÆûÊòØÁî±ËßÜÂõæÁöÑ boundsÔºåpositionÔºåanchorpoint ‰ª•Âèä transform ÂÖ±ÂêåÂÜ≥ÂÆöÁöÑ„ÄÇ‰øÆÊîπ frame ÂÖ∂ÂÆûÂ∞±ÊòØ‰øÆÊîπ bounds Âíå position ÁöÑÂÄº„ÄÇ ‰∏ÄËà¨ËÄåË®ÄÔºåÊúÄÂ•Ω‰ΩøÁî® transform ËøõË°åÂä®ÁîªÔºåÂõ†‰∏∫Êúâ‰∏ÄÁßçÊÉÖÂÜµÊòØÔºåÂ¶ÇÊûúËØ•ËßÜÂõæÂÖ∑ÊúâÂ≠êËßÜÂõæÔºåÂπ∂‰∏îË¶ÅËøõË°åÁº©ÊîæÂä®Áîª„ÄÇÈÇ£‰πàÊâßË°åÂä®ÁîªÁöÑÊó∂ÂÄôÔºåÂä®ÁîªËôΩÁÑ∂Êúâ‰∏Ä‰∏™ËøáÁ®ãÔºå‰ΩÜÂÖ∂ÂÆû‰ªéÂä®Áîª‰∏ÄÂºÄÂßãÔºåframeÂ∞±Â∑≤Áªè‰øÆÊîπ‰∫Ü„ÄÇÂ¶ÇÊûúÁõ¥Êé•ËÆæÁΩÆframeÔºåÈÇ£‰πàÂºÄÂßãÁöÑÊó∂ÂÄôÔºåÂ≠êËßÜÂõæÂ∞±‰ºöÊåâÂèòÂåñÂêéÁöÑframeÊù•ÈáçÊñ∞Â∏ÉÂ±ÄÔºåËÄå‰∏çÊòØË∑üÈöèÁà∂ËßÜÂõæ‰∏ÄËµ∑ÊÖ¢ÊÖ¢ÂèòÂåñ„ÄÇ ËÄå transform Âä®ÁîªÁöÑËØùÔºå‰∏ç‰ºöË∞ÉÁî®Êéß‰ª∂ÁöÑ layoutsubview ÊñπÊ≥ïÔºåÊï¥‰∏™ËøáÁ®ãÊõ¥ÂÉèÊòØÊääÊï¥‰∏™ËßÜÂõæÊåâÊØî‰æãÁº©ÊîæÔºåÂ≠êËßÜÂõæ‰ºöË∑üÁùÄÁà∂ËßÜÂõæ‰∏ÄËµ∑Áº©Êîæ„ÄÇ CALayerÁöÑtransformÂ±ûÊÄßtransformÁªìÊûÑCALayerÁöÑtransformÊòØ‰∏Ä‰∏™CATransform3DÁªìÊûÑÔºö 1234567struct CATransform3D&#123; CGFloat m11, m12, m13, m14; CGFloat m21, m22, m23, m24; CGFloat m31, m32, m33, m34; CGFloat m41, m42, m43, m44;&#125;; ÊúâÂà´‰∫éCGAffineTransform,CATransform3DÊòØ‰∏Ä‰∏™‰∏âÁª¥ÂèòÂåñÔºåÈúÄË¶Å‰∏Ä‰∏™4Èò∂Áü©ÈòµË°®Á§∫„ÄÇÂÖ∂‰ªñÁ±ª‰ººÔºåÂÜçÊ¨°‰∏çË°®„ÄÇ transformÊñπÊ≥ïCALayerÁöÑtransformÊñπÊ≥ïÂíåViewÁöÑtransformÂü∫Êú¨‰∏ÄËá¥„ÄÇ‰∏æÂá†ÁÇπ‰∏çÂêåÔºö CALayerÁî±‰∫éÊúâzËΩ¥ÔºåÂõ†Ê≠§ÂØπ‰∏çÂêåÂõæÂ±Ç‰ΩøÁî®CATransform3DMakeTranslation (CGFloat tx, CGFloat ty, CGFloat tz)ÊñπÊ≥ïÁöÑÊó∂ÂÄôÂèØ‰ª•ÈÄöËøáÊîπÂèòtzÁöÑÂÄºÔºåÊù•ÂÆûÁé∞ÂõæÂ±ÇÁöÑË¶ÜÁõñ„ÄÇÂØπ‰∫étzÊù•ËØ¥ÔºåÂÄºË∂äÂ§ßÔºåÈÇ£‰πàÂõæÂ±ÇÂ∞±Ë∂äÂæÄÂ§ñÔºàÊé•ËøëÂ±èÂπïÔºâÔºåÂÄºË∂äÂ∞èÔºåÂõæÂ±ÇË∂äÂæÄÈáåÔºàÂ±èÂπïÈáåÔºâ„ÄÇ Áî±‰∫éÂõæÂÉèÊòØ‰ªéÊ≠£Èù¢ÊäïÂΩ±ÔºåÁõ¥Êé•ÁªïÁùÄxÊàñyËΩ¥ÊóãËΩ¨Ëææ‰∏çÂà∞ÈÄèËßÜÁöÑÊïàÊûúÔºåÂ¶ÇÊûúË¶ÅËææÂà∞ÈÄèËßÜÊïàÊûúÔºåÈúÄË¶ÅÊîπÂèòm34(ÂÖ∂ÂÆûÊîπÂèòm14Ôºåm24‰πüËÉΩËææÂà∞ÊïàÊûúÔºåÂèØ‰ª•Ëá™Ë°åÈÄöËøáË°åÂàóÂºèÊé®ÂØº„ÄÇ)ÔºåÂÜçÂØπÂõæÂ±ÇËøõË°åÊóãËΩ¨„ÄÇm34ÁöÑÂÄºÂèØ‰ª•Ê†πÊçÆÈúÄË¶ÅÂÆûÁé∞ÁöÑÊïàÊûúÊé®ÂØºÂæóÂà∞Ôºå‰∏çÁõ¥Êé•ÁöÑÊñπÊ≥ïËøòÊòØÁõ¥Êé•ËØï„ÄÇ Â¶ÇÊûúÊÉ≥Ë¶ÅÁõ¥Êé•ÊîπÂèòÁü©ÈòµÈáåÁöÑÂÄºÔºåÂèØ‰ª•ÂÖà‰ΩøÁî®CATransform3DIdentityÁöÑÊñπÂºèÔºåÂàùÂßãÂåñ‰∏Ä‰∏™CATransform3DÂÆû‰æãÔºåÁÑ∂ÂêéÂÜçËµãÂÄº„ÄÇ CAShapeLayerCAShapeLayerÁªßÊâøËá™CALayer„ÄÇCAShapeLayerÊòØÂú®ÂùêÊ†áÁ≥ªÂÜÖÁªòÂà∂Ë¥ùÂ°ûÂ∞îÊõ≤Á∫øÁöÑÔºåÈÄöËøáÁªòÂà∂Ë¥ùÂ°ûÂ∞îÊõ≤Á∫øÔºåËÆæÁΩÆshape(ÂΩ¢Áä∂)ÁöÑpath(Ë∑ØÂæÑ)Ôºå‰ªéËÄåÁªòÂà∂ÂêÑÁßçÂêÑÊ†∑ÁöÑÂõæÂΩ¢‰ª•Âèä‰∏çËßÑÂàôÂõæÂΩ¢„ÄÇÂõ†Ê≠§Ôºå‰ΩøÁî®CAShapeLayerÈúÄË¶Å‰∏éUIBezierPath‰∏ÄËµ∑‰ΩøÁî®„ÄÇ ÂàõÂª∫1CAShapeLayer *layer = [CAShapeLayer layer]; Â±ûÊÄß12345678910111213141516// Ë¶ÅÂëàÁé∞ÁöÑË∑ØÂæÑ@property(nullable) CGPathRef path;// Â°´ÂÖÖËâ≤@property(nullable) CGColorRef fillColor;// Â°´ÂÖÖËßÑÂàô„ÄÇÂÄºÊúâ‰∏§ÁßçÔºåÈùûÈõ∂ÂíåÂ•áÂÅ∂Êï∞Ôºå‰ΩÜÈªòËÆ§ÊòØÈùûÈõ∂ÂÄº„ÄÇ@property(copy) NSString *fillRule;// ËÆæÁΩÆÊèèËæπËâ≤@property(nullable) CGColorRef strokeColor;// ÁªòÂà∂ËæπÁ∫øËΩÆÂªìË∑ØÂæÑÁöÑÂ≠êÂå∫Âüü„ÄÇËØ•ÂÄºÂøÖÈ°ªÂú®[0,1]ËåÉÂõ¥Ôºå0‰ª£Ë°®Ë∑ØÂæÑÁöÑÂºÄÂßãÔºå1‰ª£Ë°®Ë∑ØÂæÑÁöÑÁªìÊùü„ÄÇÂú®0Âíå1‰πãÈó¥ÁöÑÂÄºÊ≤øË∑ØÂæÑÈïøÂ∫¶ËøõË°åÁ∫øÊÄßÊèíÂÄº„ÄÇstrokestartÈªòËÆ§‰∏∫0ÔºåstrokeendÈªòËÆ§‰∏∫1„ÄÇ@property CGFloat strokeStart;@property CGFloat strokeEnd;// Á∫øÁöÑÂÆΩÂ∫¶@property CGFloat lineWidth;// Á´ØÁÇπÂíå‰∫§ÁÇπÁöÑÊòæÁ§∫Á±ªÂûã@property(copy) NSString *lineCap;@property(copy) NSString *lineJoin; ÂàõÂª∫Ë¥ùÂ°ûÂ∞îÊõ≤Á∫øËøôÈáåÂè™ÊòØÁªô‰∫ÜÂá†‰∏™ÂõæÂΩ¢ÁöÑÂü∫Êú¨ÁîªÊ≥ïÔºåËøòÊúâÊõ¥Â§öÂõæÂΩ¢ÁöÑÁîªÊ≥ïÂèØ‰ª•Á®çÂêéÊü•Áúã 12345678910//ÁªòÂà∂Áü©ÂΩ¢UIBezierPath *path = [UIBezierPath bezierPathWithRect:CGRectMake(0, 0, 100, 100)];//ÁªòÂà∂ÂúÜÂΩ¢Ë∑ØÂæÑUIBezierPath *path = [UIBezierPath bezierPathWithOvalInRect:CGRectMake(0, 0, 100, 100)];//ÁªòÂà∂Ëá™Â∏¶ÂúÜËßíÁöÑË∑ØÂæÑUIBezierPath *path = [UIBezierPath bezierPathWithRoundedRect:CGRectMake(0, 0, 100, 100) cornerRadius:30];//ÊåáÂÆöÁü©ÂΩ¢Êüê‰∏Ä‰∏™ËßíÂä†ÂúÜËßíÔºà‰ª£Á†ÅÁ§∫‰æã‰∏∫Â∑¶‰∏äËßíÔºâUIBezierPath *path = [UIBezierPath bezierPathWithRoundedRect:CGRectMake(0, 0, 100, 100) byRoundingCorners:UIRectCornerTopLeft cornerRadii:CGSizeMake(50, 50)];self.layer.path = path.CGPath; Êõ≤Á∫øÂä®ÁîªÊõ≤Á∫øÂä®ÁîªÁöÑ‰∏ªË¶ÅÊÄùÊÉ≥ÊòØÂØπ layer ÁöÑ strokeEnd Â±ûÊÄßÂÅö CABasicAnimation Âä®ÁîªÔºö 12345678910111213141516UIBezierPath *path = [UIBezierPath bezierPath];//Ëµ∑ÂßãÁÇπ[path moveToPoint:CGPointMake(50, 667/2)];//ÁªìÊùüÁÇπ„ÄÅ‰∏§‰∏™ÊéßÂà∂ÁÇπ[path addCurveToPoint:CGPointMake(330, 667/2) controlPoint1:CGPointMake(125, 200) controlPoint2:CGPointMake(185, 450)];CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"strokeEnd"];animation.duration = 5;animation.fromValue = @(0);animation.toValue = @(1);animation.repeatCount = 100;CAShapeLayer *layer = [self createShapeLayerNoFrame:[UIColor clearColor]];layer.path = path.CGPath;layer.lineWidth = 2.0;[layer addAnimation:animation forKey:@"strokeEndAnimation"]; MaskÂ±ûÊÄßÂü∫Êú¨‰ΩøÁî®layerÁöÑÂ§ßÂ∞èÂíåÂΩ¢Áä∂ÊòØÂèóÂà∞maskÈÅÆÁΩ©Â±ÇÁöÑÂΩ±ÂìçÁöÑÔºåÂèØ‰ª•ÈÄöËøáËµãÁªômaskÂ±Ç‰∏Ä‰∏™Êñ∞layerÔºåÊù•ÂÆûÁé∞ÊîπÂèòlayerÂΩ¢Áä∂ÁöÑÊïàÊûú„ÄÇmaskÂõæÂ±ÇÁöÑ Color Â±ûÊÄßÊòØÊó†ÂÖ≥Á¥ßË¶ÅÁöÑÔºàmask‰∏çÊòØÈÄèÊòéÁöÑÈÉ®ÂàÜÔºålayerËÉΩÊòæÁ§∫Âá∫ÂéüÊù•ÁöÑÈ¢úËâ≤ÔºâÔºåÁúüÊ≠£ÈáçË¶ÅÁöÑÊòØÂõæÂ±ÇÁöÑËΩÆÂªì„ÄÇ ‰∏ãÈù¢ÁöÑ‰æãÂ≠ê‰∏≠Ôºå‰∏∫‰∏Ä‰∏™ÂõæÁâáËÆæÁΩÆ‰∫ÜÂúÜÂΩ¢ÁöÑËíôÁâà„ÄÇËíôÁâàÂ§ñÁöÑÈÉ®ÂàÜÊòØÈÄèÊòéÁöÑÔºåËØ•ÈÉ®ÂàÜÂõæÁâá‰∏ç‰∫àÊòæÁ§∫„ÄÇ 123456789- (CALayer *)maskRadiusCorner:(UIImageView *)imageView&#123; //CAShapeLayer ÊòØ CALayer ÁöÑÂ≠êÁ±ªÔºåÈÄöËøáUIBezierPathÊù•ÁªòÂà∂ÂÆÉÁöÑÂΩ¢Áä∂ CAShapeLayer *masklayer = [CAShapeLayer layer]; //Ëé∑ÂèñÂÆΩÂ∫¶ masklayer.frame = imageView.bounds; //Ê≥®ÊÑèbezierPathWithArcCenterÁöÑËÆæÁΩÆ masklayer.path = [UIBezierPath bezierPathWithArcCenter:CGPointMake(imageView.frame.size.width/2, imageView.frame.size.height/2) radius:imageView.frame.size.width/2 startAngle:0 endAngle:2*M_PI clockwise:YES].CGPath; return masklayer;&#125; ÊïàÊûúÂõæÂ¶Ç‰∏ãÔºö ÂÜç‰∏æ‰∏Ä‰∏™‰æãÂ≠êÔºåËßÇÂØü‰∏ãÂõæÁöÑÂÆûÁé∞ÊñπÂºèÔºö ÂéüÁêÜÊòØÂ∞ÜÂΩ©Ëâ≤ÁöÑÂõæÁâáÊ∑ªÂä†Âú®ÁÅ∞Ëâ≤ÁöÑÂõæÁâá‰∏äÔºåÂØπÂΩ©Ëâ≤ÁöÑÂõæÁâáÊ∑ªÂä†‰∏Ä‰∏™ÂúÜÂΩ¢ÁöÑËíôÁâà„ÄÇÂúÜÂΩ¢ËíôÁâàÂ§ñÁöÑÈÉ®ÂàÜÁî±‰∫éÊòØÈÄèÊòéÁöÑÊâÄ‰ª•Â∞±‰∏ç‰∫àÊòæÁ§∫Ôºå‰πüÂ∞±ÊòØ‰∏ãÈù¢ÁöÑÁÅ∞Ëâ≤ÂõæÁâá„ÄÇÂúÜÂΩ¢ËíôÁâàÂÜÖÁöÑÈÉ®ÂàÜÁî±‰∫éËÆæÁΩÆ‰∫ÜÈ¢úËâ≤ÔºåÂ∞±ËÉΩÂ§üÊòæÁ§∫ÂΩ©Ëâ≤ÂõæÁâá„ÄÇ 1234567891011121314151617181920212223242526272829303132/** Ê∑ªÂä†‰∏Ä‰∏™ÂúÜÂΩ¢ËíôÁâà */- (void)addMaskLayer&#123; //ÂàõÂª∫ËíôÁâàÁöÑlayer self.maskLayer = [CALayer layer]; //ËíôÁâàÂ§ßÂ∞è self.maskLayer.frame = CGRectMake(0, 0, 100, 100); //Èöè‰æøÂèñ‰∏™È¢úËâ≤ÔºåÂè™Ë¶Å‰∏çÊòØÈÄèÊòéÁöÑÂ∞±Ë°å self.maskLayer.backgroundColor = [UIColor whiteColor].CGColor; //ÂúÜÂΩ¢ËíôÁâà self.maskLayer.cornerRadius = 50; //Â∞ÜËíôÁâàËµãÁªôView self.colorImageView.layer.mask = self.maskLayer;&#125;- (void)viewDidLoad&#123; [super viewDidLoad]; //Ê∑ªÂä†‰∏§‰∏™image self.colorImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"pic"]]; self.grayImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"gray"]]; //ËÆæÁΩÆframe self.colorImageView.frame = CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height); self.grayImageView.frame = CGRectMake(0, 0, 300, 300); [self.view addSubview:self.colorImageView]; [self.view addSubview:self.grayImageView]; [self addMaskLayer];&#125; ÁªòÂà∂Âè™Êúâ‰∏§‰∏™ÂúÜËßíÁöÑËßÜÂõæÊúâ‰∫õÊÉÖÂÜµ‰∏ãÔºå‰∏Ä‰∏™ button ÊàñËÄÖ labelÔºåÂè™Ë¶ÅÂè≥ËæπÁöÑ‰∏§‰∏™ËßíÂúÜËßíÔºåÊàñËÄÖÂè™Ë¶Å‰∏Ä‰∏™ÂúÜËßí„ÄÇËØ•ÊÄé‰πàÂäûÂë¢Ôºü 12345678CGRect rect = CGRectMake(0, 0, 100, 50);CGSize radio = CGSizeMake(5, 5); // ÂúÜËßíÂ∞∫ÂØ∏UIRectCorner corner = UIRectCornerTopLeft | UIRectCornerTopRight; // ËøôÂè™ÂúÜËßí‰ΩçÁΩÆUIBezierPath *path = [UIBezierPath bezierPathWithRoundedRect:rect byRoundingCorners:corner cornerRadii:radio];CAShapeLayer *masklayer = [[CAShapeLayer alloc] init]; // ÂàõÂª∫shapelayermasklayer.frame = button.bounds;masklayer.path = path.CGPath; // ËÆæÁΩÆË∑ØÂæÑbutton.layer.mask = masklayer; ÂÖ≥‰∫éÁ¶ªÂ±èÊ∏≤ÊüìÊ∏≤ÊüìÊú∫Âà∂CPU ËÆ°ÁÆóÂÜÖÂÆπ‰∫§Áî± GPU Ê∏≤ÊüìÔºåGPU Ê∏≤ÊüìÂÆåÊàêÂêéÊîæÂÖ•Â∏ßÁºìÂÜ≤Âå∫„ÄÇÈöèÂêéËßÜÈ¢ëÊéßÂà∂Âô®‰ºöÊåâÁÖß VSync ‰ø°Âè∑ÈÄêË°åËØªÂèñÂ∏ßÁºìÂÜ≤Âå∫ÁöÑÊï∞ÊçÆÔºåÁªèËøáÂèØËÉΩÁöÑÊï∞Ê®°ËΩ¨Êç¢‰º†ÈÄíÁªôÊòæÁ§∫Âô®ÊòæÁ§∫„ÄÇ GPU Ê∏≤ÊüìÊñπÂºè On-Screen RenderingÔºöÊÑè‰∏∫ÂΩìÂâçÂ±èÂπïÊ∏≤Êüì„ÄÇGPUÁöÑÊ∏≤ÊüìÊìç‰ΩúÊòØÂú®ÂΩìÂâçÁî®‰∫éÊòæÁ§∫ÁöÑÂ±èÂπïÁºìÂÜ≤Âå∫‰∏≠ËøõË°å„ÄÇ Off-Screen RenderingÔºöÊÑè‰∏∫Á¶ªÂ±èÊ∏≤Êüì„ÄÇGPUÂú®ÂΩìÂâçÂ±èÂπïÁºìÂÜ≤Âå∫‰ª•Â§ñÊñ∞ÂºÄËæü‰∏Ä‰∏™ÁºìÂÜ≤Âå∫ËøõË°åÊ∏≤ÊüìÊìç‰Ωú„ÄÇ ÂÖ∂ÂÆûÈùûÂΩìÂâçÂ±èÂπïÁºìÂÜ≤Âå∫ÁöÑÊ∏≤ÊüìÈÉΩÂè´ÂÅöÁ¶ªÂ±èÊ∏≤ÊüìÔºåCPU Ê∏≤ÊüìÂæóÂà∞ bitmap ÁÑ∂Âêé‰∫§Áî± GPU ÊòæÁ§∫‰πüÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑÁ¶ªÂ±èÊ∏≤ÊüìÔºåÊ≠§‰∏æ‰ºöÊ∂àËÄó‰∏ÄÂÆöÁöÑ CPU ËµÑÊ∫ê„ÄÇ‰ΩÜÊòØÂ¶ÇÊûú GPU ËµÑÊ∫êÁ¥ßÂº†ÔºåÂêåÊó∂ CPU Á©∫Èó≤ÔºåÂèØ‰ª•ËÄÉËôëÂ¶ÇÊ≠§‰ºòÂåñÔºå‰ª•Ê∂àÈô§ GPU ‰∏çËÉΩÂèäÊó∂Ê∏≤ÊüìÂØºËá¥ÁöÑ‰∏¢Â∏ßÁöÑÂΩ±Âìç„ÄÇ ÊâÄ‰ª•Á¶ªÂ±èÊ∏≤Êüì‰∏ç‰∏ÄÂÆöÂ∞±ÊòØÂΩ±ÂìçÊÄßËÉΩÁöÑ„ÄÇÂè™ÊòØÊ∏≤ÊüìÊñπÂºèÁöÑ‰∏ÄÁßç„ÄÇ Á¶ªÂ±èÊ∏≤ÊüìÁöÑËß¶Âèë shouldRasterizeÔºàÂÖâÊ†ÖÂåñÔºâ masksÔºàÈÅÆÁΩ©Ôºâ shadowsÔºàÈò¥ÂΩ±Ôºâ edge antialiasingÔºàÊäóÈîØÈΩøÔºâ group opacityÔºà‰∏çÈÄèÊòéÔºâ ÂÖ∂‰∏≠ÔºåÂÖâÊ†ÖÂåñÊòØÊääGPUÁöÑÊìç‰ΩúËΩ¨Âà∞CPU‰∏äÔºå‰∏•Ê†ºÊÑè‰πâ‰∏äÊòØ‚ÄùËΩØ‰ª∂Ê∏≤Êüì‚ÄùÔºåÂ∞ÜÂõæËΩ¨Âåñ‰∏∫‰∏Ä‰∏™‰∏™Ê†ÖÊ†ºÁªÑÊàêÁöÑÂõæË±°„ÄÇÂπ∂‰∏îÁºìÂ≠òËµ∑Êù•ÔºåÂáèÂ∞ëÊ∏≤ÊüìÁöÑÈ¢ëÂ∫¶„ÄÇÂØπ‰∫éÂü∫Êú¨‰∏ç‰ºöÂèòÂåñÁöÑËßÜÂõæÔºåÂºÄÂêØÂÖâÊ†ÖÂåñÊúâÂä©‰∫éÊÄßËÉΩ‰ºòÂåñÔºå‰ΩÜÊòØÂ¶ÇÊûúÂÜÖÂÆπÁªèÂ∏∏ÂèòÂåñÔºåÈÇ£‰πàÂ∞±‰ºöÈÄ†ÊàêÊÄßËÉΩÊµ™Ë¥π„ÄÇ ‰∏∫‰ªÄ‰πà‰ºö‰∫ßÁîüÁ¶ªÂ±èÊ∏≤ÊüìÂΩì‰ΩøÁî®ÂúÜËßíÔºåÈò¥ÂΩ±ÔºåÈÅÆÁΩ©ÁöÑÊó∂ÂÄôÔºåÂõæÂ±ÇÂ±ûÊÄßÁöÑÊ∑∑Âêà‰ΩìË¢´ÊåáÂÆö‰∏∫Âú®Êú™È¢ÑÂêàÊàê‰πãÂâç‰∏çËÉΩÁõ¥Êé•Âú®Â±èÂπï‰∏≠ÁªòÂà∂„ÄÇ ËøôÊòØÂõ†‰∏∫ GPU Êó†Ê≥ïÂú®Êüê‰∏ÄÂ±ÇÊ∏≤ÊüìÂÆåÊàê‰πãÂêéÔºåÂÜçÂõûËøáÂ§¥Êù•Êì¶Èô§/ÊîπÂèòÂÖ∂‰∏≠ÁöÑÊüê‰∏™ÈÉ®ÂàÜ„ÄÇÂõ†‰∏∫Âú®Ëøô‰∏ÄÂ±Ç‰πãÂâçÁöÑËã•Âπ≤Â±ÇlayerÂÉèÁ¥†Êï∞ÊçÆÔºåÂ∑≤ÁªèÂú®Ê∏≤Êüì‰∏≠Ë¢´Ê∞∏‰πÖË¶ÜÁõñ‰∫Ü„ÄÇËøôÂ∞±ÊÑèÂë≥ÁùÄÔºåÂØπ‰∫éÊØè‰∏ÄÂ±ÇlayerÔºåË¶Å‰πàËÉΩÊâæÂà∞‰∏ÄÁßçÈÄöËøáÂçïÊ¨°ÈÅçÂéÜÂ∞±ËÉΩÂÆåÊàêÊ∏≤ÊüìÁöÑÁÆóÊ≥ïÔºåË¶Å‰πàÂ∞±‰∏çÂæó‰∏çÂè¶ÂºÄ‰∏ÄÂùóÂÜÖÂ≠òÔºåÂÄüÂä©Ëøô‰∏™‰∏¥Êó∂‰∏≠ËΩ¨Âå∫ÂüüÊù•ÂÆåÊàê‰∏Ä‰∫õÊõ¥Â§çÊùÇÁöÑ„ÄÅÂ§öÊ¨°ÁöÑ‰øÆÊîπ/Ââ™Ë£ÅÊìç‰Ωú„ÄÇ ËßÜÂõæÂúÜËßíËÆæÁΩÆËßÜÂõæÁöÑ cornerRadiusÊú¨Ë∫´Âπ∂‰∏ç‰ºöËß¶ÂèëÁ¶ªÂ±èÊ∏≤ÊüìÔºåÈúÄË¶ÅÂíå maskToBounds ‰∏ÄËµ∑ËÆæÁΩÆÊâç‰ºö‰∫ßÁîü„ÄÇ ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÁõ¥Êé•ËÆæÁΩÆÂúÜËßíÂç≥ÂèØ„ÄÇ 123UIView *view = [[UIView alloc] init];view.backgroundColor = [UIColor blackColor];view.layer.cornerRadius = 3.f; ‰ΩÜÊòØ UILabel ‰æãÂ§ñÔºåUILabel Â¶ÇÊûúÊúâËÉåÊôØËâ≤ÈúÄË¶ÅËÆæÁΩÆ layer ÁöÑËÉåÊôØËâ≤Ôºö 1234UILabel *label = [[UILabel alloc] init];// ÈáçÁÇπÂú®Ê≠§ÔºÅÔºÅËÆæÁΩÆËßÜÂõæÁöÑÂõæÂ±ÇËÉåÊôØËâ≤ÔºåÂçÉ‰∏á‰∏çË¶ÅÁõ¥Êé•ËÆæÁΩÆ label.backgroundColorlabel.layer.backgroundColor = [UIColor grayColor].CGColor;label.layer.cornerRadius = cornerRadius; UIImageView Êó†Ê≥ïÂÅöÂà∞Áõ¥Êé•ÈöêËóèÂõæÁâáÂúÜËßí„ÄÇÊâÄ‰ª•ÈúÄË¶ÅËá™Â∑±ÁªòÂà∂Âá∫‰∏Ä‰∏™Â∏¶ÂúÜËßíÁöÑÂõæÁâáÔºö 123456789101112131415161718extension UIImage &#123; func kt_drawRectWithRoundedCorner(radius radius: CGFloat, _ sizetoFit: CGSize) -&gt; UIImage &#123; let rect = CGRect(origin: CGPoint(x: 0, y: 0), size: sizetoFit) UIGraphicsBeginImageContextWithOptions(rect.size, false, UIScreen.mainScreen().scale) CGContextAddPath(UIGraphicsGetCurrentContext(), UIBezierPath(roundedRect: rect, byRoundingCorners: UIRectCorner.AllCorners, cornerRadii: CGSize(width: radius, height: radius)).CGPath) CGContextClip(UIGraphicsGetCurrentContext()) self.drawInRect(rect) CGContextDrawPath(UIGraphicsGetCurrentContext(), .FillStroke) let output = UIGraphicsGetImageFromCurrentImageContext(); UIGraphicsEndImageContext(); return output &#125;&#125; ËøôÁßçÊñπÂºèÂ¶ÇÊûú‰∏çÂÅöÁºìÂ≠òÔºåÊØèÊ¨°ÈÉΩ‰ºöÂàõÂª∫Êñ∞ÁöÑ UIImageÔºåÂä†Èáç CPU ÁöÑË¥üÊãÖ„ÄÇ Âè¶Â§ñÔºåËøòÊúâ‰∏ÄÁßç‰ΩøÁî®Ë¥ùÂ°ûÂ∞îÊõ≤Á∫øÔºåÂà©Áî®CALayerÂ±ÇÁªòÂà∂ÊåáÂÆöÂúÜËßíÊ†∑ÂºèÁöÑmaskÈÅÆÁõñView ÁöÑÊñπÂºèËææÂà∞ÂúÜËßíÊïàÊûúÁöÑ„ÄÇ‰∏çËøáËøôÁßçÊñπÂºè‰πüÊòØÊìç‰Ωú maskÔºå‰ºö‰∫ßÁîüÁ¶ªÂ±èÊ∏≤ÊüìÔºå‰ΩÜÊòØÊïàÊûú‰ºöÊØîÁõ¥Êé•ËÆæÁΩÆÂúÜËßíË¶ÅÂ•ΩÂæàÂ§ö„ÄÇ ËøôÊ†∑ÊòØÊää GPU ÁöÑ‰ªªÂä°ËΩ¨Áªô‰∫Ü CPU ÂéªÂÆåÊàê„ÄÇÈÇ£‰πàÂ¶ÇÊûúËøòÊòØÊéâÂ∏ßÊÄé‰πàÂäûÔºü Áõ¥Êé•ËÆ© UI Â∞ÜÂõæÁâáÂàá‰∏∫ÂúÜËßí Âú®ÂéüÊù•ÁöÑËßÜÂõæ‰∏äÊ∑ªÂä†‰∏Ä‰∏™Âõõ‰∏™ËßíÊúâÈ¢úËâ≤‰∏≠Èó¥ÈÄèÊòéÁöÑÂõæÁâá,ÈÅÆÁõñÂà∞ÂéüÊù•ÂõæÁâá‰∏ä„ÄÇËøôÊ†∑ÊòØÈÄöËøáÊ∑∑ÂêàÂõæÂ±ÇÁöÑÊñπÂºèÂÆûÁé∞„ÄÇÊçüËÄóÁöÑÊÄßËÉΩ‰ºöÂ•ΩÂæàÂ§ö„ÄÇ Â∞Ü‰∏äÈù¢ÁªòÂà∂ÂúÜËßíÂõæÁâáÁöÑËøáÁ®ãÊîæÂà∞Â≠êÁ∫øÁ®ã‰∏≠ÂéªÔºåÁªòÂà∂ÂÆåÊàêÂêéÂõûÂà∞‰∏ªÁ∫øÁ®ã‰∏≠„ÄÇ ÈíàÂØπ‰∏äÈù¢Á¨¨‰∫åÁÇπÔºöÊ∑ªÂä†‰∏Ä‰∏™Âõõ‰∏™ËßíÊúâÈ¢úËâ≤‰∏≠Èó¥ÈÄèÊòéÁöÑÂõæÁâá„ÄÇÁõ∏ÂÖ≥‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617181920212223242526272829303132333435363738@implementation UIImage (XWAddForRoundedCorner)/**Êèê‰æõ‰∏Ä‰∏™Âú®‰∏Ä‰∏™ÊåáÂÆöÁöÑsize‰∏≠ÁªòÂà∂ÂõæÁâáÁöÑ‰æøÊç∑ÊñπÊ≥ï*/+ (UIImage *)xw_imageWithSize:(CGSize)size drawBlock:(void (^)(CGContextRef context))drawBlock &#123; if (!drawBlock) return nil; UIGraphicsBeginImageContextWithOptions(size, NO, 0); CGContextRef context = UIGraphicsGetCurrentContext(); if (!context) return nil; drawBlock(context); UIImage *image = UIGraphicsGetImageFromCurrentImageContext(); UIGraphicsEndImageContext(); return image;&#125;/**ÁªòÂà∂ÊñπÊ≥ïÁöÑÂÖ∑‰ΩìÈÄªËæëÔºåÈÅÆÁΩ©ÂõæÁâáÁöÑÈÄªËæëÊòØÁªòÂà∂‰∏Ä‰∏™Áü©ÂΩ¢ÔºåÁÑ∂ÂêéÂú®ÁªòÂà∂‰∏Ä‰∏™Áõ∏Â∫îÁöÑÂúÜËßíÁü©ÂΩ¢ÔºåÁÑ∂ÂêéÂ°´ÂÖÖÁü©ÂΩ¢ÂíåÂúÜËßíÁü©ÂΩ¢ÁöÑ‰∏≠Èó¥ÈÉ®ÂàÜ‰∏∫Áà∂ËßÜÂõæÁöÑËÉåÊôØËâ≤*/+ (UIImage *)xw_maskRoundCornerRadiusImageWithColor:(UIColor *)color cornerRadii:(CGSize)cornerRadii size:(CGSize)size corners:(UIRectCorner)corners borderColor:(UIColor *)borderColor borderWidth:(CGFloat)borderWidth&#123; return [UIImage xw_imageWithSize:size drawBlock:^(CGContextRef _Nonnull context) &#123; CGContextSetLineWidth(context, 0); [color set]; CGRect rect = CGRectMake(0, 0, size.width, size.height); //ÁªòÂà∂‰∏Ä‰∏™Áü©ÂΩ¢ÔºåËøôÈáåÂèë-0.3ÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢ËæπÁºòÁöÑÈîØÈΩøÔºå UIBezierPath *rectPath = [UIBezierPath bezierPathWithRect:CGRectInset(rect, -0.3, -0.3)]; //ÁªòÂà∂ÂúÜËßíÁü©ÂΩ¢ÔºåËøôÈáåÁöÑ0.3ÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢ÂÜÖËæπÊ°ÜÁöÑÈîØÈΩø UIBezierPath *roundPath = [UIBezierPath bezierPathWithRoundedRect:CGRectInset(rect, 0.3, 0.3) byRoundingCorners:corners cornerRadii:cornerRadii]; [rectPath appendPath:roundPath]; CGContextAddPath(context, rectPath.CGPath); //Ê≥®ÊÑèË¶ÅÁî®EOFillÊñπÂºèËøõË°åÂ°´ÂÖÖËÄåÈùûFillÊñπÂºè CGContextEOFillPath(context); //Â¶Ç‰∏ãÊòØÁªòÂà∂ËæπÊ°ÜÔºåÂéüÁêÜ‰æùÊóßÊòØÁªòÂà∂‰∏Ä‰∏™Â§ñËæπÊ°ÜÁÑ∂ÂêéÊ†πÊçÆËæπÊ°ÜÂÆΩÂ∫¶ÁªòÂà∂‰∏Ä‰∏™ÂÜÖËæπÊ°ÜÂêåÊ†∑ÈááÂèñEOFillÁöÑÊñπÂºèËøõË°åÂ°´ÂÖÖÂç≥ÂèØ if (!borderColor || !borderWidth) return; [borderColor set]; UIBezierPath *borderOutterPath = [UIBezierPath bezierPathWithRoundedRect:rect byRoundingCorners:corners cornerRadii:cornerRadii]; UIBezierPath *borderInnerPath = [UIBezierPath bezierPathWithRoundedRect:CGRectInset(rect, borderWidth, borderWidth) byRoundingCorners:corners cornerRadii:cornerRadii]; [borderOutterPath appendPath:borderInnerPath]; CGContextAddPath(context, borderOutterPath.CGPath); CGContextEOFillPath(context); &#125;];&#125; Ê∑ªÂä†shadowÁöÑÁ¶ªÂ±èÊ∏≤ÊüìÊàë‰ª¨Áõ¥Êé•ËÆæÁΩÆ shadow Áõ∏ÂÖ≥Â±ûÊÄß‰ºö‰∫ßÁîüÁ¶ªÂ±èÊ∏≤ÊüìÔºö 12345let layer = view.layerlayer.shadowColor = UIColor.black.cgColorlayer.shadowOpacity = 0.3layer.shadowRadius = radiuslayer.shadowOffset = CGSize(width: 0, height: -3) Âè™Ë¶Å‰Ω†ÊèêÂâçÂëäËØâCoreAnimation‰Ω†Ë¶ÅÊ∏≤ÊüìÁöÑViewÁöÑÂΩ¢Áä∂Shape,Â∞±‰ºöÂáèÂ∞ëÁ¶ªÂ±èÊ∏≤ÊüìËÆ°ÁÆó„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶ÅÂä†‰∏äËÆæÁΩÆ shadowPath ÁöÑ‰∏ÄË°åÔºö 123456let layer = view.layerlayer.shadowColor = UIColor.black.cgColorlayer.shadowOpacity = 0.3layer.shadowRadius = radiuslayer.shadowOffset = CGSize(width: 0, height: -3)layer.shadowPath = [[UIBezierPathbezierPathWithRectÔºömyView.bounds] CGPath]; ÂèÇËÄÉÊñáÊ°£Á¶ªÂ±èÊ∏≤Êüì‰ºòÂåñËØ¶Ëß£ÔºöÂÆû‰æãÁ§∫ËåÉ+ÊÄßËÉΩÊµãËØï]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Animation</tag>
        <tag>UI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GCDÈòüÂàó Â≠¶‰π†‰∏éÊï¥ÁêÜ]]></title>
    <url>%2F2016%2F08%2F02%2FGCD%E9%98%9F%E5%88%97%2F</url>
    <content type="text"><![CDATA[Grand Central DispatchÊàñËÄÖGCDÔºåÊòØ‰∏ÄÂ•ó‰ΩéÂ±ÇAPIÔºåÊèê‰æõ‰∫Ü‰∏ÄÁßçÊñ∞ÁöÑÊñπÊ≥ïÊù•ËøõË°åÂπ∂ÂèëÁ®ãÂ∫èÁºñÂÜô„ÄÇ‰ªéÂü∫Êú¨ÂäüËÉΩ‰∏äËÆ≤ÔºåGCDÊúâÁÇπÂÉèNSOperationQueueÔºå‰ªñ‰ª¨ÈÉΩÂÖÅËÆ∏Á®ãÂ∫èÂ∞Ü‰ªªÂä°ÂàáÂàÜ‰∏∫Â§ö‰∏™Âçï‰∏Ä‰ªªÂä°ÁÑ∂ÂêéÊèê‰∫§Ëá≥Â∑•‰ΩúÈòüÂàóÊù•Âπ∂ÂèëÂú∞ÊàñËÄÖ‰∏≤Ë°åÂú∞ÊâßË°å„ÄÇGCDÊØî‰πãNSOpertionQueueÊõ¥Â∫ïÂ±ÇÊõ¥È´òÊïàÔºåÂπ∂‰∏îÂÆÉ‰∏çÊòØCocoaÊ°ÜÊû∂ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ Âü∫Êú¨Ê¶ÇÂøµ Serial vs. Concurrent ‰∏≤Ë°å vs. Âπ∂ÂèëËøô‰∫õÊúØËØ≠ÊèèËø∞ÂΩì‰ªªÂä°Áõ∏ÂØπ‰∫éÂÖ∂ÂÆÉ‰ªªÂä°Ë¢´ÊâßË°åÔºå‰ªªÂä°‰∏≤Ë°åÊâßË°åÂ∞±ÊòØÊØèÊ¨°Âè™Êúâ‰∏Ä‰∏™‰ªªÂä°Ë¢´ÊâßË°åÔºå‰ªªÂä°Âπ∂ÂèëÊâßË°åÂ∞±ÊòØÂú®Âêå‰∏ÄÊó∂Èó¥ÂèØ‰ª•ÊúâÂ§ö‰∏™‰ªªÂä°Ë¢´ÊâßË°å„ÄÇ Synchronous vs. Asynchronous ÂêåÊ≠• vs. ÂºÇÊ≠•Âú® GCD ‰∏≠ÔºåËøô‰∫õÊúØËØ≠ÊèèËø∞ÂΩì‰∏Ä‰∏™ÂáΩÊï∞Áõ∏ÂØπ‰∫éÂè¶‰∏Ä‰∏™‰ªªÂä°ÂÆåÊàêÔºåÊ≠§‰ªªÂä°ÊòØËØ•ÂáΩÊï∞Ë¶ÅÊ±Ç GCD ÊâßË°åÁöÑ„ÄÇ‰∏Ä‰∏™ÂêåÊ≠•ÂáΩÊï∞Âè™Âú®ÂÆåÊàê‰∫ÜÂÆÉÈ¢ÑÂÆöÁöÑ‰ªªÂä°ÂêéÊâçËøîÂõû„ÄÇ‰∏Ä‰∏™ÂºÇÊ≠•ÂáΩÊï∞ÔºåÂàöÂ•ΩÁõ∏ÂèçÔºå‰ºöÁ´ãÂç≥ËøîÂõûÔºåÈ¢ÑÂÆöÁöÑ‰ªªÂä°‰ºöÂÆåÊàê‰ΩÜ‰∏ç‰ºöÁ≠âÂÆÉÂÆåÊàê„ÄÇÂõ†Ê≠§Ôºå‰∏Ä‰∏™ÂºÇÊ≠•ÂáΩÊï∞‰∏ç‰ºöÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ãÂéªÊâßË°å‰∏ã‰∏Ä‰∏™ÂáΩÊï∞„ÄÇ ÂêåÊ≠•ÂºÇÊ≠•ÊòØÂØπÁ∫øÁ®ãËØ¥ÁöÑ ‰∏≤Ë°åÂπ∂Ë°åÊòØÂØπÈòüÂàóËØ¥ÁöÑ ÈòüÂàóÂàÜÁ±ª Serial Queues ‰∏≤Ë°åÈòüÂàóËøô‰∫õ‰ªªÂä°ÁöÑÊâßË°åÊó∂Êú∫ÂèóÂà∞ GCD ÁöÑÊéßÂà∂ÔºõÂîØ‰∏ÄËÉΩÁ°Æ‰øùÁöÑ‰∫ãÊÉÖÊòØ GCD ‰∏ÄÊ¨°Âè™ÊâßË°å‰∏Ä‰∏™‰ªªÂä°ÔºåÂπ∂‰∏îÊåâÁÖßÊàë‰ª¨Ê∑ªÂä†Âà∞ÈòüÂàóÁöÑÈ°∫Â∫èÊù•ÊâßË°å„ÄÇÁî±‰∫éÂú®‰∏≤Ë°åÈòüÂàó‰∏≠‰∏ç‰ºöÊúâ‰∏§‰∏™‰ªªÂä°Âπ∂ÂèëËøêË°åÔºåÂõ†Ê≠§‰∏ç‰ºöÂá∫Áé∞ÂêåÊó∂ËÆøÈóÆ‰∏¥ÁïåÂå∫ÁöÑÈ£éÈô©ÔºõÁõ∏ÂØπ‰∫éËøô‰∫õ‰ªªÂä°Êù•ËØ¥ÔºåËøôÂ∞±‰ªéÁ´ûÊÄÅÊù°‰ª∂‰∏ã‰øùÊä§‰∫Ü‰∏¥ÁïåÂå∫ÔºåÂÆûÁé∞‰∫ÜÈîÅÁöÑÂäüËÉΩ„ÄÇ Concurrent Queues Âπ∂ÂèëÈòüÂàóÂú®Âπ∂ÂèëÈòüÂàó‰∏≠ÁöÑ‰ªªÂä°ËÉΩÂæóÂà∞ÁöÑ‰øùËØÅÊòØÂÆÉ‰ª¨‰ºöÊåâÁÖßË¢´Ê∑ªÂä†ÁöÑÈ°∫Â∫èÂºÄÂßãÊâßË°åÔºå‰ΩÜËøôÂ∞±ÊòØÂÖ®ÈÉ®ÁöÑ‰øùËØÅ‰∫Ü„ÄÇ‰ªªÂä°ÂèØËÉΩ‰ª•‰ªªÊÑèÈ°∫Â∫èÂÆåÊàêÔºå‰Ω†‰∏ç‰ºöÁü•ÈÅì‰ΩïÊó∂ÂºÄÂßãËøêË°å‰∏ã‰∏Ä‰∏™‰ªªÂä°ÔºåÊàñËÄÖ‰ªªÊÑèÊó∂ÂàªÊúâÂ§öÂ∞ë Block Âú®ËøêË°å„ÄÇÂÜçËØ¥‰∏ÄÈÅçÔºåËøôÂÆåÂÖ®ÂèñÂÜ≥‰∫é GCD „ÄÇ ÈòüÂàóÁ±ªÂûã The main queue‰∏é‰∏ªÁ∫øÁ®ãÂäüËÉΩÁõ∏Âêå„ÄÇÂÆûÈôÖ‰∏äÔºåÊèê‰∫§Ëá≥main queueÁöÑ‰ªªÂä°‰ºöÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÊâßË°å„ÄÇÂõ†‰∏∫main queueÊòØ‰∏é‰∏ªÁ∫øÁ®ãÁõ∏ÂÖ≥ÁöÑÔºåÊâÄ‰ª•ËøôÊòØ‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàó„ÄÇÁî±‰∫éÊòØÁ≥ªÁªüÈªòËÆ§ÁîüÊàêÁöÑÔºåÊâÄ‰ª•Êó†Ê≥ïË∞ÉÁî®dispatch_resume()Âíådispatch_suspend()Êù•ÊéßÂà∂ÊâßË°åÁªßÁª≠Êàñ‰∏≠Êñ≠„ÄÇËøôÊòØÂú®‰∏Ä‰∏™Âπ∂ÂèëÈòüÂàó‰∏äÂÆåÊàê‰ªªÂä°ÂêéÊõ¥Êñ∞ UI ÁöÑÂÖ±ÂêåÈÄâÊã©„ÄÇ Global queuesÂÖ®Â±ÄÈòüÂàóÊòØÂπ∂ÂèëÈòüÂàóÔºåÂπ∂Áî±Êï¥‰∏™ËøõÁ®ãÂÖ±‰∫´„ÄÇËøõÁ®ã‰∏≠Â≠òÂú®‰∏â‰∏™ÂÖ®Â±ÄÈòüÂàóÔºöÈ´ò„ÄÅ‰∏≠ÔºàÈªòËÆ§Ôºâ„ÄÅ‰Ωé‰∏â‰∏™‰ºòÂÖàÁ∫ßÈòüÂàó„ÄÇÂêåÊ†∑Êó†Ê≥ïÊéßÂà∂‰∏ªÁ∫øÁ®ãdispatchÈòüÂàóÁöÑÊâßË°åÁªßÁª≠Êàñ‰∏≠Êñ≠„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºå‰∏â‰∏™ÈòüÂàó‰∏ç‰ª£Ë°®‰∏â‰∏™Á∫øÁ®ãÔºåÂèØËÉΩ‰ºöÊúâÊõ¥Â§öÁöÑÁ∫øÁ®ã„ÄÇÂπ∂ÂèëÈòüÂàóÂèØ‰ª•Ê†πÊçÆÂÆûÈôÖÊÉÖÂÜµÊù•Ëá™Âä®‰∫ßÁîüÂêàÁêÜÁöÑÁ∫øÁ®ãÊï∞„ÄÇ Áî®Êà∑ÈòüÂàóÁî®Êà∑Ëá™Â∑±ÂàõÂª∫ÁöÑÈòüÂàó„ÄÇÂèØ‰ª•ÂàõÂª∫ÂçïÁ∫øÁ®ãÁöÑ‰∏≤Ë°åÈòüÂàóÔºå‰πüÂèØ‰ª•ÂàõÂª∫Â§öÁ∫øÁ®ãÁöÑÂπ∂Ë°åÈòüÂàó„ÄÇ ÈòüÂàóÂàõÂª∫ÊñπÂºè dispatch_queue_t queue = dispatch_queue_create(‚Äúcom.dispatch.serial‚Äù, DISPATCH_QUEUE_SERIAL);ÁîüÊàê‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàó„ÄÇÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÈòüÂàóÁöÑÂêçÁß∞ÔºåÂú®Ë∞ÉËØïÁ®ãÂ∫èÊó∂‰ºöÈùûÂ∏∏ÊúâÁî®ÔºåÊâÄÊúâÂ∞ΩÈáè‰∏çË¶ÅÈáçÂêç„ÄÇÁ¨¨‰∫å‰∏™ÂèÇÊï∞Ë°®Á§∫ÁîüÊàêÁöÑÈòüÂàóÊòØ‰∏≤Ë°åÁöÑÔºåÂ¶ÇÊûú‰º†ÂÖ• null ÈªòËÆ§ÊòØ‰∏≤Ë°åÁöÑ„ÄÇ dispatch_queue_t queue = dispatch_queue_create(‚Äúcom.dispatch.concurrent‚Äù, DISPATCH_QUEUE_CONCURRENT);ÁîüÊàê‰∏Ä‰∏™Âπ∂ÂèëÊâßË°åÈòüÂàó„ÄÇ dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);Ëé∑ÂæóÂÖ®Â±ÄÈòüÂàó(Á≥ªÁªüÁöÑÈòüÂàóÔºå‰∏éÂπ∂Ë°åÈòüÂàóÁ±ª‰ººÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®Ôºå‰∏çËÉΩÊåáÂÆöÂêçÂ≠ó)„ÄÇ dispatch_queue_t queue = dispatch_get_main_queue()Ëé∑Âæó‰∏ªÁ∫øÁ®ãÈòüÂàó„ÄÇ Êèê‰∫§ JobÂêë‰∏Ä‰∏™ÈòüÂàóÊèê‰∫§JobÂæàÁÆÄÂçïÔºöË∞ÉÁî®dispatch_asyncÊàñdispatch_syncÂáΩÊï∞Ôºå‰º†ÂÖ•‰∏Ä‰∏™ÈòüÂàóÂíå‰∏Ä‰∏™block„ÄÇÈòüÂàó‰ºöÂú®ËΩÆÂà∞Ëøô‰∏™blockÊâßË°åÊó∂ÊâßË°åËøô‰∏™blockÁöÑ‰ª£Á†Å„ÄÇ dispatch_asyncdispatch_async ÂáΩÊï∞‰ºöÁ´ãÂç≥ËøîÂõû, block‰ºöÂú®ÂêéÂè∞ÂºÇÊ≠•ÊâßË°å„ÄÇ 1234dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; [self goDoSomethingLongAndInvolved]; NSLog(@"Done doing something long and involved");&#125;); Âú®ÂÖ∏ÂûãÁöÑCocoaÁ®ãÂ∫è‰∏≠Ôºå‰Ω†ÂæàÊúâÂèØËÉΩÂ∏åÊúõÂú®‰ªªÂä°ÂÆåÊàêÊó∂Êõ¥Êñ∞ÁïåÈù¢ÔºåËøôÂ∞±ÊÑèÂë≥ÁùÄÈúÄË¶ÅÂú®‰∏ªÁ∫øÁ®ã‰∏≠ÊâßË°å‰∏Ä‰∫õ‰ª£Á†Å„ÄÇ‰Ω†ÂèØ‰ª•ÁÆÄÂçïÂú∞ÂÆåÊàêËøô‰∏™‰ªªÂä°‚Äî‚Äî‰ΩøÁî®ÂµåÂ•óÁöÑdispatchÔºåÂú®Â§ñÂ±Ç‰∏≠ÊâßË°åÂêéÂè∞‰ªªÂä°ÔºåÂú®ÂÜÖÂ±Ç‰∏≠Â∞Ü‰ªªÂä°dispatchÂà∞main queueÔºö 123456dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; [self goDoSomethingLongAndInvolved]; dispatch_async(dispatch_get_main_queue(), ^&#123; [textField setStringValue:@"Done doing something long and involved"]; &#125;);&#125;); dispatch_syncdispatch_sync ÂêåÊ≠•ÊâßË°å blockÔºåÂáΩÊï∞‰∏çËøîÂõûÔºå‰∏ÄÁõ¥Á≠âÂà∞ block ÊâßË°åÂÆåÊØï„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊòØÂú®ÂΩìÂâçÁ∫øÁ®ã‰∏≠ÂÆåÊàêÔºåÂõ†‰∏∫Ê¥æÂèëÂêåÊ≠•‰ªªÂä°ÔºåÊú¨Ë∫´Â∞±Ë¶ÅÁ≠âÂà∞‰ªªÂä°ÂÆåÊàêÊâçËÉΩÁªßÁª≠ÊâßË°åÔºåÈÇ£‰πàÂ∞±Ê≤°ÊúâÂøÖË¶ÅÂÜçÂºÄ‰∏Ä‰∏™Á∫øÁ®ãÂéª‰∏ìÈó®ÊâßË°åËøô‰∏™ÂêåÊ≠•‰ªªÂä°ÔºåÊâßË°åÂÆåÂêéÔºåÂÜçËøîÂõûËØ•Á∫øÁ®ã‰∫Ü„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÂú®ÂÖ∂‰ªñÁ∫øÁ®ãÈáåÂæÄ‰∏ªÈòüÂàóÈáåÊ¥æÂèëÂêåÊ≠•‰ªªÂä°ÔºåÈÇ£‰πàËøô‰∏™ÂêåÊ≠•‰ªªÂä°ËøòÊòØ‰ºöÂú®‰∏ªÁ∫øÁ®ãÈáåÊâßË°åÔºåÂΩìÂâçÁ∫øÁ®ãÈòªÂ°û„ÄÇ ÊâßË°åÂà∞ dispatch_sync ÁöÑÊó∂ÂÄôÔºåË°®Á§∫Ëøô‰∏™ block ÂøÖÈ°ªË¶ÅÂú®ÂΩìÂâçÁ∫øÁ®ãÁ´ãÂàªÊâßË°åÂÆå ÂÆûÈôÖÁºñÁ®ãÁªèÈ™åÂëäËØâÊàë‰ª¨ÔºåÂ∞ΩÂèØËÉΩÈÅøÂÖç‰ΩøÁî® dispatch_syncÔºåÂµåÂ•ó‰ΩøÁî®‰∏Ä‰∏™‰∏≤Ë°åÈòüÂàóÊó∂ÊûÅÊòì‰∫ßÁîüÁ®ãÂ∫èÊ≠ªÈîÅÔºåÊØîÂ¶ÇÂµåÂ•óË∞ÉÁî®‰∏ªÁ∫øÁ®ãÔºö Ê≥®ÊÑèËøôÈáåÊ≠ªÈîÅÁöÑÂæàÈáçË¶Å‰∏Ä‰∏™Êù°‰ª∂‰πüÂõ†‰∏∫‰∏ªÈòüÂàóÊòØ‰∏Ä‰∏™‰∏≤Ë°åÁöÑÈòüÂàó(‰∏ªÈòüÂàó‰∏≠Âè™Êúâ‰∏ÄÊù°‰∏ªÁ∫øÁ®ã)„ÄÇÂ¶ÇÊûúÊàë‰ª¨Â¶Ç‰∏ã‰æãÔºåÂú®Âπ∂Ë°åÈòüÂàó‰∏≠Êèê‰∫§ÔºåÂàô‰∏ç‰ºöÈÄ†ÊàêÊ≠ªÈîÅÔºö 123456dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; dispatch_sync(dispatch_get_global_queue(0, 0), ^&#123; NSLog(@"‰ªªÂä°‰∏Ä"); &#125;); NSLog(@"‰ªªÂä°‰∫å");&#125;); ÂéüÂõ†ÊòØÂπ∂Ë°åÈòüÂàó‰∏≠‰ªªÂä°‰∏ÄËôΩË¢´Êèê‰∫§‰ªçÁÑ∂ÊòØÂú®queueÁöÑÈòüÂ∞æÔºåÂú®‰ªªÂä°‰∫å‰πãÂêéÔºå‰ΩÜÊòØÂõ†‰∏∫ÊòØÂπ∂Ë°åÁöÑÔºåÊâÄ‰ª•‰ªªÂä°‰∏ÄÂπ∂‰∏ç‰ºö‰∏ÄÁõ¥Á≠â‰ªªÂä°‰∫åÁªìÊùüÊâçÂéªÊâßË°åÔºåËÄåÊòØÁõ¥Êé•ÊâßË°åÂÆå„ÄÇÊ≠§Êó∂‰ªªÂä°‰∫åÂõ†‰∏∫‰ªªÂä°‰∏ÄÁöÑÁªìÊùüÔºåsyncÈòªÂ°û‰πüÂ∞±Ê∂àÈô§Ôºå‰ªªÂä°‰∫åÂæó‰ª•ÊâßË°å„ÄÇ ÊÄªÁªìÈòüÂàóÊòØ‰∏≤Ë°åÊàñÂπ∂ÂèëÁöÑÔºåÊìç‰ΩúÈòüÂàóÁöÑÂáΩÊï∞ÊòØÂêåÊ≠•ÊàñËÄÖÂºÇÊ≠•ÊâßË°åÁöÑÔºà‰πüÂ∞±ÊòØÂú®ÂΩìÂâçÁ∫øÁ®ãÊâßË°åÂÆåËøîÂõûÂíåÁ´ãÂç≥ËøîÂõûÂè¶ÂºÄÁ∫øÁ®ãÊâßË°åÁöÑÂå∫Âà´Ôºâ„ÄÇ‰∏≤Ë°åÈòüÂàóÂÖ∂ÂÆûÂ∞±Áõ∏ÂΩì‰∫éÂä†‰∫Ü‰∏Ä‰∏™ËµÑÊ∫êÈîÅÔºåÊó†ËÆ∫Âú®Â§öÂ∞ë‰∏™Á∫øÁ®ãÈáåÔºåÂè™ÊúâÂΩìÈòüÂàó‰∏≠Ââç‰∏Ä‰∏™ÂÖÉÁ¥†ÊâßË°åÂÆåÔºåÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑ‰ª£Á†ÅÂùóÊâçËÉΩÁªßÁª≠ÊâßË°åÔºåÂπ∂Ë°åÈòüÂàóÂàôÊ≤°Êúâ‰ªª‰ΩïË¶ÅÊ±ÇÔºåÊúâÈúÄË¶ÅÊâßË°åÂ∞±Á´ãÂç≥ÊâßË°å„ÄÇ ÊâÄ‰ª•Ôºö ‰∏≤Ë°åÈòüÂàóË¶ÅÊ±ÇÈòüÂàóÂâçÁöÑÂøÖÈ°ªÂÖàÊâßË°åÂÆåÔºåÊâçËÉΩÊâßË°åÂêéÈù¢„ÄÇÂπ∂Ë°åÈòüÂàóÊó†Ë¶ÅÊ±Ç dispatch_sync Ë¶ÅÊ±ÇÂΩìÂâç‰ª£Á†ÅÂùóÂøÖÈ°ªÂÖàÊâßË°åÂÆåÔºåÊâçËÉΩÊâßË°åÂêéÈù¢„ÄÇdispatch_async Êó†Ë¶ÅÊ±Ç Âõ†Ê≠§Ôºådispatch_sync Âíå ‰∏≤Ë°åÈòüÂàóÂú®‰∏ÄËµ∑ÂµåÂ•ó‰ΩøÁî®Êó∂Ôºå‰ºöÂÆπÊòì‰∫ßÁîüÊ≠ªÈîÅ„ÄÇ Á§∫‰æã1Âú®‰∏ªÁ∫øÁ®ãÈáåÁöÑÁ§∫‰æãÁöÑÂõõÁßçÁªÑÂêàÁöÑËæìÂá∫Ôºö 1234567for (int i = 1; i &lt; 10; i++) &#123; dispatch_(a)sync(queue, ^&#123; NSLog(@"%d___%@",i, [NSThread currentThread]); &#125;); &#125; NSLog(@"over"); ÁªìÊûú: ‰∏≤Ë°åÂêåÊ≠•ÈòüÂàóÔºöËøêË°åÂú®‰∏ªÁ∫øÁ®ãÈáåÔºåÂÖà‰æùÊ¨°ÊâìÂç∞ i ÂêéÔºåÂÜçÊâìÂç∞ over„ÄÇ ‰∏≤Ë°åÂºÇÊ≠•ÈòüÂàóÔºöÂÖàÊâìÂç∞ overÔºåÂÜç‰æùÊ¨°ÊâìÂç∞ i„ÄÇÁî±‰∫éÊòØÂºÇÊ≠•ÁöÑÔºåover ÊâßË°åÂú®‰∏ªÁ∫øÁ®ãÈáåÊØãÂ∫∏ÁΩÆÁñëÔºåÊâìÂç∞ i Êó∂ÔºåÊñ∞Âª∫‰∫Ü‰∏Ä‰∏™Á∫øÁ®ã„ÄÇ‰∏∫‰ªÄ‰πàÊòØ‰∏Ä‰∏™Âë¢ÔºüÂõ†‰∏∫‰∏≤Ë°åÈòüÂàóÔºå‰ª£Á†ÅÂùó‰æùÊ¨°ÊâßË°å„ÄÇÂàõÂª∫Êñ∞Á∫øÁ®ãÔºåÊâßË°åÔºåÈîÄÊØÅÔºåÂÜçÂàõÂª∫Êñ∞Á∫øÁ®ãÁöÑÊìç‰ΩúÂ§™ËÄóÊó∂„ÄÇÊâÄ‰ª•ÁºñËØëÂô®‰ºòÂåñÂêéÔºå‰ªÖÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êñ∞Á∫øÁ®ã„ÄÇ Âπ∂Ë°åÂêåÊ≠•ÈòüÂàóÔºöËøêË°åÂú®‰∏ªÁ∫øÁ®ãÈáåÔºåÂÖà‰æùÊ¨°ÊâìÂç∞ i ÂêéÔºåÂÜçÊâìÂç∞ over„ÄÇÁé∞Âú®ÁúãËµ∑Êù•Âíå‰∏≤Ë°åÂêåÊ≠•ÈòüÂàó‰∏ÄÊ†∑ÂØπ‰∏çÂØπÔºüÈÇ£‰πà‰ªÄ‰πàÊó∂ÂÄôÊâç‰∏çÂêåÂë¢ÔºüÂÅáÂ¶Ç‰Ω†ÊâãÂä®ÂºÄ‰∫Ü‰∏Ä‰∏™Á∫øÁ®ãÔºåÂπ∂‰∏îÂú®ÈÇ£‰∏™Á∫øÁ®ãÈáåÔºåÂèàËøêË°å‰∫Ü‰∏ÄÈÅç‰∏äÈù¢ÁöÑ‰ª£Á†Å„ÄÇ‰∏≤Ë°åÂêåÊ≠•ÈòüÂàóÁî±‰∫éÊúâÈîÅÔºåÊâßË°åÂΩìÂâç‰ª£Á†ÅÂùóÁöÑÊó∂ÂÄôÔºåÂè¶‰∏Ä‰∏™Á∫øÁ®ãÂ§Ñ‰∫éÈòªÂ°ûÁä∂ÊÄÅÔºåÂè™ËÉΩÁ≠âÂà∞ÂΩìÂâç‰ª£Á†ÅÂùóÊâßË°åÂÆåÊØïÊâçËÉΩË∑≥Âà∞Âè¶‰∏Ä‰∏™Á∫øÁ®ãÔºõÂπ∂Ë°åÂêåÊ≠•ÈòüÂàóÊ≤°ÊúâÈîÅÔºåÂèØËÉΩ‰ª£Á†ÅÂùóÊ≤°ÊúâÊâßË°åÂÆåÔºåÁî±‰∫éÁ∫øÁ®ãÁöÑÊó∂Èó¥ÁâáÁî®ÂÆå‰∫ÜÔºåÂ∞±Á´ãÂç≥Ë∑≥Âà∞Âè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ã‰∏äÂéªÊâßË°å‰∫Ü„ÄÇ Âπ∂Ë°åÂºÇÊ≠•ÈòüÂàóÔºöÂÖàÊâìÂç∞ overÔºåÁÑ∂ÂêéÁûéJBÊâìÂç∞i„ÄÇ Á§∫‰æã21234567891011dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);NSLog(@"1");dispatch_sync(queue, ^&#123; NSLog(@"2"); NSLog(@"thread = %@", [NSThread currentThread]); dispatch_sync(queue, ^&#123; NSLog(@"3"); NSLog(@"thread = %@", [NSThread currentThread]); &#125;); NSLog(@"4");&#125;); ÁªìÊûúÔºö 12345612main thread3main thread4 Âõ†‰∏∫Á∫øÁ®ãÂíå dispatch_async ‰ª•Âèä dispatch_sync ÊúâÂÖ≥„ÄÇÂõ†Ê≠§ÔºåÂú®‰∏ä‰æã‰∏≠ dispatch_sync Êó∂Âú®‰∏ªÁ∫øÁ®ã‰∏≠ÔºåÊâÄ‰ª•ÊâìÂç∞ÁöÑ‰πüÊòØ‰∏ªÁ∫øÁ®ã„ÄÇËôΩÁÑ∂ÈÉΩÊòØÂú®‰∏ªÁ∫øÁ®ã‰∏≠Ôºå‰ΩÜÊòØÊòØÂπ∂Ë°åÈòüÂàóÔºåÂπ∂‰∏ç‰ºöÂèëÁîüÊ≠ªÈîÅ„ÄÇÂè™Êúâ dispatch_sync Ëé∑Âèñ‰∏≤Ë°åÈòüÂàóÁöÑÊó∂ÂÄôÊâç‰ºöÂèëÁîüÊ≠ªÈîÅ„ÄÇ Á§∫‰æã3123456789dispatch_async(global_queue, ^&#123; NSLog(@"1"); [self performSelector:@selector(printLog) withObject:nil afterDelay:0]; NSLog(@"3");&#125;&#125; - (void)printLog &#123; NSLog(@"2");&#125; ÁªìÊûúÔºö 1213 Ëøô‰∏™‰æãÈ¢ò‰∏ç‰ºöÂá∫Áé∞ÊâìÂç∞2„ÄÇÂú®GCDÁîüÊàêÁöÑÂ≠êÁ∫øÁ®ã‰∏≠ÊòØÊ≤°Êúâ runloop ÁöÑÔºåÂ¶ÇÊûú performSelector:withObject:afterDelaty: ÊÉ≥Ë¶ÅÊâßË°åÊàêÂäüÔºåÂøÖÈ°ªË¶ÅÊúâ runloop„ÄÇÂõ†Ê≠§‰∏çÊâìÂç∞ 2 Â∏∏Áî®ÊñπÊ≥ïdispatch_applyÈáçÂ§çÊâßË°åblockÔºåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØËøô‰∏™ÊñπÊ≥ïÊòØÂêåÊ≠•ËøîÂõûÔºå‰πüÂ∞±ÊòØËØ¥Á≠âÂà∞ÊâÄÊúâblockÊâßË°åÂÆåÊØïÊâçËøîÂõû„ÄÇÂ§ö‰∏™blockÁöÑËøêË°åÊòØÂê¶Âπ∂ÂèëÊàñ‰∏≤Ë°åÊâßË°å‰πü‰æùËµñqueueÁöÑÊòØÂê¶Âπ∂ÂèëÊàñ‰∏≤Ë°å„ÄÇ 12345dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);dispatch_apply([array count], queue, ^(size_t index)&#123; [self doSomethingIntensiveWith:[array objectAtIndex:index]];&#125;);[self doSomethingWith:array]; Â¶ÇÊûúÈúÄË¶ÅÂºÇÊ≠•ÊâßË°åËøô‰∫õ‰ª£Á†ÅÔºåÂè™ÈúÄË¶ÅÁî®dispatch_asyncÊñπÊ≥ïÔºåÂ∞ÜÊâÄÊúâ‰ª£Á†ÅÊé®Ëá≥ÂêéÂè∞„ÄÇ dispatch_afterÂª∂ËøüÊèê‰∫§ blockÔºö 12345double delayInSeconds = 1.0; dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delayInSeconds * NSEC_PER_SEC));dispatch_after(popTime, dispatch_get_main_queue(), ^(void)&#123; // code to be executed on the main queue after delay&#125;); ÂÖ∂‰∏≠ NSEC_PER_SEC Ë°®Á§∫‰∏ÄÁßíÈíüÊúâÂ§öÂ∞ëÁ∫≥Áßí„ÄÇ dispatch_after ÊòØÂª∂ËøüÊèê‰∫§Ôºå‰∏çÊòØÂª∂ËøüËøêË°åÔºå‰∏çÊòØÂú®ÁâπÂÆöÁöÑÊó∂Èó¥ÂêéÁ´ãÂç≥ËøêË°åÔºÅÔºö 1234567891011121314151617//ÂàõÂª∫‰∏≤Ë°åÈòüÂàódispatch_queue_t queue = dispatch_queue_create("me.tutuge.test.gcd", DISPATCH_QUEUE_SERIAL);//Á´ãÂç≥ÊâìÂç∞‰∏ÄÊù°‰ø°ÊÅØNSLog(@"Begin add block...");//Êèê‰∫§‰∏Ä‰∏™blockdispatch_async(queue, ^&#123; //Sleep 10Áßí [NSThread sleepForTimeInterval:10]; NSLog(@"First block done...");&#125;);//5 Áßí‰ª•ÂêéÊèê‰∫§blockdispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(5 * NSEC_PER_SEC)), queue, ^&#123; NSLog(@"After...");&#125;); ÁªìÊûúÂ¶Ç‰∏ã: 1232015-03-31 20:57:27.122 GCDTest[45633:1812016] Begin add block...2015-03-31 20:57:37.127 GCDTest[45633:1812041] First block done...2015-03-31 20:57:37.127 GCDTest[45633:1812041] After... ÂØπ‰∫éËøô‰∏™‰∏≤Ë°åÁöÑÈòüÂàóÔºåÂÖà async ÊâßË°å‰∫ÜÈòªÂ°û10ÁßíÔºåÊ≠§Êó∂ÔºåÊ∑ªÂä†‰∏Ä‰∏™5ÁßíÁöÑÂª∂Êó∂‰ªªÂä°„ÄÇÁî±‰∫é5ÁßíÂâç‰∏Ä‰∏™‰ªªÂä°ËøòÊú™ËøîÂõûÔºåÊâÄ‰ª•Âª∂Ëøü‰ªªÂä°‰∏çËÉΩÁ´ãÂàªÊâßË°å„ÄÇÂΩìÂâç‰∏Ä‰∏™‰ªªÂä°ËøîÂõûÂêéÔºåÂª∂Ëøü‰ªªÂä°ÊâßË°åÊó∂ÂèëÁé∞Â∑≤ÁªèËøá‰∫ÜÈ¢ÑÂÆöÊó∂Èó¥ÔºåÈÇ£‰πàÁ´ãÂç≥ÊâßË°å„ÄÇ dispatch_once‰øùËØÅÂú®APPËøêË°åÊúüÈó¥Ôºåblock‰∏≠ÁöÑ‰ª£Á†ÅÂè™ÊâßË°å‰∏ÄÊ¨°1234static dispatch_once_t onceToken;dispatch_once(&amp;onceToken, ^&#123; // code to be executed once&#125;); ‰∏ÄÂÆöË¶ÅÊ≥®ÊÑèÁöÑÊòØ dispatch_once_t ÂøÖÈ°ªÊòØÂÖ®Â±ÄÊàñ static ÂèòÈáè„ÄÇÂê¶Âàô‰ΩøÁî®Êó∂‰ºöÂØºËá¥ÈùûÂ∏∏‰∏çÂ•ΩÊéíÊü•ÁöÑ bug„ÄÇ dispatch_once ÈÄíÂΩíË∞ÉÁî®‰ºö‰∫ßÁîüÊ≠ªÈîÅ„ÄÇ dispatch_group‰∏Ä‰∏™dispatch groupÂèØ‰ª•Áî®Êù•Â∞ÜÂ§ö‰∏™blockÁªÑÊàê‰∏ÄÁªÑ‰ª•ÁõëÊµãËøô‰∫õBlockÂÖ®ÈÉ®ÂÆåÊàêÊàñËÄÖÁ≠âÂæÖÂÖ®ÈÉ®ÂÆåÊàêÊó∂ÂèëÂá∫ÁöÑÊ∂àÊÅØ„ÄÇ dispatch_group_createÂàõÂª∫‰∏Ä‰∏™Ë∞ÉÂ∫¶‰ªªÂä°ÁªÑ dispatch_group_async Êää‰∏Ä‰∏™‰ªªÂä°ÂºÇÊ≠•Êèê‰∫§Âà∞‰ªªÂä°ÁªÑÈáå dispatch_group_notify Áî®Êù•ÁõëÂê¨‰ªªÂä°ÁªÑ‰∫ã‰ª∂ÁöÑÊâßË°åÂÆåÊØï dispatch_group_wait ËÆæÁΩÆÁ≠âÂæÖÊó∂Èó¥ÔºåÂú®Á≠âÂæÖÊó∂Èó¥ÁªìÊùüÂêéÔºåÂ¶ÇÊûúËøòÊ≤°ÊúâÊâßË°åÂÆå‰ªªÂä°ÁªÑÔºåÂàôËøîÂõû„ÄÇËøîÂõû0‰ª£Ë°®ÊâßË°åÊàêÂäüÔºåÈùû0ÂàôÊâßË°åÂ§±Ë¥•123456789dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);dispatch_group_t group = dispatch_group_create();for(id obj in array) dispatch_group_async(group, queue, ^&#123; [self doSomethingIntensiveWith:obj]; &#125;);dispatch_group_notify(group, queue, ^&#123; [self doSomethingWith:array];&#125;); Èô§‰∫Ü dispatch_group_async Áõ¥Êé•ÂèëËµ∑‰∏Ä‰∏™ÂºÇÊ≠•ÈòüÂàóÔºåÊàë‰ª¨ËøòÂèØ‰ª•ÈÖçÂêà‰ΩøÁî®‰∏ãÈù¢‰∏§‰∏™ÊñπÊ≥ïÔºö dispatch_group_enter(group); dispatch_group_leave(group); Ëøô‰∏§‰∏™ÊñπÊ≥ïÊúÄÂ•ΩÈÖçÂêàÂºÇÊ≠•ËØ∑Ê±Ç‰ΩøÁî®Ôºö 123456789101112131415161718192021222324// ÂàõÂª∫ dispatch ÁªÑdispatch_group_t group = dispatch_group_create();// Á¨¨‰∏Ä‰∏™ËØ∑Ê±ÇÔºödispatch_group_enter(group);[self sendGetAddressByPinWithURLs:REQUEST(@"getAddressByPin.json") completionHandler:^(NSDictionary * _Nullable data, NSError * _Nullable error) &#123; NSArray *addressList = [TXAddressModel mj_objectArrayWithKeyValuesArray:data[@"addressList"]]; self.addressList = addressList; dispatch_group_leave(group);&#125;];// Á¨¨‰∫å‰∏™ËØ∑Ê±Çdispatch_group_enter(group);[self sendCurrentOrderWithURLs:REQUEST(@"currentOrder.json") completionHandler:^(NSDictionary * _Nullable data, NSError * _Nullable error) &#123; TXCurrentOrderModel *currentOrderModel = [TXCurrentOrderModel mj_objectWithKeyValues:data]; self.currentOrderModel = currentOrderModel; dispatch_group_leave(group);&#125;];// ÂΩì‰∏äÈù¢‰∏§‰∏™ËØ∑Ê±ÇÈÉΩÁªìÊùüÂêéÔºåÂõûË∞ÉÊ≠§ Blockdispatch_group_notify(group, dispatch_get_main_queue(), ^&#123; NSLog(@"OVER:%@", [NSThread currentThread]); [self setupOrderDataSource];&#125;); Ëøô‰∏™‰æãÂ≠êÁöÑ‰ΩøÁî®Âú∫ÊôØÊòØÔºåÂú®‰∏§‰∏™ËØ∑Ê±ÇÈÉΩËøîÂõûÂÆåÊØïÂêéÔºåÊâçÂõûË∞É‰∏Ä‰∏™ block„ÄÇÂõ†‰∏∫‰∏§‰∏™ËØ∑Ê±ÇÊú¨ÁîüÂ∞±ÊòØÂºÇÊ≠•ÁöÑÔºåÊâÄ‰ª•‰∏çËÉΩ‰ΩøÁî® dispatch_group_async„ÄÇ dispatch_barrier_asyncÂú®ËÆøÈóÆÊï∞ÊçÆÂ∫ìÊñá‰ª∂Êó∂Ôºå‰ΩøÁî® Serial Dispatch Queue ÂèØÈÅøÂÖçÊï∞ÊçÆÁ´û‰∫âÁöÑÈóÆÈ¢òÔºå‰ΩÜÊòØÊïàÁéáËæÉ‰Ωé„ÄÇÊØîÂ¶ÇÂÜôÂÖ•Â§ÑÁêÜ‰∏çËÉΩÂñùÂÖ∂‰ªñÂÜôÂÖ•Â§ÑÁêÜ‰ª•ÂèäËØªÂèñÂ§ÑÁêÜÁ≠âÂπ∂Ë°åÊâßË°å„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúËØªÂèñÂ§ÑÁêÜÂè™ÂíåËØªÂèñÂ§ÑÁêÜÂπ∂Ë°åÊâßË°åÔºåÈÇ£‰πàÂ§ö‰∏™Âπ∂Ë°åÊâßË°å‰∏ç‰ºöÂèëÁîüÈóÆÈ¢ò„ÄÇ ‰∏∫‰∫ÜÈ´òÊïàÁéáÁöÑËøõË°åËÆøÈóÆÔºåËØªÂèñÂ§ÑÁêÜËøΩÂä†Âà∞ Concurrent Dispatch Queue ‰∏≠ÔºåÂÜôÂÖ•Â§ÑÁêÜÂú®‰ªª‰∏Ä‰∏™ËØªÂèñÂ§ÑÁêÜÊ≤°ÊúâÊâßË°åÁöÑÊÉÖÂÜµ‰∏ãÔºåËøΩÂä†Âà∞ Serial Dispatch Queue ‰∏≠Âç≥ÂèØ(ÂÜôÂÖ•Â§ÑÁêÜÁªìÊùüÂâçÔºåËØªÂèñÂ§ÑÁêÜ‰∏çÂèØÊâßË°åÔºâ„ÄÇ GCD Êèê‰æõ‰∫Ü dispatch_barrier_async ÂáΩÊï∞„ÄÇËØ•ÂáΩÊï∞Âêå Concurrent Dispatch Queue ‰∏ÄËµ∑‰ΩøÁî®„ÄÇdispatch_barrier_async ÂáΩÊï∞‰ºöÁ≠âÂæÖËøΩÂä†Âà∞ Concurrent Dispatch Queue ‰∏äÁöÑÂπ∂Ë°åÊâßË°åÁöÑÂ§ÑÁêÜÂÖ®ÈÉ®ÁªìÊùü‰πãÂêéÔºåÂÜçÂ∞ÜÊåáÂÆöÁöÑÂ§ÑÁêÜËøΩÂä†Âà∞ËØ• Concurrent Dispatch Queue‰∏≠„ÄÇÁÑ∂ÂêéÂú®Áî± dispatch_barrier_async ÂáΩÊï∞ËøΩÂä†ÁöÑÂ§ÑÁêÜÊâßË°åÂÆåÊØïÂêéÔºåConcurrent Dispatch Queue ÊâçÊÅ¢Â§ç‰∏∫‰∏ÄËà¨ÁöÑÂä®‰ΩúÔºåËøΩÂä†Âà∞ËØ• Concurrent Dispatch Queue ÁöÑÂ§ÑÁêÜÂèàÂºÄÂßãÂπ∂Ë°åÊâßË°å„ÄÇ ‰∏ÄÂÆöË¶ÅÊ≥®ÊÑèÔºåÂÆòÊñπÊèêÁ§∫ÔºöÂú®‰ΩøÁî®Ê†ÖÊ†èÂáΩÊï∞Êó∂.‰ΩøÁî®Ëá™ÂÆö‰πâÈòüÂàóÊâçÊúâÊÑè‰πâ,Â¶ÇÊûúÁî®ÁöÑÊòØ‰∏≤Ë°åÈòüÂàóÊàñËÄÖÁ≥ªÁªüÊèê‰æõÁöÑÂÖ®Â±ÄÂπ∂ÂèëÈòüÂàó,Ëøô‰∏™Ê†ÖÊ†èÂáΩÊï∞ÁöÑ‰ΩúÁî®Á≠âÂêå‰∫é‰∏Ä‰∏™ÂêåÊ≠•ÂáΩÊï∞ÁöÑ‰ΩúÁî® 12345678910dispatch_queue_t queue = dispatch_queue_create("myQueue", DISPATCH_QUEUE_CONCURRENT);dispatch_async(queue, blk0_for_reading);dispatch_async(queue, blk1_for_reading);dispatch_async(queue, blk2_for_reading);dispatch_async(queue, blk3_for_reading);dispatch_barrier_async(queue, blk_for_writing);dispatch_async(queue, blk4_for_reading);dispatch_async(queue, blk5_for_reading);dispatch_async(queue, blk6_for_reading);dispatch_async(queue, blk7_for_reading); Â§ÑÁêÜÊµÅÁ®ãÂ¶ÇÂõæÔºö ‰ΩøÁî® dispatch_barrier_async ÂèØÊèêÈ´òÊï∞ÊçÆÂ∫ìËÆøÈóÆÂíåÊñá‰ª∂ËÆøÈóÆÁöÑÊïàÁéá„ÄÇ Èô§‰∫Ü dispatch_barrier_async ËøòÊúâ‰∏Ä‰∏™ dispatch_barrier_syncÔºå‰∏§ËÄÖÊúâ‰ªÄ‰πàÂå∫Âà´Âë¢Ôºü‰∏§ËÄÖÈÉΩËÉΩËææÂà∞Á≠âÂæÖÂú®ÂÆÉÂâçÈù¢ÊèíÂÖ•ÈòüÂàóÁöÑ‰ªªÂä°ÂÖàÊâßË°åÂÆåÔºåÁ≠âÂæÖ‰ªñ‰ª¨Ëá™Â∑±ÁöÑ‰ªªÂä°ÊâßË°åÂÆåÂÜçÊâßË°åÂêéÈù¢ÁöÑ‰ªªÂä°ÁöÑÁõÆÁöÑ„ÄÇ‰ΩÜÊòØ‰∏çÂêåÁöÑÊòØÔºådispatch_barrier_async Â∞ÜËá™Â∑±ÁöÑ‰ªªÂä°ÊèíÂÖ•Âà∞ÈòüÂàó‰πãÂêéÔºå‰∏ç‰ºöÁ≠âÂæÖËá™Â∑±ÁöÑ‰ªªÂä°ÁªìÊùüÔºåÂÆÉ‰ºöÁªßÁª≠ÊääÂêéÈù¢ÁöÑ‰ªªÂä°ÊèíÂÖ•Âà∞ÈòüÂàóÔºåÁÑ∂ÂêéÁ≠âÂæÖËá™Â∑±ÁöÑ‰ªªÂä°ÁªìÊùüÂêéÊâçÊâßË°åÂêéÈù¢‰ªªÂä°Ôºõdispatch_barrier_sync Â∞ÜËá™Â∑±ÁöÑ‰ªªÂä°ÊèíÂÖ•Âà∞ÈòüÂàóÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÁ≠âÂæÖËá™Â∑±ÁöÑ‰ªªÂä°ÁªìÊùü‰πãÂêéÊâç‰ºöÁªßÁª≠ÊèíÂÖ•Ë¢´ÂÜôÂú®ÂÆÉÂêéÈù¢ÁöÑ‰ªªÂä°ÔºåÁÑ∂ÂêéÊâßË°åÂÆÉ‰ª¨„ÄÇ‰πüÂ∞±ÊòØËØ¥ÂâçËÄÖ‰∏ç‰ºöÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ãÔºåËÄåÂêéËÄÖ‰ºöÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ã„ÄÇ dispatch_barrier_sync Âíådispatch_barrier_asyncÁöÑÂå∫Âà´ dispatch_semaphoredispatch_semaphore ‰∏ªË¶ÅÁî®Êù•ÂÆûÁé∞ÈîÅÁöÑÊìç‰Ωú„ÄÇÂèØÁî®‰∫éËØ∑Ê±ÇÂêåÊ≠•Á≠âÂ§ÑÁêÜ„ÄÇ dispatch_semaphore_t semaphore = dispatch_semaphore_create(value); dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER); dispatch_semaphore_signal(semaphore); value ÂèØ‰ª•ÁêÜËß£‰∏∫ËµÑÊ∫êÊï∞ÈáèÔºå‰ª• value = 0 ‰∏∫‰æãÔºåË∞ÉÁî® dispatch_semaphore_wait Êìç‰ΩúÊàêÂäüÂêéÔºåÂΩìËµÑÊ∫êÊï∞Èáè value Á≠â‰∫é 0 Êó∂ÔºåÂ∞±‰ºöÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ãÔºàÂèç‰πãÔºåvalue Â∞±‰ºöÂáè 1ÔºâÔºåÁõ¥Âà∞Êúâ dispatch_semaphore_signal ÈÄöÁü•‰ø°Âè∑ÂèëÂá∫ÔºåÂΩì value Â§ß‰∫é 0 Êó∂ÔºåÂΩìÂâçÁ∫øÁ®ãÂ∞±‰ºöË¢´Âî§ÈÜíÁªßÁª≠ÊâßË°åÂÖ∂‰ªñÊìç‰Ωú„ÄÇ ‰æãÂ≠ê:Ê®°ÊãüÂêåÊ≠•ËØ∑Ê±ÇÔºåÈòªÂ°ûÂΩìÂâçÁ∫øÁ®ãÔºö12345678910111213141516// 1.ÂàõÂª∫‰ø°Âè∑Èáèdispatch_semaphore_t semaphore = dispatch_semaphore_create(0);NSLog(@"0");// ÂºÄÂßãÂºÇÊ≠•ËØ∑Ê±ÇÊìç‰ΩúÔºàÈÉ®ÂàÜ‰ª£Á†ÅÁï•Ôºâdispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; NSLog(@"1"); // This function returns non-zero if a thread is woken. Otherwise, zero is returned. // 2.Âú®ÁΩëÁªúËØ∑Ê±ÇÁªìÊùüÂêéÂèëÈÄÅÈÄöÁü•‰ø°Âè∑ dispatch_semaphore_signal(semaphore);&#125;);// Returns zero on success, or non-zero if the timeout occurred.// 3.ÂèëÈÄÅÁ≠âÂæÖ‰ø°Âè∑dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);NSLog(@"2");// print 0„ÄÅ1„ÄÅ2 Áî±‰∫é dispatch_semaphore_waitÔºåÁ∫øÁ®ãÈòªÂ°û„ÄÇÂè™ÊúâÁ≠âÂæÖÂºÇÊ≠•ËØ∑Ê±ÇËøîÂõûÂêéÊâßË°å dispatch_semaphore_signal ÂêéÔºåÊâç‰ºöÁªßÁª≠ÊâßË°å‰∏ãÈù¢ÁöÑ‰ª£Á†Å„ÄÇÊâÄ‰ª•ÂÖàÊâìÂç∞ 1ÔºåÂêéÊâìÂç∞ 2. ‰æãÂ≠êÔºöÂä†ÈîÅÔºåÈòªÂ°ûÂÖ∂‰ªñÁ∫øÁ®ãÔºö123456789101112dispatch_queue_t queue = dispatch_get_global_queue(0, 0);dispatch_semaphore_t semaphore = dispatch_semaphore_create(1);for (int i = 0; i &lt; 100; i++) &#123; dispatch_async(queue, ^&#123; // Áõ∏ÂΩì‰∫éÂä†ÈîÅ dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER); NSLog(@"i = %zd semaphore = %@", i, semaphore); // Áõ∏ÂΩì‰∫éËß£ÈîÅ dispatch_semaphore_signal(semaphore); &#125;);&#125; ÈóÆÈ¢ò ‰∏≤Ë°åÂπ∂Ë°åÔºåÂêåÊ≠•ÂºÇÊ≠•ÁöÑÂå∫Âà´Ôºü ‰ªÄ‰πàÊÉÖÂÜµ‰∏ã‰ºöÈÄ†ÊàêÊ≠ªÈîÅÔºü Â¶Ç‰Ωï‰ΩøÁî® dispatch_time_tÔºüÂ¶Ç‰Ωï‰ΩøÁî® dispatch_after? dispatch_after ‰Ωú‰∏∫ÂÄíËÆ°Êó∂ÂáÜÁ°Æ‰πàÔºü‰ªÄ‰πàÊÉÖÂÜµ‰∏ã‰ºö‰∏çÂáÜÔºü Â¶Ç‰Ωï‰ΩøÁî® dispatch_onceÔºü Â¶Ç‰ΩïÂàõÂª∫Âíå‰ΩøÁî® dispatch_group? ‰ªÄ‰πàÊó∂ÂÄô‰ΩøÁî® dispatch_group_enter(group)Âíådispatch_group_leave(group)?ÊÄé‰πà‰ΩøÁî®Ôºü dispatch_barrier_asyncÂíådispatch_barrier_sync ÊÄé‰πàÁî®ÔºüÈúÄË¶ÅÊ≥®ÊÑè‰ªÄ‰πàÔºüÁî®Âú®‰ªÄ‰πàÊÉÖÂÜµ‰∏ãÔºü‰∏§ËÄÖÊúâ‰ªÄ‰πàÂ∑ÆÂà´Ôºü dispatch_semaphore Êúâ‰ªÄ‰πàÁî®ÔºüÂ¶Ç‰Ωï‰ΩøÁî®ÔºüÂ¶Ç‰ΩïÁî®ÂÆÉÊ®°ÊãüÂêåÊ≠•ËØ∑Ê±ÇÔºüÂ¶Ç‰ΩïÂä†ÈîÅ‰ª•ÂèäÈòªÂ°ûÂÖ∂‰ªñÁ∫øÁ®ãÔºü ËøòÊúâ‰∏Ä‰∏™ÂèÇËÄÉÊñáÁ´†ÔºöGCD‰ΩøÁî®ÁªèÈ™å‰∏éÊäÄÂ∑ßÊµÖË∞à]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>GCD</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂõæËß£TCP-IPÂ≠¶‰π†Á¨îËÆ∞]]></title>
    <url>%2F2016%2F07%2F31%2F%E5%9B%BE%E8%A7%A3TCP_IP%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáÊòØÂØπ„ÄäÂõæËß£TCP-IP„Äã‰∏Ä‰π¶Â≠¶‰π†ÂêéÊëòÂΩïÁöÑÁ¨îËÆ∞„ÄÇÈÉΩÊòØÁΩëÁªú‰∏≠ÊúÄÂü∫Á°ÄÁöÑÁü•ËØÜ„ÄÇËôΩÁÑ∂ÊòØÂõæËß£Ôºå‰ΩÜÊòØ‰º†ÂõæÂ§™È∫ªÁÉ¶„ÄÇÂ∞±‰∏çÊà™Âõæ‰∫Ü„ÄÇÀô TCP/IPÂü∫Á°ÄÁü•ËØÜTCP/IPÊ®°Âûã Á°¨‰ª∂(Áâ©ÁêÜÂ±Ç) ÁΩëÁªúÊé•Âè£Â±Ç(Êï∞ÊçÆÈìæË∑ØÂ±Ç) ‰∫íËÅîÁΩëÂ±Ç(ÁΩëÁªúÂ±Ç) IPÔºöË∑®Ë∂äÁΩëÁªúÂèëÈÄÅÊï∞ÊçÆÂåÖÔºå‰ΩøÊï¥‰∏™‰∫íËÅîÁΩëÈÉΩËÉΩÊî∂Âà∞Êï∞ÊçÆÁöÑÂçèËÆÆ„ÄÇ ICMPÔºöIPÊï∞ÊçÆÂåÖÂèëÈÄÅÈÄî‰∏≠Âá∫Áé∞ÂºÇÂ∏∏Êó†Ê≥ïÂèëÈÄÅÂà∞ÁõÆÊ†áÂú∞ÂùÄÊó∂ÔºåÁªôÂèëÈÄÅÁ´Ø‰∏Ä‰∏™ÂºÇÂ∏∏ÈÄöÁü•„ÄÇICMPÂ∞±ÊòØ‰∏∫Ëøô‰∏ÄÂäüËÉΩÂÆöÂà∂ÁöÑ ARPÔºö‰ªéÂàÜÁªÑÊï∞ÊçÆÂåÖËß£ÊûêÂá∫Áâ©ÁêÜÂú∞ÂùÄ(MACÂú∞ÂùÄ)ÁöÑ‰∏ÄÁßçÂçèËÆÆ„ÄÇ ‰º†ËæìÂ±Ç TCPÔºöÈù¢ÂêëËøûÊé•ÁöÑ‰º†ËæìÂ±ÇÂçèËÆÆ„ÄÇÂèØ‰ª•‰øùËØÅ‰∏§Á´ØÈÄö‰ø°‰∏ªÊú∫Èó¥ÁöÑÈÄö‰ø°ÂèØËææ„ÄÇ UDPÔºöÈù¢ÂêëÊó†ËøûÊé•ÁöÑ‰º†ËæìÂ±ÇÂçèËÆÆ„ÄÇ Â∫îÁî®Â±Ç(‰ºöËØùÂ±Ç‰ª•‰∏äÁöÑÂàÜÂ±Ç) WWW ÁîµÂ≠êÈÇÆ‰ª∂(E-Mail) Êñá‰ª∂‰º†Ëæì(FTP) ËøúÁ®ãÁôªÂΩï(TELNET,SSH) ÁΩëÁªúÁÆ°ÁêÜ(SNMP) Áâ©ÁêÜÂ±ÇÂçèËÆÆÁâ©ÁêÜÂ±ÇÊòØ‰∫îÂ±ÇÊ®°Âûã‰∏≠ÁöÑÊúÄÂ∫ïÂ±ÇÔºåÁâ©ÁêÜÂ±Ç‰∏∫ËÆ°ÁÆóÊú∫‰πãÈó¥ÁöÑÊï∞ÊçÆÈÄö‰ø°Êèê‰æõ‰∫Ü‰º†ËæìÂ™í‰ΩìÂíå‰∫íËøûËÆæÂ§áÔºå‰∏∫Êï∞ÊçÆ‰º†ËæìÊèê‰æõ‰∫ÜÂèØÈù†ÁöÑÁéØÂ¢ÉÔºåÂ™í‰ΩìÂåÖÊã¨ÁîµÁºÜ„ÄÅÂÖâÁ∫§„ÄÅÊó†Á∫ø‰ø°ÈÅìÁ≠âÔºå‰∫íËøûËÆæÂ§áÊåáÊòØËÆ°ÁÆóÊú∫ÂíåË∞ÉÂà∂Ëß£Ë∞ÉÂô®‰πãÈó¥ÁöÑ‰∫íËøûËÆæÂ§áÔºåÂ¶ÇÂêÑÁßçÊèíÂ§¥„ÄÅÊèíÂ∫ßÁ≠â„ÄÇËØ•Â±ÇÁöÑ‰ΩúÁî®ÊòØÈÄèÊòéÁöÑ‰º†ËæìÊØîÁâπÊµÅÔºàÂç≥‰∫åËøõÂà∂ÊµÅÔºâÔºå‰∏∫Êï∞ÊçÆÈìæË∑ØÂ±ÇÊèê‰æõ‰∏Ä‰∏™‰º†ËæìÂéüÂßãÊØîÁâπÊµÅÁöÑÁâ©ÁêÜËøûÊé• Êï∞ÊçÆÈìæË∑ØÂ±ÇÊï∞ÊçÆÈìæË∑ØÂ±ÇÊòØÊ®°Âûã‰∏≠ÁöÑÁ¨¨2Â±ÇÔºåËØ•Â±ÇÂØπÊé•ÂèóÂà∞Áâ©ÁêÜÂ±Ç‰º†ËæìËøáÊù•ÁöÑÊØîÁâπÊµÅËøõË°åÂàÜÁªÑÔºå‰∏ÄÁªÑÁîµ‰ø°Âè∑ÊûÑÊàêÁöÑÊï∞ÊçÆÂåÖÔºåÂ∞±Âè´ÂÅö‚ÄùÂ∏ß‚ÄùÔºåÊï∞ÊçÆÈìæÈìæË∑ØÂ±ÇÂ∞±ÊòØÊù•‰º†Ëæì‰ª•‚ÄùÂ∏ß‚Äù(frame)‰∏∫Âçï‰ΩçÁöÑÊï∞ÊçÆÂåÖÔºåÊääÊï∞ÊçÆ‰º†ÈÄíÁªô‰∏ä‰∏ÄÂ±ÇÔºàÁΩëÁªúÂ±ÇÔºâÔºåÂ∏ßÊï∞ÊçÆÁî±‰∏§ÈÉ®ÂàÜÁªÑÊàêÔºöÂ∏ßÂ§¥ÂíåÂ∏ßÊï∞ÊçÆÔºåÂ∏ßÂ§¥ÂåÖÊã¨Êé•ÂèóÊñπÁâ©ÁêÜÂú∞ÂùÄÔºàÂ∞±ÊòØ‰∏ã‰∏ÄÁ∫ßÁöÑÁΩëÂç°Âú∞ÂùÄÔºâÂíåÂÖ∂‰ªñÁöÑÁΩëÁªú‰ø°ÊÅØÔºåÂ∏ßÊï∞ÊçÆÂ∞±ÊòØË¶Å‰º†ËæìÁöÑÊï∞ÊçÆ‰Ωì„ÄÇÊï∞ÊçÆÂ∏ßÁöÑÊúÄÈïø‰∏∫1500Â≠óËäÇÔºåÂ¶ÇÊûúÊï∞ÊçÆÂæàÈïøÔºåÂ∞±ÂøÖÈ°ªÂàÜÂâ≤ÊàêÂ§ö‰∏™Â∏ßËøõË°åÂèëÈÄÅ„ÄÇ ÁΩëÁªúÂ±ÇËØ•Â±ÇÈÄöËøáÂØªÂùÄÔºàÂØªÂùÄÂú∞ÂùÄÔºâÊù•Âª∫Á´ã‰∏§‰∏™ËäÇÁÇπ‰πãÈó¥ÁöÑËøûÊé•ÔºåÂ§ßÂÆ∂ÈÉΩÁü•ÈÅìÊàë‰ª¨ÁöÑÁîµËÑëËøûÊé•‰∏äÁΩëÁªúÂêéÈÉΩÊúâ‰∏Ä‰∏™IPÂú∞ÂùÄÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáIPÂú∞ÂùÄÊù•Á°ÆÂÆö‰∏çÂêåÁöÑËÆ°ÁÆóÊú∫ÊòØÂê¶Âú®Âêå‰∏Ä‰∏™Â≠êÁΩëË∑Ø„ÄÇÂ¶ÇÊûúÊàë‰ª¨ÁöÑÁîµËÑëËøûÊé•‰∏äÁΩëÁªúÂêéÂ∞±Êúâ‰∏§ÁßçÂú∞ÂùÄÔºöÁâ©ÁêÜÂú∞ÂùÄÂíåÁΩëÁªúÂú∞ÂùÄÔºàIPÂú∞ÂùÄÔºâÔºåÁΩëÁªú‰∏äÁöÑËÆ°ÁÆóÊú∫Ë¶ÅÈÄö‰ø°ÔºåÂøÖÈ°ªË¶ÅÁü•ÈÅìÈÄö‰ø°ÁöÑËÆ°ÁÆóÊú∫‚ÄúÂú®Âì™Èáå‚ÄùÔºå È¶ñÂÖàÈÄöËøáÁΩëÁªúÂú∞ÂùÄÊù•Âà§Êñ≠ÊòØÂê¶Â§Ñ‰∫éÂêå‰∏Ä‰∏™Â≠êÁΩëÁªúÔºåÁÑ∂ÂêéÂÜçÂØπÁâ©ÁêÜÂú∞ÂùÄÔºàMACÔºâÂú∞ÂùÄËøõË°åÂ§ÑÁêÜÔºå‰ªéËÄåÂáÜÁ°ÆÁ°ÆÂÆöË¶ÅÈÄö‰ø°ËÆ°ÁÆóÊú∫ÁöÑ‰ΩçÁΩÆ„ÄÇ Âú®ÁΩëÁªúÂ±Ç‰∏≠ÊúâÊàë‰ª¨ÁÜüÊÇâÁöÑIPÂçèËÆÆÔºàÂç≥ËßÑÂÆöÁΩëÁªúÂú∞ÂùÄÁöÑÂçèËÆÆÔºâÔºåÁõÆÂâçÂπøÊ≥õÈááÁî®ÁöÑÊòØIPv4,Ëøô‰∏™ÁâàÊú¨ËßÑÂÆöÔºåÁΩëÁªúÂú∞ÂùÄÁî±32‰Ωç‰∫åËøõÂà∂‰ΩçÁªÑÊàê„ÄÇÊàë‰ª¨ÂèØ‰ª•Ëá™Â∑±ÈÖçÁΩÆIPÂú∞ÂùÄ‰πüÂèØ‰ª•Ëá™Âä®Ëé∑ÂæóÁöÑÊñπÂºèÂæóÂà∞IPÂú∞ÂùÄÔºåIPÂú∞ÂùÄÂàÜÊàê‰∏§ÈÉ®ÂàÜÔºåÂâç24‰Ωç‰ª£Ë°®ÁΩëÁªúÔºåÂêé8‰Ωç‰ª£Ë°®‰∏ªÊú∫Âè∑Ôºå Â¶Ç192.168.254.1Âíå192.168.254.2Â∞±Â§Ñ‰∫éÂêå‰∏Ä‰∏™Â≠êÁΩëÁªúÈáåÔºåÂõ†‰∏∫Ëøô‰∏§‰∏™IPÂú∞ÂùÄÁöÑÂâç24‰ΩçÁõ∏Âêå„ÄÇ Â∏ßÊï∞ÊçÆÂå∫Âê´Êúâ‰∏Ä‰∏™Êï∞ÊçÆ‰Ωì„ÄÇ‰∏∫Á°Æ‰øùËÆ°ÁÆóÊú∫ËÉΩÂ§üËß£ÈáäÊï∞ÊçÆÂ∏ß‰∏≠ÁöÑÊï∞ÊçÆÔºåËøô‰∏§Âè∞ËÆ°ÁÆóÊú∫‰ΩøÁî®‰∏ÄÁßçÂÖ¨Áî®ÁöÑÈÄöËÆØÂçèËÆÆ„ÄÇ‰∫íËÅîÁΩë‰ΩøÁî®ÁöÑÈÄöËÆØÂçèËÆÆÁÆÄÁß∞IPÔºåÂç≥‰∫íËÅîÁΩëÂçèËÆÆ„ÄÇIPÊï∞ÊçÆÂåÖ‰πüÂåÖÊã¨‰∏§ÈÉ®ÂàÜÔºöÂ§¥ÔºàHeadÔºâÂíåÊï∞ÊçÆ(Data)ÔºåIPÊï∞ÊçÆÂåÖ(Packet)ÊîæËøõÊï∞ÊçÆÂ∏ß‰∏≠ÁöÑÊï∞ÊçÆÈÉ®ÂàÜËøõË°å‰º†Ëæì„ÄÇ MacÂú∞ÂùÄÂú®Â∏ßÂ§¥‰∏≠ÔºåIPÂú∞ÂùÄÂú®Â∏ßÊï∞ÊçÆ‰∏≠ÁöÑIPÊï∞ÊçÆÂåÖÂ§¥‰∏≠ÔºåËøôÊ†∑‰∫§Êç¢Êú∫ÂèØ‰ª•Âø´ÈÄüËØªÂèñMacÂú∞ÂùÄËøõË°åËΩ¨ÂèëÔºåËÄå‰∏çÈúÄË¶ÅÂÉèË∑ØÁî±Âô®‰∏ÄÊ†∑ÈúÄË¶ÅËß£ÂåÖÂ∞ÜIPÂú∞ÂùÄÂèñÂá∫ÔºåÊâçËÉΩËøõË°åËΩ¨ÂèëÔºåÂΩ±ÂìçÊïàÁéá„ÄÇ ‰º†ËæìÂ±ÇÈÄöËøáMACÂíåIPÂú∞ÂùÄÔºåÊàë‰ª¨ÂèØ‰ª•ÊâæÂà∞‰∫íËÅîÁΩë‰∏ä‰ªªÊÑè‰∏§Âè∞‰∏ªÊú∫Êù•Âª∫Á´ãÈÄö‰ø°„ÄÇÁÑ∂ËÄåËøôÈáåÊúâ‰∏Ä‰∏™ÈóÆÈ¢òÔºåÊâæÂà∞‰∏ªÊú∫ÂêéÔºå‰∏ªÊú∫‰∏äÊúâÂæàÂ§öÁ®ãÂ∫èÈÉΩÈúÄË¶ÅÁî®Âà∞ÁΩëÁªúÔºåÊØîÂ¶ÇËØ¥‰Ω†Âú®‰∏ÄËæπÂê¨Ê≠åÂíåÂ•ΩÁî®QQËÅäÂ§©Ôºå ÂΩìÁΩëÁªú‰∏äÂèëÈÄÅÊù•‰∏Ä‰∏™Êï∞ÊçÆÂåÖÊó∂Ôºå ÊòØÊÄé‰πàÁü•ÈÅìÂÆÉÊòØË°®Á§∫ËÅäÂ§©ÁöÑÂÜÖÂÆπËøòÊòØÊ≠åÊõ≤ÁöÑÂÜÖÂÆπÁöÑÔºå ËøôÊó∂ÂÄôÂ∞±ÈúÄË¶Å‰∏Ä‰∏™ÂèÇÊï∞Êù•Ë°®Á§∫Ëøô‰∏™Êï∞ÊçÆÂåÖÊòØÂèëÈÄÅÁªôÈÇ£‰∏™Á®ãÂ∫èÔºàËøõÁ®ãÔºâÊù•‰ΩøÁî®ÁöÑÔºåËøô‰∏™ÂèÇÊï∞Êàë‰ª¨Â∞±Âè´ÂÅöÁ´ØÂè£Âè∑Ôºå‰∏ªÊú∫‰∏äÁî®Á´ØÂè£Âè∑Êù•Ê†áËØÜ‰∏çÂêåÁöÑÁ®ãÂ∫èÔºàËøõÁ®ãÔºâÔºåÁ´ØÂè£ÊòØ0Âà∞65535‰πãÈó¥ÁöÑ‰∏Ä‰∏™Êï¥Êï∞Ôºå0Âà∞1023ÁöÑÁ´ØÂè£Ë¢´Á≥ªÁªüÂç†Áî®ÔºåÁî®Êà∑Âè™ËÉΩÈÄâÊã©Â§ß‰∫é1023ÁöÑÁ´ØÂè£„ÄÇ ‰º†ËæìÂ±ÇÁöÑÂäüËÉΩÂ∞±ÊòØÂª∫Á´ãÁ´ØÂè£Âà∞Á´ØÂè£ÁöÑÈÄö‰ø°ÔºåÁΩëÁªúÂ±ÇÂ∞±ÊòØÂª∫Á´ã‰∏ªÊú∫‰∏é‰∏ªÊú∫ÁöÑÈÄö‰ø°ÔºåËøôÊ†∑Â¶ÇÊûúÊàë‰ª¨Á°ÆÂÆö‰∫Ü‰∏ªÊú∫ÂíåÁ´ØÂè£ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÂÆûÁé∞Á®ãÂ∫è‰πãÈó¥ÁöÑÈÄö‰ø°‰∫Ü„ÄÇÊàë‰ª¨ÊâÄËØ¥ÁöÑSocketÁºñÁ®ãÂ∞±ÊòØÈÄöËøá‰ª£Á†ÅÊù•ÂÆûÁé∞‰º†ËæìÂ±Ç‰πãÈó¥ÁöÑÈÄö‰ø°„ÄÇÂõ†‰∏∫ÂàùÂßãÂåñSocketÁ±ªÂØπË±°Ë¶ÅÊåáÂÆöIPÂú∞ÂùÄÂíåÁ´ØÂè£Âè∑„ÄÇ Âú®‰º†ËæìÂ±ÇÊúâ‰∏§‰∏™ÈùûÂ∏∏ÈáçË¶ÅÁöÑÂçèËÆÆÔºöUDP ÂçèËÆÆÂíåTCPÂçèËÆÆ ÈááÁî®UDPÂçèËÆÆËØù‰º†ËæìÁöÑÂ∞±ÊòØUDPÊï∞ÊçÆÊÆµÔºåÂêåÊ†∑UDPÊï∞ÊçÆÊÆµ‰πüÁî±Â§¥ÂíåÊï∞ÊçÆ‰∏§ÈÉ®ÂàÜÁªÑÊàêÔºåÂ§¥ÈÉ®ÂàÜ‰∏ªË¶ÅÊ†áËØÜ‰∫ÜÂèëÈÄÅÁ´ØÂè£ÂíåÊé•ÂèóÁ´ØÂè£ÔºåÊï∞ÊçÆÈÉ®ÂàÜÂ∞±ÊòØÂÖ∑‰ΩìÁöÑÂÜÖÂÆπ‰ø°ÊÅØ„ÄÇÂêåÊ†∑UDPÊï∞ÊçÆÊÆµ(segment)ÊòØÊîæÂÖ•IPÊï∞ÊçÆÂåÖ‰∏≠ÁöÑ‚ÄùÊï∞ÊçÆ‚ÄùÈÉ®ÂàÜÔºåIPÊï∞ÊçÆÂåÖÂÜçÊîæÂÖ•Êï∞ÊçÆÂ∏ß‰∏≠Âú®ÁΩëÁªú‰∏ä‰º†Ëæì„ÄÇ Áî±‰∫éUDPÂçèËÆÆÁöÑÂèØÈù†ÊÄßÂ∑ÆÔºàÊï∞ÊçÆÂèëÈÄÅÂêéÊó†Ê≥ïÁ°ÆÂÆöÂØπÊñπÊòØÂê¶Êî∂Âà∞ÔºâÔºåÊâÄ‰ª•ÂèàÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÂèØÈù†ÊÄßÈ´òÁöÑÂçèËÆÆ‚Äî‚ÄîTCPÂçèËÆÆÔºåTCPÂçèËÆÆÈááÂèñ‰∫ÜÊè°ÊâãÁöÑÊñπÂºèË¶ÅÁ°Æ‰øùÂØπÊñπÊî∂Âà∞‰∫ÜÊï∞ÊçÆ„ÄÇ TCP ÂçèËÆÆÁöÑ‰∏âÊ¨°Êè°Êâã‰∏ªË¶ÅÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÁ°ÆÂÆöÂÆ¢Êà∑Á´ØË¶ÅÂíåÊúçÂä°Âô®Âª∫Á´ãÈìæÊé•Ôºå‰ª•Èò≤ÊúçÂä°Âô®‰∏ÄÁõ¥Á≠âÂæÖÈÄ†ÊàêÁöÑÊÄßËÉΩÊçüÂ§±„ÄÇÂÆ¢Êà∑Á´ØÂÖàÂèë‰∏Ä‰∏™ÂêåÊ≠•‰ø°ÊÅØÂëäËØâÊúçÂä°Âô®Ë¶ÅÂª∫Á´ãÈìæÊé•ÔºåÊúçÂä°Âô®ËøîÂõû‰∏Ä‰∏™Á°ÆËÆ§‰ø°ÊÅØÔºåÂÆ¢Êà∑Á´ØÊé•Êî∂Âà∞‰πãÂêéÂÜçËøîÂõû‰∏Ä‰∏™Á°ÆËÆ§‰ø°ÊÅØ„ÄÇÂ¶ÇÊûú‰∏çËøôÊ†∑ÂÅöÔºåÂèØËÉΩÂõ†‰∏∫ÁΩëÁªúÂª∂ËøüÔºåÂÆ¢Êà∑Á´ØÁöÑ‰ø°ÊÅØÂÜç‰∏ÄÊÆµÊó∂ÂÄôÂêéÊâçË¢´ÊúçÂä°Âô®Êé•Êî∂ÔºåÊúçÂä°Âô®Á≠âÂæÖÂÆ¢Êà∑Á´ØÊï∞ÊçÆÔºå‰ΩÜÊòØÁî±‰∫éËøá‰∫Ü‰∏ÄÊÆµÊó∂Èó¥ÔºåÂÆ¢Êà∑Á´ØÂèØËÉΩÂ∑≤ÁªèÂÅúÊ≠¢‰∫ÜËØ∑Ê±ÇÊìç‰ΩúÔºåËøôÂ∞±ÂØºËá¥‰∫ÜÊúçÂä°Âô®ÊÄßËÉΩÁöÑÊµ™Ë¥π„ÄÇ Â∫îÁî®Â±ÇÂ∫îÁî®Â±ÇÊòØÊ®°Âûã‰∏≠ÁöÑÊúÄÈ°∂Â±ÇÔºåÊòØÁî®Êà∑‰∏éÁΩëÁªúÁöÑÊé•Âè£ÔºåËØ•Â±ÇÈÄöËøáÂ∫îÁî®Á®ãÂ∫èÊù•ÂÆåÊàêÁΩëÁªúÁî®Êà∑ÁöÑÂ∫îÁî®ÈúÄÊ±Ç„ÄÇËØ•Â±ÇÁöÑÊï∞ÊçÆÊîæÂú®TCPÊï∞ÊçÆÂåÖÁöÑÊï∞ÊçÆÈÉ®ÂàÜÔºåËØ•Â±ÇÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÂæàÈáçË¶ÅÁöÑÂçèËÆÆ‚Äî‚ÄîHttpÂçèËÆÆÔºåÊàë‰ª¨‰∏ÄËà¨ÁöÑWebÂºÄÂèëÈÉΩÊòØÂü∫‰∫éÂ∫îÁî®Â±ÇÁöÑÂºÄÂèë„ÄÇ Êï∞ÊçÆÂåÖÂ¶Ç‰ΩïÂú®ÁΩëÁªú‰∏≠‰º†ËæìÂΩìÊàë‰ª¨ÂêëÁõÆÊ†áÁ´ôÁÇπÂèëÈÄÅÊï∞ÊçÆÂåÖÊó∂(ÊØîÂ¶Ç ping ‰∏Ä‰∏™Âú∞ÂùÄ)ÔºåÂ∞±ÁîüÊàê‰∫Ü‰∏Ä‰∏™ÂåÖÂê´ ICMP ÂçèËÆÆÂüüÁöÑÊï∞ÊçÆÂåÖÔºåÊàë‰ª¨ÊöÇ‰∏îÁß∞‰πã‰∏∫‚ÄúÂ∞èÂæ∑‚Äù„ÄÇ ‚ÄúÂ∞èÂæ∑‚ÄùÂ∑≤ÁªèÂ∞ÜICMPÂçèËÆÆÊâìÂåÖÂà∞Êï∞ÊçÆÊÆµÈáå‰∫ÜÔºåÂèØÊòØËøò‰∏çËÉΩÂèëÈÄÅÔºåÂõ†‰∏∫‰∏Ä‰∏™Êï∞ÊçÆË¶ÅÊÉ≥ÂêëÂ§ñÈù¢‰º†ÈÄÅÔºåËøòÂæóÁªèËøá‚ÄúÊúâÂÖ≥ÈÉ®Èó®‚ÄùÁöÑÊâπÂáÜ‚Äî‚ÄîIPÂçèËÆÆ„ÄÇIPË¶ÅÂ∞Ü‰Ω†ÁöÑ‚ÄúÂÜô‰ø°‰∫∫Âú∞ÂùÄ‚ÄùÂíå‚ÄúÊî∂‰ø°‰∫∫Âú∞ÂùÄ‚ÄùÂÜôÂà∞Êï∞ÊçÆÊÆµ‰∏äÈù¢ÔºåÂç≥ÔºöÂ∞ÜÊï∞ÊçÆÁöÑÊ∫êIPÂú∞ÂùÄÂíåÁõÆÁöÑIPÂú∞ÂùÄÂàÜÂà´ÊâìÂåÖÂú®‚ÄúÂ∞èÂæ∑‚ÄùÁöÑÂ§¥ÈÉ®ÂíåÂ∞æÈÉ®ÔºåËøôÊ†∑‰∏ÄÊù•ÔºåÂ§ßÂÆ∂ÊâçÁü•ÈÅì‰Ω†ÁöÑÊï∞ÊçÆÊòØË¶ÅÈÄÅÂà∞Âì™Èáå„ÄÇ ÂáÜÂ§áÂ∑•‰ΩúËøòÊ≤°ÊúâÂÆå„ÄÇÊé•‰∏ãÊù•ËøòÊúâÈÉ®Èó®Ë¶ÅÂÆ°Ê†∏‚Äî‚ÄîARP„ÄÇARP‰∏ªË¶ÅË¥üË¥£ÊääIPÂú∞ÂùÄÂØπÂ∫îÂà∞Á°¨‰ª∂Âú∞ÂùÄ„ÄÇÁõ¥Êé•ËØ¥ÂêßÔºåÈÉΩÊÄ™‰∫åÂ±Ç‰∫§Êç¢Êú∫Â§™‚ÄúÂÇª‚ÄùÔºå‰∏çËÉΩÊ†πÊçÆIPÂú∞ÂùÄÁõ¥Êé•ÊâæÂà∞Áõ∏Â∫îÁöÑËÆ°ÁÆóÊú∫ÔºåÂè™ËÉΩÊ†πÊçÆÁ°¨‰ª∂Âú∞ÂùÄÊù•Êâæ„ÄÇ‰∫éÊòØÔºå‰∏ªÊú∫ÊàñËÄÖ‰∏âÂ±Ç‰∫§Êç¢Êú∫(‰∏çÊòØÊåá‰∫§Êç¢Êú∫ÂïäÔºåARP ÊòØÂ∑•‰ΩúÂú®ÁΩëÁªúÂ±ÇÁöÑÔºå‰∏çÊòØÊï∞ÊçÆÈìæË∑ØÂ±ÇÂïä)Â∞±ÁªèÂ∏∏‰øùÁïô‰∏ÄÂº†IPÂú∞ÂùÄ‰∏éÁ°¨‰ª∂Âú∞ÂùÄÁöÑÂØπÂ∫îË°®‰ª•‰æøÂÖ∂Êü•ÊâæÁõÆÁöÑÂú∞„ÄÇËÄåARPÂ∞±ÊòØÁî®Êù•ÁîüÊàêËøôÂº†Ë°®ÁöÑ„ÄÇÊØîÂ¶ÇÔºöÂΩì‚ÄúÂ∞èÂæ∑‚ÄùË¢´ÈÄÅÂà∞ARPÊâãÈáå‰πãÂêéÔºåARPÂ∞±Ë¶ÅÂú®Ë°®ÈáåÈù¢Êü•ÊâæÔºåÁúãÁúã‚ÄúÂ∞èÂæ∑‚ÄùÁöÑIPÂú∞ÂùÄ‰∏é‰∫§Êç¢Êú∫ÁöÑÂì™‰∏™Á´ØÂè£ÂØπÂ∫îÔºåÁÑ∂ÂêéËΩ¨ÂèëËøáÂéª„ÄÇÂ¶ÇÊûúÊ≤°ÊâæÂà∞ÔºåÂàôÂèë‰∏Ä‰∏™ÂπøÊí≠ÁªôÊâÄÊúâÂÖ∂‰ªñÁöÑ‰∫§Êç¢Êú∫Á´ØÂè£ÔºåÈóÆËøôÊòØË∞ÅÁöÑIPÂú∞ÂùÄÔºåÂ¶ÇÊûúÊúâ‰∫∫ÂõûÁ≠îÔºåÂ∞±ËΩ¨ÂèëÁªôÂÆÉ„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÔºåÂ∞±ÂáÜÂ§áÁî±‰∫åÂ±Ç‰∫§Êç¢Êú∫ËΩ¨ÂèëÂà∞Ë∑ØÁî±Âô®ÔºàËøô‰πãÂâçÈÉΩÊòØÂú®‰∏ªÊú∫ÈáåÊü•ËØ¢ ARP Ë°®ÔºâÔºåËµ∞Âá∫Â±ÄÂüüÁΩë‰∫Ü„ÄÇÔºàÂÖ∂ÂÆûÂ∞±ÊòØÊàë‰ª¨Ë¶ÅÂèëÈÄÅ‰ø°ÊÅØÔºåÊàë‰ª¨Âè™Áü•ÈÅìË¶ÅÂèëÁªôÁöÑ‰∏ªÊú∫ÁöÑipÂú∞ÂùÄÔºå‰ΩÜÊòØ‰∏çÂèØËÉΩÁü•ÈÅì‰∏ªÊú∫ÁöÑMACÂú∞ÂùÄ„ÄÇ‰ΩÜÊòØ‰∫§Êç¢Êú∫Ë¶ÅÈÄöËøáMACÂú∞ÂùÄËΩ¨ÂèëÔºåÊâÄ‰ª•Â∞±Êúâ‰∫ÜËøô‰πà‰∏Ä‰∏™ARPË°®ÔºåÊîæÂú®‰∏ªÊú∫ÊàñËÄÖ‰∏âÂ±Ç‰∫§Êç¢Êú∫ÈáåÔºâ ÁªèËøá‰∏ÄÁï™ÊäòËÖæÔºå‚ÄúÂ∞èÂæ∑‚ÄùÁªà‰∫éË¶ÅËµ∞Âá∫Ëøô‰∏™ÂÄíÈúâÁöÑÂ±ÄÂüüÁΩë‰∫Ü„ÄÇÂèØÂú®Ê≠§‰πãÂâçÔºåÂÆÉ‰ª¨ËøòÊ≤°ÂøòÁªô‚ÄúÂ∞èÂæ∑‚ÄùÂ±ÅËÇ°ÂêéÈù¢Áõñ‰∏™‚ÄúÊà≥‚ÄùÔºåËØ¥ÊòØ‰ªÄ‰πàCRCÊ†°È™åÂÄºÔºåÊÄï‚ÄúÂ∞èÂæ∑‚ÄùÂú®ÊóÖË°åÈÄî‰∏≠Áº∫ËÉ≥ËÜäÂ∞ëËÖøÔºåËøòÂæóÈ∫ªÁÉ¶ÂÆÉ‰ª¨ÈáçÊñ∞ÂèëÈÄÅ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇÊàëÈù†~~~~Ê≥®ÔºöÂæàÂ§ö‰∫∫ÂºÑ‰∏çÊ∏ÖFCSÂíåCRC„ÄÇÊâÄË∞ìÁöÑCRCÊòØ‰∏ÄÁßçÊ†°È™åÊñπÊ≥ïÔºåÁî®Êù•Á°Æ‰øùÊï∞ÊçÆÂú®‰º†ËæìËøáÁ®ã‰∏≠‰∏ç‰ºö‰∏¢ÂåÖÔºåÊçüÂùèÁ≠âÁ≠âÔºåFCSÊòØÊï∞ÊçÆÂåÖÔºàÂáÜÁ°ÆÁöÑËØ¥ÊòØframeÔºâÈáåÁöÑ‰∏Ä‰∏™Âå∫ÂüüÔºåÁî®Êù•Â≠òÊîæCRCÁöÑËÆ°ÁÆóÁªìÊûúÁöÑ„ÄÇÂà∞‰∫ÜÁõÆÁöÑÂú∞‰πãÂêéÔºåÁõÆÁöÑËÆ°ÁÆóÊú∫Ë¶ÅÊ£ÄÊü•FCSÈáåÁöÑCRCÂÄºÔºåÂ¶ÇÊûú‰∏éÂéüÊù•ÁöÑÁõ∏ÂêåÔºåÂàôËØ¥ÊòéÊï∞ÊçÆÂú®ÈÄî‰∏≠Ê≤°ÊúâÊçüÂùè„ÄÇ Âú®Ëµ∞Âá∫Âéª‰πãÂâçÔºåÈÇ£‰∫õÂÆ∂‰ºôÊúÄÂêéÊäòÁ£®‰∫Ü‰∏ÄÊ¨°‚ÄúÂ∞èÂæ∑‚Äù‚Äî‚ÄîÊääÂ∞èÂæ∑Ë∫´‰∏ä‰ºóÂ§öÁöÑ0Âíå1ÔºåÂºÑÊàê‰∫Ü‰ªÄ‰πà‚ÄúÈ´òÁîµÂéã‚Äù‚Äú‰ΩéÁîµÂéã‚ÄùÔºåÂú®ÂèåÁªûÁ∫ø‰∏ä‰º†ÈÄÅ‰∫ÜÂá∫Âéª„ÄÇÊôï~~Âá∫Ë∂üÈó®Â∞±Ëøô‰πàÈ∫ªÁÉ¶ÂêóÔºü ÂùêÁùÄÂèåÁªûÁ∫øÊóÖÊ∏∏ÔºåÁàΩÔºÅÂèØÂΩìÁúãÂà∞ÂæàÂ§ö‰∫∫ÂùêÁùÄÂêåËΩ¥ÁîµÁºÜÔºåËøòÊúâÂùêÂÖâÁ∫§ÁöÑÊó∂ÂÄôÔºåÂ∞èÂæ∑ÂèàÊÑüËßâ‰∏çÊòØÈÇ£‰πàÁàΩ‰∫Ü„ÄÇÂ∞±Âú®ËøôÊó∂ÔºåÊù•Âà∞‰∫ÜÊóÖÈÄîÁöÑ‰∏≠ËΩ¨Á´ô‚Äî‚ÄîË∑ØÁî±Âô®„ÄÇËøôÂú∞ÊñπÂèØÊòØÈ´òÁ∫ßÂú∫ÊâÄÔºå‰∫∫ÂÆ∂Áõ¥Êé•Êü•ÁúãIPÂú∞ÂùÄÔºÅÂâ©‰∏ãÁöÑ‰∏ÄÊ¶Ç‰∏çÁÆ°Ôºå‰∫§Áªô‰∏ãÈù¢ÁöÑ‰∫∫ÂéªÂÅö„ÄÇÂ§üÁâõÂêßÔºüË∑ØÁî±Âô®ÁöÑÂÜÖÈÉ®‰πüÊúâ‰∏ÄÂº†Ë°®ÔºåÂè´ÂÅöË∑ØÁî±Ë°®ÔºåÈáåÈù¢Ê†áËØÜÁùÄÂì™‰∏Ä‰∏™ÁΩëÁªúÁöÑIPÂØπÂ∫îÁùÄË∑ØÁî±Âô®ÁöÑÂì™‰∏Ä‰∏™Á´ØÂè£„ÄÇËøô‰∏™Ë°®‰πü‰∏çÊòØÂ§©ÁîüÂ∞±ÊúâÁöÑÔºåËÄåÊòØÈù†Ë∑ØÁî±Âô®‰πãÈó¥‰∫íÁõ∏‚ÄúÂ≠¶‰π†‚Äù‰πãÂêéÁîüÊàêÁöÑÔºåÂΩìÁÑ∂‰πüÂèØ‰ª•Áî±ÁÆ°ÁêÜÂëòÊâãÂ∑•ËÆæÂÆö„ÄÇËøô‰∏™‚ÄúÂ≠¶‰π†‚ÄùÁöÑËøáÁ®ãÊòØ‰æùÈù†Ë∑ØÁî±ÂçèËÆÆÊù•ÂÆåÊàêÁöÑÔºåÊØîÂ¶ÇRIPÔºåEIGRPÔºåOSPFÁ≠âÁ≠â„ÄÇ ÂΩìË∑ØÁî±Âô®Êü•Áúã‰∫Ü‚ÄúÂ∞èÂæ∑‚ÄùÁöÑIPÂú∞ÂùÄ‰ª•ÂêéÔºåÊ†πÊçÆË∑ØÁî±Ë°®Áü•ÈÅì‰∫ÜÂ∞èÂæ∑Ë¶ÅÂéªÁöÑÁΩëÁªúÔºåÊé•ÁùÄÂ∞±ÊääÂ∞èÂæ∑ËΩ¨Âà∞‰∫ÜÁõ∏Â∫îÁöÑÁ´ØÂè£‰∫Ü„ÄÇËá≥Ê≠§ÔºåË∑ØÁî±Âô®ÁöÑ‰∏ªË¶ÅÂ∑•‰ΩúÂÆåÊàêÔºå‰∏ãÈù¢ÂèàÊòØÊâìÂåÖÔºåÂ∞ÅË£ÖÊàêframeÔºåËΩ¨Êç¢ÊàêÁîµÂéã‰ø°Âè∑Á≠â‰∏ÄÁ≥ªÂàó‚ÄúÊäòËÖæ‚ÄùÁöÑÊ¥ªÔºåÂ∞±Áî±Êï∞ÊçÆÈìæË∑ØÂ±ÇÂíåÁâ©ÁêÜÂ±ÇÁöÑÊ®°ÂùóÂéªÂπ≤Âêß„ÄÇ Â∞èÂæ∑‰ªéË∑ØÁî±Âô®ÁöÑÂá∫Âè£Âá∫Êù•Ôºå‰æøÊù•Âà∞‰∫ÜÁõÆÁöÑÂú∞‚Äî-ÁîµËÑëB‚Äî-ÊâÄÂ±ûÁöÑÁΩëÁªúÁöÑÈªòËÆ§ÁΩëÂÖ≥„ÄÇÈªòËÆ§ÁΩëÂÖ≥ÂèØ‰ª•ÊòØË∑ØÁî±Âô®ÁöÑ‰∏Ä‰∏™Á´ØÂè£Ôºå‰πüÂèØ‰ª•ÊòØÂ±ÄÂüüÁΩëÈáåÁöÑÂêÑÁßçÊúçÂä°Âô®„ÄÇ‰∏çÁÆ°ÊÄéÊ†∑Ôºå‰∏ãÈù¢ÁöÑËøáÁ®ãËøòÊòØ‰∏ÄÊ†∑ÁöÑÔºöÂà∞‰∏âÂ±Ç‰∫§Êç¢Êú∫ÈáåÁöÑARPË°®Êü•ËØ¢‚ÄúÂ∞èÂæ∑‚ÄùÁöÑIPÂú∞ÂùÄÔºåÁúãÁúãÂ±û‰∫éÂì™‰∏™Â±ÄÂüüÁΩëÊÆµÊàñÁ´ØÂè£ÔºåÁÑ∂ÂêéÂ∞±ËΩ¨ÂèëÂà∞B‰∫Ü„ÄÇ Ëøõ‰∫ÜBÁöÑÁΩëÂç°‰πãÂêéÔºåËøòË¶ÅÂ±ÇÂ±Ç‚ÄúÂâ•ÁöÆ‚ÄùÔºåÂü∫Êú¨‰∏äÂíå‰ªéAÂá∫Êù•ÁöÑÁ®ãÂ∫èÊòØ‰∏ÄÊ†∑ÁöÑ‚Äî‚ÄîÁîµËÑëBÂÖàÊ†°È™å‰∏Ä‰∏ãCRCÂÄºÔºåÁúãÁúãÊï∞ÊçÆÊòØÂê¶ÂÆåÊï¥ÔºõÁÑ∂ÂêéÊ£ÄÊü•‰∏Ä‰∏ãframeÁöÑÂ∞ÅË£ÖÔºåÁúãÂà∞ÊòØIPÂçèËÆÆ‰πãÂêéÔºåÂ∞±Êää‚ÄúÂ∞èÂæ∑‚Äù‰∫§ÁªôIP‚ÄúÈÉ®Èó®‚Äù‰∫ÜÔºõIPÂçèËÆÆ‰∏ÄÁúãÁõÆÁöÑÂú∞ÂùÄÔºåÊ≠£Á°ÆÔºåÂÜçÁúãÁúãÂ∫îÁî®ÂçèËÆÆÔºåÊòØICMP„ÄÇ‰∫éÊòØÁü•ÈÅì‰∫ÜËØ•ÊÄé‰πàÂÅö‰∫Ü‚Äî‚Äî‰∫ßÁîü‰∏Ä‰∏™ÂõûÂ∫îÊï∞ÊçÆÂåÖÔºåÔºàÂèØ‰ª•ÂëΩÂêç‰∏∫‚ÄúÂõûÂ∫îÂ∞èÂæ∑‚ÄùÔºâÔºåÂπ∂ÂáÜÂ§á‰ª•ÂêåÊ†∑ÁöÑÈ°∫Â∫èÂêëËøúÁ´ØÁöÑAÂèëÈÄÅ„ÄÇ„ÄÇËá≥‰∫éÂàöÂàöÊî∂Âà∞ÁöÑÈÇ£‰∏™Êï∞ÊçÆÂåÖÂ∞±‰∏¢ÂºÉ‰∫Ü„ÄÇ ‰∏Ä‰∏™Âá∫Âè£Â§ö‰∏™ÂÖ•Âè£ÁöÑÊòØ‰∫§Êç¢Êú∫ÔºåÊØè‰∏™ÂÖ•Âè£ÈÉΩÂØπÂ∫îÁùÄ‰∏Ä‰∏™ÁªàÁ´ØÔºåÊòØÁΩëÁªú‰º†ËæìÂºÄÂßãÁöÑÈÉ®ÂàÜÔºåÈÄöËøá MAC Âú∞ÂùÄËΩ¨Âèë Â§ö‰∏™Âá∫Âè£Â§ö‰∏™ÂÖ•Âè£ÁöÑÊòØË∑ØÁî±Âô®Ôºå‰ºöËß£Êûê IP Â§¥ÔºåÊâæÂà∞ÈÄÇÂêàÁöÑÂá∫Âè£Â∞ÜÊï∞ÊçÆ‰º†ËæìÂá∫Âéª„ÄÇ ÂÆ∂Áî®Ë∑ØÁî±Âô®=‰∫§Êç¢Êú∫+NAT„ÄÇÂ¶ÇÊûúÁî®‰∫§Êç¢Êú∫Áõ∏ÂΩì‰∫éÊØèÂè∞ÂÆ∂Áî®ËÆæÂ§áÈúÄË¶Å‰∏Ä‰∏™ IPÔºå‰ΩÜÊòØÂ¶ÇÊûú‰ΩøÁî®ÂÆ∂Áî®Ë∑ØÁî±Âô®ÔºåÈÇ£‰πàÈÄöËøá NAT Âè™ÈúÄË¶ÅÁªô‰∏Ä‰∏™ IP Âç≥ÂèØ„ÄÇ IPÂçèËÆÆIPÁΩëÁªúÂçèËÆÆÁΩëÁªúÂ±ÇÁöÑ‰∏ã‰∏ÄÂ±Ç‚Äî‚ÄîÊï∞ÊçÆÈìæË∑ØÂ±Ç‰∏ªË¶Å‰ΩúÁî®ÊòØÂú®‰∫íËøûÂêå‰∏ÄÁßçÊï∞ÊçÆÈìæË∑ØËäÇÁÇπ‰πãÈó¥ËøõË°åÂåÖ‰º†ÈÄí(Â±ÄÂüüÁΩë)„ÄÇËÄå‰∏ÄÊó¶Ë∑®Ë∂äÂ§öÁßçÊï∞ÊçÆÈìæË∑ØÔºåÂ∞±ÈúÄË¶ÅÂÄüÂä©ÁΩëÁªúÂ±Ç„ÄÇÁΩëÁªúÂ±ÇÂèØ‰ª•Ë∑®Ë∂ä‰∏çÂêåÊï∞ÊçÆÈìæË∑ØÔºåÂç≥‰ΩøÂú®‰∏çÂêåÊï∞ÊçÆÈìæË∑Ø‰∏ä‰πüËÉΩÂÆûÁé∞‰∏§Á´ØËäÇÁÇπ‰πãÈó¥ÁöÑÊï∞ÊçÆÂåÖ‰º†Ëæì„ÄÇ ÈÖçÊúâIPÁöÑÂú∞ÂùÄÁöÑËÆæÂ§áÁß∞‰∏∫‰∏ªÊú∫„ÄÇÂíåË∑ØÁî±Âô®‰∏çÂêåÔºåË∑ØÁî±Âô®Âç≥ÈÖçÊúâIPÂú∞ÂùÄÔºåÂèàÂÖ∑ÊúâË∑ØÁî±ÊéßÂà∂ËÉΩÂäõ„ÄÇËäÇÁÇπÊòØ‰∏ªÊú∫ÂíåË∑ØÁî±Âô®ÁöÑÁªüÁß∞„ÄÇ ÁΩëÁªúÂ±Ç‰∏éÊï∞ÊçÆÈìæË∑ØÂ±ÇÂÖ≥Á≥ªÔºöÊï∞ÊçÆÈìæË∑ØÂ±ÇÊèê‰æõÁõ¥Ëøû‰∏§‰∏™ËÆæÂ§áÁöÑËÉΩÂäõ„ÄÇ‰∏é‰πãÁõ∏ÊØîÔºåÁΩëÁªúÂ±ÇÁöÑIPÂàôË¥üË¥£Âú®Ê≤°ÊúâÁõ¥ËøûÁöÑ‰∏§‰∏™ÁΩëÁªú‰πãÈó¥ËøõË°åÈÄö‰ø°‰º†Ëæì„ÄÇÊØîÂ¶ÇÊóÖË°åÔºåÊï∞ÊçÆÈìæË∑ØÁõ∏ÂΩì‰∫éÂêÑ‰∏™‰∏≠ËΩ¨ÁöÑÁÅ´ËΩ¶Á•®ÔºåËÄåIPÁõ∏ÂΩì‰∫éÊòØ‰∏™ÊóÖË°åË°®„ÄÇÊ≤°ÊúâËΩ¶Á•®ÔºåÊó†Ê≥ïËææÂà∞ÁõÆÁöÑÂú∞ÔºåÊ≤°ÊúâÊóÖË°åË°®ÔºåÂàô‰∏çÁü•ÈÅìÂÅö‰ªÄ‰πàËΩ¶„ÄÇ IPÂü∫Á°ÄÁü•ËØÜIPÂ§ßËá¥ÂàÜ‰∏∫‰∏âÂ§ßÊ®°ÂùóÔºåIPÂØªÂùÄÔºåË∑ØÁî±ÔºåIPÂàÜÂåÖÂíåÁªÑÂåÖ„ÄÇ ‰∏∫ËØÜÂà´ÈÄö‰ø°ÂØπÁ´ØÔºåÂøÖÈ°ªÊúâ‰∏Ä‰∏™Á±ª‰ºº‰∫éÂú∞ÂùÄÁöÑËØÜÂà´Á†ÅËøõË°åÊ†áËØÜ„ÄÇMACÂú∞ÂùÄÊ≠£ÊòØÁî®Êù•Ê†áËØÜÂêå‰∏Ä‰∏™ÈìæË∑Ø‰∏≠‰∏çÂêåËÆ°ÁÆóÊú∫ÁöÑ‰∏ÄÁßçËØÜÂà´Á†Å„ÄÇIP‰πüÊúâËøôÁßçÂú∞ÂùÄ‰ø°ÊÅØÔºåÁî®‰∫éÂú®ËøûÊé•Âà∞ÁΩëÁªú‰∏≠ÁöÑÊâÄÊúâ‰∏ªÊú∫‰∏≠ËØÜÂà´Âá∫ËøõË°åÈÄö‰ø°ÁöÑÁõÆÊ†áÂú∞ÂùÄ„ÄÇÂõ†Ê≠§ÔºåTCP/IP‰∏≠ÊâÄÊúâ‰∏ªÊú∫ÊàñË∑ØÁî±ÂøÖÈ°ªËÆæÂÆöËá™Â∑±ÁöÑIPÂú∞ÂùÄ„ÄÇ Ë∑ØÁî±ÊéßÂà∂Â∞ÜÂàÜÁªÑÊï∞ÊçÆÂèëÈÄÅÂà∞ÊúÄÁªàÁõÆÊ†áÂú∞ÂùÄ„ÄÇ‰∏∫‰∫ÜÂ∞ÜÊï∞ÊçÆÂèëÁªôÁõÆÊ†á‰∏ªÊú∫ÔºåÊâÄÊúâ‰∏ªÊú∫ÈÉΩÁª¥Êä§ÁùÄ‰∏ÄÂº†Ë∑ØÁî±ÊéßÂà∂Ë°®„ÄÇËØ•Ë°®ËÆ∞ÂΩïIPÊï∞ÊçÆÂú®‰∏ã‰∏ÄÊ≠•Â∫îËØ•ÂèëÁªôÂì™‰∏™Ë∑ØÁî±Âô®„ÄÇIPÂåÖÂ∞ÜÊ†πÊçÆËøô‰∏™Ë∑ØÁî±Ë°®Âú®ÂêÑ‰∏™Êï∞ÊçÆÈìæË∑Ø‰∏ä‰º†Ëæì„ÄÇ IPÂú∞ÂùÄÁöÑÂü∫Á°ÄÁü•ËØÜIPÂú∞ÂùÄÁî±ÁΩëÁªúÊ†áËØÜÂíå‰∏ªÊú∫Ê†áËØÜÁªÑÊàê„ÄÇÁΩëÁªúÊ†áËØÜÂøÖÈ°ª‰øùËØÅÁõ∏‰∫íËøûÊé•ÁöÑÊØè‰∏™ÊÆµÁöÑÂú∞ÂùÄ‰∏çÈáçÂ§ç„ÄÇËÄåÁõ∏ÂêåÊÆµÂÜÖÁõ∏ËøûÁöÑ‰∏ªÊú∫ÂøÖÈ°ªÊúâÁõ∏ÂêåÁöÑÁΩëÁªúÂú∞ÂùÄ„ÄÇIPÂú∞ÂùÄÁöÑ‚Äú‰∏ªÊú∫Ê†áËØÜ‚ÄùÂàô‰∏çÂÖÅËÆ∏Âú®Âêå‰∏Ä‰∏™ÁΩëÊÆµÂÜÖÈáçÂ§çÂá∫Áé∞„ÄÇ ÂπøÊí≠Âú∞ÂùÄÁî®‰∫éÂú®Âêå‰∏Ä‰∏™ÈìæË∑Ø‰∏≠‰∫íÁõ∏ËøûÊé•ÁöÑ‰∏ªÊú∫Èó¥ÂèëÈÄÅÊï∞ÊçÆ„ÄÇÂ∞Ü‰∏ªÊú∫Âú∞ÂùÄÈÉ®ÂàÜÂÖ®ÈÉ®ËÆæÁΩÆ‰∏∫1ÔºåÂ∞±Êàê‰∫ÜÂπøÊí≠Âú∞ÂùÄ„ÄÇ Â§öÊí≠Áî®‰∫éÂ∞ÜÂåÖÂèëÈÄÅÁªôÁâπÂÆöÁªÑÂÜÖÁöÑÊâÄÊúâ‰∏ªÊú∫„ÄÇÂá°ÊòØ‰ª•1110ÂºÄÂ§¥ÁöÑÈÉΩÊòØÂ§öÊí≠Âú∞ÂùÄÔºåÂâ©‰∏ãÁöÑ28‰∏∫ÊòØÂ§öÊí≠ÁöÑÁªÑÁºñÂè∑„ÄÇ ÁΩëÁªúÊ†áËØÜÁõ∏ÂêåÁöÑËÆ°ÁÆóÊú∫ÂøÖÈ°ªÂ±û‰∫éÂêå‰∏ÄÈìæË∑ØÔºå‰ΩÜÂ¶ÇAÁ±ªBÁ±ªÂ∞Ü‰∫ßÁîüÂ§ßÈáèÊµ™Ë¥πÁöÑÂú∞ÂùÄÔºåÂõ†‰∏∫‰∏çÂèØËÉΩÊúâÈÇ£‰πàÂ§ö‰∏ªÊú∫ËøûÊé•Âú®‰∏Ä‰∏™ÈìæË∑Ø‰∏ä„ÄÇÁé∞Âú®ÔºåÂèØ‰ª•ÈÄöËøá‰∏Ä‰∏™Âè´ÂÅö‚ÄùÂ≠êÁΩëÊé©Á†Å‚ÄúÁöÑËØÜÂà´Á†ÅÈÄöËøáÂ≠êÁΩëÁΩëÁªúÂú∞ÂùÄÁªÜÂàÜÂá∫ÊØîABCÊõ¥Â∞èÁ≤íÂ∫¶ÁöÑÁΩëÁªú„ÄÇÂ≠êÁΩëÊé©Á†Å‰πüÊòØ32‰ΩçÔºåÂØπÂ∫îÁΩëÁªúÂú∞ÂùÄÁöÑÈÉ®ÂàÜ‰∏∫1ÔºåÂØπÂ∫î‰∏ªÊú∫Âú∞ÂùÄÁöÑÈÉ®ÂàÜÂØπÂ∫î‰∏∫0„ÄÇÊØîÂ¶ÇAÁ±ªÁΩëÁªúÁöÑÂ≠êÁΩëÊé©Á†ÅÂ∞±ÊòØ255.0.0.0(Ââç8‰ΩçÂÖ®ÊòØ1)ÔºåBÁ±ªÁΩëÁªúÁöÑÂ≠êÁΩëÊé©Á†ÅÂ∞±ÊòØ255.255.0.0(Ââç16‰ΩçÂÖ®ÊòØ1)„ÄÇ Áî±‰∫é‰∫íËÅîÁΩëÁöÑÊôÆÂèäÔºåIPÂú∞ÂùÄ‰∏çË∂≥ÈóÆÈ¢ò‰∏•Èáç„ÄÇ‰∫éÊòØÂá∫Áé∞ÁßÅÊúâÁΩëÁªúÁöÑIPÂú∞ÂùÄ„ÄÇÂÆÉÁöÑÂú∞ÂùÄËåÉÂõ¥ÔºöAÁ±ªÔºå10.0.0.0-10.2555.255.255ÔºõBÁ±ªÔºå172.16.0.0-172.31.255.255ÔºõCÁ±ªÔºå192.168.0.0-192.168.255.255„ÄÇÂåÖÂê´Âú®Ëøô‰∏™ËåÉÂõ¥ÂÜÖÁöÑIPÈÉΩÂ±û‰∫éÁßÅÊúâIPÔºåÂú®Ê≠§‰πãÂ§ñÁöÑIPÁß∞‰∏∫ÂÖ®Â±ÄIP„ÄÇÂÜÖÈÉ®ÊØè‰∏™ÁªàÁ´Ø‰ΩøÁî®ÁßÅÊúâIPÔºåËÄåÂú®Ë∑ØÁî±Âô®(ÂÆΩÂ∏¶Ë∑ØÁî±Âô®)ÊàñÂøÖË¶ÅÊúçÂä°Âô®‰∏äËÆæÁΩÆÂÖ®Â±ÄIP„ÄÇÂΩìÈÖçÊúâÁßÅÊúâIPÁöÑ‰∏ªÊú∫ËÅîÁΩëÊó∂Ôºå‰ΩøÁî®NATËøõË°åÈÄö‰ø°„ÄÇ ÂØπ‰∫éFTTHÂíåADSLÊúçÂä°ÔºåÁΩëÁªú‰æõÂ∫îÂïÜÁõ¥Êé•ÁªôÁî®Êà∑ÂàÜÈÖçÂÖ®Â±ÄIPÂú∞ÂùÄÔºåÂπ∂‰∏îÊØèÊ¨°Áî®Êà∑ÈáçËøûÔºåËØ•IPÂú∞ÂùÄÈÉΩÂèØËÉΩÂèëÁîüÂèòÂåñ„ÄÇËøôÈáåÁöÑIPÂú∞ÂùÄÁî±‰æõÂ∫îÂïÜÁª¥Êä§Ôºå‰∏çÈúÄË¶ÅÁî®Êà∑Ëá™Â∑±Áî≥ËØ∑ÂÖ®Â±ÄIP„ÄÇ Ë∑ØÁî±ÊéßÂà∂‰ªÖ‰ªÖÊúâIPÂú∞ÂùÄ‰∏çË∂≥‰ª•ÂÆûÁé∞Â∞ÜÊï∞ÊçÆÂåÖÂèëÈÄÅÂà∞ÂØπÁ´ØÁõÆÊ†áÂú∞ÂùÄÔºåÂú®Êï∞ÊçÆÂèëÈÄÅËøáÁ®ã‰∏≠ËøòÈúÄË¶ÅÊåáÊòéË∑ØÁî±Âô®Êàñ‰∏ªÊú∫ÁöÑ‰ø°ÊÅØÔºå‰ª•‰æøÁúüÊ≠£ÂèëÂæÄÁõÆÊ†áÂú∞ÂùÄ„ÄÇ‰øùÂ≠òËøôÁßç‰ø°ÊÅØÁöÑÂ∞±ÊòØË∑ØÁî±ÊéßÂà∂Ë°®„ÄÇ Ë∑ØÁî±ÊéßÂà∂Ë°®ËÆ∞ÂΩïÁùÄÁΩëÁªúÂú∞ÂùÄÂíå‰∏ã‰∏ÄÊ≠•Â∫îËØ•ÂèëÈÄÅËá≥Ë∑ØÁî±Âô®ÁöÑÂú∞ÂùÄ„ÄÇÂèëÈÄÅIPÂåÖÊó∂ÔºåÂÖàÁ°ÆÂÆöIPÂåÖÈ¶ñÈÉ®‰∏≠ÁöÑÁõÆÊ†áÂú∞ÂùÄÔºåÂÜç‰ªéË∑ØÁî±ÊéßÂà∂Ë°®‰∏≠ÊâæÂà∞‰∏éËØ•Âú∞ÂùÄÂÖ∑ÊúâÁõ∏ÂêåÁΩëÁªúÂú∞ÂùÄÁöÑËÆ∞ÂΩïÔºåÊ†πÊçÆËØ•ËÆ∞ÂΩïÂ∞ÜIPÂåÖËΩ¨ÂèëÁªôÁõ∏Â∫îÁöÑ‰∏ã‰∏Ä‰∏™Ë∑ØÁî±Âô®„ÄÇ Ë∑ØÁî±ÁÆóÊ≥ïË∑ùÁ¶ªÂêëÈáèÁÆóÊ≥ïÈááÁî®Bellman-FordÁÆóÊ≥ïÔºå‰øùÂ≠òÁΩëÁªú‰∏≠ÁöÑÊâÄÊúâË∑ØÁî±Âô®ÂèäÁΩëÁªúÁöÑÊãìÊâëÂõæ„ÄÇÊØîËæÉË¥πÊó∂Ë¥πÊÄßËÉΩ„ÄÇ ÈìæË∑ØÁä∂ÊÄÅÁÆóÊ≥ïÈááÁî®Dijkstra ÁÆóÊ≥ï„ÄÇ ÂΩì‰∏Ä‰∏™Ë∑ØÁî±Âô®ÂêØÂä®ÁöÑÊó∂ÂÄôÔºåÂêëÈÇªÂ±ÖÂèëÈÄÅÊ∂àÊÅØÔºåÈÇªÂ±ÖÁ´ãÂàªÂõûÂ§çÔºå‰ªéËÄåËÆ°ÁÆóÂíåÈÇªÂ±ÖÁöÑË∑ùÁ¶ª„ÄÇÁÑ∂ÂêéÂ∞ÜËá™Â∑±ÂíåÈÇªÂ±ÖÁöÑÈìæË∑ØÁä∂ÊÄÅÂπøÊí≠Âá∫ÂéªÔºåÂèëÈÄÅÂà∞Êï¥‰∏™ÁΩëÁªúÁöÑÊâÄÊúâË∑ØÁî±Âô®„ÄÇÂõ†Ê≠§ÔºåÊØè‰∏Ä‰∏™Ë∑ØÁî±Âô®ÈÉΩÂèØ‰ª•Âú®Êú¨Âú∞ÊûÑÂª∫‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÂõæÔºåÁÑ∂Âêé‰ΩøÁî® Dijkstra ÁÆóÊ≥ïÔºåÊâæÂà∞‰∏§ÁÇπÁöÑÊúÄÁü≠Ë∑ØÂæÑ„ÄÇ IPÂçèËÆÆÁõ∏ÂÖ≥ICMPICMP ‰∏ªË¶ÅÁî®Êù•Á°ÆËÆ§ IP ÂåÖÊòØÂê¶ÊàêÂäüÂà∞ËææÁõÆÊ†áÂú∞ÂùÄ„ÄÇ‰ΩøÁî® UDP ÂçèËÆÆ„ÄÇ‰∏ÄËà¨ÊâÄËØ¥ÁöÑ ping ‰∏Ä‰∏™ IP Â∞±ÊòØ‰ΩøÁî® ICMP ÂçèËÆÆ„ÄÇ NATNAT Áî®‰∫éÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî®ÁßÅÊúâÂú∞ÂùÄÔºåÂú®ËøûÊé•‰∫íËÅîÁΩëÊó∂‰ΩøÁî®ÂÖ®Â±Ä IP Âú∞ÂùÄ„ÄÇNAT ‰∏ªË¶ÅËß£ÂÜ≥ÁöÑÊòØ IPv4 IP Âú∞ÂùÄÊûØÁ´≠ÁöÑÈóÆÈ¢ò„ÄÇ NAT ÂÜÖÈÉ®ÁöÑÊú∫Âô®ÈÄöËøá NAT Ë∑ØÁî±Âô®Â∞ÜÂÜÖÈÉ® IP ËΩ¨Âåñ‰∏∫Â§ñÈÉ® IPÔºå‰∏éÂ§ñÈÉ®Êú∫Âô®ÈÄö‰ø°„ÄÇ NAT ÂÜÖÈÉ®Áª¥Êä§‰∫Ü‰∏Ä‰∏™ NAT ËΩ¨ÂåñË°®„ÄÇÂ∞ÜÂÜÖÈÉ®‰∏çÂêåÁöÑÊú∫Âô®Êò†Â∞Ñ‰∏∫‰∏çÂêåÁöÑÁ´ØÂè£Âè∑„ÄÇÊØîÂ¶ÇÂÜÖÈÉ® 10.0.0.10 Êò†Â∞Ñ‰∏∫Â§ñÈÉ®IP 202.244.174.37:1025ÔºåÂ∞Ü 10.0.0.11Êò†Â∞Ñ‰∏∫Â§ñÈÉ® IP 202.244.174.37:1026 ÂÖ∂ÂÆûÂ∞±ÊòØËôΩÁÑ∂Âè™Êúâ‰∏Ä‰∏™Â§ñÁΩëIPÔºå‰ΩÜÊòØÂèØ‰ª•ÈÄöËøáÁ´ØÂè£Âè∑ÊãìÂ±ïÂæàÂ§öÁöÑÂÜÖÈÉ®Êú∫Âô®„ÄÇ ÂØπ‰∫éÁ¨¨ÂõõÂ±ÇÊòØTCPÊàñUDPÁöÑÊï∞ÊçÆÂåÖÔºåNATÈÄöËøáÊõ¥ÊîπÊ∫êÁ´ØÂè£Âè∑ÔºåÊù•ÂÆûÁé∞Â§öÂØπÂ∞ëÁöÑÊò†Â∞Ñ„ÄÇ ÂØπ‰∫éICMPÂåÖÔºåNATÈÄöËøáÊõ¥ÊîπICMPÁöÑIDÔºåÊù•ÂÆûÁé∞Â§öÂØπÂ∞ëÁöÑÊò†Â∞Ñ„ÄÇ ÔºàNATËøùÂèç‰∫ÜÂü∫Êú¨ÁöÑÁΩëÁªúÂàÜÂ±ÇÁªìÊûÑÊ®°ÂûãÁöÑËÆæËÆ°ÂéüÂàô„ÄÇÂõ†‰∏∫Âú®‰º†ÁªüÁöÑÁΩëÁªúÂàÜÂ±ÇÁªìÊûÑÊ®°Âûã‰∏≠ÔºåÁ¨¨NÂ±ÇÊòØ‰∏çËÉΩ‰øÆÊîπÁ¨¨N+1Â±ÇÁöÑÊä•Â§¥ÂÜÖÂÆπÁöÑ„ÄÇNATÁ†¥Âùè‰∫ÜËøôÁßçÂêÑÂ±ÇÁã¨Á´ãÁöÑÂéüÂàô„ÄÇÔºâ DNSDNSÂ∏ÆÂä©Áî®Êà∑Âú®‰∫íËÅîÁΩë‰∏äÂØªÊâæË∑ØÂæÑ„ÄÇÂú®‰∫íËÅîÁΩë‰∏äÁöÑÊØè‰∏Ä‰∏™ËÆ°ÁÆóÊú∫ÈÉΩÊã•Êúâ‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑÂú∞ÂùÄÔºåÁß∞‰Ωú‚ÄúIPÂú∞ÂùÄ‚ÄùÔºàÂç≥‰∫íËÅîÁΩëÂçèËÆÆÂú∞ÂùÄÔºâ„ÄÇÁî±‰∫éIPÂú∞ÂùÄÔºà‰∏∫‰∏Ä‰∏≤Êï∞Â≠óÔºâ‰∏çÊñπ‰æøËÆ∞ÂøÜÔºåDNSÂÖÅËÆ∏Áî®Êà∑‰ΩøÁî®‰∏Ä‰∏≤Â∏∏ËßÅÁöÑÂ≠óÊØçÔºàÂç≥‚ÄúÂüüÂêç‚ÄùÔºâÂèñ‰ª£„ÄÇÂú®ÊØèÊ¨° TCP/IP ÈÄö‰ø°ÂâçÔºåÈÉΩ‰ºöÂÖàÈÄöËøá UDP ÂçèËÆÆÔºåÂêë DNS ÊúçÂä°Âô®ËØ∑Ê±Ç IP Âú∞ÂùÄ„ÄÇ ÂÖ∂ÂÆûdnsÁ≥ªÁªüÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÊ†ëÁä∂Êû∂ÊûÑÔºåÊàë‰ª¨ËÆæÁΩÆÁöÑdnsÊúçÂä°Âô®ÂÖ∂ÂÆûÂ∫îËØ•Âè´dnsÁºìÂ≠òÊü•ËØ¢ÊúçÂä°Âô®ÔºåÂÆÉÊòØ‰∏∫‰∫ÜÂáèËΩª‰∫íËÅîÁΩë‰∏ädnsÊü•ËØ¢ÁöÑË¥üËΩΩÊâÄËÆæËÆ°ÁöÑ„ÄÇÂ¶ÇÊûú‰Ω†ÁöÑËØ∑Ê±ÇÊ≤°ÊúâÂëΩ‰∏≠ÁºìÂ≠òÔºåÈÇ£‰πàËøô‰∏™ÁºìÂ≠òÊúçÂä°Âô®Â∞±‰ºöËá™Â∑±ËøõË°å‰∏ÄÊ¨°Ê†áÂáÜÊü•ËØ¢ÔºåÁÑ∂ÂêéÂÜçÊääÁªìÊûúÁºìÂ≠òËµ∑Êù•ÔºåÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØ‰ªéÊ†πÊúçÂä°Âô®ÂºÄÂßã‰∏ÄÁ∫ß‰∏ÄÁ∫ßÁöÑÈóÆ„ÄÇÊàë‰ª¨‰ª•ÂâçÁªèÂ∏∏Ë∞àÂà∞Ê†πÊúçÂä°Âô®ÁöÑÈáçË¶ÅÊÄßÂÖ∂ÂÆûÂ∞±‰ΩìÁé∞Âú®ËøôÈáå‰∫ÜÔºåÂÆÉ‰øùÁïô‰∫ÜÂØπÊâÄÊúâÂüüÂêçÁöÑËµ∑ÂßãËß£ÈáäÊùÉ„ÄÇ ‰∏äÈù¢ËÆ≤Âà∞Ê†πÊúçÂä°Âô®Êã•Êúâ‰∏ÄÂàáÂüüÂêçÁöÑËµ∑ÂßãËß£ÈáäÊùÉÔºå‰ΩÜÊòØÂ¶ÇÊûú‰Ω†ÂéªÈóÆÊ†πÊúçÂä°Âô®ÂÆÉÊòØ‰∏ç‰ºöÁõ¥Êé•ÂëäËØâ‰Ω†ÊúÄÁªàÁ≠îÊ°àÁöÑ„ÄÇÂõ†‰∏∫Â¶ÇÊûúÂÆÉË¶ÅÂ≠òÂÇ®ÊâÄÊúâÁöÑËÆ∞ÂΩïÔºåÈÇ£ÂÆÉ‰πüÂ§™Á¥Ø‰∫ÜÔºåËøô‰∏™Ë¥üËΩΩÂíåÂºÄÈîÄÊòØÊÉä‰∫∫ÁöÑ„ÄÇÈÇ£ÂÆÉ‰ºöÂëäËØâ‰Ω†‰ªÄ‰πàÂë¢ÔºüÂÆÉ‰ºöÂëäËØâ‰Ω†Â∫îËØ•ÂéªÈóÆË∞ÅÔºå‰πüÂ∞±ÊòØÂÆÉÊéàÊùÉ‰∏ã‰∏ÄÁ∫ßÊúçÂä°Âô®Êù•Ëß£Á≠î‰Ω†ÁöÑÈóÆÈ¢ò„ÄÇÊâÄ‰ª•ÂèØËßÅÔºådnsÁ≥ªÁªüÊú¨Ë∫´ÊòØ‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÁöÑÁΩëÁªú„ÄÇ DNS Âä´ÊåÅ DNSÂä´ÊåÅÂ∞±ÊòØÈÄöËøáÂä´ÊåÅ‰∫ÜDNSÊúçÂä°Âô®ÔºåÈÄöËøáÊüê‰∫õÊâãÊÆµÂèñÂæóÊüêÂüüÂêçÁöÑËß£ÊûêËÆ∞ÂΩïÊéßÂà∂ÊùÉÔºåËøõËÄå‰øÆÊîπÊ≠§ÂüüÂêçÁöÑËß£ÊûêÁªìÊûúÔºåÂØºËá¥ÂØπËØ•ÂüüÂêçÁöÑËÆøÈóÆÁî±ÂéüIPÂú∞ÂùÄËΩ¨ÂÖ•Âà∞‰øÆÊîπÂêéÁöÑÊåáÂÆöIPÔºåÂÖ∂ÁªìÊûúÂ∞±ÊòØÂØπÁâπÂÆöÁöÑÁΩëÂùÄ‰∏çËÉΩËÆøÈóÆÊàñËÆøÈóÆÁöÑÊòØÂÅáÁΩëÂùÄÔºå‰ªéËÄåÂÆûÁé∞Á™ÉÂèñËµÑÊñôÊàñËÄÖÁ†¥ÂùèÂéüÊúâÊ≠£Â∏∏ÊúçÂä°ÁöÑÁõÆÁöÑ„ÄÇDNSÂä´ÊåÅÈÄöËøáÁØ°ÊîπDNSÊúçÂä°Âô®‰∏äÁöÑÊï∞ÊçÆËøîÂõûÁªôÁî®Êà∑‰∏Ä‰∏™ÈîôËØØÁöÑÊü•ËØ¢ÁªìÊûúÊù•ÂÆûÁé∞ÁöÑ„ÄÇ ÂØπ‰∫éDNSÂä´ÊåÅÔºåÂèØ‰ª•ÈááÁî®‰ΩøÁî®ÂõΩÂ§ñÂÖçË¥πÂÖ¨Áî®ÁöÑDNSÊúçÂä°Âô®Ëß£ÂÜ≥„ÄÇ‰æãÂ¶ÇOpenDNSÔºà208.67.222.222ÔºâÊàñGoogleDNSÔºà8.8.8.8Ôºâ„ÄÇ DNS Ê±°ÊüìDNSÊ±°ÊüìÊòØ‰∏ÄÁßçËÆ©‰∏ÄËà¨Áî®Êà∑Áî±‰∫éÂæóÂà∞ËôöÂÅáÁõÆÊ†á‰∏ªÊú∫IPËÄå‰∏çËÉΩ‰∏éÂÖ∂ÈÄö‰ø°ÁöÑÊñπÊ≥ïÔºåÊòØ‰∏ÄÁßçDNSÁºìÂ≠òÊäïÊØíÊîªÂáªÔºàDNS cache poisoningÔºâ„ÄÇÂÖ∂Â∑•‰ΩúÊñπÂºèÊòØÔºöÁî±‰∫éÈÄöÂ∏∏ÁöÑDNSÊü•ËØ¢Ê≤°Êúâ‰ªª‰ΩïËÆ§ËØÅÊú∫Âà∂ÔºåËÄå‰∏îDNSÊü•ËØ¢ÈÄöÂ∏∏Âü∫‰∫éÁöÑUDPÊòØÊó†ËøûÊé•‰∏çÂèØÈù†ÁöÑÂçèËÆÆÔºåÂõ†Ê≠§DNSÁöÑÊü•ËØ¢ÈùûÂ∏∏ÂÆπÊòìË¢´ÁØ°ÊîπÔºåÈÄöËøáÂØπUDPÁ´ØÂè£53‰∏äÁöÑDNSÊü•ËØ¢ËøõË°åÂÖ•‰æµÊ£ÄÊµãÔºå‰∏ÄÁªèÂèëÁé∞‰∏éÂÖ≥ÈîÆËØçÁõ∏ÂåπÈÖçÁöÑËØ∑Ê±ÇÂàôÁ´ãÂç≥‰º™Ë£ÖÊàêÁõÆÊ†áÂüüÂêçÁöÑËß£ÊûêÊúçÂä°Âô®ÔºàNSÔºåName ServerÔºâÁªôÊü•ËØ¢ËÄÖËøîÂõûËôöÂÅáÁªìÊûú„ÄÇ ÂØπ‰∫éDNSÊ±°ÊüìÔºåÂèØ‰ª•ËØ¥Ôºå‰∏™‰∫∫Áî®Êà∑ÂæàÈöæÂçïÂçïÈù†ËÆæÁΩÆËß£ÂÜ≥ÔºåÈÄöÂ∏∏ÂèØ‰ª•‰ΩøÁî®VPNÊàñËÄÖÂüüÂêçËøúÁ®ãËß£ÊûêÁöÑÊñπÊ≥ïËß£ÂÜ≥Ôºå‰ΩÜËøôÂ§ßÂ§öÈúÄË¶ÅË¥≠‰π∞‰ªòË¥πÁöÑVPNÊàñSSHÁ≠âÔºå‰πüÂèØ‰ª•ÈÄöËøá‰øÆÊîπHostsÁöÑÊñπÊ≥ïÔºåÊâãÂä®ËÆæÁΩÆÂüüÂêçÊ≠£Á°ÆÁöÑIPÂú∞ÂùÄ„ÄÇ HTTPDNSHTTPNDS ÂÖ∂ÂÆûÂ∞±ÊòØÔºå‰∏çËµ∞‰º†ÁªüÁöÑ DNS Ëß£ÊûêÔºåËÄåÊòØËá™Â∑±Êê≠Âª∫Âü∫‰∫é HTTP ÂçèËÆÆÁöÑ DNS ÊúçÂä°Âô®ÈõÜÁæ§ÔºåÂàÜÂ∏ÉÂú®Â§ö‰∏™Âú∞ÁÇπÂíåÂ§ö‰∏™ËøêËê•ÂïÜ„ÄÇÂΩìÂÆ¢Êà∑Á´ØÈúÄË¶Å DNS Ëß£ÊûêÁöÑÊó∂ÂÄôÔºåÁõ¥Êé•ÈÄöËøá HTTP ÂçèËÆÆËøõË°åËØ∑Ê±ÇËøô‰∏™ÊúçÂä°Âô®ÈõÜÁæ§ÔºåÂæóÂà∞Â∞±ËøëÁöÑÂú∞ÂùÄ„ÄÇ ÂÖ∂ÂÆûÂ∞±ÊòØÂ∞±ËøëÊâæ DNS ÊÄªÁªìDNSÂä´ÊåÅÂ∞±ÊòØÊåáÁî®Êà∑ËÆøÈóÆ‰∏Ä‰∏™Ë¢´Ê†áËÆ∞ÁöÑÂú∞ÂùÄÊó∂ÔºåDNSÊúçÂä°Âô®ÊïÖÊÑèÂ∞ÜÊ≠§Âú∞ÂùÄÊåáÂêë‰∏Ä‰∏™ÈîôËØØÁöÑIPÂú∞ÂùÄÁöÑË°å‰∏∫„ÄÇ DNSÊ±°ÊüìÔºåÊåáÁöÑÊòØÁî®Êà∑ËÆøÈóÆ‰∏Ä‰∏™Âú∞ÂùÄÔºåÂõΩÂÜÖÁöÑÊúçÂä°Âô®(ÈùûDNS)ÁõëÊéßÂà∞Áî®Êà∑ËÆøÈóÆÁöÑÂ∑≤ÁªèË¢´Ê†áËÆ∞Âú∞ÂùÄÊó∂ÔºåÊúçÂä°Âô®‰º™Ë£ÖÊàêDNSÊúçÂä°Âô®ÂêëÁî®Êà∑ÂèëÂõûÈîôËØØÁöÑÂú∞ÂùÄÁöÑË°å‰∏∫„ÄÇ ‰øÆÊîπDNSÂèØ‰ª•ÊâãÂä®‰øÆÊîπÊú¨Êú∫ÁöÑ DNSÔºå‰πüÂèØ‰ª•‰∏ç‰øÆÊîπ‰ΩøÁî®Ë∑ØÁî±Âô®ÁöÑ DNSÔºåË∑ØÁî±Âô®ÂèØ‰ª•ÊâãÂä®‰øÆÊîπ DNSÔºå‰πüÂèØ‰ª•‰∏ç‰øÆÊîπ‰ΩøÁî®ËøêËê•ÂïÜÁöÑ DNS„ÄÇ ÈôÑÔºö GFW ÁöÑÂÆûÁé∞GFW Â∞±ÊòØÊâÄËØ¥ÁöÑÂ¢ôÔºåÊúâ‰∏âÁßçÊñπÂºèÂ±èËîΩÁΩëÁªú‰∏ä‰º†Êí≠ÁöÑÂÜÖÂÆπÔºö ÂÜÖÂÆπÂÆ°Êü•GFWÁöÑÂÜÖÂÆπÂÆ°Êü•ÈíàÂØπHTTP‰º†ËæìÂçèËÆÆÁöÑÈªòËÆ§Á´ØÂè£ÁöÑ80Á´ØÂè£ÔºåHTTP‰º†Êí≠ÁöÑÂÜÖÂÆπÊòØÊòéÊñáÁöÑÂÜÖÂÆπÔºåÊ≤°ÊúâÁªèËøáÂä†ÂØÜÔºåGFWÊòØ‰∏Ä‰∏™IDS[Intrusion detection system(ÂÖ•‰æµÊ£ÄÊµãÁ≥ªÁªü)]ÔºåGFWÊúâ‰∏Ä‰∏™ÊïèÊÑüÂ≠óÂêçÂçïÔºåËã•Âú®‰∏≠ÂõΩÂ§ßÈôÜËÆøÈóÆÂ¢ÉÂ§ñÁöÑ‰∏ªÊú∫ÁöÑHTTPÁöÑÊï∞ÊçÆÊµÅÈáåÂèëÁé∞ÊïèÊÑüÂ≠óÁúºÔºåÂ∞±Âú®‰∏§Âè∞‰∏ªÊú∫Èó¥‰º™ÈÄ†‰∏Ä‰∏™‚Äùreset‚Äù‰ø°Âè∑ÔºåÂØºËá¥ÂèåÊñπ‰∏ªÊú∫‰ª•‰∏∫ÂØπÊñπ‰∏≠Ê≠¢‰∫ÜËØ∑Ê±Ç„ÄÇ DNSÂä´ÊåÅÂíåÊ±°ÊüìDNSÂä´ÊåÅÔºöÈÄöËøáÁΩëÁªúÊúçÂä°Êèê‰æõÂïÜ(Internet ServiceProvider/ISP)Êèê‰æõÁöÑDNSÊúçÂä°Âô®ËøõË°åDNSÊ¨∫È™óÔºåÂΩì‰∫∫‰ª¨ËÆøÈóÆÊüê‰∏™ÁΩëÁ´ôÊó∂ÔºåÈúÄË¶ÅË¶ÅÊääÂüüÂêçËΩ¨Êç¢‰∏∫‰∏Ä‰∏™IPÂú∞ÂùÄÔºåDNSÊúçÂä°Âô®Ë¥üË¥£Â∞ÜÂüüÂêçËΩ¨Êç¢‰∏∫IPÂú∞ÂùÄÔºå‰∏≠ÂõΩÂ§ßÈôÜÁöÑISPÊé•ÂèóÈÄö‰ø°ÁÆ°ÁêÜÂ±ÄÁöÑÂ±èËîΩÁΩëÁ´ôÁöÑÊåá‰ª§ÂêéÂú®DNSÊúçÂä°Âô®ÈáåÂä†ÂÖ•Êüê‰∫õÁâπÂÆöÂüüÂêçÁöÑËôöÂÅáAËÆ∞ÂΩïÔºåÂΩì‰ΩøÁî®Ê≠§DNSÊúçÂä°Âô®ÁöÑÁΩëÁªúÁî®Êà∑ËÆøÈóÆÊ≠§ÁâπÂÆöÁΩëÁ´ôÊó∂ÔºåDNSÊúçÂä°‰æøÁªôÂá∫ÂÅáÁöÑIPÂú∞ÂùÄÔºåÂØºËá¥ËÆøÈóÆÁΩëÁ´ôÂ§±Ë¥•ÔºåÁîöËá≥ËøîÂõûISPËøêËê•ÂïÜÊèê‰æõÁöÑÂá∫ÈîôÈ°µÈù¢ÂíåÂπøÂëäÈ°µÈù¢„ÄÇ DNSÊ±°ÊüìÔºöGFWÂú®DNSÊü•ËØ¢‰ΩøÁî®ÁöÑUDP53Á´ØÂè£‰∏äÊ†πÊçÆÈªëÂêçÂçïËøõË°åËøáÊª§ÔºåÈÅáÂà∞ÈÄöÂæÄÂõΩÂ§ñÁöÑ‰ΩøÁî®UDPÁöÑ53Á´ØÂè£ËøõË°åÊü•ËØ¢ÁöÑDNSËØ∑Ê±ÇÔºåÂ∞±ËøîÂõû‰∏Ä‰∏™ËôöÂÅáÁöÑIPÂú∞ÂùÄÔºàÂç≥‰ΩøÁî®ÂõΩÂ§ñÁöÑÊúçÂä°Âô®Êü•ËØ¢Â∞±‰ºöËøîÂõû‰∏Ä‰∏™ËôöÂÅáÁöÑÂú∞ÂùÄÔºâ„ÄÇ Â±èËîΩIPÊúâ‰∫õ‰∫∫Êîπ‰∫Ü hostsÔºåÁõ¥Êé•Â∞ÜË∞∑Ê≠åÁöÑÂüüÂêçÊò†Â∞ÑÂà∞ ipÔºå‰ΩÜÊòØGFWÂèØ‰ª•ÈÄöËøáË∑ØÁî±Âô®(router)Êù•ÊéßÂà∂ÁöÑÔºåÂú®ÈÄöÂæÄÂõΩÂ§ñÁöÑÊúÄÂêé‰∏Ä‰∏™ÁΩëÂÖ≥‰∏äÂä†‰∏ä‰∏ÄÊù°‰º™ÈÄ†ÁöÑË∑ØÁî±ËßÑÂàôÔºåÂØºËá¥ÈÄöÂæÄÊüê‰∫õË¢´Â±èËîΩÁöÑÁΩëÁ´ôÁöÑÊâÄÊúâIPÊï∞ÊçÆÂåÖÊó†Ê≥ïÂà∞Ëææ„ÄÇË∑ØÁî±Âô®ÁöÑÊ≠£Â∏∏Â∑•‰ΩúÊñπÂºèÊòØÂ≠¶‰π†Âà´ÁöÑË∑ØÁî±Âô®ÂπøÊí≠ÁöÑË∑ØÁî±ËßÑÂàôÔºåÈÅáÂà∞Á¨¶ÂêàÂ∑≤Áü•ÁöÑIPËΩ¨ÂèëËßÑÂàôÁöÑÊï∞ÊçÆÂåÖÔºåÂàôÊåâÂ∑≤ÁªèËßÑÂàôÂèëÈÄÅÔºåÈÅáÂà∞Êú™Áü•ËßÑÂàôIPÁöÑÊï∞ÊçÆÔºåÂàôËΩ¨ÂèëÂà∞‰∏ä‰∏ÄÁ∫ßÁΩëÂÖ≥„ÄÇGFWÁöÑË∑ØÁî±Âô®ÊåâÈªëÂêçÂçï(blacklist)Êù•ËΩ¨ÂèëÁâπÂÆöÁöÑIPÊï∞ÊçÆÂåÖÔºåÂàôÂèØÂ±èËîΩÁâπÂÆöÁöÑÁΩëÁ´ôÁöÑIPÔºåÊ≠§IPÈªëÂêçÂçï‰∏çÊòØÂõ∫ÂÆöÁöÑÔºå‰ºöÊõ¥Êñ∞„ÄÇ TCP‰∏éUDPTCPÊ¶ÇËø∞tcpÈááÂèñÂÖ®ÂèåÂ∑•(full-duplex)‰º†ËæìÔºå‰πüÂ∞±ÊòØ‰º†ËæìËøáÁ®ã‰∏≠ÔºåÂêå‰∏ÄËøûÊé•ÂèØ‰ª•‰º†ËæìÂèåÂêëÁöÑÊï∞ÊçÆÊµÅÔºåÂèëÈÄÅÊñπÂèØ‰ª•‰º†ÁªôÊé•Êî∂ÊñπÔºåÊé•Êî∂Êñπ‰πüÂèØ‰ª•‰º†ÁªôÂèëÈÄÅÊñπ„ÄÇ tcpÊòØÈù¢ÂêëËøûÊé•ÁöÑÂçèËÆÆ„ÄÇÂÖ∂ÂÆûÔºåÁΩëÁªú‰∏äÁöÑ‰º†ËæìÊòØÊ≤°ÊúâËøûÊé•ÁöÑÔºåÂåÖÊã¨TCP‰πüÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇËÄåTCPÊâÄË∞ìÁöÑ‚ÄúËøûÊé•‚ÄùÔºåÂÖ∂ÂÆûÂè™‰∏çËøáÊòØÂú®ÈÄöËÆØÁöÑÂèåÊñπÁª¥Êä§‰∏Ä‰∏™‚ÄúËøûÊé•Áä∂ÊÄÅ‚ÄùÔºåËÆ©ÂÆÉÁúã‰∏äÂéªÂ•ΩÂÉèÊúâËøûÊé•‰∏ÄÊ†∑„ÄÇÊâÄ‰ª•ÔºåTCPÁöÑÁä∂ÊÄÅÂèòÊç¢ÊòØÈùûÂ∏∏ÈáçË¶ÅÁöÑ„ÄÇ TCP ÂèëÈÄÅ‰ø°ÊÅØËøáÁ®ã ËøûÊé•ËøáÁ®ã client ÂèëÈÄÅ‰∏Ä‰∏™ÂêåÊ≠•Ê∂àÊÅØ SYN ÔºåÂêåÊó∂ÂèëÈÄÅÈöèÊú∫ seq ‰∏∫ xÔºåÂëäËØâserver ÂèëÈÄÅÁöÑÂåÖÂ∫èÂè∑‰ªé x ÂºÄÂßã„ÄÇ server Êî∂Âà∞ÂêåÊ≠•Ê∂àÊÅØÂêéÔºå‰πüËøîÂõû‰∏Ä‰∏™ SYN ‰ø°Âè∑ÔºåÂêåÊó∂ËøîÂõû‰∏Ä‰∏™ ACK ‰ø°Âè∑‰∏∫ x+1ÔºåË°®Á§∫Áü•ÈÅì‰∫Ü‰Ω†ÁöÑÂ∫èÂè∑ÔºåËøòËøîÂõû‰∫Ü server ÁöÑÈöèÊú∫ seq ‰∏∫ yÔºåÂëäËØâ clientÔºåserver Á´ØÂ∫èÂè∑‰ªé y ÂºÄÂßã„ÄÇ client Êî∂Âà∞ÂêéÔºåËøîÂõû‰∏Ä‰∏™ ACK ‰∏∫ y+1ÔºåË°®Á§∫ client Áü•ÈÅì server ÁöÑÂºÄÂßãÂ∫èÂè∑‰∫Ü„ÄÇ Êñ≠ÂºÄËøûÊé•ËøáÁ®ã client ÂèëÈÄÅ‰∏Ä‰∏™Êñ≠ËøûÊ∂àÊÅØ FIN Ôºå‰ª•ÂèäÈöèÊú∫ seq server Êî∂Âà∞ÂêåÊ≠•Ê∂àÊÅØÂêéÔºåËøîÂõû‰∏Ä‰∏™ ACK ‰ø°Âè∑ ‰πãÂêéÔºåÂú® server Á´ØÂÜ≥ÂÆöÁöÑ‰ªªÊÑèÊó∂ÂàªÔºåÂèëËµ∑‰∏Ä‰∏™Êñ≠Ëøû‰ø°Âè∑ FINÔºå‰ª•ÂèäÈöèÊú∫ seq client Êî∂Âà∞ÂêéÔºåËøîÂõû‰∏Ä‰∏™ ACK ÊúÄÂêéË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂÆ¢Êà∑Á´ØÈúÄË¶ÅÂú®Êî∂Âà∞ÊúçÂä°Á´ØÁöÑ FIN Âπ∂‰∏îÂèëÈÄÅ ACK ‰πãÂêéË¶ÅÁ≠â‰∏§‰∏™Êó∂Èó¥Á™óÂÜçÂÖ≥„ÄÇÂõ†‰∏∫ÂÆ¢Êà∑Á´ØÂèëÈÄÅÁöÑ ACK ÂèØËÉΩÊ≤°ÊúâÂà∞ËææÊúçÂä°Á´Ø„ÄÇÊúçÂä°Á´Ø‰ºö‰∏çÂÅúÁöÑÂèëÈÄÅ FINÔºåÊâÄ‰ª•Ë¶ÅÁ≠âÂæÖ‰∏ÄÊÆµÊó∂Èó¥ÔºåÁ°ÆËÆ§ÊúçÂä°Á´ØÂ∑≤ÁªèÂÖ≥Èó≠‰∫ÜÔºåÂÆ¢Êà∑Á´ØÂÜçÂÖ≥Èó≠„ÄÇ TCP Â¶Ç‰ΩïÂÆûÁé∞ÂèØÈù†‰º†Ëæì Á°ÆËÆ§ÂíåÈáç‰º† Êï∞ÊçÆÊ†°È™å Êï∞ÊçÆÂêàÁêÜÂàÜÁâá‰∏éÊéíÂ∫è ÊµÅÈáèÊéßÂà∂ Êã•Â°ûÊéßÂà∂ TCP Á°ÆËÆ§‰∏éÈáç‰º†Êú∫Âà∂‰∏ÄÁßçÊñπÂºèÊòØË∂ÖÊó∂Èáç‰º†ÔºåÂ∞±ÊòØÂØπÊØè‰∏Ä‰∏™Ê≤°Êúâ ACK ÁöÑÂåÖÈÉΩËÆæÁΩÆ‰∏Ä‰∏™ÂÆöÊó∂Âô®ÔºåË∂ÖËøá‰∏ÄÂÆöÊó∂Èó¥ÂêéÂ∞ùËØïÈáç‰º†„ÄÇË∂ÖÊó∂Èáç‰º†ÁöÑÂë®Êúü‰∏çÂÆúËøáÁü≠‰πü‰∏çÂÆúËøáÈïøÔºåËøáÁü≠Âà´‰∫∫ÂèØËÉΩÁúüÁöÑÊ≤°ÊúâÊé•Êî∂Âà∞ÔºåËøáÈïøÂèà‰ºöÈòªÂ°û‰ø°ÊÅØ‰º†Ëæì„ÄÇ‰∏ÄËà¨ÁöÑÁ≠ñÁï•ÊòØÊØèÂΩìÈÅáÂà∞‰∏ÄÊ¨°Ë∂ÖÊó∂Èáç‰º†ÁöÑÊó∂ÂÄôÔºåÈÉΩ‰ºöÂ∞Ü‰∏ã‰∏ÄÊ¨°Ë∂ÖÊó∂Êó∂Èó¥Èó¥ÈöîËÆæ‰∏∫ÂÖàÂâçÂÄºÁöÑ‰∏§ÂÄç„ÄÇ‰∏§Ê¨°Ë∂ÖÊó∂ÔºåÂ∞±ËØ¥ÊòéÁΩëÁªúÁéØÂ¢ÉÂ∑ÆÔºå‰∏çÂÆúÈ¢ëÁπÅÂèçÂ§çÂèëÈÄÅ„ÄÇ ÈíàÂØπË∂ÖÊó∂Èáç‰º†Âë®ÊúüÂèØËÉΩËøáÈïøÁöÑÈóÆÈ¢òÔºåÈááÂèñÂø´ÈÄüÈáç‰º†ÁöÑÊú∫Âà∂„ÄÇÂΩìÊé•Êî∂ÊñπÊî∂Âà∞‰∏Ä‰∏™Â∫èÂè∑Â§ß‰∫é‰∏ã‰∏Ä‰∏™ÊâÄÊúüÊúõÁöÑÊä•ÊñáÊÆµÊó∂ÔºåÂ∞±Ê£ÄÊµãÂà∞‰∫ÜÊï∞ÊçÆÊµÅ‰∏≠ÁöÑ‰∏Ä‰∏™Èó¥Ê†ºÔºåÊé•Êî∂ÊñπËøòÊòØÂèëÈÄÅÊúüÊúõÊä•ÊñáÊÆµ‰πãÂâçÁöÑÊä•ÊñáÁöÑ ACK„ÄÇÂΩìÂÆ¢Êà∑Á´ØËøûÁª≠Êî∂Âà∞‰∏â‰∏™ËøôÊ†∑ÁöÑ ACK Êó∂ÔºåÂ∞±Âú®ÂÆöÊó∂Âô®ËøáÊúü‰πãÂâçÔºåÈáç‰º†‰∏¢Â§±ÁöÑÊä•ÊñáÊÆµ„ÄÇ Âø´ÈÄüÈáç‰º†Ëß£ÂÜ≥‰∫ÜÈáç‰º†Âë®ÊúüÈïøÁöÑÈóÆÈ¢òÔºå‰ΩÜÊòØÊ≤°Ëß£ÂÜ≥Èáç‰º†‰∏Ä‰∏™ËøòÊòØÈáç‰º†Â§ö‰∏™ÁöÑÈóÆÈ¢ò„ÄÇÂõ†Ê≠§ËøòÂá∫Áé∞‰∫ÜÈÄâÊã©Á°ÆËÆ§Êú∫Âà∂ÔºåTCP Â§¥ÈáåÂä†‰∏Ä‰∏™ SACK ÁöÑ‰∏úË•øÔºåÂèØ‰ª•Â∞ÜÁºìÂ≠òÁöÑÂú∞ÂõæÂèëÈÄÅÁªôÂèëÈÄÅÊñπ„ÄÇËøôÊ†∑‰∏Ä‰∏ãÂ≠êÂ∞±ËÉΩÁü•ÈÅì‰∏¢Â§±‰∫Ü‰ªÄ‰πà„ÄÇ TCP ÊµÅÈáèÊéßÂà∂Êú¨Ë¥®‰∏äÂ∞±ÊòØÂú®ÂèëÈÄÅÊñπÁª¥ÊåÅ‰∏Ä‰∏™ÊªëÂä®Á™óÔºåÁ™óÁöÑÂ§ßÂ∞èÁî±Êé•Êî∂Á´ØÊéßÂà∂„ÄÇ TCP Êã•Â°ûÊéßÂà∂ÊªëÂä®Á™óÂè£ rwnd ÊòØÊÄïÂèëÈÄÅÊñπÊääÊé•Êî∂ÊñπÁºìÂ≠òÂ°ûÊª°ÔºåËÄåÊã•Â°ûÁ™óÂè£ÊòØÊÄïÊääÁΩëÁªúÂ°ûÊª°„ÄÇ TCP ‰ΩøÁî®ÊªëÂä®Á™óÁöÑÊñπÂºèÂèëÈÄÅÊï∞ÊçÆÔºåÊî∂Âèë‰∏ªÊú∫‰πãÈó¥‰∏çÂÜç‰ª•Êï∞ÊçÆÊÆµ‰∏∫Âçï‰ΩçÂèëÈÄÅÁ°ÆËÆ§Â∫îÁ≠î„ÄÇËøô‰∏™Êó∂ÂÄôÂèØËÉΩ‰∫ßÁîüÊã•Â†µ„ÄÇTCP ‰∏∫‰∫ÜÈò≤Ê≠¢ËøôÊ†∑ÁöÑÈóÆÈ¢òÔºå‰∏ÄËà¨ÈááÁî®Â¶Ç‰∏ãÂÅöÊ≥ïÔºö ÊÖ¢ÂêØÂä®Ôºö‰∏ªË¶ÅÂÅöÊ≥ïÂ∞±ÊòØËØïÊé¢ÔºåÈ¶ñÂÖàÂú®‰∏Ä‰∏™Âçï‰ΩçÊó∂Èó¥ÈáåÂèëÈÄÅ‰∏Ä‰∏™Êä•Êñá„ÄÇÂ¶ÇÊûúÊî∂Âà∞‰∫ÜÁ°ÆËÆ§ÂõûÊâßÔºåÈÇ£‰πàÁøªÂÄçÂèëÈÄÅÔºåÁõ¥Âà∞Êã•Â°ûÔºåÊï∞ÊçÆ‰∏¢Â§±ÔºåËøô‰∏ÄÈò∂ÊÆµÊä•ÊñáÁöÑÊï∞ÈáèÊòØ‰ª•ÊåáÊï∞Á∫ßÂ¢ûÈïø„ÄÇ Êã•Â°ûÈÅøÂÖçÔºöÊÖ¢ÂêØÂä®ÁöÑÊó∂ÂÄôÊòØÊåáÊï∞Â¢ûÈïøÁöÑÔºå‰ΩÜÊòØÂ¢ûÈïøÊòØÊúâ‰∏™Èó®ÈôêssthreshÁöÑÔºåÂà∞ËææÈó®ÈôêÂêéËøõÂÖ•Êã•Â°ûÈÅøÂÖçÈò∂ÊÆµ„ÄÇÊã•Â°ûÈÅøÂÖçÁä∂ÊÄÅÔºåÊØèÊ¨°Â¢ûÈïø‰∏Ä‰∏™Êä•Êñá„ÄÇ Âø´ÈÄüÊÅ¢Â§çÔºöÂΩìÂá∫Áé∞‰∏¢ÂåÖÔºåÂπ∂‰∏îÂÆûÊñΩ‰∫ÜÂø´ÈÄüÈáç‰º†ÁöÑÊó∂ÂÄôÔºåÂ∞±Ë°®ÊòéÁΩëË∑ØËøòÊòØËæÉ‰∏∫ÁïÖÈÄöÁöÑÔºåÊ≠§Êó∂Ê≠§Êó∂Â∞±‰∏ç‰ºöÁõ¥Êé•ËøõÂÖ•ÊÖ¢ÂêØÂä®Áä∂ÊÄÅÔºåËÄåÊòØÂ∞Ü‰º†ËæìÁöÑÊä•ÊñáÊï∞ÈáèÂáèÂçäÔºåÁÑ∂ÂêéÁªßÁª≠Êã•Â°ûÈÅøÂÖç„ÄÇ Âè™ÊúâÂú®Âø´ÈÄüÈáç‰º†ÁöÑÊó∂ÂÄôÊâç‰ºöËøõÂÖ•Âø´ÈÄüÊÅ¢Â§ç„ÄÇÂ¶ÇÊûúÊòØË∂ÖÊó∂Èáç‰º†ÔºåÈÇ£‰πàÂ∞±Ë¶ÅÈáçÊñ∞ËøõË°åÂèà‰∏ÄËΩÆÁöÑÊÖ¢ÂêØÂä®„ÄÇ ‰∏âÊ¨°Êè°Êâã‰∏∫‰ªÄ‰πàË¶Å‰∏âÊ¨°Êè°Êâã‰∏çÊòØ‰∏§Ê¨°Ôºü‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜËäÇÁ∫¶ server Á´ØÁöÑ socket ËµÑÊ∫ê„ÄÇÂ¶ÇÊûú‰∏§Ê¨°Êè°ÊâãÔºåÊúçÂä°Á´ØÂú®Á¨¨‰∫åÊ¨°Êè°ÊâãÂêéÁª¥Êä§‰∫Ü‰∏Ä‰∏™ËøûÊé•„ÄÇ‰ΩÜÊòØÂÆ¢Êà∑Á´ØÊ≤°ÊúâÊî∂Âà∞ÊúçÂä°Á´ØÁöÑACKÔºåËøôÊó∂ÂÄôÂÆ¢Êà∑Á´Ø‰ª•‰∏∫ÊúçÂä°Á´ØÊ≤°ÊúâÂª∫Á´ãËøûÊé•Â∞±‰ºöÈáçÊñ∞ÂèëÈÄÅ SYN ËØ∑Ê±ÇÂª∫Á´ãËøûÊé•„ÄÇÊúçÂä°Á´ØÂâç‰∏Ä‰∏™Âª∫Á´ãÁöÑËøûÊé•Â∞±ÊòØÊ≠ªËøûÊé•‰∫Ü„ÄÇ‰∏Ä‰∏™ËøõÁ®ãÊâìÂºÄÁöÑsocketÊòØÊúâÈôêÂ∫¶ÁöÑÔºå Áª¥Êä§Ëøô‰∫õÊ≠ªËøûÊé•ÈùûÂ∏∏ËÄóË¥πËµÑÊ∫ê„ÄÇ ‰∏∫‰ªÄ‰πàÊòØ‰∏âÊ¨°Êè°Êâã‰∏çÊòØÂõõÊ¨°ÔºüÂÖ∂ÂÆûÊú¨Ë∫´Ôºåclient ÂèëÈÄÅÂêåÊ≠•‰ø°Âè∑ SYN ‰ª•Âèä seqÔºåserver ÂõûÂ§ç ACKÔºåÈöèÂêé server ÂèëÈÄÅÂêåÊ≠•‰ø°Âè∑ SYN ‰ª•Âèä seqÔºåclient ÂõûÂ§ç ACK ÊòØÂõõÊ¨°„ÄÇ‰ΩÜÊòØ server ÂèëÈÄÅ seq Âíå ACK ÂèØ‰ª•ÂêàÂπ∂‰∏∫‰∏ÄÊ¨°ÔºåÂõ†Ê≠§Â∞±Âè™ÈúÄË¶Å‰∏âÊ¨°‰∫Ü„ÄÇ ÂõõÊ¨°Êå•ÊâãÊú¨Ë¥®‰∏äÂíåÊè°ÊâãÊó∂client ÈÄöÁü•Ôºåserver ÂõûÂ§ç„ÄÇserver ÈÄöÁü•Ôºåclient ÂõûÂ§ç‰∏ÄÊ†∑ÊòØÂõõÊ¨°„ÄÇ‰ΩÜÊòØÂú®ÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÁªìÊùüÁöÑÊó∂ÂÄôÔºåÊúçÂä°Á´ØÂèØËÉΩÂú®ÂèëÊï∞ÊçÆÔºåÊâÄ‰ª•‰∏çËÉΩÊää ACK Âíå FIN ÂÉèÊè°ÊâãÁöÑÊó∂ÂÄô‰∏ÄËµ∑ÂèëÈÄÅ„ÄÇÊâÄ‰ª•‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãË¶ÅÂõõÊ¨°„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÂΩìÊó∂ÊúçÂä°Á´ØÊ≤°ÊúâÂÜçÂèëÈÄÅÊï∞ÊçÆÔºåÈÇ£‰πà‰πüÂèØ‰ª•‰∏âÊ¨°Êå•Êâã„ÄÇ ÂõõÊ¨°Êå•ÊâãËÉΩÂê¶ÂèòÊàê‰∏âÊ¨°Êå•ÊâãÔºüÂèØ‰ª•ÔºåÂ¶ÇÊûúServerÂú®Êî∂Âà∞ClientÁöÑFINÂåÖÂêéÔºåÂú®‰πüÊ≤°Êï∞ÊçÆÈúÄË¶ÅÂèëÈÄÅÁªôClient‰∫ÜÔºåÈÇ£‰πàÂØπClientÁöÑACKÂåÖÂíåServerËá™Â∑±ÁöÑFINÂåÖÂ∞±ÂèØ‰ª•ÂêàÂπ∂Êàê‰∏∫‰∏Ä‰∏™ÂåÖÂèëÈÄÅËøáÂéªÔºåËøôÊ†∑ÂõõÊ¨°Êå•ÊâãÂ∞±ÂèØ‰ª•ÂèòÊàê‰∏âÊ¨°‰∫Ü„ÄÇ UDPUDP Â¶Ç‰Ωï‰øùËØÅÂèØÈù†ÊÄß‰∏∫‰ªÄ‰πàË¶ÅÂú® UDP ‰πã‰∏äÂÅöÂèØÈù†‰øùËØÅÔºåÁ©∂ÂÖ∂ÂéüÂõ†Â∞±ÊòØÂú®‰øùËØÅÈÄö‰ø°ÁöÑÊó∂Âª∂ÂíåË¥®ÈáèÁöÑÊù°‰ª∂‰∏ãÂ∞ΩÈáèÈôç‰ΩéÊàêÊú¨„ÄÇ ÈÇ£‰πàÂú® UDP ‰πã‰∏äÊÄé‰πàÂÆûÁé∞ÂèØÈù†Âë¢ÔºüÁ≠îÊ°àÂ∞±ÊòØÈáç‰º†„ÄÇ Â∞±ÊòØÊää TCP ÁöÑËøôÂá†‰∏™ÂèØÈù†ÊÄßÊú∫Âà∂ËÉΩÊê¨Â§öÂ∞ëÊê¨Â§öÂ∞ë„ÄÇ Âá†Âº†Ë°®MACÂú∞ÂùÄËΩ¨ÂèëË°®ËØ¥Âà∞MACÂú∞ÂùÄË°®ÔºåÂ∞±‰∏çÂæó‰∏çËØ¥‰∏Ä‰∏ã‰∫§Êç¢Êú∫ÁöÑÂ∑•‰ΩúÂéüÁêÜ‰∫ÜÔºåÂõ†‰∏∫‰∫§Êç¢Êú∫ÊòØÊ†πÊçÆMACÂú∞ÂùÄË°®ËΩ¨ÂèëÊï∞ÊçÆÂ∏ßÁöÑ„ÄÇÂú®‰∫§Êç¢Êú∫‰∏≠Êúâ‰∏ÄÂº†ËÆ∞ÂΩïÁùÄÂ±ÄÂüüÁΩë‰∏ªÊú∫MACÂú∞ÂùÄ‰∏é‰∫§Êç¢Êú∫Êé•Âè£ÁöÑÂØπÂ∫îÂÖ≥Á≥ªÁöÑË°®Ôºå‰∫§Êç¢Êú∫Â∞±ÊòØÊ†πÊçÆËøôÂº†Ë°®Ë¥üË¥£Â∞ÜÊï∞ÊçÆÂ∏ß‰º†ËæìÂà∞ÊåáÂÆöÁöÑ‰∏ªÊú∫‰∏äÁöÑ„ÄÇ ‰∫§Êç¢Êú∫Âú®Êé•Êî∂Âà∞Êï∞ÊçÆÂ∏ß‰ª•ÂêéÔºåÈ¶ñÂÖà„ÄÅ‰ºöËÆ∞ÂΩïÊï∞ÊçÆÂ∏ß‰∏≠ÁöÑÊ∫êMACÂú∞ÂùÄÂíåÂØπÂ∫îÁöÑÊé•Âè£Âà∞MACË°®‰∏≠ÔºåÊé•ÁùÄ„ÄÅ‰ºöÊ£ÄÊü•Ëá™Â∑±ÁöÑMACË°®‰∏≠ÊòØÂê¶ÊúâÊï∞ÊçÆÂ∏ß‰∏≠ÁõÆÊ†áMACÂú∞ÂùÄÁöÑ‰ø°ÊÅØÔºåÂ¶ÇÊûúÊúâÂàô‰ºöÊ†πÊçÆMACË°®‰∏≠ËÆ∞ÂΩïÁöÑÂØπÂ∫îÊé•Âè£Â∞ÜÊï∞ÊçÆÂ∏ßÂèëÈÄÅÂá∫Âéª(‰πüÂ∞±ÊòØÂçïÊí≠)ÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÂàô‰ºöÂ∞ÜËØ•Êï∞ÊçÆÂ∏ß‰ªéÈùûÊé•ÂèóÊé•Âè£ÂèëÈÄÅÂá∫Âéª(‰πüÂ∞±ÊòØÂπøÊí≠)„ÄÇ ‰∏äÈù¢ËØ¥ÁöÑ‰∫§Êç¢Êú∫ÊåáÁöÑÊòØ‰∫åÂ±Ç‰∫§Êç¢Êú∫ ËøôÂº†Ë°®Â≠òÂú®‰∫é‰∫§Êç¢Êú∫‰∏≠ÔºåËÆ∞ÂΩïÁöÑÊòØ MACÂú∞ÂùÄ -&gt; Á´ØÂè£ÁöÑÊò†Â∞Ñ ARPÁºìÂ≠òË°®‰∏äÈù¢Êàë‰ª¨ËÆ≤Ëß£‰∫Ü‰∫§Êç¢Êú∫ÁöÑÂ∑•‰ΩúÂéüÁêÜÔºåÁü•ÈÅì‰∫§Êç¢Êú∫ÊòØÈÄöËøáMACÂú∞ÂùÄÈÄö‰ø°ÁöÑÔºå‰ΩÜÊòØÊàë‰ª¨ÊòØÂ¶Ç‰ΩïËé∑ÂæóÁõÆÊ†á‰∏ªÊú∫ÁöÑMACÂú∞ÂùÄÂë¢ÔºüËøôÊó∂Êàë‰ª¨Â∞±ÈúÄË¶Å‰ΩøÁî®ARPÂçèËÆÆ‰∫ÜÔºåÂú®ÊØèÂè∞‰∏ªÊú∫‰∏≠ÈÉΩÊúâ‰∏ÄÂº†ARPË°®ÔºåÂÆÉËÆ∞ÂΩïÁùÄ‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄÂíåMACÂú∞ÂùÄÁöÑÂØπÂ∫îÂÖ≥Á≥ª„ÄÇARPÂçèËÆÆÊòØÂ∑•‰ΩúÂú®ÁΩëÁªúÂ±ÇÁöÑÂçèËÆÆÔºåÂÆÉË¥üË¥£Â∞ÜIPÂú∞ÂùÄËß£Êûê‰∏∫MACÂú∞ÂùÄ„ÄÇ Áü•ÈÅì‰∏ã‰∏ÄË∑≥ÁöÑ IPÔºå‰ΩÜÊòØ‰∏çÁü•ÈÅì‰∏ã‰∏ÄË∑≥ÁöÑ MAC Âú∞ÂùÄÊòØÊó†Ê≥ï‰º†ËæìÁöÑ„ÄÇÊâÄ‰ª•ÂΩìÁü•ÈÅì IP ‰ΩÜ‰∏çÁü•ÈÅì MAC Âú∞ÂùÄÁöÑÊó∂ÂÄôÔºåÂ∞±Ë¶ÅÈÄöËøá ARP ÂèëÈÄÅ‰∏Ä‰∏™ÂπøÊí≠ÂåÖÔºåÈóÆËøô‰∏™ IP ÊòØË∞ÅÁöÑÔºüMAC Âú∞ÂùÄÊòØÂ§öÂ∞ëÔºü ‰∏äÈù¢ÊåáÁöÑÊòØÂ±ÄÂüüÁΩë‰∏≠ÁöÑÊï∞ÊçÆ‰º†ÈÄí„ÄÇÈô§‰∫Ü‰∏ªÊú∫‰∏≠Ôºå‰∏âÂ±Ç‰∫§Êç¢Êú∫ÊàñËÄÖË∑ØÁî±‰∏≠‰πüÊòØÊúâ ARP Ë°®ÁöÑÔºåÊï∞ÊçÆÊúÄÁªàËΩ¨Âèë‰æùÈù†ÁöÑÈÉΩÊòØARPË°®Ôºå‰ªñÊòØÊï∞ÊçÆËΩ¨ÂèëÊúÄÂü∫Á°ÄÁöÑ‰æùÊçÆÔºåARPÁõ¥Êé•Â∞ÜÁ°¨‰ª∂Âú∞ÂùÄÂíåÁΩëÁªúÂú∞ÂùÄÁõ∏‰∫íÊò†Â∞Ñ„ÄÇ ËøôÂº†Ë°®ËÆ∞ÂΩïÁöÑÊòØ IP -&gt; MAC Âú∞ÂùÄÁöÑÊò†Â∞Ñ„ÄÇ Ë∑ØÁî±Ë°®Ë∑ØÁî±Âô®Ë¥üË¥£‰∏çÂêåÁΩëÁªú‰πãÈó¥ÁöÑÈÄö‰ø°ÔºåÂÆÉÊòØÂΩì‰ªäÁΩëÁªú‰∏≠ÁöÑÈáçË¶ÅËÆæÂ§áÔºåÂèØ‰ª•ËØ¥Ê≤°ÊúâË∑ØÁî±Âô®Â∞±Ê≤°ÊúâÂΩì‰ªäÁöÑ‰∫íËÅîÁΩë„ÄÇÂú®Ë∑ØÁî±Âô®‰∏≠‰πüÊúâ‰∏ÄÂº†Ë°®ÔºåËøôÂº†Ë°®Âè´Ë∑ØÁî±Ë°®ÔºåËÆ∞ÂΩïÁùÄÂà∞‰∏çÂêåÁΩëÊÆµÁöÑ‰ø°ÊÅØ„ÄÇ Ë∑ØÁî±Âô®ÊòØÂ∑•‰ΩúÂú®ÁΩëÁªúÂ±ÇÁöÑÔºåÂú®ÁΩëÁªúÂ±ÇÂèØ‰ª•ËØÜÂà´ÈÄªËæëÂú∞ÂùÄ„ÄÇÂΩìË∑ØÁî±Âô®ÁöÑÊüê‰∏™Êé•Âè£Êî∂Âà∞‰∏Ä‰∏™ÂåÖÊó∂ÔºåË∑ØÁî±Âô®‰ºöËØªÂèñÂåÖ‰∏≠Áõ∏Â∫îÁöÑÁõÆÊ†áÁöÑÈÄªËæëÂú∞ÂùÄÁöÑÁΩëÁªúÈÉ®ÂàÜÔºåÁÑ∂ÂêéÂú®Ë∑ØÁî±Ë°®‰∏≠ËøõË°åÊü•Êâæ„ÄÇÂ¶ÇÊûúÂú®Ë∑ØÁî±Ë°®‰∏≠ÊâæÂà∞ÁõÆÊ†áÂú∞ÂùÄÁöÑË∑ØÁî±Êù°ÁõÆÔºåÂàôÊåáÂÆö‰∏ã‰∏ÄË∑≥ ipÔºåÁÑ∂ÂêéÊääÂåÖËΩ¨ÂèëÂà∞Ë∑ØÁî±Âô®ÁöÑÁõ∏Â∫îÊé•Âè£ÔºåÂ¶ÇÊûúÂú®Ë∑ØÁî±Ë°®‰∏≠Ê≤°ÊúâÊâæÂà∞ÁõÆÊ†áÂú∞ÂùÄÁöÑË∑ØÁî±Êù°ÁõÆÔºåÈÇ£‰πàÔºåÂ¶ÇÊûúË∑ØÁî±ÈÖçÁΩÆÈªòËÆ§Ë∑ØÁî±ÔºåÂ∞±ÊåâÁÖßÈªòËÆ§Ë∑ØÁî±ÁöÑÈÖçÁΩÆËΩ¨ÂèëÂà∞Ë∑ØÁî±Âô®ÁöÑÁõ∏Â∫îÊé•Âè£ÔºõÂ¶ÇÊûúÊ≤°ÊúâÈÖçÁΩÆÈªòËÆ§Ë∑ØÁî±ÔºåÂàôÂ∞ÜËØ•ÂåÖ‰∏¢ÂºÉÔºåÂπ∂ËøîÂõû‰∏çÂèØÂà∞ËææÁöÑ‰ø°ÊÅØ„ÄÇËøôÂ∞±ÊòØÊï∞ÊçÆË∑ØÁî±ÁöÑËøáÁ®ã„ÄÇ ËøôÂº†Ë°®ËÆ∞ÂΩïÁöÑÊòØ ÁõÆÊ†áIP -&gt; ‰∏ã‰∏ÄË∑≥Ë∑ØÁî± IP ÁöÑÊò†Â∞Ñ ‰∏âÂº†Ë°®ÊòØÊúâ‰∏Ä‰∏™Â±ÇÊ¨°ÂÖ≥Á≥ªÁöÑ„ÄÇÊØèÊ¨° IP ÁöÑË∑≥ËΩ¨ÈÉΩË¶ÅÁªìÂêà‰∏âÂº†Ë°®Ôºå‰ªéÁõÆÊ†á IP Âà∞ ÁõÆÊ†á MAC ÊâÄÂú®Á´ØÂè£ÁöÑËΩ¨Êç¢„ÄÇ ÈóÆÈ¢ò ‰∏∫‰ªÄ‰πà‰∏çÊääMACÂú∞ÂùÄÂíåIPÂú∞ÂùÄÁªü‰∏ÄÊàê‰∏Ä‰∏™Âú∞ÂùÄËÄåÁî®‰∏§‰∏™Âú∞ÂùÄÔºü ‰ªÄ‰πàÊòØ‰∏≠ÁªßÂô®/ÁΩëÊ°•/Ë∑ØÁî±Âô®/‰∏âÂ±Ç‰∫§Êç¢Êú∫/‰∫åÂ±Ç‰∫§Êç¢Êú∫/ÁΩëÂÖ≥Ôºü TCP/IP ‰∫îÂ±ÇÊ®°ÂûãÂêÑÊåá‰ªÄ‰πàÔºüÂêÑËá™ÁöÑ‰ΩúÁî®ÊòØ‰ªÄ‰πàÔºü IP/ARP/TCP/UDP/HTTP/FTP Ëøô‰∫õÂçèËÆÆÂàÜÂà´Â§Ñ‰∫éÂì™‰∏ÄÂ±ÇÔºü‰ΩúÁî®ÊòØ‰ªÄ‰πàÔºü ‰ªÄ‰πàÊòØÂ∏ßÔºüIP Âú∞ÂùÄÂíå MAC Âú∞ÂùÄÂàÜÂà´ÊîæÂú®Â∏ßÁöÑÂì™‰∏ÄÈÉ®ÂàÜÔºåËøôÊ†∑Êúâ‰ªÄ‰πàÂ•ΩÂ§ÑÔºü ‰∏∫‰ªÄ‰πà TCP ÂçèËÆÆË¶ÅËøõË°å‰∏âÊ¨°Êè°ÊâãÔºåÂõõÊ¨°Êå•ÊâãÔºü ÁÆÄËø∞Êï∞ÊçÆÂåÖÂ¶Ç‰ΩïÂú®ÁΩëÁªú‰∏≠‰º†ËæìÔºü ARPÁºìÂ≠òË°®ÔºåMACÂú∞ÂùÄË°®ÔºåË∑ØÁî±Ë°®ÁöÑ‰ΩúÁî®ÂàÜÂà´ÊòØ‰ªÄ‰πàÔºü ‰ªÄ‰πàÊòØDNSÔºüÂü∫Êú¨ÂéüÁêÜÊòØ‰ªÄ‰πàÔºü‰∏∫‰ªÄ‰πàËØ¥ÂÆÉÊòØÂàÜÂ∏ÉÂºèÁöÑÁΩëÁªúÔºü ‰ªÄ‰πàÊòØDNSÂä´ÊåÅÔºü‰ªÄ‰πàÊòØDNSÊ±°ÊüìÔºü]]></content>
      <categories>
        <category>ËÆ°ÁÆóÊú∫</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[„ÄäiOS UI ÂºÄÂèëÊç∑ÂæÑ„ÄãËØª‰π¶Á¨îËÆ∞]]></title>
    <url>%2F2016%2F07%2F31%2FUI%E5%BC%80%E5%8F%91%E6%8D%B7%E5%BE%84%2F</url>
    <content type="text"><![CDATA[ËØª‰∫Ü „ÄäiOS UI ÂºÄÂèëÊç∑ÂæÑ„ÄãÔºå‰π¶‰∏äÁöÑ‰∏úË•øÊØîËæÉÁÆÄÂçïÔºå‰πüÊØîËæÉÈõ∂Á¢é„ÄÇÊâÄ‰ª•ÂÅö‰∏™Â§ßËá¥ÁöÑÊï¥ÁêÜ„ÄÇ xib Âä†ËΩΩ CellÊúâ‰∏Ä‰∏™ÁâπÊÆäÁöÑ View ÊòØ cell: 12// Âπ≥Êó∂‰ΩøÁî® loadNibNamed:owner:options ÊñπÊ≥ï‰ºöÂÖàÊää xib Âä†ËΩΩÂà∞ÂÜÖÂ≠òÁîüÊàêÁõ∏Â∫îÁöÑ nibÔºåÂÜçÈÄöËøá nib ËΩ¨Âåñ‰∏∫ View ÂÆû‰æã„ÄÇÂØπ‰∫é UITableView Êù•ËØ¥ÔºåÈáçÂ§çÂä†ËΩΩ xib ÊòØ‰∏Ä‰∏™ËÄóÊó∂Êìç‰ΩúÔºåÊâÄ‰ª• UITableView ÈÄöËøáÊ≥®ÂÜå UINib Êù•ÁºìÂ≠ò nib[_tableView registerNib:[Nib nibWithNibNamed:@"SomeView"] bundle:nil]; xib Âä†ËΩΩ VCÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÊñπÂºèÂàõÂª∫‰∫é xib ÂÖ≥ËÅîÁöÑ VC: 1234// ÊúâÂêåÂêçÁöÑ xib Êñá‰ª∂let homeVC = HomeViewController()// Ê≤°ÊúâÂêåÂêçÁöÑ xib Êñá‰ª∂let homeVC = HomeViewController.init(nibName:"HomeViewController", bundle:nil) Âä†ËΩΩ bundle ‰∏≠ÁöÑËµÑÊ∫êÂ∫îÁî®ÁöÑ‰ª£Á†ÅÂíåËµÑÊ∫êÈÉΩÊîæÂú®Â∫îÁî®ÊâÄÂú®ÁöÑ main bundle ‰∏≠Ôºå‰∏çËøáÊúâ‰∏Ä‰∫õÁ¨¨‰∏âÊñπÁöÑ sdk ‰ºöÊääËá™Â∑±ÁöÑËµÑÊ∫êÊñá‰ª∂ÊâìÂåÖÊàê‰∏Ä‰∏™ bundle„ÄÇËøô‰∫õ bundle ‰πü‰ºö‰øùÂ≠òÂú® main bundle ‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÂÖàÊãøÂà∞ÂÖ∂ bundle ÂÜçÊãøËµÑÊ∫êÊñá‰ª∂Ôºö 12let subBundle = Bundle.init(path: Bundle.main.path(forResource: "myBundle" ofType:"bundle")!)let image = subBundle?.path(forResource: "myImage" ofType:"png")!) Âä†ËΩΩ image ÊñπÂºèÊúâ‰∏§ÁßçÊñπÂºèÂä†ËΩΩ imageÔºö 12let image = UIImage.init(named:"someImage")let image = UIImage.init(contentsOfFile:(Bundle.main.path(forResource:"someImage", ofType:"png"))!) Á¨¨‰∏ÄÁßçÈªòËÆ§Âä†ËΩΩ mainbundle ‰∏≠ÁöÑÂõæÁâáÔºåAssets.xcassets ‰∏≠ÁöÑÂõæÁâáÂè™ËÉΩÈÄöËøáÁ¨¨‰∏ÄÁßçÊñπÂºèÂä†ËΩΩ Á¨¨‰∫åÁßçÂèØ‰ª•Âä†ËΩΩ‰ªªÊÑè‰ΩçÁΩÆÁöÑÂõæÁâá„ÄÇÁ¨¨‰∏ÄÁßçÂä†ËΩΩÁöÑÂõæÁâá‰ºöË¢´Á≥ªÁªüÁºìÂ≠ò„ÄÇÊâÄ‰ª•ÊòæÁ§∫ icon ÁöÑÊó∂ÂÄôÈÄöËøáÁ¨¨‰∏ÄÁßçÊñπÂºèÂä†ËΩΩÊØîËæÉÂ•ΩÔºåÂõæÁâáËµÑÊ∫êËæÉÂ§ßÊó∂ÔºåÁî®Á¨¨‰∫åÁßçÊñπÂºè Â¶Ç‰ΩïÂà†Èô§ storyboardstoryboardÁöÑÂÖ•Âè£Âú®targets-&gt;General-&gt;Deployment Info-&gt;Main InterfaceÔºåÈªòËÆ§ÁöÑÂÄº‰∏∫MainÔºåÂç≥ÂàùÂßãÈªòËÆ§storyboardÁöÑÂêçÂ≠ó„ÄÇÂõ†Ê≠§ÔºåÊÉ≥Ë¶Å‰∏çÂä†ËΩΩstoryboardÔºåÈúÄË¶ÅÂ∞ÜËøô‰∏™ÈªòËÆ§ÂÄºÂà†ÊéâÔºåÂ∞±‰∏ç‰ºöÂÜç‰ªéstoryboardËøõÂÖ•‰∫Ü„ÄÇ ‰ΩøÁî®storyboardÁöÑÊó∂ÂÄô application:didFinishWithOptions: ÊñπÊ≥ïÂè™ËøîÂõû‰∏Ä‰∏™YES„ÄÇÂà†Èô§ÂêéÔºåÈúÄË¶ÅÊ∑ªÂä†‰ª£Á†ÅÂØπwindowÂàùÂßãÂåñÔºåÂê¶Âàôapp‰ªÄ‰πà‰πüÊòæÁ§∫‰∏ç‰∫Ü„ÄÇ 1234567- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]]; ViewController *uv = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil]; [self.window setRootViewController:uv]; [self.window makeKeyAndVisible]; return YES;&#125; Êãâ‰º∏ÂõæÁâáËÅäÂ§©ÁöÑÊ∞îÊ≥°ÂõæÂèØ‰ª•ÈÄöËøá‰ª£Á†ÅÁöÑÊñπÂºèËÆæÁΩÆÔºå‰πüÂèØ‰ª•Áõ¥Êé•Âú® Assets.xcassets Êñá‰ª∂Â§πÂÜÖÁõ¥Êé•ËÆæÁΩÆ„ÄÇÈÄâ‰∏≠Áõ∏Â∫îÂõæÁâáÔºåÊâæÂà∞Èù¢Êùø‰∏≠ÁöÑ show slicing ÁÇπÂáªÔºå‰ºöÂá∫Áé∞Áõ∏Â∫îÁöÑËÆæÁΩÆÁõ∏ÂÖ≥È°πÔºàÁî®Âà∞Êó∂ÂÄôÊü•‰∏Ä‰∏ãÔºå‰ΩøÁî®Ëµ∑Êù•ÈùûÂ∏∏ÁÆÄÂçïÔºâ„ÄÇ ‰ΩøÁî® @IBOutlet ËÆæÁΩÆÁ∫¶Êùü‰ª£Á†Å‰∏≠Â£∞ÊòéÁ∫¶ÊùüÂèòÈáèÔºö 1@IBOutlet weak var widthConstraint: NSLayoutConstraint! Âú® xib ‰∏≠Âè≥ÈîÆÁÑ∂ÂêéÂíå‰ª£Á†Å‰∏≠Â£∞ÊòéÁöÑÂèòÈáèËøûÁ∫ø„ÄÇÂøÖË¶ÅÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®Âä®ÁîªÊîπÂèòÁ∫¶ÊùüÔºö 1234UIView.animated(withDuration:0.5, animations:&#123; self.widthConstraint.constant = 300 self.view.layoutIfNeeded()&#125;) User Defined Runtime Atrributes‰ΩøÁî®User Defined Runtime AttributesÂèØ‰ª•ÈÖçÁΩÆ‰∏Ä‰∫õÂú®interface builder ‰∏≠‰∏çËÉΩÈÖçÁΩÆÁöÑÂ±ûÊÄß„ÄÇÊØîÂ¶ÇÂÜô‰∏Ä‰∏™buttonÁöÑÊó∂ÂÄôÁªèÂ∏∏‰ºöÈúÄË¶ÅËÆæÁΩÆÂÖ∂ cornerRadiousÔºåborderWidth Âíå borderColor ‰∏â‰∏™Â±ûÊÄß: 1234Key.Path Typelayer.cornerRadius Numberlayer.borderWidth Numberlayer.borderColor Color ‰ΩÜÊòØÔºåËøõËøáËÆæÁΩÆÂêé‰ºöÂèëÁé∞ borderColor Â±ûÊÄßËÆæÁΩÆÂπ∂‰∏çÊàêÂäü„ÄÇËøôÊòØÂõ†‰∏∫ËøôÈáåËÆæÁΩÆÁöÑÈ¢úËâ≤Á±ªÂûãÊòØ UIColor ËÄå borderColor ÊòØ CGColor Âõ†Ê≠§ÊòæÁ§∫‰∏çÂá∫Êù•„ÄÇ ÈúÄË¶ÅÂÆö‰πâ‰∏Ä‰∏™ CALayer ÁöÑÂàÜÁ±ª: 1234567#import "CALayer+Additions.h"#import &lt;UIKit/UIKit.h&gt;@implementation CALayer (Additions)- (void)setBorderColorFromUIColor:(UIColor *)color&#123; self.borderColor = color.CGColor;&#125;@end xib‰∏≠ÁöÑKey.Path Êîπ‰∏∫Ê≠§Â±ûÊÄß layer.borderColorFromUIColor Âç≥ÂèØÈÄöËøá runtime Âä®ÊÄÅËÆæÁΩÆ„ÄÇ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iosÁºñÁ®ã(Á¨¨ÂõõÁâà) Â≠¶‰π†Á¨îËÆ∞]]></title>
    <url>%2F2016%2F07%2F31%2Fios%E7%BC%96%E7%A8%8B%EF%BC%88%E7%AC%AC%E5%9B%9B%E7%89%88%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáÊòØÂØπ„ÄäiosÁºñÁ®ã(Á¨¨ÂõõÁâà)„Äã‰∏Ä‰π¶Â≠¶‰π†ÂêéÊëòÂΩïÁöÑÁ¨îËÆ∞ÔºåÂ±û‰∫éiosÂºÄÂèëÂü∫Á°Ä„ÄÇ ËßÜÂõæ‰∏éËßÜÂõæÂ±ÇÊ¨°ÁªìÊûÑËßÜÂõæÂ±ÇÊ¨°ÁªìÊûÑËßÜÂõæÂ±ÇÊ¨°ÁªìÊûÑ‰∏≠ÁöÑÊØè‰∏™ËßÜÂõæÂàÜÂà´ÁªòÂà∂Ëá™Â∑±„ÄÇËßÜÂõæ‰ºöÂ∞ÜËá™Â∑±ÁªòÂà∂Âà∞ÂõæÂ±Ç(layer)‰∏äÔºåÊØè‰∏™ UIView ÂØπË±°ÈÉΩÊúâ‰∏Ä‰∏™ layer Â±ûÊÄßÔºåÊåáÂêë‰∏Ä‰∏™ CALayer Á±ªÁöÑÂØπË±°„ÄÇ layer Âè™Ë¥üË¥£ÊòæÁ§∫Ôºålayer ÂèØ‰ª•‰∏çÂíå View ÈáçÂè†ÁöÑÊîæÂú®‰ªª‰Ωï‰ΩçÁΩÆÔºå‰ΩÜÊòØÂÖ≥‰∫éËßÜÂõæÁöÑÂìçÂ∫îËøòÊòØË¶ÅÈù† UIViewÔºåÂç≥Áúã View ÁöÑ‰ΩçÁΩÆ„ÄÇ ÂàõÂª∫ UIView Â≠êÁ±ªÊØè‰∏™ UIView ÂØπË±°ÈÉΩÊúâ‰∏Ä‰∏™ superview Â±ûÊÄß„ÄÇÂ∞Ü‰∏Ä‰∏™ËßÜÂõæ‰Ωú‰∏∫Â≠êËßÜÂõæÂä†ÂÖ•Âè¶‰∏Ä‰∏™ËßÜÂõæÊó∂Ôºå‰ºöËá™Âä®ÂàõÂª∫Áõ∏Â∫îÁöÑÂèçÂêëÂÖ≥ËÅî„ÄÇ Âú® drawRect: ÊñπÊ≥ï‰∏≠Ëá™ÂÆö‰πâÁªòÂõæËßÜÂõæÊ†πÊçÆ drawRect: ÊñπÊ≥ïÂ∞ÜËá™Â∑±ÁªòÂà∂Âà∞ÂõæÂ±Ç‰∏ä„ÄÇÊØè‰∏™ UIView ÁöÑÂ≠êÁ±ªÂèØ‰ª•Ë¶ÜÁõñ drawRect:ÔºåÂÆåÊàêËá™ÂÆö‰πâÁöÑÁªòÂõæ‰ªªÂä°„ÄÇ‰æãÂ¶Ç UIButton ÁöÑ drawRect: ÊñπÊ≥ïÈªòËÆ§‰ºöÂú® frame Ë°®Á§∫ÁöÑÁü©ÂΩ¢Âå∫Âüü‰∏≠ÂøÉÁîª‰∏ÄË°åÊµÖËìùËâ≤ÁöÑÊñáÂ≠ó„ÄÇ ÂèØ‰ª•‰ΩøÁî® UIBezeierPath ÁªòÂà∂Áõ¥Á∫øÊàñËÄÖÊõ≤Á∫øÊù•ÁªÑÊàêÂêÑÁßçÂΩ¢Áä∂Ôºå‰æãÂ¶ÇÁîª‰∏Ä‰∏™ÂêåÂøÉÂúÜÁöÑ‰∏Ä‰∏™Áï•‰º™ÁöÑ‰ª£Á†ÅÔºö 1234567891011121314151617181920- (void)drawRect:(CGRect)rect&#123; UIBezierPath *path = [[UIBezierPath alloc] init]; // ÁîªÂêåÂøÉÂúÜ for (float currentRadius = maxRadius; currentRadius &gt;0; currentRadius -= 20)&#123; // ÊØè‰∏ÄÊ¨°‰∏Ä‰∏™ path ÁöÑ stroke ÈÉΩÁõ∏ÂΩì‰∫éÊòØ‰∏ÄÁ¨îÁîªÔºåÁªòÂà∂ÂÆå‰∏Ä‰∏™ÂúÜÂêéÂøÖÈ°ªË¶ÅÊä¨Á¨îËÆ©Ëµ∑ÂßãÁÇπÁßªÂä®Âà∞Âè¶‰∏Ä‰∏™Âú∞Êñπ [path moveToPoint:CGPointMake(center.x + currentRadius, center.y)]; // ÁîªÂºß [path addArcWithCenter:center radius:currentRadius startAngle:0.0 endAngle:M_PI*2 clockwise:YES]; &#125; // ËÆæÁΩÆÁ∫øÊù°ÂÆΩÂ∫¶‰∏∫10 path.lineWidth = 10; // ËÆæÁΩÆÁîªÁ¨îÈ¢úËâ≤‰∏∫ÊµÖÁÅ∞Ëâ≤ [[UIColor lightGrayColor] setStroke]; // ÁªòÂà∂Ë∑ØÂæÑ [path stroke];&#125; Ê∑±ÂÖ•Â≠¶‰π†: Core Graphics Core Graphics ‰∏≠ÊúÄÈáçË¶ÅÁöÑÂØπË±°ÊòØÂõæÂΩ¢‰∏ä‰∏ãÊñáÔºåÂõæÂΩ¢‰∏ä‰∏ãÊñáÊòØ CGContextRef ÁöÑÂØπË±°ÔºåË¥üË¥£Â≠òÂÇ®ÂõûËØùÁä∂ÊÄÅ(‰æãÂ¶ÇÁîªÁ¨îÈ¢úËâ≤ÂíåÁ∫øÊù°Á≤óÁªÜ)ÂíåÊå•‰πãÂÜÖÂÆπÊâÄÂ§ÑÁöÑÂÜÖÂ≠òÁ©∫Èó¥„ÄÇ ÂèÇ‰∏éÁªòÂõæÊìç‰ΩúÁöÑÁ±ªÈÉΩÂÆö‰πâ‰∫ÜÊîπÂèòÁªòÂõæÁä∂ÊÄÅÂíåÊâßË°åÁªòÂõæÊìç‰ΩúÁöÑÊñπÊ≥ïÔºåËøô‰∫õÊñπÊ≥ïÂÖ∂ÂÆûË∞ÉÁî®‰∫ÜÂØπÂ∫îÁöÑ Core Graphics ÂáΩÊï∞„ÄÇÊúâÊó∂ÂÄôÊàë‰ª¨‰∏çÂæó‰∏çÁî®Âà∞ÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∫õÂ±ûÊÄßÔºå‰ΩÜÊòØ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨Ê≤°ÊúâÂøÖË¶ÅÁõ¥Êé•‰ΩøÁî® Core Graphics„ÄÇ ËßÜÂõæ:ÈáçÁªò‰∏é UIScrollViewËøêË°åÂæ™ÁéØÂíåÈáçÁªòËßÜÂõæiOS Â∫îÁî®ÂêØÂä®‰ºöÂºÄÂßã‰∏Ä‰∏™ËøêË°åÂæ™ÁéØ„ÄÇËøêË°åÂæ™ÁéØÁöÑÂ∑•‰ΩúÊòØÂ§ÑÁêÜ‰∫ã‰ª∂Ôºå‰æãÂ¶ÇËß¶Êë∏„ÄÇËøêË°åÂæ™ÁéØ‰ºö‰∏∫Áõ∏Â∫îÁöÑ‰∫ã‰ª∂ÊâæÂà∞ÂêàÈÄÇÁöÑÂ§ÑÁêÜÊñπÊ≥ï„ÄÇÂΩìËøô‰∫õÊñπÊ≥ïÊâßË°åÂÆåÊØïÂêéÔºåÊéßÂà∂ÊùÉ‰ºöÂÜçÊ¨°ÂõûÂà∞ËøêË°åÂæ™ÁéØ„ÄÇ ÂΩìÂ∫îÁî®Â∞ÜÊéßÂà∂ÊùÉ‰∫§ÂõûÁªôËøêË°åÂæ™ÁéØÊó∂ÔºåËøêË°åÂæ™ÁéØÈ¶ñÂÖà‰ºöÊ£ÄÊü•ÊòØÂê¶ÊúâÁ≠âÂæÖÈáçÁªòÁöÑËßÜÂõæ(Âç≥ÂΩìÂâçÂæ™ÁéØÊî∂Âà∞Ëøá setNeedDisplay Ê∂àÊÅØÁöÑËßÜÂõæ)ÔºåÁÑ∂ÂêéÂêëÊâÄÊúâÁ≠âÂæÖÈáçÁªòÁöÑËßÜÂõæÂèëÈÄÅ drawRect: Âú®‰∫ã‰ª∂Â§ÑÁêÜÂë®Êúü‰∏≠ÔºåËßÜÂõæÁöÑÂ±ûÊÄßÂèØËÉΩ‰ºöÂ§öÊ¨°ÊîπÂèòÔºåÂ¶ÇÊûúÁªèÂ∏∏ÈáçÁªòËá™Â∑±Ôºå‰ºöÂáèÊÖ¢ÁïåÈù¢ÁöÑÂìçÂ∫îÈÄüÂ∫¶„ÄÇiOS ‰ºöÂú®ËøêË°åÂæ™ÁéØÁöÑÊúÄÂêéÈò∂ÊÆµÈõÜ‰∏≠Â§ÑÁêÜÊâÄÊúâÈúÄË¶ÅÈáçÁªòÁöÑËßÜÂõæÔºåÂ∞§ÂÖ∂ÊòØÂØπ‰∫éÂ±ûÊÄßÂ§öÊ¨°ÂèëÁîüÊîπÂèòÁöÑËßÜÂõæÔºåÂú®ÊØèÊ¨°Êó∂Èó¥Â§ÑÁêÜÂë®Êúü‰∏≠Âè™ÈáçÁªò‰∏ÄÊ¨°„ÄÇ ‰∏∫‰∫ÜÊ†áËÆ∞ËßÜÂõæË¶ÅÈáçÁªòÔºåÂøÖÈ°ªÂêëÂÖ∂ÂèëÈÄÅ setNeedsDisplay Ê∂àÊÅØ„ÄÇÁ≥ªÁªü‰∏≠ÁöÑËßÜÂõæÂØπË±°‰ºöÂú®ÊòæÁ§∫ÁöÑÂÜÖÂÆπÂèëÁîüÊîπÂèòÊó∂ÂêëËá™Ë∫´ÂèëÈÄÅ setNeedsDisplay Ê∂àÊÅØÔºå‰æãÂ¶Ç UILabel ÂØπË±°Êî∂Âà∞ setText: Ê∂àÊÅØÂêéÔºå‰ºöËá™Âä®Ê†áËÆ∞‰∏∫ÈúÄË¶ÅÈáçÁªò„ÄÇËÄåËá™ÂÆö‰πâÁöÑ UIView Â≠êÁ±ªÔºåÂøÖÈ°ªÊâãÂä®ÂêëÂÖ∂ÂèëÈÄÅ setNeedsDisplay Ê∂àÊÅØ„ÄÇ 1234- (void)setCircleColor:(UIColor *)circleColor&#123; circleColor = circleColor; [self setNeedsDisplay]; // ÈáçÁªò&#125; ‰ΩøÁî® UIScrollViewÂè¶‰∏ÄÁØá‰∏ìÈó®ËÆ≤ UIScrollView ÁöÑÊñáÁ´†Â∑≤ÁªèËØ¥‰∫ÜÔºåUIScrollView Êúâ‰∏§‰∏™ sizeÔºå‰∏Ä‰∏™ÊéßÂà∂ÊòæÁ§∫ÁöÑÊ°ÜÊ°ÜÁöÑÂ§ßÂ∞èÔºåÂ∞±ÊòØÊåá frameÔºå‰∏Ä‰∏™ÊòØÂÆûÈôÖÂÜÖÈÉ®ÂõæÂÉèÁöÑÂ§ßÂ∞èÔºåÂ∞±ÊòØÂÖ∂‰∏≠ÁöÑ contentSize Â±ûÊÄßÔºö 1234567891011// Â§ñÈÉ®Â§ßÂ∞èËÆæÁΩÆ‰∏∫Â±èÂπïÂ§ßÂ∞èUIScrollView *scrollView = [[UIScrollView alloc] initWithFrame:screenRect];// Ê∑ªÂä†‰∏Ä‰∏™ ContentViewÔºåÂú®Ëøô‰∏™ View ‰∏äÊ∑ªÂä†Êõ¥Â§öË¶ÅÊòæÁ§∫ÁöÑÂõæÂΩ¢UIView *contentView = [[UIView alloc] initWithFrame:bigRect];[scrollView addSubview:contentView];// ÂëäËØâ UIScrollView ÂèñÊôØËåÉÂõ¥Â§öÂ§ßscrollView.contentSize = bigRect.size;// ÂèØ‰ª•Âú® contentView ‰∏≠Ê∑ªÂä†ÂêÑÁßç subview[contentView addSubview:xx1View];[contentView addSubview:xx2View]; UIScrollView ‰∏≠Êúâ‰∏Ä‰∏™ÂàÜÈ°µÁöÑÂ±ûÊÄß pagingEnabledÔºåÂ¶ÇÊûúÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ YESÔºå‰ºö‰∏ÄÈ°µ‰∏ÄÈ°µÂú∞ÊòæÁ§∫ËßÜÂõæÔºåÂÖ∂ÂÆûÁé∞ÂéüÁêÜÊòØÔºö UIScrollView ÂØπË±°‰ºöÊ†πÊçÆÂÖ∂ bounds ÁöÑÂ∞∫ÂØ∏ÔºåÂ∞Ü contentSize ÂàÜÂâ≤‰∏∫Â∞∫ÂØ∏Áõ∏ÂêåÁöÑÂ§ö‰∏™Âå∫Âüü„ÄÇÊãñÂä®ÁªìÊùüÂêéÔºå UIScrollView ‰ºöËá™Âä®ÊªöÂä®Âπ∂ÂÄºÊòæÁ§∫ÂÖ∂‰∏≠‰∏Ä‰∏™Âå∫Âüü„ÄÇ ËßÜÂõæÊéßÂà∂Âô®ÂàõÂª∫ UIViewControllerÂ≠êÁ±ªUIViewControllerÊúâ‰∏Ä‰∏™ÈáçË¶ÅÂ±ûÊÄß viewÔºåÂÆÉÊòØËßÜÂõæÂ±ÇÊ¨°ÁªìÊûÑÁöÑÊ†πËßÜÂõæÔºåÊâÄÊúâËßÜÂõæÈÉΩÊ∑ªÂä†Âú®Ëøô‰∏™ view ‰∏ä: 1@property (nonatomic, strong) UIView *view; ËßÜÂõæÊéßÂà∂Âô®ÂèØ‰ª•ÈÄöËøá‰∏§ÁßçÊñπÂºèÂàõÂª∫ËßÜÂõæÂ±ÇÊ¨°ÁªìÊûÑ: ‰ª£Á†ÅÊñπÂºè:Ë¶ÜÁõñ UIViewController ‰∏≠ÁöÑ loadView NIB Êñá‰ª∂ÊñπÂºè:‰∏çË¶ÜÁõñ UIViewController ‰∏≠ÁöÑ loadView loadView ÊñπÊ≥ï‰ºöÂú® ViewController ÁöÑ view Ë¢´ËØ∑Ê±ÇÂπ∂‰∏îÂΩìÂâçview‰∏∫nilÊó∂Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ï„ÄÇÊâÄ‰ª•‰Ω†Ë∞ÉÁî® [[UIViewController alloc] init] Âπ∂‰∏îÂ∞ÜËøô‰∏™ ViewController ÊòæÁ§∫Âá∫Êù•ÁöÑÊó∂ÂÄôÔºå‰ºöËá™Âä®Ëß¶Âèë loadView ÊñπÊ≥ï„ÄÇ Á≥ªÁªüÁöÑ loadView ÊñπÊ≥ïÁöÑÈªòËÆ§ÂÆûÁé∞ÊòØÔºöÂØªÊâæÊúâÂÖ≥ÁöÑ nib Êñá‰ª∂ÁöÑ‰ø°ÊÅØÔºåÊ†πÊçÆËøô‰∏™‰ø°ÊÅØÊù•Âä†ËΩΩ nib Êñá‰ª∂„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÁõ∏ÂÖ≥nibÊñá‰ª∂ÁöÑ‰ø°ÊÅØÔºåÈªòËÆ§ÂàõÂª∫‰∏Ä‰∏™Á©∫ÁôΩÁöÑ UIView ÂØπË±°ÔºåÁÑ∂ÂêéÊääÂØπË±°ÊàêËµãÂÄºÁªô ViewController ÁöÑ‰∏ª view„ÄÇ Ëøô‰∏™nibÊñá‰ª∂ÁöÑ‰ø°ÊÅØÊòØ initWithNibName:Bundle: ÊñπÊ≥ïÊèê‰æõÁöÑÔºå‰Ω†ÂèØ‰ª•Âú®ÂàõÂª∫ VC ÁöÑÊó∂ÂÄôÁõ¥Êé•ÊâãÂä®Ë∞ÉÁî®Ôºö[[UIViewController alloc] initWithNibName:@&quot;xxxx&quot; Bundle:[UIBundle mainBundle]]„ÄÇÂ¶ÇÊûúÊòØ‰ΩøÁî® init ÊñπÊ≥ïÂàùÂßãÂåñÁöÑÔºåinit ÊñπÊ≥ï‰ºöÈªòËÆ§Ë∞ÉÁî®ËØ•ÊñπÊ≥ïÔºåÂÖ∂‰∏≠ÁöÑ nibName ÈªòËÆ§ÊòØÂêåÂêçÊñá‰ª∂„ÄÇ ÈÄöËøá Nib Êñá‰ª∂ÊñπÂºèÂä†ËΩΩËßÜÂõæÂ∞±ÊòØ‰∏çË¶ÅÈáçÂÜô loadView ÊñπÊ≥ï Ëá™ÂÆö‰πâÈáçËΩΩ loadView ÁöÑÊó∂ÂÄôÊ≥®ÊÑè‰∏çÈúÄË¶ÅË∞ÉÁî®‰∏äÈù¢ÊâÄËØ¥ÁöÑÁ≥ªÁªüÂÆûÁé∞ÊñπÊ≥ï [super loadView]; Âõ†‰∏∫‰Ω†ÊÉ≥Ëá™ÂÆö‰πâ view ÁöÑËØùÔºåÂ∞±ÈúÄË¶ÅËá™Â∑±Áªô view Â±ûÊÄßËµãÂÄº„ÄÇ 12345678- (void)loadView&#123; // ÂàõÂª∫‰∏Ä‰∏™view UIView *view = [[UIView alloc] init]; // Â∞Ü view ËµãÁªôÊéßÂà∂Âô®ÁöÑ view Â±ûÊÄß self.view = view; // Ê∑ªÂä†ÂÖ∂‰ªñÁöÑview ...&#125; ÈáçÂÜô loadView Êù•ÂÆûÁé∞‰ª£Á†ÅÊñπÂºèËá™ÂÆö‰πâËßÜÂõæ Êó†ËÆ∫ XIB ËøòÊòØ‰ª£Á†ÅÂàõÂª∫ÈÉΩ‰ºöË∞ÉÁî® viewDidLoad ÊñπÊ≥ï„ÄÇÂ¶ÇÊûú‰Ω†ÈúÄË¶ÅÂØπ view ÂèäÊ∑ªÂä†Âú®ÂÖ∂‰∏äÁöÑËßÜÂõæÂÅö‰∏Ä‰∫õÂÖ∂‰ªñÁöÑÂÆöÂà∂Êìç‰ΩúÔºåÂú® viewDidLoad ÈáåÈù¢ÂéªÂÅö„ÄÇ Âè¶‰∏Ä‰∏™ËßÜÂõæÊéßÂà∂Âô®ÈÄöËøá initWithNibName:Bundle: ÊñπÊ≥ïÂèØ‰ª•ÊåáÂÆöÂä†ËΩΩÁöÑ NIB Êñá‰ª∂Ôºåbundle Áî®‰∫éÊåáÂÆöÊâÄÂú®ÁöÑÁ®ãÂ∫èÂåÖÔºåÈªòËÆ§ÊòØ‰∏ªÁ®ãÂ∫èÂåÖ [NSBundle mainBundle];ÔºåÂØπÂ∫î‰∫éÊñá‰ª∂Á≥ªÁªü‰∏≠ÁöÑÊ†πÁõÆÂΩïÔºåÂåÖÂê´‰ª£Á†ÅÊñá‰ª∂ÂíåËµÑÊ∫êÊñá‰ª∂„ÄÇ Âú®Âä†ËΩΩÂâçÔºåÊàë‰ª¨Ë¶ÅÁ°Æ‰øù nib ÂØπË±°Âíå ViewController Â∑≤ÂÖ≥ËÅîËµ∑Êù•(Â∞§ÂÖ∂ÊòØ view Â±ûÊÄßË¶ÅÂÖ≥ËÅîËµ∑Êù•Ôºå‰∏çÂÖ≥ËÅîÂ∞±‰ºöÊäõÂá∫ÂºÇÂ∏∏)ÔºåÈúÄË¶Å‰ΩøÁî® File‚Äôs Owner ÂØπË±°„ÄÇFile‚Äôs Owner ÂØπË±°ÊòØ‰∏Ä‰∏™Âç†‰ΩçÁ¨¶ÔºåÂΩìÊüê‰∏™ËßÜÂõæÊéßÂà∂Âô®Â∞Ü Xib Êñá‰ª∂Âä†ËΩΩ‰∏∫ NIB Êñá‰ª∂Êó∂ÔºåÈ¶ñÂÖà‰ºöÂàõÂª∫ XIB Êñá‰ª∂‰∏≠ÊâÄÊúâËßÜÂõæÂØπË±°ÔºåÁÑ∂Âêé‰ºöÂ∞ÜËá™Â∑±Â°´ÂÖ•Áõ∏Â∫îÁöÑ File‚Äôs Owner Á©∫Ê¥ûÔºåÂπ∂Âª∫Á´ã‰πãÂâçÂú® Interface Builder ‰∏≠ËÆæÁΩÆÁöÑÂÖ≥ËÅî„ÄÇ ÂÖ≥ËÅî view Â±ûÊÄßÔºåÈ¶ñÂÖàÈÄâ‰∏≠ Files‚Äôs Owner ÁÑ∂ÂêéÊâìÂºÄÊ£ÄËßÜÈù¢ÊùøÔºåÂ∞Ü Class ËÆæÁΩÆ‰∏∫ÁõÆÊ†á ViewController ÁöÑ ClassÔºö ËÆæÁΩÆ File‚Äôs Owner ÊòØÂú® initWithNibName:bundle: ÊñπÊ≥ïÈáåËÆæÁΩÆÁöÑÔºåÈÇ£‰πà‰∏äÂõæÁöÑËÆæÁΩÆÊÑè‰πâÊòØ‰ªÄ‰πàÂë¢ÔºüÂè™ÊúâÊ≠£Á°ÆÁöÑËÆæÁΩÆ‰∫Ü ClassÔºå‰∏ãÈù¢ÂÖ≥ËÅîÊèíÂ∫ßÁöÑÊó∂ÂÄôÊâçËÉΩÂ∞Ü ViewController ‰∏≠ÁöÑÊèíÂ∫ßÂèòÈáèÂ±ïÁ§∫Âá∫Êù•ÔºåÊèê‰æõÁªô‰ΩøÁî®ËÄÖËøûÁ∫øÔºö ÊØîÂ¶ÇÂú® NavigationController ‰∏≠ÁöÑ‰∏ÄÂ†Ü ViewControllerÔºåÂú®ÂÜÖÂ≠òÂÅèÂ∞ëÊó∂Ôºå‰ºöÈáäÊîæÂÖ∂ËßÜÂõæÂπ∂Âú®ÊòæÁ§∫ÁöÑÊó∂ÂÄôÂÜçÂàõÂª∫Âá∫Êù•„ÄÇÊâÄ‰ª• ViewController ‰∏≠ÁöÑÊèíÂ∫ßÂèòÈáè‰∏ÄËà¨Â£∞Êòé‰∏∫ weakÔºåÈò≤Ê≠¢ ViewController Âº∫ÂºïÁî® XibÔºåÂØºËá¥Á≥ªÁªü‰∏çËÉΩÈáäÊîæ Xib„ÄÇ ÊèíÊí≠‰∏ÄÔºöFile‚Äòs Owner Âíå View ÁöÑ custom class ÁöÑÂå∫Âà´Áî®‰∫é ViewController ‰∏äÁöÑÂå∫Âà´Èô§‰∫Ü File‚Äôs Owner ÂèØ‰ª•ËÆæÁΩÆ custom classÔºåxib ‰∏≠ÁöÑ view ‰πüÂèØ‰ª•ËÆæÁΩÆ custom class„ÄÇ‰ΩÜÊòØÂâçËÄÖÂèØ‰ª•ÊòØ‰ªªÊÑèÂØπË±°Âç≥ NSObject ËÄåÂêéËÄÖÂè™ËÉΩÊòØ UIView ÁöÑÂ≠êÁ±ª„ÄÇÊàë‰ª¨Âú®ÂØπ ViewController ËÆæÁΩÆ xib ÁöÑÊó∂ÂÄôÂè™ÂèØ‰ª•ËÆæÁΩÆ File‚Äôs Owner ÁöÑ custom classÔºåÂπ∂ÈÄöËøá initWithNibName:bundle: ÂàùÂßãÂåñÔºåËÄå‰∏çËÉΩËÆæÁΩÆ xib ‰∏≠ view ÁöÑ custom class„ÄÇ Âõ†‰∏∫ UIViewController ÁªßÊâø‰∫é NSObjectÔºåÊú¨Ë¥®‰∏äÊòØ‰∏Ä‰∏™ÊéßÂà∂Âô®ÔºåËÄå‰∏çÊòØ‰∏Ä‰∏™ View„ÄÇÊâÄ‰ª•Ëøô‰∏™ xib ÊâÄ‰ª£Ë°®ÁöÑ View ÊòØ custom class ‰πüÂ∞±ÊòØ VC ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ‰ªéËøûÁ∫ø‰∏äÂ∞±ÂèØ‰ª•‰ΩúËØÅÔºåÂõ†‰∏∫Â¶ÇÊûúÂàõÂª∫ VC ÁöÑÊó∂ÂÄôËøûÂêåÂàõÂª∫‰∫Ü xib ÁöÑËØùÔºåXcode ‰ºöÈªòËÆ§Â∞Ü VC ÁöÑ View Â±ûÊÄßÂíå xib ËøûÊé•„ÄÇ ËÄå View ÂàôË°®Á§∫ custom class Â∞±ÊòØËøô‰∏™ view„ÄÇÊâÄ‰ª•‰∏çËÉΩÂ∞ÜÂÖ∂Áî®Âú® VC ‰∏ä„ÄÇ Áî®‰∫é View ‰∏äÁöÑÂå∫Âà´ÈÇ£ÂØπ‰∫é‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑ ViewÔºåÊàë‰ª¨ÊòØËØ•ËÆæÁΩÆÂì™‰∏™ÁöÑ custom class Âë¢ÔºüÁ≠îÊ°àÊòØÔºö‰∏§ËÄÖÈÉΩÂèØ‰ª•ÂÆûÁé∞Ôºå‰ΩÜÊòØ‰ΩøÁî®Âú∫ÊôØÂíåÊñπÂºèÈÉΩÁï•ÊúâÂå∫Âà´„ÄÇ ÂØπ‰∫éËá™ÂÆö‰πâ viewÔºå‰∏§ËÄÖÈÉΩÂèØ‰ª•‰ΩøÁî®‰∏ãÈù¢ÁöÑÊñπÊ≥ïË°®Á§∫„ÄÇÂâçËÄÖÈúÄË¶ÅÂ∞Ü owner ËÆæÁΩÆ‰∏∫Áé∞Âú®ÁöÑ ownerÔºå‰∏ÄËà¨ÊòØ selfÔºõÂêéËÄÖÂ∞ÜÂÖ∂ÁΩÆ‰∏∫ nil Âç≥ÂèØÔºö 1NSArray *nibViews = [[NSBundle mainBundle] loadNibNamed:@"NibName" owner:owner options:nil]; Â¶ÇÊûúÊòØËÆæÁΩÆ view ÁöÑ custom class„ÄÇ‰æãÂ¶Ç‰∏Ä‰∏™ TestView ËßÜÂõæÔºåÁõ¥Êé•Â∞±ÂèØ‰ª•Â∞ÜËøô‰∏™ View ËµãÁªô‰∫Ü TestView ÂØπË±°„ÄÇËøôÈáåËÆæÁΩÆ owner ‰∏∫ nilÔºö 1234// Âú®Êüê‰∏™ ViewController ‰∏≠Ê∑ªÂä† TestView ËßÜÂõæNSArray* nibView = [[NSBundle mainBundle] loadNibNamed:@"TestView" owner:nil options:nil];TestView *testView = [nibView firstObject];[self.view addSubview:testView]; ËÆæÁΩÆ Files‚Äôs Owner ÁöÑ custom class ÁöÑÊñπÂºèÂàôÈúÄË¶ÅÈÄöËøá addSubView: ÊñπÊ≥ïÊâãÂä®Ê∑ªÂä†Âà∞ÂÖ∂ owner Á±ª‰∏≠Ôºö 12345678910// Ëá™ÂÆö‰πâÁöÑ TestView ÁöÑÊüê‰∏™ÂÆû‰æãÂåñÊñπÊ≥ï- (instancetype)initFromNibWithFrame:(CGRect)frame&#123; UIView *nibView = [[[NSBundle mainBundle] loadNibNamed:@"TestView" owner:self options:nil] firstObject]; nibView.frame = frame; self = [super initWithFrame:nibView.frame]; [self addSubview:nibView]; // Ëøô‰∏™Ëá™ÂÆö‰πâÁöÑÊñπÊ≥ïÁî®Êù•Ëá™ÂÆö‰πâËÆæÁΩÆ View [self nib_viewDidLoad]; return self;&#125; ‰∏ÄËà¨Êàë‰ª¨Â¶ÇÊûúËá™ÂÆö‰πâ View ÈÉΩÊòØÁõ¥Êé•ÈááÁî®ËÆæÁΩÆ View ÁöÑ custom class ÁöÑÊñπÂºèÔºåÊØîÂ¶Ç TableView ‰∏≠Âä†ËΩΩÂ§¥ËßÜÂõæÔºåËÆæÁΩÆ TableViewCell Á≠âÔºö 12345// ËÆæÁΩÆÂ§¥ËßÜÂõæUIView *headerView = [[[NSBundle mainBundle] loadNibNamed:@"HotelReviewsHeaderView" owner:nil options:nil]lastObject];// ËÆæÁΩÆ Cell[self.tableView registerNib:[UINib nibWithNibName:@"MineUserInfoCell" bundle:nil] forCellReuseIdentifier:@"MineUserInfoCellIdentifier"]; ËÆæÁΩÆ File‚Äòs owner Â∞±Ë°®Á§∫Ëøô‰∏™ xib ÊòØÊàë Custom class ÁöÑÈ©¨‰ªîÔºåÊâÄ‰ª•Ë¶Å addSubview ÁöÑÊñπÂºèÊ∑ªÂä†ËøõÂéª„ÄÇËÆæÁΩÆ View ÁöÑcustom class Ë°®Á§∫Ëøô‰∏™ xib Â∞±ÊòØÊàëËá™Â∑±ÂëÄ„ÄÇ ÂèÇËÄÉÔºöÈÄöËøá XIB Âä†ËΩΩ UIView ÊèíÊí≠‰∫åÔºöÂú® xib ‰∏≠‰ΩøÁî®Ëá™ÂÆö‰πâÁöÑview‰∏äÈù¢ÊºîÁ§∫‰∫ÜÂ¶Ç‰ΩïÁî®‰ª£Á†ÅÁöÑÊñπÂºèÂØπËÆæÁΩÆ‰∫Ü File‚Äôs owner Êàñ View ÁöÑ custom view ÁöÑËá™ÂÆö‰πâËßÜÂõæËøõË°åÂÆû‰æãÂåñ„ÄÇÈÇ£‰πà‰∏ÄÁõ¥Êúâ‰∏Ä‰∏™ÁñëÊÉëÔºåÂ¶Ç‰ΩïÂú® xib ‰∏≠Áõ¥Êé•Ê∑ªÂä†Ëá™ÂÆö‰πâview ÁöÑ xibÔºü Âú® ViewController ÁöÑ xib ‰∏≠ÔºåÊàë‰ª¨ÊãñÂÖ•‰∏Ä‰∏™ UIView ÁöÑÊéß‰ª∂ÔºåÁÑ∂ÂêéÂ∞ÜËøô‰∏™ UIView ÁöÑ Custom Class ËÆæÁΩÆ‰∏∫Ëá™ÂÆö‰πâÁöÑ view ÁöÑÁ±ªÂêç„ÄÇÊ≠§Âàª‰Ω†ËßâÂæóÂ§ßÂäüÂëäÊàê‰∫Ü‰πàÔºüÈùû‰πüÔºåÂ¶ÇÊûúËøêË°åÂ∞±‰ºöÂèëÁé∞ÔºåÂàöÂàöÊãñÂÖ•Âπ∂ËÆæÁΩÆ‰∫Ü Custom Class ÁöÑÊéß‰ª∂Âπ∂Ê≤°ÊúâÊòæÁ§∫Âá∫Êù•ÔºåÂè™ÊòØ‰∏ÄÁâáÁ©∫ÁôΩ„ÄÇÈÇ£‰πàÊàë‰ª¨Ë¶ÅÂ¶Ç‰Ωï‰øÆÊîπÂë¢Ôºü ÂÖ∂ÂÆû‰∏∫‰ªÄ‰πàÊòØ‰∏ÄÁâáÁ©∫ÁôΩÂæàÂ•ΩÁêÜËß£ÔºåÂõ†‰∏∫‰Ω†ÊãñÁöÑËøô‰∏™ UIView Â∞±ÊòØÁ©∫ÁôΩÁöÑÔºåXcode Â∞±ËÆ§‰∏∫‰Ω†Â∞ÜÁ±ªÂíåËøô‰∏™Á©∫ÁôΩÁöÑ UIView ÂÖ≥ËÅî‰∫ÜËµ∑Êù•„ÄÇ ËôΩÁÑ∂‰Ω†ËøòÂ∞ÜÂè¶Â§ñÁöÑ‰∏Ä‰∏™ xib ÂíåËøô‰∏™Á±ªÂÖ≥ËÅîËµ∑Êù•‰∫ÜÔºå‰ΩÜÊòØ‰Ω†ÊòæÁ§∫ÁöÑÂπ∂‰∏çÊòØÈÇ£‰∏™ xib„ÄÇÂÖ∂ÂÆûÂ∞±Áõ∏ÂΩì‰∫é‰∏Ä‰∏™Á±ªÂÖ≥ËÅî‰∫ÜÂ§ö‰∏™ xib ÁöÑËßÜÂõæ„ÄÇ ÂΩìÊåáÂÆö‰∫ÜÁ±ªÁöÑÈÇ£‰∏™ UIView ÈöèÁùÄ ViewController ÁöÑ xib Ë¢´Âä†ËΩΩÁöÑÊó∂ÂÄôÔºå‰ºöË∞ÉÁî® initWithCoder: ‰ª•Âèä awakeFromeNib ÊñπÊ≥ïÔºàÂè™Ë¶ÅÊòØ‰ªéÊñá‰ª∂(Âç≥ xib)‰∏≠Âä†ËΩΩÁöÑÔºåÂ∞±ÈÉΩ‰ºöË∞ÉÁî®ÂÖ∂Á±ªÁöÑËØ•ÊñπÊ≥ï„ÄÇÂÖ∂ÂÆûÂ∞±Áõ∏ÂΩì‰∫éÂú®Âä†ËΩΩ VC ÁöÑ xib ÁöÑÊó∂ÂÄôÔºåÈÄíÂΩíÁöÑË∞ÉÁî®‰∫ÜÂÖ∂ÂÜÖÈÉ®ÊâÄÊúâ View ÁöÑ initWithCoder ÊñπÊ≥ïÔºâ„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈáçÂÜô initWithCoder: ÊñπÊ≥ïÂ∞ÜÊàë‰ª¨Ë¶ÅÂ±ïÁ§∫ÁöÑ UIView Ê∑ªÂä†‰∏äÂéª„ÄÇ initWithCoder ÊòØÊñá‰ª∂ÊñπÂºèÂàõÂª∫ UIView ÁöÑÊó∂ÂÄôÂ∞±‰ºöË∞ÉÁî®ÁöÑÔºåË∞ÉÁî® [super initWithCoder:aDecoder] Â∞±ÂÆåÊàê‰∫Ü UIView ÁöÑÂàõÂª∫„ÄÇ‰Ω†ÂèØ‰ª•Ê∑ªÂä†Ëá™Â∑±ÁöÑ‰ª£Á†ÅÔºåÂú® UIView ‰∏≠Ê∑ªÂä†ËßÜÂõæ„ÄÇ initWithFrame Â∞±ÊòØ‰ª•‰ª£Á†ÅÊñπÂºèÂàõÂª∫ UIView ÁöÑ‰∫Ü„ÄÇ awakeFromNib ÊòØÂú® initWithCoder ÊàêÂäü‰ªéÊñá‰ª∂ÂàõÂª∫Â•Ω UIView ‰πãÂêéË∞ÉÁî®ÁöÑ„ÄÇ ËøôÈáåÂ∞±‰∏çËÉΩÂÉèÂâçÈù¢‰∏ÄÊ†∑ÂèØ‰ª•ËÆæÁΩÆ File‚Äôs Owner Âíå View ÁöÑ custom class ÈÉΩÂèØ‰ª•Âä†ËΩΩËá™ÂÆö‰πâËßÜÂõæÂØπË±°‰∫Ü„ÄÇËøôÈáåÂè™ËÉΩËÆæÁΩÆ File‚Äôs Owner ÁöÑ custom classÔºåÁÑ∂ÂêéÂú® initWithCoder: ÊñπÊ≥ï‰∏≠Ê∑ªÂä† subView„ÄÇÊúÄÂêéÊ≥®ÊÑèÁî±‰∫éÊòØÊ∑ªÂä†ÁöÑ subViewÔºåÈÇ£‰πàÈúÄË¶ÅËÆæÁΩÆ frame„ÄÇ 123456789101112- (instancetype)initWithCoder:(NSCoder *)aDecoder&#123; self = [super initWithCoder:aDecoder]; if (self) &#123; NSString *className = NSStringFromClass([self class]); UIView *view = [[[NSBundle mainBundle] loadNibNamed:className owner:self options:nil] firstObject]; view.frame = self.bounds; [self addSubview:view]; return self; &#125; return nil;&#125; ÈÄöËøáËÆæÁΩÆ View ÁöÑ custom class Â∞Ü‰ºö‰∫ßÁîüÊó†Á∫øÈÄíÂΩíÔºåÊúÄÁªàÂØºËá¥Ê†àÊ∫¢Âá∫Â¥©Ê∫É„ÄÇ‰∏∫‰ªÄ‰πàÔºüÂõ†‰∏∫ Â¶ÇÊûú‰Ω†Âú® xib ‰∏≠Â∞Ü View ÁöÑ custom class ËÆæÁΩÆ‰∏∫Ëá™ÂÆö‰πâview ÁöÑÁ±ªÔºåÈÇ£‰πà‰Ω†Âú® initWithCoder ‰∏≠Ë∞ÉÁî® UIView *view = [[[NSBundle mainBundle] loadNibNamed:className owner:self options:nil] firstObject]; ÁöÑÊó∂ÂÄô‰ºöËß¶Âèë initWithCoder:„ÄÇÊâÄ‰ª•Ëøô‰∏™ËøáÁ®ãÁõ∏ÂΩì‰∫é‰∏çÂÅúÁöÑÂú®Âä†ËΩΩËá™Â∑±„ÄÇÂè™ÊúâÂΩì‰Ω†Â∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ File‚Äôs Owner ÁöÑÊó∂ÂÄôÔºåÂú® initWithCoder ‰∏≠Âä†ËΩΩËßÜÂõæÔºåÂ∞±ÊòØÂä†ËΩΩÂ≠êËßÜÂõæÔºåÂ∞±Áõ∏ÂΩì‰∫éÂä†ËΩΩËá™Â∑±ÁöÑÂÑøÂ≠ê„ÄÇ ÂèÇËÄÉÔºöNested Xib Views - ‰ΩøÁî®XIBÂÆûÁé∞ÂµåÂ•óËá™ÂÆö‰πâËßÜÂõæ UITabBarControllerUITabBarController ÁöÑ view Â±ûÊÄßÊåáÂêë‰∏Ä‰∏™ÂåÖÂê´‰∏§‰∏™Â≠êËßÜÂõæÁöÑ UIView ÂØπË±°ÔºåÂàÜÂà´ÊòØÊ†áÁ≠æÊ†èÂíåÂΩìÂâçÈÄâ‰∏≠ÁöÑËßÜÂõæÊéßÂà∂Âô®ÁöÑËßÜÂõæ„ÄÇÂÖ∂ viewControllers Â±ûÊÄß‰øùÂ≠ò‰∏ÄÁªÑËßÜÂõæÊéßÂà∂Âô®ÔºåÊØè‰∏Ä‰∏™ËßÜÂõæÊéßÂà∂Âô®ÂØπÂ∫î‰∏Ä‰∏™ tabItemÔºö 123456789101112131415- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&#123; UIImage *mainImage = [UIImage imageNamed:@"tab_home"]; UIImage *mainImageSel = [UIImage imageNamed:@"tab_home_active"]; //ËÆæÁΩÆÂõæÁâáÁöÑÊ∏≤ÊüìÊ®°Âºè mainImage = [mainImage imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal]; mainImageSel = [mainImageSel imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal]; //ËÆæÁΩÆtabBarItem UITabBarItem *mainTabBarItem = [[UITabBarItem alloc] initWithTitle:@"È¶ñÈ°µ" image:mainImage selectedImage:mainImageSel]; mainNav.tabBarItem = mainTabBarItem; //ÂàùÂßãÂåñtabBar UITabBarController *tabBarController = [[UITabBarController alloc] init]; tabBarController.viewControllers = @[mainNav,nextNav]; // ËÆæ‰∏∫Ê†πViewController self.window.rootViewController = tabBarController;&#125; ‰∏∫tabbarÊ∑ªÂä†subview: 123UIView *backview = [[UIView alloc] initWithFrame:self.tabBar.bounds];[backview setBackgroundColor:[UIColor whiteColor]];[self.tabBar addSubview:backview]; ‰∏éËßÜÂõæÊéßÂà∂Âô®ÂèäÂÖ∂ËßÜÂõæ‰∫§‰∫íapplication:didFinishLaunchingWithOptions: ËØ•ÊñπÊ≥ï‰∏≠ËÆæÁΩÆÂíåÂàùÂßãÂåñÂ∫îÁî®Á™óÂè£ÁöÑÊ†πËßÜÂõæÊéßÂà∂Âô®„ÄÇËØ•ÊñπÊ≥ïÂè™‰ºöÂú®Â∫îÁî®ÂêØÂä®ÂêéË∞ÉÁî®‰∏ÄÊ¨°„ÄÇÂ¶ÇÊûú‰ªéÂÖ∂‰ªñÂ∫îÁî®ÂàáÊç¢ÂõûÊú¨Âú∞Â∫îÁî®ÔºåËØ•ÊñπÊ≥ï‰∏ç‰ºöË¢´Ë∞ÉÁî®ÔºåÂ¶ÇÊûúÂÖ≥Èó≠Â∫îÁî®ÂêéÂè∞Âú®ÈáçÂêØÊâç‰ºöÂÜçÊ¨°Ë∞ÉÁî®„ÄÇinitWithNibNameÔºöbundleÔºöËØ•ÊñπÊ≥ïÊòØUIViewControllerÁöÑÊåáÂÆöÂàùÂßãÂåñÊñπÊ≥ïÔºåÂàõÂª∫ËßÜÂõæÊéßÂà∂Âô®Êó∂ÔºåÂ∞±‰ºöË∞ÉÁî®ËØ•ÊñπÊ≥ï„ÄÇloadViewÔºöË¶ÜÁõñËØ•ÊñπÊ≥ïÔºå‰ΩøÁî®‰ª£Á†ÅÊñπÂºèËÆæÁΩÆËßÜÂõæÊéßÂà∂ÁöÑÁöÑviewÂ±ûÊÄß„ÄÇviewDidLoadÔºöËØ•ÊñπÊ≥ï‰ºöÂú®ËßÜÂõæÊéßÂà∂Âô®Âä†ËΩΩÂÆåËßÜÂõæÂêéË¢´Ë∞ÉÁî®„ÄÇviewWillAppearÔºöËØ•ÊñπÊ≥ï‰ºöÂú®ËßÜÂõæÊéßÂà∂Âô®ÁöÑviewÊòæÁ§∫Âú®Â±èÂπï‰∏äÊó∂Ë¢´Ë∞ÉÁî®„ÄÇ ÊñáÊú¨Ê°Ü‰∏éÊñáÊú¨ËæìÂÖ•ÊñáÊú¨Ê°ÜUIResponder ÊòØ UIKitÊ°ÜÊû∂‰∏≠ÁöÑ‰∏Ä‰∏™ÊäΩË±°Á±ª„ÄÇËØ∏Â¶Ç UIViewÔºåUIViewControllerÔºåUIApplication ÈÉΩÊòØÂÆÉÁöÑÂ≠êÁ±ª„ÄÇ UIResponder ÂÆö‰πâ‰∫Ü‰∏ÄÁ≥ªÂàóÊñπÊ≥ïÔºåÁî®‰∫éÊé•Êî∂ÂíåÂ§ÑÁêÜÁî®Êà∑‰∫ã‰ª∂Ôºå‰æãÂ¶ÇËß¶Êë∏‰∫ã‰ª∂ÔºåËøêÂä®Êó∂Èó¥(Â¶ÇÊëáÊôÉ)ÂíåÂäüËÉΩÊéßÂà∂‰∫ã‰ª∂(Â¶ÇÁºñËæëÊñáÊú¨ÂíåÊí≠ÊîæÈü≥‰πê)Á≠â„ÄÇ Âú®‰∏äÈù¢ÁöÑ‰∫ã‰ª∂‰∏≠ÔºåËß¶Êë∏‰∫ã‰ª∂Â∫îËØ•Áî±Ë¢´Ëß¶Êë∏ÁöÑËßÜÂõæË¥üË¥£Â§ÑÁêÜÔºåÂÖ∂‰ªñÁ±ªÂûãÁöÑ‰∫ã‰ª∂‰ºöÁî±Á¨¨‰∏ÄÂìçÂ∫îËÄÖË¥üË¥£Â§ÑÁêÜ„ÄÇ UIWindow Êúâ‰∏Ä‰∏™ firstResponder Â±ûÊÄßÊåáÂêëÁ¨¨‰∏ÄÂìçÂ∫îËÄÖ„ÄÇ main() ‰∏é UIApplicationÁî® c ÂÜôÁöÑÁ®ãÂ∫èÔºåÂÖ•Âè£ÈÉΩÊòØ main(): 12345int main(int argc, char * argv[]) &#123; @autoreleasepool &#123; return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class])); &#125;&#125; UIApplicationMain ÂáΩÊï∞‰ºöÂàõÂª∫‰∏Ä‰∏™ UIApplication ÂØπË±°„ÄÇÊØè‰∏™ iOS Â∫îÁî®ÈÉΩÊúâ‰∏îÂè™Êúâ‰∏Ä‰∏™ UIApplication ÂØπË±°ÔºåËØ•ÂØπË±°‰ΩúÁî®ÊòØÁª¥Êä§ËøêË°åÂæ™ÁéØ„ÄÇ‰∏ÄÊó¶Á®ãÂ∫èÂàõÂª∫‰∫ÜÊüê‰∏™ UIApplication ÂØπË±°ÔºåËØ•ÂØπË±°Â∞±‰ºö‰∏ÄÁõ¥Âæ™ÁéØ‰∏ãÂéªÔºå main() ÁöÑÊâßË°å‰πü‰ºöÂõ†Ê≠§Â†µÂ°û„ÄÇ UIApplicationMain ÂáΩÊï∞Ëøò‰ºöÂàõÂª∫Êüê‰∏™ÊåáÂÆöÁ±ªÁöÑÂØπË±°ÔºåÂπ∂Â∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ UIApplication ÂØπË±°ÁöÑ delegate„ÄÇËØ•ÂØπË±°ÁöÑÁ±ªÁî± UIApplicationMain ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂèÇÊï∞ÊåáÂÆö„ÄÇ Â∫îÁî®ÂêØÂä®ËøêË°åÂæ™ÁéØÂπ∂ÂºÄÂßãÊé•Êî∂‰∫ã‰ª∂ÂâçÔºå UIApplication ÂØπË±°‰ºöÂÉèÂÖ∂ÂßîÊâòÂèëÈÄÅ‰∏Ä‰∏™ÁâπÂÆöÁöÑÊ∂àÊÅØÔºå‰ΩøÂ∫îÁî®ÂÆåÊàêÁõ∏Â∫îÁöÑÂàùÂßãÂåñÂ∑•‰Ωú„ÄÇËøô‰∏™Ê∂àÊÅØÁöÑÂêçÁß∞ÊòØ application:didFinishLaunchingWithOptions: UIMenuControlleriOS SDK Êèê‰æõ‰∏Ä‰∏™Âêç‰∏∫ UIMenuController ÁöÑÁ±ªÔºåÂèØ‰ª•Áî®Êù•ÊòæÁ§∫ËèúÂçï„ÄÇ‰æãÂ¶ÇÂú®ÂçïÂáªÊâãÂäøÁöÑÂÆûÁé∞ÊñπÊ≥ï‰∏≠ÂºπÂá∫‰∏Ä‰∏™ËèúÂçïÔºö 123456789101112131415- (void)tap:(UIGestureRecognizer *)gr&#123; // Ëé∑ÂèñÊâãÂäøÁöÑÂùêÊ†á CGPoint point = [gr locationInView:self]; // ËÆ©ËßÜÂõæÂèòÊàê UIMenuItem Âä®‰ΩúÊ∂àÊÅØÁöÑÁõÆÊ†á [self becomeFirstResponder]; // Ëé∑Âèñ UIMenuController ÂØπË±° UIMenuController *menu = [UIMenuController sharedMenuController]; // ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÊ†áÈ¢ò‰∏∫"delete"ÁöÑUIMenuItemÂØπË±° UIMenuItem *deleteItem = [[UIMenuItem alloc] initWithTitle:@"Delete" action:@selector(deleteLine:)]; menu.menuItems = @[deleteItem]; // ÂÖà‰∏∫ UIMenuController ÂØπË±°ËÆæÁΩÆÊòæÁ§∫Âå∫ÂüüÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ÂèØËßÅ [menu setTargetRect:CGRectMake(point.x,point.y,2,2) inView:self]; [menu setMenuVisible:YES animated:YES];&#125; Ë¶ÅÊòæÁ§∫ UIMenuController ÂØπË±°ÔºåËøòË¶ÅÊª°Ë∂≥‰∏Ä‰∏™Êù°‰ª∂ÔºöÊòæÁ§∫ UIMenuController ÂØπË±°ÁöÑ UIView ÂØπË±°ÂøÖÈ°ªÊòØÂΩìÂâç UIWindow ÂØπË±°ÁöÑÁ¨¨‰∏ÄÂìçÂ∫îÂØπË±°„ÄÇÂ¶ÇÊûúË¶ÅÂ∞ÜÊüê‰∏™Ëá™ÂÆö‰πâÁöÑ UIView Â≠êÁ±ªÂØπË±°ËÆæÁΩÆ‰∏∫Á¨¨‰∏ÄÂìçÂ∫îÂØπË±°ÔºåÂ∞±ÂøÖÈ°ªË¶ÜÁõñËØ•ÂØπË±°ÁöÑ canBecomeFirstResponder ÊñπÊ≥ïÔºö 123- (BOOL)canBecomeFirstResponder&#123; return YES;&#125; ÈóÆÈ¢òÔºö ‰ªÄ‰πàÊÉÖÂÜµ‰∏ã‰ºöËøõË°åÈáçÁªòÔºåÈáçÁªòÁöÑÊó∂Êú∫ÊòØ‰ªÄ‰πàÊó∂ÂÄôÔºü loadView ‰ªÄ‰πàÊó∂ÂÄô‰ºöË¢´Ë∞ÉÁî®Ôºü Á≥ªÁªüÁöÑ loadView ÂÅö‰∫Ü‰ªÄ‰πà‰∫ãÔºü‰ªÄ‰πàÊÉÖÂÜµ‰∏ãË¶ÅËá™ÂÆö‰πâ loadView ÔºüË¶ÅÊ≥®ÊÑè‰ªÄ‰πàÔºü ‰∏∫‰ªÄ‰πàË¶ÅÂú® xib ‰∏≠ËÆæÁΩÆ Files‚Äôs Owner ÁöÑ Custom Class ‰∏∫ÁõÆÊ†á ViewControllerÔºü ÊèíÂ∫ßÂèòÈáè‰∏∫‰ªÄ‰πàË¶ÅËÆæÁΩÆ‰∏∫ weakÔºü ‰∏∫‰ªÄ‰πà‰∏çËÉΩÂ∞Ü ViewController ËÆæÁΩÆ‰∏∫ View ÁöÑ Custom Class Ôºü Â∞ÜÊüê‰∏™ View ËÆæÁΩÆ‰∏∫ Files‚Äôs Owner ÁöÑ Custom Class ÊàñËÄÖËÆæÁΩÆ‰∏∫ View ÁöÑ Custom Class Âú®ÂàõÂª∫ÊñπÂºè‰∏äÊúâ‰ªÄ‰πà‰∏çÂêåÔºü initWithCoder ‰ΩïÊó∂‰ºöË¢´Ë∞ÉÁî®ÔºüÊÄé‰πà‰ΩøÁî®Ôºü Â¶Ç‰ΩïÂ∞Ü ViewController ÁöÑ xib ‰∏≠ÊãñÊãΩÂá∫ÁöÑ‰∏Ä‰∏™ view ÂíåËá™ÂÆö‰πâÁöÑ View ÂÖ≥ËÅîÔºüÊ≠§Êó∂ÊÄé‰πàÁî®Ëøô‰∏™Ëá™ÂÆö‰πâÁöÑ View Âä†ËΩΩÂè¶‰∏Ä‰∏™ nib Êñá‰ª∂ÔºüÊúâ‰ªÄ‰πàÊ≥®ÊÑèÁÇπÔºü Â¶Ç‰ΩïËÆæÁΩÆ‰∏Ä‰∏™ UITabBarControllerÔºåÂåÖÊã¨ tabbar„ÄÅtabBarItem Â±ûÊÄßÔºü Â¶Ç‰ΩïÁªô‰∏Ä‰∏™ View ËÆæÁΩÆ‰∏Ä‰∏™ UIMenuControllerÔºüÂØπËøô‰∏™ View Êúâ‰ªÄ‰πàË¶ÅÊ±ÇÔºü]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>Â≠¶‰π†Á¨îËÆ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mac ‰ΩøÁî®ÊäÄÂ∑ß]]></title>
    <url>%2F2016%2F07%2F31%2Fmac%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[‰ΩøÁî® Mac Áî®Âà∞ÁöÑ‰∏Ä‰∫õÊñπÊ≥ï ÂèñÊ∂àMacÂ∑•‰ΩúÂå∫ÂàáÊç¢‰πãÂêéËá™Âä®ÈáçÊéíÂ∑•‰ΩúÂå∫ÂàáÊç¢ÂêéËá™Âä®ÈáçÊéíÁúüÊòØ‰∏Ä‰∏™ÈùûÂ∏∏sbÁöÑÂäüËÉΩ„ÄÇÂèØËÉΩÊàëÂéüÊú¨Â∞ÜXcodeÔºåChromeÔºåÂæÆ‰ø°ÊéíÂ•ΩÁöÑÈ°∫Â∫èÂú®ÂàáÊç¢‰∫Ü‰∏ÄÊ¨°Á®ãÂ∫è‰πãÂêéÂ∞±Âèò‰∫Ü„ÄÇËøôÊòØ‰∏ÄÁõ¥Âõ∞Êâ∞ÊàëÁöÑ‰∏Ä‰∏™ÈóÆÈ¢ò„ÄÇ Ëß£ÂÜ≥ÊñπÊ≥ïÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºåÂú®‚ÄúÂÅèÂ•ΩËÆæÁΩÆ‚Äù‰∏≠ÈÄâÊã©‚ÄúË∞ÉÂ∫¶‰∏≠ÂøÉ‚ÄùÔºåÂèñÊ∂à‚ÄúÂãæÈÄâÊ†πÊçÆÊúÄËøëÁöÑ‰ΩøÁî®ÊÉÖÂÜµËá™Âä®ÈáçÊñ∞ÊéíÂàó Spaces ‚ÄùÂç≥ÂèØ„ÄÇ ÈöêËóè dockerdocker ÈùûÂ∏∏Âç†Áî®Ê°åÈù¢Á©∫Èó¥ÔºåÂ¶ÇÊûú‰Ω†‰∏∫Â∏∏Áî®Â∫îÁî®ËÆæÁΩÆ‰∫ÜÂø´Êç∑ÈîÆÔºåÂπ∂‰∏î‰ΩøÁî® AlfredÔºåÈÇ£‰πà‰Ω†Â∞±ÂèØ‰ª•ÊëÜËÑ± dockerÔºåÂ∞ÜÂÖ∂ÈöêËóè„ÄÇÊñπÂºèÊòØÂ∞Ü docker ËÆæÁΩÆ‰∏∫‰∏çÁî®Êó∂ÈöêËóèÔºåÁÑ∂ÂêéÈÄöËøáÂëΩ‰ª§Ë°åËÆæÁΩÆÊòæÁ§∫Êó∂Èó¥Ôºö 1234-- ËÆæÁΩÆÈº†Ê†áÂà∞ÂØπÂ∫î‰ΩçÁΩÆÂÅúÈ°øÂçÅÁßíÊâç‰ºöÊòæÁ§∫$ defaults write com.apple.dock autohide-delay -int 10-- ËÆæÁΩÆÁ´ãÂàªÈáçÂêØdocker$ killall Dock ÊêúÁ¥¢ÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂‰ΩøÁî® grep12-- ÊêúÁ¥¢ÂΩìÂâçÁõÆÂΩï‰∏ãÂêçÂ≠óÂ∏¶Êúâ zachary ÁöÑÊñá‰ª∂„ÄÇÊñá‰ª∂Âêç‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºè$ ls -R | grep zachary ‰∏çËøáËøôÊ†∑‰∏çÂ∏¶Â≠êÊñá‰ª∂Â§πÁöÑË∑ØÂæÑ„ÄÇÂè™ÈÄÇÂêàÂú®ÂΩìÂâçÊñá‰ª∂Â§π‰∏ã„ÄÇ ‰ΩøÁî® find12-- ÊêúÁ¥¢ÂΩìÂâçÁõÆÂΩï‰∏ãÂêçÂ≠óÂ∏¶Êúâ zachary ÁöÑÊñá‰ª∂„ÄÇÊñá‰ª∂Âêç‰ΩøÁî®ÈÄöÈÖçÁ¨¶$ find ./ -name '*zachary*' Êã∑Ë¥ùÊñá‰ª∂Âà∞ÁõÆÊ†áÊú∫Âô®ÈÄöËøá scp Â∞ÜÊñá‰ª∂Êã∑Ë¥ùÂà∞ÁõÆÊ†áÊú∫Âô®ÁöÑÊ†πÁõÆÂΩï‰∏ã 1scp ./xxx.js 10.26.5.145:~ sshÂÖçÂØÜÁôªÂΩïÂú®ÁõÆÊ†áÊú∫Âô®ÁöÑ .ssh Êñá‰ª∂Â§π‰∏ãÊñ∞Âª∫‰∏Ä‰∏™ authorized_keys Êñá‰ª∂ÔºåÂú®ÂÖ∂‰∏≠Âä†ÂÖ•Ëá™Â∑±ÁöÑ ssh_pub Âç≥ÂèØ ÁôªÂΩïÁöÑÊó∂ÂÄôËæìÂÖ•Ôºö 1ssh zachary@10.26.5.145 ÈÄÄÂá∫‰ΩøÁî® 1exit Â∫îÁî®Á®ãÂ∫èÂºπÁ™óÈÄâÊã©ÊúâÊó∂ÂÄôÂ∫îÁî®Á®ãÂ∫è‰ºöÂºπÁ™óÔºåÂ¶Ç‰∏ãÂõæÔºå‰Ω†Âè™ËÉΩÊåâÂõûËΩ¶Á°ÆÂÆöÔºåÂê¶ÂàôÂøÖÈ°ª‰ΩøÁî®Èº†Ê†áÈÄâÊã©ÂèñÊ∂àÔºö ÂèØ‰ª•ÈÄöËøáÂú®ÂëΩ‰ª§Ë°å‰∏ãÊï≤Â¶Ç‰∏ãÂëΩ‰ª§Êèê‰æõÈîÆÁõòÁöÑÊéßÂà∂ÊñπÂºèÔºö 1defaults write NSGlobalDomain AppleKeyboardUIMode -int 3 Â∞±ÂèØ‰ª•ÈÄöËøá tab ÂàáÊç¢ÈÄâ‰∏≠È°πÔºåspace ÈÄâ‰∏≠ÈÄâ‰∏≠È°π(enter ËøòÊòØË°®Á§∫ÈªòËÆ§Á°ÆÂÆö) Ë£ÖÊú∫ÂøÖÂ§áÂÆâË£Ö homebrew1/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)" ÂÆâË£Ö cocoapods‰øÆÊîπ ruby Ê∫ê123456//Âà†Èô§ÈªòËÆ§Ê∫ê$gem sources --remove https://rubygems.org///Ê∑ªÂä†Êñ∞Ê∫ê$gem sources -a http://gems.ruby-china.org///Êü•Áúã$ gem sources -l ÂÆâË£Ö cocoapods1$ sudo gem install cocoapods ÂÆâË£Ö node1brew install node ÂÆâË£ÖÂ•ΩnodeËá™ÁÑ∂Â∞±ÂÆâË£ÖÂ•Ω npm ‰∫Ü„ÄÇ ‰ΩøÁî® iterm2iterm2 ÊúÄÂº∫Â§ßÁöÑÂäüËÉΩÂ∞±ÊòØÂèØ‰ª•ÂàÜÂ±è„ÄÇËøòÊúâÂ∞±ÊòØÂèØ‰ª•ÈÄâ‰∏≠Âç≥Â§çÂà∂Ôºå‰ª•ÂèäÊåâ‰Ωè command ÁÇπÂáªÂ∞±ÂèØ‰ª•Áõ¥Êé•Ë∑≥ËΩ¨Âà∞Êñá‰ª∂Â§πÊàñËÄÖÁΩëÈ°µ„ÄÇ ‰∏ãËΩΩ‰∏ªÈ¢òÂÆòÊñπÁöÑÈ¢úËâ≤ÈªòËÆ§ÊòØÈªëËâ≤ÁöÑÔºåÂèØ‰ª•ÂéªIterm2-color-schemes‰∏ãËΩΩ‰∏ªÈ¢òÔºå‰∏ãËΩΩ tar.gz ÊàñËÄÖ zip ÁöÑÂéãÁº©ÂåÖÔºåÁÑ∂Âêé‰ºö‰∏ãËΩΩÈùûÂ∏∏Â§öÁöÑÈÖçËâ≤„ÄÇÁÑ∂ÂêéÊåâÁÖßÂ¶Ç‰∏ãÂõæÊìç‰ΩúÈÖçËâ≤Ôºö „ÄÇ Êé®Ëçê‰ΩøÁî® Solarized Dark Higher Contrast ‰∏ãËΩΩ zshzsh ÂèØ‰ª•Êèê‰æõ‰∏Ä‰∏™ÂæàÂº∫ÁöÑÂëΩ‰ª§Ë°•ÂÖ®ÁöÑÂäüËÉΩÔºåÂèçÊ≠£‰∏çÂ§™ËÆ∞ÂæóÁöÑÂëΩ‰ª§ÊàñËÄÖÂèÇÊï∞ÔºåÂè™Ë¶ÅÊåâ tab Â∞±Ë°å‰∫Ü„ÄÇ‰∏ãËΩΩ‰πüÊØîËæÉÁÆÄÂçïÔºö 1curl -L https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh | sh curl ÊòØÂà©Áî®URLËØ≠Ê≥ïÂú®ÂëΩ‰ª§Ë°åÊñπÂºè‰∏ãÂ∑•‰ΩúÁöÑÂºÄÊ∫êÊñá‰ª∂‰º†ËæìÂ∑•ÂÖ∑„ÄÇ Âè¶Â§ñÔºå‰∏ãËΩΩ‰πãÂêéÁªàÁ´Ø‰ºöÂèòÂæóÊØîËæÉÂ•ΩÁúã„ÄÇ ‰∏ãËΩΩÂ≠ó‰Ωì FiraÂ≠ó‰Ωì Fira ÈùûÂ∏∏ÂúÜÊ∂¶ÔºåÈÄÇÂêà‰Ωú‰∏∫‰ª£Á†ÅÁºñËæëÂô®ÁöÑÂ≠ó‰ΩìÔºå‰∏ãËΩΩ‰πüÈùûÂ∏∏ÁÆÄÂçï„ÄÇ‰ΩÜÊòØÊØîËæÉÂ≠ó‰ΩìÂåÖÊúâÁÇπÂ§ßÔºö 12brew tap caskroom/fontsbrew cask install font-fira-code brew Ë°®Á§∫ homebrew VSCode ÂêåÊ≠•ÊñπÊ°àVSCode ÁöÑÊèí‰ª∂ Setting Sync Êèê‰æõ‰∫ÜÈÄöËøá github ÁöÑ Gist ÂÆåÊàêÈÖçÁΩÆÂêåÊ≠•ÁöÑÂäüËÉΩ„ÄÇ‰ΩÜÊòØÁî±‰∫éÂÆÉÁöÑÊïôÁ®ã‰∏çÂÆåÊï¥ÔºåÂØºËá¥ÂêåÊ≠•Ëµ∑Êù•‰ºö‰∫ßÁîüÁúÅÈóÆÈ¢ò„ÄÇÊúÄÂ∏∏ËßÅÁöÑÈóÆÈ¢òÊòØÊó†Ê≥ï‰∏ãËΩΩÈÖçÁΩÆÔºåÊèêÁ§∫‰ø°ÊÅØ‰∏∫ÔºöSync : Invalid / Expired GitHub Token. Please generate new token with scopes mentioned in readme. Exception Logged in Console. Gist ÂèØ‰ª•‰øùÂ≠ò‰∏ä‰º†ÁöÑÈÖçÁΩÆÊñá‰ª∂„ÄÇÊãâÂèñÈÖçÁΩÆÊñá‰ª∂ÈúÄË¶ÅÈÖçÁΩÆ‰∏§‰∏™ idÔºå‰∏Ä‰∏™ÊòØ Gist IdÔºå‰∏Ä‰∏™ÊòØ Token Id„ÄÇËøô‰∏§‰∏™ Id ÂâçËÄÖÊ†áËØÜÈÖçÁΩÆÊñá‰ª∂ÔºåÂêéËÄÖÁî®‰∫éË∫´‰ªΩÈ™åËØÅ„ÄÇÊàë‰ª¨Êó†Ê≥ï‰∏ãËΩΩÁöÑÂéüÂõ†Â∞±ÊòØÊàë‰ª¨‰ΩøÁî®ÂçïÂçïÂú® Sync:Download Settings ÂëΩ‰ª§‰∏≠‰ΩøÁî®‰∫Ü Gist idÔºåÊâÄ‰ª•ÈîôËØØÊèêÁ§∫ÊâçÊòØÊó†ÊïàÁöÑ token„ÄÇ ÈÇ£‰πàËØ•ÊÄé‰πàËøõË°åË∫´‰ªΩÈ™åËØÅÂë¢ÔºüËøòÊòØÂú® VSCode ‰∏≠ËæìÂÖ•ÂëΩ‰ª§ÔºöSync:Advanced OptionsÔºåÁÑ∂ÂêéÈÄâÊã© Sync:Edit Extension Local SettingsÔºåÁºñËæë syncLocalSettings.json Ëøô‰∏™ÈÖçÁΩÆÊñá‰ª∂„ÄÇËøô‰∏™Êñá‰ª∂‰∏≠Êúâ‰∏ÄÈ°π token Ê≤°ÊúâËÆæÁΩÆÔºåËøôÈáåÂ∞±ÈúÄË¶ÅËÆæÁΩÆ‰∏∫ Token Id„ÄÇ‰Ω†ÂèØ‰ª•Áî®‰πãÂâç‰∏ä‰º†ÈÖçÁΩÆÊñá‰ª∂Êó∂ËÆæÁΩÆÁöÑ TokenÔºå‰πüÂèØ‰ª•ÂÜçÊñ∞Âª∫‰∏Ä‰∏™ Token„ÄÇ sudo ‰ªçÁÑ∂Êó†Ê≥ïËé∑ÂæóÊùÉÈôêÊúâ‰∫õÊó∂ÂÄô‰ΩøÁî® sudo ÂëΩ‰ª§‰ªçÁÑ∂‰ºöÂ§±Ë¥•ÔºåÊèêÁ§∫ Operation not permitted„ÄÇËøôÊòØÂõ†‰∏∫ÂºÄÂêØ‰∫Ü sip ÁöÑÁºòÊïÖ„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂÖ≥Èó≠ sipÔºö ÈáçÂêØOSXÁ≥ªÁªüÔºåÁÑ∂ÂêéÊåâ‰ΩèCommand+RÔºåËøõÂÖ•ÊÅ¢Â§çÊ®°Âºè Âá∫Áé∞ÁïåÈù¢‰πãÂêéÔºåÈÄâÊã©Â±èÂπïÂ∑¶‰∏äËßíËèúÂçïÊ†è‰∏≠ÁöÑÂÆûÁî®Â∑•ÂÖ∑‰∏≠ÁöÑTerminalÔºåÊâìÂºÄÁªàÁ´Ø Âú®Terminal‰∏≠ËæìÂÖ•csrutil disable ÂÖ≥Èó≠SIP ÈáçÂêØreboot OSX npm ÂÖ®Â±ÄÂÆâË£ÖÊó†ÊùÉÈôêÊúâÊó∂ÂÄôÊàë‰ª¨‰ΩøÁî® sudo npm install -g xxx ÁöÑÊó∂ÂÄô‰ªçÁÑ∂ÊèêÁ§∫ Error: EACCES: permission denied„ÄÇ Ëøô‰∏™Êó∂ÂÄôÂèØ‰ª•Â¢ûÂä†‰∏Ä‰∫õÈÄâÈ°πÔºö 1sudo npm install -g xxx --unsafe-perm=true --allow-root shell ËÑöÊú¨ sudo ÂëΩ‰ª§‰∏çËæìÂÖ•ÂØÜÁ†Åexpectexpect ÂèØ‰ª•Âú®ÈúÄË¶ÅÂØÜÁ†ÅÁöÑÊó∂ÂÄôËæìÂÖ•ÂØÜÁ†Å„ÄÇÂÆâË£Ö expect ÈùûÂ∏∏ÁÆÄÂçïÔºö 1brew install expect 123456789#!/usr/bin/expectset timeout 30spawn bash "./Untitled-1.sh"expect &#123; Password: &#123; send xxxx\r &#125; Password: &#123; send xxxx\r &#125; Password: &#123; send xxxx\r &#125;&#125;interact #!/usr/bin/expect Ë°®Á§∫Âà∞ interact ‰∏∫Ê≠¢ÔºåÈÉΩ‰ΩøÁî® expect ÊâßË°å spawn ËØ•ÂëΩ‰ª§Áî®‰∫éÂêØÂä®‰∏Ä‰∏™Â≠êËøõÁ®ãÔºåÊâßË°åÂêéÁª≠ÂëΩ‰ª§. expect ‰ªéËøõÁ®ãÊé•ÂèóÂ≠óÁ¨¶‰∏≤ÔºåÂ¶ÇÊûúÊé•ÂèóÁöÑÂ≠óÁ¨¶‰∏≤ÂíåÊúüÂæÖÁöÑÂ≠óÁ¨¶‰∏≤‰∏çÂåπÈÖçÔºåÂàô‰∏ÄÁõ¥ÈòªÂ°ûÔºåÁõ¥Âà∞ÂåπÈÖç‰∏äÊàñËÄÖÁ≠âÂæÖË∂ÖÊó∂ÊâçÁªßÁª≠ÂæÄ‰∏ãÊâßË°å„ÄÇ‰∏äÈù¢ÁöÑ PasswordÔºö Â∞±ÊòØÊâßË°å sudo ÂëΩ‰ª§ÊòØ‰ºöÂá∫Áé∞ÁöÑ„ÄÇ ËøôÈáåÊ®°Êãü‰∫Ü‰∏â‰∏™‰ºöÂá∫Áé∞ Password: ËæìÂÖ•ÂØÜÁ†ÅÁöÑÂú∫ÊôØ„ÄÇ send ÂêëËøõÁ®ãÂèëÈÄÅÂ≠óÁ¨¶‰∏≤Ôºå‰∏éÊâãÂä®ËæìÂÖ•ÂÜÖÂÆπÁ≠âÊïàÔºåÈÄöÂ∏∏Â≠óÁ¨¶‰∏≤ÈúÄË¶Å‰ª•‚Äô\r‚ÄôÁªìÂ∞æ„ÄÇ interact ËØ•ÂëΩ‰ª§Â∞ÜÊéßÂà∂ÊùÉ‰∫§ÁªôÊéßÂà∂Âè∞Ôºå‰πãÂêéÂ∞±ÂèØ‰ª•ËøõË°å‰∫∫Â∑•Êìç‰Ωú‰∫Ü„ÄÇÈÄöÂ∏∏Áî®‰∫é‰ΩøÁî®ËÑöÊú¨ËøõË°åËá™Âä®ÂåñÁôªÂΩï‰πãÂêéÂÜçÊâãÂä®ÊâßË°åÊüê‰∫õÂëΩ‰ª§„ÄÇÂ¶ÇÊûúËÑöÊú¨‰∏≠Ê≤°ÊúâËøô‰∏ÄÊù°ËØ≠Âè•ÔºåËÑöÊú¨ÊâßË°åÂÆåÂ∞ÜËá™Âä®ÈÄÄÂá∫„ÄÇ sudo ‰∏çË¶ÅÂØÜÁ†ÅÈô§‰∫ÜÁî® expect Âú®ÈúÄË¶ÅÂØÜÁ†ÅÁöÑÊó∂ÂÄôËæìÂÖ•Â§ñÔºåËøòÂèØ‰ª•ËÆæÁΩÆ sudo ‰∏çÈúÄË¶ÅÂØÜÁ†Å„ÄÇËôΩÁÑ∂‰∏çÂÆâÂÖ®Ôºå‰ΩÜÊòØ‰∏ÄËà¨‰∏™‰∫∫‰ΩøÁî®‰πü‰∏ç‰ºöÊúâ‰ªÄ‰πàÈóÆÈ¢ò„ÄÇ ËæìÂÖ• sudo visudo ‰ºöÊâìÂºÄ /etc/sudoers Êñá‰ª∂ÔºåËøôÂ∞±ÊòØË¶Å‰øÆÊîπÁöÑÈÖçÁΩÆÊñá‰ª∂„ÄÇ ÁÑ∂ÂêéÂÜçÊúÄÂêéËæìÂÖ•Ôºö 1zachary ALL=(ALL) NOPASSWD: ALL ‰øùÂ≠òÂπ∂Êé®Âá∫„ÄÇÊ≠§Êó∂ sudo Â∞±‰∏ç‰ºöÂÜçÈúÄË¶ÅÂØÜÁ†Å‰∫Ü„ÄÇ ÈÇ£‰πàËøôÂè•ËØùÊòØ‰ªÄ‰πàÊÑèÊÄùÂë¢Ôºü Á¨¨‰∏Ä‰∏™Â≠óÊÆµ zachary Ë°®Á§∫‰ΩøÁî® sudo ÂëΩ‰ª§ÁöÑÁî®Êà∑‰∏∫ zachary Á¨¨‰∫å‰∏™Â≠óÊÆµÔºåÁ≠âÂè∑Â∑¶ËæπÁöÑ ALL Ë°®Á§∫ÂÖÅËÆ∏‰ΩøÁî® sudo ÁöÑ‰∏ªÊú∫„ÄÇËøôÈáåÊòØÊâÄÊúâ‰∏ªÊú∫„ÄÇ Á¨¨‰∏â‰∏™Â≠óÊÆµÔºåÁ≠âÂè∑Âè≥ËæπÁöÑ (ALL) Ë°®Á§∫‰ΩøÁî® sudo Âêé‰∏Ä‰ªÄ‰πàË∫´‰ªΩÊù•ÊâßË°åÂëΩ‰ª§„ÄÇ ÊúÄÂêé‰∏Ä‰∏™Â≠óÊÆµ NOPASSWD: ALL Ë°®Á§∫ÊâÄÊúâÂëΩ‰ª§ÔºåÈÉΩ‰∏çÈúÄË¶ÅÂØÜÁ†Å„ÄÇ ÁÆ°ÈÅì‰∏é xargsÁÆ°ÈÅìÁÆ°ÈÅìÁöÑ‰ΩúÁî®Â∞±ÊòØÊääÂâç‰∏Ä‰∏™ÂëΩ‰ª§ÁöÑÊ†áÂáÜËæìÂá∫‰Ωú‰∏∫Âêé‰∏Ä‰∏™ÂëΩ‰ª§ÁöÑÊ†áÂáÜËæìÂÖ•ÔºåÊØîÂ¶ÇÔºö 1ls -a | grep myfile ‰∏äÈù¢ÁöÑÂëΩ‰ª§Â∞±ÊòØÊääÂàóÂá∫ÊâÄÊúâÊñá‰ª∂ÁöÑËæìÂá∫Ôºå‰Ωú‰∏∫Ê≠£ÂàôÂåπÈÖçÊü•ÊâæÁöÑËæìÂÖ•„ÄÇ ‰ΩÜÊòØÂæàÂ§öÁ®ãÂ∫èÊòØ‰∏çÂ§ÑÁêÜÊ†áÂáÜËæìÂÖ•ÁöÑÔºå‰æãÂ¶Ç kill , rm Ëøô‰∫õÁ®ãÂ∫èÂ¶ÇÊûúÂëΩ‰ª§Ë°åÂèÇÊï∞‰∏≠Ê≤°ÊúâÊåáÂÆöË¶ÅÂ§ÑÁêÜÁöÑÂÜÖÂÆπÂàô‰∏ç‰ºöÈªòËÆ§‰ªéÊ†áÂáÜËæìÂÖ•‰∏≠ËØªÂèñÔºåÊâÄ‰ª•Ôºö 1ls -a | grep myfile | rm -f Ëøô‰∏™ÂëΩ‰ª§ÊòØÊó†Ê≥ïÂà†Èô§ myfile Áõ∏ÂÖ≥ÁöÑÊñá‰ª∂ÁöÑ„ÄÇËøôÊó∂ÂÄôÂ∞±ÈúÄË¶Å‰ΩøÁî® xargs xargsxargs ÂíåÁÆ°ÈÅìÊúâ‰ªÄ‰πà‰∏çÂêåÂèØ‰ª•Áúã‰∏ãÈù¢Ëøô‰∏™‰æãÂ≠êÔºö 123456echo '--help' | cat ËæìÂá∫Ôºö--helpecho '--help' | xargs cat ËæìÂá∫Âêå cat --help ÂèØ‰ª•ÂèëÁé∞Ôºåxargs Â∞ÜÂÖ∂Êé•ÂèóÁöÑÂ≠óÁ¨¶‰∏≤ ‚Äîhelp ÂÅöÊàêcatÁöÑ‰∏Ä‰∏™ÂëΩ‰ª§ÂèÇÊï∞Êù•ËøêË°åcatÂëΩ‰ª§„ÄÇ ÊâÄ‰ª•‰∏äÈù¢ÁöÑÂà†Èô§ÊñπÊ≥ïË¶ÅÊîπÊàêÂ¶Ç‰∏ãÔºåÂ∞±ÊòØÂèØ‰ª•ËææÂà∞ÁõÆÁöÑÁöÑÔºö 1ls -a | grep myfile | xargs rm -f xargs ËøòÊúâËÆ∏Â§öÂèÇÊï∞ÔºåÂèØ‰ª•Áî®Âú®ÈúÄË¶ÅÂ§ö‰∏™ÂèÇÊï∞ÁöÑÊÉÖÂÜµÔºåÂ¶ÇÊûúÊúâÈúÄÊ±ÇÔºåÂèØ‰ª•Êü•ÈòÖ‰ΩøÁî®„ÄÇ ‰ΩøÁî® npmrc ÁôªÂΩï npmÊàë‰ª¨Ë¶ÅÂèëÂ∏ÉËá™Â∑±ÁöÑ npm ÂåÖÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÂÖàÁôªÂΩïÂà∞ npm„ÄÇÈÇ£‰πàÔºånpm ÊÄé‰πàÈ™åËØÅÂèëÂ∏ÉÁöÑÊòØÊú¨‰∫∫Âë¢ÔºüÂΩìÊàë‰ª¨Âú® shell ÈáåÁôªÂΩïÂà∞ npm ÁöÑÊó∂ÂÄôÔºåÂú® home ÁõÆÂΩï‰∏ã‰ºöÁîüÊàê‰∏Ä‰∏™ .npmrc Êñá‰ª∂„ÄÇËøô‰∏™Êñá‰ª∂ÈáåÊúâ‰∏™ authToken ÔºåÂêåÊó∂Ôºå‰Ω†ÁöÑ npm Ë¥¶Êà∑ÈáåÁöÑ token ÂàóË°®Èáå‰πü‰ºö‰∫ßÁîü‰∏Ä‰∏™Áõ∏Â∫îÁöÑ token„ÄÇÂΩì‰Ω†Ë¶ÅÂèëÂ∏É‰ª£Á†ÅÁöÑÊó∂ÂÄôÔºånpm Â∞±‰ºöÊØîËæÉË¥¶Êà∑ÈáåÁöÑ token ÊòØÂê¶ÂåÖÂê´Ëøô‰∏™ authToken„ÄÇÂ¶ÇÊûú‰Ω†ÊâãÂä®Âà†Èô§‰∫Ü npm Ë¥¶Êà∑ÈáåÁöÑ tokenÔºåÈÇ£‰πà‰πãÂêé‰πüÂ∞±Êó†Ê≥ïÈÄöËøáËØ• authToken ÁôªÂΩï‰∫Ü„ÄÇ Âè¶Â§ñÔºåÊØè‰∏™È°πÁõÆÈáåÈÉΩÂèØ‰ª•Êúâ‰∏Ä‰∏™ .npmrc ‰ΩøÁî®‰∏çÂêåÁöÑ token„ÄÇÈ°πÁõÆÈáåÊ≤°Êúâ token ÁöÑÊÉÖÂÜµ‰∏ãÊâçÂõûÂéª home ‰∏ãÊü•Êâæ .npmrc Ëá™Âà∂‰∏Ä‰∏™ÊêúÁ¥¢ Markdown Êñá‰ª∂ÁöÑ workflowÂèØ‰ª•Ëá™Âà∂‰∏Ä‰∏™ workflow ËÄå‰∏çÊòØ‰ΩøÁî® open ÊâìÂºÄ markdown Êñá‰ª∂„ÄÇ ‰∏ªË¶ÅÊ≠•È™§Â∞±ÊòØÊñ∞Âª∫‰∏Ä‰∏™ workflowÔºåÁÑ∂Âêé Âè≥ÈîÆ‚ÜíInputs‚ÜíFile Filter„ÄÇËøôÈáåÁöÑÈáçÁÇπÂ∞±ÊòØÈÄâÊã© File FilterÔºåËøôÊ†∑Á≥ªÁªü‰ºöËá™Âä®ËøõË°åÊñá‰ª∂ÊêúÁ¥¢„ÄÇÁÑ∂ÂêéÂú®ÂºπÂá∫ÁöÑËÆæÁΩÆÁïåÈù¢ËÆæÁΩÆÂÖ≥ÈîÆÂ≠óÔºå‰ª•ÂèäÊêúÁ¥¢ÁöÑÊñá‰ª∂Á±ªÂûã„ÄÇ‰Ω†‰πüÂèØ‰ª•Âú®Á¨¨‰∫å‰∏™ÈÄâÈ°πÂç°‰∏≠ËÆæÁΩÆÊêúÁ¥¢Ë∑ØÂæÑÔºö ÁÑ∂ÂêéËÆæÁΩÆËøô‰∏™Êìç‰ΩúÁöÑÂä®‰ΩúÔºöÊãâÁ∫ø‚ÜíActions‚ÜíOpen File„ÄÇOpen File Âá∫Áé∞ÁöÑËÆæÁΩÆÁïåÈù¢‰∏çÁî®‰ªª‰ΩïÊìç‰ΩúÔºåÁõ¥Êé•ÁÇπÂÆåÊàêÂç≥ÂèØÔºö ‰∏ÄËà¨Êàë‰ª¨‰ΩøÁî®ÁöÑÊâìÂºÄ Xcode Â∑•Á®ã‰πüÂèØ‰ª•ËøôÊ†∑ËÆæÁΩÆ„ÄÇ Alfred3 ÂºÄÊú∫ËÆøÈóÆÈÄöËÆØÂΩïÁ†¥Ëß£ÁöÑ Alfred3 ÊØèÊ¨°ÂºÄÊú∫ÈÉΩË¶ÅËÆøÈóÆÈÄöËÆØÂΩïÔºåËß£ÂÜ≥ÂäûÊ≥ïÊòØÂú®ÁªàÁ´Ø‰∏≠ËøõË°åÁ≠æÂêç: 1sudo codesign -f -d -s - /Applications/Alfred\ 3.app/Contents/Frameworks/Alfred\ Framework.framework/Versions/A/Alfred\ Framework ÂÆâË£ÖÁöÑMacÂ∫îÁî®ÊòæÁ§∫Â∑≤ÊçüÂùèÊó†Ê≥ïÊâìÂºÄËÆæÁΩÆ =&gt; ÂÆâÂÖ®ÊÄß‰∏éÈöêÁßÅ =&gt; ÈÄöÁî® =&gt; ÂÖÅËÆ∏‰ªé‰ª•‰∏ã‰ΩçÁΩÆ‰∏ãËΩΩÁöÑÂ∫îÁî® =&gt; ‰ªª‰ΩïÊù•Ê∫ê Â¶ÇÊûúÊ≤°Êúâ ‰ªª‰ΩïÊù•Ê∫ê Ëøô‰∏™ÈÄâÈ°πÔºåÈúÄË¶ÅÊâßË°åÂëΩ‰ª§Ôºö 1sudo spctl --master-disable Â¶Ç‰ΩïÊòæÁ§∫/‰∏çÊòæÁ§∫ÈöêËóèÊñá‰ª∂Âú®ÁªàÁ´Ø‰∏≠ÊâßË°åÂ¶Ç‰∏ã‰ª£Á†ÅÂπ∂ÈáçÂêØÂä®Finder„ÄÇ 1234ÊòæÁ§∫ÈöêËóèÊñá‰ª∂Ôºödefaults write com.apple.finder AppleShowAllFiles -bool TRUEÂÅúÊ≠¢ÊòæÁ§∫ÈöêËóèÊñá‰ª∂Ôºödefaults write com.apple.finder AppleShowAllFiles -bool FALSE Êñ∞Á≥ªÁªü‰∏≠Êõ¥Â•ΩÁöÑÊñπÂºèÔºö ÂèØ‰ª•‰ΩøÁî®Âø´Êç∑ÈîÆ shift+command+. handoff Êó†Ê≥ï‰ΩøÁî®handoff ÊòØ‰∏Ä‰∏™ËÉΩÂú®ÁîµËÑëÂíåÊâãÊú∫Èó¥ÂÖ±‰∫´‰ø°ÊÅØÁöÑ‰∏úË•øÔºå‰ΩÜÊòØÊúâÁöÑÊó∂ÂÄôÂ∞±ÊòØËØÜÂà´‰∏çÂà∞„ÄÇÂ¶ÇÊûúÂ∑≤ÁªèÊòéÁ°ÆËá™Â∑±ÂºÄÂêØ‰∫Ü handoff ‰ΩÜÊòØ‰ªªÁÑ∂Êó†Ê≥ï‰ΩøÁî®ÔºåÈÇ£‰πàÂèØ‰ª•ÂÖàÂÖ≥Èó≠ÁîµËÑëÁöÑËìùÁâôÂäüËÉΩÔºåÁÑ∂ÂêéÂÜçÊâìÂºÄ„ÄÇËøôÊ†∑Â∞±ÂèØ‰ª•‰ΩøÁî®‰∫Ü„ÄÇ Â¶Ç‰ΩïÁ†¥Ëß£Ê¨ßË∑ØÁöÑ‰ΩøÁî®Ê¨°Êï∞ÈôêÂà∂ÈùûÊ≥®ÂÜåÁî®Êà∑Âè™ËÉΩ‰ΩøÁî® Xcode 50Ê¨°Ôºå‰∏∫‰∫ÜÁúÅËøô 98ÂùóÈí±Â∞±Âú®ÁΩë‰∏äÊâæÁ†¥Ëß£ÁâàÔºåÊó†ÊÑè‰∏≠ÊêúÂà∞‰∫Ü‰øÆÊîπ‰ΩøÁî®Ê¨°Êï∞ÁöÑÊñπÊ≥ï„ÄÇ Âú® ~/library/preferences/ Êñá‰ª∂Â§πÈáåÔºåÊâæÂà∞ com.eusoft.eudic.plist Êñá‰ª∂„ÄÇÁî® Xcode ÊâìÂºÄÂÆÉÔºåÁÑ∂ÂêéÊâæÂà∞Âπ∂‰øÆÊîπ MAIN_TimeLeft ÁöÑÂÄºÔºö 1&lt;key&gt;MAIN_TimeLeft&lt;/key&gt; &lt;integer&gt;50&lt;/integer&gt;]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>ÊåÅÁª≠Êõ¥Êñ∞</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÈáçÊñ∞ÂºÄÂßã]]></title>
    <url>%2F2016%2F07%2F30%2F%E9%87%8D%E6%96%B0%E5%BC%80%E5%A7%8B%2F</url>
    <content type="text"><![CDATA[Êó∂ÈöîÊé•Ëøë‰∏ÄÂπ¥ÔºåÁªà‰∫éËøòÊòØÂáÜÂ§áÈáçÂºÄ‰∏™‰∫∫ÁΩëÁ´ô„ÄÇËøáÂéª‰∏ÄÂπ¥Â≠¶‰∫ÜÂæàÂ§öÔºåËÆ∞‰∫ÜÂæàÂ§öÔºåËøôÊòØÊàëÊÑüÂà∞ÈùûÂ∏∏ÂÆΩÊÖ∞ÁöÑ„ÄÇÁü•ËØÜÊòØË¶Å‰∏çÊñ≠Â∑©Âõ∫ÁöÑÔºå‰∏™‰∫∫ÁΩëÈ°µ‰∏çËßÅÂæóË¶ÅÁªôÂà´‰∫∫ÁúãÂà∞ÔºåËá™Â∑±Ê≤°‰∫ãÁöÑÊó∂ÂÄôÁªèÂ∏∏ÁøªÁøªËá™Â∑±ÊõæÁªèÂÅö‰∫Ü‰ªÄ‰πàÔºåÂ≠¶‰∫Ü‰ªÄ‰πà„ÄÇÊó†ÂΩ¢‰∏≠Ôºå‰πüÊòØ‰∏ÄÁßçËÆ∞ÂøÜÁöÑËÑöÂç∞„ÄÇ ‰∏çËøáÔºå‰πãÂâç‰∏ÄÊù•ÂØπ‰∫égitÔºåhexoÁöÑÊéåÊè°Á®ãÂ∫¶ËæÉ‰ΩéÔºå‰∫åÊù•Ê≤°Êúâ‰ªîÁªÜÊ£ÄÊü•Â§á‰ªΩÔºåÂØºËá¥Âú®ËøÅÁßªÁöÑÊó∂ÂÄôÔºåËæõËæõËã¶Ëã¶ÂÜôÁöÑÂçÅÂá†ÁØáÁ¨îËÆ∞ÈÉΩ‰∏¢Â§±‰∫Ü„ÄÇ‰∏ÄÂ∫¶ÈùûÂ∏∏ÊáäÊÅºÔºå‰∏çÊÉ≥ÂÜçÂÅöËøô‰∫õË¥πÊó∂Ë¥πÂäõÁöÑ‰∫ã‰∫Ü„ÄÇ ‰ªäÂ§©ÔºåÁªà‰∫éÂèàËÄê‰∏ãÊÄßÂ≠êÔºåÊääÊï¥‰∏™‰∏™‰∫∫ÁΩëÁ´ôÂèàÂºÑËµ∑Êù•‰∫Ü„ÄÇËôΩÁÑ∂ÂäüËÉΩËøòÊòØÂæàÁÆÄÂçïÔºåÂÖ®ÂΩìÊòØ‰∏Ä‰∏™ËÆ∞ÂΩïÁöÑÂú∞ÊñπÂêß„ÄÇÊÄª‰πãÔºåËøôÂ∞±ÁÆóÊòØÈáçÊñ∞ÂºÄÂßã‰∫Ü„ÄÇËøô‰πüÁÆóÊòØ‰∏Ä‰∏™Êñ∞ÁöÑËµ∑ÁÇπÂêß„ÄÇÂ§öÂÅöÊÄªÁªìÔºåÂ§öÂÅöÂàÜ‰∫´„ÄÇÂ∏åÊúõËá™Â∑±ËÉΩÂ§ü‰øùÊåÅÂ≠¶‰π†ÁöÑÂä®ÂäõÔºåÂÜçÊé•ÂÜçÂéâÔºÅ]]></content>
      <categories>
        <category>Êó†Â§ÑÁΩÆÊîæ</category>
      </categories>
      <tags>
        <tag>ÊùÇË∞à</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2016%2F07%2F29%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
      <categories>
        <category>Êó†Â§ÑÁΩÆÊîæ</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
</search>
